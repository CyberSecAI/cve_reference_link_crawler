
- Search for:

* [Products](https://outpost24.com/products/)
  + [Exposure Management PlatformRemediate your organization’s most critical vulnerabilities with our modular platform that offers continuous and comprehensive visibility into your attack surface.](https://outpost24.com/products/exposure-management-platform/)
  + [External Attack Surface ManagementAttack surface discovery and monitoring in real-time with actionable insights](https://outpost24.com/products/external-attack-surface-management/)
  + [Web Application Security TestingManual testing & automated scanning with continuous monitoring via pen testing as a service (PTaaS)](https://outpost24.com/products/web-application-security-testing/)
  + [Cyber Threat IntelligenceDigital risk protection with our modular, multi-tenant, subscription-based solution for any use case](https://outpost24.com/products/cyber-threat-intelligence/)
  + [Risk-based Vulnerability ManagementVulnerability management with real-word threat intelligence to focus remediation & reduce business risk](https://outpost24.com/products/risk-based-vulnerability-management/)
  + [Active Directory Password SecurityStrengthen AD passwords with Specops Software, an Outpost24 company](https://outpost24.com/products/active-directory-password-security/)
* [Services](https://outpost24.com/services/managed-services/)
  + [Managed ServicesProactive security services for your network, endpoints, applications, and clouds](https://outpost24.com/services/managed-services/)
  + [Penetration TestingClassic penetration testing on networks, web, and mobile applications](https://outpost24.com/services/penetration-testing/)
  + [Red TeamingScenario-based attack simulations to reveal hidden threats](https://outpost24.com/services/red-teaming/)
  + [Security Awareness TrainingComplete solution to improve security resilience throughout your organization](https://outpost24.com/services/security-awareness-training/)
* [Resources](/resources/)
  + [ResearchIn-depth reports compiled by KrakenLabs, our Threat Intelligence analysts](/resources/#research)
  + [DatasheetsDownloadable datasheets for products and services](/resources/#datasheets)
  + [Videos & WebinarsOn-demand webinars and product videos](/resources/#webinar)
  + [WhitepapersIndustry and best practice guides for securing your business](/resources/#whitepaper)
  + [Upcoming EventsCybersecurity conferences, events, and webinars organized by Outpost24](/resources/#event)
* [Support](https://outpost24.com/support/)
* [Partners](https://outpost24.com/partners/)
* [Company](https://outpost24.com/company/)
  + [Company OverviewOur mission to fight cybercrime, and who we are](https://outpost24.com/company/)
  + [NewsroomOur latest announcements, press mentions, and media contact information.](https://outpost24.com/news/)
  + [CertificationsCybersecurity certifications and adherence to industry best practice standards](https://outpost24.com/certifications/)
  + [CustomersReal-world examples of how Outpost24 helps businesses improve their security posture](/customers/)
  + [ESGOur principles and commitments as a global citizen](https://outpost24.com/esg/)
  + [CareersWe’re hiring! Check out our current openings](https://careers.outpost24.com/#jobs)
* [Careers](https://careers.outpost24.com/#jobs)
* [Blog](https://outpost24.com/blog/)
* [Pricing](https://outpost24.com/pricing/)
* [Contact](https://outpost24.com/contact/)
- EnglishDeutschFrançais

[![outpost24 logo](https://outpost24.com/wp-content/uploads/2023/05/01-o24-color.svg)](https://outpost24.com/)

* [Careers](https://careers.outpost24.com/)
* [Blog](https://outpost24.com/blog/)
* [Pricing](https://outpost24.com/pricing/)
* [Contact](https://outpost24.com/contact/)

Search for:

EnglishDeutschFrançais

[![outpost24 logo](https://outpost24.com/wp-content/uploads/2023/05/01-o24-color.svg)](https://outpost24.com/)

* [Products](https://outpost24.com/products/)
  + [Exposure Management PlatformRemediate your organization’s most critical vulnerabilities with our modular platform that offers continuous and comprehensive visibility into your attack surface.](https://outpost24.com/products/exposure-management-platform/)
  + [External Attack Surface ManagementAttack surface discovery and monitoring in real-time with actionable insights](https://outpost24.com/products/external-attack-surface-management/)
  + [Web Application Security TestingManual testing & automated scanning with continuous monitoring via pen testing as a service (PTaaS)](https://outpost24.com/products/web-application-security-testing/)
  + [Cyber Threat IntelligenceDigital risk protection with our modular, multi-tenant, subscription-based solution for any use case](https://outpost24.com/products/cyber-threat-intelligence/)
  + [Risk-based Vulnerability ManagementVulnerability management with real-word threat intelligence to focus remediation & reduce business risk](https://outpost24.com/products/risk-based-vulnerability-management/)
  + [Active Directory Password SecurityStrengthen AD passwords with Specops Software, an Outpost24 company](https://outpost24.com/products/active-directory-password-security/)
* [Services](https://outpost24.com/services/managed-services/)
  + [Managed ServicesProactive security services for your network, endpoints, applications, and clouds](https://outpost24.com/services/managed-services/)
  + [Penetration TestingClassic penetration testing on networks, web, and mobile applications](https://outpost24.com/services/penetration-testing/)
  + [Red TeamingScenario-based attack simulations to reveal hidden threats](https://outpost24.com/services/red-teaming/)
  + [Security Awareness TrainingComplete solution to improve security resilience throughout your organization](https://outpost24.com/services/security-awareness-training/)
* [Resources](/resources/)
  + [ResearchIn-depth reports compiled by KrakenLabs, our Threat Intelligence analysts](/resources/#research)
  + [DatasheetsDownloadable datasheets for products and services](/resources/#datasheets)
  + [Videos & WebinarsOn-demand webinars and product videos](/resources/#webinar)
  + [WhitepapersIndustry and best practice guides for securing your business](/resources/#whitepaper)
  + [Upcoming EventsCybersecurity conferences, events, and webinars organized by Outpost24](/resources/#event)
* [Support](https://outpost24.com/support/)
* [Partners](https://outpost24.com/partners/)
* [Company](https://outpost24.com/company/)
  + [Company OverviewOur mission to fight cybercrime, and who we are](https://outpost24.com/company/)
  + [NewsroomOur latest announcements, press mentions, and media contact information.](https://outpost24.com/news/)
  + [CertificationsCybersecurity certifications and adherence to industry best practice standards](https://outpost24.com/certifications/)
  + [CustomersReal-world examples of how Outpost24 helps businesses improve their security posture](/customers/)
  + [ESGOur principles and commitments as a global citizen](https://outpost24.com/esg/)
  + [CareersWe’re hiring! Check out our current openings](https://careers.outpost24.com/#jobs)
* [Careers](https://careers.outpost24.com/#jobs)
* [Blog](https://outpost24.com/blog/)
* [Pricing](https://outpost24.com/pricing/)
* [Contact](https://outpost24.com/contact/)
[Contact Us](/contact/)

[Blog](https://outpost24.com/blog/)  /  [Research & Threat Intel](https://outpost24.com/blog/category/research-and-threat-intel/)  /  Nagios XI vulnerabilities resulting in privilege escalation (& more)

Contents

* [What is Nagios XI](#what-is-nagios-xi "What is Nagios XI")
* [The four vulnerabilities](#the-four-vulnerabilities "The four vulnerabilities")
  + [1. SQL Injection in Banner acknowledging endpoint (CVE-2023-40931)](#1-sql-injection-in-banner-acknowledging-endpoint-cve-2023-40931 "1. SQL Injection in Banner acknowledging endpoint (CVE-2023-40931)")
  + [2. SQL Injection in Host/Service Escalation in CCM (CVE-2023-40934)](#2-sql-injection-in-hostservice-escalation-in-ccm-cve-2023-40934 "2. SQL Injection in Host/Service Escalation in CCM (CVE-2023-40934)")
  + [3. SQL Injection in Announcement Banner Settings (CVE-2023-40933)](#3-sql-injection-in-announcement-banner-settings-cve-2023-40933 "3. SQL Injection in Announcement Banner Settings (CVE-2023-40933)")
  + [4. Cross-Site Scripting in Custom Logo Component (CVE-2023-40932)](#4-cross-site-scripting-in-custom-logo-component-cve-2023-40932 "4. Cross-Site Scripting in Custom Logo Component (CVE-2023-40932)")
* [Disclosure timeline](#disclosure-timeline "Disclosure timeline")
* [The importance of application security testing](#the-importance-of-application-security-testing "The importance of application security testing")
* [About Ghost Labs](#about-ghost-labs "About Ghost Labs")

# Nagios XI vulnerabilities resulting in privilege escalation (& more)

[Research & Threat Intel](https://outpost24.com/blog/category/research-and-threat-intel/)
Last updated: 20 Aug 2024

Written By
[Astrid Tedenbrant](https://outpost24.com/blog/authors/astrid-tedenbrant/)
Vulnerability Research Engineer, Outpost24

During some standard research as part of the Outpost24 Ghost Labs Vulnerability Research department, I discovered four different vulnerabilities in Nagios XI (version 5.11.1 and lower). Three of these vulnerabilities (CVE-2023-40931, CVE-2023-40933 and CVE-2023-40934) allow users, with various levels of privileges, to access database fields via SQL Injections. The data obtained from these vulnerabilities may be used to further escalate privileges in the product and obtain sensitive user data such as password hashes and API tokens.

The fourth vulnerability (CVE-2023-40932) allows [Cross-Site Scripting](https://outpost24.com/blog/cross-site-scripting-attacks-how-protect-against/) via the Custom Logo component, which will render on every page, including the login page. This may be used to read and modify page data, such as plain-text passwords from login forms.

All these vulnerabilities have been resolved as of 2023.09.11 and users are advised to upgrade to 5.11.2 or later.

## What is Nagios XI

Nagios XI is a popular and widely used commercial monitoring solution for IT infrastructure and network monitoring. It is the commercial version of the open-source Nagios Core monitoring platform, and provides added features to simplify the process of managing complex IT environments.

Due to the access required by Nagios XI, it is often deployed in high-privileged environments, which makes it an interesting asset for an attacker to target.

## The four vulnerabilities

### 1. SQL Injection in Banner acknowledging endpoint (CVE-2023-40931)

Nagios XI features “Announcement Banners”, which can optionally be acknowledged by users. The endpoint for this feature is vulnerable to a SQL Injection attack.

When a user acknowledges a banner, a POST request is sent to `/nagiosxi/admin/banner\_message-ajaxhelper.php` with the POST data consisting of the intended action and message ID – `action=acknowledge banner message&id=3`.

The ID parameter is assumed to be trusted but comes directly from the client without sanitization. This leads to a SQL Injection where an authenticated user with low or no privileges can retrieve sensitive data, such as from the `xi\_session` and `xi\_users` table containing data such as emails, usernames, hashed passwords, API tokens, and backend tickets.

This vulnerability does not require the existence of a valid announcement banner ID, meaning it can be exploited by an attacker at any time.

### 2. SQL Injection in Host/Service Escalation in CCM (CVE-2023-40934)

The Core Configuration Manager in Nagios XI allows an authenticated user with privilege to manage host escalations to perform arbitrary database queries through the `/nagiosxi/includes/components/ccm/index.php` endpoint.

The parameters `tfFirstNotif`, `tfLastNotif`, and `tfNotifInterval` are assumed to be trusted despite coming directly from the client through a POST request.

This vulnerability results in the same access to the database as the other SQL Injection vulnerabilities, but requires additional privileges compared to CVE-2023-40931.

### 3. SQL Injection in Announcement Banner Settings (CVE-2023-40933)

Nagios XI has an administrative page for Announcement Banner settings, which contains a SQL Injection vulnerability in the `/nagiosxi/admin/banner message-ajaxhelper.php` endpoint.

When performing the `update\_banner\_message\_settings` action on the affected endpoint, the `id` parameter is assumed to be trusted and is concatenated into a database query with no sanitization. This allows an attacker to modify the query.

Successful exploitation grants the same database access as the other two SQL Injection Vulnerabilities, but requires additional privileges compared to CVE-2023-40931.

### 4. Cross-Site Scripting in Custom Logo Component (CVE-2023-40932)

Nagios XI can be customized with a custom company logo, which will be displayed across the entire product. This includes the landing page, various administrative pages, and the login page.

Due to a cross-site scripting vulnerability in this feature, an attacker can inject arbitrary JavaScript which will evaluate in any users’ browser. This can be used to read and modify page data, as well as perform actions on behalf on the affected user. Furthermore, as this renders on the login page, plain-text credentials can be stolen from users’ browsers as they enter them.

## Disclosure timeline

We found and disclosed the vulnerabilities to Nagios in August 2023. Here’s what happened next:

* 2023-08-04 – Contacted vendor and submitted report
* 2023-08-04 – Vendor acknowledged report, started reviewing
* 2023-08-11 – Vendor confirmed all 4 vulnerabilities
* 2023-08-11 – Contacted MITRE for CVE allocation
* 2023-09-01 – CVEs reserved by MITRE
* 2923-09-07 – Coordinated disclosure for 2023-09-19
* 2023-09-11 – Nagios XI 5.11.2 released with security fixes applied
* 2023-09-19 – Vulnerabilities fully disclosed

## The importance of application security testing

In a targeted attack, these types of vulnerabilities are relatively easy to exploit. As recent attacks have demonstrated (most notably the SolarWinds hack), IT management platforms are also likely targets. Without continuous application security testing in place, critical business data is at risk. Test your applications in real-time for the latest vulnerabilities with [Outpost24’s Pen Testing as a Service (PTaaS) solution](https://outpost24.com/products/web-application-security-testing/). Our highly skilled and experienced pen testers will give you the most accurate view of your vulnerabilities including business logic errors and backdoors that automated scanners missed.

[Book your live PTaaS demo](https://outpost24.com/products/web-application-security-testing/#request-a-live-demo)
## About Ghost Labs

Ghost Labs is the specialist security unit within Outpost24 working in partnership with our clients to meet their penetration testing needs and objectives. Our experienced Offensive Security team offers enhanced and bespoke [penetration testing security services](https://outpost24.com/services/penetration-testing/) such as advanced network penetration testing, (web)application testing, Red Teaming assessments and complex web application exploitation to help organizations have a true picture of their cyber risk. In addition, the Ghost Labs team is an active contributor to the security community with vulnerability research and coordinated responsible disclosure program.

Ghost Labs performs hundreds of successful penetration tests for its customers ranging from global enterprises to SMEs. Our team consists of highly skilled ethical hackers, covering a wide range of advanced testing services to help companies keep up with evolving threats and new technologies. To help businesses drive security maturity and mitigate risks posed by the evolving threat and techniques of the modern-day hacker.

### About the Author

![Astrid Tedenbrant](//outpost24.com/wp-content/plugins/a3-lazy-load/assets/images/lazy_placeholder.gif)![Astrid Tedenbrant](https://outpost24.com/wp-content/uploads/2023/12/Astrid-Tedenbrant-author.png)
[Astrid Tedenbrant](https://outpost24.com/blog/authors/astrid-tedenbrant/)
Vulnerability Research Engineer, Outpost24

Astrid is a creative ethical hacker working as a Vulnerability Research Engineer at Outpost24. Her background as a web developer brings unique insights to the team in regards to web security, enabling her to report multiple CVEs in various products.

![](//outpost24.com/wp-content/plugins/a3-lazy-load/assets/images/lazy_placeholder.gif)![](https://outpost24.com/wp-content/uploads/2024/12/03-o24-color-n.svg)[Contact Us](/contact/)
#### Follow Us

[![Linkedin icon](//outpost24.com/wp-content/plugins/a3-lazy-load/assets/images/lazy_placeholder.gif)![Linkedin icon](https://outpost24.com/wp-content/uploads/2023/05/Social_Linkedin.webp)](https://www.linkedin.com/company/outpost24)

[![X/Twitter icon](//outpost24.com/wp-content/plugins/a3-lazy-load/assets/images/lazy_placeholder.gif)![X/Twitter icon](https://outpost24.com/wp-content/uploads/2023/12/x-social-media-white-round-icon.webp)](https://www.twitter.com/outpost24)

[![Youtube icon](//outpost24.com/wp-content/plugins/a3-lazy-load/assets/images/lazy_placeholder.gif)![Youtube icon](https://outpost24.com/wp-content/uploads/2023/05/Social_Youtube.webp)](https://www.youtube.com/user/Outpost24HQ)

[![Github icon](//outpost24.com/wp-content/plugins/a3-lazy-load/assets/images/lazy_placeholder.gif)![Github icon](https://outpost24.com/wp-content/uploads/2023/05/Social_Github.webp)](https://github.com/Outpost24)

#### PRODUCTS

* [Pricing](https://outpost24.com/pricing/)
* [Outscan NX](https://outpost24.com/products/risk-based-vulnerability-management/)
* [SWAT](https://outpost24.com/products/web-application-security-testing/)
* [Threat Compass](https://outpost24.com/products/cyber-threat-intelligence/)
* [Sweepatic](https://outpost24.com/products/external-attack-surface-management/)
  + [Sweepatic platform](https://platform.sweepatic.com/)
* [Specops Software (an Outpost24 company)](https://specopssoft.com/?utm_source=outpost24&utm_medium=referral&utm_campaign=global_outpost24&utm_content=navigation)

#### ABOUT US

* [Our Company](https://outpost24.com/company/)
* [Customers](/customers/)
* [Partners](https://outpost24.com/partners/)
* [Certifications](https://outpost24.com/certifications/)
* [Careers](https://careers.outpost24.com/)

#### LEGAL

* [Legal Information](https://outpost24.com/legal/)
* [Website Terms of Use](https://outpost24.com/legal/website-terms-of-use/)
* [Security and Policies](https://outpost24.com/policies/)
* [Privacy Statement](https://outpost24.com/policies/privacy-policy/)

© Outpost24 All rights reserved.

