```
{
  "vulnerability": {
    "root_cause": "The `dev->tstats` and `tun->security` allocations were not properly handled during errors in `register_netdevice()`. When `register_netdevice()` failed, the destructor `tun_free_netdev()` would be called which could lead to a double free of `tun->security` and `dev->tstats` if the allocations were already done in `tun_set_iff`",
    "weaknesses": [
      "Double free vulnerability"
    ],
    "impact": "A double-free vulnerability can lead to memory corruption and potentially arbitrary code execution.",
    "attack_vectors": "The vulnerability is triggered when there's an error in `register_netdevice()` function, which can be triggered by a variety of actions through `ioctl` calls on tun/tap devices.",
    "required_capabilities": "Attacker needs the ability to create and manipulate tun/tap devices via ioctl calls, and trigger a failure during the registration of the device. This could be achieved through crafted ioctl calls."
  },
  "resolution": "The fix moves the allocation of `dev->tstats` and `tun->security` to the new `ndo_init` routine `tun_net_init()` which is called by `register_netdevice()`. This ensures that these allocations are paired with the destructor `tun_free_netdev()`, preventing double frees if registration fails."
}
```