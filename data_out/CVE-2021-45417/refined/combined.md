=== Content from security.gentoo.org_c06ef7dc_20250108_120516.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# AIDE: Root Privilege Escalation â€” GLSA **202311-07**

A vulnerability has been found in AIDE which can lead to root privilege escalation.

### Affected packages

| Package | **app-forensics/aide** on all architectures |
| --- | --- |
| Affected versions | < **0.17.4** |
| Unaffected versions | >= **0.17.4** |

### Background

AIDE (Advanced Intrusion Detection Environment) is a file and directory integrity checker.
It creates a database from the regular expression rules that it finds from the config file(s). Once this database is initialized it can be used to verify the integrity of the files. It has several message digest algorithms (see below) that are used to check the integrity of the file. All of the usual file attributes can also be checked for inconsistencies.

### Description

A vulnerability has been discovered in AIDE. Please review the CVE identifier referenced below for details.

### Impact

AIDE before 0.17.4 allows local users to obtain root privileges via crafted file metadata (such as XFS extended attributes or tmpfs ACLs), because of a heap-based buffer overflow.

### Workaround

There is no known workaround at this time.

### Resolution

All AIDE users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-forensics/aide-0.17.4"

```
### References

* [CVE-2021-45417](https://nvd.nist.gov/vuln/detail/CVE-2021-45417)

**Release date**

November 25, 2023

**Latest revision**

November 25, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [831658](https://bugs.gentoo.org/show_bug.cgi?id=831658)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from www.debian.org_dfecd36d_20250108_120517.html ===


---

[[Date Prev](msg00016.html)][[Date Next](msg00018.html)]
[[Thread Prev](msg00016.html)][[Thread Next](msg00018.html)]
[[Date Index](maillist.html#00017)]
[[Thread Index](threads.html#00017)]

# [SECURITY] [DSA 5051-1] aide security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5051-1] aide security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Thu, 20 Jan 2022 18:24:59 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1nAc7H-0002hD-FH%40seger.debian.org)Â [E1nAc7H-0002hD-FH@seger.debian.org](msg00017.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5051-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
January 20, 2022                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : aide
CVE ID         : CVE-2021-45417

David Bouman discovered a heap-based buffer overflow vulnerability in
the base64 functions of aide, an advanced intrusion detection system,
which can be triggered via large extended file attributes or ACLs. This
may result in denial of service or privilege escalation.

For the oldstable distribution (buster), this problem has been fixed
in version 0.16.1-1+deb10u1.

For the stable distribution (bullseye), this problem has been fixed in
version 0.17.3-4+deb11u1.

We recommend that you upgrade your aide packages.

For the detailed security status of aide please refer to its security
tracker page at:
<https://security-tracker.debian.org/tracker/aide>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmHpqF1fFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0R6uxAAohkCxTNn/+/sf9ywHCqNq0fcygIsqFvY1K9pvXu9goQHei088JyYtcf7
XiUZIqz1EQWlu02lAJmUlOk1VOpe/A9n39jSC9CghWyhAI1WLArM2vM+XV22MRDB
mXB1ncaQsOT/9wpcPHx1P2m7esRZ50LWKF1fllF0aufF/LLrqihfKapuWXa1CG8t
DVd8yLfnoNvtj4LMvPpziyrwPBeVFlFT2n3NGa5MtpUBmf6y2n+N85wm5I1n1NQf
cuHJ6BryLTSZAxT9VJaTetoErxVK3QhWh2jmP6AEKCUn5KsX1pX6NWhpa5eMhBF0
86b+rQaLAbCj6Qdm/pEPCgGCq/EzzMt6rztF68BDmkoVNR2reA4PCQy7KwWUq0o1
HUPaAhbJDAr46iG/45/NuVPA/5Z//VZOsUqBMyIhWQR/EwM3HczVNMmyTrTZaZAA
aiePsIzqqECkGZMquFRTPpe8wLKAfckYq3rkCnXx35SWWSiG+UGJA/rVV7R73gm3
FdlaCap7RGE7OiDAU8YPrUgvnht+6hJjnpUVtoP66WSzURk5Gx6L5Kd8eM/4265k
Tu8qI9FzfR5XDhqgHPB0siImGKq6iedngo/NJundUPQ6+NQpKTmkJ/yPZ+wDaO6U
k5UH+wknjv6/nzJM6KxyvECiYtKylzSrPynoimGvt/DedY+35cs=
=yndN
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_dcfc3f3d_20250108_120517.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <YemPSkQtnUCflmaH@sulfur.vonhaugwitz.com>
Date: Thu, 20 Jan 2022 17:35:22 +0100
From: Hannes von Haugwitz <hannes@...haugwitz.com>
To: oss-security@...ts.openwall.com
Subject: CVE-2021-45417 - aide (>= 0.13 <= 0.17.3): heap-based buffer
 overflow vulnerability in base64 functions

Summary
=======

David Bouman discovered a heap-based buffer overflow vulnerability in base64
functions of AIDE, an advanced intrusion detection system. An attacker could
crash the program and possibly execute arbitrary code through large (<16k)
extended file attributes or ACL. A local user might exploit this flaw for root
privilege escalation.

Project
=======

AIDE (<https://aide.github.io>)

Affected versions
=================

AIDE >= 0.13, <= 0.17.3

CVE ID
======

CVE-2021-45417

Proof of concept
================

To take advantage of the flaw the user needs write access to a mounted file
system that supports large enough extended attributes (e.g. XFS) or ACL (e.g.
tmpfs).

AIDE needs to be compiled with --with-xattr or --with-posix-acl configure flag
(this is the case for most distributions).

# extended attributes on XFS filesystem

    $ touch user-file; xattr -w user.comment "$(for i in {1..40000} ; do printf '%c' A ; done)" user-file
    # aide --config=/dev/null --after "$(pwd)/user-file xattrs" --after "database_out=file:/dev/null" --init

# ACL on tmpfs file system

    $ touch user-file; for i in {1000..2000} ; do setfacl -m u:${i}:r user-file ; done
    # aide --config=/dev/null --after "$(pwd)/user-file acl" --after "database_out=file:/dev/null" --init

Analysis
========

The vulnerability is caused by a fixed buffer size (16384 in
src/base64.h[base.h]) in the encode_base64/decode_base64 functions[base64.c].
Initially this was safe as the base64 functions were only used for
encoding/decoding of the calculated hashsums. However since the addition of
extended file attribute and ACL support in AIDE 0.13 encode_base64 is also used
for encoding xattr and ACL values before writing them to the database.

This allows a user to create a file with a large extended attribute value or
large ACL causing aide (ussaly triggered by cron as root) to segfault.

The issue is fixed by precalculating the size of the return buffer depending on
the input in the encode_base64/decode_base64 functions.

[base64.h] <https://github.com/aide/aide/blob/v0.17.3/include/base64.h#L38>
[base64.c] <https://github.com/aide/aide/blob/v0.17.3/src/base64.c>

Mitigation
==========

Upgrade to AIDE v0.17.4 (only containing the fix for this issue) [v0.17.4]

Alternatively apply one of the provided patches:

aide-0.17-cve-2021-45417.patch: patch for 0.17.x
aide-0.16-cve-2021-45417.patch: patch for 0.16.x (backported for Debian oldstable)

Though not tested the patch for 0.16.x might also apply for earlier releases < 0.16.

If you cannot upgrade, consider removing `acl` and `xattrs` groups from rules
matching files on affected file systems.

[v0.17.4] <https://github.com/aide/aide/releases/tag/v0.17.4>

Credit
======

The issue was reported by David Bouman.

View attachment "[aide-0.16-cve-2021-45417.patch](3/1)" of type "text/x-diff" (3034 bytes)

View attachment "[aide-0.17-cve-2021-45417.patch](3/2)" of type "text/x-diff" (3164 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lists.debian.org_03ae04b6_20250108_120516.html ===


---

[[Date Prev](msg00023.html)][[Date Next](msg00025.html)]
[[Thread Prev](msg00023.html)][[Thread Next](msg00025.html)]
[[Date Index](maillist.html#00024)]
[[Thread Index](threads.html#00024)]

# [SECURITY] [DLA 2894-1] aide security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2894-1] aide security update
* *From*: Utkarsh Gupta <utkarsh@debian.org>
* *Date*: Tue, 25 Jan 2022 06:54:04 +0530
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/CAPP0f96oSHrOoDrQUY3_2UhdeS14ZL9EOTMKUZ8Ec_cXB_Bbow%40mail.gmail.com)Â [CAPP0f96oSHrOoDrQUY3\_2UhdeS14ZL9EOTMKUZ8Ec\_cXB\_Bbow@mail.gmail.com](msg00024.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -----------------------------------------------------------------------
Debian LTS Advisory DLA-2894-1              debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Utkarsh Gupta
January 24, 2022                            <https://wiki.debian.org/LTS>
- -----------------------------------------------------------------------

Package        : aide
Version        : 0.16-1+deb9u1
CVE ID         : CVE-2021-45417

David Bouman discovered a heap-based buffer overflow vulnerability in
the base64 functions of aide, an advanced intrusion detection system,
which can be triggered via large extended file attributes or ACLs. This
may result in denial of service or privilege escalation.

For Debian 9 stretch, this problem has been fixed in version
0.16-1+deb9u1.

We recommend that you upgrade your aide packages.

For the detailed security status of aide please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/aide>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEbJ0QSEqa5Mw4X3xxgj6WdgbDS5YFAmHvUQEACgkQgj6WdgbD
S5b5cxAAlB9TjFDs1rHpXctYi9ntYAdx17t6hSVFdDCW6XBGLFRv2vM8xoWFIuT5
YpGnOTZD+/jarF3NzHs2KvNgk1x4/pL6VaLeAcBVOQauES6JUdjiwNKDy/SWYX5S
t4a3nBfD020jPQ5+uVM3gjIjl1ONdeTl/ODMOaLy+/GKVvbNRVw0hMS/Fr3RVwMM
InV2t2meanAWpR5+iOD2u+P8NKAAJUy2/bSvVNdmK3wUPE3Ic3oVuyiVQsUl7uoe
oSTRQt0Xh1Voy6YVQwUzw7C85ZA/nO3xYmLGg4tr91VD5NUoBQ4VqAMb6TvurZAw
LV0Fu2WRcuaq2ghYfkdwOhphT3WXEXSAexYZFMjqLVa/ZC64INi55W6kNgDAjfvN
/3IbZ/s6Gn3MpAeqkrUg8Zkyv8Y+zhWQCn0GUsRqUso++it62DBXQK1mLwLvbR8+
d52i9dXQyiemsCdBO262/agsKJZKoUGlRzU3UlWxT4P7Gu4kvKLR7m1k+zVLygka
+x9AtjWnj/ceOCAwaamo1H41HI3ZDOcNZKwrLpLF85C696j3M7zlz5u3zZFL+DB7
12rvHU2DG+Ka3lOqTfd5mLt7dDEYebrte+2Ea5iTSo6pNeGrUrnqF6yulb2LHVdK
jqbk9opFG6IawFxywLzmsqn8crPz9t+nHvejvV7uhqI6bK4UZJk=
=JClW
-----END PGP SIGNATURE-----

```

---



=== Content from www.ipi.fi_7d7a5050_20250108_120517.html ===

# [Aide] CVE-2021-45417 - aide (>= 0.13 <= 0.17.3): heap-based buffer overflow vulnerability in base64 functions

**Hannes von Haugwitz**
hannes at vonhaugwitz.com

*Thu Jan 20 16:18:00 EET 2022*

* Next message: [[Aide] AIDE 0.17.4 security release](001714.html)
* **Messages sorted by:**
  [[ date ]](date.html#1713)
  [[ thread ]](thread.html#1713)
  [[ subject ]](subject.html#1713)
  [[ author ]](author.html#1713)

---

```
Summary
=======

David Bouman discovered a heap-based buffer overflow vulnerability in base64
functions of AIDE, an advanced intrusion detection system. An attacker could
crash the program and possibly execute arbitrary code through large (<16k)
extended file attributes or ACL. A local user might exploit this flaw for root
privilege escalation.

Project
=======

AIDE (<https://aide.github.io>)

Affected versions
=================

AIDE >= 0.13, <= 0.17.3

CVE ID
======

CVE-2021-45417

Proof of concept
================

To take advantage of the flaw the user needs write access to a mounted file
system that supports large enough extended attributes (e.g. XFS) or ACL (e.g.
tmpfs).

AIDE needs to be compiled with --with-xattr or --with-posix-acl configure flag
(this is the case for most distributions).

# extended attributes on XFS filesystem

    $ touch user-file; xattr -w user.comment "$(for i in {1..40000} ; do printf '%c' A ; done)" user-file
    # aide --config=/dev/null --after "$(pwd)/user-file xattrs" --after "database_out=file:/dev/null" --init

# ACL on tmpfs file system

    $ touch user-file; for i in {1000..2000} ; do setfacl -m u:${i}:r user-file ; done
    # aide --config=/dev/null --after "$(pwd)/user-file acl" --after "database_out=file:/dev/null" --init

Analysis
========

The vulnerability is caused by a fixed buffer size (16384 in
src/base64.h[base.h]) in the encode_base64/decode_base64 functions[base64.c].
Initially this was safe as the base64 functions were only used for
encoding/decoding of the calculated hashsums. However since the addition of
extended file attribute and ACL support in AIDE 0.13 encode_base64 is also used
for encoding xattr and ACL values before writing them to the database.

This allows a user to create a file with a large extended attribute value or
large ACL causing aide (ussaly triggered by cron as root) to segfault.

The issue is fixed by precalculating the size of the return buffer depending on
the input in the encode_base64/decode_base64 functions.

[base64.h] <https://github.com/aide/aide/blob/v0.17.3/include/base64.h#L38>
[base64.c] <https://github.com/aide/aide/blob/v0.17.3/src/base64.c>

Mitigation
==========

Upgrade to AIDE v0.17.4 (only containing the fix for this issue) [v0.17.4]

Alternatively apply one of the provided patches:

aide-0.17-cve-2021-45417.patch: patch for 0.17.x
aide-0.16-cve-2021-45417.patch: patch for 0.16.x (backported for Debian oldstable)

Though not tested the patch for 0.16.x might also apply for earlier releases < 0.16.

If you cannot upgrade, consider removing `acl` and `xattrs` groups from rules
matching files on affected file systems.

[v0.17.4] <https://github.com/aide/aide/releases/tag/v0.17.4>

Credit
======

The issue was reported by David Bouman.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: aide-0.16-cve-2021-45417.patch
Type: text/x-diff
Size: 3034 bytes
Desc: not available
URL: <<http://www.ipi.fi/pipermail/aide/attachments/20220120/7482ce11/attachment.patch>>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: aide-0.17-cve-2021-45417.patch
Type: text/x-diff
Size: 3163 bytes
Desc: not available
URL: <<http://www.ipi.fi/pipermail/aide/attachments/20220120/7482ce11/attachment-0001.patch>>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 659 bytes
Desc: not available
URL: <<http://www.ipi.fi/pipermail/aide/attachments/20220120/7482ce11/attachment.sig>>

```

---

* Next message: [[Aide] AIDE 0.17.4 security release](001714.html)
* **Messages sorted by:**
  [[ date ]](date.html#1713)
  [[ thread ]](thread.html#1713)
  [[ subject ]](subject.html#1713)
  [[ author ]](author.html#1713)

---

[More information about the Aide
mailing list](https://www.ipi.fi/mailman/listinfo/aide)



=== Content from www.openwall.com_f5437c6a_20250108_120516.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <YemPSkQtnUCflmaH@sulfur.vonhaugwitz.com>
Date: Thu, 20 Jan 2022 17:35:22 +0100
From: Hannes von Haugwitz <hannes@...haugwitz.com>
To: oss-security@...ts.openwall.com
Subject: CVE-2021-45417 - aide (>= 0.13 <= 0.17.3): heap-based buffer
 overflow vulnerability in base64 functions

Summary
=======

David Bouman discovered a heap-based buffer overflow vulnerability in base64
functions of AIDE, an advanced intrusion detection system. An attacker could
crash the program and possibly execute arbitrary code through large (<16k)
extended file attributes or ACL. A local user might exploit this flaw for root
privilege escalation.

Project
=======

AIDE (<https://aide.github.io>)

Affected versions
=================

AIDE >= 0.13, <= 0.17.3

CVE ID
======

CVE-2021-45417

Proof of concept
================

To take advantage of the flaw the user needs write access to a mounted file
system that supports large enough extended attributes (e.g. XFS) or ACL (e.g.
tmpfs).

AIDE needs to be compiled with --with-xattr or --with-posix-acl configure flag
(this is the case for most distributions).

# extended attributes on XFS filesystem

    $ touch user-file; xattr -w user.comment "$(for i in {1..40000} ; do printf '%c' A ; done)" user-file
    # aide --config=/dev/null --after "$(pwd)/user-file xattrs" --after "database_out=file:/dev/null" --init

# ACL on tmpfs file system

    $ touch user-file; for i in {1000..2000} ; do setfacl -m u:${i}:r user-file ; done
    # aide --config=/dev/null --after "$(pwd)/user-file acl" --after "database_out=file:/dev/null" --init

Analysis
========

The vulnerability is caused by a fixed buffer size (16384 in
src/base64.h[base.h]) in the encode_base64/decode_base64 functions[base64.c].
Initially this was safe as the base64 functions were only used for
encoding/decoding of the calculated hashsums. However since the addition of
extended file attribute and ACL support in AIDE 0.13 encode_base64 is also used
for encoding xattr and ACL values before writing them to the database.

This allows a user to create a file with a large extended attribute value or
large ACL causing aide (ussaly triggered by cron as root) to segfault.

The issue is fixed by precalculating the size of the return buffer depending on
the input in the encode_base64/decode_base64 functions.

[base64.h] <https://github.com/aide/aide/blob/v0.17.3/include/base64.h#L38>
[base64.c] <https://github.com/aide/aide/blob/v0.17.3/src/base64.c>

Mitigation
==========

Upgrade to AIDE v0.17.4 (only containing the fix for this issue) [v0.17.4]

Alternatively apply one of the provided patches:

aide-0.17-cve-2021-45417.patch: patch for 0.17.x
aide-0.16-cve-2021-45417.patch: patch for 0.16.x (backported for Debian oldstable)

Though not tested the patch for 0.16.x might also apply for earlier releases < 0.16.

If you cannot upgrade, consider removing `acl` and `xattrs` groups from rules
matching files on affected file systems.

[v0.17.4] <https://github.com/aide/aide/releases/tag/v0.17.4>

Credit
======

The issue was reported by David Bouman.

View attachment "[aide-0.16-cve-2021-45417.patch](3/1)" of type "text/x-diff" (3034 bytes)

View attachment "[aide-0.17-cve-2021-45417.patch](3/2)" of type "text/x-diff" (3164 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


