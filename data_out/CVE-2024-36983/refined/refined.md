Based on the provided content, here's a breakdown of CVE-2024-36983:

**Root Cause:**

*   The vulnerability stems from the use of a deprecated internal function, `runshellscript`, within scripted alert actions, in combination with external command lookups.

**Weaknesses/Vulnerabilities:**

*   **Command Injection:** Authenticated users can create external lookups that call the deprecated `runshellscript` function. This allows them to inject arbitrary code into the Splunk platform's installation directory.
*   **Insecure Use of Deprecated Function:** The `runshellscript` command, intended for internal use, is being exposed through external lookups.
*   **Lack of Input Sanitization:** The vulnerability implies that user-supplied input to the external lookup is not properly sanitized or validated before being used to construct commands executed on the system.

**Impact of Exploitation:**

*   **Arbitrary Code Execution (ACE):** Successful exploitation allows an attacker to execute arbitrary code on the Splunk platform instance, within a privileged context.
*   **System Compromise:** This could lead to complete system compromise, data loss, unauthorized data transfer, and other malicious activities.

**Attack Vectors:**

*   **Network:** The attack vector is network-based (AV:N).
*   **External Lookups:**  The vulnerability is triggered by creating a malicious external lookup.
*   **User Interaction (UI):** The attack requires user interaction (UI:R) as the attacker needs to configure the malicious external lookup.

**Required Attacker Capabilities/Position:**

*   **Authenticated Access:** The attacker needs to be an authenticated user with the ability to create external lookups (PR:L).
*   **Knowledge of Deprecated Function:** The attacker must be aware of the `runshellscript` function and how to call it using an external lookup.

**Additional Details:**
*   The vulnerability is rated as high severity (8.0) with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H.
*   The affected versions are Splunk Enterprise below 9.2.2, 9.1.5, and 9.0.10, and Splunk Cloud Platform versions below 9.1.2312.109 and 9.1.2308.207.
*   The provided detection query helps identify the usage of the vulnerable command `runshellscript` along with other risky commands such as `collect`, `delete` and `sendemail`.