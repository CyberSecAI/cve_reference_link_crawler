=== Content from www.wordfence.com_9932bdaf_20250111_162305.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Responsive Lightbox & Gallery <= 2.4.7 - Authenticated (Author+) Stored Cross-Site Scripting via File Upload

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Responsive Lightbox & Gallery <= 2.4.7 - Authenticated (Author+) Stored Cross-Site Scripting via File Upload

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-6870](https://www.cve.org/CVERecord?id=CVE-2024-6870) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | August 21, 2024 |
| Last Updated | August 22, 2024 |
| Researcher | [wesley (wcraft)](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/wesley-jhon) |

### Description

The Responsive Lightbox & Gallery plugin for WordPress is vulnerable to Stored Cross-Site Scripting via file uploads in all versions up to, and including, 2.4.7 due to insufficient input sanitization and output escaping affecting the rl\_upload\_image AJAX endpoint. This makes it possible for authenticated attackers, with Author-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses the 3gp2 file.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/responsive-lightbox/tags/2.4.7/includes/class-remote-library.php#L261)
* [wordpress.org](https://wordpress.org/plugins/responsive-lightbox/#developers)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3137531%40responsive-lightbox&new=3137531%40responsive-lightbox&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fresponsive-lightbox%2Fresponsive-lightbox-gallery-247-authenticated-author-stored-cross-site-scripting-via-file-upload&t=Responsive%20Lightbox%20%26%20Gallery%20%3C%3D%202.4.7%20-%20Authenticated%20%28Author%2B%29%20Stored%20Cross-Site%20Scripting%20via%20File%20Upload "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fresponsive-lightbox%2Fresponsive-lightbox-gallery-247-authenticated-author-stored-cross-site-scripting-via-file-upload&text=Responsive%20Lightbox%20%26%20Gallery%20%3C%3D%202.4.7%20-%20Authenticated%20%28Author%2B%29%20Stored%20Cross-Site%20Scripting%20via%20File%20Upload "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fresponsive-lightbox%2Fresponsive-lightbox-gallery-247-authenticated-author-stored-cross-site-scripting-via-file-upload "LinkedIn")
Email

## Vulnerability Details for Responsive Lightbox & Gallery

#### [Responsive Lightbox & Gallery](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/responsive-lightbox)

| Software Type | Plugin |
| --- | --- |
| Software Slug | responsive-lightbox [(view on wordpress.org)](https://wordpress.org/plugins/responsive-lightbox) |
| Patched? | Yes |
| Remediation | Update to version 2.4.8, or a newer patched version |
| Affected Version | * <= 2.4.7 |
| Patched Version | * 2.4.8 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from wordpress.org_95c17aca_20250111_162304.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Responsive Lightbox & Gallery

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fresponsive-lightbox&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fresponsive-lightbox&locale=en_US)

Search plugins

![](https://ps.w.org/responsive-lightbox/assets/banner-772x250.jpg?rev=1872740)
![](https://ps.w.org/responsive-lightbox/assets/icon-256x256.png?rev=1872740)
# Responsive Lightbox & Gallery

By [dFactory](http://www.dfactory.co/)

[Download](https://downloads.wordpress.org/plugin/responsive-lightbox.2.4.9.zip)

* [Details](https://wordpress.org/plugins/responsive-lightbox/#description)
* [Reviews](https://wordpress.org/plugins/responsive-lightbox/#reviews)
* [Installation](https://wordpress.org/plugins/responsive-lightbox/#installation)
* [Development](https://wordpress.org/plugins/responsive-lightbox/#developers)

[Support](https://wordpress.org/support/plugin/responsive-lightbox/)

## Description

#### Everything You Need in a WordPress Gallery Plugin

[Responsive Lightbox and Gallery plugin](http://www.dfactory.co/products/responsive-lightbox/?utm_source=repo&utm_medium=link&utm_campaign=responsive-lightbox-plugin-free) is a fully fledged WordPress gallery plugin with a powerful Drag & Drop Gallery Builder and Lightbox functionality that’s used daily by more than 300,000 active users and downloaded over 3 Million times.

The beauty of it is how easy it is for you to customize it and enhance its features thanks to [free and premium extensions](?utm_source=repo&utm_medium=link&utm_campaign=responsive-lightbox-plugin-free).

#### Why You Should Use Responsive Lightbox and Gallery Plugin

#### Easiest Gallery Builder

Say goodbye to coding. With the built-in drag and drop Gallery builder, you will be able to create beautiful galleries, customize them, and add your preferred styles in minutes.

#### Vast Customization Options

Responsive Lightbox and Gallery plugin is packed with customization options per each gallery and lightbox style so you can tweak them to suit your website’s audience with just a few clicks.

#### SEO-Friendly and Lightweight

Responsive Lightbox and Gallery plugin is built keeping SEO and performance in mind, making it lightweight and fast when it comes to page load.

#### Premium Extensions

Looking to provide a premium experience to your visitors? Responsive Lightbox and Gallery plugin offers plenty of premium extensions to provide you with even more flexibility and customization options.

Need more reasons? [Check them out here](http://www.dfactory.co/products/responsive-lightbox/?utm_source=repo&utm_medium=link&utm_campaign=responsive-lightbox-plugin-free)!

#### What some of our 300,000+ active users say about Responsive Lightbox and Gallery plugin

> Amazing Gallery plugin!
>
> Versatile and powerful for both sliders and galleries, many features and style options.
>
> Really easy to use. Takes all the fiddling out of the process of creating a responsive gallery/lightbox.
>
> I needed a lightbox plugin that works reliably. This marvelous plugin does the magic. Now I can spend more on my photography and less time customizing WordPress.
>
> This plugin is quite flexible and effective. The functionality choices are broad and all quite easy to configure.

#### Need more galley options?

Responsive Lightbox and Gallery plugin can be extended with our [premium extensions](?utm_source=repo&utm_medium=link&utm_campaign=responsive-lightbox-plugin-free):

**Premium Extensions:**

> [Photo & Art bundle](http://www.dfactory.co/products/photo-art-bundle/)
>
> [Justified Gallery](http://www.dfactory.co/products/justified-gallery/)
>
> [Expander Gallery](http://www.dfactory.co/products/expander-gallery/)
>
> [Hidden Gallery](http://www.dfactory.co/products/hidden-gallery/)
>
> [Masonry Image Gallery](http://www.dfactory.co/products/masonry-gallery-pro/)
>
> [Slider Gallery](http://www.dfactory.co/products/slider-gallery/)
>
> [Lightcase Lightbox](http://www.dfactory.co/products/lightcase-lightbox/)
>
> [PhotoSwipe Lightbox](http://www.dfactory.co/products/photoswipe-lightbox/)
>
> [Lightgallery Lightbox](http://www.dfactory.co/products/lightgallery-lightbox/)
>
> [Strip Lightbox](http://www.dfactory.co/products/strip-lightbox/)
>
> [Fancybox Pro](http://www.dfactory.co/products/fancybox-pro/)
>
> [Lightbox Comments](http://www.dfactory.co/products/lightbox-comments/)

#### Full Feature List

* Powerful and easy-to-use gallery builder
* 3 beautiful gallery templates – Grid, Slider and Masonry
* 7 responsive lightbox scripts (SwipeBox, prettyPhoto, Nivo Lightbox, Image Lightbox, Tos “R” Us, Featherlight, Magnific Popup)
* Create galleries from Media Library or Post attached images
* Media Folders with a drag & drop interface
* Access to millions of images through Remote Library
* Option to import remote images to Media Library
* Gutenberg editor compatibility
* Iframe, Ajax, HTML5 and Inline lightbox content support
* Advanced pagination, incl. AJAX and infinite scroll
* Automatically add lightbox to WordPress image galleries
* Automatically add lightbox to WordPress image links
* Automatically add lightbox to WordPress video links (YouTube, Vimeo)
* Automatically add lightbox to widgets content
* Automatically add lightbox to WordPress comments content
* WooCommerce product gallery support
* Popular Page builders compatibility
* Gallery widget
* Single image widget
* Option to display single post images as a gallery
* Option to modify native WP gallery links image size
* Option to set gallery images title from image title, caption, alt or description
* Option to force lightbox for custom WP gallery replacements like Jetpack tiled galleries
* Option to trigger lightbox on custom jquery events
* Option to conditionally load scripts and styles only on pages that have images or galleries in post content
* Highly customizable settings for each of the lightbox scripts
* Highly customizable settings for each gallery
* Multisite support
* .pot file for translations included

## Screenshots

* [![](https://ps.w.org/responsive-lightbox/assets/screenshot-1.jpg?rev=1869920)](https://ps.w.org/responsive-lightbox/assets/screenshot-1.jpg?rev=1869920)

  screenshot-1.png
* [![](https://ps.w.org/responsive-lightbox/assets/screenshot-2.png?rev=1869920)](https://ps.w.org/responsive-lightbox/assets/screenshot-2.png?rev=1869920)

  screenshot-2.jpg
* [![](https://ps.w.org/responsive-lightbox/assets/screenshot-3.png?rev=1869920)](https://ps.w.org/responsive-lightbox/assets/screenshot-3.png?rev=1869920)
* [![](https://ps.w.org/responsive-lightbox/assets/screenshot-4.jpg?rev=1869920)](https://ps.w.org/responsive-lightbox/assets/screenshot-4.jpg?rev=1869920)

## Blocks

This plugin provides 2 blocks.

* Gallery
* Remote Library Image

## Installation

1. Install Responsive Lightbox either via the WordPress.org plugin directory, or by uploading the files to your server
2. Activate the plugin through the ‘Plugins’ menu in WordPress
3. Go to the Responsive Lightbox settings and set your desired options.

## FAQ

### Who is Responsive Lightbox & Gallery for?

Responsive Lightbox and Gallery is the perfect solution for anyone who wants to create incredibly beautiful responsive galleries with images and/or videos with lightbox effect. This means bloggers, photographers, designers can choose from one of the many layouts available and publish their gallery in minutes.

### Do I need coding skills to use this plugin?

Thanks to the built-in gallery builder, anyone can create a professional responsive gallery and take advantage of the many layouts and styles. Know how to code? You can adjust the plugin to meet your requirements.

### What’s the Photo & Art Bundle?

Many users love to have different ways to customize their galleries. This bundle gives you access to all our premium extensions, 1-year direct support and all updates, at a hugely discounted price (70% off). [Learn more here](http://www.dfactory.co/products/photo-art-bundle/?utm_source=repo&utm_medium=link&utm_campaign=responsive-lightbox-plugin-free).

### Will this plugin slow down my site?

Responsive Lightbox and Gallery plugin is a lightweight WordPress gallery plugin built with performance and speed in mind. This means your page load time won’t be affected.

### How can I get the most of this plugin?

Responsive Lightbox and Gallery plugin comes with plenty of documentation to guide you while creating and customizing your galleries. On top of that, you’ll find plenty of articles on how to add the lightbox effect, how to use the gallery builder, and much more! Need to fix a specific issue? Share it on our forum and get the answer you need!

### I need a specific style, layout or effect for my galleries. What should I do?

Responsive Lightbox and Gallery plugin comes with many styles and effects already in it’s free version and can be enhanced with 10+ premium extensions like Masonry Gallery Pro, Hidden Gallery, Slider Gallery, and many more. [Check them all out here](http://www.dfactory.co/products/responsive-lightbox-gallery-extensions/?utm_source=repo&utm_medium=link&utm_campaign=responsive-lightbox-plugin-free) and pick your preferred one!

## Reviews

![](https://secure.gravatar.com/avatar/9291567f4b12aa2ccf4fa01c95536b20690cdbccaa350b90770bf7fb4cf2d6cd?s=60&d=retro&r=g)
### [good](https://wordpress.org/support/topic/good-8732/)

[frankcasarii](https://profiles.wordpress.org/frankcasarii/ "Posts by frankcasarii")
January 6, 2025

good plugin

![](https://secure.gravatar.com/avatar/8d3cafdf6dbda7fbe023d7d4b79ce8c571b9b3ca83c66dbc1da25dd74f37ce94?s=60&d=retro&r=g)
### [Does the job](https://wordpress.org/support/topic/does-the-job-1041/)

[philippe11](https://profiles.wordpress.org/philippe11/ "Posts by philippe11")
November 27, 2024

A free plugin, which allows honest unlocked features. Pity that it doesn’t also provide carousel sliders, but other plugins make that.

![](https://secure.gravatar.com/avatar/11f2f719bd420c813adda794639a928592c0aca1ea87425691cf824d86f2d967?s=60&d=retro&r=g)
### [Very simple but powerful Tool](https://wordpress.org/support/topic/very-simple-but-powerful-tool/)

[searchhook](https://profiles.wordpress.org/searchhook/ "Posts by searchhook")
November 27, 2024

Very simple but powerful Tool! In simple words, that works!

![](https://secure.gravatar.com/avatar/acd98b2de1815c7f054ed4ac215fe6ecd2187ba478b0f1b0e253f1503e8998b4?s=60&d=retro&r=g)
### [Not supported anymore](https://wordpress.org/support/topic/not-supported-anymore-18/)

[mbdNnse](https://profiles.wordpress.org/rider7991/ "Posts by mbdNnse")
November 18, 2024

This plugin have +5 months old bugs and no one fixes these

![](https://secure.gravatar.com/avatar/097fb8681a08b2f962d218d8a8d00d5c4ca1551262ec5609f9cbb577bb95c01d?s=60&d=retro&r=g)
### [Sehr schönes Tool, bin sehr zufrieden!](https://wordpress.org/support/topic/sehr-schones-tool-bin-sehr-zufrieden/)

[hhaberscheidt](https://profiles.wordpress.org/hhaberscheidt/ "Posts by hhaberscheidt")
October 25, 2024

Verhält sich genau so wie erhofft.
Besten Dank!

![](https://secure.gravatar.com/avatar/2ad440846a2daf62385ea3df907b2ef402ddbbe7d8141037f9044928fb357b3d?s=60&d=retro&r=g)
### [really bad](https://wordpress.org/support/topic/really-bad-29/)

[vinciego](https://profiles.wordpress.org/vinciego/ "Posts by vinciego")
October 24, 2024

There are so many better plugin. It’s bugging on Twenty Twenty Three. Responsiveness is broken > change ratio of pictures. Not handling bloc gutenberg…

[Read all 1,959 reviews](https://wordpress.org/support/plugin/responsive-lightbox/reviews/)
## Contributors & Developers

“Responsive Lightbox & Gallery” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/3873a6a64e5bcd1609cbd66b3643b35b9bf368c31de681fa450e4ca0fa106325?s=32&d=mm&r=g) [dFactory](https://profiles.wordpress.org/dfactory/)

“Responsive Lightbox & Gallery” has been translated into 12 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/responsive-lightbox/contributors) for their contributions.

[Translate “Responsive Lightbox & Gallery” into your language.](https://translate.wordpress.org/projects/wp-plugins/responsive-lightbox)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/responsive-lightbox/), check out the [SVN repository](https://plugins.svn.wordpress.org/responsive-lightbox/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/responsive-lightbox/) by [RSS](https://plugins.trac.wordpress.org/log/responsive-lightbox/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 2.4.9

* Fix: Potential XSS vulnerability related to Featherlight lightbox
* Fix: Removed the vulnerable Fancybox 3.x script

#### 2.4.8

* Fix: Flushing rewrite rules
* Fix: Uploading remote library images
* Fix: Potential XSS vulnerability related to Magnific Popup
* Tweak: Updated Magnific Popup to 1.2.0

#### 2.4.7

* Fix: Unauthorized access to private rl\_gallery shortcodes

#### 2.4.6

* Fix: Editing folder names
* Tweak: Updated jsTree to 3.3.16

#### 2.4.5

* New: WordPress 6.2 compatibility
* New: PHP 8.2 compatibility
* Fix: Rendering media providers in settings
* Fix: Assigning terms to media folders
* Fix: Getting galleries for post-new.php pages
* Fix: Displaying legacy gallery and image widgets
* Fix: Getting colors for media folders (Undefined array key 3 in includes\class-folders.php)
* Tweak: Updated jsTree to 3.3.14

#### 2.4.4

* Fix: Improved sanitization and validation
* Fix: Displaying legacy gallery and image widgets
* Fix: Assigning terms to media folders
* Fix: Issue getting colors for media folders
* Fix: Automatic conversion of false to array deprecated

#### 2.4.3

* Fix: General sanitization and validation overhaul
* Fix: Displaying legacy gallery and image widgets
* Fix: Getting colors for media folders
* Fix: Assigning terms to media folders

#### 2.4.2

* Fix: Potential XSS vulnerabilities related to settings validation
* Fix: Missing image alt attribute
* Fix: Undefined array key “type”
* Fix: Possible invalid data passed to attachment\_url\_to\_postid function

#### 2.4.1

* Fix: WooCommerce product gallery
* Fix: WooCommerce gallery lightbox

#### 2.4.0

* New: WordPress 6.0 compatibility
* New: HTML5 Media Library videos support (with Lightgallery, Fancybox Pro and Lightcase lightboxes)
* New: Embed Youtube & Vimeo videos support (with Lightgallery, Fancybox Pro and Lightcase lightboxes)
* New: [Lightbox Comments](http://www.dfactory.co/products/lightbox-comments/) extension
* New: WP Gallery block support
* New: WP Image block support

#### 2.3.5

* Fix: Insert gallery double preview
* Tweak: Display of horizontal / vertical igallery images
* Tweak: Improved gallery images loading performance
* Tweak: Add gallery number of images displayed

#### 2.3.4

* New: WordPress 5.9 compatibility
* Fix: Adding new images to existing galleries
* Fix: Ajax gallery pagination
* Fix: Infinite scroll issues with Masonry gallery
* Fix: Edge case PHP Fatal error
* Fix: WP Media grid view folders not updating
* Fix: Gallery shortcode not selecting
* Fix: Deprecated events: DOMNodeInserted, DOMNodeRemoved in front.js
* Fix: Deprecated event: DOMNodeInserted in admin-galleries.js
* Fix: Uncaught Error: Call to undefined method Responsive\_Lightbox\_Galleries::get\_active\_providers()

#### 2.3.3

* Fix: Invalid argument in upgrader process
* Fix: Widgets warning in WordPress 5.8
* Fix: Warning in wp\_localize\_script usage

#### 2.3.2

* Fix: Add option to enable/disable advanced capability management
* Fix: Insert gallery into post not working in Gutenberg editor
* Fix: Remove “ready” deprecated event from front.js
* Fix: array\_combine() function error class-folders.php
* FIx: $.uniqueSort is not a function error

#### 2.3.1

* Fix: Plugin capabilities not granted properly

#### 2.3.0

* New: WordPress 5.6 compatibility
* New: Capabilities management
* New: Admin breadcrumb navigation

#### 2.2.3

* Fix: Media Folders js and CSS issues in Media Library
* Fix: Empty src attribute in Remote Library inserted images
* Tweak: Remove featured image thumbnail from Media Library access

#### 2.2.2

* Fix: Add Media button not working for custom post types
* Fix: Underscore.js dependency missing
* Fix: Undefined variable: current\_color\_scheme
* Fix: Root Folder missing in media upload dropdown

#### 2.2.1

* Fix: Invalid arguments passed in class-folders.php

#### 2.2.0

* New: Introducing Remote Library feature
* New: Gutenberg editor compatibility
* Tweak: PHP 7.3 support

#### 2.1.0

* New: Introducing Media Library Folders
* New: Media folder gallery type
* New: Filter gallery by category
* Fix: Ajax Pagination not working when logged out
* Fix: CSS issues with multiple Basic grid galleries on one page
* Fix: Removed call to a sanitize\_field function

#### 2.0.5

* Fix: Escaped characters on titles and descriptions
* Fix: Gallery shortcode not accepting image order
* Fix: Gallery using default parameters instead of the settings
* Fix: PHP fatal error if gallery builder is disabled

#### 2.0.4

* Fix: Gallery sorting and orderby not working
* Fix: Slow db query on post edit screen
* Fix: WooCommerce gallery undefined method for get\_gallery\_image\_ids
* Fix: Uncaught Argument in preview\_post\_link function
* Fix: Removed a callback to sanitize\_textarea\_field

#### 2.0.3

* Fix: Gallery shortcode thumbnails not accepting size parameter
* Fix: Basic templates for WooCommerce gallery

#### 2.0.2

* Fix: Default WordPress gallery issue

#### 2.0.1

* Fix: Syntax error in frontend.php on line 522

#### 2.0

* New: Powerful gallery builder
* New: 3 gallery templates – Basic Grid, Slider and Masonry
* New: Magnific Popup lightbox
* New: Iframe, Ajax, HTML5 and Inline lightbox content support
* Tweak: Improved Visual Composer compatibility
* Tweak: Revamped admin interface

#### 1.7.1

* New: Tos “R” Us overlay close option
* Fix: License activation issues
* Tweak: Featherlight script update to 1.7.0
* Tweak: Imagelightbox script update

#### 1.7.0

* New: Add lightbox to widgets content
* New: Add lightbox to WordPress comments
* New: Gallery widget
* New: Single image widget
* New: Visual Composer compatibility
* New: WooCommerce 3.0 compatibility
* New: [Fancybox Pro](http://www.dfactory.co/products/fancybox-pro/) premium extension
* New: [Expander Gallery](http://www.dfactory.co/products/expander-gallery/) premium extension
* New: [Hidden Gallery](http://www.dfactory.co/products/hidden-gallery/) premium extension
* Tweak: Attachment ID query optimization
* Tweak: Revamped lightbox settings screen
* Tweak: Improved custom galleries compatibility

#### 1.6.12

* Fix: WooCommerce single product image lightbox

#### 1.6.11

* Tweak: Added plugin documentation link
* Tweak: Nivo lightbox update to 1.3.1

#### 1.6.10

* New: Featherlight lightbox script
* New: [Lightgallery Lightbox](http://www.dfactory.co/products/lightgallery-lightbox/) premium extension
* New: [Slider Gallery](http://www.dfactory.co/products/slider-gallery/) premium extension

#### 1.6.9

* New: [PhotoSwipe Lightbox](http://www.dfactory.co/products/photoswipe-lightbox/) premium extension
* Fix: data-rel attribute missing in multiline links
* Tweak: Removed local translation files in favor of WP repository translations
* Tweak: SwipeBox script updated to 1.4.4

#### 1.6.8

* Tweak: Tos “R” Us script caption issue when empty link title
* Tweak: Undefined notice on extentions activation.

#### 1.6.7

* New: WooCommerce product gallery support
* New: [Masonry Image Gallery](http://www.dfactory.co/products/masonry-gallery-pro/) and [Strip Lightbox](http://www.dfactory.co/products/strip-lightbox/) extensions
* Tweak: Tos”R”Us script updated to 2.4.2
* Tweak: Settings handler improvements.

#### 1.6.6

* Tweak: Confirmed WordPress 4.4 compatibility

#### 1.6.5

* Fix: Lightbox activated on non-video youtube links
* Tweak: Added a way to change settings required capability

#### 1.6.4

* Tweak: prettyPhoto improvements for mobile devices

#### 1.6.3

* Fix: Tos”R”Us script initialized multiple times in Ajax
* Fix: Regex issue with replacing rel attribute
* Tweak: Swipebox updated to 1.4.1

#### 1.6.2

* New: Disable lightbox for single images with data-rel=”norl” attribute
* Tweak: Keep rel attribute intact if used in post content links
* Tweak: Vimeo regex improvements

#### 1.6.1

* Fix: prettyPhoto and Nivo gallery navigation broken
* Tweak: Added another way to close the extensions notification

#### 1.6.0

* New: Introducing [Justified Gallery](http://www.dfactory.co/products/justified-gallery/) and [Lightcase Lightbox](http://www.dfactory.co/products/lightcase-lightbox/) premium extensions.
* New: Option to set single images title from image title, caption, alt or description
* Tweak: Confirmed WP 4.3 compatibility

#### 1.5.8

* Tweak: Switched to protocol independent URLs in Nivo and Tosrus

#### 1.5.7

* New: Romanian translation, thanks to [Victor Chiritoiu](http://contacter.ro)
* Fix: Tos “R” Us pagination thumbnails and pause on hover settings not working
* Tweak: Scripts and styles versioning, for better cache handling
* Tweak: French translation updated

#### 1.5.6

* New: Option to conditionally load scripts and styles only on pages that have images or galleries in post content.

#### 1.5.5

* Tweak: Multiple backward rel attribute compatibility tweaks
* Fix: Nivo lightbox and Image lightbox js attr errors when no data-rel given
* Fix: Swipebox option to remove top and bottom bars

#### 1.5.4

* Tweak: Swipebox option to remove top and bottom bars on mobile devices
* Fix: Swipe support for Tos “R” Us lightbox script

#### 1.5.3

* Fix: Nivo lightbox buttons and styles missing

#### 1.5.2

* New: Tos “R” Us lightbox script
* Fix: Final fix for video links regex (hopefully)
* Tweak: Switched from rel to data-rel attribute to avoid W3C validation errors
* Tweak: Optimized gallery image size function

#### 1.5.1

* Tweak: Support for multiple custom galleries per page (via gallery-n) in rel
* Fix: Boolean / subfields bug not saving settings properly
* Fix: Vimeo videos automatic lightbox not working when query parameters were not set

#### 1.5.0

* New: Revamped User Interface
* New: Option to force lightbox for custom WP gallery replacements like Jetpack tiled galleries

#### 1.4.14

* New: Option to set gallery images title from image title, caption, alt or description
* Tweak: Improved regex for Youtube video links

#### 1.4.13

* Fix: Reverted back the regex change in lightbox selector to gallery links

#### 1.4.12

* Fix: jQuery prettyPhoto DOM Cross-Site Scripting (XSS) vulnerability
* Tweak: Added regex filetype check before applying lightbox selector to gallery links.
* Tweak: Switched from wp\_generate\_password() to custom function, without needless DB call.

#### 1.4.11

* Tweak: Swipebox script updated to 1.3.0.2
* Tweak: prettyPhoto CSS tweaks
* Tweak: fancyBox IE patch

#### 1.4.10

* Tweak: Image Lightbox updated

#### 1.4.9

* New: Hungarian translation, thanks to [Zsolt Boda](http://cmfrt.net/)
* Tweak: Remove direct http calls from Javascript to improve https protocol compatibility

#### 1.4.8

* Tweak: Nivo Lightbox updated to 1.2
* Tweak: Confirmed WP 4.0 compatibility

#### 1.4.7

* New: Option to modify native WP gallery links image size
* New: Option to donate this plugin 🙂

#### 1.4.6

* New: Slovak translation, thanks to [Patrik Zec](http://patwist.com)

#### 1.4.5

* New: Russian translation, thanks to [Konstantin](http://l-konstantin.ru)

#### 1.4.4

* Fix: Prevent unintentional scroll to the top when pressing the “enter” key in the opened swipebox, thanks to Arno Welzel

#### 1.4.3

* New: Estonian translation, thanks to Hugo Amtmann
* Tweak: Swipebox script update, thanks to Arno Welzel

#### 1.4.2

* Fix: Final fix for IE scroll bug

#### 1.4.1

* Fix: Swipebox script files inconsistency

#### 1.4.0

* New: Added Image Lightbox script
* New: Option to load scripts in header or footer
* Tweak: Changed Swipebox script to custom built, thanks to Arno Welzel

#### 1.3.6

* New: Added rl\_lightbox\_args filter hook for embeddding different scripts based on any custom conditions (page, post, category, user id, etc.)

#### 1.3.5

* New: Dutch translation, thanks to [Sebas Blom](http://www.basbva.nl/)

#### 1.3.4

* Fix: Gallery images displayed as single images

#### 1.3.3

* New: Triggering lightbox on custom jquery events option
* Tweak: UI improvements for WP 3.8

#### 1.3.2

* New: German translation, thanks to Andreas Reitberger
* Tweak: Nivo Lightbox script updated

#### 1.3.1

* New: Spanish translation, thanks to Gaston
* Tweak: Japanese translation updated

#### 1.3.0

* New: Added Nivo Lightbox script
* New: Option to reset plugin settings to defaults

#### 1.2.3

* New: Serbo-Croatian translation, thanks to Borisa Djuraskovic

#### 1.2.2

* New: Option to force PNG icons in case of display problems
* Fix: Bug with video width not working in SwipeBox

#### 1.2.1

* New: Support for images loaded via AJAX
* Tweak: Updated Japanese translation

#### 1.2.0

* New: Added FancyBox script
* Tweak: UI enhancements for options
* Tweak: Better YouTube video handling (including https protocol)

#### 1.1.2

* New: Japanese translation, thanks to stranger-jp

#### 1.1.1

* Tweak: UI enhancements for prettyPhoto opacity

#### 1.1.0

* New: Multisite support
* Fix: Notice during first plugin activation

#### 1.0.4

* Fix: Changed regex for links to attachment pages, thanks to Darwin

#### 1.0.3

* New: Added Czech translation, thanks to Vaclav Hnilicka
* Tweak: Small UI enhancements
* Tweak: Changed SwipeBox Top and Bottom bars options description

#### 1.0.2

* New: Option to display single post images as a gallery
* New: Added French translation by Li-An
* Tweak: Rewritten regex for selector

#### 1.0.1

* New: Support for video links (YouTube and Vimeo)
* New: Added Polish translation
* New: Added Persian translation by Ali Mirzaei
* Tweak: SwipeBox script updated
* Tweak: Changed method of applying lightbox rel attribute to single images

#### 1.0.0

Initial release

## Meta

* Version **2.4.9**
* Last updated **3 months ago**
* Active installations **100,000+**
* WordPress version **5.0 or higher**
* Tested up to **6.6.2**
* PHP version **5.4 or higher**
* Languages
  See all 13

  Close

  [Dutch](https://nl.wordpress.org/plugins/responsive-lightbox/), [English (US)](https://wordpress.org/plugins/responsive-lightbox/), [French (France)](https://fr.wordpress.org/plugins/responsive-lightbox/), [German](https://de.wordpress.org/plugins/responsive-lightbox/), [Japanese](https://ja.wordpress.org/plugins/responsive-lightbox/), [Polish](https://pl.wordpress.org/plugins/responsive-lightbox/), [Romanian](https://ro.wordpress.org/plugins/responsive-lightbox/), [Russian](https://ru.wordpress.org/plugins/responsive-lightbox/), [Spanish (Chile)](https://cl.wordpress.org/plugins/responsive-lightbox/), [Spanish (Colombia)](https://es-co.wordpress.org/plugins/responsive-lightbox/), [Spanish (Mexico)](https://es-mx.wordpress.org/plugins/responsive-lightbox/), [Spanish (Spain)](https://es.wordpress.org/plugins/responsive-lightbox/), and [Spanish (Venezuela)](https://ve.wordpress.org/plugins/responsive-lightbox/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/responsive-lightbox)
* Tags [galleries](https://wordpress.org/plugins/tags/galleries/)[gallery](https://wordpress.org/plugins/tags/gallery/)[image](https://wordpress.org/plugins/tags/image/)[images](https://wordpress.org/plugins/tags/images/)[lightbox](https://wordpress.org/plugins/tags/lightbox/)
* [Advanced View](https://wordpress.org/plugins/responsive-lightbox/advanced/)

## Ratings

4.9 out of 5 stars.

* [1848 5-star reviews
  5 stars

  1848](https://wordpress.org/support/plugin/responsive-lightbox/reviews/?filter=5)
* [45 4-star reviews
  4 stars

  45](https://wordpress.org/support/plugin/responsive-lightbox/reviews/?filter=4)
* [12 3-star reviews
  3 stars

  12](https://wordpress.org/support/plugin/responsive-lightbox/reviews/?filter=3)
* [12 2-star reviews
  2 stars

  12](https://wordpress.org/support/plugin/responsive-lightbox/reviews/?filter=2)
* [42 1-star reviews
  1 star

  42](https://wordpress.org/support/plugin/responsive-lightbox/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/responsive-lightbox/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/responsive-lightbox/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/3873a6a64e5bcd1609cbd66b3643b35b9bf368c31de681fa450e4ca0fa106325?s=32&d=mm&r=g) [dFactory](https://profiles.wordpress.org/dfactory/)
## Support

Issues resolved in last two months:

0 out of 2

[View support forum](https://wordpress.org/support/plugin/responsive-lightbox/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](http://www.dfactory.co/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_d220381d_20250111_162303.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3137531%2540responsive-lightbox%26old%3D3137531%2540responsive-lightbox)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3137523/responsive-lightbox "Changeset 3137523 for responsive-lightbox")
* [Next Change](/changeset/3173096/responsive-lightbox "Changeset 3173096 for responsive-lightbox") →

---

# Changeset [3137531](/changeset/3137531 "Show full changeset") for [responsive-lightbox](/browser/responsive-lightbox?rev=3137531 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
08/19/2024 10:46:10 AM
([5 months](/timeline?from=2024-08-19T10%3A46%3A10Z&precision=second "See timeline at 08/19/2024 10:46:10 AM") ago)

Author:
dfactory
Message:

Update to 2.4.8

Location:
[responsive-lightbox/trunk](/browser/responsive-lightbox/trunk?rev=3137531)
Files:

17 edited

* [assets/featherlight/README.md](/browser/responsive-lightbox/trunk/assets/featherlight/README.md?rev=3137531 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [assets/magnific/LICENSE](/browser/responsive-lightbox/trunk/assets/magnific/LICENSE?rev=3137531 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [assets/magnific/README.md](/browser/responsive-lightbox/trunk/assets/magnific/README.md?rev=3137531 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [assets/magnific/jquery.magnific-popup.js](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531 "Show entry in browser")
  (modified)
  ([19 diffs](#file3 "Show differences"))
* [assets/magnific/jquery.magnific-popup.min.js](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.min.js?rev=3137531 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [assets/magnific/magnific-popup.css](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531 "Show entry in browser")
  (modified)
  ([18 diffs](#file5 "Show differences"))
* [assets/magnific/magnific-popup.min.css](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.min.css?rev=3137531 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [includes/class-remote-library-api.php](/browser/responsive-lightbox/trunk/includes/class-remote-library-api.php?rev=3137531 "Show entry in browser")
  (modified)
  ([2 diffs](#file7 "Show differences"))
* [includes/class-remote-library.php](/browser/responsive-lightbox/trunk/includes/class-remote-library.php?rev=3137531 "Show entry in browser")
  (modified)
  ([5 diffs](#file8 "Show differences"))
* [includes/class-settings.php](/browser/responsive-lightbox/trunk/includes/class-settings.php?rev=3137531 "Show entry in browser")
  (modified)
  ([3 diffs](#file9 "Show differences"))
* [includes/providers/class-flickr.php](/browser/responsive-lightbox/trunk/includes/providers/class-flickr.php?rev=3137531 "Show entry in browser")
  (modified)
  ([2 diffs](#file10 "Show differences"))
* [includes/providers/class-unsplash.php](/browser/responsive-lightbox/trunk/includes/providers/class-unsplash.php?rev=3137531 "Show entry in browser")
  (modified)
  ([2 diffs](#file11 "Show differences"))
* [includes/providers/class-wikimedia.php](/browser/responsive-lightbox/trunk/includes/providers/class-wikimedia.php?rev=3137531 "Show entry in browser")
  (modified)
  ([1 diff](#file12 "Show differences"))
* [js/admin-media.js](/browser/responsive-lightbox/trunk/js/admin-media.js?rev=3137531 "Show entry in browser")
  (modified)
  ([2 diffs](#file13 "Show differences"))
* [js/front.js](/browser/responsive-lightbox/trunk/js/front.js?rev=3137531 "Show entry in browser")
  (modified)
  ([5 diffs](#file14 "Show differences"))
* [readme.txt](/browser/responsive-lightbox/trunk/readme.txt?rev=3137531 "Show entry in browser")
  (modified)
  ([3 diffs](#file15 "Show differences"))
* [responsive-lightbox.php](/browser/responsive-lightbox/trunk/responsive-lightbox.php?rev=3137531 "Show entry in browser")
  (modified)
  ([5 diffs](#file16 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [responsive-lightbox/trunk/assets/featherlight/README.md](/changeset/3137531/responsive-lightbox/trunk/assets/featherlight/README.md "Show the changeset 3137531 restricted to responsive-lightbox/trunk/assets/featherlight/README.md")

  | [r2674555](/browser/responsive-lightbox/trunk/assets/featherlight/README.md?rev=2674555#L2 "Show revision 2674555 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/assets/featherlight/README.md?rev=3137531#L2 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | ------------------------ |
  | 3 | 3 |  |
  | 4 |  | \*\*Featherlight is a very lightweight jQuery lightbox plugin. For more information and demos, visit the [official website](http~~://noelboss.github.io/featherlight~~/).\*\* |
  |  | 4 | \*\*Featherlight is a very lightweight jQuery lightbox plugin. For more information and demos, visit the [official website](https://www.noevu.ch/featherlight-js-the-ultra-slim-lightbox/).\*\* |
  | 5 | 5 |  |
  | 6 | 6 | \* Simple yet flexible |
  | […](/browser/responsive-lightbox/trunk/assets/featherlight/README.md?rev=2674555#L507) | […](/browser/responsive-lightbox/trunk/assets/featherlight/README.md?rev=3137531#L507) |  |
  | 507 | 507 | To run the tests, you can open `test/featherlight.html` or `test/featherlight\_gallery.html` in your browser. |
  | 508 | 508 | Alternatively, run them from the console with `grunt test`; you will need to run `npm install` the first time. |
  |  | 509 |  |
  |  | 510 | ©️ [Noevu - Schweizer KMU Webseiten Entwicklung](https://www.noevu.ch/#entwicklung) |
* ## [responsive-lightbox/trunk/assets/magnific/LICENSE](/changeset/3137531/responsive-lightbox/trunk/assets/magnific/LICENSE "Show the changeset 3137531 restricted to responsive-lightbox/trunk/assets/magnific/LICENSE")

  | [r2674555](/browser/responsive-lightbox/trunk/assets/magnific/LICENSE?rev=2674555#L1 "Show revision 2674555 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/assets/magnific/LICENSE?rev=3137531#L1 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | The MIT License (MIT) |
  | 2 | 2 |  |
  | 3 |  | Copyright (c) 2014-20~~16 Dmitry~~ Semenov, http://dimsemenov.com |
  |  | 3 | Copyright (c) 2014-2024 Dmytro Semenov, http://dimsemenov.com |
  | 4 | 4 |  |
  | 5 | 5 | Permission is hereby granted, free of charge, to any person obtaining a copy of |
* ## [responsive-lightbox/trunk/assets/magnific/README.md](/changeset/3137531/responsive-lightbox/trunk/assets/magnific/README.md "Show the changeset 3137531 restricted to responsive-lightbox/trunk/assets/magnific/README.md")

  | [r2674555](/browser/responsive-lightbox/trunk/assets/magnific/README.md?rev=2674555#L1 "Show revision 2674555 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/assets/magnific/README.md?rev=3137531#L1 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  |  | 1 | \*\*Important note\*\* This jQuery plugin is deprecated, only critical or security bug fixes will be released in future. Use native `<dialog>` element if you need a basic dialog/modal/popup, or my <a href="https://photoswipe.com">PhotoSwipe</a> library if you need an advanced image gallery. Feel free to email me if you need assistance. |
  |  | 2 |  |
  |  | 3 | [![Stand With Ukraine](https://raw.githubusercontent.com/vshymanskyy/StandWithUkraine/main/banner-direct.svg)](https://savelife.in.ua/en/) |
  |  | 4 |  |
  | 1 | 5 | # Magnific Popup Repository |
  | 2 | 6 |  |
  | 3 | 7 | [![Build Status](https://travis-ci.org/dimsemenov/Magnific-Popup.png)](https://travis-ci.org/dimsemenov/Magnific-Popup) |
  | 4 |  | ~~[![Flattr](http://api.flattr.com/button/flattr-badge-large.png)](https://flattr.com/thing/1310305/Magnific-Popup-by-dimsemenov)~~ |
  | 5 | 8 |  |
  | 6 | 9 | Fast, light and responsive lightbox plugin, for jQuery and Zepto.js. |
* ## [responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js](/changeset/3137531/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js "Show the changeset 3137531 restricted to responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js")

  | [r2438905](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L1 "Show revision 2438905 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L1 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | /\*! Magnific Popup - v1.~~1.0 - 2016-02-20~~ |
  |  | 1 | /\*! Magnific Popup - v1.2.0 - 2024-06-08 |
  | 2 | 2 | \* http://dimsemenov.com/plugins/magnific-popup/ |
  | 3 |  | \* Copyright (c) 20~~16 Dmitry~~ Semenov; \*/ |
  |  | 3 | \* Copyright (c) 2024 Dmytro Semenov; \*/ |
  | 4 | 4 | ;(function (factory) { |
  | 5 | 5 | if (typeof define === 'function' && define.amd) { |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L446) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L446) |  |
  | 446 | 446 |  |
  | 447 | 447 | if(mfp.st.autoFocusLast && mfp.\_lastFocusedEl) { |
  | 448 |  | $(mfp.\_lastFocusedEl).trigger(~~'focus'~~ ); // put tab focus back |
  |  | 448 | $(mfp.\_lastFocusedEl).trigger('focus'); // put tab focus back |
  | 449 | 449 | } |
  | 450 | 450 | mfp.currItem = null; |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L642) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L642) |  |
  | 642 | 642 |  |
  | 643 | 643 | if(disableOn) { |
  | 644 |  | if~~( typeof disableOn === "function"~~ ) { |
  |  | 644 | if(typeof disableOn === "function") { |
  | 645 | 645 | if( !disableOn.call(mfp) ) { |
  | 646 | 646 | return true; |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L694) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L694) |  |
  | 694 | 694 | text = data.text; |
  | 695 | 695 |  |
  | 696 |  | mfp.preloader.html(text); |
  |  | 696 | if (mfp.st.allowHTMLInStatusIndicator) { |
  |  | 697 | mfp.preloader.html(text); |
  |  | 698 | } else { |
  |  | 699 | mfp.preloader.text(text); |
  |  | 700 | } |
  | 697 | 701 |  |
  | 698 | 702 | mfp.preloader.find('a').on('click', function(e) { |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L756) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L760) |  |
  | 756 | 760 | }, |
  | 757 | 761 | \_setFocus: function() { |
  | 758 |  | (mfp.st.focus ? mfp.content.find(mfp.st.focus).eq(0) : mfp.wrap).trigger(~~'focus'~~ ); |
  |  | 762 | (mfp.st.focus ? mfp.content.find(mfp.st.focus).eq(0) : mfp.wrap).trigger('focus'); |
  | 759 | 763 | }, |
  | 760 | 764 | \_onFocusIn: function(e) { |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L797) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L801) |  |
  | 797 | 801 |  |
  | 798 | 802 | } else { |
  | 799 |  | template.find(EVENT\_NS + '-'+key).html(value); |
  |  | 803 | if (mfp.st.allowHTMLInTemplate) { |
  |  | 804 | template.find(EVENT\_NS + '-'+key).html(value); |
  |  | 805 | } else { |
  |  | 806 | template.find(EVENT\_NS + '-'+key).text(value); |
  |  | 807 | } |
  | 800 | 808 | } |
  | 801 | 809 | }); |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L900) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L908) |  |
  | 900 | 908 | tLoading: 'Loading...', |
  | 901 | 909 |  |
  | 902 |  | autoFocusLast: true |
  |  | 910 | autoFocusLast: true, |
  |  | 911 |  |
  |  | 912 | allowHTMLInStatusIndicator: false, |
  |  | 913 |  |
  |  | 914 | allowHTMLInTemplate: false |
  | 903 | 915 |  |
  | 904 | 916 | } |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L1048) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L1060) |  |
  | 1048 | 1060 | settings: null, |
  | 1049 | 1061 | cursor: 'mfp-ajax-cur', |
  | 1050 |  | tError: '~~<a href="%url%">The content</a>~~ could not be loaded.' |
  |  | 1062 | tError: 'The content could not be loaded.' |
  | 1051 | 1063 | }, |
  | 1052 | 1064 |  |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L1118) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L1130) |  |
  | 1118 | 1130 |  |
  | 1119 | 1131 | if(src) { |
  | 1120 |  | if~~( typeof src === "function"~~ ) { |
  |  | 1132 | if(typeof src === "function") { |
  | 1121 | 1133 | return src.call(mfp, item); |
  | 1122 | 1134 | } else if(item.el) { |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L1145) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L1157) |  |
  | 1145 | 1157 | titleSrc: 'title', |
  | 1146 | 1158 | verticalFit: true, |
  | 1147 |  | tError: '~~<a href="%url%">The image</a>~~ could not be loaded.' |
  |  | 1159 | tError: 'The image could not be loaded.' |
  | 1148 | 1160 | }, |
  | 1149 | 1161 |  |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L1249) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L1261) |  |
  | 1249 | 1261 |  |
  | 1250 | 1262 | var guard = 0, |
  |  | 1263 |  |
  |  | 1264 | imgSt = mfp.st.image, |
  |  | 1265 |  |
  |  | 1266 | // image error handler |
  |  | 1267 | onLoadError = function() { |
  |  | 1268 | if(item) { |
  |  | 1269 | item.img.off('.mfploader'); |
  |  | 1270 | if(item === mfp.currItem){ |
  |  | 1271 | mfp.\_onImageHasSize(item); |
  |  | 1272 | mfp.updateStatus('error', imgSt.tError.replace('%url%', item.src) ); |
  |  | 1273 | } |
  |  | 1274 |  |
  |  | 1275 | item.hasSize = true; |
  |  | 1276 | item.loaded = true; |
  |  | 1277 | item.loadError = true; |
  |  | 1278 | } |
  |  | 1279 | }, |
  | 1251 | 1280 |  |
  | 1252 | 1281 | // image load complete handler |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L1278) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L1307) |  |
  | 1278 | 1307 | } |
  | 1279 | 1308 | } |
  | 1280 |  | }, |
  | 1281 |  |  |
  | 1282 |  | // image error handler |
  | 1283 |  | onLoadError = function() { |
  | 1284 |  | if(item) { |
  | 1285 |  | item.img.off('.mfploader'); |
  | 1286 |  | if(item === mfp.currItem){ |
  | 1287 |  | mfp.\_onImageHasSize(item); |
  | 1288 |  | mfp.updateStatus('error', imgSt.tError.replace('%url%', item.src) ); |
  | 1289 |  | } |
  | 1290 |  |  |
  | 1291 |  | item.hasSize = true; |
  | 1292 |  | item.loaded = true; |
  | 1293 |  | item.loadError = true; |
  | 1294 |  | } |
  | 1295 |  | }, |
  | 1296 |  | imgSt = mfp.st.image; |
  |  | 1309 | }; |
  |  | 1310 |  |
  | 1297 | 1311 |  |
  | 1298 | 1312 |  |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L1639) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L1653) |  |
  | 1639 | 1653 | dataObj[iframeSt.srcAction] = embedSrc; |
  | 1640 | 1654 | } |
  |  | 1655 |  |
  | 1641 | 1656 | mfp.\_parseMarkup(template, dataObj, item); |
  | 1642 | 1657 |  |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L1680) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L1695) |  |
  | 1680 | 1695 | tPrev: 'Previous (Left arrow key)', |
  | 1681 | 1696 | tNext: 'Next (Right arrow key)', |
  | 1682 |  | tCounter: '%curr% of %total%' |
  |  | 1697 | tCounter: '%curr% of %total%', |
  |  | 1698 |  |
  |  | 1699 | langDir: null, |
  |  | 1700 | loop: true, |
  | 1683 | 1701 | }, |
  | 1684 | 1702 |  |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L1692) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L1710) |  |
  | 1692 | 1710 |  |
  | 1693 | 1711 | if(!gSt || !gSt.enabled ) return false; |
  |  | 1712 |  |
  |  | 1713 | if (!gSt.langDir) { |
  |  | 1714 | gSt.langDir = document.dir || 'ltr'; |
  |  | 1715 | } |
  | 1694 | 1716 |  |
  | 1695 | 1717 | \_wrapClasses += ' mfp-gallery'; |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L1708) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L1730) |  |
  | 1708 | 1730 | \_document.on('keydown'+ns, function(e) { |
  | 1709 | 1731 | if (e.keyCode === 37) { |
  | 1710 |  | mfp.prev(); |
  |  | 1732 | if (gSt.langDir === 'rtl') mfp.next(); |
  |  | 1733 | else mfp.prev(); |
  | 1711 | 1734 | } else if (e.keyCode === 39) { |
  | 1712 |  | mfp.next(); |
  |  | 1735 | if (gSt.langDir === 'rtl') mfp.prev(); |
  |  | 1736 | else mfp.next(); |
  | 1713 | 1737 | } |
  | 1714 | 1738 | }); |
  |  | 1739 |  |
  |  | 1740 | mfp.updateGalleryButtons(); |
  |  | 1741 |  |
  |  | 1742 | }); |
  |  | 1743 |  |
  |  | 1744 | \_mfpOn('UpdateStatus'+ns, function(/\*e, data\*/) { |
  |  | 1745 | mfp.updateGalleryButtons(); |
  | 1715 | 1746 | }); |
  | 1716 | 1747 |  |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L1728) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L1759) |  |
  | 1728 | 1759 | \_mfpOn('BuildControls' + ns, function() { |
  | 1729 | 1760 | if(mfp.items.length > 1 && gSt.arrows && !mfp.arrowLeft) { |
  | 1730 |  | var markup = gSt.arrowMarkup, |
  | 1731 |  | arrowLeft = mfp.arrowLeft = $( markup.replace(/%title%/gi, gSt.tPrev).replace(/%dir%/gi, 'left') ).addClass(PREVENT\_CLOSE\_CLASS), |
  | 1732 |  | arrowRight = mfp.arrowRight = $( markup.replace(/%title%/gi, gSt.tNext).replace(/%dir%/gi, 'right') ).addClass(PREVENT\_CLOSE\_CLASS); |
  | 1733 |  |  |
  | 1734 |  | arrowLeft.on( 'click', function() { |
  | 1735 |  | mfp.prev(); |
  | 1736 |  | } ); |
  | 1737 |  | arrowRight.on( 'click', function() { |
  | 1738 |  | mfp.next(); |
  | 1739 |  | } ); |
  |  | 1761 |  |
  |  | 1762 | var arrowLeftDesc, arrowRightDesc, arrowLeftAction, arrowRightAction; |
  |  | 1763 |  |
  |  | 1764 | if (gSt.langDir === 'rtl') { |
  |  | 1765 | arrowLeftDesc = gSt.tNext; |
  |  | 1766 | arrowRightDesc = gSt.tPrev; |
  |  | 1767 | arrowLeftAction = 'next'; |
  |  | 1768 | arrowRightAction = 'prev'; |
  |  | 1769 | } else { |
  |  | 1770 | arrowLeftDesc = gSt.tPrev; |
  |  | 1771 | arrowRightDesc = gSt.tNext; |
  |  | 1772 | arrowLeftAction = 'prev'; |
  |  | 1773 | arrowRightAction = 'next'; |
  |  | 1774 | } |
  |  | 1775 |  |
  |  | 1776 | var markup     = gSt.arrowMarkup, |
  |  | 1777 | arrowLeft  = mfp.arrowLeft = $( markup.replace(/%title%/gi, arrowLeftDesc).replace(/%action%/gi, arrowLeftAction).replace(/%dir%/gi, 'left') ).addClass(PREVENT\_CLOSE\_CLASS), |
  |  | 1778 | arrowRight = mfp.arrowRight = $( markup.replace(/%title%/gi, arrowRightDesc).replace(/%action%/gi, arrowRightAction).replace(/%dir%/gi, 'right') ).addClass(PREVENT\_CLOSE\_CLASS); |
  |  | 1779 |  |
  |  | 1780 | if (gSt.langDir === 'rtl') { |
  |  | 1781 | mfp.arrowNext = arrowLeft; |
  |  | 1782 | mfp.arrowPrev = arrowRight; |
  |  | 1783 | } else { |
  |  | 1784 | mfp.arrowNext = arrowRight; |
  |  | 1785 | mfp.arrowPrev = arrowLeft; |
  |  | 1786 | } |
  |  | 1787 |  |
  |  | 1788 | arrowLeft.on('click', function() { |
  |  | 1789 | if (gSt.langDir === 'rtl') mfp.next(); |
  |  | 1790 | else mfp.prev(); |
  |  | 1791 | }); |
  |  | 1792 | arrowRight.on('click', function() { |
  |  | 1793 | if (gSt.langDir === 'rtl') mfp.prev(); |
  |  | 1794 | else mfp.next(); |
  |  | 1795 | }); |
  | 1740 | 1796 |  |
  | 1741 | 1797 | mfp.container.append(arrowLeft.add(arrowRight)); |
  |  | 1798 |  |
  | 1742 | 1799 | } |
  | 1743 | 1800 | }); |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L1761) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L1818) |  |
  | 1761 | 1818 | }, |
  | 1762 | 1819 | next: function() { |
  |  | 1820 | var newIndex = \_getLoopedId(mfp.index + 1); |
  |  | 1821 | if (!mfp.st.gallery.loop && newIndex === 0 ) return false; |
  | 1763 | 1822 | mfp.direction = true; |
  | 1764 |  | mfp.index = ~~\_getLoopedId(mfp.index + 1)~~; |
  |  | 1823 | mfp.index = newIndex; |
  | 1765 | 1824 | mfp.updateItemHTML(); |
  | 1766 | 1825 | }, |
  | 1767 | 1826 | prev: function() { |
  |  | 1827 | var newIndex = mfp.index - 1; |
  |  | 1828 | if (!mfp.st.gallery.loop && newIndex < 0) return false; |
  | 1768 | 1829 | mfp.direction = false; |
  | 1769 |  | mfp.index = \_getLoopedId(~~mfp.index - 1~~); |
  |  | 1830 | mfp.index = \_getLoopedId(newIndex); |
  | 1770 | 1831 | mfp.updateItemHTML(); |
  | 1771 | 1832 | }, |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=2438905#L1814) | […](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.js?rev=3137531#L1875) |  |
  | 1814 | 1875 |  |
  | 1815 | 1876 | item.preloaded = true; |
  | 1816 |  | } |
  |  | 1877 | }, |
  |  | 1878 |  |
  |  | 1879 | /\*\* |
  |  | 1880 | \* Show/hide the gallery prev/next buttons if we're at the start/end, if looping is turned off |
  |  | 1881 | \* Added by Joloco for Veg |
  |  | 1882 | \*/ |
  |  | 1883 | updateGalleryButtons: function() { |
  |  | 1884 |  |
  |  | 1885 | if ( !mfp.st.gallery.loop && typeof mfp.arrowPrev === 'object' && mfp.arrowPrev !== null) { |
  |  | 1886 |  |
  |  | 1887 | if (mfp.index === 0) mfp.arrowPrev.hide(); |
  |  | 1888 | else mfp.arrowPrev.show(); |
  |  | 1889 |  |
  |  | 1890 | if (mfp.index === (mfp.items.length - 1)) mfp.arrowNext.hide(); |
  |  | 1891 | else mfp.arrowNext.show(); |
  |  | 1892 |  |
  |  | 1893 | } |
  |  | 1894 |  |
  |  | 1895 | }, |
  |  | 1896 |  |
  | 1817 | 1897 | } |
  |  | 1898 |  |
  | 1818 | 1899 | }); |
  |  | 1900 |  |
  | 1819 | 1901 |  |
  | 1820 | 1902 | /\*>>gallery\*/ |
* ## [responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.min.js](/changeset/3137531/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.min.js "Show the changeset 3137531 restricted to responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.min.js")

  | [r2438905](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.min.js?rev=2438905#L1 "Show revision 2438905 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/assets/magnific/jquery.magnific-popup.min.js?rev=3137531#L1 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | !function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(window.jQuery||window.Zepto)}(function(~~d){function e(){}function p(e,t){g.ev.on(n+e+w,t)}function u(e,t,n,o){var i=document.createElement("div");return i.className="mfp-"+e,n&&(i.innerHTML=n),o?t&&t.appendChild(i):(i=d(i),t&&i.appendTo(t)),i}function f(e,t){g.ev.triggerHandler(n+e,t),g.st.callbacks&&(e=e.charAt(0).toLowerCase()+e.slice(1),g.st.callbacks[e]&&g.st.callbacks[e].apply(g,Array.isArray(t)?t:[t]))}function m(e){return e===t&&g.currTemplate.closeBtn||(g.currTemplate.closeBtn=d(g.st.closeMarkup.replace("%title%",g.st.tClose)),t=e),g.currTemplate.closeBtn}function r(){d.magnificPopup.instance||((g=new e).init(),d.magnificPopup.instance=g)}var g,o,h,i,v,t,l="Close",c="BeforeClose",y="MarkupParse",C="Open",a="Change",n="mfp",w="."+n,b="mfp-ready",s="mfp-removing",I="mfp-prevent-close",x=!!window.jQuery,k=d(window);e.prototype={constructor:e,init:function(){var e=navigator.appVersion;g.isLowIE=g.isIE8=document.all&&!document.addEventListener,g.isAndroid=/android/gi.test(e),g.isIOS=/iphone|ipad|ipod/gi.test(e),g.supportsTransition=function(){var e=document.createElement("p").style,t=["ms","O","Moz","Webkit"];if(void 0!==e.transition)return!0;for(;t.length;)if(t.pop()+"Transition"in e)return!0;return!1}(),g.probablyMobile=g.isAndroid||g.isIOS||/(Opera Mini)|Kindle|webOS|BlackBerry|(Opera Mobi)|(Windows Phone)|IEMobile/i.test(navigator.userAgent),h=d(document),g.popupsCache={}},open:function(e){if(!1===e.isObj){g.items=e.items.toArray(),g.index=0;for(var t,n=e.items,o=0;o<n.length;o++)if((t=n[o]).parsed&&(t=t.el[0]),t===e.el[0]){g.index=o;break}}else g.items=Array.isArray(e.items)?e.items:[e.items],g.index=e.index||0;if(!g.isOpen){g.types=[],v="",e.mainEl&&e.mainEl.length?g.ev=e.mainEl.eq(0):g.ev=h,e.key?(g.popupsCache[e.key]||(g.popupsCache[e.key]={}),g.currTemplate=g.popupsCache[e.key]):g.currTemplate={},g.st=d.extend(!0,{},d.magnificPopup.defaults,e),g.fixedContentPos="auto"===g.st.fixedContentPos?!g.probablyMobile:g.st.fixedContentPos,g.st.modal&&(g.st.closeOnContentClick=!1,g.st.closeOnBgClick=!1,g.st.showCloseBtn=!1,g.st.enableEscapeKey=!1),g.bgOverlay||(g.bgOverlay=u("bg").on("click"+w,function(){g.close()}),g.wrap=u("wrap").attr("tabindex",-1).on("click"+w,function(e){g.\_checkIfClose(e.target)&&g.close()}),g.container=u("container",g.wrap)),g.contentContainer=u("content"),g.st.preloader&&(g.preloader=u("preloader",g.container,g.st.tLoading));var i=d.magnificPopup.modules;for(o=0;o<i.length;o++){var r=(r=i[o]).charAt(0).toUpperCase()+r.slice(1);g["init"+r].call(g)}f("BeforeOpen"),g.st.showCloseBtn&&(g.st.closeBtnInside?(p(y,function(e,t,n,o){n.close\_replaceWith=m(o.type)}),v+=" mfp-close-btn-in"):g.wrap.append(m())),g.st.alignTop&&(v+=" mfp-align-top"),g.fixedContentPos?g.wrap.css({overflow:g.st.overflowY,overflowX:"hidden",overflowY:g.st.overflowY}):g.wrap.css({top:k.scrollTop(),position:"absolute"}),!1!==g.st.fixedBgPos&&("auto"!==g.st.fixedBgPos||g.fixedContentPos)||g.bgOverlay.css({height:h.height(),position:"absolute"}),g.st.enableEscapeKey&&h.on("keyup"+w,function(e){27===e.keyCode&&g.close()}),k.on("resize"+w,function(){g.updateSize()}),g.st.closeOnContentClick||(v+=" mfp-auto-cursor"),v&&g.wrap.addClass(v);var a,s=g.wH=k.height(),l={};g.fixedContentPos&&(!g.\_hasScrollBar(s)||(a=g.\_getScrollbarSize())&&(l.marginRight=a)),g.fixedContentPos&&(g.isIE7?d("body, html").css("overflow","hidden"):l.overflow="hidden");var c=g.st.mainClass;return g.isIE7&&(c+=" mfp-ie7"),c&&g.\_addClassToMFP(c),g.updateItemHTML(),f("BuildControls"),d("html").css(l),g.bgOverlay.add(g.wrap).prependTo(g.st.prependTo||d(document.body)),g.\_lastFocusedEl=document.activeElement,setTimeout(function(){g.content?(g.\_addClassToMFP(b),g.\_setFocus()):g.bgOverlay.addClass(b),h.on("focusin"+w,g.\_onFocusIn)},16),g.isOpen=!0,g.updateSize(s),f(C),e}g.updateItemHTML()},close:function(){g.isOpen&&(f(c),g.isOpen=!1,g.st.removalDelay&&!g.isLowIE&&g.supportsTransition?(g.\_addClassToMFP(s),setTimeout(function(){g.\_close()},g.st.removalDelay)):g.\_close())},\_close:function(){f(l);var e,t=s+" "+b+" ";g.bgOverlay.detach(),g.wrap.detach(),g.container.empty(),g.st.mainClass&&(t+=g.st.mainClass+" "),g.\_removeClassFromMFP(t),g.fixedContentPos&&(e={marginRight:""},g.isIE7?d("body, html").css("overflow",""):e.overflow="",d("html").css(e)),h.off("keyup.mfp focusin"+w),g.ev.off(w),g.wrap.attr("class","mfp-wrap").removeAttr("style"),g.bgOverlay.attr("class","mfp-bg"),g.container.attr("class","mfp-container"),!g.st.showCloseBtn||g.st.closeBtnInside&&!0!==g.currTemplate[g.currItem.type]||g.currTemplate.closeBtn&&g.currTemplate.closeBtn.detach(),g.st.autoFocusLast&&g.\_lastFocusedEl&&d(g.\_lastFocusedEl).trigger("focus"),g.currItem=null,g.content=null,g.currTemplate=null,g.prevHeight=0,f("AfterClose")},updateSize:function(e){var t,n;g.isIOS?(t=document.documentElement.clientWidth/window.innerWidth,n=window.innerHeight\*t,g.wrap.css("height",n),g.wH=n):g.wH=e||k.height(),g.fixedContentPos||g.wrap.css("height",g.wH),f("Resize")},updateItemHTML:function(){var e=g.items[g.index];g.contentContainer.detach(),g.content&&g.content.detach(),e.parsed||(e=g.parseEl(g.index));var t,n=e.type;f("BeforeChange",[g.currItem?g.currItem.type:"",n]),g.currItem=e,g.currTemplate[n]||(t=!!g.st[n]&&g.st[n].markup,f("FirstMarkupParse",t),g.currTemplate[n]=!t||d(t)),i&&i!==e.type&&g.container.removeClass("mfp-"+i+"-holder");var o=g["get"+n.charAt(0).toUpperCase()+n.slice(1)](e,g.currTemplate[n]);g.appendContent(o,n),e.preloaded=!0,f(a,e),i=e.type,g.container.prepend(g.contentContainer),f("AfterChange")},appendContent:function(e,t){(g.content=e)?g.st.showCloseBtn&&g.st.closeBtnInside&&!0===g.currTemplate[t]?g.content.find(".mfp-close").length||g.content.append(m()):g.content=e:g.content="",f("BeforeAppend"),g.container.addClass("mfp-"+t+"-holder"),g.contentContainer.append(g.content)},parseEl:function(e){var t,n=g.items[e];if((n=n.tagName?{el:d(n)}:(t=n.type,{data:n,src:n.src})).el){for(var o=g.types,i=0;i<o.length;i++)if(n.el.hasClass("mfp-"+o[i])){t=o[i];break}n.src=n.el.attr("data-mfp-src"),n.src||(n.src=n.el.attr("href"))}return n.type=t||g.st.type||"inline",n.index=e,n.parsed=!0,g.items[e]=n,f("ElementParse",n),g.items[e]},addGroup:function(t,n){function e(e){e.mfpEl=this,g.\_openClick(e,t,n)}var o="click.magnificPopup";(n=n||{}).mainEl=t,n.items?(n.isObj=!0,t.off(o).on(o,e)):(n.isObj=!1,n.delegate?t.off(o).on(o,n.delegate,e):(n.items=t).off(o).on(o,e))},\_openClick:function(e,t,n){if((void 0!==n.midClick?n.midClick:d.magnificPopup.defaults.midClick)||!(2===e.which||e.ctrlKey||e.metaKey||e.altKey||e.shiftKey)){var o=void 0!==n.disableOn?n.disableOn:d.magnificPopup.defaults.disableOn;if(o)if("function"==typeof o){if(!o.call(g))return!0}else if(k.width()<o)return!0;e.type&&(e.preventDefault(),g.isOpen&&e.stopPropagation()),n.el=d(e.mfpEl),n.delegate&&(n.items=t.find(n.delegate)),g.open(n)}},updateStatus:function(e,t){var n;g.preloader&&(o!==e&&g.container.removeClass("mfp-s-"+o),t||"loading"!==e||(t=g.st.tLoading),f("UpdateStatus",n={status:e,text:t}),e=n.status,t=n.text,g.preloader.html(t),g.preloader.find("a").on("click",function(e){e.stopImmediatePropagation()}),g.container.addClass("mfp-s-"+e),o=e)},\_checkIfClose:function(e){if(!d(e).closest("."+I).length){var t=g.st.closeOnContentClick,n=g.st.closeOnBgClick;if(t&&n)return!0;if(!g.content||d(e).closest(".mfp-close").length||g.preloader&&e===g.preloader[0])return!0;if(e===g.content[0]||d.contains(g.content[0],e)){if(t)return!0}else if(n&&d.contains(document,e))return!0;return!1}},\_addClassToMFP:function(e){g.bgOverlay.addClass(e),g.wrap.addClass(e)},\_removeClassFromMFP:function(e){this.bgOverlay.removeClass(e),g.wrap.removeClass(e)},\_hasScrollBar:function(e){return(g.isIE7?h.height():document.body.scrollHeight)>(e||k.height())},\_setFocus:function(){(g.st.focus?g.content.find(g.st.focus).eq(0):g.wrap).trigger("focus")},\_onFocusIn:function(e){if(e.target!==g.wrap[0]&&!d.contains(g.wrap[0],e.target))return g.\_setFocus(),!1},\_parseMarkup:function(i,e,t){var r;t.data&&(e=d.extend(t.data,e)),f(y,[i,e,t]),d.each(e,function(e,t){return void 0===t||!1===t||void(1<(r=e.split("\_")).length?0<(n=i.find(w+"-"+r[0])).length&&("replaceWith"===(o=r[1])?n[0]!==t[0]&&n.replaceWith(t):"img"===o?n.is("img")?n.attr("src",t):n.replaceWith(d("<img>").attr("src",t).attr("class",n.attr("class"))):n.attr(r[1],t)):i.find(w+"-"+e).html(t));var n,o})},\_getScrollbarSize:function(){var e;return void 0===g.scrollbarSize&&((e=document.createElement("div")).style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",document.body.appendChild(e),g.scrollbarSize=e.offsetWidth-e.clientWidth,document.body.removeChild(e)),g.scrollbarSize}},d.magnificPopup={instance:null,proto:e.prototype,modules:[],open:function(e,t){return r(),(e=e?d.extend(!0,{},e):{}).isObj=!0,e.index=t||0,this.instance.open(e)},close:function(){return d.magnificPopup.instance&&d.magnificPopup.instance.close()},registerModule:function(e,t){t.options&&(d.magnificPopup.defaults[e]=t.options),d.extend(this.proto,t.proto),this.modules.push(e)},defaults:{disableOn:0,key:null,midClick:!1,mainClass:"",preloader:!0,focus:"",closeOnContentClick:!1,closeOnBgClick:!0,closeBtnInside:!0,showCloseBtn:!0,enableEscapeKey:!0,modal:!1,alignTop:!1,removalDelay:0,prependTo:null,fixedContentPos:"auto",fixedBgPos:"auto",overflowY:"auto",closeMarkup:'<button title="%title%" type="button" class="mfp-close">&#215;</button>',tClose:"Close (Esc)",tLoading:"Loading...",autoFocusLast:!0}},d.fn.magnificPopup=function(e){r();var t,n,o,i=d(this);return"string"==typeof e?"open"===e?(t=x?i.data("magnificPopup"):i[0].magnificPopup,n=parseInt(arguments[1],10)||0,o=t.items?t.items[n]:(o=i,t.delegate&&(o=o.find(t.delegate)),o.eq(n)),g.\_openClick({mfpEl:o},i,t)):g.isOpen&&g[e].apply(g,Array.prototype.slice.call(arguments,1)):(e=d.extend(!0,{},e),x?i.data("magnificPopup",e):i[0].magnificPopup=e,g.addGroup(i,e)),i};function T(){S&&(P.after(S.addClass(\_)).detach(),S=null)}var \_,P,S,E="inline";d.magnificPopup.registerModule(E,{options:{hiddenClass:"hide",markup:"",tNotFound:"Content not found"},proto:{initInline:function(){g.types.push(E),p(l+"."+E,function(){T()})},getInline:function(e,t){if(T(),e.src){var n,o=g.st.inline,i=d(e.src);return i.length?((n=i[0].parentNode)&&n.tagName&&(P||(\_=o.hiddenClass,P=u(\_),\_="mfp-"+\_),S=i.after(P).detach().removeClass(\_)),g.updateStatus("ready")):(g.updateStatus("error",o.tNotFound),i=d("<div>")),e.inlineElement=i}return g.updateStatus("ready"),g.\_parseMarkup(t,{},e),t}}});function z(){M&&d(document.body).removeClass(M)}function O(){z(),g.req&&g.req.abort()}var M,B="ajax";d.magnificPopup.registerModule(B,{options:{settings:null,cursor:"mfp-ajax-cur",tError:'<a href="%url%">The content</a> could not be loaded.'},proto:{initAjax:function(){g.types.push(B),M=g.st.ajax.cursor,p(l+"."+B,O),p("BeforeChange."+B,O)},getAjax:function(i){M&&d(document.body).addClass(M),g.updateStatus("loading");var e=d.extend({url:i.src,success:function(e,t,n){var o={data:e,xhr:n};f("ParseAjax",o),g.appendContent(d(o.data),B),i.finished=!0,z(),g.\_setFocus(),setTimeout(function(){g.wrap.addClass(b)},16),g.updateStatus("ready"),f("AjaxContentAdded")},error:function(){z(),i.finished=i.loadError=!0,g.updateStatus("error",g.st.ajax.tError.replace("%url%",i.src))}},g.st.ajax.settings);return g.req=d.ajax(e),""}}});var A;d.magnificPopup.registerModule("image",{options:{markup:'<div class="mfp-figure"><div class="mfp-close"></div><figure><div class="mfp-img"></div><figcaption><div class="mfp-bottom-bar"><div class="mfp-title"></div><div class="mfp-counter"></div></div></figcaption></figure></div>',cursor:"mfp-zoom-out-cur",titleSrc:"title",verticalFit:!0,tError:'<a href="%url%">The image</a> could not be loaded.'},proto:{initImage:function(){var e=g.st.image,t=".image";g.types.push("image"),p(C+t,function(){"image"===g.currItem.type&&e.cursor&&d(document.body).addClass(e.cursor)}),p(l+t,function(){e.cursor&&d(document.body).removeClass(e.cursor),k.off("resize"+w)}),p("Resize"+t,g.resizeImage),g.isLowIE&&p("AfterChange",g.resizeImage)},resizeImage:function(){var e,t=g.currItem;t&&t.img&&g.st.image.verticalFit&&(e=0,g.isLowIE&&(e=parseInt(t.img.css("padding-top"),10)+parseInt(t.img.css("padding-bottom"),10)),t.img.css("max-height",g.wH-e))},\_onImageHasSize:function(e){e.img&&(e.hasSize=!0,A&&clearInterval(A),e.isCheckingImgSize=!1,f("ImageHasSize",e),e.imgHidden&&(g.content&&g.content.removeClass("mfp-loading"),e.imgHidden=!1))},findImageSize:function(t){var n=0,o=t.img[0],i=function(e){A&&clearInterval(A),A=setInterval(function(){0<o.naturalWidth?g.\_onImageHasSize(t):(200<n&&clearInterval(A),3===++n?i(10):40===n?i(50):100===n&&i(500))},e)};i(1)},getImage:function(e,t){var n,o=0,i=function(){e&&(e.img[0].complete?(e.img.off(".mfploader"),e===g.currItem&&(g.\_onImageHasSize(e),g.updateStatus("ready")),e.hasSize=!0,e.loaded=!0,f("ImageLoadComplete")):++o<200?setTimeout(i,100):r())},r=function(){e&&(e.img.off(".mfploader"),e===g.currItem&&(g.\_onImageHasSize(e),g.updateStatus("error",a.tError.replace("%url%",e.src))),e.hasSize=!0,e.loaded=!0,e.loadError=!0)},a=g.st.image,s=t.find(".mfp-img");return s.length&&((n=document.createElement("img")).className="mfp-img",e.el&&e.el.find("img").length&&(n.alt=e.el.find("img").attr("alt")),e.img=d(n).on("load.mfploader",i).on("error.mfploader",r),n.src=e.src,s.is("img")&&(e.img=e.img.clone()),0<(n=e.img[0]).naturalWidth?e.hasSize=!0:n.width||(e.hasSize=!1)),g.\_parseMarkup(t,{title:function(e){if(e.data&&void 0!==e.data.title)return e.data.title;var t=g.st.image.titleSrc;if(t){if("function"==typeof t)return t.call(g,e);if(e.el)return e.el.attr(t)||""}return""}(e),img\_replaceWith:e.img},e),g.resizeImage(),e.hasSize?(A&&clearInterval(A),e.loadError?(t.addClass("mfp-loading"),g.updateStatus("error",a.tError.replace("%url%",e.src))):(t.removeClass("mfp-loading"),g.updateStatus("ready"))):(g.updateStatus("loading"),e.loading=!0,e.hasSize||(e.imgHidden=!0,t.addClass("mfp-loading"),g.findImageSize(e))),t}}});var L;d.magnificPopup.registerModule("zoom",{options:{enabled:!1,easing:"ease-in-out",duration:300,opener:function(e){return e.is("img")?e:e.find("img")}},proto:{initZoom:function(){var e,t,n,o,i,r,a=g.st.zoom,s=".zoom";a.enabled&&g.supportsTransition&&(t=a.duration,n=function(e){var t=e.clone().removeAttr("style").removeAttr("class").addClass("mfp-animated-image"),n="all "+a.duration/1e3+"s "+a.easing,o={position:"fixed",zIndex:9999,left:0,top:0,"-webkit-backface-visibility":"hidden"},i="transition";return o["-webkit-"+i]=o["-moz-"+i]=o["-o-"+i]=o[i]=n,t.css(o),t},o=function(){g.content.css("visibility","visible")},p("BuildControls"+s,function(){if(g.\_allowZoom()){if(clearTimeout(i),g.content.css("visibility","hidden"),!(e=g.\_getItemToZoom()))return void o();(r=n(e)).css(g.\_getOffset()),g.wrap.append(r),i=setTimeout(function(){r.css(g.\_getOffset(!0)),i=setTimeout(function(){o(),setTimeout(function(){r.remove(),e=r=null,f("ZoomAnimationEnded")},16)},t)},16)}}),p(c+s,function(){if(g.\_allowZoom()){if(clearTimeout(i),g.st.removalDelay=t,!e){if(!(e=g.\_getItemToZoom()))return;r=n(e)}r.css(g.\_getOffset(!0)),g.wrap.append(r),g.content.css("visibility","hidden"),setTimeout(function(){r.css(g.\_getOffset())},16)}}),p(l+s,function(){g.\_allowZoom()&&(o(),r&&r.remove(),e=null)}))},\_allowZoom:function(){return"image"===g.currItem.type},\_getItemToZoom:function(){return!!g.currItem.hasSize&&g.currItem.img},\_getOffset:function(e){var t=e?g.currItem.img:g.st.zoom.opener(g.currItem.el||g.currItem),n=t.offset(),o=parseInt(t.css("padding-top"),10),i=parseInt(t.css("padding-bottom"),10);n.top-=d(window).scrollTop()-o;var r={width:t.width(),height:(x?t.innerHeight():t[0].offsetHeight)-i-o};return void 0===L&&(L=void 0!==document.createElement("p").style.MozTransform),L?r["-moz-transform"]=r.transform="translate("+n.left+"px,"+n.top+"px)":(r.left=n.left,r.top=n.top),r}}});function H(e){var t;!g.currTemplate[F]||(t=g.currTemplate[F].find("iframe")).length&&(e||(t[0].src="//about:blank"),g.isIE8&&t.css("display",e?"block":"none"))}var F="iframe";d.magnificPopup.registerModule(F,{options:{markup:'<div class="mfp-iframe-scaler"><div class="mfp-close"></div><iframe class="mfp-iframe" src="//about:blank" frameborder="0" allowfullscreen></iframe></div>',srcAction:"iframe\_src",patterns:{youtube:{index:"youtube.com",id:"v=",src:"//www.youtube.com/embed/%id%?autoplay=1"},vimeo:{index:"vimeo.com/",id:"/",src:"//player.vimeo.com/video/%id%?autoplay=1"},gmaps:{index:"//maps.google.",src:"%id%&output=embed"}}},proto:{initIframe:function(){g.types.push(F),p("BeforeChange",function(e,t,n){t!==n&&(t===F?H():n===F&&H(!0))}),p(l+"."+F,function(){H()})},getIframe:function(e,t){var n=e.src,o=g.st.iframe;d.each(o.patterns,function(){if(-1<n.indexOf(this.index))return this.id&&(n="string"==typeof this.id?n.substr(n.lastIndexOf(this.id)+this.id.length,n.length):this.id.call(this,n)),n=this.src.replace("%id%",n),!1});var i={};return o.srcAction&&(i[o.srcAction]=n),g.\_parseMarkup(t,i,e),g.updateStatus("ready"),t}}});function j(e){var t=g.items.length;return t-1<e?e-t:e<0?t+e:e}function N(e,t,n){return e.replace(/%curr%/gi,t+1).replace(/%total%/gi,n)}d.magnificPopup.registerModule("gallery",{options:{enabled:!1,arrowMarkup:'<button title="%title%" type="button" class="mfp-arrow mfp-arrow-%dir%"></button>',preload:[0,2],navigateByImgClick:!0,arrows:!0,tPrev:"Previous (Left arrow key)",tNext:"Next (Right arrow key)",tCounter:"%curr% of %total%"},proto:{initGallery:function(){var r=g.st.gallery,e=".mfp-gallery";if(g.direction=!0,!r||!r.enabled)return!1;v+=" mfp-gallery",p(C+e,function(){r.navigateByImgClick&&g.wrap.on("click"+e,".mfp-img",function(){if(1<g.items.length)return g.next(),!1}),h.on("keydown"+e,function(e){37===e.keyCode?g.prev():39===e.keyCode&&g.next()})}),p("UpdateStatus"+e,function(e,t){t.text&&(t.text=N(t.text,g.currItem.index,g.items.length))}),p(y+e,function(e,t,n,o){var i=g.items.length;n.counter=1<i?N(r.tCounter,o.index,i):""}),p("BuildControls"+e,function(){var e,t,n;1<g.items.length&&r.arrows&&!g.arrowLeft&&(e=r.arrowMarkup,t=g.arrowLeft=d(e.replace(/%title%/gi,r.tPrev).replace(/%dir%/gi,"left")).addClass(I),n=g.arrowRight=d(e.replace(/%title%/gi,r.tNext).replace(/%dir%/gi,"right")).addClass(I),t.on("click",function(){g.prev()}),n.on("click",function(){g.next()}),g.container.append(t.add(n)))}),p(a+e,function(){g.\_preloadTimeout&&clearTimeout(g.\_preloadTimeout),g.\_preloadTimeout=setTimeout(function(){g.preloadNearbyImages(),g.\_preloadTimeout=null},16)}),p(l+e,function(){h.off(e),g.wrap.off("click"+e),g.arrowRight=g.arrowLeft=null})},next:function(){g.direction=!0,g.index=j(g.index+1),g.updateItemHTML()},prev:function(){g.direction=!1,g.index=j(g.index-1),g.updateItemHTML()},goTo:function(e){g.direction=e>=g.index,g.index=e,g.updateItemHTML()},preloadNearbyImages:function(){for(var e=g.st.gallery.preload,t=Math.min(e[0],g.items.length),n=Math.min(e[1],g.items.length),o=1;o<=(g.direction?n:t);o++)g.\_preloadItem(g.index+o);for(o=1;o<=(g.direction?t:n);o++)g.\_preloadItem(g.index-o)},\_preloadItem:function(e){var t;e=j(e),g.items[e].preloaded||((t=g.items[e]).parsed||(t=g.parseEl(e)),f("LazyLoad",t),"image"===t.type&&(t.img=d('<img class="mfp-img" />').on("load.mfploader",function(){t.hasSize=!0}).on("error.mfploader",function(){t.hasSize=!0,t.loadError=!0,f("LazyLoadError",t)}).attr("src",t.src)),t.preloaded=!0)}}});var W="retina";d.magnificPopup.registerModule(W,{options:{replaceSrc:function(e){return e.src.replace(/\.\w+$/,function(e){return"@2x"+e})},ratio:1},proto:{initRetina:function(){var n,o;1<window.devicePixelRatio&&(n=g.st.retina,o=n.ratio,1<(o=isNaN(o)?o():o)&&(p("ImageHasSize."+W,function(e,t){t.img.css({"max-width":t.img[0].naturalWidth/o,width:"100%"})}),p("ElementParse."+W,function(e,t){t.src=n.replaceSrc(t,o)})~~))}}}),r()}); |
  |  | 1 | !function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(window.jQuery||window.Zepto)}(function(c){function e(){}function d(e,t){m.ev.on(x+e+I,t)}function p(e,t,n,o){var i=document.createElement("div");return i.className="mfp-"+e,n&&(i.innerHTML=n),o?t&&t.appendChild(i):(i=c(i),t&&i.appendTo(t)),i}function u(e,t){m.ev.triggerHandler(x+e,t),m.st.callbacks&&(e=e.charAt(0).toLowerCase()+e.slice(1),m.st.callbacks[e])&&m.st.callbacks[e].apply(m,Array.isArray(t)?t:[t])}function f(e){return e===A&&m.currTemplate.closeBtn||(m.currTemplate.closeBtn=c(m.st.closeMarkup.replace("%title%",m.st.tClose)),A=e),m.currTemplate.closeBtn}function r(){c.magnificPopup.instance||((m=new e).init(),c.magnificPopup.instance=m)}function a(){y&&(v.after(y.addClass(l)).detach(),y=null)}function i(){n&&c(document.body).removeClass(n)}function t(){i(),m.req&&m.req.abort()}var m,o,g,s,h,A,l,v,y,n,w="Close",F="BeforeClose",C="MarkupParse",b="Open",j="Change",x="mfp",I="."+x,T="mfp-ready",N="mfp-removing",k="mfp-prevent-close",P=!!window.jQuery,\_=c(window),S=(c.magnificPopup={instance:null,proto:e.prototype={constructor:e,init:function(){var e=navigator.appVersion;m.isLowIE=m.isIE8=document.all&&!document.addEventListener,m.isAndroid=/android/gi.test(e),m.isIOS=/iphone|ipad|ipod/gi.test(e),m.supportsTransition=function(){var e=document.createElement("p").style,t=["ms","O","Moz","Webkit"];if(void 0!==e.transition)return!0;for(;t.length;)if(t.pop()+"Transition"in e)return!0;return!1}(),m.probablyMobile=m.isAndroid||m.isIOS||/(Opera Mini)|Kindle|webOS|BlackBerry|(Opera Mobi)|(Windows Phone)|IEMobile/i.test(navigator.userAgent),g=c(document),m.popupsCache={}},open:function(e){if(!1===e.isObj){m.items=e.items.toArray(),m.index=0;for(var t,n=e.items,o=0;o<n.length;o++)if((t=(t=n[o]).parsed?t.el[0]:t)===e.el[0]){m.index=o;break}}else m.items=Array.isArray(e.items)?e.items:[e.items],m.index=e.index||0;if(!m.isOpen){m.types=[],h="",e.mainEl&&e.mainEl.length?m.ev=e.mainEl.eq(0):m.ev=g,e.key?(m.popupsCache[e.key]||(m.popupsCache[e.key]={}),m.currTemplate=m.popupsCache[e.key]):m.currTemplate={},m.st=c.extend(!0,{},c.magnificPopup.defaults,e),m.fixedContentPos="auto"===m.st.fixedContentPos?!m.probablyMobile:m.st.fixedContentPos,m.st.modal&&(m.st.closeOnContentClick=!1,m.st.closeOnBgClick=!1,m.st.showCloseBtn=!1,m.st.enableEscapeKey=!1),m.bgOverlay||(m.bgOverlay=p("bg").on("click"+I,function(){m.close()}),m.wrap=p("wrap").attr("tabindex",-1).on("click"+I,function(e){m.\_checkIfClose(e.target)&&m.close()}),m.container=p("container",m.wrap)),m.contentContainer=p("content"),m.st.preloader&&(m.preloader=p("preloader",m.container,m.st.tLoading));var i=c.magnificPopup.modules;for(o=0;o<i.length;o++){var r=(r=i[o]).charAt(0).toUpperCase()+r.slice(1);m["init"+r].call(m)}u("BeforeOpen"),m.st.showCloseBtn&&(m.st.closeBtnInside?(d(C,function(e,t,n,o){n.close\_replaceWith=f(o.type)}),h+=" mfp-close-btn-in"):m.wrap.append(f())),m.st.alignTop&&(h+=" mfp-align-top"),m.fixedContentPos?m.wrap.css({overflow:m.st.overflowY,overflowX:"hidden",overflowY:m.st.overflowY}):m.wrap.css({top:\_.scrollTop(),position:"absolute"}),!1!==m.st.fixedBgPos&&("auto"!==m.st.fixedBgPos||m.fixedContentPos)||m.bgOverlay.css({height:g.height(),position:"absolute"}),m.st.enableEscapeKey&&g.on("keyup"+I,function(e){27===e.keyCode&&m.close()}),\_.on("resize"+I,function(){m.updateSize()}),m.st.closeOnContentClick||(h+=" mfp-auto-cursor"),h&&m.wrap.addClass(h);var a=m.wH=\_.height(),s={},l=(m.fixedContentPos&&m.\_hasScrollBar(a)&&(l=m.\_getScrollbarSize())&&(s.marginRight=l),m.fixedContentPos&&(m.isIE7?c("body, html").css("overflow","hidden"):s.overflow="hidden"),m.st.mainClass);return m.isIE7&&(l+=" mfp-ie7"),l&&m.\_addClassToMFP(l),m.updateItemHTML(),u("BuildControls"),c("html").css(s),m.bgOverlay.add(m.wrap).prependTo(m.st.prependTo||c(document.body)),m.\_lastFocusedEl=document.activeElement,setTimeout(function(){m.content?(m.\_addClassToMFP(T),m.\_setFocus()):m.bgOverlay.addClass(T),g.on("focusin"+I,m.\_onFocusIn)},16),m.isOpen=!0,m.updateSize(a),u(b),e}m.updateItemHTML()},close:function(){m.isOpen&&(u(F),m.isOpen=!1,m.st.removalDelay&&!m.isLowIE&&m.supportsTransition?(m.\_addClassToMFP(N),setTimeout(function(){m.\_close()},m.st.removalDelay)):m.\_close())},\_close:function(){u(w);var e=N+" "+T+" ";m.bgOverlay.detach(),m.wrap.detach(),m.container.empty(),m.st.mainClass&&(e+=m.st.mainClass+" "),m.\_removeClassFromMFP(e),m.fixedContentPos&&(e={marginRight:""},m.isIE7?c("body, html").css("overflow",""):e.overflow="",c("html").css(e)),g.off("keyup.mfp focusin"+I),m.ev.off(I),m.wrap.attr("class","mfp-wrap").removeAttr("style"),m.bgOverlay.attr("class","mfp-bg"),m.container.attr("class","mfp-container"),!m.st.showCloseBtn||m.st.closeBtnInside&&!0!==m.currTemplate[m.currItem.type]||m.currTemplate.closeBtn&&m.currTemplate.closeBtn.detach(),m.st.autoFocusLast&&m.\_lastFocusedEl&&c(m.\_lastFocusedEl).trigger("focus"),m.currItem=null,m.content=null,m.currTemplate=null,m.prevHeight=0,u("AfterClose")},updateSize:function(e){var t;m.isIOS?(t=document.documentElement.clientWidth/window.innerWidth,t=window.innerHeight\*t,m.wrap.css("height",t),m.wH=t):m.wH=e||\_.height(),m.fixedContentPos||m.wrap.css("height",m.wH),u("Resize")},updateItemHTML:function(){var e=m.items[m.index],t=(m.contentContainer.detach(),m.content&&m.content.detach(),(e=e.parsed?e:m.parseEl(m.index)).type),n=(u("BeforeChange",[m.currItem?m.currItem.type:"",t]),m.currItem=e,m.currTemplate[t]||(n=!!m.st[t]&&m.st[t].markup,u("FirstMarkupParse",n),m.currTemplate[t]=!n||c(n)),s&&s!==e.type&&m.container.removeClass("mfp-"+s+"-holder"),m["get"+t.charAt(0).toUpperCase()+t.slice(1)](e,m.currTemplate[t]));m.appendContent(n,t),e.preloaded=!0,u(j,e),s=e.type,m.container.prepend(m.contentContainer),u("AfterChange")},appendContent:function(e,t){(m.content=e)?m.st.showCloseBtn&&m.st.closeBtnInside&&!0===m.currTemplate[t]?m.content.find(".mfp-close").length||m.content.append(f()):m.content=e:m.content="",u("BeforeAppend"),m.container.addClass("mfp-"+t+"-holder"),m.contentContainer.append(m.content)},parseEl:function(e){var t,n=m.items[e];if((n=n.tagName?{el:c(n)}:(t=n.type,{data:n,src:n.src})).el){for(var o=m.types,i=0;i<o.length;i++)if(n.el.hasClass("mfp-"+o[i])){t=o[i];break}n.src=n.el.attr("data-mfp-src"),n.src||(n.src=n.el.attr("href"))}return n.type=t||m.st.type||"inline",n.index=e,n.parsed=!0,m.items[e]=n,u("ElementParse",n),m.items[e]},addGroup:function(t,n){function e(e){e.mfpEl=this,m.\_openClick(e,t,n)}var o="click.magnificPopup";(n=n||{}).mainEl=t,n.items?(n.isObj=!0,t.off(o).on(o,e)):(n.isObj=!1,n.delegate?t.off(o).on(o,n.delegate,e):(n.items=t).off(o).on(o,e))},\_openClick:function(e,t,n){var o=(void 0!==n.midClick?n:c.magnificPopup.defaults).midClick;if(o||!(2===e.which||e.ctrlKey||e.metaKey||e.altKey||e.shiftKey)){o=(void 0!==n.disableOn?n:c.magnificPopup.defaults).disableOn;if(o)if("function"==typeof o){if(!o.call(m))return!0}else if(\_.width()<o)return!0;e.type&&(e.preventDefault(),m.isOpen)&&e.stopPropagation(),n.el=c(e.mfpEl),n.delegate&&(n.items=t.find(n.delegate)),m.open(n)}},updateStatus:function(e,t){var n;m.preloader&&(o!==e&&m.container.removeClass("mfp-s-"+o),n={status:e,text:t=t||"loading"!==e?t:m.st.tLoading},u("UpdateStatus",n),e=n.status,t=n.text,m.st.allowHTMLInStatusIndicator?m.preloader.html(t):m.preloader.text(t),m.preloader.find("a").on("click",function(e){e.stopImmediatePropagation()}),m.container.addClass("mfp-s-"+e),o=e)},\_checkIfClose:function(e){if(!c(e).closest("."+k).length){var t=m.st.closeOnContentClick,n=m.st.closeOnBgClick;if(t&&n)return!0;if(!m.content||c(e).closest(".mfp-close").length||m.preloader&&e===m.preloader[0])return!0;if(e===m.content[0]||c.contains(m.content[0],e)){if(t)return!0}else if(n&&c.contains(document,e))return!0;return!1}},\_addClassToMFP:function(e){m.bgOverlay.addClass(e),m.wrap.addClass(e)},\_removeClassFromMFP:function(e){this.bgOverlay.removeClass(e),m.wrap.removeClass(e)},\_hasScrollBar:function(e){return(m.isIE7?g.height():document.body.scrollHeight)>(e||\_.height())},\_setFocus:function(){(m.st.focus?m.content.find(m.st.focus).eq(0):m.wrap).trigger("focus")},\_onFocusIn:function(e){if(e.target!==m.wrap[0]&&!c.contains(m.wrap[0],e.target))return m.\_setFocus(),!1},\_parseMarkup:function(i,e,t){var r;t.data&&(e=c.extend(t.data,e)),u(C,[i,e,t]),c.each(e,function(e,t){if(void 0===t||!1===t)return!0;var n,o;1<(r=e.split("\_")).length?0<(n=i.find(I+"-"+r[0])).length&&("replaceWith"===(o=r[1])?n[0]!==t[0]&&n.replaceWith(t):"img"===o?n.is("img")?n.attr("src",t):n.replaceWith(c("<img>").attr("src",t).attr("class",n.attr("class"))):n.attr(r[1],t)):m.st.allowHTMLInTemplate?i.find(I+"-"+e).html(t):i.find(I+"-"+e).text(t)})},\_getScrollbarSize:function(){var e;return void 0===m.scrollbarSize&&((e=document.createElement("div")).style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",document.body.appendChild(e),m.scrollbarSize=e.offsetWidth-e.clientWidth,document.body.removeChild(e)),m.scrollbarSize}},modules:[],open:function(e,t){return r(),(e=e?c.extend(!0,{},e):{}).isObj=!0,e.index=t||0,this.instance.open(e)},close:function(){return c.magnificPopup.instance&&c.magnificPopup.instance.close()},registerModule:function(e,t){t.options&&(c.magnificPopup.defaults[e]=t.options),c.extend(this.proto,t.proto),this.modules.push(e)},defaults:{disableOn:0,key:null,midClick:!1,mainClass:"",preloader:!0,focus:"",closeOnContentClick:!1,closeOnBgClick:!0,closeBtnInside:!0,showCloseBtn:!0,enableEscapeKey:!0,modal:!1,alignTop:!1,removalDelay:0,prependTo:null,fixedContentPos:"auto",fixedBgPos:"auto",overflowY:"auto",closeMarkup:'<button title="%title%" type="button" class="mfp-close">&#215;</button>',tClose:"Close (Esc)",tLoading:"Loading...",autoFocusLast:!0,allowHTMLInStatusIndicator:!1,allowHTMLInTemplate:!1}},c.fn.magnificPopup=function(e){r();var t,n,o,i=c(this);return"string"==typeof e?"open"===e?(t=P?i.data("magnificPopup"):i[0].magnificPopup,n=parseInt(arguments[1],10)||0,o=t.items?t.items[n]:(o=i,(o=t.delegate?o.find(t.delegate):o).eq(n)),m.\_openClick({mfpEl:o},i,t)):m.isOpen&&m[e].apply(m,Array.prototype.slice.call(arguments,1)):(e=c.extend(!0,{},e),P?i.data("magnificPopup",e):i[0].magnificPopup=e,m.addGroup(i,e)),i},"inline"),E=(c.magnificPopup.registerModule(S,{options:{hiddenClass:"hide",markup:"",tNotFound:"Content not found"},proto:{initInline:function(){m.types.push(S),d(w+"."+S,function(){a()})},getInline:function(e,t){var n,o,i;return a(),e.src?(n=m.st.inline,(o=c(e.src)).length?((i=o[0].parentNode)&&i.tagName&&(v||(l=n.hiddenClass,v=p(l),l="mfp-"+l),y=o.after(v).detach().removeClass(l)),m.updateStatus("ready")):(m.updateStatus("error",n.tNotFound),o=c("<div>")),e.inlineElement=o):(m.updateStatus("ready"),m.\_parseMarkup(t,{},e),t)}}}),"ajax");c.magnificPopup.registerModule(E,{options:{settings:null,cursor:"mfp-ajax-cur",tError:"The content could not be loaded."},proto:{initAjax:function(){m.types.push(E),n=m.st.ajax.cursor,d(w+"."+E,t),d("BeforeChange."+E,t)},getAjax:function(o){n&&c(document.body).addClass(n),m.updateStatus("loading");var e=c.extend({url:o.src,success:function(e,t,n){e={data:e,xhr:n};u("ParseAjax",e),m.appendContent(c(e.data),E),o.finished=!0,i(),m.\_setFocus(),setTimeout(function(){m.wrap.addClass(T)},16),m.updateStatus("ready"),u("AjaxContentAdded")},error:function(){i(),o.finished=o.loadError=!0,m.updateStatus("error",m.st.ajax.tError.replace("%url%",o.src))}},m.st.ajax.settings);return m.req=c.ajax(e),""}}});var z;c.magnificPopup.registerModule("image",{options:{markup:'<div class="mfp-figure"><div class="mfp-close"></div><figure><div class="mfp-img"></div><figcaption><div class="mfp-bottom-bar"><div class="mfp-title"></div><div class="mfp-counter"></div></div></figcaption></figure></div>',cursor:"mfp-zoom-out-cur",titleSrc:"title",verticalFit:!0,tError:"The image could not be loaded."},proto:{initImage:function(){var e=m.st.image,t=".image";m.types.push("image"),d(b+t,function(){"image"===m.currItem.type&&e.cursor&&c(document.body).addClass(e.cursor)}),d(w+t,function(){e.cursor&&c(document.body).removeClass(e.cursor),\_.off("resize"+I)}),d("Resize"+t,m.resizeImage),m.isLowIE&&d("AfterChange",m.resizeImage)},resizeImage:function(){var e,t=m.currItem;t&&t.img&&m.st.image.verticalFit&&(e=0,m.isLowIE&&(e=parseInt(t.img.css("padding-top"),10)+parseInt(t.img.css("padding-bottom"),10)),t.img.css("max-height",m.wH-e))},\_onImageHasSize:function(e){e.img&&(e.hasSize=!0,z&&clearInterval(z),e.isCheckingImgSize=!1,u("ImageHasSize",e),e.imgHidden)&&(m.content&&m.content.removeClass("mfp-loading"),e.imgHidden=!1)},findImageSize:function(t){function n(e){z&&clearInterval(z),z=setInterval(function(){0<i.naturalWidth?m.\_onImageHasSize(t):(200<o&&clearInterval(z),3===++o?n(10):40===o?n(50):100===o&&n(500))},e)}var o=0,i=t.img[0];n(1)},getImage:function(e,t){function n(){e&&(e.img.off(".mfploader"),e===m.currItem&&(m.\_onImageHasSize(e),m.updateStatus("error",a.tError.replace("%url%",e.src))),e.hasSize=!0,e.loaded=!0,e.loadError=!0)}function o(){e&&(e.img[0].complete?(e.img.off(".mfploader"),e===m.currItem&&(m.\_onImageHasSize(e),m.updateStatus("ready")),e.hasSize=!0,e.loaded=!0,u("ImageLoadComplete")):++r<200?setTimeout(o,100):n())}var i,r=0,a=m.st.image,s=t.find(".mfp-img");return s.length&&((i=document.createElement("img")).className="mfp-img",e.el&&e.el.find("img").length&&(i.alt=e.el.find("img").attr("alt")),e.img=c(i).on("load.mfploader",o).on("error.mfploader",n),i.src=e.src,s.is("img")&&(e.img=e.img.clone()),0<(i=e.img[0]).naturalWidth?e.hasSize=!0:i.width||(e.hasSize=!1)),m.\_parseMarkup(t,{title:function(e){if(e.data&&void 0!==e.data.title)return e.data.title;var t=m.st.image.titleSrc;if(t){if("function"==typeof t)return t.call(m,e);if(e.el)return e.el.attr(t)||""}return""}(e),img\_replaceWith:e.img},e),m.resizeImage(),e.hasSize?(z&&clearInterval(z),e.loadError?(t.addClass("mfp-loading"),m.updateStatus("error",a.tError.replace("%url%",e.src))):(t.removeClass("mfp-loading"),m.updateStatus("ready"))):(m.updateStatus("loading"),e.loading=!0,e.hasSize||(e.imgHidden=!0,t.addClass("mfp-loading"),m.findImageSize(e))),t}}});function O(e){var t;m.currTemplate[L]&&(t=m.currTemplate[L].find("iframe")).length&&(e||(t[0].src="//about:blank"),m.isIE8)&&t.css("display",e?"block":"none")}function M(e){var t=m.items.length;return t-1<e?e-t:e<0?t+e:e}function D(e,t,n){return e.replace(/%curr%/gi,t+1).replace(/%total%/gi,n)}c.magnificPopup.registerModule("zoom",{options:{enabled:!1,easing:"ease-in-out",duration:300,opener:function(e){return e.is("img")?e:e.find("img")}},proto:{initZoom:function(){var e,t,n,o,i,r,a=m.st.zoom,s=".zoom";a.enabled&&m.supportsTransition&&(t=a.duration,n=function(e){var e=e.clone().removeAttr("style").removeAttr("class").addClass("mfp-animated-image"),t="all "+a.duration/1e3+"s "+a.easing,n={position:"fixed",zIndex:9999,left:0,top:0,"-webkit-backface-visibility":"hidden"},o="transition";return n["-webkit-"+o]=n["-moz-"+o]=n["-o-"+o]=n[o]=t,e.css(n),e},o=function(){m.content.css("visibility","visible")},d("BuildControls"+s,function(){m.\_allowZoom()&&(clearTimeout(i),m.content.css("visibility","hidden"),(e=m.\_getItemToZoom())?((r=n(e)).css(m.\_getOffset()),m.wrap.append(r),i=setTimeout(function(){r.css(m.\_getOffset(!0)),i=setTimeout(function(){o(),setTimeout(function(){r.remove(),e=r=null,u("ZoomAnimationEnded")},16)},t)},16)):o())}),d(F+s,function(){if(m.\_allowZoom()){if(clearTimeout(i),m.st.removalDelay=t,!e){if(!(e=m.\_getItemToZoom()))return;r=n(e)}r.css(m.\_getOffset(!0)),m.wrap.append(r),m.content.css("visibility","hidden"),setTimeout(function(){r.css(m.\_getOffset())},16)}}),d(w+s,function(){m.\_allowZoom()&&(o(),r&&r.remove(),e=null)}))},\_allowZoom:function(){return"image"===m.currItem.type},\_getItemToZoom:function(){return!!m.currItem.hasSize&&m.currItem.img},\_getOffset:function(e){var e=e?m.currItem.img:m.st.zoom.opener(m.currItem.el||m.currItem),t=e.offset(),n=parseInt(e.css("padding-top"),10),o=parseInt(e.css("padding-bottom"),10),e=(t.top-=c(window).scrollTop()-n,{width:e.width(),height:(P?e.innerHeight():e[0].offsetHeight)-o-n});return(B=void 0===B?void 0!==document.createElement("p").style.MozTransform:B)?e["-moz-transform"]=e.transform="translate("+t.left+"px,"+t.top+"px)":(e.left=t.left,e.top=t.top),e}}});var B,L="iframe",H=(c.magnificPopup.registerModule(L,{options:{markup:'<div class="mfp-iframe-scaler"><div class="mfp-close"></div><iframe class="mfp-iframe" src="//about:blank" frameborder="0" allowfullscreen></iframe></div>',srcAction:"iframe\_src",patterns:{youtube:{index:"youtube.com",id:"v=",src:"//www.youtube.com/embed/%id%?autoplay=1"},vimeo:{index:"vimeo.com/",id:"/",src:"//player.vimeo.com/video/%id%?autoplay=1"},gmaps:{index:"//maps.google.",src:"%id%&output=embed"}}},proto:{initIframe:function(){m.types.push(L),d("BeforeChange",function(e,t,n){t!==n&&(t===L?O():n===L&&O(!0))}),d(w+"."+L,function(){O()})},getIframe:function(e,t){var n=e.src,o=m.st.iframe,i=(c.each(o.patterns,function(){if(-1<n.indexOf(this.index))return this.id&&(n="string"==typeof this.id?n.substr(n.lastIndexOf(this.id)+this.id.length,n.length):this.id.call(this,n)),n=this.src.replace("%id%",n),!1}),{});return o.srcAction&&(i[o.srcAction]=n),m.\_parseMarkup(t,i,e),m.updateStatus("ready"),t}}}),c.magnificPopup.registerModule("gallery",{options:{enabled:!1,arrowMarkup:'<button title="%title%" type="button" class="mfp-arrow mfp-arrow-%dir%"></button>',preload:[0,2],navigateByImgClick:!0,arrows:!0,tPrev:"Previous (Left arrow key)",tNext:"Next (Right arrow key)",tCounter:"%curr% of %total%",langDir:null,loop:!0},proto:{initGallery:function(){var r=m.st.gallery,e=".mfp-gallery";if(m.direction=!0,!r||!r.enabled)return!1;r.langDir||(r.langDir=document.dir||"ltr"),h+=" mfp-gallery",d(b+e,function(){r.navigateByImgClick&&m.wrap.on("click"+e,".mfp-img",function(){if(1<m.items.length)return m.next(),!1}),g.on("keydown"+e,function(e){37===e.keyCode?"rtl"===r.langDir?m.next():m.prev():39===e.keyCode&&("rtl"===r.langDir?m.prev():m.next())}),m.updateGalleryButtons()}),d("UpdateStatus"+e,function(){m.updateGalleryButtons()}),d("UpdateStatus"+e,function(e,t){t.text&&(t.text=D(t.text,m.currItem.index,m.items.length))}),d(C+e,function(e,t,n,o){var i=m.items.length;n.counter=1<i?D(r.tCounter,o.index,i):""}),d("BuildControls"+e,function(){var e,t,n,o,i;1<m.items.length&&r.arrows&&!m.arrowLeft&&(t="rtl"===r.langDir?(o=r.tNext,e=r.tPrev,i="next","prev"):(o=r.tPrev,e=r.tNext,i="prev","next"),n=r.arrowMarkup,o=m.arrowLeft=c(n.replace(/%title%/gi,o).replace(/%action%/gi,i).replace(/%dir%/gi,"left")).addClass(k),i=m.arrowRight=c(n.replace(/%title%/gi,e).replace(/%action%/gi,t).replace(/%dir%/gi,"right")).addClass(k),"rtl"===r.langDir?(m.arrowNext=o,m.arrowPrev=i):(m.arrowNext=i,m.arrowPrev=o),o.on("click",function(){"rtl"===r.langDir?m.next():m.prev()}),i.on("click",function(){"rtl"===r.langDir?m.prev():m.next()}),m.container.append(o.add(i)))}),d(j+e,function(){m.\_preloadTimeout&&clearTimeout(m.\_preloadTimeout),m.\_preloadTimeout=setTimeout(function(){m.preloadNearbyImages(),m.\_preloadTimeout=null},16)}),d(w+e,function(){g.off(e),m.wrap.off("click"+e),m.arrowRight=m.arrowLeft=null})},next:function(){var e=M(m.index+1);if(!m.st.gallery.loop&&0===e)return!1;m.direction=!0,m.index=e,m.updateItemHTML()},prev:function(){var e=m.index-1;if(!m.st.gallery.loop&&e<0)return!1;m.direction=!1,m.index=M(e),m.updateItemHTML()},goTo:function(e){m.direction=e>=m.index,m.index=e,m.updateItemHTML()},preloadNearbyImages:function(){for(var e=m.st.gallery.preload,t=Math.min(e[0],m.items.length),n=Math.min(e[1],m.items.length),o=1;o<=(m.direction?n:t);o++)m.\_preloadItem(m.index+o);for(o=1;o<=(m.direction?t:n);o++)m.\_preloadItem(m.index-o)},\_preloadItem:function(e){var t;e=M(e),m.items[e].preloaded||((t=m.items[e]).parsed||(t=m.parseEl(e)),u("LazyLoad",t),"image"===t.type&&(t.img=c('<img class="mfp-img" />').on("load.mfploader",function(){t.hasSize=!0}).on("error.mfploader",function(){t.hasSize=!0,t.loadError=!0,u("LazyLoadError",t)}).attr("src",t.src)),t.preloaded=!0)},updateGalleryButtons:function(){m.st.gallery.loop||"object"!=typeof m.arrowPrev||null===m.arrowPrev||(0===m.index?m.arrowPrev.hide():m.arrowPrev.show(),m.index===m.items.length-1?m.arrowNext.hide():m.arrowNext.show())}}}),"retina");c.magnificPopup.registerModule(H,{options:{replaceSrc:function(e){return e.src.replace(/\.\w+$/,function(e){return"@2x"+e})},ratio:1},proto:{initRetina:function(){var n,o;1<window.devicePixelRatio&&(n=m.st.retina,o=n.ratio,1<(o=isNaN(o)?o():o))&&(d("ImageHasSize."+H,function(e,t){t.img.css({"max-width":t.img[0].naturalWidth/o,width:"100%"})}),d("ElementParse."+H,function(e,t){t.src=n.replaceSrc(t,o)}))}}}),r()}); |
* ## [responsive-lightbox/trunk/assets/magnific/magnific-popup.css](/changeset/3137531/responsive-lightbox/trunk/assets/magnific/magnific-popup.css "Show the changeset 3137531 restricted to responsive-lightbox/trunk/assets/magnific/magnific-popup.css")

  | [r1869902](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L9 "Show revision 1869902 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L9 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 9 | 9 | position: fixed; |
  | 10 | 10 | background: #0b0b0b; |
  | 11 |  | opacity: 0.8; } |
  |  | 11 | opacity: 0.8; |
  |  | 12 | } |
  | 12 | 13 |  |
  | 13 | 14 | .mfp-wrap { |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L19) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L20) |  |
  | 19 | 20 | position: fixed; |
  | 20 | 21 | outline: none !important; |
  | 21 |  | -webkit-backface-visibility: hidden; } |
  |  | 22 | -webkit-backface-visibility: hidden; |
  |  | 23 | } |
  | 22 | 24 |  |
  | 23 | 25 | .mfp-container { |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L29) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L31) |  |
  | 29 | 31 | top: 0; |
  | 30 | 32 | padding: 0 8px; |
  | 31 |  | box-sizing: border-box; } |
  |  | 33 | box-sizing: border-box; |
  |  | 34 | } |
  | 32 | 35 |  |
  | 33 | 36 | .mfp-container:before { |
  | 34 |  | content: ~~''~~; |
  |  | 37 | content: ""; |
  | 35 | 38 | display: inline-block; |
  | 36 | 39 | height: 100%; |
  | 37 |  | vertical-align: middle; } |
  |  | 40 | vertical-align: middle; |
  |  | 41 | } |
  | 38 | 42 |  |
  | 39 | 43 | .mfp-align-top .mfp-container:before { |
  | 40 |  | display: none; } |
  |  | 44 | display: none; |
  |  | 45 | } |
  | 41 | 46 |  |
  | 42 | 47 | .mfp-content { |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L46) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L51) |  |
  | 46 | 51 | margin: 0 auto; |
  | 47 | 52 | text-align: left; |
  | 48 |  | z-index: 1045; } |
  |  | 53 | z-index: 1045; |
  |  | 54 | } |
  | 49 | 55 |  |
  | 50 | 56 | .mfp-inline-holder .mfp-content, |
  | 51 | 57 | .mfp-ajax-holder .mfp-content { |
  | 52 |  | max-width: 80%; |
  | 53 |  | max-height: 80%; |
  |  | 58 | width: 100%; |
  | 54 | 59 | cursor: auto; |
  | 55 | 60 | } |
  | 56 | 61 |  |
  | 57 |  | ~~.mfp-inline-holder .mfp-content {~~ |
  | 58 |  | ~~position: relative;~~ |
  | 59 |  | ~~background: #fff;~~ |
  | 60 |  | ~~padding: 20px;~~ |
  | 61 |  | ~~width: auto;~~ |
  | 62 |  | ~~max-width: 500px;~~ |
  | 63 |  | ~~margin: 20px auto;~~ |
  | 64 |  | ~~}~~ |
  | 65 |  |  |
  | 66 | 62 | .mfp-ajax-cur { |
  | 67 |  | cursor: progress; } |
  |  | 63 | cursor: progress; |
  |  | 64 | } |
  | 68 | 65 |  |
  | 69 | 66 | .mfp-zoom-out-cur, .mfp-zoom-out-cur .mfp-image-holder .mfp-close { |
  | 70 | 67 | cursor: -moz-zoom-out; |
  | 71 | 68 | cursor: -webkit-zoom-out; |
  | 72 |  | cursor: zoom-out; } |
  |  | 69 | cursor: zoom-out; |
  |  | 70 | } |
  | 73 | 71 |  |
  | 74 | 72 | .mfp-zoom { |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L76) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L74) |  |
  | 76 | 74 | cursor: -webkit-zoom-in; |
  | 77 | 75 | cursor: -moz-zoom-in; |
  | 78 |  | cursor: zoom-in; } |
  |  | 76 | cursor: zoom-in; |
  |  | 77 | } |
  | 79 | 78 |  |
  | 80 | 79 | .mfp-auto-cursor .mfp-content { |
  | 81 |  | cursor: auto; } |
  |  | 80 | cursor: auto; |
  |  | 81 | } |
  | 82 | 82 |  |
  | 83 | 83 | .mfp-close, |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L87) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L87) |  |
  | 87 | 87 | -webkit-user-select: none; |
  | 88 | 88 | -moz-user-select: none; |
  | 89 |  | user-select: none; } |
  |  | 89 | user-select: none; |
  |  | 90 | } |
  | 90 | 91 |  |
  | 91 | 92 | .mfp-loading.mfp-figure { |
  | 92 |  | display: none; } |
  |  | 93 | display: none; |
  |  | 94 | } |
  | 93 | 95 |  |
  | 94 | 96 | .mfp-hide { |
  | 95 |  | display: none !important; } |
  |  | 97 | display: none !important; |
  |  | 98 | } |
  | 96 | 99 |  |
  | 97 | 100 | .mfp-preloader { |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L104) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L107) |  |
  | 104 | 107 | left: 8px; |
  | 105 | 108 | right: 8px; |
  | 106 |  | z-index: 1044; } |
  |  | 109 | z-index: 1044; |
  |  | 110 | } |
  |  | 111 |  |
  | 107 | 112 | .mfp-preloader a { |
  | 108 |  | color: #CCC; } |
  |  | 113 | color: #CCC; |
  |  | 114 | } |
  |  | 115 |  |
  | 109 | 116 | .mfp-preloader a:hover { |
  | 110 |  | color: #FFF; } |
  |  | 117 | color: #FFF; |
  |  | 118 | } |
  | 111 | 119 |  |
  | 112 | 120 | .mfp-s-ready .mfp-preloader { |
  | 113 |  | display: none; } |
  |  | 121 | display: none; |
  |  | 122 | } |
  | 114 | 123 |  |
  | 115 | 124 | .mfp-s-error .mfp-content { |
  | 116 |  | ~~display: none; }~~ |
  | 117 |  |  |
  | 118 |  | button.mfp-close, |
  | 119 |  | button.mfp-arrow { |
  |  | 125 |  |
  |  | 126 | display: none; |
  |  | 127 | } |
  |  | 128 | button.mfp-close, button.mfp-arrow { |
  | 120 | 129 | overflow: visible; |
  | 121 | 130 | cursor: pointer; |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L128) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L137) |  |
  | 128 | 137 | z-index: 1046; |
  | 129 | 138 | box-shadow: none; |
  | 130 |  | touch-action: manipulation; } |
  |  | 139 | touch-action: manipulation; |
  |  | 140 | } |
  | 131 | 141 |  |
  | 132 | 142 | button::-moz-focus-inner { |
  | 133 | 143 | padding: 0; |
  | 134 |  | border: 0; } |
  |  | 144 | border: 0; |
  |  | 145 | } |
  | 135 | 146 |  |
  | 136 | 147 | .mfp-close { |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L148) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L159) |  |
  | 148 | 159 | font-style: normal; |
  | 149 | 160 | font-size: 28px; |
  | 150 |  | font-family: Arial, Baskerville, monospace; } |
  | 151 |  | .mfp-close:hover, |
  | 152 |  | .mfp-close:focus { |
  | 153 |  | opacity: 1; } |
  |  | 161 | font-family: Arial, Baskerville, monospace; |
  |  | 162 | } |
  |  | 163 |  |
  |  | 164 | .mfp-close:hover, .mfp-close:focus { |
  |  | 165 | opacity: 1; |
  |  | 166 | } |
  |  | 167 |  |
  | 154 | 168 | .mfp-close:active { |
  | 155 |  | top: 1px; } |
  |  | 169 | top: 1px; |
  |  | 170 | } |
  | 156 | 171 |  |
  | 157 | 172 | .mfp-close-btn-in .mfp-close { |
  | 158 |  | color: #333; } |
  |  | 173 | color: #333; |
  |  | 174 | } |
  | 159 | 175 |  |
  | 160 | 176 | .mfp-image-holder .mfp-close, |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L164) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L180) |  |
  | 164 | 180 | text-align: right; |
  | 165 | 181 | padding-right: 6px; |
  | 166 |  | width: 100%; } |
  |  | 182 | width: 100%; |
  |  | 183 | } |
  | 167 | 184 |  |
  | 168 | 185 | .mfp-counter { |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L173) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L190) |  |
  | 173 | 190 | font-size: 12px; |
  | 174 | 191 | line-height: 18px; |
  | 175 |  | white-space: nowrap; } |
  |  | 192 | white-space: nowrap; |
  |  | 193 | } |
  | 176 | 194 |  |
  | 177 | 195 | .mfp-arrow { |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L184) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L202) |  |
  | 184 | 202 | width: 90px; |
  | 185 | 203 | height: 110px; |
  | 186 |  | -webkit-tap-highlight-color: transparent; } |
  |  | 204 | -webkit-tap-highlight-color: rgba(0, 0, 0, 0); |
  |  | 205 | } |
  |  | 206 |  |
  | 187 | 207 | .mfp-arrow:active { |
  | 188 |  | margin-top: -54px; } |
  | 189 |  | .mfp-arrow:hover, |
  | 190 |  | .mfp-arrow:focus { |
  | 191 |  | opacity: 1; } |
  | 192 |  | .mfp-arrow:before, |
  |  | 208 | margin-top: -54px; |
  |  | 209 | } |
  |  | 210 |  |
  |  | 211 | .mfp-arrow:hover, .mfp-arrow:focus { |
  |  | 212 | opacity: 1; |
  |  | 213 | } |
  |  | 214 |  |
  |  | 215 | .mfp-arrow:before, .mfp-arrow:after { |
  |  | 216 | content: ""; |
  |  | 217 | display: block; |
  |  | 218 | width: 0; |
  |  | 219 | height: 0; |
  |  | 220 | position: absolute; |
  |  | 221 | left: 0; |
  |  | 222 | top: 0; |
  |  | 223 | margin-top: 35px; |
  |  | 224 | margin-left: 35px; |
  |  | 225 | border: medium inset transparent; |
  |  | 226 | } |
  |  | 227 |  |
  | 193 | 228 | .mfp-arrow:after { |
  | 194 |  | content: ''; |
  | 195 |  | display: block; |
  | 196 |  | width: 0; |
  | 197 |  | height: 0; |
  | 198 |  | position: absolute; |
  | 199 |  | left: 0; |
  | 200 |  | top: 0; |
  | 201 |  | margin-top: 35px; |
  | 202 |  | margin-left: 35px; |
  | 203 |  | border: medium inset transparent; } |
  | 204 |  | .mfp-arrow:after { |
  | 205 |  | border-top-width: 13px; |
  | 206 |  | border-bottom-width: 13px; |
  | 207 |  | top: 8px; } |
  |  | 229 | border-top-width: 13px; |
  |  | 230 | border-bottom-width: 13px; |
  |  | 231 | top: 8px; |
  |  | 232 | } |
  |  | 233 |  |
  | 208 | 234 | .mfp-arrow:before { |
  | 209 |  | border-top-width: 21px; |
  | 210 |  | border-bottom-width: 21px; |
  | 211 |  | opacity: 0.7; } |
  |  | 235 | border-top-width: 21px; |
  |  | 236 | border-bottom-width: 21px; |
  |  | 237 | opacity: 0.7; |
  |  | 238 | } |
  | 212 | 239 |  |
  | 213 | 240 | .mfp-arrow-left { |
  | 214 |  | left: 0; } |
  |  | 241 | left: 0; |
  |  | 242 | } |
  |  | 243 |  |
  | 215 | 244 | .mfp-arrow-left:after { |
  | 216 |  | border-right: 17px solid #FFF; |
  | 217 |  | margin-left: 31px; } |
  |  | 245 | border-right: 17px solid #FFF; |
  |  | 246 | margin-left: 31px; |
  |  | 247 | } |
  |  | 248 |  |
  | 218 | 249 | .mfp-arrow-left:before { |
  | 219 |  | margin-left: 25px; |
  | 220 |  | border-right: 27px solid #3F3F3F; } |
  |  | 250 | margin-left: 25px; |
  |  | 251 | border-right: 27px solid #3F3F3F; |
  |  | 252 | } |
  | 221 | 253 |  |
  | 222 | 254 | .mfp-arrow-right { |
  | 223 |  | right: 0; } |
  |  | 255 | right: 0; |
  |  | 256 | } |
  |  | 257 |  |
  | 224 | 258 | .mfp-arrow-right:after { |
  | 225 |  | border-left: 17px solid #FFF; |
  | 226 |  | margin-left: 39px; } |
  |  | 259 | border-left: 17px solid #FFF; |
  |  | 260 | margin-left: 39px; |
  |  | 261 | } |
  |  | 262 |  |
  | 227 | 263 | .mfp-arrow-right:before { |
  | 228 |  | border-left: 27px solid #3F3F3F; } |
  |  | 264 | border-left: 27px solid #3F3F3F; |
  |  | 265 | } |
  | 229 | 266 |  |
  | 230 | 267 | .mfp-iframe-holder { |
  | 231 | 268 | padding-top: 40px; |
  | 232 |  | padding-bottom: 40px; } |
  |  | 269 | padding-bottom: 40px; |
  |  | 270 | } |
  |  | 271 |  |
  | 233 | 272 | .mfp-iframe-holder .mfp-content { |
  | 234 |  | line-height: 0; |
  | 235 |  | width: 100%; |
  | 236 |  | max-width: 900px; } |
  |  | 273 | line-height: 0; |
  |  | 274 | width: 100%; |
  |  | 275 | max-width: 900px; |
  |  | 276 | } |
  |  | 277 |  |
  | 237 | 278 | .mfp-iframe-holder .mfp-close { |
  | 238 |  | top: -40px; } |
  |  | 279 | top: -40px; |
  |  | 280 | } |
  | 239 | 281 |  |
  | 240 | 282 | .mfp-iframe-scaler { |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L242) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L284) |  |
  | 242 | 284 | height: 0; |
  | 243 | 285 | overflow: hidden; |
  | 244 |  | padding-top: 56.25%; } |
  |  | 286 | padding-top: 56.25%; |
  |  | 287 | } |
  |  | 288 |  |
  | 245 | 289 | .mfp-iframe-scaler iframe { |
  | 246 |  | position: absolute; |
  | 247 |  | display: block; |
  | 248 |  | top: 0; |
  | 249 |  | left: 0; |
  | 250 |  | width: 100%; |
  | 251 |  | height: 100%; |
  | 252 |  | box-shadow: 0 0 8px rgba(0, 0, 0, 0.6); |
  | 253 |  | background: #000; } |
  |  | 290 | position: absolute; |
  |  | 291 | display: block; |
  |  | 292 | top: 0; |
  |  | 293 | left: 0; |
  |  | 294 | width: 100%; |
  |  | 295 | height: 100%; |
  |  | 296 | box-shadow: 0 0 8px rgba(0, 0, 0, 0.6); |
  |  | 297 | background: #000; |
  |  | 298 | } |
  | 254 | 299 |  |
  | 255 | 300 | /\* Main image in popup \*/ |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L262) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L307) |  |
  | 262 | 307 | box-sizing: border-box; |
  | 263 | 308 | padding: 40px 0 40px; |
  | 264 |  | margin: 0 auto; } |
  |  | 309 | margin: 0 auto; |
  |  | 310 | } |
  | 265 | 311 |  |
  | 266 | 312 | /\* The shadow behind the image \*/ |
  | 267 | 313 | .mfp-figure { |
  | 268 |  | line-height: 0; } |
  |  | 314 | line-height: 0; |
  |  | 315 | } |
  |  | 316 |  |
  | 269 | 317 | .mfp-figure:after { |
  | 270 |  | content: ''; |
  | 271 |  | position: absolute; |
  | 272 |  | left: 0; |
  | 273 |  | top: 40px; |
  | 274 |  | bottom: 40px; |
  | 275 |  | display: block; |
  | 276 |  | right: 0; |
  | 277 |  | width: auto; |
  | 278 |  | height: auto; |
  | 279 |  | z-index: -1; |
  | 280 |  | box-shadow: 0 0 8px rgba(0, 0, 0, 0.6); |
  | 281 |  | background: #444; } |
  |  | 318 | content: ""; |
  |  | 319 | position: absolute; |
  |  | 320 | left: 0; |
  |  | 321 | top: 40px; |
  |  | 322 | bottom: 40px; |
  |  | 323 | display: block; |
  |  | 324 | right: 0; |
  |  | 325 | width: auto; |
  |  | 326 | height: auto; |
  |  | 327 | z-index: -1; |
  |  | 328 | box-shadow: 0 0 8px rgba(0, 0, 0, 0.6); |
  |  | 329 | background: #444; |
  |  | 330 | } |
  |  | 331 |  |
  | 282 | 332 | .mfp-figure small { |
  | 283 |  | color: #BDBDBD; |
  | 284 |  | display: block; |
  | 285 |  | font-size: 12px; |
  | 286 |  | line-height: 14px; } |
  |  | 333 | color: #BDBDBD; |
  |  | 334 | display: block; |
  |  | 335 | font-size: 12px; |
  |  | 336 | line-height: 14px; |
  |  | 337 | } |
  |  | 338 |  |
  | 287 | 339 | .mfp-figure figure { |
  | 288 |  | margin: 0; } |
  |  | 340 | margin: 0; |
  |  | 341 | } |
  | 289 | 342 |  |
  | 290 | 343 | .mfp-bottom-bar { |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L294) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L347) |  |
  | 294 | 347 | left: 0; |
  | 295 | 348 | width: 100%; |
  | 296 |  | cursor: auto; } |
  |  | 349 | cursor: auto; |
  |  | 350 | } |
  | 297 | 351 |  |
  | 298 | 352 | .mfp-title { |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L301) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L355) |  |
  | 301 | 355 | color: #F3F3F3; |
  | 302 | 356 | word-wrap: break-word; |
  | 303 |  | padding-right: 36px; } |
  |  | 357 | padding-right: 36px; |
  |  | 358 | } |
  | 304 | 359 |  |
  | 305 | 360 | .mfp-image-holder .mfp-content { |
  | 306 |  | max-width: 100%; } |
  |  | 361 | max-width: 100%; |
  |  | 362 | } |
  | 307 | 363 |  |
  | 308 | 364 | .mfp-gallery .mfp-image-holder .mfp-figure { |
  | 309 |  | cursor: pointer; } |
  |  | 365 | cursor: pointer; |
  |  | 366 | } |
  | 310 | 367 |  |
  | 311 | 368 | @media screen and (max-width: 800px) and (orientation: landscape), screen and (max-height: 300px) { |
  | 312 | 369 | /\*\* |
  | 313 |  | \* Remove all paddings around the image on small screen |
  | 314 |  | \*/ |
  |  | 370 | \* Remove all paddings around the image on small screen |
  |  | 371 | \*/ |
  | 315 | 372 | .mfp-img-mobile .mfp-image-holder { |
  | 316 | 373 | padding-left: 0; |
  | 317 |  | padding-right: 0; } |
  |  | 374 | padding-right: 0; |
  |  | 375 | } |
  | 318 | 376 | .mfp-img-mobile img.mfp-img { |
  | 319 |  | padding: 0; } |
  |  | 377 | padding: 0; |
  |  | 378 | } |
  | 320 | 379 | .mfp-img-mobile .mfp-figure:after { |
  | 321 | 380 | top: 0; |
  | 322 |  | bottom: 0; } |
  |  | 381 | bottom: 0; |
  |  | 382 | } |
  | 323 | 383 | .mfp-img-mobile .mfp-figure small { |
  | 324 | 384 | display: inline; |
  | 325 |  | margin-left: 5px; } |
  |  | 385 | margin-left: 5px; |
  |  | 386 | } |
  | 326 | 387 | .mfp-img-mobile .mfp-bottom-bar { |
  | 327 | 388 | background: rgba(0, 0, 0, 0.6); |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L331) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L392) |  |
  | 331 | 392 | padding: 3px 5px; |
  | 332 | 393 | position: fixed; |
  | 333 |  | box-sizing: border-box; } |
  | 334 |  | .mfp-img-mobile .mfp-bottom-bar:empty { |
  | 335 |  | padding: 0; } |
  |  | 394 | box-sizing: border-box; |
  |  | 395 | } |
  |  | 396 | .mfp-img-mobile .mfp-bottom-bar:empty { |
  |  | 397 | padding: 0; |
  |  | 398 | } |
  | 336 | 399 | .mfp-img-mobile .mfp-counter { |
  | 337 | 400 | right: 5px; |
  | 338 |  | top: 3px; } |
  |  | 401 | top: 3px; |
  |  | 402 | } |
  | 339 | 403 | .mfp-img-mobile .mfp-close { |
  | 340 | 404 | top: 0; |
  | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=1869902#L346) | […](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.css?rev=3137531#L410) |  |
  | 346 | 410 | position: fixed; |
  | 347 | 411 | text-align: center; |
  | 348 |  | padding: 0; } } |
  |  | 412 | padding: 0; |
  |  | 413 | } |
  |  | 414 | } |
  | 349 | 415 |  |
  | 350 | 416 | @media all and (max-width: 900px) { |
  | 351 | 417 | .mfp-arrow { |
  | 352 | 418 | -webkit-transform: scale(0.75); |
  | 353 |  | transform: scale(0.75); } |
  |  | 419 | transform: scale(0.75); |
  |  | 420 | } |
  | 354 | 421 | .mfp-arrow-left { |
  | 355 | 422 | -webkit-transform-origin: 0; |
  | 356 |  | transform-origin: 0; } |
  |  | 423 | transform-origin: 0; |
  |  | 424 | } |
  | 357 | 425 | .mfp-arrow-right { |
  | 358 | 426 | -webkit-transform-origin: 100%; |
  | 359 |  | transform-origin: 100%; } |
  |  | 427 | transform-origin: 100%; |
  |  | 428 | } |
  | 360 | 429 | .mfp-container { |
  | 361 | 430 | padding-left: 6px; |
  | 362 |  | padding-right: 6px; } } |
  |  | 431 | padding-right: 6px; |
  |  | 432 | } |
  |  | 433 | } |
  |  | 434 |  |
  |  | 435 | /\*# sourceMappingURL=magnific-popup.css.map \*/ |
* ## [responsive-lightbox/trunk/assets/magnific/magnific-popup.min.css](/changeset/3137531/responsive-lightbox/trunk/assets/magnific/magnific-popup.min.css "Show the changeset 3137531 restricted to responsive-lightbox/trunk/assets/magnific/magnific-popup.min.css")

  | [r1869902](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.min.css?rev=1869902#L1 "Show revision 1869902 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/assets/magnific/magnific-popup.min.css?rev=3137531#L1 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | .mfp-bg,.mfp-container,.mfp-wrap{~~width:100%;left:0;top:0;height:100%}.mfp-arrow:after,.mfp-arrow:before,.mfp-container:before,.mfp-figure:after{content:''}.mfp-bg{z-index:1042;overflow:hidden;position:fixed;background:#0b0b0b;opacity:.8}.mfp-wrap{z-index:1043;position:fixed;outline:0!important;-webkit-backface-visibility:hidden}.mfp-container{text-align:center;position:absolute;padding:0 8px;box-sizing:border-box}.mfp-container:before{display:inline-block;height:100%;vertical-align:middle}.mfp-align-top .mfp-container:before{display:none}.mfp-content{position:relative;display:inline-block;vertical-align:middle;margin:0 auto;text-align:left;z-index:1045}.mfp-ajax-holder .mfp-content,.mfp-inline-holder .mfp-content{max-width:80%;max-height:80%;cursor:auto}.mfp-inline-holder .mfp-content{position:relative;background:#fff;padding:20px;width:auto;max-width:500px;margin:20px auto}.mfp-ajax-cur{cursor:progress}.mfp-zoom-out-cur,.mfp-zoom-out-cur .mfp-image-holder .mfp-close{cursor:-moz-zoom-out;cursor:-webkit-zoom-out;cursor:zoom-out}.mfp-zoom{cursor:pointer;cursor:-webkit-zoom-in;cursor:-moz-zoom-in;cursor:zoom-in}.mfp-auto-cursor .mfp-content{cursor:auto}.mfp-arrow,.mfp-close,.mfp-counter,.mfp-preloader{-webkit-user-select:none;-moz-user-select:none;user-select:none}.mfp-loading.mfp-figure{display:none}.mfp-hide{display:none!important}.mfp-preloader{color:#CCC;position:absolute;top:50%;width:auto;text-align:center;margin-top:-.8em;left:8px;right:8px;z-index:1044}.mfp-preloader a{color:#CCC}.mfp-close,.mfp-preloader a:hover{color:#FFF}.mfp-s-error .mfp-content,.mfp-s-ready .mfp-preloader{display:none}button.mfp-arrow,button.mfp-close{overflow:visible;cursor:pointer;background:0 0;border:0;-webkit-appearance:none;display:block;outline:0;padding:0;z-index:1046;box-shadow:none;touch-action:manipulation}.mfp-figure:after,.mfp-iframe-scaler iframe{box-shadow:0 0 8px rgba(0,0,0,.6);position:absolute;left:0}button::-moz-focus-inner{padding:0;border:0}.mfp-close{width:44px;height:44px;line-height:44px;position:absolute;right:0;top:0;text-decoration:none;text-align:center;opacity:.65;padding:0 0 18px 10px;font-style:normal;font-size:28px;font-family:Arial,Baskerville,monospace}.mfp-close:focus,.mfp-close:hover{opacity:1}.mfp-close:active{top:1px}.mfp-close-btn-in .mfp-close{color:#333}.mfp-iframe-holder .mfp-close,.mfp-image-holder .mfp-close{color:#FFF;right:-6px;text-align:right;padding-right:6px;width:100%}.mfp-counter{position:absolute;top:0;right:0;color:#CCC;font-size:12px;line-height:18px;white-space:nowrap}.mfp-figure,img.mfp-img{line-height:0}.mfp-arrow{position:absolute;opacity:.65;margin:-55px 0 0;top:50%;padding:0;width:90px;height:110px;-webkit-tap-highlight-color:transparent}.mfp-arrow:active{margin-top:-54px}.mfp-arrow:focus,.mfp-arrow:hover{opacity:1}.mfp-arrow:after,.mfp-arrow:before{display:block;width:0;height:0;position:absolute;left:0;top:0;margin-top:35px;margin-left:35px;border:inset transparent}.mfp-arrow:after{border-top-width:13px;border-bottom-width:13px;top:8px}.mfp-arrow:before{border-top-width:21px;border-bottom-width:21px;opacity:.7}.mfp-arrow-left{left:0}.mfp-arrow-left:after{border-right:17px solid #FFF;margin-left:31px}.mfp-arrow-left:before{margin-left:25px;border-right:27px solid #3F3F3F}.mfp-arrow-right{right:0}.mfp-arrow-right:after{border-left:17px solid #FFF;margin-left:39px}.mfp-arrow-right:before{border-left:27px solid #3F3F3F}.mfp-iframe-holder{padding-top:40px;padding-bottom:40px}.mfp-iframe-holder .mfp-content{line-height:0;width:100%;max-width:900px}.mfp-image-holder .mfp-content,img.mfp-img{max-width:100%}.mfp-iframe-holder .mfp-close{top:-40px}.mfp-iframe-scaler{width:100%;height:0;overflow:hidden;padding-top:56.25%}.mfp-iframe-scaler iframe{display:block;top:0;width:100%;height:100%;background:#000}.mfp-figure:after,img.mfp-img{width:auto;height:auto;display:block}img.mfp-img{box-sizing:border-box;padding:40px 0;margin:0 auto}.mfp-figure:after{top:40px;bottom:40px;right:0;z-index:-1;background:#444}.mfp-figure small{color:#BDBDBD;display:block;font-size:12px;line-height:14px}.mfp-figure figure{margin:0}.mfp-bottom-bar{margin-top:-36px;position:absolute;top:100%;left:0;width:100%;cursor:auto}.mfp-title{text-align:left;line-height:18px;color:#F3F3F3;word-wrap:break-word;padding-right:36px}.mfp-gallery .mfp-image-holder .mfp-figure{cursor:pointer}@media screen and (max-width:800px) and (orientation:landscape),screen and (max-height:300px){.mfp-img-mobile .mfp-image-holder{padding-left:0;padding-right:0}.mfp-img-mobile img.mfp-img{padding:0}.mfp-img-mobile .mfp-figure:after{top:0;bottom:0}.mfp-img-mobile .mfp-figure small{display:inline;margin-left:5px}.mfp-img-mobile .mfp-bottom-bar{background:rgba(0,0,0,.6);bottom:0;margin:0;top:auto;padding:3px 5px;position:fixed;box-sizing:border-box}.mfp-img-mobile .mfp-bottom-bar:empty{padding:0~~}.mfp-img-mobile .mfp-counter{right:5px;top:3px}.mfp-img-mobile .mfp-close{top:0;right:0;width:35px;height:35px;line-height:35px;background:rgba(0,0,0,.6);position:fixed;text-align:center;padding:0}}@media all and (max-width:900px){.mfp-arrow{-webkit-transform:scale(.75);transform:scale(.75)}.mfp-arrow-left{-webkit-transform-origin:0;transform-origin:0}.mfp-arrow-right{-webkit-transform-origin:100%;transform-origin:100%}.mfp-container{padding-left:6px;padding-right:6px}} |
  |  | 1 | .mfp-bg,.mfp-container,.mfp-wrap{left:0;top:0;width:100%;height:100%}.mfp-container:before,.mfp-content{display:inline-block;vertical-align:middle}.mfp-bg{z-index:1042;overflow:hidden;position:fixed;background:#0b0b0b;opacity:.8}.mfp-wrap{z-index:1043;position:fixed;outline:0!important;-webkit-backface-visibility:hidden}.mfp-container{text-align:center;position:absolute;padding:0 8px;box-sizing:border-box}.mfp-container:before{content:"";height:100%}.mfp-align-top .mfp-container:before,.mfp-loading.mfp-figure,.mfp-s-error .mfp-content,.mfp-s-ready .mfp-preloader{display:none}.mfp-content{position:relative;margin:0 auto;text-align:left;z-index:1045}.mfp-ajax-holder .mfp-content,.mfp-inline-holder .mfp-content{width:100%;cursor:auto}.mfp-ajax-cur{cursor:progress}.mfp-zoom-out-cur,.mfp-zoom-out-cur .mfp-image-holder .mfp-close{cursor:-moz-zoom-out;cursor:-webkit-zoom-out;cursor:zoom-out}.mfp-gallery .mfp-image-holder .mfp-figure,.mfp-zoom{cursor:pointer}.mfp-zoom{cursor:-webkit-zoom-in;cursor:-moz-zoom-in;cursor:zoom-in}.mfp-auto-cursor .mfp-content{cursor:auto}.mfp-arrow,.mfp-close,.mfp-counter,.mfp-preloader{-webkit-user-select:none;-moz-user-select:none;user-select:none}.mfp-hide{display:none!important}.mfp-preloader{color:#ccc;position:absolute;top:50%;width:auto;text-align:center;margin-top:-.8em;left:8px;right:8px;z-index:1044}.mfp-close,.mfp-preloader a:hover{color:#fff}.mfp-preloader a{color:#ccc}button.mfp-arrow,button.mfp-close{overflow:visible;cursor:pointer;background:0 0;border:0;-webkit-appearance:none;display:block;outline:0;padding:0;z-index:1046;box-shadow:none;touch-action:manipulation}.mfp-figure:after,.mfp-iframe-scaler iframe{box-shadow:0 0 8px rgba(0,0,0,.6);position:absolute;left:0}button::-moz-focus-inner{padding:0;border:0}.mfp-close{width:44px;height:44px;line-height:44px;position:absolute;right:0;top:0;text-decoration:none;text-align:center;opacity:.65;padding:0 0 18px 10px;font-style:normal;font-size:28px;font-family:Arial,Baskerville,monospace}.mfp-arrow:focus,.mfp-arrow:hover,.mfp-close:focus,.mfp-close:hover{opacity:1}.mfp-close:active{top:1px}.mfp-close-btn-in .mfp-close{color:#333}.mfp-iframe-holder .mfp-close,.mfp-image-holder .mfp-close{color:#fff;right:-6px;text-align:right;padding-right:6px;width:100%}.mfp-counter{position:absolute;top:0;right:0;color:#ccc;font-size:12px;line-height:18px;white-space:nowrap}.mfp-figure,img.mfp-img{line-height:0}.mfp-arrow{position:absolute;opacity:.65;margin:-55px 0 0;top:50%;padding:0;width:90px;height:110px;-webkit-tap-highlight-color:transparent}.mfp-arrow:active{margin-top:-54px}.mfp-arrow:after,.mfp-arrow:before{content:"";display:block;width:0;height:0;position:absolute;left:0;top:0;margin-top:35px;margin-left:35px;border:inset transparent}.mfp-arrow:after{border-top-width:13px;border-bottom-width:13px;top:8px}.mfp-arrow:before{border-top-width:21px;border-bottom-width:21px;opacity:.7}.mfp-arrow-left{left:0}.mfp-arrow-left:after{border-right:17px solid #fff;margin-left:31px}.mfp-arrow-left:before{margin-left:25px;border-right:27px solid #3f3f3f}.mfp-arrow-right{right:0}.mfp-arrow-right:after{border-left:17px solid #fff;margin-left:39px}.mfp-arrow-right:before{border-left:27px solid #3f3f3f}.mfp-iframe-holder{padding-top:40px;padding-bottom:40px}.mfp-iframe-holder .mfp-content{line-height:0;width:100%;max-width:900px}.mfp-image-holder .mfp-content,img.mfp-img{max-width:100%}.mfp-iframe-holder .mfp-close{top:-40px}.mfp-iframe-scaler{width:100%;height:0;overflow:hidden;padding-top:56.25%}.mfp-iframe-scaler iframe{display:block;top:0;width:100%;height:100%;background:#000}.mfp-figure:after,img.mfp-img{width:auto;height:auto;display:block}img.mfp-img{box-sizing:border-box;padding:40px 0;margin:0 auto}.mfp-figure:after{content:"";top:40px;bottom:40px;right:0;z-index:-1;background:#444}.mfp-figure small{color:#bdbdbd;display:block;font-size:12px;line-height:14px}.mfp-figure figure{margin:0}.mfp-bottom-bar{margin-top:-36px;position:absolute;top:100%;left:0;width:100%;cursor:auto}.mfp-title{text-align:left;line-height:18px;color:#f3f3f3;word-wrap:break-word;padding-right:36px}@media screen and (max-width:800px) and (orientation:landscape),screen and (max-height:300px){.mfp-img-mobile .mfp-image-holder{padding-left:0;padding-right:0}.mfp-img-mobile .mfp-bottom-bar:empty,.mfp-img-mobile img.mfp-img{padding:0}.mfp-img-mobile .mfp-figure:after{top:0;bottom:0}.mfp-img-mobile .mfp-figure small{display:inline;margin-left:5px}.mfp-img-mobile .mfp-bottom-bar{background:rgba(0,0,0,.6);bottom:0;margin:0;top:auto;padding:3px 5px;position:fixed;box-sizing:border-box}.mfp-img-mobile .mfp-counter{right:5px;top:3px}.mfp-img-mobile .mfp-close{top:0;right:0;width:35px;height:35px;line-height:35px;background:rgba(0,0,0,.6);position:fixed;text-align:center;padding:0}}@media all and (max-width:900px){.mfp-arrow{-webkit-transform:scale(.75);transform:scale(.75)}.mfp-arrow-left{-webkit-transform-origin:0;transform-origin:0}.mfp-arrow-right{-webkit-transform-origin:100%;transform-origin:100%}.mfp-container{padding-left:6px;padding-right:6px}} |
* ## [responsive-lightbox/trunk/includes/class-remote-library-api.php](/changeset/3137531/responsive-lightbox/trunk/includes/class-remote-library-api.php "Show the changeset 3137531 restricted to responsive-lightbox/trunk/includes/class-remote-library-api.php")

  | [r3001037](/browser/responsive-lightbox/trunk/includes/class-remote-library-api.php?rev=3001037#L11 "Show revision 3001037 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/includes/class-remote-library-api.php?rev=3137531#L11 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | abstract class Responsive\_Lightbox\_Remote\_Library\_API { |
  | 12 | 12 |  |
  |  | 13 | protected $allowed\_hosts = []; |
  |  | 14 | protected $allowed\_formats = [ |
  |  | 15 | 'bmp'   => 'image/bmp', |
  |  | 16 | 'gif'   => 'image/gif', |
  |  | 17 | 'jpe'   => 'image/jpeg', |
  |  | 18 | 'jpeg'  => 'image/jpeg', |
  |  | 19 | 'jpg'   => 'image/jpeg', |
  |  | 20 | 'png'   => 'image/png', |
  |  | 21 | 'tif'   => 'image/tiff', |
  |  | 22 | 'tiff'  => 'image/tiff', |
  |  | 23 | 'webp'  => 'image/webp' |
  |  | 24 | ]; |
  | 13 | 25 | protected $rl; |
  | 14 | 26 | protected $slug; |
  | […](/browser/responsive-lightbox/trunk/includes/class-remote-library-api.php?rev=3001037#L205) | […](/browser/responsive-lightbox/trunk/includes/class-remote-library-api.php?rev=3137531#L217) |  |
  | 205 | 217 | return trim( $source\_text . ' ' . $user\_text ); |
  | 206 | 218 | } |
  |  | 219 |  |
  |  | 220 | /\*\* |
  |  | 221 | \* Get allowed formats. |
  |  | 222 | \* |
  |  | 223 | \* @return array |
  |  | 224 | \*/ |
  |  | 225 | public function get\_allowed\_formats() { |
  |  | 226 | return $this->allowed\_formats; |
  |  | 227 | } |
  |  | 228 |  |
  |  | 229 | /\*\* |
  |  | 230 | \* Get allowed hosts. |
  |  | 231 | \* |
  |  | 232 | \* @return array |
  |  | 233 | \*/ |
  |  | 234 | public function get\_allowed\_hosts() { |
  |  | 235 | return $this->allowed\_hosts; |
  |  | 236 | } |
  | 207 | 237 | } |
* ## [responsive-lightbox/trunk/includes/class-remote-library.php](/changeset/3137531/responsive-lightbox/trunk/includes/class-remote-library.php "Show the changeset 3137531 restricted to responsive-lightbox/trunk/includes/class-remote-library.php")

  | [r3001037](/browser/responsive-lightbox/trunk/includes/class-remote-library.php?rev=3001037#L12 "Show revision 3001037 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/includes/class-remote-library.php?rev=3137531#L12 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 |  |
  | 13 | 13 | public $providers = []; |
  |  | 14 | private $image\_formats = [ |
  |  | 15 | 'bmp'   => 'image/bmp', |
  |  | 16 | 'gif'   => 'image/gif', |
  |  | 17 | 'jpe'   => 'image/jpeg', |
  |  | 18 | 'jpeg'  => 'image/jpeg', |
  |  | 19 | 'jpg'   => 'image/jpeg', |
  |  | 20 | 'png'   => 'image/png', |
  |  | 21 | 'tif'   => 'image/tiff', |
  |  | 22 | 'tiff'  => 'image/tiff', |
  |  | 23 | 'webp'  => 'image/webp' |
  |  | 24 | ]; |
  | 14 | 25 |  |
  | 15 | 26 | /\*\* |
  | […](/browser/responsive-lightbox/trunk/includes/class-remote-library.php?rev=3001037#L260) | […](/browser/responsive-lightbox/trunk/includes/class-remote-library.php?rev=3137531#L271) |  |
  | 260 | 271 | \*/ |
  | 261 | 272 | public function ajax\_upload\_image() { |
  |  | 273 | // clear post data |
  | 262 | 274 | $data = stripslashes\_deep( $\_POST ); |
  | 263 |  | $new\_data = []; |
  |  | 275 |  |
  |  | 276 | // default result |
  |  | 277 | $result = [ |
  |  | 278 | 'id'        => 0, |
  |  | 279 | 'full'      => [ '', 0, 0, false ], |
  |  | 280 | 'error'     => false, |
  |  | 281 | 'message'   => '' |
  |  | 282 | ]; |
  | 264 | 283 |  |
  | 265 | 284 | // verified upload? |
  | 266 | 285 | if ( current\_user\_can( 'upload\_files' ) && isset( $data['rlnonce'], $data['image'], $data['post\_id'] ) && wp\_verify\_nonce( $data['rlnonce'], 'rl-remote-library-upload-image' ) ) { |
  |  | 286 | // include required files if needed |
  | 267 | 287 | if ( ! function\_exists( 'media\_handle\_upload' ) ) |
  | 268 | 288 | require\_once( path\_join( ABSPATH, 'wp-admin/includes/media.php' ) ); |
  | […](/browser/responsive-lightbox/trunk/includes/class-remote-library.php?rev=3001037#L271) | […](/browser/responsive-lightbox/trunk/includes/class-remote-library.php?rev=3137531#L291) |  |
  | 271 | 291 | require\_once( path\_join( ABSPATH, 'wp-admin/includes/file.php' ) ); |
  | 272 | 292 |  |
  | 273 |  | if ( ! empty( $data['image']['url'] ) ) { |
  | 274 |  | // get image as binary data |
  | 275 |  | $response = wp\_safe\_remote\_get( esc\_url\_raw( $data['image']['url'] ) ); |
  | 276 |  |  |
  | 277 |  | // get file name |
  | 278 |  | $file\_name = basename( parse\_url( $data['image']['name'], PHP\_URL\_PATH ) ); |
  | 279 |  |  |
  | 280 |  | // check extension |
  | 281 |  | $file\_ext = strrpos( $file\_name, '.' ); |
  | 282 |  |  |
  | 283 |  | // no extension? |
  | 284 |  | if ( $file\_ext === false ) |
  | 285 |  | $file\_name .= '.jpg'; |
  | 286 |  |  |
  | 287 |  | // no errors? |
  | 288 |  | if ( ! is\_wp\_error( $response ) ) { |
  | 289 |  | $bits = wp\_remote\_retrieve\_body( $response ); |
  | 290 |  | $loaded = wp\_upload\_bits( $file\_name, null, $bits, current\_time( 'Y/m' ) ); |
  | 291 |  |  |
  | 292 |  | if ( isset( $loaded['error'] ) && $loaded['error'] ) { |
  | 293 |  | $results = [ |
  | 294 |  | 'error'     => true, |
  | 295 |  | 'message'   => $loaded['error'] |
  | 296 |  | ]; |
  |  | 293 | // get media provider |
  |  | 294 | $media\_provider = ! empty( $data['image']['media\_provider'] ) ? sanitize\_key( $data['image']['media\_provider'] ) : ''; |
  |  | 295 |  |
  |  | 296 | // get active providers |
  |  | 297 | $providers = $this->get\_active\_providers(); |
  |  | 298 |  |
  |  | 299 | if ( in\_array( $media\_provider, $providers, true ) ) { |
  |  | 300 | // get image formats |
  |  | 301 | $image\_formats = $this->get\_allowed\_image\_formats( $media\_provider ); |
  |  | 302 |  |
  |  | 303 | if ( ! empty( $data['image']['url'] ) && ! empty( $data['image']['mime'] ) && ! empty( $data['image']['subtype'] ) && array\_key\_exists( $data['image']['subtype'], $image\_formats ) ) { |
  |  | 304 | // get image url |
  |  | 305 | $image\_url = esc\_url\_raw( $data['image']['url'] ); |
  |  | 306 |  |
  |  | 307 | // get allowed hosts |
  |  | 308 | $hosts = $this->get\_allowed\_hosts( $media\_provider ); |
  |  | 309 |  |
  |  | 310 | if ( ! empty( $hosts ) ) { |
  |  | 311 | $valid\_host = false; |
  |  | 312 |  |
  |  | 313 | // get image host |
  |  | 314 | $image\_host = parse\_url( $image\_url, PHP\_URL\_HOST ); |
  |  | 315 |  |
  |  | 316 | // check allowed hosts |
  |  | 317 | foreach ( $hosts as $host ) { |
  |  | 318 | // invalid host? |
  |  | 319 | if ( strpos( $image\_host, $host ) !== false ) { |
  |  | 320 | $valid\_host = true; |
  |  | 321 |  |
  |  | 322 | // no need to check rest of the hosts |
  |  | 323 | break; |
  |  | 324 | } |
  |  | 325 | } |
  |  | 326 | } else |
  |  | 327 | $valid\_host = true; |
  |  | 328 |  |
  |  | 329 | if ( $valid\_host ) { |
  |  | 330 | // get image as binary data |
  |  | 331 | $response = wp\_safe\_remote\_get( $image\_url ); |
  |  | 332 |  |
  |  | 333 | // no errors? |
  |  | 334 | if ( ! is\_wp\_error( $response ) ) { |
  |  | 335 | // get sanitized file name |
  |  | 336 | $file\_name = sanitize\_file\_name( pathinfo( $data['image']['name'], PATHINFO\_BASENAME ) ); |
  |  | 337 |  |
  |  | 338 | // get file extension |
  |  | 339 | $file\_ext = pathinfo( $file\_name, PATHINFO\_EXTENSION ); |
  |  | 340 |  |
  |  | 341 | // no extension? |
  |  | 342 | if ( $file\_ext === '' || ! array\_key\_exists( $file\_ext, $image\_formats ) ) { |
  |  | 343 | $file\_name .= '.jpg'; |
  |  | 344 | $file\_ext = 'jpg'; |
  |  | 345 | } |
  |  | 346 |  |
  |  | 347 | // simple mime checking |
  |  | 348 | $check = wp\_check\_filetype( $file\_name ); |
  |  | 349 |  |
  |  | 350 | if ( $check['type'] === $data['image']['mime'] && $check['ext'] !== false && array\_key\_exists( $file\_ext, $image\_formats ) ) { |
  |  | 351 | // get image binary data |
  |  | 352 | $image\_bits = wp\_remote\_retrieve\_body( $response ); |
  |  | 353 |  |
  |  | 354 | // upload image |
  |  | 355 | $uploaded\_image = wp\_upload\_bits( $file\_name, null, $image\_bits, current\_time( 'Y/m' ) ); |
  |  | 356 |  |
  |  | 357 | if ( isset( $uploaded\_image['error'] ) && $uploaded\_image['error'] ) { |
  |  | 358 | $result['error'] = true; |
  |  | 359 | $result['message'] = $uploaded\_image['error']; |
  |  | 360 | } else { |
  |  | 361 | // get file name |
  |  | 362 | $file\_name = pathinfo( $uploaded\_image['file'], PATHINFO\_BASENAME ); |
  |  | 363 |  |
  |  | 364 | // simulate upload |
  |  | 365 | $\_FILES['rl-remote-image'] = [ |
  |  | 366 | 'error'     => 0, |
  |  | 367 | 'name'      => $file\_name, |
  |  | 368 | 'tmp\_name'  => $uploaded\_image['file'], |
  |  | 369 | 'size'      => filesize( $uploaded\_image['file'] ) |
  |  | 370 | ]; |
  |  | 371 |  |
  |  | 372 | // get post id |
  |  | 373 | $post\_id = isset( $data['post\_id'] ) ? (int) $data['post\_id'] : 0; |
  |  | 374 |  |
  |  | 375 | // more reliable mime type checking |
  |  | 376 | $check = wp\_check\_filetype\_and\_ext( $uploaded\_image['file'], $file\_name ); |
  |  | 377 |  |
  |  | 378 | // correct mime type and extension? |
  |  | 379 | if ( strpos( $data['image']['mime'], 'image/' ) === 0 && $check['type'] === $data['image']['mime'] && $check['ext'] !== false && wp\_get\_image\_mime( $uploaded\_image['file'] ) === $check['type'] ) { |
  |  | 380 | // upload image, wp handle sanitization and validation here |
  |  | 381 | $attachment\_id = media\_handle\_upload( |
  |  | 382 | 'rl-remote-image', |
  |  | 383 | $post\_id, |
  |  | 384 | [ |
  |  | 385 | 'post\_title'    => empty( $data['image']['title'] ) ? $file\_name : $data['image']['title'], |
  |  | 386 | 'post\_content'  => empty( $data['image']['description'] ) ? '' : $data['image']['description'], |
  |  | 387 | 'post\_excerpt'  => empty( $data['image']['caption'] ) ? '' : $data['image']['caption'] |
  |  | 388 | ], |
  |  | 389 | [ |
  |  | 390 | 'action'    => 'rl\_remote\_library\_handle\_upload', |
  |  | 391 | 'test\_form' => false |
  |  | 392 | ] |
  |  | 393 | ); |
  |  | 394 |  |
  |  | 395 | // upload success? |
  |  | 396 | if ( ! is\_wp\_error( $attachment\_id ) ) { |
  |  | 397 | add\_post\_meta( $attachment\_id, '\_wp\_attachment\_image\_alt', empty( $data['image']['alt'] ) ? '' : $data['image']['alt'] ); |
  |  | 398 |  |
  |  | 399 | $result['id'] = $attachment\_id; |
  |  | 400 | $result['full'] = wp\_get\_attachment\_image\_src( $attachment\_id, 'full' ); |
  |  | 401 | } else { |
  |  | 402 | $result['error'] = true; |
  |  | 403 | $result['message'] = $attachment\_id->get\_error\_message(); |
  |  | 404 | } |
  |  | 405 | // file still exists? |
  |  | 406 | } elseif ( file\_exists( $uploaded\_image['file'] ) ) { |
  |  | 407 | $result['error'] = true; |
  |  | 408 | $result['message'] = \_\_( 'Invalid MIME type', 'responsive-lightbox' ); |
  |  | 409 |  |
  |  | 410 | // delete file |
  |  | 411 | wp\_delete\_file( $uploaded\_image['file'] ); |
  |  | 412 | } |
  |  | 413 | } |
  |  | 414 | } else { |
  |  | 415 | $result['error'] = true; |
  |  | 416 | $result['message'] = \_\_( 'Invalid image type', 'responsive-lightbox' ); |
  |  | 417 | } |
  |  | 418 | } else { |
  |  | 419 | $result['error'] = true; |
  |  | 420 | $result['message'] = $response->get\_error\_message(); |
  |  | 421 | } |
  | 297 | 422 | } else { |
  | 298 |  | // simulate upload |
  | 299 |  | $\_FILES['rl-remote-image'] = [ |
  | 300 |  | 'error'     => 0, |
  | 301 |  | 'name'      => $file\_name, |
  | 302 |  | 'tmp\_name'  => $loaded['file'], |
  | 303 |  | 'size'      => filesize( $loaded['file'] ) |
  | 304 |  | ]; |
  | 305 |  |  |
  | 306 |  | // get post ID |
  | 307 |  | $post\_id = isset( $data['post\_id'] ) ? (int) $data['post\_id'] : 0; |
  | 308 |  |  |
  | 309 |  | // upload image, wp handle sanitization and validation here |
  | 310 |  | $attachment\_id = media\_handle\_upload( |
  | 311 |  | 'rl-remote-image', |
  | 312 |  | $post\_id, |
  | 313 |  | [ |
  | 314 |  | 'post\_title'    => $data['image']['title'], |
  | 315 |  | 'post\_content'  => $data['image']['description'], |
  | 316 |  | 'post\_excerpt'  => $data['image']['caption'] |
  | 317 |  | ], |
  | 318 |  | [ |
  | 319 |  | 'action'    => 'rl\_remote\_library\_handle\_upload', |
  | 320 |  | 'test\_form' => false |
  | 321 |  | ] |
  | 322 |  | ); |
  | 323 |  |  |
  | 324 |  | // upload success? |
  | 325 |  | if ( ! is\_wp\_error( $attachment\_id ) ) { |
  | 326 |  | add\_post\_meta( $attachment\_id, '\_wp\_attachment\_image\_alt', $data['image']['alt'] ); |
  | 327 |  |  |
  | 328 |  | $new\_data['id'] = $attachment\_id; |
  | 329 |  | $new\_data['full'] = wp\_get\_attachment\_image\_src( $attachment\_id, 'full' ); |
  | 330 |  | } |
  |  | 423 | $result['error'] = true; |
  |  | 424 | $result['message'] = \_\_( 'Invalid host', 'responsive-lightbox' ); |
  | 331 | 425 | } |
  |  | 426 | } else { |
  |  | 427 | $result['error'] = true; |
  |  | 428 | $result['message'] = \_\_( 'Missing or invalid image data', 'responsive-lightbox' ); |
  | 332 | 429 | } |
  |  | 430 | } else { |
  |  | 431 | $result['error'] = true; |
  |  | 432 | $result['message'] = \_\_( 'Invalid media provider', 'responsive-lightbox' ); |
  | 333 | 433 | } |
  |  | 434 | } else { |
  |  | 435 | $result['error'] = true; |
  |  | 436 | $result['message'] = \_\_( 'Access denied', 'responsive-lightbox' ); |
  | 334 | 437 | } |
  | 335 | 438 |  |
  | 336 | 439 | // send data |
  | 337 |  | wp\_send\_json( $~~new\_data~~ ); |
  |  | 440 | wp\_send\_json( $result ); |
  | 338 | 441 | } |
  | 339 | 442 |  |
  | […](/browser/responsive-lightbox/trunk/includes/class-remote-library.php?rev=3001037#L392) | […](/browser/responsive-lightbox/trunk/includes/class-remote-library.php?rev=3137531#L495) |  |
  | 392 | 495 |  |
  | 393 | 496 | // check extension |
  | 394 |  | $file\_ext = strrpos( basename( parse\_url( $result['url'], PHP\_URL\_PATH ) ), '.' ); |
  | 395 |  |  |
  | 396 |  | // no extension? |
  | 397 |  | if ( $file\_ext === false ) |
  | 398 |  | $file\_ext .= 'jpg'; |
  | 399 |  |  |
  | 400 |  | if ( $file\_ext === 'png' || $file\_ext === 'gif' ) { |
  | 401 |  | $copy[$no]['mime'] = 'image/' . $file\_ext; |
  |  | 497 | $file\_ext = pathinfo( $result['url'], PATHINFO\_EXTENSION ); |
  |  | 498 |  |
  |  | 499 | // get image formats |
  |  | 500 | $image\_formats = $this->get\_allowed\_image\_formats( $args['media\_provider'] ); |
  |  | 501 |  |
  |  | 502 | if ( array\_key\_exists( $file\_ext, $image\_formats ) ) { |
  |  | 503 | $copy[$no]['mime'] = $image\_formats[$file\_ext]; |
  | 402 | 504 | $copy[$no]['subtype'] = $file\_ext; |
  | 403 | 505 | } else { |
  | 404 | 506 | $copy[$no]['mime'] = 'image/jpeg'; |
  | 405 |  | $copy[$no]['subtype'] = 'jp~~e~~g'; |
  |  | 507 | $copy[$no]['subtype'] = 'jpg'; |
  | 406 | 508 | } |
  | 407 | 509 |  |
  | […](/browser/responsive-lightbox/trunk/includes/class-remote-library.php?rev=3001037#L525) | […](/browser/responsive-lightbox/trunk/includes/class-remote-library.php?rev=3137531#L627) |  |
  | 525 | 627 | return $results; |
  | 526 | 628 | } |
  |  | 629 |  |
  |  | 630 | /\*\* |
  |  | 631 | \* Get allowed hosts. |
  |  | 632 | \* |
  |  | 633 | \* @param string $provider |
  |  | 634 | \* @return array |
  |  | 635 | \*/ |
  |  | 636 | public function get\_allowed\_hosts( $provider ) { |
  |  | 637 | // get active providers |
  |  | 638 | $providers = $this->get\_active\_providers(); |
  |  | 639 |  |
  |  | 640 | if ( in\_array( $provider, $providers, true ) ) { |
  |  | 641 | // get available provider host |
  |  | 642 | $hosts = Responsive\_Lightbox()->providers[$provider]['instance']->get\_allowed\_hosts(); |
  |  | 643 | } else |
  |  | 644 | $hosts = []; |
  |  | 645 |  |
  |  | 646 | return $hosts; |
  |  | 647 | } |
  |  | 648 |  |
  |  | 649 | /\*\* |
  |  | 650 | \* Get allowed image formats. |
  |  | 651 | \* |
  |  | 652 | \* @param string $provider |
  |  | 653 | \* @return array |
  |  | 654 | \*/ |
  |  | 655 | public function get\_allowed\_image\_formats( $provider = 'all' ) { |
  |  | 656 | if ( $provider === 'all' ) { |
  |  | 657 | $image\_formats = $this->image\_formats; |
  |  | 658 | } else { |
  |  | 659 | // get active providers |
  |  | 660 | $providers = $this->get\_active\_providers(); |
  |  | 661 |  |
  |  | 662 | if ( in\_array( $provider, $providers, true ) ) { |
  |  | 663 | // get available provider image formats |
  |  | 664 | $image\_formats = Responsive\_Lightbox()->providers[$provider]['instance']->get\_allowed\_formats(); |
  |  | 665 | } else |
  |  | 666 | $image\_formats = []; |
  |  | 667 | } |
  |  | 668 |  |
  |  | 669 | return $image\_formats; |
  |  | 670 | } |
  | 527 | 671 | } |
* ## [responsive-lightbox/trunk/includes/class-settings.php](/changeset/3137531/responsive-lightbox/trunk/includes/class-settings.php "Show the changeset 3137531 restricted to responsive-lightbox/trunk/includes/class-settings.php")

  | [r3001037](/browser/responsive-lightbox/trunk/includes/class-settings.php?rev=3001037#L28 "Show revision 3001037 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/includes/class-settings.php?rev=3137531#L28 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 28 | 28 |  |
  | 29 | 29 | // actions |
  |  | 30 | add\_action( 'after\_setup\_theme', [ $this, 'load\_defaults' ] ); |
  |  | 31 | add\_action( 'admin\_init', [ $this, 'init\_builder' ] ); |
  | 30 | 32 | add\_action( 'admin\_init', [ $this, 'register\_settings' ] ); |
  | 31 | 33 | add\_action( 'admin\_menu', [ $this, 'admin\_menu\_options' ] ); |
  | 32 |  | ~~add\_action( 'after\_setup\_theme', [ $this, 'load\_defaults' ] );~~ |
  | 33 |  | ~~add\_action( 'init', [ $this, 'init\_builder' ] );~~ |
  | 34 | 34 | } |
  | 35 | 35 |  |
  | […](/browser/responsive-lightbox/trunk/includes/class-settings.php?rev=3001037#L65) | […](/browser/responsive-lightbox/trunk/includes/class-settings.php?rev=3137531#L65) |  |
  | 65 | 65 |  |
  | 66 | 66 | // flush rewrite rules if needed |
  | 67 |  | if ( ~~isset( $\_GET['flush\_rules'] )~~ ) |
  |  | 67 | if ( current\_user\_can( apply\_filters( 'rl\_lightbox\_settings\_capability', $rl->options['capabilities']['active'] ? 'edit\_lightbox\_settings' : 'manage\_options' ) ) && isset( $\_POST['flush\_rules'] ) && isset( $\_POST['option\_page'], $\_POST['action'], $\_POST['responsive\_lightbox\_builder'], $\_POST['\_wpnonce'] ) && $\_POST['option\_page'] === 'responsive\_lightbox\_builder' && $\_POST['action'] === 'update' && ( isset( $\_POST['save\_rl\_builder'] ) || isset( $\_POST['reset\_rl\_builder'] ) ) && check\_admin\_referer( 'responsive\_lightbox\_builder-options', '\_wpnonce' ) !== false ) |
  | 68 | 68 | flush\_rewrite\_rules(); |
  | 69 | 69 | } |
  | […](/browser/responsive-lightbox/trunk/includes/class-settings.php?rev=3001037#L1963) | […](/browser/responsive-lightbox/trunk/includes/class-settings.php?rev=3137531#L1963) |  |
  | 1963 | 1963 | if ( $tab\_key === 'builder' ) |
  | 1964 | 1964 | echo ' |
  | 1965 |  | <input type="hidden" name="~~\_wp\_http\_referer" value="'. esc\_attr( wp\_unslash( add\_query\_arg( 'flush\_rules', 1, $\_SERVER['REQUEST\_URI'] ) ) ) . '~~" />'; |
  |  | 1965 | <input type="hidden" name="flush\_rules" value="1" />'; |
  | 1966 | 1966 | } |
  | 1967 | 1967 |  |
* ## [responsive-lightbox/trunk/includes/providers/class-flickr.php](/changeset/3137531/responsive-lightbox/trunk/includes/providers/class-flickr.php "Show the changeset 3137531 restricted to responsive-lightbox/trunk/includes/providers/class-flickr.php")

  | [r2897673](/browser/responsive-lightbox/trunk/includes/providers/class-flickr.php?rev=2897673#L12 "Show revision 2897673 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/includes/providers/class-flickr.php?rev=3137531#L12 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | \*/ |
  | 13 | 13 | class Responsive\_Lightbox\_Remote\_Library\_Flickr extends Responsive\_Lightbox\_Remote\_Library\_API { |
  |  | 14 |  |
  |  | 15 | protected $allowed\_hosts = [ 'staticflickr.com' ]; |
  |  | 16 | protected $allowed\_formats = [ |
  |  | 17 | 'bmp'   => 'image/bmp', |
  |  | 18 | 'gif'   => 'image/gif', |
  |  | 19 | 'jpe'   => 'image/jpeg', |
  |  | 20 | 'jpeg'  => 'image/jpeg', |
  |  | 21 | 'jpg'   => 'image/jpeg', |
  |  | 22 | 'png'   => 'image/png', |
  |  | 23 | 'tif'   => 'image/tiff', |
  |  | 24 | 'tiff'  => 'image/tiff' |
  |  | 25 | ]; |
  | 14 | 26 |  |
  | 15 | 27 | /\*\* |
  | […](/browser/responsive-lightbox/trunk/includes/providers/class-flickr.php?rev=2897673#L259) | […](/browser/responsive-lightbox/trunk/includes/providers/class-flickr.php?rev=3137531#L271) |  |
  | 259 | 271 | 'thumbnail\_orientation' => (int) $small[2] > (int) $small[1] ? 'portrait' : 'landscape', |
  | 260 | 272 | 'media\_provider'        => 'flickr', |
  | 261 |  | 'filename'              => ~~basename( sanitize\_file\_~~name( $large[0] ) ), |
  |  | 273 | 'filename'              => sanitize\_file\_name( basename( $large[0] ) ), |
  | 262 | 274 | 'dimensions'            => (int) $large[1] . ' x ' . (int) $large[2], |
  | 263 | 275 | 'type'                  => 'image' |
* ## [responsive-lightbox/trunk/includes/providers/class-unsplash.php](/changeset/3137531/responsive-lightbox/trunk/includes/providers/class-unsplash.php "Show the changeset 3137531 restricted to responsive-lightbox/trunk/includes/providers/class-unsplash.php")

  | [r2897673](/browser/responsive-lightbox/trunk/includes/providers/class-unsplash.php?rev=2897673#L12 "Show revision 2897673 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/includes/providers/class-unsplash.php?rev=3137531#L12 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | \*/ |
  | 13 | 13 | class Responsive\_Lightbox\_Remote\_Library\_Unsplash extends Responsive\_Lightbox\_Remote\_Library\_API { |
  |  | 14 |  |
  |  | 15 | protected $allowed\_hosts = [ 'unsplash.com' ]; |
  |  | 16 | protected $allowed\_formats = [ |
  |  | 17 | 'jpe'   => 'image/jpeg', |
  |  | 18 | 'jpeg'  => 'image/jpeg', |
  |  | 19 | 'jpg'   => 'image/jpeg' |
  |  | 20 | ]; |
  | 14 | 21 |  |
  | 15 | 22 | /\*\* |
  | […](/browser/responsive-lightbox/trunk/includes/providers/class-unsplash.php?rev=2897673#L213) | […](/browser/responsive-lightbox/trunk/includes/providers/class-unsplash.php?rev=3137531#L220) |  |
  | 213 | 220 | 'thumbnail\_orientation' => $thumbnail\_height > $thumbnail\_width ? 'portrait' : 'landscape', |
  | 214 | 221 | 'media\_provider'        => 'unsplash', |
  | 215 |  | 'filename'              => ~~basename( sanitize\_file\_~~name( $result['urls']['raw'] ) ), |
  |  | 222 | 'filename'              => sanitize\_file\_name( basename( $result['urls']['raw'] ) ), |
  | 216 | 223 | 'dimensions'            => $width . ' x ' . $height, |
  | 217 | 224 | 'type'                  => 'image' |
* ## [responsive-lightbox/trunk/includes/providers/class-wikimedia.php](/changeset/3137531/responsive-lightbox/trunk/includes/providers/class-wikimedia.php "Show the changeset 3137531 restricted to responsive-lightbox/trunk/includes/providers/class-wikimedia.php")

  | [r2897673](/browser/responsive-lightbox/trunk/includes/providers/class-wikimedia.php?rev=2897673#L12 "Show revision 2897673 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/includes/providers/class-wikimedia.php?rev=3137531#L12 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | \*/ |
  | 13 | 13 | class Responsive\_Lightbox\_Remote\_Library\_Wikimedia extends Responsive\_Lightbox\_Remote\_Library\_API { |
  |  | 14 |  |
  |  | 15 | protected $allowed\_hosts = [ 'wikimedia.org' ]; |
  |  | 16 | protected $allowed\_formats = [ |
  |  | 17 | 'gif'   => 'image/gif', |
  |  | 18 | 'jpe'   => 'image/jpeg', |
  |  | 19 | 'jpeg'  => 'image/jpeg', |
  |  | 20 | 'jpg'   => 'image/jpeg', |
  |  | 21 | 'png'   => 'image/png', |
  |  | 22 | 'tif'   => 'image/tiff', |
  |  | 23 | 'tiff'  => 'image/tiff', |
  |  | 24 | 'webp'  => 'image/webp' |
  |  | 25 | ]; |
  | 14 | 26 |  |
  | 15 | 27 | /\*\* |
* ## [responsive-lightbox/trunk/js/admin-media.js](/changeset/3137531/responsive-lightbox/trunk/js/admin-media.js "Show the changeset 3137531 restricted to responsive-lightbox/trunk/js/admin-media.js")

  | [r2438905](/browser/responsive-lightbox/trunk/js/admin-media.js?rev=2438905#L193 "Show revision 2438905 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/js/admin-media.js?rev=3137531#L193 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 193 | 193 | // valid remote library view? |
  | 194 | 194 | if ( view !== null && 'model' in view && view.model.id === 'rl-remote-library' ) { |
  | 195 |  | var contentState = this.state()~~,~~ |
  | 196 |  | contentSelection = contentState.get( 'selection' ); |
  |  | 195 | var contentState = this.state(); |
  |  | 196 | var contentSelection = contentState.get( 'selection' ); |
  | 197 | 197 |  |
  | 198 | 198 | // clear selection |
  | 199 | 199 | contentSelection.reset(); |
  | 200 | 200 |  |
  | 201 |  | var toolbar = this.toolbar.get()~~,~~ |
  | 202 |  | ~~controller = this,~~ |
  | 203 |  | spinner = view.toolbar.get( 'spinner' ); |
  |  | 201 | var toolbar = this.toolbar.get(); |
  |  | 202 | var controller = this; |
  |  | 203 | var spinner = view.toolbar.get( 'spinner' ); |
  | 204 | 204 |  |
  | 205 | 205 | // display spinner |
  | […](/browser/responsive-lightbox/trunk/js/admin-media.js?rev=2438905#L219) | […](/browser/responsive-lightbox/trunk/js/admin-media.js?rev=3137531#L219) |  |
  | 219 | 219 | requires: { selection: true }, |
  | 220 | 220 | click: function() { |
  | 221 |  | var state = controller.state()~~,~~ |
  | 222 |  | ~~selection = state.get( 'selection' ),~~ |
  | 223 |  | ~~image = selection.single(),~~ |
  | 224 |  | ~~content = controller.content.get(),~~ |
  | 225 |  | ~~attachment = content.attachments.$el.find( 'li[data-id="' + image.attributes.id + '"] .thumbnail' ),~~ |
  | 226 |  | attachment\_image = attachment.find( '.centered' ); |
  |  | 221 | var state = controller.state(); |
  |  | 222 | var selection = state.get( 'selection' ); |
  |  | 223 | var image = selection.single(); |
  |  | 224 | var content = controller.content.get(); |
  |  | 225 | var attachment = content.attachments.$el.find( 'li[data-id="' + image.attributes.id + '"] .thumbnail' ); |
  |  | 226 | var attachment\_image = attachment.find( '.centered' ); |
  | 227 | 227 |  |
  | 228 | 228 | attachment\_image.css( { opacity: 0.1, transition: 'opacity 500ms' } ); |
  | 229 | 229 | attachment\_image.after( '<div class="media-progress-bar"><div style="width: 20%"></div></div>' ); |
  | 230 | 230 |  |
  | 231 |  | var progress = attachment.find( '.media-progress-bar div' )~~,~~ |
  | 232 |  | transition = progress.css( 'transition' ); |
  |  | 231 | var progress = attachment.find( '.media-progress-bar div' ); |
  |  | 232 | var transition = progress.css( 'transition' ); |
  | 233 | 233 |  |
  | 234 | 234 | progress.css( 'transition', 'width 10s' ).animate( { width: "100%" }, 0 ); |
* ## [responsive-lightbox/trunk/js/front.js](/changeset/3137531/responsive-lightbox/trunk/js/front.js "Show the changeset 3137531 restricted to responsive-lightbox/trunk/js/front.js")

  | [r2897673](/browser/responsive-lightbox/trunk/js/front.js?rev=2897673#L715 "Show revision 2897673 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/js/front.js?rev=3137531#L715 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 715 | 715 |  |
  | 716 | 716 | case 'featherlight': |
  |  | 717 | delete $.featherlight.contentFilters.jquery; |
  |  | 718 |  |
  |  | 719 | $.extend( $.featherlight.contentFilters, { |
  |  | 720 | html: { |
  |  | 721 | regex: /[^]/, // it will also handle jquery and any unspecified content type |
  |  | 722 | process: function( html ) { |
  |  | 723 | return $( '<div>', { text: html } ); |
  |  | 724 | } |
  |  | 725 | } |
  |  | 726 | } ); |
  |  | 727 |  |
  | 717 | 728 | var selectors = []; |
  | 718 | 729 | var lastImage = ''; |
  | […](/browser/responsive-lightbox/trunk/js/front.js?rev=2897673#L739) | […](/browser/responsive-lightbox/trunk/js/front.js?rev=3137531#L750) |  |
  | 739 | 750 | // set defaults |
  | 740 | 751 | $.extend( $.featherlight.defaults, { |
  |  | 752 | contentFilters: ['image', 'html', 'ajax', 'iframe', 'text'], |
  | 741 | 753 | openSpeed: parseInt( args.openSpeed ), |
  | 742 | 754 | closeSpeed: parseInt( args.closeSpeed ), |
  | […](/browser/responsive-lightbox/trunk/js/front.js?rev=2897673#L832) | […](/browser/responsive-lightbox/trunk/js/front.js?rev=3137531#L844) |  |
  | 832 | 844 |  |
  | 833 | 845 | subselector.magnificPopup( { |
  |  | 846 | allowHTMLInStatusIndicator: false, |
  |  | 847 | allowHTMLInTemplate: true, |
  | 834 | 848 | type: media\_type === 'gallery' ? 'image' : ( media\_type === 'video' ? 'iframe' : media\_type ), |
  | 835 | 849 | disableOn: args.disableOn, |
  | […](/browser/responsive-lightbox/trunk/js/front.js?rev=2897673#L852) | […](/browser/responsive-lightbox/trunk/js/front.js?rev=3137531#L866) |  |
  | 852 | 866 | if ( ! title ) |
  | 853 | 867 | title = ''; |
  |  | 868 | else { |
  |  | 869 | title = title.replace( /[^]/g, function( c ) { |
  |  | 870 | return '&#' + c.charCodeAt( 0 ) + ';'; |
  |  | 871 | } ); |
  |  | 872 | } |
  | 854 | 873 |  |
  | 855 | 874 | if ( ! caption ) |
  | 856 | 875 | caption = ''; |
  |  | 876 | else { |
  |  | 877 | caption = caption.replace( /[^]/g, function( c ) { |
  |  | 878 | return '&#' + c.charCodeAt( 0 ) + ';'; |
  |  | 879 | } ); |
  |  | 880 | } |
  | 857 | 881 |  |
  | 858 | 882 | return title + '<small>' + caption + '</small>'; |
  | […](/browser/responsive-lightbox/trunk/js/front.js?rev=2897673#L871) | […](/browser/responsive-lightbox/trunk/js/front.js?rev=3137531#L895) |  |
  | 871 | 895 | // trigger image view |
  | 872 | 896 | rl\_view\_image( script, this.currItem.src ); |
  |  | 897 | }, |
  |  | 898 | elementParse: function( item ) { |
  |  | 899 | if ( item.src.trim().includes( '<' ) ) { |
  |  | 900 | if ( item.type === 'inline' ) |
  |  | 901 | item.src = '<div>HTML is disallowed.</div>'; |
  |  | 902 | else if ( item.type === 'iframe' || item.type === 'ajax' ) |
  |  | 903 | item.src = ''; |
  |  | 904 | } |
  | 873 | 905 | } |
  | 874 | 906 | } |
* ## [responsive-lightbox/trunk/readme.txt](/changeset/3137531/responsive-lightbox/trunk/readme.txt "Show the changeset 3137531 restricted to responsive-lightbox/trunk/readme.txt")

  | [r3054841](/browser/responsive-lightbox/trunk/readme.txt?rev=3054841#L2 "Show revision 3054841 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/readme.txt?rev=3137531#L2 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | Contributors: dfactory |
  | 3 | 3 | Donate link: http://www.dfactory.co/ |
  | 4 |  | Tags: gallery, galleries, ~~image, images, responsive, lightbox, photo, photography, masonry, video, builder~~ |
  |  | 4 | Tags: gallery, galleries, lightbox, image, images |
  | 5 | 5 | Requires at least: 5.0 |
  | 6 |  | Tested up to: 6.~~4.3~~ |
  | 7 |  | Stable tag: 2.4.~~7~~ |
  |  | 6 | Tested up to: 6.6.1 |
  |  | 7 | Stable tag: 2.4.8 |
  | 8 | 8 | Requires PHP: 5.4 |
  | 9 | 9 | License: MIT License |
  | […](/browser/responsive-lightbox/trunk/readme.txt?rev=3054841#L141) | […](/browser/responsive-lightbox/trunk/readme.txt?rev=3137531#L141) |  |
  | 141 | 141 | == Changelog == |
  | 142 | 142 |  |
  |  | 143 | = 2.4.8 = |
  |  | 144 | \* Fix: Flushing rewrite rules |
  |  | 145 | \* Fix: Uploading remote library images |
  |  | 146 | \* Fix: Potential XSS vulnerability related to Magnific Popup |
  |  | 147 | \* Fix: Potential XSS vulnerability related to Featherlight lightbox |
  |  | 148 | \* Tweak: Updated Magnific Popup to 1.2.0 |
  |  | 149 |  |
  | 143 | 150 | = 2.4.7 = |
  | 144 | 151 | \* Fix: Unauthorized access to private rl\_gallery shortcodes |
  | […](/browser/responsive-lightbox/trunk/readme.txt?rev=3054841#L533) | […](/browser/responsive-lightbox/trunk/readme.txt?rev=3137531#L540) |  |
  | 533 | 540 | == Upgrade Notice == |
  | 534 | 541 |  |
  | 535 |  | = 2.4.~~7~~ = |
  | 536 |  | \* Fix: Unauthorized access to private rl\_gallery shortcodes |
  |  | 542 | = 2.4.8 = |
  |  | 543 | Multiple fixes - Flushing rewrite rules, Uploading remote library images, Potential XSS vulnerability related to Magnific Popup, Potential XSS vulnerability related to Featherlight lightbox |
* ## [responsive-lightbox/trunk/responsive-lightbox.php](/changeset/3137531/responsive-lightbox/trunk/responsive-lightbox.php "Show the changeset 3137531 restricted to responsive-lightbox/trunk/responsive-lightbox.php")

  | [r3054841](/browser/responsive-lightbox/trunk/responsive-lightbox.php?rev=3054841#L3 "Show revision 3054841 of this file in browser") | [r3137531](/browser/responsive-lightbox/trunk/responsive-lightbox.php?rev=3137531#L3 "Show revision 3137531 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Plugin Name: Responsive Lightbox & Gallery |
  | 4 | 4 | Description: Responsive Lightbox & Gallery allows users to create galleries and view larger versions of images, galleries and videos in a lightbox (overlay) effect optimized for mobile devices. |
  | 5 |  | Version: 2.4.~~7~~ |
  |  | 5 | Version: 2.4.8 |
  | 6 | 6 | Author: dFactory |
  | 7 | 7 | Author URI: http://www.dfactory.co/ |
  | […](/browser/responsive-lightbox/trunk/responsive-lightbox.php?rev=3054841#L45) | […](/browser/responsive-lightbox/trunk/responsive-lightbox.php?rev=3137531#L45) |  |
  | 45 | 45 | \* |
  | 46 | 46 | \* @class Responsive\_Lightbox |
  | 47 |  | \* @version 2.4.~~7~~ |
  |  | 47 | \* @version 2.4.8 |
  | 48 | 48 | \*/ |
  | 49 | 49 | class Responsive\_Lightbox { |
  | […](/browser/responsive-lightbox/trunk/responsive-lightbox.php?rev=3054841#L306) | […](/browser/responsive-lightbox/trunk/responsive-lightbox.php?rev=3137531#L306) |  |
  | 306 | 306 | 'origin\_top'        => true |
  | 307 | 307 | ], |
  | 308 |  | 'version' => '2.4.~~7~~', |
  |  | 308 | 'version' => '2.4.8', |
  | 309 | 309 | 'activation\_date' => '' |
  | 310 | 310 | ]; |
  | […](/browser/responsive-lightbox/trunk/responsive-lightbox.php?rev=3054841#L2050) | […](/browser/responsive-lightbox/trunk/responsive-lightbox.php?rev=3137531#L2050) |  |
  | 2050 | 2050 |  |
  | 2051 | 2051 | case 'featherlight': |
  | 2052 |  | wp\_register\_script( 'responsive-lightbox-featherlight', plugins\_url( 'assets/featherlight/featherlight' . ( ! ( defined( 'SCRIPT\_DEBUG' ) && SCRIPT\_DEBUG ) ? '.min' : '' ) . '.js', \_\_FILE\_\_ ), [ 'jquery' ], $this->defaults['version'], $this->options['settings']['loading\_place'] === 'footer' ); |
  | 2053 |  |  |
  | 2054 |  | wp\_register\_style( |
  | 2055 |  | 'responsive-lightbox-featherlight', plugins\_url( 'assets/featherlight/featherlight' . ( ! ( defined( 'SCRIPT\_DEBUG' ) && SCRIPT\_DEBUG ) ? '.min' : '' ) . '.css', \_\_FILE\_\_ ), [], $this->defaults['version'] |
  | 2056 |  | ); |
  | 2057 |  |  |
  | 2058 |  | wp\_register\_script( 'responsive-lightbox-featherlight-gallery', plugins\_url( 'assets/featherlight/featherlight.gallery' . ( ! ( defined( 'SCRIPT\_DEBUG' ) && SCRIPT\_DEBUG ) ? '.min' : '' ) . '.js', \_\_FILE\_\_ ), [ 'jquery' ], $this->defaults['version'], $this->options['settings']['loading\_place'] === 'footer' ); |
  | 2059 |  |  |
  | 2060 |  | wp\_register\_style( |
  | 2061 |  | 'responsive-lightbox-featherlight-gallery', plugins\_url( 'assets/featherlight/featherlight.gallery' . ( ! ( defined( 'SCRIPT\_DEBUG' ) && SCRIPT\_DEBUG ) ? '.min' : '' ) . '.css', \_\_FILE\_\_ ), [], $this->defaults['version'] |
  | 2062 |  | ); |
  |  | 2052 | wp\_register\_script( 'responsive-lightbox-featherlight', plugins\_url( 'assets/featherlight/featherlight' . ( ! ( defined( 'SCRIPT\_DEBUG' ) && SCRIPT\_DEBUG ) ? '.min' : '' ) . '.js', \_\_FILE\_\_ ), [ 'jquery' ], '1.7.14', $this->options['settings']['loading\_place'] === 'footer' ); |
  |  | 2053 |  |
  |  | 2054 | wp\_register\_style( 'responsive-lightbox-featherlight', plugins\_url( 'assets/featherlight/featherlight' . ( ! ( defined( 'SCRIPT\_DEBUG' ) && SCRIPT\_DEBUG ) ? '.min' : '' ) . '.css', \_\_FILE\_\_ ), [], '1.7.14' ); |
  |  | 2055 |  |
  |  | 2056 | wp\_register\_script( 'responsive-lightbox-featherlight-gallery', plugins\_url( 'assets/featherlight/featherlight.gallery' . ( ! ( defined( 'SCRIPT\_DEBUG' ) && SCRIPT\_DEBUG ) ? '.min' : '' ) . '.js', \_\_FILE\_\_ ), [ 'jquery' ], '1.7.14', $this->options['settings']['loading\_place'] === 'footer' ); |
  |  | 2057 |  |
  |  | 2058 | wp\_register\_style( 'responsive-lightbox-featherlight-gallery', plugins\_url( 'assets/featherlight/featherlight.gallery' . ( ! ( defined( 'SCRIPT\_DEBUG' ) && SCRIPT\_DEBUG ) ? '.min' : '' ) . '.css', \_\_FILE\_\_ ), [], '1.7.14' ); |
  | 2063 | 2059 |  |
  | 2064 | 2060 | $scripts[] = 'responsive-lightbox-featherlight'; |
  | […](/browser/responsive-lightbox/trunk/responsive-lightbox.php?rev=3054841#L2081) | […](/browser/responsive-lightbox/trunk/responsive-lightbox.php?rev=3137531#L2077) |  |
  | 2081 | 2077 |  |
  | 2082 | 2078 | case 'magnific': |
  | 2083 |  | wp\_register\_script( 'responsive-lightbox-magnific', plugins\_url( 'assets/magnific/jquery.magnific-popup' . ( ! ( defined( 'SCRIPT\_DEBUG' ) && SCRIPT\_DEBUG ) ? '.min' : '' ) . '.js', \_\_FILE\_\_ ), [ 'jquery' ], ~~$this->defaults['version']~~, $this->options['settings']['loading\_place'] === 'footer' ); |
  | 2084 |  |  |
  | 2085 |  | wp\_register\_style( 'responsive-lightbox-magnific', plugins\_url( 'assets/magnific/magnific-popup' . ( ! ( defined( 'SCRIPT\_DEBUG' ) && SCRIPT\_DEBUG ) ? '.min' : '' ) . '.css', \_\_FILE\_\_ ), [], ~~$this->defaults['version']~~ ); |
  |  | 2079 | wp\_register\_script( 'responsive-lightbox-magnific', plugins\_url( 'assets/magnific/jquery.magnific-popup' . ( ! ( defined( 'SCRIPT\_DEBUG' ) && SCRIPT\_DEBUG ) ? '.min' : '' ) . '.js', \_\_FILE\_\_ ), [ 'jquery' ], '1.2.0', $this->options['settings']['loading\_place'] === 'footer' ); |
  |  | 2080 |  |
  |  | 2081 | wp\_register\_style( 'responsive-lightbox-magnific', plugins\_url( 'assets/magnific/magnific-popup' . ( ! ( defined( 'SCRIPT\_DEBUG' ) && SCRIPT\_DEBUG ) ? '.min' : '' ) . '.css', \_\_FILE\_\_ ), [], '1.2.0' ); |
  | 2086 | 2082 |  |
  | 2087 | 2083 | $scripts[] = 'responsive-lightbox-magnific'; |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3137531)
* [Zip Archive](?format=zip&new=3137531)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_3f666047_20250111_162257.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fresponsive-lightbox%2Ftags%2F2.4.7%2Fincludes%2Fclass-remote-library.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/responsive-lightbox/tags/2.4.7/includes/class-remote-library.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/responsive-lightbox/tags/2.4.7/includes/class-remote-library.php)

---

# [source:](/browser?order=name "Go to repository root") [responsive-lightbox](/browser/responsive-lightbox?order=name "View responsive-lightbox")/[tags](/browser/responsive-lightbox/tags?order=name "View tags")/[2.4.7](/browser/responsive-lightbox/tags/2.4.7?order=name "View 2.4.7")/[includes](/browser/responsive-lightbox/tags/2.4.7/includes?order=name "View includes")/[class-remote-library.php](/browser/responsive-lightbox/tags/2.4.7/includes/class-remote-library.php?order=name "View class-remote-library.php")

View diff against:

View revision:

| [Last change](/changeset/3054822/responsive-lightbox/tags/2.4.7/includes/class-remote-library.php "View differences") on this file was [3054822](/changeset/3054822/ "View changeset 3054822"), checked in by dfactory, [10 months ago](/timeline?from=2024-03-19T21%3A04%3A34Z&precision=second "See timeline at 03/19/2024 09:04:34 PM") |
| --- |
| Tagging version 2.4.7 |
| **File size:** 16.4 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | // exit if accessed directly |
| [3](#L3) | if ( ! defined( 'ABSPATH' ) ) |
| [4](#L4) | exit; |
| [5](#L5) |  |
| [6](#L6) | /\*\* |
| [7](#L7) | \* Responsive Lightbox Remote Library class. |
| [8](#L8) | \* |
| [9](#L9) | \* @class Responsive\_Lightbox\_Remote\_Library |
| [10](#L10) | \*/ |
| [11](#L11) | class Responsive\_Lightbox\_Remote\_Library { |
| [12](#L12) |  |
| [13](#L13) | public $providers = []; |
| [14](#L14) |  |
| [15](#L15) | /\*\* |
| [16](#L16) | \* Class constructor. |
| [17](#L17) | \* |
| [18](#L18) | \* @return void |
| [19](#L19) | \*/ |
| [20](#L20) | public function \_\_construct() { |
| [21](#L21) | // is remote library active? |
| [22](#L22) | if ( ! Responsive\_Lightbox()->options['remote\_library']['active'] ) |
| [23](#L23) | return; |
| [24](#L24) |  |
| [25](#L25) | // actions |
| [26](#L26) | add\_action( 'wp\_ajax\_rl\_remote\_library\_query', [ $this, 'ajax\_query\_media' ] ); |
| [27](#L27) | add\_action( 'wp\_ajax\_rl\_upload\_image', [ $this, 'ajax\_upload\_image' ] ); |
| [28](#L28) | add\_action( 'admin\_enqueue\_scripts', [ $this, 'remote\_library\_scripts' ] ); |
| [29](#L29) |  |
| [30](#L30) | // add filter to send new data to editor |
| [31](#L31) | add\_filter( 'image\_send\_to\_editor', [ $this, 'send\_image\_to\_editor' ], 21, 8 ); |
| [32](#L32) | } |
| [33](#L33) |  |
| [34](#L34) | /\*\* |
| [35](#L35) | \* Hidden field with response data for gallery preview. |
| [36](#L36) | \* |
| [37](#L37) | \* @param array $args Field arguments |
| [38](#L38) | \* @return string |
| [39](#L39) | \*/ |
| [40](#L40) | public function remote\_library\_response\_data( $args ) { |
| [41](#L41) | // get main instance |
| [42](#L42) | $rl = Responsive\_Lightbox(); |
| [43](#L43) |  |
| [44](#L44) | // get active providers |
| [45](#L45) | $providers = $this->get\_active\_providers(); |
| [46](#L46) |  |
| [47](#L47) | $html = ''; |
| [48](#L48) |  |
| [49](#L49) | // any providers? |
| [50](#L50) | if ( ! empty( $providers ) ) { |
| [51](#L51) | foreach ( $providers as $provider ) { |
| [52](#L52) | // get provider |
| [53](#L53) | $provider = $rl->providers[$provider]; |
| [54](#L54) |  |
| [55](#L55) | // add response data arguments if needed |
| [56](#L56) | if ( ! empty( $provider['response\_args'] ) ) { |
| [57](#L57) | $response = $provider['instance']->get\_response\_data(); |
| [58](#L58) |  |
| [59](#L59) | foreach ( $provider['response\_args'] as $arg ) { |
| [60](#L60) | if ( array\_key\_exists( $arg, $response ) ) { |
| [61](#L61) | $html .= '<span id="' . esc\_attr( 'rl\_' . $args['tab\_id'] . '\_' . $args['menu\_item'] . '\_' . $args['field'] . '\_' . $provider['slug'] . '\_' . $arg ) . '" class="rl-response-data" data-value="' . esc\_attr( base64\_encode( wp\_json\_encode( $response[$arg] ) ) ) . '" data-name="' . esc\_attr( $arg ) . '" data-provider="' . esc\_attr( $provider['slug'] ) . '"></span>'; |
| [62](#L62) | } |
| [63](#L63) | } |
| [64](#L64) | } |
| [65](#L65) | } |
| [66](#L66) | } |
| [67](#L67) |  |
| [68](#L68) | return $html; |
| [69](#L69) | } |
| [70](#L70) |  |
| [71](#L71) | /\*\* |
| [72](#L72) | \* Send updated image data to editor. |
| [73](#L73) | \* |
| [74](#L74) | \* @param string $html The image HTML markup to send |
| [75](#L75) | \* @param int $id The attachment ID |
| [76](#L76) | \* @param string $caption The image caption |
| [77](#L77) | \* @param string $title The image title |
| [78](#L78) | \* @param string $align The image alignment |
| [79](#L79) | \* @param string $url The image source URL |
| [80](#L80) | \* @param string|array $size Size of image |
| [81](#L81) | \* @param string $alt The image alternative text. |
| [82](#L82) | \* @return string |
| [83](#L83) | \*/ |
| [84](#L84) | function send\_image\_to\_editor( $html, $id, $caption, $title, $align, $url, $size, $alt ) { |
| [85](#L85) | if ( $id === Responsive\_Lightbox()->galleries->maybe\_generate\_thumbnail() && isset( $\_POST['attachment'] ) && is\_array( $\_POST['attachment'] ) ) { |
| [86](#L86) | $attachment = wp\_unslash( $\_POST['attachment'] ); |
| [87](#L87) |  |
| [88](#L88) | if ( isset( $attachment['remote\_library\_image'], $attachment['width'], $attachment['height'] ) ) { |
| [89](#L89) | $html = preg\_replace( '/src=(\'|")(.\*?)(\'|")/', 'src="' . ( ! empty( $attachment['rl\_url'] ) ? esc\_url( $attachment['rl\_url'] ) : $url ) . '"', $html ); |
| [90](#L90) | $html = preg\_replace( '/width=(\'|")(.\*?)(\'|")/', 'width="' . (int) $attachment['width'] . '"', $html ); |
| [91](#L91) | $html = preg\_replace( '/height=(\'|")(.\*?)(\'|")/', 'height="' . (int) $attachment['height'] . '"', $html ); |
| [92](#L92) | $html = preg\_replace( '/(\s)?id="attachment\_' . (int) $id . '"/', '', $html ); |
| [93](#L93) | $html = preg\_replace( '/(\s)?wp-image-' . (int) $id . '/', '', $html ); |
| [94](#L94) | } |
| [95](#L95) | } |
| [96](#L96) |  |
| [97](#L97) | return $html; |
| [98](#L98) | } |
| [99](#L99) |  |
| [100](#L100) | /\*\* |
| [101](#L101) | \* Get all available providers. |
| [102](#L102) | \* |
| [103](#L103) | \* @return array |
| [104](#L104) | \*/ |
| [105](#L105) | public function get\_providers() { |
| [106](#L106) | return (array) apply\_filters( 'rl\_get\_providers', Responsive\_Lightbox()->providers ); |
| [107](#L107) | } |
| [108](#L108) |  |
| [109](#L109) | /\*\* |
| [110](#L110) | \* Get all active providers. |
| [111](#L111) | \* |
| [112](#L112) | \* @return array |
| [113](#L113) | \*/ |
| [114](#L114) | public function get\_active\_providers() { |
| [115](#L115) | $providers = $this->get\_providers(); |
| [116](#L116) | $active\_providers = []; |
| [117](#L117) |  |
| [118](#L118) | foreach ( $providers as $provider => $data ) { |
| [119](#L119) | if ( Responsive\_Lightbox()->options['remote\_library'][$provider]['active'] ) |
| [120](#L120) | $active\_providers[] = $provider; |
| [121](#L121) | } |
| [122](#L122) |  |
| [123](#L123) | return (array) apply\_filters( 'rl\_get\_active\_providers', $active\_providers ); |
| [124](#L124) | } |
| [125](#L125) |  |
| [126](#L126) | /\*\* |
| [127](#L127) | \* Check whether provider is active. |
| [128](#L128) | \* |
| [129](#L129) | \* @param string $provider Media provider |
| [130](#L130) | \* @return bool |
| [131](#L131) | \*/ |
| [132](#L132) | public function is\_active\_provider( $provider ) { |
| [133](#L133) | $providers = $this->get\_providers(); |
| [134](#L134) | $rl = Responsive\_Lightbox(); |
| [135](#L135) |  |
| [136](#L136) | return (bool) apply\_filters( 'rl\_is\_active\_provider', array\_key\_exists( $provider, $rl->options['remote\_library'] ) && $rl->options['remote\_library'][$provider]['active'], $provider ); |
| [137](#L137) | } |
| [138](#L138) |  |
| [139](#L139) | /\*\* |
| [140](#L140) | \* Scripts and styles for media frame. |
| [141](#L141) | \* |
| [142](#L142) | \* @global string $wp\_version |
| [143](#L143) | \* @global string $pagenow |
| [144](#L144) | \* |
| [145](#L145) | \* @return void |
| [146](#L146) | \*/ |
| [147](#L147) | public function remote\_library\_scripts() { |
| [148](#L148) | global $wp\_version; |
| [149](#L149) | global $pagenow; |
| [150](#L150) |  |
| [151](#L151) | // display only for post edit pages |
| [152](#L152) | if ( ! ( ( $pagenow === 'post.php' || $pagenow === 'post-new.php' ) || ( version\_compare( $wp\_version, '5.8', '>=' ) && ( $pagenow === 'widgets.php' || $pagenow === 'customize.php' ) ) ) ) |
| [153](#L153) | return; |
| [154](#L154) |  |
| [155](#L155) | // get main instance |
| [156](#L156) | $rl = Responsive\_Lightbox(); |
| [157](#L157) |  |
| [158](#L158) | wp\_enqueue\_script( 'responsive-lightbox-remote-library-media', RESPONSIVE\_LIGHTBOX\_URL . '/js/admin-media.js', [ 'jquery', 'media-models', 'underscore' ], $rl->defaults['version'] ); |
| [159](#L159) |  |
| [160](#L160) | // prepare script data |
| [161](#L161) | $script\_data = [ |
| [162](#L162) | 'thumbnailID'                   => $rl->galleries->maybe\_generate\_thumbnail(), |
| [163](#L163) | 'postID'                                => get\_the\_ID(), |
| [164](#L164) | 'providers'                             => $this->get\_providers(), |
| [165](#L165) | 'providersActive'               => $this->get\_active\_providers(), |
| [166](#L166) | 'allProviders'                  => esc\_html\_\_( 'All providers', 'responsive-lightbox' ), |
| [167](#L167) | 'uploadAndInsert'               => esc\_html\_\_( 'Upload and Insert', 'responsive-lightbox' ), |
| [168](#L168) | 'uploadAndSelect'               => esc\_html\_\_( 'Upload and Select', 'responsive-lightbox' ), |
| [169](#L169) | 'filterByremoteLibrary' => esc\_html\_\_( 'Filter by remote library', 'responsive-lightbox' ), |
| [170](#L170) | 'getUploadNonce'                => wp\_create\_nonce( 'rl-remote-library-upload-image' ) |
| [171](#L171) | ]; |
| [172](#L172) |  |
| [173](#L173) | wp\_add\_inline\_script( 'responsive-lightbox-remote-library-media', 'var rlRemoteLibraryMedia = ' . wp\_json\_encode( $script\_data ) . ";\n", 'before' ); |
| [174](#L174) |  |
| [175](#L175) | // enqueue gallery |
| [176](#L176) | $rl->galleries->enqueue\_gallery\_scripts\_styles(); |
| [177](#L177) | } |
| [178](#L178) |  |
| [179](#L179) | /\*\* |
| [180](#L180) | \* AJAX media query action. |
| [181](#L181) | \* |
| [182](#L182) | \* @return void |
| [183](#L183) | \*/ |
| [184](#L184) | public function ajax\_query\_media() { |
| [185](#L185) | $data = stripslashes\_deep( $\_POST ); |
| [186](#L186) | $results = [ |
| [187](#L187) | 'last'          => false, |
| [188](#L188) | 'images'        => [], |
| [189](#L189) | 'data'          => [] |
| [190](#L190) | ]; |
| [191](#L191) |  |
| [192](#L192) | if ( isset( $data['media\_provider'], $data['media\_search'], $data['media\_page'] ) ) { |
| [193](#L193) | $data['media\_provider'] = sanitize\_key( $data['media\_provider'] ); |
| [194](#L194) |  |
| [195](#L195) | if ( $data['media\_provider'] === 'all' || $this->is\_active\_provider( $data['media\_provider'] ) ) { |
| [196](#L196) | $data['preview\_page'] = (int) $data['media\_page']; |
| [197](#L197) | $data['preview\_per\_page'] = 20; |
| [198](#L198) |  |
| [199](#L199) | // get images |
| [200](#L200) | $results['images'] = $this->get\_remote\_library\_images( $data ); |
| [201](#L201) |  |
| [202](#L202) | // get main instance |
| [203](#L203) | $rl = Responsive\_Lightbox(); |
| [204](#L204) |  |
| [205](#L205) | // single provider? |
| [206](#L206) | if ( $data['media\_provider'] !== 'all' ) { |
| [207](#L207) | // get provider |
| [208](#L208) | $provider = $rl->providers[$data['media\_provider']]; |
| [209](#L209) |  |
| [210](#L210) | // add response data arguments if needed |
| [211](#L211) | if ( ! empty( $provider['response\_args'] ) ) { |
| [212](#L212) | $response = $provider['instance']->get\_response\_data(); |
| [213](#L213) |  |
| [214](#L214) | foreach ( $provider['response\_args'] as $arg ) { |
| [215](#L215) | if ( array\_key\_exists( $arg, $response ) ) |
| [216](#L216) | $results['data'][$provider['slug']][$arg] = base64\_encode( wp\_json\_encode( $response[$arg] ) ); |
| [217](#L217) | } |
| [218](#L218) | } |
| [219](#L219) | } else { |
| [220](#L220) | // get active providers |
| [221](#L221) | $providers = $this->get\_active\_providers(); |
| [222](#L222) |  |
| [223](#L223) | if ( ! empty( $providers ) ) { |
| [224](#L224) | foreach ( $providers as $provider ) { |
| [225](#L225) | // get provider |
| [226](#L226) | $provider = $rl->providers[$provider]; |
| [227](#L227) |  |
| [228](#L228) | // add response data arguments if needed |
| [229](#L229) | if ( ! empty( $provider['response\_args'] ) ) { |
| [230](#L230) | $response = $provider['instance']->get\_response\_data(); |
| [231](#L231) |  |
| [232](#L232) | foreach ( $provider['response\_args'] as $arg ) { |
| [233](#L233) | if ( array\_key\_exists( $arg, $response ) ) |
| [234](#L234) | $results['data'][$provider['slug']][$arg] = base64\_encode( wp\_json\_encode( $response[$arg] ) ); |
| [235](#L235) | } |
| [236](#L236) | } |
| [237](#L237) | } |
| [238](#L238) | } |
| [239](#L239) | } |
| [240](#L240) |  |
| [241](#L241) | if ( ! empty( $results['images'] ) ) { |
| [242](#L242) | // create WP compatible attachments |
| [243](#L243) | $results['images'] = $this->create\_wp\_remote\_attachments( $results['images'], $data ); |
| [244](#L244) |  |
| [245](#L245) | // handle last page if needed |
| [246](#L246) | $results['last'] = apply\_filters( 'rl\_remote\_library\_query\_last\_page', false, $results, $data ); |
| [247](#L247) | } else |
| [248](#L248) | $results['last'] = true; |
| [249](#L249) | } |
| [250](#L250) | } |
| [251](#L251) |  |
| [252](#L252) | // send data |
| [253](#L253) | wp\_send\_json( $results ); |
| [254](#L254) | } |
| [255](#L255) |  |
| [256](#L256) | /\*\* |
| [257](#L257) | \* AJAX upload image action. |
| [258](#L258) | \* |
| [259](#L259) | \* @return void |
| [260](#L260) | \*/ |
| [261](#L261) | public function ajax\_upload\_image() { |
| [262](#L262) | $data = stripslashes\_deep( $\_POST ); |
| [263](#L263) | $new\_data = []; |
| [264](#L264) |  |
| [265](#L265) | // verified upload? |
| [266](#L266) | if ( current\_user\_can( 'upload\_files' ) && isset( $data['rlnonce'], $data['image'], $data['post\_id'] ) && wp\_verify\_nonce( $data['rlnonce'], 'rl-remote-library-upload-image' ) ) { |
| [267](#L267) | if ( ! function\_exists( 'media\_handle\_upload' ) ) |
| [268](#L268) | require\_once( path\_join( ABSPATH, 'wp-admin/includes/media.php' ) ); |
| [269](#L269) |  |
| [270](#L270) | if ( ! function\_exists( 'wp\_handle\_upload' ) ) |
| [271](#L271) | require\_once( path\_join( ABSPATH, 'wp-admin/includes/file.php' ) ); |
| [272](#L272) |  |
| [273](#L273) | if ( ! empty( $data['image']['url'] ) ) { |
| [274](#L274) | // get image as binary data |
| [275](#L275) | $response = wp\_safe\_remote\_get( esc\_url\_raw( $data['image']['url'] ) ); |
| [276](#L276) |  |
| [277](#L277) | // get file name |
| [278](#L278) | $file\_name = basename( parse\_url( $data['image']['name'], PHP\_URL\_PATH ) ); |
| [279](#L279) |  |
| [280](#L280) | // check extension |
| [281](#L281) | $file\_ext = strrpos( $file\_name, '.' ); |
| [282](#L282) |  |
| [283](#L283) | // no extension? |
| [284](#L284) | if ( $file\_ext === false ) |
| [285](#L285) | $file\_name .= '.jpg'; |
| [286](#L286) |  |
| [287](#L287) | // no errors? |
| [288](#L288) | if ( ! is\_wp\_error( $response ) ) { |
| [289](#L289) | $bits = wp\_remote\_retrieve\_body( $response ); |
| [290](#L290) | $loaded = wp\_upload\_bits( $file\_name, null, $bits, current\_time( 'Y/m' ) ); |
| [291](#L291) |  |
| [292](#L292) | if ( isset( $loaded['error'] ) && $loaded['error'] ) { |
| [293](#L293) | $results = [ |
| [294](#L294) | 'error'         => true, |
| [295](#L295) | 'message'       => $loaded['error'] |
| [296](#L296) | ]; |
| [297](#L297) | } else { |
| [298](#L298) | // simulate upload |
| [299](#L299) | $\_FILES['rl-remote-image'] = [ |
| [300](#L300) | 'error'         => 0, |
| [301](#L301) | 'name'          => $file\_name, |
| [302](#L302) | 'tmp\_name'      => $loaded['file'], |
| [303](#L303) | 'size'          => filesize( $loaded['file'] ) |
| [304](#L304) | ]; |
| [305](#L305) |  |
| [306](#L306) | // get post ID |
| [307](#L307) | $post\_id = isset( $data['post\_id'] ) ? (int) $data['post\_id'] : 0; |
| [308](#L308) |  |
| [309](#L309) | // upload image, wp handle sanitization and validation here |
| [310](#L310) | $attachment\_id = media\_handle\_upload( |
| [311](#L311) | 'rl-remote-image', |
| [312](#L312) | $post\_id, |
| [313](#L313) | [ |
| [314](#L314) | 'post\_title'    => $data['image']['title'], |
| [315](#L315) | 'post\_content'  => $data['image']['description'], |
| [316](#L316) | 'post\_excerpt'  => $data['image']['caption'] |
| [317](#L317) | ], |
| [318](#L318) | [ |
| [319](#L319) | 'action'        => 'rl\_remote\_library\_handle\_upload', |
| [320](#L320) | 'test\_form'     => false |
| [321](#L321) | ] |
| [322](#L322) | ); |
| [323](#L323) |  |
| [324](#L324) | // upload success? |
| [325](#L325) | if ( ! is\_wp\_error( $attachment\_id ) ) { |
| [326](#L326) | add\_post\_meta( $attachment\_id, '\_wp\_attachment\_image\_alt', $data['image']['alt'] ); |
| [327](#L327) |  |
| [328](#L328) | $new\_data['id'] = $attachment\_id; |
| [329](#L329) | $new\_data['full'] = wp\_get\_attachment\_image\_src( $attachment\_id, 'full' ); |
| [330](#L330) | } |
| [331](#L331) | } |
| [332](#L332) | } |
| [333](#L333) | } |
| [334](#L334) | } |
| [335](#L335) |  |
| [336](#L336) | // send data |
| [337](#L337) | wp\_send\_json( $new\_data ); |
| [338](#L338) | } |
| [339](#L339) |  |
| [340](#L340) | /\*\* |
| [341](#L341) | \* Create WP compatible attachments for JavaScript. |
| [342](#L342) | \* |
| [343](#L343) | \* @param array $results Requested images |
| [344](#L344) | \* @param array $args Additional arguments |
| [345](#L345) | \* @return array |
| [346](#L346) | \*/ |
| [347](#L347) | public function create\_wp\_remote\_attachments( $results, $args ) { |
| [348](#L348) | // get current user |
| [349](#L349) | $user = wp\_get\_current\_user(); |
| [350](#L350) |  |
| [351](#L351) | // copy results |
| [352](#L352) | $copy = $results; |
| [353](#L353) |  |
| [354](#L354) | // get current time |
| [355](#L355) | $time = current\_time( 'timestamp' ); |
| [356](#L356) |  |
| [357](#L357) | // get date format |
| [358](#L358) | $date\_format = get\_option( 'date\_format' ); |
| [359](#L359) |  |
| [360](#L360) | // format date |
| [361](#L361) | $date = date\_i18n( \_\_( 'F j Y' ), $time ); |
| [362](#L362) |  |
| [363](#L363) | // $result is already sanitized by specific provider sanitize\_result function |
| [364](#L364) | foreach ( $results as $no => $result ) { |
| [365](#L365) | // make sure those attributes are strings |
| [366](#L366) | $copy[$no]['caption'] = (string) $result['caption']; |
| [367](#L367) | $copy[$no]['description'] = (string) $result['description']; |
| [368](#L368) | $copy[$no]['title'] = (string) $result['title']; |
| [369](#L369) | $copy[$no]['filename'] = $copy[$no]['name'] = (string) $result['filename']; |
| [370](#L370) |  |
| [371](#L371) | // rest of attributes |
| [372](#L372) | $copy[$no]['id'] = 'rl-attachment-' . ( ( $args['preview\_page'] - 1 ) \* $args['preview\_per\_page'] + $no ) . '-' . $args['media\_provider']; |
| [373](#L373) | $copy[$no]['remote\_library\_image'] = true; |
| [374](#L374) | $copy[$no]['author'] = $user->ID; |
| [375](#L375) | $copy[$no]['authorName'] = esc\_html( $user->user\_login ); |
| [376](#L376) | $copy[$no]['can'] = [ |
| [377](#L377) | 'save' => true, |
| [378](#L378) | 'remove' => false |
| [379](#L379) | ]; |
| [380](#L380) | $copy[$no]['compat'] = ''; |
| [381](#L381) | $copy[$no]['date'] = $time; |
| [382](#L382) | $copy[$no]['dateFormatted'] = $date; |
| [383](#L383) | $copy[$no]['delete'] = ''; |
| [384](#L384) | $copy[$no]['edit'] = ''; |
| [385](#L385) | $copy[$no]['update'] = ''; |
| [386](#L386) | $copy[$no]['filesizeHumanReadable'] = ''; |
| [387](#L387) | $copy[$no]['filesizeInBytes'] = 0; |
| [388](#L388) | $copy[$no]['icon'] = ''; |
| [389](#L389) | $copy[$no]['link'] = $result['url']; |
| [390](#L390) | $copy[$no]['menuOrder'] = 0; |
| [391](#L391) | $copy[$no]['meta'] = false; |
| [392](#L392) |  |
| [393](#L393) | // check extension |
| [394](#L394) | $file\_ext = strrpos( basename( parse\_url( $result['url'], PHP\_URL\_PATH ) ), '.' ); |
| [395](#L395) |  |
| [396](#L396) | // no extension? |
| [397](#L397) | if ( $file\_ext === false ) |
| [398](#L398) | $file\_ext .= 'jpg'; |
| [399](#L399) |  |
| [400](#L400) | if ( $file\_ext === 'png' || $file\_ext === 'gif' ) { |
| [401](#L401) | $copy[$no]['mime'] = 'image/' . $file\_ext; |
| [402](#L402) | $copy[$no]['subtype'] = $file\_ext; |
| [403](#L403) | } else { |
| [404](#L404) | $copy[$no]['mime'] = 'image/jpeg'; |
| [405](#L405) | $copy[$no]['subtype'] = 'jpeg'; |
| [406](#L406) | } |
| [407](#L407) |  |
| [408](#L408) | $copy[$no]['modified'] = $time; |
| [409](#L409) | $copy[$no]['nonces'] = [ |
| [410](#L410) | 'delete'        => '', |
| [411](#L411) | 'edit'          => '', |
| [412](#L412) | 'update'        => '' |
| [413](#L413) | ]; |
| [414](#L414) | $copy[$no]['orientation'] = $result['orientation']; |
| [415](#L415) | $copy[$no]['status'] = 'inherit'; |
| [416](#L416) | $copy[$no]['type'] = 'image'; |
| [417](#L417) | $copy[$no]['uploadedTo'] = 0; |
| [418](#L418) | $copy[$no]['uploadedToLink'] = ''; |
| [419](#L419) | $copy[$no]['uploadedToTitle'] = ''; |
| [420](#L420) | $copy[$no]['sizes'] = [ |
| [421](#L421) | 'medium' => [ |
| [422](#L422) | 'height'                => $result['thumbnail\_height'], |
| [423](#L423) | 'width'                 => $result['thumbnail\_width'], |
| [424](#L424) | 'orientation'   => $result['thumbnail\_orientation'], |
| [425](#L425) | 'url'                   => $result['thumbnail\_url'] |
| [426](#L426) | ], |
| [427](#L427) | 'full' => [ |
| [428](#L428) | 'height'                => $result['height'], |
| [429](#L429) | 'width'                 => $result['width'], |
| [430](#L430) | 'orientation'   => $result['orientation'], |
| [431](#L431) | 'url'                   => $result['url'] |
| [432](#L432) | ] |
| [433](#L433) | ]; |
| [434](#L434) | } |
| [435](#L435) |  |
| [436](#L436) | return (array) apply\_filters( 'rl\_remote\_library\_wp\_attachments', $copy, $args ); |
| [437](#L437) | } |
| [438](#L438) |  |
| [439](#L439) | /\*\* |
| [440](#L440) | \* Remote library media query. |
| [441](#L441) | \* |
| [442](#L442) | \* @param array $args |
| [443](#L443) | \* @return array |
| [444](#L444) | \*/ |
| [445](#L445) | public function get\_remote\_library\_images( $args ) { |
| [446](#L446) | $args = stripslashes\_deep( $args ); |
| [447](#L447) |  |
| [448](#L448) | // search phrase |
| [449](#L449) | if ( isset( $args['media\_search'] ) ) |
| [450](#L450) | $args['media\_search'] = strtolower( trim( $args['media\_search'] ) ); |
| [451](#L451) | else |
| [452](#L452) | $args['media\_search'] = ''; |
| [453](#L453) |  |
| [454](#L454) | // media provider |
| [455](#L455) | if ( isset( $args['media\_provider'] ) ) |
| [456](#L456) | $args['media\_provider'] = trim( $args['media\_provider'] ); |
| [457](#L457) | else |
| [458](#L458) | $args['media\_provider'] = 'all'; |
| [459](#L459) |  |
| [460](#L460) | // page number |
| [461](#L461) | if ( isset( $args['preview\_page'] ) ) |
| [462](#L462) | $args['preview\_page'] = (int) $args['preview\_page']; |
| [463](#L463) | else |
| [464](#L464) | $args['preview\_page'] = 1; |
| [465](#L465) |  |
| [466](#L466) | // number of images per page |
| [467](#L467) | if ( isset( $args['preview\_per\_page'] ) ) |
| [468](#L468) | $args['preview\_per\_page'] = (int) $args['preview\_per\_page']; |
| [469](#L469) | else |
| [470](#L470) | $args['preview\_per\_page'] = 20; |
| [471](#L471) |  |
| [472](#L472) | // get active providers |
| [473](#L473) | $providers = $this->get\_active\_providers(); |
| [474](#L474) |  |
| [475](#L475) | // prepare valid providers |
| [476](#L476) | $valid\_providers = []; |
| [477](#L477) |  |
| [478](#L478) | if ( $args['media\_provider'] === 'all' ) |
| [479](#L479) | $valid\_providers = $providers; |
| [480](#L480) | elseif ( in\_array( $args['media\_provider'], $providers, true ) ) |
| [481](#L481) | $valid\_providers[] = $args['media\_provider']; |
| [482](#L482) |  |
| [483](#L483) | $results = []; |
| [484](#L484) |  |
| [485](#L485) | // any valid providers? |
| [486](#L486) | if ( ! empty( $valid\_providers ) ) { |
| [487](#L487) | // get main instance |
| [488](#L488) | $rl = Responsive\_Lightbox(); |
| [489](#L489) |  |
| [490](#L490) | foreach ( $valid\_providers as $provider\_name ) { |
| [491](#L491) | if ( ! empty( $args['response\_data'][$provider\_name] ) ) { |
| [492](#L492) | // get provider |
| [493](#L493) | $provider = $rl->providers[$provider\_name]; |
| [494](#L494) |  |
| [495](#L495) | if ( ! empty( $provider['response\_args'] ) ) { |
| [496](#L496) | foreach ( $provider['response\_args'] as $arg ) { |
| [497](#L497) | if ( array\_key\_exists( $arg, $args['response\_data'][$provider\_name] ) ) { |
| [498](#L498) | $base64 = base64\_decode( $args['response\_data'][$provider\_name][$arg] ); |
| [499](#L499) |  |
| [500](#L500) | if ( ! empty( $base64 ) ) |
| [501](#L501) | $args['response\_data'][$provider\_name][$arg] = json\_decode( $base64, true ); |
| [502](#L502) | } |
| [503](#L503) | } |
| [504](#L504) | } |
| [505](#L505) | } |
| [506](#L506) |  |
| [507](#L507) | // get results |
| [508](#L508) | $results = apply\_filters( 'rl\_remote\_library\_query', $results, $args['media\_search'], $provider\_name, $args ); |
| [509](#L509) |  |
| [510](#L510) | // number of results |
| [511](#L511) | $nor = count( $results ); |
| [512](#L512) |  |
| [513](#L513) | // more than requested images? |
| [514](#L514) | if ( $nor > $args['preview\_per\_page'] ) { |
| [515](#L515) | // get part of images |
| [516](#L516) | $results = array\_slice( $results, 0, $args['preview\_per\_page'], true ); |
| [517](#L517) |  |
| [518](#L518) | break; |
| [519](#L519) | // same amount of images? |
| [520](#L520) | } elseif ( $nor === $args['preview\_per\_page'] ) |
| [521](#L521) | break; |
| [522](#L522) | } |
| [523](#L523) | } |
| [524](#L524) |  |
| [525](#L525) | return $results; |
| [526](#L526) | } |
| [527](#L527) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/responsive-lightbox/tags/2.4.7/includes/class-remote-library.php?format=txt)
* [Original Format](/export/3220775/responsive-lightbox/tags/2.4.7/includes/class-remote-library.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


