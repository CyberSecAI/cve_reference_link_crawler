- **Root cause of vulnerability:** The GitLab Dependency Proxy allows attackers to control HTTP responses, including headers, when using a custom Maven URL.
- **Weaknesses/vulnerabilities present:** Cross-Site Scripting (XSS) vulnerability due to the ability to manipulate HTTP headers, specifically `Content-Security-Policy` and `Content-Type`, and inject malicious content via the dependency proxy.
- **Impact of exploitation:** Execution of arbitrary JavaScript code in the context of the victim's browser when visiting a crafted URL, potentially leading to account compromise or data theft.
- **Attack vectors:** The attacker needs to configure a custom Maven URL in the GitLab project settings. Then, the attacker can manipulate the HTTP response from the server under that URL to inject a malicious script via the dependency proxy.
- **Required attacker capabilities/position:** The attacker needs to have at least Maintainer access to the GitLab project to configure the custom Maven URL and host the malicious server.