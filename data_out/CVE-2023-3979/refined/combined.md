=== Content from gitlab.com_f5ee32e1_20250111_013555.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Removed Developer can continue editing the source code of a public project

⚠ **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2082560](https://hackerone.com/reports/2082560)** by `theluci` on 2023-07-24, assigned to `GitLab Team`:

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

Hello,

#### Background

Gitlab provides a feature to create a [fork of a project](https://docs.gitlab.com/ee/user/project/repository/forking_workflow.html).

Gitlab also provides a feature to [Collaborate on merge requests across forks](https://docs.gitlab.com/ee/user/project/merge_requests/allow_collaboration.html). This feature allows upstream members to collaborate with you on your branch, when this option is enabled members who have permission to merge to the target branch get permission to write to the merge request’s source branch.

According to docs,

[![8july-4.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/920973510918408f55f98156b38b187056edc899/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f30616138376638372d653164362d343063612d616536622d6564343962393937333639312f386a756c792d342e706e67)

#### Vulnerability

When a merge request is created from a **public project** `victim-project` to one of its forks `victim-project-fork` **(Public project but merge requests has been set as Only Project Members)**, Only the members of the `victim-project-fork` has the ability to view, edit as well as **delete** the merge request.

A *malicious developer* of `victim-project` can utilize the above to create a merge request from `victim-project` to `victim-project-fork` with *collaboration option enabled* and continue affecting the integrity of `victim-project` **even after malicious developer has been removed**.

Attack flow looks as follows,

* `victim` is the *Owner* of **public project** `victim-project`
* `attacker` is a *Developer* of `victim-project`

1. `attacker` creates a **public fork** of `victim-project` in **his Personal namespace** `victim-project-fork`.
2. `attacker` goes to `victim-project-fork` settings and set *Merge requests* as **Only Project Members**.
3. `attacker` creates merge requests from every non-protected branch in `victim-project` to their respective branches in `victim-project-fork` with *collaboration option enabled*.
4. `attacker` is removed from `victim-project`.
5. `victim` cannot *view or delete the merge requests* in `victim-project-fork`.
6. `attacker` continues to be able to edit the source code of `victim-project` using open merge requests in `victim-project-fork`.

#### Steps to reproduce

1. `victim` creates a **public group** `victim-group` and a **public project** `victim-project` inside.
2. `victim` goes to `victim-group` membership page `https://gitlab.com/groups/<victim-group>/-/group_members` and adds `attacker` as *Developer*.
3. `victim` goes to `victim-project` and creates branch `another-branch`.
4. `attacker` goes to `victim-project` and creates a public fork in **his Personal namespace** `victim-project-fork`.
5. `attacker` goes to `victim-project-fork` settings `https://gitlab.com/<attacker_username>/<victim-project-fork>/edit`, **Expand Visibility, project features, permissions** and set *Merge requests* as **Only Project Members**.
6. `attacker` goes to `https://gitlab.com/<victim-group>/<victim-project>/-/merge_requests/new` and creates a merge request from `another-branch` in `victim-project` to `another-branch` in `victim-project-fork` with *collaboration option enabled*.

[![9july-1.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/8bec15c0093cea1d00efe1a3ee6e029001ef3dab/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61346435636564642d623335652d343730362d396430372d6333306162636432386339662f396a756c792d312e706e67)

In a real-world scenario, `attacker` will create merge requests from every *non-protected branch* in `victim-project` to their respective branches in `victim-project-fork` with *collaboration option enabled*.

7. `victim` removes `attacker` from `victim-group`.

`victim` is not able to *view or delete the merge requests* in `victim-project-fork` and has no idea merge requests with **collaboration option enabled exists**.

`attacker` continues to be able to edit the source code of `victim-project` using open merge requests in `victim-project-fork`.

8. `attacker` visits `victim-project`

9. `attacker` is able to make changes to `another-branch` in `victim-project`

* To create a new file, `attacker` switches to `another-branch` and create the file using **`+`** symbol.
* To edit an existing file `attacker` goes to the following API endpoint,

```
https://gitlab.com/<victim-group>/<victim-project>/-/edit/another-branch/<file_name>
```

As can be seen, `attacker` continues to be able to edit the source code of `victim-project`.

#### POC

[24july-2.mp4](https://user-content.gitlab-static.net/223086fe149321b42948dbae333cefc1ffbc96c9/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f66666631353135392d653135312d343932662d393031652d6432666238626533376463312f32346a756c792d322e6d7034 "Download '24july-2.mp4'")

#### Output of checks

This bug happens on GitLab.com (Probably on instance too).

#### Impact

A Removed Developer can continue editing the source code of a public project

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [8july-4.png](https://h1.sec.gitlab.net/a/0aa87f87-e1d6-40ca-ae6b-ed49b9973691/8july-4.png)
* [9july-1.png](https://h1.sec.gitlab.net/a/a4d5cedd-b35e-4706-9d07-c30abcd28c9f/9july-1.png)
* [24july-2.mp4](https://h1.sec.gitlab.net/a/fff15159-e151-492f-901e-d2fb8be37dc1/24july-2.mp4)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


