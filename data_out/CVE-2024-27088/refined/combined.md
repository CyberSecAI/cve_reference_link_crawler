=== Content from github.com_e7d64b85_20250110_205840.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmedikoo%2Fes5-ext%2Fissues%2F201)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmedikoo%2Fes5-ext%2Fissues%2F201)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=medikoo%2Fes5-ext)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[medikoo](/medikoo)
/
**[es5-ext](/medikoo/es5-ext)**
Public

* [Notifications](/login?return_to=%2Fmedikoo%2Fes5-ext) You must be signed in to change notification settings
* [Fork
  91](/login?return_to=%2Fmedikoo%2Fes5-ext)
* [Star
   176](/login?return_to=%2Fmedikoo%2Fes5-ext)

* [Code](/medikoo/es5-ext)
* [Issues
  43](/medikoo/es5-ext/issues)
* [Pull requests
  1](/medikoo/es5-ext/pulls)
* [Actions](/medikoo/es5-ext/actions)
* [Security](/medikoo/es5-ext/security)
* [Insights](/medikoo/es5-ext/pulse)

Additional navigation options

* [Code](/medikoo/es5-ext)
* [Issues](/medikoo/es5-ext/issues)
* [Pull requests](/medikoo/es5-ext/pulls)
* [Actions](/medikoo/es5-ext/actions)
* [Security](/medikoo/es5-ext/security)
* [Insights](/medikoo/es5-ext/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmedikoo%2Fes5-ext%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmedikoo%2Fes5-ext%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# redos in es5-ext #201

Closed

[GAP-dev](/GAP-dev) opened this issue
Sep 26, 2023
· 24 comments

Closed

# [redos in es5-ext](#top) #201

[GAP-dev](/GAP-dev) opened this issue
Sep 26, 2023
· 24 comments

Assignees
[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=40&v=4)](/medikoo)

Labels
[bug](/medikoo/es5-ext/labels/bug)

## Comments

[![@GAP-dev](https://avatars.githubusercontent.com/u/73922876?s=80&u=f80c784112e15ba0bd26457e40200764fb7d047a&v=4)](/GAP-dev)

Copy link

### **[GAP-dev](/GAP-dev)** commented [Sep 26, 2023](#issue-1912511313)

| Test Environment:  Apple M1 macbook air, 2020 (ventura 13.3.1)  node module  name : es5-ext  node js  version : v18.16.0  2023\_09\_26  이동하 ( Lee Dong Ha of ZeroPointer Lab )  강성현    ( kang seonghyeun )  박성진    ( sungjin park )  김찬호    ( Chanho Kim )  이수영    ( Lee Su Young )  김민욱    ( MinUk Kim )  Team : For CVE  Subject : ReDoS\_Vulnerability\_Report\_in\_the\_es5-ext\_Module\_copy.js\_2023-09-26 011618.041116.txt  Dear es5-ext team, I am writing to report a potential ReDoS (Regular Expression Denial of Service) vulnerability in your es5-ext module. It has come to my attention that the current regex implementation for parsing values in the module is susceptible to excessive backtracking, leading to potential DoS attacks.The regex implementation in question is as follows:  /^\s*function\s*([\0-')-\uffff]+)*\s*(([\0-(*-\uffff]*))\s\*{/  This vulnerability can be exploited when there is an imbalance in parentheses, which results in excessive backtracking and subsequently increases the CPU load and processing time significantly. This vulnerability can be triggered using the following input:  'function{' + 'n'.repeat(31) + '){'  Here is a simple PoC code to demonstrate the issue:  const protocolre = /^\s*function\s*([\0-')-\uffff]+)*\s*(([\0-(*-\uffff]*))\s\*{/;  const startTime = Date.now(); const maliciousInput = 'function{' + 'n'.repeat(31) + '){'  protocolre.test(maliciousInput);  const endTime = Date.now();  console.log("process time: ", endTime - startTime, "ms");  Modification adds a limit to the number of digits, thereby preventing the ReDoS vulnerability from occurring. I believe it is crucial to address this issue promptly to ensure the security of your module for all users. Please let me know if you need any further information or assistance with this matter.  <https://www.npmjs.com/package/es5-ext> |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=40&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)
[medikoo](/medikoo)
self-assigned this
[Sep 26, 2023](#event-10471273832)

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=80&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)

Copy link

Owner

### **[medikoo](/medikoo)** commented [Sep 26, 2023](#issuecomment-1735079550)

| [@GAP-dev](https://github.com/GAP-dev), thanks for opening that.  Have you approached the real-world scenario when that happened?  In normal circumstances, I believe *ReDos* cannot happen, as this regex is run only on function string representations where, by design, we cannot get into excessive backtracking (see that first group excludes `(` character, which in all cases will follow the group (e.g., `'function ' + 'n'.repeat(31) + ' (){}` which is a valid representation match on the spot.  Your test example (`'function{' + 'n'.repeat(31) + '){'`) doesn't show a valid function string representation  Such an attack would require overriding `toString` on a function instance first (so it returns an invalid string that triggers the issue). Still, this should be out of scope as if an attacker can manipulate the objects in the process. Similarly, we can just run an infinite loop to block the process. |
| --- |

All reactions

Sorry, something went wrong.

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=40&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)
[medikoo](/medikoo)
assigned [GAP-dev](/GAP-dev) and unassigned [medikoo](/medikoo)
[Sep 26, 2023](#event-10471922275)

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=40&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)
[medikoo](/medikoo)
added
the
[question](/medikoo/es5-ext/labels/question)
Further information is requested
label
[Sep 26, 2023](#event-10471923680)

[![@GAP-dev](https://avatars.githubusercontent.com/u/73922876?s=80&u=f80c784112e15ba0bd26457e40200764fb7d047a&v=4)](/GAP-dev)

Copy link

Author

### **[GAP-dev](/GAP-dev)** commented [Sep 27, 2023](#issuecomment-1736487435)

| Yes, This vulnerability can't exploit right now.  It seems that the input string is being sanitized. However, this is a potential vulnerability. If combined with another vulnerability, it could be exploited in a real-world service.  It should be implemented to further protect the system from potential attacks.  It's always a good practice to assume that attackers can and will find and exploit vulnerabilities, so a defense-in-depth approach, employing multiple layers of security controls and measures, is highly recommended. |
| --- |

All reactions

Sorry, something went wrong.

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=80&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)

Copy link

Owner

### **[medikoo](/medikoo)** commented [Sep 27, 2023](#issuecomment-1736935225)

| [@GAP-dev](https://github.com/GAP-dev) what solution do you propose? |
| --- |

All reactions

Sorry, something went wrong.

[![@GAP-dev](https://avatars.githubusercontent.com/u/73922876?s=80&u=f80c784112e15ba0bd26457e40200764fb7d047a&v=4)](/GAP-dev)

Copy link

Author

### **[GAP-dev](/GAP-dev)** commented [Sep 27, 2023](#issuecomment-1737281773)

| /^\s*function\s+[a-zA-Z\_$][0-9a-zA-Z\_$]*\s\*([^\)]*)\s*{/ like this |
| --- |

All reactions

Sorry, something went wrong.

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=80&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)

Copy link

Owner

### **[medikoo](/medikoo)** commented [Sep 27, 2023](#issuecomment-1737659802)

| [@GAP-dev](https://github.com/GAP-dev) Version you propose is broken:  ``` const re = /^\sfunction\s+[a-zA-Z_$][0-9a-zA-Z_$]\s*([^\)])\s{/  console.log(re.test(String(function myFuńctión() { }))) ```  Logs `false` |
| --- |

All reactions

Sorry, something went wrong.

[![@GAP-dev](https://avatars.githubusercontent.com/u/73922876?s=80&u=f80c784112e15ba0bd26457e40200764fb7d047a&v=4)](/GAP-dev)

Copy link

Author

### **[GAP-dev](/GAP-dev)** commented [Sep 27, 2023](#issuecomment-1738108516)

| oh, sorry /function\s+([\p{L}*$][\p{L}\p{N}*$]*)\s*()\s\*{\s\*}/gu how about this?  ``` const regex = /function\s+([\p{L}_$][\p{L}\p{N}_$]*)\s*\(\)\s*\{\s*\}/gu; const str = ` function myFuńctión() { } function myfunciton() { } function F() { } function add() { } `; let m; while ((m = regex.exec(str)) !== null) {     console.log(m[1]); } ```  [image](https://private-user-images.githubusercontent.com/73922876/271121277-31d7cd90-10b4-45d1-9c11-2e6483e3f658.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NDMwMjAsIm5iZiI6MTczNjU0MjcyMCwicGF0aCI6Ii83MzkyMjg3Ni8yNzExMjEyNzctMzFkN2NkOTAtMTBiNC00NWQxLTljMTEtMmU2NDgzZTNmNjU4LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDIwNTg0MFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTJiODhlNWRkYjM0ZDRlYWUxYjM0OTVhZWNmZWNlOGUzMDY0ODFmYWJlMGRlNGE3NzE4YjcxMzQ5OGNmMGRmZDAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.J2uXKi-DfoLPwX4wInbcZ6pROB_hP68vBf5jlblEA4I) |
| --- |

All reactions

Sorry, something went wrong.

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=80&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)

Copy link

Owner

### **[medikoo](/medikoo)** commented [Sep 28, 2023](#issuecomment-1738604936)

| [@GAP-dev](https://github.com/GAP-dev) what you test above is not a valid function string representation, also in this package we need to support all ES5+ engines, while `u` flag was introduced with ES2018 |
| --- |

All reactions

Sorry, something went wrong.

[![@GAP-dev](https://avatars.githubusercontent.com/u/73922876?s=80&u=f80c784112e15ba0bd26457e40200764fb7d047a&v=4)](/GAP-dev)

Copy link

Author

### **[GAP-dev](/GAP-dev)** commented [Sep 30, 2023](#issuecomment-1741794287)

| or /^\s*function\s*(.)*?\s*((.))?\s\*{/ 😅 |
| --- |

All reactions

Sorry, something went wrong.

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=80&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)

Copy link

Owner

### **[medikoo](/medikoo)** commented [Oct 2, 2023](#issuecomment-1742569211)

| [@GAP-dev](https://github.com/GAP-dev)  ``` const re = /^\sfunction\s(.)?\s((.))?\s*{/  console.log(re.test(String(function myFuńctión() { }))) ```  Prints `false` |
| --- |

All reactions

Sorry, something went wrong.

[![@GAP-dev](https://avatars.githubusercontent.com/u/73922876?s=80&u=f80c784112e15ba0bd26457e40200764fb7d047a&v=4)](/GAP-dev)

Copy link

Author

### **[GAP-dev](/GAP-dev)** commented [Oct 3, 2023](#issuecomment-1744464511)

| sorry...  ``` const re =  /^\s*function\s*(.)*\s*\(([\0-(*-\uffff]*)\)\s*\{/ console.log(re.test(String(function myFuńctión() { }))) ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=80&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)

Copy link

Owner

### **[medikoo](/medikoo)** commented [Oct 3, 2023](#issuecomment-1744488591)

| [@GAP-dev](https://github.com/GAP-dev) this also won't work, as matching groups need to properly capture function name and its arguments, with what you've proposed we get `n` in function name matching group |
| --- |

All reactions

Sorry, something went wrong.

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=80&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)

Copy link

Owner

### **[medikoo](/medikoo)** commented [Oct 3, 2023](#issuecomment-1744497411)

| [@GAP-dev](https://github.com/GAP-dev) Ideally would be if you propose change as PR, as then tests will automatically pick issues for you |
| --- |

All reactions

Sorry, something went wrong.

[![@SCH227](https://avatars.githubusercontent.com/u/69127692?s=80&u=62cff0b75e0058d28468505a14213ce4f4b72390&v=4)](/SCH227)

Copy link

### **[SCH227](/SCH227)** commented [Nov 28, 2023](#issuecomment-1829055279)

| Hi everyone! I also found the inefficient regex issue in `copy.js` from my side. It is recommended to disclose this type of security issues privately. However, as this was already made public, I will share here a PoC I discovered which triggers the ReDoS by abusing `copy.js` usage directly:  ``` const copy = require('es5-ext/function/#/copy'); var payload = function CRASHCRASHCRASHCRASHCRASHCRASHCRASHCRASHCRASHCRASHCRASHCRASHCRASH(consoleLog = () => console.log("bu")) {consoleLog();} var copiedFunction = copy.call(payload);  ``` |
| --- |

 👍
2
 medikoo and GAP-dev reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=80&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)

Copy link

Owner

### **[medikoo](/medikoo)** commented [Nov 28, 2023](#issuecomment-1829267250) • edited Loading

| [@SCH227](https://github.com/SCH227) Thanks for putting light on that. So, apparently, there's a real-world case where this issue can be triggered.  I will work this week on fixing that. I don't think there's a reliable way to fix the regexp (if you feel otherwise, I'll be grateful for a hint). The solutions I see:   * In [function/#/copy](https://github.com/medikoo/es5-ext/blob/main/function/%23/copy.js) - we can simplify regex just to retrieve the function name. Other logic can be easily refactored to not rely on parsed-out arguments input * In [function/#/to-string-tokens](https://github.com/medikoo/es5-ext/blob/main/function/%23/to-string-tokens.js) - there's no simple solution. I think I should switch from regex to a state machine based parser as [esniff](https://github.com/medikoo/esniff) |
| --- |

 👍
2
 SCH227 and GAP-dev reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=40&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)
[medikoo](/medikoo)
added
[bug](/medikoo/es5-ext/labels/bug)
and removed
[question](/medikoo/es5-ext/labels/question)
Further information is requested
labels
[Nov 28, 2023](#event-11079890537)

[![@SCH227](https://avatars.githubusercontent.com/u/69127692?s=80&u=62cff0b75e0058d28468505a14213ce4f4b72390&v=4)](/SCH227)

Copy link

### **[SCH227](/SCH227)** commented [Nov 28, 2023](#issuecomment-1829987854)

| [@medikoo](https://github.com/medikoo), thank you for the prompt response, and for this awesome project!  Your proposed solutions make sense to me. I believe they will narrow the attack surface, complex regexes are hard to debug so prone to errors. But if you want to keep them, I have these ideas:   * The root cause of the exponential complexity in `copy.js` regex seems to be the nested quantifier. Does a regex like `^\s*function\s*([\0-')-\uffff]*)\s*\(([\0-(*-\uffff]*)\)\s*\{` fails in any corner case you know? * The previous proposed fix (and also the regex in `to-string-tokens.js`) is still vulnerable to a lesser complexity backtracking. If it is not mandatory to allow arbitrary whitespaces, a mitigation to this issue is to limit them: `^\s{0,10}function\s{0,10}([\0-')-\uffff]*)\s{0,10}\(([\0-(*-\uffff]*)\)\s{0,10}\{` . That, together with limiting the maximum length of the function declaration to parse to a reasonable value, may make exploitation unfeasible. * Another possibility would be to implement another function `stripWhitespaces()`, in charge of filtering out unnecessary sequences of whitespaces before `String().match(re)` |
| --- |

 ❤️
2
 medikoo and GAP-dev reacted with heart emoji

All reactions

* ❤️
  2 reactions

Sorry, something went wrong.

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=80&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)

Copy link

Owner

### **[medikoo](/medikoo)** commented [Nov 28, 2023](#issuecomment-1830645030)

| The root cause of the exponential complexity in copy.js regex seems to be the nested quantifier.  Indeed, great find 👍 I didn't notice that quirk there. I believe (and as I tested) changing `(x+)*` into `(x*)` won't make any functional difference, and is cleaner.  If it is not mandatory to allow arbitrary whitespaces, a mitigation to this issue is to limit them  This is more controversial, as functions can be defined with absurd whitespace gaps, and its stringified form will reflect that. Still, as I test, we don't have to restrict too much, e.g., we can do `\s{0,100}`, and then putting the process on a stall should no longer be possible. WDYT?  I believe I can go with that, and in the unlikely event of a real-world case where it appears to be breaking, I'll probably revert to a state-machine-based idea. |
| --- |

 👍
1
 SCH227 reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@SCH227](https://avatars.githubusercontent.com/u/69127692?s=80&u=62cff0b75e0058d28468505a14213ce4f4b72390&v=4)](/SCH227)

Copy link

### **[SCH227](/SCH227)** commented [Nov 29, 2023](#issuecomment-1831150261)

| Mostly I agree. On my tests, the regex `/^\s{0,100}function\s{0,100}([\0-')-\uffff]*)\s{0,100}\(([\0-(*-\uffff]*)\)\s{0,100}\{/` executes in around 1 second for a backtracking payload of length 20,000 (vs. ∼0.2 ms for a no backtracking one). If you believe that limiting functions length to something in the order of 10,000 will not break real-world use-cases, I would go for adding that too so to avoid the chance of abusing the regex with loong payloads. |
| --- |

All reactions

Sorry, something went wrong.

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=80&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)

Copy link

Owner

### **[medikoo](/medikoo)** commented [Nov 29, 2023](#issuecomment-1831490680) • edited Loading

| executes in around 1 second for a backtracking payload of length 20,000  By "backtracking payload," do you mean backtracking function body? If so, we can skip that in regex (so keep regex as you pasted in the last comment)  On my side, this regex executes in 11ms for function with a string length of 30,000, and it doesn't seem to get greater for more extensive functions (I got same result for 200,000 length) |
| --- |

All reactions

Sorry, something went wrong.

[![@SCH227](https://avatars.githubusercontent.com/u/69127692?s=80&u=62cff0b75e0058d28468505a14213ce4f4b72390&v=4)](/SCH227)

Copy link

### **[SCH227](/SCH227)** commented [Nov 29, 2023](#issuecomment-1832271480)

| Sorry if I was not clear enough, let me explain. After fixing the nested quantifier, the regex is still vulnerable to a lesser complexity catastrophic backtracking but with a different payload. I compared the times of execution for a payload causing backtracking and for another one that does not, seeing how they grow with the payload length:  ``` const regex = /^\s{0,100}function\s{0,100}([\0-')-\uffff]*)\s{0,100}\(([\0-(*-\uffff]*)\)\s{0,100}\{/;  // String known to NOT cause catastrophic backtracking const str1 = 'a'.repeat(5000);  // String known to cause catastrophic backtracking const str2 = 'function' +' '.repeat(5000) + '(consoleLog = () => console.log("bu")) {consoleLog();}';  console.time('Execution Time - No Backtracking'); const result1 = regex.test(str1); console.timeEnd('Execution Time - No Backtracking');  console.time('Execution Time - Backtracking'); const result2 = regex.test(str2); console.timeEnd('Execution Time - Backtracking');  ```  Output:  ``` Execution Time - No Backtracking: 0.187ms Execution Time - Backtracking: 253.638ms  ```  For a payload length of 20,000:  ``` Execution Time - No Backtracking: 0.192ms Execution Time - Backtracking: 1.036s  ```  For a payload length of 200,000:  ``` Execution Time - No Backtracking: 0.358ms Execution Time - Backtracking: 10.456s  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=80&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)

Copy link

Owner

### **[medikoo](/medikoo)** commented [Nov 29, 2023](#issuecomment-1832594744)

| [@SCH227](https://github.com/SCH227), thanks for the explanations.  I don't think it makes sense to take into account the `str1` case, as it doesn't reflect a valid function string.  Concerning other cases, after thinking it through, I think the best would be to switch to a state-machine approach, as even if we improve regex with proposed suggestions, it'll remain invalid for some ES2015+ function cases (which were not around when this utility was originally written).  e.g. it'll fail for: `function (foo = function () {}) {}`, and this cannot be handled with regex (at least not with one we have in JS engine).  Therefore, I think the ultimate solution would be to refactor this to [esniff](https://github.com/medikoo/esniff) based version, I'll take care of it in next days |
| --- |

All reactions

Sorry, something went wrong.

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=40&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)
[medikoo](/medikoo)
assigned [medikoo](/medikoo) and unassigned [GAP-dev](/GAP-dev)
[Nov 29, 2023](#event-11100761521)

[![@SCH227](https://avatars.githubusercontent.com/u/69127692?s=80&u=62cff0b75e0058d28468505a14213ce4f4b72390&v=4)](/SCH227)

Copy link

### **[SCH227](/SCH227)** commented [Nov 29, 2023](#issuecomment-1832736807)

| Yes, `str1` case was only meant for timing purposes.  I agree, that would be the best quality solution.  Actually, my PoCs rely on the fact that the regex doesn't match some valid function cases. You can see that if there's a match, backtracking does not occurs:   * No match and backtracking: <https://regex101.com/r/75qvPb/1> * Match and no backtracking: <https://regex101.com/r/692I41/1> |
| --- |

 👍
1
 medikoo reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[medikoo](/medikoo)
added a commit
that referenced
this issue
[Feb 23, 2024](#ref-commit-3551cdd)
[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=40&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)

`[fix: Do not rely on problematic regex](/medikoo/es5-ext/commit/3551cdd7b2db08b1632841f819d008757d28e8e2 "fix: Do not rely on problematic regex

Addresses #201")`
…

`[3551cdd](/medikoo/es5-ext/commit/3551cdd7b2db08b1632841f819d008757d28e8e2)`

```
Addresses [#201](https://github.com/medikoo/es5-ext/issues/201)
```

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=80&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)

Copy link

Owner

### **[medikoo](/medikoo)** commented [Feb 23, 2024](#issuecomment-1961640096)

| [@GAP-dev](https://github.com/GAP-dev) and [@SCH227](https://github.com/SCH227) big thanks in helping coining that issue  Fixed with:   * [3551cdd](https://github.com/medikoo/es5-ext/commit/3551cdd7b2db08b1632841f819d008757d28e8e2) * [a52e957](https://github.com/medikoo/es5-ext/commit/a52e95736690ad1d465ebcd9791d54570e294602)   Published with v0.10.63 |
| --- |

 👍
1
 GAP-dev reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=40&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)
[medikoo](/medikoo)
closed this as [completed](/medikoo/es5-ext/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Feb 23, 2024](#event-11905840854)

[![@SCH227](https://avatars.githubusercontent.com/u/69127692?s=80&u=62cff0b75e0058d28468505a14213ce4f4b72390&v=4)](/SCH227)

Copy link

### **[SCH227](/SCH227)** commented [Feb 25, 2024](#issuecomment-1962809992)

| [@medikoo](https://github.com/medikoo) thank you for the fix! Do you believe this issue applies for [creating a repository security advisory](https://docs.github.com/en/code-security/security-advisories/working-with-repository-security-advisories/creating-a-repository-security-advisory)? If so, please include [@GAP-dev](https://github.com/GAP-dev) and me as reporters/analysts |
| --- |

 👍
1
 GAP-dev reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=80&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)

Copy link

Owner

### **[medikoo](/medikoo)** commented [Feb 26, 2024](#issuecomment-1963624525)

| [@SCH227](https://github.com/SCH227) very good point. I've created it: [GHSA-4gmj-3p3h-gm8h](https://github.com/medikoo/es5-ext/security/advisories/GHSA-4gmj-3p3h-gm8h "GHSA-4gmj-3p3h-gm8h") |
| --- |

 ❤️
2
 GAP-dev and SCH227 reacted with heart emoji

All reactions

* ❤️
  2 reactions

Sorry, something went wrong.

[renovate](/apps/renovate) bot
referenced
this issue
in Unleash/unleash
[Feb 27, 2024](#ref-commit-43b4343)
[![@renovate](https://avatars.githubusercontent.com/in/2740?s=40&v=4)](/marketplace/renovate)

`[chore(deps): update dependency es5-ext to v0.10.63 [security] (](/Unleash/unleash/commit/43b43432638f2c6f6ea2e1118e9ac1b223aaec04 "chore(deps): update dependency es5-ext to v0.10.63 [security] (#6349)

[![Mend
Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [es5-ext](https://togithub.com/medikoo/es5-ext) | [`0.10.62` ->
`0.10.63`](https://renovatebot.com/diffs/npm/es5-ext/0.10.62/0.10.63) |
[![age](https://developer.mend.io/api/mc/badges/age/npm/es5-ext/0.10.63?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/es5-ext/0.10.63?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/es5-ext/0.10.62/0.10.63?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/es5-ext/0.10.62/0.10.63?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|

### GitHub Vulnerability Alerts

####
[CVE-2024-27088](https://togithub.com/medikoo/es5-ext/security/advisories/GHSA-4gmj-3p3h-gm8h)

### Impact

Passing functions with very long names or complex default argument names
into `function#copy` or`function#toStringTokens` may put script to stall

### Patches
Fixed with
https://github.com/medikoo/es5-ext/commit/3551cdd7b2db08b1632841f819d008757d28e8e2
and
https://github.com/medikoo/es5-ext/commit/a52e95736690ad1d465ebcd9791d54570e294602
Published with v0.10.63

### Workarounds
No real workaround aside of refraining from using above utilities.

### References

[https://github.com/medikoo/es5-ext/issues/201](https://togithub.com/medikoo/es5-ext/issues/201)

---

### Release Notes

<details>
<summary>medikoo/es5-ext (es5-ext)</summary>

###
[`v0.10.63`](https://togithub.com/medikoo/es5-ext/blob/HEAD/CHANGELOG.md#01063-2024-02-23)

[Compare
Source](https://togithub.com/medikoo/es5-ext/compare/v0.10.62...v0.10.63)

</details>

---

### Configuration

📅 **Schedule**: Branch creation - \"\" in timezone Europe/Madrid,
Automerge - At any time (no schedule defined).

🚦 **Automerge**: Enabled.

♻ **Rebasing**: Whenever PR becomes conflicted, or you tick the
rebase/retry checkbox.

🔕 **Ignore**: Close this PR and you won't be reminded about this update
again.

---

- [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check
this box

---

This PR has been generated by [Mend
Renovate](https://www.mend.io/free-developer-tools/renovate/). View
repository job log
[here](https://developer.mend.io/github/Unleash/unleash).

<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yMTIuMCIsInVwZGF0ZWRJblZlciI6IjM3LjIxMi4wIiwidGFyZ2V0QnJhbmNoIjoibWFpbiJ9-->

Co-authored-by: renovate[bot] <29139614+renovate[bot]@users.noreply.github.com>")[#6349](https://github.com/Unleash/unleash/pull/6349)[)](/Unleash/unleash/commit/43b43432638f2c6f6ea2e1118e9ac1b223aaec04 "chore(deps): update dependency es5-ext to v0.10.63 [security] (#6349)

[![Mend
Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [es5-ext](https://togithub.com/medikoo/es5-ext) | [`0.10.62` ->
`0.10.63`](https://renovatebot.com/diffs/npm/es5-ext/0.10.62/0.10.63) |
[![age](https://developer.mend.io/api/mc/badges/age/npm/es5-ext/0.10.63?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/es5-ext/0.10.63?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/es5-ext/0.10.62/0.10.63?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/es5-ext/0.10.62/0.10.63?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|

### GitHub Vulnerability Alerts

####
[CVE-2024-27088](https://togithub.com/medikoo/es5-ext/security/advisories/GHSA-4gmj-3p3h-gm8h)

### Impact

Passing functions with very long names or complex default argument names
into `function#copy` or`function#toStringTokens` may put script to stall

### Patches
Fixed with
https://github.com/medikoo/es5-ext/commit/3551cdd7b2db08b1632841f819d008757d28e8e2
and
https://github.com/medikoo/es5-ext/commit/a52e95736690ad1d465ebcd9791d54570e294602
Published with v0.10.63

### Workarounds
No real workaround aside of refraining from using above utilities.

### References

[https://github.com/medikoo/es5-ext/issues/201](https://togithub.com/medikoo/es5-ext/issues/201)

---

### Release Notes

<details>
<summary>medikoo/es5-ext (es5-ext)</summary>

###
[`v0.10.63`](https://togithub.com/medikoo/es5-ext/blob/HEAD/CHANGELOG.md#01063-2024-02-23)

[Compare
Source](https://togithub.com/medikoo/es5-ext/compare/v0.10.62...v0.10.63)

</details>

---

### Configuration

📅 **Schedule**: Branch creation - \"\" in timezone Europe/Madrid,
Automerge - At any time (no schedule defined).

🚦 **Automerge**: Enabled.

♻ **Rebasing**: Whenever PR becomes conflicted, or you tick the
rebase/retry checkbox.

🔕 **Ignore**: Close this PR and you won't be reminded about this update
again.

---

- [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check
this box

---

This PR has been generated by [Mend
Renovate](https://www.mend.io/free-developer-tools/renovate/). View
repository job log
[here](https://developer.mend.io/github/Unleash/unleash).

<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yMTIuMCIsInVwZGF0ZWRJblZlciI6IjM3LjIxMi4wIiwidGFyZ2V0QnJhbmNoIjoibWFpbiJ9-->

Co-authored-by: renovate[bot] <29139614+renovate[bot]@users.noreply.github.com>")`
…

`[43b4343](/Unleash/unleash/commit/43b43432638f2c6f6ea2e1118e9ac1b223aaec04)`

```
[![Mend
Renovate]([https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com](https://app.renovatebot.com/images/banner.svg%29%5D%28https%3A//renovatebot.com))

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [es5-ext](<https://togithub.com/medikoo/es5-ext>) | [`0.10.62` ->
`0.10.63`](<https://renovatebot.com/diffs/npm/es5-ext/0.10.62/0.10.63>) |
[![age](<https://developer.mend.io/api/mc/badges/age/npm/es5-ext/0.10.63?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|
[![adoption](<https://developer.mend.io/api/mc/badges/adoption/npm/es5-ext/0.10.63?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|
[![passing](<https://developer.mend.io/api/mc/badges/compatibility/npm/es5-ext/0.10.62/0.10.63?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|
[![confidence](<https://developer.mend.io/api/mc/badges/confidence/npm/es5-ext/0.10.62/0.10.63?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|

### GitHub Vulnerability Alerts

####
[[CVE-2024-27088](https://github.com/advisories/GHSA-4gmj-3p3h-gm8h "CVE-2024-27088")](<https://togithub.com/medikoo/es5-ext/security/advisories/GHSA-4gmj-3p3h-gm8h>)

### Impact

Passing functions with very long names or complex default argument names
into `function#copy` or`function#toStringTokens` may put script to stall

### Patches
Fixed with
[medikoo/es5-ext@3551cdd](https://github.com/medikoo/es5-ext/commit/3551cdd7b2db08b1632841f819d008757d28e8e2)
and
[medikoo/es5-ext@a52e957](https://github.com/medikoo/es5-ext/commit/a52e95736690ad1d465ebcd9791d54570e294602)
Published with v0.10.63

### Workarounds
No real workaround aside of refraining from using above utilities.

### References

[[https://github.com/medikoo/es5-ext/issues/201](https://togithub.com/medikoo/es5-ext/issues/201)](https://github.com/medikoo/es5-ext/issues/201%5D%28https%3A//togithub.com/medikoo/es5-ext/issues/201%29)

---

### Release Notes

<details>
<summary>medikoo/es5-ext (es5-ext)</summary>

###
[`v0.10.63`](<https://togithub.com/medikoo/es5-ext/blob/HEAD/CHANGELOG.md#01063-2024-02-23>)

[Compare
Source](<https://togithub.com/medikoo/es5-ext/compare/v0.10.62...v0.10.63>)

</details>

---

### Configuration

📅 **Schedule**: Branch creation - "" in timezone Europe/Madrid,
Automerge - At any time (no schedule defined).

🚦 **Automerge**: Enabled.

♻ **Rebasing**: Whenever PR becomes conflicted, or you tick the
rebase/retry checkbox.

🔕 **Ignore**: Close this PR and you won't be reminded about this update
again.

---

- [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check
this box

---

This PR has been generated by [Mend
Renovate](<https://www.mend.io/free-developer-tools/renovate/>). View
repository job log
[here](<https://developer.mend.io/github/Unleash/unleash>).

<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yMTIuMCIsInVwZGF0ZWRJblZlciI6IjM3LjIxMi4wIiwidGFyZ2V0QnJhbmNoIjoibWFpbiJ9-->

Co-authored-by: renovate[bot] <29139614+renovate[bot]@users.noreply.github.com>
```

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this issue
[Feb 28, 2024](#ref-issue-2159786159)

[Snyk vulnerability [SNYK-JS-ES5EXT-6095076]
backstage/backstage#23322](/backstage/backstage/issues/23322)

Closed

[![@Omrisnyk](https://avatars.githubusercontent.com/u/45172620?s=40&v=4)](/Omrisnyk)
[Omrisnyk](/Omrisnyk)
mentioned this issue
[Mar 1, 2024](#ref-pullrequest-2163137146)

[[Snyk] Security upgrade es5-ext from 0.10.42 to 0.10.63
Omrisnyk/npm-lockfiles#146](/Omrisnyk/npm-lockfiles/pull/146)
 Open

[![@adamstruck](https://avatars.githubusercontent.com/u/5560701?s=40&v=4)](/adamstruck)
[adamstruck](/adamstruck)
mentioned this issue
[Mar 8, 2024](#ref-pullrequest-2176559694)

[chore(deps): bump es5-ext in /packages/cubejs-query-orchestrator to address security advisory
cube-js/cube#7884](/cube-js/cube/pull/7884)
 Open

[![@connor4312](https://avatars.githubusercontent.com/u/2230985?s=40&v=4)](/connor4312)
[connor4312](/connor4312)
mentioned this issue
[Mar 11, 2024](#ref-issue-2180363087)

[TS SDK depends on a vulnerable version of es5-ext
microsoft/dev-tunnels#420](/microsoft/dev-tunnels/issues/420)

Open

This was referenced Apr 3, 2024

[azure-iot-provisioning-device-amqp
Azure/azure-iot-sdk-node#1218](/Azure/azure-iot-sdk-node/issues/1218)

Open

[azure-iot-provisioning-device-mqtt
Azure/azure-iot-sdk-node#1219](/Azure/azure-iot-sdk-node/issues/1219)

Open

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=40&u=6202deb7a394c25a15b19d420e5ea28914384ec4&v=4)](/medikoo)
[medikoo](/medikoo)
mentioned this issue
[May 15, 2024](#ref-pullrequest-2298227189)

[[GHSA-4gmj-3p3h-gm8h] es5-ext vulnerable to Regular Expression Denial of Service in `function#copy` and `function#toStringTokens`
github/advisory-database#4433](/github/advisory-database/pull/4433)
 Closed

[![@Fedex13](https://avatars.githubusercontent.com/u/119826697?s=40&v=4)](/Fedex13)
[Fedex13](/Fedex13)
mentioned this issue
[Jul 5, 2024](#ref-pullrequest-2391660729)

[[Snyk] Upgrade es5-ext from 0.10.62 to 0.10.64
Fedex13/vite#5](/Fedex13/vite/pull/5)
 Open

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this issue
[Aug 15, 2024](#ref-issue-2468643380)

[High severity - Regular Expression Denial of Service (ReDoS) vulnerability in es5-ext (package.json)
jordaniac89/juice-shop#205](/jordaniac89/juice-shop/issues/205)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmedikoo%2Fes5-ext%2Fissues%2F201)

Assignees

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=40&v=4)](/medikoo) [medikoo](/medikoo)

Labels

[bug](/medikoo/es5-ext/labels/bug)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

3 participants

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=52&v=4)](/medikoo) [![@SCH227](https://avatars.githubusercontent.com/u/69127692?s=52&v=4)](/SCH227) [![@GAP-dev](https://avatars.githubusercontent.com/u/73922876?s=52&v=4)](/GAP-dev)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_8b8d170b_20250110_205839.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmedikoo%2Fes5-ext%2Fcommit%2Fa52e95736690ad1d465ebcd9791d54570e294602)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmedikoo%2Fes5-ext%2Fcommit%2Fa52e95736690ad1d465ebcd9791d54570e294602)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=medikoo%2Fes5-ext)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[medikoo](/medikoo)
/
**[es5-ext](/medikoo/es5-ext)**
Public

* [Notifications](/login?return_to=%2Fmedikoo%2Fes5-ext) You must be signed in to change notification settings
* [Fork
  91](/login?return_to=%2Fmedikoo%2Fes5-ext)
* [Star
   176](/login?return_to=%2Fmedikoo%2Fes5-ext)

* [Code](/medikoo/es5-ext)
* [Issues
  43](/medikoo/es5-ext/issues)
* [Pull requests
  1](/medikoo/es5-ext/pulls)
* [Actions](/medikoo/es5-ext/actions)
* [Security](/medikoo/es5-ext/security)
* [Insights](/medikoo/es5-ext/pulse)

Additional navigation options

* [Code](/medikoo/es5-ext)
* [Issues](/medikoo/es5-ext/issues)
* [Pull requests](/medikoo/es5-ext/pulls)
* [Actions](/medikoo/es5-ext/actions)
* [Security](/medikoo/es5-ext/security)
* [Insights](/medikoo/es5-ext/pulse)

## Commit

[Permalink](/medikoo/es5-ext/commit/a52e95736690ad1d465ebcd9791d54570e294602)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: Support ES2015+ function definitions in `function#toStringTokens()`

[Browse files](/medikoo/es5-ext/tree/a52e95736690ad1d465ebcd9791d54570e294602)
Browse the repository at this point in the history

```
Additionally revert from problematic regex based implementation. Addresses [#21](https://github.com/medikoo/es5-ext/issues/21)
```

* Loading branch information

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=40&v=4)](/medikoo)

[medikoo](/medikoo/es5-ext/commits?author=medikoo "View all commits by medikoo")
committed
Feb 21, 2024

1 parent
[3551cdd](/medikoo/es5-ext/commit/3551cdd7b2db08b1632841f819d008757d28e8e2)

commit a52e957

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**54 additions**
and
**13 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* function/#

  + function/#/to-string-tokens.js
    [to-string-tokens.js](#diff-3bc94c1bae8e92037762ba18e2e55a57635645f3582260f0fd4fe0878d0ccdf9)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)
* test/function/#

  + test/function/#/to-string-tokens.js
    [to-string-tokens.js](#diff-bc0d5ffa3527c4581213a2453966967c23e6ffc07f32823cc79a9c540b70a298)

## There are no files selected for viewing

57 changes: 46 additions & 11 deletions

57
[function/#/to-string-tokens.js](#diff-3bc94c1bae8e92037762ba18e2e55a57635645f3582260f0fd4fe0878d0ccdf9 "function/#/to-string-tokens.js")

Show comments

[View file](/medikoo/es5-ext/blob/a52e95736690ad1d465ebcd9791d54570e294602/function/%23/to-string-tokens.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,17 +1,52 @@ |
|  |  | "use strict"; |
|  |  |  |
|  |  | var validFunction = require("../valid-function"); |
|  |  | var isValue = require("../../object/is-value") |
|  |  | , esniff = require("esniff") |
|  |  | , validFunction = require("../valid-function"); |
|  |  |  |
|  |  | var re1 = /^\s\*function[\0-')-\uffff]\*\(([\0-(\*-\uffff]\*)\)\s\*\{([\0-\uffff]\*)\}\s\*$/ |
|  |  | , re2 = /^\s\*\(?([\0-'\*-\uffff]\*)\)?\s\*=>\s\*(\{?[\0-\uffff]\*\}?)\s\*$/; |
|  |  | var classRe = /^\s\*class[\s{/}]/; |
|  |  |  |
|  |  | module.exports = function () { |
|  |  | var str = String(validFunction(this)), data = str.match(re1); |
|  |  | if (!data) { |
|  |  | data = str.match(re2); |
|  |  | if (!data) throw new Error("Unrecognized string format"); |
|  |  | data[1] = data[1].trim(); |
|  |  | if (data[2][0] === "{") data[2] = data[2].trim().slice(1, -1); |
|  |  | } |
|  |  | return { args: data[1], body: data[2] }; |
|  |  | var str = String(validFunction(this)); |
|  |  | if (classRe.test(str)) throw new Error("Class methods are not supported"); |
|  |  |  |
|  |  | var argsStartIndex |
|  |  | , argsEndIndex |
|  |  | , bodyStartIndex |
|  |  | , bodyEndReverseIndex = -1 |
|  |  | , shouldTrimArgs = false; |
|  |  |  |
|  |  | esniff(str, function (emitter, accessor) { |
|  |  | emitter.once("trigger:(", function () { argsStartIndex = accessor.index + 1; }); |
|  |  | emitter.once("trigger:=", function () { |
|  |  | if (isValue(argsStartIndex)) return; |
|  |  | argsStartIndex = 0; |
|  |  | argsEndIndex = accessor.index; |
|  |  | shouldTrimArgs = true; |
|  |  | if (!accessor.skipCodePart("=>")) { |
|  |  | throw new Error("Unexpected function string: " + str); |
|  |  | } |
|  |  | accessor.skipWhitespace(); |
|  |  | if (!accessor.skipCodePart("{")) bodyEndReverseIndex = Infinity; |
|  |  | bodyStartIndex = accessor.index; |
|  |  | }); |
|  |  | emitter.on("trigger:)", function () { |
|  |  | if (accessor.scopeDepth) return; |
|  |  | argsEndIndex = accessor.index; |
|  |  | accessor.skipCodePart(")"); |
|  |  | accessor.skipWhitespace(); |
|  |  | if (accessor.skipCodePart("=>")) { |
|  |  | accessor.skipWhitespace(); |
|  |  | if (!accessor.skipCodePart("{")) bodyEndReverseIndex = Infinity; |
|  |  | } else if (!accessor.skipCodePart("{")) { |
|  |  | throw new Error("Unexpected function string: " + str); |
|  |  | } |
|  |  | bodyStartIndex = accessor.index; |
|  |  | accessor.stop(); |
|  |  | }); |
|  |  | }); |
|  |  |  |
|  |  | var argsString = str.slice(argsStartIndex, argsEndIndex); |
|  |  | if (shouldTrimArgs) argsString = argsString.trim(); |
|  |  | return { args: argsString, body: str.slice(bodyStartIndex, bodyEndReverseIndex) }; |
|  |  | }; |

1 change: 1 addition & 0 deletions

1
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/medikoo/es5-ext/blob/a52e95736690ad1d465ebcd9791d54570e294602/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,6 +25,7 @@ |
|  |  | "dependencies": { |
|  |  | "es6-iterator": "^2.0.3", |
|  |  | "es6-symbol": "^3.1.3", |
|  |  | "esniff": "^2.0.1", |
|  |  | "next-tick": "^1.1.0" |
|  |  | }, |
|  |  | "devDependencies": { |
| Expand Down | |  |

9 changes: 7 additions & 2 deletions

9
[test/function/#/to-string-tokens.js](#diff-bc0d5ffa3527c4581213a2453966967c23e6ffc07f32823cc79a9c540b70a298 "test/function/#/to-string-tokens.js")

Show comments

[View file](/medikoo/es5-ext/blob/a52e95736690ad1d465ebcd9791d54570e294602/test/function/%23/to-string-tokens.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,10 +10,10 @@ module.exports = function (t, a) { |
|  |  | a.deep(t.call(function () {}), { args: "", body: "" }); |
|  |  | // eslint-disable-next-line no-unused-vars |
|  |  | a.deep(t.call(function (raz) {}), { args: "raz", body: "" }); |
|  |  | a.deep(t.call(function () { Object(); }), { args: "", body: " Object(); " }); |
|  |  | a.deep(t.call(function () { return {}; }), { args: "", body: " return {}; " }); |
|  |  |  |
|  |  | try { |
|  |  | eval("(() => {})"); |
|  |  | eval("((foo = bar) => {})"); |
|  |  | } catch (e) { |
|  |  | // Non ES2015 env |
|  |  | return; |
| Expand All | | @@ -23,4 +23,9 @@ module.exports = function (t, a) { |
|  |  | a.deep(t.call(eval("((elo) => foo)")), { args: "elo", body: "foo" }); |
|  |  | a.deep(t.call(eval("(elo => foo)")), { args: "elo", body: "foo" }); |
|  |  | a.deep(t.call(eval("((elo, bar) => foo())")), { args: "elo, bar", body: "foo()" }); |
|  |  | a.deep(t.call(eval("foo=>bar")), { args: "foo", body: "bar" }); |
|  |  | a.deep(t.call(eval("(foo = { marko: (elo) => { someFunct(); } }) => { body(); }")), { |
|  |  | args: "foo = { marko: (elo) => { someFunct(); } }", |
|  |  | body: " body(); " |
|  |  | }); |
|  |  | }; |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `a52e957`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmedikoo%2Fes5-ext%2Fcommit%2Fa52e95736690ad1d465ebcd9791d54570e294602) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_4e941c61_20250110_205838.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmedikoo%2Fes5-ext%2Fcommit%2F3551cdd7b2db08b1632841f819d008757d28e8e2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmedikoo%2Fes5-ext%2Fcommit%2F3551cdd7b2db08b1632841f819d008757d28e8e2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=medikoo%2Fes5-ext)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[medikoo](/medikoo)
/
**[es5-ext](/medikoo/es5-ext)**
Public

* [Notifications](/login?return_to=%2Fmedikoo%2Fes5-ext) You must be signed in to change notification settings
* [Fork
  91](/login?return_to=%2Fmedikoo%2Fes5-ext)
* [Star
   176](/login?return_to=%2Fmedikoo%2Fes5-ext)

* [Code](/medikoo/es5-ext)
* [Issues
  43](/medikoo/es5-ext/issues)
* [Pull requests
  1](/medikoo/es5-ext/pulls)
* [Actions](/medikoo/es5-ext/actions)
* [Security](/medikoo/es5-ext/security)
* [Insights](/medikoo/es5-ext/pulse)

Additional navigation options

* [Code](/medikoo/es5-ext)
* [Issues](/medikoo/es5-ext/issues)
* [Pull requests](/medikoo/es5-ext/pulls)
* [Actions](/medikoo/es5-ext/actions)
* [Security](/medikoo/es5-ext/security)
* [Insights](/medikoo/es5-ext/pulse)

## Commit

[Permalink](/medikoo/es5-ext/commit/3551cdd7b2db08b1632841f819d008757d28e8e2)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: Do not rely on problematic regex

[Browse files](/medikoo/es5-ext/tree/3551cdd7b2db08b1632841f819d008757d28e8e2)
Browse the repository at this point in the history

```
Addresses [#201](https://github.com/medikoo/es5-ext/issues/201)
```

* Loading branch information

[![@medikoo](https://avatars.githubusercontent.com/u/122434?s=40&v=4)](/medikoo)

[medikoo](/medikoo/es5-ext/commits?author=medikoo "View all commits by medikoo")
committed
Feb 19, 2024

1 parent
[7855319](/medikoo/es5-ext/commit/7855319f41b9736639cf4555bd2c419f17addf55)

commit 3551cdd

Showing
**1 changed file**
with
**7 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

13 changes: 7 additions & 6 deletions

13
[function/#/copy.js](#diff-0b5da12d62ddb7ac6ea2ae5705150fdb1142e8732b7c6b4c7c2c9f6a13a04de8 "function/#/copy.js")

Show comments

[View file](/medikoo/es5-ext/blob/3551cdd7b2db08b1632841f819d008757d28e8e2/function/%23/copy.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,19 +1,20 @@ |
|  |  | "use strict"; |
|  |  |  |
|  |  | var mixin = require("../../object/mixin") |
|  |  | , validFunction = require("../valid-function") |
|  |  | , re = /^\s\*function\s\*([\0-')-\uffff]+)\*\s\*\(([\0-(\*-\uffff]\*)\)\s\*\{/; |
|  |  | , validFunction = require("../valid-function"); |
|  |  |  |
|  |  | module.exports = function () { |
|  |  | var match = String(validFunction(this)).match(re), fn; |
|  |  | validFunction(this); |
|  |  |  |
|  |  | var args = []; |
|  |  | for (var i = 0; i < this.length; ++i) args.push("arg" + (i + 1)); |
|  |  | // eslint-disable-next-line no-new-func |
|  |  | fn = new Function( |
|  |  | var fn = new Function( |
|  |  | "fn", |
|  |  | "return function " + |
|  |  | match[1].trim() + |
|  |  | (this.name || "") + |
|  |  | "(" + |
|  |  | match[2] + |
|  |  | args.join(", ") + |
|  |  | ") { return fn.apply(this, arguments); };" |
|  |  | )(this); |
|  |  | try { mixin(fn, this); } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `3551cdd`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmedikoo%2Fes5-ext%2Fcommit%2F3551cdd7b2db08b1632841f819d008757d28e8e2) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5578835e_20250110_205841.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmedikoo%2Fes5-ext%2Fsecurity%2Fadvisories%2FGHSA-4gmj-3p3h-gm8h)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmedikoo%2Fes5-ext%2Fsecurity%2Fadvisories%2FGHSA-4gmj-3p3h-gm8h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=medikoo%2Fes5-ext)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[medikoo](/medikoo)
/
**[es5-ext](/medikoo/es5-ext)**
Public

* [Notifications](/login?return_to=%2Fmedikoo%2Fes5-ext) You must be signed in to change notification settings
* [Fork
  91](/login?return_to=%2Fmedikoo%2Fes5-ext)
* [Star
   176](/login?return_to=%2Fmedikoo%2Fes5-ext)

* [Code](/medikoo/es5-ext)
* [Issues
  43](/medikoo/es5-ext/issues)
* [Pull requests
  1](/medikoo/es5-ext/pulls)
* [Actions](/medikoo/es5-ext/actions)
* [Security](/medikoo/es5-ext/security)
* [Insights](/medikoo/es5-ext/pulse)

Additional navigation options

* [Code](/medikoo/es5-ext)
* [Issues](/medikoo/es5-ext/issues)
* [Pull requests](/medikoo/es5-ext/pulls)
* [Actions](/medikoo/es5-ext/actions)
* [Security](/medikoo/es5-ext/security)
* [Insights](/medikoo/es5-ext/pulse)

# Regular Expression Denial of Service in `function#copy` and `function#toStringTokens`

Low

[medikoo](/medikoo)
published
GHSA-4gmj-3p3h-gm8h
Feb 26, 2024

## Package

npm

es5-ext
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

>= 0.10.0, < 0.10.63

## Patched versions

0.10.63

## Description

### Impact

Passing functions with very long names or complex default argument names into `function#copy` or`function#toStringTokens` may put script to stall

### Patches

Fixed with [3551cdd](https://github.com/medikoo/es5-ext/commit/3551cdd7b2db08b1632841f819d008757d28e8e2) and [a52e957](https://github.com/medikoo/es5-ext/commit/a52e95736690ad1d465ebcd9791d54570e294602)

Published with v0.10.63

### Workarounds

No real workaround aside of refraining from using above utilities.

### References

[#201](https://github.com/medikoo/es5-ext/issues/201)

### Severity

Low

0.0

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
High

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:N

### CVE ID

CVE-2024-27088

### Weaknesses

No CWEs

### Credits

* [![@GAP-dev](https://avatars.githubusercontent.com/u/73922876?s=40&v=4)](/GAP-dev)
  [GAP-dev](/GAP-dev)
  Reporter
* [![@SCH227](https://avatars.githubusercontent.com/u/69127692?s=40&v=4)](/SCH227)
  [SCH227](/SCH227)
  Coordinator

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


