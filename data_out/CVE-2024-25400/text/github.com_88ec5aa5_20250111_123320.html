
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fintelliants%2Fsubrion%2Fissues%2F910)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fintelliants%2Fsubrion%2Fissues%2F910)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=intelliants%2Fsubrion)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[intelliants](/intelliants)
/
**[subrion](/intelliants/subrion)**
Public

* [Notifications](/login?return_to=%2Fintelliants%2Fsubrion) You must be signed in to change notification settings
* [Fork
  119](/login?return_to=%2Fintelliants%2Fsubrion)
* [Star
   284](/login?return_to=%2Fintelliants%2Fsubrion)

* [Code](/intelliants/subrion)
* [Issues
  178](/intelliants/subrion/issues)
* [Pull requests
  0](/intelliants/subrion/pulls)
* [Actions](/intelliants/subrion/actions)
* [Wiki](/intelliants/subrion/wiki)
* [Security](/intelliants/subrion/security)
* [Insights](/intelliants/subrion/pulse)

Additional navigation options

* [Code](/intelliants/subrion)
* [Issues](/intelliants/subrion/issues)
* [Pull requests](/intelliants/subrion/pulls)
* [Actions](/intelliants/subrion/actions)
* [Wiki](/intelliants/subrion/wiki)
* [Security](/intelliants/subrion/security)
* [Insights](/intelliants/subrion/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fintelliants%2Fsubrion%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fintelliants%2Fsubrion%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Subrion SQL Injection ia.core.mysqli.php #910

Open

[diyarsaadi](/diyarsaadi) opened this issue
Feb 27, 2024
· 1 comment

Open

# [Subrion SQL Injection ia.core.mysqli.php](#top) #910

[diyarsaadi](/diyarsaadi) opened this issue
Feb 27, 2024
· 1 comment

## Comments

[![@diyarsaadi](https://avatars.githubusercontent.com/u/161453186?s=80&v=4)](/diyarsaadi)

Copy link

### **[diyarsaadi](/diyarsaadi)** commented [Feb 27, 2024](#issue-2156228179)

| \*\*Subrion 4.2.1 is vulnerable SQL Injection \*\* Vulnerable Line : SQL Injection has been found. Change this code to no longer construct SQL queries directly from user-controlled data.  Calling method \iaDb,1::getAll(["var"]) in (216)\iaDb,1::\_get(["row","MAX(`order`)","var","var","1"]) that outputs using tainted argument [#1](https://github.com/intelliants/subrion/pull/1) (`$sql`).  Infected Line : 242  238 $sql = 'SELECT ' . $stmtFields . ' FROM `' . $this->_table . '` ' . $condition; 239  240 switch ($type) { 241 case 'all': 242 1return $this->getAll($sql); 243 case 'keyval': 244 return $this->getKeyValue($sql); 245 case 'assoc': 246 return $this->getAssoc($sql, true); 247 default:  #Description #  This code is vulnerable to SQL injection because the application receives data from the user or a third-party service and inserts it into a database query without sanitizing it first. It's a critical vulnerability.  What is the potential impact? The attacker can manipulate user input fields (such as a search bar or login form) to inject malicious SQL code into the backend database. This can allow them to gain unauthorized access to sensitive information, modify or delete data, and even take control of the entire system.  SQL Injection attacks are unfortunately very common, and this is due to two factors: 1-the significant prevalence of SQL injection vulnerabilities, and 2-the attractiveness of the target (i.e., the database typically contains all the interesting/critical data for your application). It's crucial that you address the vulnerability as soon as possible to prevent any data breaches or unauthorized access. Steps to Fix The correct way to avoid SQL injection attacks is to separate the data from SQL, so that data remains just that and can never be interpreted as commands by the SQL parser:  If the code needs a number, change it to a number explicitly If it's a string, use bind parameters If it's an enum, double-check that the value is strictly from the enum string object Use prepared statements and parameterized queries. These are SQL statements that are sent to and parsed by the database server separately from any parameters. This way it is impossible for an attacker to inject malicious SQL.  Using [PDO](http://php.net/manual/en/book.pdo.php) (for any supported database driver): $stmt = $pdo->prepare('SELECT \* FROM employees WHERE name = :name'); $stmt->execute([ 'name' => $name ]);  foreach ($stmt as $row) { // Do something with $row } Using [MySQLi](http://php.net/manual/en/book.mysqli.php) (for MySQL): Since PHP 8.2+ we can make use of [mysqli\_execute\_query()](https://www.php.net/manual/en/mysqli.execute-query.php) (or mysqli::execute\_query()) which prepares, binds parameters, and executes SQL statement in one method:  $result = $dbConnection->execute\_query('SELECT \* FROM employees WHERE name = ?', [$name]);  while ($row = $result->fetch\_assoc()) { // Do something with $row } Up to PHP 8.1  $stmt = $dbConnection->prepare('SELECT \* FROM employees WHERE name = ?'); $stmt->bind\_param('s', $name); // 's' specifies the variable type => 'string' $stmt->execute();  $result = $stmt->get\_result(); while ($row = $result->fetch\_assoc()) { // Do something with $row } If you're connecting to a database other than MySQL, there is a driver-specific second option that you can refer to (for example, pg\_prepare() and pg\_execute() for PostgreSQL). PDO is the universal option. Steps to Reproduce curl -X POST -d "id=1%E2%80%98%20or%201%3D1--" <https://site.com/includes/classes/ia.base.controller.admin.php> |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@blockisec](https://avatars.githubusercontent.com/u/62061776?s=80&v=4)](/blockisec)

Copy link

### **[blockisec](/blockisec)** commented [Jun 17, 2024](#issuecomment-2174012538)

| same as [#911](https://github.com/intelliants/subrion/issues/911). You cannot trigger any SQL injection by requesting a PHP file just containing a class using this curl request. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fintelliants%2Fsubrion%2Fissues%2F910)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@blockisec](https://avatars.githubusercontent.com/u/62061776?s=52&v=4)](/blockisec) [![@diyarsaadi](https://avatars.githubusercontent.com/u/161453186?s=52&v=4)](/diyarsaadi)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

