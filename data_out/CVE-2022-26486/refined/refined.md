The provided content relates to **CVE-2022-26486**.

**Root cause of vulnerability:**
- An unexpected message in the WebGPU IPC framework could lead to a use-after-free condition.
- Specifically, the vulnerability occurs when the `ffi::wgpu_server_delete` function is called on the `mContext` pointer after it has been deallocated. This happens in the `WebGPUParent::RecvShutdown` function after the `ffi::wgpu_server_poll_all_devices` function.

**Weaknesses/vulnerabilities present:**
- Use-after-free (UAF) vulnerability due to incorrect handling of the `mContext` pointer during shutdown of the WebGPU IPC framework.
- Inadequate checks/protections when handling IPC messages related to WebGPU.

**Impact of exploitation:**
- Critical impact as it allows for an exploitable sandbox escape.
- Remote code execution (RCE) in the GPU process, which is a high-privileged process.
- An attacker can potentially gain control of the system.

**Attack vectors:**
1. The attacker needs to first compromise the render process, which can be achieved through other exploits (e.g., CVE-2022-26485).
2. Once the render process is compromised, the attacker can execute shellcode to call `mozilla::webgpu::Instance::Create` followed by `mozilla::webgpu::PWebGPUChild::SendShutdown`, which leads to the UAF.
3. By carefully crafting the heap layout using `mozilla::layers::PWebRenderBridgeChild::SendSetDisplayList`, the attacker can trigger a use-after-free when `mozilla::webgpu::PWebGPUChild::SendShaderModuleDestroy` is called.

**Required attacker capabilities/position:**
- The attacker needs to be able to execute code in the context of a compromised content (render) process.
- The attacker needs to be able to craft specific IPC messages to trigger the vulnerability in the GPU process.
- Knowledge of the internal workings of the WebGPU implementation within Firefox and the ability to manipulate the heap is also necessary to fully exploit this flaw.