

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jan Kara <jack@suse.cz> | 2024-06-17 17:41:51 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-03 08:59:39 +0200 |
| commit | [40d7b3ed52449d36143bab8d3e70926aa61a60f4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4)) | |
| tree | [4889527471998192b50b8c196424c3a10922bca7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4) | |
| parent | [73c19830cd7234ee2aa0ff7f99becc6b99813e13](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=73c19830cd7234ee2aa0ff7f99becc6b99813e13) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4&id2=73c19830cd7234ee2aa0ff7f99becc6b99813e13)) | |
| download | [linux-40d7b3ed52449d36143bab8d3e70926aa61a60f4.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-40d7b3ed52449d36143bab8d3e70926aa61a60f4.tar.gz) | |

udf: Fix bogus checksum computation in udf\_rename()[ Upstream commit 27ab33854873e6fb958cb074681a0107cc2ecc4c ]
Syzbot reports uninitialized memory access in udf\_rename() when updating
checksum of '..' directory entry of a moved directory. This is indeed
true as we pass on-stack diriter.fi to the udf\_update\_tag() and because
that has only struct fileIdentDesc included in it and not the impUse or
name fields, the checksumming function is going to checksum random stack
contents beyond the end of the structure. This is actually harmless
because the following udf\_fiiter\_write\_fi() will recompute the checksum
from on-disk buffers where everything is properly included. So all that
is needed is just removing the bogus calculation.
Fixes: e9109a92d2a9 ("udf: Convert udf\_rename() to new directory iteration code")
Link: [https://lore.kernel.org/all/000000000000cf405f060d8f75a9@google.com/T/](https://lore.kernel.org/all/000000000000cf405f060d8f75a9%40google.com/T/)
Link: [https://patch.msgid.link/20240617154201.29512-1-jack@suse.cz](https://patch.msgid.link/20240617154201.29512-1-jack%40suse.cz)
Reported-by: syzbot+d31185aa54170f7fc1f5@syzkaller.appspotmail.com
Signed-off-by: Jan Kara <jack@suse.cz>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4)

| -rw-r--r-- | [fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/udf/namei.c?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 0 insertions, 2 deletions

| diff --git a/fs/udf/namei.c b/fs/udf/namei.cindex 1308109fd42d9f..78a603129dd583 100644--- a/[fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/udf/namei.c?id=73c19830cd7234ee2aa0ff7f99becc6b99813e13)+++ b/[fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/udf/namei.c?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4)@@ -876,8 +876,6 @@ static int udf\_rename(struct mnt\_idmap \*idmap, struct inode \*old\_dir, if (has\_diriter) { diriter.fi.icb.extLocation = cpu\_to\_lelb(UDF\_I(new\_dir)->i\_location);- udf\_update\_tag((char \*)&diriter.fi,- udf\_dir\_entry\_len(&diriter.fi)); udf\_fiiter\_write\_fi(&diriter, NULL); udf\_fiiter\_release(&diriter); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 15:02:03 +0000

