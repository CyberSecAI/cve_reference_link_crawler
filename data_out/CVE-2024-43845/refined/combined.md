=== Content from git.kernel.org_ae0fe2f9_20250111_150328.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=fe2ead240c31e8d158713beca9d0681a6e6a53ab)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fe2ead240c31e8d158713beca9d0681a6e6a53ab)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fe2ead240c31e8d158713beca9d0681a6e6a53ab)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fe2ead240c31e8d158713beca9d0681a6e6a53ab)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jan Kara <jack@suse.cz> | 2024-06-17 17:41:51 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-03 08:53:39 +0200 |
| commit | [fe2ead240c31e8d158713beca9d0681a6e6a53ab](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fe2ead240c31e8d158713beca9d0681a6e6a53ab) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=fe2ead240c31e8d158713beca9d0681a6e6a53ab)) | |
| tree | [eeaab91d8841184c52f8ab8882265425ed920545](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fe2ead240c31e8d158713beca9d0681a6e6a53ab) | |
| parent | [67b5f1054197e4f5553047759c15c1d67d4c8142](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=67b5f1054197e4f5553047759c15c1d67d4c8142) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fe2ead240c31e8d158713beca9d0681a6e6a53ab&id2=67b5f1054197e4f5553047759c15c1d67d4c8142)) | |
| download | [linux-fe2ead240c31e8d158713beca9d0681a6e6a53ab.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-fe2ead240c31e8d158713beca9d0681a6e6a53ab.tar.gz) | |

udf: Fix bogus checksum computation in udf\_rename()[ Upstream commit 27ab33854873e6fb958cb074681a0107cc2ecc4c ]
Syzbot reports uninitialized memory access in udf\_rename() when updating
checksum of '..' directory entry of a moved directory. This is indeed
true as we pass on-stack diriter.fi to the udf\_update\_tag() and because
that has only struct fileIdentDesc included in it and not the impUse or
name fields, the checksumming function is going to checksum random stack
contents beyond the end of the structure. This is actually harmless
because the following udf\_fiiter\_write\_fi() will recompute the checksum
from on-disk buffers where everything is properly included. So all that
is needed is just removing the bogus calculation.
Fixes: e9109a92d2a9 ("udf: Convert udf\_rename() to new directory iteration code")
Link: [https://lore.kernel.org/all/000000000000cf405f060d8f75a9@google.com/T/](https://lore.kernel.org/all/000000000000cf405f060d8f75a9%40google.com/T/)
Link: [https://patch.msgid.link/20240617154201.29512-1-jack@suse.cz](https://patch.msgid.link/20240617154201.29512-1-jack%40suse.cz)
Reported-by: syzbot+d31185aa54170f7fc1f5@syzkaller.appspotmail.com
Signed-off-by: Jan Kara <jack@suse.cz>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fe2ead240c31e8d158713beca9d0681a6e6a53ab)

| -rw-r--r-- | [fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/udf/namei.c?id=fe2ead240c31e8d158713beca9d0681a6e6a53ab) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 0 insertions, 2 deletions

| diff --git a/fs/udf/namei.c b/fs/udf/namei.cindex ae55ab8859b6d9..605f182da42cbb 100644--- a/[fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/udf/namei.c?id=67b5f1054197e4f5553047759c15c1d67d4c8142)+++ b/[fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/udf/namei.c?id=fe2ead240c31e8d158713beca9d0681a6e6a53ab)@@ -874,8 +874,6 @@ static int udf\_rename(struct mnt\_idmap \*idmap, struct inode \*old\_dir, if (has\_diriter) { diriter.fi.icb.extLocation = cpu\_to\_lelb(UDF\_I(new\_dir)->i\_location);- udf\_update\_tag((char \*)&diriter.fi,- udf\_dir\_entry\_len(&diriter.fi)); udf\_fiiter\_write\_fi(&diriter, NULL); udf\_fiiter\_release(&diriter); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 15:02:05 +0000



=== Content from git.kernel.org_c33efa4f_20250111_150327.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=9c439311c13fc6faab1921441165c9b8b500c83b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9c439311c13fc6faab1921441165c9b8b500c83b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9c439311c13fc6faab1921441165c9b8b500c83b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9c439311c13fc6faab1921441165c9b8b500c83b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jan Kara <jack@suse.cz> | 2024-10-17 17:20:02 -0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-22 15:40:39 +0200 |
| commit | [9c439311c13fc6faab1921441165c9b8b500c83b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9c439311c13fc6faab1921441165c9b8b500c83b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=9c439311c13fc6faab1921441165c9b8b500c83b)) | |
| tree | [b0ef0872355476553af97a4811eda1b8636eda4a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9c439311c13fc6faab1921441165c9b8b500c83b) | |
| parent | [4a1d95fc9706b2b065e56d5281b380bcaa1bce9c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4a1d95fc9706b2b065e56d5281b380bcaa1bce9c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9c439311c13fc6faab1921441165c9b8b500c83b&id2=4a1d95fc9706b2b065e56d5281b380bcaa1bce9c)) | |
| download | [linux-9c439311c13fc6faab1921441165c9b8b500c83b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-9c439311c13fc6faab1921441165c9b8b500c83b.tar.gz) | |

udf: Fix bogus checksum computation in udf\_rename()[ Upstream commit 27ab33854873e6fb958cb074681a0107cc2ecc4c ]
Syzbot reports uninitialized memory access in udf\_rename() when updating
checksum of '..' directory entry of a moved directory. This is indeed
true as we pass on-stack diriter.fi to the udf\_update\_tag() and because
that has only struct fileIdentDesc included in it and not the impUse or
name fields, the checksumming function is going to checksum random stack
contents beyond the end of the structure. This is actually harmless
because the following udf\_fiiter\_write\_fi() will recompute the checksum
from on-disk buffers where everything is properly included. So all that
is needed is just removing the bogus calculation.
Fixes: e9109a92d2a9 ("udf: Convert udf\_rename() to new directory iteration code")
Link: [https://lore.kernel.org/all/000000000000cf405f060d8f75a9@google.com/T/](https://lore.kernel.org/all/000000000000cf405f060d8f75a9%40google.com/T/)
Link: [https://patch.msgid.link/20240617154201.29512-1-jack@suse.cz](https://patch.msgid.link/20240617154201.29512-1-jack%40suse.cz)
Reported-by: syzbot+d31185aa54170f7fc1f5@syzkaller.appspotmail.com
Signed-off-by: Jan Kara <jack@suse.cz>
Signed-off-by: Thadeu Lima de Souza Cascardo <cascardo@igalia.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9c439311c13fc6faab1921441165c9b8b500c83b)

| -rw-r--r-- | [fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/udf/namei.c?id=9c439311c13fc6faab1921441165c9b8b500c83b) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 0 insertions, 2 deletions

| diff --git a/fs/udf/namei.c b/fs/udf/namei.cindex 093de955ba101c..5e39cbc7452432 100644--- a/[fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/udf/namei.c?id=4a1d95fc9706b2b065e56d5281b380bcaa1bce9c)+++ b/[fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/udf/namei.c?id=9c439311c13fc6faab1921441165c9b8b500c83b)@@ -857,8 +857,6 @@ static int udf\_rename(struct user\_namespace \*mnt\_userns, struct inode \*old\_dir, if (has\_diriter) { diriter.fi.icb.extLocation = cpu\_to\_lelb(UDF\_I(new\_dir)->i\_location);- udf\_update\_tag((char \*)&diriter.fi,- udf\_dir\_entry\_len(&diriter.fi)); udf\_fiiter\_write\_fi(&diriter, NULL); udf\_fiiter\_release(&diriter); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 15:02:04 +0000



=== Content from git.kernel.org_b961d132_20250111_150325.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=27ab33854873e6fb958cb074681a0107cc2ecc4c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=27ab33854873e6fb958cb074681a0107cc2ecc4c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=27ab33854873e6fb958cb074681a0107cc2ecc4c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=27ab33854873e6fb958cb074681a0107cc2ecc4c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jan Kara <jack@suse.cz> | 2024-06-17 17:41:51 +0200 |
| --- | --- | --- |
| committer | Jan Kara <jack@suse.cz> | 2024-06-20 15:07:27 +0200 |
| commit | [27ab33854873e6fb958cb074681a0107cc2ecc4c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=27ab33854873e6fb958cb074681a0107cc2ecc4c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=27ab33854873e6fb958cb074681a0107cc2ecc4c)) | |
| tree | [aa0a1a3f204f6d44e0fe9e434203b189d339e4ab](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=27ab33854873e6fb958cb074681a0107cc2ecc4c) | |
| parent | [8832fc1e502687869606bb0a7b79848ed3bf036f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8832fc1e502687869606bb0a7b79848ed3bf036f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=27ab33854873e6fb958cb074681a0107cc2ecc4c&id2=8832fc1e502687869606bb0a7b79848ed3bf036f)) | |
| download | [linux-27ab33854873e6fb958cb074681a0107cc2ecc4c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-27ab33854873e6fb958cb074681a0107cc2ecc4c.tar.gz) | |

udf: Fix bogus checksum computation in udf\_rename()Syzbot reports uninitialized memory access in udf\_rename() when updating
checksum of '..' directory entry of a moved directory. This is indeed
true as we pass on-stack diriter.fi to the udf\_update\_tag() and because
that has only struct fileIdentDesc included in it and not the impUse or
name fields, the checksumming function is going to checksum random stack
contents beyond the end of the structure. This is actually harmless
because the following udf\_fiiter\_write\_fi() will recompute the checksum
from on-disk buffers where everything is properly included. So all that
is needed is just removing the bogus calculation.
Fixes: e9109a92d2a9 ("udf: Convert udf\_rename() to new directory iteration code")
Link: [https://lore.kernel.org/all/000000000000cf405f060d8f75a9@google.com/T/](https://lore.kernel.org/all/000000000000cf405f060d8f75a9%40google.com/T/)
Link: [https://patch.msgid.link/20240617154201.29512-1-jack@suse.cz](https://patch.msgid.link/20240617154201.29512-1-jack%40suse.cz)
Reported-by: syzbot+d31185aa54170f7fc1f5@syzkaller.appspotmail.com
Signed-off-by: Jan Kara <jack@suse.cz>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=27ab33854873e6fb958cb074681a0107cc2ecc4c)

| -rw-r--r-- | [fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/udf/namei.c?id=27ab33854873e6fb958cb074681a0107cc2ecc4c) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 0 insertions, 2 deletions

| diff --git a/fs/udf/namei.c b/fs/udf/namei.cindex 1308109fd42d9f..78a603129dd583 100644--- a/[fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/udf/namei.c?id=8832fc1e502687869606bb0a7b79848ed3bf036f)+++ b/[fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/udf/namei.c?id=27ab33854873e6fb958cb074681a0107cc2ecc4c)@@ -876,8 +876,6 @@ static int udf\_rename(struct mnt\_idmap \*idmap, struct inode \*old\_dir, if (has\_diriter) { diriter.fi.icb.extLocation = cpu\_to\_lelb(UDF\_I(new\_dir)->i\_location);- udf\_update\_tag((char \*)&diriter.fi,- udf\_dir\_entry\_len(&diriter.fi)); udf\_fiiter\_write\_fi(&diriter, NULL); udf\_fiiter\_release(&diriter); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 15:02:03 +0000



=== Content from git.kernel.org_93765388_20250111_150327.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c996b570305e7a6910c2ce4cdcd4c22757ffe241)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c996b570305e7a6910c2ce4cdcd4c22757ffe241)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c996b570305e7a6910c2ce4cdcd4c22757ffe241)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c996b570305e7a6910c2ce4cdcd4c22757ffe241)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jan Kara <jack@suse.cz> | 2024-06-17 17:41:51 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-29 17:30:22 +0200 |
| commit | [c996b570305e7a6910c2ce4cdcd4c22757ffe241](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c996b570305e7a6910c2ce4cdcd4c22757ffe241) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c996b570305e7a6910c2ce4cdcd4c22757ffe241)) | |
| tree | [d1ae0d6d1ca3c61524d4278bd10e9074a65861a6](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c996b570305e7a6910c2ce4cdcd4c22757ffe241) | |
| parent | [0752e7fb549d90c33b4d4186f11cfd25a556d1dd](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0752e7fb549d90c33b4d4186f11cfd25a556d1dd) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c996b570305e7a6910c2ce4cdcd4c22757ffe241&id2=0752e7fb549d90c33b4d4186f11cfd25a556d1dd)) | |
| download | [linux-c996b570305e7a6910c2ce4cdcd4c22757ffe241.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c996b570305e7a6910c2ce4cdcd4c22757ffe241.tar.gz) | |

udf: Fix bogus checksum computation in udf\_rename()[ Upstream commit 27ab33854873e6fb958cb074681a0107cc2ecc4c ]
Syzbot reports uninitialized memory access in udf\_rename() when updating
checksum of '..' directory entry of a moved directory. This is indeed
true as we pass on-stack diriter.fi to the udf\_update\_tag() and because
that has only struct fileIdentDesc included in it and not the impUse or
name fields, the checksumming function is going to checksum random stack
contents beyond the end of the structure. This is actually harmless
because the following udf\_fiiter\_write\_fi() will recompute the checksum
from on-disk buffers where everything is properly included. So all that
is needed is just removing the bogus calculation.
Fixes: e9109a92d2a9 ("udf: Convert udf\_rename() to new directory iteration code")
Link: [https://lore.kernel.org/all/000000000000cf405f060d8f75a9@google.com/T/](https://lore.kernel.org/all/000000000000cf405f060d8f75a9%40google.com/T/)
Link: [https://patch.msgid.link/20240617154201.29512-1-jack@suse.cz](https://patch.msgid.link/20240617154201.29512-1-jack%40suse.cz)
Reported-by: syzbot+d31185aa54170f7fc1f5@syzkaller.appspotmail.com
Signed-off-by: Jan Kara <jack@suse.cz>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c996b570305e7a6910c2ce4cdcd4c22757ffe241)

| -rw-r--r-- | [fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/udf/namei.c?id=c996b570305e7a6910c2ce4cdcd4c22757ffe241) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 0 insertions, 1 deletions

| diff --git a/fs/udf/namei.c b/fs/udf/namei.cindex 7c95c549dd64e2..ded71044988abf 100644--- a/[fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/udf/namei.c?id=0752e7fb549d90c33b4d4186f11cfd25a556d1dd)+++ b/[fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/udf/namei.c?id=c996b570305e7a6910c2ce4cdcd4c22757ffe241)@@ -1183,7 +1183,6 @@ static int udf\_rename(struct user\_namespace \*mnt\_userns, struct inode \*old\_dir,  if (dir\_fi) { dir\_fi->icb.extLocation = cpu\_to\_lelb(UDF\_I(new\_dir)->i\_location);- udf\_update\_tag((char \*)dir\_fi, udf\_dir\_entry\_len(dir\_fi)); if (old\_iinfo->i\_alloc\_type == ICBTAG\_FLAG\_AD\_IN\_ICB) mark\_inode\_dirty(old\_inode); else |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 15:02:04 +0000



=== Content from git.kernel.org_3d1607c4_20250111_150326.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jan Kara <jack@suse.cz> | 2024-06-17 17:41:51 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-03 08:59:39 +0200 |
| commit | [40d7b3ed52449d36143bab8d3e70926aa61a60f4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4)) | |
| tree | [4889527471998192b50b8c196424c3a10922bca7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4) | |
| parent | [73c19830cd7234ee2aa0ff7f99becc6b99813e13](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=73c19830cd7234ee2aa0ff7f99becc6b99813e13) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4&id2=73c19830cd7234ee2aa0ff7f99becc6b99813e13)) | |
| download | [linux-40d7b3ed52449d36143bab8d3e70926aa61a60f4.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-40d7b3ed52449d36143bab8d3e70926aa61a60f4.tar.gz) | |

udf: Fix bogus checksum computation in udf\_rename()[ Upstream commit 27ab33854873e6fb958cb074681a0107cc2ecc4c ]
Syzbot reports uninitialized memory access in udf\_rename() when updating
checksum of '..' directory entry of a moved directory. This is indeed
true as we pass on-stack diriter.fi to the udf\_update\_tag() and because
that has only struct fileIdentDesc included in it and not the impUse or
name fields, the checksumming function is going to checksum random stack
contents beyond the end of the structure. This is actually harmless
because the following udf\_fiiter\_write\_fi() will recompute the checksum
from on-disk buffers where everything is properly included. So all that
is needed is just removing the bogus calculation.
Fixes: e9109a92d2a9 ("udf: Convert udf\_rename() to new directory iteration code")
Link: [https://lore.kernel.org/all/000000000000cf405f060d8f75a9@google.com/T/](https://lore.kernel.org/all/000000000000cf405f060d8f75a9%40google.com/T/)
Link: [https://patch.msgid.link/20240617154201.29512-1-jack@suse.cz](https://patch.msgid.link/20240617154201.29512-1-jack%40suse.cz)
Reported-by: syzbot+d31185aa54170f7fc1f5@syzkaller.appspotmail.com
Signed-off-by: Jan Kara <jack@suse.cz>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4)

| -rw-r--r-- | [fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/udf/namei.c?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 0 insertions, 2 deletions

| diff --git a/fs/udf/namei.c b/fs/udf/namei.cindex 1308109fd42d9f..78a603129dd583 100644--- a/[fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/udf/namei.c?id=73c19830cd7234ee2aa0ff7f99becc6b99813e13)+++ b/[fs/udf/namei.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/udf/namei.c?id=40d7b3ed52449d36143bab8d3e70926aa61a60f4)@@ -876,8 +876,6 @@ static int udf\_rename(struct mnt\_idmap \*idmap, struct inode \*old\_dir, if (has\_diriter) { diriter.fi.icb.extLocation = cpu\_to\_lelb(UDF\_I(new\_dir)->i\_location);- udf\_update\_tag((char \*)&diriter.fi,- udf\_dir\_entry\_len(&diriter.fi)); udf\_fiiter\_write\_fi(&diriter, NULL); udf\_fiiter\_release(&diriter); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 15:02:03 +0000


