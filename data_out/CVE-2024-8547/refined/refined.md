Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-8547

**Root Cause:**
- The vulnerability stems from insufficient input sanitization and output escaping within the Simple Popup Plugin's `[popup]` shortcode. Specifically, user-supplied attributes like `url`, `class`, `height`, and `width` are not properly sanitized before being used in the output.

**Weaknesses/Vulnerabilities Present:**
- **Stored Cross-Site Scripting (XSS):** The primary vulnerability is a stored XSS, allowing an attacker to inject malicious scripts that are stored in the WordPress database and executed when a user accesses the affected page.

**Impact of Exploitation:**
- **Arbitrary Script Execution:** Successful exploitation allows attackers to execute arbitrary web scripts in the context of the victim's browser when viewing pages containing the injected shortcode.
- **Potential for Malicious Activities:** This can lead to various malicious actions, including but not limited to:
    - Redirecting users to malicious websites.
    - Stealing session cookies or other sensitive information.
    - Defacing the website.
    - Performing actions on behalf of the user.

**Attack Vectors:**
- **Shortcode Injection:** Attackers can inject malicious code through the `[popup]` shortcode by providing crafted values for its attributes.
- **WordPress Post/Page Content:** The injected shortcode is stored as part of the WordPress post or page content and is triggered when the affected page is loaded by a user.

**Required Attacker Capabilities/Position:**
- **Authenticated User:** The attacker needs to have contributor-level access or higher within the WordPress site. This means they need to be able to create or edit posts/pages where shortcodes can be inserted.
- **Knowledge of shortcode usage:** The attacker should be aware of the shortcode syntax and parameters that can be leveraged to inject malicious scripts.

**Additional Details:**
- The vulnerability affects all versions of the Simple Popup Plugin up to and including 4.5.
- The vulnerability is patched in version 4.6.
- The `esc_attr` function is used in the output but it does not protect against XSS in this case.
- The vulnerability was discovered by Krzysztof ZajÄ…c of CERT PL.