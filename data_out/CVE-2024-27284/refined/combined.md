=== Content from github.com_099a6b16_20250111_185045.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcassandra-rs%2Fcassandra-rs%2Fcommit%2Fae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcassandra-rs%2Fcassandra-rs%2Fcommit%2Fae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=cassandra-rs%2Fcassandra-rs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cassandra-rs](/cassandra-rs)
/
**[cassandra-rs](/cassandra-rs/cassandra-rs)**
Public

* [Notifications](/login?return_to=%2Fcassandra-rs%2Fcassandra-rs) You must be signed in to change notification settings
* [Fork
  55](/login?return_to=%2Fcassandra-rs%2Fcassandra-rs)
* [Star
   138](/login?return_to=%2Fcassandra-rs%2Fcassandra-rs)

* [Code](/cassandra-rs/cassandra-rs)
* [Issues
  15](/cassandra-rs/cassandra-rs/issues)
* [Pull requests
  1](/cassandra-rs/cassandra-rs/pulls)
* [Actions](/cassandra-rs/cassandra-rs/actions)
* [Security](/cassandra-rs/cassandra-rs/security)
* [Insights](/cassandra-rs/cassandra-rs/pulse)

Additional navigation options

* [Code](/cassandra-rs/cassandra-rs)
* [Issues](/cassandra-rs/cassandra-rs/issues)
* [Pull requests](/cassandra-rs/cassandra-rs/pulls)
* [Actions](/cassandra-rs/cassandra-rs/actions)
* [Security](/cassandra-rs/cassandra-rs/security)
* [Insights](/cassandra-rs/cassandra-rs/pulse)

## Commit

[Permalink](/cassandra-rs/cassandra-rs/commit/ae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-x9xc-63hg-vcfq](https://github.com/advisories/GHSA-x9xc-63hg-vcfq "GHSA-x9xc-63hg-vcfq")

[Browse files](/cassandra-rs/cassandra-rs/tree/ae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7)
Browse the repository at this point in the history

```
Make `ResultIterator` a `LendingIterator`
```

* Loading branch information

[![@kw217](https://avatars.githubusercontent.com/u/587036?s=40&v=4)](/kw217)

[kw217](/cassandra-rs/cassandra-rs/commits?author=kw217 "View all commits by kw217")
authored
Feb 28, 2024

2 parents
[9698afb](/cassandra-rs/cassandra-rs/commit/9698afb9131cab8be1ef0550ca380008962d308c)
+
[299e6ac](/cassandra-rs/cassandra-rs/commit/299e6ac50f87eb2823a373baec37b590a74994ee)

commit ae054dc

 Show file tree

 Hide file tree

Showing
**46 changed files**
with
**687 additions**
and
**609 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* Cargo.toml
  [Cargo.toml](#diff-2e9d962a08321605940b5a657135052fbcef87b5e360662bb527c96d9a615542)
* README.md
  [README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)
* examples

  + examples/collections.rs
    [collections.rs](#diff-75cb79ef82a1cede02036908fb5b6875a80dbdb5e8f0321565e7bc9f0eb2190d)
  + examples/simple.rs
    [simple.rs](#diff-9b91ae38610593e55d5bf8c7f39f99538733db009291ac6ed4ec9a6664e75fbb)
  + examples/ssl.rs
    [ssl.rs](#diff-dc13de072261240f6ff035cc9cf9187b77d3b433e21958c2f2f6be1268569d8b)
* src

  + cassandra

    - src/cassandra/batch.rs
      [batch.rs](#diff-bbdaaad6c9f517914f900e324adb12a0165ac2e4e24b116ea2d0622a55847314)
    - src/cassandra/cluster.rs
      [cluster.rs](#diff-c53050fbf610e66981b02ac69c250d126f510fafe03e9f2beffb48a7854cfa11)
    - src/cassandra/collection.rs
      [collection.rs](#diff-9f26829aa133dd47f59909f267edb22fa5e13941fd447f1a33b30552f67dc02d)
    - src/cassandra/consistency.rs
      [consistency.rs](#diff-b4e416cdd6be667daed1b9468361baca4470b75e18bb3b2bdeb0bee9fe54310a)
    - src/cassandra/custom\_payload.rs
      [custom\_payload.rs](#diff-923700f0f097346c87f4f324b54de2abc9b82ff32820da154b453f4bdd02f4c3)
    - src/cassandra/data\_type.rs
      [data\_type.rs](#diff-c11b9994e463354a1977d6de6a08001359564faf227cc3381527a43b2c403ab2)
    - src/cassandra/error.rs
      [error.rs](#diff-1ffe52cddbe29797e7c4794a11f11f5d85f3dc7d1d05f7d3a7c6027ae744b4c0)
    - src/cassandra/field.rs
      [field.rs](#diff-47e40778b5fc5b982d9cede26aa01421bf382c5bbb9e1fe2be57d3e4faec0eee)
    - src/cassandra/future.rs
      [future.rs](#diff-4e0f972b86d9cbc81b207bfdb039e0655fa28e37c7e700ee512123004f83eede)
    - src/cassandra/inet.rs
      [inet.rs](#diff-2a2da914cad34515d89418eed5eefc34660c0a7944a2c054477187478b5ab9d4)
    - src/cassandra/iterator.rs
      [iterator.rs](#diff-b53d799c9a6711cec7b4f5d6da2f8e2e25b77b7715b1108f7d5297ecf9afd1c1)
    - src/cassandra/log.rs
      [log.rs](#diff-53f069c318b36fdad4bda5895ac199b064d177559407354c4ab069183f6397ff)
    - src/cassandra/metrics.rs
      [metrics.rs](#diff-a9465b97279ec79a259a33744085e2758b3b10e99d3940219fc5557bbb2d5cd5)
    - policy

      * src/cassandra/policy/retry.rs
        [retry.rs](#diff-a29f8934f321e9970d2e04d30708f61cc9c9f5c59a07f9938cbb72c6bc4649c5)
    - src/cassandra/prepared.rs
      [prepared.rs](#diff-aedc2a5b4b1892ffbf1060807c4c05bace7cbf9a8f808f17e0b23dcce4f1b916)
    - src/cassandra/result.rs
      [result.rs](#diff-fd045d6fd3b435c5b54b07c67c8865a04776b5be53a73aca2e3f64ae6ec980df)
    - src/cassandra/row.rs
      [row.rs](#diff-1a09b32808b25a93798ba22e6685624331a4c27645b16af55dde2dc933273df2)
    - schema

      * src/cassandra/schema/aggregate\_meta.rs
        [aggregate\_meta.rs](#diff-8ef6f9e9d4886c284563c10e642d42757478f30783dbeaaecae36b09f032f728)
      * src/cassandra/schema/column\_meta.rs
        [column\_meta.rs](#diff-00122f1c83f80f3cde197f4de54dfaff9d1b23f532de8e799567dc70aa99c762)
      * src/cassandra/schema/function\_meta.rs
        [function\_meta.rs](#diff-895b0be411689670535c679439d855db5616647c7a2de01c85dc4be606ac38c3)
      * src/cassandra/schema/keyspace\_meta.rs
        [keyspace\_meta.rs](#diff-6eef2b33ab4c4a163dcff04455e23c1b9738e3f0f4492c36d5ec8ee10875fd54)
      * src/cassandra/schema/schema\_meta.rs
        [schema\_meta.rs](#diff-d69b249a1088ca76aca78d4c8d89fbd1d7f96909c3dacb88aabb6f7fed8bd17e)
      * src/cassandra/schema/table\_meta.rs
        [table\_meta.rs](#diff-ee44b6ba8e981482b10eb24235d5f9279e82d7c8dcb123ecf61149b82ac3080d)
    - src/cassandra/session.rs
      [session.rs](#diff-82ab55b7f3e98adc759153f6317f56ab011cf2c1d1c799cf33c13f96a4792fb7)
    - src/cassandra/ssl.rs
      [ssl.rs](#diff-a913ede6515c5f325101c57bc0fba2a52230d7ea1b8dd02324f8832918d9af78)
    - src/cassandra/statement.rs
      [statement.rs](#diff-c86937842e651cb2c2cede786f74667dd782d25cfdb6c0d2fae58aab84f53beb)
    - src/cassandra/tuple.rs
      [tuple.rs](#diff-93a157bda6f186fb94a368b22182b076f2a10b972643e3f97b1013d2b09a5dc3)
    - src/cassandra/user\_type.rs
      [user\_type.rs](#diff-cda6d11e83ae5e97ed0613b828d09b96da3c2117be7b21d87fcf5f4d829a130a)
    - src/cassandra/uuid.rs
      [uuid.rs](#diff-2343534799b467c3d3b12243a36be7817345157462315dfe6603ed03cbf8ff9c)
    - src/cassandra/value.rs
      [value.rs](#diff-5e43f0200262fc152039ae1f5a1a41094bcefb1ff3e1972d494c7325d94a6900)
    - src/cassandra/write\_type.rs
      [write\_type.rs](#diff-e45b68504796c43c6a51ffe165c031a6c1aaaf455d764c677322a227b3f48279)
  + src/lib.rs
    [lib.rs](#diff-b1a35a68f14e696205874893c07fd24fdb88882b47c23cc0e0c80a30c7d53759)
* tests

  + tests/basic.rs
    [basic.rs](#diff-e41c063cd26a1181211ca22e91577e32d5067e01cf8f6341954e708842bf5f07)
  + tests/batch.rs
    [batch.rs](#diff-124ccc2ac8dbdec5af7278e1231bd90aaef6014df84fdf6e0acf86c3b540667b)
  + tests/bind\_by\_name.rs
    [bind\_by\_name.rs](#diff-46484b31e1ecac509d050f174a79225dba64cb7e401201ed0b6032c54e8b013e)
  + tests/collections.rs
    [collections.rs](#diff-845db23aaa38d54c776b988a239a80c4b512e11827c712189150f63de6d8c37a)
  + tests/maps.rs
    [maps.rs](#diff-272635a5e7ed947307c5fee3a42587e4d3febec2c5fbe268c95dd0a6b80942c3)
  + tests/paging.rs
    [paging.rs](#diff-f71e467097bcee231c3bb4190c189aaf7db5ad45189cadb1b175607338500bf5)
  + tests/send\_static\_future.rs
    [send\_static\_future.rs](#diff-32a145c263d1e145f03ac323e1517f80aeb08edb6af444e549de0eb30914a27b)
  + tests/uuids.rs
    [uuids.rs](#diff-9b650fa99488d47a7763769978b22f08780a3d8043c5311ec1a56fd40392905e)

## There are no files selected for viewing

28 changes: 28 additions & 0 deletions

28
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/cassandra-rs/cassandra-rs/blob/ae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -14,6 +14,34 @@ version number is tracked in the file `VERSION`. |
|  |  |  |
|  |  | ### Fixed |
|  |  |  |
|  |  | ## [3.0.0] |
|  |  |  |
|  |  | ### Added |
|  |  | - `get\_decimal()` now gets a Cassanda decimal value as `BigDecimal`, |
|  |  | `bind\_decimal()` does the reverse. |
|  |  |  |
|  |  | ### Changed |
|  |  | - Date type is now `u32`. |
|  |  |  |
|  |  | ### Fixed |
|  |  | - Soundness issue fixed - the various iterators no longer implement |
|  |  | `std::iter::Iterator`, but instead a new `LendingIterator` trait. |
|  |  | For migration guide, see [`README`](README.md#lending-iterator-api-version-30). |
|  |  | - Many types now take a lifetime argument, e.g., `Value` is now `Value<'a>`, |
|  |  | `ResultIterator` is now `ResultIterator<'a>`. |
|  |  | - `RowIterator` no longer implements `Display` (since it would consume the |
|  |  | iterator); however `Row` does. |
|  |  | - `Result::into\_iter()` and `Row::into\_iter()` are now both `iter()`, since they |
|  |  | do not consume their argument. |
|  |  | - `TupleIterator` is removed - it was never used, since you use the set iterator |
|  |  | (Value::get\_set()) for lists, sets, and tuples. |
|  |  | - `ConstDataType::sub\_data\_by\_name` and `ConstDataType::sub\_type\_name` now take |
|  |  | `&self` rather than an explicit argument. |
|  |  | - `FunctionMeta::argument` now returns the name and type, rather than just `()`. |
|  |  | - The underlying raw pointer is no longer exposed as a field of `Cluster`, |
|  |  | `ResultIterator`, and `RowIterator`. |
|  |  | - Many types now implement `Sync` as well as `Send`. |
|  |  |  |
|  |  | ## [2.0.1] - 2023-06-08 |
|  |  |  |
|  |  | ### Fixed |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[Cargo.toml](#diff-2e9d962a08321605940b5a657135052fbcef87b5e360662bb527c96d9a615542 "Cargo.toml")

Show comments

[View file](/cassandra-rs/cassandra-rs/blob/ae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7/Cargo.toml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,7 +8,7 @@ keywords = [ "Cassandra", "binding", "CQL", "client", "database" ] |
|  |  | categories = [ "api-bindings", "database", "external-ffi-bindings", "asynchronous" ] |
|  |  | license = "Apache-2.0" |
|  |  | name = "cassandra-cpp" |
|  |  | version = "2.0.2-pre" |
|  |  | version = "3.0.0" |
|  |  | authors = ["Tupshin Harper <tupshin@tupshin.com>", "Keith Wansbrough <Keith.Wansbrough@metaswitch.com>"] |
|  |  | edition = "2018" |
|  |  |  |
| Expand Down | |  |

50 changes: 50 additions & 0 deletions

50
[README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5 "README.md")

Show comments

[View file](/cassandra-rs/cassandra-rs/blob/ae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -55,6 +55,56 @@ For a straightforward example see [`simple.rs`](examples/simple.rs). |
|  |  | There are additional examples included with the project in [`tests`](tests/) and |
|  |  | [`examples`](examples/). |
|  |  |  |
|  |  | ## Lending iterator API (version 3.0) |
|  |  |  |
|  |  | Version 3.0 fixes a soundness issue with the previous API. The iterators in the |
|  |  | underlying Cassandra driver invalidate the current item when `next()` is called, |
|  |  | and this was not reflected in the Rust binding prior to version 3. |
|  |  |  |
|  |  | To deal with this, the various iterators (`ResultIterator`, `RowIterator`, |
|  |  | `MapIterator`, `SetIterator`, `FieldIterator`, `UserTypeIterator`, |
|  |  | `KeyspaceIterator`, `FunctionIterator`, `AggregateIterator`, `TableIterator`, |
|  |  | `ColumnIterator`) no longer implement `std::iter::Iterator`. Instead, since this |
|  |  | is a [lending |
|  |  | iterator,](https://blog.rust-lang.org/2022/11/03/Rust-1.65.0.html#generic-associated-types-gats) |
|  |  | these types all implement a new `LendingIterator` trait. We define this |
|  |  | ourselves because there is currently no widely-used crate that implements it. |
|  |  |  |
|  |  | To upgrade, change |
|  |  |  |
|  |  | ```rust |
|  |  | for row in result { |
|  |  | // ... do something with row ... |
|  |  | } |
|  |  | ``` |
|  |  |  |
|  |  | to |
|  |  |  |
|  |  | ```rust |
|  |  | let mut iter = result.iter(); |
|  |  | while let Some(row) = iter.next() { |
|  |  | // ... do something with row ... |
|  |  | } |
|  |  | ``` |
|  |  |  |
|  |  | The intermediate variable `iter` is necessary, otherwise you will infinitely |
|  |  | visit the first row of the result! |
|  |  |  |
|  |  | Other changes: |
|  |  |  |
|  |  | \* Many types now take a lifetime argument, e.g., `Value` is now `Value<'a>`, |
|  |  | `ResultIterator` is now `ResultIterator<'a>`. In almost all cases you can omit |
|  |  | this and it will be inferred for you. If not, you can usually write |
|  |  | `Value<'\_>` to let Rust worry about it for you. |
|  |  | \* `RowIterator` no longer implements `Display` (since it would consume the |
|  |  | iterator); however `Row` does. |
|  |  | \* `TupleIterator` is removed - it was never used, since you use the set iterator |
|  |  | (Value::get\_set()) for lists, sets, and tuples. |
|  |  | \* `ConstDataType::sub\_data\_by\_name` and `ConstDataType::sub\_type\_name` now take |
|  |  | `&self` rather than an explicit argument. |
|  |  | \* `FunctionMeta::argument` now returns the name and type, rather than just `()`. |
|  |  |  |
|  |  |  |
|  |  | ## New session API (version 2.0) |
|  |  |  |
|  |  | Version 2.0 introduces a new and safer API. `Statement`s (and |
| Expand Down | |  |

29 changes: 19 additions & 10 deletions

29
[examples/collections.rs](#diff-75cb79ef82a1cede02036908fb5b6875a80dbdb5e8f0321565e7bc9f0eb2190d "examples/collections.rs")

Show comments

[View file](/cassandra-rs/cassandra-rs/blob/ae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7/examples/collections.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -26,26 +26,35 @@ async fn do\_work(session: &Session) -> Result<()> { |
|  |  | let result = session.execute("SELECT \* FROM testks.user;").await?; |
|  |  |  |
|  |  | println!("Overall result: {}", result); |
|  |  | for row in result.iter() { |
|  |  | let mut iter = result.iter(); |
|  |  | while let Some(row) = iter.next() { |
|  |  | println!("Row: {}", row); |
|  |  |  |
|  |  | let first\_name: String = row.get\_by\_name("first\_name")?; |
|  |  | let addresses: HashMap<String, String> = { |
|  |  | let maybe\_iter: Result<MapIterator> = row.get\_by\_name("addresses"); |
|  |  | match maybe\_iter { |
|  |  | Err(\_) => HashMap::new(), |
|  |  | Ok(addresses\_iter) => addresses\_iter |
|  |  | .map(|(k, v)| Ok((k.get\_string()?, v.get\_string()?))) |
|  |  | .collect::<Result<\_>>()?, |
|  |  | Ok(mut addresses\_iter) => { |
|  |  | let mut map = HashMap::new(); |
|  |  | while let Some((k, v)) = addresses\_iter.next() { |
|  |  | map.insert(k.get\_string()?, v.get\_string()?); |
|  |  | } |
|  |  | map |
|  |  | } |
|  |  | } |
|  |  | }; |
|  |  | let emails\_iter: SetIterator = row.get\_by\_name("email")?; |
|  |  | let emails: Vec<String> = emails\_iter.map(|v| v.get\_string()).collect::<Result<\_>>()?; |
|  |  | let mut emails\_iter: SetIterator = row.get\_by\_name("email")?; |
|  |  | let mut emails: Vec<String> = vec![]; |
|  |  | while let Some(v) = emails\_iter.next() { |
|  |  | emails.push(v.get\_string()?); |
|  |  | } |
|  |  | let last\_name: String = row.get\_by\_name("last\_name")?; |
|  |  | let phone\_numbers\_iter: SetIterator = row.get\_by\_name("phone\_numbers")?; |
|  |  | let phone\_numbers: Vec<String> = phone\_numbers\_iter |
|  |  | .map(|v| v.get\_string()) |
|  |  | .collect::<Result<\_>>()?; |
|  |  | let mut phone\_numbers\_iter: SetIterator = row.get\_by\_name("phone\_numbers")?; |
|  |  | let mut phone\_numbers: Vec<String> = vec![]; |
|  |  | while let Some(v) = phone\_numbers\_iter.next() { |
|  |  | phone\_numbers.push(v.get\_string()?); |
|  |  | } |
|  |  | let title: i32 = row.get\_by\_name("title")?; |
|  |  | println!( |
|  |  | " == {} {:?} {:?} {} {:?} {}", |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[examples/simple.rs](#diff-9b91ae38610593e55d5bf8c7f39f99538733db009291ac6ed4ec9a6664e75fbb "examples/simple.rs")

Show comments

[View file](/cassandra-rs/cassandra-rs/blob/ae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7/examples/simple.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -12,7 +12,8 @@ async fn main() -> Result<()> { |
|  |  | .await?; |
|  |  | println!("{}", result); |
|  |  |  |
|  |  | for row in result.iter() { |
|  |  | let mut iter = result.iter(); |
|  |  | while let Some(row) = iter.next() { |
|  |  | let col: String = row.get\_by\_name("keyspace\_name")?; |
|  |  | println!("ks name = {}", col); |
|  |  | } |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[examples/ssl.rs](#diff-dc13de072261240f6ff035cc9cf9187b77d3b433e21958c2f2f6be1268569d8b "examples/ssl.rs")

Show comments

[View file](/cassandra-rs/cassandra-rs/blob/ae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7/examples/ssl.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,7 +25,8 @@ async fn main() -> Result<()> { |
|  |  | .unwrap(); |
|  |  |  |
|  |  | println!("{}", result); |
|  |  | for row in result.iter() { |
|  |  | let mut iter = result.iter(); |
|  |  | while let Some(row) = iter.next() { |
|  |  | let col: String = row.get\_by\_name(col\_name).unwrap(); |
|  |  | println!("ks name = {}", col); |
|  |  | } |
| Expand Down | |  |

9 changes: 3 additions & 6 deletions

9
[src/cassandra/batch.rs](#diff-bbdaaad6c9f517914f900e324adb12a0165ac2e4e24b116ea2d0622a55847314 "src/cassandra/batch.rs")

Show comments

[View file](/cassandra-rs/cassandra-rs/blob/ae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7/src/cassandra/batch.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,10 +18,6 @@ use crate::cassandra\_sys::cass\_batch\_set\_serial\_consistency; |
|  |  | use crate::cassandra\_sys::cass\_batch\_set\_timestamp; |
|  |  | use crate::cassandra\_sys::CassBatch as \_Batch; |
|  |  | use crate::cassandra\_sys::CassBatchType\_; |
|  |  | use crate::cassandra\_sys::CassConsistency; |
|  |  | use crate::cassandra\_sys::CassCustomPayload as \_CassCustomPayload; |
|  |  | use std::ffi::NulError; |
|  |  | use std::os::raw::c\_char; |
|  |  |  |
|  |  | #[derive(Debug)] |
|  |  | struct BatchInner(\*mut \_Batch); |
| Expand All | | @@ -31,9 +27,10 @@ struct BatchInner(\*mut \_Batch); |
|  |  | #[derive(Debug)] |
|  |  | pub struct Batch(BatchInner, Session); |
|  |  |  |
|  |  | // The underlying C type has no thread-local state, but does not support access |
|  |  | // from multiple threads: https://datastax.github.io/cpp-driver/topics/#thread-safety |
|  |  | // The underlying C type has no thread-local state, and forbids only concurrent |
|  |  | // mutation/free: https://datastax.github.io/cpp-driver/topics/#thread-safety |
|  |  | unsafe impl Send for BatchInner {} |
|  |  | unsafe impl Sync for BatchInner {} |
|  |  |  |
|  |  | impl ProtectedInner<\*mut \_Batch> for BatchInner { |
|  |  | #[inline(always)] |
| Expand Down | |  |

21 changes: 7 additions & 14 deletions

21
[src/cassandra/cluster.rs](#diff-c53050fbf610e66981b02ac69c250d126f510fafe03e9f2beffb48a7854cfa11 "src/cassandra/cluster.rs")

Show comments

[View file](/cassandra-rs/cassandra-rs/blob/ae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7/src/cassandra/cluster.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -48,23 +48,15 @@ use crate::cassandra\_sys::cass\_cluster\_set\_whitelist\_filtering; |
|  |  | use crate::cassandra\_sys::cass\_cluster\_set\_write\_bytes\_high\_water\_mark; |
|  |  | use crate::cassandra\_sys::cass\_cluster\_set\_write\_bytes\_low\_water\_mark; |
|  |  | use crate::cassandra\_sys::cass\_false; |
|  |  | use crate::cassandra\_sys::cass\_future\_error\_code; |
|  |  |  |
|  |  | use crate::cassandra\_sys::cass\_session\_connect; |
|  |  | use crate::cassandra\_sys::cass\_session\_connect\_keyspace\_n; |
|  |  | use crate::cassandra\_sys::cass\_session\_new; |
|  |  |  |
|  |  | use crate::cassandra\_sys::cass\_true; |
|  |  | use crate::cassandra\_sys::CassCluster as \_Cluster; |
|  |  |  |
|  |  | use std::ffi::CStr; |
|  |  | use std::ffi::NulError; |
|  |  | use std::fmt; |
|  |  | use std::fmt::Display; |
|  |  | use std::iter::Map; |
|  |  | use std::net::AddrParseError; |
|  |  | use std::net::Ipv4Addr; |
|  |  | use std::os::raw::c\_char; |
|  |  | use std::result; |
|  |  | use std::str::FromStr; |
|  |  |  |
|  |  | use std::time::Duration; |
|  |  |  |
|  |  | /// A CQL protocol version is just an integer. |
| Expand All | | @@ -85,11 +77,12 @@ pub type CqlProtocol = i32; |
|  |  | /// # } |
|  |  | /// ``` |
|  |  | #[derive(Debug)] |
|  |  | pub struct Cluster(pub \*mut \_Cluster); |
|  |  | pub struct Cluster(\*mut \_Cluster); |
|  |  |  |
|  |  | // The underlying C type has no thread-local state, but does not support access |
|  |  | // from multiple threads: https://datastax.github.io/cpp-driver/topics/#thread-safety |
|  |  | // The underlying C type has no thread-local state, and forbids only concurrent |
|  |  | // mutation/free: https://datastax.github.io/cpp-driver/topics/#thread-safety |
|  |  | unsafe impl Send for Cluster {} |
|  |  | unsafe impl Sync for Cluster {} |
|  |  |  |
|  |  | impl Drop for Cluster { |
|  |  | /// Frees a cluster instance. |
| Expand Down | |  |

17 changes: 10 additions & 7 deletions

17
[src/cassandra/collection.rs](#diff-9f26829aa133dd47f59909f267edb22fa5e13941fd447f1a33b30552f67dc02d "src/cassandra/collection.rs")

Show comments

[View file](/cassandra-rs/cassandra-rs/blob/ae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7/src/cassandra/collection.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,7 +10,7 @@ use crate::cassandra::uuid::Uuid; |
|  |  | use crate::cassandra\_sys::cass\_collection\_append\_bool; |
|  |  | use crate::cassandra\_sys::cass\_collection\_append\_bytes; |
|  |  | use crate::cassandra\_sys::cass\_collection\_append\_collection; |
|  |  | use crate::cassandra\_sys::cass\_collection\_append\_decimal; |
|  |  |  |
|  |  | use crate::cassandra\_sys::cass\_collection\_append\_double; |
|  |  | use crate::cassandra\_sys::cass\_collection\_append\_float; |
|  |  | use crate::cassandra\_sys::cass\_collection\_append\_inet; |
| Expand Down  Expand Up | | @@ -124,9 +124,10 @@ pub trait CassCollection: Sized { |
|  |  | #[derive(Debug)] |
|  |  | pub struct List(\*mut \_CassCollection); |
|  |  |  |
|  |  | // The underlying C type has no thread-local state, but does not support access |
|  |  | // from multiple threads: https://datastax.github.io/cpp-driver/topics/#thread-safety |
|  |  | // The underlying C type has no thread-local state, and forbids only concurrent |
|  |  | // mutation/free: https://datastax.github.io/cpp-driver/topics/#thread-safety |
|  |  | unsafe impl Send for List {} |
|  |  | unsafe impl Sync for List {} |
|  |  |  |
|  |  | impl ProtectedInner<\*mut \_CassCollection> for List { |
|  |  | fn inner(&self) -> \*mut \_CassCollection { |
| Expand Down  Expand Up | | @@ -302,9 +303,10 @@ impl CassCollection for List { |
|  |  | #[derive(Debug)] |
|  |  | pub struct Set(\*mut \_CassCollection); |
|  |  |  |
|  |  | // The underlying C type has no thread-local state, but does not support access |
|  |  | // from multiple threads: https://datastax.github.io/cpp-driver/topics/#thread-safety |
|  |  | // The underlying C type has no thread-local state, and forbids only concurrent |
|  |  | // mutation/free: https://datastax.github.io/cpp-driver/topics/#thread-safety |
|  |  | unsafe impl Send for Set {} |
|  |  | unsafe impl Sync for Set {} |
|  |  |  |
|  |  | impl Drop for Set { |
|  |  | fn drop(&mut self) { |
| Expand Down  Expand Up | | @@ -438,9 +440,10 @@ impl CassCollection for Set { |
|  |  | #[derive(Debug)] |
|  |  | pub struct Map(\*mut \_CassCollection); |
|  |  |  |
|  |  | // The underlying C type has no thread-local state, but does not support access |
|  |  | // from multiple threads: https://datastax.github.io/cpp-driver/topics/#thread-safety |
|  |  | // The underlying C type has no thread-local state, and forbids only concurrent |
|  |  | // mutation/free: https://datastax.github.io/cpp-driver/topics/#thread-safety |
|  |  | unsafe impl Send for Map {} |
|  |  | unsafe impl Sync for Map {} |
|  |  |  |
|  |  | impl Drop for Map { |
|  |  | fn drop(&mut self) { |
| Expand Down | |  |

5 changes: 0 additions & 5 deletions

5
[src/cassandra/consistency.rs](#diff-b4e416cdd6be667daed1b9468361baca4470b75e18bb3b2bdeb0bee9fe54310a "src/cassandra/consistency.rs")

Show comments

[View file](/cassandra-rs/cassandra-rs/blob/ae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7/src/cassandra/consistency.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,10 +1,5 @@ |
|  |  | use crate::cassandra::util::Protected; |
|  |  | use crate::cassandra\_sys::CassConsistency\_; |
|  |  |  |
|  |  | use crate::cassandra\_sys::cass\_consistency\_string; |
|  |  |  |
|  |  | use std::ffi::CStr; |
|  |  |  |
|  |  | /// A Cassandra consistency level. |
|  |  | #[derive(Debug, Eq, PartialEq, Copy, Clone, Hash)] |
|  |  | #[allow(missing\_docs)] // Meanings are defined in CQL documentation. |
| Expand Down | |  |

9 changes: 5 additions & 4 deletions

9
[src/cassandra/custom\_payload.rs](#diff-923700f0f097346c87f4f324b54de2abc9b82ff32820da154b453f4bdd02f4c3 "src/cassandra/custom_payload.rs")

Show comments

[View file](/cassandra-rs/cassandra-rs/blob/ae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7/src/cassandra/custom_payload.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,9 +1,9 @@ |
|  |  | use crate::cassandra::error::\*; |
|  |  | use crate::cassandra::util::{Protected, ProtectedInner, ProtectedWithSession}; |
|  |  | use crate::cassandra::util::{Protected, ProtectedInner}; |
|  |  |  |
|  |  | use crate::cassandra\_sys::cass\_custom\_payload\_free; |
|  |  | use crate::cassandra\_sys::cass\_custom\_payload\_new; |
|  |  | use crate::cassandra\_sys::cass\_custom\_payload\_set; |
|  |  |  |
|  |  | use crate::cassandra\_sys::cass\_custom\_payload\_set\_n; |
|  |  | use crate::cassandra\_sys::CassCustomPayload as \_CassCustomPayload; |
|  |  | use std::collections::HashMap; |
| Expand All | | @@ -15,9 +15,10 @@ pub type CustomPayloadResponse = HashMap<String, Vec<u8>>; |
|  |  | #[derive(Debug)] |
|  |  | pub struct CustomPayload(\*mut \_CassCustomPayload); |
|  |  |  |
|  |  | // The underlying C type has no thread-local state, but does not support access |
|  |  | // from multiple threads: https://datastax.github.io/cpp-driver/topics/#thread-safety |
|  |  | // The underlying C type has no thread-local state, and forbids only concurrent |
|  |  | // mutation/free: https://datastax.github.io/cpp-driver/topics/#thread-safety |
|  |  | unsafe impl Send for CustomPayload {} |
|  |  | unsafe impl Sync for CustomPayload {} |
|  |  |  |
|  |  | impl ProtectedInner<\*mut \_CassCustomPayload> for CustomPayload { |
|  |  | #[inline(always)] |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ae054dc`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcassandra-rs%2Fcassandra-rs%2Fcommit%2Fae054dc8044eac9c2c7ae2b1ab154b53ca7f8df7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_26731238_20250111_185045.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcassandra-rs%2Fcassandra-rs%2Fsecurity%2Fadvisories%2FGHSA-x9xc-63hg-vcfq)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcassandra-rs%2Fcassandra-rs%2Fsecurity%2Fadvisories%2FGHSA-x9xc-63hg-vcfq)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=cassandra-rs%2Fcassandra-rs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cassandra-rs](/cassandra-rs)
/
**[cassandra-rs](/cassandra-rs/cassandra-rs)**
Public

* [Notifications](/login?return_to=%2Fcassandra-rs%2Fcassandra-rs) You must be signed in to change notification settings
* [Fork
  55](/login?return_to=%2Fcassandra-rs%2Fcassandra-rs)
* [Star
   138](/login?return_to=%2Fcassandra-rs%2Fcassandra-rs)

* [Code](/cassandra-rs/cassandra-rs)
* [Issues
  15](/cassandra-rs/cassandra-rs/issues)
* [Pull requests
  1](/cassandra-rs/cassandra-rs/pulls)
* [Actions](/cassandra-rs/cassandra-rs/actions)
* [Security](/cassandra-rs/cassandra-rs/security)
* [Insights](/cassandra-rs/cassandra-rs/pulse)

Additional navigation options

* [Code](/cassandra-rs/cassandra-rs)
* [Issues](/cassandra-rs/cassandra-rs/issues)
* [Pull requests](/cassandra-rs/cassandra-rs/pulls)
* [Actions](/cassandra-rs/cassandra-rs/actions)
* [Security](/cassandra-rs/cassandra-rs/security)
* [Insights](/cassandra-rs/cassandra-rs/pulse)

# Non-idiomatic use of iterators leads to use after free

High

[kw217](/kw217)
published
GHSA-x9xc-63hg-vcfq
Feb 28, 2024

## Package

cargo

cassandra-rs
([Rust](/advisories?query=ecosystem%3Arust))

## Affected versions

<3.0.0

## Patched versions

3.0.0

## Description

### Impact

Code that attempts to use an item (e.g., a row) returned by an iterator after the iterator has advanced to the next item will be accessing freed memory and experience undefined behaviour. Code that uses the item and then advances the iterator is unaffected. This problem has always existed.

This is a use-after-free bug, so it's rated high severity. If your code uses a pre-3.0.0 version of cassandra-rs, and uses an item returned by a cassandra-rs iterator after calling `next()` on that iterator, then it is vulnerable. However, such code will almost always fail immediately - so we believe it is unlikely that any code using this pattern would have reached production. For peace of mind, we recommend you upgrade anyway.

### Patches

The problem has been fixed in version 3.0.0. Users should upgrade to ensure their code cannot use the problematic pattern.

### Workarounds

Ensure all usage fits the expected pattern. For example, use `get_first_row()` rather than an iterator, or completely process an item before advancing the iterator with `next()`.

### References

None.

### Severity

High

### CVE ID

CVE-2024-27284

### Weaknesses

[CWE-416](/advisories?query=cwe%3A416)

### Credits

* [![@CastleQuirm](https://avatars.githubusercontent.com/u/95966834?s=40&v=4)](/CastleQuirm)
  [CastleQuirm](/CastleQuirm)
  Reporter
* [![@kw217](https://avatars.githubusercontent.com/u/587036?s=40&v=4)](/kw217)
  [kw217](/kw217)
  Remediation developer
* [![@angusi](https://avatars.githubusercontent.com/u/762026?s=40&v=4)](/angusi)
  [angusi](/angusi)
  Remediation reviewer
* [![@bossmc](https://avatars.githubusercontent.com/u/1073983?s=40&v=4)](/bossmc)
  [bossmc](/bossmc)
  Remediation developer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


