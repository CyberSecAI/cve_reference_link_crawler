

![Ruby on Rails Discussions](data:image/svg;base64...)
Loading

[Ruby on Rails Discussions](/)

# [[CVE-2022-44566] Possible Denial of Service Vulnerability in ActiveRecord's PostgreSQL adapter](/t/cve-2022-44566-possible-denial-of-service-vulnerability-in-activerecords-postgresql-adapter/82119)

[Security Announcements](/c/security-announcements/9)

[security](https://discuss.rubyonrails.org/tag/security),
[patch](https://discuss.rubyonrails.org/tag/patch),
[activerecord](https://discuss.rubyonrails.org/tag/activerecord)

[jhawthorn](https://discuss.rubyonrails.org/u/jhawthorn)
(John Hawthorn)

January 17, 2023, 7:19pm

1

# Possible Denial of Service Vulnerability in ActiveRecord’s PostgreSQL adapter

There is a potential denial of service vulnerability present in ActiveRecord’s
PostgreSQL adapter.

This has been assigned the CVE identifier CVE-2022-44566.

Versions Affected: All.
Not affected: None.
Fixed Versions: 7.0.4.1, 6.1.7.1

## Impact

In ActiveRecord <7.0.4.1 and <6.1.7.1, when a value outside the range
for a 64bit signed integer is provided to the PostgreSQL connection adapter,
it will treat the target column type as numeric. Comparing integer values
against numeric values can result in a slow sequential scan resulting
in potential Denial of Service.

## Releases

The fixed releases are available at the normal locations.

## Workarounds

Ensure that user supplied input which is provided to ActiveRecord clauses do
not contain integers wider than a signed 64bit representation or floats.

## Patches

To aid users who aren’t able to upgrade immediately we have provided patches for
the supported release series in accordance with our
[maintenance policy](https://guides.rubyonrails.org/maintenance_policy.html#security-issues)
regarding security issues. They are in git-am format and consist of a
single changeset.

* 6-1-Added-integer-width-check-to-PostgreSQL-Quoting.patch - Patch for 6.1 series
* 7-0-Added-integer-width-check-to-PostgreSQL-Quoting.patch - Patch for 7.0 series

## Credits

Thank you [Jeremy Evans](https://code.jeremyevans.net) for reporting this!

[6-1-Added-integer-width-check-to-PostgreSQL-Quoting.patch](/uploads/short-url/6vfEFM06e2jKincwWdvKoohU1ux.patch) (6.4 KB)

[7-0-Added-integer-width-check-to-PostgreSQL-Quoting.patch](/uploads/short-url/LlRAx2jcNtDE8rFvgwPA1Cj5Ay.patch) (7.2 KB)

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [[CVE-2021-22880] Possible DoS Vulnerability in Active Record PostgreSQL adapter](https://discuss.rubyonrails.org/t/cve-2021-22880-possible-dos-vulnerability-in-active-record-postgresql-adapter/77129)  [Security Announcements](/c/security-announcements/9) | 0 | 10607 | February 10, 2021 |
| [[CVE-2023-22794] SQL Injection Vulnerability via ActiveRecord comments](https://discuss.rubyonrails.org/t/cve-2023-22794-sql-injection-vulnerability-via-activerecord-comments/82117)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) ,  [activerecord](https://discuss.rubyonrails.org/tag/activerecord) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 30932 | January 17, 2023 |
| [Ticket #6868](https://discuss.rubyonrails.org/t/ticket-6868/23183)  [rubyonrails-core](/c/rubyonrails-core/5) | 1 | 113 | January 16, 2008 |
| [[CVE-2023-22796] Possible ReDoS based DoS vulnerability in Active Support's underscore](https://discuss.rubyonrails.org/t/cve-2023-22796-possible-redos-based-dos-vulnerability-in-active-supports-underscore/82116)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) ,  [activesupport](https://discuss.rubyonrails.org/tag/activesupport) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 7585 | January 17, 2023 |
| [How to reproduce: CVE-2013-1854 Symbol DoS vulnerability in Active Record](https://discuss.rubyonrails.org/t/how-to-reproduce-cve-2013-1854-symbol-dos-vulnerability-in-active-record/66922)  [rubyonrails-talk](/c/rubyonrails-talk/7) | 1 | 132 | May 1, 2013 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

