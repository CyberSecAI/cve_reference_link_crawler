```
{
  "vulnerability": {
    "root_cause": "The rehash delayed work in the mlxsw driver migrates filters between regions. It uses markers to track progress across work reschedules. Upon errors, only the chunk marker is reset, while entry markers which are relative to the chunk marker are not reset. This leads to incorrect resumption of migration from an entry that does not belong to the chunk being migrated. This causes a chunk to be iterated over as if it is an entry, leading to a warning due to how structures are defined.",
    "weaknesses": [
      "Incorrect state management during error recovery",
      "Inconsistent reset of related markers"
    ],
    "impact": "The vulnerability doesn't lead to KASAN splats, but rather results in a warning during rehash operations. This indicates a logical error in the migration process that could potentially lead to incorrect filter handling or other unexpected behavior, although no direct security impact is mentioned.",
    "attack_vectors": [
      "Triggering the rehash operation in the mlxsw driver"
    ],
    "required_capabilities": "The attacker needs to be able to trigger a rehash operation within the Mellanox mlxsw driver. This could involve configuration changes or other actions that initiate filter migration."
  },
  "affected_components": [
    "Mellanox mlxsw driver (specifically the spectrum_acl_tcam module)",
    "Linux kernel"
  ],
    "fix": "The fix involves creating a helper function that resets all the markers (chunk and entry) related to the rehash context. This function is called from all the locations where the chunk marker was previously reset, as well as when starting a new rehash, ensuring all markers are correctly reset upon error or at the start of a new rehash operation."
}
```