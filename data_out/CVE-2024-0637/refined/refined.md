Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
- The vulnerability is a SQL injection flaw caused by the lack of proper validation of a user-supplied string before using it to construct SQL queries within the `updateDirectory` function.

**Weaknesses/Vulnerabilities:**
- SQL Injection vulnerability.
- Lack of input sanitization/validation.

**Impact of Exploitation:**
- Remote code execution (RCE) on affected Centreon installations.
- An attacker can execute code within the context of the service account.
- The impact is high, leading to complete compromise (confidentiality, integrity, availability) of the system.

**Attack Vectors:**
- Remote attack over the network.

**Required Attacker Capabilities/Position:**
- Authenticated user access to the Centreon application is required to exploit this vulnerability.