=== Content from security.netapp.com_bb07efa6_20250108_111110.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2022-3564 Linux Kernel Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20221223-0001)

## CVE-2022-3564 Linux Kernel Vulnerability in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20221223-0001 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20221223-0001 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20221223-0001 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20221223-0001 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20221223-0001
**Version:**
4.0

**Last updated:**
01/23/2023

**Status:**
Final.

**CVEs:** CVE-2022-3564

Overview
#### Summary

Multiple NetApp products incorporate Linux Kernel. All versions of Linux Kernel are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2022-3564](https://nvd.nist.gov/vuln/detail/CVE-2022-3564) | 7.1 (HIGH) | CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

Affected Products
#### Affected Products

* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S

#### Products Not Affected

* 7-Mode Transition Tool
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Trident
* Astra Trident Autosupport
* BeeGFS CSI Driver
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Data Sense
* Cloud Insights Acquisition Unit
* Cloud Insights Telegraf Agent
* Cloud Secure Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2554/2552/2520
* FAS/AFF BIOS - 8080/8060/8040/8020
* FAS/AFF BIOS - 8300/8700/A400
* FAS/AFF BIOS - A250/500f
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A700s
* FAS/AFF BIOS - A800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f
* FAS/AFF Baseboard Management Controller (BMC) - A320/C190/A220/FAS2720/FAS2750/A800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Service Processor - 2554/2552/2520
* FAS/AFF Service Processor - 8080/8060/8040/8020
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* Interoperability Matrix Tool
* Inventory Collect Tool
* Management Services for Element Software and NetApp HCI
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp E-Series BeeGFS Collection
* NetApp E-Series Host Collection
* NetApp E-Series Performance Analyzer
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp SMI-S Provider
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp Virtual Desktop Service (VDS)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere
* OnCommand Insight
* OnCommand Workflow Automation
* SANtricity Storage Plugin for vCenter
* SAS Firmware
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* Spot PC
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024
* StorageGRID Baseboard Management Controller (BMC)
* System Manager 9.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S** | NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2884466.html) for more information. |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20221223-0001>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20221223 | Initial Public Release |
| 2.0 | 20230113 | NetApp HCI Baseboard Management Controller (BMC) - H610C, NetApp HCI Baseboard Management Controller (BMC) - H610S and NetApp HCI Baseboard Management Controller (BMC) - H615C moved to Products Not Affected |
| 3.0 | 20230120 | NetApp HCI Baseboard Management Controller (BMC) - H410C moved to Products Not Affected |
| 4.0 | 20230123 | Brocade Fabric Operating System Firmware moved to Products Not Affected, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from lists.debian.org_fd6e070d_20250108_111109.html ===


---

[[Date Prev](msg00033.html)][[Date Next](msg00035.html)]
[[Thread Prev](msg00033.html)][[Thread Next](msg00035.html)]
[[Date Index](maillist.html#00034)]
[[Thread Index](threads.html#00034)]

# [SECURITY] [DLA 3245-1] linux security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3245-1] linux security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Fri, 23 Dec 2022 23:16:58 +0100
* *Message-id*: <[[🔎]](/msgid-search/1bbd98236848af2b95e3e5504023b5363cf93d77.camel%40debian.org) [1bbd98236848af2b95e3e5504023b5363cf93d77.camel@debian.org](msg00034.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3245-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
December 21, 2022                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux
Version        : 4.19.269-1
CVE ID         : CVE-2022-2978 CVE-2022-3521 CVE-2022-3524 CVE-2022-3564
                 CVE-2022-3565 CVE-2022-3594 CVE-2022-3621 CVE-2022-3628
                 CVE-2022-3640 CVE-2022-3643 CVE-2022-3646 CVE-2022-3649
                 CVE-2022-4378 CVE-2022-20369 CVE-2022-29901 CVE-2022-40768
                 CVE-2022-41849 CVE-2022-41850 CVE-2022-42328 CVE-2022-42329
                 CVE-2022-42895 CVE-2022-42896 CVE-2022-43750

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2022-2978

    "butt3rflyh4ck", Hao Sun, and Jiacheng Xu reported a flaw in the
    nilfs2 filesystem driver which can lead to a use-after-free.  A
    local use might be able to exploit this to cause a denial of
    service (crash or memory corruption) or possibly for privilege
    escalation.

CVE-2022-3521

    The syzbot tool found a race condition in the KCM subsystem
    which could lead to a crash.

    This subsystem is not enabled in Debian's official kernel
    configurations.

CVE-2022-3524

    The syzbot tool found a race condition in the IPv6 stack which
    could lead to a memory leak.  A local user could exploit this to
    cause a denial of service (memory exhaustion).

CVE-2022-3564

    A flaw was discovered in the Bluetooh L2CAP subsystem which
    would lead to a use-after-free.  This might be exploitable
    to cause a denial of service (crash or memory corruption) or
    possibly for privilege escalation.

CVE-2022-3565

    A flaw was discovered in the mISDN driver which would lead to a
    use-after-free.  This might be exploitable to cause a denial of
    service (crash or memory corruption) or possibly for privilege
    escalation.

CVE-2022-3594

    Andrew Gaul reported that the r8152 Ethernet driver would log
    excessive numbers of messages in response to network errors.  A
    remote attacker could possibly exploit this to cause a denial of
    service (resource exhaustion).

CVE-2022-3621, CVE-2022-3646

    The syzbot tool found flaws in the nilfs2 filesystem driver which
    can lead to a null pointer dereference or memory leak.  A user
    permitted to mount arbitrary filesystem images could use these to
    cause a denial of service (crash or resource exhaustion).

CVE-2022-3628

    Dokyung Song, Jisoo Jang, and Minsuk Kang reported a potential
    heap-based buffer overflow in the brcmfmac Wi-Fi driver.  A user
    able to connect a malicious USB device could exploit this to cause
    a denial of service (crash or memory corruption) or possibly for
    privilege escalation.

CVE-2022-3640

    A flaw was discovered in the Bluetooh L2CAP subsystem which
    would lead to a use-after-free.  This might be exploitable
    to cause a denial of service (crash or memory corruption) or
    possibly for privilege escalation.

CVE-2022-3643 (XSA-423)

    A flaw was discovered in the Xen network backend driver that would
    result in it generating malformed packet buffers.  If these
    packets were forwarded to certain other network devices, a Xen
    guest could exploit this to cause a denial of service (crash or
    device reset).

CVE-2022-3649

    The syzbot tool found flaws in the nilfs2 filesystem driver which
    can lead to a use-after-free.  A user permitted to mount arbitrary
    filesystem images could use these to cause a denial of service
    (crash or memory corruption) or possibly for privilege escalation.

CVE-2022-4378

    Kyle Zeng found a flaw in procfs that would cause a stack-based
    buffer overflow.  A local user permitted to write to a sysctl
    could use this to cause a denial of service (crash or memory
    corruption) or possibly for privilege escalation.

CVE-2022-20369

    A flaw was found in the v4l2-mem2mem media driver that would lead
    to an out-of-bounds write.  A local user with access to such a
    device could exploit this for privilege escalation.

CVE-2022-29901

    Johannes Wikner and Kaveh Razavi reported that for Intel
    processors (Intel Core generation 6, 7 and 8), protections against
    speculative branch target injection attacks were insufficient in
    some circumstances, which may allow arbitrary speculative code
    execution under certain microarchitecture-dependent conditions.

    More information can be found at
    <https://www.intel.com/content/www/us/en/developer/articles/technical/software-security-guidance/advisory-guidance/return-stack-buffer-underflow.html>

CVE-2022-40768

    "hdthky" reported that the stex SCSI adapter driver did not fully
    initialise a structure that is copied to user-space.  A local user
    with access to such a device could exploit this to leak sensitive
    information.

CVE-2022-41849

    A race condition was discovered in the smscufx graphics driver,
    which could lead to a use-after-free.  A user able to remove the
    physical device while also accessing its device node could exploit
    this to cause a denial of service (crash or memory corruption) or
    possibly for privilege escalation.

CVE-2022-41850

    A race condition was discovered in the hid-roccat input driver,
    which could lead to a use-after-free.  A local user able to access
    such a device could exploit this to cause a denial of service
    (crash or memory corruption) or possibly for privilege escalation.

CVE-2022-42328, CVE-2022-42329 (XSA-424)

    Yang Yingliang reported that the Xen network backend driver did
    not use the proper function to free packet buffers in one case,
    which could lead to a deadlock.  A Xen guest could exploit this to
    cause a denial of service (hang).

CVE-2022-42895

    Tamás Koczka reported a flaw in the Bluetooh L2CAP subsystem
    that would result in reading uninitialised memory.  A nearby
    attacker able to make a Bluetooth connection could exploit
    this to leak sensitive information.

CVE-2022-42896

    Tamás Koczka reported flaws in the Bluetooh L2CAP subsystem that
    can lead to a use-after-free.  A nearby attacker able to make a
    Bluetooth SMP connection could exploit this to cause a denial of
    service (crash or memory corruption) or possibly for remote code
    execution.

CVE-2022-43750

    The syzbot tool found that the USB monitor (usbmon) driver allowed
    user-space programs to overwrite the driver's data structures.  A
    local user permitted to access a USB monitor device could exploit
    this to cause a denial of service (memory corruption or crash) or
    possibly for privilege escalation.  However, by default only the
    root user can access such devices.

For Debian 10 buster, these problems have been fixed in version
4.19.269-1.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--
Ben Hutchings - Debian developer, member of kernel, installer and LTS
teams

```

**Attachment:
[signature.asc](pgpJBRnFmtPRG.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from lists.debian.org_68041af4_20250108_111109.html ===


---

[[Date Prev](msg00030.html)][[Date Next](msg00032.html)]
[[Thread Prev](msg00030.html)][[Thread Next](msg00032.html)]
[[Date Index](maillist.html#00031)]
[[Thread Index](threads.html#00031)]

# [SECURITY] [DLA 3244-1] linux-5.10 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3244-1] linux-5.10 security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Thu, 22 Dec 2022 14:40:03 +0100
* *Message-id*: <[[🔎]](/msgid-search/4bd394b5a6656ecd24f8981d40c39b25c3cfd17d.camel%40debian.org) [4bd394b5a6656ecd24f8981d40c39b25c3cfd17d.camel@debian.org](msg00031.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3244-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
December 20, 2022                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux-5.10
Version        : 5.10.158-2~deb10u1
CVE ID         : CVE-2021-3759 CVE-2022-3169 CVE-2022-3435 CVE-2022-3521
                 CVE-2022-3524 CVE-2022-3564 CVE-2022-3565 CVE-2022-3594
                 CVE-2022-3628 CVE-2022-3640 CVE-2022-3643 CVE-2022-4139
                 CVE-2022-4378 CVE-2022-41849 CVE-2022-41850 CVE-2022-42328
                 CVE-2022-42329 CVE-2022-42895 CVE-2022-42896 CVE-2022-47518
                 CVE-2022-47519 CVE-2022-47520 CVE-2022-47521
Debian Bug     : 1022806 1024697

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2021-3759

    It was discovered that the memory cgroup controller did not
    account for kernel memory allocated for IPC objects.  A local user
    could use this for denial of service (memory exhaustion).

CVE-2022-3169

    It was discovered that the NVMe host driver did not prevent a
    concurrent reset and subsystem reset.  A local user with access to
    an NVMe device could use this to cause a denial of service (device
    disconnect or crash).

CVE-2022-3435

    Gwangun Jung reported a flaw in the IPv4 forwarding subsystem
    which would lead to an out-of-bounds read.  A local user with
    CAP_NET_ADMIN capability in any user namespace could possibly
    exploit this to cause a denial of service (crash).

CVE-2022-3521

    The syzbot tool found a race condition in the KCM subsystem
    which could lead to a crash.

    This subsystem is not enabled in Debian's official kernel
    configurations.

CVE-2022-3524

    The syzbot tool found a race condition in the IPv6 stack which
    could lead to a memory leak.  A local user could exploit this to
    cause a denial of service (memory exhaustion).

CVE-2022-3564

    A flaw was discovered in the Bluetooh L2CAP subsystem which
    would lead to a use-after-free.  This might be exploitable
    to cause a denial of service (crash or memory corruption) or
    possibly for privilege escalation.

CVE-2022-3565

    A flaw was discovered in the mISDN driver which would lead to a
    use-after-free.  This might be exploitable to cause a denial of
    service (crash or memory corruption) or possibly for privilege
    escalation.

CVE-2022-3594

    Andrew Gaul reported that the r8152 Ethernet driver would log
    excessive numbers of messages in response to network errors.  A
    remote attacker could possibly exploit this to cause a denial of
    service (resource exhaustion).

CVE-2022-3628

    Dokyung Song, Jisoo Jang, and Minsuk Kang reported a potential
    heap-based buffer overflow in the brcmfmac Wi-Fi driver.  A user
    able to connect a malicious USB device could exploit this to cause
    a denial of service (crash or memory corruption) or possibly for
    privilege escalation.

CVE-2022-3640

    A flaw was discovered in the Bluetooh L2CAP subsystem which
    would lead to a use-after-free.  This might be exploitable
    to cause a denial of service (crash or memory corruption) or
    possibly for privilege escalation.

CVE-2022-3643 (XSA-423)

    A flaw was discovered in the Xen network backend driver that would
    result in it generating malformed packet buffers.  If these
    packets were forwarded to certain other network devices, a Xen
    guest could exploit this to cause a denial of service (crash or
    device reset).

CVE-2022-4139

    A flaw was discovered in the i915 graphics driver.  On gen12 "Xe"
    GPUs it failed to flush TLBs when necessary, resulting in GPU
    programs retaining access to freed memory.  A local user with
    access to the GPU could exploit this to leak sensitive
    information, cause a denial of service (crash or memory
    corruption) or likely for privilege escalation.

CVE-2022-4378

    Kyle Zeng found a flaw in procfs that would cause a stack-based
    buffer overflow.  A local user permitted to write to a sysctl
    could use this to cause a denial of service (crash or memory
    corruption) or possibly for privilege escalation.

CVE-2022-41849

    A race condition was discovered in the smscufx graphics driver,
    which could lead to a use-after-free.  A user able to remove the
    physical device while also accessing its device node could exploit
    this to cause a denial of service (crash or memory corruption) or
    possibly for privilege escalation.

CVE-2022-41850

    A race condition was discovered in the hid-roccat input driver,
    which could lead to a use-after-free.  A local user able to access
    such a device could exploit this to cause a denial of service
    (crash or memory corruption) or possibly for privilege escalation.

CVE-2022-42328, CVE-2022-42329 (XSA-424)

    Yang Yingliang reported that the Xen network backend driver did
    not use the proper function to free packet buffers in one case,
    which could lead to a deadlock.  A Xen guest could exploit this to
    cause a denial of service (hang).

CVE-2022-42895

    Tamás Koczka reported a flaw in the Bluetooh L2CAP subsystem
    that would result in reading uninitialised memory.  A nearby
    attacker able to make a Bluetooth connection could exploit
    this to leak sensitive information.

CVE-2022-42896

    Tamás Koczka reported flaws in the Bluetooh L2CAP subsystem that
    can lead to a use-after-free.  A nearby attacker able to make a
    Bluetooth SMP connection could exploit this to cause a denial of
    service (crash or memory corruption) or possibly for remote code
    execution.

CVE-2022-47518, CVE-2022-47519, CVE-2022-47521

    Several flaws were discovered in the wilc1000 Wi-Fi driver which
    could lead to a heap-based buffer overflow.  A nearby attacker
    could exploit these for denial of service (crash or memory
    corruption) or possibly for remote code execution.

CVE-2022-47520

    A flaw was discovered in the wilc1000 Wi-Fi driver which could
    lead to a heap-based buffer overflow.  A local user with
    CAP_NET_ADMIN capability over such a Wi-Fi device could exploit
    this for denial of service (crash or memory corruption) or
    possibly for privilege escalation.

For Debian 10 buster, these problems have been fixed in version
5.10.158-2~deb10u1.

We recommend that you upgrade your linux-5.10 packages.

For the detailed security status of linux-5.10 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux-5.10>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--
Ben Hutchings - Debian developer, member of kernel, installer and LTS
teams

```

**Attachment:
[signature.asc](pgpUHfc88I3cD.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from git.kernel.org_5ad48cb5_20250108_111109.html ===


| [cgit logo](/) | [index](/) : [kernel/git/bluetooth/bluetooth-next.git](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/) | bluetooth-next for-upstream master |
| --- | --- | --- |
| Bluetooth kernel development tree | Bluetooth group |

| [about](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/about/)[summary](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/)[refs](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/refs/?id=89f9f3cb86b1c63badaf392a83dd661d56cc50b1)[log](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/log/)[tree](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/?id=89f9f3cb86b1c63badaf392a83dd661d56cc50b1)[commit](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=89f9f3cb86b1c63badaf392a83dd661d56cc50b1)[diff](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/?id=89f9f3cb86b1c63badaf392a83dd661d56cc50b1)[stats](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maxim Mikityanskiy <maxtram95@gmail.com> | 2022-10-05 00:27:18 +0300 |
| --- | --- | --- |
| committer | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2022-10-04 16:24:09 -0700 |
| commit | [89f9f3cb86b1c63badaf392a83dd661d56cc50b1](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=89f9f3cb86b1c63badaf392a83dd661d56cc50b1) ([patch](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/patch/?id=89f9f3cb86b1c63badaf392a83dd661d56cc50b1)) | |
| tree | [3562082d15568eb809cdf4996c65ead0ce020db1](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/?id=89f9f3cb86b1c63badaf392a83dd661d56cc50b1) | |
| parent | [681bf011b9b5989c6e9db6beb64494918aab9a43](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=681bf011b9b5989c6e9db6beb64494918aab9a43) ([diff](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/?id=89f9f3cb86b1c63badaf392a83dd661d56cc50b1&id2=681bf011b9b5989c6e9db6beb64494918aab9a43)) | |
| download | [bluetooth-next-89f9f3cb86b1c63badaf392a83dd661d56cc50b1.tar.gz](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/snapshot/bluetooth-next-89f9f3cb86b1c63badaf392a83dd661d56cc50b1.tar.gz) | |

Bluetooth: L2CAP: Fix use-after-free caused by l2cap\_reassemble\_sduFix the race condition between the following two flows that run in
parallel:
1. l2cap\_reassemble\_sdu -> chan->ops->recv (l2cap\_sock\_recv\_cb) ->
\_\_sock\_queue\_rcv\_skb.
2. bt\_sock\_recvmsg -> skb\_recv\_datagram, skb\_free\_datagram.
An SKB can be queued by the first flow and immediately dequeued and
freed by the second flow, therefore the callers of l2cap\_reassemble\_sdu
can't use the SKB after that function returns. However, some places
continue accessing struct l2cap\_ctrl that resides in the SKB's CB for a
short time after l2cap\_reassemble\_sdu returns, leading to a
use-after-free condition (the stack trace is below, line numbers for
kernel 5.19.8).
Fix it by keeping a local copy of struct l2cap\_ctrl.
BUG: KASAN: use-after-free in l2cap\_rx\_state\_recv (net/bluetooth/l2cap\_core.c:6906) bluetooth
Read of size 1 at addr ffff88812025f2f0 by task kworker/u17:3/43169
Workqueue: hci0 hci\_rx\_work [bluetooth]
Call Trace:
<TASK>
dump\_stack\_lvl (lib/dump\_stack.c:107 (discriminator 4))
print\_report.cold (mm/kasan/report.c:314 mm/kasan/report.c:429)
? l2cap\_rx\_state\_recv (net/bluetooth/l2cap\_core.c:6906) bluetooth
kasan\_report (mm/kasan/report.c:162 mm/kasan/report.c:493)
? l2cap\_rx\_state\_recv (net/bluetooth/l2cap\_core.c:6906) bluetooth
l2cap\_rx\_state\_recv (net/bluetooth/l2cap\_core.c:6906) bluetooth
l2cap\_rx (net/bluetooth/l2cap\_core.c:7236 net/bluetooth/l2cap\_core.c:7271) bluetooth
ret\_from\_fork (arch/x86/entry/entry\_64.S:306)
</TASK>
Allocated by task 43169:
kasan\_save\_stack (mm/kasan/common.c:39)
\_\_kasan\_slab\_alloc (mm/kasan/common.c:45 mm/kasan/common.c:436 mm/kasan/common.c:469)
kmem\_cache\_alloc\_node (mm/slab.h:750 mm/slub.c:3243 mm/slub.c:3293)
\_\_alloc\_skb (net/core/skbuff.c:414)
l2cap\_recv\_frag (./include/net/bluetooth/bluetooth.h:425 net/bluetooth/l2cap\_core.c:8329) bluetooth
l2cap\_recv\_acldata (net/bluetooth/l2cap\_core.c:8442) bluetooth
hci\_rx\_work (net/bluetooth/hci\_core.c:3642 net/bluetooth/hci\_core.c:3832) bluetooth
process\_one\_work (kernel/workqueue.c:2289)
worker\_thread (./include/linux/list.h:292 kernel/workqueue.c:2437)
kthread (kernel/kthread.c:376)
ret\_from\_fork (arch/x86/entry/entry\_64.S:306)
Freed by task 27920:
kasan\_save\_stack (mm/kasan/common.c:39)
kasan\_set\_track (mm/kasan/common.c:45)
kasan\_set\_free\_info (mm/kasan/generic.c:372)
\_\_\_\_kasan\_slab\_free (mm/kasan/common.c:368 mm/kasan/common.c:328)
slab\_free\_freelist\_hook (mm/slub.c:1780)
kmem\_cache\_free (mm/slub.c:3536 mm/slub.c:3553)
skb\_free\_datagram (./include/net/sock.h:1578 ./include/net/sock.h:1639 net/core/datagram.c:323)
bt\_sock\_recvmsg (net/bluetooth/af\_bluetooth.c:295) bluetooth
l2cap\_sock\_recvmsg (net/bluetooth/l2cap\_sock.c:1212) bluetooth
sock\_read\_iter (net/socket.c:1087)
new\_sync\_read (./include/linux/fs.h:2052 fs/read\_write.c:401)
vfs\_read (fs/read\_write.c:482)
ksys\_read (fs/read\_write.c:620)
do\_syscall\_64 (arch/x86/entry/common.c:50 arch/x86/entry/common.c:80)
entry\_SYSCALL\_64\_after\_hwframe (arch/x86/entry/entry\_64.S:120)
Link: [https://lore.kernel.org/linux-bluetooth/CAKErNvoqga1WcmoR3-0875esY6TVWFQDandbVZncSiuGPBQXLA@mail.gmail.com/T/#u](https://lore.kernel.org/linux-bluetooth/CAKErNvoqga1WcmoR3-0875esY6TVWFQDandbVZncSiuGPBQXLA%40mail.gmail.com/T/#u)
Fixes: d2a7ac5d5d3a ("Bluetooth: Add the ERTM receive state machine")
Fixes: 4b51dae96731 ("Bluetooth: Add streaming mode receive and incoming packet classifier")
Signed-off-by: Maxim Mikityanskiy <maxtram95@gmail.com>
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
[Diffstat](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/?id=89f9f3cb86b1c63badaf392a83dd661d56cc50b1)

| -rw-r--r-- | [net/bluetooth/l2cap\_core.c](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/net/bluetooth/l2cap_core.c?id=89f9f3cb86b1c63badaf392a83dd661d56cc50b1) | 48 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 41 insertions, 7 deletions

| diff --git a/net/bluetooth/l2cap\_core.c b/net/bluetooth/l2cap\_core.cindex 1f34b82ca0ec93..2283871d3f0131 100644--- a/[net/bluetooth/l2cap\_core.c](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/net/bluetooth/l2cap_core.c?id=681bf011b9b5989c6e9db6beb64494918aab9a43)+++ b/[net/bluetooth/l2cap\_core.c](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/net/bluetooth/l2cap_core.c?id=89f9f3cb86b1c63badaf392a83dd661d56cc50b1)@@ -6885,6 +6885,7 @@ static int l2cap\_rx\_state\_recv(struct l2cap\_chan \*chan, struct l2cap\_ctrl \*control, struct sk\_buff \*skb, u8 event) {+ struct l2cap\_ctrl local\_control; int err = 0; bool skb\_in\_use = false; @@ -6909,15 +6910,32 @@ static int l2cap\_rx\_state\_recv(struct l2cap\_chan \*chan, chan->buffer\_seq = chan->expected\_tx\_seq; skb\_in\_use = true; + /\* l2cap\_reassemble\_sdu may free skb, hence invalidate+ \* control, so make a copy in advance to use it after+ \* l2cap\_reassemble\_sdu returns and to avoid the race+ \* condition, for example:+ \*+ \* The current thread calls:+ \* l2cap\_reassemble\_sdu+ \* chan->ops->recv == l2cap\_sock\_recv\_cb+ \* \_\_sock\_queue\_rcv\_skb+ \* Another thread calls:+ \* bt\_sock\_recvmsg+ \* skb\_recv\_datagram+ \* skb\_free\_datagram+ \* Then the current thread tries to access control, but+ \* it was freed by skb\_free\_datagram.+ \*/+ local\_control = \*control; err = l2cap\_reassemble\_sdu(chan, skb, control); if (err) break; - if (control->final) {+ if (local\_control.final) { if (!test\_and\_clear\_bit(CONN\_REJ\_ACT, &chan->conn\_state)) {- control->final = 0;- l2cap\_retransmit\_all(chan, control);+ local\_control.final = 0;+ l2cap\_retransmit\_all(chan, &local\_control); l2cap\_ertm\_send(chan); } }@@ -7297,11 +7315,27 @@ static int l2cap\_rx(struct l2cap\_chan \*chan, struct l2cap\_ctrl \*control, static int l2cap\_stream\_rx(struct l2cap\_chan \*chan, struct l2cap\_ctrl \*control, struct sk\_buff \*skb) {+ /\* l2cap\_reassemble\_sdu may free skb, hence invalidate control, so store+ \* the txseq field in advance to use it after l2cap\_reassemble\_sdu+ \* returns and to avoid the race condition, for example:+ \*+ \* The current thread calls:+ \* l2cap\_reassemble\_sdu+ \* chan->ops->recv == l2cap\_sock\_recv\_cb+ \* \_\_sock\_queue\_rcv\_skb+ \* Another thread calls:+ \* bt\_sock\_recvmsg+ \* skb\_recv\_datagram+ \* skb\_free\_datagram+ \* Then the current thread tries to access control, but it was freed by+ \* skb\_free\_datagram.+ \*/+ u16 txseq = control->txseq;+ BT\_DBG("chan %p, control %p, skb %p, state %d", chan, control, skb, chan->rx\_state); - if (l2cap\_classify\_txseq(chan, control->txseq) ==- L2CAP\_TXSEQ\_EXPECTED) {+ if (l2cap\_classify\_txseq(chan, txseq) == L2CAP\_TXSEQ\_EXPECTED) { l2cap\_pass\_to\_tx(chan, control);  BT\_DBG("buffer\_seq %u->%u", chan->buffer\_seq,@@ -7324,8 +7358,8 @@ static int l2cap\_stream\_rx(struct l2cap\_chan \*chan, struct l2cap\_ctrl \*control, } } - chan->last\_acked\_seq = control->txseq;- chan->expected\_tx\_seq = \_\_next\_seq(chan, control->txseq);+ chan->last\_acked\_seq = txseq;+ chan->expected\_tx\_seq = \_\_next\_seq(chan, txseq);  return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-08 11:09:46 +0000



=== Content from vuldb.com_71a26e1a_20250108_111110.html ===
![VulDB](/_thm/vuldb.png)

* Home
  + Overview
  + [Live Recent](?live.recent)
  + [Live Updates](?live.updates)
  + [Live Archive](?live.archive)
  + [Live Submits](?live.submits)
* [Entries](?recent)
  + [Recent](?recent)
  + [Updates](?updates)
  + [Commits](?commits)
  + [Archive](?archive)
  + [CNA](?cna)
  + [Stats](?stats)
  + [Submits](?submits)
  + [Add](?id.add)
* [Products](?product)
  + [Vendor](?vendor)
  + [Product](?product)
  + [Type](?type)
* [Risk](?cvssv3)
  + [CVSSv4](?cvssv4)
  + [CVSSv3](?cvssv3)
  + [CVSSv2](?cvssv2)
  + [Risks](?risk)
  + [Exploits](?exploits)
* [Threat](?cti)
  + [Analysis](?cti.analyze)
  + [Activities](?activities)
  + [Events](?events)
  + [Actors](?actor)
  + [IP addresses](?ip)
  + [Country](?country)
  + [Sector](?sector)
  + [Exploit Prices](?exploitprices)
* [References](?references)
  + [References](?references)
  + [Tools](?tools)
  + [Videos](?videos)
  + [Google Hacking](?googlehacking)
  + [Exports](?export)
* [Search](?search)

  + [Search](?search)
  + [Advanced Search](?search.advanced)
  + [User](?user)
  + [Feeds](?feeds)
  + [API](?kb.api)
* [Support](?kb)
  + [Knowledge Base](?kb)
  + [FAQ](?kb.faq)
  + [Changelog](?kb.changelog)
  + [Roadmap](?kb.roadmap)
  + [Status](?status)
  + [Contact](?contact)
* [Login](?login)
  + [Login](?login)
  + [Signup](?signup)
  + [Purchase](?pay)
  + [Terms of Use](?kb.terms)

* [History](?history.211087)
* [Diff](?diff.211087)
* [Relate](?relate.211087)
* [API JSON](?json.211087)
* [API XML](?xml.211087)
* [Add](?id.add)
* [Purchase](?pay)

[Login](?login)[Signup](?signup)[VDB-211087](?id.211087 "VulDB") · [CVE-2022-3564](?source_cve.211087 "Cve")
# Linux Kernel Bluetooth l2cap\_core.c l2cap\_reassemble\_sdu use after free

[History](?history.211087)[Diff](?diff.211087)[relate](?relate.211087)[json](?login)[xml](?login)[CTI](?ctiid.211087)![Linux](/logos/linux.jpg)

| CVSS Meta Temp ScoreCVSS is a standardized scoring system to determine possibilities of attacks. The Temp Score considers temporal factors like disclosure, exploit and countermeasures. The unique Meta Score calculates the average score of different sources to provide a normalized scoring system. | Current Exploit Price (≈)Our analysts are monitoring exploit markets and are in contact with vulnerability brokers. The range indicates the observed or calculated exploit price to be seen on exploit markets. A good indicator to understand the monetary effort required for and the popularity of an attack. | CTI Interest ScoreOur Cyber Threat Intelligence team is monitoring different web sites, mailing lists, exploit markets and social media networks. The CTI Interest Score identifies the interest of attackers and the security community for this specific vulnerability in real-time. A high score indicates an elevated risk to be targeted for this vulnerability. |
| --- | --- | --- |
| 6.3 | $0-$5k | 0.12 |

A vulnerability classified as critical was found in [Linux Kernel](?product.linux:kernel) ([Operating System](?type.operating_system)) ([affected version not known](?kb.version)). Affected by this vulnerability is the function `l2cap_reassemble_sdu` of the file *net/bluetooth/l2cap\_core.c* of the component *Bluetooth*. The manipulation with an unknown input leads to a use after free vulnerability. The CWE definition for the vulnerability is [CWE-416](?vulnerability_cwe.211087 "Cwe"). Referencing memory after it has been freed can cause a program to crash, use unexpected values, or execute code. As an impact it is known to affect confidentiality, integrity, and availability.

The weakness was disclosed 10/17/2022. It is possible to read the advisory at [git.kernel.org](?advisory_url.211087). This vulnerability is known as [CVE-2022-3564](?source_cve.211087 "Cve"). Technical details of the vulnerability are known, but there is no available exploit. The pricing for an exploit might be around USD $0-$5k at the moment ([estimation calculated on 11/09/2022](?kb.exploitprices)).

Applying a patch is able to eliminate this problem. The bugfix is ready for download at [git.kernel.org](?countermeasure_patch_url.211087).

The entries [VDB-211918](?id.211918), [VDB-211944](?id.211944), [VDB-214262](?id.214262) and [VDB-214423](?id.214423) are pretty similar.

## Product[info](?kb.cpe)

**Type**

* [Operating System](?type.operating_system)

**Vendor**

* [Linux](?vendor.linux)

**Name**

* [Kernel](?product.linux:kernel)

**License**

* [open-source](?kb.softwarelicense)

## CPE 2.3[info](?kb.cpe)

* [🔍](?pay)
* [🔍](?pay)

## CPE 2.2[info](?kb.cpe)

* [🔍](?pay)
* [🔍](?pay)

## CVSSv4[info](?kb.cvss)

VulDB CVSS-B Score: [🔍](?pay)
VulDB CVSS-BT Score: [🔍](?pay)
VulDB Vector: [🔍](?pay)
VulDB Reliability: [🔍](?pay)
## CVSSv3[info](?kb.cvss)

VulDB Meta Base Score: 6.3
VulDB Meta Temp Score: 6.3

VulDB Base Score: [5.5](https://www.first.org/cvss/v3.1/specification-document#Base-Metrics)
VulDB Temp Score: [5.3](https://www.first.org/cvss/v3.1/specification-document#Temporal-Metrics)
VulDB Vector: [🔍](?pay)
VulDB Reliability: [🔍](?pay)

NVD Base Score: [8.0](?source_nvd.211087)
NVD Vector: [🔍](?pay)

CNA Base Score: [5.5](?source_nvd.211087)
CNA Vector (VulDB): [🔍](?pay)
## CVSSv2[info](?kb.cvss)

[| AV | AC | Au | C | I | A |
| --- | --- | --- | --- | --- | --- |
| 💳 | 💳 | 💳 | 💳 | 💳 | 💳 |
| 💳 | 💳 | 💳 | 💳 | 💳 | 💳 |
| 💳 | 💳 | 💳 | 💳 | 💳 | 💳 |

| Vector | Complexity | Authentication | Confidentiality | Integrity | Availability |
| --- | --- | --- | --- | --- | --- |
| unlock | unlock | unlock | unlock | unlock | unlock |
| unlock | unlock | unlock | unlock | unlock | unlock |
| unlock | unlock | unlock | unlock | unlock | unlock |](?pay)
VulDB Base Score: [🔍](?pay)
VulDB Temp Score: [🔍](?pay)
VulDB Reliability: [🔍](?pay)
## Exploiting[info](?kb.exploitprices)

Class: Use after free
CWE: [CWE-416 / CWE-119](?vulnerability_cwe.211087 "Cwe")
CAPEC: [🔍](?pay)
ATT&CK: [🔍](?pay)

Local: No
Remote: Partially

Availability: [🔍](?pay)
Status: Not defined

EPSS Score: [🔍](?pay)
EPSS Percentile: [🔍](?pay)

Price Prediction: [🔍](?pay)
Current Price Estimation: [🔍](?pay)
 [| 0-Day | unlock | unlock | unlock | unlock |
| --- | --- | --- | --- | --- |
| Today | unlock | unlock | unlock | unlock |](?pay)
## Threat Intelligence[info](?kb.cti)

Interest: [🔍](?pay)
Active Actors: [🔍](?pay)
Active APT Groups: [🔍](?pay)
## Countermeasures[info](?kb.countermeasures)

Recommended: Patch
Status: [🔍](?pay)

0-Day Time: [🔍](?pay)

Patch: [git.kernel.org](?countermeasure_patch_url.211087)
## Timeline[info](?kb.timelines)

10/17/2022   [🔍](?pay)
10/17/2022  +0 days [🔍](?pay)
10/17/2022  +0 days [🔍](?pay)
11/09/2022  +23 days [🔍](?pay)
## Sources[info](?kb.sources)

Vendor: [kernel.org](https://www.kernel.org/)

Advisory: [git.kernel.org](?advisory_url.211087 "Advisory")
Status: Confirmed

CVE: [CVE-2022-3564](?source_cve.211087 "Cve") ([🔍](?pay))
See also: [🔍](?pay)
## Entry[info](?kb.moderation)

Created: 10/17/2022 07:45 PM
Updated: 11/09/2022 11:28 PM
Changes: [10/17/2022 07:45 PM (41), 11/09/2022 11:18 PM (2), 11/09/2022 11:28 PM (21)](?diff.211087)
Complete: [🔍](?pay)
Cache ID: 109:10C:111
## Discussion

No comments yet. Languages: en.

[Please log in to comment.](?login)

[◂ Previous](?id.211086)[Overview](?live.recent)[Next ▸](?id.211088)

# Do you need the next level of professionalism?

Upgrade your account now!

[© 1997-2025 vuldb.com](?kb.terms) · [cc by-nc-sa](https://creativecommons.org/licenses/by-nc-sa/4.0/)[de](/de/?id.211087 "German") · [fr](/fr/?id.211087 "French") · [it](/it/?id.211087 "Italian") · [es](/es/?id.211087 "Spanish") · [pt](/pt/?id.211087 "Portuguese") · [ru](/ru/?id.211087 "Russian") · [pl](/pl/?id.211087 "Polish") · [sv](/sv/?id.211087 "Swedish") · [zh](/zh/?id.211087 "Chinese") · [ja](/ja/?id.211087 "Japanese") · [ar](/ar/?id.211087 "Arabic")[v18.14.7](?kb.changelog)
