```json
[
  {
    "ID": "CVE-2022-2586",
    "Content": "The netfilter subsystem of the Linux kernel did not prevent one nft object from referencing an nft set in another nft table, leading to a use-after-free vulnerability. A local attacker could use this to cause a denial of service (system crash) or execute arbitrary code.",
    "Root cause": "The vulnerability arises because the netfilter subsystem allows an nft object or expression to reference an nft set in a different nft table. When the referenced table is deleted, a use-after-free condition occurs due to the dangling reference.",
    "Weaknesses": [
      "Use-after-free vulnerability",
       "Cross-table references in netfilter"
    ],
    "Impact": "A local attacker can exploit this vulnerability to cause a denial of service (system crash) or potentially execute arbitrary code with root privileges.",
    "Attack vectors": "Local exploitation by crafting malicious nft rules that create cross-table references",
    "Required attacker capabilities": "The attacker must have the capability to execute low-privileged code on the target system and possess `CAP_NET_ADMIN` privileges in any user or network namespace."
  },
  {
      "ID": "CVE-2022-2586",
      "Content": "When doing lookups for sets on the same batch by using its ID, a set from a\ndifferent table can be used.\n\nThen, when the table is removed, a reference to the set may be kept after\nthe set is freed, leading to a potential use-after-free.\n\nWhen looking for sets by ID, use the table that was used for the lookup by\nname, and only return sets belonging to that same table.\n\nThis fixes CVE-2022-2586, also reported as ZDI-CAN-17470.",
    "Root cause": "The vulnerability stems from the ability to use an ID to look up sets across different tables. When a table is removed, the reference to a set from another table can persist, causing a use-after-free.",
    "Weaknesses": [
      "Use-after-free",
      "Lack of proper table scoping during set lookups"
     ],
    "Impact": "A use-after-free vulnerability can occur, potentially leading to a denial of service or arbitrary code execution.",
    "Attack vectors": "Local exploitation by crafting netfilter rules that manipulate sets across different tables.",
    "Required attacker capabilities": "Attacker needs to be able to create or manipulate nft rules."
  },
    {
      "ID": "CVE-2022-2586",
      "Content": "When doing lookups for chains on the same batch by using its ID, a chain\nfrom a different table can be used. If a rule is added to a table but\nrefers to a chain in a different table, it will be linked to the chain in\ntable2, but would have expressions referring to objects in table1.\n\nThen, when table1 is removed, the rule will not be removed as its linked to\na chain in table2. When expressions in the rule are processed or removed,\nthat will lead to a use-after-free.\n\nWhen looking for chains by ID, use the table that was used for the lookup\nby name, and only return chains belonging to that same table.",
      "Root cause": "The vulnerability occurs because chain IDs can be used across different tables. When a rule in one table refers to a chain in another table, and the first table is removed, a use-after-free condition can occur when expressions in the rule are processed or removed.",
      "Weaknesses": [
          "Use-after-free",
          "Lack of proper table scoping during chain lookups"
      ],
      "Impact": "A use-after-free vulnerability, leading to potential denial of service or arbitrary code execution.",
      "Attack vectors": "Local exploitation by creating and manipulating netfilter rules with references to chains in different tables.",
      "Required attacker capabilities":"Attacker needs to have the ability to create or manipulate nft rules."
    },
    {
      "ID": "CVE-2022-2586",
      "Content": "When doing lookups for rules on the same batch by using its ID, a rule from\na different chain can be used. If a rule is added to a chain but tries to\nbe positioned next to a rule from a different chain, it will be linked to\nchain2, but the use counter on chain1 would be the one to be incremented.\n\nWhen looking for rules by ID, use the chain that was used for the lookup by\nname. The chain used in the context copied to the transaction needs to\nmatch that same chain. That way, struct nft_rule does not need to get\nenlarged with another member.",
     "Root cause": "The vulnerability arises when rules from different chains are mixed using IDs. When a rule is positioned next to a rule from another chain, it can lead to inconsistencies. Specifically, it gets linked to chain2 while the use counter of chain1 is incremented",
      "Weaknesses": [
          "Incorrect rule positioning logic",
           "Lack of proper chain scoping during rule lookups"
      ],
      "Impact": "Use-after-free condition may occur due to incorrect reference counting of rules. This could lead to a denial of service (system crash) or possibly arbitrary code execution.",
      "Attack vectors": "Local exploitation by manipulating netfilter rules with specific ID positioning.",
      "Required attacker capabilities": "Attacker needs the ability to create or manipulate nft rules."
  },
  {
    "ID": "CVE-2022-2586",
    "Content": "It was discovered that a nft object or expression could reference a nft set on a different nft table, leading to a use-after-free once that table was deleted.",
    "Root cause": "Improper handling of references between nft objects and sets across different tables. When a table is deleted, references to its sets may still be held in other tables, leading to use-after-free.",
    "Weaknesses": [
      "Use-after-free"
    ],
    "Impact": "Denial of service (system crash) or arbitrary code execution by local attacker",
    "Attack vectors": "Crafting malicious nft rules that create cross-table references.",
    "Required attacker capabilities": "Local access with the ability to create and manipulate nft rules"
  },
  {
    "ID": "CVE-2022-2586",
      "Content": "This vulnerability allows local attackers to escalate privileges on affected installations of Linux Kernel. An attacker must first obtain the ability to execute low-privileged code on the target system in order to exploit this vulnerability.  The specific flaw exists within the handling of nft\\_objects. The issue results from the lack of validating the existence of an object prior to performing operations on the object. An attacker can leverage this vulnerability to escalate privileges and execute arbitrary code in the context of root.",
     "Root cause": "The vulnerability exists because the kernel does not properly validate the existence of an nft_object before operating on it. This lack of validation allows an attacker to manipulate objects in ways that lead to a use-after-free.",
    "Weaknesses": [
      "Use-after-free",
        "Insufficient input validation"
    ],
    "Impact": "Local privilege escalation, leading to arbitrary code execution in the context of root.",
    "Attack vectors": "Local exploitation via crafted network filtering rules using the netfilter subsystem.",
    "Required attacker capabilities": "Ability to execute low-privileged code on the target system."
    }
]
```