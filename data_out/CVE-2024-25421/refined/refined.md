### CVE-2024-25421

**Root cause of vulnerability:**
The vulnerability stems from the way Openfire handles user deletions in group chats. When a user is added to a group chat, their affiliation and related data are stored in the cache. However, when the user is deleted, the cache is not updated to reflect this change.

**Weaknesses/vulnerabilities present:**
- Improper access control: The system fails to revoke group chat privileges from the cache upon user deletion.
- Inadequate cache management: The cache is not refreshed or updated after a user is deleted. The cache entries related to group chat affiliations of deleted users remain active until the server restarts.

**Impact of exploitation:**
- Privilege escalation: A new user created with the same username as a deleted user can gain access to the group chat with the same level of privileges as the deleted user.
- Unauthorized access: The new user can view previous messages and perform actions corresponding to the deleted user's role within the chat (e.g., admin or owner privileges).

**Attack vectors:**
- User registration: Attackers can create a new user using the same username as a deleted user, leveraging the outdated cache information.
- Group chat access: Attackers can gain unauthorized access to group chats by exploiting the improper handling of deleted users in the cache.

**Required attacker capabilities/position:**
- Ability to create user accounts: The attacker must be able to register new users with usernames identical to previously deleted users.
- Knowledge of deleted usernames: The attacker needs to know or guess usernames of previously deleted users who had group chat access. This can be gathered through OSINT or internal knowledge.