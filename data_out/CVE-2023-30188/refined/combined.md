=== Content from github.com_6335906f_20250110_171130.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FONLYOFFICE%2Fcore%2Ftree%2F8ca40a44ce47a86168327a46db91253cf6bb205d%2FDesktopEditor%2Fdoctrenderer)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FONLYOFFICE%2Fcore%2Ftree%2F8ca40a44ce47a86168327a46db91253cf6bb205d%2FDesktopEditor%2Fdoctrenderer)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=ONLYOFFICE%2Fcore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ONLYOFFICE](/ONLYOFFICE)
/
**[core](/ONLYOFFICE/core)**
Public

* [Notifications](/login?return_to=%2FONLYOFFICE%2Fcore) You must be signed in to change notification settings
* [Fork
  226](/login?return_to=%2FONLYOFFICE%2Fcore)
* [Star
   294](/login?return_to=%2FONLYOFFICE%2Fcore)

* [Code](/ONLYOFFICE/core)
* [Pull requests
  11](/ONLYOFFICE/core/pulls)
* [Actions](/ONLYOFFICE/core/actions)
* [Security](/ONLYOFFICE/core/security)
* [Insights](/ONLYOFFICE/core/pulse)

Additional navigation options

* [Code](/ONLYOFFICE/core)
* [Pull requests](/ONLYOFFICE/core/pulls)
* [Actions](/ONLYOFFICE/core/actions)
* [Security](/ONLYOFFICE/core/security)
* [Insights](/ONLYOFFICE/core/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from onlyoffice.com_67dd555f_20250110_171128.html ===


Get free mobile app

[Get it now](/)

This website uses cookies

By continuing to browse the website you agree to our
[privacy policy](https://help.onlyoffice.co/products/files/doceditor.aspx?fileid=5048502&doc=SXhWMEVzSEYxNlVVaXJJeUVtS0kyYk14YWdXTEFUQmRWL250NllHNUFGbz0_IjUwNDg1MDIi0&_ga=2.239950403.1196593722.1525950411-169631771.1404734630).

Got it!

[ONLYOFFICE DocSpace 3.0 released: Updated user types•Virtual Data rooms•OAuth2.0•improved room & file management•and more](https://www.onlyoffice.com/blog/2024/11/onlyoffice-docspace-3-0-released)

[ONLYOFFICE DocSpace 3.0 released](https://www.onlyoffice.com/blog/2024/11/onlyoffice-docspace-3-0-released)

* Products
  + ONLYOFFICE DocSpace

    ONLYOFFICE Docs

    Other products
  + ONLYOFFICE DocSpace
    ONLYOFFICE DocSpace
    [What is ONLYOFFICE DocSpace](/docspace.aspx)

    Document editors integrated into secure room-based DMS

    [Document editors](/office-suite.aspx)

    [Collaboration rooms](/collaboration-rooms.aspx)
    [Meeting rooms](/office-for-zoom.aspx)
    [Public rooms](/public-rooms.aspx)
    [Custom rooms](/custom-rooms.aspx)
    [Form Filling rooms](/form-filling-rooms.aspx)
    [Virtual data rooms](/virtual-data-rooms.aspx)

    [DocSpace connectors](/all-connectors.aspx)

    ONLYOFFICE Docs
    ONLYOFFICE Docs
    [What is ONLYOFFICE Docs](/office-suite.aspx)

    Document editors to integrate into your business platform

    [Document Editor](/document-editor.aspx?docs=download)
    [Spreadsheet Editor](/spreadsheet-editor.aspx?docs=download)
    [Presentation Editor](/presentation-editor.aspx?docs=download)
    [PDF Editor](/pdf-editor.aspx?docs=download)
    [Form creator](/form-creator.aspx?docs=download)
    [E-book creator](/e-book.aspx?docs=download)
    [Collaboration features](/seamless-collaboration.aspx?docs=download)

    [Docs connectors](/all-connectors.aspx)

    Other products
    Other products
    [ONLYOFFICE Desktop Editors](/desktop.aspx)

    Free desktop apps for Windows, Linux, macOS

    ONLYOFFICE Documents

    Free mobile apps for Android and iOS

    [ONLYOFFICE Workspace](/workspace.aspx)

    Business platform to manage your team activities

    [Online converters](/online-document-converter.aspx)

    For docs, sheets, slides, PDFs
  + [Templates](https://templates.onlyoffice.com/)
    [Marketplace](http://www.onlyoffice.com/app-directory)
    [Security](/security.aspx)
    [AI assistant](/ai-assistants.aspx)
    [Accessibility](/accessibility.aspx)
    [Sustainability](https://www.onlyoffice.com/blog/2024/06/eco-friendly)
* Enterprise
  + Docs Enterprise
    [Why Docs Enterprise](/docs-enterprise.aspx)
    [Pricing](/docs-enterprise-prices.aspx)
    [Get it now](/download.aspx#docs-enterprise)
  + DocSpace Enterprise
    [Why DocSpace Enterprise](/docspace-enterprise.aspx)
    [Pricing](/docspace-prices.aspx)
    [Get it now](/download.aspx#docspace-enterprise)
  + Contact sales
    [Request demo](/demo-order.aspx)
* Developers
  + [All solutions](/for-developers.aspx)
    [Why Docs Developer](/developer-edition.aspx)
    - [Automation API](/automation-api.aspx)
    - [Conversion API](/conversion-api.aspx)
    - [Document Builder](/document-builder.aspx)[Pricing](/developer-edition-prices.aspx)
    [Launch demo](/see-it-in-action.aspx?developer=edition)
    [Get it now](/download-developer.aspx?from=downloadintegrationmenu#docs-developer)
  + DocSpace Developer
    [Why DocSpace Developer](/docspace-developer.aspx)
    [Pricing](/docspace-developer-prices.aspx)
    [Get it now](/download-developer.aspx#docspace-developer)
  + [API Docs](https://api.onlyoffice.com/)
    Contact sales
* Pricing
  + For business
    [DocSpace](/docspace-prices.aspx)
    [Docs Enterprise](/docs-enterprise-prices.aspx)
    [Workspace](/workspace-prices.aspx)

    For developers
    [Docs Developer](/developer-edition-prices.aspx)
    [DocSpace Developer](/docspace-developer-prices.aspx)
    For home use
    [Docs Home Server](/docs-home-server.aspx)
    [DocSpace Family Pack](/docspace-family-pack.aspx)
  + [Buy from an ONLYOFFICE reseller](/find-partners.aspx)
    [Find out the list of all the authorized ONLYOFFICE resellers in your area](/find-partners.aspx)
  + Contact sales
* Partners
  + [Resellers](/resellers.aspx)
    [Affiliates](/affiliates.aspx)
    [Hosting providers](/hosting-providers.aspx)
    [Technology partners](/technology-partners.aspx)
    [Find partners](/find-partners.aspx)
    [Submit request](/partnership-request.aspx)
  + [Events](/events.aspx)

    Meet the ONLYOFFICE team
* Resources
  + About us
    [Company](/about.aspx)
    [Customers](/customers.aspx)
    [Success stories](/customers.aspx#stories)
    [Awards](/awards.aspx)
    [Certificates](/certificates.aspx)
    [Events](/events.aspx)
    [Press downloads](/press-downloads.aspx)
    [Gift shop](https://shop.spreadshirt.com/onlyoffice)
    [Contacts](/contacts.aspx)
  + Collaborate
    [For contributors](/contribute.aspx)
    [For translators](https://helpcenter.onlyoffice.com/guides/become-translator.aspx)
    [For influencers](/influencer-program.aspx)
    [Vacancies](/vacancies.aspx)

    Get help
    [Forum](https://forum.onlyoffice.com/)
    [Help Center](https://helpcenter.onlyoffice.com/index.aspx)
    [Training courses](/training-courses.aspx)
    [Webinars](/webinars.aspx)
    [White papers](/whitepapers.aspx)
  + [Blog](http://www.onlyoffice.com/blog/)
    [ONLYOFFICE DocSpace 3.0 released: updated user types, Virtual Data rooms, OAuth2.0, improved room & file management, and more

    25 November 2024](https://www.onlyoffice.com/blog/2024/11/onlyoffice-docspace-3-0-released)
    [ONLYOFFICE Docs 8.2 released: PDF collaborative editing, revamped interface, optimized performance, and more

    17 October 2024](https://www.onlyoffice.com/blog/2024/10/onlyoffice-docs-8-2-released)
* Download
  + [Enterprise servers](/download.aspx)

    Docs and DocSpace for businesses’ internal use

    [Developer servers](/download-developer.aspx)

    Docs and DocSpace for sale to customers under your brand

    [Desktop and mobiles apps](/download-desktop.aspx)

    Linux, Windows, macOS, Android, iOS
* Log in / Sign up
  + [DocSpace](/docspace-signin.aspx)

    Document editors & storage

    [Docs](/docs-registration.aspx)

    Document editors only

Download

* Download
  [Enterprise servers](/download.aspx)

  Docs and DocSpace for businesses’ internal use

  [Developer servers](/download-developer.aspx)

  Docs and DocSpace for sale to customers under your brand

  [Desktop and mobiles apps](/download-desktop.aspx)

  Linux, Windows, macOS, Android, iOS

Log in  Sign up

* Log in / Sign up
  [DocSpace](/docspace-registration.aspx)

  Document editors & storage

  [Docs](/docs-registration.aspx)

  Document editors only

Search on site

* Ascensio System SIA
  Phone: +1 (972) 301-8440Phone: +371 63399867Phone: +371 633 998 67Phone: +371 633 99 867Phone: +44 20 3287 1086
  [Request a call](/call-back-form.aspx)

+1 (972) 301-8440
+371 633 998 67
+371 633 998 67
+371 633 99 867
+44 20 3287 1086

# Run your private office with the ONLYOFFICE

[Get it now](/download.aspx?from=default#docs-enterprise)
[See it in action](/docspace-registration.aspx?from=default)

## ONLYOFFICE Docs, the most complete office suite

View, edit, and collaborate on [docs](/document-editor.aspx), [sheets](/spreadsheet-editor.aspx), [slides](/presentation-editor.aspx)
Build fillable [PDF forms](/form-creator.aspx) and fill them in online
Read and edit [PDFs](/pdf-editor.aspx), export/import to/from PDF
Convert docs to Markdown and HTML
Turn your textbooks into [e-books](/e-book.aspx)

View, edit, and collaborate on [docs](/document-editor.aspx), [sheets](/spreadsheet-editor.aspx), [slides](/presentation-editor.aspx)

Build fillable [PDF forms](/form-creator.aspx) and fill them in online

Read and edit [PDFs](/pdf-editor.aspx), export/import to/from PDF

Convert docs to Markdown and HTML

Turn your textbooks into [e-books](/e-book.aspx)

[Learn more about ONLYOFFICE Docs features](/office-suite.aspx)

## Designed to make collaboration seamless

Share your docs for viewing, editing, reviewing, commenting, or filling forms
Make use of character- and paragraph-level co-editing modes
Compare and review docs and track changes
Leave comments and mentions
Communicate via built-in chat or Telegram
Make audio and video calls with Jitsi or Rainbow

Share your docs for viewing, editing, reviewing, commenting, or filling forms

Make use of character- and paragraph-level co-editing modes

Compare and review docs and track changes

Leave comments and mentions

Communicate via built-in chat or Telegram

Make audio and video calls with Jitsi or Rainbow

[Learn more about ONLYOFFICE collaboration features](/seamless-collaboration.aspx)

## Security first

Open-source code available on GitHub
Compliance with international security standards
Three levels of encryption: at rest, in transit, end-to-end
Secure access and monitoring tools
Extra document permissions

[Learn more about ONLYOFFICE security features](/security.aspx)

## Get started and choose where to work

### In ONLYOFFICE DocSpace

Create rooms within your secure DocSpace, invite people, view, edit, and collaborate on all kinds of documents from any desktop or mobile device.
[Start with your free account](/docspace-registration.aspx)

### In the platform you use

Connect Docs to edit documents directly from your app. [40+ ready integrations](/all-connectors.aspx): Box, Moodle, Nextcloud, Odoo, Wordpress, etc.
[Get Docs now](/download.aspx#docs-enterprise)

### In the platform you build

Integrate Docs into your service to provide powerful document-editing and building capabilities to your customers under your brand.
[Learn more](/developer-edition.aspx)

### From your PC

Edit docs offline with free office apps for Windows, Linux, and macOS
[Download now](/download-desktop.aspx)

### From your mobile devices

Work on documents on the go with free apps for iOS and Android devices
[Install now](/download-desktop.aspx#mobile)

### Trusted by more than 15 million users worldwide

[More customers](/customers.aspx?from=default)

[#### How Kinderhaus Berlin shares and collaborates on sensitive files with ONLYOFFICE DocSpace](https://www.onlyoffice.com/blog/2023/11/how-kinderhaus-berlin-is-using-onlyoffice-docspace)

[#### Why the Guará Linux team chooses ONLYOFFICE Desktop Editors as the default office suite for 22.000 employees of the Military Police of Minas Gerais](https://www.onlyoffice.com/blog/2024/07/onlyoffice-desktop-editors-on-guara-linux)

[#### How Czech TV replaced Google Docs and MS Office with ONLYOFFICE and ownCloud](https://www.onlyoffice.com/blog/2021/04/how-czech-tv-replaced-google-docs-and-ms-office-with-onlyoffice-and-owncloud/)

[#### How SWITCH integrated ONLYOFFICE into SWITCHdrive to create a complete alternative to Office 365](https://www.onlyoffice.com/blog/2021/02/how-switch-integrated-onlyoffice-into-switchdrive-to-create-a-complete-alternative-to-office-365/)

[#### The City of Hopewell, Virginia: enabling remote work for 500 government employees with ONLYOFFICE](https://www.onlyoffice.com/blog/2020/06/onlyoffice-in-the-city-of-hopewell/)

[#### How Calar Alto Observatory implements ONLYOFFICE for secure & location-independent collaboration](https://www.onlyoffice.com/blog/2022/06/how-calar-alto-observatory-implements-onlyoffice/)

[More success stories](/customers.aspx?from=default)

## Highly rated by both critics and users

[Slashdot Leader Winter 2024](https://slashdot.org/software/p/ONLYOFFICE/)
[Top 20 Document Management Software](https://www.capterra.com/document-management-software/#top-20)
[Office Suites High Performer Fall 2023](https://www.g2.com/products/onlyoffice/reviews?utm_source=rewards-badge)
[GOLD in the Cloud Content Management 2024](https://www.cloudcomputing-insider.de/it-awards-2024-gewinner-a-0eff7f083cda3aea4c1b8c23ef107b60/)
[Top rated office suites](https://omr.com/de/reviews/product/onlyoffice)
[SourceForge Leader Winter 2024](https://sourceforge.net/software/product/ONLYOFFICE/)

4.5 / 5

4.5 / 5

4.5 / 5

4.4 / 5

5.0 / 5

4.5 / 5

4.0 / 5

4.4 / 5

## Stay up-to-date with the latest from ONLYOFFICE

###### [Blog](https://www.onlyoffice.com/blog/)

[More news here](https://www.onlyoffice.com/blog/)

###### [YouTube](https://www.youtube.com/user/onlyofficeTV)

[More videos here](https://www.youtube.com/user/onlyofficeTV)

###### [Events](/events.aspx?from=default)

[More events here](/events.aspx?from=default)

Frequently Asked Questions
Get answers to the most popular questions about ONLYOFFICE

* **Is ONLYOFFICE really free?**

  Yes, it is. ONLYOFFICE is a free and open-source office suite distributed under the AGPL 3.0 license. The source code repositories are available on [GitHub](https://github.com/ONLYOFFICE).

   Besides, we offer a range of free solutions that you can choose from based on your needs. These include absolutely [free desktop editors](/desktop.aspx) for Windows/Linux/macOS, [free mobile apps](/download-desktop.aspx#mobile) for iOS/Android, [the free Startup plan](/docspace-registration.aspx) of ONLYOFFICE DocSpace Cloud.

   Free community builds of ONLYOFFICE solutions for self-hosting can be found [here](/download-community.aspx).
* **What is ONLYOFFICE used for?**

  ONLYOFFICE provides [a full range of tools](/office-suite.aspx) to create, edit and collaborate on text documents, spreadsheets, presentations, PDF forms and regular PDF files on web, desktop and mobile platforms.

   You can use the online editors [within any business platform](/all-connectors.aspx) or opt for the room-based content collaboration platform [ONLYOFFICE DocSpace](/docspace.aspx) which already comes with the integrated editors. Besides, you are able to [embed](/developer-edition.aspx) the editors into your own web app.

   [Desktop editors](/desktop.aspx) for working with office documents offline, as well as [mobile apps](/download-desktop.aspx#mobile) are also available.
* **Is ONLYOFFICE safe to use?**

  Yes, it is. We [prioritize security](/security.aspx) with robust measures. ONLYOFFICE is open-source and GDPR compliant – which means it fits all the legal criteria for data protection. ONLYOFFICE includes file encryption and multiple options for secure sharing and access control. Besides, our solutions can be deployed on private servers.
* **Can I use ONLYOFFICE offline?**

  Yes, you can. To do so, download the free [ONLYOFFICE Desktop Editors](/download-desktop.aspx#desktop) which is available for Windows, Linux, and macOS.
* **Does ONLYOFFICE have ads?**

  No, ONLYOFFICE is ad-free. We don't incorporate any external ads into our solutions.

Get free apps

[For Windows](/download-desktop.aspx)
[For Linux](/download-desktop.aspx)
[For macOS](/download-desktop.aspx)
[For Android](/download-desktop.aspx#mobile)
[For iOS](/download-desktop.aspx#mobile)

###### Templates

[PDF form templates](https://templates.onlyoffice.com/pdf-form-templates)
[Text document templates](https://templates.onlyoffice.com/document-templates)
[Spreadsheet templates](https://templates.onlyoffice.com/spreadsheet-templates)
[Presentation templates](https://templates.onlyoffice.com/presentation-templates)

###### Converters

[Convert text files](/text-file-converter.aspx)
[Convert spreadsheets](/spreadsheet-converter.aspx)
[Convert presentations](/presentation-converter.aspx)
[Convert PDFs](/pdf-converter.aspx)

###### For education

[For students](/office-for-students.aspx)
[For educators](/office-for-educators.aspx)

###### Get news

[Blog](http://www.onlyoffice.com/blog)

###### Collaborate

[For contributors](/contribute.aspx)
[For translators](https://helpcenter.onlyoffice.com/guides/become-translator.aspx)
[For influencers](/influencer-program.aspx)
[Vacancies](/vacancies.aspx)

###### Get help

[Forum](https://forum.onlyoffice.com/)
[Help Center](https://helpcenter.onlyoffice.com/index.aspx)
[Training courses](/training-courses.aspx)
[Webinars](/webinars.aspx)
[White papers](/whitepapers.aspx)
[Support contact form](/support-contact-form.aspx)
[Order demo](/demo-order.aspx)
[Legal notice](/legalterms.aspx)

###### [Comparison](/document-editor-comparison.aspx)

[ONLYOFFICE Docs vs MS Office Online](/best-microsoft-office-alternative.aspx)
[ONLYOFFICE Docs vs Google Docs](/best-google-docs-alternative.aspx)
[ONLYOFFICE Docs vs Zoho Docs](/best-zoho-docs-alternative.aspx)
[ONLYOFFICE Docs vs LibreOffice](/best-libreoffice-alternative.aspx)
[ONLYOFFICE Docs vs WPS](/best-wps-alternative.aspx)
[ONLYOFFICE Docs vs Adobe Acrobat](/best-adobe-alternative.aspx)
[ONLYOFFICE Docs vs Hancom](/best-hancom-alternative.aspx)

###### Contact Us

Sales questions sales@onlyoffice.com
Partner inquiries partners@onlyoffice.com
Press inquiries press@onlyoffice.com
[Request a call](/call-back-form.aspx)

Follow us on:

© Ascensio System SIA 2009-2025.

All rights reserved

Don't Miss an Update!

Get the latest ONLYOFFICE news delivered to your inbox
First name:

First name is empty.

Your email:

Email is empty.

We sent an email message with confirmation to your email address.



=== Content from github.com_61a30c32_20250110_171130.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FONLYOFFICE%2FDocumentServer)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FONLYOFFICE%2FDocumentServer)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=ONLYOFFICE%2FDocumentServer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ONLYOFFICE](/ONLYOFFICE)
/
**[DocumentServer](/ONLYOFFICE/DocumentServer)**
Public

* [Notifications](/login?return_to=%2FONLYOFFICE%2FDocumentServer) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2FONLYOFFICE%2FDocumentServer)
* [Star
   5k](/login?return_to=%2FONLYOFFICE%2FDocumentServer)

ONLYOFFICE Docs is a free collaborative online office suite comprising viewers and editors for texts, spreadsheets and presentations, forms and PDF, fully compatible with Office Open XML formats: .docx, .xlsx, .pptx and enabling collaborative editing in real time.

[www.onlyoffice.com](https://www.onlyoffice.com "https://www.onlyoffice.com")

### License

[AGPL-3.0 license](/ONLYOFFICE/DocumentServer/blob/master/LICENSE.txt)

[5k
stars](/ONLYOFFICE/DocumentServer/stargazers) [1.1k
forks](/ONLYOFFICE/DocumentServer/forks) [Branches](/ONLYOFFICE/DocumentServer/branches) [Tags](/ONLYOFFICE/DocumentServer/tags) [Activity](/ONLYOFFICE/DocumentServer/activity)
 [Star](/login?return_to=%2FONLYOFFICE%2FDocumentServer)

 [Notifications](/login?return_to=%2FONLYOFFICE%2FDocumentServer) You must be signed in to change notification settings

* [Code](/ONLYOFFICE/DocumentServer)
* [Issues
  921](/ONLYOFFICE/DocumentServer/issues)
* [Pull requests
  1](/ONLYOFFICE/DocumentServer/pulls)
* [Discussions](/ONLYOFFICE/DocumentServer/discussions)
* [Actions](/ONLYOFFICE/DocumentServer/actions)
* [Wiki](/ONLYOFFICE/DocumentServer/wiki)
* [Security](/ONLYOFFICE/DocumentServer/security)
* [Insights](/ONLYOFFICE/DocumentServer/pulse)

Additional navigation options

* [Code](/ONLYOFFICE/DocumentServer)
* [Issues](/ONLYOFFICE/DocumentServer/issues)
* [Pull requests](/ONLYOFFICE/DocumentServer/pulls)
* [Discussions](/ONLYOFFICE/DocumentServer/discussions)
* [Actions](/ONLYOFFICE/DocumentServer/actions)
* [Wiki](/ONLYOFFICE/DocumentServer/wiki)
* [Security](/ONLYOFFICE/DocumentServer/security)
* [Insights](/ONLYOFFICE/DocumentServer/pulse)

# ONLYOFFICE/DocumentServer

    master[Branches](/ONLYOFFICE/DocumentServer/branches)[Tags](/ONLYOFFICE/DocumentServer/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[492 Commits](/ONLYOFFICE/DocumentServer/commits/master/) | | |
| [.github](/ONLYOFFICE/DocumentServer/tree/master/.github ".github") | | [.github](/ONLYOFFICE/DocumentServer/tree/master/.github ".github") |  |  |
| [core @ 029e6c6](/ONLYOFFICE/core/tree/029e6c6df762cc84a0597033e47411c2563ab37f "core") | | [core @ 029e6c6](/ONLYOFFICE/core/tree/029e6c6df762cc84a0597033e47411c2563ab37f "core") |  |  |
| [core-fonts @ d5d80e6](/ONLYOFFICE/core-fonts/tree/d5d80e6ae15800ccf31e1c4dbb1ae3385992e0c2 "core-fonts") | | [core-fonts @ d5d80e6](/ONLYOFFICE/core-fonts/tree/d5d80e6ae15800ccf31e1c4dbb1ae3385992e0c2 "core-fonts") |  |  |
| [dictionaries @ 25e1e98](/ONLYOFFICE/dictionaries/tree/25e1e985e4cc71be39812a120a14b6f07095266d "dictionaries") | | [dictionaries @ 25e1e98](/ONLYOFFICE/dictionaries/tree/25e1e985e4cc71be39812a120a14b6f07095266d "dictionaries") |  |  |
| [sdkjs @ e37d97e](/ONLYOFFICE/sdkjs/tree/e37d97e2810d0e6b19f41a7f989f279fb566943d "sdkjs") | | [sdkjs @ e37d97e](/ONLYOFFICE/sdkjs/tree/e37d97e2810d0e6b19f41a7f989f279fb566943d "sdkjs") |  |  |
| [server @ 03f49f8](/ONLYOFFICE/server/tree/03f49f8e954a9b76736cb62ecf970d916d135ba5 "server") | | [server @ 03f49f8](/ONLYOFFICE/server/tree/03f49f8e954a9b76736cb62ecf970d916d135ba5 "server") |  |  |
| [web-apps @ e6e56e8](/ONLYOFFICE/web-apps/tree/e6e56e8a5ebafad8e730eaec67595d9b8a848f03 "web-apps") | | [web-apps @ e6e56e8](/ONLYOFFICE/web-apps/tree/e6e56e8a5ebafad8e730eaec67595d9b8a848f03 "web-apps") |  |  |
| [.aspell.en.pws](/ONLYOFFICE/DocumentServer/blob/master/.aspell.en.pws ".aspell.en.pws") | | [.aspell.en.pws](/ONLYOFFICE/DocumentServer/blob/master/.aspell.en.pws ".aspell.en.pws") |  |  |
| [.gitmodules](/ONLYOFFICE/DocumentServer/blob/master/.gitmodules ".gitmodules") | | [.gitmodules](/ONLYOFFICE/DocumentServer/blob/master/.gitmodules ".gitmodules") |  |  |
| [.markdownlint.json](/ONLYOFFICE/DocumentServer/blob/master/.markdownlint.json ".markdownlint.json") | | [.markdownlint.json](/ONLYOFFICE/DocumentServer/blob/master/.markdownlint.json ".markdownlint.json") |  |  |
| [.mrconfig](/ONLYOFFICE/DocumentServer/blob/master/.mrconfig ".mrconfig") | | [.mrconfig](/ONLYOFFICE/DocumentServer/blob/master/.mrconfig ".mrconfig") |  |  |
| [CHANGELOG.md](/ONLYOFFICE/DocumentServer/blob/master/CHANGELOG.md "CHANGELOG.md") | | [CHANGELOG.md](/ONLYOFFICE/DocumentServer/blob/master/CHANGELOG.md "CHANGELOG.md") |  |  |
| [LICENSE.txt](/ONLYOFFICE/DocumentServer/blob/master/LICENSE.txt "LICENSE.txt") | | [LICENSE.txt](/ONLYOFFICE/DocumentServer/blob/master/LICENSE.txt "LICENSE.txt") |  |  |
| [ROADMAP.md](/ONLYOFFICE/DocumentServer/blob/master/ROADMAP.md "ROADMAP.md") | | [ROADMAP.md](/ONLYOFFICE/DocumentServer/blob/master/ROADMAP.md "ROADMAP.md") |  |  |
| [Readme.md](/ONLYOFFICE/DocumentServer/blob/master/Readme.md "Readme.md") | | [Readme.md](/ONLYOFFICE/DocumentServer/blob/master/Readme.md "Readme.md") |  |  |
| [mr-update.sh](/ONLYOFFICE/DocumentServer/blob/master/mr-update.sh "mr-update.sh") | | [mr-update.sh](/ONLYOFFICE/DocumentServer/blob/master/mr-update.sh "mr-update.sh") |  |  |
| View all files | | |

## Repository files navigation

* README
* AGPL-3.0 license

[![License](https://camo.githubusercontent.com/1720e1c42dd5a9a5cfaed3a4abec210e929921fa9271e404263661daf3c7905b/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d474e552532304147504c25323056332d677265656e2e7376673f7374796c653d666c6174)](https://www.gnu.org/licenses/agpl-3.0.en.html) [![Release](https://camo.githubusercontent.com/ddb8bd81a4d6fc7401d08bb36c122c29e3e0a2674f9db7b305bbc96123478f9d/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f52656c656173652d76382e312e312d626c75652e7376673f7374796c653d666c6174)](https://camo.githubusercontent.com/ddb8bd81a4d6fc7401d08bb36c122c29e3e0a2674f9db7b305bbc96123478f9d/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f52656c656173652d76382e312e312d626c75652e7376673f7374796c653d666c6174)

## Overview

[ONLYOFFICE Docs](https://www.onlyoffice.com/office-suite.aspx?utm_source=github&utm_medium=cpc&utm_campaign=GitHubDS)\* is a free collaborative online office suite comprising viewers and editors for texts, spreadsheets and presentations, forms and PDF, fully compatible with Office Open XML formats: .docx, .xlsx, .pptx and enabling collaborative editing in real time.

ONLYOFFICE Docs can be used as a part of [ONLYOFFICE Workspace](https://www.onlyoffice.com/workspace.aspx?utm_source=github&utm_medium=cpc&utm_campaign=GitHubCS) or with [third-party sync&share solutions](https://www.onlyoffice.com/all-connectors.aspx?utm_source=github&utm_medium=cpc&utm_campaign=GitHubDS) (e.g. Nextcloud, ownCloud, Seafile) to enable collaborative editing within their interface.

It has three editions - [Community, Enterprise, and Developer](#onlyoffice-docs-editions).

\* Starting from version 6.0, Document Server is distributed under a new name - ONLYOFFICE Docs.

## Components

ONLYOFFICE Docs contains the following components:

* [server](https://github.com/ONLYOFFICE/server) - the backend server software layer which is the base for all other components of ONLYOFFICE Docs.
* [core](https://github.com/ONLYOFFICE/core) - server core components of ONLYOFFICE Docs which enable the conversion between the most popular office document formats (DOC, DOCX, ODT, RTF, TXT, PDF, HTML, EPUB, XPS, DjVu, XLS, XLSX, ODS, CSV, PPT, PPTX, ODP).
* [sdkjs](https://github.com/ONLYOFFICE/sdkjs) - JavaScript SDK for the ONLYOFFICE Docs which contains API for all the included components client-side interaction.
* [web-apps](https://github.com/ONLYOFFICE/web-apps) - the frontend for ONLYOFFICE Docs which builds the program interface and allows the user create, edit, save and export text, spreadsheet and presentation documents using the common interface of a document editor.
* [dictionaries](https://github.com/ONLYOFFICE/dictionaries) - the dictionaries of various languages used for spellchecking in ONLYOFFICE Docs.

## Plugins

ONLYOFFICE Docs offer support for plugins allowing developers to add specific features to the editors that are not directly related to the OOXML format. For more information see [our API](https://api.onlyoffice.com/plugin/basic) or visit github [plugins repo](https://github.com/ONLYOFFICE/onlyoffice.github.io).

## Functionality

ONLYOFFICE Docs includes the following editors:

* [ONLYOFFICE Document Editor](https://www.onlyoffice.com/document-editor.aspx?utm_source=GitHub&utm_medium=social&utm_campaign=GitHubDesktop)
* [ONLYOFFICE Spreadsheet Editor](https://www.onlyoffice.com/spreadsheet-editor.aspx?utm_source=GitHub&utm_medium=social&utm_campaign=GitHubDesktop)
* [ONLYOFFICE Presentation Editor](https://www.onlyoffice.com/presentation-editor.aspx?utm_source=GitHub&utm_medium=social&utm_campaign=GitHubDesktop)
* [ONLYOFFICE Form Creator](https://www.onlyoffice.com/form-creator.aspx?utm_source=GitHub&utm_medium=social&utm_campaign=GitHubDesktop)
* [ONLYOFFICE PDF editor, reader & converter](https://www.onlyoffice.com/pdf-reader.aspx?utm_source=GitHub&utm_medium=social&utm_campaign=GitHubDesktop)

The editors allow you to create, edit, save and export text, spreadsheet and presentation documents and additionally have the features:

* Collaborative editing
* Hieroglyph support
* Reviewing
* Spell-checking

## ONLYOFFICE Docs editions

ONLYOFFICE offers different versions of its online document editors that can be deployed on your own servers.

ONLYOFFICE Docs (packaged as Document Server):

* Community Edition (`onlyoffice-documentserver` package)
* Enterprise Edition (`onlyoffice-documentserver-ee` package)
* Developer Edition (`onlyoffice-documentserver-de` package)

The table below will help you to make the right choice.

| Pricing and licensing | Community Edition | Enterprise Edition | Developer Edition |
| --- | --- | --- | --- |
|  | [Get it now](https://www.onlyoffice.com/download-docs.aspx?utm_source=github&utm_medium=cpc&utm_campaign=GitHubDS#docs-community) | [Start Free Trial](https://www.onlyoffice.com/download-docs.aspx?utm_source=github&utm_medium=cpc&utm_campaign=GitHubDS#docs-enterprise) | [Start Free Trial](https://www.onlyoffice.com/download-docs.aspx?utm_source=github&utm_medium=cpc&utm_campaign=GitHubDS#docs-developer) |
| Cost | FREE | [Go to the pricing page](https://www.onlyoffice.com/docs-enterprise-prices.aspx?utm_source=github&utm_medium=cpc&utm_campaign=GitHubDS) | [Go to the pricing page](https://www.onlyoffice.com/developer-edition-prices.aspx?utm_source=github&utm_medium=cpc&utm_campaign=GitHubDS) |
| Simultaneous connections | up to 20 maximum | As in chosen pricing plan | As in chosen pricing plan |
| Number of users | up to 20 recommended | As in chosen pricing plan | As in chosen pricing plan |
| Clusterization | - | + | + |
| License | GNU AGPL v.3 | Proprietary | Proprietary |
| **Support** | **Community Edition** | **Enterprise Edition** | **Developer Edition** |
| Documentation | [Help Center](https://helpcenter.onlyoffice.com/installation/docs-community-index.aspx) | [Help Center](https://helpcenter.onlyoffice.com/installation/docs-enterprise-index.aspx) | [Help Center](https://helpcenter.onlyoffice.com/installation/docs-developer-index.aspx) |
| Standard support | [GitHub](https://github.com/ONLYOFFICE/DocumentServer/issues) or paid | One year support included | One year support included |
| Premium support | Contact Us | Contact Us | Contact Us |
| **Services** | **Community Edition** | **Enterprise Edition** | **Developer Edition** |
| Conversion Service | + | + | + |
| Document Builder Service | + | + | + |
| **Interface** | **Community Edition** | **Enterprise Edition** | **Developer Edition** |
| Tabbed interface | + | + | + |
| Dark theme | + | + | + |
| 125%, 150%, 175%, 200% scaling | + | + | + |
| White label | - | - | + |
| Integrated test example (node.js) | + | + | + |
| Mobile web editors | - | +\*\* | +\*\* |
| **Plugins & Macros** | **Community Edition** | **Enterprise Edition** | **Developer Edition** |
| Plugins | + | + | + |
| Macros | + | + | + |
| **Collaborative capabilities** | **Community Edition** | **Enterprise Edition** | **Developer Edition** |
| Two co-editing modes | + | + | + |
| Comments | + | + | + |
| Built-in chat | + | + | + |
| Review and tracking changes | + | + | + |
| Display modes of tracking changes | + | + | + |
| Version history | + | + | + |
| **Document Editor features** | **Community Edition** | **Enterprise Edition** | **Developer Edition** |
| Font and paragraph formatting | + | + | + |
| Object insertion | + | + | + |
| Adding Content control | + | + | + |
| Editing Content control | + | + | + |
| Layout tools | + | + | + |
| Table of contents | + | + | + |
| Navigation panel | + | + | + |
| Mail Merge | + | + | + |
| Comparing Documents | + | + | + |
| **Spreadsheet Editor features** | **Community Edition** | **Enterprise Edition** | **Developer Edition** |
| Font and paragraph formatting | + | + | + |
| Object insertion | + | + | + |
| Functions, formulas, equations | + | + | + |
| Table templates | + | + | + |
| Pivot tables | + | + | + |
| Data validation | + | + | + |
| Conditional formatting | + | + | + |
| Sparklines | + | + | + |
| Sheet Views | + | + | + |
| **Presentation Editor features** | **Community Edition** | **Enterprise Edition** | **Developer Edition** |
| Font and paragraph formatting | + | + | + |
| Object insertion | + | + | + |
| Transitions | + | + | + |
| Animations | + | + | + |
| Presenter mode | + | + | + |
| Notes | + | + | + |
| **Form creator features** | **Community Edition** | **Enterprise Edition** | **Developer Edition** |
| Adding form fields | + | + | + |
| Form preview | + | + | + |
| Saving as PDF | + | + | + |
| **Working with PDF** | **Community Edition** | **Enterprise Edition** | **Developer Edition** |
| Text annotations (highlight, underline, cross out) | + | + | + |
| Comments | + | + | + |
| Freehand drawings | + | + | + |
| Form filling | + | + | + |
| **Security features** | **Community Edition** | **Enterprise Edition** | **Developer Edition** |
| End-to-end encryption via Private Rooms\*\*\* | + | + | - |
|  | [Get it now](https://www.onlyoffice.com/download-docs.aspx?utm_source=github&utm_medium=cpc&utm_campaign=GitHubDS#docs-community) | [Start Free Trial](https://www.onlyoffice.com/download-docs.aspx?utm_source=github&utm_medium=cpc&utm_campaign=GitHubDS#docs-enterprise) | [Start Free Trial](https://www.onlyoffice.com/download-docs.aspx?utm_source=github&utm_medium=cpc&utm_campaign=GitHubDS#docs-developer) |

\*\* If supported by DMS

\*\*\* End-to-end encryption via Private Rooms requires ONLYOFFICE Workspace

## How to Install on a local server

The easiest way to install ONLYOFFICE Docs is to use **the Docker image** ([the official source code](https://github.com/ONLYOFFICE/Docker-DocumentServer))

* [Installing ONLYOFFICE Docs Docker](https://helpcenter.onlyoffice.com/installation/docs-community-install-docker.aspx)
* [Installing ONLYOFFICE Docs for Linux](https://helpcenter.onlyoffice.com/installation/docs-community-install-ubuntu.aspx)
* [Installing ONLYOFFICE Docs for Windows](https://helpcenter.onlyoffice.com/installation/docs-community-install-windows.aspx)

## How to Build

Instructions for building ONLYOFFICE Docs for a local server from source code are in [our helpcenter](https://helpcenter.onlyoffice.com/installation/docs-community-compile.aspx).

## License

ONLYOFFICE Docs is licensed under the GNU Affero Public License, version 3.0. See [LICENSE](https://onlyo.co/38YZGJh) for more information.

## User Feedback and Support

If you have any problems with or questions about ONLYOFFICE Docs, please visit our official forum to find answers to your questions: [forum.onlyoffice.com](https://forum.onlyoffice.com) or you can ask and answer ONLYOFFICE development questions on [Stack Overflow](https://stackoverflow.com/questions/tagged/onlyoffice).

## About

ONLYOFFICE Docs is a free collaborative online office suite comprising viewers and editors for texts, spreadsheets and presentations, forms and PDF, fully compatible with Office Open XML formats: .docx, .xlsx, .pptx and enabling collaborative editing in real time.

[www.onlyoffice.com](https://www.onlyoffice.com "https://www.onlyoffice.com")

### Topics

[nodejs](/topics/nodejs "Topic: nodejs")
[node](/topics/node "Topic: node")
[presentation](/topics/presentation "Topic: presentation")
[excel](/topics/excel "Topic: excel")
[word](/topics/word "Topic: word")
[xlsx](/topics/xlsx "Topic: xlsx")
[xls](/topics/xls "Topic: xls")
[spreadsheet](/topics/spreadsheet "Topic: spreadsheet")
[collaboration](/topics/collaboration "Topic: collaboration")
[office](/topics/office "Topic: office")
[docx](/topics/docx "Topic: docx")
[node-js](/topics/node-js "Topic: node-js")
[pptx](/topics/pptx "Topic: pptx")
[collaborative](/topics/collaborative "Topic: collaborative")
[doc](/topics/doc "Topic: doc")
[ods](/topics/ods "Topic: ods")
[odp](/topics/odp "Topic: odp")
[odt](/topics/odt "Topic: odt")
[ppt](/topics/ppt "Topic: ppt")
[onlyoffice](/topics/onlyoffice "Topic: onlyoffice")

### Resources

[Readme](#readme-ov-file)
### License

[AGPL-3.0 license](#AGPL-3.0-1-ov-file)

[Activity](/ONLYOFFICE/DocumentServer/activity)
[Custom properties](/ONLYOFFICE/DocumentServer/custom-properties)
### Stars

[**5k**
stars](/ONLYOFFICE/DocumentServer/stargazers)
### Watchers

[**175**
watching](/ONLYOFFICE/DocumentServer/watchers)
### Forks

[**1.1k**
forks](/ONLYOFFICE/DocumentServer/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FONLYOFFICE%2FDocumentServer&report=ONLYOFFICE+%28user%29)

## [Releases 102](/ONLYOFFICE/DocumentServer/releases)

[ONLYOFFICE-DocumentServer-8.2.2
Latest

Nov 28, 2024](/ONLYOFFICE/DocumentServer/releases/tag/v8.2.2)
[+ 101 releases](/ONLYOFFICE/DocumentServer/releases)

## [Contributors 17](/ONLYOFFICE/DocumentServer/graphs/contributors)

* [![@agolybev](https://avatars.githubusercontent.com/u/8861642?s=64&v=4)](https://github.com/agolybev)
* [![@ShockwaveNN](https://avatars.githubusercontent.com/u/668524?s=64&v=4)](https://github.com/ShockwaveNN)
* [![@trofim24](https://avatars.githubusercontent.com/u/1764789?s=64&v=4)](https://github.com/trofim24)
* [![@DenisDeeSign](https://avatars.githubusercontent.com/u/15816249?s=64&v=4)](https://github.com/DenisDeeSign)
* [![@papacarlo](https://avatars.githubusercontent.com/u/22055467?s=64&v=4)](https://github.com/papacarlo)
* [![@hellonadya](https://avatars.githubusercontent.com/u/29226935?s=64&v=4)](https://github.com/hellonadya)
* [![@github-actions[bot]](https://avatars.githubusercontent.com/in/15368?s=64&v=4)](https://github.com/apps/github-actions)
* [![@svetlana81](https://avatars.githubusercontent.com/u/22791605?s=64&v=4)](https://github.com/svetlana81)
* [![@ivanovnikolay](https://avatars.githubusercontent.com/u/1043943?s=64&v=4)](https://github.com/ivanovnikolay)
* [![@alexeybannov](https://avatars.githubusercontent.com/u/8578518?s=64&v=4)](https://github.com/alexeybannov)
* [![@andrewaeva](https://avatars.githubusercontent.com/u/3368345?s=64&v=4)](https://github.com/andrewaeva)
* [![@heatray](https://avatars.githubusercontent.com/u/5289615?s=64&v=4)](https://github.com/heatray)
* [![@sallakarppinen](https://avatars.githubusercontent.com/u/5364212?s=64&v=4)](https://github.com/sallakarppinen)
* [![@JMoVS](https://avatars.githubusercontent.com/u/7354506?s=64&v=4)](https://github.com/JMoVS)

[+ 3 contributors](/ONLYOFFICE/DocumentServer/graphs/contributors)

## Languages

* [Shell
  100.0%](/ONLYOFFICE/DocumentServer/search?l=shell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from gist.github.com_b2347b17_20250110_171129.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fmerrychap%2F25eba8c4dd97c9e545edad1b8f0eadc2)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fmerrychap%2F25eba8c4dd97c9e545edad1b8f0eadc2&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fmerrychap%2F25eba8c4dd97c9e545edad1b8f0eadc2) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fmerrychap%2F25eba8c4dd97c9e545edad1b8f0eadc2&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@merrychap](https://avatars.githubusercontent.com/u/12413083?s=64&v=4)](/merrychap)

# [merrychap](/merrychap)/**[vulnerabilities\_description.md](/merrychap/25eba8c4dd97c9e545edad1b8f0eadc2)** Secret

Last active
August 14, 2023 01:00

Show Gist options

* [Download ZIP](/merrychap/25eba8c4dd97c9e545edad1b8f0eadc2/archive/20d2a3f2f9d58ce0f7b44c18631ca4a87cd361a1.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fmerrychap%2F25eba8c4dd97c9e545edad1b8f0eadc2)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fmerrychap%2F25eba8c4dd97c9e545edad1b8f0eadc2)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/merrychap/25eba8c4dd97c9e545edad1b8f0eadc2.js&quot;&gt;&lt;/script&gt;
* Save merrychap/25eba8c4dd97c9e545edad1b8f0eadc2 to your computer and use it in GitHub Desktop.

[Code](/merrychap/25eba8c4dd97c9e545edad1b8f0eadc2)
[Revisions
4](/merrychap/25eba8c4dd97c9e545edad1b8f0eadc2/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/merrychap/25eba8c4dd97c9e545edad1b8f0eadc2.js&quot;&gt;&lt;/script&gt;

Save merrychap/25eba8c4dd97c9e545edad1b8f0eadc2 to your computer and use it in GitHub Desktop.

[Download ZIP](/merrychap/25eba8c4dd97c9e545edad1b8f0eadc2/archive/20d2a3f2f9d58ce0f7b44c18631ca4a87cd361a1.zip)

CVE-2023-30186, CVE-2023-30187, CVE-2023-30188

 [Raw](/merrychap/25eba8c4dd97c9e545edad1b8f0eadc2/raw/20d2a3f2f9d58ce0f7b44c18631ca4a87cd361a1/vulnerabilities_description.md)

[**vulnerabilities\_description.md**](#file-vulnerabilities_description-md)

# Description

Here is the light analysis of all three vulnerabilities that I've submitted to MITRE. Small note, the description of the reserved CVE-2023-30188 must be changed from "Buffer Overflow vulnerability in ONLYOFFICE Document Server 4.0.3 through 7.3.2 allows remote attackers to cause a denial of service via crafted JavaScript file" to "Memory Exhaustion vulnerability in ONLYOFFICE Document Server 4.0.3 through 7.3.2 allows remote attackers to cause a denial of service via crafted JavaScript file"

Docbuilder uses a v8 engine to execute JavaScript code inside of the process. Besides the usual JavaScript code, Docbuilder also implements several custom JS objects to include special functionality dedicated to them. Native Engine is one such object having function callbacks implemented in C++ by means of an embedded v8 engine.

The mentioned Docbuilder can be accessed from the server side by sending a request to `/docbuilder` API route. Though, from verion 7.2 an attacker has to know the generated JWT token to be able to communicate with `/docbuilder` because JWT tokens were enabled by default starting from version 7.2. Then, JWT tokens are essential to operate with DocumentServer, therefore end users still must have them and the attacker can be one of the end users too.

`/docbuilder` route requires a url parameter pointing to the attacker's controlled remote server that has a JavaScript file that will be executed in Docbuilder process.

Below are the relevant members of `CNativeControl` class:

```
class CNativeControl
{
  private:
	std::wstring m_strFilePath;
	std::wstring m_strFileId;

  public:
	...

	BYTE* m_pSaveBinary;
	int m_nSaveLen;

	int m_nSaveBinaryLen;
	...
}
```

`m_pSaveBinary` is the pointer to document's data and m\_nSaveLen is the length of this data. The API functions that Native Engine exposes relevant to the vulnerability are the following:

```
    void Save_Alloc(int nLen)
    {
      m_nSaveLen = nLen;
      m_pSaveBinary = new BYTE[m_nSaveLen];
      memset(m_pSaveBinary, 0xFF, m_nSaveLen);
    }

    void Save_ReAlloc(int pos, int len)
    {
      BYTE* pOld = m_pSaveBinary;
      m_nSaveLen = len;
      m_pSaveBinary = new BYTE[m_nSaveLen];

      memcpy(m_pSaveBinary, pOld, pos);

      RELEASEARRAYOBJECTS(pOld);
    }
```

## CVE-2023-30186

By utilizing `Save_Alloc` function, a user can allocate a new chunk of arbitrary size initialized with `0xff`. Then in `Save_ReAlloc` this chunk can be freed and a new one is reallocated to store a part of the previous data. In both cases, a new `v8::ArrayBuffer` is constructed based on the allocated heap chunk (either allocation from `Save_Alloc` or reallocation from `Save_ReAlloc`) in function `CJSContext::createUint8Array` for the corresponding action implemented in the methods of `CNativeControlEmbed` class.

Consider the following set of actions:

1. Create a new `v8::ArrayBuffer` object by utilizing `Save_Alloc`.
2. Create a data viewer for this buffer such as `Uint8Array`. In this case, `Uint8Array`'s backing store will point to the allocated `m_pSaveBinary`.
3. Execute `Save_ReAlloc` which will free the previous heap chunk pointed by `m_pSaveBinary` and allocate a new one.

After these steps, the data viewer's backing store still points to the `m_pSaveBinary` which was freed previously. This leads to Use-After-Free because an attacker can manipulate with data viewer to leak or change the content of the freed heap chunk.

## CVE-2023-30187

By utilizing `Save_Alloc` function, a user can allocate a new chunk of arbitrary size initialized with `0xff`. Then in `Save_ReAlloc` this chunk can be freed and a new one is reallocated to store a part of the previous data. In both cases, a new `v8::ArrayBuffer` is constructed based on the allocated heap chunk (either allocation from `Save_Alloc` or reallocation from `Save_ReAlloc`) in function `CJSContext::createUint8Array` for the corresponding action implemented in the methods of `CNativeControlEmbed` class.
Notice that no validation is performed on `pos` and `len` parameters neither in `Save_ReAlloc` nor in `CNativeControlEmbed::Save_ReAllocNative` functions.
Consider the following set of actions:

1. Create a new `v8::ArrayBuffer` object by utilizing `Save_Alloc` with a size equal to 0x100.
2. Create a data viewer for this buffer such as `Uint8Array`. In this case, `Uint8Array`'s backing store will point to the allocated `m_pSaveBinary`.
3. Populate the allocated `m_pSaveBinary` with some attacker's controlled data.
4. Execute `Save_ReAlloc` with `pos = 0x100` and `len = 0x20`.

After these steps, the larger-sized chunk will be copied into the smaller one which clearly leads to Heap Buffer Overflow. The same approach can be applied to copy the data below the source buffer into the destination giving the ability to leak data from the heap section.
Hence, Out-of-Bounds Memory Access vulnerability is present in `Save_ReAlloc` function.

## CVE-2023-30188

By utilizing `Save_Alloc` function, a user can allocate a new chunk of arbitrary size initialized with `0xff`. The lifetime of the allocated object is not limited, therefore executing `Save_Alloc` in an infinite loop will lead to the Denial of Service on DocumentServer application and possibly the host system as well.

To reproduce this issue, the following JavaScript code can be used:

```
builder.CreateFile("docx");

engine = CreateNativeEngine();

while (true) {
    engine.Save_AllocNative(0x808);
}
```

# Fixes

Here is the patch file: <https://github.com/ONLYOFFICE/core/commit/2b6ad83b36afd9845085b536969d366d1d61150a>

You need to pay attention to the changes in `DesktopEditor/doctrenderer/embed/jsc/jsc_NativeControl.mm` file that remove the functionality containing the vulnerabilities

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fmerrychap%2F25eba8c4dd97c9e545edad1b8f0eadc2)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_97093e16_20250110_171132.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FONLYOFFICE%2Fcore%2Fcommit%2F2b6ad83b36afd9845085b536969d366d1d61150a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FONLYOFFICE%2Fcore%2Fcommit%2F2b6ad83b36afd9845085b536969d366d1d61150a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ONLYOFFICE%2Fcore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ONLYOFFICE](/ONLYOFFICE)
/
**[core](/ONLYOFFICE/core)**
Public

* [Notifications](/login?return_to=%2FONLYOFFICE%2Fcore) You must be signed in to change notification settings
* [Fork
  226](/login?return_to=%2FONLYOFFICE%2Fcore)
* [Star
   294](/login?return_to=%2FONLYOFFICE%2Fcore)

* [Code](/ONLYOFFICE/core)
* [Pull requests
  11](/ONLYOFFICE/core/pulls)
* [Actions](/ONLYOFFICE/core/actions)
* [Security](/ONLYOFFICE/core/security)
* [Insights](/ONLYOFFICE/core/pulse)

Additional navigation options

* [Code](/ONLYOFFICE/core)
* [Pull requests](/ONLYOFFICE/core/pulls)
* [Actions](/ONLYOFFICE/core/actions)
* [Security](/ONLYOFFICE/core/security)
* [Insights](/ONLYOFFICE/core/pulse)

## Commit

[Permalink](/ONLYOFFICE/core/commit/2b6ad83b36afd9845085b536969d366d1d61150a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix bug 60433

[Browse files](/ONLYOFFICE/core/tree/2b6ad83b36afd9845085b536969d366d1d61150a)
Browse the repository at this point in the history

* Loading branch information

[![@K0R0L](https://avatars.githubusercontent.com/u/16754960?s=40&v=4)](/K0R0L)

[K0R0L](/ONLYOFFICE/core/commits?author=K0R0L "View all commits by K0R0L")
committed
Feb 4, 2023

1 parent
[0b9dc3c](/ONLYOFFICE/core/commit/0b9dc3c296439c156966ba9bd6a3beb3d43327da)

commit 2b6ad83

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**200 additions**
and
**149 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* DesktopEditor/doctrenderer

  + DesktopEditor/doctrenderer/docbuilder\_p.cpp
    [docbuilder\_p.cpp](#diff-752fb054ef05f1d54a228a7f5759447bfe58ab5857ce0c6ec7b2df96ff52513d)
  + DesktopEditor/doctrenderer/docbuilder\_p.h
    [docbuilder\_p.h](#diff-7e8fe0d5d78a05a50930f61f2e8430360a116cf5f5a1a074c8c32ec7a84c5e95)
  + embed

    - jsc

      * DesktopEditor/doctrenderer/embed/jsc/jsc\_NativeControl.mm
        [jsc\_NativeControl.mm](#diff-37eced48f3ccf47cd809e34ed313eb9677d13f6c9e5ec9ba6b1488015bdc2475)
    - v8

      * DesktopEditor/doctrenderer/embed/v8/v8\_NativeControl.cpp
        [v8\_NativeControl.cpp](#diff-21b543332663c60272f39bd721fbed5a90d3a0aa5e8737992ec7d35fab85c889)
  + js\_internal/v8

    - DesktopEditor/doctrenderer/js\_internal/v8/v8\_base.cpp
      [v8\_base.cpp](#diff-556c74bb7c13991ef38a7029c28a9e18ed8551452a77952a28db994179fcfd7d)
    - DesktopEditor/doctrenderer/js\_internal/v8/v8\_base.h
      [v8\_base.h](#diff-ed9de112e0fa95533854b06a57db3dd9ca823256369fa1606464ddc23484c79d)

## There are no files selected for viewing

14 changes: 7 additions & 7 deletions

14
[DesktopEditor/doctrenderer/docbuilder\_p.cpp](#diff-752fb054ef05f1d54a228a7f5759447bfe58ab5857ce0c6ec7b2df96ff52513d "DesktopEditor/doctrenderer/docbuilder_p.cpp")

Show comments

[View file](/ONLYOFFICE/core/blob/2b6ad83b36afd9845085b536969d366d1d61150a/DesktopEditor/doctrenderer/docbuilder_p.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -76,8 +76,8 @@ bool CV8RealTimeWorker::ExecuteCommand(const std::wstring& command, NSDoctRender |
|  |  | { |
|  |  | LOGGER\_SPEED\_START |
|  |  |  |
|  |  | if (retValue) |
|  |  | retValue->Clear(); |
|  |  | if (retValue) |
|  |  | retValue->Clear(); |
|  |  |  |
|  |  | std::string commandA = U\_TO\_UTF8(command); |
|  |  | //commandA = "Api." + commandA; |
| Expand All | | @@ -87,7 +87,7 @@ bool CV8RealTimeWorker::ExecuteCommand(const std::wstring& command, NSDoctRender |
|  |  |  |
|  |  | LOGGER\_SPEED\_LAP("compile\_command") |
|  |  |  |
|  |  | JSSmart<CJSValue> retNativeVal = m\_context->runScript(commandA, try\_catch); |
|  |  | JSSmart<CJSValue> retNativeVal = m\_context->runScript(commandA, try\_catch); |
|  |  | if(try\_catch->Check()) |
|  |  | return false; |
|  |  |  |
| Expand All | | @@ -100,7 +100,7 @@ bool CV8RealTimeWorker::ExecuteCommand(const std::wstring& command, NSDoctRender |
|  |  |  |
|  |  | LOGGER\_SPEED\_LAP("run\_command") |
|  |  |  |
|  |  | return true; |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | std::string CV8RealTimeWorker::GetGlobalVariable() |
| Expand Down  Expand Up | | @@ -139,7 +139,7 @@ bool CV8RealTimeWorker::OpenFile(const std::wstring& sBasePath, const std::wstri |
|  |  | { |
|  |  | LOGGER\_SPEED\_START |
|  |  |  |
|  |  | JSSmart<CJSContextScope> context\_scope = m\_context->CreateContextScope(); |
|  |  | JSSmart<CJSContextScope> context\_scope = m\_context->CreateContextScope(); |
|  |  | JSSmart<CJSTryCatch> try\_catch = m\_context->GetExceptions(); |
|  |  |  |
|  |  | LOGGER\_SPEED\_LAP("compile"); |
| Expand All | | @@ -150,7 +150,7 @@ bool CV8RealTimeWorker::OpenFile(const std::wstring& sBasePath, const std::wstri |
|  |  |  |
|  |  | LOGGER\_SPEED\_LAP("run") |
|  |  |  |
|  |  | if (true) |
|  |  | if (true) |
|  |  | { |
|  |  | std::string sArg = m\_sUtf8ArgumentJSON; |
|  |  | if (sArg.empty()) |
| Expand Down  Expand Up | | @@ -249,7 +249,7 @@ bool CV8RealTimeWorker::OpenFile(const std::wstring& sBasePath, const std::wstri |
|  |  |  |
|  |  | LOGGER\_SPEED\_LAP("open") |
|  |  |  |
|  |  | return !bIsBreak; |
|  |  | return !bIsBreak; |
|  |  | } |
|  |  |  |
|  |  | bool CV8RealTimeWorker::SaveFileWithChanges(int type, const std::wstring& \_path, const std::wstring& sJsonParams) |
| Expand Down | |  |

6 changes: 3 additions & 3 deletions

6
[DesktopEditor/doctrenderer/docbuilder\_p.h](#diff-7e8fe0d5d78a05a50930f61f2e8430360a116cf5f5a1a074c8c32ec7a84c5e95 "DesktopEditor/doctrenderer/docbuilder_p.h")

Show comments

[View file](/ONLYOFFICE/core/blob/2b6ad83b36afd9845085b536969d366d1d61150a/DesktopEditor/doctrenderer/docbuilder_p.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -890,7 +890,7 @@ namespace NSDoctRenderer |
|  |  |  |
|  |  | LOGGER\_SPEED\_START |
|  |  |  |
|  |  | CheckFileDir(); |
|  |  | CheckFileDir(); |
|  |  | NSDirectory::CreateDirectory(m\_sFileDir + L"/changes"); |
|  |  |  |
|  |  | std::wstring sExtCopy = GetFileCopyExt(path); |
| Expand All | | @@ -912,8 +912,8 @@ namespace NSDoctRenderer |
|  |  |  |
|  |  | LOGGER\_SPEED\_LAP("open\_convert") |
|  |  |  |
|  |  | if (0 == nReturnCode) |
|  |  | return 0; |
|  |  | if (0 == nReturnCode) |
|  |  | return 0; |
|  |  |  |
|  |  | NSDirectory::DeleteDirectory(m\_sFileDir); |
|  |  | m\_sFileDir = L""; |
| Expand Down | |  |

8 changes: 4 additions & 4 deletions

8
[DesktopEditor/doctrenderer/embed/jsc/jsc\_NativeControl.mm](#diff-37eced48f3ccf47cd809e34ed313eb9677d13f6c9e5ec9ba6b1488015bdc2475 "DesktopEditor/doctrenderer/embed/jsc/jsc_NativeControl.mm")

Show comments

[View file](/ONLYOFFICE/core/blob/2b6ad83b36afd9845085b536969d366d1d61150a/DesktopEditor/doctrenderer/embed/jsc/jsc_NativeControl.mm)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -14,8 +14,8 @@ -(JSValue\*) GetEditorType; |
|  |  | -(JSValue\*) CheckNextChange; |
|  |  | -(JSValue\*) GetCountChanges; |
|  |  | -(JSValue\*) GetChangesFile : (JSValue\*)index; |
|  |  | -(JSValue\*) Save\_AllocNative : (JSValue\*)len; |
|  |  | -(JSValue\*) Save\_ReAllocNative : (JSValue\*)pos : (JSValue\*)len; |
|  |  | //-(JSValue\*) Save\_AllocNative : (JSValue\*)len; |
|  |  | //-(JSValue\*) Save\_ReAllocNative : (JSValue\*)pos : (JSValue\*)len; |
|  |  | -(JSValue\*) Save\_End : (JSValue\*)pos : (JSValue\*)len; |
|  |  | -(JSValue\*) AddImageInChanges : (JSValue\*)img; |
|  |  | -(JSValue\*) ConsoleLog : (JSValue\*)message; |
| Expand Down  Expand Up | | @@ -54,8 +54,8 @@ @implementation CJSCNativeControl |
|  |  | FUNCTION\_WRAPPER\_JS(CheckNextChange, CheckNextChange) |
|  |  | FUNCTION\_WRAPPER\_JS(GetCountChanges, GetCountChanges) |
|  |  | FUNCTION\_WRAPPER\_JS\_1(GetChangesFile, GetChangesFile) |
|  |  | FUNCTION\_WRAPPER\_JS\_1(Save\_AllocNative, Save\_AllocNative) |
|  |  | FUNCTION\_WRAPPER\_JS\_2(Save\_ReAllocNative, Save\_ReAllocNative) |
|  |  | //FUNCTION\_WRAPPER\_JS\_1(Save\_AllocNative, Save\_AllocNative) |
|  |  | //FUNCTION\_WRAPPER\_JS\_2(Save\_ReAllocNative, Save\_ReAllocNative) |
|  |  | FUNCTION\_WRAPPER\_JS\_2(Save\_End, Save\_End) |
|  |  | FUNCTION\_WRAPPER\_JS\_1(AddImageInChanges, AddImageInChanges) |
|  |  | FUNCTION\_WRAPPER\_JS\_1(ConsoleLog, ConsoleLog) |
| Expand Down | |  |

282 changes: 147 additions & 135 deletions

282
[DesktopEditor/doctrenderer/embed/v8/v8\_NativeControl.cpp](#diff-21b543332663c60272f39bd721fbed5a90d3a0aa5e8737992ec7d35fab85c889 "DesktopEditor/doctrenderer/embed/v8/v8_NativeControl.cpp")

Show comments

[View file](/ONLYOFFICE/core/blob/2b6ad83b36afd9845085b536969d366d1d61150a/DesktopEditor/doctrenderer/embed/v8/v8_NativeControl.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,147 +3,159 @@ |
|  |  |  |
|  |  | namespace NSNativeControl |
|  |  | { |
|  |  | #define CURRENTWRAPPER CNativeControlEmbed |
|  |  |  |
|  |  | FUNCTION\_WRAPPER\_V8(\_GetFilePath, GetFilePath) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_SetFilePath, SetFilePath) |
|  |  | FUNCTION\_WRAPPER\_V8(\_GetFileId, GetFileId) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_SetFileId, SetFileId) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_GetFileArrayBuffer, GetFileBinary) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_GetFontArrayBuffer, GetFontBinary) |
|  |  | FUNCTION\_WRAPPER\_V8(\_GetFontsDirectory, GetFontsDirectory) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_GetFileString, GetFileString) |
|  |  | FUNCTION\_WRAPPER\_V8(\_GetEditorType, GetEditorType) |
|  |  | FUNCTION\_WRAPPER\_V8(\_CheckNextChange, CheckNextChange) |
|  |  | FUNCTION\_WRAPPER\_V8(\_GetChangesCount, GetCountChanges) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_GetChangesFile, GetChangesFile) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_Save\_AllocNative, Save\_AllocNative) |
|  |  | FUNCTION\_WRAPPER\_V8\_2(\_Save\_ReAllocNative, Save\_ReAllocNative) |
|  |  | FUNCTION\_WRAPPER\_V8\_2(\_Save\_End, Save\_End) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_AddImageInChanges, AddImageInChanges) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_ConsoleLog, ConsoleLog) |
|  |  | FUNCTION\_WRAPPER\_V8\_3(\_SaveChanges, SaveChanges) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_zipOpenFile, zipOpenFile) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_zipOpenFileBase64, zipOpenFileBase64) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_zipGetFileAsString, zipGetFileAsString) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_zipGetFileAsBinary, zipGetFileAsBinary) |
|  |  | FUNCTION\_WRAPPER\_V8(\_zipCloseFile, zipCloseFile) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_GetImageUrl, GetImageUrl) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_GetImageOriginalSize, GetImageOriginalSize) |
|  |  | FUNCTION\_WRAPPER\_V8(\_GetImagesPath, GetImagesPath) |
|  |  |  |
|  |  | v8::Handle<v8::ObjectTemplate> CreateNativeControlTemplate(v8::Isolate\* isolate) |
|  |  | { |
|  |  | v8::EscapableHandleScope handle\_scope(isolate); |
|  |  |  |
|  |  | v8::Local<v8::ObjectTemplate> result = v8::ObjectTemplate::New(V8IsolateOneArg); |
|  |  | result->SetInternalFieldCount(1); |
|  |  |  |
|  |  | NSV8Objects::Template\_Set(result, "SetFilePath", \_SetFilePath); |
|  |  | NSV8Objects::Template\_Set(result, "GetFilePath", \_GetFilePath); |
|  |  | NSV8Objects::Template\_Set(result, "SetFileId", \_SetFileId); |
|  |  | NSV8Objects::Template\_Set(result, "GetFileId", \_GetFileId); |
|  |  | NSV8Objects::Template\_Set(result, "GetFileBinary", \_GetFileArrayBuffer); |
|  |  | NSV8Objects::Template\_Set(result, "GetFontBinary", \_GetFontArrayBuffer); |
|  |  | NSV8Objects::Template\_Set(result, "GetFontsDirectory", \_GetFontsDirectory); |
|  |  | NSV8Objects::Template\_Set(result, "GetFileString", \_GetFileString); |
|  |  | NSV8Objects::Template\_Set(result, "GetEditorType", \_GetEditorType); |
|  |  | NSV8Objects::Template\_Set(result, "CheckNextChange", \_CheckNextChange); |
|  |  | NSV8Objects::Template\_Set(result, "GetCountChanges", \_GetChangesCount); |
|  |  | NSV8Objects::Template\_Set(result, "GetChangesFile", \_GetChangesFile); |
|  |  | NSV8Objects::Template\_Set(result, "Save\_AllocNative", \_Save\_AllocNative); |
|  |  | NSV8Objects::Template\_Set(result, "Save\_ReAllocNative", \_Save\_ReAllocNative); |
|  |  | NSV8Objects::Template\_Set(result, "Save\_End", \_Save\_End); |
|  |  | NSV8Objects::Template\_Set(result, "AddImageInChanges", \_AddImageInChanges); |
|  |  | NSV8Objects::Template\_Set(result, "ConsoleLog", \_ConsoleLog); |
|  |  | NSV8Objects::Template\_Set(result, "SaveChanges", \_SaveChanges); |
|  |  | NSV8Objects::Template\_Set(result, "ZipOpen", \_zipOpenFile); |
|  |  | NSV8Objects::Template\_Set(result, "ZipOpenBase64", \_zipOpenFileBase64); |
|  |  | NSV8Objects::Template\_Set(result, "ZipFileAsString", \_zipGetFileAsString); |
|  |  | NSV8Objects::Template\_Set(result, "ZipFileAsBinary", \_zipGetFileAsBinary); |
|  |  | NSV8Objects::Template\_Set(result, "ZipClose", \_zipCloseFile); |
|  |  | NSV8Objects::Template\_Set(result, "getImageUrl", \_GetImageUrl); |
|  |  | NSV8Objects::Template\_Set(result, "getImagesDirectory", \_GetImagesPath); |
|  |  | NSV8Objects::Template\_Set(result, "GetImageOriginalSize", \_GetImageOriginalSize); |
|  |  |  |
|  |  | return handle\_scope.Escape(result); |
|  |  | } |
|  |  |  |
|  |  | // Без SaveChanges |
|  |  | v8::Handle<v8::ObjectTemplate> CreateNativeControlTemplateBuilder(v8::Isolate\* isolate) |
|  |  | { |
|  |  | v8::EscapableHandleScope handle\_scope(isolate); |
|  |  |  |
|  |  | v8::Local<v8::ObjectTemplate> result = v8::ObjectTemplate::New(V8IsolateOneArg); |
|  |  | result->SetInternalFieldCount(1); |
|  |  |  |
|  |  | NSV8Objects::Template\_Set(result, "SetFilePath", \_SetFilePath); |
|  |  | NSV8Objects::Template\_Set(result, "GetFilePath", \_GetFilePath); |
|  |  | NSV8Objects::Template\_Set(result, "SetFileId", \_SetFileId); |
|  |  | NSV8Objects::Template\_Set(result, "GetFileId", \_GetFileId); |
|  |  | NSV8Objects::Template\_Set(result, "GetFileBinary", \_GetFileArrayBuffer); |
|  |  | NSV8Objects::Template\_Set(result, "GetFontBinary", \_GetFontArrayBuffer); |
|  |  | NSV8Objects::Template\_Set(result, "GetFontsDirectory", \_GetFontsDirectory); |
|  |  | NSV8Objects::Template\_Set(result, "GetFileString", \_GetFileString); |
|  |  | NSV8Objects::Template\_Set(result, "GetEditorType", \_GetEditorType); |
|  |  | NSV8Objects::Template\_Set(result, "CheckNextChange", \_CheckNextChange); |
|  |  | NSV8Objects::Template\_Set(result, "GetCountChanges", \_GetChangesCount); |
|  |  | NSV8Objects::Template\_Set(result, "GetChangesFile", \_GetChangesFile); |
|  |  | NSV8Objects::Template\_Set(result, "Save\_AllocNative", \_Save\_AllocNative); |
|  |  | NSV8Objects::Template\_Set(result, "Save\_ReAllocNative", \_Save\_ReAllocNative); |
|  |  | NSV8Objects::Template\_Set(result, "Save\_End", \_Save\_End); |
|  |  | NSV8Objects::Template\_Set(result, "AddImageInChanges", \_AddImageInChanges); |
|  |  | NSV8Objects::Template\_Set(result, "ConsoleLog", \_ConsoleLog); |
|  |  | NSV8Objects::Template\_Set(result, "ZipOpen", \_zipOpenFile); |
|  |  | NSV8Objects::Template\_Set(result, "ZipOpenBase64", \_zipOpenFileBase64); |
|  |  | NSV8Objects::Template\_Set(result, "ZipFileAsString", \_zipGetFileAsString); |
|  |  | NSV8Objects::Template\_Set(result, "ZipFileAsBinary", \_zipGetFileAsBinary); |
|  |  | NSV8Objects::Template\_Set(result, "ZipClose", \_zipCloseFile); |
|  |  | NSV8Objects::Template\_Set(result, "getImageUrl", \_GetImageUrl); |
|  |  | NSV8Objects::Template\_Set(result, "getImagesDirectory", \_GetImagesPath); |
|  |  | NSV8Objects::Template\_Set(result, "GetImageOriginalSize", \_GetImageOriginalSize); |
|  |  |  |
|  |  | return handle\_scope.Escape(result); |
|  |  | } |
|  |  |  |
|  |  | void CreateNativeObject(const v8::FunctionCallbackInfo<v8::Value>& args) |
|  |  | { |
|  |  | v8::Isolate\* isolate = args.GetIsolate(); |
|  |  | v8::HandleScope scope(isolate); |
|  |  |  |
|  |  | v8::Handle<v8::ObjectTemplate> NativeObjectTemplate = CreateNativeControlTemplate(isolate); |
|  |  | CNativeControlEmbed\* pNativeObject = new CNativeControlEmbed(); |
|  |  |  |
|  |  | v8::Local<v8::Object> obj = NativeObjectTemplate->NewInstance(isolate->GetCurrentContext()).ToLocalChecked(); |
|  |  | obj->SetInternalField(0, v8::External::New(CV8Worker::GetCurrent(), pNativeObject)); |
|  |  |  |
|  |  | args.GetReturnValue().Set(obj); |
|  |  | } |
|  |  |  |
|  |  | // Без SaveChanges |
|  |  | void CreateNativeObjectBuilder(const v8::FunctionCallbackInfo<v8::Value>& args) |
|  |  | { |
|  |  | v8::Isolate\* isolate = args.GetIsolate(); |
|  |  | v8::HandleScope scope(isolate); |
|  |  |  |
|  |  | v8::Handle<v8::ObjectTemplate> NativeObjectTemplate = CreateNativeControlTemplateBuilder(isolate); |
|  |  | CNativeControlEmbed\* pNativeObject = new CNativeControlEmbed(); |
|  |  |  |
|  |  | v8::Local<v8::Object> obj = NativeObjectTemplate->NewInstance(isolate->GetCurrentContext()).ToLocalChecked(); |
|  |  | obj->SetInternalField(0, v8::External::New(CV8Worker::GetCurrent(), pNativeObject)); |
|  |  |  |
|  |  | args.GetReturnValue().Set(obj); |
|  |  | } |
|  |  | #define CURRENTWRAPPER CNativeControlEmbed |
|  |  |  |
|  |  | FUNCTION\_WRAPPER\_V8(\_GetFilePath, GetFilePath) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_SetFilePath, SetFilePath) |
|  |  | FUNCTION\_WRAPPER\_V8(\_GetFileId, GetFileId) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_SetFileId, SetFileId) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_GetFileArrayBuffer, GetFileBinary) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_GetFontArrayBuffer, GetFontBinary) |
|  |  | FUNCTION\_WRAPPER\_V8(\_GetFontsDirectory, GetFontsDirectory) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_GetFileString, GetFileString) |
|  |  | FUNCTION\_WRAPPER\_V8(\_GetEditorType, GetEditorType) |
|  |  | FUNCTION\_WRAPPER\_V8(\_CheckNextChange, CheckNextChange) |
|  |  | FUNCTION\_WRAPPER\_V8(\_GetChangesCount, GetCountChanges) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_GetChangesFile, GetChangesFile) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_Save\_AllocNative, Save\_AllocNative) |
|  |  | FUNCTION\_WRAPPER\_V8\_2(\_Save\_ReAllocNative, Save\_ReAllocNative) |
|  |  | FUNCTION\_WRAPPER\_V8\_2(\_Save\_End, Save\_End) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_AddImageInChanges, AddImageInChanges) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_ConsoleLog, ConsoleLog) |
|  |  | FUNCTION\_WRAPPER\_V8\_3(\_SaveChanges, SaveChanges) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_zipOpenFile, zipOpenFile) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_zipOpenFileBase64, zipOpenFileBase64) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_zipGetFileAsString, zipGetFileAsString) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_zipGetFileAsBinary, zipGetFileAsBinary) |
|  |  | FUNCTION\_WRAPPER\_V8(\_zipCloseFile, zipCloseFile) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_GetImageUrl, GetImageUrl) |
|  |  | FUNCTION\_WRAPPER\_V8\_1(\_GetImageOriginalSize, GetImageOriginalSize) |
|  |  | FUNCTION\_WRAPPER\_V8(\_GetImagesPath, GetImagesPath) |
|  |  |  |
|  |  | v8::Handle<v8::ObjectTemplate> CreateNativeControlTemplate(v8::Isolate\* isolate) |
|  |  | { |
|  |  | v8::EscapableHandleScope handle\_scope(isolate); |
|  |  |  |
|  |  | v8::Local<v8::ObjectTemplate> result = v8::ObjectTemplate::New(V8IsolateOneArg); |
|  |  | result->SetInternalFieldCount(1); |
|  |  |  |
|  |  | NSV8Objects::Template\_Set(result, "SetFilePath", \_SetFilePath); |
|  |  | NSV8Objects::Template\_Set(result, "GetFilePath", \_GetFilePath); |
|  |  | NSV8Objects::Template\_Set(result, "SetFileId", \_SetFileId); |
|  |  | NSV8Objects::Template\_Set(result, "GetFileId", \_GetFileId); |
|  |  | NSV8Objects::Template\_Set(result, "GetFileBinary", \_GetFileArrayBuffer); |
|  |  | NSV8Objects::Template\_Set(result, "GetFontBinary", \_GetFontArrayBuffer); |
|  |  | NSV8Objects::Template\_Set(result, "GetFontsDirectory", \_GetFontsDirectory); |
|  |  | NSV8Objects::Template\_Set(result, "GetFileString", \_GetFileString); |
|  |  | NSV8Objects::Template\_Set(result, "GetEditorType", \_GetEditorType); |
|  |  | NSV8Objects::Template\_Set(result, "CheckNextChange", \_CheckNextChange); |
|  |  | NSV8Objects::Template\_Set(result, "GetCountChanges", \_GetChangesCount); |
|  |  | NSV8Objects::Template\_Set(result, "GetChangesFile", \_GetChangesFile); |
|  |  | //NSV8Objects::Template\_Set(result, "Save\_AllocNative", \_Save\_AllocNative); |
|  |  | //NSV8Objects::Template\_Set(result, "Save\_ReAllocNative", \_Save\_ReAllocNative); |
|  |  | NSV8Objects::Template\_Set(result, "Save\_End", \_Save\_End); |
|  |  | NSV8Objects::Template\_Set(result, "AddImageInChanges", \_AddImageInChanges); |
|  |  | NSV8Objects::Template\_Set(result, "ConsoleLog", \_ConsoleLog); |
|  |  | NSV8Objects::Template\_Set(result, "SaveChanges", \_SaveChanges); |
|  |  | NSV8Objects::Template\_Set(result, "ZipOpen", \_zipOpenFile); |
|  |  | NSV8Objects::Template\_Set(result, "ZipOpenBase64", \_zipOpenFileBase64); |
|  |  | NSV8Objects::Template\_Set(result, "ZipFileAsString", \_zipGetFileAsString); |
|  |  | NSV8Objects::Template\_Set(result, "ZipFileAsBinary", \_zipGetFileAsBinary); |
|  |  | NSV8Objects::Template\_Set(result, "ZipClose", \_zipCloseFile); |
|  |  | NSV8Objects::Template\_Set(result, "getImageUrl", \_GetImageUrl); |
|  |  | NSV8Objects::Template\_Set(result, "getImagesDirectory", \_GetImagesPath); |
|  |  | NSV8Objects::Template\_Set(result, "GetImageOriginalSize", \_GetImageOriginalSize); |
|  |  |  |
|  |  | return handle\_scope.Escape(result); |
|  |  | } |
|  |  |  |
|  |  | // Без SaveChanges |
|  |  | v8::Handle<v8::ObjectTemplate> CreateNativeControlTemplateBuilder(v8::Isolate\* isolate) |
|  |  | { |
|  |  | v8::EscapableHandleScope handle\_scope(isolate); |
|  |  |  |
|  |  | v8::Local<v8::ObjectTemplate> result = v8::ObjectTemplate::New(V8IsolateOneArg); |
|  |  | result->SetInternalFieldCount(1); |
|  |  |  |
|  |  | NSV8Objects::Template\_Set(result, "SetFilePath", \_SetFilePath); |
|  |  | NSV8Objects::Template\_Set(result, "GetFilePath", \_GetFilePath); |
|  |  | NSV8Objects::Template\_Set(result, "SetFileId", \_SetFileId); |
|  |  | NSV8Objects::Template\_Set(result, "GetFileId", \_GetFileId); |
|  |  | NSV8Objects::Template\_Set(result, "GetFileBinary", \_GetFileArrayBuffer); |
|  |  | NSV8Objects::Template\_Set(result, "GetFontBinary", \_GetFontArrayBuffer); |
|  |  | NSV8Objects::Template\_Set(result, "GetFontsDirectory", \_GetFontsDirectory); |
|  |  | NSV8Objects::Template\_Set(result, "GetFileString", \_GetFileString); |
|  |  | NSV8Objects::Template\_Set(result, "GetEditorType", \_GetEditorType); |
|  |  | NSV8Objects::Template\_Set(result, "CheckNextChange", \_CheckNextChange); |
|  |  | NSV8Objects::Template\_Set(result, "GetCountChanges", \_GetChangesCount); |
|  |  | NSV8Objects::Template\_Set(result, "GetChangesFile", \_GetChangesFile); |
|  |  | //NSV8Objects::Template\_Set(result, "Save\_AllocNative", \_Save\_AllocNative); |
|  |  | //NSV8Objects::Template\_Set(result, "Save\_ReAllocNative", \_Save\_ReAllocNative); |
|  |  | NSV8Objects::Template\_Set(result, "Save\_End", \_Save\_End); |
|  |  | NSV8Objects::Template\_Set(result, "AddImageInChanges", \_AddImageInChanges); |
|  |  | NSV8Objects::Template\_Set(result, "ConsoleLog", \_ConsoleLog); |
|  |  | NSV8Objects::Template\_Set(result, "ZipOpen", \_zipOpenFile); |
|  |  | NSV8Objects::Template\_Set(result, "ZipOpenBase64", \_zipOpenFileBase64); |
|  |  | NSV8Objects::Template\_Set(result, "ZipFileAsString", \_zipGetFileAsString); |
|  |  | NSV8Objects::Template\_Set(result, "ZipFileAsBinary", \_zipGetFileAsBinary); |
|  |  | NSV8Objects::Template\_Set(result, "ZipClose", \_zipCloseFile); |
|  |  | NSV8Objects::Template\_Set(result, "getImageUrl", \_GetImageUrl); |
|  |  | NSV8Objects::Template\_Set(result, "getImagesDirectory", \_GetImagesPath); |
|  |  | NSV8Objects::Template\_Set(result, "GetImageOriginalSize", \_GetImageOriginalSize); |
|  |  |  |
|  |  | return handle\_scope.Escape(result); |
|  |  | } |
|  |  |  |
|  |  | void CreateNativeObject(const v8::FunctionCallbackInfo<v8::Value>& args) |
|  |  | { |
|  |  | v8::Isolate\* isolate = args.GetIsolate(); |
|  |  | v8::HandleScope scope(isolate); |
|  |  |  |
|  |  | if (CIsolateAdditionalData::CheckSingletonType(isolate, CIsolateAdditionalData::iadtSingletonNative)) |
|  |  | { |
|  |  | args.GetReturnValue().Set(v8::Undefined(isolate)); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | v8::Handle<v8::ObjectTemplate> NativeObjectTemplate = CreateNativeControlTemplate(isolate); |
|  |  | CNativeControlEmbed\* pNativeObject = new CNativeControlEmbed(); |
|  |  |  |
|  |  | v8::Local<v8::Object> obj = NativeObjectTemplate->NewInstance(isolate->GetCurrentContext()).ToLocalChecked(); |
|  |  | obj->SetInternalField(0, v8::External::New(CV8Worker::GetCurrent(), pNativeObject)); |
|  |  |  |
|  |  | args.GetReturnValue().Set(obj); |
|  |  | } |
|  |  |  |
|  |  | // Без SaveChanges |
|  |  | void CreateNativeObjectBuilder(const v8::FunctionCallbackInfo<v8::Value>& args) |
|  |  | { |
|  |  | v8::Isolate\* isolate = args.GetIsolate(); |
|  |  | v8::HandleScope scope(isolate); |
|  |  |  |
|  |  | if (CIsolateAdditionalData::CheckSingletonType(isolate, CIsolateAdditionalData::iadtSingletonNative)) |
|  |  | { |
|  |  | args.GetReturnValue().Set(v8::Undefined(isolate)); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | v8::Handle<v8::ObjectTemplate> NativeObjectTemplate = CreateNativeControlTemplateBuilder(isolate); |
|  |  | CNativeControlEmbed\* pNativeObject = new CNativeControlEmbed(); |
|  |  |  |
|  |  | v8::Local<v8::Object> obj = NativeObjectTemplate->NewInstance(isolate->GetCurrentContext()).ToLocalChecked(); |
|  |  | obj->SetInternalField(0, v8::External::New(CV8Worker::GetCurrent(), pNativeObject)); |
|  |  |  |
|  |  | args.GetReturnValue().Set(obj); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | void CNativeControlEmbed::CreateObjectInContext(const std::string& name, JSSmart<CJSContext> context) |
|  |  | { |
|  |  | v8::Isolate\* current = CV8Worker::GetCurrent(); |
|  |  | context->m\_internal->m\_global->Set(current, name.c\_str(), v8::FunctionTemplate::New(current, NSNativeControl::CreateNativeObject)); |
|  |  | v8::Isolate\* current = CV8Worker::GetCurrent(); |
|  |  | context->m\_internal->m\_global->Set(current, name.c\_str(), v8::FunctionTemplate::New(current, NSNativeControl::CreateNativeObject)); |
|  |  | } |
|  |  |  |
|  |  | void CNativeControlEmbed::CreateObjectBuilderInContext(const std::string& name, JSSmart<CJSContext> context) |
|  |  | { |
|  |  | v8::Isolate\* current = CV8Worker::GetCurrent(); |
|  |  | context->m\_internal->m\_global->Set(current, name.c\_str(), v8::FunctionTemplate::New(current, NSNativeControl::CreateNativeObjectBuilder)); |
|  |  | v8::Isolate\* current = CV8Worker::GetCurrent(); |
|  |  | context->m\_internal->m\_global->Set(current, name.c\_str(), v8::FunctionTemplate::New(current, NSNativeControl::CreateNativeObjectBuilder)); |
|  |  | } |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2b6ad83`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FONLYOFFICE%2Fcore%2Fcommit%2F2b6ad83b36afd9845085b536969d366d1d61150a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_36f951d7_20250110_171131.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FONLYOFFICE%2Fcore%2Fblob%2F8ca40a44ce47a86168327a46db91253cf6bb205d%2FDesktopEditor%2Fdoctrenderer%2Fembed%2FNativeControlEmbed.cpp)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FONLYOFFICE%2Fcore%2Fblob%2F8ca40a44ce47a86168327a46db91253cf6bb205d%2FDesktopEditor%2Fdoctrenderer%2Fembed%2FNativeControlEmbed.cpp)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=ONLYOFFICE%2Fcore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ONLYOFFICE](/ONLYOFFICE)
/
**[core](/ONLYOFFICE/core)**
Public

* [Notifications](/login?return_to=%2FONLYOFFICE%2Fcore) You must be signed in to change notification settings
* [Fork
  226](/login?return_to=%2FONLYOFFICE%2Fcore)
* [Star
   294](/login?return_to=%2FONLYOFFICE%2Fcore)

* [Code](/ONLYOFFICE/core)
* [Pull requests
  11](/ONLYOFFICE/core/pulls)
* [Actions](/ONLYOFFICE/core/actions)
* [Security](/ONLYOFFICE/core/security)
* [Insights](/ONLYOFFICE/core/pulse)

Additional navigation options

* [Code](/ONLYOFFICE/core)
* [Pull requests](/ONLYOFFICE/core/pulls)
* [Actions](/ONLYOFFICE/core/actions)
* [Security](/ONLYOFFICE/core/security)
* [Insights](/ONLYOFFICE/core/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


