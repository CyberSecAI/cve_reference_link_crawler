



<!DOCTYPE html>
<html class="gl-light ui-gray with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>(CVE-2021-46829) Buffer overwrite in io-gif-animation.c composite_frame() (possibly exploitable) (#190) · Issues · GNOME / gdk-pixbuf · GitLab</title>
<script>
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.gnome.org/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=500;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="6Lfhei8UAAAAAKwEVuEwxJX09r0AGdMm-DUTWNAQ";gon.gitlab_url="https://gitlab.gnome.org";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="58dfc9c873e";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-d746ae2450a3e9c626d338d77a101b84ff33a47c0c281b676d75c4a6ed2948a4.css";gon.emoji_backend_version=4;gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=null;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=1;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=false;gon.jh=false;gon.dot_com=false;gon.uf_error_prefix="UF";gon.pat_prefix="ggopat";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"findAndReplace":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"asyncSidebarCounts":false,"preserveMarkdown":false,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":false,"workItems":true,"workItemsBeta":false,"workItemsAlpha":false,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false};
//]]>
</script>


<script>
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/GNOME/gdk-pixbuf/-/issues/190/related_branches":{},"/GNOME/gdk-pixbuf/-/issues/190/discussions.json?per_page=20":{},"/GNOME/gdk-pixbuf/-/issues/190.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = null;

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"KcwY3fwa3a475eJaVJX9bRpSOssy1DR-Bl7rdVxl3zR_7MuK51c-dSU8MVQbvK2yDr22lyepH10NnE0Y9FNFOA","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.gnome.org/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-2e69a08e74e113997b5ba7fc5cd3e020a6f407d9ad552675adc6d78c2b23d0f7.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-55b7f0d1f8549b24ba19c0b5aaf18a17a8d3828677fad074d37dd2e69d08da2b.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-6598dbf61fe32a8ddb1b06150f2301451ad41554975581e771efc5f890d0443f.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-01914381150850b46ac12e613a08df1d9b815aa305882ef8482ccd64eda0773f.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-caf98f77b75b4b5399bdde69c069ee023fefdaa986d687c937e8010218785f51.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-cbc6a2e1633c4e847a617e35cc4833b85b80816db688d3d6dd3cd31d4251bc53.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-0bfb919a8a7eb0e89544dfe328e69461ccb276a565685fdb6ae3b14f3db3f41b.css" />
<link rel="stylesheet" href="/assets/tailwind-016e83140c37d97dbdff0cef9c063fcd43d214866665fb783774776747928853.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-5ffbb706faebead681b01c8b52e92c6c0d35ad5b1c11d39012c90bcaf7892ca8.css" />


<link rel="preload" href="/assets/application_utilities-0bfb919a8a7eb0e89544dfe328e69461ccb276a565685fdb6ae3b14f3db3f41b.css" as="style" type="text/css">
<link rel="preload" href="/assets/application-2e69a08e74e113997b5ba7fc5cd3e020a6f407d9ad552675adc6d78c2b23d0f7.css" as="style" type="text/css">
<link rel="preload" href="/assets/highlight/themes/white-5ffbb706faebead681b01c8b52e92c6c0d35ad5b1c11d39012c90bcaf7892ca8.css" as="style" type="text/css">




<script src="/assets/webpack/runtime.10b44924.bundle.js" defer="defer"></script>
<script src="/assets/webpack/main.a4c9ae4f.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.dashboar-c8f1318b.54872cef.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.issues-pages.dashboard.milestones.show-pages.-13e11bbf.1a73330b.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.issues-pages.groups.boards-pages.groups.issue-8dfa5f96.20262e8b.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.issues-pages.groups.boards-pages.groups.issue-f804d6c2.d4f467df.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.800b02b5.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.98a5daf8.chunk.js" defer="defer"></script>
<script src="/assets/webpack/super_sidebar.839aed14.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-2cf3f004.cf930f47.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.m-b59cd8e6.af19401d.chunk.js" defer="defer"></script>
<script src="/assets/webpack/5.7a5f7362.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.m-bfc75f5d.bc5ed18e.chunk.js" defer="defer"></script>
<script src="/assets/webpack/9.bc4d8be7.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.m-74b1dcb9.25b64210.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports-pages.admin.abuse_reports.show-pages.admin.groups.index-pages.admi-e271b53c.4fcbe683.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.milestones.edit-pages.groups.mil-2f72a3d7.5269b7ea.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.milestones.show-pages.groups.merge_requests-p-6152ef8e.1d43fc45.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.dashboard.milestones.show-pages.groups.merge_requests-pages.groups.milestones.edit-pag-8e438287.4a86321e.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.dashboard.issues-pages.groups.issues-pages.groups.merge_requests-pages.groups.work_ite-dc744cb1.d70eece9.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.issues-pages.groups.merge_requests-pages.groups.work_items-pages.groups.work_it-ed595783.87e56f63.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.milestones.edit-pages.groups.milestones.new-pages.groups.milestones.show-pages.-7486cfee.c1a8fe55.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.merge_requests-pages.groups.work_items-pages.groups.work_items.show-pages.proje-a6a6c699.b1ed2339.chunk.js" defer="defer"></script>
<script src="/assets/webpack/pages.projects.issues.show.fe9c774a.chunk.js" defer="defer"></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="(CVE-2021-46829) Buffer overwrite in io-gif-animation.c composite_frame() (possibly exploitable) (#190) · Issues · GNOME / gdk-pixbuf · GitLab" property="og:title">
<meta content="I have been fuzzing gdk-pixbuf and found an interesting bug. I did limited research on it, but the bug appears to be an exploitable memory overwrite. " property="og:description">
<meta content="https://gitlab.gnome.org/uploads/-/system/project/avatar/1548/gdk-pixbuf-logo.png" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.gnome.org/GNOME/gdk-pixbuf/-/issues/190" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="(CVE-2021-46829) Buffer overwrite in io-gif-animation.c composite_frame() (possibly exploitable) (#190) · Issues · GNOME / gdk-pixbuf · GitLab" property="twitter:title">
<meta content="I have been fuzzing gdk-pixbuf and found an interesting bug. I did limited research on it, but the bug appears to be an exploitable memory overwrite. " property="twitter:description">
<meta content="https://gitlab.gnome.org/uploads/-/system/project/avatar/1548/gdk-pixbuf-logo.png" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="Pedro Ribeiro"><meta property="twitter:label2" content="Assignee"><meta property="twitter:data2" content="Robert Ancell">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="TUpWCMGF7n3FIbJxTOXL9EUEhIUuXBwxXi4wz-cyDc0baoVf2sgNptv4YX8DzJsrUesI2TshNxJV7JaiTwSXwQ" />
<meta name="csp-nonce" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/uploads/-/system/appearance/favicon/1/GnomeLogoVertical.svg.png" id="favicon" data-original-href="/uploads/-/system/appearance/favicon/1/GnomeLogoVertical.svg.png" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content="I have been fuzzing gdk-pixbuf and found an interesting bug. I did limited research on it, but the bug appears to be an exploitable memory overwrite. " name="description">
<meta content="#28272d" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-find-file="/GNOME/gdk-pixbuf/-/find_file/master" data-group="GNOME" data-group-full-path="GNOME" data-namespace-id="8" data-page="projects:issues:show" data-page-type-id="190" data-project="gdk-pixbuf" data-project-full-path="GNOME/gdk-pixbuf" data-project-id="1548">
<script>
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"members":"/GNOME/gdk-pixbuf/-/autocomplete_sources/members?type=Issue\u0026type_id=190","issues":"/GNOME/gdk-pixbuf/-/autocomplete_sources/issues","mergeRequests":"/GNOME/gdk-pixbuf/-/autocomplete_sources/merge_requests","labels":"/GNOME/gdk-pixbuf/-/autocomplete_sources/labels?type=Issue\u0026type_id=190","milestones":"/GNOME/gdk-pixbuf/-/autocomplete_sources/milestones","commands":"/GNOME/gdk-pixbuf/-/autocomplete_sources/commands?type=Issue\u0026type_id=190","snippets":"/GNOME/gdk-pixbuf/-/autocomplete_sources/snippets","contacts":"/GNOME/gdk-pixbuf/-/autocomplete_sources/contacts?type=Issue\u0026type_id=190","wikis":"/GNOME/gdk-pixbuf/-/autocomplete_sources/wikis"};


//]]>
</script>
<script>
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" href="/"><img class="brand-header-logo lazy" alt="" data-src="/uploads/-/system/appearance/header_logo/1/GnomeLogoHorizontal.svg" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" />
</a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/GNOME/gdk-pixbuf/-/files/master?format=json&quot;,&quot;project_blob_url&quot;:&quot;/GNOME/gdk-pixbuf/-/blob/master&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="false" data-root-path="/" data-sidebar="{&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;gdk-pixbuf&quot;,&quot;avatar&quot;:&quot;/uploads/-/system/project/avatar/1548/gdk-pixbuf-logo.png&quot;,&quot;entity_id&quot;:1548,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/issues&quot;,&quot;pill_count&quot;:&quot;97&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/milestones&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_wiki&quot;,&quot;title&quot;:&quot;Wiki&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/wikis/home&quot;,&quot;link_classes&quot;:&quot;shortcuts-wiki&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/merge_requests&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;project_merge_request_list&quot;,&quot;title&quot;:&quot;Merge requests&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/merge_requests&quot;,&quot;pill_count&quot;:&quot;33&quot;,&quot;link_classes&quot;:&quot;shortcuts-merge_requests&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/tree/master&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/commits/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/network/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/compare?from=master\u0026to=master&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_snippets&quot;,&quot;title&quot;:&quot;Snippets&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/snippets&quot;,&quot;link_classes&quot;:&quot;shortcuts-snippets&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;container_registry&quot;,&quot;title&quot;:&quot;Container Registry&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/container_registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/ml/models&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;operations_menu&quot;,&quot;title&quot;:&quot;Operate&quot;,&quot;icon&quot;:&quot;cloud-pod&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/environments&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;environments&quot;,&quot;title&quot;:&quot;Environments&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/environments&quot;,&quot;link_classes&quot;:&quot;shortcuts-environments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/incidents&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;incidents&quot;,&quot;title&quot;:&quot;Incidents&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/incidents&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;service_desk&quot;,&quot;title&quot;:&quot;Service Desk&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/issues/service_desk&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/graphs/master?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/graphs/master/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_experiments&quot;,&quot;title&quot;:&quot;Model experiments&quot;,&quot;link&quot;:&quot;/GNOME/gdk-pixbuf/-/ml/experiments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:false,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:8,&quot;name&quot;:&quot;GNOME&quot;,&quot;full_name&quot;:&quot;GNOME&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/GNOME/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/GNOME/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:1548,&quot;name&quot;:&quot;gdk-pixbuf&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/GNOME/gdk-pixbuf/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/GNOME/gdk-pixbuf/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">

























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"GNOME","item":"https://gitlab.gnome.org/GNOME"},{"@type":"ListItem","position":2,"name":"gdk-pixbuf","item":"https://gitlab.gnome.org/GNOME/gdk-pixbuf"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.gnome.org/GNOME/gdk-pixbuf/-/issues"},{"@type":"ListItem","position":4,"name":"#190","item":"https://gitlab.gnome.org/GNOME/gdk-pixbuf/-/issues/190"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;GNOME&quot;,&quot;href&quot;:&quot;/GNOME&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/group/avatar/8/gnomelogo.png&quot;},{&quot;text&quot;:&quot;gdk-pixbuf&quot;,&quot;href&quot;:&quot;/GNOME/gdk-pixbuf&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/project/avatar/1548/gdk-pixbuf-logo.png&quot;},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/GNOME/gdk-pixbuf/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#190&quot;,&quot;href&quot;:&quot;/GNOME/gdk-pixbuf/-/issues/190&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/GNOME/gdk-pixbuf/-/issues/190&quot;,&quot;new_issue_path&quot;:&quot;/GNOME/gdk-pixbuf/-/issues/new?add_related_issue=190&quot;,&quot;project_path&quot;:&quot;GNOME/gdk-pixbuf&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:56528,&quot;reported_from_url&quot;:&quot;https://gitlab.gnome.org/GNOME/gdk-pixbuf/-/issues/190&quot;,&quot;submit_as_spam_path&quot;:&quot;/GNOME/gdk-pixbuf/-/issues/190/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null}" data-initial="{&quot;endpoint&quot;:&quot;/GNOME/gdk-pixbuf/-/issues/190&quot;,&quot;updateEndpoint&quot;:&quot;/GNOME/gdk-pixbuf/-/issues/190.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#190&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/GNOME/gdk-pixbuf/-/preview_markdown?target_id=190\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:4,&quot;issuableTemplateNamesPath&quot;:&quot;/GNOME/gdk-pixbuf/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;(CVE-2021-46829) Buffer overwrite in io-gif-animation.c composite_frame() (possibly exploitable)&quot;,&quot;initialTitleText&quot;:&quot;(CVE-2021-46829) Buffer overwrite in io-gif-animation.c composite_frame() (possibly exploitable)&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003cp data-sourcepos=\&quot;1:1-1:149\&quot; dir=\&quot;auto\&quot;\u003eI have been fuzzing gdk-pixbuf and found an interesting bug. I did limited research on it, but the bug appears to be an exploitable memory overwrite.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:1-3:177\&quot; dir=\&quot;auto\&quot;\u003eThe bug is in composite_frame() in io-gif-animation.c, which I pasted below. It can be triggered by running gdk-pixbuf-pixdata with any of the poc files attached to this report.\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;5:1-30:3\&quot; data-canonical-lang=\&quot;c\&quot; class=\&quot;code highlight js-syntax-highlight language-c\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\u003cspan class=\&quot;n\&quot;\u003epixels\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egdk_pixbuf_get_pixels\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eanim\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003elast_frame_data\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\u003cspan class=\&quot;k\&quot;\u003efor\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ei\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e0\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ei\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003en_indexes\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ei\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e++\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e{\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;n\&quot;\u003eguint8\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eindex\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eindex_buffer\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e[\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ei\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e];\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;n\&quot;\u003eguint\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ex\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ey\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;kt\&quot;\u003eint\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eoffset\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;k\&quot;\u003eif\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eindex\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e==\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eframe\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003etransparent_index\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\t\t\u003cspan class=\&quot;k\&quot;\u003econtinue\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;n\&quot;\u003ex\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ei\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e%\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eframe\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ewidth\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e+\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eframe\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ex_offset\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;n\&quot;\u003ey\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003einterlace_rows\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e[\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ei\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e/\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eframe\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ewidth\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e]\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e+\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eframe\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ey_offset\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;k\&quot;\u003eif\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ex\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eanim\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ewidth\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e||\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ey\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eanim\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eheight\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\t\t\u003cspan class=\&quot;k\&quot;\u003econtinue\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;n\&quot;\u003eoffset\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ey\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egdk_pixbuf_get_rowstride\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eanim\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003elast_frame_data\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e+\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ex\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e4\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;kt\&quot;\u003eint\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003erowstride\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egdk_pixbuf_get_rowstride\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eanim\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003elast_frame_data\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;n\&quot;\u003eprintf\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;signed: y: %d x: %d height: %d width: %d rowstride: %d offset: %d\u003c/span\u003e\u003cspan class=\&quot;se\&quot;\u003e\\n\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ey\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ex\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eanim\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eheight\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eanim\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ewidth\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003erowstride\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eoffset\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;n\&quot;\u003eprintf\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;unsigned: y: %u x: %u height: %u width: %u rowstride: %u offset: %u\u003c/span\u003e\u003cspan class=\&quot;se\&quot;\u003e\\n\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ey\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ex\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eanim\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eheight\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eanim\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ewidth\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003erowstride\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eoffset\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;n\&quot;\u003eprintf\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;buf size: %u\u003c/span\u003e\u003cspan class=\&quot;se\&quot;\u003e\\n\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egdk_pixbuf_get_byte_length\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eanim\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003elast_frame_data\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e));\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;n\&quot;\u003epixels\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e[\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eoffset\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e+\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e0\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e]\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eframe\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ecolor_map\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e[\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eindex\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e3\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e+\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e0\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e];\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;n\&quot;\u003epixels\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e[\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eoffset\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e+\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e1\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e]\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eframe\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ecolor_map\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e[\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eindex\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e3\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e+\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e1\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e];\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;n\&quot;\u003epixels\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e[\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eoffset\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e+\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e2\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e]\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eframe\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ecolor_map\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e[\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eindex\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e3\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e+\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e2\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e];\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t\t\u003cspan class=\&quot;n\&quot;\u003epixels\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e[\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eoffset\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e+\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e3\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e]\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e255\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\u003cspan class=\&quot;p\&quot;\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u003cinsert-code-snippet\u003e\u003c/insert-code-snippet\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;32:1-33:107\&quot; dir=\&quot;auto\&quot;\u003eNote that the \u003ccode data-sourcepos=\&quot;32:16-32:21\&quot;\u003eprintf\u003c/code\u003e were added by me to aid in debugging.\u0026#x000A;The problem appears to be in the calculation of the offset variable. Actually there are two problems there:\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;35:1-37:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;35:1-35:72\&quot;\u003ebecause it is a signed int, it can overwrite when it&#39;s over INT32_MAX\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;36:1-37:0\&quot;\u003eeven if it was as an unsigned int, given the calculations, it becomes quite easy to reach very large values\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;38:1-38:87\&quot; dir=\&quot;auto\&quot;\u003eI am attaching two files here. The first is \u003ccode data-sourcepos=\&quot;38:46-38:60\&quot;\u003ewrap_around.poc\u003c/code\u003e, which gives this result:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;40:1-45:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003esigned: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: -2011744996\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eunsigned: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: 2283222300\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ebuf size: 2353510400\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSegmentation fault\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u003cinsert-code-snippet\u003e\u003c/insert-code-snippet\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;47:1-48:35\&quot; dir=\&quot;auto\&quot;\u003eAs you can see, we&#39;ve wrapped around and gone into a negative number, which causes a negative offset access on the buffer.\u0026#x000A;This can be further checked in gdb:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;49:1-62:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e$r11   : 0x00007fff6b247010  →  0x0000000000000000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e$r15   : 0xffffffff8817351c\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e   0x55555556603b \u0026lt;composite_frame+667\u0026gt; lea    eax, [r10+r10*2]\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e   0x55555556603f \u0026lt;composite_frame+671\u0026gt; movsxd rdx, eax\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e   0x555555566042 \u0026lt;composite_frame+674\u0026gt; movzx  edx, BYTE PTR [rcx+rdx*1]\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e → 0x555555566046 \u0026lt;composite_frame+678\u0026gt; mov    BYTE PTR [r11+r15*1], dl\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e   0x55555556604a \u0026lt;composite_frame+682\u0026gt; lea    edx, [rax+0x1]\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e   0x55555556604d \u0026lt;composite_frame+685\u0026gt; mov    rcx, QWORD PTR [rbp+0x20]\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e   0x555555566051 \u0026lt;composite_frame+689\u0026gt; add    eax, 0x2\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e   0x555555566054 \u0026lt;composite_frame+692\u0026gt; movsxd rdx, edx\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e   0x555555566057 \u0026lt;composite_frame+695\u0026gt; cdqe\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u003cinsert-code-snippet\u003e\u003c/insert-code-snippet\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;64:1-64:187\&quot; dir=\&quot;auto\&quot;\u003eHere the value of $r11 is the pixels buffer, while r15 is the calculated output variable. Its value is 0xffffffff8817351c, which is exactly -2011744996 as printed out by my added printfs.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;66:1-66:129\&quot; dir=\&quot;auto\&quot;\u003eThe second file I am attaching, \u003ccode data-sourcepos=\&quot;66:34-66:49\&quot;\u003emore_trouble.poc\u003c/code\u003e, shows that this can happen even with a smaller buffer. Its output results in:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;67:1-72:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003esigned: y: 32896 x: 128 height: 65526 width: 18303 rowstride: 73212 offset: -1886584832\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eunsigned: y: 32896 x: 128 height: 65526 width: 18303 rowstride: 73212 offset: 2408382464\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ebuf size: 502322216\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSegmentation fault\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u003cinsert-code-snippet\u003e\u003c/insert-code-snippet\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;74:1-74:445\&quot; dir=\&quot;auto\&quot;\u003eI haven&#39;t tried to exploit this, but looks to me that it is definitely exploitable. We can write to an arbitrary memory address, which is calculated using the offset variable. What I am not sure is how controllable that offset variable is; its value depends on the X and Y and other factors, which might influence the buffer size. I&#39;m sure you know the code better than me and will be able to definitely tell if this is fully exploitable or not.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;76:1-77:126\&quot; dir=\&quot;auto\&quot;\u003eI also did a naive fix, which works perfectly to avoid this problem, but I&#39;m not sure if its the correct way to go about it.\u0026#x000A;You just need to introduce the following check after the offset calculation and before it is used to access the pixels buffer:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;78:1-81:3\&quot; data-canonical-lang=\&quot;c\&quot; class=\&quot;code highlight js-syntax-highlight language-c\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t \u003cspan class=\&quot;n\&quot;\u003egsize\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003elen\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egdk_pixbuf_get_byte_length\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eanim\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003elast_frame_data\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t \u003cspan class=\&quot;n\&quot;\u003eg_assert\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eoffset\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e+\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e3\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003elen\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eoffset\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e0\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u003cinsert-code-snippet\u003e\u003c/insert-code-snippet\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;83:1-83:112\&quot; dir=\&quot;auto\&quot;\u003eThis seems to stop every memory overwrite from happening, here&#39;s the output of \u003ccode data-sourcepos=\&quot;83:81-83:95\&quot;\u003ewrap_around.poc\u003c/code\u003e with the patch:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;85:1-93:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003esigned: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: -2011744996\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eunsigned: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: 2283222300\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ebuf size: 2353510400\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e**\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGdkPixbuf:ERROR:../gdk-pixbuf/io-gif-animation.c:390:composite_frame: assertion failed: (offset + 3 \u0026lt;= len \u0026amp;\u0026amp; offset \u0026gt; 0)\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eBail out! GdkPixbuf:ERROR:../gdk-pixbuf/io-gif-animation.c:390:composite_frame: assertion failed: (offset + 3 \u0026lt;= len \u0026amp;\u0026amp; offset \u0026gt; 0)\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eAborted\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u003cinsert-code-snippet\u003e\u003c/insert-code-snippet\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;95:1-95:68\&quot; dir=\&quot;auto\&quot;\u003e\u003ca data-sourcepos=\&quot;95:1-95:68\&quot; href=\&quot;/-/project/1548/uploads/6ff374b990a1f545877a122caf5a87ea/pocs.tar.xz\&quot; data-canonical-src=\&quot;/uploads/6ff374b990a1f545877a122caf5a87ea/pocs.tar.xz\&quot; data-link=\&quot;true\&quot; class=\&quot;gfm\&quot;\u003epocs.tar.xz\u003c/a\u003e\u003c/p\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;I have been fuzzing gdk-pixbuf and found an interesting bug. I did limited research on it, but the bug appears to be an exploitable memory overwrite.\n\nThe bug is in composite_frame() in io-gif-animation.c, which I pasted below. It can be triggered by running gdk-pixbuf-pixdata with any of the poc files attached to this report.\n\n```c\n\t\tpixels = gdk_pixbuf_get_pixels (anim-\u003elast_frame_data);\n\t\tfor (i = 0; i \u003c n_indexes; i++) {\n\t\t\t\tguint8 index = index_buffer[i];\n\t\t\t\tguint x, y;\n\t\t\t\tint offset;\n\n\t\t\t\tif (index == frame-\u003etransparent_index)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\tx = i % frame-\u003ewidth + frame-\u003ex_offset;\n\t\t\t\ty = interlace_rows[i / frame-\u003ewidth] + frame-\u003ey_offset;\n\t\t\t\tif (x \u003e= anim-\u003ewidth || y \u003e= anim-\u003eheight)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\toffset = y * gdk_pixbuf_get_rowstride (anim-\u003elast_frame_data) + x * 4;\n\t\t\t\tint rowstride = gdk_pixbuf_get_rowstride (anim-\u003elast_frame_data);\n\t\t\t\tprintf(\&quot;signed: y: %d x: %d height: %d width: %d rowstride: %d offset: %d\\n\&quot;, y, x, anim-\u003eheight, anim-\u003ewidth, rowstride, offset);\n\t\t\t\tprintf(\&quot;unsigned: y: %u x: %u height: %u width: %u rowstride: %u offset: %u\\n\&quot;, y, x, anim-\u003eheight, anim-\u003ewidth, rowstride, offset);\n\t\t\t\tprintf(\&quot;buf size: %u\\n\&quot;, gdk_pixbuf_get_byte_length (anim-\u003elast_frame_data));\n\t\t\t\tpixels[offset + 0] = frame-\u003ecolor_map[index * 3 + 0];\n\t\t\t\tpixels[offset + 1] = frame-\u003ecolor_map[index * 3 + 1];\n\t\t\t\tpixels[offset + 2] = frame-\u003ecolor_map[index * 3 + 2];\n\t\t\t\tpixels[offset + 3] = 255;\n\t\t}\n```\n\nNote that the `printf` were added by me to aid in debugging.\nThe problem appears to be in the calculation of the offset variable. Actually there are two problems there:\n\n1. because it is a signed int, it can overwrite when it&#39;s over INT32_MAX\n2. even if it was as an unsigned int, given the calculations, it becomes quite easy to reach very large values\n\nI am attaching two files here. The first is `wrap_around.poc`, which gives this result:\n\n```\nsigned: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: -2011744996\nunsigned: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: 2283222300\nbuf size: 2353510400\nSegmentation fault\n```\n\nAs you can see, we&#39;ve wrapped around and gone into a negative number, which causes a negative offset access on the buffer.\nThis can be further checked in gdb:\n```\n$r11   : 0x00007fff6b247010  →  0x0000000000000000\n$r15   : 0xffffffff8817351c\n\n   0x55555556603b \u003ccomposite_frame+667\u003e lea    eax, [r10+r10*2]\n   0x55555556603f \u003ccomposite_frame+671\u003e movsxd rdx, eax\n   0x555555566042 \u003ccomposite_frame+674\u003e movzx  edx, BYTE PTR [rcx+rdx*1]\n → 0x555555566046 \u003ccomposite_frame+678\u003e mov    BYTE PTR [r11+r15*1], dl\n   0x55555556604a \u003ccomposite_frame+682\u003e lea    edx, [rax+0x1]\n   0x55555556604d \u003ccomposite_frame+685\u003e mov    rcx, QWORD PTR [rbp+0x20]\n   0x555555566051 \u003ccomposite_frame+689\u003e add    eax, 0x2\n   0x555555566054 \u003ccomposite_frame+692\u003e movsxd rdx, edx\n   0x555555566057 \u003ccomposite_frame+695\u003e cdqe\n```\n\nHere the value of $r11 is the pixels buffer, while r15 is the calculated output variable. Its value is 0xffffffff8817351c, which is exactly -2011744996 as printed out by my added printfs.\n\nThe second file I am attaching, `more_trouble.poc`, shows that this can happen even with a smaller buffer. Its output results in:\n```\nsigned: y: 32896 x: 128 height: 65526 width: 18303 rowstride: 73212 offset: -1886584832\nunsigned: y: 32896 x: 128 height: 65526 width: 18303 rowstride: 73212 offset: 2408382464\nbuf size: 502322216\nSegmentation fault\n```\n\nI haven&#39;t tried to exploit this, but looks to me that it is definitely exploitable. We can write to an arbitrary memory address, which is calculated using the offset variable. What I am not sure is how controllable that offset variable is; its value depends on the X and Y and other factors, which might influence the buffer size. I&#39;m sure you know the code better than me and will be able to definitely tell if this is fully exploitable or not.\n\nI also did a naive fix, which works perfectly to avoid this problem, but I&#39;m not sure if its the correct way to go about it.\nYou just need to introduce the following check after the offset calculation and before it is used to access the pixels buffer:\n```c\n\t\t gsize len = gdk_pixbuf_get_byte_length (anim-\u003elast_frame_data);\n\t\t g_assert (offset + 3 \u003c= len \u0026\u0026 offset \u003e 0);\n```\n\nThis seems to stop every memory overwrite from happening, here&#39;s the output of `wrap_around.poc` with the patch:\n\n```\nsigned: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: -2011744996\nunsigned: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: 2283222300\nbuf size: 2353510400\n**\nGdkPixbuf:ERROR:../gdk-pixbuf/io-gif-animation.c:390:composite_frame: assertion failed: (offset + 3 \u003c= len \u0026\u0026 offset \u003e 0)\nBail out! GdkPixbuf:ERROR:../gdk-pixbuf/io-gif-animation.c:390:composite_frame: assertion failed: (offset + 3 \u003c= len \u0026\u0026 offset \u003e 0)\nAborted\n```\n\n[pocs.tar.xz](/uploads/6ff374b990a1f545877a122caf5a87ea/pocs.tar.xz)&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;GNOME/gdk-pixbuf&quot;,&quot;iid&quot;:190,&quot;issuableId&quot;:116089,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:56528,&quot;authorName&quot;:&quot;Pedro Ribeiro&quot;,&quot;authorUsername&quot;:&quot;pedrib&quot;,&quot;authorWebUrl&quot;:&quot;/pedrib&quot;,&quot;createdAt&quot;:&quot;2021-06-02T15:06:54+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;projectPath&quot;:&quot;gdk-pixbuf&quot;,&quot;projectId&quot;:1548,&quot;projectNamespace&quot;:&quot;GNOME&quot;,&quot;updatedAt&quot;:&quot;2021-06-02T15:09:01+00:00&quot;,&quot;updatedBy&quot;:{&quot;name&quot;:&quot;Pedro Ribeiro&quot;,&quot;path&quot;:&quot;/pedrib&quot;}}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">(CVE-2021-46829) Buffer overwrite in io-gif-animation.c composite_frame() (possibly exploitable)</h1>
</div>
<div class="description">
<div class="md"><p data-sourcepos="1:1-1:149" dir="auto">I have been fuzzing gdk-pixbuf and found an interesting bug. I did limited research on it, but the bug appears to be an exploitable memory overwrite.</p>&#x000A;<p data-sourcepos="3:1-3:177" dir="auto">The bug is in composite_frame() in io-gif-animation.c, which I pasted below. It can be triggered by running gdk-pixbuf-pixdata with any of the poc files attached to this report.</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="5:1-30:3" data-canonical-lang="c" class="code highlight js-syntax-highlight language-c" v-pre="true"><code><span id="LC1" class="line" lang="c">		<span class="n">pixels</span> <span class="o">=</span> <span class="n">gdk_pixbuf_get_pixels</span> <span class="p">(</span><span class="n">anim</span><span class="o">-&gt;</span><span class="n">last_frame_data</span><span class="p">);</span></span>&#x000A;<span id="LC2" class="line" lang="c">		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n_indexes</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span></span>&#x000A;<span id="LC3" class="line" lang="c">				<span class="n">guint8</span> <span class="n">index</span> <span class="o">=</span> <span class="n">index_buffer</span><span class="p">[</span><span class="n">i</span><span class="p">];</span></span>&#x000A;<span id="LC4" class="line" lang="c">				<span class="n">guint</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span></span>&#x000A;<span id="LC5" class="line" lang="c">				<span class="kt">int</span> <span class="n">offset</span><span class="p">;</span></span>&#x000A;<span id="LC6" class="line" lang="c"></span>&#x000A;<span id="LC7" class="line" lang="c">				<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">==</span> <span class="n">frame</span><span class="o">-&gt;</span><span class="n">transparent_index</span><span class="p">)</span></span>&#x000A;<span id="LC8" class="line" lang="c">						<span class="k">continue</span><span class="p">;</span></span>&#x000A;<span id="LC9" class="line" lang="c"></span>&#x000A;<span id="LC10" class="line" lang="c">				<span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">frame</span><span class="o">-&gt;</span><span class="n">width</span> <span class="o">+</span> <span class="n">frame</span><span class="o">-&gt;</span><span class="n">x_offset</span><span class="p">;</span></span>&#x000A;<span id="LC11" class="line" lang="c">				<span class="n">y</span> <span class="o">=</span> <span class="n">interlace_rows</span><span class="p">[</span><span class="n">i</span> <span class="o">/</span> <span class="n">frame</span><span class="o">-&gt;</span><span class="n">width</span><span class="p">]</span> <span class="o">+</span> <span class="n">frame</span><span class="o">-&gt;</span><span class="n">y_offset</span><span class="p">;</span></span>&#x000A;<span id="LC12" class="line" lang="c">				<span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">anim</span><span class="o">-&gt;</span><span class="n">width</span> <span class="o">||</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">anim</span><span class="o">-&gt;</span><span class="n">height</span><span class="p">)</span></span>&#x000A;<span id="LC13" class="line" lang="c">						<span class="k">continue</span><span class="p">;</span></span>&#x000A;<span id="LC14" class="line" lang="c"></span>&#x000A;<span id="LC15" class="line" lang="c">				<span class="n">offset</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="n">gdk_pixbuf_get_rowstride</span> <span class="p">(</span><span class="n">anim</span><span class="o">-&gt;</span><span class="n">last_frame_data</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">4</span><span class="p">;</span></span>&#x000A;<span id="LC16" class="line" lang="c">				<span class="kt">int</span> <span class="n">rowstride</span> <span class="o">=</span> <span class="n">gdk_pixbuf_get_rowstride</span> <span class="p">(</span><span class="n">anim</span><span class="o">-&gt;</span><span class="n">last_frame_data</span><span class="p">);</span></span>&#x000A;<span id="LC17" class="line" lang="c">				<span class="n">printf</span><span class="p">(</span><span class="s">"signed: y: %d x: %d height: %d width: %d rowstride: %d offset: %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">anim</span><span class="o">-&gt;</span><span class="n">height</span><span class="p">,</span> <span class="n">anim</span><span class="o">-&gt;</span><span class="n">width</span><span class="p">,</span> <span class="n">rowstride</span><span class="p">,</span> <span class="n">offset</span><span class="p">);</span></span>&#x000A;<span id="LC18" class="line" lang="c">				<span class="n">printf</span><span class="p">(</span><span class="s">"unsigned: y: %u x: %u height: %u width: %u rowstride: %u offset: %u</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">anim</span><span class="o">-&gt;</span><span class="n">height</span><span class="p">,</span> <span class="n">anim</span><span class="o">-&gt;</span><span class="n">width</span><span class="p">,</span> <span class="n">rowstride</span><span class="p">,</span> <span class="n">offset</span><span class="p">);</span></span>&#x000A;<span id="LC19" class="line" lang="c">				<span class="n">printf</span><span class="p">(</span><span class="s">"buf size: %u</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">gdk_pixbuf_get_byte_length</span> <span class="p">(</span><span class="n">anim</span><span class="o">-&gt;</span><span class="n">last_frame_data</span><span class="p">));</span></span>&#x000A;<span id="LC20" class="line" lang="c">				<span class="n">pixels</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame</span><span class="o">-&gt;</span><span class="n">color_map</span><span class="p">[</span><span class="n">index</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">0</span><span class="p">];</span></span>&#x000A;<span id="LC21" class="line" lang="c">				<span class="n">pixels</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame</span><span class="o">-&gt;</span><span class="n">color_map</span><span class="p">[</span><span class="n">index</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span></span>&#x000A;<span id="LC22" class="line" lang="c">				<span class="n">pixels</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame</span><span class="o">-&gt;</span><span class="n">color_map</span><span class="p">[</span><span class="n">index</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">];</span></span>&#x000A;<span id="LC23" class="line" lang="c">				<span class="n">pixels</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span></span>&#x000A;<span id="LC24" class="line" lang="c">		<span class="p">}</span></span></code></pre>&#x000A;<copy-code></copy-code><insert-code-snippet></insert-code-snippet>&#x000A;</div>&#x000A;<p data-sourcepos="32:1-33:107" dir="auto">Note that the <code data-sourcepos="32:16-32:21">printf</code> were added by me to aid in debugging.&#x000A;The problem appears to be in the calculation of the offset variable. Actually there are two problems there:</p>&#x000A;<ol data-sourcepos="35:1-37:0" dir="auto">&#x000A;<li data-sourcepos="35:1-35:72">because it is a signed int, it can overwrite when it's over INT32_MAX</li>&#x000A;<li data-sourcepos="36:1-37:0">even if it was as an unsigned int, given the calculations, it becomes quite easy to reach very large values</li>&#x000A;</ol>&#x000A;<p data-sourcepos="38:1-38:87" dir="auto">I am attaching two files here. The first is <code data-sourcepos="38:46-38:60">wrap_around.poc</code>, which gives this result:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="40:1-45:3" class="code highlight js-syntax-highlight language-plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">signed: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: -2011744996</span>&#x000A;<span id="LC2" class="line" lang="plaintext">unsigned: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: 2283222300</span>&#x000A;<span id="LC3" class="line" lang="plaintext">buf size: 2353510400</span>&#x000A;<span id="LC4" class="line" lang="plaintext">Segmentation fault</span></code></pre>&#x000A;<copy-code></copy-code><insert-code-snippet></insert-code-snippet>&#x000A;</div>&#x000A;<p data-sourcepos="47:1-48:35" dir="auto">As you can see, we've wrapped around and gone into a negative number, which causes a negative offset access on the buffer.&#x000A;This can be further checked in gdb:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="49:1-62:3" class="code highlight js-syntax-highlight language-plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">$r11   : 0x00007fff6b247010  →  0x0000000000000000</span>&#x000A;<span id="LC2" class="line" lang="plaintext">$r15   : 0xffffffff8817351c</span>&#x000A;<span id="LC3" class="line" lang="plaintext"></span>&#x000A;<span id="LC4" class="line" lang="plaintext">   0x55555556603b &lt;composite_frame+667&gt; lea    eax, [r10+r10*2]</span>&#x000A;<span id="LC5" class="line" lang="plaintext">   0x55555556603f &lt;composite_frame+671&gt; movsxd rdx, eax</span>&#x000A;<span id="LC6" class="line" lang="plaintext">   0x555555566042 &lt;composite_frame+674&gt; movzx  edx, BYTE PTR [rcx+rdx*1]</span>&#x000A;<span id="LC7" class="line" lang="plaintext"> → 0x555555566046 &lt;composite_frame+678&gt; mov    BYTE PTR [r11+r15*1], dl</span>&#x000A;<span id="LC8" class="line" lang="plaintext">   0x55555556604a &lt;composite_frame+682&gt; lea    edx, [rax+0x1]</span>&#x000A;<span id="LC9" class="line" lang="plaintext">   0x55555556604d &lt;composite_frame+685&gt; mov    rcx, QWORD PTR [rbp+0x20]</span>&#x000A;<span id="LC10" class="line" lang="plaintext">   0x555555566051 &lt;composite_frame+689&gt; add    eax, 0x2</span>&#x000A;<span id="LC11" class="line" lang="plaintext">   0x555555566054 &lt;composite_frame+692&gt; movsxd rdx, edx</span>&#x000A;<span id="LC12" class="line" lang="plaintext">   0x555555566057 &lt;composite_frame+695&gt; cdqe</span></code></pre>&#x000A;<copy-code></copy-code><insert-code-snippet></insert-code-snippet>&#x000A;</div>&#x000A;<p data-sourcepos="64:1-64:187" dir="auto">Here the value of $r11 is the pixels buffer, while r15 is the calculated output variable. Its value is 0xffffffff8817351c, which is exactly -2011744996 as printed out by my added printfs.</p>&#x000A;<p data-sourcepos="66:1-66:129" dir="auto">The second file I am attaching, <code data-sourcepos="66:34-66:49">more_trouble.poc</code>, shows that this can happen even with a smaller buffer. Its output results in:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="67:1-72:3" class="code highlight js-syntax-highlight language-plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">signed: y: 32896 x: 128 height: 65526 width: 18303 rowstride: 73212 offset: -1886584832</span>&#x000A;<span id="LC2" class="line" lang="plaintext">unsigned: y: 32896 x: 128 height: 65526 width: 18303 rowstride: 73212 offset: 2408382464</span>&#x000A;<span id="LC3" class="line" lang="plaintext">buf size: 502322216</span>&#x000A;<span id="LC4" class="line" lang="plaintext">Segmentation fault</span></code></pre>&#x000A;<copy-code></copy-code><insert-code-snippet></insert-code-snippet>&#x000A;</div>&#x000A;<p data-sourcepos="74:1-74:445" dir="auto">I haven't tried to exploit this, but looks to me that it is definitely exploitable. We can write to an arbitrary memory address, which is calculated using the offset variable. What I am not sure is how controllable that offset variable is; its value depends on the X and Y and other factors, which might influence the buffer size. I'm sure you know the code better than me and will be able to definitely tell if this is fully exploitable or not.</p>&#x000A;<p data-sourcepos="76:1-77:126" dir="auto">I also did a naive fix, which works perfectly to avoid this problem, but I'm not sure if its the correct way to go about it.&#x000A;You just need to introduce the following check after the offset calculation and before it is used to access the pixels buffer:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="78:1-81:3" data-canonical-lang="c" class="code highlight js-syntax-highlight language-c" v-pre="true"><code><span id="LC1" class="line" lang="c">		 <span class="n">gsize</span> <span class="n">len</span> <span class="o">=</span> <span class="n">gdk_pixbuf_get_byte_length</span> <span class="p">(</span><span class="n">anim</span><span class="o">-&gt;</span><span class="n">last_frame_data</span><span class="p">);</span></span>&#x000A;<span id="LC2" class="line" lang="c">		 <span class="n">g_assert</span> <span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;=</span> <span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="n">offset</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">);</span></span></code></pre>&#x000A;<copy-code></copy-code><insert-code-snippet></insert-code-snippet>&#x000A;</div>&#x000A;<p data-sourcepos="83:1-83:112" dir="auto">This seems to stop every memory overwrite from happening, here's the output of <code data-sourcepos="83:81-83:95">wrap_around.poc</code> with the patch:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="85:1-93:3" class="code highlight js-syntax-highlight language-plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">signed: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: -2011744996</span>&#x000A;<span id="LC2" class="line" lang="plaintext">unsigned: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: 2283222300</span>&#x000A;<span id="LC3" class="line" lang="plaintext">buf size: 2353510400</span>&#x000A;<span id="LC4" class="line" lang="plaintext">**</span>&#x000A;<span id="LC5" class="line" lang="plaintext">GdkPixbuf:ERROR:../gdk-pixbuf/io-gif-animation.c:390:composite_frame: assertion failed: (offset + 3 &lt;= len &amp;&amp; offset &gt; 0)</span>&#x000A;<span id="LC6" class="line" lang="plaintext">Bail out! GdkPixbuf:ERROR:../gdk-pixbuf/io-gif-animation.c:390:composite_frame: assertion failed: (offset + 3 &lt;= len &amp;&amp; offset &gt; 0)</span>&#x000A;<span id="LC7" class="line" lang="plaintext">Aborted</span></code></pre>&#x000A;<copy-code></copy-code><insert-code-snippet></insert-code-snippet>&#x000A;</div>&#x000A;<p data-sourcepos="95:1-95:68" dir="auto"><a data-sourcepos="95:1-95:68" href="/-/project/1548/uploads/6ff374b990a1f545877a122caf5a87ea/pocs.tar.xz" data-canonical-src="/uploads/6ff374b990a1f545877a122caf5a87ea/pocs.tar.xz" data-link="true" class="gfm">pocs.tar.xz</a></p></div>
</div>
<div class="edited-text gl-mt-4 gl-text-gray-500 gl-text-sm">Edited <time class="js-timeago issue-edited-ago js-issue-edited-ago" title="Jun 2, 2021 3:09pm" datetime="2021-06-02T15:09:01Z" data-toggle="tooltip" data-placement="bottom" data-container="body">Jun 02, 2021</time> by <a class="author-link hover:gl-underline gl-text-gray-700 js-user-link" data-user-id="56528" data-username="pedrib" data-name="Pedro Ribeiro" href="/pedrib"><span class="">Pedro Ribeiro</span></a></div>
</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/1548/issues/190/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="gl-border-solid gl-border-1 gl-border-gray-100 gl-rounded-base gl-mt-5 gl-p-3 gl-text-center">
To upload designs, you'll need to enable LFS and have an admin enable hashed storage. <a href="/help/user/project/issues/design_management.md#prerequisites" target="_blank" rel="noopener noreferrer">More information</a>
</div>

<div class="js-work-item-links-root" data-full-path="GNOME/gdk-pixbuf" data-issuable-id="116089" data-issuable-iid="190" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-default-branch="master" data-wi-full-path="GNOME/gdk-pixbuf" data-wi-group-path="GNOME" data-wi-is-signed-in="false" data-wi-issues-list-path="/GNOME/gdk-pixbuf/-/issues" data-wi-labels-manage-path="/GNOME/gdk-pixbuf/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/GNOME/gdk-pixbuf/-/issues/190/links" data-full-path="GNOME/gdk-pixbuf" data-has-issue-weights-feature="false" data-has-iterations-feature="false" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="false" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-default-branch="master" data-wi-full-path="GNOME/gdk-pixbuf" data-wi-group-path="GNOME" data-wi-is-signed-in="false" data-wi-issues-list-path="/GNOME/gdk-pixbuf/-/issues" data-wi-labels-manage-path="/GNOME/gdk-pixbuf/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="true" data-iid="190" data-project-path="GNOME/gdk-pixbuf" id="js-related-merge-requests"></div>
<div data-url="/GNOME/gdk-pixbuf/-/issues/190/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:116089,&quot;iid&quot;:190,&quot;description&quot;:&quot;I have been fuzzing gdk-pixbuf and found an interesting bug. I did limited research on it, but the bug appears to be an exploitable memory overwrite.\n\nThe bug is in composite_frame() in io-gif-animation.c, which I pasted below. It can be triggered by running gdk-pixbuf-pixdata with any of the poc files attached to this report.\n\n```c\n\t\tpixels = gdk_pixbuf_get_pixels (anim-\u003elast_frame_data);\n\t\tfor (i = 0; i \u003c n_indexes; i++) {\n\t\t\t\tguint8 index = index_buffer[i];\n\t\t\t\tguint x, y;\n\t\t\t\tint offset;\n\n\t\t\t\tif (index == frame-\u003etransparent_index)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\tx = i % frame-\u003ewidth + frame-\u003ex_offset;\n\t\t\t\ty = interlace_rows[i / frame-\u003ewidth] + frame-\u003ey_offset;\n\t\t\t\tif (x \u003e= anim-\u003ewidth || y \u003e= anim-\u003eheight)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\toffset = y * gdk_pixbuf_get_rowstride (anim-\u003elast_frame_data) + x * 4;\n\t\t\t\tint rowstride = gdk_pixbuf_get_rowstride (anim-\u003elast_frame_data);\n\t\t\t\tprintf(\&quot;signed: y: %d x: %d height: %d width: %d rowstride: %d offset: %d\\n\&quot;, y, x, anim-\u003eheight, anim-\u003ewidth, rowstride, offset);\n\t\t\t\tprintf(\&quot;unsigned: y: %u x: %u height: %u width: %u rowstride: %u offset: %u\\n\&quot;, y, x, anim-\u003eheight, anim-\u003ewidth, rowstride, offset);\n\t\t\t\tprintf(\&quot;buf size: %u\\n\&quot;, gdk_pixbuf_get_byte_length (anim-\u003elast_frame_data));\n\t\t\t\tpixels[offset + 0] = frame-\u003ecolor_map[index * 3 + 0];\n\t\t\t\tpixels[offset + 1] = frame-\u003ecolor_map[index * 3 + 1];\n\t\t\t\tpixels[offset + 2] = frame-\u003ecolor_map[index * 3 + 2];\n\t\t\t\tpixels[offset + 3] = 255;\n\t\t}\n```\n\nNote that the `printf` were added by me to aid in debugging.\nThe problem appears to be in the calculation of the offset variable. Actually there are two problems there:\n\n1. because it is a signed int, it can overwrite when it&#39;s over INT32_MAX\n2. even if it was as an unsigned int, given the calculations, it becomes quite easy to reach very large values\n\nI am attaching two files here. The first is `wrap_around.poc`, which gives this result:\n\n```\nsigned: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: -2011744996\nunsigned: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: 2283222300\nbuf size: 2353510400\nSegmentation fault\n```\n\nAs you can see, we&#39;ve wrapped around and gone into a negative number, which causes a negative offset access on the buffer.\nThis can be further checked in gdb:\n```\n$r11   : 0x00007fff6b247010  →  0x0000000000000000\n$r15   : 0xffffffff8817351c\n\n   0x55555556603b \u003ccomposite_frame+667\u003e lea    eax, [r10+r10*2]\n   0x55555556603f \u003ccomposite_frame+671\u003e movsxd rdx, eax\n   0x555555566042 \u003ccomposite_frame+674\u003e movzx  edx, BYTE PTR [rcx+rdx*1]\n → 0x555555566046 \u003ccomposite_frame+678\u003e mov    BYTE PTR [r11+r15*1], dl\n   0x55555556604a \u003ccomposite_frame+682\u003e lea    edx, [rax+0x1]\n   0x55555556604d \u003ccomposite_frame+685\u003e mov    rcx, QWORD PTR [rbp+0x20]\n   0x555555566051 \u003ccomposite_frame+689\u003e add    eax, 0x2\n   0x555555566054 \u003ccomposite_frame+692\u003e movsxd rdx, edx\n   0x555555566057 \u003ccomposite_frame+695\u003e cdqe\n```\n\nHere the value of $r11 is the pixels buffer, while r15 is the calculated output variable. Its value is 0xffffffff8817351c, which is exactly -2011744996 as printed out by my added printfs.\n\nThe second file I am attaching, `more_trouble.poc`, shows that this can happen even with a smaller buffer. Its output results in:\n```\nsigned: y: 32896 x: 128 height: 65526 width: 18303 rowstride: 73212 offset: -1886584832\nunsigned: y: 32896 x: 128 height: 65526 width: 18303 rowstride: 73212 offset: 2408382464\nbuf size: 502322216\nSegmentation fault\n```\n\nI haven&#39;t tried to exploit this, but looks to me that it is definitely exploitable. We can write to an arbitrary memory address, which is calculated using the offset variable. What I am not sure is how controllable that offset variable is; its value depends on the X and Y and other factors, which might influence the buffer size. I&#39;m sure you know the code better than me and will be able to definitely tell if this is fully exploitable or not.\n\nI also did a naive fix, which works perfectly to avoid this problem, but I&#39;m not sure if its the correct way to go about it.\nYou just need to introduce the following check after the offset calculation and before it is used to access the pixels buffer:\n```c\n\t\t gsize len = gdk_pixbuf_get_byte_length (anim-\u003elast_frame_data);\n\t\t g_assert (offset + 3 \u003c= len \u0026\u0026 offset \u003e 0);\n```\n\nThis seems to stop every memory overwrite from happening, here&#39;s the output of `wrap_around.poc` with the patch:\n\n```\nsigned: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: -2011744996\nunsigned: y: 25926 x: 18759 height: 26725 width: 22016 rowstride: 88064 offset: 2283222300\nbuf size: 2353510400\n**\nGdkPixbuf:ERROR:../gdk-pixbuf/io-gif-animation.c:390:composite_frame: assertion failed: (offset + 3 \u003c= len \u0026\u0026 offset \u003e 0)\nBail out! GdkPixbuf:ERROR:../gdk-pixbuf/io-gif-animation.c:390:composite_frame: assertion failed: (offset + 3 \u003c= len \u0026\u0026 offset \u003e 0)\nAborted\n```\n\n[pocs.tar.xz](/uploads/6ff374b990a1f545877a122caf5a87ea/pocs.tar.xz)&quot;,&quot;title&quot;:&quot;(CVE-2021-46829) Buffer overwrite in io-gif-animation.c composite_frame() (possibly exploitable)&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:null,&quot;updated_by_id&quot;:362,&quot;created_at&quot;:&quot;2021-06-02T15:06:54Z&quot;,&quot;updated_at&quot;:&quot;2024-12-09T17:22:32Z&quot;,&quot;milestone&quot;:null,&quot;labels&quot;:[{&quot;id&quot;:3255,&quot;title&quot;:&quot;5. Loaders&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:null,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T13:04:08.097Z&quot;,&quot;updated_at&quot;:&quot;2018-05-22T13:04:08.097Z&quot;,&quot;group_id&quot;:null,&quot;project_id&quot;:1548,&quot;template&quot;:false},{&quot;id&quot;:5053,&quot;title&quot;:&quot;GIF&quot;,&quot;color&quot;:&quot;#A295D6&quot;,&quot;description&quot;:&quot;The Graphics Interchange Format loader&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-30T13:42:25.382Z&quot;,&quot;updated_at&quot;:&quot;2018-05-30T13:42:25.382Z&quot;,&quot;group_id&quot;:null,&quot;project_id&quot;:1548,&quot;template&quot;:false}],&quot;lock_version&quot;:4,&quot;author_id&quot;:56528,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[{&quot;id&quot;:76,&quot;username&quot;:&quot;robert.ancell&quot;,&quot;name&quot;:&quot;Robert Ancell&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://secure.gravatar.com/avatar/1630c33cf7c0cab8eea6806600cd04f5ca89945f437e5fb56fab9971ee3b767a?s=80\u0026d=identicon&quot;,&quot;web_url&quot;:&quot;https://gitlab.gnome.org/robert.ancell&quot;}],&quot;due_date&quot;:null,&quot;project_id&quot;:1548,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/GNOME/gdk-pixbuf/-/issues/190&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/GNOME/gdk-pixbuf/notes?target_id=116089\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/GNOME/gdk-pixbuf/-/preview_markdown?target_id=190\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:116089,&quot;projectId&quot;:1548,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/GNOME/gdk-pixbuf/-/issues/190/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/GNOME/gdk-pixbuf/-/issues/190.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/GNOME/gdk-pixbuf/-/issues/190.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/GNOME/gdk-pixbuf/noteable/issue/116089/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736342526000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-shadow-none gl-block " type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/GNOME/gdk-pixbuf/-/issues/190.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="1">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="" data-can-edit="" data-iid="190" data-issuable-type="issue" data-labels-fetch-path="/GNOME/gdk-pixbuf/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/GNOME/gdk-pixbuf/-/labels" data-project-issues-path="/GNOME/gdk-pixbuf/-/issues" data-project-path="GNOME/gdk-pixbuf" data-selected-labels="[{&quot;id&quot;:3255,&quot;title&quot;:&quot;5. Loaders&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:null,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T13:04:08.097Z&quot;,&quot;updated_at&quot;:&quot;2018-05-22T13:04:08.097Z&quot;,&quot;group_id&quot;:null,&quot;project_id&quot;:1548,&quot;template&quot;:false},{&quot;id&quot;:5053,&quot;title&quot;:&quot;GIF&quot;,&quot;color&quot;:&quot;#A295D6&quot;,&quot;description&quot;:&quot;The Graphics Interchange Format loader&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-30T13:42:25.382Z&quot;,&quot;updated_at&quot;:&quot;2018-05-30T13:42:25.382Z&quot;,&quot;group_id&quot;:null,&quot;project_id&quot;:1548,&quot;template&quot;:false}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="190" data-project-path="GNOME/gdk-pixbuf"></div>
</div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="js-sidebar-confidential-widget-root"></div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/GNOME/gdk-pixbuf/-/issues/190.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/GNOME/gdk-pixbuf/-/issues/190/toggle_subscription","moveIssueEndpoint":"/GNOME/gdk-pixbuf/-/issues/190/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=1548","editable":"","currentUser":{},"rootPath":"/","fullPath":"GNOME/gdk-pixbuf","iid":190,"id":116089,"severity":"unknown","timeTrackingLimitToHours":false,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false"}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script>
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script>
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

