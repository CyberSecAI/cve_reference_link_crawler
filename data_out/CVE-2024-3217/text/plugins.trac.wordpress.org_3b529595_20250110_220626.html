

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3064842%2Fwpdirectorykit%2Ftrunk%2Fapplication%2Fcontrollers%2FWdk_frontendajax.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3029364/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php "Changeset 3029364 for wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php")
* [Next Change](/changeset/3103627/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php "Changeset 3103627 for wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php") →

---

# Changeset [3064842](/changeset/3064842 "Show full changeset") for [wpdirectorykit/trunk/application/controllers/Wdk\_frontendajax.php](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3064842 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
04/04/2024 03:52:58 PM
([9 months](/timeline?from=2024-04-04T15%3A52%3A58Z&precision=second "See timeline at 04/04/2024 03:52:58 PM") ago)

Author:
sanwinter
Message:
# 1.3.1

* search\_rank allow in custom query in option of widget wdk-listings-results
* wdk-implode-shortcode, implode shortcode with profile\_id and listing\_id
* search form, hot fix
* security fixes/improvements

File:

1 edited

* [wpdirectorykit/trunk/application/controllers/Wdk\_frontendajax.php](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3064842 "Show entry in browser")
  (modified)
  ([8 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wpdirectorykit/trunk/application/controllers/Wdk\_frontendajax.php](/changeset/3064842/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php "Show the changeset 3064842 restricted to wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php")

  | [r3029364](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3029364#L127 "Show revision 3029364 of this file in browser") | [r3064842](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3064842#L127 "Show revision 3064842 of this file in browser") |  |
  | --- | --- | --- |
  | 127 | 127 |  |
  | 128 | 128 | $table\_name = substr($table,0, -2); |
  | 129 |  | $attr\_id = sanitize\_text\_field($parameters['attribute\_id']); |
  | 130 |  | $attr\_val = sanitize\_text\_field($parameters['attribute\_value']); |
  |  | 129 |  |
  |  | 130 | $attr\_id = preg\_replace("/[^0-9a-zA-Z\_\-]/", "",sanitize\_text\_field($parameters['attribute\_id'])); |
  |  | 131 | $attr\_val = preg\_replace("/[^0-9a-zA-Z\_\-]/", "",sanitize\_text\_field($parameters['attribute\_value'])); |
  |  | 132 |  |
  |  | 133 |  |
  | 131 | 134 | $attr\_search = sanitize\_text\_field($parameters['search\_term']); |
  | 132 | 135 | $skip\_id = intval($parameters['skip\_id']); |
  | […](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3029364#L177) | […](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3064842#L180) |  |
  | 177 | 180 |  |
  | 178 | 181 | $where["($id\_part $attr\_val\_sql LIKE '%$attr\_search%')"] = NULL; |
  | 179 |  |  |
  | 180 | 182 | } |
  | 181 | 183 |  |
  | […](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3029364#L235) | […](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3064842#L237) |  |
  | 235 | 237 |  |
  | 236 | 238 | } else { |
  | 237 |  | $tree\_results = $this->$table->get\_pagination(intval($parameters['limit']),intval($parameters['offset']), $where); |
  | 238 |  | } |
  | 239 |  |  |
  |  | 239 |  |
  |  | 240 | if(method\_exists($this->$table, 'get\_pagination\_simple')) { |
  |  | 241 | if($table == 'location\_m') { |
  |  | 242 | $this->db->select('location\_title, idlocation, level'); |
  |  | 243 | } else if($table == 'category\_m') { |
  |  | 244 | $this->db->select('category\_title, idcategory, level'); |
  |  | 245 | } |
  |  | 246 | $tree\_results = $this->$table->get\_pagination\_simple(intval($parameters['limit']),intval($parameters['offset']), $where); |
  |  | 247 | } else { |
  |  | 248 | $tree\_results = $this->$table->get\_pagination(intval($parameters['limit']),intval($parameters['offset']), $where); |
  |  | 249 | } |
  |  | 250 | } |
  | 240 | 251 | } |
  | 241 | 252 |  |
  | […](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3029364#L371) | […](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3064842#L382) |  |
  | 371 | 382 |  |
  | 372 | 383 | $table\_name = substr($table,0, -2); |
  | 373 |  | $attr\_id = sanitize\_text\_field($parameters['attribute\_id']); |
  | 374 |  | $attr\_val = sanitize\_text\_field($parameters['attribute\_value']); |
  |  | 384 | $attr\_id = preg\_replace("/[^0-9a-zA-Z\_\-]/", "",sanitize\_text\_field($parameters['attribute\_id'])); |
  |  | 385 | $attr\_val = preg\_replace("/[^0-9a-zA-Z\_\-]/", "",sanitize\_text\_field($parameters['attribute\_value'])); |
  |  | 386 |  |
  | 375 | 387 | $attr\_search = sanitize\_text\_field($parameters['search\_term']); |
  | 376 | 388 | $skip\_id = intval($parameters['skip\_id']); |
  | […](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3029364#L1231) | […](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3064842#L1243) |  |
  | 1231 | 1243 | $temp\_get = $\_GET; |
  | 1232 | 1244 | $\_GET = $custom\_parameters; |
  |  | 1245 | do\_action('wpdirectorykit/ajax/loading\_listings'); |
  |  | 1246 |  |
  | 1233 | 1247 | $data['output']['pagination\_html'] = wdk\_wp\_frontend\_paginate($data['output']['listings\_count'], $options['limit'], 'wmvc\_paged', array(), TRUE, |
  | 1234 | 1248 | FALSE, FALSE, $options['limit\_pagination']); |
  | […](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3029364#L1237) | […](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3064842#L1251) |  |
  | 1237 | 1251 | wdk\_prepare\_search\_query\_GET($columns, $controller.'\_m', $external\_columns, $custom\_parameters); |
  | 1238 | 1252 | $listings\_result = $this->listing\_m->get\_pagination($options['limit'], $offset, array('is\_activated' => 1,'is\_approved'=>1)); |
  |  | 1253 |  |
  | 1239 | 1254 | if(defined( 'WP\_DEBUG' ) && WP\_DEBUG) |
  | 1240 | 1255 | $data['listings\_result\_sql'] = $this->db->last\_query(); |
  | […](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3029364#L1305) | […](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3064842#L1320) |  |
  | 1305 | 1320 | } |
  | 1306 | 1321 |  |
  | 1307 |  |  |
  | 1308 | 1322 | } |
  | 1309 | 1323 |  |
  | […](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3029364#L1322) | […](/browser/wpdirectorykit/trunk/application/controllers/Wdk_frontendajax.php?rev=3064842#L1336) |  |
  | 1322 | 1336 | $pin\_icon = ""; |
  | 1323 | 1337 | $font\_class = ""; |
  | 1324 |  | $font\_icon = (wmvc\_show\_data('conf\_custom\_map\_pin\_icon', $~~get\_~~settings\_el\_map)) ? esc\_url($get\_settings\_el\_map->generate\_icon($settings\_el\_map['conf\_custom\_map\_pin\_icon'])) : '<i class="fa fa-home"></i>'; |
  | 1325 |  | $pin\_icon = (~~wmvc\_show\_data('conf\_custom\_map\_pin', $get\_settings\_el\_map)) ? esc\_url($~~settings\_el\_map['conf\_custom\_map\_pin']['url']) : ''; |
  |  | 1338 | $font\_icon = (wmvc\_show\_data('conf\_custom\_map\_pin\_icon', $settings\_el\_map)) ? esc\_url($get\_settings\_el\_map->generate\_icon($settings\_el\_map['conf\_custom\_map\_pin\_icon'])) : '<i class="fa fa-home"></i>'; |
  |  | 1339 | $pin\_icon = (isset( $settings\_el\_map['conf\_custom\_map\_pin'])) ? esc\_url($get\_settings\_el\_map['conf\_custom\_map\_pin']['url']) : ''; |
  | 1326 | 1340 |  |
  | 1327 | 1341 | if(wmvc\_show\_data('conf\_hide\_real\_location', $category) == 'yes') { |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3064842)
* [Zip Archive](?format=zip&new=3064842)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

