Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-3217

**Root Cause of Vulnerability:**
- The vulnerability stems from insufficient sanitization of user-supplied input in the `attribute_id` and `attribute_value` parameters within the `Wdk_frontendajax.php` controller. Specifically, the code uses `sanitize_text_field` which is inadequate to prevent SQL injection in this context. The vulnerability exists because the sanitized values are directly concatenated into an SQL query without proper parameterization or escaping.

**Weaknesses/Vulnerabilities Present:**
- **SQL Injection:** The lack of proper sanitization and escaping allows an attacker to inject arbitrary SQL code into the database query. This is facilitated by the vulnerable code at lines 178 and 384 which use preg_replace but do not sanitize enough to prevent injection, and then directly incorporate the sanitized parameters into a SQL query at line 183 and 404.

**Impact of Exploitation:**
- **Data Breach:** Attackers can potentially extract sensitive information from the database, including user credentials, personal data, and other confidential information.
- **Data Modification:** Attackers could modify or delete data within the database.
- **Privilege Escalation:** With the ability to execute arbitrary SQL queries, an attacker might be able to gain administrative privileges within the WordPress site or the database.

**Attack Vectors:**
- **HTTP POST Requests:** The vulnerability is exploited through HTTP POST requests to the `Wdk_frontendajax.php` endpoint.
- **`attribute_id` and `attribute_value` Parameters:** The malicious SQL code is injected through these POST parameters.

**Required Attacker Capabilities/Position:**
- **Authenticated Access:** Attackers need to have at least subscriber-level access to the WordPress site. This means they need to have a valid user account and be logged in.
- **Network Access:** The attack is executed remotely over the network via HTTP.

**Additional Information:**
- **Affected Plugin:** WP Directory Kit
- **Affected Versions:** All versions up to and including 1.3.0 are vulnerable.
- **Patched Version:** Version 1.3.1 and later versions include a fix for this vulnerability.
- **Code Location:** The vulnerable code is located in the `Wdk_frontendajax.php` file, specifically around lines 127-133, 173-183, 373-387 and 400-404.
- **Mitigation:** Users should update to version 1.3.1 or later to patch this vulnerability. The patch involves applying `preg_replace("/[^0-9a-zA-Z\_\-]/", "",sanitize_text_field($parameters['attribute_id']));` and `preg_replace("/[^0-9a-zA-Z\_\-]/", "",sanitize_text_field($parameters['attribute_value']));` to sanitize the vulnerable input parameters.