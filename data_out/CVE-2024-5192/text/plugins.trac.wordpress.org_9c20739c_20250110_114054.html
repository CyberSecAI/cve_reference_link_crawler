

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Ffunnel-builder%2Ftrunk%2Fmodules%2Fcheckouts%2Fincludes%2Fclass-wfacp-common-helper.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/funnel-builder/trunk/modules/checkouts/includes/class-wfacp-common-helper.php?rev=3122057 "Revision 3122057")
* Next Revision →
* [Blame](/browser/funnel-builder/trunk/modules/checkouts/includes/class-wfacp-common-helper.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/funnel-builder/trunk/modules/checkouts/includes/class-wfacp-common-helper.php)

---

# [source:](/browser?order=name "Go to repository root") [funnel-builder](/browser/funnel-builder?order=name "View funnel-builder")/[trunk](/browser/funnel-builder/trunk?order=name "View trunk")/[modules](/browser/funnel-builder/trunk/modules?order=name "View modules")/[checkouts](/browser/funnel-builder/trunk/modules/checkouts?order=name "View checkouts")/[includes](/browser/funnel-builder/trunk/modules/checkouts/includes?order=name "View includes")/[class-wfacp-common-helper.php](/browser/funnel-builder/trunk/modules/checkouts/includes/class-wfacp-common-helper.php?order=name "View class-wfacp-common-helper.php")

View diff against:

View revision:

| [Last change](/changeset/3139626/funnel-builder/trunk/modules/checkouts/includes/class-wfacp-common-helper.php "View differences") on this file was [3139626](/changeset/3139626/ "View changeset 3139626"), checked in by teamwoofunnels, [5 months ago](/timeline?from=2024-08-22T10%3A24%3A40Z&precision=second "See timeline at 08/22/2024 10:24:40 AM") |
| --- |
| trunk 3.5.0 |
| **File size:** 104.6 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | #[AllowDynamicProperties] |
| [4](#L4) | abstract class WFACP\_Common\_Helper { |
| [5](#L5) | private static $order\_bumps = []; |
| [6](#L6) | protected static $wfacp\_publish\_posts = []; |
| [7](#L7) | protected static $get\_saved\_pages = []; |
| [8](#L8) | protected static $ip\_data = []; |
| [9](#L9) | public static $global\_checkout\_page\_id = null; |
| [10](#L10) |  |
| [11](#L11) | public static function get\_geo\_ip() { |
| [12](#L12) | if ( isset( self::$ip\_data ) ) { |
| [13](#L13) | self::$ip\_data = WC\_Geolocation::geolocate\_ip(); |
| [14](#L14) | } |
| [15](#L15) |  |
| [16](#L16) | return self::$ip\_data; |
| [17](#L17) | } |
| [18](#L18) |  |
| [19](#L19) |  |
| [20](#L20) | public static function set\_session( $key, $data ) { |
| [21](#L21) |  |
| [22](#L22) | if ( empty( $data ) ) { |
| [23](#L23) | $data = []; |
| [24](#L24) | } |
| [25](#L25) |  |
| [26](#L26) | if ( ! is\_null( WC()->session ) ) { |
| [27](#L27) |  |
| [28](#L28) | WC()->session->set( 'wfacp\_' . $key . '\_' . WFACP\_Common::get\_id(), $data ); |
| [29](#L29) | } |
| [30](#L30) | } |
| [31](#L31) |  |
| [32](#L32) | public static function get\_session( $key ) { |
| [33](#L33) |  |
| [34](#L34) | if ( ! is\_null( WC()->session ) ) { |
| [35](#L35) | return WC()->session->get( 'wfacp\_' . $key . '\_' . WFACP\_Common::get\_id(), [] ); |
| [36](#L36) | } |
| [37](#L37) |  |
| [38](#L38) | return []; |
| [39](#L39) | } |
| [40](#L40) |  |
| [41](#L41) |  |
| [42](#L42) | public static function default\_design\_data() { |
| [43](#L43) | return [ |
| [44](#L44) | 'selected'        => 'embed\_forms\_1', |
| [45](#L45) | 'selected\_type'   => 'embed\_forms', |
| [46](#L46) | 'template\_active' => 'no', |
| [47](#L47) | ]; |
| [48](#L48) | } |
| [49](#L49) |  |
| [50](#L50) | public static function pc( $data ) { |
| [51](#L51) | if ( class\_exists( 'PC' ) && method\_exists( 'PC', 'debug' ) && ( true == apply\_filters( 'wfacp\_show\_debug\_logs', false ) ) ) { |
| [52](#L52) | PC::debug( $data ); |
| [53](#L53) | } |
| [54](#L54) | } |
| [55](#L55) |  |
| [56](#L56) | public static function is\_disabled() { |
| [57](#L57) | if ( isset( $\_REQUEST['wfacp\_disabled'] ) ) { |
| [58](#L58) | return true; |
| [59](#L59) | } |
| [60](#L60) |  |
| [61](#L61) | return false; |
| [62](#L62) | } |
| [63](#L63) |  |
| [64](#L64) | public static function pr( $arr ) { |
| [65](#L65) | echo '<br /><pre>'; |
| [66](#L66) | print\_r( $arr ); |
| [67](#L67) | echo '</pre><br />'; |
| [68](#L68) | } |
| [69](#L69) |  |
| [70](#L70) | public static function dump( $arr ) { |
| [71](#L71) | echo '<pre>'; |
| [72](#L72) | var\_dump( $arr ); |
| [73](#L73) | echo '</pre>'; |
| [74](#L74) | } |
| [75](#L75) |  |
| [76](#L76) | public static function export( $arr ) { |
| [77](#L77) | echo '<pre>'; |
| [78](#L78) | var\_export( $arr ); |
| [79](#L79) | echo '</pre>'; |
| [80](#L80) | } |
| [81](#L81) |  |
| [82](#L82) | /\*\* |
| [83](#L83) | \* Check our customizer page is open or not |
| [84](#L84) | \* @return bool |
| [85](#L85) | \*/ |
| [86](#L86) | public static function is\_customizer() { |
| [87](#L87) | if ( isset( $\_REQUEST['wfacp\_customize'] ) && $\_REQUEST['wfacp\_customize'] == 'loaded' && isset( $\_REQUEST['wfacp\_id'] ) && $\_REQUEST['wfacp\_id'] > 0 ) { |
| [88](#L88) | return true; |
| [89](#L89) | } |
| [90](#L90) |  |
| [91](#L91) | return false; |
| [92](#L92) | } |
| [93](#L93) |  |
| [94](#L94) |  |
| [95](#L95) | public static function get\_checkout\_page\_version() { |
| [96](#L96) | $version = WFACP\_Common::get\_post\_meta\_data( WFACP\_Common::get\_id(), '\_wfacp\_version' ); |
| [97](#L97) |  |
| [98](#L98) | return empty( $version ) ? '1.0.0' : $version; |
| [99](#L99) | } |
| [100](#L100) |  |
| [101](#L101) | public static function maybe\_convert\_html\_tag( $val ) { |
| [102](#L102) | //      new WP\_Customize\_Manager(); |
| [103](#L103) | if ( false === is\_string( $val ) ) { |
| [104](#L104) | return $val; |
| [105](#L105) | } |
| [106](#L106) | $val = str\_replace( '&lt;', '<', $val ); |
| [107](#L107) | $val = str\_replace( '&gt;', '>', $val ); |
| [108](#L108) |  |
| [109](#L109) | return $val; |
| [110](#L110) | } |
| [111](#L111) |  |
| [112](#L112) | public static function date\_i18n( $timestamp = '' ) { |
| [113](#L113) | if ( '' == $timestamp ) { |
| [114](#L114) | $timestamp = time(); |
| [115](#L115) | } |
| [116](#L116) |  |
| [117](#L117) | return date\_i18n( apply\_filters( 'wfacp\_date\_i18n\_format', get\_option( 'date\_format', 'M jS, Y' ) ), $timestamp ); |
| [118](#L118) | } |
| [119](#L119) |  |
| [120](#L120) | public static function include\_notification\_class( $get\_global\_path ) { |
| [121](#L121) |  |
| [122](#L122) | require\_once $get\_global\_path . 'includes/class-woofunnels-notifications.php'; |
| [123](#L123) | } |
| [124](#L124) |  |
| [125](#L125) | /\*\* |
| [126](#L126) | \* Get default global setting Error Messages |
| [127](#L127) | \* @return array |
| [128](#L128) | \*/ |
| [129](#L129) | public static function get\_error\_message() { |
| [130](#L130) |  |
| [131](#L131) | $msg = [ |
| [132](#L132) | 'required' => \_\_( 'is required field', 'funnel-builder' ), |
| [133](#L133) | 'invalid'  => \_\_( 'is not a valid', 'funnel-builder' ), |
| [134](#L134) |  |
| [135](#L135) | ]; |
| [136](#L136) |  |
| [137](#L137) | return $msg; |
| [138](#L138) |  |
| [139](#L139) | } |
| [140](#L140) |  |
| [141](#L141) | /\*\* |
| [142](#L142) | \* Check cart all product is boolean |
| [143](#L143) | \* @return bool |
| [144](#L144) | \*/ |
| [145](#L145) | public static function is\_cart\_is\_virtual() { |
| [146](#L146) | if ( is\_null( WC()->cart ) ) { |
| [147](#L147) | return false; |
| [148](#L148) | } |
| [149](#L149) | $cart\_items      = WC()->cart->get\_cart\_contents(); |
| [150](#L150) | $virtual\_product = 0; |
| [151](#L151) | if ( ! empty( $cart\_items ) ) { |
| [152](#L152) | foreach ( $cart\_items as $key => $cart\_item ) { |
| [153](#L153) | $pro = $cart\_item['data']; |
| [154](#L154) | if ( $pro instanceof WC\_Product && $pro->is\_virtual() ) { |
| [155](#L155) | $virtual\_product ++; |
| [156](#L156) | } |
| [157](#L157) | } |
| [158](#L158) | } |
| [159](#L159) | if ( count( $cart\_items ) == $virtual\_product ) { |
| [160](#L160) | return true; |
| [161](#L161) | } |
| [162](#L162) |  |
| [163](#L163) | return false; |
| [164](#L164) | } |
| [165](#L165) |  |
| [166](#L166) | public static function get\_saved\_pages() { |
| [167](#L167) | if ( ! empty( self::$get\_saved\_pages ) ) { |
| [168](#L168) | return self::$get\_saved\_pages; |
| [169](#L169) | } |
| [170](#L170) | global $wpdb; |
| [171](#L171) | $slug                  = WFACP\_Common::get\_post\_type\_slug(); |
| [172](#L172) | self::$get\_saved\_pages = $wpdb->get\_results( "SELECT `ID`, `post\_title`, `post\_type` FROM `{$wpdb->prefix}posts` WHERE `post\_type` = '{$slug}' AND `post\_title` != '' AND `post\_status` = 'publish' ORDER BY `post\_title` ASC", ARRAY\_A ); |
| [173](#L173) |  |
| [174](#L174) | return self::$get\_saved\_pages; |
| [175](#L175) | } |
| [176](#L176) |  |
| [177](#L177) | public static function get\_class\_path( $class = 'WFACP\_Core' ) { |
| [178](#L178) | $reflector = new ReflectionClass( $class ); |
| [179](#L179) | $fn        = $reflector->getFileName(); |
| [180](#L180) |  |
| [181](#L181) | return dirname( $fn ); |
| [182](#L182) | } |
| [183](#L183) |  |
| [184](#L184) | public static function get\_function\_path( $class = 'WFACP\_Core()' ) { |
| [185](#L185) | $reflector = new ReflectionFunction( $class ); |
| [186](#L186) | $fn        = $reflector->getFileName(); |
| [187](#L187) |  |
| [188](#L188) | return dirname( $fn ); |
| [189](#L189) | } |
| [190](#L190) |  |
| [191](#L191) |  |
| [192](#L192) | /\*\* |
| [193](#L193) | \* Detect builder page is open |
| [194](#L194) | \* @return bool |
| [195](#L195) | \*/ |
| [196](#L196) |  |
| [197](#L197) | public static function is\_builder() { |
| [198](#L198) | if ( is\_admin() && isset( $\_GET['page'] ) && 'wfacp' == $\_GET['page'] ) { |
| [199](#L199) | return true; |
| [200](#L200) | } |
| [201](#L201) |  |
| [202](#L202) | return false; |
| [203](#L203) |  |
| [204](#L204) | } |
| [205](#L205) |  |
| [206](#L206) |  |
| [207](#L207) | public static function is\_theme\_builder() { |
| [208](#L208) |  |
| [209](#L209) | return apply\_filters( 'wfacp\_is\_theme\_builder', self::is\_customizer() ); |
| [210](#L210) | } |
| [211](#L211) |  |
| [212](#L212) | public static function is\_edit\_screen\_open() { |
| [213](#L213) | $status = false; |
| [214](#L214) | if ( isset( $\_REQUEST['wfacp\_customize'] ) || isset( $\_REQUEST['wfacp\_id'] ) ) { |
| [215](#L215) | $status = true; |
| [216](#L216) | } |
| [217](#L217) |  |
| [218](#L218) | return apply\_filters( 'wfacp\_is\_edit\_screen\_open', $status ); |
| [219](#L219) | } |
| [220](#L220) |  |
| [221](#L221) | public static function get\_date\_format() { |
| [222](#L222) | return get\_option( 'date\_format', '' ) . ' ' . get\_option( 'time\_format', '' ); |
| [223](#L223) | } |
| [224](#L224) |  |
| [225](#L225) | public static function posts\_per\_page() { |
| [226](#L226) | return apply\_filters( 'wfacp\_post\_per\_page', 10 ); |
| [227](#L227) | } |
| [228](#L228) |  |
| [229](#L229) |  |
| [230](#L230) | /\*\* |
| [231](#L231) | \* Checkout Placeorder button pressed and checout process started |
| [232](#L232) | \* @return bool |
| [233](#L233) | \*/ |
| [234](#L234) | public static function is\_checkout\_process() { |
| [235](#L235) | if ( isset( $\_REQUEST['\_wfacp\_post\_id'] ) && $\_REQUEST['\_wfacp\_post\_id'] > 0 ) { |
| [236](#L236) | return true; |
| [237](#L237) | } |
| [238](#L238) |  |
| [239](#L239) | return false; |
| [240](#L240) | } |
| [241](#L241) |  |
| [242](#L242) | public static function unset\_blank\_keys\_old( $data\_array ) { |
| [243](#L243) |  |
| [244](#L244) | foreach ( $data\_array as $key => $value ) { |
| [245](#L245) | if ( $value == '' ) { |
| [246](#L246) | unset( $data\_array[ $key ] ); |
| [247](#L247) | } |
| [248](#L248) | } |
| [249](#L249) |  |
| [250](#L250) | return $data\_array; |
| [251](#L251) | } |
| [252](#L252) |  |
| [253](#L253) | public static function unset\_blank\_keys( $array\_for\_check ) { |
| [254](#L254) | if ( is\_array( $array\_for\_check ) && count( $array\_for\_check ) > 0 ) { |
| [255](#L255) | foreach ( $array\_for\_check as $key => $value ) { |
| [256](#L256) | if ( is\_array( $value ) && count( $value ) > 0 ) { |
| [257](#L257) | continue; |
| [258](#L258) | } |
| [259](#L259) | if ( $value == '' ) { |
| [260](#L260) | unset( $array\_for\_check[ $key ] ); |
| [261](#L261) | } |
| [262](#L262) | } |
| [263](#L263) | } |
| [264](#L264) |  |
| [265](#L265) | return $array\_for\_check; |
| [266](#L266) |  |
| [267](#L267) | } |
| [268](#L268) |  |
| [269](#L269) |  |
| [270](#L270) | public static function default\_shipping\_placeholder\_text() { |
| [271](#L271) | return \_\_( 'Enter your address to view shipping options.', 'funnel-builder' ); |
| [272](#L272) | } |
| [273](#L273) |  |
| [274](#L274) |  |
| [275](#L275) | /\*\* |
| [276](#L276) | \* Disabled finale execution on our discounting |
| [277](#L277) | \*/ |
| [278](#L278) | public static function disable\_wcct\_pricing() { |
| [279](#L279) |  |
| [280](#L280) | if ( function\_exists( 'WCCT\_Core' ) && class\_exists( 'WCCT\_discount' ) ) { |
| [281](#L281) |  |
| [282](#L282) | add\_filter( 'wcct\_force\_do\_not\_run\_campaign', function ( $status, $instance ) { |
| [283](#L283) | $products = WC()->session->get( 'wfacp\_product\_data\_' . WFACP\_Common::get\_id() ); |
| [284](#L284) | if ( is\_array( $products ) && count( $products ) > 0 ) { |
| [285](#L285) |  |
| [286](#L286) | foreach ( $products as $index => $data ) { |
| [287](#L287) | $product\_id = absint( $data['id'] ); |
| [288](#L288) | if ( $data['parent\_product\_id'] && $data['parent\_product\_id'] > 0 ) { |
| [289](#L289) | $product\_id = absint( $data['parent\_product\_id'] ); |
| [290](#L290) | } |
| [291](#L291) | unset( $instance->single\_campaign[ $product\_id ] ); |
| [292](#L292) | $status = false; |
| [293](#L293) | } |
| [294](#L294) | } |
| [295](#L295) |  |
| [296](#L296) | return $status; |
| [297](#L297) |  |
| [298](#L298) | }, 10, 2 ); |
| [299](#L299) | } |
| [300](#L300) | } |
| [301](#L301) |  |
| [302](#L302) | /\*\* |
| [303](#L303) | \* Restrict discount apply on these our ajax action |
| [304](#L304) | \* |
| [305](#L305) | \* @param $actions |
| [306](#L306) | \* |
| [307](#L307) | \* @return array |
| [308](#L308) | \*/ |
| [309](#L309) | public static function wcct\_get\_restricted\_action( $actions ) { |
| [310](#L310) | $actions[] = 'wfacp\_add\_product'; |
| [311](#L311) | $actions[] = 'wfacp\_remove\_product'; |
| [312](#L312) | $actions[] = 'wfacp\_save\_products'; |
| [313](#L313) |  |
| [314](#L314) | $actions[] = 'wfacp\_addon\_product'; |
| [315](#L315) | $actions[] = 'wfacp\_remove\_addon\_product'; |
| [316](#L316) | $actions[] = 'wfacp\_switch\_product\_addon'; |
| [317](#L317) | $actions[] = 'wfacp\_update\_product\_qty'; |
| [318](#L318) | $actions[] = 'wfacp\_quick\_view\_ajax'; |
| [319](#L319) |  |
| [320](#L320) | return $actions; |
| [321](#L321) | } |
| [322](#L322) |  |
| [323](#L323) | public static function handling\_post\_data( $post\_data ) { |
| [324](#L324) | if ( isset( $post\_data['ship\_to\_different\_address'] ) && isset( $post\_data['wfacp\_billing\_same\_as\_shipping'] ) && $post\_data['wfacp\_billing\_same\_as\_shipping'] == 0 ) { |
| [325](#L325) | $address\_fields = [ 'address\_1', 'address\_2', 'city', 'postcode', 'country', 'state' ]; |
| [326](#L326) | foreach ( $address\_fields as $key => $val ) { |
| [327](#L327) | if ( isset( $\_POST[ 's\_' . $val ] ) ) { |
| [328](#L328) | $\_POST[ $val ] = filter\_input( INPUT\_POST, 's\_' . $val, FILTER\_UNSAFE\_RAW ); |
| [329](#L329) | } |
| [330](#L330) | } |
| [331](#L331) | } |
| [332](#L332) | } |
| [333](#L333) |  |
| [334](#L334) |  |
| [335](#L335) | public static function wcs\_cart\_totals\_shipping\_calculator\_html() { |
| [336](#L336) | include WFACP\_TEMPLATE\_COMMON . '/checkout/wcs\_cart\_totals\_shipping\_calculator\_html.php'; |
| [337](#L337) | } |
| [338](#L338) |  |
| [339](#L339) |  |
| [340](#L340) | public static function wcs\_cart\_totals\_shipping\_html() { |
| [341](#L341) | include WFACP\_TEMPLATE\_COMMON . '/checkout/wcs\_cart\_totals\_shipping\_html.php'; |
| [342](#L342) | } |
| [343](#L343) |  |
| [344](#L344) |  |
| [345](#L345) | public static function check\_wc\_validations\_billing( $address\_fields, $type ) { |
| [346](#L346) |  |
| [347](#L347) | $woocommerce\_checkout\_address\_2\_field = get\_option( 'woocommerce\_checkout\_address\_2\_field', 'optional' ); |
| [348](#L348) | $woocommerce\_checkout\_company\_field   = get\_option( 'woocommerce\_checkout\_company\_field', 'optional' ); |
| [349](#L349) | $requiredFor                          = false; |
| [350](#L350) | $requiredForCompany                   = false; |
| [351](#L351) | if ( 'required' === $woocommerce\_checkout\_address\_2\_field ) { |
| [352](#L352) | $requiredFor = true; |
| [353](#L353) | } |
| [354](#L354) | if ( 'required' === $woocommerce\_checkout\_company\_field ) { |
| [355](#L355) | $requiredForCompany = true; |
| [356](#L356) | } |
| [357](#L357) |  |
| [358](#L358) | if ( isset( $address\_fields['billing\_address\_2'] ) ) { |
| [359](#L359) | if ( ( isset( $address\_fields['billing\_address\_2']['required'] ) && false === $requiredFor ) ) { |
| [360](#L360) | unset( $address\_fields['billing\_address\_2']['required'] ); |
| [361](#L361) | } |
| [362](#L362) | } |
| [363](#L363) |  |
| [364](#L364) | if ( isset( $address\_fields['billing\_company'] ) ) { |
| [365](#L365) | if ( ( isset( $address\_fields['billing\_company']['required'] ) && false === $requiredForCompany ) ) { |
| [366](#L366) | unset( $address\_fields['billing\_company']['required'] ); |
| [367](#L367) | } |
| [368](#L368) | } |
| [369](#L369) |  |
| [370](#L370) | return $address\_fields; |
| [371](#L371) | } |
| [372](#L372) |  |
| [373](#L373) | public static function check\_wc\_validations\_shipping( $address\_fields, $type ) { |
| [374](#L374) |  |
| [375](#L375) | $woocommerce\_checkout\_address\_2\_field = get\_option( 'woocommerce\_checkout\_address\_2\_field', 'optional' ); |
| [376](#L376) | $woocommerce\_checkout\_company\_field   = get\_option( 'woocommerce\_checkout\_company\_field', 'optional' ); |
| [377](#L377) |  |
| [378](#L378) | $requiredFor        = false; |
| [379](#L379) | $requiredForCompany = false; |
| [380](#L380) | if ( 'required' === $woocommerce\_checkout\_address\_2\_field ) { |
| [381](#L381) | $requiredFor = true; |
| [382](#L382) | } |
| [383](#L383) |  |
| [384](#L384) | if ( 'required' === $woocommerce\_checkout\_company\_field ) { |
| [385](#L385) | $requiredForCompany = true; |
| [386](#L386) | } |
| [387](#L387) |  |
| [388](#L388) | if ( isset( $address\_fields['shipping\_address\_2'] ) ) { |
| [389](#L389) | if ( ( isset( $address\_fields['shipping\_address\_2']['required'] ) && false === $requiredFor ) ) { |
| [390](#L390) | unset( $address\_fields['shipping\_address\_2']['required'] ); |
| [391](#L391) | } |
| [392](#L392) | } |
| [393](#L393) | if ( isset( $address\_fields['shipping\_company'] ) ) { |
| [394](#L394) | if ( ( isset( $address\_fields['shipping\_company']['required'] ) && false === $requiredForCompany ) ) { |
| [395](#L395) | unset( $address\_fields['shipping\_company']['required'] ); |
| [396](#L396) | } |
| [397](#L397) | } |
| [398](#L398) |  |
| [399](#L399) | return $address\_fields; |
| [400](#L400) | } |
| [401](#L401) |  |
| [402](#L402) | /\*\* Do not sustain deleted item in remove\_cart\_item\_object |
| [403](#L403) | \* |
| [404](#L404) | \* @param $cart\_item\_key |
| [405](#L405) | \* @param $cart WC\_Cart |
| [406](#L406) | \*/ |
| [407](#L407) | public static function remove\_item\_deleted\_items( $cart\_item\_key, $cart ) { |
| [408](#L408) | unset( $cart->removed\_cart\_contents[ $cart\_item\_key ] ); |
| [409](#L409) | } |
| [410](#L410) |  |
| [411](#L411) | public static function remove\_src\_set( $attr ) { |
| [412](#L412) | if ( isset( $attr['srcset'] ) ) { |
| [413](#L413) | unset( $attr['srcset'] ); |
| [414](#L414) | } |
| [415](#L415) |  |
| [416](#L416) | return $attr; |
| [417](#L417) | } |
| [418](#L418) |  |
| [419](#L419) |  |
| [420](#L420) | public static function get\_product\_image( $product\_obj, $size = 'woocommerce\_thumbnail', $cart\_item = [], $cart\_item\_key = '' ) { |
| [421](#L421) | $image = ''; |
| [422](#L422) | if ( ! $product\_obj instanceof WC\_Product ) { |
| [423](#L423) | return $image; |
| [424](#L424) | } |
| [425](#L425) | if ( $product\_obj->get\_image\_id() ) { |
| [426](#L426) | $image = wp\_get\_attachment\_image\_src( $product\_obj->get\_image\_id(), $size, false ); |
| [427](#L427) | } elseif ( $product\_obj->get\_parent\_id() ) { |
| [428](#L428) | $parent\_product = wc\_get\_product( $product\_obj->get\_parent\_id() ); |
| [429](#L429) | $image          = self::get\_product\_image( $parent\_product, $size, $cart\_item, $cart\_item\_key ); |
| [430](#L430) | } |
| [431](#L431) |  |
| [432](#L432) | if ( is\_array( $image ) && isset( $image[0] ) ) { |
| [433](#L433) |  |
| [434](#L434) | $image\_src = apply\_filters( 'wfacp\_cart\_item\_thumbnail', $image[0], $cart\_item, $cart\_item\_key ); |
| [435](#L435) |  |
| [436](#L436) | $image\_html = '<img src="' . esc\_attr( $image\_src ) . '" alt="' . esc\_html( $product\_obj->get\_name() ) . '" width="' . esc\_attr( $image[1] ) . '" height="' . esc\_attr( $image[2] ) . '" />'; |
| [437](#L437) |  |
| [438](#L438) | return apply\_filters( 'wfacp\_product\_image\_thumbnail\_html', $image\_html, $cart\_item, $cart\_item\_key ); |
| [439](#L439) | } |
| [440](#L440) |  |
| [441](#L441) | $image = wc\_placeholder\_img( $size ); |
| [442](#L442) |  |
| [443](#L443) | return apply\_filters( 'wfacp\_product\_image\_thumbnail\_html', $image, $cart\_item, $cart\_item\_key ); |
| [444](#L444) |  |
| [445](#L445) |  |
| [446](#L446) | } |
| [447](#L447) |  |
| [448](#L448) | public static function array\_insert\_after( array $array, $key, array $new ) { |
| [449](#L449) | $keys  = array\_keys( $array ); |
| [450](#L450) | $index = array\_search( $key, $keys ); |
| [451](#L451) |  |
| [452](#L452) | $pos = false === $index ? count( $array ) : $index + 1; |
| [453](#L453) |  |
| [454](#L454) | return array\_merge( array\_slice( $array, 0, $pos ), $new, array\_slice( $array, $pos ) ); |
| [455](#L455) | } |
| [456](#L456) |  |
| [457](#L457) |  |
| [458](#L458) | public static function sort\_shipping( $available\_methods ) { |
| [459](#L459) |  |
| [460](#L460) | $global\_settings = get\_option( '\_wfacp\_global\_settings', [] ); |
| [461](#L461) | if ( isset( $global\_settings['wfacp\_set\_shipping\_method'] ) && false === wc\_string\_to\_bool( $global\_settings['wfacp\_set\_shipping\_method'] ) ) { |
| [462](#L462) | if ( true === apply\_filters( 'wfacp\_disable\_shipping\_sorting', true ) ) { |
| [463](#L463) | return $available\_methods; |
| [464](#L464) | } |
| [465](#L465) | } |
| [466](#L466) |  |
| [467](#L467) | uasort( $available\_methods, [ \_\_CLASS\_\_, 'short\_shipping\_method' ] ); |
| [468](#L468) |  |
| [469](#L469) | return $available\_methods; |
| [470](#L470) | } |
| [471](#L471) |  |
| [472](#L472) | /\*\* |
| [473](#L473) | \* Short shipping method low to high Cost |
| [474](#L474) | \* |
| [475](#L475) | \* @param $p1 |
| [476](#L476) | \* @param $p2 |
| [477](#L477) | \*/ |
| [478](#L478) | public static function short\_shipping\_method( $p1, $p2 ) { |
| [479](#L479) | if ( $p1 instanceof WC\_Shipping\_Rate && $p2 instanceof WC\_Shipping\_Rate ) { |
| [480](#L480) | if ( $p1->get\_cost() == $p2->get\_cost() ) { |
| [481](#L481) | return 0; |
| [482](#L482) | } |
| [483](#L483) |  |
| [484](#L484) | return ( $p1->get\_cost() < $p2->get\_cost() ) ? - 1 : 1; |
| [485](#L485) | } |
| [486](#L486) |  |
| [487](#L487) | return 0; |
| [488](#L488) | } |
| [489](#L489) |  |
| [490](#L490) |  |
| [491](#L491) | /\*\* |
| [492](#L492) | \* Get a shipping methods full label including price. |
| [493](#L493) | \* |
| [494](#L494) | \* @param WC\_Shipping\_Rate $method Shipping method rate data. |
| [495](#L495) | \* |
| [496](#L496) | \* @return string |
| [497](#L497) | \*/ |
| [498](#L498) | public static function wc\_cart\_totals\_shipping\_method\_cost( $method ) { |
| [499](#L499) | $output    = \_\_( 'Free', 'woocommerce' ); |
| [500](#L500) | $has\_cost  = 0 < $method->cost; |
| [501](#L501) | $hide\_cost = ! $has\_cost && in\_array( $method->get\_method\_id(), array( 'free\_shipping', 'local\_pickup' ), true ); |
| [502](#L502) |  |
| [503](#L503) | if ( $has\_cost && ! $hide\_cost ) { |
| [504](#L504) | $output = ''; |
| [505](#L505) | if ( WC()->cart->display\_prices\_including\_tax() ) { |
| [506](#L506) | $output .= wc\_price( $method->cost + $method->get\_shipping\_tax() ); |
| [507](#L507) | if ( $method->get\_shipping\_tax() > 0 && ! wc\_prices\_include\_tax() ) { |
| [508](#L508) | $output .= ' <small class="tax\_label">' . WC()->countries->inc\_tax\_or\_vat() . '</small>'; |
| [509](#L509) | } |
| [510](#L510) | } else { |
| [511](#L511) | $output .= wc\_price( $method->cost ); |
| [512](#L512) | if ( $method->get\_shipping\_tax() > 0 && wc\_prices\_include\_tax() ) { |
| [513](#L513) | $output .= ' <small class="tax\_label">' . WC()->countries->ex\_tax\_or\_vat() . '</small>'; |
| [514](#L514) | } |
| [515](#L515) | } |
| [516](#L516) | } |
| [517](#L517) |  |
| [518](#L518) | return apply\_filters( 'wc\_cart\_totals\_shipping\_method\_cost', $output, $method ); |
| [519](#L519) | } |
| [520](#L520) |  |
| [521](#L521) | /\*\* |
| [522](#L522) | \* Get a shipping methods full label including price. |
| [523](#L523) | \* |
| [524](#L524) | \* @param WC\_Shipping\_Rate $method Shipping method rate data. |
| [525](#L525) | \* |
| [526](#L526) | \* @return string |
| [527](#L527) | \*/ |
| [528](#L528) | public static function shipping\_method\_label( $method ) { |
| [529](#L529) |  |
| [530](#L530) | $status = apply\_filters( 'wfacp\_show\_shipping\_method\_label\_without\_tax\_string', true, $method ); |
| [531](#L531) | if ( true == $status ) { |
| [532](#L532) | $output = $method->get\_label(); |
| [533](#L533) | } else { |
| [534](#L534) | $output = wc\_cart\_totals\_shipping\_method\_label( $method ); |
| [535](#L535) | } |
| [536](#L536) |  |
| [537](#L537) | return apply\_filters( 'woocommerce\_cart\_shipping\_method\_full\_label', $output, $method ); |
| [538](#L538) | } |
| [539](#L539) |  |
| [540](#L540) |  |
| [541](#L541) | public static function get\_cart\_count( $items ) { |
| [542](#L542) | $count = 0; |
| [543](#L543) | if ( is\_array( $items ) && count( $items ) > 0 ) { |
| [544](#L544) | foreach ( $items as $item ) { |
| [545](#L545) | if ( isset( $item['\_wfob\_product'] ) || apply\_filters( 'wfacp\_exclude\_product\_cart\_count', false, $item ) ) { |
| [546](#L546) | continue; |
| [547](#L547) | } |
| [548](#L548) | $count ++; |
| [549](#L549) | } |
| [550](#L550) | } |
| [551](#L551) |  |
| [552](#L552) | return $count; |
| [553](#L553) |  |
| [554](#L554) | } |
| [555](#L555) |  |
| [556](#L556) | public static function wc\_cart\_totals\_shipping\_html( $colspan\_attr\_1 = '', $colspan\_attr\_2 = '' ) { |
| [557](#L557) | $packages = WC()->shipping->get\_packages(); |
| [558](#L558) | $first    = true; |
| [559](#L559) |  |
| [560](#L560) | foreach ( $packages as $i => $package ) { |
| [561](#L561) | $chosen\_method = isset( WC()->session->chosen\_shipping\_methods[ $i ] ) ? WC()->session->chosen\_shipping\_methods[ $i ] : ''; |
| [562](#L562) | $product\_names = array(); |
| [563](#L563) | if ( count( $packages ) > 1 ) { |
| [564](#L564) | foreach ( $package['contents'] as $item\_id => $values ) { |
| [565](#L565) | $product\_names[ $item\_id ] = $values['data']->get\_name() . ' &times;' . $values['quantity']; |
| [566](#L566) | } |
| [567](#L567) | $product\_names = apply\_filters( 'woocommerce\_shipping\_package\_details\_array', $product\_names, $package ); |
| [568](#L568) | } |
| [569](#L569) |  |
| [570](#L570) | wc\_get\_template( 'wfacp/checkout/cart-shipping.php', array( |
| [571](#L571) | 'package'                  => $package, |
| [572](#L572) | 'available\_methods'        => $package['rates'], |
| [573](#L573) | 'show\_package\_details'     => count( $packages ) > 1, |
| [574](#L574) | 'show\_shipping\_calculator' => is\_cart() && $first, |
| [575](#L575) | 'package\_details'          => implode( ', ', $product\_names ), |
| [576](#L576) | 'package\_name'             => apply\_filters( 'woocommerce\_shipping\_package\_name', ( ( $i + 1 ) > 1 ) ? sprintf( \_x( 'Shipping %d', 'shipping packages', 'woocommerce' ), ( $i + 1 ) ) : \_x( 'Shipping', 'shipping packages', 'woocommerce' ), $i, $package ), |
| [577](#L577) | 'index'                    => $i, |
| [578](#L578) | 'chosen\_method'            => $chosen\_method, |
| [579](#L579) | 'formatted\_destination'    => WC()->countries->get\_formatted\_address( $package['destination'], ', ' ), |
| [580](#L580) | 'has\_calculated\_shipping'  => WC()->customer->has\_calculated\_shipping(), |
| [581](#L581) | 'colspan\_attr\_1'           => $colspan\_attr\_1, |
| [582](#L582) | 'colspan\_attr\_2'           => $colspan\_attr\_2, |
| [583](#L583) | ) ); |
| [584](#L584) |  |
| [585](#L585) | $first = false; |
| [586](#L586) | } |
| [587](#L587) | } |
| [588](#L588) |  |
| [589](#L589) | /\*\* |
| [590](#L590) | \* Remove action for without instance method  class found and return object of class |
| [591](#L591) | \* |
| [592](#L592) | \* @param $hook |
| [593](#L593) | \* @param $cls string |
| [594](#L594) | \* @param string $function |
| [595](#L595) | \* |
| [596](#L596) | \* @return |null |
| [597](#L597) | \*/ |
| [598](#L598) | public static function remove\_actions( $hook, $cls, $function = '' ) { |
| [599](#L599) |  |
| [600](#L600) | global $wp\_filter; |
| [601](#L601) | $object = null; |
| [602](#L602) | if ( class\_exists( $cls ) && isset( $wp\_filter[ $hook ] ) && ( $wp\_filter[ $hook ] instanceof WP\_Hook ) ) { |
| [603](#L603) | $hooks = $wp\_filter[ $hook ]->callbacks; |
| [604](#L604) | foreach ( $hooks as $priority => $reference ) { |
| [605](#L605) | if ( is\_array( $reference ) && count( $reference ) > 0 ) { |
| [606](#L606) | foreach ( $reference as $index => $calls ) { |
| [607](#L607) | if ( isset( $calls['function'] ) && is\_array( $calls['function'] ) && count( $calls['function'] ) > 0 ) { |
| [608](#L608) | if ( is\_object( $calls['function'][0] ) ) { |
| [609](#L609) | $cls\_name = get\_class( $calls['function'][0] ); |
| [610](#L610) | if ( $cls\_name == $cls && $calls['function'][1] == $function ) { |
| [611](#L611) | $object = $calls['function'][0]; |
| [612](#L612) | unset( $wp\_filter[ $hook ]->callbacks[ $priority ][ $index ] ); |
| [613](#L613) | } |
| [614](#L614) | } elseif ( $index == $cls . '::' . $function ) { |
| [615](#L615) | // For Static Classess |
| [616](#L616) | $object = $cls; |
| [617](#L617) | unset( $wp\_filter[ $hook ]->callbacks[ $priority ][ $cls . '::' . $function ] ); |
| [618](#L618) | } |
| [619](#L619) | } |
| [620](#L620) | } |
| [621](#L621) | } |
| [622](#L622) | } |
| [623](#L623) | } elseif ( function\_exists( $cls ) && isset( $wp\_filter[ $hook ] ) && ( $wp\_filter[ $hook ] instanceof WP\_Hook ) ) { |
| [624](#L624) |  |
| [625](#L625) | $hooks = $wp\_filter[ $hook ]->callbacks; |
| [626](#L626) | foreach ( $hooks as $priority => $reference ) { |
| [627](#L627) | if ( is\_array( $reference ) && count( $reference ) > 0 ) { |
| [628](#L628) | foreach ( $reference as $index => $calls ) { |
| [629](#L629) | $remove = false; |
| [630](#L630) | if ( $index == $cls ) { |
| [631](#L631) | $remove = true; |
| [632](#L632) | } elseif ( isset( $calls['function'] ) && $cls == $calls['function'] ) { |
| [633](#L633) | $remove = true; |
| [634](#L634) | } |
| [635](#L635) | if ( true == $remove ) { |
| [636](#L636) | unset( $wp\_filter[ $hook ]->callbacks[ $priority ][ $cls ] ); |
| [637](#L637) | } |
| [638](#L638) | } |
| [639](#L639) | } |
| [640](#L640) | } |
| [641](#L641) | } |
| [642](#L642) |  |
| [643](#L643) | return $object; |
| [644](#L644) |  |
| [645](#L645) | } |
| [646](#L646) |  |
| [647](#L647) | public static function add\_actions( $hook, $function = '', $cls = '', $priority = 10 ) { |
| [648](#L648) |  |
| [649](#L649) | $status = false; |
| [650](#L650) | if ( empty( $function ) ) { |
| [651](#L651) | return $status; |
| [652](#L652) | } |
| [653](#L653) |  |
| [654](#L654) | if ( is\_null( $cls ) ) { |
| [655](#L655) | return $status; |
| [656](#L656) | } |
| [657](#L657) |  |
| [658](#L658) | if ( ! empty( $cls ) && method\_exists( $cls, $function ) ) { |
| [659](#L659) | add\_action( $hook, [ $cls, $function ], $priority ); |
| [660](#L660) | $status = true; |
| [661](#L661) |  |
| [662](#L662) | } elseif ( function\_exists( $function ) ) { |
| [663](#L663) | add\_action( $hook, $function, $priority ); |
| [664](#L664) | $status = true; |
| [665](#L665) | } |
| [666](#L666) |  |
| [667](#L667) | return $status; |
| [668](#L668) |  |
| [669](#L669) | } |
| [670](#L670) |  |
| [671](#L671) |  |
| [672](#L672) | /\*\* |
| [673](#L673) | \* Filter callback for finding variation attributes. |
| [674](#L674) | \* |
| [675](#L675) | \* @param WC\_Product\_Attribute $attribute Product attribute. |
| [676](#L676) | \* |
| [677](#L677) | \* @return bool |
| [678](#L678) | \*/ |
| [679](#L679) | private static function filter\_variation\_attributes( $attribute ) { |
| [680](#L680) | return true === $attribute->get\_variation(); |
| [681](#L681) | } |
| [682](#L682) |  |
| [683](#L683) | /\*\* |
| [684](#L684) | \* @param $cart\_item |
| [685](#L685) | \* @param $cart\_item\_key |
| [686](#L686) | \* @param $pro WC\_Product |
| [687](#L687) | \* @param $switcher\_settings |
| [688](#L688) | \* @param $product\_data |
| [689](#L689) | \* |
| [690](#L690) | \* @return mixed|void |
| [691](#L691) | \*/ |
| [692](#L692) |  |
| [693](#L693) |  |
| [694](#L694) | public static function order\_summary\_html( $args = [] ) { |
| [695](#L695) | if ( ! empty( $args ) ) { |
| [696](#L696) | WC()->session->set( 'wfacp\_order\_summary\_' . WFACP\_Common::get\_id(), $args ); |
| [697](#L697) | } |
| [698](#L698) | $path = WFACP\_TEMPLATE\_COMMON . '/order-summary.php'; |
| [699](#L699) | $path = apply\_filters( 'wfacp\_order\_summary\_template', $path ); |
| [700](#L700) | include $path; |
| [701](#L701) |  |
| [702](#L702) | } |
| [703](#L703) |  |
| [704](#L704) |  |
| [705](#L705) | public static function get\_builder\_localization() { |
| [706](#L706) | $data = []; |
| [707](#L707) |  |
| [708](#L708) | $stripe\_link                                          = "<a target='\_blank' href='https://docs.woocommerce.com/document/stripe/#section-7'>Stripe Apple Pay, Stripe Google Pay</a>"; |
| [709](#L709) | $amazonelink                                          = "<a target='\_blank' href='https://docs.woocommerce.com/document/amazon-payments-advanced/'>Amazon Pay</a>"; |
| [710](#L710) | $lock\_img                                             = '<img src="' . WFACP\_PLUGIN\_URL . '/admin/assets/img/lock.svg">'; |
| [711](#L711) | $data['global']                                       = [ |
| [712](#L712) | 'form\_has\_changes'                        => [ |
| [713](#L713) | 'title'             => \_\_( 'Changes have been made!', 'funnel-builder' ), |
| [714](#L714) | 'text'              => \_\_( 'You need to save changes before generating preview.', 'funnel-builder' ), |
| [715](#L715) | 'confirmButtonText' => \_\_( 'Yes, Save it!', 'funnel-builder' ), |
| [716](#L716) | 'cancelText'        => \_\_( 'Cancel', 'funnel-builder' ), |
| [717](#L717) | 'reverseButtons'    => true |
| [718](#L718) | ], |
| [719](#L719) | 'no\_products'                             => \_\_( 'No product associated with this checkout. You need to add minimum one product to generate preview', 'funnel-builder' ), |
| [720](#L720) | 'remove\_product'                          => [ |
| [721](#L721) | 'title'             => \_\_( 'Want to remove this product from checkout?', 'funnel-builder' ), |
| [722](#L722) | 'text'              => \_\_( "You are about to remove this product. This action cannot be undone. Cancel to stop, Remove to proceed.", 'funnel-builder' ), |
| [723](#L723) | 'confirmButtonText' => \_\_( 'Remove', 'funnel-builder' ), |
| [724](#L724) | 'type'              => 'error', |
| [725](#L725) | 'reverseButtons'    => true, |
| [726](#L726) | 'modal\_title'       => \_\_( 'Remove Product', 'funnel-builder' ), |
| [727](#L727) | ], |
| [728](#L728) | 'active'                                  => \_\_( 'Active', 'funnel-builder' ), |
| [729](#L729) | 'inactive'                                => \_\_( 'Inactive', 'funnel-builder' ), |
| [730](#L730) | 'add\_checkout'                            => [ |
| [731](#L731) | 'heading'           => \_\_( 'Title', 'funnel-builder' ), |
| [732](#L732) | 'post\_content'      => \_\_( 'Description', 'funnel-builder' ), |
| [733](#L733) | 'checkout\_url\_slug' => \_\_( 'URL Slug', 'funnel-builder' ), |
| [734](#L734) | ], |
| [735](#L735) | 'confirm\_button\_text'                     => \_\_( 'Remove', 'funnel-builder' ), |
| [736](#L736) | 'confirm\_button\_text\_ok'                  => \_\_( 'OK', 'funnel-buildert' ) . '&nbsp;<i class="dashicons dashicons-arrow-right-alt"></i>', |
| [737](#L737) | 'upgrade\_button\_text'                     => \_\_( 'Upgrade to PRO Now', 'funnel-builder' ), |
| [738](#L738) | 'billing\_email\_present\_only\_first\_step'   => \_\_( 'Billing Email field must be on step 1 for the form', 'funnel-builder' ), |
| [739](#L739) | 'cancel\_button\_text'                      => \_\_( 'Cancel', 'funnel-builder' ), |
| [740](#L740) | 'delete\_checkout\_page\_head'               => \_\_( 'Are you sure you want to delete this checkout page?', 'funnel-builder' ), |
| [741](#L741) | 'delete\_checkout\_page'                    => \_\_( 'Are you sure, you want to delete this permanently? This can`t be undone', 'funnel-builder' ), |
| [742](#L742) | 'add\_checkout\_page'                       => \_\_( 'New Checkout', 'funnel-builder' ), |
| [743](#L743) | 'edit\_checkout\_page'                      => \_\_( 'Edit Checkout Page', 'funnel-builder' ), |
| [744](#L744) | 'add\_checkout\_btn'                        => \_\_( 'Add', 'funnel-builder' ), |
| [745](#L745) | 'update\_btn'                              => \_\_( 'Update', 'funnel-builder' ), |
| [746](#L746) | 'data\_saving'                             => \_\_( 'Data Saving...', 'funnel-builder' ), |
| [747](#L747) | 'shortcode\_copy\_message'                  => \_\_( 'Shortcode Copied!', 'funnel-builder' ), |
| [748](#L748) | 'enable'                                  => \_\_( 'Enable', 'funnel-builder' ), |
| [749](#L749) | 'add\_product\_popup'                       => \_\_( 'Add Product', 'funnel-builder' ), |
| [750](#L750) | 'pro\_feature\_message\_heading'             => $lock\_img . \_\_( '{feature\_name} is a Pro Feature', 'funnel-builder' ), |
| [751](#L751) | 'pro\_feature\_message\_subheading'          => \_\_( "We're sorry, the {feature\_name} is not available on your plan. Please upgrade to the PRO plan to unlock all these awesome features.", 'funnel-builder' ), |
| [752](#L752) | 'pro\_feature\_product\_settings\_heading'    => $lock\_img . \_\_( 'Want to offer users different product options?', 'funnel-builder' ), |
| [753](#L753) | 'pro\_feature\_product\_settings\_subheading' => \_\_( 'Unlock this Pro feature now and experience the fully-loaded version.', 'funnel-builder' ), |
| [754](#L754) | 'swal\_delete\_modal\_title'                 => \_\_( 'Delete', 'funnel-builder' ), |
| [755](#L755) | 'swal\_remove\_modal\_title'                 => \_\_( 'Remove', 'funnel-builder' ), |
| [756](#L756) | 'changes\_saved'                           => \_\_( 'Changes saved', 'funnel-builder' ), |
| [757](#L757) | 'get\_pro\_link'                            => WFACP\_Common::get\_pro\_link(), |
| [758](#L758) | ]; |
| [759](#L759) | $data['error']                                        = [ |
| [760](#L760) | 400 => array( |
| [761](#L761) | 'title'             => \_\_( 'Oops! Unable to save this form', 'funnel-builder' ), |
| [762](#L762) | 'text'              => \_\_( 'This Forms contains extremely large options. Please increase server\'s max\_input\_vars limit. Not sure? Contact support.', 'funnel-builder' ), |
| [763](#L763) | 'confirmButtonText' => \_\_( 'Okay! Got it', 'funnel-builder' ), |
| [764](#L764) | 'type'              => 'error', |
| [765](#L765) | ), |
| [766](#L766) | 500 => array( |
| [767](#L767) | 'title'             => \_\_( 'Oops! Internal Server Error', 'funnel-builder' ), |
| [768](#L768) | 'text'              => '', |
| [769](#L769) | 'confirmButtonText' => \_\_( 'Okay! Got it', 'funnel-builder' ), |
| [770](#L770) | 'type'              => 'error', |
| [771](#L771) | ), |
| [772](#L772) | 502 => array( |
| [773](#L773) | 'title'             => \_\_( 'Oops! Bad Gateway', 'funnel-builder' ), |
| [774](#L774) | 'text'              => '', |
| [775](#L775) | 'confirmButtonText' => \_\_( 'Okay! Got it', 'funnel-builder' ), |
| [776](#L776) | 'type'              => 'error', |
| [777](#L777) | ) |
| [778](#L778) | ]; |
| [779](#L779) | $data['importer']                                     = [ |
| [780](#L780) | 'activate\_template' => [ |
| [781](#L781) | 'heading'     => \_\_( 'Are you sure you want to apply this template?', 'funnel-builder' ), |
| [782](#L782) | 'sub\_heading' => '', |
| [783](#L783) | 'button\_text' => \_\_( 'Yes, apply this template!', 'funnel-builder' ), |
| [784](#L784) | ], |
| [785](#L785) |  |
| [786](#L786) | 'add\_template'      => [ |
| [787](#L787) | 'heading'     => \_\_( 'Are you sure you want to import this template?', 'funnel-builder' ), |
| [788](#L788) | 'sub\_heading' => '', |
| [789](#L789) | 'button\_text' => \_\_( 'Yes, Import this template!', 'funnel-builder' ), |
| [790](#L790) | ], |
| [791](#L791) | 'remove\_template'   => [ |
| [792](#L792) | 'heading'     => \_\_( 'Are you sure you want to remove this template?', 'funnel-builder' ), |
| [793](#L793) | 'sub\_heading' => \_\_( 'You are about to remove this template. Any changes done to the current template will be lost. Cancel to stop, Remove to proceed.', 'funnel-builder' ), |
| [794](#L794) | 'button\_text' => \_\_( 'Remove', 'funnel-builder' ), |
| [795](#L795) | 'modal\_title' => \_\_( 'Remove Template', 'funnel-builder' ), |
| [796](#L796) | ], |
| [797](#L797) | 'failed\_import'     => \_\_( 'Oops! Something went wrong. Try again or contact support.', 'funnel-builder' ), |
| [798](#L798) | 'close\_prompt\_text' => \_\_( 'Close', 'funnel-builder' ), |
| [799](#L799) | ]; |
| [800](#L800) | $data['fields']                                       = [ |
| [801](#L801) | 'field\_id\_slug'                               => \_\_( 'Field ID', 'funnel-builder' ), |
| [802](#L802) | 'inputs'                                      => [ |
| [803](#L803) | 'active'   => \_\_( 'Active', 'funnel-builder' ), |
| [804](#L804) | 'inactive' => \_\_( 'Inactive', 'funnel-builder' ), |
| [805](#L805) | ], |
| [806](#L806) | 'section'                                     => [ |
| [807](#L807) | 'default\_sub\_heading' => \_\_( 'Example: Fields marked with \* are mandatory', 'funnel-builder' ), |
| [808](#L808) | 'default\_classes'     => '', |
| [809](#L809) | 'add\_heading'         => \_\_( 'Add Section', 'funnel-builder' ), |
| [810](#L810) | 'update\_heading'      => \_\_( 'Update', 'funnel-builder' ), |
| [811](#L811) | 'delete'              => \_\_( 'You are about to remove section {{section\_name}}. This action cannot be undone. Cancel to stop, Remove to proceed.', 'funnel-builder' ), |
| [812](#L812) | 'modal\_title'         => \_\_( 'Remove Section', 'funnel-builder' ), |
| [813](#L813) | 'fields'              => [ |
| [814](#L814) | 'heading'     => \_\_( 'Section Name', 'funnel-builder' ), |
| [815](#L815) | 'sub\_heading' => \_\_( 'Sub Heading', 'funnel-builder' ), |
| [816](#L816) | 'classes'     => \_\_( 'Classes', 'funnel-builder' ), |
| [817](#L817) | ], |
| [818](#L818) | ], |
| [819](#L819) | 'steps\_error\_msgs'                            => [ |
| [820](#L820) | 'single\_step' => \_\_( 'Step 1', 'funnel-builder' ), |
| [821](#L821) | 'two\_step'    => \_\_( 'Step 2', 'funnel-builder' ), |
| [822](#L822) | 'third\_step'  => \_\_( 'Step 3', 'funnel-builder' ), |
| [823](#L823) | ], |
| [824](#L824) | 'empty\_step\_error'                            => \_\_( 'can\'t be blank. Add a few fields or remove the step and save again.', 'funnel-builder' ), |
| [825](#L825) | 'input\_field\_error'                           => [ |
| [826](#L826) | 'billing\_email' => \_\_( 'Billing Email is required for processing payment', 'funnel-builder' ), |
| [827](#L827) | ], |
| [828](#L828) | 'same\_as\_billing'                             => \_\_( 'Enable checkbox to show above fields', 'funnel-builder' ), |
| [829](#L829) | 'same\_as\_billing\_label\_hint'                  => \_\_( 'This will make shipping address an optional checkbox when billing address is present in the form', 'funnel-builder' ), |
| [830](#L830) | 'same\_as\_shipping'                            => \_\_( 'Different from shipping address', 'funnel-builder' ), |
| [831](#L831) | 'same\_as\_shipping\_label\_hint'                 => \_\_( 'This will make shipping address an optional checkbox when billing address is present in the form', 'funnel-builder' ), |
| [832](#L832) | 'add\_new\_btn'                                 => \_\_( 'Add Section', 'funnel-builder' ), |
| [833](#L833) | 'update\_btn'                                  => \_\_( 'Update', 'funnel-builder' ), |
| [834](#L834) | 'show\_field\_label1'                           => \_\_( 'Status', 'funnel-builder' ), |
| [835](#L835) | 'show\_field\_label2'                           => \_\_( 'Label', 'funnel-builder' ), |
| [836](#L836) | 'show\_field\_label3'                           => \_\_( 'Placeholder', 'funnel-builder' ), |
| [837](#L837) | 'product\_you\_save\_merge\_tags'                 => \_\_( 'Merge Tags: {{quantity}},{{saving\_value}} or {{saving\_percentage}}', 'funnel-builder' ), |
| [838](#L838) | 'field\_types\_label'                           => \_\_( 'Field Type', 'funnel-builder' ), |
| [839](#L839) | 'field\_types'                                 => [ |
| [840](#L840) | [ |
| [841](#L841) | 'id'   => 'text', |
| [842](#L842) | 'name' => \_\_( 'Single Line Text', 'funnel-builder' ), |
| [843](#L843) | ], |
| [844](#L844) | [ |
| [845](#L845) | 'id'   => 'checkbox', |
| [846](#L846) | 'name' => \_\_( 'Checkbox', 'funnel-builder' ), |
| [847](#L847) | ], |
| [848](#L848) | [ |
| [849](#L849) | 'id'   => 'wfacp\_radio', |
| [850](#L850) | 'name' => \_\_( 'Radio', 'funnel-builder' ), |
| [851](#L851) | ], |
| [852](#L852) | [ |
| [853](#L853) | 'id'   => 'wfacp\_wysiwyg', |
| [854](#L854) | 'name' => \_\_( 'HTML', 'funnel-builder' ), |
| [855](#L855) | ], |
| [856](#L856) |  |
| [857](#L857) | [ |
| [858](#L858) | 'id'   => 'select', |
| [859](#L859) | 'name' => \_\_( 'Dropdown', 'funnel-builder' ), |
| [860](#L860) | ], |
| [861](#L861) | [ |
| [862](#L862) | 'id'   => 'select2', |
| [863](#L863) | 'name' => \_\_( 'Select2', 'funnel-builder' ), |
| [864](#L864) | ], |
| [865](#L865) | [ |
| [866](#L866) | 'id'   => 'multiselect', |
| [867](#L867) | 'name' => \_\_( 'Multi Select', 'funnel-builder' ), |
| [868](#L868) | ], |
| [869](#L869) |  |
| [870](#L870) | [ |
| [871](#L871) | 'id'   => 'textarea', |
| [872](#L872) | 'name' => \_\_( 'Paragraph Text', 'funnel-builder' ), |
| [873](#L873) | ], |
| [874](#L874) | [ |
| [875](#L875) | 'id'   => 'number', |
| [876](#L876) | 'name' => \_\_( 'Number', 'funnel-builder' ), |
| [877](#L877) | ], |
| [878](#L878) | [ |
| [879](#L879) | 'id'   => 'hidden', |
| [880](#L880) | 'name' => \_\_( 'Hidden', 'funnel-builder' ), |
| [881](#L881) | ], |
| [882](#L882) | [ |
| [883](#L883) | 'id'   => 'password', |
| [884](#L884) | 'name' => \_\_( 'Password', 'funnel-builder' ), |
| [885](#L885) | ], |
| [886](#L886) | [ |
| [887](#L887) | 'id'   => 'email', |
| [888](#L888) | 'name' => \_\_( 'Email', 'funnel-builder' ), |
| [889](#L889) | ], |
| [890](#L890) | ], |
| [891](#L891) | 'name\_field\_label'                            => \_\_( 'Field ID (Order Meta Key)', 'funnel-builder' ), |
| [892](#L892) | 'name\_field\_label\_hint'                       => \_\_( "Field ID (Order Meta Key) where value of this field gets stored. Use '\_' to seperate in case of multiple words. Example: date\_of\_birth", 'funnel-builder' ), |
| [893](#L893) | 'label\_field\_label'                           => \_\_( 'Label', 'funnel-builder' ), |
| [894](#L894) | 'options\_field\_label'                         => \_\_( 'Options (|) separated', 'funnel-builder' ), |
| [895](#L895) | 'default\_field\_label'                         => \_\_( 'Default', 'funnel-builder' ), |
| [896](#L896) | 'multiselect\_maximum\_selection'               => \_\_( 'Max number of selection', 'funnel-builder' ), |
| [897](#L897) | 'multiselect\_maximum\_error\_field\_label'       => \_\_( 'Error Message', 'funnel-builder' ), |
| [898](#L898) | 'multiselect\_maximum\_error'                   => \_\_( 'You can only select {maximum\_number} items', 'funnel-builder' ), |
| [899](#L899) | 'multiselect\_maximum\_selection\_default\_count' => '', |
| [900](#L900) | 'shipping\_field\_placeholder'                  => \_\_( 'Placeholder', 'funnel-builder' ), |
| [901](#L901) | 'shipping\_field\_placeholder\_hint'             => \_\_( 'Enter the default text for shipping method', 'funnel-builder' ), |
| [902](#L902) | 'default\_field\_placeholder'                   => \_\_( 'Default Value', 'funnel-builder' ), |
| [903](#L903) | 'order\_total\_breakup\_label'                   => \_\_( 'Detailed Summary', 'funnel-builder' ), |
| [904](#L904) | 'order\_total\_breakup\_hint'                    => \_\_( 'Enable this to show detailed summary including Subtotal, Coupon, Fees, Shipping and Taxes whichever are applicable.', 'funnel-builder' ), |
| [905](#L905) | 'order\_summary\_allow\_delete'                  => \_\_( 'Enable Product Deletion', 'funnel-builder' ), |
| [906](#L906) | 'order\_summary\_allow\_delete\_hint'             => \_\_( 'Enable this to show delete icon below item subtotal', 'funnel-builder' ), |
| [907](#L907) | 'default\_field\_checkbox\_options'              => [ |
| [908](#L908) | [ |
| [909](#L909) | 'id'   => '1', |
| [910](#L910) | 'name' => \_\_( 'True', 'funnel-builder' ), |
| [911](#L911) | ], |
| [912](#L912) | [ |
| [913](#L913) | 'id'   => '0', |
| [914](#L914) | 'name' => \_\_( 'False', 'funnel-builder' ), |
| [915](#L915) | ], |
| [916](#L916) | ], |
| [917](#L917) | 'placeholder\_field\_label'                     => \_\_( 'Placeholder', 'funnel-builder' ), |
| [918](#L918) | 'required\_field\_label'                        => \_\_( 'Required', 'funnel-builder' ), |
| [919](#L919) | 'address'                                     => [ |
| [920](#L920) | 'billing\_address\_first\_name\_hint' => \_\_( 'Please keep this field turned OFF, if you are using First name separate field in the form', 'funnel-builder' ), |
| [921](#L921) | 'billing\_address\_last\_name\_hint'  => \_\_( 'Please keep this field turned OFF, if you are using First name separate field in the form', 'funnel-builder' ), |
| [922](#L922) | 'first\_name'                      => \_\_( 'First Name', 'funnel-builder' ), |
| [923](#L923) | 'last\_name'                       => \_\_( 'Last Name', 'funnel-builder' ), |
| [924](#L924) | 'label'                           => \_\_( 'Label', 'funnel-builder' ), |
| [925](#L925) | 'placeholder'                     => \_\_( 'Placeholder', 'funnel-builder' ), |
| [926](#L926) | 'street\_address1'                 => \_\_( 'Street Address', 'funnel-builder' ), |
| [927](#L927) | 'street\_address2'                 => \_\_( 'Street Address 2', 'funnel-builder' ), |
| [928](#L928) | 'company'                         => \_\_( 'Company', 'funnel-builder' ), |
| [929](#L929) | 'city'                            => \_\_( 'City', 'funnel-builder' ), |
| [930](#L930) | 'state'                           => \_\_( 'State', 'funnel-builder' ), |
| [931](#L931) | 'zip'                             => \_\_( 'Zip/Postcode', 'funnel-builder' ), |
| [932](#L932) | 'country'                         => \_\_( 'Country', 'funnel-builder' ), |
| [933](#L933) | ], |
| [934](#L934) | 'add\_field'                                   => \_\_( 'Add Field', 'funnel-builder' ), |
| [935](#L935) | 'edit\_field'                                  => \_\_( 'Edit Field', 'funnel-builder' ), |
| [936](#L936) | 'shipping\_address\_message'                    => WFACP\_Common::default\_shipping\_placeholder\_text(), |
| [937](#L937) |  |
| [938](#L938) | 'show\_on\_thankyou'           => \_\_( 'Show On Thank You Page', 'funnel-builder' ), |
| [939](#L939) | 'show\_in\_email'              => \_\_( 'Show In Order Email', 'funnel-builder' ), |
| [940](#L940) | 'enable\_time\_date'           => \_\_( 'Enable Time', 'funnel-builder' ), |
| [941](#L941) | 'time\_format\_label'          => \_\_( 'Time Format', 'funnel-builder' ), |
| [942](#L942) | 'time\_format\_options'        => [ |
| [943](#L943) | [ |
| [944](#L944) | 'value' => '12', |
| [945](#L945) | 'name'  => \_\_( '12 Hours', 'funnel-builder' ), |
| [946](#L946) | ], |
| [947](#L947) | [ |
| [948](#L948) | 'value' => '24', |
| [949](#L949) | 'name'  => \_\_( '24 Hours', 'funnel-builder' ), |
| [950](#L950) | ], |
| [951](#L951) | ], |
| [952](#L952) | 'validation\_error'           => \_\_( 'Validation Error', 'funnel-builder' ), |
| [953](#L953) | 'delete\_c\_field'             => \_\_( 'Are you sure you want to delete field?', 'funnel-builder' ), |
| [954](#L954) | 'delete\_c\_field\_sub\_heading' => \_\_( 'You are about to delete field {{field\_name}}. This action cannot be undone. Cancel to stop, Delete to proceed.', 'funnel-builder' ), |
| [955](#L955) | 'delete\_modal'               => \_\_( 'Delete Field', 'funnel-builder' ), |
| [956](#L956) | 'yes\_delete\_the\_field'       => \_\_( 'Delete', 'funnel-builder' ), |
| [957](#L957) |  |
| [958](#L958) | ]; |
| [959](#L959) | $data['design']['section']                            = []; |
| [960](#L960) | $data['design']['settings']                           = []; |
| [961](#L961) | $data['settings']['radio\_fields']                     = [ |
| [962](#L962) | [ |
| [963](#L963) | 'value' => 'true', |
| [964](#L964) | 'name'  => \_\_( 'Yes', 'funnel-builder' ), |
| [965](#L965) | ], |
| [966](#L966) | [ |
| [967](#L967) | 'value' => 'false', |
| [968](#L968) | 'name'  => \_\_( 'No', 'funnel-builder' ), |
| [969](#L969) | ], |
| [970](#L970) | ]; |
| [971](#L971) | $data['settings']['preview\_section\_heading']          = \_\_( 'Heading (optional)', 'funnel-builder' ); |
| [972](#L972) | $data['settings']['preview\_section\_subheading']       = \_\_( 'Subheading (optional)', 'funnel-builder' ); |
| [973](#L973) | $data['settings']['preview\_field\_admin\_heading']      = '<span class="wfacp\_pro\_feature\_span" data-item="optimization">' . $lock\_img . '</span>' . \_\_( 'Multistep Field Preview', 'funnel-builder' ); |
| [974](#L974) | $data['settings']['preview\_field\_admin\_heading\_hint'] = \_\_( 'Enable this on multistep form to help user preview entered values at next steps. It helps user recap the information and prevent inadvertent errors.', 'funnel-builder' ); |
| [975](#L975) | $data['settings']['preview\_field\_admin\_note']         = \_\_( 'This Feature is available only for multistep form', 'funnel-builder' ); |
| [976](#L976) |  |
| [977](#L977) | $data['settings']['empty\_cart\_heading\_area']       = \_\_( 'Empty cart', 'funnel-builder' ); |
| [978](#L978) | $data['settings']['empty\_cart\_heading\_subheading'] = \_\_( 'Message when cart is empty', 'funnel-builder' ); |
| [979](#L979) | $data['settings']['empty\_cart\_heading']            = \_\_( 'Empty cart message', 'funnel-builder' ); |
| [980](#L980) | $data['settings']['empty\_cart\_heading\_hint']       = \_\_( 'Message when no product added to cart', 'funnel-builder' ); |
| [981](#L981) | $data['settings']['scripts']                       = [ |
| [982](#L982) | 'heading'                   => \_\_( 'Embed Script', 'funnel-builder' ), |
| [983](#L983) | 'sub\_heading'               => \_\_( 'Add custom scripts on checkout page', 'funnel-builder' ), |
| [984](#L984) | 'header\_heading'            => \_\_( 'Header', 'funnel-builder' ), |
| [985](#L985) | 'header\_script\_placeholder' => \_\_( 'Paste your code here', 'funnel-builder' ), |
| [986](#L986) | 'footer\_heading'            => \_\_( 'Footer', 'funnel-builder' ), |
| [987](#L987) | 'footer\_script\_placeholder' => \_\_( 'Paste your code here', 'funnel-builder' ), |
| [988](#L988) | ]; |
| [989](#L989) | $data['settings']['style']                         = [ |
| [990](#L990) | 'heading'                  => \_\_( 'Custom CSS', 'funnel-builder' ), |
| [991](#L991) | 'sub\_heading'              => \_\_( 'Add custom CSS on checkout page', 'funnel-builder' ), |
| [992](#L992) | 'header\_heading'           => \_\_( 'CSS', 'funnel-builder' ), |
| [993](#L993) | 'header\_style\_placeholder' => \_\_( 'Paste your CSS code here', 'funnel-builder' ), |
| [994](#L994) |  |
| [995](#L995) | ]; |
| [996](#L996) | $data['google\_autocomplete']                       = [ |
| [997](#L997) | 'heading'       => '<span class="wfacp\_pro\_feature\_span" data-item="optimization">' . $lock\_img . '</span>' . \_\_( 'Google Address Autocompletion', 'funnel-builder' ), |
| [998](#L998) | 'sub\_heading'   => \_\_( 'Enable this to provide address suggestions and let buyers quickly fill up form as they enter billing and shipping address.', 'funnel-builder' ), |
| [999](#L999) | 'country\_label' => \_\_( 'Disallow Countries (Optional)', 'funnel-builder' ), |
| [1000](#L1000) | ]; |
| [1001](#L1001) | $couponText                                        = \_\_( 'Enable this to surprise your buyers with special auto applied coupon. Reduces cart abandonment rate and discourages buyers from hunting coupons else where.', 'funnel-builder' ); |
| [1002](#L1002) |  |
| [1003](#L1003) | $data['settings']['coupons']                = [ |
| [1004](#L1004) | 'heading'                 => '<span class="wfacp\_pro\_feature\_span" data-item="optimization">' . $lock\_img . '</span>' . \_\_( 'Auto Apply Coupons', 'funnel-builder' ), |
| [1005](#L1005) | 'sub\_heading'             => $couponText, |
| [1006](#L1006) | 'auto\_add\_coupon\_heading' => \_\_( 'Auto Apply Coupon', 'woofunnels-aero-checkout' ), |
| [1007](#L1007) | 'coupon\_heading'          => \_\_( 'Coupon code', 'woocommerce' ), |
| [1008](#L1008) | 'search\_placeholder'      => \_\_( 'Enter coupon code here', 'woofunnels-aero-checkout' ), |
| [1009](#L1009) | 'select\_coupon'           => \_\_( 'Choose Coupon', 'woofunnels-aero-checkout' ), |
| [1010](#L1010) | 'disable\_coupon'          => \_\_( 'Disable Coupon Field', 'woofunnels-aero-checkout' ), |
| [1011](#L1011) | 'active'                  => \_\_( 'Active', 'woofunnels-aero-checkout' ), |
| [1012](#L1012) | 'inactive'                => \_\_( 'Inactive', 'woofunnels-aero-checkout' ), |
| [1013](#L1013) | ]; |
| [1014](#L1014) | $data['optimizations']['google']            = [ |
| [1015](#L1015) | 'heading'             => '<span class="wfacp\_pro\_feature\_span" data-item="optimization">' . $lock\_img . '</span>' . \_\_( 'Google Autocomplete', 'funnel-builder' ), |
| [1016](#L1016) | 'sub\_heading'         => \_\_( '', 'funnel-builder' ), |
| [1017](#L1017) | 'enable'              => \_\_( 'Enable google autocomplete', 'funnel-builder' ), |
| [1018](#L1018) | 'api\_key'             => \_\_( 'Enter Api Key', 'funnel-builder' ), |
| [1019](#L1019) | 'api\_key\_placeholder' => 'AIzaSyCJZg\_lvlTS7-2BXb5fZPEAekBs3bjOW-o', |
| [1020](#L1020) | 'api\_key\_hint'        => \_\_( 'Api Key', 'funnel-builder' ) . ' (https://developers.google.com/maps/documentation/javascript/get-api-key#key)', |
| [1021](#L1021) | ]; |
| [1022](#L1022) | $data['optimizations']['preferred\_country'] = [ |
| [1023](#L1023) | 'heading'     => '<span class="wfacp\_pro\_feature\_span" data-item="optimization">' . $lock\_img . '</span>' . \_\_( 'Preferred Countries', 'funnel-builder' ), |
| [1024](#L1024) | 'sub\_heading' => \_\_( 'By default, WooCommerce shows countries in alphabetical order. Enable this option to re-arrange the list such that your top selling countries are always on top', 'funnel-builder' ), |
| [1025](#L1025) | 'label'       => \_\_( 'Select Countries', 'funnel-builder' ), |
| [1026](#L1026) | 'placeholder' => ' ', |
| [1027](#L1027) | 'hint'        => 'US=United States, GB=United Kingdom,CA=CANADA', |
| [1028](#L1028) | ]; |
| [1029](#L1029) |  |
| [1030](#L1030) |  |
| [1031](#L1031) | $data['optimizations']['smart\_buttons']              = [ |
| [1032](#L1032) | 'heading'          => \_\_( 'Express Checkout Buttons', 'woofunnels-aero-checkout' ), |
| [1033](#L1033) | 'sub\_heading'      => \_\_( "Enable this to show smart buttons for $stripe\_link and $amazonelink for express checkout. For Stripe, Payment Request Buttons should be enabled and configured.", 'woofunnels-aero-checkout' ), |
| [1034](#L1034) | 'position\_heading' => \_\_( 'Choose Position', 'woofunnels-aero-checkout' ), |
| [1035](#L1035) | 'positions'        => self::smart\_buttons\_positions(), |
| [1036](#L1036) | ]; |
| [1037](#L1037) | $data['optimizations']['live\_validation']            = [ |
| [1038](#L1038) | 'heading'                => \_\_( 'Inline Field Validation', 'woofunnels-aero-checkout' ), |
| [1039](#L1039) | 'sub\_heading'            => \_\_( "Enable this to show the real time validation errors below the fields", 'woofunnels-aero-checkout' ), |
| [1040](#L1040) | 'enable\_live\_validation' => \_\_( 'Enable', 'woofunnels-aero-checkout' ), |
| [1041](#L1041) |  |
| [1042](#L1042) | ]; |
| [1043](#L1043) | $data['optimizations']['collapsible\_optional\_field'] = [ |
| [1044](#L1044) | 'heading'                              => \_\_( 'Collapsible Optional Field', 'woofunnels-aero-checkout' ), |
| [1045](#L1045) | 'sub\_heading'                          => \_\_( "Enable this to replace optional fields with a link and decrease form length ", 'woofunnels-aero-checkout' ), |
| [1046](#L1046) | 'collapsable\_link\_text'                => \_\_( 'Collapsable Prefix Label', 'woofunnels-aero-checkout' ), |
| [1047](#L1047) | 'collapsible\_optional\_link\_text'       => \_\_( "Add", 'woofunnels-aero-checkout' ), |
| [1048](#L1048) | 'collapsible\_optional\_field\_text\_hint' => \_\_( "Please enable this field in your checkout form to make it collapsable", 'woofunnels-aero-checkout' ), |
| [1049](#L1049) | 'collapsable\_hint\_text'                => \_\_( 'This text will appear as a prefix to the field label', 'woofunnels-aero-checkout' ), |
| [1050](#L1050) | ]; |
| [1051](#L1051) |  |
| [1052](#L1052) | $data['settings']['coupon']   = [ |
| [1053](#L1053) | 'success\_message\_heading'      => \_\_( 'Success message', 'woofunnels-aero-checkout' ), |
| [1054](#L1054) | 'success\_message\_heading\_hint' => \_\_( 'Use merge tags to display Coupon Code: {{coupon\_code}} & Coupon Value: {{coupon\_value}} in success message', 'woofunnels-aero-checkout' ), |
| [1055](#L1055) | 'remove\_message\_heading'       => \_\_( 'Failure message', 'woofunnels-aero-checkout' ), |
| [1056](#L1056) | 'style\_heading'                => \_\_( 'Collapsible', 'woofunnels-aero-checkout' ), |
| [1057](#L1057) | 'style\_options'                => [ |
| [1058](#L1058) | [ |
| [1059](#L1059) | 'value' => 'true', |
| [1060](#L1060) | 'name'  => \_\_( 'yes', 'woofunnels-aero-checkout' ), |
| [1061](#L1061) | ], |
| [1062](#L1062) | [ |
| [1063](#L1063) | 'value' => 'false', |
| [1064](#L1064) | 'name'  => \_\_( 'no', 'woofunnels-aero-checkout' ), |
| [1065](#L1065) | ], |
| [1066](#L1066) | ], |
| [1067](#L1067) | 'sub\_heading'                  => \_\_( 'You can manage the quantity increment, quick view provision from here', 'woofunnels-aero-checkout' ), |
| [1068](#L1068) | ]; |
| [1069](#L1069) | $timezone\_heading             = \_\_( 'Enable this to set expiry of checkout page after certain sales or at a particular date. Used for generating scarcity during time sensitive campaigns.', 'woofunnels-aero-checkout' ); |
| [1070](#L1070) | $timezone\_text                = \_\_( '<p>Note: The settings are only applicable for product specific checkout pages or order forms</p>', 'woofunnels-aero-checkout' ); |
| [1071](#L1071) | $data['settings']['advanced'] = [ |
| [1072](#L1072) | 'heading'                           => '<span class="wfacp\_pro\_feature\_span" data-item="optimization">' . $lock\_img . '</span>' . \_\_( 'Time Checkout Expiry', 'woofunnels-aero-checkout' ), |
| [1073](#L1073) | 'sub\_heading'                       => $timezone\_heading . $timezone\_text, |
| [1074](#L1074) | 'close\_after'                       => \_\_( 'Close This checkout Page After # of Orders', 'funnel-builder' ), |
| [1075](#L1075) | 'close\_checkout\_after\_date'         => \_\_( 'Close Checkout After Date', 'funnel-builder' ), |
| [1076](#L1076) | 'total\_purchased\_allowed'           => \_\_( 'Total Orders Allowed', 'funnel-builder' ), |
| [1077](#L1077) | 'total\_purchased\_allowed\_hint'      => \_\_( 'After given number of order made, disable this checkout page and redirect buyer to a specified URL', 'funnel-builder' ), |
| [1078](#L1078) | 'total\_purchased\_redirect\_url'      => \_\_( 'Redirect URL', 'funnel-builder' ), |
| [1079](#L1079) | 'total\_purchased\_redirect\_url\_hint' => \_\_( 'Buyer will be redirect to given URL here', 'funnel-builder' ), |
| [1080](#L1080) | 'close\_checkout\_on'                 => \_\_( 'Close Checkout On', 'funnel-builder' ), |
| [1081](#L1081) | 'close\_checkout\_on\_hint'            => \_\_( 'Set the date to close this checkout page', 'funnel-builder' ), |
| [1082](#L1082) | 'close\_checkout\_redirect\_url'       => \_\_( 'Closed Checkout Redirect URL', 'funnel-builder' ), |
| [1083](#L1083) | 'close\_checkout\_redirect\_url\_hint'  => \_\_( 'Buyer will be redirect to given URL here', 'funnel-builder' ), |
| [1084](#L1084) | 'note\_for\_global\_checkout'          => \_\_( 'Note: These settings are only applicable for dedicated checkout page', 'funnel-builder' ), |
| [1085](#L1085) |  |
| [1086](#L1086) | ]; |
| [1087](#L1087) |  |
| [1088](#L1088) | $data['settings']['autopopulate\_fields'] = [ |
| [1089](#L1089) | 'heading'     => '<span class="wfacp\_pro\_feature\_span" data-item="optimization">' . $lock\_img . '</span>' . \_\_( 'Prefill Form for Abandoned Users', 'funnel-builder' ), |
| [1090](#L1090) | 'sub\_heading' => \_\_( 'Enable this to populate previously entered values as abandoned users return back to checkout.', 'funnel-builder' ), |
| [1091](#L1091) | ]; |
| [1092](#L1092) | $data['settings']['autopopulate\_state']  = [ |
| [1093](#L1093) | 'heading'         => '<span class="wfacp\_pro\_feature\_span" data-item="optimization">' . $lock\_img . '</span>' . \_\_( 'Auto fill State from Zip Code and Country', 'funnel-builder' ), |
| [1094](#L1094) | 'sub\_heading'     => \_\_( 'Enable this to auto fill State from combination of Zip code and Country', 'funnel-builder' ), |
| [1095](#L1095) | 'service\_heading' => \_\_( 'Choose service', 'funnel-builder' ), |
| [1096](#L1096) | 'services'        => [ |
| [1097](#L1097) | [ |
| [1098](#L1098) | 'value' => 'zippopotamus', |
| [1099](#L1099) | 'name'  => \_\_( 'By Zippopotamus', 'funnel-builder' ), |
| [1100](#L1100) | ], |
| [1101](#L1101) | ] |
| [1102](#L1102) | ]; |
| [1103](#L1103) |  |
| [1104](#L1104) | $data['settings']['auto\_fill\_url'] = [ |
| [1105](#L1105) | 'heading'                => '<span class="wfacp\_pro\_feature\_span" data-item="optimization">' . $lock\_img . '</span>' . \_\_( 'Generate URL to populate checkout', 'funnel-builder' ), |
| [1106](#L1106) | 'sub\_heading'            => \_\_( 'Use these settings to pre-populate checkout with URLs parameters', 'funnel-builder' ), |
| [1107](#L1107) | 'product\_ids'            => \_\_( 'Product', 'funnel-builder' ), |
| [1108](#L1108) | 'product\_ids\_hint'       => \_\_( 'Tip: Enter Comma Separated Product IDs for multiple products', 'funnel-builder' ), |
| [1109](#L1109) | 'quantity'               => \_\_( 'Quantity', 'funnel-builder' ), |
| [1110](#L1110) | 'quantity\_hint'          => \_\_( 'Tip: Enter Comma Separated quantity value for multiple products', 'funnel-builder' ), |
| [1111](#L1111) | 'fields\_label'           => \_\_( 'Fields', 'funnel-builder' ), |
| [1112](#L1112) | 'fields\_options'         => [ |
| [1113](#L1113) | [ |
| [1114](#L1114) | 'value' => 'billing\_email', |
| [1115](#L1115) | 'name'  => \_\_( 'Email', 'funnel-builder' ), |
| [1116](#L1116) | ], |
| [1117](#L1117) | [ |
| [1118](#L1118) | 'value' => 'billing\_first\_name', |
| [1119](#L1119) | 'name'  => \_\_( 'First Name', 'funnel-builder' ), |
| [1120](#L1120) | ], |
| [1121](#L1121) | [ |
| [1122](#L1122) | 'value' => 'billing\_last\_name', |
| [1123](#L1123) | 'name'  => \_\_( 'Last Name', 'funnel-builder' ) |
| [1124](#L1124) | ] |
| [1125](#L1125) | ], |
| [1126](#L1126) | 'auto\_responder\_label'   => \_\_( 'Email Service', 'funnel-builder' ), |
| [1127](#L1127) | 'auto\_responder\_options' => self::auto\_responder\_options(), |
| [1128](#L1128) | 'perfill\_url'            => \_\_( 'Checkout URL', 'funnel-builder' ) |
| [1129](#L1129) | ]; |
| [1130](#L1130) |  |
| [1131](#L1131) | $data['settings']['analytics'] = [ |
| [1132](#L1132) | 'heading'             => '<span class="wfacp\_pro\_feature\_span" data-item="track-analytics">' . $lock\_img . '</span>' . \_\_( 'Tracking and Analytics', 'funnel-builder' ), |
| [1133](#L1133) | 'hint'                => \_\_( 'Use this to adjust the tracking events for one-page checkouts', 'funnel-builder' ), |
| [1134](#L1134) | 'sub\_heading'         => \_\_( 'Enable this to auto fill State from combination of Zip code and Country', 'funnel-builder' ), |
| [1135](#L1135) | 'service\_heading'     => \_\_( 'Choose service', 'funnel-builder' ), |
| [1136](#L1136) | 'pixel'               => [ |
| [1137](#L1137) | 'heading' => \_\_( 'Facebook Pixel', 'funnel-builder' ), |
| [1138](#L1138) | ], |
| [1139](#L1139) | 'google'              => [ |
| [1140](#L1140) | 'heading' => \_\_( 'Google Analytics', 'funnel-builder' ), |
| [1141](#L1141) | ], |
| [1142](#L1142) | 'events'              => [ |
| [1143](#L1143) | 'add\_to\_cart' => \_\_( 'Enable AddtoCart Event', 'funnel-builder' ), |
| [1144](#L1144) | 'page\_view'   => \_\_( 'Enable PageView Event', 'funnel-builder' ), |
| [1145](#L1145) | 'checkout'    => \_\_( 'Enable BeginCheckout Event', 'funnel-builder' ), |
| [1146](#L1146) | 'payment'     => \_\_( 'Enable AddPaymentInfo Event', 'funnel-builder' ) |
| [1147](#L1147) | ], |
| [1148](#L1148) | 'options\_label'       => \_\_( 'Trigger Event', 'funnel-builder' ), |
| [1149](#L1149) | 'override'            => \_\_( 'Override Global Settings', 'funnel-builder' ), |
| [1150](#L1150) | 'track\_event\_options' => self::track\_events\_options() |
| [1151](#L1151) | ]; |
| [1152](#L1152) | $data['settings']['tracking']  = [ |
| [1153](#L1153) | 'heading' => \_\_( 'Tracking and analytics', 'funnel-builder' ), |
| [1154](#L1154) | 'label'   => \_\_( 'Override global settings', 'funnel-builder' ) |
| [1155](#L1155) |  |
| [1156](#L1156) | ]; |
| [1157](#L1157) | $data['settings']['intl']      = [ |
| [1158](#L1158) | 'heading'                      => \_\_( 'Enhanced Phone Field', 'funnel-builder' ), |
| [1159](#L1159) | 'sub\_heading'                  => \_\_( 'Enable this to add enhanced Phone field with Country Code and its flags.', 'funnel-builder' ), |
| [1160](#L1160) | 'enable\_phone\_flag'            => \_\_( 'Enable', 'funnel-builder' ), |
| [1161](#L1161) | 'enable\_phone\_validation'      => \_\_( 'Validate Phone Number', 'funnel-builder' ), |
| [1162](#L1162) | 'enable\_save\_phone\_number'     => \_\_( 'Save Phone Number in Order', 'funnel-builder' ), |
| [1163](#L1163) | 'enable\_phone\_validation\_hint' => \_\_( 'Validate phone number entry based on selected country', 'funnel-builder' ), |
| [1164](#L1164) | 'enable\_phone\_placeholder'     => \_\_( 'placeholder', 'funnel-builder' ), |
| [1165](#L1165) | 'phone\_helping\_text'           => \_\_( 'Phone Help Text', 'funnel-builder' ), |
| [1166](#L1166) | 'phone\_helping\_text\_hint'      => \_\_( 'keep Blank to hide the Tool Tip', 'funnel-builder' ), |
| [1167](#L1167) | 'phone\_helping\_text'           => \_\_( 'Phone Help Text', 'woofunnels-aero-checkout' ), |
| [1168](#L1168) | 'saving\_options'               => [ |
| [1169](#L1169) | [ |
| [1170](#L1170) | 'value' => 'true', |
| [1171](#L1171) | 'name'  => \_\_( 'With country code', 'funnel-builder' ), |
| [1172](#L1172) | ], |
| [1173](#L1173) | [ |
| [1174](#L1174) | 'value' => 'false', |
| [1175](#L1175) | 'name'  => \_\_( 'Without country code', 'funnel-builder' ), |
| [1176](#L1176) | ], |
| [1177](#L1177) | ], |
| [1178](#L1178) | ]; |
| [1179](#L1179) |  |
| [1180](#L1180) |  |
| [1181](#L1181) | $shipping\_address\_options = WFACP\_Common::get\_single\_address\_fields( 'shipping' ); |
| [1182](#L1182) | $address\_options          = WFACP\_Common::get\_single\_address\_fields(); |
| [1183](#L1183) |  |
| [1184](#L1184) | $shipping\_address\_options     = WFACP\_Common::get\_single\_address\_fields( 'shipping' ); |
| [1185](#L1185) | $address\_options              = WFACP\_Common::get\_single\_address\_fields(); |
| [1186](#L1186) | $data['shipping-address']     = $shipping\_address\_options['fields\_options']; |
| [1187](#L1187) | $data['address']              = $address\_options['fields\_options']; |
| [1188](#L1188) | $data['field\_validate\_error'] = \_\_( 'Please Validate Field ', 'funnel-builder' ); |
| [1189](#L1189) |  |
| [1190](#L1190) | $data = apply\_filters( 'wfacp\_builder\_default\_localization', $data ); |
| [1191](#L1191) |  |
| [1192](#L1192) | return apply\_filters( 'wfacp\_global\_localization\_texts', $data ); |
| [1193](#L1193) | } |
| [1194](#L1194) |  |
| [1195](#L1195) | public static function auto\_responder\_options() { |
| [1196](#L1196) | $options = [ |
| [1197](#L1197) | 'select\_email\_provider' => [ |
| [1198](#L1198) | 'id'         => 'select\_email\_provider', |
| [1199](#L1199) | 'name'       => \_\_( 'Select Email Service Provider', 'funnel-builder' ), |
| [1200](#L1200) | 'merge\_tags' => [] |
| [1201](#L1201) | ], |
| [1202](#L1202) | 'activecampaign'        => [ |
| [1203](#L1203) | 'id'         => 'activecampaign', |
| [1204](#L1204) | 'name'       => \_\_( 'ActiveCampaign', 'funnel-builder' ), |
| [1205](#L1205) | 'merge\_tags' => [ |
| [1206](#L1206) | 'billing\_email'      => '%EMAIL%', |
| [1207](#L1207) | 'billing\_first\_name' => '%FIRSTNAME%', |
| [1208](#L1208) | 'billing\_last\_name'  => '%LASTNAME%', |
| [1209](#L1209) | ] |
| [1210](#L1210) | ], |
| [1211](#L1211) | 'convertkit'            => [ |
| [1212](#L1212) | 'id'         => 'convertkit', |
| [1213](#L1213) | 'name'       => \_\_( 'Convertkit', 'funnel-builder' ), |
| [1214](#L1214) | 'merge\_tags' => [ |
| [1215](#L1215) | 'billing\_email'      => '{{subscriber.email }}', |
| [1216](#L1216) | 'billing\_first\_name' => '{{subscriber.first\_name}}', |
| [1217](#L1217) | 'billing\_last\_name'  => '{{subscriber.last\_name}}', |
| [1218](#L1218) | ] |
| [1219](#L1219) | ], |
| [1220](#L1220) | 'drip'                  => [ |
| [1221](#L1221) | 'id'         => 'drip', |
| [1222](#L1222) | 'name'       => \_\_( 'Drip', 'funnel-builder' ), |
| [1223](#L1223) | 'merge\_tags' => [ |
| [1224](#L1224) | 'billing\_email'      => '{{subscriber.email}}', |
| [1225](#L1225) | 'billing\_first\_name' => '{{subscriber.first\_name}}', |
| [1226](#L1226) | 'billing\_last\_name'  => '{{subscriber.last\_name}}', |
| [1227](#L1227) | ] |
| [1228](#L1228) | ], |
| [1229](#L1229) | 'infusionsoft'          => [ |
| [1230](#L1230) | 'id'         => 'infusionsoft', |
| [1231](#L1231) | 'name'       => \_\_( 'InfusionSoft', 'funnel-builder' ), |
| [1232](#L1232) | 'merge\_tags' => [ |
| [1233](#L1233) | 'billing\_email'      => '~Contact.Email~', |
| [1234](#L1234) | 'billing\_first\_name' => '~Contact.FirstName~', |
| [1235](#L1235) | 'billing\_last\_name'  => '~Contact.LastName~', |
| [1236](#L1236) | ] |
| [1237](#L1237) | ], |
| [1238](#L1238) | 'mailchimp'             => [ |
| [1239](#L1239) | 'id'         => 'mailchimp', |
| [1240](#L1240) | 'name'       => \_\_( 'Mailchimp', 'funnel-builder' ), |
| [1241](#L1241) | 'merge\_tags' => [ |
| [1242](#L1242) | 'billing\_email'      => '\*|EMAIL|\*', |
| [1243](#L1243) | 'billing\_first\_name' => '\*|FNAME|\*', |
| [1244](#L1244) | 'billing\_last\_name'  => '\*|LNAME|\*', |
| [1245](#L1245) | ] |
| [1246](#L1246) | ], |
| [1247](#L1247) | 'other'                 => [ |
| [1248](#L1248) | 'id'         => 'other', |
| [1249](#L1249) | 'name'       => \_\_( 'Other', 'funnel-builder' ), |
| [1250](#L1250) | 'merge\_tags' => [ |
| [1251](#L1251) | 'billing\_email'      => 'xxx', |
| [1252](#L1252) | 'billing\_first\_name' => 'xxx', |
| [1253](#L1253) | 'billing\_last\_name'  => 'xxx', |
| [1254](#L1254) | ] |
| [1255](#L1255) | ] |
| [1256](#L1256) | ]; |
| [1257](#L1257) |  |
| [1258](#L1258) | return apply\_filters( 'wfacp\_auto\_responders\_settings', $options ); |
| [1259](#L1259) | } |
| [1260](#L1260) |  |
| [1261](#L1261) | public static function smart\_buttons\_positions() { |
| [1262](#L1262) |  |
| [1263](#L1263) | $positions = [ |
| [1264](#L1264) | //'' |
| [1265](#L1265) | [ |
| [1266](#L1266) | 'id'   => 'wfacp\_form\_single\_step\_start', |
| [1267](#L1267) | 'name' => \_\_( 'At top of checkout Page', 'funnel-builder' ), |
| [1268](#L1268) | ], |
| [1269](#L1269) | [ |
| [1270](#L1270) | 'id'   => 'wfacp\_before\_product\_switching\_field', |
| [1271](#L1271) | 'name' => \_\_( 'Before product switcher', 'funnel-builder' ), |
| [1272](#L1272) | ], |
| [1273](#L1273) | [ |
| [1274](#L1274) | 'id'   => 'wfacp\_after\_product\_switching\_field', |
| [1275](#L1275) | 'name' => \_\_( 'After product switcher', 'funnel-builder' ), |
| [1276](#L1276) | ], |
| [1277](#L1277) | [ |
| [1278](#L1278) | 'id'   => 'wfacp\_before\_order\_summary\_field', |
| [1279](#L1279) | 'name' => \_\_( 'Before order summary', 'funnel-builder' ), |
| [1280](#L1280) | ], |
| [1281](#L1281) | [ |
| [1282](#L1282) | 'id'   => 'wfacp\_after\_order\_summary\_field', |
| [1283](#L1283) | 'name' => \_\_( 'After order summary', 'funnel-builder' ), |
| [1284](#L1284) | ], |
| [1285](#L1285) | [ |
| [1286](#L1286) | 'id'   => 'wfacp\_before\_payment\_section', |
| [1287](#L1287) | 'name' => \_\_( 'Above the payment gateways', 'funnel-builder' ), |
| [1288](#L1288) | ], |
| [1289](#L1289) | ]; |
| [1290](#L1290) |  |
| [1291](#L1291) | return apply\_filters( 'wfacp\_smart\_buttons\_positions', $positions ); |
| [1292](#L1292) | } |
| [1293](#L1293) |  |
| [1294](#L1294) | public static function get\_html\_excluded\_field() { |
| [1295](#L1295) | return [ 'order\_summary', 'order\_total', 'order\_coupon', 'product\_switching', 'shipping\_calculator' ]; |
| [1296](#L1296) |  |
| [1297](#L1297) | } |
| [1298](#L1298) |  |
| [1299](#L1299) | public static function is\_mobile\_device() { |
| [1300](#L1300) | $detect = WFACP\_Mobile\_Detect::get\_instance(); |
| [1301](#L1301) | if ( $detect->isMobile() && ! $detect->istablet() ) { |
| [1302](#L1302) | return true; |
| [1303](#L1303) | } |
| [1304](#L1304) |  |
| [1305](#L1305) | return false; |
| [1306](#L1306) | } |
| [1307](#L1307) |  |
| [1308](#L1308) | public static function get\_current\_user\_role() { |
| [1309](#L1309) | if ( is\_user\_logged\_in() ) { |
| [1310](#L1310) | if ( is\_super\_admin() ) { |
| [1311](#L1311) | return 'administrator'; |
| [1312](#L1312) | } else { |
| [1313](#L1313) | return 'customer'; |
| [1314](#L1314) | } |
| [1315](#L1315) | } |
| [1316](#L1316) |  |
| [1317](#L1317) | return 'guest'; |
| [1318](#L1318) | } |
| [1319](#L1319) |  |
| [1320](#L1320) |  |
| [1321](#L1321) | /\*\* |
| [1322](#L1322) | \* Save all publish checkout pages into transient |
| [1323](#L1323) | \*/ |
| [1324](#L1324) | public static function save\_publish\_checkout\_pages\_in\_transient( $force = true, $count = '-1' ) { |
| [1325](#L1325) | if ( ! empty( self::$wfacp\_publish\_posts ) ) { |
| [1326](#L1326) | return self::$wfacp\_publish\_posts; |
| [1327](#L1327) | } |
| [1328](#L1328) |  |
| [1329](#L1329) | $output   = []; |
| [1330](#L1330) | $output[] = [ |
| [1331](#L1331) | 'id'   => '0', |
| [1332](#L1332) | 'name' => \_\_( 'Default WooCommerce Checkout Page', 'funnel-builder' ), |
| [1333](#L1333) | 'type' => 'default', |
| [1334](#L1334) | ]; |
| [1335](#L1335) | $data     = WFACP\_Common::get\_saved\_pages(); |
| [1336](#L1336) | if ( is\_array( $data ) && count( $data ) > 0 ) { |
| [1337](#L1337) |  |
| [1338](#L1338) | foreach ( $data as $v ) { |
| [1339](#L1339) | $output[] = [ |
| [1340](#L1340) | 'id'   => $v['ID'], |
| [1341](#L1341) | 'name' => $v['post\_title'], |
| [1342](#L1342) | 'type' => 'wfacp', |
| [1343](#L1343) | ]; |
| [1344](#L1344) | } |
| [1345](#L1345) | } |
| [1346](#L1346) |  |
| [1347](#L1347) | $output = apply\_filters( 'wfacp\_checkout\_post\_list', $output ); |
| [1348](#L1348) |  |
| [1349](#L1349) | if ( count( $output ) == 0 ) { |
| [1350](#L1350) | return []; |
| [1351](#L1351) | } |
| [1352](#L1352) |  |
| [1353](#L1353) | self::$wfacp\_publish\_posts = $output; |
| [1354](#L1354) |  |
| [1355](#L1355) | return $output; |
| [1356](#L1356) | } |
| [1357](#L1357) |  |
| [1358](#L1358) | /\*\* |
| [1359](#L1359) | \* Return WFACP Post id if user override default checkout from global settings |
| [1360](#L1360) | \*/ |
| [1361](#L1361) | public static function get\_checkout\_page\_id() { |
| [1362](#L1362) | if ( ! is\_null( self::$global\_checkout\_page\_id ) ) { |
| [1363](#L1363) | return self::$global\_checkout\_page\_id; |
| [1364](#L1364) | } |
| [1365](#L1365) | $checkout\_page\_id = 0; |
| [1366](#L1366) | $global\_settings  = get\_option( '\_wfacp\_global\_settings', [] ); |
| [1367](#L1367) |  |
| [1368](#L1368) | if ( isset( $global\_settings['override\_checkout\_page\_id'] ) ) { |
| [1369](#L1369) | $checkout\_page\_id = absint( $global\_settings['override\_checkout\_page\_id'] ); |
| [1370](#L1370) | } |
| [1371](#L1371) | self::$global\_checkout\_page\_id = apply\_filters( 'wfacp\_global\_checkout\_page\_id', $checkout\_page\_id ); |
| [1372](#L1372) |  |
| [1373](#L1373) | return self::$global\_checkout\_page\_id; |
| [1374](#L1374) | } |
| [1375](#L1375) |  |
| [1376](#L1376) | public static function is\_global\_checkout( $id = 0 ) { |
| [1377](#L1377) | if ( $id === 0 ) { |
| [1378](#L1378) | return false; |
| [1379](#L1379) | } |
| [1380](#L1380) |  |
| [1381](#L1381) | if ( $id == self::get\_checkout\_page\_id() ) { |
| [1382](#L1382) | return true; |
| [1383](#L1383) | } |
| [1384](#L1384) |  |
| [1385](#L1385) | return false; |
| [1386](#L1386) |  |
| [1387](#L1387) | } |
| [1388](#L1388) |  |
| [1389](#L1389) | public static function make\_cart\_empty() { |
| [1390](#L1390) | $items = WC()->cart->get\_cart(); |
| [1391](#L1391) | if ( ! empty( $items ) ) { |
| [1392](#L1392) | foreach ( $items as $key => $item ) { |
| [1393](#L1393) | if ( isset( $item['\_wfob\_options'] ) ) { |
| [1394](#L1394) | continue; |
| [1395](#L1395) | } |
| [1396](#L1396) | WC()->cart->remove\_cart\_item( $key ); |
| [1397](#L1397) | } |
| [1398](#L1398) | } |
| [1399](#L1399) | } |
| [1400](#L1400) |  |
| [1401](#L1401) | /\*\* |
| [1402](#L1402) | \* Stored Order bump Item in variable when product switcher radio options triggered |
| [1403](#L1403) | \*/ |
| [1404](#L1404) | public static function order\_bump\_restored\_start() { |
| [1405](#L1405) | $items = WC()->cart->get\_cart(); |
| [1406](#L1406) | if ( ! empty( $items ) ) { |
| [1407](#L1407) | foreach ( $items as $key => $item ) { |
| [1408](#L1408) | if ( isset( $item['\_wfob\_options'] ) && ! isset( $item['\_wfob\_pre\_checked'] ) ) { |
| [1409](#L1409) | self::$order\_bumps[ $key ] = $item; |
| [1410](#L1410) | continue; |
| [1411](#L1411) | } |
| [1412](#L1412) | } |
| [1413](#L1413) | } |
| [1414](#L1414) | } |
| [1415](#L1415) |  |
| [1416](#L1416) | /\*\* |
| [1417](#L1417) | \* Restore a Order bump cart item when product switcher add a product in cart for Radio Option. |
| [1418](#L1418) | \* |
| [1419](#L1419) | \* @param string $cart\_item\_key Cart item key to restore to the cart. |
| [1420](#L1420) | \* |
| [1421](#L1421) | \* @return bool |
| [1422](#L1422) | \*/ |
| [1423](#L1423) | public static function order\_bump\_restored\_end() { |
| [1424](#L1424) | if ( count( self::$order\_bumps ) > 0 ) { |
| [1425](#L1425) | foreach ( self::$order\_bumps as $item\_key => $item ) { |
| [1426](#L1426) | do\_action( 'woocommerce\_restore\_cart\_item', $item\_key, WC()->cart ); |
| [1427](#L1427) | WC()->cart->cart\_contents[ $item\_key ] = $item; |
| [1428](#L1428) | do\_action( 'woocommerce\_cart\_item\_restored', $item\_key, WC()->cart ); |
| [1429](#L1429) | } |
| [1430](#L1430) | } |
| [1431](#L1431) | } |
| [1432](#L1432) |  |
| [1433](#L1433) | /\*\* |
| [1434](#L1434) | \* Make Proper table layout in Mini cart  for shipping columns |
| [1435](#L1435) | \* |
| [1436](#L1436) | \* @param $spans |
| [1437](#L1437) | \* |
| [1438](#L1438) | \* @return mixed |
| [1439](#L1439) | \*/ |
| [1440](#L1440) | public static function order\_review\_shipping\_colspan( $spans ) { |
| [1441](#L1441) | global $wfacp\_colspan\_attr\_1, $wfacp\_colspan\_attr\_2; |
| [1442](#L1442) | if ( ! is\_null( $wfacp\_colspan\_attr\_1 ) ) { |
| [1443](#L1443) | $spans['first'] = $wfacp\_colspan\_attr\_1; |
| [1444](#L1444) | } |
| [1445](#L1445) | if ( ! is\_null( $wfacp\_colspan\_attr\_2 ) ) { |
| [1446](#L1446) | $spans['second'] = $wfacp\_colspan\_attr\_2; |
| [1447](#L1447) | } |
| [1448](#L1448) |  |
| [1449](#L1449) | return $spans; |
| [1450](#L1450) | } |
| [1451](#L1451) |  |
| [1452](#L1452) |  |
| [1453](#L1453) | public static function woocommerce\_locate\_template( $template ) { |
| [1454](#L1454) | $wfacp\_dir = strpos( $template, 'wfacp/checkout/cart-shipping.php' ); |
| [1455](#L1455) | if ( false !== $wfacp\_dir ) { |
| [1456](#L1456) | return WFACP\_TEMPLATE\_COMMON . '/checkout/cart-shipping.php'; |
| [1457](#L1457) | } |
| [1458](#L1458) |  |
| [1459](#L1459) | $wfacp\_dir = strpos( $template, 'wfacp/checkout/cart-recurring-shipping.php' ); |
| [1460](#L1460) | if ( false !== $wfacp\_dir ) { |
| [1461](#L1461) | return WFACP\_TEMPLATE\_COMMON . '/checkout/cart-recurring-shipping.php'; |
| [1462](#L1462) | } |
| [1463](#L1463) |  |
| [1464](#L1464) | $wfacp\_dir = strpos( $template, 'wfacp/checkout/cart-recurring-shipping-calculate.php' ); |
| [1465](#L1465) | if ( false !== $wfacp\_dir ) { |
| [1466](#L1466) | return WFACP\_TEMPLATE\_COMMON . '/checkout/cart-recurring-shipping-calculate.php'; |
| [1467](#L1467) | } |
| [1468](#L1468) |  |
| [1469](#L1469) | return $template; |
| [1470](#L1470) |  |
| [1471](#L1471) | } |
| [1472](#L1472) |  |
| [1473](#L1473) | public static function track\_events\_content\_id\_options() { |
| [1474](#L1474) |  |
| [1475](#L1475) | $events = [ |
| [1476](#L1476) | [ 'id' => '0', 'name' => \_\_( 'Select content id parameter', 'funnel-builder' ) ], |
| [1477](#L1477) | [ 'id' => 'product\_id', 'name' => \_\_( 'Product ID', 'funnel-builder' ) ], |
| [1478](#L1478) | [ 'id' => 'product\_sku', 'name' => \_\_( 'Product Sku', 'funnel-builder' ) ], |
| [1479](#L1479) | ]; |
| [1480](#L1480) |  |
| [1481](#L1481) | return apply\_filters( 'wfacp\_track\_events\_content\_id\_options', $events ); |
| [1482](#L1482) | } |
| [1483](#L1483) |  |
| [1484](#L1484) | public static function track\_events\_options() { |
| [1485](#L1485) |  |
| [1486](#L1486) | $events = [ |
| [1487](#L1487) | [ 'id' => 'load', 'name' => \_\_( 'On Page Load', 'funnel-builder' ) ], |
| [1488](#L1488) | [ 'id' => 'email', 'name' => \_\_( 'On Email Capture', 'funnel-builder' ) ] |
| [1489](#L1489) | ]; |
| [1490](#L1490) |  |
| [1491](#L1491) | return apply\_filters( 'wfacp\_track\_event\_options', $events ); |
| [1492](#L1492) | } |
| [1493](#L1493) |  |
| [1494](#L1494) | public static function get\_default\_global\_settings() { |
| [1495](#L1495) | $data                          = []; |
| [1496](#L1496) | $global\_template\_pages         = WFACP\_Common::save\_publish\_checkout\_pages\_in\_transient(); |
| [1497](#L1497) | $wfacp\_miscellaneous\_analytics = [ |
| [1498](#L1498) | 'fields'     => [ |
| [1499](#L1499) |  |
| [1500](#L1500) | [ |
| [1501](#L1501) | 'type'         => 'checkbox', |
| [1502](#L1502) | 'inputType'    => 'text', |
| [1503](#L1503) | 'label'        => \_\_( 'Set Shipping Method Prices in Ascending Order', 'funnel-builder' ), |
| [1504](#L1504) | 'default'      => '', |
| [1505](#L1505) | 'styleClasses' => 'group-one-class wfacp\_set\_shipping\_method\_wrap wfacp\_checkbox\_wrap', |
| [1506](#L1506) | 'model'        => 'wfacp\_set\_shipping\_method', |
| [1507](#L1507) | 'is\_bool'      => false, |
| [1508](#L1508) | ], |
| [1509](#L1509) |  |
| [1510](#L1510) | ], |
| [1511](#L1511) | 'legend'     => \_\_( 'Advance', 'funnel-builder' ), |
| [1512](#L1512) | 'wfacp\_data' => [ 'id' => 'wfacp-miscellaneous', 'class' => 'wfacp\_miscellaneous', 'title' => \_\_( 'Advance', 'funnel-builder' ) ] |
| [1513](#L1513) | ]; |
| [1514](#L1514) |  |
| [1515](#L1515) | $wfacp\_appearance = [ |
| [1516](#L1516) | 'fields'     => [ |
| [1517](#L1517) |  |
| [1518](#L1518) | [ |
| [1519](#L1519) | 'type'         => 'textArea', |
| [1520](#L1520) | 'inputType'    => 'text', |
| [1521](#L1521) | 'label'        => \_\_( 'Custom CSS Tweaks', 'funnel-builder' ), |
| [1522](#L1522) | 'styleClasses' => 'wfacp\_global\_css\_wrap\_field', |
| [1523](#L1523) | 'model'        => 'wfacp\_checkout\_global\_css', |
| [1524](#L1524) | ], |
| [1525](#L1525) |  |
| [1526](#L1526) | ], |
| [1527](#L1527) | 'legend'     => \_\_( 'Custom CSS', 'funnel-builder' ), |
| [1528](#L1528) | 'wfacp\_data' => [ 'id' => 'wfacp-global\_css', 'class' => 'wfacp\_global\_css', 'title' => \_\_( 'Custom CSS', 'funnel-builder' ) ] |
| [1529](#L1529) | ]; |
| [1530](#L1530) |  |
| [1531](#L1531) | $wfacp\_external\_script = [ |
| [1532](#L1532) | 'fields'     => [ |
| [1533](#L1533) |  |
| [1534](#L1534) | [ |
| [1535](#L1535) | 'type'         => 'textArea', |
| [1536](#L1536) | 'inputType'    => 'text', |
| [1537](#L1537) | 'label'        => \_\_( 'External JS Scripts', 'funnel-builder' ), |
| [1538](#L1538) | 'styleClasses' => 'wfacp\_global\_external\_script\_field', |
| [1539](#L1539) | 'model'        => 'wfacp\_global\_external\_script', |
| [1540](#L1540) | ], |
| [1541](#L1541) |  |
| [1542](#L1542) | ], |
| [1543](#L1543) | 'legend'     => \_\_( 'External Scripts', 'funnel-builder' ), |
| [1544](#L1544) | 'wfacp\_data' => [ 'id' => 'wfacp-global\_external\_script', 'class' => 'wfacp\_global\_external\_script', 'title' => \_\_( 'External Scripts', 'funnel-builder' ) ] |
| [1545](#L1545) | ]; |
| [1546](#L1546) |  |
| [1547](#L1547) | $data['groups'][] = $wfacp\_appearance; |
| [1548](#L1548) | $data['groups'][] = $wfacp\_external\_script; |
| [1549](#L1549) | $data['groups'][] = $wfacp\_miscellaneous\_analytics; |
| [1550](#L1550) |  |
| [1551](#L1551) |  |
| [1552](#L1552) | return apply\_filters( 'wfacp\_global\_setting\_fields', $data ); |
| [1553](#L1553) | } |
| [1554](#L1554) |  |
| [1555](#L1555) | /\*\* |
| [1556](#L1556) | \* @return mixed|void |
| [1557](#L1557) | \*/ |
| [1558](#L1558) | public static function all\_global\_settings\_fields() { |
| [1559](#L1559) | $global\_template\_pages = WFACP\_Common::save\_publish\_checkout\_pages\_in\_transient(); |
| [1560](#L1560) | $data                  = array( |
| [1561](#L1561) |  |
| [1562](#L1562) | 'wfacp\_global\_checkout' => array( |
| [1563](#L1563) | 'title'    => \_\_( 'Global Checkout', 'funnel-builder' ), |
| [1564](#L1564) | 'heading'  => \_\_( 'Global Checkout', 'funnel-builder' ), |
| [1565](#L1565) | 'slug'     => 'wfacp\_global\_checkout', |
| [1566](#L1566) | 'fields'   => array( |
| [1567](#L1567) | array( |
| [1568](#L1568) | 'key'           => 'override\_checkout\_page\_id', |
| [1569](#L1569) | 'styleClasses'  => 'group-one-class', |
| [1570](#L1570) | 'type'          => ! empty( $global\_template\_pages ) ? 'select' : 'hidden', |
| [1571](#L1571) | 'label'         => \_\_( 'Override Default Checkout', 'funnel-builder' ), |
| [1572](#L1572) | 'hint'          => ! empty( $global\_template\_pages ) ? \_\_( 'Selected checkout page will replace default WooCommerce checkout page', 'funnel-builder' ) : \_\_( 'No checkout pages found.', 'funnel-builder' ), |
| [1573](#L1573) | 'default'       => '0', |
| [1574](#L1574) | 'values'        => $global\_template\_pages, |
| [1575](#L1575) | 'selectOptions' => [ |
| [1576](#L1576) | 'hideNoneSelectedText' => true, |
| [1577](#L1577) | ], |
| [1578](#L1578) | ) |
| [1579](#L1579) | ), |
| [1580](#L1580) | 'priority' => 5, |
| [1581](#L1581) | ), |
| [1582](#L1582) |  |
| [1583](#L1583) | 'wfacp\_global\_css'    => array( |
| [1584](#L1584) | 'title'    => \_\_( 'Custom CSS', 'funnel-builder' ), |
| [1585](#L1585) | 'heading'  => \_\_( 'Custom CSS', 'funnel-builder' ), |
| [1586](#L1586) | 'slug'     => 'wfacp\_global\_css', |
| [1587](#L1587) | 'fields'   => array( |
| [1588](#L1588) | array( |
| [1589](#L1589) | 'key'          => 'wfacp\_checkout\_global\_css', |
| [1590](#L1590) | 'styleClasses' => 'wfacp\_global\_css\_wrap\_field', |
| [1591](#L1591) | 'type'         => 'textArea', |
| [1592](#L1592) | 'label'        => \_\_( 'Custom CSS Tweaks', 'funnel-builder' ), |
| [1593](#L1593) | 'placeholder'  => \_\_( 'Type here...', 'funnel-builder' ), |
| [1594](#L1594) | ) |
| [1595](#L1595) | ), |
| [1596](#L1596) | 'priority' => 15, |
| [1597](#L1597) | ), |
| [1598](#L1598) | 'wfacp\_global\_script' => array( |
| [1599](#L1599) | 'title'    => \_\_( 'External Scripts', 'funnel-builder' ), |
| [1600](#L1600) | 'heading'  => \_\_( 'External Scripts', 'funnel-builder' ), |
| [1601](#L1601) | 'slug'     => 'wfacp\_global\_script', |
| [1602](#L1602) | 'fields'   => array( |
| [1603](#L1603) | array( |
| [1604](#L1604) | 'key'          => 'wfacp\_global\_external\_script', |
| [1605](#L1605) | 'styleClasses' => 'wfacp\_global\_external\_script\_field', |
| [1606](#L1606) | 'type'         => 'textArea', |
| [1607](#L1607) | 'label'        => \_\_( 'External JS Scripts', 'funnel-builder' ), |
| [1608](#L1608) | 'placeholder'  => \_\_( 'Type here...', 'funnel-builder' ), |
| [1609](#L1609) | ) |
| [1610](#L1610) | ), |
| [1611](#L1611) | 'priority' => 20, |
| [1612](#L1612) | ), |
| [1613](#L1613) | 'wfacp\_miscellaneous' => array( |
| [1614](#L1614) | 'title'    => \_\_( 'Advance', 'funnel-builder' ), |
| [1615](#L1615) | 'heading'  => \_\_( 'Advance', 'funnel-builder' ), |
| [1616](#L1616) | 'slug'     => 'wfacp\_miscellaneous', |
| [1617](#L1617) | 'fields'   => array( |
| [1618](#L1618) | array( |
| [1619](#L1619) | 'key'          => 'wfacp\_set\_shipping\_head', |
| [1620](#L1620) | 'styleClasses' => '', |
| [1621](#L1621) | 'type'         => 'label', |
| [1622](#L1622) | 'label'        => \_\_( 'Shipping Method Prices', 'funnel-builder' ), |
| [1623](#L1623) |  |
| [1624](#L1624) | ), |
| [1625](#L1625) | array( |
| [1626](#L1626) | 'key'          => 'wfacp\_set\_shipping\_method', |
| [1627](#L1627) | 'styleClasses' => 'group-one-class wfacp\_setting\_track\_and\_events\_end', |
| [1628](#L1628) | 'type'         => 'checkbox', |
| [1629](#L1629) | 'label'        => \_\_( 'Set Shipping Method Prices in Ascending Order', 'funnel-builder' ), |
| [1630](#L1630) |  |
| [1631](#L1631) | ) |
| [1632](#L1632) | ), |
| [1633](#L1633) | 'priority' => 25, |
| [1634](#L1634) | ), |
| [1635](#L1635) | ); |
| [1636](#L1636) |  |
| [1637](#L1637) | if ( function\_exists( 'wfacp\_pro\_dependency' ) && ( ! wfacp\_pro\_dependency() || ( class\_exists( 'WFFN\_Common' ) && class\_exists( 'WFFN\_Pro\_Modules' ) && ! WFFN\_Pro\_Modules::get\_module( 'checkout/woofunnels-aero-checkout.php' )::is\_module\_exists() ) ) ) { |
| [1638](#L1638) | unset( $data['wfacp\_global\_checkout'] ); |
| [1639](#L1639) | } |
| [1640](#L1640) |  |
| [1641](#L1641) | $global\_settings = WFACP\_Common::global\_settings( true ); |
| [1642](#L1642) |  |
| [1643](#L1643) | foreach ( $data as &$arr ) { |
| [1644](#L1644) | $values = []; |
| [1645](#L1645) | foreach ( $arr['fields'] as &$field ) { |
| [1646](#L1646) | if ( is\_array( $global\_settings ) && isset( $global\_settings[ $field['key'] ] ) ) { |
| [1647](#L1647) | $values[ $field['key'] ] = $global\_settings[ $field['key'] ]; |
| [1648](#L1648) | } |
| [1649](#L1649) | } |
| [1650](#L1650) | $arr['values'] = $values; |
| [1651](#L1651) | } |
| [1652](#L1652) |  |
| [1653](#L1653) | return $data; |
| [1654](#L1654) |  |
| [1655](#L1655) | } |
| [1656](#L1656) |  |
| [1657](#L1657) | /\*\* |
| [1658](#L1658) | \* Get page layout data |
| [1659](#L1659) | \* |
| [1660](#L1660) | \* @param $page\_id |
| [1661](#L1661) | \* |
| [1662](#L1662) | \* @return array|mixed |
| [1663](#L1663) | \*/ |
| [1664](#L1664) | public static function get\_page\_layout( $page\_id ) { |
| [1665](#L1665) |  |
| [1666](#L1666) | $data          = WFACP\_Common::get\_post\_meta\_data( $page\_id, '\_wfacp\_page\_layout' ); |
| [1667](#L1667) | $stepone\_title = \_\_( 'Customer Information', 'funnel-builder' ); |
| [1668](#L1668) |  |
| [1669](#L1669) | if ( empty( $data ) ) { |
| [1670](#L1670) |  |
| [1671](#L1671) | $data                               = array( |
| [1672](#L1672) | 'steps'     => self::get\_default\_steps\_fields(), |
| [1673](#L1673) | 'fieldsets' => array( |
| [1674](#L1674) | 'single\_step' => [], |
| [1675](#L1675) | ), |
| [1676](#L1676) |  |
| [1677](#L1677) | 'current\_step'                => 'single\_step', |
| [1678](#L1678) | 'have\_billing\_address'        => 'true', |
| [1679](#L1679) | 'have\_shipping\_address'       => 'true', |
| [1680](#L1680) | 'have\_billing\_address\_index'  => 5, |
| [1681](#L1681) | 'have\_shipping\_address\_index' => 4, |
| [1682](#L1682) | 'enabled\_product\_switching'   => "yes", |
| [1683](#L1683) | 'have\_coupon\_field'           => true, |
| [1684](#L1684) | 'have\_shipping\_method'        => true, |
| [1685](#L1685) | ); |
| [1686](#L1686) | $data['fieldsets']['single\_step'][] = array( |
| [1687](#L1687) | 'name'        => $stepone\_title, |
| [1688](#L1688) | 'class'       => '', |
| [1689](#L1689) | 'is\_default'  => 'yes', |
| [1690](#L1690) | 'sub\_heading' => '', |
| [1691](#L1691) | 'fields'      => array( |
| [1692](#L1692) | array( |
| [1693](#L1693) | 'label'        => \_\_( 'Email', 'funnel-builder' ), |
| [1694](#L1694) | 'required'     => 'true', |
| [1695](#L1695) | 'type'         => 'email', |
| [1696](#L1696) | 'class'        => array( |
| [1697](#L1697) | 0 => 'form-row-wide', |
| [1698](#L1698) | ), |
| [1699](#L1699) | 'validate'     => array( |
| [1700](#L1700) | 0 => 'email', |
| [1701](#L1701) | ), |
| [1702](#L1702) | 'autocomplete' => 'email username', |
| [1703](#L1703) | 'priority'     => '110', |
| [1704](#L1704) | 'id'           => 'billing\_email', |
| [1705](#L1705) | 'field\_type'   => 'billing', |
| [1706](#L1706) | 'placeholder'  => \_\_( '', 'funnel-builder' ), |
| [1707](#L1707) | ), |
| [1708](#L1708) | array( |
| [1709](#L1709) | 'label'        => \_\_( 'First name', 'funnel-builder' ), |
| [1710](#L1710) | 'required'     => 'true', |
| [1711](#L1711) | 'class'        => array( |
| [1712](#L1712) | 0 => 'form-row-first', |
| [1713](#L1713) | ), |
| [1714](#L1714) | 'autocomplete' => 'given-name', |
| [1715](#L1715) | 'priority'     => '10', |
| [1716](#L1716) | 'type'         => 'text', |
| [1717](#L1717) | 'id'           => 'billing\_first\_name', |
| [1718](#L1718) | 'field\_type'   => 'billing', |
| [1719](#L1719) | 'placeholder'  => \_\_( '', 'funnel-builder' ), |
| [1720](#L1720) |  |
| [1721](#L1721) | ), |
| [1722](#L1722) | array( |
| [1723](#L1723) | 'label'        => \_\_( 'Last name', 'funnel-builder' ), |
| [1724](#L1724) | 'required'     => 'true', |
| [1725](#L1725) | 'class'        => array( |
| [1726](#L1726) | 0 => 'form-row-last', |
| [1727](#L1727) | ), |
| [1728](#L1728) | 'autocomplete' => 'family-name', |
| [1729](#L1729) | 'priority'     => '20', |
| [1730](#L1730) | 'type'         => 'text', |
| [1731](#L1731) | 'id'           => 'billing\_last\_name', |
| [1732](#L1732) | 'field\_type'   => 'billing', |
| [1733](#L1733) | 'placeholder'  => \_\_( '', 'funnel-builder' ), |
| [1734](#L1734) | ), |
| [1735](#L1735) | self::get\_single\_address\_fields( 'shipping' ), |
| [1736](#L1736) | self::get\_single\_address\_fields(), |
| [1737](#L1737) | array( |
| [1738](#L1738) | 'label'        => \_\_( 'Phone', 'funnel-builder' ), |
| [1739](#L1739) | 'type'         => 'tel', |
| [1740](#L1740) | 'class'        => array( 'form-row-wide' ), |
| [1741](#L1741) | 'id'           => 'billing\_phone', |
| [1742](#L1742) | 'field\_type'   => 'billing', |
| [1743](#L1743) | 'validate'     => array( 'phone' ), |
| [1744](#L1744) | 'placeholder'  => '', |
| [1745](#L1745) | 'autocomplete' => 'tel', |
| [1746](#L1746) | 'priority'     => 100, |
| [1747](#L1747) | ), |
| [1748](#L1748) |  |
| [1749](#L1749) | ), |
| [1750](#L1750) | ); |
| [1751](#L1751) |  |
| [1752](#L1752) | $advanced\_field = self::get\_advanced\_fields(); |
| [1753](#L1753) |  |
| [1754](#L1754) | $data['fieldsets']['single\_step'][] = array( |
| [1755](#L1755) |  |
| [1756](#L1756) | 'name'        => \_\_( 'Shipping Method', 'funnel-builder' ), |
| [1757](#L1757) | 'class'       => '', |
| [1758](#L1758) | 'sub\_heading' => '', |
| [1759](#L1759) | 'html\_fields' => [ 'shipping\_calculator' => true ], |
| [1760](#L1760) | 'fields'      => array( |
| [1761](#L1761) | $advanced\_field['shipping\_calculator'], |
| [1762](#L1762) | ), |
| [1763](#L1763) | ); |
| [1764](#L1764) |  |
| [1765](#L1765) |  |
| [1766](#L1766) | $data['fieldsets']['single\_step'][] = array( |
| [1767](#L1767) | 'name'        => \_\_( 'Order Summary', 'funnel-builder' ), |
| [1768](#L1768) | 'class'       => '', |
| [1769](#L1769) | 'sub\_heading' => '', |
| [1770](#L1770) | 'html\_fields' => [ |
| [1771](#L1771) | 'order\_summary' => true, |
| [1772](#L1772) | ], |
| [1773](#L1773) | 'fields'      => array( |
| [1774](#L1774) | $advanced\_field['order\_summary'], |
| [1775](#L1775) | ), |
| [1776](#L1776) | ); |
| [1777](#L1777) | $data                               = apply\_filters( 'wfacp\_default\_form\_fieldset', $data ); |
| [1778](#L1778) | } |
| [1779](#L1779) |  |
| [1780](#L1780) | return $data; |
| [1781](#L1781) | } |
| [1782](#L1782) |  |
| [1783](#L1783) | public static function get\_single\_address\_fields( $type = 'billing' ) { |
| [1784](#L1784) |  |
| [1785](#L1785) | $address\_field = array( |
| [1786](#L1786) | 'required'   => '1', |
| [1787](#L1787) | 'class'      => [ 'wfacp-col-half' ], |
| [1788](#L1788) | 'cssready'   => [ 'wfacp-col-half' ], |
| [1789](#L1789) | 'id'         => 'address', |
| [1790](#L1790) | 'field\_type' => 'billing', |
| [1791](#L1791) | ); |
| [1792](#L1792) |  |
| [1793](#L1793) |  |
| [1794](#L1794) | /\*------------------------------Address 2 visibility on------------------------------------- \*/ |
| [1795](#L1795) |  |
| [1796](#L1796) | $page\_id     = WFACP\_Common::get\_id(); |
| [1797](#L1797) | $design\_data = WFACP\_Common::get\_page\_design( $page\_id ); |
| [1798](#L1798) |  |
| [1799](#L1799) | $fields\_visibility = "false"; |
| [1800](#L1800) | if ( is\_array( $design\_data ) && count( $design\_data ) > 0 && isset( $design\_data['selected'] ) ) { |
| [1801](#L1801) | if ( ( false !== strpos( $design\_data['selected'], 'minimalist' ) || false !== strpos( $design\_data['selected'], 'shoppe' ) || false !== strpos( $design\_data['selected'], 'optic' ) ) ) { |
| [1802](#L1802) | $fields\_visibility = "true"; |
| [1803](#L1803) | } |
| [1804](#L1804) | } |
| [1805](#L1805) |  |
| [1806](#L1806) | if ( 'billing' == $type ) { |
| [1807](#L1807) | $address\_field['label'] = \_\_( 'Billing Address', 'funnel-builder' ); |
| [1808](#L1808) | } else { |
| [1809](#L1809) | $address\_field['label'] = \_\_( 'Shipping Address', 'funnel-builder' ); |
| [1810](#L1810) | unset( $address\_field['required'] ); |
| [1811](#L1811) | } |
| [1812](#L1812) |  |
| [1813](#L1813) | if ( 'shipping' === $type ) { |
| [1814](#L1814) | $address\_field['id']                                = 'shipping-address'; |
| [1815](#L1815) | $address\_field['fields\_options']['same\_as\_billing'] = array( |
| [1816](#L1816) | 'same\_as\_billing'         => 'true', |
| [1817](#L1817) | 'same\_as\_billing\_label'   => \_\_( 'Use a different shipping address', 'funnel-builder' ), |
| [1818](#L1818) | 'same\_as\_billing\_label\_2' => '', |
| [1819](#L1819) | ); |
| [1820](#L1820) | } else { |
| [1821](#L1821) | $address\_field['fields\_options']['same\_as\_shipping'] = array( |
| [1822](#L1822) | 'same\_as\_shipping'         => 'true', |
| [1823](#L1823) | 'same\_as\_shipping\_label'   => \_\_( 'Use a different billing address', 'funnel-builder' ), |
| [1824](#L1824) | 'same\_as\_shipping\_label\_2' => '', |
| [1825](#L1825) |  |
| [1826](#L1826) | ); |
| [1827](#L1827) | } |
| [1828](#L1828) |  |
| [1829](#L1829) | $address\_field['fields\_options']['first\_name'] = array( |
| [1830](#L1830) | 'first\_name'             => 'false', |
| [1831](#L1831) | 'first\_name\_label'       => \_\_( 'First name', 'funnel-builder' ), |
| [1832](#L1832) | 'first\_name\_placeholder' => '', |
| [1833](#L1833) | 'hint'                   => \_\_( 'Field ID: ', 'funnel-builder' ) . $type . '\_first\_name', |
| [1834](#L1834) | 'required'               => true, |
| [1835](#L1835) | 'configuration\_message'  => '' |
| [1836](#L1836) | ); |
| [1837](#L1837) | $address\_field['fields\_options']['last\_name']  = array( |
| [1838](#L1838) | 'last\_name'             => 'false', |
| [1839](#L1839) | 'last\_name\_label'       => \_\_( 'Last name', 'funnel-builder' ), |
| [1840](#L1840) | 'last\_name\_placeholder' => '', |
| [1841](#L1841) | 'hint'                  => \_\_( 'Field ID: ', 'funnel-builder' ) . $type . '\_last\_name', |
| [1842](#L1842) | 'required'              => true, |
| [1843](#L1843) | 'configuration\_message' => '' |
| [1844](#L1844) | ); |
| [1845](#L1845) |  |
| [1846](#L1846) |  |
| [1847](#L1847) | $address\_field['fields\_options']['company']   = array( |
| [1848](#L1848) | 'company'             => 'false', |
| [1849](#L1849) | 'company\_label'       => \_\_( 'Company', 'funnel-builder' ), |
| [1850](#L1850) | 'company\_placeholder' => '', |
| [1851](#L1851) | 'hint'                => \_\_( 'Field ID: ', 'funnel-builder' ) . $type . '\_company', |
| [1852](#L1852) | 'required'            => false, |
| [1853](#L1853) | ); |
| [1854](#L1854) | $address\_field['fields\_options']['address\_1'] = array( |
| [1855](#L1855) | 'street\_address1'              => 'true', |
| [1856](#L1856) | 'street\_address\_1\_label'       => \_\_( 'Street address', 'woocommerce' ), |
| [1857](#L1857) | 'street\_address\_1\_placeholder' => '', |
| [1858](#L1858) | 'hint'                         => \_\_( 'Field ID: ', 'woofunnels-aero-checkout' ) . $type . '\_address\_1', |
| [1859](#L1859) | 'required'                     => true, |
| [1860](#L1860) | ); |
| [1861](#L1861) | $address\_field['fields\_options']['address\_2'] = array( |
| [1862](#L1862) | 'street\_address2'              => $fields\_visibility, |
| [1863](#L1863) | 'street\_address\_2\_label'       => \_\_( 'Apartment, suite, unit etc', 'woocommerce' ), |
| [1864](#L1864) | 'street\_address\_2\_placeholder' => '', |
| [1865](#L1865) | 'hint'                         => \_\_( 'Field ID: ', 'woofunnels-aero-checkout' ) . $type . '\_address\_2', |
| [1866](#L1866) | 'required'                     => false, |
| [1867](#L1867) | ); |
| [1868](#L1868) | $address\_field['fields\_options']['city']      = array( |
| [1869](#L1869) | 'address\_city'             => 'true', |
| [1870](#L1870) | 'address\_city\_label'       => \_\_( 'Town / City', 'funnel-builder' ), |
| [1871](#L1871) | 'address\_city\_placeholder' => '', |
| [1872](#L1872) | 'hint'                     => \_\_( 'Field ID: ', 'funnel-builder' ) . $type . '\_city', |
| [1873](#L1873) | 'required'                 => true, |
| [1874](#L1874) | ); |
| [1875](#L1875) | $address\_field['fields\_options']['postcode']  = array( |
| [1876](#L1876) | 'address\_postcode'             => 'true', |
| [1877](#L1877) | 'address\_postcode\_label'       => \_\_( 'Postcode', 'funnel-builder' ), |
| [1878](#L1878) | 'address\_postcode\_placeholder' => '', |
| [1879](#L1879) | 'hint'                         => \_\_( 'Field ID: ', 'funnel-builder' ) . $type . '\_postcode', |
| [1880](#L1880) | 'required'                     => true, |
| [1881](#L1881) | ); |
| [1882](#L1882) | $address\_field['fields\_options']['country']   = array( |
| [1883](#L1883) | 'address\_country'             => 'true', |
| [1884](#L1884) | 'address\_country\_label'       => \_\_( 'Country', 'funnel-builder' ), |
| [1885](#L1885) | 'address\_country\_placeholder' => '', |
| [1886](#L1886) | 'hint'                        => \_\_( 'Field ID: ', 'funnel-builder' ) . $type . '\_country', |
| [1887](#L1887) | 'required'                    => true, |
| [1888](#L1888) | ); |
| [1889](#L1889) | $address\_field['fields\_options']['state']     = array( |
| [1890](#L1890) | 'address\_state'             => 'true', |
| [1891](#L1891) | 'address\_state\_label'       => \_\_( 'State', 'funnel-builder' ), |
| [1892](#L1892) | 'address\_state\_placeholder' => '', |
| [1893](#L1893) | 'hint'                      => \_\_( 'Field ID: ', 'funnel-builder' ) . $type . '\_state', |
| [1894](#L1894) | 'required'                  => false, |
| [1895](#L1895) | ); |
| [1896](#L1896) | $address\_field['fields\_options']['phone']     = array( |
| [1897](#L1897) | 'address\_phone'             => 'false', |
| [1898](#L1898) | 'address\_phone\_label'       => \_\_( 'Phone', 'funnel-builder' ), |
| [1899](#L1899) | 'address\_phone\_placeholder' => '', |
| [1900](#L1900) | 'hint'                      => \_\_( 'Field ID: ', 'funnel-builder' ) . $type . '\_phone', |
| [1901](#L1901) | 'required'                  => false, |
| [1902](#L1902) | ); |
| [1903](#L1903) | if ( 'billing' === $type ) { |
| [1904](#L1904) | $address\_field['fields\_options']['first\_name']['configuration\_message'] = \_\_( 'Note: Keep this field turned OFF, if you are using First name as a separate field.', 'funnel-builder' ); |
| [1905](#L1905) | $address\_field['fields\_options']['last\_name']['configuration\_message']  = \_\_( 'Note: Keep this field turned OFF, if you are using Last name as a separate field.', 'funnel-builder' ); |
| [1906](#L1906) | $address\_field['fields\_options']['phone']['configuration\_message']      = \_\_( 'Note: Keep this field turned OFF, if you are using Phone as a separate field.', 'funnel-builder' ); |
| [1907](#L1907) | } |
| [1908](#L1908) | $address\_field['fields\_options'] = apply\_filters( 'wfacp\_' . $type . '\_address\_options', $address\_field['fields\_options'] ); |
| [1909](#L1909) |  |
| [1910](#L1910) | return $address\_field; |
| [1911](#L1911) | } |
| [1912](#L1912) |  |
| [1913](#L1913) | public static function get\_default\_steps\_fields( $active\_steps = false ) { |
| [1914](#L1914) |  |
| [1915](#L1915) | return array( |
| [1916](#L1916) | 'single\_step' => array( |
| [1917](#L1917) | 'name'          => \_\_( 'Step 1', 'funnel-builder' ), |
| [1918](#L1918) | 'slug'          => 'single\_step', |
| [1919](#L1919) | 'friendly\_name' => \_\_( 'Single Step Checkout', 'funnel-builder' ), |
| [1920](#L1920) | 'active'        => 'yes', |
| [1921](#L1921) | ), |
| [1922](#L1922) | 'two\_step'    => array( |
| [1923](#L1923) | 'name'          => \_\_( 'Step 2', 'funnel-builder' ), |
| [1924](#L1924) | 'slug'          => 'two\_step', |
| [1925](#L1925) | 'friendly\_name' => \_\_( 'Two Step Checkout', 'funnel-builder' ), |
| [1926](#L1926) | 'active'        => true === $active\_steps ? 'yes' : 'no', |
| [1927](#L1927) | ), |
| [1928](#L1928) | 'third\_step'  => array( |
| [1929](#L1929) | 'name'          => \_\_( 'Step 3', 'funnel-builder' ), |
| [1930](#L1930) | 'slug'          => 'third\_step', |
| [1931](#L1931) | 'friendly\_name' => \_\_( 'Three Step Checkout', 'funnel-builder' ), |
| [1932](#L1932) | 'active'        => true === $active\_steps ? 'yes' : 'no', |
| [1933](#L1933) | ), |
| [1934](#L1934) | ); |
| [1935](#L1935) | } |
| [1936](#L1936) |  |
| [1937](#L1937) | public static function get\_advanced\_fields() { |
| [1938](#L1938) | $field = array( |
| [1939](#L1939) | 'order\_comments' => [ |
| [1940](#L1940) | 'type'        => 'textarea', |
| [1941](#L1941) | 'class'       => [ 'notes' ], |
| [1942](#L1942) | 'id'          => 'order\_comments', |
| [1943](#L1943) | 'label'       => \_\_( 'Order notes', 'woocommerce' ), |
| [1944](#L1944) | 'placeholder' => \_\_( 'Order notes', 'woocommerce' ), |
| [1945](#L1945) | ], |
| [1946](#L1946) | ); |
| [1947](#L1947) |  |
| [1948](#L1948) |  |
| [1949](#L1949) | $field['shipping\_calculator'] = [ |
| [1950](#L1950) | 'type'       => 'wfacp\_html', |
| [1951](#L1951) | 'field\_type' => 'advanced', |
| [1952](#L1952) | 'id'         => 'shipping\_calculator', |
| [1953](#L1953) | 'default'    => self::default\_shipping\_placeholder\_text(), |
| [1954](#L1954) | 'class'      => [ 'wfacp\_shipping\_calculator' ], |
| [1955](#L1955) | 'label'      => \_\_( 'Shipping method', 'funnel-builder' ), |
| [1956](#L1956) | ]; |
| [1957](#L1957) |  |
| [1958](#L1958) |  |
| [1959](#L1959) | $field['order\_summary'] = [ |
| [1960](#L1960) | 'type'       => 'wfacp\_html', |
| [1961](#L1961) | 'field\_type' => 'advanced', |
| [1962](#L1962) | 'class'      => [ 'wfacp\_order\_summary' ], |
| [1963](#L1963) | 'id'         => 'order\_summary', |
| [1964](#L1964) | 'label'      => \_\_( 'Order Summary', 'funnel-builder' ), |
| [1965](#L1965) | ]; |
| [1966](#L1966) |  |
| [1967](#L1967) | $field['order\_total']             = [ |
| [1968](#L1968) | 'type'       => 'wfacp\_html', |
| [1969](#L1969) | 'field\_type' => 'advanced', |
| [1970](#L1970) | 'class'      => [ 'wfacp\_order\_total' ], |
| [1971](#L1971) | 'default'    => false, |
| [1972](#L1972) | 'is\_locked'  => 'yes', |
| [1973](#L1973) | 'id'         => 'order\_summary', |
| [1974](#L1974) | 'label'      => \_\_( 'Order Total', 'funnel-builder' ), |
| [1975](#L1975) | 'is\_pro'     => true, |
| [1976](#L1976) | ]; |
| [1977](#L1977) | $success\_message                  = sprintf( \_\_( 'Congrats! Coupon code %s %s applied successfully.', 'funnel-builder' ), '{{coupon\_code}}', '({{coupon\_value}})' ); |
| [1978](#L1978) | $field['order\_coupon']            = [ |
| [1979](#L1979) | 'type'                           => 'wfacp\_html', |
| [1980](#L1980) | 'field\_type'                     => 'advanced', |
| [1981](#L1981) | 'class'                          => [ 'wfacp\_order\_coupon' ], |
| [1982](#L1982) | 'id'                             => 'order\_coupon', |
| [1983](#L1983) | 'coupon\_style'                   => 'true', |
| [1984](#L1984) | 'coupon\_success\_message\_heading' => $success\_message, |
| [1985](#L1985) | 'coupon\_remove\_message\_heading'  => \_\_( 'Coupon code removed successfully.', 'funnel-builder' ), |
| [1986](#L1986) | 'label'                          => \_\_( 'Coupon code', 'funnel-builder' ), |
| [1987](#L1987) | ]; |
| [1988](#L1988) | $field['wc\_advanced\_order\_field'] = [ |
| [1989](#L1989) | 'id'             => 'wc\_advanced\_order\_field', |
| [1990](#L1990) | 'type'           => 'wfacp\_html', |
| [1991](#L1991) | 'label'          => \_\_( 'Extra Advanced Fields' ), |
| [1992](#L1992) | 'placeholder'    => '', |
| [1993](#L1993) | 'data\_label'     => \_\_( 'Extra Advanced Fields' ), |
| [1994](#L1994) | 'required'       => false, |
| [1995](#L1995) | 'default'        => '', |
| [1996](#L1996) | 'field\_type'     => 'advanced', |
| [1997](#L1997) | 'is\_wfacp\_field' => 'true', |
| [1998](#L1998) | 'class'          => [ 'wfacp-col-full', 'wfacp-form-control-wrapper', 'wfacp\_date\_field' ], |
| [1999](#L1999) | ]; |
| [2000](#L2000) |  |
| [2001](#L2001) | return apply\_filters( 'wfacp\_advanced\_fields', $field ); |
| [2002](#L2002) | } |
| [2003](#L2003) |  |
| [2004](#L2004) | public static function get\_product\_field() { |
| [2005](#L2005) | $output = []; |
| [2006](#L2006) |  |
| [2007](#L2007) | $output['product\_switching'] = [ |
| [2008](#L2008) | 'type'        => 'product', |
| [2009](#L2009) | 'class'       => [ 'wfacp\_product\_switcher' ], |
| [2010](#L2010) | 'id'          => 'product\_switching', |
| [2011](#L2011) | 'is\_locked'   => 'yes', |
| [2012](#L2012) | 'label'       => \_\_( 'Products', 'woocommerce' ), |
| [2013](#L2013) | 'data\_label'  => \_\_( 'Products', 'woocommerce' ), |
| [2014](#L2014) | 'field\_type'  => 'product', |
| [2015](#L2015) | 'placeholder' => '', |
| [2016](#L2016) | 'is\_pro'      => true, |
| [2017](#L2017) | ]; |
| [2018](#L2018) |  |
| [2019](#L2019) | $output = apply\_filters( 'wfacp\_products\_field', $output ); |
| [2020](#L2020) |  |
| [2021](#L2021) | return $output; |
| [2022](#L2022) | } |
| [2023](#L2023) |  |
| [2024](#L2024) |  |
| [2025](#L2025) | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Page layout section End \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
| [2026](#L2026) | /\*\* |
| [2027](#L2027) | \* Get default global setting schema |
| [2028](#L2028) | \* @return array |
| [2029](#L2029) | \*/ |
| [2030](#L2030) | /\*\* |
| [2031](#L2031) | \* Return Shortcodes of embed form |
| [2032](#L2032) | \*/ |
| [2033](#L2033) | public static function get\_short\_codes() { |
| [2034](#L2034) | $id = WFACP\_Common::get\_id(); |
| [2035](#L2035) |  |
| [2036](#L2036) | $shortcode = "[wfacp\_forms id='{$id}']"; |
| [2037](#L2037) | $lightbox  = "[wfacp\_forms id='{$id}' lightbox='yes']"; |
| [2038](#L2038) |  |
| [2039](#L2039) | return [ 'shortcode' => $shortcode, 'lightbox\_shortcode' => $lightbox ]; |
| [2040](#L2040) | } |
| [2041](#L2041) |  |
| [2042](#L2042) | public static function get\_shortcode\_supported\_template() { |
| [2043](#L2043) | return [ |
| [2044](#L2044) | 'selected'        => 'embed\_forms\_1', |
| [2045](#L2045) | 'selected\_type'   => 'embed\_forms', |
| [2046](#L2046) | 'template\_active' => 'yes' |
| [2047](#L2047) | ]; |
| [2048](#L2048) | } |
| [2049](#L2049) |  |
| [2050](#L2050) | /\*\* |
| [2051](#L2051) | \* Check Current Aero page is created by old version |
| [2052](#L2052) | \* @return bool |
| [2053](#L2053) | \*/ |
| [2054](#L2054) | public static function page\_is\_old\_version( $version = '1.9.3' ) { |
| [2055](#L2055) | $current\_version = WFACP\_Common::get\_checkout\_page\_version(); |
| [2056](#L2056) | if ( version\_compare( $current\_version, $version, '>' ) ) { |
| [2057](#L2057) | return false; |
| [2058](#L2058) | } |
| [2059](#L2059) |  |
| [2060](#L2060) | return true; |
| [2061](#L2061) | } |
| [2062](#L2062) |  |
| [2063](#L2063) | public static function last\_item\_delete\_message( $resp, $item\_key = '' ) { |
| [2064](#L2064) |  |
| [2065](#L2065) | if ( apply\_filters( 'wfacp\_force\_deletion\_last\_item', false ) && '' !== $item\_key ) { |
| [2066](#L2066) | //add\_action( 'woocommerce\_cart\_item\_removed', 'WFACP\_Common::remove\_item\_deleted\_items', 10, 2 ); |
| [2067](#L2067) | WC()->cart->remove\_cart\_item( $item\_key ); |
| [2068](#L2068) | //remove\_action( 'woocommerce\_cart\_item\_removed', 'WFACP\_Common::remove\_item\_deleted\_items', 10 ); |
| [2069](#L2069) | $resp['force\_redirect'] = apply\_filters( 'wfacp\_force\_redirect\_url', wc\_get\_cart\_url() ); |
| [2070](#L2070) |  |
| [2071](#L2071) | return $resp; |
| [2072](#L2072) | } |
| [2073](#L2073) |  |
| [2074](#L2074) | $last\_item\_delete\_message = \_\_( 'At least one item should be available in your cart to checkout.', 'funnel-builder' ); |
| [2075](#L2075) |  |
| [2076](#L2076) | if ( apply\_filters( 'wfacp\_enable\_last\_item\_delete', false ) ) { |
| [2077](#L2077) |  |
| [2078](#L2078) | $are\_you\_sure             = \_\_( 'Click to delete this last item from your cart.', 'funnel-builder' ); |
| [2079](#L2079) | $are\_you\_sure             = " <a href='' class='wfacp\_force\_last\_delete'>" . $are\_you\_sure . "</a>"; |
| [2080](#L2080) | $last\_item\_delete\_message .= $are\_you\_sure; |
| [2081](#L2081) | } |
| [2082](#L2082) |  |
| [2083](#L2083) | $resp['error'] = apply\_filters( 'wfacp\_last\_item\_message', $last\_item\_delete\_message ); |
| [2084](#L2084) |  |
| [2085](#L2085) | return $resp; |
| [2086](#L2086) | } |
| [2087](#L2087) |  |
| [2088](#L2088) | public static function get\_address\_field\_order( $id ) { |
| [2089](#L2089) | $id       = absint( $id ); |
| [2090](#L2090) | $data     = get\_post\_meta( $id, '\_wfacp\_save\_address\_order', true ); |
| [2091](#L2091) | $defaults = [ 'address' => [], 'shipping-address' => [], 'display\_type\_address' => 'checkbox', 'display\_type\_shipping-address' => 'checkbox' ]; |
| [2092](#L2092) | if ( empty( $data ) || ! is\_array( $data ) ) { |
| [2093](#L2093) | return $defaults; |
| [2094](#L2094) | } |
| [2095](#L2095) |  |
| [2096](#L2096) | foreach ( $defaults as $key => $val ) { |
| [2097](#L2097) | if ( ! isset( $data[ $key ] ) ) { |
| [2098](#L2098) | $data[ $key ] = $val; |
| [2099](#L2099) | } |
| [2100](#L2100) | } |
| [2101](#L2101) |  |
| [2102](#L2102) |  |
| [2103](#L2103) | return $data; |
| [2104](#L2104) |  |
| [2105](#L2105) | } |
| [2106](#L2106) |  |
| [2107](#L2107) |  |
| [2108](#L2108) | public static function get\_template\_container\_atts( $template = '' ) { |
| [2109](#L2109) |  |
| [2110](#L2110) |  |
| [2111](#L2111) | return $template; |
| [2112](#L2112) | } |
| [2113](#L2113) |  |
| [2114](#L2114) | public static function do\_not\_show\_session\_expired\_message( $status ) { |
| [2115](#L2115) | if ( isset( $\_REQUEST['wfacp\_id'] ) && wp\_doing\_ajax() ) { |
| [2116](#L2116) | $status = false; |
| [2117](#L2117) | } |
| [2118](#L2118) |  |
| [2119](#L2119) | return $status; |
| [2120](#L2120) | } |
| [2121](#L2121) |  |
| [2122](#L2122) |  |
| [2123](#L2123) | public static function show\_cart\_empty\_message() { |
| [2124](#L2124) |  |
| [2125](#L2125) | echo '<div class="wfacp\_cart\_empty">'; |
| [2126](#L2126) | do\_action( 'wfacp\_cart\_empty\_before\_message' ); |
| [2127](#L2127) | echo apply\_filters( 'wfacp\_cart\_empty\_message', \_\_( 'Your cart is currently empty.', 'funnel-builder' ) ); |
| [2128](#L2128) | do\_action( 'wfacp\_cart\_empty\_after\_message' ); |
| [2129](#L2129) | echo '</div>'; |
| [2130](#L2130) |  |
| [2131](#L2131) | } |
| [2132](#L2132) |  |
| [2133](#L2133) | public static function cart\_is\_sustained() { |
| [2134](#L2134) | if ( is\_null( WC()->session ) ) { |
| [2135](#L2135) | return false; |
| [2136](#L2136) | } |
| [2137](#L2137) |  |
| [2138](#L2138) | return WC()->session->get( 'wfacp\_checkout\_processed\_' . WFACP\_Common::get\_Id(), false ); |
| [2139](#L2139) |  |
| [2140](#L2140) | } |
| [2141](#L2141) |  |
| [2142](#L2142) | public static function delete\_page\_layout( $post\_id ) { |
| [2143](#L2143) | delete\_post\_meta( $post\_id, '\_wfacp\_page\_layout' ); |
| [2144](#L2144) | delete\_post\_meta( $post\_id, '\_wfacp\_fieldsets\_data' ); |
| [2145](#L2145) | delete\_post\_meta( $post\_id, '\_wfacp\_checkout\_fields' ); |
| [2146](#L2146) | delete\_post\_meta( $post\_id, '\_wfacp\_save\_address\_order' ); |
| [2147](#L2147) |  |
| [2148](#L2148) | } |
| [2149](#L2149) |  |
| [2150](#L2150) | public static function get\_template\_filter( $all\_pro = false ) { |
| [2151](#L2151) |  |
| [2152](#L2152) | $options = [ |
| [2153](#L2153) | '1' => \_\_( 'One Step', 'funnel-builder' ), |
| [2154](#L2154) | '2' => \_\_( 'Two Step', 'funnel-builder' ), |
| [2155](#L2155) | '3' => \_\_( 'Three Step', 'funnel-builder' ), |
| [2156](#L2156) | ]; |
| [2157](#L2157) |  |
| [2158](#L2158) | return $options; |
| [2159](#L2159) | } |
| [2160](#L2160) |  |
| [2161](#L2161) | public static function remove\_item\_remove\_cart\_item( $item\_key, $cart\_key = '' ) { |
| [2162](#L2162) | $removed\_cart\_items = WC()->cart->removed\_cart\_contents; |
| [2163](#L2163) | if ( empty( $removed\_cart\_items ) ) { |
| [2164](#L2164) | return; |
| [2165](#L2165) | } |
| [2166](#L2166) | foreach ( $removed\_cart\_items as $key => $item ) { |
| [2167](#L2167) | if ( ( isset( $item['\_wfacp\_product'] ) && $item['\_wfacp\_product\_key'] == $item\_key ) || ( $cart\_key == $key ) ) { |
| [2168](#L2168) | unset( $removed\_cart\_items[ $key ] ); |
| [2169](#L2169) | } |
| [2170](#L2170) | } |
| [2171](#L2171) | if ( count( $removed\_cart\_items ) > 0 ) { |
| [2172](#L2172) | WC()->cart->set\_removed\_cart\_contents( $removed\_cart\_items ); |
| [2173](#L2173) | } |
| [2174](#L2174) | } |
| [2175](#L2175) |  |
| [2176](#L2176) |  |
| [2177](#L2177) | /\*\* |
| [2178](#L2178) | \* get global price data after tax calculation based |
| [2179](#L2179) | \*     \* |
| [2180](#L2180) | \* |
| [2181](#L2181) | \* @param $cart\_item |
| [2182](#L2182) | \* @param int $qty |
| [2183](#L2183) | \* |
| [2184](#L2184) | \* @return float |
| [2185](#L2185) | \*/ |
| [2186](#L2186) | public static function get\_subscription\_cart\_item\_price( $cart\_item, $qty = 1 ) { |
| [2187](#L2187) | $price = 0; |
| [2188](#L2188) | if ( ! empty( $cart\_item ) ) { |
| [2189](#L2189) | $display\_type = WFACP\_Common::get\_tax\_display\_mode(); |
| [2190](#L2190) | if ( 'incl' == $display\_type ) { |
| [2191](#L2191) | $price = round( $cart\_item['line\_subtotal'] + $cart\_item['line\_subtotal\_tax'], wc\_get\_price\_decimals() ); |
| [2192](#L2192) | } else { |
| [2193](#L2193) | $price = round( $cart\_item['line\_subtotal'], wc\_get\_price\_decimals() ); |
| [2194](#L2194) | } |
| [2195](#L2195) | } |
| [2196](#L2196) |  |
| [2197](#L2197) | return $price; |
| [2198](#L2198) | } |
| [2199](#L2199) |  |
| [2200](#L2200) | static function get\_price\_sign\_up\_fee( $product, $type = '' ) { |
| [2201](#L2201) |  |
| [2202](#L2202) | if ( 'inc\_tax' == $type ) { |
| [2203](#L2203) | return wcs\_get\_price\_including\_tax( $product, array( 'price' => WC\_Subscriptions\_Product::get\_sign\_up\_fee( $product ) ) ); |
| [2204](#L2204) | } |
| [2205](#L2205) |  |
| [2206](#L2206) | return wcs\_get\_price\_excluding\_tax( $product, array( 'price' => WC\_Subscriptions\_Product::get\_sign\_up\_fee( $product ) ) ); |
| [2207](#L2207) | } |
| [2208](#L2208) |  |
| [2209](#L2209) | public static function get\_cart\_undo\_message() { |
| [2210](#L2210) | $cart\_contents = WC()->cart->removed\_cart\_contents; |
| [2211](#L2211) | if ( empty( WC()->cart->removed\_cart\_contents ) ) { |
| [2212](#L2212) | return; |
| [2213](#L2213) | } |
| [2214](#L2214) | wc\_clear\_notices(); |
| [2215](#L2215) | $out\_items = []; |
| [2216](#L2216) | foreach ( $cart\_contents as $cart\_item\_key => $cart\_item ) { |
| [2217](#L2217) | $item\_data = wc\_get\_product( $cart\_item['product\_id'] ); |
| [2218](#L2218) | if ( ! $item\_data instanceof WC\_Product ) { |
| [2219](#L2219) | continue; |
| [2220](#L2220) | } |
| [2221](#L2221) | if ( isset( $cart\_item['\_wfob\_options'] ) ) { |
| [2222](#L2222) | continue; |
| [2223](#L2223) | } |
| [2224](#L2224) | if ( isset( $cart\_item['xlwcfg\_gift\_id'] ) ) { |
| [2225](#L2225) | continue; |
| [2226](#L2226) | } |
| [2227](#L2227) | if ( true === apply\_filters( 'wfacp\_show\_undo\_message\_for\_item', false, $cart\_item ) ) { |
| [2228](#L2228) | continue; |
| [2229](#L2229) | } |
| [2230](#L2230) |  |
| [2231](#L2231) | $item\_key   = $cart\_item\_key; |
| [2232](#L2232) | $item\_class = 'wfacp\_restore\_cart\_item'; |
| [2233](#L2233) | $item\_icon  = "&nbsp;" . \_\_( 'Undo?', 'funnel-builder' ); |
| [2234](#L2234) | if ( isset( $cart\_item['\_wfacp\_product'] ) && ! WFACP\_Core()->public->is\_checkout\_override() ) { |
| [2235](#L2235) | $item\_key = $cart\_item['\_wfacp\_product\_key']; |
| [2236](#L2236) |  |
| [2237](#L2237) | if ( isset( $out\_items[ $item\_key ] ) && $out\_items[ $item\_key ] > 0 ) { |
| [2238](#L2238) | continue; |
| [2239](#L2239) | } |
| [2240](#L2240) | $out\_items[ $item\_key ] = 1; |
| [2241](#L2241) | $wfacp\_data             = $cart\_item['\_wfacp\_options']; |
| [2242](#L2242) | $item\_title             = $wfacp\_data['title']; |
| [2243](#L2243) | $status                 = WFACP\_Common::get\_cart\_item\_key( $item\_key ); |
| [2244](#L2244) | if ( ! is\_null( $status ) ) { |
| [2245](#L2245) | continue; |
| [2246](#L2246) | } |
| [2247](#L2247) |  |
| [2248](#L2248) |  |
| [2249](#L2249) | } else { |
| [2250](#L2250) | $item\_title = $item\_data->get\_name(); |
| [2251](#L2251) | } |
| [2252](#L2252) | if ( $item\_data && $item\_data->is\_in\_stock() && $item\_data->has\_enough\_stock( $cart\_item['quantity'] ) ) { |
| [2253](#L2253) | /\* Translators: %s Product title. \*/ |
| [2254](#L2254) | $removed\_notice = sprintf( \_\_( '%s removed.', 'funnel-builder' ), $item\_title ); |
| [2255](#L2255) | $removed\_notice .= sprintf( '<a href="javascript:void(0)" class="%s" data-cart\_key="%s" data-item\_key="%s">%s</a>', $item\_class, $cart\_item\_key, $item\_key, $item\_icon ); |
| [2256](#L2256) | } else { |
| [2257](#L2257) | /\* Translators: %s Product title. \*/ |
| [2258](#L2258) | $removed\_notice = sprintf( \_\_( '%s removed.', 'funnel-builder' ), $item\_title ); |
| [2259](#L2259) | } |
| [2260](#L2260) | echo "<div class='wfacp\_product\_restore\_wrap'>" . $removed\_notice . '</div>'; |
| [2261](#L2261) | } |
| [2262](#L2262) | } |
| [2263](#L2263) |  |
| [2264](#L2264) | public static function delete\_cart\_item\_link( $allow\_delete, $cart\_item\_key, $cart\_item ) { |
| [2265](#L2265) | if ( apply\_filters( 'wfacp\_delete\_item\_from\_order\_summary', $allow\_delete, $cart\_item\_key, $cart\_item ) ) { |
| [2266](#L2266) |  |
| [2267](#L2267) | $item\_icon = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"> |
| [2268](#L2268) | <path d="M16.3394 9.32245C16.7434 8.94589 16.7657 8.31312 16.3891 7.90911C16.0126 7.50509 15.3798 7.48283 14.9758 7.85938L12.0497 10.5866L9.32245 7.66048C8.94589 7.25647 8.31312 7.23421 7.90911 7.61076C7.50509 7.98731 7.48283 8.62008 7.85938 9.0241L10.5866 11.9502L7.66048 14.6775C7.25647 15.054 7.23421 15.6868 7.61076 16.0908C7.98731 16.4948 8.62008 16.5171 9.0241 16.1405L11.9502 13.4133L14.6775 16.3394C15.054 16.7434 15.6868 16.7657 16.0908 16.3891C16.4948 16.0126 16.5171 15.3798 16.1405 14.9758L13.4133 12.0497L16.3394 9.32245Z" fill="currentColor"/> |
| [2269](#L2269) | <path fill-rule="evenodd" clip-rule="evenodd" d="M1 12C1 5.92487 5.92487 1 12 1C18.0751 1 23 5.92487 23 12C23 18.0751 18.0751 23 12 23C5.92487 23 1 18.0751 1 12ZM12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21Z" fill="currentColor"/> |
| [2270](#L2270) | </svg>'; |
| [2271](#L2271) |  |
| [2272](#L2272) | ?> |
| [2273](#L2273) | <div class="wfacp\_order\_summary\_item\_delete wfacp\_delete\_item\_wrap"> |
| [2274](#L2274) | <a href="javascript:void(0)" class="wfacp\_remove\_item\_from\_order\_summary" data-cart\_key="<?php echo $cart\_item\_key; ?>"><?php echo $item\_icon; ?></a> |
| [2275](#L2275) | </div> |
| [2276](#L2276) | <?php |
| [2277](#L2277) | } |
| [2278](#L2278) | } |
| [2279](#L2279) |  |
| [2280](#L2280) | public static function import\_checkout\_settings( $post\_id, $file\_path ) { |
| [2281](#L2281) | if ( file\_exists( $file\_path ) ) { |
| [2282](#L2282) | $page\_layout = include $file\_path; |
| [2283](#L2283) | $page\_layout = apply\_filters( 'wfacp\_import\_checkout\_settings', $page\_layout, $post\_id, $file\_path ); |
| [2284](#L2284) | if ( isset( $page\_layout['page\_layout'] ) ) { |
| [2285](#L2285) | WFACP\_Common::update\_page\_layout( $post\_id, $page\_layout['page\_layout'], true ); |
| [2286](#L2286) | } |
| [2287](#L2287) |  |
| [2288](#L2288) | if ( isset( $page\_layout['page\_settings'] ) ) { |
| [2289](#L2289) | WFACP\_Template\_Importer::update\_import\_page\_settings( $post\_id, $page\_layout['page\_settings'] ); |
| [2290](#L2290) | } |
| [2291](#L2291) |  |
| [2292](#L2292) |  |
| [2293](#L2293) | if ( isset( $page\_layout['wfacp\_product\_switcher\_setting'] ) ) { |
| [2294](#L2294) | update\_post\_meta( $post\_id, '\_wfacp\_product\_switcher\_setting', $page\_layout['wfacp\_product\_switcher\_setting'] ); |
| [2295](#L2295) | } |
| [2296](#L2296) | if ( isset( $page\_layout['default\_customizer\_value'] ) && is\_array( $page\_layout['default\_customizer\_value'] ) ) { |
| [2297](#L2297) | $customizer = $page\_layout['default\_customizer\_value']; |
| [2298](#L2298) | $final\_data = []; |
| [2299](#L2299) | foreach ( $customizer as $key => $value ) { |
| [2300](#L2300) | $final\_data = array\_merge( $final\_data, $value ); |
| [2301](#L2301) | } |
| [2302](#L2302) | if ( ! empty( $final\_data ) ) { |
| [2303](#L2303) | update\_option( WFACP\_SLUG . '\_c\_' . $post\_id, $final\_data ); |
| [2304](#L2304) | } |
| [2305](#L2305) |  |
| [2306](#L2306) | } |
| [2307](#L2307) | } |
| [2308](#L2308) |  |
| [2309](#L2309) | } |
| [2310](#L2310) |  |
| [2311](#L2311) | public static function is\_front\_page() { |
| [2312](#L2312) | $page\_on\_front = get\_option( 'page\_on\_front' ); |
| [2313](#L2313) | if ( 'page' === get\_option( 'show\_on\_front' ) && absint( $page\_on\_front ) > 0 ) { |
| [2314](#L2314) | $temp = get\_post( $page\_on\_front ); |
| [2315](#L2315) | if ( ! is\_null( $temp ) && $temp->post\_type == WFACP\_Common::get\_post\_type\_slug() ) { |
| [2316](#L2316) | return true; |
| [2317](#L2317) | } |
| [2318](#L2318) | } |
| [2319](#L2319) |  |
| [2320](#L2320) | return false; |
| [2321](#L2321) | } |
| [2322](#L2322) |  |
| [2323](#L2323) | public static function get\_tax\_display\_mode() { |
| [2324](#L2324) |  |
| [2325](#L2325) | if ( is\_null( WC()->cart ) ) { |
| [2326](#L2326) | return ''; |
| [2327](#L2327) | } |
| [2328](#L2328) |  |
| [2329](#L2329) | if ( version\_compare( WC()->version, '4.4', 'lt' ) ) { |
| [2330](#L2330) | return WC()->cart->tax\_display\_cart; |
| [2331](#L2331) | } |
| [2332](#L2332) |  |
| [2333](#L2333) | return WC()->cart->get\_tax\_price\_display\_mode(); |
| [2334](#L2334) |  |
| [2335](#L2335) | } |
| [2336](#L2336) |  |
| [2337](#L2337) | public static function check\_builder\_status( $builder = '' ) { |
| [2338](#L2338) | // Divi Builder Plugin Exists |
| [2339](#L2339) | $response = [ 'found' => false, 'error' => '', 'is\_old\_version' => 'no', 'version' => '' ]; |
| [2340](#L2340) | if ( empty( $builder ) ) { |
| [2341](#L2341) | $response['error'] = \_\_( 'No Builder Specified', 'funnel-builder' ); |
| [2342](#L2342) | } else if ( 'oxy' === $builder ) { |
| [2343](#L2343) | $supported\_version   = '3.7'; |
| [2344](#L2344) | $oxy\_exist           = false; |
| [2345](#L2345) | $oxy\_builder\_version = '1.0'; |
| [2346](#L2346) | if ( class\_exists( 'CT\_Component' ) ) { |
| [2347](#L2347) | $oxy\_exist = true; |
| [2348](#L2348) | if ( defined( 'CT\_VERSION' ) ) { |
| [2349](#L2349) | $oxy\_builder\_version = CT\_VERSION; |
| [2350](#L2350) | } |
| [2351](#L2351) | } |
| [2352](#L2352) |  |
| [2353](#L2353) | if ( true === $oxy\_exist ) { |
| [2354](#L2354) | $response['found'] = true; |
| [2355](#L2355) | if ( ! version\_compare( $oxy\_builder\_version, $supported\_version, '>=' ) ) { |
| [2356](#L2356) | $response['is\_old\_version'] = 'yes'; |
| [2357](#L2357) | $response['version']        = $oxy\_builder\_version; |
| [2358](#L2358) | $response['error']          = sprintf( \_\_( 'Site has an older version of Oxygen Builder. Templates are supported for v%s or greater.<br /> Please update.', 'funnel-builder' ), $supported\_version ); |
| [2359](#L2359) | } |
| [2360](#L2360) | } |
| [2361](#L2361) |  |
| [2362](#L2362) | } else if ( 'divi' === $builder ) { |
| [2363](#L2363) | $supported\_version    = '4.1'; |
| [2364](#L2364) | $divi\_exist           = false; |
| [2365](#L2365) | $divi\_builder\_version = 0; |
| [2366](#L2366) | // Detect Divi Builder Plugin is Active |
| [2367](#L2367) | if ( class\_exists( 'ET\_Builder\_Plugin' ) ) { |
| [2368](#L2368) | $divi\_exist = true; |
| [2369](#L2369) |  |
| [2370](#L2370) | if ( defined( 'ET\_BUILDER\_PLUGIN\_VERSION' ) ) { |
| [2371](#L2371) | $divi\_builder\_version = ET\_BUILDER\_PLUGIN\_VERSION; |
| [2372](#L2372) | } |
| [2373](#L2373) |  |
| [2374](#L2374) |  |
| [2375](#L2375) | } else if ( function\_exists( 'et\_setup\_theme' ) ) { // Detect Theme Active |
| [2376](#L2376) | $divi\_exist = true; |
| [2377](#L2377) | $theme      = wp\_get\_theme(); |
| [2378](#L2378) | if ( $theme instanceof WP\_Theme ) { |
| [2379](#L2379) | $parent = $theme->parent(); |
| [2380](#L2380) | if ( $parent instanceof WP\_Theme ) { |
| [2381](#L2381) | $divi\_builder\_version = $parent->get( 'Version' ); |
| [2382](#L2382) | } else { |
| [2383](#L2383) | $divi\_builder\_version = $theme->get( 'Version' ); |
| [2384](#L2384) | } |
| [2385](#L2385) |  |
| [2386](#L2386) | } |
| [2387](#L2387) | } |
| [2388](#L2388) | // available in Both Theme & Plugin |
| [2389](#L2389) | if ( 0 == $divi\_builder\_version && defined( 'ET\_BUILDER\_PRODUCT\_VERSION' ) ) { |
| [2390](#L2390) | $divi\_builder\_version = ET\_BUILDER\_PRODUCT\_VERSION; |
| [2391](#L2391) | } |
| [2392](#L2392) |  |
| [2393](#L2393) | //ET\_Builder\_Plugin |
| [2394](#L2394) | if ( true === $divi\_exist && class\_exists( 'ET\_Core\_Portability' ) ) { |
| [2395](#L2395) | $response['found']   = true; |
| [2396](#L2396) | $response['version'] = $divi\_builder\_version; |
| [2397](#L2397) | if ( ! version\_compare( $divi\_builder\_version, $supported\_version, '>=' ) ) { |
| [2398](#L2398) | $response['is\_old\_version'] = 'yes'; |
| [2399](#L2399) | $response['error']          = sprintf( \_\_( 'Site has an older version of Divi Builder. Templates are supported for v%s or greater.<br /> Please update.', 'funnel-builder' ), $supported\_version ); |
| [2400](#L2400) | } |
| [2401](#L2401) | } |
| [2402](#L2402) | } |
| [2403](#L2403) |  |
| [2404](#L2404) | return $response; |
| [2405](#L2405) | } |
| [2406](#L2406) |  |
| [2407](#L2407) | public static function get\_device\_mode() { |
| [2408](#L2408) | $device\_type = 'desktop'; |
| [2409](#L2409) | $detect      = WFACP\_Mobile\_Detect::get\_instance(); |
| [2410](#L2410) |  |
| [2411](#L2411) | if ( $detect->isMobile() ) { |
| [2412](#L2412) | $device\_type = 'mobile'; |
| [2413](#L2413) | if ( $detect->istablet() ) { |
| [2414](#L2414) | $device\_type = 'tablet'; |
| [2415](#L2415) | } |
| [2416](#L2416) | } |
| [2417](#L2417) |  |
| [2418](#L2418) | return $device\_type; |
| [2419](#L2419) | } |
| [2420](#L2420) |  |
| [2421](#L2421) | final public static function get\_list\_of\_attach\_actions( $hook ) { |
| [2422](#L2422) |  |
| [2423](#L2423) | $output = []; |
| [2424](#L2424) | global $wp\_filter; |
| [2425](#L2425) | $object = null; |
| [2426](#L2426) | if ( isset( $wp\_filter[ $hook ] ) && ( $wp\_filter[ $hook ] instanceof WP\_Hook ) ) { |
| [2427](#L2427) | $hooks = $wp\_filter[ $hook ]->callbacks; |
| [2428](#L2428) | foreach ( $hooks as $priority => $reference ) { |
| [2429](#L2429) | if ( is\_array( $reference ) && count( $reference ) > 0 ) { |
| [2430](#L2430) | foreach ( $reference as $index => $calls ) { |
| [2431](#L2431) | if ( isset( $calls['function'] ) && is\_array( $calls['function'] ) && count( $calls['function'] ) > 0 ) { |
| [2432](#L2432) | if ( is\_object( $calls['function'][0] ) ) { |
| [2433](#L2433) | $cls\_name = get\_class( $calls['function'][0] ); |
| [2434](#L2434) | $output[] = [ |
| [2435](#L2435) | 'type'       => 'class', |
| [2436](#L2436) | 'class'      => $cls\_name, |
| [2437](#L2437) | 'function'   => $calls['function'][1], |
| [2438](#L2438) | 'class\_path' => WFACP\_Common::get\_class\_path( $cls\_name ), |
| [2439](#L2439) | 'index'      => $index, |
| [2440](#L2440) | 'priority'   => $priority, |
| [2441](#L2441) | ]; |
| [2442](#L2442) |  |
| [2443](#L2443) | } else { |
| [2444](#L2444) | $output[] = [ |
| [2445](#L2445) | 'type'       => 'static\_class', |
| [2446](#L2446) | 'class'      => $calls['function'][0], |
| [2447](#L2447) | 'function'   => $calls['function'][1], |
| [2448](#L2448) | 'class\_path' => WFACP\_Common::get\_class\_path( $calls['function'][0] ), |
| [2449](#L2449) | 'index'      => $index, |
| [2450](#L2450) | 'priority'   => $priority, |
| [2451](#L2451) | ]; |
| [2452](#L2452) | } |
| [2453](#L2453) |  |
| [2454](#L2454) | } else { |
| [2455](#L2455) | $output[] = [ |
| [2456](#L2456) | 'type'          => 'function', |
| [2457](#L2457) | 'function'      => $calls['function'], |
| [2458](#L2458) | 'function\_path' => WFACP\_Common::get\_function\_path( $calls['function'] ), |
| [2459](#L2459) | 'index'         => $index, |
| [2460](#L2460) | 'priority'      => $priority, |
| [2461](#L2461) | ]; |
| [2462](#L2462) | } |
| [2463](#L2463) | } |
| [2464](#L2464) | } |
| [2465](#L2465) | } |
| [2466](#L2466) | } |
| [2467](#L2467) |  |
| [2468](#L2468) |  |
| [2469](#L2469) | return $output; |
| [2470](#L2470) | } |
| [2471](#L2471) |  |
| [2472](#L2472) | public static function maybe\_insert\_log( $content ) { |
| [2473](#L2473) |  |
| [2474](#L2474) | if ( true === apply\_filters( 'bwf\_conversion\_api\_checkout\_event\_logs', false ) && self::is\_enabled\_log() ) { |
| [2475](#L2475) | wc\_get\_logger()->log( 'info', $content, array( 'source' => 'bwf\_facebook\_conversion\_api' ) ); |
| [2476](#L2476) | } |
| [2477](#L2477) | } |
| [2478](#L2478) |  |
| [2479](#L2479) | /\*\* |
| [2480](#L2480) | \* Check if logs are enabled or not for the conversion API |
| [2481](#L2481) | \* @return bool |
| [2482](#L2482) | \*/ |
| [2483](#L2483) | public static function is\_enabled\_log() { |
| [2484](#L2484) | $admin\_general         = BWF\_Admin\_General\_Settings::get\_instance(); |
| [2485](#L2485) | $is\_conversion\_api\_log = $admin\_general->get\_option( 'is\_fb\_conversion\_api\_log' ); |
| [2486](#L2486) | if ( is\_array( $is\_conversion\_api\_log ) && count( $is\_conversion\_api\_log ) > 0 && 'yes' === $is\_conversion\_api\_log[0] ) { |
| [2487](#L2487) | return true; |
| [2488](#L2488) | } |
| [2489](#L2489) |  |
| [2490](#L2490) | return false; |
| [2491](#L2491) | } |
| [2492](#L2492) |  |
| [2493](#L2493) | public static function get\_user\_email() { |
| [2494](#L2494) | $current\_user = wp\_get\_current\_user(); |
| [2495](#L2495) |  |
| [2496](#L2496) | // not logged in |
| [2497](#L2497) | if ( $current\_user->ID == 0 ) { |
| [2498](#L2498) | return ''; |
| [2499](#L2499) | } |
| [2500](#L2500) |  |
| [2501](#L2501) | return $current\_user->user\_email; |
| [2502](#L2502) | } |
| [2503](#L2503) |  |
| [2504](#L2504) | public static function the\_content( $post ) { |
| [2505](#L2505) | if ( is\_null( $post ) ) { |
| [2506](#L2506) | return ''; |
| [2507](#L2507) | } |
| [2508](#L2508) | $content = get\_the\_content( null, false, $post ); |
| [2509](#L2509) |  |
| [2510](#L2510) | /\*\* |
| [2511](#L2511) | \* Filters the post content. |
| [2512](#L2512) | \* |
| [2513](#L2513) | \* @param string $content Content of the current post. |
| [2514](#L2514) | \* |
| [2515](#L2515) | \* @since 0.71 |
| [2516](#L2516) | \* |
| [2517](#L2517) | \*/ |
| [2518](#L2518) | $content = apply\_filters( 'the\_content', $content ); |
| [2519](#L2519) | $content = str\_replace( ']]>', ']]&gt;', $content ); |
| [2520](#L2520) | echo $content; |
| [2521](#L2521) | } |
| [2522](#L2522) |  |
| [2523](#L2523) | /\* Modern Label\*/ |
| [2524](#L2524) |  |
| [2525](#L2525) | public static function get\_old\_placeholders() { |
| [2526](#L2526) | return [ |
| [2527](#L2527) | 'john.doe@example.com', |
| [2528](#L2528) | 'john.doe@example.com ', |
| [2529](#L2529) | 'John', |
| [2530](#L2530) | 'Doe', |
| [2531](#L2531) | 'john', |
| [2532](#L2532) | 'doe', |
| [2533](#L2533) | 'Albany', |
| [2534](#L2534) | 'House Number and Street Name', |
| [2535](#L2535) | '12084', |
| [2536](#L2536) | '999-999-9999', |
| [2537](#L2537) | 'United States', |
| [2538](#L2538) | 'New York' |
| [2539](#L2539) | ]; |
| [2540](#L2540) | } |
| [2541](#L2541) |  |
| [2542](#L2542) |  |
| [2543](#L2543) | public static function live\_change\_modern\_label( $field ) { |
| [2544](#L2544) |  |
| [2545](#L2545) | $placeholder = $field['placeholder']; |
| [2546](#L2546) | if ( empty( $placeholder ) ) { |
| [2547](#L2547) | return $field; |
| [2548](#L2548) | } |
| [2549](#L2549) | $search = self::get\_old\_placeholders(); |
| [2550](#L2550) | if ( in\_array( $placeholder, $search ) ) { |
| [2551](#L2551) | $field['placeholder'] = $field['label']; |
| [2552](#L2552) | } |
| [2553](#L2553) |  |
| [2554](#L2554) | return $field; |
| [2555](#L2555) | } |
| [2556](#L2556) |  |
| [2557](#L2557) | public static function modern\_label\_migrate( $id ) { |
| [2558](#L2558) | $migrate = get\_post\_meta( $id, '\_wfacp\_page\_modern\_label\_migrate', true ); |
| [2559](#L2559) | if ( 'yes' == $migrate ) { |
| [2560](#L2560) | return; |
| [2561](#L2561) | } |
| [2562](#L2562) |  |
| [2563](#L2563) | $page\_layout    = get\_post\_meta( $id, '\_wfacp\_page\_layout', true ); |
| [2564](#L2564) | $page\_field\_set = get\_post\_meta( $id, '\_wfacp\_fieldsets\_data', true ); |
| [2565](#L2565) | if ( empty( $page\_layout ) ) { |
| [2566](#L2566) | return; |
| [2567](#L2567) | } |
| [2568](#L2568) |  |
| [2569](#L2569) | // Saving backup |
| [2570](#L2570) | update\_post\_meta( $id, '\_wfacp\_page\_layout\_bck', $page\_layout ); |
| [2571](#L2571) | update\_post\_meta( $id, '\_wfacp\_fieldsets\_data\_bck', $page\_field\_set ); |
| [2572](#L2572) |  |
| [2573](#L2573) |  |
| [2574](#L2574) | $search         = self::get\_old\_placeholders(); |
| [2575](#L2575) | $page\_layout    = json\_encode( $page\_layout ); |
| [2576](#L2576) | $page\_field\_set = json\_encode( $page\_field\_set ); |
| [2577](#L2577) | $page\_layout    = str\_replace( $search, '', $page\_layout ); |
| [2578](#L2578) | $page\_field\_set = str\_replace( $search, '', $page\_field\_set ); |
| [2579](#L2579) | if ( is\_null( $page\_layout ) || empty( $page\_layout ) ) { |
| [2580](#L2580) | // Do not override meta field  value if $page\_layout is null |
| [2581](#L2581) | return; |
| [2582](#L2582) | } |
| [2583](#L2583) |  |
| [2584](#L2584) | update\_post\_meta( $id, '\_wfacp\_page\_layout', json\_decode( $page\_layout, true ) ); |
| [2585](#L2585) | update\_post\_meta( $id, '\_wfacp\_fieldsets\_data', json\_decode( $page\_field\_set, true ) ); |
| [2586](#L2586) | update\_post\_meta( $id, '\_wfacp\_page\_modern\_label\_migrate', 'yes' ); |
| [2587](#L2587) | } |
| [2588](#L2588) |  |
| [2589](#L2589) | /\*\* |
| [2590](#L2590) | \* Update Label Meta while template import |
| [2591](#L2591) | \* |
| [2592](#L2592) | \* @param $post\_id |
| [2593](#L2593) | \* @param $json\_data |
| [2594](#L2594) | \* |
| [2595](#L2595) | \* @return void |
| [2596](#L2596) | \*/ |
| [2597](#L2597) | public static function update\_label\_meta( $post\_id, $json\_data ) { |
| [2598](#L2598) | if ( is\_array( $json\_data ) ) { |
| [2599](#L2599) | $json\_data = json\_encode( $json\_data ); |
| [2600](#L2600) | } |
| [2601](#L2601) | if ( empty( $json\_data ) ) { |
| [2602](#L2602) | return; |
| [2603](#L2603) | } |
| [2604](#L2604) | if ( false !== strpos( $json\_data, 'wfacp-modern-label' ) ) { |
| [2605](#L2605) | $field\_label = 'wfacp-modern-label'; |
| [2606](#L2606) | } else if ( false !== strpos( $json\_data, 'wfacp-top' ) ) { |
| [2607](#L2607) | $field\_label = 'wfacp-top'; |
| [2608](#L2608) | } else { |
| [2609](#L2609) | $field\_label = 'wfacp-inside'; |
| [2610](#L2610) | } |
| [2611](#L2611) |  |
| [2612](#L2612) | update\_post\_meta( $post\_id, '\_wfacp\_field\_label\_position', $field\_label ); |
| [2613](#L2613) |  |
| [2614](#L2614) | } |
| [2615](#L2615) |  |
| [2616](#L2616) | public static function get\_pro\_link() { |
| [2617](#L2617) | return esc\_url( 'https://www.funnelkit.com/funnel-builder-lite-upgrade/' ); |
| [2618](#L2618) | } |
| [2619](#L2619) |  |
| [2620](#L2620) | public static function is\_funnel\_builder\_3() { |
| [2621](#L2621) | return class\_exists( 'WFFN\_REST\_CHECKOUT\_API\_EndPoint' ); |
| [2622](#L2622) | } |
| [2623](#L2623) |  |
| [2624](#L2624) | /\*\* |
| [2625](#L2625) | \* display Value instead of of slug For Radio,Checkbox,Multiselect field at thankyou and email |
| [2626](#L2626) | \* |
| [2627](#L2627) | \* @param $meta\_value |
| [2628](#L2628) | \* @param $fields |
| [2629](#L2629) | \* |
| [2630](#L2630) | \* @return string |
| [2631](#L2631) | \*/ |
| [2632](#L2632) | public static function map\_meta\_value\_for\_custom\_fields( $meta\_value, $field ) { |
| [2633](#L2633) | if ( ! isset( $field['options'] ) || empty( $field['options'] ) ) { |
| [2634](#L2634) | return $meta\_value; |
| [2635](#L2635) | } |
| [2636](#L2636) | $options = $field['options']; |
| [2637](#L2637) | if ( is\_array( $meta\_value ) ) { |
| [2638](#L2638) | $meta\_value = array\_map( function ( $item ) use ( $options ) { |
| [2639](#L2639) | return isset( $options[ $item ] ) ? $options[ $item ] : $item; |
| [2640](#L2640) | }, $meta\_value ); |
| [2641](#L2641) | $meta\_value = implode( ', ', $meta\_value ); |
| [2642](#L2642) | } else { |
| [2643](#L2643) | $meta\_value = isset( $options[ $meta\_value ] ) ? $options[ $meta\_value ] : $meta\_value; |
| [2644](#L2644) | } |
| [2645](#L2645) |  |
| [2646](#L2646) | return $meta\_value; |
| [2647](#L2647) |  |
| [2648](#L2648) | } |
| [2649](#L2649) |  |
| [2650](#L2650) | public static function update\_aero\_custom\_fields( $order, $posted\_data, $force\_save = false ) { |
| [2651](#L2651) | $wfacp\_id = 0; |
| [2652](#L2652) | if ( isset( $posted\_data['wfacp\_post\_id'] ) ) { |
| [2653](#L2653) | $wfacp\_id = $posted\_data['wfacp\_post\_id']; |
| [2654](#L2654) | } else if ( isset( $posted\_data['\_wfacp\_post\_id'] ) ) { |
| [2655](#L2655) | $wfacp\_id = $posted\_data['\_wfacp\_post\_id']; |
| [2656](#L2656) | } else if ( $\_GET['wfacp\_id'] ) { |
| [2657](#L2657) | $wfacp\_id = $posted\_data['wfacp\_id']; |
| [2658](#L2658) | } |
| [2659](#L2659) | $is\_numeric = false; |
| [2660](#L2660) | if ( is\_numeric( $order ) ) { |
| [2661](#L2661) | $is\_numeric = true; |
| [2662](#L2662) | $order      = wc\_get\_order( $order ); |
| [2663](#L2663) | } |
| [2664](#L2664) | if ( ! $order instanceof WC\_Order ) { |
| [2665](#L2665) | return; |
| [2666](#L2666) | } |
| [2667](#L2667) |  |
| [2668](#L2668) | $wfacp\_id = absint( $wfacp\_id ); |
| [2669](#L2669) | if ( $wfacp\_id < 1 ) { |
| [2670](#L2670) | return; |
| [2671](#L2671) | } |
| [2672](#L2672) | $order->update\_meta\_data( '\_wfacp\_post\_id', $wfacp\_id ); |
| [2673](#L2673) | $order->update\_meta\_data( '\_wfacp\_source', $posted\_data['wfacp\_source'] ); |
| [2674](#L2674) |  |
| [2675](#L2675) | $timezone = $posted\_data['wfacp\_timezone'] ?? ( $\_POST['wfacp\_timezone'] ?? null ); |
| [2676](#L2676) | if ( ! is\_null( $timezone ) ) { |
| [2677](#L2677) | $order->update\_meta\_data( '\_wfacp\_timezone', wc\_clean( $timezone ) ); |
| [2678](#L2678) | } |
| [2679](#L2679) |  |
| [2680](#L2680) | $cfields           = WFACP\_Common::get\_page\_custom\_fields( $wfacp\_id ); |
| [2681](#L2681) | $have\_custom\_field = isset( $cfields['advanced'] ) && ! empty( $cfields['advanced'] ); |
| [2682](#L2682) |  |
| [2683](#L2683) | if ( $have\_custom\_field ) { |
| [2684](#L2684) | $advancedFields = $cfields['advanced']; |
| [2685](#L2685) | foreach ( $advancedFields as $field\_key => $field ) { |
| [2686](#L2686) | if ( isset( $field['type'] ) && ( 'wfacp\_html' === $field['type'] || 'wfacp\_wysiwyg' === $field['type'] ) ) { |
| [2687](#L2687) | continue; |
| [2688](#L2688) | } |
| [2689](#L2689) | $field\_value = $posted\_data[ $field\_key ] ?? ( $\_REQUEST[ $field\_key ] ?? null ); |
| [2690](#L2690) | if ( is\_null( $field\_value ) ) { |
| [2691](#L2691) | continue; |
| [2692](#L2692) | } |
| [2693](#L2693) | if ( ! empty( $field\_value ) && $field['type'] == 'date' ) { |
| [2694](#L2694) | $field\_value = date( 'Y-m-d', strtotime( $field\_value ) ); |
| [2695](#L2695) | } elseif ( ! empty( $field\_value ) && $field['type'] == 'wfacp\_dob' ) { |
| [2696](#L2696) | $field\_value = ( $posted\_data[ $field\_key ]['year'] ?? ( $\_REQUEST[ $field\_key ]['year'] ) ) . '-' . ( $posted\_data[ $field\_key ]['month'] ?? $\_REQUEST[ $field\_key ]['month'] ) . '-' . ( $posted\_data[ $field\_key ]['day'] ?? $\_REQUEST[ $field\_key ]['day'] ); |
| [2697](#L2697) | } |
| [2698](#L2698) | if ( $field['type'] != 'multiselect' ) { |
| [2699](#L2699) | $field\_value = wc\_clean( $field\_value ); |
| [2700](#L2700) | } |
| [2701](#L2701) | $order->update\_meta\_data( $field\_key, $field\_value ); |
| [2702](#L2702) |  |
| [2703](#L2703) | } |
| [2704](#L2704) | } |
| [2705](#L2705) | if ( $is\_numeric || $force\_save ) { |
| [2706](#L2706) | $order->save(); |
| [2707](#L2707) | } |
| [2708](#L2708) |  |
| [2709](#L2709) | } |
| [2710](#L2710) |  |
| [2711](#L2711) | public static function get\_optional\_checkout\_fields( $checkout\_id ) { |
| [2712](#L2712) |  |
| [2713](#L2713) | $checkout\_fields = WFACP\_Common::get\_checkout\_fields( $checkout\_id ); |
| [2714](#L2714) |  |
| [2715](#L2715) | $optional\_fields = []; |
| [2716](#L2716) |  |
| [2717](#L2717) |  |
| [2718](#L2718) | if ( isset( $checkout\_fields['product'] ) ) { |
| [2719](#L2719) | unset( $checkout\_fields['product'] ); |
| [2720](#L2720) | } |
| [2721](#L2721) | if ( isset( $checkout\_fields['product'] ) ) { |
| [2722](#L2722) | unset( $checkout\_fields['product'] ); |
| [2723](#L2723) | } |
| [2724](#L2724) |  |
| [2725](#L2725) |  |
| [2726](#L2726) | $page\_layout = WFACP\_Common::get\_page\_layout( $checkout\_id ); |
| [2727](#L2727) |  |
| [2728](#L2728) |  |
| [2729](#L2729) | if ( ! isset( $page\_layout['fieldsets'] ) ) { |
| [2730](#L2730) | return $optional\_fields; |
| [2731](#L2731) |  |
| [2732](#L2732) | } |
| [2733](#L2733) |  |
| [2734](#L2734) | $exclude\_keys = [ |
| [2735](#L2735) | 'billing\_same\_as\_shipping', |
| [2736](#L2736) | 'shipping\_same\_as\_billing', |
| [2737](#L2737) | 'wfacp\_divider\_shipping', |
| [2738](#L2738) | 'wfacp\_divider\_shipping\_end', |
| [2739](#L2739) | 'wfacp\_divider\_billing', |
| [2740](#L2740) | 'wfacp\_divider\_billing\_end', |
| [2741](#L2741) | 'billing\_address\_1', |
| [2742](#L2742) | 'billing\_city', |
| [2743](#L2743) | 'billing\_postcode', |
| [2744](#L2744) | 'billing\_country', |
| [2745](#L2745) | 'billing\_state', |
| [2746](#L2746) | 'shipping\_address\_1', |
| [2747](#L2747) | 'shipping\_city', |
| [2748](#L2748) | 'shipping\_postcode', |
| [2749](#L2749) | 'shipping\_country', |
| [2750](#L2750) | 'shipping\_state', |
| [2751](#L2751) | 'product\_switching', |
| [2752](#L2752) | 'order\_total', |
| [2753](#L2753) | 'order\_coupon', |
| [2754](#L2754) | 'shipping\_calculator', |
| [2755](#L2755) | 'order\_summary', |
| [2756](#L2756) | 'bwfan\_birthday\_date', |
| [2757](#L2757) | ]; |
| [2758](#L2758) |  |
| [2759](#L2759) |  |
| [2760](#L2760) | foreach ( $checkout\_fields as $i => $fieldset ) { |
| [2761](#L2761) |  |
| [2762](#L2762) | foreach ( $fieldset as $key => $fields ) { |
| [2763](#L2763) |  |
| [2764](#L2764) | if ( ! isset( $fields['type'] ) || 'wfacp\_html' == $fields['type'] ) { |
| [2765](#L2765) | continue; |
| [2766](#L2766) | } |
| [2767](#L2767) | if ( isset( $fields['required'] ) && true == wc\_string\_to\_bool( $fields['required'] ) ) { |
| [2768](#L2768) | continue; |
| [2769](#L2769) | } |
| [2770](#L2770) | if ( in\_array( $key, $exclude\_keys ) ) { |
| [2771](#L2771) | continue; |
| [2772](#L2772) | } |
| [2773](#L2773) |  |
| [2774](#L2774) | $optional\_fields[ $key ]            = $fields; |
| [2775](#L2775) | $optional\_fields[ $key ]['disable'] = true; |
| [2776](#L2776) |  |
| [2777](#L2777) | } |
| [2778](#L2778) |  |
| [2779](#L2779) | } |
| [2780](#L2780) |  |
| [2781](#L2781) |  |
| [2782](#L2782) | $all\_fields     = []; |
| [2783](#L2783) | $address\_fields = []; |
| [2784](#L2784) | $tmp            = []; |
| [2785](#L2785) | if ( isset( $page\_layout['address\_order'] ) && is\_array( $page\_layout['address\_order'] ) && count( $page\_layout['address\_order'] ) > 0 ) { |
| [2786](#L2786) | foreach ( $page\_layout['address\_order'] as $address\_key => $fields ) { |
| [2787](#L2787) | if ( ! in\_array( $address\_key, [ 'shipping-address', 'address' ] ) ) { |
| [2788](#L2788) | continue; |
| [2789](#L2789) | } |
| [2790](#L2790) | $label\_key    = 'billing\_'; |
| [2791](#L2791) | $label\_prefix = 'Billing'; |
| [2792](#L2792) |  |
| [2793](#L2793) | if ( $address\_key == 'shipping-address' ) { |
| [2794](#L2794) | $label\_key    = 'shipping\_'; |
| [2795](#L2795) | $label\_prefix = 'Shipping'; |
| [2796](#L2796) | } |
| [2797](#L2797) |  |
| [2798](#L2798) | $tmp[] = $address\_key; |
| [2799](#L2799) | foreach ( $fields as $adderess\_index => $field ) { |
| [2800](#L2800) | if ( ! isset( $field['key'] ) || in\_array( $label\_key . $field['key'], $exclude\_keys ) ) { |
| [2801](#L2801) | continue; |
| [2802](#L2802) | } |
| [2803](#L2803) |  |
| [2804](#L2804) | if ( isset( $field['required'] ) && true == wc\_string\_to\_bool( $field['required'] ) ) { |
| [2805](#L2805) |  |
| [2806](#L2806) | continue; |
| [2807](#L2807) | } |
| [2808](#L2808) | $add\_field\_key = $field['key']; |
| [2809](#L2809) |  |
| [2810](#L2810) | $field['field\_type']                           = $address\_key; |
| [2811](#L2811) | $address\_fields[ $label\_key . $add\_field\_key ] = $field; |
| [2812](#L2812) |  |
| [2813](#L2813) | if ( isset( $field['status'] ) && true == wc\_string\_to\_bool( $field['status'] ) ) { |
| [2814](#L2814) | $address\_fields[ $label\_key . $add\_field\_key ]['disable'] = false; |
| [2815](#L2815) | } else { |
| [2816](#L2816) | $address\_fields[ $label\_key . $add\_field\_key ]['disable'] = true; |
| [2817](#L2817) | } |
| [2818](#L2818) |  |
| [2819](#L2819) | if ( ! isset( $field['label'] ) ) { |
| [2820](#L2820) |  |
| [2821](#L2821) | continue; |
| [2822](#L2822) | } |
| [2823](#L2823) | $address\_fields[ $label\_key . $add\_field\_key ]['label'] = $label\_prefix . " " . $field['label']; |
| [2824](#L2824) |  |
| [2825](#L2825) | } |
| [2826](#L2826) | } |
| [2827](#L2827) | } |
| [2828](#L2828) |  |
| [2829](#L2829) |  |
| [2830](#L2830) | foreach ( $page\_layout['fieldsets'] as $field\_step\_key => $field\_step\_val ) { |
| [2831](#L2831) | foreach ( $field\_step\_val as $i => $fields ) { |
| [2832](#L2832) | if ( ! isset( $fields['fields'] ) ) { |
| [2833](#L2833) | continue; |
| [2834](#L2834) | } |
| [2835](#L2835) |  |
| [2836](#L2836) |  |
| [2837](#L2837) | foreach ( $fields['fields'] as $k => $field ) { |
| [2838](#L2838) | if ( ! isset( $field['id'] ) || in\_array( $field['id'], $exclude\_keys ) ) { |
| [2839](#L2839) | continue; |
| [2840](#L2840) | } |
| [2841](#L2841) | if ( array\_key\_exists( $field['id'], $tmp ) ) { |
| [2842](#L2842) | continue; |
| [2843](#L2843) | } |
| [2844](#L2844) | if ( isset( $field['fields\_options'] ) && is\_array( $field['fields\_options'] ) ) { |
| [2845](#L2845) | $label\_key    = 'billing\_'; |
| [2846](#L2846) | $label\_prefix = 'Billing'; |
| [2847](#L2847) | if ( $field['id'] == 'shipping-address' ) { |
| [2848](#L2848) | $label\_key    = 'shipping\_'; |
| [2849](#L2849) | $label\_prefix = 'Shipping'; |
| [2850](#L2850) | } |
| [2851](#L2851) | foreach ( $field['fields\_options'] as $address\_key => $address\_field ) { |
| [2852](#L2852) | if ( ! isset( $field['id'] ) || in\_array( $label\_key . $address\_key, $exclude\_keys ) ) { |
| [2853](#L2853) | continue; |
| [2854](#L2854) | } |
| [2855](#L2855) | if ( isset( $address\_field['required'] ) && true == wc\_string\_to\_bool( $address\_field['required'] ) ) { |
| [2856](#L2856) | continue; |
| [2857](#L2857) | } |
| [2858](#L2858) | $address\_field['field\_type']             = $field['id']; |
| [2859](#L2859) | $all\_fields[ $label\_key . $address\_key ] = $address\_field; |
| [2860](#L2860) | if ( isset( $optional\_fields[ $label\_key . $address\_key ] ) && true == $optional\_fields[ $label\_key . $address\_key ] ) { |
| [2861](#L2861) | $all\_fields[ $label\_key . $address\_key ]['disable'] = false; |
| [2862](#L2862) | } else { |
| [2863](#L2863) | $all\_fields[ $label\_key . $address\_key ]['disable'] = true; |
| [2864](#L2864) | } |
| [2865](#L2865) |  |
| [2866](#L2866) | if ( isset( $address\_field['street\_address\_2\_label'] ) && false !== strpos( $address\_key, 'address\_2' ) ) { |
| [2867](#L2867) | $all\_fields[ $label\_key . $address\_key ]['label'] = $label\_prefix . " " . $address\_field['street\_address\_2\_label']; |
| [2868](#L2868) | } else if ( isset( $address\_field['address\_phone\_label'] ) && false !== strpos( $address\_key, 'phone' ) ) { |
| [2869](#L2869) | $all\_fields[ $label\_key . $address\_key ]['label'] = $label\_prefix . " " . $address\_field['address\_phone\_label']; |
| [2870](#L2870) | } else { |
| [2871](#L2871) | $all\_fields[ $label\_key . $address\_key ]['label'] = $label\_prefix . " " . $address\_field[ $address\_key . '\_label' ]; |
| [2872](#L2872) | } |
| [2873](#L2873) | } |
| [2874](#L2874) | } else { |
| [2875](#L2875) | if ( isset( $field['required'] ) && true == wc\_string\_to\_bool( $field['required'] ) ) { |
| [2876](#L2876) | continue; |
| [2877](#L2877) | } |
| [2878](#L2878) | $all\_fields[ $field['id'] ] = $field; |
| [2879](#L2879) | if ( isset( $all\_fields[ $field['id'] ] ) && true == $all\_fields[ $field['id'] ] ) { |
| [2880](#L2880) | $all\_fields[ $field['id'] ]['disable'] = false; |
| [2881](#L2881) | } else { |
| [2882](#L2882) | $all\_fields[ $field['id'] ]['disable'] = true; |
| [2883](#L2883) | } |
| [2884](#L2884) | } |
| [2885](#L2885) |  |
| [2886](#L2886) |  |
| [2887](#L2887) | } |
| [2888](#L2888) | } |
| [2889](#L2889) |  |
| [2890](#L2890) | } |
| [2891](#L2891) |  |
| [2892](#L2892) |  |
| [2893](#L2893) | if ( is\_array( $address\_fields ) && count( $address\_fields ) > 0 ) { |
| [2894](#L2894) | return array\_merge( $all\_fields, $address\_fields ); |
| [2895](#L2895) | } |
| [2896](#L2896) |  |
| [2897](#L2897) | return $all\_fields; |
| [2898](#L2898) | } |
| [2899](#L2899) |  |
| [2900](#L2900) | /\*\* |
| [2901](#L2901) | \* Override WooCommerce Block Checkout and Cart with older respective shortcodes |
| [2902](#L2902) | \* @return void |
| [2903](#L2903) | \*/ |
| [2904](#L2904) | public static function override\_block\_cart\_checkout() { |
| [2905](#L2905) | $wc\_checkout\_page = get\_post( wc\_get\_page\_id( 'checkout' ) ); |
| [2906](#L2906) |  |
| [2907](#L2907) | if ( has\_block( 'woocommerce/checkout', $wc\_checkout\_page ) ) { |
| [2908](#L2908) | wp\_update\_post( array( |
| [2909](#L2909) | 'ID'           => $wc\_checkout\_page->ID, |
| [2910](#L2910) | 'post\_content' => '<!-- wp:woocommerce/classic-shortcode {"shortcode":"checkout"} /-->', |
| [2911](#L2911) | ) ); |
| [2912](#L2912) | } |
| [2913](#L2913) |  |
| [2914](#L2914) |  |
| [2915](#L2915) | } |
| [2916](#L2916) |  |
| [2917](#L2917) | /\*\* |
| [2918](#L2918) | \* Return subscription version if woocommerce payment or Main Subscription |
| [2919](#L2919) | \* @return string |
| [2920](#L2920) | \* |
| [2921](#L2921) | \*/ |
| [2922](#L2922) | public static function get\_subscription\_version() { |
| [2923](#L2923) |  |
| [2924](#L2924) | if ( class\_exists( 'WC\_Subscriptions\_Core\_Plugin' ) ) { |
| [2925](#L2925) | $instance = WC\_Subscriptions\_Core\_Plugin::instance(); |
| [2926](#L2926) |  |
| [2927](#L2927) | return $instance->get\_plugin\_version(); |
| [2928](#L2928) | } |
| [2929](#L2929) |  |
| [2930](#L2930) | return WC\_Subscriptions::$version; |
| [2931](#L2931) |  |
| [2932](#L2932) | } |
| [2933](#L2933) |  |
| [2934](#L2934) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/funnel-builder/trunk/modules/checkouts/includes/class-wfacp-common-helper.php?format=txt)
* [Original Format](/export/3220168/funnel-builder/trunk/modules/checkouts/includes/class-wfacp-common-helper.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

