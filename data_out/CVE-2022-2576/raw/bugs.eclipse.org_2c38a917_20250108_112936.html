<!DOCTYPE html>
<html lang="en">
  <head>
    <title>580018 &ndash; Denial-of-Service vulnerability in the DTLS stack</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="data/assets/03c4bb46b12126a79867f9a9f5323634.css?1726586909" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1726586908"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/bugs',
                maxusermatches: 10
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "580018 – Denial-of-Service vulnerability in the DTLS stack",
                             "show_bug.cgi?id=580018" );
        document.title = "580018 – Denial-of-Service vulnerability in the DTLS stack";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "580018 – Denial-of-Service vulnerability in the DTLS stack", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1726586909"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico">
  </head>

  <body 
        class="bugs-eclipse-org-bugs
                 bz_bug
                 bz_status_NEW
                 bz_product_Californium
                 bz_component_Scandium
                 bz_bug_580018 yui-skin-sam">

  <div id="header"><!-- 1.0@bugzilla.org -->





<!--  START OF SOLSTICE HEADER -->
 <link rel="stylesheet" type="text/css" href="https://www.eclipse.org/eclipse.org-common/themes/solstice/public/stylesheets/vendor/cookieconsent/cookieconsent.min.css" />
 <script src="https://www.eclipse.org/eclipse.org-common/themes/solstice/public/javascript/vendor/cookieconsent/default.min.js"></script>
 <style type="text/css">
    @import url('https://www.eclipse.org/eclipse.org-common/themes/solstice/public/stylesheets/barebone.min.css')
    </style>
    <script
      src="https://www.eclipse.org/eclipse.org-common/themes/solstice/public/javascript/barebone.min.js">
    </script><header role="banner" class="barebone-layout thin-header padding-top-5 padding-bottom-5"  id="header-wrapper">
  <div class="container-fluid reset">
    <div class="row-fluid" id="header-row">
            <div class="col-sm-8 col-md-6 col-lg-4" id="header-left">
        <div class="wrapper-logo-default"><a href="https://www.eclipse.org/"><img class="logo-eclipse-default img-responsive hidden-xs" alt="logo" src=""https://www.eclipse.org/eclipse.org-common/themes/solstice/public/images/logo/eclipse-foundation-grey-orange.svg"/></a></div>
      </div>            <div class="col-sm-16 col-md-18 col-lg-20" id="main-menu-wrapper">
  <div class="navbar yamm" id="main-menu">
    <div id="navbar-collapse-1" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li class="visible-thin"><a href="https://www.eclipse.org/downloads/" target="_self">Download</a></li><li><a href="https://www.eclipse.org/users/" target="_self">Getting Started</a></li><li><a href="https://www.eclipse.org/membership/" target="_self">Members</a></li><li><a href="https://www.eclipse.org/projects/" target="_self">Projects</a></li>                  <li class="dropdown visible-xs"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Community <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="http://marketplace.eclipse.org">Marketplace</a></li><li><a href="http://events.eclipse.org">Events</a></li><li><a href="http://www.planeteclipse.org/">Planet Eclipse</a></li><li><a href="https://www.eclipse.org/community/eclipse_newsletter/">Newsletter</a></li><li><a href="https://www.youtube.com/user/EclipseFdn">Videos</a></li></ul></li><li class="dropdown visible-xs"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Participate <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://bugs.eclipse.org/bugs/">Report a Bug</a></li><li><a href="https://www.eclipse.org/forums/">Forums</a></li><li><a href="https://www.eclipse.org/mail/">Mailing Lists</a></li><li><a href="https://wiki.eclipse.org/">Wiki</a></li><li><a href="https://wiki.eclipse.org/IRC">IRC</a></li><li><a href="https://www.eclipse.org/contribute/">How to Contribute</a></li></ul></li><li class="dropdown visible-xs"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Working Groups <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="http://wiki.eclipse.org/Auto_IWG">Automotive</a></li><li><a href="http://iot.eclipse.org">Internet of Things</a></li><li><a href="http://locationtech.org">LocationTech</a></li><li><a href="http://lts.eclipse.org">Long-Term Support</a></li><li><a href="http://polarsys.org">PolarSys</a></li><li><a href="http://science.eclipse.org">Science</a></li><li><a href="http://www.openmdm.org">OpenMDM</a></li></ul></li>          <!-- More -->
          <li class="dropdown eclipse-more hidden-xs">
            <a data-toggle="dropdown" class="dropdown-toggle">More<b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li>
                <!-- Content container to add padding -->
                <div class="yamm-content">
                  <div class="row">
                    <ul class="col-sm-8 list-unstyled"><li><p><strong>Community</strong></p></li><li><a href="http://marketplace.eclipse.org">Marketplace</a></li><li><a href="http://events.eclipse.org">Events</a></li><li><a href="http://www.planeteclipse.org/">Planet Eclipse</a></li><li><a href="https://www.eclipse.org/community/eclipse_newsletter/">Newsletter</a></li><li><a href="https://www.youtube.com/user/EclipseFdn">Videos</a></li></ul><ul class="col-sm-8 list-unstyled"><li><p><strong>Participate</strong></p></li><li><a href="https://bugs.eclipse.org/bugs/">Report a Bug</a></li><li><a href="https://www.eclipse.org/forums/">Forums</a></li><li><a href="https://www.eclipse.org/mail/">Mailing Lists</a></li><li><a href="https://wiki.eclipse.org/">Wiki</a></li><li><a href="https://wiki.eclipse.org/IRC">IRC</a></li><li><a href="https://www.eclipse.org/contribute/">How to Contribute</a></li></ul><ul class="col-sm-8 list-unstyled"><li><p><strong>Working Groups</strong></p></li><li><a href="http://wiki.eclipse.org/Auto_IWG">Automotive</a></li><li><a href="http://iot.eclipse.org">Internet of Things</a></li><li><a href="http://locationtech.org">LocationTech</a></li><li><a href="http://lts.eclipse.org">Long-Term Support</a></li><li><a href="http://polarsys.org">PolarSys</a></li><li><a href="http://science.eclipse.org">Science</a></li><li><a href="http://www.openmdm.org">OpenMDM</a></li></ul>                  </div>
                </div>
              </li>
            </ul>
          </li>
              </ul>
    </div>
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      </button>
      <div class="wrapper-logo-mobile"><a class="navbar-brand visible-xs" href="https://www.eclipse.org/"><img class="logo-eclipse-default-mobile img-responsive" alt="logo" src="/eclipse.org-common/themes/solstice/public/images/logo/eclipse-800x188.png"/></a></div>    </div>
  </div>
</div>
    </div>
  </div>
</header>
<!--  END OF SOLSTICE HEADER -->

    <div id="titles">
      <span id="title">Bugzilla &ndash; Bug&nbsp;580018</span>

        <span id="subtitle" class="subheader">Denial-of-Service vulnerability in the DTLS stack</span>

        <span id="information" class="header_addl_info">Last modified: 2022-07-29 09:24:57 EDT</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=580018&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=580018" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        placeholder="Login">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/termsofuse.php">Terms of Use</a></li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/copyright.php">Copyright Agent</a></li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body"><div id=message>This Bugzilla instance is deprecated, and most Eclipse projects now use 
 <a href="https://github.com/eclipse">GitHub</a> or <a href="https://gitlab.eclipse.org/eclipse/">Eclipse GitLab</a>. Please see the <a href="https://gitlab.eclipse.org/eclipsefdn/helpdesk/-/wikis/Gerrit/Gerrit-and-Bugzilla-deprecation-and-migration-plan">deprecation plan</a> for details.</div>


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2022-07-29 09:24:57">
  <input type="hidden" name="id" value="580018">
  <input type="hidden" name="token" value="1736335728-ARKkB-EvFOgzZFw0hhp-fwMOk6DubnvxF8YUYwVJIFs">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=580018"><b>Bug&nbsp;580018</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">Denial-of-Service vulnerability in the DTLS stack</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span>Denial-of-Service vulnerability in the DTLS stack
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'Denial-of-Service vulnerability in the DTLS stack' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">NEW
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components. Select a Classification to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >Californium

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >IoT

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=Californium"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >Scandium

  (<a href="buglist.cgi?component=Scandium&amp;product=Californium&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

</th>

      <td>unspecified &#160; <a href="https://dev.eclipse.org/committers/bugs/bugz_manager.php"><img src="//dev.eclipse.org/small_icons/apps/accessories-text-editor.png" alt="Edit" title="Edit these values" /></a></td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">PC
        Linux
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>P3
       normal
      </td>
    </tr>

      <tr><th class="field_label "
    id="field_label_target_milestone">


  <a 
      title="The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it."
      class="field_help_link"
      href="page.cgi?id=fields.html#target_milestone"
  >Target Milestone:</a>

</th>
        <td>--- &#160; <a href="https://dev.eclipse.org/committers/bugs/bugz_manager.php"><img src="//dev.eclipse.org/small_icons/apps/accessories-text-editor.png" alt="Edit" title="Edit these values" /></a></td>
      </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Security vulnerabilitied reported against Eclipse projects</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=vulnerability.reports-inbox&#64;eclipse.org" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">


  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#qa_contact"
  >QA Contact:</a>

</th>
      <td><span class="vcard">
</span>
      </td>
    </tr>
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'cf-inbox\x40eclipse.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>

    <tr><th class="field_label "
    id="field_label_status_whiteboard">


  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>

</th><td>  
  </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >security

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2022-05-26 06:14 EDT by <span class="vcard"><span class="fn">Nurullah Erinola</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=nurullah.erinola&#64;rub.de" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2022-07-29 09:24 EDT
      (<a href="show_activity.cgi?id=580018">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>5 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="achim.kraus">achim.kraus</option>
                <option value="code">code</option>
                <option value="kai.hudalla">kai.hudalla</option>
                <option value="mikael.barbero">mikael.barbero</option>
                <option value="wayne.beaton">wayne.beaton</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="3" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_application_vnd.tcpdump.pcap">
        <td>
            <a href="attachment.cgi?id=288540"
               title="View the content of the attachment">
          <b>PCAP file with the interaction</b></a>

          <span class="bz_attach_extra_info">
              (4.62 KB,
                application/vnd.tcpdump.pcap)

            <br>
            <a href="#attach_288540"
               title="Go to the comment associated with the attachment">2022-05-26 06:14 EDT</a>,

            <span class="vcard"><span class="fn">Nurullah Erinola</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=nurullah.erinola&#64;rub.de" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=288540&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="3">
        <span class="bz_attach_view_hide">
            <a id="view_all" href="attachment.cgi?bugid=580018&amp;action=viewall">View All</a>
        </span>
        <a href="attachment.cgi?bugid=580018&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=580018&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1463425338" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nurullah Erinola</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=nurullah.erinola&#64;rub.de" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-05-26 06:14:29 EDT
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=288540" name="attach_288540" title="PCAP file with the interaction">attachment 288540</a> <a href="attachment.cgi?id=288540&amp;action=edit" title="PCAP file with the interaction">[details]</a></span>
PCAP file with the interaction

Our systematic analysis of DTLS implementations indicated that your DTLS stack is vulnerable to a Denial-of-Service attack.

Tested build
============
v3.5.0

Affected protocol versions
==========================
DTLS 1.2

Expected behavior
=================
According to the DTLS 1.2 standard in chapter 4.2.1 [1], the server may respond with a HelloVerifyRequest message when the client sends its ClientHello message.

This mechanism should provide defense against the following two DoS attacks:
1. An attacker can consume excessive resources on the server by transmitting a series of handshake initiation requests, causing the server to allocate state and potentially to perform expensive cryptographic operations.
2. An attacker can use the server as an amplifier by sending connection initiation messages with a forged source of the victim.  The server then sends its next message (in DTLS, a Certificate message, which can be quite large) to the victim machine, thus flooding it.

Observed behavior
=================
The DTLS stack does not perform a stateless cookie exchange during session resumption with Session IDs. If the server receives a ClientHello message with a valid Session ID, it responds directly with the ServerHello, ChangeCipherSpec, and Finished messages.

For an attack, an attacker only needs to collect valid Session IDs and then flood the server with ClientHello messages that contain one of the collected parameters.

The main problem here is that an attacker can force the server to send ServerHello, Certificate, ..., ServerHelloDone messages. As a result, the amplification attack is greatly increased.

A properly implemented server should not allow skipping the stateless cookie exchange.

Steps to Reproduce
==================
To reproduce the bug, OpenSSL can be used.
1. Launch an server. (We used for out tests the example DTLS server.)
2. Launch the OpenSSL client with:
openssl s_client -dtls -connect localhost:4433 -sess_out sess.pem -no_ticket -cipher ECDHE-ECDSA-AES256-GCM-SHA384
3. Close the connection.
4. Launch the OpenSSL client again with:
openssl s_client -dtls -connect localhost:4433 -sess_in sess.pem -no_ticket -cipher ECDHE-ECDSA-AES128-GCM-SHA256

The most important point here is that the cipher suite in the second handshake must be different from the negotiated in the first handshake. If everything works as planned, Wireshark should show an interaction
similar to that in the attached PCAP files.

Links
=====
[1] <a href="https://datatracker.ietf.org/doc/html/rfc6347#section-4.2.1">https://datatracker.ietf.org/doc/html/rfc6347#section-4.2.1</a></pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-05 06:42:50 EDT
        </span>

      </div>




<pre class="bz_comment_text">Thanks for reporting this.

I change my e-mail address end of May and was in vacation.

Is see two issues:

- if the server falls back to an full-handshake, it must use the HelloVerifyRequest

- if not, then there have been some discussions about the in the IETF mailing list, see <a href="https://mailarchive.ietf.org/arch/msg/tls/hlW5oeiZ-ZsrThTG2FgrlFhA-8s/">https://mailarchive.ietf.org/arch/msg/tls/hlW5oeiZ-ZsrThTG2FgrlFhA-8s/</a> .
The outcome of that is to configure the behavior according your requirements. See 

<a href="https://github.com/eclipse/californium/blob/main/scandium-core/src/main/java/org/eclipse/californium/scandium/config/DtlsConfig.java#L691">https://github.com/eclipse/californium/blob/main/scandium-core/src/main/java/org/eclipse/californium/scandium/config/DtlsConfig.java#L691</a>

and 

<a href="https://github.com/eclipse/californium/blob/main/demo-apps/cf-plugtest-server/src/main/java/org/eclipse/californium/plugtests/PlugtestServer.java#L142">https://github.com/eclipse/californium/blob/main/demo-apps/cf-plugtest-server/src/main/java/org/eclipse/californium/plugtests/PlugtestServer.java#L142</a> 

how to change the default.</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-05 11:57:15 EDT
        </span>

      </div>




<pre class="bz_comment_text">I prepared a PR to fix it.

<a href="https://github.com/eclipse/californium/pull/2039">https://github.com/eclipse/californium/pull/2039</a>

maybe you can retest with that.

I also added your test to 

<a href="https://github.com/eclipse/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl">https://github.com/eclipse/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl</a>

but I prefer to publish that test after a 3.6 release.

Currently I plan the 3.6 release for end of next week, 14. July. 2022.</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Bernard</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=code&#64;simonbernard.eu" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-06 08:26:44 EDT
        </span>

      </div>




<pre class="bz_comment_text">Some questions : 

1. Just to be sure, If we set DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD to 0, we are no more affected by this ?

2. Do you plan to create a CVE for this ?

3. I see you plan to release a 3.6 version with a fix, do you plan to do a security fix for 2.x or 2.7.x ?</pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-06 08:37:18 EDT
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; 1. Just to be sure, If we set DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD to 0, we are no more affected by this ?</span >

Yes, with that, the HelloVerifyRequest is always used.

<span class="quote">&gt; 2. Do you plan to create a CVE for this ?</span >

I consider it. 

<span class="quote">&gt; 3. I see you plan to release a 3.6 version with a fix, do you plan to do a security fix for 2.x or 2.7.x ?</span >

The patch uses a new API introduced with 3.x. Therefore it can't be applied to a 2.7.x.directly.

To skip the HelloVerifyRequest was introduced when the resumption handshake was intended to be used for frequent address changes. With RFC9146 it gets less frequently useful. So I think, use a 0 will do it in a 2.7.

Anyway, if you feel, it's important to use it with a 2.7. I will prepare a fix for that as well.</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Bernard</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=code&#64;simonbernard.eu" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-06 08:49:23 EDT
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; Anyway, if you feel, it's important to use it with a 2.7. I will prepare a fix for that as well.</span >

At Sierra we don't use it, so we don't really need it.

But I'm not so comfortable with the idea to have this issue in Leshan 1.x with the default configuration.

Maybe for cf 2.x : 
 - the default behavior should be set to 0
 - if user activate it, a warn about the security issue should be raised ? 

(or any other idea ?)</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-06 08:53:28 EDT
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; (or any other idea ?)</span >

Then fixing it will be easier ;-).

(Changing the defaults isn't that effective, because old &quot;Californium.properties&quot; will keep the old value.)</pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Bernard</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=code&#64;simonbernard.eu" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-06 09:03:37 EDT
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; (Changing the defaults isn't that effective, because old &quot;Californium.properties&quot; will keep the old value.)</span >

That's why I propose the warn log in addition. 

<span class="quote">&gt; Then fixing it will be easier ;-).</span >

If fixing is easy, I'm ok with it too.</pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-06 13:37:35 EDT
        </span>

      </div>




<pre class="bz_comment_text">About Californium 2.7:

A ClientHello, which causes in 3.0 a fallback to a full handshake, causes with the 2.7 an Alert &quot;Illegal Parameter&quot;.

So affect only 3.0-3.5.</pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 01:39:28 EDT
        </span>

      </div>




<pre class="bz_comment_text">CVE:

I would go for <a href="https://cwe.mitre.org/data/definitions/440.html">https://cwe.mitre.org/data/definitions/440.html</a>

In my opinion, the basic idea, that a resumption handshake doesn't require a HelloVerifyRequest because the reply flight is very small and inexpensive, isn't wrong.

But the check, if a resumption or the fallback to a full-handshake is used instead, was wrong. This weakness then caused the vulnerabilities:

- possible amplification (DDoS others)
- possible CPU exhausting (Dos affected server)

Any other opinions/proposals?</pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Kai Hudalla</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=kai.hudalla&#64;bosch.com" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 02:41:53 EDT
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Achim Kraus from <a href="show_bug.cgi?id=580018#c9">comment #9</a>)
<span class="quote">&gt; CVE:
&gt; 
&gt; I would go for <a href="https://cwe.mitre.org/data/definitions/440.html">https://cwe.mitre.org/data/definitions/440.html</a>
&gt; </span >
FMPOV <a href="https://cwe.mitre.org/data/definitions/408.html">https://cwe.mitre.org/data/definitions/408.html</a> would be a more specific fit.

<span class="quote">&gt; In my opinion, the basic idea, that a resumption handshake doesn't require a
&gt; HelloVerifyRequest because the reply flight is very small and inexpensive,
&gt; isn't wrong.</span >

I agree

<span class="quote">&gt; 
&gt; But the check, if a resumption or the fallback to a full-handshake is used
&gt; instead, was wrong. This weakness then caused the vulnerabilities:
&gt; 
&gt; - possible amplification (DDoS others)
&gt; - possible CPU exhausting (Dos affected server)
&gt; </span >

So, the proposed fix is to ALWAYS send the HelloVerifyRequest when falling back to a full handshake but act according to the value set in DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD otherwise, right? If that is the case then I also agree here :-)</pre>
    </div>

    <div id="c11" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 02:57:47 EDT
        </span>

      </div>




<pre class="bz_comment_text">I also read the 408, my understanding of it is:

1. &quot;do expensive processing&quot;
2. &quot;do the security check&quot;

With the bug would cause no &quot;security check&quot; (HelloVerifyRequest) at all.


<span class="quote">&gt; So, the proposed fix is to ALWAYS send the HelloVerifyRequest when falling back to a full handshake but act according to the value set in DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD otherwise, right?</span >

Yes, that's the proposed fix.

The tricky thing is, that it requires a callback API to implement it.
Therefore I introduced &quot;ExtendedResumptionVerifier&quot;. The background is, that if the &quot;session-store&quot; (former cache) is a &quot;remote implementation&quot;, the processing maybe very specific.

(Just to mention: because hono uses a cluster, I disables the session resumption in hono at all.)</pre>
    </div>

    <div id="c12" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Kai Hudalla</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=kai.hudalla&#64;bosch.com" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 03:38:24 EDT
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Achim Kraus from <a href="show_bug.cgi?id=580018#c11">comment #11</a>)
<span class="quote">&gt; I also read the 408, my understanding of it is:
&gt; 
&gt; 1. &quot;do expensive processing&quot;
&gt; 2. &quot;do the security check&quot;
&gt; 
&gt; With the bug would cause no &quot;security check&quot; (HelloVerifyRequest) at all.
&gt; </span >

&quot;The software allows an entity to perform a legitimate but expensive operation before authentication or authorization has taken place.&quot;

Isn't that exactly what is happening when falling back to a full handshake without sending the ClientVerifyRequest?</pre>
    </div>

    <div id="c13" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 04:01:49 EDT
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; &quot;The software allows an entity to perform a legitimate but expensive operation before authentication or authorization has taken place.&quot;</span >

<span class="quote">&gt; Isn't that exactly what is happening when falling back to a full handshake without sending the ClientVerifyRequest?</span >

Yes, if &quot;before&quot; also includes &quot;not to authenticate&quot;. 
&quot;Incorrect Behavior Order&quot; points for me to the order.

Right way:

1. check
2. process

Wrong way:

1. process
2. check

But the bug does:

1. process

(The check isn't done at all. Therefore the misbehavior is not based on the wrong order, its based on the missing check.)</pre>
    </div>

    <div id="c14" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Bernard</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=code&#64;simonbernard.eu" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 04:32:12 EDT
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; About Californium 2.7:</span >

<span class="quote">&gt; A ClientHello, which causes in 3.0 a fallback to a full handshake, causes with &gt; the 2.7 an Alert &quot;Illegal Parameter&quot;.</span >

<span class="quote">&gt; So affect only 3.0-3.5.</span >


This doesn't really respect the RFC as it should fallback to fullhandshake, right ? 

Does it impact opened connection/session attached to this Session ID ?</pre>
    </div>

    <div id="c15" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Bernard</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=code&#64;simonbernard.eu" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 04:40:07 EDT
        </span>

      </div>




<pre class="bz_comment_text">My 2 cts, I also think that <a href="https://cwe.mitre.org/data/definitions/408.html">https://cwe.mitre.org/data/definitions/408.html</a> fit better but maybe I don't understand the issue enough.


About : 

<span class="quote">&gt; But the bug does:
&gt; 1. process</span >


Could we consider that the check after &quot;process&quot; could be the fullhandshake itself ?


By the way, 408 seems to match better for Technical Impacts too. 

440 Impact: Quality Degradation; Varies by Context

408 Impacts : DoS: Amplification; DoS: Crash, Exit, or Restart; DoS: Resource Consumption (CPU); DoS: Resource Consumption (Memory)</pre>
    </div>

    <div id="c16" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 05:16:35 EDT
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; This doesn't really respect the RFC as it should fallback to fullhandshake, right ?</span >

At least I didn't found something in RFC 5246, except the MUST in

<span class="quote">&gt; If the
&gt; session_id field is not empty (implying a session resumption
&gt; request), this vector MUST include at least the cipher_suite from
&gt; that session.</span >

But that doesn't say &quot;fallback&quot; nor &quot;fail&quot;.

Only RFC 6066 states for SNI 

<span class="quote">&gt; A server that implements this extension MUST NOT accept the request
&gt; to resume the session if the server_name extension contains a
&gt; different name.  Instead, it proceeds with a full handshake to
&gt; establish a new session.</span >

therefore I changed the behavior in 3.0.</pre>
    </div>

    <div id="c17" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 05:22:24 EDT
        </span>

      </div>




<pre class="bz_comment_text">About CWE 408:

I was a little fixed at &quot;server hello, certificate&quot; and &quot;hello verify request&quot;. But if I change to:

- check for full handshake
- use either &quot;hello verify request&quot; 
- or &quot;server hello, certificate&quot;

[- (over simplified, ineffective) check for &quot;hello verify request&quot;]

- use either &quot;hello verify request&quot; 
- check for full handshake
- &quot;server hello, certificate&quot; or &quot;server hello, server hello done&quot;

Then I guess we can also go for 408.</pre>
    </div>

    <div id="c18" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Bernard</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=code&#64;simonbernard.eu" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 05:33:12 EDT
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; At least I didn't found something in RFC 5246</span >

I was thinking this part of the spec about : 

<span class="quote">&gt; If a Session ID match is not
&gt;    found, the server generates a new session ID, and the TLS client and
&gt;   server perform a full handshake.</span >

(<a href="https://www.rfc-editor.org/rfc/rfc5246#section-7.3">https://www.rfc-editor.org/rfc/rfc5246#section-7.3</a>)</pre>
    </div>

    <div id="c19" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 05:40:54 EDT
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; If a Session ID match is not found</span >

So that depends on how to interpret &quot;Session ID match&quot;. Only the ID? Or also the other parameter? Anyway, though it's a MUST, a violation is always &quot;out of spec&quot;. So I don't think, it pays of that much, to change that behavior for 2.7.</pre>
    </div>

    <div id="c20" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Bernard</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=code&#64;simonbernard.eu" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 06:05:26 EDT
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; So that depends on how to interpret &quot;Session ID match&quot;. Only the ID? Or also the other parameter? </span >

For me, it's pretty clear &quot;Session ID&quot; means &quot;Session ID&quot;


<span class="quote">&gt;  Anyway, though it's a MUST, a violation is always &quot;out of spec&quot;.</span >

I don't get your point. &quot;How a violation is handled&quot; can be part of a spec.

Anyway here this is not a violation, this is just a possible common use case OR I totally missed something.
The client tries to resume a session, it send a session ID it want to resume. If server lost the session (for any reason, restart, session lifetime) the handshake turn in full handshak.


If I understand you correctly the behavior in 2.7 is to send an Alert instead of fallback on fullhandshake, correct ?


(You didn't answer about : &quot;Does it impact opened connection/session attached to this Session ID ?&quot; don't know if it's on purpose or just oversight)</pre>
    </div>

    <div id="c21" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 06:17:16 EDT
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; I don't get your point. &quot;How a violation is handled&quot; can be part of a spec.</span >

Sure, but, as I wrote, I miss that part explaining, what to do, if the &quot;MUST&quot; in
 
<span class="quote">&gt; If the
&gt; session_id field is not empty (implying a session resumption
&gt; request), this vector MUST include at least the cipher_suite from
&gt; that session.</span >

fails.

Basically, this reported bug does exactly this, it doesn't include the cipher_suite and so breaks the MUST.</pre>
    </div>

    <div id="c22" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 06:21:07 EDT
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; Anyway here this is not a violation, this is just a possible common use case OR I totally missed something.
&gt; The client tries to resume a session, it send a session ID it want to resume. If server lost the session (for any reason, restart, session lifetime) the handshake turn in full handshak.</span >

No, only in the cases, where the cipher_suite or compression_method doesn't comply to MUST. In the &quot;common case&quot;, where the session for the session ID is missing, the 2.7 falls back to the full-handshake. (You may verify that on your own and there are some unit tests to ensure that.)</pre>
    </div>

    <div id="c23" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 06:23:50 EDT
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; (You didn't answer about : &quot;Does it impact opened connection/session attached to this Session ID ?&quot; don't know if it's on purpose or just oversight)</span >

Oversight.

If there is an other session on that &quot;unverified address resuming address&quot;, scandium uses a &quot;HelloVerifyRequest&quot;.</pre>
    </div>

    <div id="c24" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 07:28:17 EDT
        </span>

      </div>




<pre class="bz_comment_text">2.7:

I think, if that attack uses a SNI change, the attack will work as well with a 2.7. ;-(.

Unfortunately, there is much more to do for 3.6 (and tinydtls), so I guess, the fix for 2.7 must wait until end of July.</pre>
    </div>

    <div id="c25" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Bernard</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=code&#64;simonbernard.eu" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-07 08:28:47 EDT
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; Basically, this reported bug does exactly this, it doesn't include the cipher_suite and so breaks the MUST.</span >

OK I missed this part about different cipher_suite.

And so I understand now why you say RFC doesn't define the behavior.

I guess in that case an ALERT could be OK.</pre>
    </div>

    <div id="c26" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-11 06:18:19 EDT
        </span>

      </div>




<pre class="bz_comment_text">Project name: Eclipse Californium

Versions affected: [2.0.0, 2.7.2] and [3.0.0, 3.5.0]

Common Weakness Enumeration:

- CWE-408: Incorrect Behavior Order: Early Amplification

Summary:

In Eclipse Californium version 2.0.0 to 2.7.2 and 3.0.0-3.5.0 a resumption handshake falls back to a full handshake on a parameter mismatch without using a HelloVerifyRequest. Especially, if used with certificated based cipher suites, that results in message amplification (DDoS other peers) and high CPU load (DoS peer).

Links:

- <a href="https://bugs.eclipse.org/580018">https://bugs.eclipse.org/580018</a></pre>
    </div>

    <div id="c27" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-11 06:20:51 EDT
        </span>

      </div>




<pre class="bz_comment_text">&#64;Simon
&#64;Kai

please check, if that description is OK for you.

For 3.6.0 the PR with the fix is already merged to main.
For 2.7.x the PR #2041 is pending.

If no objection or other preferred schedules, I would like to release

2.7.3 on Wednesday 13. July
3.6.0 on Thursday  14. July</pre>
    </div>

    <div id="c28" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Kai Hudalla</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=kai.hudalla&#64;bosch.com" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-11 06:51:34 EDT
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Achim Kraus from <a href="show_bug.cgi?id=580018#c26">comment #26</a>)
<span class="quote">&gt; Project name: Eclipse Californium
&gt; 
&gt; Versions affected: [2.0.0, 2.7.2] and [3.0.0, 3.5.0]
&gt; 
&gt; Common Weakness Enumeration:
&gt; 
&gt; - CWE-408: Incorrect Behavior Order: Early Amplification
&gt; 
&gt; Summary:
&gt; 
&gt; In Eclipse Californium version 2.0.0 to 2.7.2 and 3.0.0-3.5.0 a resumption
&gt; handshake falls back to a full handshake on a parameter mismatch without
&gt; using a HelloVerifyRequest. Especially, if used with certificated based
&gt; cipher suites, that results in message amplification (DDoS other peers) and
&gt; high CPU load (DoS peer).
&gt; 
&gt; Links:
&gt; 
&gt; - <a href="https://bugs.eclipse.org/580018">https://bugs.eclipse.org/580018</a></span >

Just a small typo

<span class="quote">&gt; Especially, if used with certificate based ...</span ></pre>
    </div>

    <div id="c29" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c29">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Kai Hudalla</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=kai.hudalla&#64;bosch.com" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-11 06:52:02 EDT
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Achim Kraus from <a href="show_bug.cgi?id=580018#c27">comment #27</a>)
<span class="quote">&gt; &#64;Simon
&gt; &#64;Kai
&gt; 
&gt; please check, if that description is OK for you.
&gt; 
&gt; For 3.6.0 the PR with the fix is already merged to main.
&gt; For 2.7.x the PR #2041 is pending.
&gt; 
&gt; If no objection or other preferred schedules, I would like to release
&gt; 
&gt; 2.7.3 on Wednesday 13. July
&gt; 3.6.0 on Thursday  14. July</span >

Sounds good to me. Thanks for handling this vulnerability, Achim :-)</pre>
    </div>

    <div id="c30" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Bernard</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=code&#64;simonbernard.eu" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-11 08:50:36 EDT
        </span>

      </div>




<pre class="bz_comment_text">LGTM, Except maybe : 

I understand that this security issue only concerns users who are using DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD &gt; 0.

If you think this is still true, I think this could be a good addition to say something about this. (just to let user know if there are concerned and also that they can use this workaround instead of upgrade)</pre>
    </div>

    <div id="c31" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-11 08:56:34 EDT
        </span>

      </div>




<pre class="bz_comment_text">Project name: Eclipse Californium

Versions affected: [2.0.0, 2.7.2] and [3.0.0, 3.5.0]

Common Weakness Enumeration:

- CWE-408: Incorrect Behavior Order: Early Amplification

Summary:

In Eclipse Californium version 2.0.0 to 2.7.2 and 3.0.0-3.5.0 a DTLS resumption handshake falls back to a DTLS full handshake on a parameter mismatch without using a HelloVerifyRequest. Especially, if used with certificate based cipher suites, that results in message amplification (DDoS other peers) and high CPU load (DoS own peer). The misbehavior occurs only with DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD values larger than 0.  

Links:

- <a href="https://bugs.eclipse.org/580018">https://bugs.eclipse.org/580018</a></pre>
    </div>

    <div id="c32" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c32">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Bernard</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=code&#64;simonbernard.eu" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-11 09:04:50 EDT
        </span>

      </div>




<pre class="bz_comment_text">LGTM</pre>
    </div>

    <div id="c33" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c33">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-14 08:04:05 EDT
        </span>

      </div>




<pre class="bz_comment_text">The fix is now successfully released with 2.7.3 and 3.6.0.

&#64;Simon

Do you plan to provide Leshan releases as well?
If not, then I would ask Wayne (or Mikael) to publish the CVE next week.</pre>
    </div>

    <div id="c34" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c34">Comment 34</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Bernard</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=code&#64;simonbernard.eu" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-18 05:42:07 EDT
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; Do you plan to provide Leshan releases as well?</span >

I don't know yet because there is nothing to release for Leshan 1.x except update the californium dependency.

I'm still a bit frustrated with the way maven handle version dependency because I feel this is not so clean to have strict defined version dependency for a library...

I remember when I was coding eclipse plugins, the way dependencies was managed was really cleaner. You can say &quot;my plugin depends on given plugin v1.2 or later&quot; so you depends to a version of API and bug fix release is handle by each project.



<span class="quote">&gt; If not, then I would ask Wayne (or Mikael) to publish the CVE next week.</span >

Yes please do it, don't wait for us.</pre>
    </div>

    <div id="c35" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c35">Comment 35</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Kai Hudalla</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=kai.hudalla&#64;bosch.com" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-18 07:37:21 EDT
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Simon Bernard from <a href="show_bug.cgi?id=580018#c34">comment #34</a>)
<span class="quote">&gt; 
&gt; I'm still a bit frustrated with the way maven handle version dependency
&gt; because I feel this is not so clean to have strict defined version
&gt; dependency for a library...
&gt; 
&gt; I remember when I was coding eclipse plugins, the way dependencies was
&gt; managed was really cleaner. You can say &quot;my plugin depends on given plugin
&gt; v1.2 or later&quot; so you depends to a version of API and bug fix release is
&gt; handle by each project.
&gt; </span >

you should be able to do that with Maven as well if I am not mistaken:

<a href="https://books.sonatype.com/mvnref-book/reference/pom-relationships-sect-project-dependencies.html#pom-relationships-sect-version-ranges">https://books.sonatype.com/mvnref-book/reference/pom-relationships-sect-project-dependencies.html#pom-relationships-sect-version-ranges</a></pre>
    </div>

    <div id="c36" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c36">Comment 36</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Bernard</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=code&#64;simonbernard.eu" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-18 08:55:59 EDT
        </span>

      </div>




<pre class="bz_comment_text">&#64;Kai, Thx for sharing this. 🙏

I was aware about this but I had the vague memory that it was not advised or even deprecated to use it with Maven. (I don't remember why I thought this 🤦...)

Maybe I should give it a try.

Do you guys already use it ? any feedbacks ? (or maybe reason why you don't use it)</pre>
    </div>

    <div id="c37" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c37">Comment 37</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Kai Hudalla</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=kai.hudalla&#64;bosch.com" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-18 09:37:32 EDT
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Simon Bernard from <a href="show_bug.cgi?id=580018#c36">comment #36</a>)
<span class="quote">&gt; &#64;Kai, Thx for sharing this. 🙏</span >

<span class="quote">&gt; Maybe I should give it a try.
&gt; 
&gt; Do you guys already use it ? any feedbacks ? (or maybe reason why you don't
&gt; use it)</span >

I am currently not using this but for no particular reason. There is one thing that IMHO needs to be considered: not every third party dependency uses semantic versioning or if it claims to do so, actually implements the semantics correctly and reliably. So, in many cases you will need to test manually with every new (minor) version and if you need to do that anyway, specifying a version range for a dependency doesn't seem beneficial or appropriate at all.</pre>
    </div>

    <div id="c38" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c38">Comment 38</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-19 03:29:10 EDT
        </span>

      </div>




<pre class="bz_comment_text">&#64;Wayne
&#64;Mikael

from my side the team agreed on having a CVE created with:
-------------------------------------------
Project name: Eclipse Californium

Versions affected: [2.0.0, 2.7.2] and [3.0.0, 3.5.0]

Common Weakness Enumeration:

- CWE-408: Incorrect Behavior Order: Early Amplification

Summary:

In Eclipse Californium version 2.0.0 to 2.7.2 and 3.0.0-3.5.0 a DTLS resumption handshake falls back to a DTLS full handshake on a parameter mismatch without using a HelloVerifyRequest. Especially, if used with certificate based cipher suites, that results in message amplification (DDoS other peers) and high CPU load (DoS own peer). The misbehavior occurs only with DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD values larger than 0.  

Links:

- <a href="https://bugs.eclipse.org/580018">https://bugs.eclipse.org/580018</a>
-------------------------------------------

If nothing is missing, please create it.</pre>
    </div>

    <div id="c39" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c39">Comment 39</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Bernard</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=code&#64;simonbernard.eu" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-26 03:57:52 EDT
        </span>

      </div>




<pre class="bz_comment_text">I released : 
- leshan v1.4.1 with californium v2.7.3
- leshan v2.0.0-M8 with californium v3.6.0</pre>
    </div>

    <div id="c40" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c40">Comment 40</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mikaël Barbero</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=mikael.barbero&#64;eclipse-foundation.org" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-29 07:54:06 EDT
        </span>

      </div>




<pre class="bz_comment_text">I'm on it.</pre>
    </div>

    <div id="c41" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c41">Comment 41</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mikaël Barbero</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=mikael.barbero&#64;eclipse-foundation.org" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-29 08:39:29 EDT
        </span>

      </div>




<pre class="bz_comment_text">I've submitted <a href="https://github.com/CVEProject/cvelist/pull/6693">https://github.com/CVEProject/cvelist/pull/6693</a>, but it's not yet merged as my account is still under verification. I will keep you posted as soon as it's done.</pre>
    </div>

    <div id="c42" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c42">Comment 42</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Achim Kraus</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=achim.kraus&#64;cloudcoap.net" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-29 08:43:54 EDT
        </span>

      </div>




<pre class="bz_comment_text">Thanks for the update!</pre>
    </div>

    <div id="c43" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=580018#c43">Comment 43</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mikaël Barbero</span> <a href="https://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=mikael.barbero&#64;eclipse-foundation.org" alt="CLA" title="Eclipse Contributor Agreement" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-07-29 09:24:57 EDT
        </span>

      </div>




<pre class="bz_comment_text">CVE has been merged, you should be all set to socialize about CVE-2022-2576. It will appear soon at <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2576">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2576</a></pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=580018">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=580018">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=580018">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=580018&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=580018" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        placeholder="Login">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/termsofuse.php">Terms of Use</a></li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/copyright.php">Copyright Agent</a></li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>