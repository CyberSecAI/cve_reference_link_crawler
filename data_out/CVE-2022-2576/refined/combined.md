=== Content from books.sonatype.com_ced5eae8_20250108_150717.html ===


# [TheNEXUS](http://www.sonatype.org/nexus/ "TheNEXUS")

| [Central Status](http://central.sonatype.org/) |
| --- |
| [oss.Sonatype.org Status](http://status.sonatype.com/) |
| [Security Advisory Archives](http://www.sonatype.org/advisories)  [SECURITY ADVISORY 12/23/14](http://www.sonatype.org/advisories) Critical Security Advisory for Sonatype Nexus Users [Read More Â»](http://www.sonatype.org/advisories) |

[Must Read Articles](http://www.sonatype.org/nexus/article-archives-2/)

[DW Focus](http://www.sonatype.org/nexus/ "DW Focus")

* [Home](http://www.sonatype.org/nexus/)
* [Articles](http://www.sonatype.org/nexus/article-archives-2/ "An archive of all articles published on this site")
  + [In
    the Spotlight](http://www.sonatype.org/nexus/category/spotlight/)
  + [Guest
    Authors](http://www.sonatype.org/nexus/category/guest-authors/)
  + [Nexus Repository Manager/Lifecycle](http://www.sonatype.org/nexus/category/nexus-proclm/)
  + [Nexus
    and NuGet](http://www.sonatype.org/nexus/category/article-series/nexus-and-nuget/)
  + [Nexus Repository Manager OSS](http://www.sonatype.org/nexus/category/nexus-oss/)
  + [DevOps](http://www.sonatype.org/nexus/category/devops/)
  + [Engineering
    Team: Thoughts](http://www.sonatype.org/nexus/category/article-series/engineering-2/)
  + [OpEd](http://www.sonatype.org/nexus/category/oped/)
  + [The
    Q&A Corner](http://www.sonatype.org/nexus/category/qa/)
* [Support](http://www.sonatype.org/nexus/support/ "Need immediate help? Try one of these threeâ¦")
  + [Nexus
    on StackOverflow](http://stackoverflow.com/questions/tagged/nexus)
  + [Knowledge
    Base](https://support.sonatype.com/categories/20112427-Sonatype-Nexus)
  + [Nexus
    Issue Tracker](http://links.sonatype.com/products/nexus/oss/issues)
* [Resources](http://www.sonatype.org/nexus/resources/ "General resources available to the community")
  + [Books to Download](http://www.sonatype.org/nexus/resources/resources-book-links-and-downloads/)
  + [Lists
    and Other Resources](http://www.sonatype.org/nexus/lists-live-chat-and-other-resources/)
  + [The
    Nexus Repository Manager Deployment Guidelines](http://www.sonatype.org/nexus/downloads/the-nexus-professional-deployment-guidelines/)
  + [Continuous
    Delivery and DevOps: SlideShow Gallery](http://www.sonatype.org/nexus/continuous-delivery-and-devops-slideshow-gallery/)
  + [Repository
    Health Check](http://books.sonatype.com/nexus-book/reference/rhc.html)
  + [Application
    Health Check](http://www.sonatype.com/application-health-check)
* [Downloads](http://www.sonatype.org/nexus/downloads/ "Nexus  Repository Manager OSS, Nexus Repository Manager, and how to choose between them")
  + [Nexus Repository Manager OSS](http://www.sonatype.org/nexus/go)
  + [Nexus Repository Manager - Free Trial](http://www.sonatype.com/nexus/free-trial)
  + [How to Choose](http://www.sonatype.com/nexus/why-nexus/which-repo-is-right-for-me)
* [Documentation](http://www.sonatype.org/nexus/resources/resources-book-links-and-downloads/ "Documentation")
  + [Maven: The Complete Reference](http://books.sonatype.com/mvnref-book/reference/index.html)
  + [Maven by Example](http://books.sonatype.com/mvnex-book/reference/index.html)
  + [Repository Management with Nexus](http://books.sonatype.com/nexus-book/index.html)
  + [Nexus IQ Server Documentation](http://books.sonatype.com/sonatype-clm-book/html/index.html)
* [About
  Us](http://www.sonatype.org/nexus/about-us/ "Who we are, how to contribute, contact us")
* [Members
  Only](http://www.sonatype.org/nexus/members-only/ "Exclusive resources for community members")
  + [About
    the Community](http://www.sonatype.org/nexus/members-only/ "What are the advantages of being a member of the community?")
  + [Member
    Entrance](http://www.sonatype.org/nexus/members-only/member-entrance/)
  + [Video
    Gallery](http://www.sonatype.org/nexus/members-only/video-gallery-2/)
  + [Free
    Training: Sonatype Nexus and CLM Tips from the
    Trenches](http://www.sonatype.org/nexus/members-only/video-gallery-2/free-training-sonatype-nexus-and-clm-tips-from-the-trenches/)
  + [Free
    Training: Nexus Professional and Smart Proxy](http://www.sonatype.org/nexus/members-only/video-gallery-2/free-training-nexus-professional-and-smart-proxy/)
  + [Free
    Training: Empowering Releases with the Nexus
    Staging Suite](http://www.sonatype.org/nexus/members-only/video-gallery-2/free-training/)
  + [The
    Nexus 2 Minute Challenge](http://www.sonatype.org/nexus/members-only/video-gallery-2/2-minute-nexus-challenge/)

| Maven: The Complete Reference |
|  |
| * [Prev : 3.3.Â POM Syntax](pom-relationships-sect-pom-syntax.html) * [TOC](index.html) * [Next : 3.5.Â Project Relationships](pom-relationships-sect-project-relationships.html)  3.4.Â Project Dependencies   Maven can manage both internal and external dependencies. An external dependency for a Java project might be a library such as Plexus, the Spring Framework, or Log4J. An internal dependency is illustrated by a web application project depending on another project that contains service classes, model objects, or persistence logic. [Project Dependencies](pom-relationships-sect-project-dependencies.html#ex-dependency "Project Dependencies") shows some examples of project dependencies.  **Project Dependencies.Â**  ``` <project>     ...     <dependencies>         <dependency>             <groupId>org.codehaus.xfire</groupId>             <artifactId>xfire-java5</artifactId>             <version>1.2.5</version>         </dependency>         <dependency>             <groupId>junit</groupId>             <artifactId>junit</artifactId>             <version>3.8.1</version>             <scope>test</scope>         </dependency>         <dependency>             <groupId>javax.servlet</groupId>             <artifactId>servlet-api</artifactId>             <version>2.4</version>             <scope>provided</scope>         </dependency>     </dependencies>     ... </project> ```    The first dependency is a compile dependency on the XFire SOAP library from Codehaus. You would use this type of dependency if your project depended on this library for compilation, testing, and during execution. The second dependency is a `test`-scoped dependency on JUnit. You would use a `test`-scoped dependency when you need to reference this library only during testing. The last dependency in [Project Dependencies](pom-relationships-sect-project-dependencies.html#ex-dependency "Project Dependencies") is a dependency on the Servlet 2.4 API. The last dependency is scoped as a provided dependency. You would use a provided scope when the application you are developing needs a library for compilation and testing, but this library is supplied by a container at runtime.  3.4.1.Â Dependency Scope   [Project Dependencies](pom-relationships-sect-project-dependencies.html#ex-dependency "Project Dependencies") briefly introduced three of the five dependency scopes: `compile`, `test`, and `provided`. Scope controls which dependencies are available in which classpath, and which dependencies are included with an application. Letâs explore each scope in detail:  compile   `compile` is the default scope; all dependencies are `compile`-scoped if a scope is not supplied. `compile` dependencies are available in all classpaths, and they are packaged.  provided   `provided` dependencies are used when you expect the JDK or a container to provide them. For example, if you were developing a web application, you would need the Servlet API available on the compile classpath to compile a servlet, but you wouldnât want to include the Servlet API in the packaged WAR; the Servlet API JAR is supplied by your application server or servlet container. `provided` dependencies are available on the compilation classpath (not runtime). They are not transitive, nor are they packaged.  runtime   `runtime` dependencies are required to execute and test the system, but they are not required for compilation. For example, you may need a JDBC API JAR at compile time and the JDBC driver implementation only at runtime.  test   `test`-scoped dependencies are not required during the normal operation of an application, and they are available only during test compilation and execution phases.  system   The `system` scope is similar to `provided` except that you have to provide an explicit path to the JAR on the local file system. This is intended to allow compilation against native objects that may be part of the system libraries. The artifact is assumed to always be available and is not looked up in a repository. If you declare the scope to be `system`, you must also provide the `systemPath` element. Note that this scope is not recommended (you should always try to reference dependencies in a public or custom Maven repository).     3.4.2.Â Optional Dependencies   Assume that you are working on a library that provides caching behavior. Instead of writing a caching system from scratch, you want to use some of the existing libraries that provide caching on the file system and distributed caches. Also assume that you want to give the end user an option to cache on the file system or to use an in-memory distributed cache. To cache on the file system, youâll want to use a freely available library called EHCache (<http://ehcache.sourceforge.net/>), and to cache in a distributed in-memory cache, you want to use another freely available caching library named SwarmCache ( <http://swarmcache.sourceforge.net/> ). Youâll code an interface and create a library that can be configured to use either EHCache or SwarmCache, but you want to avoid adding a dependency on both caching libraries to any project that depends on your library.  In other words, you need both libraries to compile this library project, but you donât want both libraries to show up as transitive runtime dependencies for the project that uses your library. You can accomplish this by using optional dependencies as shown in [Declaring Optional Dependencies](pom-relationships-sect-project-dependencies.html#ex-optional-depend "Declaring Optional Dependencies").  **Declaring Optional Dependencies.Â**  ``` <project>     <modelVersion>4.0.0</modelVersion>     <groupId>org.sonatype.mavenbook</groupId>     <artifactId>my-project</artifactId>     <version>1.0.0</version>     <dependencies>         <dependency>             <groupId>net.sf.ehcache</groupId>             <artifactId>ehcache</artifactId>             <version>1.4.1</version>             <optional>true</optional>         </dependency>         <dependency>             <groupId>swarmcache</groupId>             <artifactId>swarmcache</artifactId>             <version>1.0RC2</version>             <optional>true</optional>         </dependency>         <dependency>             <groupId>log4j</groupId>             <artifactId>log4j</artifactId>             <version>1.2.13</version>         </dependency>     </dependencies> </project> ```    Since youâve declared these dependencies as optional in `my-project`, if youâve defined a project that depends on `my-project` which needs those dependencies, youâll have to include them explicitly in the project that depends on `my-project`. For example, if you were writing an application which depended on `my-project` and wanted to use the EHCache implementation, you would need to add the following `dependency` element to your project.  ``` <project>     <modelVersion>4.0.0</modelVersion>     <groupId>org.sonatype.mavenbook</groupId>     <artifactId>my-application</artifactId>     <version>1.0.0</version>     <dependencies>         <dependency>             <groupId>org.sonatype.mavenbook</groupId>             <artifactId>my-project</artifactId>             <version>1.0.0</version>         </dependency>         <dependency>             <groupId>net.sf.ehcache</groupId>             <artifactId>ehcache</artifactId>             <version>1.4.1</version>         </dependency>     </dependencies> </project> ```  In an ideal world, you wouldnât have to use optional dependencies. Instead of having one large project with a series of optional dependencies, you would separate the EHCache-specific code to a `my-project-ehcache` submodule and the SwarmCache-specific code to a `my-project-swarmcache` submodule. This way, instead of requiring projects that reference `my-project` to specifically add a dependency, projects can just reference a particular implementation project and benefit from the transitive dependency.  3.4.3.Â Dependency Version Ranges   Instead of a specific version for each dependency, you can alternatively specify a range of versions that would satisfy a given dependency. For example, you can specify that your project depends on version 3.8 or greater of JUnit, or anything between versions 4.5 and 4.10 of JUnit. You do this by surrounding one or more version numbers with the following characters:  (, )   Exclusive quantifiers  [, ]   Inclusive quantifiers    For example, if you wished to access any `JUnit` version greater than or equal to 3.8 but less than 4.0, your dependency would be as shown in [Specifying a Dependency Range: JUnit 3.8 - JUnit 4.0](pom-relationships-sect-project-dependencies.html#ex-dep-range "Specifying a Dependency Range: JUnit 3.8 - JUnit 4.0").  **Specifying a Dependency Range: JUnit 3.8 - JUnit 4.0.Â**  ``` <dependency>     <groupId>junit</groupId>     <artifactId>junit</artifactId>     <version>[3.8,4.0)</version>     <scope>test</scope> </dependency> ```    If you want to depend on any version of JUnit no higher than 3.8.1, you would specify only an upper inclusive boundary, as shown in [Specifying a Dependency Range: JUnit â 3.8.1](pom-relationships-sect-project-dependencies.html#ex-dep-range-2 "Specifying a Dependency Range: JUnit â 3.8.1").  **Specifying a Dependency Range: JUnit â 3.8.1.Â**  ``` <dependency>     <groupId>junit</groupId>     <artifactId>junit</artifactId>     <version>[,3.8.1]</version>     <scope>test</scope> </dependency> ```    A version before or after the comma is not required, and means +/- infinity. For example, "[4.0,)" means any version greater than or equal to 4.0. "(,2.0)" is any version less than 2.0. "[1.2]" means only version 1.2, and nothing else. Note When declaring a "normal" version such as 3.8.2 for Junit, internally this is represented as "allow anything, but prefer 3.8.2." This means that when a conflict is detected, Maven is allowed to use the conflict algorithms to choose the best version. If you specify [3.8.2], it means that only 3.8.2 will be used and nothing else. If somewhere else there is a dependency that specifies [3.8.1], you would get a build failure telling you of the conflict. We point this out to make you aware of the option, but use it sparingly and only when really needed. The preferred way to resolve this is via `dependencyManagement`.   3.4.4.Â Transitive Dependencies   `project-a` depends on `project-b`, which in turn depends on `project-c`, then `project-c` is considered a transitive dependency of `project-a`. If `project-c` depended on `project-d`, then `project-d` would also be considered a transitive dependency of `project-a`. Part of Mavenâs appeal is that it can manage transitive dependencies and shield the developer from having to keep track of all of the dependencies required to compile and run an application. You can just depend on something like the Spring Framework and not have to worry about tracking down every last dependency of the Spring Framework.  Maven accomplishes this by building a graph of dependencies and dealing with any conflicts and overlaps that might occur. For example, if Maven sees that two projects depend on the same `groupId` and `artifactId`, it will sort out which dependency to use automatically, always favoring the more recent version of a dependency. Although this sounds convenient, there are some edge cases where transitive dependencies can cause some configuration issues. For these scenarios, you can use a dependency exclusion.  Transitive Dependencies and Scope   Each of the scopes outlined earlier in the section [SectionÂ 3.4.1, âDependency Scopeâ](pom-relationships-sect-project-dependencies.html#pom-relationships-sect-dependency-scope "3.4.1.Â Dependency Scope") affects not just the scope of the dependency in the declaring project, but also how it acts as a transitive dependency. The easiest way to convey this information is through a table, as in [TableÂ 3.1, âHow Scope Affects Transitive Dependenciesâ](pom-relationships-sect-project-dependencies.html#table-transitive-dep-and-scope "TableÂ 3.1.Â How Scope Affects Transitive Dependencies"). Scopes in the top row represent the scope of a transitive dependency. Scopes in the leftmost column represent the scope of a direct dependency. The intersection of the row and column is the scope that is assigned to a transitive dependency. A blank cell in this table means that the transitive dependency will be omitted.   **TableÂ 3.1.Â How Scope Affects Transitive Dependencies**         | Direct Scope | vs. Transitive Scope | | | | | --- | --- | --- | --- | --- | |  | compile | provided | runtime | test | | compile | compile | - | runtime | - | | provided | provided | - | provided | - | | runtime | runtime | - | runtime | - | | test | test | - | test | - |      3.4.5.Â Conflict Resolution   There will be times when you need to exclude a transitive dependency, such as when you are depending on a project that depends on another project, but you would like to either exclude the dependency altogether or replace the transitive dependency with another dependency that provides the same functionality. [Excluding a Transitive Dependency](pom-relationships-sect-project-dependencies.html#ex-exclude "Excluding a Transitive Dependency") shows an example of a dependency element that adds a dependency on `project-a`, but excludes the transitive dependency `project-b`.  **Excluding a Transitive Dependency.Â**  ``` <dependency>     <groupId>org.sonatype.mavenbook</groupId>     <artifactId>project-a</artifactId>     <version>1.0</version>     <exclusions>         <exclusion>             <groupId>org.sonatype.mavenbook</groupId>             <artifactId>project-b</artifactId>         </exclusion>     </exclusions> </dependency> ```    Often, you will want to replace a transitive dependency with another implementation. For example, if you are depending on a library that depends on the Sun JTA API, you may want to replace the declared transitive dependency. Hibernate is one example. Hibernate depends on the Sun JTA API JAR, which is not available in the central Maven repository because it cannot be freely redistributed. Fortunately, the Apache Geronimo project has created an independent implementation of this library that can be freely redistributed. To replace a transitive dependency with another dependency, you would exclude the transitive dependency and declare a dependency on the project you wanted instead. [Excluding and Replacing a Transitive Dependency](pom-relationships-sect-project-dependencies.html#ex-exclude-replace "Excluding and Replacing a Transitive Dependency") shows an example of a such replacement.  **Excluding and Replacing a Transitive Dependency.Â**  ``` <dependencies>     <dependency>         <groupId>org.hibernate</groupId>         <artifactId>hibernate</artifactId>         <version>3.2.5.ga</version>         <exclusions>             <exclusion>                 <groupId>javax.transaction</groupId>                 <artifactId>jta</artifactId>             </exclusion>         </exclusions>     </dependency>     <dependency>         <groupId>org.apache.geronimo.specs</groupId>         <artifactId>geronimo-jta_1.1_spec</artifactId>         <version>1.1</version>     </dependency> </dependencies> ```    In [Excluding and Replacing a Transitive Dependency](pom-relationships-sect-project-dependencies.html#ex-exclude-replace "Excluding and Replacing a Transitive Dependency"), there is nothing marking the dependency on geronimo-jta\_1.1\_spec as a replacement, it just happens to be a library which provides the same API as the original JTA dependency. Here are some other reasons you might want to exclude or replace transitive dependencies:   1. The `groupId` or `artifactId` of the artifact has changed, where the    current project requires an alternately named version from a    dependencyâs version - resulting in 2 copies of the same project in    the classpath. Normally Maven would capture this conflict and use a    single version of the project, but when `groupId` or `artifactId`    are different, Maven will consider this to be two different    libraries. 2. An artifact is not used in your project and the transitive    dependency has not been marked as an optional dependency. In this    case, you might want to exclude a dependency because it isnât    something your system needs and you are trying to cut down on the    number of libraries distributed with an application. 3. An artifact which is provided by your runtime container thus should    not be included with your build. An example of this is if a    dependency depends on something like the Servlet API and you want to    make sure that the dependency is not included in a web applicationâs    *WEB-INF/lib* directory. 4. To exclude a dependency which might be an API with multiple    implementations. This is the situation illustrated by    [Excluding and Replacing a Transitive Dependency](pom-relationships-sect-project-dependencies.html#ex-exclude-replace "Excluding and Replacing a Transitive Dependency"); there is a Sun API which requires click-wrap    licensing and a time-consuming manual install into a custom    repository (Sunâs JTA JAR) versus a freely distributed version of    the same API available in the central Maven repository (Geronimoâs    JTA implementation).  ====    Dependency Management  Once youâve adopted Maven at your super complex enterprise and you have two hundred and twenty inter-related Maven projects, you are going to start wondering if there is a better way to get a handle on dependency versions. If every single project that uses a dependency like the MySQL Java connector needs to independently list the version number of the dependency, you are going to run into problems when you need to upgrade to a new version. Because the version numbers are distributed throughout your project tree, you are going to have to manually edit each of the *pom.xml* files that reference a dependency to make sure that you are changing the version number everywhere. Even with `find`, `xargs`, and `awk`, you are still running the risk of missing a single POM.  Luckily, Maven provides a way for you to consolidate dependency version numbers in the `dependencyManagement` element. Youâll usually see the `dependencyManagement` element in a top-level parent POM for an organization or project. Using the `dependencyManagement` element in a *pom.xml* allows you to reference a dependency in a child project without having to explicitly list the version. Maven will walk up the parent-child hierarchy until it finds a project with a `dependencyManagement` element, it will then use the version specified in this `dependencyManagement` element.  For example, if you have a large set of projects which make use of the MySQL Java connector version 5.1.2, you could define the following `dependencyManagement` element in your multi-module projectâs top-level POM.  **Defining Dependency Versions in a Top-level POM.Â**  ``` <project>     <modelVersion>4.0.0</modelVersion>     <groupId>org.sonatype.mavenbook</groupId>     <artifactId>a-parent</artifactId>     <version>1.0.0</version>     ...     <dependencyManagement>         <dependencies>             <dependency>                 <groupId>mysql</groupId>                 <artifactId>mysql-connector-java</artifactId>                 <version>5.1.2</version>                 <scope>runtime</scope>             </dependency>             ...             <dependencies>     </dependencyManagement> ```    Then, in a child project, you can add a dependency to the MySQL Java Connector using the following dependency XML:  ``` <project>     <modelVersion>4.0.0</modelVersion>     <parent>         <groupId>org.sonatype.mavenbook</groupId>         <artifactId>a-parent</artifactId>         <version>1.0.0</version>     </parent>     <artifactId>project-a</artifactId>     ...     <dependencies>         <dependency>             <groupId>mysql</groupId>             <artifactId>mysql-connector-java</artifactId>         </dependency>     </dependencies> </project> ```  You should notice that the child project did not have to explicitly list the version of the `mysql-connector-java` dependency. Because this dependency was defined in the top-level POMâs dependencyManagement element, the version number is going to propagate to the child projectâs dependency on `mysql-connector-java`. Note that if this child project did define a version, it would override the version listed in the top-level POMâs `dependencyManagement` section. That is, the `dependencyManagement` version is only used when the child does not declare a version directly.  Dependency management in a top-level POM is different from just defining a dependency on a widely shared parent POM. For starters, all dependencies are inherited. If `mysql-connector-java` were listed as a dependency of the top-level parent project, every single project in the hierarchy would have a reference to this dependency. Instead of adding in unnecessary dependencies, using `dependencyManagement` allows you to consolidate and centralize the management of dependency versions without adding dependencies which are inherited by all children. In other words, the `dependencyManagement` element is equivalent to an environment variable which allows you to declare a dependency anywhere below a project without specifying a version number.   * [Prev : 3.3.Â POM Syntax](pom-relationships-sect-pom-syntax.html) * [TOC](index.html) * [Next : 3.5.Â Project Relationships](pom-relationships-sect-project-relationships.html) |

|  |  |
| --- | --- |

|  |  | Become a Member       Are you a current user of: Nexus Repository Manager OSSNexus Repository ManagerNeither |
| --- | --- | --- |

|  |
| --- |
| 4817 MEMBERS & GROWING |
|  |

| Downloads |
| --- |

|  |
| --- |
|  |
|  |
| Try Nexus Pro |
|  |
|  |
|  |
|  |

* TheNEXUS

Site index

### Quick Links

| **[Home](http://www.sonatype.org/nexus)** |
| --- |
| **[Articles Archive](http://www.sonatype.org/nexus/article-archives-2/)** |
| **[Members Only](http://www.sonatype.org/nexus/members-only/)** |
|  |
| **Support** |
| > [Nexus on Stack Overflow](http://stackoverflow.com/questions/tagged/nexus) |
| > [Knowledge Base](https://support.sonatype.com/categories/20112427-Sonatype-Nexus) |
| > [Nexus Bug Tracker](https://issues.sonatype.org/browse/NEXUS) |
|  |
| **Mailing List** |
| > [Nexus User List Archive](https://groups.google.com/a/glists.sonatype.com/forum/?hl=en#%21forum/nexus-users) (Subscribe) |

### Resources

| **Downloads** |
| --- |
| > [Books (Download or Read Online)](http://www.sonatype.org/nexus/resources/resources-book-links-and-downloads/) |
| > [Nexus Repository Manager OSS](http://www.sonatype.org/nexus/go) |
| > [Nexus Repository Manager](http://www.sonatype.com/nexus/free-trial) |
| > [How to Choose](http://www.sonatype.com/nexus/why-nexus/which-repo-is-right-for-me) |
|  |
| **Tools** |
| > [Application Health Check](http://www.sonatype.com/application-health-check) |
| > [Repository Health Check](http://www.sonatype.com/nexus/whats-in-your-repo/whats-in-your-repo) |
|  |
| **Community Interest** |
| > [Event Calendar](http://www.sonatype.com/resources/events/) |
| > [Nexus Now Newsletter Archive](http://www.sonatype.com/resources/nexus-now-newsletter) |
| > [Documentation](http://www.sonatype.org/nexus/documentation/) |
| > [About Us](http://www-dev.sonatype.org/nexus/about-us/) |

### Topics

* [Article Series](http://www.sonatype.org/nexus/category/article-series/)
  + [Engineering Team: Thoughts](http://www.sonatype.org/nexus/category/article-series/engineering-2/)
    - [A View from the Inside](http://www.sonatype.org/nexus/category/article-series/engineering-2/a-view-from-the-inside/)
    - [How We Do It](http://www.sonatype.org/nexus/category/article-series/engineering-2/how-we-do-it/)
  + [HP. FoD and CLM](http://www.sonatype.org/nexus/category/article-series/hp-fod-clm/)
    - [FoD and Nexus](http://www.sonatype.org/nexus/category/article-series/hp-fod-clm/fod-and-nexus/)
    - [Mapping AppSec Incentives](http://www.sonatype.org/nexus/category/article-series/hp-fod-clm/mapping-appsec-incentives/)
  + [Nexus and NuGet](http://www.sonatype.org/nexus/category/article-series/nexus-and-nuget/)
* [Nexus Lifeycle](http://www.sonatype.org/nexus/category/clm/)
* [DevOps](http://www.sonatype.org/nexus/category/devops/)
* [Events and Webinars](http://www.sonatype.org/nexus/category/events-and-webinars/)
* [Extensions and Plugins](http://www.sonatype.org/nexus/category/plugins/)
* [Guest Authors](http://www.sonatype.org/nexus/category/guest-authors/)
* [In the Spotlight](http://www.sonatype.org/nexus/category/spotlight/)
* [Nexus Repository Manager OSS](http://www.sonatype.org/nexus/category/nexus-oss/)
  + [Minecraft](http://www.sonatype.org/nexus/category/nexus-oss/minecraft/)
  + [Tips from the Trenches](http://www.sonatype.org/nexus/category/nexus-oss/tips-from-the-trenches/)
* [Nexus Repository Manager/Nexus Lifecycle](http://www.sonatype.org/nexus/category/nexus-proclm/)
* [OpEd](http://www.sonatype.org/nexus/category/oped/)
* [OWASP](http://www.sonatype.org/nexus/category/owasp/)
* [Resource](http://www.sonatype.org/nexus/category/resource/)
* [The Q&A Corner](http://www.sonatype.org/nexus/category/qa/)
* [The Week in Review](http://www.sonatype.org/nexus/category/the-week-in-review/)
* [Video](http://www.sonatype.org/nexus/category/video/)

[![](images/Logo-Footer.jpg)](http://www.sonatype.org/nexus/)

[Top](#masthead "Scroll to top")

![](images/g.gif)


=== Content from github.com_6fd9ee8e_20250108_150716.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Fblob%2Fmain%2Fscandium-core%2Fsrc%2Fmain%2Fjava%2Forg%2Feclipse%2Fcalifornium%2Fscandium%2Fconfig%2FDtlsConfig.java)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Fblob%2Fmain%2Fscandium-core%2Fsrc%2Fmain%2Fjava%2Forg%2Feclipse%2Fcalifornium%2Fscandium%2Fconfig%2FDtlsConfig.java)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=eclipse-californium%2Fcalifornium)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eclipse-californium](/eclipse-californium)
/
**[californium](/eclipse-californium/californium)**
Public

* [Notifications](/login?return_to=%2Feclipse-californium%2Fcalifornium) You must be signed in to change notification settings
* [Fork
  368](/login?return_to=%2Feclipse-californium%2Fcalifornium)
* [Star
   731](/login?return_to=%2Feclipse-californium%2Fcalifornium)

* [Code](/eclipse-californium/californium)
* [Issues
  16](/eclipse-californium/californium/issues)
* [Pull requests
  0](/eclipse-californium/californium/pulls)
* [Actions](/eclipse-californium/californium/actions)
* [Projects
  0](/eclipse-californium/californium/projects)
* [Wiki](/eclipse-californium/californium/wiki)
* [Security](/eclipse-californium/californium/security)
* [Insights](/eclipse-californium/californium/pulse)

Additional navigation options

* [Code](/eclipse-californium/californium)
* [Issues](/eclipse-californium/californium/issues)
* [Pull requests](/eclipse-californium/californium/pulls)
* [Actions](/eclipse-californium/californium/actions)
* [Projects](/eclipse-californium/californium/projects)
* [Wiki](/eclipse-californium/californium/wiki)
* [Security](/eclipse-californium/californium/security)
* [Insights](/eclipse-californium/californium/pulse)

## Files

 main
## Breadcrumbs

1. [californium](/eclipse-californium/californium/tree/main)
2. /[scandium-core](/eclipse-californium/californium/tree/main/scandium-core)
3. /[src](/eclipse-californium/californium/tree/main/scandium-core/src)
4. /[main](/eclipse-californium/californium/tree/main/scandium-core/src/main)
5. /[java](/eclipse-californium/californium/tree/main/scandium-core/src/main/java)
6. /[org](/eclipse-californium/californium/tree/main/scandium-core/src/main/java/org)
7. /[eclipse](/eclipse-californium/californium/tree/main/scandium-core/src/main/java/org/eclipse)
8. /[californium](/eclipse-californium/californium/tree/main/scandium-core/src/main/java/org/eclipse/californium)
9. /[scandium](/eclipse-californium/californium/tree/main/scandium-core/src/main/java/org/eclipse/californium/scandium)
10. /[config](/eclipse-californium/californium/tree/main/scandium-core/src/main/java/org/eclipse/californium/scandium/config)
/
# DtlsConfig.java

 Blame  Blame
## Latest commit

## History

[History](/eclipse-californium/californium/commits/main/scandium-core/src/main/java/org/eclipse/californium/scandium/config/DtlsConfig.java)1033 lines (972 loc) · 43.7 KB main
## Breadcrumbs

1. [californium](/eclipse-californium/californium/tree/main)
2. /[scandium-core](/eclipse-californium/californium/tree/main/scandium-core)
3. /[src](/eclipse-californium/californium/tree/main/scandium-core/src)
4. /[main](/eclipse-californium/californium/tree/main/scandium-core/src/main)
5. /[java](/eclipse-californium/californium/tree/main/scandium-core/src/main/java)
6. /[org](/eclipse-californium/californium/tree/main/scandium-core/src/main/java/org)
7. /[eclipse](/eclipse-californium/californium/tree/main/scandium-core/src/main/java/org/eclipse)
8. /[californium](/eclipse-californium/californium/tree/main/scandium-core/src/main/java/org/eclipse/californium)
9. /[scandium](/eclipse-californium/californium/tree/main/scandium-core/src/main/java/org/eclipse/californium/scandium)
10. /[config](/eclipse-californium/californium/tree/main/scandium-core/src/main/java/org/eclipse/californium/scandium/config)
/
# DtlsConfig.java

Top
## File metadata and controls

* Code
* Blame

1033 lines (972 loc) · 43.7 KB[Raw](https://github.com/eclipse-californium/californium/raw/refs/heads/main/scandium-core/src/main/java/org/eclipse/californium/scandium/config/DtlsConfig.java)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* \* Copyright (c) 2021 Bosch.IO GmbH and others. \*  \* All rights reserved. This program and the accompanying materials \* are made available under the terms of the Eclipse Public License v2.0 \* and Eclipse Distribution License v1.0 which accompany this distribution. \*  \* The Eclipse Public License is available at \* http://www.eclipse.org/legal/epl-v20.html \* and the Eclipse Distribution License is available at \* http://www.eclipse.org/org/documents/edl-v10.html. \*  \* Contributors: \* Bosch IO.GmbH - initial creation \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/package org.eclipse.californium.scandium.config;
import java.net.DatagramSocket;import java.util.ArrayList;import java.util.Arrays;import java.util.List;import java.util.concurrent.TimeUnit;
import org.eclipse.californium.elements.DtlsEndpointContext;import org.eclipse.californium.elements.config.BasicListDefinition;import org.eclipse.californium.elements.config.BooleanDefinition;import org.eclipse.californium.elements.config.CertificateAuthenticationMode;import org.eclipse.californium.elements.config.Configuration;import org.eclipse.californium.elements.config.Configuration.ModuleDefinitionsProvider;import org.eclipse.californium.elements.config.DefinitionUtils;import org.eclipse.californium.elements.config.EnumDefinition;import org.eclipse.californium.elements.config.EnumListDefinition;import org.eclipse.californium.elements.config.FloatDefinition;import org.eclipse.californium.elements.config.IntegerDefinition;import org.eclipse.californium.elements.config.StringSetDefinition;import org.eclipse.californium.elements.config.SystemConfig;import org.eclipse.californium.elements.config.TimeDefinition;import org.eclipse.californium.elements.config.ValueException;import org.eclipse.californium.scandium.DTLSConnector;import org.eclipse.californium.scandium.DtlsDatagramFilter;import org.eclipse.californium.scandium.dtls.CertificateMessage;import org.eclipse.californium.scandium.dtls.CertificateRequest;import org.eclipse.californium.scandium.dtls.CertificateType;import org.eclipse.californium.scandium.dtls.ExtendedMasterSecretMode;import org.eclipse.californium.scandium.dtls.HelloVerifyRequest;import org.eclipse.californium.scandium.dtls.MaxFragmentLengthExtension.Length;import org.eclipse.californium.scandium.dtls.Record;import org.eclipse.californium.scandium.dtls.RecordLayer;import org.eclipse.californium.scandium.dtls.SignatureAndHashAlgorithm;import org.eclipse.californium.scandium.dtls.cipher.CipherSuite;import org.eclipse.californium.scandium.dtls.cipher.CipherSuite.CertificateKeyAlgorithm;import org.eclipse.californium.scandium.dtls.cipher.XECDHECryptography.SupportedGroup;
/\*\* \* Configuration definitions for DTLS. \*  \* @since 3.0 \*/public final class DtlsConfig {
 public static final String MODULE = "DTLS.";
 /\*\* \* DTLS role. \*/ public enum DtlsRole { /\*\* \* Client only. \*/ CLIENT\_ONLY, /\*\* \* Server only. \*/ SERVER\_ONLY, /\*\* \* Both roles, client and server. \*/ BOTH }
 /\*\* \* DTLS secure renegotiation. \*  \* Californium doesn't support renegotiation at all, but RFC5746 requests to \* update to a minimal version of RFC 5746. \*  \* @see <a href="https://tools.ietf.org/html/rfc5746" target="\_blank" >RFC 5746</a> \*  \* @since 3.8 \*/ public enum DtlsSecureRenegotiation { /\*\* \* Don't use secure renegotiation. \*/ NONE, /\*\* \* Request secure renegotiation. \*/ WANTED, /\*\* \* Reject missing secure renegotiation. \*/ NEEDED }
 /\*\* \* Definition for list of signature and hash algorithms. \*/ public static class SignatureAndHashAlgorithmsDefinition extends BasicListDefinition<SignatureAndHashAlgorithm> {
 public SignatureAndHashAlgorithmsDefinition(String key, String documentation) { super(key, documentation, null); }
 @Override public String getTypeName() { return "List<SignatureAndHashAlgorithm>"; }
 @Override public String writeValue(List<SignatureAndHashAlgorithm> value) { StringBuilder message = new StringBuilder(); for (SignatureAndHashAlgorithm in : value) { message.append(in.getJcaName()).append(", "); } message.setLength(message.length() - 2); return message.toString(); }
 @Override public List<SignatureAndHashAlgorithm> checkValue(List<SignatureAndHashAlgorithm> value) throws ValueException { if (value != null) { for (SignatureAndHashAlgorithm algorithm : value) { if (!algorithm.isSupported()) { throw new IllegalArgumentException(algorithm + " is not supported by the JCE!"); } } } return super.checkValue(value); }
 @Override protected boolean isAssignableFrom(Object value) { if (value instanceof List<?>) { for (Object item : (List<?>) value) { if (!(item instanceof SignatureAndHashAlgorithm)) { throw new IllegalArgumentException(item + " is no SignatureAndHashAlgorithm"); } } return true; } return false; }
 @Override protected List<SignatureAndHashAlgorithm> parseValue(String value) { String[] list = value.split(","); List<SignatureAndHashAlgorithm> result = new ArrayList<>(list.length); for (String in : list) { in = in.trim(); SignatureAndHashAlgorithm item = SignatureAndHashAlgorithm.valueOf(in); result.add(item); } return result; }
 }
 /\*\* \* The default value for {@link #DTLS\_RETRANSMISSION\_TIMEOUT} in \* milliseconds. \*  \* @since 3.0 2s instead of 1s (following ACK timeout in \* <a href="https://tools.ietf.org/html/rfc7252#section-4.8" target= \* "\_blank">RFC7252</a>). \*/ public static final int DEFAULT\_RETRANSMISSION\_TIMEOUT\_IN\_MILLISECONDS = 2000; /\*\* \* The retransmission timeout according \* <a href="https://tools.ietf.org/html/rfc6347#section-4.2.4.1" target= \* "\_blank">RFC6347</a> in milliseconds. \*/ public static final int RFC6347\_RETRANSMISSION\_TIMEOUT\_IN\_MILLISECONDS = 1000; /\*\* \* The retransmission timeout according \* <a href="https://tools.ietf.org/html/rfc7925#section-11" target= \* "\_blank">RFC7925</a> in milliseconds. \*/ public static final int RFC7925\_RETRANSMISSION\_TIMEOUT\_IN\_MILLISECONDS = 9000; /\*\* \* The maximum retransmission timeout according \* <a href="https://tools.ietf.org/html/rfc6347#section-4.2.4.1" target= \* "\_blank">RFC6347</a> in milliseconds. \*/ public static final int DEFAULT\_MAX\_RETRANSMISSION\_TIMEOUT\_IN\_MILLISECONDS = 60000; /\*\* \* The default value for the {@link #DTLS\_ADDITIONAL\_ECC\_TIMEOUT} property \* in milliseconds. \*/ public static final int DEFAULT\_ADDITIONAL\_TIMEOUT\_FOR\_ECC\_IN\_MILLISECONDS = 0; /\*\* \* The default value for {@link #DTLS\_MAX\_RETRANSMISSIONS}. \*/ public static final int DEFAULT\_MAX\_RETRANSMISSIONS = 4; /\*\* \* The default value for the \* {@link #DTLS\_MAX\_FRAGMENTED\_HANDSHAKE\_MESSAGE\_LENGTH}. \*/ public static final int DEFAULT\_MAX\_FRAGMENTED\_HANDSHAKE\_MESSAGE\_LENGTH = 8192; /\*\* \* The default value for the {@link #DTLS\_MAX\_TRANSMISSION\_UNIT\_LIMIT} \* property. \*/ public static final int DEFAULT\_MAX\_TRANSMISSION\_UNIT\_LIMIT = RecordLayer.DEFAULT\_ETH\_MTU; /\*\* \* The default value for the {@link #DTLS\_MAX\_CONNECTIONS} property. \*/ public static final int DEFAULT\_MAX\_CONNECTIONS = 150000; /\*\* \* The default value for the {@link #DTLS\_STALE\_CONNECTION\_THRESHOLD} \* property in seconds. \*/ public static final long DEFAULT\_STALE\_CONNECTION\_TRESHOLD\_SECONDS = 30 \* 60; /\*\* \* The default value for the {@link #DTLS\_MAX\_PENDING\_OUTBOUND\_JOBS} \* property. \*  \* @since 3.5 \*/ public static final int DEFAULT\_MAX\_PENDING\_OUTBOUND\_JOBS = 50000; /\*\* \* The default value for the {@link #DTLS\_MAX\_PENDING\_INBOUND\_JOBS} \* property. \*  \* @since 3.5 \*/ public static final int DEFAULT\_MAX\_PENDING\_INBOUND\_JOBS = 50000; /\*\* \* The default value for the {@link #DTLS\_MAX\_PENDING\_HANDSHAKE\_RESULT\_JOBS} \* property. \*  \* @since 3.5 \*/ public static final int DEFAULT\_MAX\_PENDING\_HANDSHAKE\_RESULT\_JOBS = 5000; /\*\* \* The default value for the \* {@link #DTLS\_MAX\_DEFERRED\_OUTBOUND\_APPLICATION\_MESSAGES} property. \*/ public static final int DEFAULT\_MAX\_DEFERRED\_OUTBOUND\_APPLICATION\_MESSAGES = 10; /\*\* \* The default value for the {@link #DTLS\_MAX\_DEFERRED\_INBOUND\_RECORDS\_SIZE} \* property. \*/ public static final int DEFAULT\_MAX\_DEFERRED\_PROCESSED\_INCOMING\_RECORDS\_SIZE = 8192; /\*\* \* The default value for the {@link #DTLS\_SECURE\_RENEGOTIATION}. \*  \* @since 3.8 \*/ public static final DtlsSecureRenegotiation DEFAULT\_SECURE\_RENEGOTIATION = DtlsSecureRenegotiation.WANTED;
 /\*\* \* DTLS session timeout. Currently not supported! \*  \* Californium uses {@link #DTLS\_MAX\_CONNECTIONS} and \* {@link #DTLS\_STALE\_CONNECTION\_THRESHOLD} in order to keep session as \* along as the resources are not required for fresh connections. \*/ public static final TimeDefinition DTLS\_SESSION\_TIMEOUT = new TimeDefinition(MODULE + "SESSION\_TIMEOUT", "DTLS session timeout. Currently not supported.", 1L, TimeUnit.HOURS); /\*\* \* DTLS auto handshake timeout. \*  \* After that period without exchanged messages, new messages will initiate \* a handshake. If possible a resumption/abbreviated handshake is used. Must \* not be used with {@link DtlsRole#SERVER\_ONLY}. {@code 30s} is a common \* value to compensate assumed NAT timeouts. \*/ public static final TimeDefinition DTLS\_AUTO\_HANDSHAKE\_TIMEOUT = new TimeDefinition( MODULE + "AUTO\_HANDSHAKE\_TIMEOUT", "DTLS auto-handshake timeout. After that period without exchanging messages, " + "a new message will initiate a handshake. Must not be used with SERVER\_ONLY! " + "Common value will be \"30[s]\" in order to compensate assumed NAT timeouts. " + "<blank>, disabled."); /\*\* \* DTLS connection id length. \*  \* <a href= "https://www.rfc-editor.org/rfc/rfc9146.html" target \* ="\_blank">RFC 9146, Connection Identifier for DTLS 1.2</a> \*  \* <ul> \* <li>{@code ""} disabled support for connection id.</li> \* <li>{@code 0} enable support for connection id, but don't use it for \* incoming traffic to this peer.</li> \* <li>{@code n} use connection id of n bytes. Note: chose n large enough \* for the number of considered peers. Recommended to have 100 time more \* values than peers. E.g. 65000 peers, chose not 2 bytes, chose at lease 3 \* bytes!</li> \* </ul> \*/ public static final IntegerDefinition DTLS\_CONNECTION\_ID\_LENGTH = new IntegerDefinition( MODULE + "CONNECTION\_ID\_LENGTH", "DTLS connection ID length. <blank> default, -1 disables, 0 enables support without active use of CID.", 6, -1);
 /\*\* \* If {@link #DTLS\_CONNECTION\_ID\_LENGTH} enables the use of a connection id, \* this node id could be used to configure the generation of connection ids \* specific for node in a multi-node deployment (cluster). The value is used \* as first byte in generated connection ids. \*/ public static final IntegerDefinition DTLS\_CONNECTION\_ID\_NODE\_ID = new IntegerDefinition( MODULE + "CONNECTION\_ID\_NODE\_ID", "DTLS cluster-node ID used for connection ID. <blank> not used.", null, 0);
 /\*\* \* Specify the initial DTLS retransmission timeout. \*/ public static final TimeDefinition DTLS\_RETRANSMISSION\_TIMEOUT = new TimeDefinition( MODULE + "RETRANSMISSION\_TIMEOUT", "DTLS initial retransmission timeout.", DEFAULT\_RETRANSMISSION\_TIMEOUT\_IN\_MILLISECONDS, TimeUnit.MILLISECONDS); /\*\* \* Specify the maximum DTLS retransmission timeout. \*/ public static final TimeDefinition DTLS\_MAX\_RETRANSMISSION\_TIMEOUT = new TimeDefinition( MODULE + "MAX\_RETRANSMISSION\_TIMEOUT", "DTLS maximum retransmission timeout.", DEFAULT\_MAX\_RETRANSMISSION\_TIMEOUT\_IN\_MILLISECONDS, TimeUnit.MILLISECONDS); /\*\* \* Random factor applied to the initial retransmission timeout. Harmonize \* CoAP and DTLS. \*/ public static final FloatDefinition DTLS\_RETRANSMISSION\_INIT\_RANDOM = new FloatDefinition( MODULE + "RETRANSMISSION\_INIT\_RANDOM", "DTLS random factor for initial retransmission timeout.", 1.0F, 1.0F); /\*\* \* Scale factor applied to the retransmission timeout. Harmonize CoAP and \* DTLS. \*/ public static final FloatDefinition DTLS\_RETRANSMISSION\_TIMEOUT\_SCALE = new FloatDefinition( MODULE + "RETRANSMISSION\_TIMEOUT\_SCALE", "DTLS scale factor for retransmission backoff-timeout.", 2.0F, 1.0F); /\*\* \* Specify the additional initial DTLS retransmission timeout, when the \* other peer is expected to perform ECC calculations. \*  \* ECC calculations may be time intensive, especially for smaller \* micro-controllers without ecc-hardware support. The additional timeout \* prevents Californium from resending a flight too early. The extra time is \* used for the DTLS-client, if a ECDSA or ECDHE cipher suite is proposed, \* and for the DTLS-server, if a ECDSA or ECDHE cipher suite is selected. \*  \* This timeout is added to {@link #DTLS\_RETRANSMISSION\_TIMEOUT} and on each \* retransmission, the resulting time is doubled. \*/ public static final TimeDefinition DTLS\_ADDITIONAL\_ECC\_TIMEOUT = new TimeDefinition( MODULE + "ADDITIONAL\_ECC\_TIMEOUT", "DTLS additional initial timeout for ECC related flights.", DEFAULT\_ADDITIONAL\_TIMEOUT\_FOR\_ECC\_IN\_MILLISECONDS, TimeUnit.MILLISECONDS); /\*\* \* Specify the maximum number of DTLS retransmissions. \*/ public static final IntegerDefinition DTLS\_MAX\_RETRANSMISSIONS = new IntegerDefinition( MODULE + "MAX\_RETRANSMISSIONS", "DTLS maximum number of flight retransmissions.", DEFAULT\_MAX\_RETRANSMISSIONS, 0); /\*\* \* Specify the number of DTLS retransmissions before the attempt to transmit \* a flight in back-off mode. \*  \* <a href="https://tools.ietf.org/html/rfc6347#page-12" target= "\_blank"> \* RFC 6347, Section 4.1.1.1, Page 12</a> \*  \* In back-off mode, UDP datagrams of maximum 512 bytes or the negotiated \* records size, if that is smaller, are used. Each handshake message is \* placed in one dtls record, or more dtls records, if the handshake message \* is too large and must be fragmented. Beside of the CCS and FINISH dtls \* records, which send together in one UDP datagram, all other records are \* send in separate datagrams. \*  \* The {@link #DTLS\_USE\_MULTI\_HANDSHAKE\_MESSAGE\_RECORDS} and \* {@link #DTLS\_USE\_MULTI\_RECORD\_MESSAGES} has precedence over the back-off \* definition. \*  \* Value {@code 0}, to disable it, {@code null}, for default of \* {@link #DTLS\_MAX\_RETRANSMISSIONS} / 2. \*/ public static final IntegerDefinition DTLS\_RETRANSMISSION\_BACKOFF = new IntegerDefinition( MODULE + "RETRANSMISSION\_BACKOFF", "Number of flight-retransmissions before switching to backoff mode using single handshake messages in single record datagrams.", null, 0);
 /\*\* \* Enable or disable the server to use a session ID in order to support or \* disable session resumption. \*/ public static final BooleanDefinition DTLS\_SERVER\_USE\_SESSION\_ID = new BooleanDefinition( MODULE + "SERVER\_USE\_SESSION\_ID", "Enable server to use a session ID in order to support session resumption.", true);
 /\*\* \* Enable early stop of retransmissions. Stop on receiving the first message \* of next flight, not waiting for the last. \*/ public static final BooleanDefinition DTLS\_USE\_EARLY\_STOP\_RETRANSMISSION = new BooleanDefinition( MODULE + "USE\_EARLY\_STOP\_RETRANSMISSION", "Stop retransmission on receiving the first message of the next flight, not waiting for the last message.", true);
 /\*\* \* Specify the record size limit. \*  \* See <a href="https://tools.ietf.org/html/rfc8449" target="\_blank">RFC \* 8449</a> for details. \*/ public static final IntegerDefinition DTLS\_RECORD\_SIZE\_LIMIT = new IntegerDefinition(MODULE + "RECORD\_SIZE\_LIMIT", "DTLS record size limit (RFC 8449). Between 64 and 16K.", null, 64);
 /\*\* \* Specify the maximum fragment length. \*  \* @see <a href="https://tools.ietf.org/html/rfc6066#section-4" target= \* "\_blank">RFC 6066, Section 4</a> \*/ public static final EnumDefinition<Length> DTLS\_MAX\_FRAGMENT\_LENGTH = new EnumDefinition<>( MODULE + "MAX\_FRAGMENT\_SIZE", "DTLS maximum fragment length (RFC 6066).", Length.values());
 /\*\* \* Specify the maximum length of reassembled fragmented handshake messages. \*/ public static final IntegerDefinition DTLS\_MAX\_FRAGMENTED\_HANDSHAKE\_MESSAGE\_LENGTH = new IntegerDefinition( MODULE + "MAX\_FRAGMENTED\_HANDSHAKE\_MESSAGE\_LENGTH", "DTLS maximum length of reassembled fragmented handshake message.\n" + "Must be large enough for used certificates.", DEFAULT\_MAX\_FRAGMENTED\_HANDSHAKE\_MESSAGE\_LENGTH, 64);
 /\*\* \* Enable to use multiple DTLS records in UDP messages. \*/ public static final BooleanDefinition DTLS\_USE\_MULTI\_RECORD\_MESSAGES = new BooleanDefinition( MODULE + "USE\_MULTI\_RECORD\_MESSAGES", "Use multiple DTLS records in UDP messages."); /\*\* \* Enable to use multiple DTLS records in UDP messages. \*/ public static final BooleanDefinition DTLS\_USE\_MULTI\_HANDSHAKE\_MESSAGE\_RECORDS = new BooleanDefinition( MODULE + "USE\_MULTI\_HANDSHAKE\_MESSAGE\_RECORDS", "Use multiple handshake messages in DTLS records.\nNot all libraries may have implemented this!");
 /\*\* \* Specify the client's certificate authentication mode. \*  \* Used on the server-side to request a client certificate for \* authentication. \*/ public static final EnumDefinition<CertificateAuthenticationMode> DTLS\_CLIENT\_AUTHENTICATION\_MODE = new EnumDefinition<>( MODULE + "CLIENT\_AUTHENTICATION\_MODE", "DTLS client authentication mode for certificate based cipher suites.", CertificateAuthenticationMode.NEEDED, CertificateAuthenticationMode.values());
 /\*\* \* Enable the DTLS client to verify the server certificate's subjects. \*/ public static final BooleanDefinition DTLS\_VERIFY\_SERVER\_CERTIFICATES\_SUBJECT = new BooleanDefinition( MODULE + "VERIFY\_SERVER\_CERTIFICATES\_SUBJECT", "DTLS verifies the server certificate's subjects.", true);
 /\*\* \* Specify the supported certificate types. \*  \* @since 3.8 \*/ public static final EnumListDefinition<CertificateType> DTLS\_CERTIFICATE\_TYPES = new EnumListDefinition<>( MODULE + "CERTIFICATE\_TYPES", "DTLS supported certificate types ordered by preference.", Arrays.asList(CertificateType.RAW\_PUBLIC\_KEY, CertificateType.X\_509), new CertificateType[] { CertificateType.RAW\_PUBLIC\_KEY, CertificateType.X\_509 });
 /\*\* \* Specify the supported DTLS roles. \*/ public static final EnumDefinition<DtlsRole> DTLS\_ROLE = new EnumDefinition<>(MODULE + "ROLE", "DTLS role.", DtlsRole.BOTH, DtlsRole.values());
 /\*\* \* Specify the MTU (Maximum Transmission Unit). \*  \* Note: Californium is only able to detect the MTU of local network \* interfaces. For the transmission, the PMTU (Path Maximum Transmission \* Unit) is required. Especially, if ip-tunnels are used, this value must be \* provided in order to consider a smaller PMTU. \*  \* @see #DTLS\_MAX\_TRANSMISSION\_UNIT\_LIMIT \*/ public static final IntegerDefinition DTLS\_MAX\_TRANSMISSION\_UNIT = new IntegerDefinition( MODULE + "MAX\_TRANSMISSION\_UNIT", "DTLS MTU (Maximum Transmission Unit).\nMust be used, if the MTU of the local network doesn't apply, e.g. if ip-tunnels are used.", null, 64);
 /\*\* \* Specify a MTU (Maximum Transmission Unit) limit for (link local) auto \* detection. \*  \* Limits maximum number of bytes sent in one transmission. \* \* Note: previous versions took the local link MTU without limits. That \* results in possibly larger MTU, e.g. for localhost or some cloud nodes \* using "jumbo frames". If a larger MTU is required to be detectable, \* please adjust this limit to the required value. \*  \* @see #DEFAULT\_MAX\_TRANSMISSION\_UNIT\_LIMIT \* @see #DTLS\_MAX\_TRANSMISSION\_UNIT \*/ public static final IntegerDefinition DTLS\_MAX\_TRANSMISSION\_UNIT\_LIMIT = new IntegerDefinition( MODULE + "MAX\_TRANSMISSION\_UNIT\_LIMIT", "DTLS MTU (Maximum Transmission Unit) limit for local auto detection.", null, 64);
 /\*\* \* Specify default handshake mode. \*  \* <b>Note:</b> if {@link #DTLS\_ROLE} is {@link DtlsRole#SERVER\_ONLY}, the \* specified default handshake mode is ignored and replaced by \* {@link DtlsEndpointContext#HANDSHAKE\_MODE\_NONE}. \*  \* Values are {@link DtlsEndpointContext#HANDSHAKE\_MODE\_NONE} or \* {@link DtlsEndpointContext#HANDSHAKE\_MODE\_AUTO}. \*/ public static final StringSetDefinition DTLS\_DEFAULT\_HANDSHAKE\_MODE = new StringSetDefinition( MODULE + "DEFAULT\_HANDSHAKE\_MODE", "DTLS default handshake mode.", DtlsEndpointContext.HANDSHAKE\_MODE\_AUTO, DtlsEndpointContext.HANDSHAKE\_MODE\_NONE, DtlsEndpointContext.HANDSHAKE\_MODE\_AUTO);
 /\*\* \* Specify the maximum number of active connections the connector should \* support. \* <p> \* An <em>active</em> connection is a connection that has been used within \* the last <em>staleConnectionThreshold</em> seconds. After that it is \* considered to be <em>stale</em>. \* <p> \* Once the maximum number of active connections is reached, new connections \* will only be accepted by the connector, if <em>stale</em> connections \* exist (which will be evicted one-by-one on an oldest-first basis). \* <p> \* The default value of this property is {@link #DEFAULT\_MAX\_CONNECTIONS}. \*/ public static final IntegerDefinition DTLS\_MAX\_CONNECTIONS = new IntegerDefinition(MODULE + "MAX\_CONNECTIONS", "DTLS maximum connections.", DEFAULT\_MAX\_CONNECTIONS, 1);
 /\*\* \* Specify the threshold without any data being exchanged before a \* connection is considered <em>stale</em>. \* <p> \* Once a connection becomes stale, it is eligible for eviction when a peer \* wants to establish a new connection and the connector already has \* {@link #DTLS\_MAX\_CONNECTIONS} connections with peers established. \* <p> \* <b>Note:</b> a connection is no longer considered stale, once data is \* being exchanged over it before it got evicted. \*/ public static final TimeDefinition DTLS\_STALE\_CONNECTION\_THRESHOLD = new TimeDefinition( MODULE + "STALE\_CONNECTION\_THRESHOLD", "DTLS threshold for stale connections. Connections will only get removed for new ones, "+ "if at least for that threshold no messages are exchanged using that connection.", DEFAULT\_STALE\_CONNECTION\_TRESHOLD\_SECONDS, TimeUnit.SECONDS);
 /\*\* \* Specify the number of pending outbound jobs that can be queued before \* dropping new job. \*  \* @since 3.5 \*/ public static final IntegerDefinition DTLS\_MAX\_PENDING\_OUTBOUND\_JOBS = new IntegerDefinition( MODULE + "MAX\_PENDING\_OUTBOUND\_JOBS", "Maximum number of jobs for outbound DTLS messages.", DEFAULT\_MAX\_PENDING\_OUTBOUND\_JOBS, 64);
 /\*\* \* Specify the number of pending inbound jobs that can be queued before \* dropping new job. \*  \* @since 3.5 \*/ public static final IntegerDefinition DTLS\_MAX\_PENDING\_INBOUND\_JOBS = new IntegerDefinition( MODULE + "MAX\_PENDING\_INBOUND\_JOBS", "Maximum number of jobs for inbound DTLS messages.", DEFAULT\_MAX\_PENDING\_INBOUND\_JOBS, 64); /\*\* \* Specify the number of pending handshake result jobs that can be queued \* before dropping new job. \*  \* @since 3.5 \*/ public static final IntegerDefinition DTLS\_MAX\_PENDING\_HANDSHAKE\_RESULT\_JOBS = new IntegerDefinition( MODULE + "MAX\_PENDING\_HANDSHAKE\_RESULT\_JOBS", "Maximum number of jobs for DTLS handshake results.", DEFAULT\_MAX\_PENDING\_HANDSHAKE\_RESULT\_JOBS, 64);
 /\*\* \* Specify maximum number of deferred processed outgoing application data \* messages. \*  \* Application data messages sent during a handshake may be dropped or \* processed deferred after the handshake. Set this to limit the maximum \* number of messages, which are intended to be processed deferred. If more \* messages are sent, these messages are dropped. \*/ public static final IntegerDefinition DTLS\_MAX\_DEFERRED\_OUTBOUND\_APPLICATION\_MESSAGES = new IntegerDefinition( MODULE + "MAX\_DEFERRED\_OUTBOUND\_APPLICATION\_MESSAGES", "DTLS maximum deferred outbound application messages.", DEFAULT\_MAX\_DEFERRED\_OUTBOUND\_APPLICATION\_MESSAGES, 0); /\*\* \* Specify maximum size of deferred processed incoming records. \*  \* Handshake records with future handshake message sequence number or \* records with future epochs received during a handshake may be dropped or \* processed deferred. Set this to limit the maximum size of all records, \* which are intended to be processed deferred. If more records are \* received, these records are dropped. \*/ public static final IntegerDefinition DTLS\_MAX\_DEFERRED\_INBOUND\_RECORDS\_SIZE = new IntegerDefinition( MODULE + "MAX\_DEFERRED\_INBOUND\_RECORDS", "DTLS maximum size of all deferred inbound messages.", DEFAULT\_MAX\_DEFERRED\_PROCESSED\_INCOMING\_RECORDS\_SIZE, 0);
 /\*\* \* Specify the number of receiver threads used by a {@link DTLSConnector}. \* <p> \* The receiver threads are responsible for receiving the messages and \* parsing them into structured {@link Record}s. Cryptographic function \* except the cookie generation for {@link HelloVerifyRequest} are not \* executed by this thread, these are executed by \* {@link #DTLS\_CONNECTOR\_THREAD\_COUNT}. \* <p> \* Values {@code < 0} will use 1 virtual thread if supported by the JVM. \*/ public static final IntegerDefinition DTLS\_RECEIVER\_THREAD\_COUNT = new IntegerDefinition( MODULE + "RECEIVER\_THREAD\_COUNT", "Number of DTLS receiver threads. -1 for 1 virtual thread, if supported by the JVM.", 1); /\*\* \* Specify the number of connector threads used by a {@link DTLSConnector}. \* The connector threads are responsible for the most cryptographic \* functions for both incoming and outgoing messages. \*/ public static final IntegerDefinition DTLS\_CONNECTOR\_THREAD\_COUNT = new IntegerDefinition( MODULE + "CONNECTOR\_THREAD\_COUNT", "Number of DTLS connector threads.", 1, 0); /\*\* \* Specify the DTLS receive buffer size used for \* {@link DatagramSocket#setReceiveBufferSize(int)}. {@code null} or \* {@code 0} to use the OS default. \*/ public static final IntegerDefinition DTLS\_RECEIVE\_BUFFER\_SIZE = new IntegerDefinition( MODULE + "RECEIVE\_BUFFER\_SIZE", "DTLS receive-buffer size. Empty or 0 to use the OS default.", null, 64); /\*\* \* Specify the DTLS send buffer size used for \* {@link DatagramSocket#setSendBufferSize(int)}. {@code null} or {@code 0} \* to use the OS default. \*/ public static final IntegerDefinition DTLS\_SEND\_BUFFER\_SIZE = new IntegerDefinition(MODULE + "SEND\_BUFFER\_SIZE", "DTLS send-buffer size. Empty or 0 to use the OS default.", null, 64);
 /\*\* \* Specify the usage and support of "server name indication". \*  \* The support on the server side currently includes a server name specific \* PSK secret lookup and to forward the server name to the CoAP stack in the \* {@link org.eclipse.californium.elements.EndpointContext}. \*  \* @see <a href="https://tools.ietf.org/html/rfc6066#section-3" target= \* "\_blank">RFC 6066, Section 3</a> \*/ public static final BooleanDefinition DTLS\_USE\_SERVER\_NAME\_INDICATION = new BooleanDefinition( MODULE + "USE\_SERVER\_NAME\_INDICATION", "DTLS use server name indication.", false);
 /\*\* \* Defines the usage of the "extend master secret" extension. \*  \* @see <a href="https://tools.ietf.org/html/rfc7627" target="\_blank">RFC \* 7627</a> \*/ public static final EnumDefinition<ExtendedMasterSecretMode> DTLS\_EXTENDED\_MASTER\_SECRET\_MODE = new EnumDefinition<>( MODULE + "EXTENDED\_MASTER\_SECRET\_MODE", "DTLS extended master secret mode.", ExtendedMasterSecretMode.ENABLED, ExtendedMasterSecretMode.values());
 /\*\* \* Generally enable/disable the server's HELLO\_VERIFY\_REQUEST. \* <p> \* <b>Note:</b> it is strongly not recommended to disable the \* HELLO\_VERIFY\_REQUEST if used with certificates! That creates a large \* amplification! \*  \* @see <a href="https://tools.ietf.org/html/rfc6347#section-4.2.1" target= \* "\_blank">RFC 6347, 4.2.1. Denial-of-Service Countermeasures</a> \*/ public static final BooleanDefinition DTLS\_USE\_HELLO\_VERIFY\_REQUEST = new BooleanDefinition( MODULE + "USE\_HELLO\_VERIFY\_REQUEST", "DTLS use a HELLO\_VERIFY\_REQUEST to protect against spoofing.", true);
 /\*\* \* Use anti replay filter. \*  \* @see <a href= "https://tools.ietf.org/html/rfc6347#section-4.1.2.6" \* target= "\_blank">RFC6347 4.1.2.6. Anti-Replay</a> \*/ public static final BooleanDefinition DTLS\_USE\_ANTI\_REPLAY\_FILTER = new BooleanDefinition( MODULE + "USE\_ANTI\_REPLAY\_FILTER", "DTLS use the anti-replay-filter.", true);
 /\*\* \* Use disabled window for anti replay filter. \*  \* Californium uses the "sliding receive window" approach mentioned in \* <a href= "https://tools.ietf.org/html/rfc6347#section-4.1.2.6" target= \* "\_blank">RFC6347 4.1.2.6. Anti-Replay</a>. That causes trouble, if some \* records are sent on postponed routes (e.g. SMS). That would make it more \* probable, that the record is to old for the receive window. In order not \* to discard such records, this values defines a "disabled window", that \* allows record to pass the filter, even if the records are too old for the \* current receive window. \*  \* The configured value will be subtracted from to lower receive window \* boundary. A value of {@code -1} will set that calculated lower boundary \* to {@code 0}. Messages between lower receive window boundary and that \* calculated value will pass the filter, for other messages the filter is \* applied. \*  \* @see <a href= "https://tools.ietf.org/html/rfc6347#section-4.1.2.6" \* target= "\_blank">RFC6347 4.1.2.6. Anti-Replay</a> \*/ public static final IntegerDefinition DTLS\_USE\_DISABLED\_WINDOW\_FOR\_ANTI\_REPLAY\_FILTER = new IntegerDefinition( MODULE + "USE\_DISABLED\_WINDOW\_FOR\_ANTI\_REPLAY\_FILTER", "DTLS use a disabled window for the anti-replay-filter. -1 := extend the disabled window to start of session, 0 := normal window, <n> := disabled window of size <n>.", 0, -1); /\*\* \* Update the ip-address from DTLS 1.2 CID records only for newer records \* based on epoch/sequence\_number. \*  \* @see <a href= "https://www.rfc-editor.org/rfc/rfc9146.html#section-6" \* target= "\_blank">RFC 9146, Connection Identifiers for DTLS 1.2, 6. \* Peer Address Update</a> \*/ public static final BooleanDefinition DTLS\_UPDATE\_ADDRESS\_USING\_CID\_ON\_NEWER\_RECORDS = new BooleanDefinition( MODULE + "UPDATE\_ADDRESS\_USING\_CID\_ON\_NEWER\_RECORDS", "DTLS update address using CID only on newer records. Without any CID record may update the address.", true);
 /\*\* \* Only process newer records based on epoch/sequence\_number. \*  \* Drop reorder records in order to protect from delay attacks, if no other \* means, maybe on application level, are available. \*  \* @since 3.8 \*/ public static final BooleanDefinition DTLS\_USE\_NEWER\_RECORD\_FILTER = new BooleanDefinition( MODULE + "USE\_NEWER\_FILTER", "DTLS use newer record filter.\n"  + "Drop reordered records in order to protect from delay attacks,\n" + "if no other means, maybe on application level, are available.", false);
 /\*\* \* Use truncated certificate paths for client's certificate message. \*  \* Truncate certificate path according the received certificate authorities \* in the {@link CertificateRequest} for the client's \* {@link CertificateMessage}. \*/ public static final BooleanDefinition DTLS\_TRUNCATE\_CLIENT\_CERTIFICATE\_PATH = new BooleanDefinition( MODULE + "TRUNCATE\_CLIENT\_CERTIFICATE\_PATH", "DTLS truncate client certificate path.", true);
 /\*\* \* Use truncated certificate paths for validation. \*  \* Truncate certificate path according the available trusted certificates \* before validation. \*/ public static final BooleanDefinition DTLS\_TRUNCATE\_CERTIFICATE\_PATH\_FOR\_VALIDATION = new BooleanDefinition( MODULE + "TRUNCATE\_CERTIFICATE\_PATH\_FOR\_VALIDATION", "DTLS certificate path for validation.", true);
 /\*\* \* Use recommended {@link CipherSuite}s only. \*  \* @see CipherSuite#isRecommended() \*/ public static final BooleanDefinition DTLS\_RECOMMENDED\_CIPHER\_SUITES\_ONLY = new BooleanDefinition( MODULE + "RECOMMENDED\_CIPHER\_SUITES\_ONLY", "DTLS recommended cipher-suites only.", true); /\*\* \* Use recommended {@link SupportedGroup}s only. \*  \* @see SupportedGroup#isRecommended() \*/ public static final BooleanDefinition DTLS\_RECOMMENDED\_CURVES\_ONLY = new BooleanDefinition( MODULE + "RECOMMENDED\_CURVES\_ONLY", "DTLS recommended ECC curves/groups only.", true); /\*\* \* Use recommended {@link SignatureAndHashAlgorithm}s only. \*  \* @see SignatureAndHashAlgorithm#isRecommended() \*/ public static final BooleanDefinition DTLS\_RECOMMENDED\_SIGNATURE\_AND\_HASH\_ALGORITHMS\_ONLY = new BooleanDefinition( MODULE + "RECOMMENDED\_SIGNATURE\_AND\_HASH\_ALGORITHMS\_ONLY", "DTLS recommended signature- and hash-algorithms only.", true);
 /\*\* \* Preselected {@link CipherSuite}s. \*/ public static final EnumListDefinition<CipherSuite> DTLS\_PRESELECTED\_CIPHER\_SUITES = new EnumListDefinition<>( MODULE + "PRESELECTED\_CIPHER\_SUITES", "List of preselected DTLS cipher-suites.\n" + "If not recommended cipher suites are intended to be used, switch off DTLS\_RECOMMENDED\_CIPHER\_SUITES\_ONLY.\n" + "The supported cipher suites are evaluated at runtime and may differ from the ones when creating this properties file.", CipherSuite.getCipherSuites(false, false)); /\*\* \* Select {@link CipherSuite}s. \*/ public static final EnumListDefinition<CipherSuite> DTLS\_CIPHER\_SUITES = new EnumListDefinition<>( MODULE + "CIPHER\_SUITES", "List of DTLS cipher-suites.\n" + "If not recommended cipher suites are intended to be used, switch off DTLS\_RECOMMENDED\_CIPHER\_SUITES\_ONLY.\n" + "The supported cipher suites are evaluated at runtime and may differ from the ones when creating this properties file.", null, 1, CipherSuite.getCipherSuites(false, true)); /\*\* \* Select curves ({@link SupportedGroup}s). \*/ public static final EnumListDefinition<SupportedGroup> DTLS\_CURVES = new EnumListDefinition<>(MODULE + "CURVES", "List of DTLS curves (supported groups).\nDefaults to all supported curves of the JCE at runtime.", SupportedGroup.getUsableGroupsArray()); /\*\* \* Select ({@link SignatureAndHashAlgorithm}s). \*/ public static final SignatureAndHashAlgorithmsDefinition DTLS\_SIGNATURE\_AND\_HASH\_ALGORITHMS = new SignatureAndHashAlgorithmsDefinition( MODULE + "SIGNATURE\_AND\_HASH\_ALGORITHMS", "List of DTLS signature- and hash-algorithms.\nValues e.g SHA256withECDSA or ED25519."); /\*\* \* Select {@link CertificateKeyAlgorithm}s. \*/ public static final EnumListDefinition<CertificateKeyAlgorithm> DTLS\_CERTIFICATE\_KEY\_ALGORITHMS = new EnumListDefinition<>( MODULE + "CERTIFICATE\_KEY\_ALGORITHMS", "List of DTLS certificate key algorithms.\n" + "On the client side used to select the default cipher-suites, on the server side to negotiate the client's certificate.", new CertificateKeyAlgorithm[] { CertificateKeyAlgorithm.EC, CipherSuite.CertificateKeyAlgorithm.RSA });
 /\*\* \* Use default DTLS record filter. \*  \* @see DtlsDatagramFilter \* @since 3.5 \*/ public static final BooleanDefinition DTLS\_USE\_DEFAULT\_RECORD\_FILTER = new BooleanDefinition( MODULE + "USE\_DEFAULT\_RECORD\_FILTER", "Use default DTLS record filter.", true);
 /\*\* \* Enable removing of stale connections, if the principal has also a newer \* connection. Intended to free heap earlier for dynamic shared systems, \* mainly useful with newer GC, as ZGC of java 17. Requires to have unique \* principals. \*  \* @since 3.5 \*/ public static final BooleanDefinition DTLS\_REMOVE\_STALE\_DOUBLE\_PRINCIPALS = new BooleanDefinition( MODULE + "REMOVE\_STALE\_DOUBLE\_PRINCIPALS", "Remove stale double principals.\n" +  "Requires unique principals and a read-write-lock connection store.", false);
 /\*\* \* Quiet time for DTLS MAC error filter. \*  \* To decrypt a message and calculate the MAC requires CPU. If a peer sends \* many messages with a broken MAC (maybe because the message is sent by an \* other peer with a spoofed source address), that may lower the overall \* performance. The MAC error filter counts therefore the MAC errors since \* the last period of without MAC errors. This counter is reset to 0, if for \* the quiet period no new MAC error occurs. If frequently new MAC errors \* are detected and the the MAC error counter exceeds \* {@link #DTLS\_MAC\_ERROR\_FILTER\_THRESHOLD}, all messages from that peer are \* dropped before decryption in order to protect the CPU. This dropping last \* for this quiet period and afterwards, the MAC error counter is reseted as \* it is reseted, if no MAC error occurs for that time. \*  \* A value of {@code 0} disables the MAC error filter. \*  \* tn time n, c=n counter with value \*  \* <pre> \* t1 ----- record MAC valid ---&gt; process \* ----- record MAC error ---&gt; drop after decryption, c=1 \* ----- record MAC valid ---&gt; process \* ----- record MAC error ---&gt; drop after decryption, c=2 \* ----- record MAC error ---&gt;drop after decryption, c=3 \* t2 ----- record MAC error ---&gt;drop after decryption, c=4 (&gt; threshold 3), activate MAC error filter \* ----- record MAC error ---&gt; drop by filter \* ----- record MAC error ---&gt; drop by filter \* ----- record MAC valid ---&gt; drop by filter \* ----- record MAC error ---&gt; drop by filter \* t3 ----- record MAC error ---&gt; drop after decryption (t3 - t2 &gt; quiet time), c=0, deactivate MAC error filter \* ----- record MAC valid ---&gt; process \* ----- record MAC error ---&gt; drop after decryption, c=1 \* t4 ----- record MAC valid ---&gt; process \* ----- record MAC valid ---&gt; process \* ----- record MAC valid ---&gt; process \* ----- record MAC valid ---&gt; process \* t5 ----- record MAC valid ---&gt; process, c=0, (t5 - t4 &gt; quiet time), reset counter \* </pre> \*  \* @since 3.6 \*/ public static final TimeDefinition DTLS\_MAC\_ERROR\_FILTER\_QUIET\_TIME = new TimeDefinition( MODULE + "MAC\_ERROR\_FILTER\_QUIET\_TIME", "Quiet time to reset MAC error filter.\n" + "The MAC error filter blocks all traffic for an endpoint, if since the last quiet period the number of new MAC errors exceeds a threshold.\n" + "0 to disable the MAC error filter.", 0, TimeUnit.SECONDS);
 /\*\* \* Threshold for DTLS MAC error filter. \*  \* Maximum number of MAC errors, before all messages are dropped for the \* {@link #DTLS\_MAC\_ERROR\_FILTER\_QUIET\_TIME}. A value of {@code 0} disables \* the MAC error filter. \*  \* @since 3.6 \*/ public static final IntegerDefinition DTLS\_MAC\_ERROR\_FILTER\_THRESHOLD = new IntegerDefinition( MODULE + "MAC\_ERROR\_FILTER\_THRESHOLD", "Threshold of current MAC errors to block all traffic for an endpoint. 0 to disable the MAC error filter.", 0, 0);
 /\*\* \* Specify the secure renegotiation mode. \*  \* Californium doesn't support renegotiation at all, but RFC5746 requests to \* update to a minimal version of RFC 5746. \*  \* @see <a href="https://tools.ietf.org/html/rfc5746" target="\_blank">RFC 5746</a> \*  \* @since 3.8 \*/ public static final EnumDefinition<DtlsSecureRenegotiation> DTLS\_SECURE\_RENEGOTIATION = new EnumDefinition<>( MODULE + "SECURE\_RENEGOTIATION\_MODE", "Use minimal version of RFC5746 to indicate secure renegotiation on initial handshake.\n" + "Renegotation handshakes are always rejected by Californium.", DEFAULT\_SECURE\_RENEGOTIATION, DtlsSecureRenegotiation.values());
 /\*\* \* Support key material export. \*  \* @see <a href="https://tools.ietf.org/html/rfc5705" target="\_blank">RFC 5705</a> \*  \* @since 3.10 \*/ public static final BooleanDefinition DTLS\_SUPPORT\_KEY\_MATERIAL\_EXPORT = new BooleanDefinition( MODULE + "SUPPORT\_KEY\_MATERIAL\_EXPORT", "Support key material export according RFC5705.", false);
 public static final ModuleDefinitionsProvider DEFINITIONS = new ModuleDefinitionsProvider() {
 @Override public String getModule() { return MODULE; }
 @Override public void applyDefinitions(Configuration config) { final int CORES = Runtime.getRuntime().availableProcessors();
 config.set(DTLS\_SESSION\_TIMEOUT, 24, TimeUnit.HOURS); config.set(DTLS\_AUTO\_HANDSHAKE\_TIMEOUT, null, TimeUnit.SECONDS); config.set(DTLS\_RETRANSMISSION\_TIMEOUT, DEFAULT\_RETRANSMISSION\_TIMEOUT\_IN\_MILLISECONDS, TimeUnit.MILLISECONDS); config.set(DTLS\_MAX\_RETRANSMISSION\_TIMEOUT, DEFAULT\_MAX\_RETRANSMISSION\_TIMEOUT\_IN\_MILLISECONDS, TimeUnit.MILLISECONDS); config.set(DTLS\_ADDITIONAL\_ECC\_TIMEOUT, DEFAULT\_ADDITIONAL\_TIMEOUT\_FOR\_ECC\_IN\_MILLISECONDS, TimeUnit.MILLISECONDS); config.set(DTLS\_MAX\_RETRANSMISSIONS, DEFAULT\_MAX\_RETRANSMISSIONS); config.set(DTLS\_RETRANSMISSION\_INIT\_RANDOM, 1.0F); config.set(DTLS\_RETRANSMISSION\_TIMEOUT\_SCALE, 2.0F); config.set(DTLS\_RETRANSMISSION\_BACKOFF, null); config.set(DTLS\_CONNECTION\_ID\_LENGTH, null); config.set(DTLS\_CONNECTION\_ID\_NODE\_ID, null); config.set(DTLS\_SERVER\_USE\_SESSION\_ID, true); config.set(DTLS\_USE\_EARLY\_STOP\_RETRANSMISSION, true); config.set(DTLS\_RECORD\_SIZE\_LIMIT, null); config.set(DTLS\_MAX\_FRAGMENT\_LENGTH, null); config.set(DTLS\_MAX\_FRAGMENTED\_HANDSHAKE\_MESSAGE\_LENGTH, DEFAULT\_MAX\_FRAGMENTED\_HANDSHAKE\_MESSAGE\_LENGTH); config.set(DTLS\_USE\_MULTI\_RECORD\_MESSAGES, null); config.set(DTLS\_USE\_MULTI\_HANDSHAKE\_MESSAGE\_RECORDS, null); config.set(DTLS\_CLIENT\_AUTHENTICATION\_MODE, CertificateAuthenticationMode.NEEDED); config.set(DTLS\_VERIFY\_SERVER\_CERTIFICATES\_SUBJECT, true); config.set(DTLS\_CERTIFICATE\_TYPES, Arrays.asList(CertificateType.RAW\_PUBLIC\_KEY, CertificateType.X\_509)); config.set(DTLS\_ROLE, DtlsRole.BOTH); config.set(DTLS\_MAX\_TRANSMISSION\_UNIT, null); config.set(DTLS\_MAX\_TRANSMISSION\_UNIT\_LIMIT, DEFAULT\_MAX\_TRANSMISSION\_UNIT\_LIMIT); config.set(DTLS\_DEFAULT\_HANDSHAKE\_MODE, null); config.set(DTLS\_MAX\_CONNECTIONS, DEFAULT\_MAX\_CONNECTIONS); config.set(DTLS\_STALE\_CONNECTION\_THRESHOLD, DEFAULT\_STALE\_CONNECTION\_TRESHOLD\_SECONDS, TimeUnit.SECONDS); config.set(DTLS\_MAX\_PENDING\_OUTBOUND\_JOBS, DEFAULT\_MAX\_PENDING\_OUTBOUND\_JOBS); config.set(DTLS\_MAX\_PENDING\_INBOUND\_JOBS, DEFAULT\_MAX\_PENDING\_INBOUND\_JOBS); config.set(DTLS\_MAX\_PENDING\_HANDSHAKE\_RESULT\_JOBS, DEFAULT\_MAX\_PENDING\_HANDSHAKE\_RESULT\_JOBS); config.set(DTLS\_MAX\_DEFERRED\_OUTBOUND\_APPLICATION\_MESSAGES, DEFAULT\_MAX\_DEFERRED\_OUTBOUND\_APPLICATION\_MESSAGES); config.set(DTLS\_MAX\_DEFERRED\_INBOUND\_RECORDS\_SIZE, DEFAULT\_MAX\_DEFERRED\_PROCESSED\_INCOMING\_RECORDS\_SIZE);
 config.set(DTLS\_RECEIVER\_THREAD\_COUNT, CORES > 3 ? 2 : 1); config.set(DTLS\_CONNECTOR\_THREAD\_COUNT, CORES); config.set(DTLS\_RECEIVE\_BUFFER\_SIZE, null); config.set(DTLS\_SEND\_BUFFER\_SIZE, null); config.set(DTLS\_USE\_SERVER\_NAME\_INDICATION, false); config.set(DTLS\_EXTENDED\_MASTER\_SECRET\_MODE, ExtendedMasterSecretMode.ENABLED); config.set(DTLS\_USE\_HELLO\_VERIFY\_REQUEST, true); config.set(DTLS\_USE\_ANTI\_REPLAY\_FILTER, true); config.set(DTLS\_USE\_DISABLED\_WINDOW\_FOR\_ANTI\_REPLAY\_FILTER, 0); config.set(DTLS\_UPDATE\_ADDRESS\_USING\_CID\_ON\_NEWER\_RECORDS, true); config.set(DTLS\_USE\_NEWER\_RECORD\_FILTER, false);[View remainder of file in raw view](https://github.com/eclipse-californium/californium/raw/refs/heads/main/scandium-core/src/main/java/org/eclipse/californium/scandium/config/DtlsConfig.java)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e9edbd2c_20250108_150719.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Ftree%2Fmain%2Fcalifornium-tests%2Fcalifornium-interoperability-tests%2Fsrc%2Ftest%2Fjava%2Forg%2Feclipse%2Fcalifornium%2Finteroperability%2Ftest%2Fopenssl)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Ftree%2Fmain%2Fcalifornium-tests%2Fcalifornium-interoperability-tests%2Fsrc%2Ftest%2Fjava%2Forg%2Feclipse%2Fcalifornium%2Finteroperability%2Ftest%2Fopenssl)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=eclipse-californium%2Fcalifornium)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eclipse-californium](/eclipse-californium)
/
**[californium](/eclipse-californium/californium)**
Public

* [Notifications](/login?return_to=%2Feclipse-californium%2Fcalifornium) You must be signed in to change notification settings
* [Fork
  368](/login?return_to=%2Feclipse-californium%2Fcalifornium)
* [Star
   731](/login?return_to=%2Feclipse-californium%2Fcalifornium)

* [Code](/eclipse-californium/californium)
* [Issues
  16](/eclipse-californium/californium/issues)
* [Pull requests
  0](/eclipse-californium/californium/pulls)
* [Actions](/eclipse-californium/californium/actions)
* [Projects
  0](/eclipse-californium/californium/projects)
* [Wiki](/eclipse-californium/californium/wiki)
* [Security](/eclipse-californium/californium/security)
* [Insights](/eclipse-californium/californium/pulse)

Additional navigation options

* [Code](/eclipse-californium/californium)
* [Issues](/eclipse-californium/californium/issues)
* [Pull requests](/eclipse-californium/californium/pulls)
* [Actions](/eclipse-californium/californium/actions)
* [Projects](/eclipse-californium/californium/projects)
* [Wiki](/eclipse-californium/californium/wiki)
* [Security](/eclipse-californium/californium/security)
* [Insights](/eclipse-californium/californium/pulse)

## Files

 main
## Breadcrumbs

1. [californium](/eclipse-californium/californium/tree/main)
2. /[californium-tests](/eclipse-californium/californium/tree/main/californium-tests)
3. /[californium-interoperability-tests](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests)
4. /[src](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src)
5. /[test](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src/test)
6. /[java](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java)
7. /[org](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java/org)
8. /[eclipse](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse)
9. /[californium](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium)
10. /[interoperability](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability)
11. /[test](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test)
/
# openssl

/
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/eclipse-californium/californium/commits/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl) main
## Breadcrumbs

1. [californium](/eclipse-californium/californium/tree/main)
2. /[californium-tests](/eclipse-californium/californium/tree/main/californium-tests)
3. /[californium-interoperability-tests](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests)
4. /[src](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src)
5. /[test](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src/test)
6. /[java](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java)
7. /[org](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java/org)
8. /[eclipse](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse)
9. /[californium](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium)
10. /[interoperability](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability)
11. /[test](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test)
/
# openssl

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/eclipse-californium/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test) | | |
| [OpenSslClientAuthenticationInteroperabilityTest.java](/eclipse-californium/californium/blob/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl/OpenSslClientAuthenticationInteroperabilityTest.java "OpenSslClientAuthenticationInteroperabilityTest.java") | | [OpenSslClientAuthenticationInteroperabilityTest.java](/eclipse-californium/californium/blob/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl/OpenSslClientAuthenticationInteroperabilityTest.java "OpenSslClientAuthenticationInteroperabilityTest.java") |  |  |
| [OpenSslClientInteroperabilityTest.java](/eclipse-californium/californium/blob/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl/OpenSslClientInteroperabilityTest.java "OpenSslClientInteroperabilityTest.java") | | [OpenSslClientInteroperabilityTest.java](/eclipse-californium/californium/blob/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl/OpenSslClientInteroperabilityTest.java "OpenSslClientInteroperabilityTest.java") |  |  |
| [OpenSslProcessUtil.java](/eclipse-californium/californium/blob/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl/OpenSslProcessUtil.java "OpenSslProcessUtil.java") | | [OpenSslProcessUtil.java](/eclipse-californium/californium/blob/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl/OpenSslProcessUtil.java "OpenSslProcessUtil.java") |  |  |
| [OpenSslServerAuthenticationInteroperabilityTest.java](/eclipse-californium/californium/blob/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl/OpenSslServerAuthenticationInteroperabilityTest.java "OpenSslServerAuthenticationInteroperabilityTest.java") | | [OpenSslServerAuthenticationInteroperabilityTest.java](/eclipse-californium/californium/blob/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl/OpenSslServerAuthenticationInteroperabilityTest.java "OpenSslServerAuthenticationInteroperabilityTest.java") |  |  |
| [OpenSslServerInteroperabilityTest.java](/eclipse-californium/californium/blob/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl/OpenSslServerInteroperabilityTest.java "OpenSslServerInteroperabilityTest.java") | | [OpenSslServerInteroperabilityTest.java](/eclipse-californium/californium/blob/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl/OpenSslServerInteroperabilityTest.java "OpenSslServerInteroperabilityTest.java") |  |  |
| [OpenSslUtil.java](/eclipse-californium/californium/blob/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl/OpenSslUtil.java "OpenSslUtil.java") | | [OpenSslUtil.java](/eclipse-californium/californium/blob/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl/OpenSslUtil.java "OpenSslUtil.java") |  |  |
| View all files | | |

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.eclipse.org_2c38a917_20250108_112936.html ===


[![logo]()](https://www.eclipse.org/)

* [Download](https://www.eclipse.org/downloads/)
* [Getting Started](https://www.eclipse.org/users/)
* [Members](https://www.eclipse.org/membership/)
* [Projects](https://www.eclipse.org/projects/)
* Community
  + [Marketplace](http://marketplace.eclipse.org)
  + [Events](http://events.eclipse.org)
  + [Planet Eclipse](http://www.planeteclipse.org/)
  + [Newsletter](https://www.eclipse.org/community/eclipse_newsletter/)
  + [Videos](https://www.youtube.com/user/EclipseFdn)
* Participate
  + [Report a Bug](https://bugs.eclipse.org/bugs/)
  + [Forums](https://www.eclipse.org/forums/)
  + [Mailing Lists](https://www.eclipse.org/mail/)
  + [Wiki](https://wiki.eclipse.org/)
  + [IRC](https://wiki.eclipse.org/IRC)
  + [How to Contribute](https://www.eclipse.org/contribute/)
* Working Groups
  + [Automotive](http://wiki.eclipse.org/Auto_IWG)
  + [Internet of Things](http://iot.eclipse.org)
  + [LocationTech](http://locationtech.org)
  + [Long-Term Support](http://lts.eclipse.org)
  + [PolarSys](http://polarsys.org)
  + [Science](http://science.eclipse.org)
  + [OpenMDM](http://www.openmdm.org)
* More
  + - **Community**
    - [Marketplace](http://marketplace.eclipse.org)
    - [Events](http://events.eclipse.org)
    - [Planet Eclipse](http://www.planeteclipse.org/)
    - [Newsletter](https://www.eclipse.org/community/eclipse_newsletter/)
    - [Videos](https://www.youtube.com/user/EclipseFdn)
    - **Participate**
    - [Report a Bug](https://bugs.eclipse.org/bugs/)
    - [Forums](https://www.eclipse.org/forums/)
    - [Mailing Lists](https://www.eclipse.org/mail/)
    - [Wiki](https://wiki.eclipse.org/)
    - [IRC](https://wiki.eclipse.org/IRC)
    - [How to Contribute](https://www.eclipse.org/contribute/)
    - **Working Groups**
    - [Automotive](http://wiki.eclipse.org/Auto_IWG)
    - [Internet of Things](http://iot.eclipse.org)
    - [LocationTech](http://locationtech.org)
    - [Long-Term Support](http://lts.eclipse.org)
    - [PolarSys](http://polarsys.org)
    - [Science](http://science.eclipse.org)
    - [OpenMDM](http://www.openmdm.org)

Toggle navigation

[![logo](/eclipse.org-common/themes/solstice/public/images/logo/eclipse-800x188.png)](https://www.eclipse.org/)

Bugzilla – Bug 580018
Denial-of-Service vulnerability in the DTLS stack
Last modified: 2022-07-29 09:24:57 EDT

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=580018&GoAheadAndLogIn=1)

  [x]
| * [Terms of Use](http://www.eclipse.org/legal/termsofuse.php)
| * [Copyright Agent](http://www.eclipse.org/legal/copyright.php)

This Bugzilla instance is deprecated, and most Eclipse projects now use
[GitHub](https://github.com/eclipse) or [Eclipse GitLab](https://gitlab.eclipse.org/eclipse/). Please see the [deprecation plan](https://gitlab.eclipse.org/eclipsefdn/helpdesk/-/wikis/Gerrit/Gerrit-and-Bugzilla-deprecation-and-migration-plan) for details.

[**Bug 580018**](show_bug.cgi?id=580018)
- Denial-of-Service vulnerability in the DTLS stack

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Denial-of-Service vulnerability in the DTLS stack

| | [Status](page.cgi?id=fields.html#bug_status): | NEW | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Californium | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | IoT | | [Component:](describecomponents.cgi?product=Californium "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Scandium ([show other bugs](buglist.cgi?component=Scandium&product=Californium&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified   [Edit](https://dev.eclipse.org/committers/bugs/bugz_manager.php) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | PC Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | P3 normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | ---   [Edit](https://dev.eclipse.org/committers/bugs/bugz_manager.php) | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Security vulnerabilitied reported against Eclipse projects [CLA](https://wiki.eclipse.org/ECA) | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | security | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2022-05-26 06:14 EDT by Nurullah Erinola [CLA](https://wiki.eclipse.org/ECA) | | --- | --- | | Modified: | 2022-07-29 09:24 EDT ([History](show_activity.cgi?id=580018)) | | CC List: | 5 users (show)  achim.kraus code kai.hudalla mikael.barbero wayne.beaton | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [**PCAP file with the interaction**](attachment.cgi?id=288540 "View the content of the attachment") (4.62 KB, application/vnd.tcpdump.pcap)  [2022-05-26 06:14 EDT](#attach_288540 "Go to the comment associated with the attachment"), Nurullah Erinola [CLA](https://wiki.eclipse.org/ECA) | *no flags* | [Details](attachment.cgi?id=288540&action=edit) | | [View All](attachment.cgi?bugid=580018&action=viewall)  [Add an attachment](attachment.cgi?bugid=580018&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=580018&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=580018#c0)  Nurullah Erinola [CLA](https://wiki.eclipse.org/ECA)    2022-05-26 06:14:29 EDT  ``` Created [attachment 288540](attachment.cgi?id=288540 "PCAP file with the interaction") [[details]](attachment.cgi?id=288540&action=edit "PCAP file with the interaction") PCAP file with the interaction  Our systematic analysis of DTLS implementations indicated that your DTLS stack is vulnerable to a Denial-of-Service attack.  Tested build ============ v3.5.0  Affected protocol versions ========================== DTLS 1.2  Expected behavior ================= According to the DTLS 1.2 standard in chapter 4.2.1 [1], the server may respond with a HelloVerifyRequest message when the client sends its ClientHello message.  This mechanism should provide defense against the following two DoS attacks: 1. An attacker can consume excessive resources on the server by transmitting a series of handshake initiation requests, causing the server to allocate state and potentially to perform expensive cryptographic operations. 2. An attacker can use the server as an amplifier by sending connection initiation messages with a forged source of the victim.  The server then sends its next message (in DTLS, a Certificate message, which can be quite large) to the victim machine, thus flooding it.  Observed behavior ================= The DTLS stack does not perform a stateless cookie exchange during session resumption with Session IDs. If the server receives a ClientHello message with a valid Session ID, it responds directly with the ServerHello, ChangeCipherSpec, and Finished messages.  For an attack, an attacker only needs to collect valid Session IDs and then flood the server with ClientHello messages that contain one of the collected parameters.  The main problem here is that an attacker can force the server to send ServerHello, Certificate, ..., ServerHelloDone messages. As a result, the amplification attack is greatly increased.  A properly implemented server should not allow skipping the stateless cookie exchange.  Steps to Reproduce ================== To reproduce the bug, OpenSSL can be used. 1. Launch an server. (We used for out tests the example DTLS server.) 2. Launch the OpenSSL client with: openssl s_client -dtls -connect localhost:4433 -sess_out sess.pem -no_ticket -cipher ECDHE-ECDSA-AES256-GCM-SHA384 3. Close the connection. 4. Launch the OpenSSL client again with: openssl s_client -dtls -connect localhost:4433 -sess_in sess.pem -no_ticket -cipher ECDHE-ECDSA-AES128-GCM-SHA256  The most important point here is that the cipher suite in the second handshake must be different from the negotiated in the first handshake. If everything works as planned, Wireshark should show an interaction similar to that in the attached PCAP files.  Links ===== [1] <https://datatracker.ietf.org/doc/html/rfc6347#section-4.2.1> ```  [Comment 1](show_bug.cgi?id=580018#c1)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-05 06:42:50 EDT  ``` Thanks for reporting this.  I change my e-mail address end of May and was in vacation.  Is see two issues:  - if the server falls back to an full-handshake, it must use the HelloVerifyRequest  - if not, then there have been some discussions about the in the IETF mailing list, see <https://mailarchive.ietf.org/arch/msg/tls/hlW5oeiZ-ZsrThTG2FgrlFhA-8s/> . The outcome of that is to configure the behavior according your requirements. See   <https://github.com/eclipse/californium/blob/main/scandium-core/src/main/java/org/eclipse/californium/scandium/config/DtlsConfig.java#L691>  and   <https://github.com/eclipse/californium/blob/main/demo-apps/cf-plugtest-server/src/main/java/org/eclipse/californium/plugtests/PlugtestServer.java#L142>   how to change the default. ```  [Comment 2](show_bug.cgi?id=580018#c2)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-05 11:57:15 EDT  ``` I prepared a PR to fix it.  <https://github.com/eclipse/californium/pull/2039>  maybe you can retest with that.  I also added your test to   <https://github.com/eclipse/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl>  but I prefer to publish that test after a 3.6 release.  Currently I plan the 3.6 release for end of next week, 14. July. 2022. ```  [Comment 3](show_bug.cgi?id=580018#c3)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-06 08:26:44 EDT  ``` Some questions :   1. Just to be sure, If we set DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD to 0, we are no more affected by this ?  2. Do you plan to create a CVE for this ?  3. I see you plan to release a 3.6 version with a fix, do you plan to do a security fix for 2.x or 2.7.x ? ```  [Comment 4](show_bug.cgi?id=580018#c4)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-06 08:37:18 EDT  ``` > 1. Just to be sure, If we set DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD to 0, we are no more affected by this ?  Yes, with that, the HelloVerifyRequest is always used.  > 2. Do you plan to create a CVE for this ?  I consider it.   > 3. I see you plan to release a 3.6 version with a fix, do you plan to do a security fix for 2.x or 2.7.x ?  The patch uses a new API introduced with 3.x. Therefore it can't be applied to a 2.7.x.directly.  To skip the HelloVerifyRequest was introduced when the resumption handshake was intended to be used for frequent address changes. With RFC9146 it gets less frequently useful. So I think, use a 0 will do it in a 2.7.  Anyway, if you feel, it's important to use it with a 2.7. I will prepare a fix for that as well. ```  [Comment 5](show_bug.cgi?id=580018#c5)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-06 08:49:23 EDT  ``` > Anyway, if you feel, it's important to use it with a 2.7. I will prepare a fix for that as well.  At Sierra we don't use it, so we don't really need it.  But I'm not so comfortable with the idea to have this issue in Leshan 1.x with the default configuration.  Maybe for cf 2.x :   - the default behavior should be set to 0  - if user activate it, a warn about the security issue should be raised ?   (or any other idea ?) ```  [Comment 6](show_bug.cgi?id=580018#c6)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-06 08:53:28 EDT  ``` > (or any other idea ?)  Then fixing it will be easier ;-).  (Changing the defaults isn't that effective, because old "Californium.properties" will keep the old value.) ```  [Comment 7](show_bug.cgi?id=580018#c7)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-06 09:03:37 EDT  ``` > (Changing the defaults isn't that effective, because old "Californium.properties" will keep the old value.)  That's why I propose the warn log in addition.   > Then fixing it will be easier ;-).  If fixing is easy, I'm ok with it too. ```  [Comment 8](show_bug.cgi?id=580018#c8)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-06 13:37:35 EDT  ``` About Californium 2.7:  A ClientHello, which causes in 3.0 a fallback to a full handshake, causes with the 2.7 an Alert "Illegal Parameter".  So affect only 3.0-3.5. ```  [Comment 9](show_bug.cgi?id=580018#c9)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 01:39:28 EDT  ``` CVE:  I would go for <https://cwe.mitre.org/data/definitions/440.html>  In my opinion, the basic idea, that a resumption handshake doesn't require a HelloVerifyRequest because the reply flight is very small and inexpensive, isn't wrong.  But the check, if a resumption or the fallback to a full-handshake is used instead, was wrong. This weakness then caused the vulnerabilities:  - possible amplification (DDoS others) - possible CPU exhausting (Dos affected server)  Any other opinions/proposals? ```  [Comment 10](show_bug.cgi?id=580018#c10)  Kai Hudalla [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 02:41:53 EDT  ``` (In reply to Achim Kraus from [comment #9](show_bug.cgi?id=580018#c9)) > CVE: >  > I would go for <https://cwe.mitre.org/data/definitions/440.html> >  FMPOV <https://cwe.mitre.org/data/definitions/408.html> would be a more specific fit.  > In my opinion, the basic idea, that a resumption handshake doesn't require a > HelloVerifyRequest because the reply flight is very small and inexpensive, > isn't wrong.  I agree  >  > But the check, if a resumption or the fallback to a full-handshake is used > instead, was wrong. This weakness then caused the vulnerabilities: >  > - possible amplification (DDoS others) > - possible CPU exhausting (Dos affected server) >   So, the proposed fix is to ALWAYS send the HelloVerifyRequest when falling back to a full handshake but act according to the value set in DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD otherwise, right? If that is the case then I also agree here :-) ```  [Comment 11](show_bug.cgi?id=580018#c11)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 02:57:47 EDT  ``` I also read the 408, my understanding of it is:  1. "do expensive processing" 2. "do the security check"  With the bug would cause no "security check" (HelloVerifyRequest) at all.   > So, the proposed fix is to ALWAYS send the HelloVerifyRequest when falling back to a full handshake but act according to the value set in DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD otherwise, right?  Yes, that's the proposed fix.  The tricky thing is, that it requires a callback API to implement it. Therefore I introduced "ExtendedResumptionVerifier". The background is, that if the "session-store" (former cache) is a "remote implementation", the processing maybe very specific.  (Just to mention: because hono uses a cluster, I disables the session resumption in hono at all.) ```  [Comment 12](show_bug.cgi?id=580018#c12)  Kai Hudalla [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 03:38:24 EDT  ``` (In reply to Achim Kraus from [comment #11](show_bug.cgi?id=580018#c11)) > I also read the 408, my understanding of it is: >  > 1. "do expensive processing" > 2. "do the security check" >  > With the bug would cause no "security check" (HelloVerifyRequest) at all. >   "The software allows an entity to perform a legitimate but expensive operation before authentication or authorization has taken place."  Isn't that exactly what is happening when falling back to a full handshake without sending the ClientVerifyRequest? ```  [Comment 13](show_bug.cgi?id=580018#c13)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 04:01:49 EDT  ``` > "The software allows an entity to perform a legitimate but expensive operation before authentication or authorization has taken place."  > Isn't that exactly what is happening when falling back to a full handshake without sending the ClientVerifyRequest?  Yes, if "before" also includes "not to authenticate".  "Incorrect Behavior Order" points for me to the order.  Right way:  1. check 2. process  Wrong way:  1. process 2. check  But the bug does:  1. process  (The check isn't done at all. Therefore the misbehavior is not based on the wrong order, its based on the missing check.) ```  [Comment 14](show_bug.cgi?id=580018#c14)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 04:32:12 EDT  ``` > About Californium 2.7:  > A ClientHello, which causes in 3.0 a fallback to a full handshake, causes with > the 2.7 an Alert "Illegal Parameter".  > So affect only 3.0-3.5.   This doesn't really respect the RFC as it should fallback to fullhandshake, right ?   Does it impact opened connection/session attached to this Session ID ? ```  [Comment 15](show_bug.cgi?id=580018#c15)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 04:40:07 EDT  ``` My 2 cts, I also think that <https://cwe.mitre.org/data/definitions/408.html> fit better but maybe I don't understand the issue enough.   About :   > But the bug does: > 1. process   Could we consider that the check after "process" could be the fullhandshake itself ?   By the way, 408 seems to match better for Technical Impacts too.   440 Impact: Quality Degradation; Varies by Context  408 Impacts : DoS: Amplification; DoS: Crash, Exit, or Restart; DoS: Resource Consumption (CPU); DoS: Resource Consumption (Memory) ```  [Comment 16](show_bug.cgi?id=580018#c16)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 05:16:35 EDT  ``` > This doesn't really respect the RFC as it should fallback to fullhandshake, right ?  At least I didn't found something in RFC 5246, except the MUST in  > If the > session_id field is not empty (implying a session resumption > request), this vector MUST include at least the cipher_suite from > that session.  But that doesn't say "fallback" nor "fail".  Only RFC 6066 states for SNI   > A server that implements this extension MUST NOT accept the request > to resume the session if the server_name extension contains a > different name.  Instead, it proceeds with a full handshake to > establish a new session.  therefore I changed the behavior in 3.0. ```  [Comment 17](show_bug.cgi?id=580018#c17)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 05:22:24 EDT  ``` About CWE 408:  I was a little fixed at "server hello, certificate" and "hello verify request". But if I change to:  - check for full handshake - use either "hello verify request"  - or "server hello, certificate"  [- (over simplified, ineffective) check for "hello verify request"]  - use either "hello verify request"  - check for full handshake - "server hello, certificate" or "server hello, server hello done"  Then I guess we can also go for 408. ```  [Comment 18](show_bug.cgi?id=580018#c18)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 05:33:12 EDT  ``` > At least I didn't found something in RFC 5246  I was thinking this part of the spec about :   > If a Session ID match is not >    found, the server generates a new session ID, and the TLS client and >   server perform a full handshake.  (<https://www.rfc-editor.org/rfc/rfc5246#section-7.3>) ```  [Comment 19](show_bug.cgi?id=580018#c19)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 05:40:54 EDT  ``` > If a Session ID match is not found  So that depends on how to interpret "Session ID match". Only the ID? Or also the other parameter? Anyway, though it's a MUST, a violation is always "out of spec". So I don't think, it pays of that much, to change that behavior for 2.7. ```  [Comment 20](show_bug.cgi?id=580018#c20)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 06:05:26 EDT  ``` > So that depends on how to interpret "Session ID match". Only the ID? Or also the other parameter?   For me, it's pretty clear "Session ID" means "Session ID"   >  Anyway, though it's a MUST, a violation is always "out of spec".  I don't get your point. "How a violation is handled" can be part of a spec.  Anyway here this is not a violation, this is just a possible common use case OR I totally missed something. The client tries to resume a session, it send a session ID it want to resume. If server lost the session (for any reason, restart, session lifetime) the handshake turn in full handshak.   If I understand you correctly the behavior in 2.7 is to send an Alert instead of fallback on fullhandshake, correct ?   (You didn't answer about : "Does it impact opened connection/session attached to this Session ID ?" don't know if it's on purpose or just oversight) ```  [Comment 21](show_bug.cgi?id=580018#c21)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 06:17:16 EDT  ``` > I don't get your point. "How a violation is handled" can be part of a spec.  Sure, but, as I wrote, I miss that part explaining, what to do, if the "MUST" in   > If the > session_id field is not empty (implying a session resumption > request), this vector MUST include at least the cipher_suite from > that session.  fails.  Basically, this reported bug does exactly this, it doesn't include the cipher_suite and so breaks the MUST. ```  [Comment 22](show_bug.cgi?id=580018#c22)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 06:21:07 EDT  ``` > Anyway here this is not a violation, this is just a possible common use case OR I totally missed something. > The client tries to resume a session, it send a session ID it want to resume. If server lost the session (for any reason, restart, session lifetime) the handshake turn in full handshak.  No, only in the cases, where the cipher_suite or compression_method doesn't comply to MUST. In the "common case", where the session for the session ID is missing, the 2.7 falls back to the full-handshake. (You may verify that on your own and there are some unit tests to ensure that.) ```  [Comment 23](show_bug.cgi?id=580018#c23)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 06:23:50 EDT  ``` > (You didn't answer about : "Does it impact opened connection/session attached to this Session ID ?" don't know if it's on purpose or just oversight)  Oversight.  If there is an other session on that "unverified address resuming address", scandium uses a "HelloVerifyRequest". ```  [Comment 24](show_bug.cgi?id=580018#c24)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 07:28:17 EDT  ``` 2.7:  I think, if that attack uses a SNI change, the attack will work as well with a 2.7. ;-(.  Unfortunately, there is much more to do for 3.6 (and tinydtls), so I guess, the fix for 2.7 must wait until end of July. ```  [Comment 25](show_bug.cgi?id=580018#c25)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 08:28:47 EDT  ``` > Basically, this reported bug does exactly this, it doesn't include the cipher_suite and so breaks the MUST.  OK I missed this part about different cipher_suite.  And so I understand now why you say RFC doesn't define the behavior.  I guess in that case an ALERT could be OK. ```  [Comment 26](show_bug.cgi?id=580018#c26)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-11 06:18:19 EDT  ``` Project name: Eclipse Californium  Versions affected: [2.0.0, 2.7.2] and [3.0.0, 3.5.0]  Common Weakness Enumeration:  - CWE-408: Incorrect Behavior Order: Early Amplification  Summary:  In Eclipse Californium version 2.0.0 to 2.7.2 and 3.0.0-3.5.0 a resumption handshake falls back to a full handshake on a parameter mismatch without using a HelloVerifyRequest. Especially, if used with certificated based cipher suites, that results in message amplification (DDoS other peers) and high CPU load (DoS peer).  Links:  - <https://bugs.eclipse.org/580018> ```  [Comment 27](show_bug.cgi?id=580018#c27)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-11 06:20:51 EDT  ``` @Simon @Kai  please check, if that description is OK for you.  For 3.6.0 the PR with the fix is already merged to main. For 2.7.x the PR #2041 is pending.  If no objection or other preferred schedules, I would like to release  2.7.3 on Wednesday 13. July 3.6.0 on Thursday  14. July ```  [Comment 28](show_bug.cgi?id=580018#c28)  Kai Hudalla [CLA](https://wiki.eclipse.org/ECA)    2022-07-11 06:51:34 EDT  ``` (In reply to Achim Kraus from [comment #26](show_bug.cgi?id=580018#c26)) > Project name: Eclipse Californium >  > Versions affected: [2.0.0, 2.7.2] and [3.0.0, 3.5.0] >  > Common Weakness Enumeration: >  > - CWE-408: Incorrect Behavior Order: Early Amplification >  > Summary: >  > In Eclipse Californium version 2.0.0 to 2.7.2 and 3.0.0-3.5.0 a resumption > handshake falls back to a full handshake on a parameter mismatch without > using a HelloVerifyRequest. Especially, if used with certificated based > cipher suites, that results in message amplification (DDoS other peers) and > high CPU load (DoS peer). >  > Links: >  > - <https://bugs.eclipse.org/580018>  Just a small typo  > Especially, if used with certificate based ... ```  [Comment 29](show_bug.cgi?id=580018#c29)  Kai Hudalla [CLA](https://wiki.eclipse.org/ECA)    2022-07-11 06:52:02 EDT  ``` (In reply to Achim Kraus from [comment #27](show_bug.cgi?id=580018#c27)) > @Simon > @Kai >  > please check, if that description is OK for you. >  > For 3.6.0 the PR with the fix is already merged to main. > For 2.7.x the PR #2041 is pending. >  > If no objection or other preferred schedules, I would like to release >  > 2.7.3 on Wednesday 13. July > 3.6.0 on Thursday  14. July  Sounds good to me. Thanks for handling this vulnerability, Achim :-) ```  [Comment 30](show_bug.cgi?id=580018#c30)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-11 08:50:36 EDT  ``` LGTM, Except maybe :   I understand that this security issue only concerns users who are using DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD > 0.  If you think this is still true, I think this could be a good addition to say something about this. (just to let user know if there are concerned and also that they can use this workaround instead of upgrade) ```  [Comment 31](show_bug.cgi?id=580018#c31)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-11 08:56:34 EDT  ``` Project name: Eclipse Californium  Versions affected: [2.0.0, 2.7.2] and [3.0.0, 3.5.0]  Common Weakness Enumeration:  - CWE-408: Incorrect Behavior Order: Early Amplification  Summary:  In Eclipse Californium version 2.0.0 to 2.7.2 and 3.0.0-3.5.0 a DTLS resumption handshake falls back to a DTLS full handshake on a parameter mismatch without using a HelloVerifyRequest. Especially, if used with certificate based cipher suites, that results in message amplification (DDoS other peers) and high CPU load (DoS own peer). The misbehavior occurs only with DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD values larger than 0.    Links:  - <https://bugs.eclipse.org/580018> ```  [Comment 32](show_bug.cgi?id=580018#c32)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-11 09:04:50 EDT  ``` LGTM ```  [Comment 33](show_bug.cgi?id=580018#c33)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-14 08:04:05 EDT  ``` The fix is now successfully released with 2.7.3 and 3.6.0.  @Simon  Do you plan to provide Leshan releases as well? If not, then I would ask Wayne (or Mikael) to publish the CVE next week. ```  [Comment 34](show_bug.cgi?id=580018#c34)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-18 05:42:07 EDT  ``` > Do you plan to provide Leshan releases as well?  I don't know yet because there is nothing to release for Leshan 1.x except update the californium dependency.  I'm still a bit frustrated with the way maven handle version dependency because I feel this is not so clean to have strict defined version dependency for a library...  I remember when I was coding eclipse plugins, the way dependencies was managed was really cleaner. You can say "my plugin depends on given plugin v1.2 or later" so you depends to a version of API and bug fix release is handle by each project.    > If not, then I would ask Wayne (or Mikael) to publish the CVE next week.  Yes please do it, don't wait for us. ```  [Comment 35](show_bug.cgi?id=580018#c35)  Kai Hudalla [CLA](https://wiki.eclipse.org/ECA)    2022-07-18 07:37:21 EDT  ``` (In reply to Simon Bernard from [comment #34](show_bug.cgi?id=580018#c34)) >  > I'm still a bit frustrated with the way maven handle version dependency > because I feel this is not so clean to have strict defined version > dependency for a library... >  > I remember when I was coding eclipse plugins, the way dependencies was > managed was really cleaner. You can say "my plugin depends on given plugin > v1.2 or later" so you depends to a version of API and bug fix release is > handle by each project. >   you should be able to do that with Maven as well if I am not mistaken:  <https://books.sonatype.com/mvnref-book/reference/pom-relationships-sect-project-dependencies.html#pom-relationships-sect-version-ranges> ```  [Comment 36](show_bug.cgi?id=580018#c36)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-18 08:55:59 EDT  ``` @Kai, Thx for sharing this. 🙏  I was aware about this but I had the vague memory that it was not advised or even deprecated to use it with Maven. (I don't remember why I thought this 🤦...)  Maybe I should give it a try.  Do you guys already use it ? any feedbacks ? (or maybe reason why you don't use it) ```  [Comment 37](show_bug.cgi?id=580018#c37)  Kai Hudalla [CLA](https://wiki.eclipse.org/ECA)    2022-07-18 09:37:32 EDT  ``` (In reply to Simon Bernard from [comment #36](show_bug.cgi?id=580018#c36)) > @Kai, Thx for sharing this. 🙏  > Maybe I should give it a try. >  > Do you guys already use it ? any feedbacks ? (or maybe reason why you don't > use it)  I am currently not using this but for no particular reason. There is one thing that IMHO needs to be considered: not every third party dependency uses semantic versioning or if it claims to do so, actually implements the semantics correctly and reliably. So, in many cases you will need to test manually with every new (minor) version and if you need to do that anyway, specifying a version range for a dependency doesn't seem beneficial or appropriate at all. ```  [Comment 38](show_bug.cgi?id=580018#c38)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-19 03:29:10 EDT  ``` @Wayne @Mikael  from my side the team agreed on having a CVE created with: ------------------------------------------- Project name: Eclipse Californium  Versions affected: [2.0.0, 2.7.2] and [3.0.0, 3.5.0]  Common Weakness Enumeration:  - CWE-408: Incorrect Behavior Order: Early Amplification  Summary:  In Eclipse Californium version 2.0.0 to 2.7.2 and 3.0.0-3.5.0 a DTLS resumption handshake falls back to a DTLS full handshake on a parameter mismatch without using a HelloVerifyRequest. Especially, if used with certificate based cipher suites, that results in message amplification (DDoS other peers) and high CPU load (DoS own peer). The misbehavior occurs only with DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD values larger than 0.    Links:  - <https://bugs.eclipse.org/580018> -------------------------------------------  If nothing is missing, please create it. ```  [Comment 39](show_bug.cgi?id=580018#c39)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-26 03:57:52 EDT  ``` I released :  - leshan v1.4.1 with californium v2.7.3 - leshan v2.0.0-M8 with californium v3.6.0 ```  [Comment 40](show_bug.cgi?id=580018#c40)  Mikaël Barbero [CLA](https://wiki.eclipse.org/ECA)    2022-07-29 07:54:06 EDT  ``` I'm on it. ```  [Comment 41](show_bug.cgi?id=580018#c41)  Mikaël Barbero [CLA](https://wiki.eclipse.org/ECA)    2022-07-29 08:39:29 EDT  ``` I've submitted <https://github.com/CVEProject/cvelist/pull/6693>, but it's not yet merged as my account is still under verification. I will keep you posted as soon as it's done. ```  [Comment 42](show_bug.cgi?id=580018#c42)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-29 08:43:54 EDT  ``` Thanks for the update! ```  [Comment 43](show_bug.cgi?id=580018#c43)  Mikaël Barbero [CLA](https://wiki.eclipse.org/ECA)    2022-07-29 09:24:57 EDT  ``` CVE has been merged, you should be all set to socialize about CVE-2022-2576. It will appear soon at <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2576> ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=580018)
* - [XML](show_bug.cgi?ctype=xml&id=580018)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=580018)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=580018&GoAheadAndLogIn=1)

    [x]
  | + [Terms of Use](http://www.eclipse.org/legal/termsofuse.php)
  | + [Copyright Agent](http://www.eclipse.org/legal/copyright.php)



=== Content from github.com_4f04f875_20250108_150720.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCVEProject%2Fcvelist%2Fpull%2F6693)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCVEProject%2Fcvelist%2Fpull%2F6693)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=CVEProject%2Fcvelist)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[CVEProject](/CVEProject)
/
**[cvelist](/CVEProject/cvelist)**
Public

* [Notifications](/login?return_to=%2FCVEProject%2Fcvelist) You must be signed in to change notification settings
* [Fork
  744](/login?return_to=%2FCVEProject%2Fcvelist)
* [Star
   1.4k](/login?return_to=%2FCVEProject%2Fcvelist)

* [Code](/CVEProject/cvelist)
* [Pull requests
  14](/CVEProject/cvelist/pulls)
* [Discussions](/CVEProject/cvelist/discussions)
* [Actions](/CVEProject/cvelist/actions)
* [Projects
  0](/CVEProject/cvelist/projects)
* [Security](/CVEProject/cvelist/security)
* [Insights](/CVEProject/cvelist/pulse)

Additional navigation options

* [Code](/CVEProject/cvelist)
* [Pull requests](/CVEProject/cvelist/pulls)
* [Discussions](/CVEProject/cvelist/discussions)
* [Actions](/CVEProject/cvelist/actions)
* [Projects](/CVEProject/cvelist/projects)
* [Security](/CVEProject/cvelist/security)
* [Insights](/CVEProject/cvelist/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FCVEProject%2Fcvelist%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FCVEProject%2Fcvelist%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# CVE-2022-2576 #6693

 Merged

[cve-team](/cve-team)
merged 1 commit into
[CVEProject:master](/CVEProject/cvelist/tree/master "CVEProject/cvelist:master")
from
[mbarbero:master](/mbarbero/cvelist/tree/master "mbarbero/cvelist:master")

Jul 29, 2022

 Merged

# [CVE-2022-2576](#top) #6693

[cve-team](/cve-team)
merged 1 commit into
[CVEProject:master](/CVEProject/cvelist/tree/master "CVEProject/cvelist:master")
from
[mbarbero:master](/mbarbero/cvelist/tree/master "mbarbero/cvelist:master")

Jul 29, 2022

[Conversation
1](/CVEProject/cvelist/pull/6693)
[Commits
1](/CVEProject/cvelist/pull/6693/commits)
[Checks
0](/CVEProject/cvelist/pull/6693/checks)
[Files changed](/CVEProject/cvelist/pull/6693/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![mbarbero](https://avatars.githubusercontent.com/u/452625?s=60&v=4)](/mbarbero)

Copy link

Contributor

### @mbarbero **[mbarbero](/mbarbero)** commented [Jul 29, 2022](#issue-1322188392)

Signed-off-by: Mikaël Barbero mikael.barbero@eclipse-foundation.org

Sorry, something went wrong.

All reactions

[![@mbarbero](https://avatars.githubusercontent.com/u/452625?s=40&v=4)](/mbarbero)

`[CVE-2022-2576](https://github.com/advisories/GHSA-qq3j-44gw-cf6r "CVE-2022-2576")`
 …

`[b6a39e1](/CVEProject/cvelist/pull/6693/commits/b6a39e1c285c6a736765bc27d4266046a27bb61b)`

```
Signed-off-by: Mikaël Barbero <mikael.barbero@eclipse-foundation.org>
```

 [![@mbarbero](https://avatars.githubusercontent.com/u/452625?s=40&u=d1980820593e3123346e10468da061ff5dedbb65&v=4)](/mbarbero)
[mbarbero](/mbarbero)
requested a review
from [cve-team](/cve-team)
as a [code owner](/CVEProject/cvelist/blob/94e68652e8145e463770fc2aa598b77a85e059e8/CODEOWNERS#L2)
[July 29, 2022 12:28](#event-7089071322)

[![@cve-team](https://avatars.githubusercontent.com/u/32679304?s=80&u=49629a2f17411c2dd63eeb03a4539027bced128d&v=4)](/cve-team)

Copy link

Collaborator

### **[cve-team](/cve-team)** commented [Jul 29, 2022](#issuecomment-1199221357)

| mbarbero is not recognized currently as an account participating in the Git Pilot. To ensure timely processing of your pull request, please contact the CVE Team using either the CVE Request web form (<https://cveform.mitre.org/>) or an email (cve@mitre.org) and confirm your identity. |
| --- |

All reactions

Sorry, something went wrong.

[![@cve-team](https://avatars.githubusercontent.com/u/32679304?s=40&u=49629a2f17411c2dd63eeb03a4539027bced128d&v=4)](/cve-team)
[cve-team](/cve-team)
added
the
[accepted](/CVEProject/cvelist/labels/accepted)
label
[Jul 29, 2022](#event-7089429664)

[![@cve-team](https://avatars.githubusercontent.com/u/32679304?s=40&u=49629a2f17411c2dd63eeb03a4539027bced128d&v=4)](/cve-team)
[cve-team](/cve-team)
merged commit [`6808409`](/CVEProject/cvelist/commit/680840931ce703926a5e960427f3f46dcef0cf88)
into
CVEProject:master

[Jul 29, 2022](https://github.com/CVEProject/cvelist/pull/6693#event-7089431754)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FCVEProject%2Fcvelist%2Fpull%2F6693)

Reviewers

[![@cve-team](https://avatars.githubusercontent.com/u/32679304?s=40&v=4)](/cve-team) [cve-team](/cve-team)

 Awaiting requested review from cve-team

 cve-team is a code owner

Assignees

No one assigned

Labels

[accepted](/CVEProject/cvelist/labels/accepted)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@mbarbero](https://avatars.githubusercontent.com/u/452625?s=52&v=4)](/mbarbero) [![@cve-team](https://avatars.githubusercontent.com/u/32679304?s=52&v=4)](/cve-team)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_02b25cc1_20250108_150722.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Fblob%2Fmain%2Fdemo-apps%2Fcf-plugtest-server%2Fsrc%2Fmain%2Fjava%2Forg%2Feclipse%2Fcalifornium%2Fplugtests%2FPlugtestServer.java)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Fblob%2Fmain%2Fdemo-apps%2Fcf-plugtest-server%2Fsrc%2Fmain%2Fjava%2Forg%2Feclipse%2Fcalifornium%2Fplugtests%2FPlugtestServer.java)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=eclipse-californium%2Fcalifornium)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eclipse-californium](/eclipse-californium)
/
**[californium](/eclipse-californium/californium)**
Public

* [Notifications](/login?return_to=%2Feclipse-californium%2Fcalifornium) You must be signed in to change notification settings
* [Fork
  368](/login?return_to=%2Feclipse-californium%2Fcalifornium)
* [Star
   731](/login?return_to=%2Feclipse-californium%2Fcalifornium)

* [Code](/eclipse-californium/californium)
* [Issues
  16](/eclipse-californium/californium/issues)
* [Pull requests
  0](/eclipse-californium/californium/pulls)
* [Actions](/eclipse-californium/californium/actions)
* [Projects
  0](/eclipse-californium/californium/projects)
* [Wiki](/eclipse-californium/californium/wiki)
* [Security](/eclipse-californium/californium/security)
* [Insights](/eclipse-californium/californium/pulse)

Additional navigation options

* [Code](/eclipse-californium/californium)
* [Issues](/eclipse-californium/californium/issues)
* [Pull requests](/eclipse-californium/californium/pulls)
* [Actions](/eclipse-californium/californium/actions)
* [Projects](/eclipse-californium/californium/projects)
* [Wiki](/eclipse-californium/californium/wiki)
* [Security](/eclipse-californium/californium/security)
* [Insights](/eclipse-californium/californium/pulse)

## Files

 main
## Breadcrumbs

1. [californium](/eclipse-californium/californium/tree/main)
2. /[demo-apps](/eclipse-californium/californium/tree/main/demo-apps)
3. /[cf-plugtest-server](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server)
4. /[src](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server/src)
5. /[main](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server/src/main)
6. /[java](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server/src/main/java)
7. /[org](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server/src/main/java/org)
8. /[eclipse](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server/src/main/java/org/eclipse)
9. /[californium](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server/src/main/java/org/eclipse/californium)
10. /[plugtests](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server/src/main/java/org/eclipse/californium/plugtests)
/
# PlugtestServer.java

 Blame  Blame
## Latest commit

## History

[History](/eclipse-californium/californium/commits/main/demo-apps/cf-plugtest-server/src/main/java/org/eclipse/californium/plugtests/PlugtestServer.java)executable file·740 lines (657 loc) · 25.6 KB main
## Breadcrumbs

1. [californium](/eclipse-californium/californium/tree/main)
2. /[demo-apps](/eclipse-californium/californium/tree/main/demo-apps)
3. /[cf-plugtest-server](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server)
4. /[src](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server/src)
5. /[main](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server/src/main)
6. /[java](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server/src/main/java)
7. /[org](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server/src/main/java/org)
8. /[eclipse](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server/src/main/java/org/eclipse)
9. /[californium](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server/src/main/java/org/eclipse/californium)
10. /[plugtests](/eclipse-californium/californium/tree/main/demo-apps/cf-plugtest-server/src/main/java/org/eclipse/californium/plugtests)
/
# PlugtestServer.java

Top
## File metadata and controls

* Code
* Blame

executable file·740 lines (657 loc) · 25.6 KB[Raw](https://github.com/eclipse-californium/californium/raw/refs/heads/main/demo-apps/cf-plugtest-server/src/main/java/org/eclipse/californium/plugtests/PlugtestServer.java)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705706707708709710711712713714715716717718719720721722723724725726727728729730731732733734735736737738739740/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* \* Copyright (c) 2015, 2017 Institute for Pervasive Computing, ETH Zurich and others. \*  \* All rights reserved. This program and the accompanying materials \* are made available under the terms of the Eclipse Public License v2.0 \* and Eclipse Distribution License v1.0 which accompany this distribution. \*  \* The Eclipse Public License is available at \* http://www.eclipse.org/legal/epl-v20.html \* and the Eclipse Distribution License is available at \* http://www.eclipse.org/org/documents/edl-v10.html. \*  \* Contributors: \* Matthias Kovatsch - creator and main architect \* Achim Kraus (Bosch Software Innovations GmbH) - add TCP and encryption support. \* Bosch Software Innovations GmbH - migrate to SLF4J \* Achim Kraus (Bosch Software Innovations GmbH) - split creating connectors into \* AbstractTestServer. \* Achim Kraus (Bosch Software Innovations GmbH) - use special properties file \* for configuration \* Rikard Höglund (RISE) - OSCORE support  \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/package org.eclipse.californium.plugtests;
import java.io.BufferedReader;import java.io.ByteArrayInputStream;import java.io.ByteArrayOutputStream;import java.io.File;import java.io.IOException;import java.io.InputStreamReader;import java.net.SocketException;import java.util.ArrayList;import java.util.Arrays;import java.util.HashMap;import java.util.List;import java.util.Map;import java.util.Queue;import java.util.concurrent.ConcurrentLinkedQueue;import java.util.concurrent.CopyOnWriteArrayList;import java.util.concurrent.TimeUnit;
import javax.crypto.SecretKey;
import org.eclipse.californium.core.CoapServer;import org.eclipse.californium.core.coap.CoAP.Type;import org.eclipse.californium.core.config.CoapConfig;import org.eclipse.californium.core.server.resources.MyIpResource;import org.eclipse.californium.cose.AlgorithmID;import org.eclipse.californium.elements.config.CertificateAuthenticationMode;import org.eclipse.californium.elements.config.Configuration;import org.eclipse.californium.elements.config.Configuration.DefinitionsProvider;import org.eclipse.californium.elements.config.SystemConfig;import org.eclipse.californium.elements.config.TcpConfig;import org.eclipse.californium.elements.config.TimeDefinition;import org.eclipse.californium.elements.config.UdpConfig;import org.eclipse.californium.elements.config.ValueException;import org.eclipse.californium.elements.util.Bytes;import org.eclipse.californium.elements.util.EncryptedPersistentComponentUtil;import org.eclipse.californium.elements.util.ExecutorsUtil;import org.eclipse.californium.elements.util.NamedThreadFactory;import org.eclipse.californium.elements.util.NetworkInterfacesUtil.InetAddressFilter;import org.eclipse.californium.elements.util.NetworkInterfacesUtil.SimpleInetAddressFilter;import org.eclipse.californium.elements.util.ProtocolScheduledExecutorService;import org.eclipse.californium.elements.util.StringUtil;import org.eclipse.californium.oscore.HashMapCtxDB;import org.eclipse.californium.oscore.OSCoreCoapStackFactory;import org.eclipse.californium.oscore.OSCoreCtx;import org.eclipse.californium.oscore.OSException;import org.eclipse.californium.plugtests.resources.Create;import org.eclipse.californium.plugtests.resources.DefaultTest;import org.eclipse.californium.plugtests.resources.Echo;import org.eclipse.californium.plugtests.resources.Hono;import org.eclipse.californium.plugtests.resources.Large;import org.eclipse.californium.plugtests.resources.LargeCreate;import org.eclipse.californium.plugtests.resources.LargePost;import org.eclipse.californium.plugtests.resources.LargeSeparate;import org.eclipse.californium.plugtests.resources.LargeUpdate;import org.eclipse.californium.plugtests.resources.Link1;import org.eclipse.californium.plugtests.resources.Link2;import org.eclipse.californium.plugtests.resources.Link3;import org.eclipse.californium.plugtests.resources.LocationQuery;import org.eclipse.californium.plugtests.resources.LongPath;import org.eclipse.californium.plugtests.resources.MultiFormat;import org.eclipse.californium.plugtests.resources.MyContext;import org.eclipse.californium.plugtests.resources.Observe;import org.eclipse.californium.plugtests.resources.ObserveLarge;import org.eclipse.californium.plugtests.resources.ObserveNon;import org.eclipse.californium.plugtests.resources.ObservePumping;import org.eclipse.californium.plugtests.resources.ObserveReset;import org.eclipse.californium.plugtests.resources.Oscore;import org.eclipse.californium.plugtests.resources.OscoreInfo;import org.eclipse.californium.plugtests.resources.Path;import org.eclipse.californium.plugtests.resources.Query;import org.eclipse.californium.plugtests.resources.Separate;import org.eclipse.californium.plugtests.resources.Shutdown;import org.eclipse.californium.plugtests.resources.Validate;import org.eclipse.californium.scandium.config.DtlsConfig;import org.eclipse.californium.scandium.dtls.cipher.CipherSuite;import org.eclipse.californium.scandium.util.SecretUtil;import org.eclipse.californium.unixhealth.NetSocketHealthLogger;import org.eclipse.californium.unixhealth.NetStatLogger;import org.slf4j.Logger;import org.slf4j.LoggerFactory;
import picocli.CommandLine;import picocli.CommandLine.ArgGroup;import picocli.CommandLine.Command;import picocli.CommandLine.Option;import picocli.CommandLine.ParameterException;import picocli.CommandLine.ParseResult;
// ETSI Plugtest environment//import java.net.InetSocketAddress;//import org.eclipse.californium.core.network.CoAPEndpoint;
/\*\* \* The class PlugtestServer implements the test specification for the ETSI IoT \* CoAP Plugtests, London, UK, 7--9 Mar 2014. \*/public class PlugtestServer extends AbstractTestServer {
 /\*\* \* @since 3.10 \*/ private static final Logger LOGGER = LoggerFactory.getLogger(CoapServer.class);
 static { CoapConfig.register(); UdpConfig.register(); DtlsConfig.register(); TcpConfig.register(); System.setProperty("COAP\_ROOT\_RESOURCE\_NOTE", "Note: the data sent to this server is public visible to other\n" + " users! Don't send data, which requires data privacy."); }
 private static final File CONFIG\_FILE = new File("CaliforniumPlugtest3.properties"); private static final String CONFIG\_HEADER = "Californium CoAP Properties file for Plugtest Server"; private static final int DEFAULT\_MAX\_RESOURCE\_SIZE = 8192; private static final int DEFAULT\_BLOCK\_SIZE = 64; private static final int DEFAULT\_NOTIFY\_INTERVAL\_MILLIS = 5000; private static final int MINIMUM\_NOTIFY\_INTERVAL\_MILLIS = 5;
 // exit codes for runtime errors public static final int ERR\_INIT\_FAILED = 1;
 public static final List<CipherSuite> PRESELECTED\_CIPHER\_SUITES = Arrays.asList( CipherSuite.TLS\_PSK\_WITH\_AES\_128\_CCM\_8, CipherSuite.TLS\_ECDHE\_PSK\_WITH\_AES\_128\_CCM\_8\_SHA256, CipherSuite.TLS\_ECDHE\_ECDSA\_WITH\_AES\_128\_CCM\_8, CipherSuite.TLS\_PSK\_WITH\_AES\_128\_CBC\_SHA256, CipherSuite.TLS\_ECDHE\_PSK\_WITH\_AES\_128\_CBC\_SHA256, CipherSuite.TLS\_ECDHE\_ECDSA\_WITH\_AES\_128\_CBC\_SHA256, CipherSuite.TLS\_PSK\_WITH\_AES\_128\_GCM\_SHA256, CipherSuite.TLS\_ECDHE\_ECDSA\_WITH\_AES\_128\_GCM\_SHA256, CipherSuite.TLS\_ECDHE\_RSA\_WITH\_AES\_128\_GCM\_SHA256, CipherSuite.TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256);
 private static DefinitionsProvider DEFAULTS = new DefinitionsProvider() {
 @Override public void applyDefinitions(Configuration config) { config.set(SystemConfig.HEALTH\_STATUS\_INTERVAL, 300, TimeUnit.SECONDS); config.set(CoapConfig.MAX\_RESOURCE\_BODY\_SIZE, DEFAULT\_MAX\_RESOURCE\_SIZE); config.set(CoapConfig.MAX\_MESSAGE\_SIZE, DEFAULT\_BLOCK\_SIZE); config.set(CoapConfig.PREFERRED\_BLOCK\_SIZE, DEFAULT\_BLOCK\_SIZE); config.set(CoapConfig.NOTIFICATION\_CHECK\_INTERVAL\_COUNT, 4); config.set(CoapConfig.NOTIFICATION\_CHECK\_INTERVAL\_TIME, 30, TimeUnit.SECONDS); config.set(CoapConfig.TCP\_NUMBER\_OF\_BULK\_BLOCKS, 1); config.set(CoapConfig.MAX\_ACTIVE\_PEERS, 10000); config.set(DtlsConfig.DTLS\_RECOMMENDED\_CIPHER\_SUITES\_ONLY, false); config.set(DtlsConfig.DTLS\_AUTO\_HANDSHAKE\_TIMEOUT, null, TimeUnit.SECONDS); config.set(DtlsConfig.DTLS\_CONNECTION\_ID\_LENGTH, 6); config.set(DtlsConfig.DTLS\_PRESELECTED\_CIPHER\_SUITES, PRESELECTED\_CIPHER\_SUITES); config.set(DtlsConfig.DTLS\_MAX\_CONNECTIONS, 10000); config.set(DtlsConfig.DTLS\_REMOVE\_STALE\_DOUBLE\_PRINCIPALS, false); config.set(DtlsConfig.DTLS\_MAC\_ERROR\_FILTER\_QUIET\_TIME, 4, TimeUnit.SECONDS); config.set(DtlsConfig.DTLS\_MAC\_ERROR\_FILTER\_THRESHOLD, 8); config.set(DtlsConfig.DTLS\_RETRANSMISSION\_TIMEOUT, 3, TimeUnit.SECONDS); config.set(DtlsConfig.DTLS\_ADDITIONAL\_ECC\_TIMEOUT, 8, TimeUnit.SECONDS); config.set(TcpConfig.TCP\_CONNECT\_TIMEOUT, 15, TimeUnit.SECONDS); config.set(TcpConfig.TCP\_CONNECTION\_IDLE\_TIMEOUT, 60, TimeUnit.MINUTES); config.set(TcpConfig.TLS\_HANDSHAKE\_TIMEOUT, 60, TimeUnit.SECONDS); config.set(EXTERNAL\_UDP\_MAX\_MESSAGE\_SIZE, 64); config.set(EXTERNAL\_UDP\_PREFERRED\_BLOCK\_SIZE, 64); config.set(UDP\_DROPS\_READ\_INTERVAL, 2000, TimeUnit.MILLISECONDS); } };
 public static class BaseConfig {
 @Option(names = { "-h", "--help" }, usageHelp = true, description = "display a help message") public boolean helpRequested;
 @Option(names = "--no-loopback", negatable = true, description = "enable endpoints on loopback network.") public boolean loopback = true;
 @Option(names = "--no-external", negatable = true, description = "enable endpoints on external network.") public boolean external = true;
 @Option(names = "--no-ipv4", negatable = true, description = "enable endpoints for ipv4.") public boolean ipv4 = true;
 @Option(names = "--no-ipv6", negatable = true, description = "enable endpoints for ipv6.") public boolean ipv6 = true;
 @Option(names = "--no-tcp", negatable = true, description = "enable endpoints for tcp.") public boolean tcp = true;
 @Option(names = "--dtls-only", description = "only dtls endpoints.") public boolean onlyDtls;
 @Option(names = "--trust-all", description = "trust all valid certificates.") public boolean trustall;
 @Option(names = "--client-auth", description = "client authentication. Values ${COMPLETION-CANDIDATES}.") public CertificateAuthenticationMode clientAuth;
 @Option(names = "--interfaces-pattern", split = ",", description = "interface regex patterns for endpoints.") public List<String> interfacePatterns;
 @Option(names = "--echo-delay", negatable = true, description = "enable delay option for echo resource.") public boolean echoDelay;
 @Option(names = "--no-oscore", negatable = true, description = "use OSCORE.") public boolean oscore = true;
 @Option(names = "--notify-interval", description = "Interval for plugtest notifies. e.g. 5[s]. Minimum " + MINIMUM\_NOTIFY\_INTERVAL\_MILLIS + "[ms], default " + DEFAULT\_NOTIFY\_INTERVAL\_MILLIS + "[ms].") public String notifyInterval;
 @ArgGroup(exclusive = false) public Store store;
 public static class Store {
 @Option(names = "--store-file", required = true, description = "file store dtls state.") public String file;
 @Option(names = "--store-password64", required = false, description = "password to store dtls state. base 64 encoded.") public String password64;
 @Option(names = "--store-max-age", required = true, description = "maximum age of connections in hours.") public Integer maxAge; }
 @Option(names = "--psk-file", description = "file with PSK credentials. id=secret-base64.") public String pskFile;
 public List<Protocol> getProtocols() { List<Protocol> protocols = new ArrayList<>(); protocols.add(Protocol.DTLS); if (!onlyDtls) { protocols.add(Protocol.UDP); if (tcp) { protocols.add(Protocol.TCP); protocols.add(Protocol.TLS); } } else { tcp = false; } return protocols; }
 public List<InterfaceType> getInterfaceTypes() { List<InterfaceType> types = new ArrayList<InterfaceType>(); if (external) { types.add(InterfaceType.EXTERNAL); } if (loopback) { types.add(InterfaceType.LOCAL); } int s = types.size(); if (s == 0) { System.err.println("Either --loopback or --external must be enabled!"); System.exit(1); } if (ipv6) { types.add(InterfaceType.IPV6); } if (ipv4) { types.add(InterfaceType.IPV4); } if (s == types.size()) { System.err.println("Either --ipv4 or --ipv6 must be enabled!"); } return types; }
 public InetAddressFilter getFilter(String tag) { if (interfacePatterns == null || interfacePatterns.isEmpty()) { return new SimpleInetAddressFilter(tag, external, loopback, ipv4, ipv6); } else { String[] patterns = new String[interfacePatterns.size()]; patterns = interfacePatterns.toArray(patterns); return new SimpleInetAddressFilter(tag, external, loopback, ipv4, ipv6, patterns); } }
 public long getNotifyIntervalMillis() { long notifyIntervalMillis = DEFAULT\_NOTIFY\_INTERVAL\_MILLIS; if (notifyInterval != null) { try { notifyIntervalMillis = TimeUnit.NANOSECONDS.toMillis(TimeDefinition.parse(notifyInterval)); if (notifyIntervalMillis < MINIMUM\_NOTIFY\_INTERVAL\_MILLIS) { notifyIntervalMillis = MINIMUM\_NOTIFY\_INTERVAL\_MILLIS; } } catch (ValueException e) { } } return notifyIntervalMillis; } }
 @Command(name = "PlugtestServer", version = "(c) 2014, Institute for Pervasive Computing, ETH Zurich.") public static class Config extends BaseConfig {
 }
 private static final Config config = new Config();
 private static PlugtestServer server; private static EncryptedPersistentComponentUtil serialization = new EncryptedPersistentComponentUtil(); private static List<CoapServer> servers = new CopyOnWriteArrayList<>(); private static byte[] state;
 public static final String CALIFORNIUM\_BUILD\_VERSION;
 static { String version = StringUtil.CALIFORNIUM\_VERSION; if (version != null) { String build = StringUtil.readFile(new File("build"), null); if (build != null && !build.isEmpty()) { version = version + "\_" + build; } } else { version = ""; } CALIFORNIUM\_BUILD\_VERSION = version; }
 public static void main(String[] args) {
 CommandLine cmd = new CommandLine(config); try { ParseResult result = cmd.parseArgs(args); if (result.isVersionHelpRequested()) { System.out.println("\nCalifornium (Cf) " + cmd.getCommandName() + " " + CALIFORNIUM\_BUILD\_VERSION); cmd.printVersionHelp(System.out); System.out.println(); } if (result.isUsageHelpRequested()) { cmd.usage(System.out); return; } } catch (ParameterException ex) { System.err.println(ex.getMessage()); System.err.println(); cmd.usage(System.err); System.exit(-1); } Configuration configuration = init(config); setupPersistence(config); ProtocolScheduledExecutorService executor = ExecutorsUtil.newProtocolScheduledThreadPool(// configuration.get(CoapConfig.PROTOCOL\_STAGE\_THREAD\_COUNT), // new NamedThreadFactory("CoapServer#")); //$NON-NLS-1$
 EndpointNetSocketObserver socketObserver = null; final NetSocketHealthLogger socketLogger = new NetSocketHealthLogger("udp"); long interval = configuration.get(SystemConfig.HEALTH\_STATUS\_INTERVAL, TimeUnit.MILLISECONDS); if (interval > 0 && socketLogger.isEnabled()) { long readInterval = configuration.get(UDP\_DROPS\_READ\_INTERVAL, TimeUnit.MILLISECONDS); if (interval > readInterval) { executor.scheduleBackgroundAtFixedRate(() -> socketLogger.read(), readInterval, readInterval, TimeUnit.MILLISECONDS); } socketObserver = new EndpointNetSocketObserver(socketLogger); } start(executor, config, configuration, socketObserver, new ActiveInputReader()); LOGGER.info("Executor shutdown ..."); ExecutorsUtil.shutdownExecutorGracefully(500, executor); exit(); LOGGER.info("Exit ..."); }
 public static void exit() { int count = Thread.activeCount(); while (count > 0) { int size = Thread.activeCount(); Thread[] all = new Thread[size]; int available = Thread.enumerate(all); if (available < size) { size = available; } count = 0; for (int index = 0; index < size; ++index) { Thread thread = all[index]; if (!thread.isDaemon() && thread.isAlive()) { ++count; LOGGER.info("Thread [{}] {}", thread.getId(), thread.getName()); } } if (count == 1) { break; } try { Thread.sleep(500); } catch (InterruptedException e) { break; } } }
 public static Configuration init(BaseConfig config) {
 Configuration configuration = Configuration.createWithFile(CONFIG\_FILE, CONFIG\_HEADER, DEFAULTS);
 Configuration udpConfiguration = new Configuration(configuration) .set(CoapConfig.MAX\_MESSAGE\_SIZE, configuration.get(EXTERNAL\_UDP\_MAX\_MESSAGE\_SIZE)) .set(CoapConfig.PREFERRED\_BLOCK\_SIZE, configuration.get(EXTERNAL\_UDP\_PREFERRED\_BLOCK\_SIZE)); Map<Select, Configuration> protocolConfig = new HashMap<>(); protocolConfig.put(new Select(Protocol.UDP, InterfaceType.EXTERNAL), udpConfiguration);
 // create server try { HashMapCtxDB oscoreCtxDb = null; byte[] oscoreServerRid = null; if (config.oscore) { oscoreCtxDb = new HashMapCtxDB(); OSCoreCoapStackFactory.useAsDefault(oscoreCtxDb); oscoreServerRid = initOscore(configuration, oscoreCtxDb); }
 long notifyIntervalMillis = config.getNotifyIntervalMillis();
 server = new PlugtestServer(configuration, protocolConfig, notifyIntervalMillis, oscoreCtxDb, oscoreServerRid); server.setVersion(CALIFORNIUM\_BUILD\_VERSION); server.setTag("PLUG-TEST"); add(server); // ETSI Plugtest environment // server.addEndpoint(new CoAPEndpoint(new InetSocketAddress("::1", // port))); // server.addEndpoint(new CoAPEndpoint(new // InetSocketAddress("127.0.0.1", port))); // server.addEndpoint(new CoAPEndpoint(new // InetSocketAddress("2a01:c911:0:2010::10", port))); // server.addEndpoint(new CoAPEndpoint(new // InetSocketAddress("10.200.1.2", port))); server.addEndpoints(config); if (server.getEndpoints().isEmpty()) { System.err.println("no endpoint available!"); System.exit(ERR\_INIT\_FAILED); } } catch (Exception e) {
 System.err.printf("Failed to create " + PlugtestServer.class.getSimpleName() + ": %s\n", e.getMessage()); e.printStackTrace(System.err); System.err.println("Exiting"); System.exit(ERR\_INIT\_FAILED); } return configuration; }
 public static void add(CoapServer server) { servers.add(server); serialization.addProvider(server); }
 public static void setupPersistence(BaseConfig config) {
 if (config.store != null) { Runnable hook = new Runnable() {
 @Override public void run() { stopAll(); } }; char[] password64 = config.store.password64 == null ? null : config.store.password64.toCharArray(); serialization.loadAndRegisterShutdown(config.store.file, password64, TimeUnit.HOURS.toSeconds(config.store.maxAge), hook); } }
 public static void load(String password) { if (state != null) { SecretKey key = toKey(password); ByteArrayInputStream in = new ByteArrayInputStream(state); stopAll(); serialization.loadComponents(in, key); if (key == null) { LOGGER.info("Loaded: {} Bytes", state.length); } else { LOGGER.info("Loaded: {} Bytes (pw: {})", state.length, password); } state = null; startAll(); SecretUtil.destroy(key); try { in.close(); } catch (IOException e) { } } else { LOGGER.info("no data to load!"); } }
 public static AbstractTestServer start(ProtocolScheduledExecutorService executor, BaseConfig config, Configuration configuration, EndpointNetSocketObserver observer, ActiveInputReader inputReader) {
 if (server != null) { server.setExecutor(executor, true); if (observer != null) { server.addDefaultEndpointObserver(observer); } server.add(new Echo(configuration, config.echoDelay ? executor : null)); server.start(); server.addLogger(true);
 LOGGER.info("{} started ...", PlugtestServer.class.getSimpleName());
 if (inputReader != null) { long interval = configuration.get(SystemConfig.HEALTH\_STATUS\_INTERVAL, TimeUnit.MILLISECONDS); if (interval > 0) { if (observer != null) { server.add(observer.getNetSocketHealth()); } if (config.ipv4) { server.add(new NetStatLogger("udp", false)); } if (config.ipv6) { server.add(new NetStatLogger("udp6", true)); } } else { interval = 30000; } for (;;) { if (console(inputReader, interval)) { break; } dumpAll(); } LOGGER.info("{} stopping ...", PlugtestServer.class.getSimpleName()); shutdown(); } } return server; }
 public static void startAll() { for (CoapServer server : servers) { server.start(); } }
 public static void stopAll() { for (CoapServer server : servers) { server.stop(); } }
 public static void dumpAll() { for (CoapServer server : servers) { server.dump(); } }
 public static void shutdown() { if (server != null) { server.stop(); } }
 public static void save(String password) { SecretKey key = toKey(password); ByteArrayOutputStream out = new ByteArrayOutputStream(); if (state != null) { Bytes.clear(state); } try { // max age 10 minutes stopAll(); serialization.saveComponents(out, key, 60 \* 10); state = out.toByteArray(); out.close(); if (key == null) { LOGGER.info("Saved: {} Bytes", state.length); } else { LOGGER.info("Saved: {} Bytes (pw: {})", state.length, password); } } catch (IOException ex) { LOGGER.warn("saving failed:", ex); } finally { SecretUtil.destroy(key); } }
 public static SecretKey toKey(String password) { SecretKey key = null; if (password != null && !password.isEmpty()) { key = SecretUtil.create(password.getBytes(), "PW"); } return key; }
 public static boolean console(ActiveInputReader reader, long timeout) { try { String line = reader.getLine(timeout); if (line != null) { System.out.println("> " + line); if (line.startsWith("save")) { save(line.substring(4)); } else if (line.startsWith("load")) { load(line.substring(4)); } else if (line.equals("exit")) { return true; } } } catch (RuntimeException e) { e.printStackTrace(); } catch (InterruptedException e) { return true; } return false; }
 /\*\* \* Initializes an OSCORE context for the server built on a pre-defined \* configuration and adds it to the OSCORE context database. The created \* context will support the Appendix B.2. context rederivation procedure. \*  \* @param config the Configuration \* @param db the OSCORE context database \*  \* @return the RID of the server for the generated context \*/ public static byte[] initOscore(Configuration config, HashMapCtxDB db) { AlgorithmID alg = AlgorithmID.AES\_CCM\_16\_64\_128; AlgorithmID kdf = AlgorithmID.HKDF\_HMAC\_SHA\_256;
 byte[] master\_secret = StringUtil.hex2ByteArray("0102030405060708090a0b0c0d0e0f10"); byte[] master\_salt = StringUtil.hex2ByteArray("9e7ca92223786340"); byte[] sid = StringUtil.hex2ByteArray("02"); byte[] rid = StringUtil.hex2ByteArray("01"); byte[] id\_context = StringUtil.hex2ByteArray("37cbf3210017a2d3"); int MAX\_UNFRAGMENTED\_SIZE = config.get(CoapConfig.MAX\_RESOURCE\_BODY\_SIZE);
 OSCoreCtx ctx = null; try { ctx = new OSCoreCtx(master\_secret, false, alg, sid, rid, kdf, 32, master\_salt, id\_context, MAX\_UNFRAGMENTED\_SIZE); ctx.setContextRederivationEnabled(true); } catch (OSException e) { LOGGER.error("Failed to derive OSCORE context"); e.printStackTrace(); } db.addContext(ctx);
 return rid; }
 public static class ActiveInputReader {
 BufferedReader in; Queue<String> buffer; Thread thread;
 public ActiveInputReader() { in = new BufferedReader(new InputStreamReader(System.in)); buffer = new ConcurrentLinkedQueue<>(); thread = new Thread(new Runnable() {
 @Override public void run() { read(); } }, "INPUT"); thread.setDaemon(true); thread.start(); }
 public void read() { String line = null; try { while ((line = in.readLine()) != null) { buffer.add(line); synchronized (buffer) { buffer.notify(); } } } catch (IOException e) { } }
 public String getLine(long timeout) throws InterruptedException { if (timeout >= 0) { synchronized (buffer) { buffer.wait(timeout); } } return buffer.poll(); } }
 public PlugtestServer(Configuration config, Map<Select, Configuration> protocolConfig, long notifyIntervalMillis, HashMapCtxDB oscoreCtxDb, byte[] oscoreServerRid) throws SocketException { super(config, protocolConfig);
 // add resources to the server add(new DefaultTest()); add(new LongPath()); add(new Query()); add(new Separate()); add(new Large()); add(new LargeUpdate()); add(new LargeCreate()); add(new LargePost()); add(new LargeSeparate()); add(new Observe(notifyIntervalMillis)); add(new ObserveNon(notifyIntervalMillis)); add(new ObserveReset()); add(new ObserveLarge(notifyIntervalMillis)); add(new ObservePumping(Type.CON, notifyIntervalMillis)); add(new ObservePumping(Type.NON, notifyIntervalMillis)); add(new LocationQuery()); add(new MultiFormat()); add(new Link1()); add(new Link2()); add(new Link3()); add(new Path()); add(new Validate()); add(new Create()); add(new Shutdown()); add(new Hono("telemetry")); add(new Hono("event")); add(new MyIpResource(MyIpResource.RESOURCE\_NAME, false)); add(new MyContext(MyContext.RESOURCE\_NAME, CALIFORNIUM\_BUILD\_VERSION, false));
 if (oscoreCtxDb != null && oscoreServerRid != null) { add(new Oscore()); add(new OscoreInfo(oscoreCtxDb, oscoreServerRid)); } }}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from datatracker.ietf.org_5603e955_20250108_150723.html ===


* Light
* Dark
* Auto

[RFC 6347

Proposed Standard](/doc/rfc6347/)

|  | Title |  | Datagram Transport Layer Security Version 1.2 |
| --- | --- | --- | --- |
| Document | Document type |  | RFC - Proposed Standard  January 2012  [View errata](https://www.rfc-editor.org/errata_search.php?rfc=6347 "Click to view errata.") [Report errata](https://www.rfc-editor.org/errata.php#reportnew "Click to report an error in the document.") [IPR](/ipr/search/?submit=draft&id=rfc6347 "Click to view IPR declarations.") Obsoleted by [RFC 9147](/doc/html/rfc9147 "The Datagram Transport Layer Security (DTLS) Protocol Version 1.3") Updated by [RFC 8996](/doc/html/rfc8996 "Deprecating TLS 1.0 and TLS 1.1"), [RFC 9146](/doc/html/rfc9146 "Connection Identifier for DTLS 1.2"), [RFC 7507](/doc/html/rfc7507 "TLS Fallback Signaling Cipher Suite Value (SCSV) for Preventing Protocol Downgrade Attacks"), [RFC 7905](/doc/html/rfc7905 "ChaCha20-Poly1305 Cipher Suites for Transport Layer Security (TLS)") Obsoletes [RFC 4347](/doc/html/rfc4347 "Datagram Transport Layer Security") Was [draft-ietf-tls-rfc4347-bis](/doc/draft-ietf-tls-rfc4347-bis/06/) ([tls WG](/wg/tls/about/)) |
| --- | --- | --- | --- |
|  | Select version |  | * [06](/doc/html/draft-ietf-tls-rfc4347-bis-06) * [RFC 6347](/doc/html/rfc6347) |
|  | Compare versions |  | RFC 6347  draft-ietf-tls-rfc4347-bis-06  draft-ietf-tls-rfc4347-bis-05  draft-ietf-tls-rfc4347-bis-04  draft-ietf-tls-rfc4347-bis-03  draft-ietf-tls-rfc4347-bis-02  draft-ietf-tls-rfc4347-bis-01  draft-ietf-tls-rfc4347-bis-00   RFC 6347  draft-ietf-tls-rfc4347-bis-06  draft-ietf-tls-rfc4347-bis-05  draft-ietf-tls-rfc4347-bis-04  draft-ietf-tls-rfc4347-bis-03  draft-ietf-tls-rfc4347-bis-02  draft-ietf-tls-rfc4347-bis-01  draft-ietf-tls-rfc4347-bis-00   Side-by-side  Inline |
|  | Authors |  | [Eric Rescorla](/person/ekr%40rtfm.com "Datatracker profile of Eric Rescorla") , [Nagendra Modadugu](/person/Nagendra%40cs.stanford.edu "Datatracker profile of Nagendra Modadugu")   Email authors |
|  | RFC stream |  | IETF Logo IETF Logo |
|  | Other formats |  | [txt](https://www.rfc-editor.org/rfc/rfc6347.txt) [html](https://www.rfc-editor.org/rfc/rfc6347.html) [pdf](https://www.rfc-editor.org/rfc/pdfrfc/rfc6347.txt.pdf) [bibtex](/doc/rfc6347/bibtex/) |
|  | Additional resources |  | [Mailing list discussion](https://mailarchive.ietf.org/arch/browse/tls/?q=rfc6347 OR %22draft-ietf-tls-rfc4347-bis%22) |
|  |  |  | [Report a bug](https://github.com/ietf-tools/datatracker/issues/new/choose) |

```
Internet Engineering Task Force (IETF)                       E. Rescorla
Request for Comments: 6347                                    RTFM, Inc.
Obsoletes: [4347](/doc/html/rfc4347)                                              N. Modadugu
Category: Standards Track                                   Google, Inc.
ISSN: 2070-1721                                             January 2012

             Datagram Transport Layer Security Version 1.2

Abstract

   This document specifies version 1.2 of the Datagram Transport Layer
   Security (DTLS) protocol.  The DTLS protocol provides communications
   privacy for datagram protocols.  The protocol allows client/server
   applications to communicate in a way that is designed to prevent
   eavesdropping, tampering, or message forgery.  The DTLS protocol is
   based on the Transport Layer Security (TLS) protocol and provides
   equivalent security guarantees.  Datagram semantics of the underlying
   transport are preserved by the DTLS protocol.  This document updates
   DTLS 1.0 to work with TLS version 1.2.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in [Section 2 of RFC 5741](/doc/html/rfc5741#section-2).

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <http://www.rfc-editor.org/info/rfc6347>.

Rescorla & Modadugu          Standards Track                    [Page 1]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to [BCP 78](/doc/html/bcp78) and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<http://trustee.ietf.org/license-info>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Rescorla & Modadugu          Standards Track                    [Page 2]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

Table of Contents

   [1](#section-1). Introduction ....................................................[4](#page-4)
      [1.1](#section-1.1). Requirements Terminology ...................................[5](#page-5)
   [2](#section-2). Usage Model .....................................................[5](#page-5)
   [3](#section-3). Overview of DTLS ................................................[5](#page-5)
      [3.1](#section-3.1). Loss-Insensitive Messaging .................................[6](#page-6)
      [3.2](#section-3.2). Providing Reliability for Handshake ........................[6](#page-6)
           [3.2.1](#section-3.2.1). Packet Loss .........................................[6](#page-6)
           [3.2.2](#section-3.2.2). Reordering ..........................................[7](#page-7)
           [3.2.3](#section-3.2.3). Message Size ........................................[7](#page-7)
      [3.3](#section-3.3). Replay Detection ...........................................[7](#page-7)
   [4](#section-4). Differences from TLS ............................................[7](#page-7)
      [4.1](#section-4.1). Record Layer ...............................................[8](#page-8)
           [4.1.1](#section-4.1.1). Transport Layer Mapping ............................[10](#page-10)
                  [4.1.1.1](#section-4.1.1.1). PMTU Issues ...............................[10](#page-10)
           [4.1.2](#section-4.1.2). Record Payload Protection ..........................[12](#page-12)
                  [4.1.2.1](#section-4.1.2.1). MAC .......................................[12](#page-12)
                  [4.1.2.2](#section-4.1.2.2). Null or Standard Stream Cipher ............[13](#page-13)
                  [4.1.2.3](#section-4.1.2.3). Block Cipher ..............................[13](#page-13)
                  [4.1.2.4](#section-4.1.2.4). AEAD Ciphers ..............................[13](#page-13)
                  [4.1.2.5](#section-4.1.2.5). New Cipher Suites .........................[13](#page-13)
                  [4.1.2.6](#section-4.1.2.6). Anti-Replay ...............................[13](#page-13)
                  [4.1.2.7](#section-4.1.2.7). Handling Invalid Records ..................[14](#page-14)
      [4.2](#section-4.2). The DTLS Handshake Protocol ...............................[14](#page-14)
           [4.2.1](#section-4.2.1). Denial-of-Service Countermeasures ..................[15](#page-15)
           [4.2.2](#section-4.2.2). Handshake Message Format ...........................[18](#page-18)
           [4.2.3](#section-4.2.3). Handshake Message Fragmentation and Reassembly .....[19](#page-19)
           [4.2.4](#section-4.2.4). Timeout and Retransmission .........................[20](#page-20)
                  [4.2.4.1](#section-4.2.4.1). Timer Values ..............................[24](#page-24)
           [4.2.5](#section-4.2.5). ChangeCipherSpec ...................................[25](#page-25)
           [4.2.6](#section-4.2.6). CertificateVerify and Finished Messages ............[25](#page-25)
           [4.2.7](#section-4.2.7). Alert Messages .....................................[25](#page-25)
           4.2.8. Establishing New Associations with Existing
                  Parameters .........................................[25](#page-25)
      [4.3](#section-4.3). Summary of New Syntax .....................................[26](#page-26)
           [4.3.1](#section-4.3.1). Record Layer .......................................[26](#page-26)
           [4.3.2](#section-4.3.2). Handshake Protocol .................................[27](#page-27)
   [5](#section-5). Security Considerations ........................................[27](#page-27)
   [6](#section-6). Acknowledgments ................................................[28](#page-28)
   [7](#section-7). IANA Considerations ............................................[28](#page-28)
   [8](#section-8). Changes since DTLS 1.0 .........................................[29](#page-29)
   [9](#section-9). References .....................................................[30](#page-30)
      [9.1](#section-9.1). Normative References ......................................[30](#page-30)
      [9.2](#section-9.2). Informative References ....................................[31](#page-31)

Rescorla & Modadugu          Standards Track                    [Page 3]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

[1](#section-1).  Introduction

   TLS [[TLS](#ref-TLS "\"The TLS Protocol Version 1.0\"")] is the most widely deployed protocol for securing network
   traffic.  It is widely used for protecting Web traffic and for e-mail
   protocols such as IMAP [[IMAP](#ref-IMAP "\"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1\"")] and POP [[POP](#ref-POP "\"Post Office Protocol - Version 3\"")].  The primary advantage
   of TLS is that it provides a transparent connection-oriented channel.
   Thus, it is easy to secure an application protocol by inserting TLS
   between the application layer and the transport layer.  However, TLS
   must run over a reliable transport channel -- typically TCP [[TCP](#ref-TCP "\"Transmission Control Protocol\"")].
   Therefore, it cannot be used to secure unreliable datagram traffic.

   An increasing number of application layer protocols have been
   designed that use UDP transport.  In particular, protocols such as
   the Session Initiation Protocol (SIP) [[SIP](#ref-SIP "\"SIP: Session Initiation Protocol\"")] and electronic gaming
   protocols are increasingly popular.  (Note that SIP can run over both
   TCP and UDP, but that there are situations in which UDP is
   preferable.)  Currently, designers of these applications are faced
   with a number of unsatisfactory choices.  First, they can use IPsec
   [[RFC4301](/doc/html/rfc4301 "\"Security Architecture for the Internet Protocol\"")].  However, for a number of reasons detailed in [[WHYIPSEC](#ref-WHYIPSEC "\"Guidelines for Specifying the Use of IPsec Version 2\"")],
   this is only suitable for some applications.  Second, they can design
   a custom application layer security protocol.  Unfortunately,
   although application layer security protocols generally provide
   superior security properties (e.g., end-to-end security in the case
   of S/MIME), they typically require a large amount of effort to design
   -- in contrast to the relatively small amount of effort required to
   run the protocol over TLS.

   In many cases, the most desirable way to secure client/server
   applications would be to use TLS; however, the requirement for
   datagram semantics automatically prohibits use of TLS.  This memo
   describes a protocol for this purpose: Datagram Transport Layer
   Security (DTLS).  DTLS is deliberately designed to be as similar to
   TLS as possible, both to minimize new security invention and to
   maximize the amount of code and infrastructure reuse.

   DTLS 1.0 [[DTLS1](#ref-DTLS1 "\"Datagram Transport Layer Security\"")] was originally defined as a delta from [[TLS11](#ref-TLS11 "\"The Transport Layer Security (TLS) Protocol Version 1.1\"")].
   This document introduces a new version of DTLS, DTLS 1.2, which is
   defined as a series of deltas to TLS 1.2 [[TLS12](#ref-TLS12 "\"The Transport Layer Security (TLS) Protocol Version 1.2\"")].  There is no DTLS
   1.1; that version number was skipped in order to harmonize version
   numbers with TLS.  This version also clarifies some confusing points
   in the DTLS 1.0 specification.

   Implementations that speak both DTLS 1.2 and DTLS 1.0 can
   interoperate with those that speak only DTLS 1.0 (using DTLS 1.0 of
   course), just as TLS 1.2 implementations can interoperate with
   previous versions of TLS (see [Appendix E.1](#appendix-E.1) of [[TLS12](#ref-TLS12 "\"The Transport Layer Security (TLS) Protocol Version 1.2\"")] for details),
   with the exception that there is no DTLS version of SSLv2 or SSLv3,
   so backward compatibility issues for those protocols do not apply.

Rescorla & Modadugu          Standards Track                    [Page 4]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

[1.1](#section-1.1). Requirements Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC 2119](/doc/html/rfc2119) [[REQ](#ref-REQ "\"Key words for use in RFCs to Indicate Requirement Levels\"")].

[2](#section-2).  Usage Model

   The DTLS protocol is designed to secure data between communicating
   applications.  It is designed to run in application space, without
   requiring any kernel modifications.

   Datagram transport does not require or provide reliable or in-order
   delivery of data.  The DTLS protocol preserves this property for
   payload data.  Applications such as media streaming, Internet
   telephony, and online gaming use datagram transport for communication
   due to the delay-sensitive nature of transported data.  The behavior
   of such applications is unchanged when the DTLS protocol is used to
   secure communication, since the DTLS protocol does not compensate for
   lost or re-ordered data traffic.

[3](#section-3).  Overview of DTLS

   The basic design philosophy of DTLS is to construct "TLS over
   datagram transport".  The reason that TLS cannot be used directly in
   datagram environments is simply that packets may be lost or
   reordered.  TLS has no internal facilities to handle this kind of
   unreliability; therefore, TLS implementations break when rehosted on
   datagram transport.  The purpose of DTLS is to make only the minimal
   changes to TLS required to fix this problem.  To the greatest extent
   possible, DTLS is identical to TLS.  Whenever we need to invent new
   mechanisms, we attempt to do so in such a way that preserves the
   style of TLS.

   Unreliability creates problems for TLS at two levels:

      1. TLS does not allow independent decryption of individual
         records.  Because the integrity check depends on the sequence
         number, if record N is not received, then the integrity check
         on record N+1 will be based on the wrong sequence number and
         thus will fail.  (Note that prior to TLS 1.1, there was no
         explicit IV and so decryption would also fail.)

      2. The TLS handshake layer assumes that handshake messages are
         delivered reliably and breaks if those messages are lost.

   The rest of this section describes the approach that DTLS uses to
   solve these problems.

Rescorla & Modadugu          Standards Track                    [Page 5]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

[3.1](#section-3.1).  Loss-Insensitive Messaging

   In TLS's traffic encryption layer (called the TLS Record Layer),
   records are not independent.  There are two kinds of inter-record
   dependency:

      1. Cryptographic context (stream cipher key stream) is retained
         between records.

      2. Anti-replay and message reordering protection are provided by a
         MAC that includes a sequence number, but the sequence numbers
         are implicit in the records.

   DTLS solves the first problem by banning stream ciphers.  DTLS solves
   the second problem by adding explicit sequence numbers.

[3.2](#section-3.2).  Providing Reliability for Handshake

   The TLS handshake is a lockstep cryptographic handshake.  Messages
   must be transmitted and received in a defined order; any other order
   is an error.  Clearly, this is incompatible with reordering and
   message loss.  In addition, TLS handshake messages are potentially
   larger than any given datagram, thus creating the problem of IP
   fragmentation.  DTLS must provide fixes for both of these problems.

[3.2.1](#section-3.2.1).  Packet Loss

   DTLS uses a simple retransmission timer to handle packet loss.  The
   following figure demonstrates the basic concept, using the first
   phase of the DTLS handshake:

         Client                                   Server
         ------                                   ------
         ClientHello           ------>

                                 X<-- HelloVerifyRequest
                                                  (lost)

         [Timer Expires]

         ClientHello           ------>
         (retransmit)

   Once the client has transmitted the ClientHello message, it expects
   to see a HelloVerifyRequest from the server.  However, if the
   server's message is lost, the client knows that either the
   ClientHello or the HelloVerifyRequest has been lost and retransmits.
   When the server receives the retransmission, it knows to retransmit.

Rescorla & Modadugu          Standards Track                    [Page 6]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   The server also maintains a retransmission timer and retransmits when
   that timer expires.

   Note that timeout and retransmission do not apply to the
   HelloVerifyRequest, because this would require creating state on the
   server.  The HelloVerifyRequest is designed to be small enough that
   it will not itself be fragmented, thus avoiding concerns about
   interleaving multiple HelloVerifyRequests.

[3.2.2](#section-3.2.2).  Reordering

   In DTLS, each handshake message is assigned a specific sequence
   number within that handshake.  When a peer receives a handshake
   message, it can quickly determine whether that message is the next
   message it expects.  If it is, then it processes it.  If not, it
   queues it for future handling once all previous messages have been
   received.

[3.2.3](#section-3.2.3).  Message Size

   TLS and DTLS handshake messages can be quite large (in theory up to
   2^24-1 bytes, in practice many kilobytes).  By contrast, UDP
   datagrams are often limited to <1500 bytes if IP fragmentation is not
   desired.  In order to compensate for this limitation, each DTLS
   handshake message may be fragmented over several DTLS records, each
   of which is intended to fit in a single IP datagram.  Each DTLS
   handshake message contains both a fragment offset and a fragment
   length.  Thus, a recipient in possession of all bytes of a handshake
   message can reassemble the original unfragmented message.

[3.3](#section-3.3).  Replay Detection

   DTLS optionally supports record replay detection.  The technique used
   is the same as in IPsec AH/ESP, by maintaining a bitmap window of
   received records.  Records that are too old to fit in the window and
   records that have previously been received are silently discarded.
   The replay detection feature is optional, since packet duplication is
   not always malicious, but can also occur due to routing errors.
   Applications may conceivably detect duplicate packets and accordingly
   modify their data transmission strategy.

[4](#section-4).  Differences from TLS

   As mentioned in [Section 3](#section-3), DTLS is intentionally very similar to TLS.
   Therefore, instead of presenting DTLS as a new protocol, we present
   it as a series of deltas from TLS 1.2 [[TLS12](#ref-TLS12 "\"The Transport Layer Security (TLS) Protocol Version 1.2\"")].  Where we do not
   explicitly call out differences, DTLS is the same as in [[TLS12](#ref-TLS12 "\"The Transport Layer Security (TLS) Protocol Version 1.2\"")].

Rescorla & Modadugu          Standards Track                    [Page 7]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

[4.1](#section-4.1).  Record Layer

   The DTLS record layer is extremely similar to that of TLS 1.2.  The
   only change is the inclusion of an explicit sequence number in the
   record.  This sequence number allows the recipient to correctly
   verify the TLS MAC.  The DTLS record format is shown below:

      struct {
           ContentType type;
           ProtocolVersion version;
           uint16 epoch;                                    // New field
           uint48 sequence_number;                          // New field
           uint16 length;
           opaque fragment[DTLSPlaintext.length];
         } DTLSPlaintext;

   type
      Equivalent to the type field in a TLS 1.2 record.

   version
      The version of the protocol being employed.  This document
      describes DTLS version 1.2, which uses the version { 254, 253 }.
      The version value of 254.253 is the 1's complement of DTLS version
      1.2.  This maximal spacing between TLS and DTLS version numbers
      ensures that records from the two protocols can be easily
      distinguished.  It should be noted that future on-the-wire version
      numbers of DTLS are decreasing in value (while the true version
      number is increasing in value.)

   epoch
      A counter value that is incremented on every cipher state change.

   sequence_number
      The sequence number for this record.

   length
      Identical to the length field in a TLS 1.2 record.  As in TLS 1.2,
      the length should not exceed 2^14.

   fragment
      Identical to the fragment field of a TLS 1.2 record.

   DTLS uses an explicit sequence number, rather than an implicit one,
   carried in the sequence_number field of the record.  Sequence numbers
   are maintained separately for each epoch, with each sequence_number
   initially being 0 for each epoch.  For instance, if a handshake
   message from epoch 0 is retransmitted, it might have a sequence
   number after a message from epoch 1, even if the message from epoch 1

Rescorla & Modadugu          Standards Track                    [Page 8]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   was transmitted first.  Note that some care needs to be taken during
   the handshake to ensure that retransmitted messages use the right
   epoch and keying material.

   If several handshakes are performed in close succession, there might
   be multiple records on the wire with the same sequence number but
   from different cipher states.  The epoch field allows recipients to
   distinguish such packets.  The epoch number is initially zero and is
   incremented each time a ChangeCipherSpec message is sent.  In order
   to ensure that any given sequence/epoch pair is unique,
   implementations MUST NOT allow the same epoch value to be reused
   within two times the TCP maximum segment lifetime.  In practice, TLS
   implementations rarely rehandshake; therefore, we do not expect this
   to be a problem.

   Note that because DTLS records may be reordered, a record from epoch
   1 may be received after epoch 2 has begun.  In general,
   implementations SHOULD discard packets from earlier epochs, but if
   packet loss causes noticeable problems they MAY choose to retain
   keying material from previous epochs for up to the default MSL
   specified for TCP [[TCP](#ref-TCP "\"Transmission Control Protocol\"")] to allow for packet reordering.  (Note that
   the intention here is that implementors use the current guidance from
   the IETF for MSL, not that they attempt to interrogate the MSL that
   the system TCP stack is using.)  Until the handshake has completed,
   implementations MUST accept packets from the old epoch.

   Conversely, it is possible for records that are protected by the
   newly negotiated context to be received prior to the completion of a
   handshake.  For instance, the server may send its Finished message
   and then start transmitting data.  Implementations MAY either buffer
   or discard such packets, though when DTLS is used over reliable
   transports (e.g., SCTP), they SHOULD be buffered and processed once
   the handshake completes.  Note that TLS's restrictions on when
   packets may be sent still apply, and the receiver treats the packets
   as if they were sent in the right order.  In particular, it is still
   impermissible to send data prior to completion of the first
   handshake.

   Note that in the special case of a rehandshake on an existing
   association, it is safe to process a data packet immediately, even if
   the ChangeCipherSpec or Finished messages have not yet been received
   provided that either the rehandshake resumes the existing session or
   that it uses exactly the same security parameters as the existing
   association.  In any other case, the implementation MUST wait for the
   receipt of the Finished message to prevent downgrade attack.

   As in TLS, implementations MUST either abandon an association or
   rehandshake prior to allowing the sequence number to wrap.

Rescorla & Modadugu          Standards Track                    [Page 9]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   Similarly, implementations MUST NOT allow the epoch to wrap, but
   instead MUST establish a new association, terminating the old
   association as described in [Section 4.2.8](#section-4.2.8).  In practice,
   implementations rarely rehandshake repeatedly on the same channel, so
   this is not likely to be an issue.

[4.1.1](#section-4.1.1).  Transport Layer Mapping

   Each DTLS record MUST fit within a single datagram.  In order to
   avoid IP fragmentation, clients of the DTLS record layer SHOULD
   attempt to size records so that they fit within any PMTU estimates
   obtained from the record layer.

   Note that unlike IPsec, DTLS records do not contain any association
   identifiers.  Applications must arrange to multiplex between
   associations.  With UDP, this is presumably done with the host/port
   number.

   Multiple DTLS records may be placed in a single datagram.  They are
   simply encoded consecutively.  The DTLS record framing is sufficient
   to determine the boundaries.  Note, however, that the first byte of
   the datagram payload must be the beginning of a record.  Records may
   not span datagrams.

   Some transports, such as DCCP [[DCCP](#ref-DCCP "\"Datagram Congestion Control Protocol (DCCP)\"")] provide their own sequence
   numbers.  When carried over those transports, both the DTLS and the
   transport sequence numbers will be present.  Although this introduces
   a small amount of inefficiency, the transport layer and DTLS sequence
   numbers serve different purposes; therefore, for conceptual
   simplicity, it is superior to use both sequence numbers.  In the
   future, extensions to DTLS may be specified that allow the use of
   only one set of sequence numbers for deployment in constrained
   environments.

   Some transports, such as DCCP, provide congestion control for traffic
   carried over them.  If the congestion window is sufficiently narrow,
   DTLS handshake retransmissions may be held rather than transmitted
   immediately, potentially leading to timeouts and spurious
   retransmission.  When DTLS is used over such transports, care should
   be taken not to overrun the likely congestion window. [[DCCPDTLS](#ref-DCCPDTLS "\"Datagram Transport Layer Security (DTLS) over the Datagram Congestion Control Protocol (DCCP)\"")]
   defines a mapping of DTLS to DCCP that takes these issues into
   account.

[4.1.1.1](#section-4.1.1.1).  PMTU Issues

   In general, DTLS's philosophy is to leave PMTU discovery to the
   application.  However, DTLS cannot completely ignore PMTU for three
   reasons:

Rescorla & Modadugu          Standards Track                   [Page 10]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   -  The DTLS record framing expands the datagram size, thus lowering
      the effective PMTU from the application's perspective.

   -  In some implementations, the application may not directly talk to
      the network, in which case the DTLS stack may absorb ICMP
      [[RFC1191](/doc/html/rfc1191 "\"Path MTU discovery\"")] "Datagram Too Big" indications or ICMPv6 [[RFC4443](/doc/html/rfc4443 "\"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification\"")]
      "Packet Too Big" indications.

   -  The DTLS handshake messages can exceed the PMTU.

   In order to deal with the first two issues, the DTLS record layer
   SHOULD behave as described below.

   If PMTU estimates are available from the underlying transport
   protocol, they should be made available to upper layer protocols.  In
   particular:

   -  For DTLS over UDP, the upper layer protocol SHOULD be allowed to
      obtain the PMTU estimate maintained in the IP layer.

   -  For DTLS over DCCP, the upper layer protocol SHOULD be allowed to
      obtain the current estimate of the PMTU.

   -  For DTLS over TCP or SCTP, which automatically fragment and
      reassemble datagrams, there is no PMTU limitation.  However, the
      upper layer protocol MUST NOT write any record that exceeds the
      maximum record size of 2^14 bytes.

   The DTLS record layer SHOULD allow the upper layer protocol to
   discover the amount of record expansion expected by the DTLS
   processing.  Note that this number is only an estimate because of
   block padding and the potential use of DTLS compression.

   If there is a transport protocol indication (either via ICMP or via a
   refusal to send the datagram as in Section 14 of [[DCCP](#ref-DCCP "\"Datagram Congestion Control Protocol (DCCP)\"")]), then the
   DTLS record layer MUST inform the upper layer protocol of the error.

   The DTLS record layer SHOULD NOT interfere with upper layer protocols
   performing PMTU discovery, whether via [[RFC1191](/doc/html/rfc1191 "\"Path MTU discovery\"")] or [[RFC4821](/doc/html/rfc4821 "\"Packetization Layer Path MTU Discovery\"")]
   mechanisms.  In particular:

   -  Where allowed by the underlying transport protocol, the upper
      layer protocol SHOULD be allowed to set the state of the DF bit
      (in IPv4) or prohibit local fragmentation (in IPv6).

   -  If the underlying transport protocol allows the application to
      request PMTU probing (e.g., DCCP), the DTLS record layer should
      honor this request.

Rescorla & Modadugu          Standards Track                   [Page 11]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   The final issue is the DTLS handshake protocol.  From the perspective
   of the DTLS record layer, this is merely another upper layer
   protocol.  However, DTLS handshakes occur infrequently and involve
   only a few round trips; therefore, the handshake protocol PMTU
   handling places a premium on rapid completion over accurate PMTU
   discovery.  In order to allow connections under these circumstances,
   DTLS implementations SHOULD follow the following rules:

   -  If the DTLS record layer informs the DTLS handshake layer that a
      message is too big, it SHOULD immediately attempt to fragment it,
      using any existing information about the PMTU.

   -  If repeated retransmissions do not result in a response, and the
      PMTU is unknown, subsequent retransmissions SHOULD back off to a
      smaller record size, fragmenting the handshake message as
      appropriate.  This standard does not specify an exact number of
      retransmits to attempt before backing off, but 2-3 seems
      appropriate.

[4.1.2](#section-4.1.2).  Record Payload Protection

   Like TLS, DTLS transmits data as a series of protected records.  The
   rest of this section describes the details of that format.

[4.1.2.1](#section-4.1.2.1).  MAC

   The DTLS MAC is the same as that of TLS 1.2. However, rather than
   using TLS's implicit sequence number, the sequence number used to
   compute the MAC is the 64-bit value formed by concatenating the epoch
   and the sequence number in the order they appear on the wire.  Note
   that the DTLS epoch + sequence number is the same length as the TLS
   sequence number.

   TLS MAC calculation is parameterized on the protocol version number,
   which, in the case of DTLS, is the on-the-wire version, i.e., {254,
   253} for DTLS 1.2.

   Note that one important difference between DTLS and TLS MAC handling
   is that in TLS, MAC errors must result in connection termination.  In
   DTLS, the receiving implementation MAY simply discard the offending
   record and continue with the connection.  This change is possible
   because DTLS records are not dependent on each other in the way that
   TLS records are.

   In general, DTLS implementations SHOULD silently discard records with
   bad MACs or that are otherwise invalid.  They MAY log an error.  If a
   DTLS implementation chooses to generate an alert when it receives a
   message with an invalid MAC, it MUST generate a bad_record_mac alert

Rescorla & Modadugu          Standards Track                   [Page 12]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   with level fatal and terminate its connection state.  Note that
   because errors do not cause connection termination, DTLS stacks are
   more efficient error type oracles than TLS stacks.  Thus, it is
   especially important that the advice in Section 6.2.3.2 of [[TLS12](#ref-TLS12 "\"The Transport Layer Security (TLS) Protocol Version 1.2\"")] be
   followed.

[4.1.2.2](#section-4.1.2.2).  Null or Standard Stream Cipher

   The DTLS NULL cipher is performed exactly as the TLS 1.2 NULL cipher.

   The only stream cipher described in TLS 1.2 is RC4, which cannot be
   randomly accessed.  RC4 MUST NOT be used with DTLS.

[4.1.2.3](#section-4.1.2.3).  Block Cipher

   DTLS block cipher encryption and decryption are performed exactly as
   with TLS 1.2.

[4.1.2.4](#section-4.1.2.4).  AEAD Ciphers

   TLS 1.2 introduced authenticated encryption with additional data
   (AEAD) cipher suites.  The existing AEAD cipher suites, defined in
   [[ECCGCM](#ref-ECCGCM "\"TLS Elliptic Curve Cipher Suites with SHA-256/384 and AES Galois Counter Mode (GCM)\"")] and [[RSAGCM](#ref-RSAGCM "\"AES Galois Counter Mode (GCM) Cipher Suites for TLS\"")], can be used with DTLS exactly as with TLS 1.2.

[4.1.2.5](#section-4.1.2.5).  New Cipher Suites

   Upon registration, new TLS cipher suites MUST indicate whether they
   are suitable for DTLS usage and what, if any, adaptations must be
   made (see [Section 7](#section-7) for IANA considerations).

[4.1.2.6](#section-4.1.2.6).  Anti-Replay

   DTLS records contain a sequence number to provide replay protection.
   Sequence number verification SHOULD be performed using the following
   sliding window procedure, borrowed from Section 3.4.3 of [[ESP](#ref-ESP "\"IP Encapsulating Security Payload (ESP)\"")].

   The receiver packet counter for this session MUST be initialized to
   zero when the session is established.  For each received record, the
   receiver MUST verify that the record contains a sequence number that
   does not duplicate the sequence number of any other record received
   during the life of this session.  This SHOULD be the first check
   applied to a packet after it has been matched to a session, to speed
   rejection of duplicate records.

   Duplicates are rejected through the use of a sliding receive window.
   (How the window is implemented is a local matter, but the following
   text describes the functionality that the implementation must
   exhibit.)  A minimum window size of 32 MUST be supported, but a

Rescorla & Modadugu          Standards Track                   [Page 13]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   window size of 64 is preferred and SHOULD be employed as the default.
   Another window size (larger than the minimum) MAY be chosen by the
   receiver.  (The receiver does not notify the sender of the window
   size.)

   The "right" edge of the window represents the highest validated
   sequence number value received on this session.  Records that contain
   sequence numbers lower than the "left" edge of the window are
   rejected.  Packets falling within the window are checked against a
   list of received packets within the window.  An efficient means for
   performing this check, based on the use of a bit mask, is described
   in Section 3.4.3 of [[ESP](#ref-ESP "\"IP Encapsulating Security Payload (ESP)\"")].

   If the received record falls within the window and is new, or if the
   packet is to the right of the window, then the receiver proceeds to
   MAC verification.  If the MAC validation fails, the receiver MUST
   discard the received record as invalid.  The receive window is
   updated only if the MAC verification succeeds.

[4.1.2.7](#section-4.1.2.7).  Handling Invalid Records

   Unlike TLS, DTLS is resilient in the face of invalid records (e.g.,
   invalid formatting, length, MAC, etc.).  In general, invalid records
   SHOULD be silently discarded, thus preserving the association;
   however, an error MAY be logged for diagnostic purposes.
   Implementations which choose to generate an alert instead, MUST
   generate fatal level alerts to avoid attacks where the attacker
   repeatedly probes the implementation to see how it responds to
   various types of error.  Note that if DTLS is run over UDP, then any
   implementation which does this will be extremely susceptible to
   denial-of-service (DoS) attacks because UDP forgery is so easy.
   Thus, this practice is NOT RECOMMENDED for such transports.

   If DTLS is being carried over a transport that is resistant to
   forgery (e.g., SCTP with SCTP-AUTH), then it is safer to send alerts
   because an attacker will have difficulty forging a datagram that will
   not be rejected by the transport layer.

[4.2](#section-4.2).  The DTLS Handshake Protocol

   DTLS uses all of the same handshake messages and flows as TLS, with
   three principal changes:

      1. A stateless cookie exchange has been added to prevent denial-
         of-service attacks.

Rescorla & Modadugu          Standards Track                   [Page 14]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

      2. Modifications to the handshake header to handle message loss,
         reordering, and DTLS message fragmentation (in order to avoid
         IP fragmentation).

      3. Retransmission timers to handle message loss.

   With these exceptions, the DTLS message formats, flows, and logic are
   the same as those of TLS 1.2.

[4.2.1](#section-4.2.1).  Denial-of-Service Countermeasures

   Datagram security protocols are extremely susceptible to a variety of
   DoS attacks.  Two attacks are of particular concern:

      1. An attacker can consume excessive resources on the server by
         transmitting a series of handshake initiation requests, causing
         the server to allocate state and potentially to perform
         expensive cryptographic operations.

      2. An attacker can use the server as an amplifier by sending
         connection initiation messages with a forged source of the
         victim.  The server then sends its next message (in DTLS, a
         Certificate message, which can be quite large) to the victim
         machine, thus flooding it.

   In order to counter both of these attacks, DTLS borrows the stateless
   cookie technique used by Photuris [[PHOTURIS](#ref-PHOTURIS "\"Photuris: Session-Key Management Protocol\"")] and IKE [[IKEv2](#ref-IKEv2 "\"Internet Key Exchange Protocol Version 2 (IKEv2)\"")].  When
   the client sends its ClientHello message to the server, the server
   MAY respond with a HelloVerifyRequest message.  This message contains
   a stateless cookie generated using the technique of [[PHOTURIS](#ref-PHOTURIS "\"Photuris: Session-Key Management Protocol\"")].  The
   client MUST retransmit the ClientHello with the cookie added.  The
   server then verifies the cookie and proceeds with the handshake only
   if it is valid.  This mechanism forces the attacker/client to be able
   to receive the cookie, which makes DoS attacks with spoofed IP
   addresses difficult.  This mechanism does not provide any defense
   against DoS attacks mounted from valid IP addresses.

Rescorla & Modadugu          Standards Track                   [Page 15]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   The exchange is shown below:

      Client                                   Server
      ------                                   ------
      ClientHello           ------>

                            <----- HelloVerifyRequest
                                   (contains cookie)

      ClientHello           ------>
      (with cookie)

      [Rest of handshake]

   DTLS therefore modifies the ClientHello message to add the cookie
   value.

   struct {
     ProtocolVersion client_version;
     Random random;
     SessionID session_id;
     opaque cookie<0..2^8-1>;                             // New field
     CipherSuite cipher_suites<2..2^16-1>;
           CompressionMethod compression_methods<1..2^8-1>;
   } ClientHello;

   When sending the first ClientHello, the client does not have a cookie
   yet; in this case, the Cookie field is left empty (zero length).

   The definition of HelloVerifyRequest is as follows:

   struct {
     ProtocolVersion server_version;
     opaque cookie<0..2^8-1>;
   } HelloVerifyRequest;

   The HelloVerifyRequest message type is hello_verify_request(3).

   The server_version field has the same syntax as in TLS.  However, in
   order to avoid the requirement to do version negotiation in the
   initial handshake, DTLS 1.2 server implementations SHOULD use DTLS
   version 1.0 regardless of the version of TLS that is expected to be
   negotiated.  DTLS 1.2 and 1.0 clients MUST use the version solely to
   indicate packet formatting (which is the same in both DTLS 1.2 and
   1.0) and not as part of version negotiation.  In particular, DTLS 1.2
   clients MUST NOT assume that because the server uses version 1.0 in
   the HelloVerifyRequest that the server is not DTLS 1.2 or that it
   will eventually negotiate DTLS 1.0 rather than DTLS 1.2.

Rescorla & Modadugu          Standards Track                   [Page 16]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   When responding to a HelloVerifyRequest, the client MUST use the same
   parameter values (version, random, session_id, cipher_suites,
   compression_method) as it did in the original ClientHello.  The
   server SHOULD use those values to generate its cookie and verify that
   they are correct upon cookie receipt.  The server MUST use the same
   version number in the HelloVerifyRequest that it would use when
   sending a ServerHello.  Upon receipt of the ServerHello, the client
   MUST verify that the server version values match.  In order to avoid
   sequence number duplication in case of multiple HelloVerifyRequests,
   the server MUST use the record sequence number in the ClientHello as
   the record sequence number in the HelloVerifyRequest.

   Note: This specification increases the cookie size limit to 255 bytes
   for greater future flexibility.  The limit remains 32 for previous
   versions of DTLS.

   The DTLS server SHOULD generate cookies in such a way that they can
   be verified without retaining any per-client state on the server.
   One technique is to have a randomly generated secret and generate
   cookies as:

      Cookie = HMAC(Secret, Client-IP, Client-Parameters)

   When the second ClientHello is received, the server can verify that
   the Cookie is valid and that the client can receive packets at the
   given IP address.  In order to avoid sequence number duplication in
   case of multiple cookie exchanges, the server MUST use the record
   sequence number in the ClientHello as the record sequence number in
   its initial ServerHello.  Subsequent ServerHellos will only be sent
   after the server has created state and MUST increment normally.

   One potential attack on this scheme is for the attacker to collect a
   number of cookies from different addresses and then reuse them to
   attack the server.  The server can defend against this attack by
   changing the Secret value frequently, thus invalidating those
   cookies.  If the server wishes that legitimate clients be able to
   handshake through the transition (e.g., they received a cookie with
   Secret 1 and then sent the second ClientHello after the server has
   changed to Secret 2), the server can have a limited window during
   which it accepts both secrets.  [[IKEv2](#ref-IKEv2 "\"Internet Key Exchange Protocol Version 2 (IKEv2)\"")] suggests adding a version
   number to cookies to detect this case.  An alternative approach is
   simply to try verifying with both secrets.

   DTLS servers SHOULD perform a cookie exchange whenever a new
   handshake is being performed.  If the server is being operated in an
   environment where amplification is not a problem, the server MAY be
   configured not to perform a cookie exchange.  The default SHOULD be
   that the exchange is performed, however.  In addition, the server MAY

Rescorla & Modadugu          Standards Track                   [Page 17]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   choose not to do a cookie exchange when a session is resumed.
   Clients MUST be prepared to do a cookie exchange with every
   handshake.

   If HelloVerifyRequest is used, the initial ClientHello and
   HelloVerifyRequest are not included in the calculation of the
   handshake_messages (for the CertificateVerify message) and
   verify_data (for the Finished message).

   If a server receives a ClientHello with an invalid cookie, it SHOULD
   treat it the same as a ClientHello with no cookie.  This avoids
   race/deadlock conditions if the client somehow gets a bad cookie
   (e.g., because the server changes its cookie signing key).

   Note to implementors: This may result in clients receiving multiple
   HelloVerifyRequest messages with different cookies.  Clients SHOULD
   handle this by sending a new ClientHello with a cookie in response to
   the new HelloVerifyRequest.

[4.2.2](#section-4.2.2).  Handshake Message Format

   In order to support message loss, reordering, and message
   fragmentation, DTLS modifies the TLS 1.2 handshake header:

   struct {
     HandshakeType msg_type;
     uint24 length;
     uint16 message_seq;                               // New field
     uint24 fragment_offset;                           // New field
     uint24 fragment_length;                           // New field
     select (HandshakeType) {
       case hello_request: HelloRequest;
       case client_hello:  ClientHello;
       case hello_verify_request: HelloVerifyRequest;  // New type
       case server_hello:  ServerHello;
       case certificate:Certificate;
       case server_key_exchange: ServerKeyExchange;
       case certificate_request: CertificateRequest;
       case server_hello_done:ServerHelloDone;
       case certificate_verify:  CertificateVerify;
       case client_key_exchange: ClientKeyExchange;
       case finished: Finished;
     } body;
   } Handshake;

   The first message each side transmits in each handshake always has
   message_seq = 0.  Whenever each new message is generated, the
   message_seq value is incremented by one.  Note that in the case of a

Rescorla & Modadugu          Standards Track                   [Page 18]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   rehandshake, this implies that the HelloRequest will have message_seq
   = 0 and the ServerHello will have message_seq = 1.  When a message is
   retransmitted, the same message_seq value is used.  For example:

         Client                             Server
         ------                             ------
         ClientHello (seq=0)  ------>

                                 X<-- HelloVerifyRequest (seq=0)
                                                 (lost)

         [Timer Expires]

         ClientHello (seq=0)  ------>
         (retransmit)

                              <------ HelloVerifyRequest (seq=0)

         ClientHello (seq=1)  ------>
         (with cookie)

                              <------        ServerHello (seq=1)
                              <------        Certificate (seq=2)
                              <------    ServerHelloDone (seq=3)

         [Rest of handshake]

   Note, however, that from the perspective of the DTLS record layer,
   the retransmission is a new record.  This record will have a new
   DTLSPlaintext.sequence_number value.

   DTLS implementations maintain (at least notionally) a
   next_receive_seq counter.  This counter is initially set to zero.
   When a message is received, if its sequence number matches
   next_receive_seq, next_receive_seq is incremented and the message is
   processed.  If the sequence number is less than next_receive_seq, the
   message MUST be discarded.  If the sequence number is greater than
   next_receive_seq, the implementation SHOULD queue the message but MAY
   discard it.  (This is a simple space/bandwidth tradeoff).

[4.2.3](#section-4.2.3).  Handshake Message Fragmentation and Reassembly

   As noted in [Section 4.1.1](#section-4.1.1), each DTLS message MUST fit within a single
   transport layer datagram.  However, handshake messages are
   potentially bigger than the maximum record size.  Therefore, DTLS
   provides a mechanism for fragmenting a handshake message over a
   number of records, each of which can be transmitted separately, thus
   avoiding IP fragmentation.

Rescorla & Modadugu          Standards Track                   [Page 19]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   When transmitting the handshake message, the sender divides the
   message into a series of N contiguous data ranges.  These ranges MUST
   NOT be larger than the maximum handshake fragment size and MUST
   jointly contain the entire handshake message.  The ranges SHOULD NOT
   overlap.  The sender then creates N handshake messages, all with the
   same message_seq value as the original handshake message.  Each new
   message is labeled with the fragment_offset (the number of bytes
   contained in previous fragments) and the fragment_length (the length
   of this fragment).  The length field in all messages is the same as
   the length field of the original message.  An unfragmented message is
   a degenerate case with fragment_offset=0 and fragment_length=length.

   When a DTLS implementation receives a handshake message fragment, it
   MUST buffer it until it has the entire handshake message.  DTLS
   implementations MUST be able to handle overlapping fragment ranges.
   This allows senders to retransmit handshake messages with smaller
   fragment sizes if the PMTU estimate changes.

   Note that as with TLS, multiple handshake messages may be placed in
   the same DTLS record, provided that there is room and that they are
   part of the same flight.  Thus, there are two acceptable ways to pack
   two DTLS messages into the same datagram: in the same record or in
   separate records.

[4.2.4](#section-4.2.4).  Timeout and Retransmission

   DTLS messages are grouped into a series of message flights, according
   to the diagrams below.  Although each flight of messages may consist
   of a number of messages, they should be viewed as monolithic for the
   purpose of timeout and retransmission.

Rescorla & Modadugu          Standards Track                   [Page 20]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   Client                                          Server
   ------                                          ------

   ClientHello             -------->                           Flight 1

                           <-------    HelloVerifyRequest      Flight 2

   ClientHello             -------->                           Flight 3

                                              ServerHello    \
                                             Certificate*     \
                                       ServerKeyExchange*      Flight 4
                                      CertificateRequest*     /
                           <--------      ServerHelloDone    /

   Certificate*                                              \
   ClientKeyExchange                                          \
   CertificateVerify*                                          Flight 5
   [[ChangeCipherSpec](#ref-ChangeCipherSpec)]                                         /
   Finished                -------->                         /

                                       [ChangeCipherSpec]    \ Flight 6
                           <--------             Finished    /

               Figure 1. Message Flights for Full Handshake

   Client                                           Server
   ------                                           ------

   ClientHello             -------->                          Flight 1

                                              ServerHello    \
                                       [[ChangeCipherSpec](#ref-ChangeCipherSpec)]     Flight 2
                            <--------             Finished    /

   [ChangeCipherSpec]                                         \Flight 3
   Finished                 -------->                         /

         Figure 2. Message Flights for Session-Resuming Handshake
                           (No Cookie Exchange)

   DTLS uses a simple timeout and retransmission scheme with the
   following state machine.  Because DTLS clients send the first message
   (ClientHello), they start in the PREPARING state.  DTLS servers start
   in the WAITING state, but with empty buffers and no retransmit timer.

Rescorla & Modadugu          Standards Track                   [Page 21]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

                      +-----------+
                      | PREPARING |
                +---> |           | <--------------------+
                |     |           |                      |
                |     +-----------+                      |
                |           |                            |
                |           | Buffer next flight         |
                |           |                            |
                |          \|/                           |
                |     +-----------+                      |
                |     |           |                      |
                |     |  SENDING  |<------------------+  |
                |     |           |                   |  | Send
                |     +-----------+                   |  | HelloRequest
        Receive |           |                         |  |
           next |           | Send flight             |  | or
         flight |  +--------+                         |  |
                |  |        | Set retransmit timer    |  | Receive
                |  |       \|/                        |  | HelloRequest
                |  |  +-----------+                   |  | Send
                |  |  |           |                   |  | ClientHello
                +--)--|  WAITING  |-------------------+  |
                |  |  |           |   Timer expires   |  |
                |  |  +-----------+                   |  |
                |  |         |                        |  |
                |  |         |                        |  |
                |  |         +------------------------+  |
                |  |                Read retransmit      |
        Receive |  |                                     |
           last |  |                                     |
         flight |  |                                     |
                |  |                                     |
               \|/\|/                                    |
                                                         |
            +-----------+                                |
            |           |                                |
            | FINISHED  | -------------------------------+
            |           |
            +-----------+
                 |  /|\
                 |   |
                 |   |
                 +---+

              Read retransmit
           Retransmit last flight

          Figure 3. DTLS Timeout and Retransmission State Machine

Rescorla & Modadugu          Standards Track                   [Page 22]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   The state machine has three basic states.

   In the PREPARING state, the implementation does whatever computations
   are necessary to prepare the next flight of messages.  It then
   buffers them up for transmission (emptying the buffer first) and
   enters the SENDING state.

   In the SENDING state, the implementation transmits the buffered
   flight of messages.  Once the messages have been sent, the
   implementation then enters the FINISHED state if this is the last
   flight in the handshake.  Or, if the implementation expects to
   receive more messages, it sets a retransmit timer and then enters the
   WAITING state.

   There are three ways to exit the WAITING state:

   1. The retransmit timer expires: the implementation transitions to
      the SENDING state, where it retransmits the flight, resets the
      retransmit timer, and returns to the WAITING state.

   2. The implementation reads a retransmitted flight from the peer: the
      implementation transitions to the SENDING state, where it
      retransmits the flight, resets the retransmit timer, and returns
      to the WAITING state.  The rationale here is that the receipt of a
      duplicate message is the likely result of timer expiry on the peer
      and therefore suggests that part of one's previous flight was
      lost.

   3. The implementation receives the next flight of messages: if this
      is the final flight of messages, the implementation transitions to
      FINISHED.  If the implementation needs to send a new flight, it
      transitions to the PREPARING state.  Partial reads (whether
      partial messages or only some of the messages in the flight) do
      not cause state transitions or timer resets.

   Because DTLS clients send the first message (ClientHello), they start
   in the PREPARING state.  DTLS servers start in the WAITING state, but
   with empty buffers and no retransmit timer.

   When the server desires a rehandshake, it transitions from the
   FINISHED state to the PREPARING state to transmit the HelloRequest.
   When the client receives a HelloRequest, it transitions from FINISHED
   to PREPARING to transmit the ClientHello.

   In addition, for at least twice the default MSL defined for [[TCP](#ref-TCP "\"Transmission Control Protocol\"")],
   when in the FINISHED state, the node that transmits the last flight
   (the server in an ordinary handshake or the client in a resumed
   handshake) MUST respond to a retransmit of the peer's last flight

Rescorla & Modadugu          Standards Track                   [Page 23]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   with a retransmit of the last flight.  This avoids deadlock
   conditions if the last flight gets lost.  This requirement applies to
   DTLS 1.0 as well, and though not explicit in [[DTLS1](#ref-DTLS1 "\"Datagram Transport Layer Security\"")], it was always
   required for the state machine to function correctly.  To see why
   this is necessary, consider what happens in an ordinary handshake if
   the server's Finished message is lost: the server believes the
   handshake is complete but it actually is not.  As the client is
   waiting for the Finished message, the client's retransmit timer will
   fire and it will retransmit the client's Finished message.  This will
   cause the server to respond with its own Finished message, completing
   the handshake.  The same logic applies on the server side for the
   resumed handshake.

   Note that because of packet loss, it is possible for one side to be
   sending application data even though the other side has not received
   the first side's Finished message.  Implementations MUST either
   discard or buffer all application data packets for the new epoch
   until they have received the Finished message for that epoch.
   Implementations MAY treat receipt of application data with a new
   epoch prior to receipt of the corresponding Finished message as
   evidence of reordering or packet loss and retransmit their final
   flight immediately, shortcutting the retransmission timer.

[4.2.4.1](#section-4.2.4.1). Timer Values

   Though timer values are the choice of the implementation, mishandling
   of the timer can lead to serious congestion problems; for example, if
   many instances of a DTLS time out early and retransmit too quickly on
   a congested link.  Implementations SHOULD use an initial timer value
   of 1 second (the minimum defined in [RFC 6298](/doc/html/rfc6298) [[RFC6298](/doc/html/rfc6298 "\"Computing TCP's Retransmission Timer\"")]) and double
   the value at each retransmission, up to no less than the [RFC 6298](/doc/html/rfc6298)
   maximum of 60 seconds.  Note that we recommend a 1-second timer
   rather than the 3-second [RFC 6298](/doc/html/rfc6298) default in order to improve latency
   for time-sensitive applications.  Because DTLS only uses
   retransmission for handshake and not dataflow, the effect on
   congestion should be minimal.

   Implementations SHOULD retain the current timer value until a
   transmission without loss occurs, at which time the value may be
   reset to the initial value.  After a long period of idleness, no less
   than 10 times the current timer value, implementations may reset the
   timer to the initial value.  One situation where this might occur is
   when a rehandshake is used after substantial data transfer.

Rescorla & Modadugu          Standards Track                   [Page 24]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

[4.2.5](#section-4.2.5).  ChangeCipherSpec

   As with TLS, the ChangeCipherSpec message is not technically a
   handshake message but MUST be treated as part of the same flight as
   the associated Finished message for the purposes of timeout and
   retransmission.  This creates a potential ambiguity because the order
   of the ChangeCipherSpec cannot be established unambiguously with
   respect to the handshake messages in case of message loss.

   This is not a problem with any current TLS mode because the expected
   set of handshake messages logically preceeding the ChangeCipherSpec
   is predictable from the rest of the handshake state.  However, future
   modes MUST take care to avoid creating ambiguity.

[4.2.6](#section-4.2.6).  CertificateVerify and Finished Messages

   CertificateVerify and Finished messages have the same format as in
   TLS.  Hash calculations include entire handshake messages, including
   DTLS-specific fields: message_seq, fragment_offset, and
   fragment_length.  However, in order to remove sensitivity to
   handshake message fragmentation, the Finished MAC MUST be computed as
   if each handshake message had been sent as a single fragment.  Note
   that in cases where the cookie exchange is used, the initial
   ClientHello and HelloVerifyRequest MUST NOT be included in the
   CertificateVerify or Finished MAC computations.

[4.2.7](#section-4.2.7).  Alert Messages

   Note that Alert messages are not retransmitted at all, even when they
   occur in the context of a handshake.  However, a DTLS implementation
   which would ordinarily issue an alert SHOULD generate a new alert
   message if the offending record is received again (e.g., as a
   retransmitted handshake message).  Implementations SHOULD detect when
   a peer is persistently sending bad messages and terminate the local
   connection state after such misbehavior is detected.

[4.2.8](#section-4.2.8).  Establishing New Associations with Existing Parameters

   If a DTLS client-server pair is configured in such a way that
   repeated connections happen on the same host/port quartet, then it is
   possible that a client will silently abandon one connection and then
   initiate another with the same parameters (e.g., after a reboot).
   This will appear to the server as a new handshake with epoch=0.  In
   cases where a server believes it has an existing association on a
   given host/port quartet and it receives an epoch=0 ClientHello, it
   SHOULD proceed with a new handshake but MUST NOT destroy the existing
   association until the client has demonstrated reachability either by
   completing a cookie exchange or by completing a complete handshake

Rescorla & Modadugu          Standards Track                   [Page 25]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   including delivering a verifiable Finished message.  After a correct
   Finished message is received, the server MUST abandon the previous
   association to avoid confusion between two valid associations with
   overlapping epochs.  The reachability requirement prevents
   off-path/blind attackers from destroying associations merely by
   sending forged ClientHellos.

[4.3](#section-4.3).  Summary of New Syntax

   This section includes specifications for the data structures that
   have changed between TLS 1.2 and DTLS 1.2. See [[TLS12](#ref-TLS12 "\"The Transport Layer Security (TLS) Protocol Version 1.2\"")] for the
   definition of this syntax.

[4.3.1](#section-4.3.1).  Record Layer

   struct {
        ContentType type;
        ProtocolVersion version;
        uint16 epoch;                                     // New field
        uint48 sequence_number;                           // New field
        uint16 length;
        opaque fragment[DTLSPlaintext.length];
      } DTLSPlaintext;

      struct {
        ContentType type;
        ProtocolVersion version;
        uint16 epoch;                                     // New field
        uint48 sequence_number;                           // New field
        uint16 length;
        opaque fragment[DTLSCompressed.length];
      } DTLSCompressed;

      struct {
        ContentType type;
        ProtocolVersion version;
        uint16 epoch;                                     // New field
        uint48 sequence_number;                           // New field
        uint16 length;
        select (CipherSpec.cipher_type) {
          case block:  GenericBlockCipher;
          case aead:   GenericAEADCipher;                 // New field
        } fragment;
      } DTLSCiphertext;

Rescorla & Modadugu          Standards Track                   [Page 26]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

[4.3.2](#section-4.3.2).  Handshake Protocol

   enum {
     hello_request(0), client_hello(1), server_hello(2),
     hello_verify_request(3),                          // New field
     certificate(11), server_key_exchange (12),
     certificate_request(13), server_hello_done(14),
     certificate_verify(15), client_key_exchange(16),
     finished(20), (255) } HandshakeType;

   struct {
     HandshakeType msg_type;
     uint24 length;
     uint16 message_seq;                               // New field
     uint24 fragment_offset;                           // New field
     uint24 fragment_length;                           // New field
     select (HandshakeType) {
       case hello_request: HelloRequest;
       case client_hello:  ClientHello;
       case server_hello:  ServerHello;
       case hello_verify_request: HelloVerifyRequest;  // New field
       case certificate:Certificate;
       case server_key_exchange: ServerKeyExchange;
       case certificate_request: CertificateRequest;
       case server_hello_done:ServerHelloDone;
       case certificate_verify:  CertificateVerify;
       case client_key_exchange: ClientKeyExchange;
       case finished: Finished;
     } body; } Handshake;

   struct {
     ProtocolVersion client_version;
     Random random;
     SessionID session_id;
     opaque cookie<0..2^8-1>;                             // New field
     CipherSuite cipher_suites<2..2^16-1>;
     CompressionMethod compression_methods<1..2^8-1>; } ClientHello;

   struct {
     ProtocolVersion server_version;
     opaque cookie<0..2^8-1>; } HelloVerifyRequest;

[5](#section-5).  Security Considerations

   This document describes a variant of TLS 1.2; therefore, most of the
   security considerations are the same as those of TLS 1.2 [[TLS12](#ref-TLS12 "\"The Transport Layer Security (TLS) Protocol Version 1.2\"")],
   described in Appendices D, E, and F.

Rescorla & Modadugu          Standards Track                   [Page 27]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   The primary additional security consideration raised by DTLS is that
   of denial of service.  DTLS includes a cookie exchange designed to
   protect against denial of service.  However, implementations that do
   not use this cookie exchange are still vulnerable to DoS.  In
   particular, DTLS servers that do not use the cookie exchange may be
   used as attack amplifiers even if they themselves are not
   experiencing DoS.  Therefore, DTLS servers SHOULD use the cookie
   exchange unless there is good reason to believe that amplification is
   not a threat in their environment.  Clients MUST be prepared to do a
   cookie exchange with every handshake.

   Unlike TLS implementations, DTLS implementations SHOULD NOT respond
   to invalid records by terminating the connection.  See [Section](#section-4.1.2.7)
   [4.1.2.7](#section-4.1.2.7) for details on this.

[6](#section-6).  Acknowledgments

   The authors would like to thank Dan Boneh, Eu-Jin Goh, Russ Housley,
   Constantine Sapuntzakis, and Hovav Shacham for discussions and
   comments on the design of DTLS.  Thanks to the anonymous NDSS
   reviewers of our original NDSS paper on DTLS [[DTLS](#ref-DTLS "\"The Design and Implementation of Datagram TLS\"")] for their
   comments.  Also, thanks to Steve Kent for feedback that helped
   clarify many points.  The section on PMTU was cribbed from the DCCP
   specification [[DCCP](#ref-DCCP "\"Datagram Congestion Control Protocol (DCCP)\"")].  Pasi Eronen provided a detailed review of this
   specification.  Peter Saint-Andre provided the list of changes in
   [Section 8](#section-8).  Helpful comments on the document were also received from
   Mark Allman, Jari Arkko, Mohamed Badra, Michael D'Errico, Adrian
   Farrell, Joel Halpern, Ted Hardie, Charlia Kaufman, Pekka Savola,
   Allison Mankin, Nikos Mavrogiannopoulos, Alexey Melnikov, Robin
   Seggelmann, Michael Tuexen, Juho Vaha-Herttua, and Florian Weimer.

[7](#section-7).  IANA Considerations

   This document uses the same identifier space as TLS [[TLS12](#ref-TLS12 "\"The Transport Layer Security (TLS) Protocol Version 1.2\"")], so no
   new IANA registries are required.  When new identifiers are assigned
   for TLS, authors MUST specify whether they are suitable for DTLS.
   IANA has modified all TLS parameter registries to add a DTLS-OK flag,
   indicating whether the specification may be used with DTLS.  At the
   time of publication, all of the [[TLS12](#ref-TLS12 "\"The Transport Layer Security (TLS) Protocol Version 1.2\"")] registrations except the
   following are suitable for DTLS.  The full table of registrations is
   available at [[IANA](#ref-IANA "\"Transport Layer Security (TLS) Parameters\"")].

   From the TLS Cipher Suite Registry:

      0x00,0x03 TLS_RSA_EXPORT_WITH_RC4_40_MD5        [[RFC4346](/doc/html/rfc4346)]
      0x00,0x04 TLS_RSA_WITH_RC4_128_MD5              [[RFC5246](/doc/html/rfc5246)]
      0x00,0x05 TLS_RSA_WITH_RC4_128_SHA              [[RFC5246](/doc/html/rfc5246)]
      0x00,0x17 TLS_DH_anon_EXPORT_WITH_RC4_40_MD5    [[RFC4346](/doc/html/rfc4346)]

Rescorla & Modadugu          Standards Track                   [Page 28]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

      0x00,0x18 TLS_DH_anon_WITH_RC4_128_MD5          [[RFC5246](/doc/html/rfc5246)]
      0x00,0x20 TLS_KRB5_WITH_RC4_128_SHA             [[RFC2712](/doc/html/rfc2712)]
      0x00,0x24 TLS_KRB5_WITH_RC4_128_MD5             [[RFC2712](/doc/html/rfc2712)]
      0x00,0x28 TLS_KRB5_EXPORT_WITH_RC4_40_SHA       [[RFC2712](/doc/html/rfc2712)]
      0x00,0x2B TLS_KRB5_EXPORT_WITH_RC4_40_MD5       [[RFC2712](/doc/html/rfc2712)]
      0x00,0x8A TLS_PSK_WITH_RC4_128_SHA              [[RFC4279](/doc/html/rfc4279)]
      0x00,0x8E TLS_DHE_PSK_WITH_RC4_128_SHA          [[RFC4279](/doc/html/rfc4279)]
      0x00,0x92 TLS_RSA_PSK_WITH_RC4_128_SHA          [[RFC4279](/doc/html/rfc4279)]
      0xC0,0x02 TLS_ECDH_ECDSA_WITH_RC4_128_SHA       [[RFC4492](/doc/html/rfc4492)]
      0xC0,0x07 TLS_ECDHE_ECDSA_WITH_RC4_128_SHA      [[RFC4492](/doc/html/rfc4492)]
      0xC0,0x0C TLS_ECDH_RSA_WITH_RC4_128_SHA         [[RFC4492](/doc/html/rfc4492)]
      0xC0,0x11 TLS_ECDHE_RSA_WITH_RC4_128_SHA        [[RFC4492](/doc/html/rfc4492)]
      0xC0,0x16 TLS_ECDH_anon_WITH_RC4_128_SHA        [[RFC4492](/doc/html/rfc4492)]
      0xC0,0x33 TLS_ECDHE_PSK_WITH_RC4_128_SHA        [[RFC5489](/doc/html/rfc5489)]

   From the TLS Exporter Label Registry:

      client EAP encryption       [[RFC5216](/doc/html/rfc5216)]
      ttls   keying material      [[RFC5281](/doc/html/rfc5281)]
      ttls   challenge            [[RFC5281](/doc/html/rfc5281)]

   This document defines a new handshake message, hello_verify_request,
   whose value has been allocated from the TLS HandshakeType registry
   defined in [[TLS12](#ref-TLS12 "\"The Transport Layer Security (TLS) Protocol Version 1.2\"")].  The value "3" has been assigned by the IANA.

[8](#section-8).  Changes since DTLS 1.0

   This document reflects the following changes since DTLS 1.0 [[DTLS1](#ref-DTLS1 "\"Datagram Transport Layer Security\"")].

   -  Updated to match TLS 1.2 [[TLS12](#ref-TLS12 "\"The Transport Layer Security (TLS) Protocol Version 1.2\"")].

   -  Addition of AEAD Ciphers in [Section 4.1.2.3](#section-4.1.2.3) (tracking changes in
      TLS 1.2.

   -  Clarifications regarding sequence numbers and epochs in [Section](#section-4.1)
      [4.1](#section-4.1) and a clear procedure for dealing with state loss in [Section](#section-4.2.8)
      [4.2.8](#section-4.2.8).

   -  Clarifications and more detailed rules regarding Path MTU issues
      in [Section 4.1.1.1](#section-4.1.1.1). Clarification of the fragmentation text
      throughout.

   -  Clarifications regarding handling of invalid records in [Section](#section-4.1.2.7)
      [4.1.2.7](#section-4.1.2.7).

   -  A new paragraph describing handling of invalid cookies at the end
      of [Section 4.2.1](#section-4.2.1).

Rescorla & Modadugu          Standards Track                   [Page 29]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   -  Some new text describing how to avoid handshake deadlock
      conditions at the end of [Section 4.2.4](#section-4.2.4).

   -  Some new text about CertificateVerify messages in [Section 4.2.6](#section-4.2.6).

   -  A prohibition on epoch wrapping in [Section 4.1](#section-4.1).

   -  Clarification of the IANA requirements and the explicit
      requirement for a new IANA registration flag for each parameter.

   -  Added a record sequence number mirroring technique for handling
      repeated ClientHello messages.

   -  Recommend a fixed version number for HelloVerifyRequest.

   -  Numerous editorial changes.

[9](#section-9).  References

[9.1](#section-9.1).  Normative References

   [REQ]       Bradner, S., "Key words for use in RFCs to Indicate
               Requirement Levels", [BCP 14](/doc/html/bcp14), [RFC 2119](/doc/html/rfc2119), March 1997.

   [RFC1191]   Mogul, J. and S. Deering, "Path MTU discovery", [RFC 1191](/doc/html/rfc1191),
               November 1990.

   [RFC4301]   Kent, S. and K. Seo, "Security Architecture for the
               Internet Protocol", [RFC 4301](/doc/html/rfc4301), December 2005.

   [RFC4443]   Conta, A., Deering, S., and M. Gupta, Ed., "Internet
               Control Message Protocol (ICMPv6) for the Internet
               Protocol Version 6 (IPv6) Specification", [RFC 4443](/doc/html/rfc4443), March
               2006.

   [RFC4821]   Mathis, M. and J. Heffner, "Packetization Layer Path MTU
               Discovery", [RFC 4821](/doc/html/rfc4821), March 2007.

   [RFC6298]   Paxson, V., Allman, M., Chu, J., and M. Sargent,
               "Computing TCP's Retransmission Timer", [RFC 6298](/doc/html/rfc6298), June
               2011.

   [RSAGCM]    Salowey, J., Choudhury, A., and D. McGrew, "AES Galois
               Counter Mode (GCM) Cipher Suites for TLS", [RFC 5288](/doc/html/rfc5288),
               August 2008.

   [TCP]       Postel, J., "Transmission Control Protocol", STD 7, [RFC](/doc/html/rfc793)
               [793](/doc/html/rfc793), September 1981.

Rescorla & Modadugu          Standards Track                   [Page 30]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   [TLS12]     Dierks, T. and E. Rescorla, "The Transport Layer Security
               (TLS) Protocol Version 1.2", [RFC 5246](/doc/html/rfc5246), August 2008.

[9.2](#section-9.2).  Informative References

   [DCCP]      Kohler, E., Handley, M., and S. Floyd, "Datagram
               Congestion Control Protocol (DCCP)", [RFC 4340](/doc/html/rfc4340), March
               2006.

   [DCCPDTLS]  Phelan, T., "Datagram Transport Layer Security (DTLS)
               over the Datagram Congestion Control Protocol (DCCP)",
               [RFC 5238](/doc/html/rfc5238), May 2008.

   [DTLS]      Modadugu, N. and E. Rescorla, "The Design and
               Implementation of Datagram TLS", Proceedings of ISOC NDSS
               2004, February 2004.

   [DTLS1]     Rescorla, E. and N. Modadugu, "Datagram Transport Layer
               Security", [RFC 4347](/doc/html/rfc4347), April 2006.

   [ECCGCM]    Rescorla, E., "TLS Elliptic Curve Cipher Suites with
               SHA-256/384 and AES Galois Counter Mode (GCM)", [RFC 5289](/doc/html/rfc5289),
               August 2008.

   [ESP]       Kent, S., "IP Encapsulating Security Payload (ESP)", [RFC](/doc/html/rfc4303)
               [4303](/doc/html/rfc4303), December 2005.

   [IANA]      IANA, "Transport Layer Security (TLS) Parameters",
               <http://www.iana.org/assignments/tls-parameters>.

   [IKEv2]     Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen,
               "Internet Key Exchange Protocol Version 2 (IKEv2)", [RFC](/doc/html/rfc5996)
               [5996](/doc/html/rfc5996), September 2010.

   [IMAP]      Crispin, M., "INTERNET MESSAGE ACCESS PROTOCOL - VERSION
               4rev1", [RFC 3501](/doc/html/rfc3501), March 2003.

   [PHOTURIS]  Karn, P. and W. Simpson, "Photuris: Session-Key
               Management Protocol", [RFC 2522](/doc/html/rfc2522), March 1999.

   [POP]       Myers, J. and M. Rose, "Post Office Protocol - Version
               3", STD 53, [RFC 1939](/doc/html/rfc1939), May 1996.

   [SIP]       Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
               A., Peterson, J., Sparks, R., Handley, M., and E.
               Schooler, "SIP: Session Initiation Protocol", [RFC 3261](/doc/html/rfc3261),
               June 2002.

Rescorla & Modadugu          Standards Track                   [Page 31]
```

---

```

[RFC 6347](/doc/html/rfc6347)                          DTLS                      January 2012

   [TLS]       Dierks, T. and C. Allen, "The TLS Protocol Version 1.0",
               [RFC 2246](/doc/html/rfc2246), January 1999.

   [TLS11]     Dierks, T. and E. Rescorla, "The Transport Layer Security
               (TLS) Protocol Version 1.1", [RFC 4346](/doc/html/rfc4346), April 2006.

   [WHYIPSEC]  Bellovin, S., "Guidelines for Specifying the Use of IPsec
               Version 2", [BCP 146](/doc/html/bcp146), [RFC 5406](/doc/html/rfc5406), February 2009.

Authors' Addresses

   Eric Rescorla
   RTFM, Inc.
   2064 Edgewood Drive
   Palo Alto, CA 94303

   EMail: ekr@rtfm.com

   Nagendra Modadugu
   Google, Inc.

   EMail: nagendra@cs.stanford.edu

Rescorla & Modadugu          Standards Track                   [Page 32]

```

[Datatracker](/doc/rfc6347/)

RFC 6347

RFC
- Proposed Standard

* Info
* Contents
* Prefs

| Document | Document type |  | RFC - Proposed Standard  January 2012  [View errata](https://www.rfc-editor.org/errata_search.php?rfc=6347 "Click to view errata.") [Report errata](https://www.rfc-editor.org/errata.php#reportnew "Click to report an error in the document.") [IPR](/ipr/search/?submit=draft&id=rfc6347 "Click to view IPR declarations.") Obsoleted by [RFC 9147](/doc/html/rfc9147 "The Datagram Transport Layer Security (DTLS) Protocol Version 1.3") Updated by [RFC 8996](/doc/html/rfc8996 "Deprecating TLS 1.0 and TLS 1.1"), [RFC 9146](/doc/html/rfc9146 "Connection Identifier for DTLS 1.2"), [RFC 7507](/doc/html/rfc7507 "TLS Fallback Signaling Cipher Suite Value (SCSV) for Preventing Protocol Downgrade Attacks"), [RFC 7905](/doc/html/rfc7905 "ChaCha20-Poly1305 Cipher Suites for Transport Layer Security (TLS)") Obsoletes [RFC 4347](/doc/html/rfc4347 "Datagram Transport Layer Security") Was [draft-ietf-tls-rfc4347-bis](/doc/draft-ietf-tls-rfc4347-bis/06/) ([tls WG](/wg/tls/about/)) |
| --- | --- | --- | --- |
|  | Select version |  | * [06](/doc/html/draft-ietf-tls-rfc4347-bis-06) * [RFC 6347](/doc/html/rfc6347) |
|  | Compare versions |  | RFC 6347  draft-ietf-tls-rfc4347-bis-06  draft-ietf-tls-rfc4347-bis-05  draft-ietf-tls-rfc4347-bis-04  draft-ietf-tls-rfc4347-bis-03  draft-ietf-tls-rfc4347-bis-02  draft-ietf-tls-rfc4347-bis-01  draft-ietf-tls-rfc4347-bis-00   RFC 6347  draft-ietf-tls-rfc4347-bis-06  draft-ietf-tls-rfc4347-bis-05  draft-ietf-tls-rfc4347-bis-04  draft-ietf-tls-rfc4347-bis-03  draft-ietf-tls-rfc4347-bis-02  draft-ietf-tls-rfc4347-bis-01  draft-ietf-tls-rfc4347-bis-00   Side-by-side  Inline |
|  | Authors |  | [Eric Rescorla](/person/ekr%40rtfm.com "Datatracker profile of Eric Rescorla") , [Nagendra Modadugu](/person/Nagendra%40cs.stanford.edu "Datatracker profile of Nagendra Modadugu")   Email authors |
|  | RFC stream |  | IETF Logo IETF Logo |
|  | Other formats |  | [txt](https://www.rfc-editor.org/rfc/rfc6347.txt) [html](https://www.rfc-editor.org/rfc/rfc6347.html) [pdf](https://www.rfc-editor.org/rfc/pdfrfc/rfc6347.txt.pdf) [bibtex](/doc/rfc6347/bibtex/) |
|  | Additional resources |  | [Mailing list discussion](https://mailarchive.ietf.org/arch/browse/tls/?q=rfc6347 OR %22draft-ietf-tls-rfc4347-bis%22) |

[Report a datatracker bug](https://github.com/ietf-tools/datatracker/issues/new/choose)

Show sidebar by default

Yes

No

Tab to show by default

Info

Contents

HTMLization configuration

HTMLize the plaintext

Plaintextify the HTML

Maximum font size

Page dependencies

Inline

Reference

Citation links

 Go to reference section

Go to linked document

![](//analytics.ietf.org/piwik.php?idsite=7)



=== Content from mailarchive.ietf.org_b1575f45_20250108_150717.html ===


[![IETF Logo](https://static.ietf.org/mailarchive/2.28.0/mlarchive/images/ietflogo-small-transparent.png)
Mail Archive](/)

* [Search www.ietf.org](https://www.ietf.org/search/)
* [Search Datatracker](https://datatracker.ietf.org)
* Help
  [Search Syntax](/arch/help/)
  [API Reference](/docs/api-reference/)
* Settings
  + Turn Static Mode On
* [Sign in](/oidc/authenticate/)

* [Date](/arch/browse/tls/?index=hlW5oeiZ-ZsrThTG2FgrlFhA-8s)
* [Thread](/arch/browse/tls/?gbt=1&index=hlW5oeiZ-ZsrThTG2FgrlFhA-8s)

### [TLS] HELLO\_VERIFY\_REQUEST during abbreviated handshake (session resumption)

Simon Bernard <contact@simonbernard.eu>
Wed, 03 October 2018 14:04 UTC

Return-Path: <contact@simonbernard.eu>

X-Original-To: tls@ietfa.amsl.com

Delivered-To: tls@ietfa.amsl.com

Received: from localhost (localhost [127.0.0.1]) by ietfa.amsl.com (Postfix) with ESMTP id 6317C13129A for <tls@ietfa.amsl.com>; Wed, 3 Oct 2018 07:04:21 -0700 (PDT)

X-Virus-Scanned: amavisd-new at amsl.com

X-Spam-Flag: NO

X-Spam-Score: -0.002

X-Spam-Level:

X-Spam-Status: No, score=-0.002 tagged\_above=-999 required=5 tests=[BAYES\_20=-0.001, RCVD\_IN\_DNSWL\_NONE=-0.0001, SPF\_PASS=-0.001] autolearn=ham autolearn\_force=no

Received: from mail.ietf.org ([4.31.198.44]) by localhost (ietfa.amsl.com [127.0.0.1]) (amavisd-new, port 10024) with ESMTP id TFFMqaW3NRav for <tls@ietfa.amsl.com>; Wed, 3 Oct 2018 07:04:19 -0700 (PDT)

Received: from 8.mo173.mail-out.ovh.net (8.mo173.mail-out.ovh.net [46.105.46.122]) (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits)) (No client certificate requested) by ietfa.amsl.com (Postfix) with ESMTPS id 6F3C21312AD for <tls@ietf.org>; Wed, 3 Oct 2018 07:04:18 -0700 (PDT)

Received: from player693.ha.ovh.net (unknown [10.109.159.123]) by mo173.mail-out.ovh.net (Postfix) with ESMTP id 89AE7D9533 for <tls@ietf.org>; Wed, 3 Oct 2018 16:04:15 +0200 (CEST)

Received: from [10.41.51.103] (134.163-14-84.ripe.coltfrance.com [84.14.163.134]) (Authenticated sender: contact@simonbernard.eu) by player693.ha.ovh.net (Postfix) with ESMTPSA id 5115A4400D2 for <tls@ietf.org>; Wed, 3 Oct 2018 16:04:14 +0200 (CEST)

To: "tls@ietf.org" <tls@ietf.org>

From: Simon Bernard <contact@simonbernard.eu>

Message-ID: <6bab54cd-e903-ac3e-a186-077458a2d652@simonbernard.eu>

Date: Wed, 03 Oct 2018 16:04:07 +0200

User-Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:60.0) Gecko/20100101 Thunderbird/60.0

MIME-Version: 1.0

Content-Type: text/plain; charset="utf-8"; format="flowed"

Content-Transfer-Encoding: 8bit

Content-Language: en-US

X-Ovh-Tracer-Id: 14726489307834956017

X-VR-SPAMSTATE: OK

X-VR-SPAMSCORE: 0

X-VR-SPAMCAUSE: gggruggvucftvghtrhhoucdtuddrgedtkedrtddvgdejhecutefuodetggdotefrodftvfcurfhrohhfihhlvgemucfqggfjpdevjffgvefmvefgnecuuegrihhlohhuthemucehtddtnecu

Archived-At: <https://mailarchive.ietf.org/arch/msg/tls/hlW5oeiZ-ZsrThTG2FgrlFhA-8s>

Subject: [TLS] HELLO\_VERIFY\_REQUEST during abbreviated handshake (session resumption)

X-BeenThere: tls@ietf.org

X-Mailman-Version: 2.1.29

Precedence: list

List-Id: "This is the mailing list for the Transport Layer Security working group of the IETF." <tls.ietf.org>

List-Unsubscribe: <https://www.ietf.org/mailman/options/tls>, <mailto:tls-request@ietf.org?subject=unsubscribe>

List-Archive: <https://mailarchive.ietf.org/arch/browse/tls/>

List-Post: <mailto:tls@ietf.org>

List-Help: <mailto:tls-request@ietf.org?subject=help>

List-Subscribe: <https://www.ietf.org/mailman/listinfo/tls>, <mailto:tls-request@ietf.org?subject=subscribe>

X-List-Received-Date: Wed, 03 Oct 2018 14:04:21 -0000

```
Hi,

    In DTLS 1.2 over UDP, I would like to know what is the
recommendation about using HELLO_VERIFY_REQUEST during an abbreviated
handshake.

    Should we send it all the time ? or could we avoid to send it if
SESSION ID is known ?

Thx,

Simon

```

* [[TLS] HELLO\_VERIFY\_REQUEST during abbreviated han…](/arch/msg/tls/hlW5oeiZ-ZsrThTG2FgrlFhA-8s/)  Simon Bernard
* [Re: [TLS] HELLO\_VERIFY\_REQUEST during abbreviated…](/arch/msg/tls/_M1VbGXvB3JwpXF49LPDh8W6Pjg/)  Eric Rescorla
* [Re: [TLS] HELLO\_VERIFY\_REQUEST during abbreviated…](/arch/msg/tls/ZW_FY_Vncumv3WwZLd7jD5lPhJE/)  Simon Bernard

* Hide Navigation Bar

Date

Thread

* [Date](/arch/browse/tls/?index=hlW5oeiZ-ZsrThTG2FgrlFhA-8s)
* [Thread](/arch/browse/tls/?gbt=1&index=hlW5oeiZ-ZsrThTG2FgrlFhA-8s)

v2.28.0 | [Report a Bug](https://github.com/ietf-tools/mailarch/issues) | By Email | [System Status](https://status.ietf.org)



=== Content from www.rfc-editor.org_ea13465f_20250108_150723.html ===

[[RFC Home](https://www.rfc-editor.org "RFC Editor")] [[TEXT](/rfc/rfc5246.txt)|[PDF](/rfc/pdfrfc/rfc5246.txt.pdf)|[HTML](/rfc/rfc5246.html)] [[Tracker](https://datatracker.ietf.org/doc/rfc5246 "IETF Datatracker information for this document")] [[IPR](https://datatracker.ietf.org/ipr/search/?rfc=5246&submit=rfc "IPR disclosures related to this document")] [[Errata](/errata/rfc5246)] [[Info page](https://www.rfc-editor.org/info/rfc5246 "Info page")]

Obsoleted by: [8446](/rfc/rfc8446) PROPOSED STANDARD
Updated by: [5746](/rfc/rfc5746), [5878](/rfc/rfc5878), [6176](/rfc/rfc6176), [7465](/rfc/rfc7465), [7507](/rfc/rfc7507), [7568](/rfc/rfc7568), [7627](/rfc/rfc7627),
 [7685](/rfc/rfc7685), [7905](/rfc/rfc7905), [7919](/rfc/rfc7919), [8447](/rfc/rfc8447), [9155](/rfc/rfc9155) Errata Exist


=== Content from github.com_78c02bde_20250108_150725.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Fpull%2F2039)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Fpull%2F2039)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=eclipse-californium%2Fcalifornium)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eclipse-californium](/eclipse-californium)
/
**[californium](/eclipse-californium/californium)**
Public

* [Notifications](/login?return_to=%2Feclipse-californium%2Fcalifornium) You must be signed in to change notification settings
* [Fork
  368](/login?return_to=%2Feclipse-californium%2Fcalifornium)
* [Star
   731](/login?return_to=%2Feclipse-californium%2Fcalifornium)

* [Code](/eclipse-californium/californium)
* [Issues
  16](/eclipse-californium/californium/issues)
* [Pull requests
  0](/eclipse-californium/californium/pulls)
* [Actions](/eclipse-californium/californium/actions)
* [Projects
  0](/eclipse-californium/californium/projects)
* [Wiki](/eclipse-californium/californium/wiki)
* [Security](/eclipse-californium/californium/security)
* [Insights](/eclipse-californium/californium/pulse)

Additional navigation options

* [Code](/eclipse-californium/californium)
* [Issues](/eclipse-californium/californium/issues)
* [Pull requests](/eclipse-californium/californium/pulls)
* [Actions](/eclipse-californium/californium/actions)
* [Projects](/eclipse-californium/californium/projects)
* [Wiki](/eclipse-californium/californium/wiki)
* [Security](/eclipse-californium/californium/security)
* [Insights](/eclipse-californium/californium/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Feclipse-californium%2Fcalifornium%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Feclipse-californium%2Fcalifornium%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix sending HelloVerifyRequest #2039

 Merged

[boaks](/boaks)
merged 1 commit into
[eclipse-californium:main](/eclipse-californium/californium/tree/main "eclipse-californium/californium:main")
from
[boaks:fix\_hello\_verify\_request](/boaks/californium/tree/fix_hello_verify_request "boaks/californium:fix_hello_verify_request")

Jul 7, 2022

 Merged

# [Fix sending HelloVerifyRequest](#top) #2039

[boaks](/boaks)
merged 1 commit into
[eclipse-californium:main](/eclipse-californium/californium/tree/main "eclipse-californium/californium:main")
from
[boaks:fix\_hello\_verify\_request](/boaks/californium/tree/fix_hello_verify_request "boaks/californium:fix_hello_verify_request")

Jul 7, 2022

[Conversation
0](/eclipse-californium/californium/pull/2039)
[Commits
1](/eclipse-californium/californium/pull/2039/commits)
[Checks
0](/eclipse-californium/californium/pull/2039/checks)
[Files changed](/eclipse-californium/californium/pull/2039/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![boaks](https://avatars.githubusercontent.com/u/10937819?s=60&v=4)](/boaks)

Copy link

Contributor

### @boaks **[boaks](/boaks)** commented [Jul 5, 2022](#issue-1294481125)

Fix sending HelloVerifyRequest, if a fallback to a full-handshake is required.

Signed-off-by: Achim Kraus achim.kraus@cloudcoap.net

Sorry, something went wrong.

All reactions

[![@boaks](https://avatars.githubusercontent.com/u/10937819?s=40&v=4)](/boaks)

`[Fix sending HelloVerifyRequest, if a fallback to a full-handshake is](/eclipse-californium/californium/pull/2039/commits/04808756630ff8e35035a48de243cc822b3d4af5 "Fix sending HelloVerifyRequest, if a fallback to a full-handshake is
required.

Signed-off-by: Achim Kraus <achim.kraus@cloudcoap.net>")`
 …

`[0480875](/eclipse-californium/californium/pull/2039/commits/04808756630ff8e35035a48de243cc822b3d4af5)`

```
required.

Signed-off-by: Achim Kraus <achim.kraus@cloudcoap.net>
```

[![@boaks](https://avatars.githubusercontent.com/u/10937819?s=40&u=b2436e3877593b6ea605d6862a777bf473ec159f&v=4)](/boaks)
[boaks](/boaks)
merged commit [`0cc953a`](/eclipse-californium/californium/commit/0cc953a1dc071efc960130e229fcb4f8bda7f9df)
into
eclipse-californium:main

[Jul 7, 2022](https://github.com/eclipse-californium/californium/pull/2039#event-6947977809)

[![@boaks](https://avatars.githubusercontent.com/u/10937819?s=40&u=b2436e3877593b6ea605d6862a777bf473ec159f&v=4)](/boaks)
[boaks](/boaks)
mentioned this pull request
[Aug 4, 2022](#ref-pullrequest-1328572953)

[Test fix for sending HelloVerifyRequest
#2053](/eclipse-californium/californium/pull/2053)
 Merged

 [![@boaks](https://avatars.githubusercontent.com/u/10937819?s=40&u=b2436e3877593b6ea605d6862a777bf473ec159f&v=4)](/boaks)
[boaks](/boaks)
deleted the
fix\_hello\_verify\_request

branch
[August 20, 2022 13:27](#event-7226317203)

[![@tdunlap607](https://avatars.githubusercontent.com/u/16122665?s=40&v=4)](/tdunlap607)
[tdunlap607](/tdunlap607)
mentioned this pull request
[Apr 19, 2023](#ref-pullrequest-1673990279)

[[GHSA-qq3j-44gw-cf6r] Eclipse Californium denial of service (DoS) via Datagram Transport Layer Security (DTLS) handshake on parameter mismatch
github/advisory-database#2118](/github/advisory-database/pull/2118)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Fpull%2F2039)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

1 participant

[![@boaks](https://avatars.githubusercontent.com/u/10937819?s=52&v=4)](/boaks)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.eclipse.org_2c38a917_20250108_150726.html ===


[![logo]()](https://www.eclipse.org/)

* [Download](https://www.eclipse.org/downloads/)
* [Getting Started](https://www.eclipse.org/users/)
* [Members](https://www.eclipse.org/membership/)
* [Projects](https://www.eclipse.org/projects/)
* Community
  + [Marketplace](http://marketplace.eclipse.org)
  + [Events](http://events.eclipse.org)
  + [Planet Eclipse](http://www.planeteclipse.org/)
  + [Newsletter](https://www.eclipse.org/community/eclipse_newsletter/)
  + [Videos](https://www.youtube.com/user/EclipseFdn)
* Participate
  + [Report a Bug](https://bugs.eclipse.org/bugs/)
  + [Forums](https://www.eclipse.org/forums/)
  + [Mailing Lists](https://www.eclipse.org/mail/)
  + [Wiki](https://wiki.eclipse.org/)
  + [IRC](https://wiki.eclipse.org/IRC)
  + [How to Contribute](https://www.eclipse.org/contribute/)
* Working Groups
  + [Automotive](http://wiki.eclipse.org/Auto_IWG)
  + [Internet of Things](http://iot.eclipse.org)
  + [LocationTech](http://locationtech.org)
  + [Long-Term Support](http://lts.eclipse.org)
  + [PolarSys](http://polarsys.org)
  + [Science](http://science.eclipse.org)
  + [OpenMDM](http://www.openmdm.org)
* More
  + - **Community**
    - [Marketplace](http://marketplace.eclipse.org)
    - [Events](http://events.eclipse.org)
    - [Planet Eclipse](http://www.planeteclipse.org/)
    - [Newsletter](https://www.eclipse.org/community/eclipse_newsletter/)
    - [Videos](https://www.youtube.com/user/EclipseFdn)
    - **Participate**
    - [Report a Bug](https://bugs.eclipse.org/bugs/)
    - [Forums](https://www.eclipse.org/forums/)
    - [Mailing Lists](https://www.eclipse.org/mail/)
    - [Wiki](https://wiki.eclipse.org/)
    - [IRC](https://wiki.eclipse.org/IRC)
    - [How to Contribute](https://www.eclipse.org/contribute/)
    - **Working Groups**
    - [Automotive](http://wiki.eclipse.org/Auto_IWG)
    - [Internet of Things](http://iot.eclipse.org)
    - [LocationTech](http://locationtech.org)
    - [Long-Term Support](http://lts.eclipse.org)
    - [PolarSys](http://polarsys.org)
    - [Science](http://science.eclipse.org)
    - [OpenMDM](http://www.openmdm.org)

Toggle navigation

[![logo](/eclipse.org-common/themes/solstice/public/images/logo/eclipse-800x188.png)](https://www.eclipse.org/)

Bugzilla – Bug 580018
Denial-of-Service vulnerability in the DTLS stack
Last modified: 2022-07-29 09:24:57 EDT

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=580018&GoAheadAndLogIn=1)

  [x]
| * [Terms of Use](http://www.eclipse.org/legal/termsofuse.php)
| * [Copyright Agent](http://www.eclipse.org/legal/copyright.php)

This Bugzilla instance is deprecated, and most Eclipse projects now use
[GitHub](https://github.com/eclipse) or [Eclipse GitLab](https://gitlab.eclipse.org/eclipse/). Please see the [deprecation plan](https://gitlab.eclipse.org/eclipsefdn/helpdesk/-/wikis/Gerrit/Gerrit-and-Bugzilla-deprecation-and-migration-plan) for details.

[**Bug 580018**](show_bug.cgi?id=580018)
- Denial-of-Service vulnerability in the DTLS stack

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Denial-of-Service vulnerability in the DTLS stack

| | [Status](page.cgi?id=fields.html#bug_status): | NEW | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Californium | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | IoT | | [Component:](describecomponents.cgi?product=Californium "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Scandium ([show other bugs](buglist.cgi?component=Scandium&product=Californium&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified   [Edit](https://dev.eclipse.org/committers/bugs/bugz_manager.php) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | PC Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | P3 normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | ---   [Edit](https://dev.eclipse.org/committers/bugs/bugz_manager.php) | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Security vulnerabilitied reported against Eclipse projects [CLA](https://wiki.eclipse.org/ECA) | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | security | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2022-05-26 06:14 EDT by Nurullah Erinola [CLA](https://wiki.eclipse.org/ECA) | | --- | --- | | Modified: | 2022-07-29 09:24 EDT ([History](show_activity.cgi?id=580018)) | | CC List: | 5 users (show)  achim.kraus code kai.hudalla mikael.barbero wayne.beaton | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [**PCAP file with the interaction**](attachment.cgi?id=288540 "View the content of the attachment") (4.62 KB, application/vnd.tcpdump.pcap)  [2022-05-26 06:14 EDT](#attach_288540 "Go to the comment associated with the attachment"), Nurullah Erinola [CLA](https://wiki.eclipse.org/ECA) | *no flags* | [Details](attachment.cgi?id=288540&action=edit) | | [View All](attachment.cgi?bugid=580018&action=viewall)  [Add an attachment](attachment.cgi?bugid=580018&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=580018&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=580018#c0)  Nurullah Erinola [CLA](https://wiki.eclipse.org/ECA)    2022-05-26 06:14:29 EDT  ``` Created [attachment 288540](attachment.cgi?id=288540 "PCAP file with the interaction") [[details]](attachment.cgi?id=288540&action=edit "PCAP file with the interaction") PCAP file with the interaction  Our systematic analysis of DTLS implementations indicated that your DTLS stack is vulnerable to a Denial-of-Service attack.  Tested build ============ v3.5.0  Affected protocol versions ========================== DTLS 1.2  Expected behavior ================= According to the DTLS 1.2 standard in chapter 4.2.1 [1], the server may respond with a HelloVerifyRequest message when the client sends its ClientHello message.  This mechanism should provide defense against the following two DoS attacks: 1. An attacker can consume excessive resources on the server by transmitting a series of handshake initiation requests, causing the server to allocate state and potentially to perform expensive cryptographic operations. 2. An attacker can use the server as an amplifier by sending connection initiation messages with a forged source of the victim.  The server then sends its next message (in DTLS, a Certificate message, which can be quite large) to the victim machine, thus flooding it.  Observed behavior ================= The DTLS stack does not perform a stateless cookie exchange during session resumption with Session IDs. If the server receives a ClientHello message with a valid Session ID, it responds directly with the ServerHello, ChangeCipherSpec, and Finished messages.  For an attack, an attacker only needs to collect valid Session IDs and then flood the server with ClientHello messages that contain one of the collected parameters.  The main problem here is that an attacker can force the server to send ServerHello, Certificate, ..., ServerHelloDone messages. As a result, the amplification attack is greatly increased.  A properly implemented server should not allow skipping the stateless cookie exchange.  Steps to Reproduce ================== To reproduce the bug, OpenSSL can be used. 1. Launch an server. (We used for out tests the example DTLS server.) 2. Launch the OpenSSL client with: openssl s_client -dtls -connect localhost:4433 -sess_out sess.pem -no_ticket -cipher ECDHE-ECDSA-AES256-GCM-SHA384 3. Close the connection. 4. Launch the OpenSSL client again with: openssl s_client -dtls -connect localhost:4433 -sess_in sess.pem -no_ticket -cipher ECDHE-ECDSA-AES128-GCM-SHA256  The most important point here is that the cipher suite in the second handshake must be different from the negotiated in the first handshake. If everything works as planned, Wireshark should show an interaction similar to that in the attached PCAP files.  Links ===== [1] <https://datatracker.ietf.org/doc/html/rfc6347#section-4.2.1> ```  [Comment 1](show_bug.cgi?id=580018#c1)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-05 06:42:50 EDT  ``` Thanks for reporting this.  I change my e-mail address end of May and was in vacation.  Is see two issues:  - if the server falls back to an full-handshake, it must use the HelloVerifyRequest  - if not, then there have been some discussions about the in the IETF mailing list, see <https://mailarchive.ietf.org/arch/msg/tls/hlW5oeiZ-ZsrThTG2FgrlFhA-8s/> . The outcome of that is to configure the behavior according your requirements. See   <https://github.com/eclipse/californium/blob/main/scandium-core/src/main/java/org/eclipse/californium/scandium/config/DtlsConfig.java#L691>  and   <https://github.com/eclipse/californium/blob/main/demo-apps/cf-plugtest-server/src/main/java/org/eclipse/californium/plugtests/PlugtestServer.java#L142>   how to change the default. ```  [Comment 2](show_bug.cgi?id=580018#c2)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-05 11:57:15 EDT  ``` I prepared a PR to fix it.  <https://github.com/eclipse/californium/pull/2039>  maybe you can retest with that.  I also added your test to   <https://github.com/eclipse/californium/tree/main/californium-tests/californium-interoperability-tests/src/test/java/org/eclipse/californium/interoperability/test/openssl>  but I prefer to publish that test after a 3.6 release.  Currently I plan the 3.6 release for end of next week, 14. July. 2022. ```  [Comment 3](show_bug.cgi?id=580018#c3)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-06 08:26:44 EDT  ``` Some questions :   1. Just to be sure, If we set DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD to 0, we are no more affected by this ?  2. Do you plan to create a CVE for this ?  3. I see you plan to release a 3.6 version with a fix, do you plan to do a security fix for 2.x or 2.7.x ? ```  [Comment 4](show_bug.cgi?id=580018#c4)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-06 08:37:18 EDT  ``` > 1. Just to be sure, If we set DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD to 0, we are no more affected by this ?  Yes, with that, the HelloVerifyRequest is always used.  > 2. Do you plan to create a CVE for this ?  I consider it.   > 3. I see you plan to release a 3.6 version with a fix, do you plan to do a security fix for 2.x or 2.7.x ?  The patch uses a new API introduced with 3.x. Therefore it can't be applied to a 2.7.x.directly.  To skip the HelloVerifyRequest was introduced when the resumption handshake was intended to be used for frequent address changes. With RFC9146 it gets less frequently useful. So I think, use a 0 will do it in a 2.7.  Anyway, if you feel, it's important to use it with a 2.7. I will prepare a fix for that as well. ```  [Comment 5](show_bug.cgi?id=580018#c5)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-06 08:49:23 EDT  ``` > Anyway, if you feel, it's important to use it with a 2.7. I will prepare a fix for that as well.  At Sierra we don't use it, so we don't really need it.  But I'm not so comfortable with the idea to have this issue in Leshan 1.x with the default configuration.  Maybe for cf 2.x :   - the default behavior should be set to 0  - if user activate it, a warn about the security issue should be raised ?   (or any other idea ?) ```  [Comment 6](show_bug.cgi?id=580018#c6)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-06 08:53:28 EDT  ``` > (or any other idea ?)  Then fixing it will be easier ;-).  (Changing the defaults isn't that effective, because old "Californium.properties" will keep the old value.) ```  [Comment 7](show_bug.cgi?id=580018#c7)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-06 09:03:37 EDT  ``` > (Changing the defaults isn't that effective, because old "Californium.properties" will keep the old value.)  That's why I propose the warn log in addition.   > Then fixing it will be easier ;-).  If fixing is easy, I'm ok with it too. ```  [Comment 8](show_bug.cgi?id=580018#c8)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-06 13:37:35 EDT  ``` About Californium 2.7:  A ClientHello, which causes in 3.0 a fallback to a full handshake, causes with the 2.7 an Alert "Illegal Parameter".  So affect only 3.0-3.5. ```  [Comment 9](show_bug.cgi?id=580018#c9)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 01:39:28 EDT  ``` CVE:  I would go for <https://cwe.mitre.org/data/definitions/440.html>  In my opinion, the basic idea, that a resumption handshake doesn't require a HelloVerifyRequest because the reply flight is very small and inexpensive, isn't wrong.  But the check, if a resumption or the fallback to a full-handshake is used instead, was wrong. This weakness then caused the vulnerabilities:  - possible amplification (DDoS others) - possible CPU exhausting (Dos affected server)  Any other opinions/proposals? ```  [Comment 10](show_bug.cgi?id=580018#c10)  Kai Hudalla [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 02:41:53 EDT  ``` (In reply to Achim Kraus from [comment #9](show_bug.cgi?id=580018#c9)) > CVE: >  > I would go for <https://cwe.mitre.org/data/definitions/440.html> >  FMPOV <https://cwe.mitre.org/data/definitions/408.html> would be a more specific fit.  > In my opinion, the basic idea, that a resumption handshake doesn't require a > HelloVerifyRequest because the reply flight is very small and inexpensive, > isn't wrong.  I agree  >  > But the check, if a resumption or the fallback to a full-handshake is used > instead, was wrong. This weakness then caused the vulnerabilities: >  > - possible amplification (DDoS others) > - possible CPU exhausting (Dos affected server) >   So, the proposed fix is to ALWAYS send the HelloVerifyRequest when falling back to a full handshake but act according to the value set in DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD otherwise, right? If that is the case then I also agree here :-) ```  [Comment 11](show_bug.cgi?id=580018#c11)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 02:57:47 EDT  ``` I also read the 408, my understanding of it is:  1. "do expensive processing" 2. "do the security check"  With the bug would cause no "security check" (HelloVerifyRequest) at all.   > So, the proposed fix is to ALWAYS send the HelloVerifyRequest when falling back to a full handshake but act according to the value set in DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD otherwise, right?  Yes, that's the proposed fix.  The tricky thing is, that it requires a callback API to implement it. Therefore I introduced "ExtendedResumptionVerifier". The background is, that if the "session-store" (former cache) is a "remote implementation", the processing maybe very specific.  (Just to mention: because hono uses a cluster, I disables the session resumption in hono at all.) ```  [Comment 12](show_bug.cgi?id=580018#c12)  Kai Hudalla [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 03:38:24 EDT  ``` (In reply to Achim Kraus from [comment #11](show_bug.cgi?id=580018#c11)) > I also read the 408, my understanding of it is: >  > 1. "do expensive processing" > 2. "do the security check" >  > With the bug would cause no "security check" (HelloVerifyRequest) at all. >   "The software allows an entity to perform a legitimate but expensive operation before authentication or authorization has taken place."  Isn't that exactly what is happening when falling back to a full handshake without sending the ClientVerifyRequest? ```  [Comment 13](show_bug.cgi?id=580018#c13)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 04:01:49 EDT  ``` > "The software allows an entity to perform a legitimate but expensive operation before authentication or authorization has taken place."  > Isn't that exactly what is happening when falling back to a full handshake without sending the ClientVerifyRequest?  Yes, if "before" also includes "not to authenticate".  "Incorrect Behavior Order" points for me to the order.  Right way:  1. check 2. process  Wrong way:  1. process 2. check  But the bug does:  1. process  (The check isn't done at all. Therefore the misbehavior is not based on the wrong order, its based on the missing check.) ```  [Comment 14](show_bug.cgi?id=580018#c14)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 04:32:12 EDT  ``` > About Californium 2.7:  > A ClientHello, which causes in 3.0 a fallback to a full handshake, causes with > the 2.7 an Alert "Illegal Parameter".  > So affect only 3.0-3.5.   This doesn't really respect the RFC as it should fallback to fullhandshake, right ?   Does it impact opened connection/session attached to this Session ID ? ```  [Comment 15](show_bug.cgi?id=580018#c15)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 04:40:07 EDT  ``` My 2 cts, I also think that <https://cwe.mitre.org/data/definitions/408.html> fit better but maybe I don't understand the issue enough.   About :   > But the bug does: > 1. process   Could we consider that the check after "process" could be the fullhandshake itself ?   By the way, 408 seems to match better for Technical Impacts too.   440 Impact: Quality Degradation; Varies by Context  408 Impacts : DoS: Amplification; DoS: Crash, Exit, or Restart; DoS: Resource Consumption (CPU); DoS: Resource Consumption (Memory) ```  [Comment 16](show_bug.cgi?id=580018#c16)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 05:16:35 EDT  ``` > This doesn't really respect the RFC as it should fallback to fullhandshake, right ?  At least I didn't found something in RFC 5246, except the MUST in  > If the > session_id field is not empty (implying a session resumption > request), this vector MUST include at least the cipher_suite from > that session.  But that doesn't say "fallback" nor "fail".  Only RFC 6066 states for SNI   > A server that implements this extension MUST NOT accept the request > to resume the session if the server_name extension contains a > different name.  Instead, it proceeds with a full handshake to > establish a new session.  therefore I changed the behavior in 3.0. ```  [Comment 17](show_bug.cgi?id=580018#c17)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 05:22:24 EDT  ``` About CWE 408:  I was a little fixed at "server hello, certificate" and "hello verify request". But if I change to:  - check for full handshake - use either "hello verify request"  - or "server hello, certificate"  [- (over simplified, ineffective) check for "hello verify request"]  - use either "hello verify request"  - check for full handshake - "server hello, certificate" or "server hello, server hello done"  Then I guess we can also go for 408. ```  [Comment 18](show_bug.cgi?id=580018#c18)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 05:33:12 EDT  ``` > At least I didn't found something in RFC 5246  I was thinking this part of the spec about :   > If a Session ID match is not >    found, the server generates a new session ID, and the TLS client and >   server perform a full handshake.  (<https://www.rfc-editor.org/rfc/rfc5246#section-7.3>) ```  [Comment 19](show_bug.cgi?id=580018#c19)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 05:40:54 EDT  ``` > If a Session ID match is not found  So that depends on how to interpret "Session ID match". Only the ID? Or also the other parameter? Anyway, though it's a MUST, a violation is always "out of spec". So I don't think, it pays of that much, to change that behavior for 2.7. ```  [Comment 20](show_bug.cgi?id=580018#c20)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 06:05:26 EDT  ``` > So that depends on how to interpret "Session ID match". Only the ID? Or also the other parameter?   For me, it's pretty clear "Session ID" means "Session ID"   >  Anyway, though it's a MUST, a violation is always "out of spec".  I don't get your point. "How a violation is handled" can be part of a spec.  Anyway here this is not a violation, this is just a possible common use case OR I totally missed something. The client tries to resume a session, it send a session ID it want to resume. If server lost the session (for any reason, restart, session lifetime) the handshake turn in full handshak.   If I understand you correctly the behavior in 2.7 is to send an Alert instead of fallback on fullhandshake, correct ?   (You didn't answer about : "Does it impact opened connection/session attached to this Session ID ?" don't know if it's on purpose or just oversight) ```  [Comment 21](show_bug.cgi?id=580018#c21)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 06:17:16 EDT  ``` > I don't get your point. "How a violation is handled" can be part of a spec.  Sure, but, as I wrote, I miss that part explaining, what to do, if the "MUST" in   > If the > session_id field is not empty (implying a session resumption > request), this vector MUST include at least the cipher_suite from > that session.  fails.  Basically, this reported bug does exactly this, it doesn't include the cipher_suite and so breaks the MUST. ```  [Comment 22](show_bug.cgi?id=580018#c22)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 06:21:07 EDT  ``` > Anyway here this is not a violation, this is just a possible common use case OR I totally missed something. > The client tries to resume a session, it send a session ID it want to resume. If server lost the session (for any reason, restart, session lifetime) the handshake turn in full handshak.  No, only in the cases, where the cipher_suite or compression_method doesn't comply to MUST. In the "common case", where the session for the session ID is missing, the 2.7 falls back to the full-handshake. (You may verify that on your own and there are some unit tests to ensure that.) ```  [Comment 23](show_bug.cgi?id=580018#c23)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 06:23:50 EDT  ``` > (You didn't answer about : "Does it impact opened connection/session attached to this Session ID ?" don't know if it's on purpose or just oversight)  Oversight.  If there is an other session on that "unverified address resuming address", scandium uses a "HelloVerifyRequest". ```  [Comment 24](show_bug.cgi?id=580018#c24)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 07:28:17 EDT  ``` 2.7:  I think, if that attack uses a SNI change, the attack will work as well with a 2.7. ;-(.  Unfortunately, there is much more to do for 3.6 (and tinydtls), so I guess, the fix for 2.7 must wait until end of July. ```  [Comment 25](show_bug.cgi?id=580018#c25)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-07 08:28:47 EDT  ``` > Basically, this reported bug does exactly this, it doesn't include the cipher_suite and so breaks the MUST.  OK I missed this part about different cipher_suite.  And so I understand now why you say RFC doesn't define the behavior.  I guess in that case an ALERT could be OK. ```  [Comment 26](show_bug.cgi?id=580018#c26)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-11 06:18:19 EDT  ``` Project name: Eclipse Californium  Versions affected: [2.0.0, 2.7.2] and [3.0.0, 3.5.0]  Common Weakness Enumeration:  - CWE-408: Incorrect Behavior Order: Early Amplification  Summary:  In Eclipse Californium version 2.0.0 to 2.7.2 and 3.0.0-3.5.0 a resumption handshake falls back to a full handshake on a parameter mismatch without using a HelloVerifyRequest. Especially, if used with certificated based cipher suites, that results in message amplification (DDoS other peers) and high CPU load (DoS peer).  Links:  - <https://bugs.eclipse.org/580018> ```  [Comment 27](show_bug.cgi?id=580018#c27)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-11 06:20:51 EDT  ``` @Simon @Kai  please check, if that description is OK for you.  For 3.6.0 the PR with the fix is already merged to main. For 2.7.x the PR #2041 is pending.  If no objection or other preferred schedules, I would like to release  2.7.3 on Wednesday 13. July 3.6.0 on Thursday  14. July ```  [Comment 28](show_bug.cgi?id=580018#c28)  Kai Hudalla [CLA](https://wiki.eclipse.org/ECA)    2022-07-11 06:51:34 EDT  ``` (In reply to Achim Kraus from [comment #26](show_bug.cgi?id=580018#c26)) > Project name: Eclipse Californium >  > Versions affected: [2.0.0, 2.7.2] and [3.0.0, 3.5.0] >  > Common Weakness Enumeration: >  > - CWE-408: Incorrect Behavior Order: Early Amplification >  > Summary: >  > In Eclipse Californium version 2.0.0 to 2.7.2 and 3.0.0-3.5.0 a resumption > handshake falls back to a full handshake on a parameter mismatch without > using a HelloVerifyRequest. Especially, if used with certificated based > cipher suites, that results in message amplification (DDoS other peers) and > high CPU load (DoS peer). >  > Links: >  > - <https://bugs.eclipse.org/580018>  Just a small typo  > Especially, if used with certificate based ... ```  [Comment 29](show_bug.cgi?id=580018#c29)  Kai Hudalla [CLA](https://wiki.eclipse.org/ECA)    2022-07-11 06:52:02 EDT  ``` (In reply to Achim Kraus from [comment #27](show_bug.cgi?id=580018#c27)) > @Simon > @Kai >  > please check, if that description is OK for you. >  > For 3.6.0 the PR with the fix is already merged to main. > For 2.7.x the PR #2041 is pending. >  > If no objection or other preferred schedules, I would like to release >  > 2.7.3 on Wednesday 13. July > 3.6.0 on Thursday  14. July  Sounds good to me. Thanks for handling this vulnerability, Achim :-) ```  [Comment 30](show_bug.cgi?id=580018#c30)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-11 08:50:36 EDT  ``` LGTM, Except maybe :   I understand that this security issue only concerns users who are using DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD > 0.  If you think this is still true, I think this could be a good addition to say something about this. (just to let user know if there are concerned and also that they can use this workaround instead of upgrade) ```  [Comment 31](show_bug.cgi?id=580018#c31)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-11 08:56:34 EDT  ``` Project name: Eclipse Californium  Versions affected: [2.0.0, 2.7.2] and [3.0.0, 3.5.0]  Common Weakness Enumeration:  - CWE-408: Incorrect Behavior Order: Early Amplification  Summary:  In Eclipse Californium version 2.0.0 to 2.7.2 and 3.0.0-3.5.0 a DTLS resumption handshake falls back to a DTLS full handshake on a parameter mismatch without using a HelloVerifyRequest. Especially, if used with certificate based cipher suites, that results in message amplification (DDoS other peers) and high CPU load (DoS own peer). The misbehavior occurs only with DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD values larger than 0.    Links:  - <https://bugs.eclipse.org/580018> ```  [Comment 32](show_bug.cgi?id=580018#c32)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-11 09:04:50 EDT  ``` LGTM ```  [Comment 33](show_bug.cgi?id=580018#c33)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-14 08:04:05 EDT  ``` The fix is now successfully released with 2.7.3 and 3.6.0.  @Simon  Do you plan to provide Leshan releases as well? If not, then I would ask Wayne (or Mikael) to publish the CVE next week. ```  [Comment 34](show_bug.cgi?id=580018#c34)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-18 05:42:07 EDT  ``` > Do you plan to provide Leshan releases as well?  I don't know yet because there is nothing to release for Leshan 1.x except update the californium dependency.  I'm still a bit frustrated with the way maven handle version dependency because I feel this is not so clean to have strict defined version dependency for a library...  I remember when I was coding eclipse plugins, the way dependencies was managed was really cleaner. You can say "my plugin depends on given plugin v1.2 or later" so you depends to a version of API and bug fix release is handle by each project.    > If not, then I would ask Wayne (or Mikael) to publish the CVE next week.  Yes please do it, don't wait for us. ```  [Comment 35](show_bug.cgi?id=580018#c35)  Kai Hudalla [CLA](https://wiki.eclipse.org/ECA)    2022-07-18 07:37:21 EDT  ``` (In reply to Simon Bernard from [comment #34](show_bug.cgi?id=580018#c34)) >  > I'm still a bit frustrated with the way maven handle version dependency > because I feel this is not so clean to have strict defined version > dependency for a library... >  > I remember when I was coding eclipse plugins, the way dependencies was > managed was really cleaner. You can say "my plugin depends on given plugin > v1.2 or later" so you depends to a version of API and bug fix release is > handle by each project. >   you should be able to do that with Maven as well if I am not mistaken:  <https://books.sonatype.com/mvnref-book/reference/pom-relationships-sect-project-dependencies.html#pom-relationships-sect-version-ranges> ```  [Comment 36](show_bug.cgi?id=580018#c36)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-18 08:55:59 EDT  ``` @Kai, Thx for sharing this. 🙏  I was aware about this but I had the vague memory that it was not advised or even deprecated to use it with Maven. (I don't remember why I thought this 🤦...)  Maybe I should give it a try.  Do you guys already use it ? any feedbacks ? (or maybe reason why you don't use it) ```  [Comment 37](show_bug.cgi?id=580018#c37)  Kai Hudalla [CLA](https://wiki.eclipse.org/ECA)    2022-07-18 09:37:32 EDT  ``` (In reply to Simon Bernard from [comment #36](show_bug.cgi?id=580018#c36)) > @Kai, Thx for sharing this. 🙏  > Maybe I should give it a try. >  > Do you guys already use it ? any feedbacks ? (or maybe reason why you don't > use it)  I am currently not using this but for no particular reason. There is one thing that IMHO needs to be considered: not every third party dependency uses semantic versioning or if it claims to do so, actually implements the semantics correctly and reliably. So, in many cases you will need to test manually with every new (minor) version and if you need to do that anyway, specifying a version range for a dependency doesn't seem beneficial or appropriate at all. ```  [Comment 38](show_bug.cgi?id=580018#c38)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-19 03:29:10 EDT  ``` @Wayne @Mikael  from my side the team agreed on having a CVE created with: ------------------------------------------- Project name: Eclipse Californium  Versions affected: [2.0.0, 2.7.2] and [3.0.0, 3.5.0]  Common Weakness Enumeration:  - CWE-408: Incorrect Behavior Order: Early Amplification  Summary:  In Eclipse Californium version 2.0.0 to 2.7.2 and 3.0.0-3.5.0 a DTLS resumption handshake falls back to a DTLS full handshake on a parameter mismatch without using a HelloVerifyRequest. Especially, if used with certificate based cipher suites, that results in message amplification (DDoS other peers) and high CPU load (DoS own peer). The misbehavior occurs only with DTLS_VERIFY_PEERS_ON_RESUMPTION_THRESHOLD values larger than 0.    Links:  - <https://bugs.eclipse.org/580018> -------------------------------------------  If nothing is missing, please create it. ```  [Comment 39](show_bug.cgi?id=580018#c39)  Simon Bernard [CLA](https://wiki.eclipse.org/ECA)    2022-07-26 03:57:52 EDT  ``` I released :  - leshan v1.4.1 with californium v2.7.3 - leshan v2.0.0-M8 with californium v3.6.0 ```  [Comment 40](show_bug.cgi?id=580018#c40)  Mikaël Barbero [CLA](https://wiki.eclipse.org/ECA)    2022-07-29 07:54:06 EDT  ``` I'm on it. ```  [Comment 41](show_bug.cgi?id=580018#c41)  Mikaël Barbero [CLA](https://wiki.eclipse.org/ECA)    2022-07-29 08:39:29 EDT  ``` I've submitted <https://github.com/CVEProject/cvelist/pull/6693>, but it's not yet merged as my account is still under verification. I will keep you posted as soon as it's done. ```  [Comment 42](show_bug.cgi?id=580018#c42)  Achim Kraus [CLA](https://wiki.eclipse.org/ECA)    2022-07-29 08:43:54 EDT  ``` Thanks for the update! ```  [Comment 43](show_bug.cgi?id=580018#c43)  Mikaël Barbero [CLA](https://wiki.eclipse.org/ECA)    2022-07-29 09:24:57 EDT  ``` CVE has been merged, you should be all set to socialize about CVE-2022-2576. It will appear soon at <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2576> ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=580018)
* - [XML](show_bug.cgi?ctype=xml&id=580018)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=580018)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=580018&GoAheadAndLogIn=1)

    [x]
  | + [Terms of Use](http://www.eclipse.org/legal/termsofuse.php)
  | + [Copyright Agent](http://www.eclipse.org/legal/copyright.php)


