=== Content from github.com_b5a1aa5b_20250111_085859.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFreeRDP%2FFreeRDP%2Fsecurity%2Fadvisories%2FGHSA-c6vw-92h9-5w9v)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFreeRDP%2FFreeRDP%2Fsecurity%2Fadvisories%2FGHSA-c6vw-92h9-5w9v)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=FreeRDP%2FFreeRDP)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[FreeRDP](/FreeRDP)
/
**[FreeRDP](/FreeRDP/FreeRDP)**
Public

* [Notifications](/login?return_to=%2FFreeRDP%2FFreeRDP) You must be signed in to change notification settings
* [Fork
  14.9k](/login?return_to=%2FFreeRDP%2FFreeRDP)
* [Star
   11.2k](/login?return_to=%2FFreeRDP%2FFreeRDP)

* [Code](/FreeRDP/FreeRDP)
* [Issues
  228](/FreeRDP/FreeRDP/issues)
* [Pull requests
  22](/FreeRDP/FreeRDP/pulls)
* [Discussions](/FreeRDP/FreeRDP/discussions)
* [Actions](/FreeRDP/FreeRDP/actions)
* [Projects
  0](/FreeRDP/FreeRDP/projects)
* [Wiki](/FreeRDP/FreeRDP/wiki)
* [Security](/FreeRDP/FreeRDP/security)
* [Insights](/FreeRDP/FreeRDP/pulse)

Additional navigation options

* [Code](/FreeRDP/FreeRDP)
* [Issues](/FreeRDP/FreeRDP/issues)
* [Pull requests](/FreeRDP/FreeRDP/pulls)
* [Discussions](/FreeRDP/FreeRDP/discussions)
* [Actions](/FreeRDP/FreeRDP/actions)
* [Projects](/FreeRDP/FreeRDP/projects)
* [Wiki](/FreeRDP/FreeRDP/wiki)
* [Security](/FreeRDP/FreeRDP/security)
* [Insights](/FreeRDP/FreeRDP/pulse)

# Out-Of-Bounds Read in general\_YUV444ToRGB\_8u\_P3AC4R\_BGRX

Low

[akallabeth](/akallabeth)
published
GHSA-c6vw-92h9-5w9v
Aug 31, 2023

## Package

FreeRDP

## Affected versions

>= 3.0.0-beta1, <= 3.0.0beta2

## Patched versions

3.0.0-beta3

## Description

### Summary

Out-Of-Bounds Read in `general_YUV444ToRGB_8u_P3AC4R_BGRX`

### Affected

FreeRDP based clients only. FreeRDP proxy not affected as image decoding is not done by proxy (data passthrough)

### Details

[FreeRDP/libfreerdp/primitives/prim\_YUV.c](https://github.com/FreeRDP/FreeRDP/blob/5be5553e0da72178a4b94cc1ffbdace9ceb153e5/libfreerdp/primitives/prim_YUV.c#L414-L445)

Lines 414 to 445
in
[5be5553](/FreeRDP/FreeRDP/commit/5be5553e0da72178a4b94cc1ffbdace9ceb153e5)

|  | static pstatus\_t general\_YUV444ToRGB\_8u\_P3AC4R\_BGRX(const BYTE\* const pSrc[3], |
| --- | --- |
|  | const UINT32 srcStep[3], BYTE\* pDst, |
|  | UINT32 dstStep, UINT32 DstFormat, |
|  | const prim\_size\_t\* roi) |
|  | { |
|  | UINT32 x, y; |
|  | UINT32 nWidth, nHeight; |
|  | const DWORD formatSize = FreeRDPGetBytesPerPixel(DstFormat); |
|  | nWidth = roi->width; |
|  | nHeight = roi->height; |
|  |  |
|  | for (y = 0; y < nHeight; y++) |
|  | { |
|  | const BYTE\* pY = pSrc[0] + y \* srcStep[0]; |
|  | const BYTE\* pU = pSrc[1] + y \* srcStep[1]; |
|  | const BYTE\* pV = pSrc[2] + y \* srcStep[2]; |
|  | BYTE\* pRGB = pDst + y \* dstStep; |
|  |  |
|  | for (x = 0; x < nWidth; x++) |
|  | { |
|  | const BYTE Y = pY[x]; |
|  | const BYTE U = pU[x]; |
|  | const BYTE V = pV[x]; |
|  | const BYTE r = YUV2R(Y, U, V); |
|  | const BYTE g = YUV2G(Y, U, V); |
|  | const BYTE b = YUV2B(Y, U, V); |
|  | pRGB = writePixelBGRX(pRGB, formatSize, DstFormat, r, g, b, 0); |
|  | } |
|  | } |
|  |  |
|  | return PRIMITIVES\_SUCCESS; |
|  | } |

I might not have the exact cause, but it seems like the issue could be insufficient data for `pSrc`.

### PoC

If reproducing the issue is not possible, I would appreciate it if you could send me the packet file you have for analysis.

### Impact

Out-Of-Bounds Read

### Asan

```
==23070==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x00012b5eb828 at pc 0x0001015e6518 bp 0x000170dd6ac0 sp 0x000170dd6ab8
READ of size 1 at 0x00012b5eb828 thread T55
    #0 0x1015e6514 in general_YUV444ToRGB_8u_P3AC4R_BGRX+0x29c (libfreerdp3.3.0.0.dylib:arm64+0x3b6514) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #1 0x1015e3510 in general_YUV444ToRGB_8u_P3AC4R+0x58 (libfreerdp3.3.0.0.dylib:arm64+0x3b3510) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #2 0x101292f10 in avc444_yuv_to_rgb+0x76c (libfreerdp3.3.0.0.dylib:arm64+0x62f10) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #3 0x10128daec in yuv444_process_work_callback+0x120 (libfreerdp3.3.0.0.dylib:arm64+0x5daec) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #4 0x101d9a8c4 in thread_pool_work_func pool.c:88
    #5 0x101da54ac in thread_launcher thread.c:520
    #6 0x1a20cbfa4 in _pthread_start+0x90 (libsystem_pthread.dylib:arm64+0x6fa4) (BuildId: 46d35233a0513f4fbba4ba56dddc4d1a32000000200000000100000000040d00)
    #7 0x12008001a20c6d9c  (<unknown module>)

0x00012b5eb828 is located 0 bytes after 208936-byte region [0x00012b5b8800,0x00012b5eb828)
allocated by thread T4 here:
    #0 0x10232d5b0 in wrap_malloc+0x8c (libclang_rt.asan_osx_dynamic.dylib:arm64+0x515b0) (BuildId: 4947f3677e4435f39b5765e7dbc19bf732000000200000000100000000000b00)
    #1 0x101e04f18 in winpr_aligned_offset_malloc alignment.c:114
    #2 0x101e055b0 in winpr_aligned_offset_recalloc alignment.c:189
    #3 0x101e05188 in winpr_aligned_recalloc alignment.c:75
    #4 0x101297030 in avc444_ensure_buffer+0x34c (libfreerdp3.3.0.0.dylib:arm64+0x67030) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #5 0x101297960 in avc444_process_rects+0x288 (libfreerdp3.3.0.0.dylib:arm64+0x67960) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #6 0x101297694 in avc444_decompress+0x228 (libfreerdp3.3.0.0.dylib:arm64+0x67694) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #7 0x1013926a8 in gdi_SurfaceCommand_AVC444+0x94c (libfreerdp3.3.0.0.dylib:arm64+0x1626a8) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #8 0x1013873b8 in gdi_SurfaceCommand+0x5b0 (libfreerdp3.3.0.0.dylib:arm64+0x1573b8) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #9 0x10055c238 in rdpgfx_decode_AVC444+0xa0c (libfreerdp-client3.3.0.0.dylib:arm64+0xa8238) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #10 0x10055b0bc in rdpgfx_decode+0x178 (libfreerdp-client3.3.0.0.dylib:arm64+0xa70bc) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #11 0x100546a20 in rdpgfx_recv_wire_to_surface_1_pdu+0x14ec (libfreerdp-client3.3.0.0.dylib:arm64+0x92a20) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #12 0x10054427c in rdpgfx_recv_pdu+0x424 (libfreerdp-client3.3.0.0.dylib:arm64+0x9027c) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #13 0x1005433b0 in rdpgfx_on_data_received+0x444 (libfreerdp-client3.3.0.0.dylib:arm64+0x8f3b0) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #14 0x1004c68a4 in dvcman_call_on_receive+0x164 (libfreerdp-client3.3.0.0.dylib:arm64+0x128a4) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #15 0x1004c6710 in dvcman_receive_channel_data+0x440 (libfreerdp-client3.3.0.0.dylib:arm64+0x12710) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #16 0x1004c30f8 in drdynvc_process_data+0x2c8 (libfreerdp-client3.3.0.0.dylib:arm64+0xf0f8) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #17 0x1004c136c in drdynvc_order_recv+0x334 (libfreerdp-client3.3.0.0.dylib:arm64+0xd36c) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #18 0x1004c0db0 in drdynvc_virtual_channel_event_data_received+0x498 (libfreerdp-client3.3.0.0.dylib:arm64+0xcdb0) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #19 0x1004bfa98 in drdynvc_virtual_channel_open_event_ex+0x1ac (libfreerdp-client3.3.0.0.dylib:arm64+0xba98) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #20 0x1014887bc in freerdp_channels_data+0x5cc (libfreerdp3.3.0.0.dylib:arm64+0x2587bc) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #21 0x10153a070 in freerdp_channel_process+0x6e0 (libfreerdp3.3.0.0.dylib:arm64+0x30a070) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #22 0x1014ea3d0 in rdp_recv_tpkt_pdu+0x11e8 (libfreerdp3.3.0.0.dylib:arm64+0x2ba3d0) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #23 0x1014e9190 in rdp_recv_pdu+0x34 (libfreerdp3.3.0.0.dylib:arm64+0x2b9190) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #24 0x1014e49f8 in rdp_recv_callback_int+0x1408 (libfreerdp3.3.0.0.dylib:arm64+0x2b49f8) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #25 0x1014e3520 in rdp_recv_callback+0x1d8 (libfreerdp3.3.0.0.dylib:arm64+0x2b3520) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #26 0x101509cd4 in transport_check_fds+0x51c (libfreerdp3.3.0.0.dylib:arm64+0x2d9cd4) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #27 0x1014e5300 in rdp_check_fds+0x170 (libfreerdp3.3.0.0.dylib:arm64+0x2b5300) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #28 0x10147ff78 in freerdp_check_fds+0x1ac (libfreerdp3.3.0.0.dylib:arm64+0x24ff78) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #29 0x101480648 in freerdp_check_event_handles+0x70 (libfreerdp3.3.0.0.dylib:arm64+0x250648) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)

Thread T55 created by T4 here:
    #0 0x10232691c in wrap_pthread_create+0x50 (libclang_rt.asan_osx_dynamic.dylib:arm64+0x4a91c) (BuildId: 4947f3677e4435f39b5765e7dbc19bf732000000200000000100000000000b00)
    #1 0x101da252c in winpr_StartThread thread.c:568
    #2 0x101da1c00 in CreateThread thread.c:650
    #3 0x101d99dd8 in InitializeThreadpool pool.c:134
    #4 0x101d99ef0 in winpr_CreateThreadpool pool.c:177
    #5 0x10128bba0 in yuv_context_new+0x2e8 (libfreerdp3.3.0.0.dylib:arm64+0x5bba0) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #6 0x101297e38 in h264_context_new+0x13c (libfreerdp3.3.0.0.dylib:arm64+0x67e38) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #7 0x101392084 in gdi_SurfaceCommand_AVC444+0x328 (libfreerdp3.3.0.0.dylib:arm64+0x162084) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #8 0x1013873b8 in gdi_SurfaceCommand+0x5b0 (libfreerdp3.3.0.0.dylib:arm64+0x1573b8) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #9 0x10055c238 in rdpgfx_decode_AVC444+0xa0c (libfreerdp-client3.3.0.0.dylib:arm64+0xa8238) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #10 0x10055b0bc in rdpgfx_decode+0x178 (libfreerdp-client3.3.0.0.dylib:arm64+0xa70bc) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #11 0x100546a20 in rdpgfx_recv_wire_to_surface_1_pdu+0x14ec (libfreerdp-client3.3.0.0.dylib:arm64+0x92a20) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #12 0x10054427c in rdpgfx_recv_pdu+0x424 (libfreerdp-client3.3.0.0.dylib:arm64+0x9027c) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #13 0x1005433b0 in rdpgfx_on_data_received+0x444 (libfreerdp-client3.3.0.0.dylib:arm64+0x8f3b0) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #14 0x1004c68a4 in dvcman_call_on_receive+0x164 (libfreerdp-client3.3.0.0.dylib:arm64+0x128a4) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #15 0x1004c6710 in dvcman_receive_channel_data+0x440 (libfreerdp-client3.3.0.0.dylib:arm64+0x12710) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #16 0x1004c30f8 in drdynvc_process_data+0x2c8 (libfreerdp-client3.3.0.0.dylib:arm64+0xf0f8) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #17 0x1004c136c in drdynvc_order_recv+0x334 (libfreerdp-client3.3.0.0.dylib:arm64+0xd36c) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #18 0x1004c0db0 in drdynvc_virtual_channel_event_data_received+0x498 (libfreerdp-client3.3.0.0.dylib:arm64+0xcdb0) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #19 0x1004bfa98 in drdynvc_virtual_channel_open_event_ex+0x1ac (libfreerdp-client3.3.0.0.dylib:arm64+0xba98) (BuildId: 81736ad6ceca33b393c7b6a3c46ded1f32000000200000000100000000000d00)
    #20 0x1014887bc in freerdp_channels_data+0x5cc (libfreerdp3.3.0.0.dylib:arm64+0x2587bc) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #21 0x10153a070 in freerdp_channel_process+0x6e0 (libfreerdp3.3.0.0.dylib:arm64+0x30a070) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #22 0x1014ea3d0 in rdp_recv_tpkt_pdu+0x11e8 (libfreerdp3.3.0.0.dylib:arm64+0x2ba3d0) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #23 0x1014e9190 in rdp_recv_pdu+0x34 (libfreerdp3.3.0.0.dylib:arm64+0x2b9190) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #24 0x1014e49f8 in rdp_recv_callback_int+0x1408 (libfreerdp3.3.0.0.dylib:arm64+0x2b49f8) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #25 0x1014e3520 in rdp_recv_callback+0x1d8 (libfreerdp3.3.0.0.dylib:arm64+0x2b3520) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #26 0x101509cd4 in transport_check_fds+0x51c (libfreerdp3.3.0.0.dylib:arm64+0x2d9cd4) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #27 0x1014e5300 in rdp_check_fds+0x170 (libfreerdp3.3.0.0.dylib:arm64+0x2b5300) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #28 0x10147ff78 in freerdp_check_fds+0x1ac (libfreerdp3.3.0.0.dylib:arm64+0x24ff78) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #29 0x101480648 in freerdp_check_event_handles+0x70 (libfreerdp3.3.0.0.dylib:arm64+0x250648) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00)
    #30 0x1000d7700 in mac_client_thread+0x5a4 (MacFreeRDP:arm64+0x13700) (BuildId: 648033a131eb3f0f9702f5da3e9b172432000000200000000100000000000d00)
    #31 0x101da54ac in thread_launcher thread.c:520
    #32 0x1a20cbfa4 in _pthread_start+0x90 (libsystem_pthread.dylib:arm64+0x6fa4) (BuildId: 46d35233a0513f4fbba4ba56dddc4d1a32000000200000000100000000040d00)
    #33 0xa7790001a20c6d9c  (<unknown module>)

Thread T4 created by T0 here:
    #0 0x10232691c in wrap_pthread_create+0x50 (libclang_rt.asan_osx_dynamic.dylib:arm64+0x4a91c) (BuildId: 4947f3677e4435f39b5765e7dbc19bf732000000200000000100000000000b00)
    #1 0x101da252c in winpr_StartThread thread.c:568
    #2 0x101da1c00 in CreateThread thread.c:650
    #3 0x1000d6e64 in -[MRDPView rdpStart:]+0x964 (MacFreeRDP:arm64+0x12e64) (BuildId: 648033a131eb3f0f9702f5da3e9b172432000000200000000100000000000d00)
    #4 0x1000d62b4 in mfreerdp_client_start+0x488 (MacFreeRDP:arm64+0x122b4) (BuildId: 648033a131eb3f0f9702f5da3e9b172432000000200000000100000000000d00)
    #5 0x1000ca18c in freerdp_client_start+0x190 (MacFreeRDP:arm64+0x618c) (BuildId: 648033a131eb3f0f9702f5da3e9b172432000000200000000100000000000d00)
    #6 0x10000678c in -[AppDelegate applicationDidFinishLaunching:]+0x53c (MacFreeRDP:arm64+0x10000678c) (BuildId: c0debf5af29834acb3c97ff2be5d5c4932000000200000000100000000000d00)
    #7 0x1a219f17c in __CFNOTIFICATIONCENTER_IS_CALLING_OUT_TO_AN_OBSERVER__+0x90 (CoreFoundation:arm64+0x7417c) (BuildId: 203e44018c2e3157a24b92f52551d43e32000000200000000100000000040d00)
    #8 0x6a470001a223aee8  (<unknown module>)
    #9 0xed170001a223ae30  (<unknown module>)
    #10 0xac5d0001a21704c8  (<unknown module>)
    #11 0x243a0001a30ce8f0  (<unknown module>)
    #12 0x8a4f0001a53d1154  (<unknown module>)
    #13 0xda138001a53d0f04  (<unknown module>)
    #14 0xc0000001a53cefa0  (<unknown module>)
    #15 0x19698001a53ceb9c  (<unknown module>)
    #16 0xb1478001a30f8b60  (<unknown module>)
    #17 0x1d768001a30f89c0  (<unknown module>)
    #18 0xc26e8001a84d1514  (<unknown module>)
    #19 0x800f8001a84d0e40  (<unknown module>)
    #20 0xd5280001a84c9f14  (<unknown module>)
    #21 0xd61b0001aba02b40  (<unknown module>)
    #22 0x23160001a53ca044  (<unknown module>)
    #23 0x433a8001a53c8edc  (<unknown module>)
    #24 0x57030001a53bd340  (<unknown module>)
    #25 0x85588001a5394790  (<unknown module>)
    #26 0xe739800100006020  (<unknown module>)
    #27 0x1a1d73f24  (<unknown module>)
    #28 0x1339fffffffffffc  (<unknown module>)

SUMMARY: AddressSanitizer: heap-buffer-overflow (libfreerdp3.3.0.0.dylib:arm64+0x3b6514) (BuildId: 6065c8e6088137a4909a9600b1279a0b32000000200000000100000000000d00) in general_YUV444ToRGB_8u_P3AC4R_BGRX+0x29c
Shadow bytes around the buggy address:
  0x00012b5eb580: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x00012b5eb600: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x00012b5eb680: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x00012b5eb700: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x00012b5eb780: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x00012b5eb800: 00 00 00 00 00[fa]fa fa fa fa fa fa fa fa fa fa
  0x00012b5eb880: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x00012b5eb900: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x00012b5eb980: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x00012b5eba00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x00012b5eba80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb

```

### Severity

Low

### CVE ID

CVE-2023-40575

### Weaknesses

No CWEs

### Credits

* [![@pwn2carr](https://avatars.githubusercontent.com/u/131132521?s=40&v=4)](/pwn2carr)
  [pwn2carr](/pwn2carr)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c2fa535b_20250111_085859.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFreeRDP%2FFreeRDP%2Fblob%2F5be5553e0da72178a4b94cc1ffbdace9ceb153e5%2Flibfreerdp%2Fprimitives%2Fprim_YUV.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFreeRDP%2FFreeRDP%2Fblob%2F5be5553e0da72178a4b94cc1ffbdace9ceb153e5%2Flibfreerdp%2Fprimitives%2Fprim_YUV.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=FreeRDP%2FFreeRDP)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[FreeRDP](/FreeRDP)
/
**[FreeRDP](/FreeRDP/FreeRDP)**
Public

* [Notifications](/login?return_to=%2FFreeRDP%2FFreeRDP) You must be signed in to change notification settings
* [Fork
  14.9k](/login?return_to=%2FFreeRDP%2FFreeRDP)
* [Star
   11.2k](/login?return_to=%2FFreeRDP%2FFreeRDP)

* [Code](/FreeRDP/FreeRDP)
* [Issues
  228](/FreeRDP/FreeRDP/issues)
* [Pull requests
  22](/FreeRDP/FreeRDP/pulls)
* [Discussions](/FreeRDP/FreeRDP/discussions)
* [Actions](/FreeRDP/FreeRDP/actions)
* [Projects
  0](/FreeRDP/FreeRDP/projects)
* [Wiki](/FreeRDP/FreeRDP/wiki)
* [Security](/FreeRDP/FreeRDP/security)
* [Insights](/FreeRDP/FreeRDP/pulse)

Additional navigation options

* [Code](/FreeRDP/FreeRDP)
* [Issues](/FreeRDP/FreeRDP/issues)
* [Pull requests](/FreeRDP/FreeRDP/pulls)
* [Discussions](/FreeRDP/FreeRDP/discussions)
* [Actions](/FreeRDP/FreeRDP/actions)
* [Projects](/FreeRDP/FreeRDP/projects)
* [Wiki](/FreeRDP/FreeRDP/wiki)
* [Security](/FreeRDP/FreeRDP/security)
* [Insights](/FreeRDP/FreeRDP/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.gentoo.org_689e052f_20250111_085859.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# FreeRDP: Multiple Vulnerabilities — GLSA **202401-16**

Multiple vulnerabilities have been discovered in FreeRDP, the worst of which could result in code execution.

### Affected packages

| Package | **net-misc/freerdp** on all architectures |
| --- | --- |
| Affected versions | < **2.11.0** |
| Unaffected versions | >= **2.11.0** |

### Background

FreeRDP is a free implementation of the remote desktop protocol.

### Description

Multiple vulnerabilities have been discovered in FreeRDP. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All FreeRDP users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-misc/freerdp-2.11.0"

```
### References

* [CVE-2022-39316](https://nvd.nist.gov/vuln/detail/CVE-2022-39316)
* [CVE-2022-39317](https://nvd.nist.gov/vuln/detail/CVE-2022-39317)
* [CVE-2022-39318](https://nvd.nist.gov/vuln/detail/CVE-2022-39318)
* [CVE-2022-39319](https://nvd.nist.gov/vuln/detail/CVE-2022-39319)
* [CVE-2022-39320](https://nvd.nist.gov/vuln/detail/CVE-2022-39320)
* [CVE-2022-39347](https://nvd.nist.gov/vuln/detail/CVE-2022-39347)
* [CVE-2022-41877](https://nvd.nist.gov/vuln/detail/CVE-2022-41877)
* [CVE-2023-39350](https://nvd.nist.gov/vuln/detail/CVE-2023-39350)
* [CVE-2023-39351](https://nvd.nist.gov/vuln/detail/CVE-2023-39351)
* [CVE-2023-39352](https://nvd.nist.gov/vuln/detail/CVE-2023-39352)
* [CVE-2023-39353](https://nvd.nist.gov/vuln/detail/CVE-2023-39353)
* [CVE-2023-39354](https://nvd.nist.gov/vuln/detail/CVE-2023-39354)
* [CVE-2023-39355](https://nvd.nist.gov/vuln/detail/CVE-2023-39355)
* [CVE-2023-39356](https://nvd.nist.gov/vuln/detail/CVE-2023-39356)
* [CVE-2023-40181](https://nvd.nist.gov/vuln/detail/CVE-2023-40181)
* [CVE-2023-40186](https://nvd.nist.gov/vuln/detail/CVE-2023-40186)
* [CVE-2023-40187](https://nvd.nist.gov/vuln/detail/CVE-2023-40187)
* [CVE-2023-40188](https://nvd.nist.gov/vuln/detail/CVE-2023-40188)
* [CVE-2023-40567](https://nvd.nist.gov/vuln/detail/CVE-2023-40567)
* [CVE-2023-40569](https://nvd.nist.gov/vuln/detail/CVE-2023-40569)
* [CVE-2023-40574](https://nvd.nist.gov/vuln/detail/CVE-2023-40574)
* [CVE-2023-40575](https://nvd.nist.gov/vuln/detail/CVE-2023-40575)
* [CVE-2023-40576](https://nvd.nist.gov/vuln/detail/CVE-2023-40576)
* [CVE-2023-40589](https://nvd.nist.gov/vuln/detail/CVE-2023-40589)

**Release date**

January 12, 2024

**Latest revision**

January 12, 2024: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [881525](https://bugs.gentoo.org/show_bug.cgi?id=881525)
* [918546](https://bugs.gentoo.org/show_bug.cgi?id=918546)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


