=== Content from gitlab.com_b14f4d22_20250110_111426.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Denial of service using asciidoctor include::

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2431562](https://hackerone.com/reports/2431562)** by `gudanggaramfilter` on 2024-03-23, assigned to [@kmorrison1](/kmorrison1 "Kevin Morrison"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

User can cause DoS to affect the entire site by using two .adoc files which include each other via include:: directive. `Gitlab::Asciidoc::IncludeProcessor` simplest mitigation - prevent all use of the include directive. This may have an adverse impact on existing users, and this number needs to be higher if we want to prevent cyclic imports. I think the main problem is with our particular processor <https://gitlab.com/gitlab-org/gitlab/blob/master/lib/gitlab/asciidoc/include_processor.rb> , specifically with `:include_allowed?`

##### Steps to reproduce

1. Create a.adoc and b.adoc files in repository (attached to report).
2. Open the a.adoc or b.adoc file or endpoint <https://gitlab.com/h1-domain-verification-txt/cukurukukngopibang/-/blob/main/b.adoc?format=json&ref_type=heads&viewer=rich>

[gitlab\_badoc.mp4](https://user-content.gitlab-static.net/3e29e35e9d581faecda0893250d11068eda0221e/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f32383439333165382d666432652d343961342d613564342d6430663130356634303864392f6769746c61625f6261646f632e6d7034 "Download 'gitlab_badoc.mp4'")

[gitlab\_adoc.mp4](https://user-content.gitlab-static.net/eca54b5fb01ebd99f7527c0551a5dec9903b7bcb/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f39613361363333312d646564662d346332352d626630392d6630386665363031313030622f6769746c61625f61646f632e6d7034 "Download 'gitlab_adoc.mp4'")

#### Impact

After 60 seconds (timeout) - the request fails. Meanwhile, on the server side, (one) CPU caught fire (verified against instance16.10.0-ce.0-0 and gitlab.com ).

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [gitlab\_badoc.mp4](https://h1.sec.gitlab.net/a/284931e8-fd2e-49a4-a5d4-d0f105f408d9/gitlab_badoc.mp4)
* [gitlab\_adoc.mp4](https://h1.sec.gitlab.net/a/9a3a6331-dedf-4c25-bf09-f08fe601100b/gitlab_adoc.mp4)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Edited Apr 25, 2024 by [Kevin Morrison](/kmorrison1)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


