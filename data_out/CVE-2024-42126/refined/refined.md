```
{
  "cveId": "CVE-2024-42126",
  "description": "PLACEHOLDER - Implement CVE description retrieval",
  "related_patches": [
    {
      "commit": "0db880fc865ffb522141ced4bfa66c12ab1fbb70",
      "link": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0db880fc865ffb522141ced4bfa66c12ab1fbb70",
      "patch_diff": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0db880fc865ffb522141ced4bfa66c12ab1fbb70",
      "details": {
        "root_cause": "The `nmi_enter()` and `nmi_exit()` functions touch per-CPU variables. When these functions are invoked during real-mode interrupt handling (e.g., early HMI/MCE interrupt handlers), and the per-CPU allocation comes from the vmalloc area, it can lead to a kernel crash.",
        "vulnerabilities": [
          "Use of per-CPU variables in interrupt handlers when percpu memory is allocated from vmalloc.",
           "Incorrect handling of nmi_enter/nmi_exit in real-mode interrupts under certain percpu memory configuration."
        ],
        "impact": "Kernel crash during real mode interrupt handling, such as early HMI/MCE interrupt",
        "attack_vector": "Exploitation of a real mode interrupt like HMI/MCE",
        "attacker_capabilities": "An attacker needs to trigger a specific interrupt such as HMI/MCE in a configuration where percpu allocation can come from vmalloc area."
      }
    },
    {
       "commit": "2c78c9411e685dbc9eac8c2845111b03501975b8",
       "link": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2c78c9411e685dbc9eac8c2845111b03501975b8",
       "patch_diff": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2c78c9411e685dbc9eac8c2845111b03501975b8",
      "details": {
        "root_cause": "The `nmi_enter()` and `nmi_exit()` functions touch per-CPU variables, which can lead to a kernel crash if invoked during real-mode interrupt handling when per-CPU memory is not embedded.",
        "vulnerabilities": [
          "Use of per-CPU variables in interrupt handlers when percpu memory is allocated from vmalloc.",
          "Incorrect handling of nmi_enter/nmi_exit in real-mode interrupts when percpu first chunk is not embedded."
        ],
        "impact": "Kernel crash during real-mode interrupt handling, specifically when per-cpu allocation comes from vmalloc area.",
        "attack_vector": "Triggering a real-mode interrupt such as a machine check exception (MCE).",
        "attacker_capabilities": "An attacker needs the ability to cause a machine check (or other real-mode NMI interrupt) on a system where the percpu memory is configured to be allocated from vmalloc."
      }
    },
     {
      "commit": "fb6675db04c4b79883373edc578d5df7bbc84848",
      "link": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fb6675db04c4b79883373edc578d5df7bbc84848",
      "patch_diff": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fb6675db04c4b79883373edc578d5df7bbc84848",
        "details": {
            "root_cause": "The `nmi_enter()` and `nmi_exit()` functions touch per-cpu variables which can lead to a kernel crash during real-mode interrupt handling if the percpu allocation comes from the vmalloc area.",
            "vulnerabilities": [
                "Incorrect usage of `nmi_enter()` and `nmi_exit()` in real mode interrupts when percpu memory is not embedded.",
                "Potential kernel crash due to accessing per-cpu variables during real mode interrupt handling when percpu allocation is from vmalloc."
            ],
            "impact": "Kernel crash during real-mode interrupt handling, particularly machine check exceptions (MCE).",
            "attack_vector": "Triggering a real mode interrupt, specifically a machine check exception (MCE), when per-cpu allocation is not embedded, such as with the `percpu_alloc=page` kernel command line.",
            "attacker_capabilities": "An attacker must have the ability to trigger a machine check exception (or other real-mode NMI interrupt) on a system configured with `CONFIG_NEED_PER_CPU_PAGE_FIRST_CHUNK` enabled and the `percpu_alloc=page` kernel command line option."
        }
    },
    {
      "commit": "8d3f83dfb23674540c827a8d65fba20aa300b252",
      "link": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8d3f83dfb23674540c827a8d65fba20aa300b252",
      "patch_diff": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8d3f83dfb23674540c827a8d65fba20aa300b252",
       "details": {
        "root_cause": "The `nmi_enter()` and `nmi_exit()` functions modify per-CPU variables and may cause a kernel crash if invoked during a real-mode interrupt when per-CPU allocation is not embedded.",
        "vulnerabilities": [
          "Use of per-CPU variables in interrupt handlers when percpu memory is allocated from vmalloc.",
          "Incorrect handling of `nmi_enter()`/`nmi_exit()` during real-mode interrupts when the percpu first chunk is not embedded."
        ],
        "impact": "Kernel crash during real mode interrupt handling (e.g., early HMI/MCE)",
        "attack_vector": "Triggering a real-mode interrupt such as a machine check.",
        "attacker_capabilities": "An attacker needs to be able to cause a real-mode NMI such as machine check on a system with `CONFIG_NEED_PER_CPU_PAGE_FIRST_CHUNK` enabled and using a per-CPU allocation from vmalloc."
      }
    },
    {
      "commit": "0f37946c62c48a907625348cbc720a7a0c547d1e",
      "link": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0f37946c62c48a907625348cbc720a7a0c547d1e",
      "patch_diff": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0f37946c62c48a907625348cbc720a7a0c547d1e",
       "details": {
        "root_cause": "The nmi_enter() and nmi_exit() functions touch per-cpu variables which can cause a kernel crash during real mode interrupt handling if the percpu allocation comes from the vmalloc area.",
        "vulnerabilities": [
           "Incorrect use of nmi_enter/nmi_exit in real mode interrupt handlers.",
            "Potential kernel crash due to accessing per-CPU variables during NMI when the percpu area is allocated from vmalloc."
        ],
        "impact": "Kernel crash during real-mode interrupt handling (e.g. early HMI/MCE interrupt handler) when per-cpu allocation is not embedded.",
        "attack_vector": "Triggering a real-mode interrupt (such as early HMI/MCE) when percpu allocation can come from vmalloc area.",
        "attacker_capabilities": "Attacker needs to trigger a specific interrupt such as HMI/MCE in a configuration where percpu allocation can come from vmalloc area."
      }
    },
    {
      "commit": "e2afb26615adf6c3ceaaa7732aa839bcd587a057",
      "link": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e2afb26615adf6c3ceaaa7732aa839bcd587a057",
      "patch_diff": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e2afb26615adf6c3ceaaa7732aa839bcd587a057",
       "details": {
          "root_cause": "The `nmi_enter()` and `nmi_exit()` functions access per-CPU variables, which can lead to kernel crashes during real-mode interrupt handling if per-CPU allocations come from the vmalloc area.",
          "vulnerabilities": [
            "Use of per-CPU variables in real-mode interrupt handlers when per-CPU memory is not embedded.",
            "Incorrect handling of `nmi_enter()` and `nmi_exit()` when per-CPU first chunk is not embedded."
          ],
          "impact": "Kernel crash during real-mode interrupt handling.",
          "attack_vector": "Triggering a real-mode NMI interrupt.",
          "attacker_capabilities": "An attacker would need to trigger a real-mode NMI interrupt on a system where `CONFIG_NEED_PER_CPU_PAGE_FIRST_CHUNK` is enabled and the percpu allocation is from vmalloc area."
        }
    }

  ]
}
```