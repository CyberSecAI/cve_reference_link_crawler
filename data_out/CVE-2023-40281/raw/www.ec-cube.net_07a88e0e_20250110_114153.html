<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>EC-CUBE 2系におけるクロスサイトスクリプティングの脆弱性(JVN#46993816)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/marx/3.0.7/marx.css">
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-KR8WP44');</script>
    <!-- End Google Tag Manager -->
</head>
<body>
<main>
    <h1>EC-CUBE 2系におけるクロスサイトスクリプティングの脆弱性(JVN#46993816)</h1>

    <section id="history">
        <h5>更新履歴</h5>
        <dl>
            <dt>2023/08/09 16:00</dt>
            <dd>JVN番号と謝辞を追加</dd>
        </dl>
        <dl>
            <dt>2023/07/27 13:00</dt>
            <dd>初版公開</dd>
        </dl>
    </section>

    <section id="info">
        <h2>EC-CUBEにおけるクロスサイトスクリプティングの脆弱性</h2>
        <p>EC-CUBE 2系におけるクロスサイトスクリプティングの脆弱性(危険度: 低)があることが判明いたしました。</p>
        <p>脆弱性そのものは、修正の反映によりすぐに解決するものです。<br>
            以下のいずれかの方法により、ご対応をお願いいたします。</p>
        <ul>
            <li>修正ファイルを適用する</li>
            <li>修正差分を確認して適用する</li>
        </ul>
        <p>
            皆様にはお手数おかけし誠に申し訳ございません。<br>
            本脆弱性における被害報告は現時点でございませんが、できるだけ速やかにご対応をお願いいたします。
        </p>
    </section>

    <section id="about">
        <h2>脆弱性の概要</h2>
        <h3>EC-CUBEにおけるクロスサイトスクリプティングの脆弱性</h3>
        <h4>危険度:</h4>
        <p>低</p>
        <h4>不具合が存在するEC-CUBEのバージョン:</h4>
        <ul>
            <li><strong>2.11.0〜2.11.5</strong></li>
            <li><strong>2.12.0〜2.12.6</strong></li>
            <li><strong>2.13.0〜2.13.5-p1</strong></li>
            <li><strong>2.17.0〜2.17.2-p1</strong></li>
        </ul>
        <h4>詳細:</h4>
        <p>
        該当バージョンのEC-CUBEにはXSSの脆弱性が存在します。攻撃者が管理画面にログイン可能な場合に、当該脆弱性を悪用して、他の管理者またはサイトにアクセスした第三者のブラウザ上で任意のスクリプトを実行させる可能性があります。
        </p>
        <hr>

        <h3>JVNからの公表内容 (2022/08/17公開)</h3>
        <p><a href="https://jvn.jp/jp/JVN46993816/" target="_blank">JVN#46993816: EC-CUBE 2系におけるクロスサイトスクリプティングの脆弱性</a></p>
        <ul>
            <li>EC-CUBE 2系におけるクロスサイトスクリプティングの脆弱性 CVE-2023-40281</li>
        </ul>
    </section>

    <section id="caution">
        <h2 style="background-color: #ed8c1f;">修正ファイル適用による注意点</h2>
        <h3>以下の注意事項をご確認お願いいたします。</h3>
        <p>
            本修正ファイルを適用することにより、スクリプトを含む文字列がサニタイズされます。<br>
            そのため、商品情報やメルマガテンプレートの登録内容にスクリプトが含まれる場合は、スクリプトはサニタイズされ機能しなくなります。あらかじめご了承ください。
        </p>
    </section>

    <section id="hotfix">
        <h2 class="bg-blue">修正方法1: 修正ファイルを利用する場合</h2>
        <p>
            開発環境がある場合は、まず開発環境でお試しください。<br>
            以下の手順に従って、修正ファイルの反映をお願いいたします。
        </p>
        <ol>
            <li>修正ファイルのダウンロード
                <p>
                    ご利用中のEC-CUBEのバージョンに該当する修正ファイルをダウンロードしてください。<br>
                    <small>
                        ※EC-CUBEのバージョンは<a href="https://www.ec-cube.net/info/security/#securit_flow01">こちらの手順</a>でご確認ください。<br>
                        ※修正ファイルは各バージョンの最新版に対して作成しています。旧バージョンをご利用の場合は、「修正方法2」のご対応をお願いします。
                    </small>
                </p>
                <ul>
                    <li>
                        <strong><a href="./eccube-2.17.2-p1.zip">修正ファイル(2.17.2-p1)</a></strong>
                        (SHA256:5d4b2ce7094e78c8a7086ffc40e334ebefccef5e745bc73a6f1a435e516f5958)
                    </li>
                    <li>
                        <strong><a href="./2.13.5-p1.zip">修正ファイル(2.13.5-p1)</a></strong>
                        (SHA256:a8f5ccc02bda915433dd8fa0541cbbe02732d8c9ea0ff88623a614141246b886)
                    </li>
                </ul>
                <p>
                    ダウンロードし、解凍していただきますと、以下の修正ファイルがあります。必ず該当するバージョンのファイルをご利用ください。
                </p>
                <h4>2.17.2-p1</h4>
                <ul>
                    <li>data/smarty_extends/modifier.script_escape.php</li>
                </ul>
                <h4>2.13.5-p1</h4>
                <ul>
                    <li>data/Smarty/templates/admin/mail/preview.tpl</li>
                    <li>data/Smarty/templates/admin/products/confirm.tpl</li>
                    <li>data/Smarty/templates/default/products/detail.tpl</li>
                    <li>data/Smarty/templates/mobile/products/detail.tpl</li>
                    <li>data/Smarty/templates/sphone/products/detail.tpl</li>
                    <li>data/smarty_extends/modifier.script_escape_ex.php</li>
                </ul>
            </li>
            <li>EC-CUBEファイルのバックアップ
                <p>
                    あらかじめEC-CUBEファイル全体のバックアップを行ってください。<br>
                </p>
            </li>
            <li>修正ファイルの反映
                <p>以下のファイルを上書き更新してください。</p>
                <p>上書きするファイル</p>
                <h4>2.17.2-p1</h4>
                <ul>
                    <li>data/smarty_extends/modifier.script_escape.php</li>
                </ul>
                <h4>2.13.5-p1</h4>
                <ul>
                    <li>data/Smarty/templates/admin/mail/preview.tpl</li>
                    <li>data/Smarty/templates/admin/products/confirm.tpl</li>
                    <li>data/Smarty/templates/default/products/detail.tpl</li>
                    <li>data/Smarty/templates/mobile/products/detail.tpl</li>
                    <li>data/Smarty/templates/sphone/products/detail.tpl</li>
                    <li>data/smarty_extends/modifier.script_escape_ex.php</li>
                </ul>
                <small>
                    ※デザインテンプレートの適用や、EC-CUBE本体のカスタマイズをしている場合、修正箇所の差分をご確認のうえ反映をお願いします。<br>
                    ※開発環境がある場合は、開発環境での反映・動作確認を行った後に、本番環境への反映をおすすめします。
                </small>
                </p>
            </li>
            <li>キャッシュの削除
                <p>
                    キャッシュは自動で更新されますが、念の為EC-CUBE のキャッシュの削除をしておくと安全です。以下のディレクトリ配下のキャッシュファイルを削除をお願い致します。<br>
                </p>
                <ul>
                    <li>data/Smarty/templates_c/admin/*</li>
                    <li>data/Smarty/templates_c/default/*</li>
                    <li>data/Smarty/templates_c/sphone/*</li>
                    <li>data/Smarty/templates_c/mobile/*</li>
                    <li>data/Smarty/templates_c/お使いのテンプレート/*</li>
                </ul>
                <small>
                    ※ディレクトリごと削除せず、配下のファイルを削除するようにしてください。
                </small>

            </li>
            <li>動作確認
                <p>
                    フロント画面と管理画面（ログインが必要）それぞれにおいて、基本操作が正常に行えることをご確認ください。<br>
                </p>
            </li>
        </ol>
    </section>

    <section id="diff-v217">
        <h2 class="bg-blue">修正方法2-1: 修正差分を確認して適宜反映する場合<strong>(2.17系)</strong></h2>
        <p>
            以下のコード差分情報を参照して頂き、必要な箇所に修正を反映してください。
        </p>
        <p>本修正方法はEC-CUBE 2.17.2-p1のバージョンを例として提示しております。<br>
            過去バージョンをご利用の場合は、下記修正対象ファイルの修正差分を参考にご対応お願いいたします。<br>
        <h3>修正差分</h3>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" />

    <style>
.d2h-wrapper{text-align:left}.d2h-file-header{background-color:#f7f7f7;border-bottom:1px solid #d8d8d8;display:-webkit-box;display:-ms-flexbox;display:flex;font-family:Source Sans Pro,Helvetica Neue,Helvetica,Arial,sans-serif;height:35px;padding:5px 10px}.d2h-file-header.d2h-sticky-header{position:sticky;top:0;z-index:1}.d2h-file-stats{display:-webkit-box;display:-ms-flexbox;display:flex;font-size:14px;margin-left:auto}.d2h-lines-added{border:1px solid #b4e2b4;border-radius:5px 0 0 5px;color:#399839;padding:2px;text-align:right;vertical-align:middle}.d2h-lines-deleted{border:1px solid #e9aeae;border-radius:0 5px 5px 0;color:#c33;margin-left:1px;padding:2px;text-align:left;vertical-align:middle}.d2h-file-name-wrapper{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;font-size:15px;width:100%}.d2h-file-name{overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap}.d2h-file-wrapper{border:1px solid #ddd;border-radius:3px;margin-bottom:1em}.d2h-file-collapse{-webkit-box-pack:end;-ms-flex-pack:end;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:1px solid #ddd;border-radius:3px;cursor:pointer;display:none;font-size:12px;justify-content:flex-end;padding:4px 8px}.d2h-file-collapse.d2h-selected{background-color:#c8e1ff}.d2h-file-collapse-input{margin:0 4px 0 0}.d2h-diff-table{border-collapse:collapse;font-family:Menlo,Consolas,monospace;font-size:13px;width:100%}.d2h-files-diff{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%}.d2h-file-diff{overflow-y:hidden}.d2h-file-diff.d2h-d-none,.d2h-files-diff.d2h-d-none{display:none}.d2h-file-side-diff{display:inline-block;overflow-x:scroll;overflow-y:hidden;width:50%}.d2h-code-line{padding:0 8em;width:calc(100% - 16em)}.d2h-code-line,.d2h-code-side-line{display:inline-block;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap}.d2h-code-side-line{padding:0 4.5em;width:calc(100% - 9em)}.d2h-code-line-ctn{word-wrap:normal;background:none;display:inline-block;padding:0;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;vertical-align:middle;white-space:pre;width:100%}.d2h-code-line del,.d2h-code-side-line del{background-color:#ffb6ba;border-radius:.2em;display:inline-block;margin-top:-1px;text-decoration:none}.d2h-code-line ins,.d2h-code-side-line ins{background-color:#97f295;border-radius:.2em;display:inline-block;margin-top:-1px;text-align:left;text-decoration:none}.d2h-code-line-prefix{word-wrap:normal;background:none;display:inline;padding:0;white-space:pre}.line-num1{float:left}.line-num1,.line-num2{-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;padding:0 .5em;text-overflow:ellipsis;width:3.5em}.line-num2{float:right}.d2h-code-linenumber{background-color:#fff;border:solid #eee;border-width:0 1px;-webkit-box-sizing:border-box;box-sizing:border-box;color:rgba(0,0,0,.3);cursor:pointer;display:inline-block;position:absolute;text-align:right;width:7.5em}.d2h-code-linenumber:after{content:"\200b"}.d2h-code-side-linenumber{background-color:#fff;border:solid #eee;border-width:0 1px;-webkit-box-sizing:border-box;box-sizing:border-box;color:rgba(0,0,0,.3);cursor:pointer;display:inline-block;overflow:hidden;padding:0 .5em;position:absolute;text-align:right;text-overflow:ellipsis;width:4em}.d2h-code-side-linenumber:after{content:"\200b"}.d2h-code-side-emptyplaceholder,.d2h-emptyplaceholder{background-color:#f1f1f1;border-color:#e1e1e1}.d2h-code-line-prefix,.d2h-code-linenumber,.d2h-code-side-linenumber,.d2h-emptyplaceholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.d2h-code-linenumber,.d2h-code-side-linenumber{direction:rtl}.d2h-del{background-color:#fee8e9;border-color:#e9aeae}.d2h-ins{background-color:#dfd;border-color:#b4e2b4}.d2h-info{background-color:#f8fafd;border-color:#d5e4f2;color:rgba(0,0,0,.3)}.d2h-file-diff .d2h-del.d2h-change{background-color:#fdf2d0}.d2h-file-diff .d2h-ins.d2h-change{background-color:#ded}.d2h-file-list-wrapper{margin-bottom:10px}.d2h-file-list-wrapper a{color:#3572b0;text-decoration:none}.d2h-file-list-wrapper a:visited{color:#3572b0}.d2h-file-list-header{text-align:left}.d2h-file-list-title{font-weight:700}.d2h-file-list-line{display:-webkit-box;display:-ms-flexbox;display:flex;text-align:left}.d2h-file-list{display:block;list-style:none;margin:0;padding:0}.d2h-file-list>li{border-bottom:1px solid #ddd;margin:0;padding:5px 10px}.d2h-file-list>li:last-child{border-bottom:none}.d2h-file-switch{cursor:pointer;display:none;font-size:10px}.d2h-icon{fill:currentColor;margin-right:10px;vertical-align:middle}.d2h-deleted{color:#c33}.d2h-added{color:#399839}.d2h-changed{color:#d0b44c}.d2h-moved{color:#3572b0}.d2h-tag{background-color:#fff;display:-webkit-box;display:-ms-flexbox;display:flex;font-size:10px;margin-left:5px;padding:0 2px}.d2h-deleted-tag{border:1px solid #c33}.d2h-added-tag{border:1px solid #399839}.d2h-changed-tag{border:1px solid #d0b44c}.d2h-moved-tag{border:1px solid #3572b0}
</style>


    <div id="diff">
      <div class="d2h-file-list-wrapper">
    <div class="d2h-file-list-header">
        <span class="d2h-file-list-title">Files changed (1)</span>
        <a class="d2h-file-switch d2h-hide">hide</a>
        <a class="d2h-file-switch d2h-show">show</a>
    </div>
    <ol class="d2h-file-list">
    <li class="d2h-file-list-line">
    <span class="d2h-file-name-wrapper">
      <svg aria-hidden="true" class="d2h-icon d2h-changed" height="16" title="modified" version="1.1"
           viewBox="0 0 14 16" width="14">
          <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM4 8c0-1.66 1.34-3 3-3s3 1.34 3 3-1.34 3-3 3-3-1.34-3-3z"></path>
      </svg>      <a href="#d2h-777336" class="d2h-file-name">data/smarty_extends/modifier.script_escape.php</a>
      <span class="d2h-file-stats">
          <span class="d2h-lines-added">+30</span>
          <span class="d2h-lines-deleted">-6</span>
      </span>
    </span>
</li>
    </ol>
</div><div class="d2h-wrapper">
    <div id="d2h-777336" class="d2h-file-wrapper" data-lang="php">
    <div class="d2h-file-header">
    <span class="d2h-file-name-wrapper">
    <svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">
        <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>
    </svg>    <span class="d2h-file-name">data/smarty_extends/modifier.script_escape.php</span>
    <span class="d2h-tag d2h-changed d2h-changed-tag">CHANGED</span></span>
<label class="d2h-file-collapse">
    <input class="d2h-file-collapse-input" type="checkbox" name="viewed" value="viewed">
    Viewed
</label>
    </div>
    <div class="d2h-file-diff">
        <div class="d2h-code-wrapper">
            <table class="d2h-diff-table">
                <tbody class="d2h-diff-tbody">
                <tr>
    <td class="d2h-code-linenumber d2h-info"></td>
    <td class="d2h-info">
        <div class="d2h-code-line">@@ -9,12 +9,36 @@ function smarty_modifier_script_escape($value)</div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">9</div>
<div class="line-num2">9</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">{</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">10</div>
<div class="line-num2">10</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">    if (is_array($value)) return $value;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">11</div>
<div class="line-num2">11</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-del d2h-change">
      <div class="line-num1">12</div>
<div class="line-num2"></div>
    </td>
    <td class="d2h-del d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">-</span>
            <span class="d2h-code-line-ctn">    $pattern = &quot;<del>&#x2F;&lt;</del>script.*?&gt;|&lt;\&#x2F;script&gt;|javascript:|&lt;svg.*(onload|onerror).*?&gt;|&lt;img.*(onload|onerror).*?&gt;|&lt;body.*onload.*?&gt;|&lt;iframe.*?&gt;|&lt;object.*?&gt;|&lt;embed<del>.*?&gt;|&lt;.*onmouse</del>.*?&gt;|<del>(\</del>&quot;<del>|&#x27;).*(onmouse|onerror|onload|onclick).*=.*(\&quot;|&#x27;).*&#x2F;i&quot;</del>;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins d2h-change">
      <div class="line-num1"></div>
<div class="line-num2">12</div>
    </td>
    <td class="d2h-ins d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    $pattern = &quot;<ins>&lt;</ins>script.*?&gt;|&lt;\&#x2F;script&gt;|javascript:|&lt;svg.*(onload|onerror).*?&gt;|&lt;img.*(onload|onerror).*?&gt;|&lt;body.*onload.*?&gt;|&lt;iframe.*?&gt;|&lt;object.*?&gt;|&lt;embed.*?&gt;|&quot;;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">13</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">14</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    &#x2F;&#x2F; 追加でサニタイズするイベント一覧</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">15</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    $escapeEvents = array(</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">16</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onmouse&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">17</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onclick&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">18</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onblur&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">19</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onfocus&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">20</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onresize&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">21</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onscroll&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">22</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;ondblclick&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">23</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onchange&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">24</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onselect&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">25</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onsubmit&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">26</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onkey&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">27</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    );</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">28</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">29</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    &#x2F;&#x2F; イベント毎の正規表現を生成</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">30</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    $generateHtmlTagPatterns = array_map(function($str) {</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">31</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        return &quot;&lt;(\w+)([^&gt;]*\s)?\&#x2F;?&quot;.$str.&quot;[^&gt;]*&gt;&quot;;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">32</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    }, $escapeEvents);</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">33</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    $pattern .= implode(&quot;|&quot;, $generateHtmlTagPatterns).&quot;|&quot;;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">34</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    $pattern .= &quot;(\&quot;|&#x27;).*(onerror|onload|&quot;.implode(&quot;|&quot;, $escapeEvents).&quot;).*=.*(\&quot;|&#x27;).*&quot;;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">35</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">36</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    &#x2F;&#x2F; 正規表現をまとめる</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">37</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    $attributesPattern = &quot;&#x2F;${pattern}&#x2F;i&quot;;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">38</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">39</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    &#x2F;&#x2F; 置き換える文字列</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">13</div>
<div class="line-num2">40</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">    $convert = &#x27;#script tag escaped#&#x27;;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">14</div>
<div class="line-num2">41</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-del d2h-change">
      <div class="line-num1">15</div>
<div class="line-num2"></div>
    </td>
    <td class="d2h-del d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">-</span>
            <span class="d2h-code-line-ctn">    <del>if</del> <del>(preg_match_all($pattern, $value, $matches)) {</del></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-del d2h-change">
      <div class="line-num1">16</div>
<div class="line-num2"></div>
    </td>
    <td class="d2h-del d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">-</span>
            <span class="d2h-code-line-ctn"><del>        </del>return preg_replace($<del>pattern</del>, $convert, $value);</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-del">
      <div class="line-num1">17</div>
<div class="line-num2"></div>
    </td>
    <td class="d2h-del">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">-</span>
            <span class="d2h-code-line-ctn">    } else {</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-del">
      <div class="line-num1">18</div>
<div class="line-num2"></div>
    </td>
    <td class="d2h-del">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">-</span>
            <span class="d2h-code-line-ctn">        return $value;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-del">
      <div class="line-num1">19</div>
<div class="line-num2"></div>
    </td>
    <td class="d2h-del">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">-</span>
            <span class="d2h-code-line-ctn">    }</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins d2h-change">
      <div class="line-num1"></div>
<div class="line-num2">42</div>
    </td>
    <td class="d2h-ins d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    <ins>&#x2F;&#x2F;</ins> <ins>マッチしたら文字列を置き換える</ins></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins d2h-change">
      <div class="line-num1"></div>
<div class="line-num2">43</div>
    </td>
    <td class="d2h-ins d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"><ins>    </ins>return preg_replace($<ins>attributesPattern</ins>, $convert, $value);</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">20</div>
<div class="line-num2">44</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">}</span>
        </div>
    </td>
</tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
</div>
    </div>

    </section>

    <section id="diff-v213">
        <h2 class="bg-blue">修正方法2-2: 修正差分を確認して適宜反映する場合<strong>(2.13系)</strong></h2>
        <p>
            以下のコード差分情報を参照して頂き、必要な箇所に修正を反映してください。
        </p>
        <p>本修正方法はEC-CUBE 2.13.5-p1のバージョンを例として提示しております。<br>
            過去バージョンをご利用の場合は、下記修正対象ファイルの修正差分を参考にご対応お願いいたします。<br>
        <h3>修正差分</h3>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" />

    <style>
.d2h-wrapper{text-align:left}.d2h-file-header{background-color:#f7f7f7;border-bottom:1px solid #d8d8d8;display:-webkit-box;display:-ms-flexbox;display:flex;font-family:Source Sans Pro,Helvetica Neue,Helvetica,Arial,sans-serif;height:35px;padding:5px 10px}.d2h-file-header.d2h-sticky-header{position:sticky;top:0;z-index:1}.d2h-file-stats{display:-webkit-box;display:-ms-flexbox;display:flex;font-size:14px;margin-left:auto}.d2h-lines-added{border:1px solid #b4e2b4;border-radius:5px 0 0 5px;color:#399839;padding:2px;text-align:right;vertical-align:middle}.d2h-lines-deleted{border:1px solid #e9aeae;border-radius:0 5px 5px 0;color:#c33;margin-left:1px;padding:2px;text-align:left;vertical-align:middle}.d2h-file-name-wrapper{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;font-size:15px;width:100%}.d2h-file-name{overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap}.d2h-file-wrapper{border:1px solid #ddd;border-radius:3px;margin-bottom:1em}.d2h-file-collapse{-webkit-box-pack:end;-ms-flex-pack:end;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:1px solid #ddd;border-radius:3px;cursor:pointer;display:none;font-size:12px;justify-content:flex-end;padding:4px 8px}.d2h-file-collapse.d2h-selected{background-color:#c8e1ff}.d2h-file-collapse-input{margin:0 4px 0 0}.d2h-diff-table{border-collapse:collapse;font-family:Menlo,Consolas,monospace;font-size:13px;width:100%}.d2h-files-diff{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%}.d2h-file-diff{overflow-y:hidden}.d2h-file-diff.d2h-d-none,.d2h-files-diff.d2h-d-none{display:none}.d2h-file-side-diff{display:inline-block;overflow-x:scroll;overflow-y:hidden;width:50%}.d2h-code-line{padding:0 8em;width:calc(100% - 16em)}.d2h-code-line,.d2h-code-side-line{display:inline-block;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap}.d2h-code-side-line{padding:0 4.5em;width:calc(100% - 9em)}.d2h-code-line-ctn{word-wrap:normal;background:none;display:inline-block;padding:0;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;vertical-align:middle;white-space:pre;width:100%}.d2h-code-line del,.d2h-code-side-line del{background-color:#ffb6ba;border-radius:.2em;display:inline-block;margin-top:-1px;text-decoration:none}.d2h-code-line ins,.d2h-code-side-line ins{background-color:#97f295;border-radius:.2em;display:inline-block;margin-top:-1px;text-align:left;text-decoration:none}.d2h-code-line-prefix{word-wrap:normal;background:none;display:inline;padding:0;white-space:pre}.line-num1{float:left}.line-num1,.line-num2{-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;padding:0 .5em;text-overflow:ellipsis;width:3.5em}.line-num2{float:right}.d2h-code-linenumber{background-color:#fff;border:solid #eee;border-width:0 1px;-webkit-box-sizing:border-box;box-sizing:border-box;color:rgba(0,0,0,.3);cursor:pointer;display:inline-block;position:absolute;text-align:right;width:7.5em}.d2h-code-linenumber:after{content:"\200b"}.d2h-code-side-linenumber{background-color:#fff;border:solid #eee;border-width:0 1px;-webkit-box-sizing:border-box;box-sizing:border-box;color:rgba(0,0,0,.3);cursor:pointer;display:inline-block;overflow:hidden;padding:0 .5em;position:absolute;text-align:right;text-overflow:ellipsis;width:4em}.d2h-code-side-linenumber:after{content:"\200b"}.d2h-code-side-emptyplaceholder,.d2h-emptyplaceholder{background-color:#f1f1f1;border-color:#e1e1e1}.d2h-code-line-prefix,.d2h-code-linenumber,.d2h-code-side-linenumber,.d2h-emptyplaceholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.d2h-code-linenumber,.d2h-code-side-linenumber{direction:rtl}.d2h-del{background-color:#fee8e9;border-color:#e9aeae}.d2h-ins{background-color:#dfd;border-color:#b4e2b4}.d2h-info{background-color:#f8fafd;border-color:#d5e4f2;color:rgba(0,0,0,.3)}.d2h-file-diff .d2h-del.d2h-change{background-color:#fdf2d0}.d2h-file-diff .d2h-ins.d2h-change{background-color:#ded}.d2h-file-list-wrapper{margin-bottom:10px}.d2h-file-list-wrapper a{color:#3572b0;text-decoration:none}.d2h-file-list-wrapper a:visited{color:#3572b0}.d2h-file-list-header{text-align:left}.d2h-file-list-title{font-weight:700}.d2h-file-list-line{display:-webkit-box;display:-ms-flexbox;display:flex;text-align:left}.d2h-file-list{display:block;list-style:none;margin:0;padding:0}.d2h-file-list>li{border-bottom:1px solid #ddd;margin:0;padding:5px 10px}.d2h-file-list>li:last-child{border-bottom:none}.d2h-file-switch{cursor:pointer;display:none;font-size:10px}.d2h-icon{fill:currentColor;margin-right:10px;vertical-align:middle}.d2h-deleted{color:#c33}.d2h-added{color:#399839}.d2h-changed{color:#d0b44c}.d2h-moved{color:#3572b0}.d2h-tag{background-color:#fff;display:-webkit-box;display:-ms-flexbox;display:flex;font-size:10px;margin-left:5px;padding:0 2px}.d2h-deleted-tag{border:1px solid #c33}.d2h-added-tag{border:1px solid #399839}.d2h-changed-tag{border:1px solid #d0b44c}.d2h-moved-tag{border:1px solid #3572b0}
</style>

    <div id="diff">
      <div class="d2h-file-list-wrapper">
    <div class="d2h-file-list-header">
        <span class="d2h-file-list-title">Files changed (6)</span>
        <a class="d2h-file-switch d2h-hide">hide</a>
        <a class="d2h-file-switch d2h-show">show</a>
    </div>
    <ol class="d2h-file-list">
    <li class="d2h-file-list-line">
    <span class="d2h-file-name-wrapper">
      <svg aria-hidden="true" class="d2h-icon d2h-changed" height="16" title="modified" version="1.1"
           viewBox="0 0 14 16" width="14">
          <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM4 8c0-1.66 1.34-3 3-3s3 1.34 3 3-1.34 3-3 3-3-1.34-3-3z"></path>
      </svg>      <a href="#d2h-338978" class="d2h-file-name">data/Smarty/templates/admin/mail/preview.tpl</a>
      <span class="d2h-file-stats">
          <span class="d2h-lines-added">+1</span>
          <span class="d2h-lines-deleted">-1</span>
      </span>
    </span>
</li>
<li class="d2h-file-list-line">
    <span class="d2h-file-name-wrapper">
      <svg aria-hidden="true" class="d2h-icon d2h-changed" height="16" title="modified" version="1.1"
           viewBox="0 0 14 16" width="14">
          <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM4 8c0-1.66 1.34-3 3-3s3 1.34 3 3-1.34 3-3 3-3-1.34-3-3z"></path>
      </svg>      <a href="#d2h-391111" class="d2h-file-name">data/Smarty/templates/admin/products/confirm.tpl</a>
      <span class="d2h-file-stats">
          <span class="d2h-lines-added">+2</span>
          <span class="d2h-lines-deleted">-2</span>
      </span>
    </span>
</li>
<li class="d2h-file-list-line">
    <span class="d2h-file-name-wrapper">
      <svg aria-hidden="true" class="d2h-icon d2h-changed" height="16" title="modified" version="1.1"
           viewBox="0 0 14 16" width="14">
          <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM4 8c0-1.66 1.34-3 3-3s3 1.34 3 3-1.34 3-3 3-3-1.34-3-3z"></path>
      </svg>      <a href="#d2h-711776" class="d2h-file-name">data/Smarty/templates/default/products/detail.tpl</a>
      <span class="d2h-file-stats">
          <span class="d2h-lines-added">+3</span>
          <span class="d2h-lines-deleted">-3</span>
      </span>
    </span>
</li>
<li class="d2h-file-list-line">
    <span class="d2h-file-name-wrapper">
      <svg aria-hidden="true" class="d2h-icon d2h-changed" height="16" title="modified" version="1.1"
           viewBox="0 0 14 16" width="14">
          <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM4 8c0-1.66 1.34-3 3-3s3 1.34 3 3-1.34 3-3 3-3-1.34-3-3z"></path>
      </svg>      <a href="#d2h-491103" class="d2h-file-name">data/Smarty/templates/mobile/products/detail.tpl</a>
      <span class="d2h-file-stats">
          <span class="d2h-lines-added">+1</span>
          <span class="d2h-lines-deleted">-1</span>
      </span>
    </span>
</li>
<li class="d2h-file-list-line">
    <span class="d2h-file-name-wrapper">
      <svg aria-hidden="true" class="d2h-icon d2h-changed" height="16" title="modified" version="1.1"
           viewBox="0 0 14 16" width="14">
          <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM4 8c0-1.66 1.34-3 3-3s3 1.34 3 3-1.34 3-3 3-3-1.34-3-3z"></path>
      </svg>      <a href="#d2h-147814" class="d2h-file-name">data/Smarty/templates/sphone/products/detail.tpl</a>
      <span class="d2h-file-stats">
          <span class="d2h-lines-added">+2</span>
          <span class="d2h-lines-deleted">-2</span>
      </span>
    </span>
</li>
<li class="d2h-file-list-line">
    <span class="d2h-file-name-wrapper">
      <svg aria-hidden="true" class="d2h-icon d2h-added" height="16" title="added" version="1.1" viewBox="0 0 14 16"
           width="14">
          <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM6 9H3V7h3V4h2v3h3v2H8v3H6V9z"></path>
      </svg>      <a href="#d2h-162334" class="d2h-file-name">data/smarty_extends/modifier.script_escape_ex.php</a>
      <span class="d2h-file-stats">
          <span class="d2h-lines-added">+44</span>
          <span class="d2h-lines-deleted">-0</span>
      </span>
    </span>
</li>
    </ol>
</div><div class="d2h-wrapper">
    <div id="d2h-338978" class="d2h-file-wrapper" data-lang="tpl">
    <div class="d2h-file-header">
    <span class="d2h-file-name-wrapper">
    <svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">
        <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>
    </svg>    <span class="d2h-file-name">data/Smarty/templates/admin/mail/preview.tpl</span>
    <span class="d2h-tag d2h-changed d2h-changed-tag">CHANGED</span></span>
<label class="d2h-file-collapse">
    <input class="d2h-file-collapse-input" type="checkbox" name="viewed" value="viewed">
    Viewed
</label>
    </div>
    <div class="d2h-file-diff">
        <div class="d2h-code-wrapper">
            <table class="d2h-diff-table">
                <tbody class="d2h-diff-tbody">
                <tr>
    <td class="d2h-code-linenumber d2h-info"></td>
    <td class="d2h-info">
        <div class="d2h-code-line">@@ -22,4 +22,4 @@</div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">22</div>
<div class="line-num2">22</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn"> *&#x2F;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">23</div>
<div class="line-num2">23</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">*}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">24</div>
<div class="line-num2">24</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-del d2h-change">
      <div class="line-num1">25</div>
<div class="line-num2"></div>
    </td>
    <td class="d2h-del d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">-</span>
            <span class="d2h-code-line-ctn">&lt;!--{if $mail.mail_method eq 2}--&gt;&lt;!--{$mail.body|h|nl2br}--&gt;&lt;!--{else}--&gt;&lt;!--{$mail.body}--&gt;&lt;!--{&#x2F;if}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins d2h-change">
      <div class="line-num1"></div>
<div class="line-num2">25</div>
    </td>
    <td class="d2h-ins d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">&lt;!--{if $mail.mail_method eq 2}--&gt;&lt;!--{$mail.body|h|nl2br}--&gt;&lt;!--{else}--&gt;&lt;!--{$mail.body<ins>|script_escape_ex</ins>}--&gt;&lt;!--{&#x2F;if}--&gt;</span>
        </div>
    </td>
</tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<div id="d2h-391111" class="d2h-file-wrapper" data-lang="tpl">
    <div class="d2h-file-header">
    <span class="d2h-file-name-wrapper">
    <svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">
        <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>
    </svg>    <span class="d2h-file-name">data/Smarty/templates/admin/products/confirm.tpl</span>
    <span class="d2h-tag d2h-changed d2h-changed-tag">CHANGED</span></span>
<label class="d2h-file-collapse">
    <input class="d2h-file-collapse-input" type="checkbox" name="viewed" value="viewed">
    Viewed
</label>
    </div>
    <div class="d2h-file-diff">
        <div class="d2h-code-wrapper">
            <table class="d2h-diff-table">
                <tbody class="d2h-diff-tbody">
                <tr>
    <td class="d2h-code-linenumber d2h-info"></td>
    <td class="d2h-info">
        <div class="d2h-code-line">@@ -200,7 +200,7 @@</div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">200</div>
<div class="line-num2">200</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">        &lt;tr&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">201</div>
<div class="line-num2">201</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">            &lt;th&gt;詳細-メインコメント&lt;&#x2F;th&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">202</div>
<div class="line-num2">202</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">            &lt;td&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-del d2h-change">
      <div class="line-num1">203</div>
<div class="line-num2"></div>
    </td>
    <td class="d2h-del d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">-</span>
            <span class="d2h-code-line-ctn">                &lt;!--{$arrForm.main_comment|nl2br_html}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins d2h-change">
      <div class="line-num1"></div>
<div class="line-num2">203</div>
    </td>
    <td class="d2h-ins d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">                &lt;!--{$arrForm.main_comment|nl2br_html<ins>|script_escape_ex</ins>}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">204</div>
<div class="line-num2">204</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">            &lt;&#x2F;td&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">205</div>
<div class="line-num2">205</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">        &lt;&#x2F;tr&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">206</div>
<div class="line-num2">206</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">        &lt;tr&gt;</span>
        </div>
    </td>
</tr>
<tr>
    <td class="d2h-code-linenumber d2h-info"></td>
    <td class="d2h-info">
        <div class="d2h-code-line">@@ -249,7 +249,7 @@</div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">249</div>
<div class="line-num2">249</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                &lt;th&gt;詳細-サブコメント（&lt;!--{$smarty.section.cnt.iteration}--&gt;）&lt;&#x2F;th&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">250</div>
<div class="line-num2">250</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                &lt;td&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">251</div>
<div class="line-num2">251</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                    &lt;!--{assign var=key value=&quot;sub_comment`$smarty.section.cnt.iteration`&quot;}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-del d2h-change">
      <div class="line-num1">252</div>
<div class="line-num2"></div>
    </td>
    <td class="d2h-del d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">-</span>
            <span class="d2h-code-line-ctn">                    &lt;!--{$arrForm[$key]|nl2br_html}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins d2h-change">
      <div class="line-num1"></div>
<div class="line-num2">252</div>
    </td>
    <td class="d2h-ins d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">                    &lt;!--{$arrForm[$key]|nl2br_html<ins>|script_escape_ex</ins>}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">253</div>
<div class="line-num2">253</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                &lt;&#x2F;td&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">254</div>
<div class="line-num2">254</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">            &lt;&#x2F;tr&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">255</div>
<div class="line-num2">255</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">            &lt;tr&gt;</span>
        </div>
    </td>
</tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<div id="d2h-711776" class="d2h-file-wrapper" data-lang="tpl">
    <div class="d2h-file-header">
    <span class="d2h-file-name-wrapper">
    <svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">
        <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>
    </svg>    <span class="d2h-file-name">data/Smarty/templates/default/products/detail.tpl</span>
    <span class="d2h-tag d2h-changed d2h-changed-tag">CHANGED</span></span>
<label class="d2h-file-collapse">
    <input class="d2h-file-collapse-input" type="checkbox" name="viewed" value="viewed">
    Viewed
</label>
    </div>
    <div class="d2h-file-diff">
        <div class="d2h-code-wrapper">
            <table class="d2h-diff-table">
                <tbody class="d2h-diff-tbody">
                <tr>
    <td class="d2h-code-linenumber d2h-info"></td>
    <td class="d2h-info">
        <div class="d2h-code-line">@@ -177,7 +177,7 @@</div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">177</div>
<div class="line-num2">177</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                &lt;&#x2F;dl&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">178</div>
<div class="line-num2">178</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">179</div>
<div class="line-num2">179</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                &lt;!--★詳細メインコメント★--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-del d2h-change">
      <div class="line-num1">180</div>
<div class="line-num2"></div>
    </td>
    <td class="d2h-del d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">-</span>
            <span class="d2h-code-line-ctn">                &lt;div class=&quot;main_comment&quot;&gt;&lt;!--{$arrProduct.main_comment|nl2br_html}--&gt;&lt;&#x2F;div&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins d2h-change">
      <div class="line-num1"></div>
<div class="line-num2">180</div>
    </td>
    <td class="d2h-ins d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">                &lt;div class=&quot;main_comment&quot;&gt;&lt;!--{$arrProduct.main_comment|nl2br_html<ins>|script_escape_ex</ins>}--&gt;&lt;&#x2F;div&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">181</div>
<div class="line-num2">181</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">182</div>
<div class="line-num2">182</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                &lt;!--▼買い物カゴ--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">183</div>
<div class="line-num2">183</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                &lt;div class=&quot;cart_area clearfix&quot;&gt;</span>
        </div>
    </td>
</tr>
<tr>
    <td class="d2h-code-linenumber d2h-info"></td>
    <td class="d2h-info">
        <div class="d2h-code-line">@@ -292,7 +292,7 @@</div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">292</div>
<div class="line-num2">292</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                &lt;!--▼サブ画像--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">293</div>
<div class="line-num2">293</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                &lt;!--{assign var=lkey value=&quot;sub_large_image`$smarty.section.cnt.index+1`&quot;}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">294</div>
<div class="line-num2">294</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                &lt;!--{if $arrProduct[$ikey]|strlen &gt;= 1}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-del d2h-change">
      <div class="line-num1">295</div>
<div class="line-num2"></div>
    </td>
    <td class="d2h-del d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">-</span>
            <span class="d2h-code-line-ctn">                    &lt;div class=&quot;subtext&quot;&gt;&lt;!--★サブテキスト★--&gt;&lt;!--{$arrProduct[$ckey]|nl2br_html}--&gt;&lt;&#x2F;div&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins d2h-change">
      <div class="line-num1"></div>
<div class="line-num2">295</div>
    </td>
    <td class="d2h-ins d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">                    &lt;div class=&quot;subtext&quot;&gt;&lt;!--★サブテキスト★--&gt;&lt;!--{$arrProduct[$ckey]|nl2br_html<ins>|script_escape_ex</ins>}--&gt;&lt;&#x2F;div&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">296</div>
<div class="line-num2">296</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                    &lt;div class=&quot;subphotoimg&quot;&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">297</div>
<div class="line-num2">297</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                        &lt;!--{if $arrProduct[$lkey]|strlen &gt;= 1}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">298</div>
<div class="line-num2">298</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                            &lt;a href=&quot;&lt;!--{$smarty.const.IMAGE_SAVE_URLPATH}--&gt;&lt;!--{$arrProduct[$lkey]|h}--&gt;&quot; class=&quot;expansion&quot; target=&quot;_blank&quot; &gt;</span>
        </div>
    </td>
</tr>
<tr>
    <td class="d2h-code-linenumber d2h-info"></td>
    <td class="d2h-info">
        <div class="d2h-code-line">@@ -307,7 +307,7 @@</div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">307</div>
<div class="line-num2">307</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                        &lt;!--{&#x2F;if}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">308</div>
<div class="line-num2">308</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                    &lt;&#x2F;div&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">309</div>
<div class="line-num2">309</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                &lt;!--{else}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-del d2h-change">
      <div class="line-num1">310</div>
<div class="line-num2"></div>
    </td>
    <td class="d2h-del d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">-</span>
            <span class="d2h-code-line-ctn">                    &lt;p class=&quot;subtext&quot;&gt;&lt;!--★サブテキスト★--&gt;&lt;!--{$arrProduct[$ckey]|nl2br_html}--&gt;&lt;&#x2F;p&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins d2h-change">
      <div class="line-num1"></div>
<div class="line-num2">310</div>
    </td>
    <td class="d2h-ins d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">                    &lt;p class=&quot;subtext&quot;&gt;&lt;!--★サブテキスト★--&gt;&lt;!--{$arrProduct[$ckey]|nl2br_html<ins>|script_escape_ex</ins>}--&gt;&lt;&#x2F;p&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">311</div>
<div class="line-num2">311</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                &lt;!--{&#x2F;if}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">312</div>
<div class="line-num2">312</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                &lt;!--▲サブ画像--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">313</div>
<div class="line-num2">313</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">            &lt;&#x2F;div&gt;</span>
        </div>
    </td>
</tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<div id="d2h-491103" class="d2h-file-wrapper" data-lang="tpl">
    <div class="d2h-file-header">
    <span class="d2h-file-name-wrapper">
    <svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">
        <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>
    </svg>    <span class="d2h-file-name">data/Smarty/templates/mobile/products/detail.tpl</span>
    <span class="d2h-tag d2h-changed d2h-changed-tag">CHANGED</span></span>
<label class="d2h-file-collapse">
    <input class="d2h-file-collapse-input" type="checkbox" name="viewed" value="viewed">
    Viewed
</label>
    </div>
    <div class="d2h-file-diff">
        <div class="d2h-code-wrapper">
            <table class="d2h-diff-table">
                <tbody class="d2h-diff-tbody">
                <tr>
    <td class="d2h-code-linenumber d2h-info"></td>
    <td class="d2h-info">
        <div class="d2h-code-line">@@ -59,7 +59,7 @@</div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">59</div>
<div class="line-num2">59</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">    &lt;!--{&#x2F;if}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">60</div>
<div class="line-num2">60</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">61</div>
<div class="line-num2">61</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">    &lt;!--★詳細メインコメント★--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-del d2h-change">
      <div class="line-num1">62</div>
<div class="line-num2"></div>
    </td>
    <td class="d2h-del d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">-</span>
            <span class="d2h-code-line-ctn">    [emoji:76]&lt;!--{$arrProduct.main_comment|nl2br_html}--&gt;&lt;br&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins d2h-change">
      <div class="line-num1"></div>
<div class="line-num2">62</div>
    </td>
    <td class="d2h-ins d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    [emoji:76]&lt;!--{$arrProduct.main_comment|nl2br_html<ins>|script_escape_ex</ins>}--&gt;&lt;br&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">63</div>
<div class="line-num2">63</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">    &lt;br&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">64</div>
<div class="line-num2">64</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">65</div>
<div class="line-num2">65</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">    &lt;!--▼商品ステータス--&gt;</span>
        </div>
    </td>
</tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<div id="d2h-147814" class="d2h-file-wrapper" data-lang="tpl">
    <div class="d2h-file-header">
    <span class="d2h-file-name-wrapper">
    <svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">
        <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>
    </svg>    <span class="d2h-file-name">data/Smarty/templates/sphone/products/detail.tpl</span>
    <span class="d2h-tag d2h-changed d2h-changed-tag">CHANGED</span></span>
<label class="d2h-file-collapse">
    <input class="d2h-file-collapse-input" type="checkbox" name="viewed" value="viewed">
    Viewed
</label>
    </div>
    <div class="d2h-file-diff">
        <div class="d2h-code-wrapper">
            <table class="d2h-diff-table">
                <tbody class="d2h-diff-tbody">
                <tr>
    <td class="d2h-code-linenumber d2h-info"></td>
    <td class="d2h-info">
        <div class="d2h-code-line">@@ -118,7 +118,7 @@</div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">118</div>
<div class="line-num2">118</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">    &lt;section id=&quot;detailarea&quot;&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">119</div>
<div class="line-num2">119</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">120</div>
<div class="line-num2">120</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">        &lt;!--★詳細メインコメント★--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-del d2h-change">
      <div class="line-num1">121</div>
<div class="line-num2"></div>
    </td>
    <td class="d2h-del d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">-</span>
            <span class="d2h-code-line-ctn">        &lt;p class=&quot;main_comment&quot;&gt;&lt;!--{$arrProduct.main_comment|nl2br_html}--&gt;&lt;&#x2F;p&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins d2h-change">
      <div class="line-num1"></div>
<div class="line-num2">121</div>
    </td>
    <td class="d2h-ins d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &lt;p class=&quot;main_comment&quot;&gt;&lt;!--{$arrProduct.main_comment|nl2br_html<ins>|script_escape_ex</ins>}--&gt;&lt;&#x2F;p&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">122</div>
<div class="line-num2">122</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">123</div>
<div class="line-num2">123</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">        &lt;form name=&quot;form1&quot; id=&quot;form1&quot; method=&quot;post&quot; action=&quot;&lt;!--{$smarty.const.ROOT_URLPATH}--&gt;products&#x2F;detail.php&quot;&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">124</div>
<div class="line-num2">124</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">            &lt;div id=&quot;detailrightblock&quot;&gt;</span>
        </div>
    </td>
</tr>
<tr>
    <td class="d2h-code-linenumber d2h-info"></td>
    <td class="d2h-info">
        <div class="d2h-code-line">@@ -342,7 +342,7 @@</div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">342</div>
<div class="line-num2">342</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                            &lt;&#x2F;p&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">343</div>
<div class="line-num2">343</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                        &lt;!--{&#x2F;if}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">344</div>
<div class="line-num2">344</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                        &lt;!--★サブテキスト★--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-del d2h-change">
      <div class="line-num1">345</div>
<div class="line-num2"></div>
    </td>
    <td class="d2h-del d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">-</span>
            <span class="d2h-code-line-ctn">                        &lt;p class=&quot;subtext&quot;&gt;&lt;!--★サブテキスト★--&gt;&lt;!--{$arrProduct[$ckey]|nl2br_html}--&gt;&lt;&#x2F;p&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins d2h-change">
      <div class="line-num1"></div>
<div class="line-num2">345</div>
    </td>
    <td class="d2h-ins d2h-change">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">                        &lt;p class=&quot;subtext&quot;&gt;&lt;!--★サブテキスト★--&gt;&lt;!--{$arrProduct[$ckey]|nl2br_html<ins>|script_escape_ex</ins>}--&gt;&lt;&#x2F;p&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">346</div>
<div class="line-num2">346</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                    &lt;&#x2F;div&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">347</div>
<div class="line-num2">347</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">                &lt;!--{&#x2F;if}--&gt;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-cntx">
      <div class="line-num1">348</div>
<div class="line-num2">348</div>
    </td>
    <td class="d2h-cntx">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">&nbsp;</span>
            <span class="d2h-code-line-ctn">            &lt;!--{&#x2F;section}--&gt;</span>
        </div>
    </td>
</tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<div id="d2h-162334" class="d2h-file-wrapper" data-lang="php">
    <div class="d2h-file-header">
    <span class="d2h-file-name-wrapper">
    <svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">
        <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>
    </svg>    <span class="d2h-file-name">data/smarty_extends/modifier.script_escape_ex.php</span>
    <span class="d2h-tag d2h-added d2h-added-tag">ADDED</span></span>
<label class="d2h-file-collapse">
    <input class="d2h-file-collapse-input" type="checkbox" name="viewed" value="viewed">
    Viewed
</label>
    </div>
    <div class="d2h-file-diff">
        <div class="d2h-code-wrapper">
            <table class="d2h-diff-table">
                <tbody class="d2h-diff-tbody">
                <tr>
    <td class="d2h-code-linenumber d2h-info"></td>
    <td class="d2h-info">
        <div class="d2h-code-line">@@ -0,0 +1,44 @@</div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">1</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">&lt;?php</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">2</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">&#x2F;**</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">3</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"> * Scriptタグをエスケープする</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">4</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"> *</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">5</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"> * @param  string $value 入力</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">6</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"> * @return string $value マッチした場合は変換後の文字列、しない場合は入力された文字列をそのまま返す。</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">7</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"> *&#x2F;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">8</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">function smarty_modifier_script_escape_ex($value)</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">9</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">{</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">10</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    if (is_array($value)) return $value;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">11</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">12</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    $pattern = &quot;&lt;script.*?&gt;|&lt;\&#x2F;script&gt;|javascript:|&lt;svg.*(onload|onerror).*?&gt;|&lt;img.*(onload|onerror).*?&gt;|&lt;body.*onload.*?&gt;|&lt;iframe.*?&gt;|&lt;object.*?&gt;|&lt;embed.*?&gt;|&quot;;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">13</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">14</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    &#x2F;&#x2F; 追加でサニタイズするイベント一覧</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">15</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    $escapeEvents = array(</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">16</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onmouse&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">17</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onclick&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">18</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onblur&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">19</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onfocus&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">20</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onresize&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">21</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onscroll&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">22</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;ondblclick&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">23</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onchange&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">24</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onselect&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">25</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onsubmit&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">26</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        &#x27;onkey&#x27;,</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">27</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    );</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">28</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">29</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    &#x2F;&#x2F; イベント毎の正規表現を生成</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">30</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    $generateHtmlTagPatterns = array_map(function($str) {</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">31</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        return &quot;&lt;(\w+)([^&gt;]*\s)?\&#x2F;?&quot;.$str.&quot;[^&gt;]*&gt;&quot;;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">32</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    }, $escapeEvents);</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">33</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    $pattern .= implode(&quot;|&quot;, $generateHtmlTagPatterns).&quot;|&quot;;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">34</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    $pattern .= &quot;(\&quot;|&#x27;).*(onerror|onload|&quot;.implode(&quot;|&quot;, $escapeEvents).&quot;).*=.*(\&quot;|&#x27;).*&quot;;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">35</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">36</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    &#x2F;&#x2F; 正規表現をまとめる</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">37</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    $attributesPattern = &quot;&#x2F;${pattern}&#x2F;i&quot;;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">38</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">39</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    &#x2F;&#x2F; 置き換える文字列</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">40</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    $convert = &#x27;#script tag escaped#&#x27;;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">41</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn"><br></span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">42</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    &#x2F;&#x2F; マッチしたら文字列を置き換える</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">43</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    return preg_replace($attributesPattern, $convert, $value);</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">44</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">}</span>
        </div>
    </td>
</tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
</div>
    </div>

    </section>

    <section id="contact">
        <h3>問い合わせ先</h3>
        <p>本脆弱性に関するお問合せ：</p>
        <p>
            EC-CUBE 運営チーム<br>
            MAIL: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="cfbcbabfbfa0bdbb8faaace2acbaadaae1a1aabb">[email&#160;protected]</a>
        </p>
    </section>

    <section id="thanks">
        <h3>謝辞</h3>
        <p>本脆弱性は、</p>
        <p>
            <ul>
                <li>三井物産セキュアディレクション株式会社 島峰 泰平 様</li>
            </ul>
        </p>
        <p>
            よりご報告いただきました。<br>
            この場をお借りして、厚く御礼申し上げます。
        </p>
    </section>

</main>

<style>
    main {
        max-width: 960px;
    }

    main p {
        line-height: 1.8;
    }

    section {
        border: 1px solid #ccc;
        padding: 0 20px 20px;
        margin: 40px 0;
    }

    h1 {
        font-size: 22px;
    }

    h2 {
        font-size: 20px;
    }

    h3 {
        font-size: 18px;
        font-weight: bold;
        margin: 1.5rem 0 0.5rem;
    }

    h4 {
        font-size: 16px;
        font-weight: bold;
    }

    h5 {
        font-size: 16px;
    }

    section > h1:first-child,
    section > h2:first-child,
    section > h3:first-child,
    section > h4:first-child,
    section > h5:first-child {
        background-color: #ccc;
        padding: 16px;
        margin: 0 -20px 16px;
    }

    .bg-blue,
    section > :first-child.bg-blue {
        background-color: #95caff;
    }

    section > h5:first-child {
        background-color: #d8c7cc;
    }

    code {
        display: block;
        font-size: 90%;
        margin: 1em 2em;
        padding: 1em;
        background-color: #eee;
    }

    .warning {
        color: red;
        font-weight: bold;
    }

    #diff td,
    #diff th {
        padding: 0;
        border-bottom: none;
    }
</style>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
</html>