[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe02d5fe218ab&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40Null__Byte%2Fserver-side-request-forgery-in-strapi-e02d5fe218ab&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40Null__Byte%2Fserver-side-request-forgery-in-strapi-e02d5fe218ab&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Server-side request forgery in STRAPI v4.24.4 (CVE-2024–37818)

[![Vaibhav Barkade](https://miro.medium.com/v2/resize:fill:88:88/0*L0-v0RH5ltG-2p_y.jpg)](/%40Null__Byte?source=post_page---byline--e02d5fe218ab--------------------------------)

[Vaibhav Barkade](/%40Null__Byte?source=post_page---byline--e02d5fe218ab--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd9c26be45857&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40Null__Byte%2Fserver-side-request-forgery-in-strapi-e02d5fe218ab&user=Vaibhav+Barkade&userId=d9c26be45857&source=post_page-d9c26be45857--byline--e02d5fe218ab---------------------post_header-----------)

3 min read·Jun 19, 2024

--

1

Listen

Share

**Description :**

Server-side request forgery is a web security vulnerability that allows an attacker to cause the server-side application to make requests to an unintended location.

In a typical SSRF attack, the attacker might cause the server to make a connection to internal-only services within the organization’s infrastructure. In other cases, they may be able to force the server to connect to arbitrary external systems. This could leak sensitive data, such as authorization credentials.

**Evidence/Steps to Reproduce :**

1. Login to application using valid admin credentials and click on BLOG.

![]()

2. Now capture the request for the below shown API from screenshot and press “CTRL+R” for sending request to the repeater. Notice that API tries to fetch the image resource from remote url.

![]()

3. Now change the URL parameter to the internal IP i.e. 127.0.0.1 and hit the send button. Notice that application blocks the request as shown in the below response.

URL : [https://strapi.io/\_next/image?url=http://127.0.0.1&w=64&q=64](https://strapi.io/_next/image?url=http%3A%2F%2F127.0.0.1&w=64&q=64)

![]()

4. Now bypass this restriction by using <http://localhost> and notice that application tries to fetch the content from internal open port.

![]()

5. Now to verify the vulnerability change the port number to any random port and observe the response. As shown in below attached screenshot, application throws the error if port is closed.

![]()

6. Now send the request to the intruder and set the payload position as the port number.

![]()

7. Now select the payload as the “Number” and set the Range from “1–65535”. After that click on Start attack button.

![]()

8. Notice the response. An attacker can find the internal open ports based on the responses as shown in attached screenshot.

![]()

**Note : This attack can be perform as an unauthorized user by simply sending GET request to the below endpoint.**

**URL :** [**https://strapi.io/\_next/image?url=http://127.0.0.1&w=64&q=64**](https://strapi.io/_next/image?url=http%3A%2F%2F127.0.0.1&w=64&q=64)

**Remediation**

1. Whitelists and DNS Resolution

2. Authentication on Internal Services

3. Harden Cloud Services

4. Response Handling

5. Disable Unused URL Schemas

**References**

1. <https://portswigger.net/web-security/ssrf#:~:text=Server%2Dside%20request%20forgery%20is,services%20within%20the%20organization's%20infrastructure.>

2. <https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html>

--

--

1

[![Vaibhav Barkade](https://miro.medium.com/v2/resize:fill:96:96/0*L0-v0RH5ltG-2p_y.jpg)](/%40Null__Byte?source=post_page---post_author_info--e02d5fe218ab--------------------------------)[![Vaibhav Barkade](https://miro.medium.com/v2/resize:fill:128:128/0*L0-v0RH5ltG-2p_y.jpg)](/%40Null__Byte?source=post_page---post_author_info--e02d5fe218ab--------------------------------)Follow[## Written by Vaibhav Barkade](/%40Null__Byte?source=post_page---post_author_info--e02d5fe218ab--------------------------------)[3 Followers](/%40Null__Byte/followers?source=post_page---post_author_info--e02d5fe218ab--------------------------------)·[1 Following](/%40Null__Byte/following?source=post_page---post_author_info--e02d5fe218ab--------------------------------)

Senior Analyst at @Deloitte USi

Follow
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----e02d5fe218ab--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----e02d5fe218ab--------------------------------)[About](/about?autoplay=1&source=post_page-----e02d5fe218ab--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----e02d5fe218ab--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----e02d5fe218ab--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----e02d5fe218ab--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e02d5fe218ab--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e02d5fe218ab--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----e02d5fe218ab--------------------------------)[Teams](/business?source=post_page-----e02d5fe218ab--------------------------------)

