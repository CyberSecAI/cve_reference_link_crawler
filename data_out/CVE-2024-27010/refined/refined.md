The provided content relates to CVE-2024-27010.

**Root cause of vulnerability:**
A deadlock occurs when using the mirred action on a classful egress qdisc where a packet is mirrored or redirected to the same device, leading to a recursive locking situation on the qdisc lock.

**Weaknesses/vulnerabilities present:**
- **Recursive Locking:** The vulnerability lies in the possibility of a recursive lock acquisition on the qdisc lock when a packet is redirected to the same device via the mirred action. The qdisc lock is acquired in `__dev_queue_xmit` function and if the same function is called recursively on the same qdisc, it leads to a deadlock.

**Impact of exploitation:**
- **Denial of Service (DoS):** The deadlock condition leads to a system hang, resulting in a denial of service.

**Attack vectors:**
- **Network Configuration:** By setting up specific traffic control (tc) rules that utilize the `mirred` action to redirect traffic to the same device, an attacker can trigger the deadlock. This involves creating a classful egress qdisc and a filter that redirects mirrored traffic back to the same device.

**Required attacker capabilities/position:**
- An attacker must be able to configure network traffic control rules on the target system. This typically requires root or administrative privileges.

**Technical Details:**
- The deadlock occurs in the `__dev_queue_xmit` function of the Linux kernel networking stack.
- The `mirred` action is used to mirror or redirect packets to another network interface.
- The issue arises when the mirrored or redirected traffic is sent back to the same interface it originated from leading to a loop.
- The fix introduces an `owner` field to the `Qdisc` structure to identify the CPU that is processing the qdisc. If the same CPU attempts to re-enter the qdisc, the packet is dropped, breaking the loop.
- The fix adds a check in `dev.c` to identify if the qdisc is already being processed by the current CPU.
- The `owner` field is set when a packet is enqueued and reset when dequeuing.