- **Root cause of vulnerability:** The vulnerability stems from the usage of `os.path.commonprefix` to validate the path against the intended directory in E2Nest's URL parser. This string-based comparison is insufficient to prevent path traversal, as it can be bypassed with specific inputs, allowing relative path components to escape the intended directory.
- **Weaknesses/vulnerabilities present:** Path traversal vulnerability in E2Nest's URL parser. Insecure path validation using `os.path.commonprefix`.
- **Impact of exploitation:** An unauthenticated attacker can exploit this vulnerability to access files outside the designated `mp4_root` directory. This includes sensitive information like server settings (e.g., `settings.py`) and other files stored on the E2Nest server's filesystem.
- **Attack vectors:** By supplying malicious payloads within the URL path, an attacker can perform path traversal. This involves using specific combinations of directory traversal sequences (e.g., `../`) to access files outside the intended directory.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP requests to the vulnerable E2Nest server. No authentication is required to exploit this vulnerability.