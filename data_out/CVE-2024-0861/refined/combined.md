=== Content from gitlab.com_86532db6_20250111_030752.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Users with the `Guest` role can change `Custom dashboard projects` settings for projects in the victim group

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2316435](https://hackerone.com/reports/2316435)** by `them4les_l1r` on 2024-01-15, assigned to [@kmorrison1](/kmorrison1 "Kevin Morrison"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary:

Based on [this documentation](https://docs.gitlab.com/ee/user/permissions.html). Users with `Guest` cannot change group and project settings.

I found a bug where users with the `Guest` role can change the `Analytics Dashboards` settings for groups and projects.

##### Step to Reproduce:

[victim]

1. To reproduce this bug, you need to create a gitlab account with the `Ultimate Saas Plan Trial` feature
2. Go to <https://gitlab.com> and select `Get Free Trial`
3. Complete registration and at the end of the form you are asked to create a group and project.
4. Invite the attacker as a guest in your project.
5. Go to `your group` -> select `your project` -> in the sidebar select `Settings -> Analytics` -> expand. You will notice that `Custom dashboard projects` is not yet setup.
6. The attacker will set these features.

[Attacker]

1. Open <https://gitlab.com> and log in to the attacker's account
2. Go to the victim's group -> then select victim project
3. Add `/-/settings/analytics` to the end of the url and enter
4. You will be directed to the `Custom dashboard projects` page.

[![Screenshot_from_2024-01-15_10-38-12.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/0b25bc1a4701f5bde208859e7c574c40f4933cd3/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34343632343236342d323731362d346332362d613634382d6339633834303134393932652f53637265656e73686f745f66726f6d5f323032342d30312d31355f31302d33382d31322e706e67)

5. Select the victim project in the combobox and select `save changes`. The attacker succeeded in changing the `Custom dashboard projects` setting on the victim project

#### Affected endpoints:

```
POST /group-name/project-name/-/settings/analytics HTTP/2
Host: gitlab.com

_method=patch&authenticity_token={TOKEN}&project%5Banalytics_dashboards_pointer_attributes%5D%5Bid%5D=XXXXXX&project%5Banalytics_dashboards_pointer_attributes%5D%5Btarget_project_id%5D={PROJECT ID}
```

##### POC VIDEO:

[Attacker\_as\_guest\_can\_set\_Custom\_Analytics\_Dashboard.mp4](https://user-content.gitlab-static.net/0cab89e76dcf0ffef8f827ec7b54b2174e009361/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62663932383262382d623830342d343634632d383235392d3534386232383937303237302f41747461636b65725f61735f67756573745f63616e5f7365745f437573746f6d5f416e616c79746963735f44617368626f6172642e6d7034 "Download 'Attacker_as_guest_can_set_Custom_Analytics_Dashboard.mp4'")

#### Impact

Users with the `Guest` role who do not have access to group and project settings can change `Custom dashboard projects` settings for projects in the victim group

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_from\_2024-01-15\_10-38-12.png](https://h1.sec.gitlab.net/a/44624264-2716-4c26-a648-c9c84014992e/Screenshot_from_2024-01-15_10-38-12.png)
* [Attacker\_as\_guest\_can\_set\_Custom\_Analytics\_Dashboard.mp4](https://h1.sec.gitlab.net/a/bf9282b8-b804-464c-8259-548b28970270/Attacker_as_guest_can_set_Custom_Analytics_Dashboard.mp4)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


