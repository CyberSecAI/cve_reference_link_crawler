=== Content from git.kernel.org_daa159a9_20250111_090038.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d89e4211b51752daf063d638af50abed2fd5f96d)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d89e4211b51752daf063d638af50abed2fd5f96d)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d89e4211b51752daf063d638af50abed2fd5f96d)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d89e4211b51752daf063d638af50abed2fd5f96d)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Tadeusz Struk <tadeusz.struk@linaro.org> | 2021-12-08 10:27:42 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-17 10:30:12 +0100 |
| commit | [d89e4211b51752daf063d638af50abed2fd5f96d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d89e4211b51752daf063d638af50abed2fd5f96d) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d89e4211b51752daf063d638af50abed2fd5f96d)) | |
| tree | [50e97579214e8fe14c62fcc7e9b66f4d5cf78cea](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d89e4211b51752daf063d638af50abed2fd5f96d) | |
| parent | [14655b6d42046a537950bfb0dee371742a3dd1fc](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=14655b6d42046a537950bfb0dee371742a3dd1fc) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d89e4211b51752daf063d638af50abed2fd5f96d&id2=14655b6d42046a537950bfb0dee371742a3dd1fc)) | |
| download | [linux-d89e4211b51752daf063d638af50abed2fd5f96d.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d89e4211b51752daf063d638af50abed2fd5f96d.tar.gz) | |

nfc: fix segfault in nfc\_genl\_dump\_devices\_donecommit fd79a0cbf0b2e34bcc45b13acf962e2032a82203 upstream.
When kmalloc in nfc\_genl\_dump\_devices() fails then
nfc\_genl\_dump\_devices\_done() segfaults as below
KASAN: null-ptr-deref in range [0x0000000000000008-0x000000000000000f]
CPU: 0 PID: 25 Comm: kworker/0:1 Not tainted 5.16.0-rc4-01180-g2a987e65025e-dirty #5
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.14.0-6.fc35 04/01/2014
Workqueue: events netlink\_sock\_destruct\_work
RIP: 0010:klist\_iter\_exit+0x26/0x80
Call Trace:
<TASK>
class\_dev\_iter\_exit+0x15/0x20
nfc\_genl\_dump\_devices\_done+0x3b/0x50
genl\_lock\_done+0x84/0xd0
netlink\_sock\_destruct+0x8f/0x270
\_\_sk\_destruct+0x64/0x3b0
sk\_destruct+0xa8/0xd0
\_\_sk\_free+0x2e8/0x3d0
sk\_free+0x51/0x90
netlink\_sock\_destruct\_work+0x1c/0x20
process\_one\_work+0x411/0x710
worker\_thread+0x6fd/0xa80
Link: <https://syzkaller.appspot.com/bug?id=fc0fa5a53db9edd261d56e74325419faf18bd0df>
Reported-by: syzbot+f9f76f4a0766420b4a02@syzkaller.appspotmail.com
Signed-off-by: Tadeusz Struk <tadeusz.struk@linaro.org>
Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
Link: [https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk@linaro.org](https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk%40linaro.org)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d89e4211b51752daf063d638af50abed2fd5f96d)

| -rw-r--r-- | [net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/nfc/netlink.c?id=d89e4211b51752daf063d638af50abed2fd5f96d) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 2 deletions

| diff --git a/net/nfc/netlink.c b/net/nfc/netlink.cindex 082085c25a8e40..8048a3dcc5f8ba 100644--- a/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=14655b6d42046a537950bfb0dee371742a3dd1fc)+++ b/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=d89e4211b51752daf063d638af50abed2fd5f96d)@@ -636,8 +636,10 @@ static int nfc\_genl\_dump\_devices\_done(struct netlink\_callback \*cb) { struct class\_dev\_iter \*iter = (struct class\_dev\_iter \*) cb->args[0]; - nfc\_device\_iter\_exit(iter);- kfree(iter);+ if (iter) {+ nfc\_device\_iter\_exit(iter);+ kfree(iter);+ }  return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 08:59:15 +0000



=== Content from git.kernel.org_f177d221_20250111_090040.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=fd79a0cbf0b2e34bcc45b13acf962e2032a82203)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fd79a0cbf0b2e34bcc45b13acf962e2032a82203)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fd79a0cbf0b2e34bcc45b13acf962e2032a82203)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fd79a0cbf0b2e34bcc45b13acf962e2032a82203)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Tadeusz Struk <tadeusz.struk@linaro.org> | 2021-12-08 10:27:42 -0800 |
| --- | --- | --- |
| committer | Jakub Kicinski <kuba@kernel.org> | 2021-12-09 07:50:23 -0800 |
| commit | [fd79a0cbf0b2e34bcc45b13acf962e2032a82203](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fd79a0cbf0b2e34bcc45b13acf962e2032a82203) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=fd79a0cbf0b2e34bcc45b13acf962e2032a82203)) | |
| tree | [08a2129d1ac68d45ff9179dc4f44acb3d584018b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fd79a0cbf0b2e34bcc45b13acf962e2032a82203) | |
| parent | [158390e45612ef0fde160af0826f1740c36daf21](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=158390e45612ef0fde160af0826f1740c36daf21) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fd79a0cbf0b2e34bcc45b13acf962e2032a82203&id2=158390e45612ef0fde160af0826f1740c36daf21)) | |
| download | [linux-fd79a0cbf0b2e34bcc45b13acf962e2032a82203.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-fd79a0cbf0b2e34bcc45b13acf962e2032a82203.tar.gz) | |

nfc: fix segfault in nfc\_genl\_dump\_devices\_doneWhen kmalloc in nfc\_genl\_dump\_devices() fails then
nfc\_genl\_dump\_devices\_done() segfaults as below
KASAN: null-ptr-deref in range [0x0000000000000008-0x000000000000000f]
CPU: 0 PID: 25 Comm: kworker/0:1 Not tainted 5.16.0-rc4-01180-g2a987e65025e-dirty #5
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.14.0-6.fc35 04/01/2014
Workqueue: events netlink\_sock\_destruct\_work
RIP: 0010:klist\_iter\_exit+0x26/0x80
Call Trace:
<TASK>
class\_dev\_iter\_exit+0x15/0x20
nfc\_genl\_dump\_devices\_done+0x3b/0x50
genl\_lock\_done+0x84/0xd0
netlink\_sock\_destruct+0x8f/0x270
\_\_sk\_destruct+0x64/0x3b0
sk\_destruct+0xa8/0xd0
\_\_sk\_free+0x2e8/0x3d0
sk\_free+0x51/0x90
netlink\_sock\_destruct\_work+0x1c/0x20
process\_one\_work+0x411/0x710
worker\_thread+0x6fd/0xa80
Link: <https://syzkaller.appspot.com/bug?id=fc0fa5a53db9edd261d56e74325419faf18bd0df>
Reported-by: syzbot+f9f76f4a0766420b4a02@syzkaller.appspotmail.com
Signed-off-by: Tadeusz Struk <tadeusz.struk@linaro.org>
Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
Link: [https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk@linaro.org](https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk%40linaro.org)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fd79a0cbf0b2e34bcc45b13acf962e2032a82203)

| -rw-r--r-- | [net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/nfc/netlink.c?id=fd79a0cbf0b2e34bcc45b13acf962e2032a82203) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 2 deletions

| diff --git a/net/nfc/netlink.c b/net/nfc/netlink.cindex 334f63c9529efa..0b4fae183a4bc0 100644--- a/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=158390e45612ef0fde160af0826f1740c36daf21)+++ b/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=fd79a0cbf0b2e34bcc45b13acf962e2032a82203)@@ -636,8 +636,10 @@ static int nfc\_genl\_dump\_devices\_done(struct netlink\_callback \*cb) { struct class\_dev\_iter \*iter = (struct class\_dev\_iter \*) cb->args[0]; - nfc\_device\_iter\_exit(iter);- kfree(iter);+ if (iter) {+ nfc\_device\_iter\_exit(iter);+ kfree(iter);+ }  return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 08:59:17 +0000



=== Content from git.kernel.org_5a4fc3f5_20250111_090031.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=214af18abbe39db05beb305b2d11e87d09a6529c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=214af18abbe39db05beb305b2d11e87d09a6529c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=214af18abbe39db05beb305b2d11e87d09a6529c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=214af18abbe39db05beb305b2d11e87d09a6529c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Tadeusz Struk <tadeusz.struk@linaro.org> | 2021-12-08 10:27:42 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-22 09:05:13 +0100 |
| commit | [214af18abbe39db05beb305b2d11e87d09a6529c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=214af18abbe39db05beb305b2d11e87d09a6529c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=214af18abbe39db05beb305b2d11e87d09a6529c)) | |
| tree | [15aab386e145bf8c8ccf86718a6aefbeebc59a56](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=214af18abbe39db05beb305b2d11e87d09a6529c) | |
| parent | [98d396d082d499d85ea373e3f8d6e7906c232cda](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=98d396d082d499d85ea373e3f8d6e7906c232cda) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=214af18abbe39db05beb305b2d11e87d09a6529c&id2=98d396d082d499d85ea373e3f8d6e7906c232cda)) | |
| download | [linux-214af18abbe39db05beb305b2d11e87d09a6529c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-214af18abbe39db05beb305b2d11e87d09a6529c.tar.gz) | |

nfc: fix segfault in nfc\_genl\_dump\_devices\_donecommit fd79a0cbf0b2e34bcc45b13acf962e2032a82203 upstream.
When kmalloc in nfc\_genl\_dump\_devices() fails then
nfc\_genl\_dump\_devices\_done() segfaults as below
KASAN: null-ptr-deref in range [0x0000000000000008-0x000000000000000f]
CPU: 0 PID: 25 Comm: kworker/0:1 Not tainted 5.16.0-rc4-01180-g2a987e65025e-dirty #5
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.14.0-6.fc35 04/01/2014
Workqueue: events netlink\_sock\_destruct\_work
RIP: 0010:klist\_iter\_exit+0x26/0x80
Call Trace:
<TASK>
class\_dev\_iter\_exit+0x15/0x20
nfc\_genl\_dump\_devices\_done+0x3b/0x50
genl\_lock\_done+0x84/0xd0
netlink\_sock\_destruct+0x8f/0x270
\_\_sk\_destruct+0x64/0x3b0
sk\_destruct+0xa8/0xd0
\_\_sk\_free+0x2e8/0x3d0
sk\_free+0x51/0x90
netlink\_sock\_destruct\_work+0x1c/0x20
process\_one\_work+0x411/0x710
worker\_thread+0x6fd/0xa80
Link: <https://syzkaller.appspot.com/bug?id=fc0fa5a53db9edd261d56e74325419faf18bd0df>
Reported-by: syzbot+f9f76f4a0766420b4a02@syzkaller.appspotmail.com
Signed-off-by: Tadeusz Struk <tadeusz.struk@linaro.org>
Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
Link: [https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk@linaro.org](https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk%40linaro.org)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=214af18abbe39db05beb305b2d11e87d09a6529c)

| -rw-r--r-- | [net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/nfc/netlink.c?id=214af18abbe39db05beb305b2d11e87d09a6529c) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 2 deletions

| diff --git a/net/nfc/netlink.c b/net/nfc/netlink.cindex 27ad73861a33fd..6e771022d43e19 100644--- a/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=98d396d082d499d85ea373e3f8d6e7906c232cda)+++ b/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=214af18abbe39db05beb305b2d11e87d09a6529c)@@ -669,8 +669,10 @@ static int nfc\_genl\_dump\_devices\_done(struct netlink\_callback \*cb) { struct class\_dev\_iter \*iter = (struct class\_dev\_iter \*) cb->args[0]; - nfc\_device\_iter\_exit(iter);- kfree(iter);+ if (iter) {+ nfc\_device\_iter\_exit(iter);+ kfree(iter);+ }  return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 08:59:09 +0000



=== Content from git.kernel.org_08451a84_20250111_090037.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d731ecc6f2eaec68f4ad1542283bbc7d07bd0112)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d731ecc6f2eaec68f4ad1542283bbc7d07bd0112)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d731ecc6f2eaec68f4ad1542283bbc7d07bd0112)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d731ecc6f2eaec68f4ad1542283bbc7d07bd0112)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Tadeusz Struk <tadeusz.struk@linaro.org> | 2021-12-08 10:27:42 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-17 10:12:23 +0100 |
| commit | [d731ecc6f2eaec68f4ad1542283bbc7d07bd0112](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d731ecc6f2eaec68f4ad1542283bbc7d07bd0112) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d731ecc6f2eaec68f4ad1542283bbc7d07bd0112)) | |
| tree | [27902f5ee49ff0ae76d3de7ebc938b6edb592936](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d731ecc6f2eaec68f4ad1542283bbc7d07bd0112) | |
| parent | [c32c40ff80928cfcea7435e27330cb995f6bfb67](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c32c40ff80928cfcea7435e27330cb995f6bfb67) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d731ecc6f2eaec68f4ad1542283bbc7d07bd0112&id2=c32c40ff80928cfcea7435e27330cb995f6bfb67)) | |
| download | [linux-d731ecc6f2eaec68f4ad1542283bbc7d07bd0112.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d731ecc6f2eaec68f4ad1542283bbc7d07bd0112.tar.gz) | |

nfc: fix segfault in nfc\_genl\_dump\_devices\_donecommit fd79a0cbf0b2e34bcc45b13acf962e2032a82203 upstream.
When kmalloc in nfc\_genl\_dump\_devices() fails then
nfc\_genl\_dump\_devices\_done() segfaults as below
KASAN: null-ptr-deref in range [0x0000000000000008-0x000000000000000f]
CPU: 0 PID: 25 Comm: kworker/0:1 Not tainted 5.16.0-rc4-01180-g2a987e65025e-dirty #5
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.14.0-6.fc35 04/01/2014
Workqueue: events netlink\_sock\_destruct\_work
RIP: 0010:klist\_iter\_exit+0x26/0x80
Call Trace:
<TASK>
class\_dev\_iter\_exit+0x15/0x20
nfc\_genl\_dump\_devices\_done+0x3b/0x50
genl\_lock\_done+0x84/0xd0
netlink\_sock\_destruct+0x8f/0x270
\_\_sk\_destruct+0x64/0x3b0
sk\_destruct+0xa8/0xd0
\_\_sk\_free+0x2e8/0x3d0
sk\_free+0x51/0x90
netlink\_sock\_destruct\_work+0x1c/0x20
process\_one\_work+0x411/0x710
worker\_thread+0x6fd/0xa80
Link: <https://syzkaller.appspot.com/bug?id=fc0fa5a53db9edd261d56e74325419faf18bd0df>
Reported-by: syzbot+f9f76f4a0766420b4a02@syzkaller.appspotmail.com
Signed-off-by: Tadeusz Struk <tadeusz.struk@linaro.org>
Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
Link: [https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk@linaro.org](https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk%40linaro.org)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d731ecc6f2eaec68f4ad1542283bbc7d07bd0112)

| -rw-r--r-- | [net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/nfc/netlink.c?id=d731ecc6f2eaec68f4ad1542283bbc7d07bd0112) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 2 deletions

| diff --git a/net/nfc/netlink.c b/net/nfc/netlink.cindex 0f61dad7256b8d..4d90cbdc083b5e 100644--- a/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=c32c40ff80928cfcea7435e27330cb995f6bfb67)+++ b/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=d731ecc6f2eaec68f4ad1542283bbc7d07bd0112)@@ -644,8 +644,10 @@ static int nfc\_genl\_dump\_devices\_done(struct netlink\_callback \*cb) { struct class\_dev\_iter \*iter = (struct class\_dev\_iter \*) cb->args[0]; - nfc\_device\_iter\_exit(iter);- kfree(iter);+ if (iter) {+ nfc\_device\_iter\_exit(iter);+ kfree(iter);+ }  return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 08:59:14 +0000



=== Content from git.kernel.org_4dce822f_20250111_090039.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ea55b3797878752aa076b118afb727dcf79cac34)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ea55b3797878752aa076b118afb727dcf79cac34)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ea55b3797878752aa076b118afb727dcf79cac34)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ea55b3797878752aa076b118afb727dcf79cac34)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Tadeusz Struk <tadeusz.struk@linaro.org> | 2021-12-08 10:27:42 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-22 09:04:17 +0100 |
| commit | [ea55b3797878752aa076b118afb727dcf79cac34](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ea55b3797878752aa076b118afb727dcf79cac34) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ea55b3797878752aa076b118afb727dcf79cac34)) | |
| tree | [73164584724c52ad1bf0ed40e59dad75fe838c6d](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ea55b3797878752aa076b118afb727dcf79cac34) | |
| parent | [87ae08ae6ba1f4d6ca8cb134899d87737700be15](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=87ae08ae6ba1f4d6ca8cb134899d87737700be15) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ea55b3797878752aa076b118afb727dcf79cac34&id2=87ae08ae6ba1f4d6ca8cb134899d87737700be15)) | |
| download | [linux-ea55b3797878752aa076b118afb727dcf79cac34.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ea55b3797878752aa076b118afb727dcf79cac34.tar.gz) | |

nfc: fix segfault in nfc\_genl\_dump\_devices\_donecommit fd79a0cbf0b2e34bcc45b13acf962e2032a82203 upstream.
When kmalloc in nfc\_genl\_dump\_devices() fails then
nfc\_genl\_dump\_devices\_done() segfaults as below
KASAN: null-ptr-deref in range [0x0000000000000008-0x000000000000000f]
CPU: 0 PID: 25 Comm: kworker/0:1 Not tainted 5.16.0-rc4-01180-g2a987e65025e-dirty #5
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.14.0-6.fc35 04/01/2014
Workqueue: events netlink\_sock\_destruct\_work
RIP: 0010:klist\_iter\_exit+0x26/0x80
Call Trace:
<TASK>
class\_dev\_iter\_exit+0x15/0x20
nfc\_genl\_dump\_devices\_done+0x3b/0x50
genl\_lock\_done+0x84/0xd0
netlink\_sock\_destruct+0x8f/0x270
\_\_sk\_destruct+0x64/0x3b0
sk\_destruct+0xa8/0xd0
\_\_sk\_free+0x2e8/0x3d0
sk\_free+0x51/0x90
netlink\_sock\_destruct\_work+0x1c/0x20
process\_one\_work+0x411/0x710
worker\_thread+0x6fd/0xa80
Link: <https://syzkaller.appspot.com/bug?id=fc0fa5a53db9edd261d56e74325419faf18bd0df>
Reported-by: syzbot+f9f76f4a0766420b4a02@syzkaller.appspotmail.com
Signed-off-by: Tadeusz Struk <tadeusz.struk@linaro.org>
Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
Link: [https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk@linaro.org](https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk%40linaro.org)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ea55b3797878752aa076b118afb727dcf79cac34)

| -rw-r--r-- | [net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/nfc/netlink.c?id=ea55b3797878752aa076b118afb727dcf79cac34) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 2 deletions

| diff --git a/net/nfc/netlink.c b/net/nfc/netlink.cindex 00a0f0476a5434..4286b900a3066e 100644--- a/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=87ae08ae6ba1f4d6ca8cb134899d87737700be15)+++ b/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=ea55b3797878752aa076b118afb727dcf79cac34)@@ -632,8 +632,10 @@ static int nfc\_genl\_dump\_devices\_done(struct netlink\_callback \*cb) { struct class\_dev\_iter \*iter = (struct class\_dev\_iter \*) cb->args[0]; - nfc\_device\_iter\_exit(iter);- kfree(iter);+ if (iter) {+ nfc\_device\_iter\_exit(iter);+ kfree(iter);+ }  return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 08:59:17 +0000



=== Content from git.kernel.org_15a871f8_20250111_090033.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=2a8845b9603c545fddd17862282dc4c4ce0971e3)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2a8845b9603c545fddd17862282dc4c4ce0971e3)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2a8845b9603c545fddd17862282dc4c4ce0971e3)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2a8845b9603c545fddd17862282dc4c4ce0971e3)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Tadeusz Struk <tadeusz.struk@linaro.org> | 2021-12-08 10:27:42 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-22 09:19:00 +0100 |
| commit | [2a8845b9603c545fddd17862282dc4c4ce0971e3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2a8845b9603c545fddd17862282dc4c4ce0971e3) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=2a8845b9603c545fddd17862282dc4c4ce0971e3)) | |
| tree | [5401f9dfa1ec1e55fbed911231b6971db71ec5f1](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2a8845b9603c545fddd17862282dc4c4ce0971e3) | |
| parent | [a256aac5b7000bdf1232ed2bbd674582c0ab27ec](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a256aac5b7000bdf1232ed2bbd674582c0ab27ec) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2a8845b9603c545fddd17862282dc4c4ce0971e3&id2=a256aac5b7000bdf1232ed2bbd674582c0ab27ec)) | |
| download | [linux-2a8845b9603c545fddd17862282dc4c4ce0971e3.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-2a8845b9603c545fddd17862282dc4c4ce0971e3.tar.gz) | |

nfc: fix segfault in nfc\_genl\_dump\_devices\_donecommit fd79a0cbf0b2e34bcc45b13acf962e2032a82203 upstream.
When kmalloc in nfc\_genl\_dump\_devices() fails then
nfc\_genl\_dump\_devices\_done() segfaults as below
KASAN: null-ptr-deref in range [0x0000000000000008-0x000000000000000f]
CPU: 0 PID: 25 Comm: kworker/0:1 Not tainted 5.16.0-rc4-01180-g2a987e65025e-dirty #5
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.14.0-6.fc35 04/01/2014
Workqueue: events netlink\_sock\_destruct\_work
RIP: 0010:klist\_iter\_exit+0x26/0x80
Call Trace:
<TASK>
class\_dev\_iter\_exit+0x15/0x20
nfc\_genl\_dump\_devices\_done+0x3b/0x50
genl\_lock\_done+0x84/0xd0
netlink\_sock\_destruct+0x8f/0x270
\_\_sk\_destruct+0x64/0x3b0
sk\_destruct+0xa8/0xd0
\_\_sk\_free+0x2e8/0x3d0
sk\_free+0x51/0x90
netlink\_sock\_destruct\_work+0x1c/0x20
process\_one\_work+0x411/0x710
worker\_thread+0x6fd/0xa80
Link: <https://syzkaller.appspot.com/bug?id=fc0fa5a53db9edd261d56e74325419faf18bd0df>
Reported-by: syzbot+f9f76f4a0766420b4a02@syzkaller.appspotmail.com
Signed-off-by: Tadeusz Struk <tadeusz.struk@linaro.org>
Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
Link: [https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk@linaro.org](https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk%40linaro.org)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2a8845b9603c545fddd17862282dc4c4ce0971e3)

| -rw-r--r-- | [net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/nfc/netlink.c?id=2a8845b9603c545fddd17862282dc4c4ce0971e3) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 2 deletions

| diff --git a/net/nfc/netlink.c b/net/nfc/netlink.cindex b6313504faed11..0a3120117c13d1 100644--- a/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=a256aac5b7000bdf1232ed2bbd674582c0ab27ec)+++ b/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=2a8845b9603c545fddd17862282dc4c4ce0971e3)@@ -655,8 +655,10 @@ static int nfc\_genl\_dump\_devices\_done(struct netlink\_callback \*cb) { struct class\_dev\_iter \*iter = (struct class\_dev\_iter \*) cb->args[0]; - nfc\_device\_iter\_exit(iter);- kfree(iter);+ if (iter) {+ nfc\_device\_iter\_exit(iter);+ kfree(iter);+ }  return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 08:59:10 +0000



=== Content from git.kernel.org_61d9ae58_20250111_090034.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=6644989642844de830f9b072cd65c553cb55946c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6644989642844de830f9b072cd65c553cb55946c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6644989642844de830f9b072cd65c553cb55946c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6644989642844de830f9b072cd65c553cb55946c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Tadeusz Struk <tadeusz.struk@linaro.org> | 2021-12-08 10:27:42 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-22 09:17:58 +0100 |
| commit | [6644989642844de830f9b072cd65c553cb55946c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6644989642844de830f9b072cd65c553cb55946c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=6644989642844de830f9b072cd65c553cb55946c)) | |
| tree | [882a6f9fc12040a91cb3c6ba553d5d6ff022c35a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6644989642844de830f9b072cd65c553cb55946c) | |
| parent | [9dfbac0e6b8600043de8dc85ed072f5f1342dc15](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9dfbac0e6b8600043de8dc85ed072f5f1342dc15) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6644989642844de830f9b072cd65c553cb55946c&id2=9dfbac0e6b8600043de8dc85ed072f5f1342dc15)) | |
| download | [linux-6644989642844de830f9b072cd65c553cb55946c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-6644989642844de830f9b072cd65c553cb55946c.tar.gz) | |

nfc: fix segfault in nfc\_genl\_dump\_devices\_donecommit fd79a0cbf0b2e34bcc45b13acf962e2032a82203 upstream.
When kmalloc in nfc\_genl\_dump\_devices() fails then
nfc\_genl\_dump\_devices\_done() segfaults as below
KASAN: null-ptr-deref in range [0x0000000000000008-0x000000000000000f]
CPU: 0 PID: 25 Comm: kworker/0:1 Not tainted 5.16.0-rc4-01180-g2a987e65025e-dirty #5
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.14.0-6.fc35 04/01/2014
Workqueue: events netlink\_sock\_destruct\_work
RIP: 0010:klist\_iter\_exit+0x26/0x80
Call Trace:
<TASK>
class\_dev\_iter\_exit+0x15/0x20
nfc\_genl\_dump\_devices\_done+0x3b/0x50
genl\_lock\_done+0x84/0xd0
netlink\_sock\_destruct+0x8f/0x270
\_\_sk\_destruct+0x64/0x3b0
sk\_destruct+0xa8/0xd0
\_\_sk\_free+0x2e8/0x3d0
sk\_free+0x51/0x90
netlink\_sock\_destruct\_work+0x1c/0x20
process\_one\_work+0x411/0x710
worker\_thread+0x6fd/0xa80
Link: <https://syzkaller.appspot.com/bug?id=fc0fa5a53db9edd261d56e74325419faf18bd0df>
Reported-by: syzbot+f9f76f4a0766420b4a02@syzkaller.appspotmail.com
Signed-off-by: Tadeusz Struk <tadeusz.struk@linaro.org>
Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
Link: [https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk@linaro.org](https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk%40linaro.org)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6644989642844de830f9b072cd65c553cb55946c)

| -rw-r--r-- | [net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/nfc/netlink.c?id=6644989642844de830f9b072cd65c553cb55946c) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 2 deletions

| diff --git a/net/nfc/netlink.c b/net/nfc/netlink.cindex d7a2580f042064..ff5995624146a2 100644--- a/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=9dfbac0e6b8600043de8dc85ed072f5f1342dc15)+++ b/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=6644989642844de830f9b072cd65c553cb55946c)@@ -666,8 +666,10 @@ static int nfc\_genl\_dump\_devices\_done(struct netlink\_callback \*cb) { struct class\_dev\_iter \*iter = (struct class\_dev\_iter \*) cb->args[0]; - nfc\_device\_iter\_exit(iter);- kfree(iter);+ if (iter) {+ nfc\_device\_iter\_exit(iter);+ kfree(iter);+ }  return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 08:59:11 +0000



=== Content from git.kernel.org_d78905d8_20250111_090035.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c602863ad28ec86794cb4ab4edea5324f555f181)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c602863ad28ec86794cb4ab4edea5324f555f181)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c602863ad28ec86794cb4ab4edea5324f555f181)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c602863ad28ec86794cb4ab4edea5324f555f181)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Tadeusz Struk <tadeusz.struk@linaro.org> | 2021-12-08 10:27:42 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-17 10:14:39 +0100 |
| commit | [c602863ad28ec86794cb4ab4edea5324f555f181](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c602863ad28ec86794cb4ab4edea5324f555f181) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c602863ad28ec86794cb4ab4edea5324f555f181)) | |
| tree | [637ed76c5f31d0bac4bb1d0079f949a6a8f8c7ff](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c602863ad28ec86794cb4ab4edea5324f555f181) | |
| parent | [37050f17f2d243f0d6ebe63ed3df84f91abce614](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=37050f17f2d243f0d6ebe63ed3df84f91abce614) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c602863ad28ec86794cb4ab4edea5324f555f181&id2=37050f17f2d243f0d6ebe63ed3df84f91abce614)) | |
| download | [linux-c602863ad28ec86794cb4ab4edea5324f555f181.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c602863ad28ec86794cb4ab4edea5324f555f181.tar.gz) | |

nfc: fix segfault in nfc\_genl\_dump\_devices\_donecommit fd79a0cbf0b2e34bcc45b13acf962e2032a82203 upstream.
When kmalloc in nfc\_genl\_dump\_devices() fails then
nfc\_genl\_dump\_devices\_done() segfaults as below
KASAN: null-ptr-deref in range [0x0000000000000008-0x000000000000000f]
CPU: 0 PID: 25 Comm: kworker/0:1 Not tainted 5.16.0-rc4-01180-g2a987e65025e-dirty #5
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.14.0-6.fc35 04/01/2014
Workqueue: events netlink\_sock\_destruct\_work
RIP: 0010:klist\_iter\_exit+0x26/0x80
Call Trace:
<TASK>
class\_dev\_iter\_exit+0x15/0x20
nfc\_genl\_dump\_devices\_done+0x3b/0x50
genl\_lock\_done+0x84/0xd0
netlink\_sock\_destruct+0x8f/0x270
\_\_sk\_destruct+0x64/0x3b0
sk\_destruct+0xa8/0xd0
\_\_sk\_free+0x2e8/0x3d0
sk\_free+0x51/0x90
netlink\_sock\_destruct\_work+0x1c/0x20
process\_one\_work+0x411/0x710
worker\_thread+0x6fd/0xa80
Link: <https://syzkaller.appspot.com/bug?id=fc0fa5a53db9edd261d56e74325419faf18bd0df>
Reported-by: syzbot+f9f76f4a0766420b4a02@syzkaller.appspotmail.com
Signed-off-by: Tadeusz Struk <tadeusz.struk@linaro.org>
Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
Link: [https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk@linaro.org](https://lore.kernel.org/r/20211208182742.340542-1-tadeusz.struk%40linaro.org)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c602863ad28ec86794cb4ab4edea5324f555f181)

| -rw-r--r-- | [net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/nfc/netlink.c?id=c602863ad28ec86794cb4ab4edea5324f555f181) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 2 deletions

| diff --git a/net/nfc/netlink.c b/net/nfc/netlink.cindex 0767404636c140..78acc4e9ac932b 100644--- a/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=37050f17f2d243f0d6ebe63ed3df84f91abce614)+++ b/[net/nfc/netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/nfc/netlink.c?id=c602863ad28ec86794cb4ab4edea5324f555f181)@@ -636,8 +636,10 @@ static int nfc\_genl\_dump\_devices\_done(struct netlink\_callback \*cb) { struct class\_dev\_iter \*iter = (struct class\_dev\_iter \*) cb->args[0]; - nfc\_device\_iter\_exit(iter);- kfree(iter);+ if (iter) {+ nfc\_device\_iter\_exit(iter);+ kfree(iter);+ }  return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 08:59:13 +0000


