<!doctype html>
<html lang="en">



<head>

<!-- Google Tag Manager -->
<script nonce="d6wtoHF/z/tJ2ZmdKBDLNw==">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-M5DJSX');</script>



    <meta charset="utf-8">
    <title>SECFORCE - Security without compromise</title>
    <meta name="title" content="SECFORCE - Security without compromise">
    <meta name="description" content="Cybersecurity consultancy specialized in offensive security helping top-tier organisations all over the world.">
    <meta name="author" content="SECFORCE">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        
    
    

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.secforce.com/blog/pre-auth-mysql-remote-dos-integer-overflow/">
    <meta property="og:title" content="SECFORCE - Security without compromise">
    <meta property="og:description" content="Cybersecurity consultancy specialized in offensive security helping top-tier organisations all over the world.">
    <meta property="og:image" content="/assets/img/images/share.76937bb9fce7.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://www.secforce.com/blog/pre-auth-mysql-remote-dos-integer-overflow/">
    <meta property="twitter:title" content="SECFORCE - Security without compromise">
    <meta property="twitter:description" content="Cybersecurity consultancy specialized in offensive security helping top-tier organisations all over the world.">
    <meta property="twitter:image" content="/assets/img/images/share.76937bb9fce7.png">
    
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicon/apple-touch-icon.aea7576716e0.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon/favicon-32x32.5d7ea608bccc.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon/favicon-16x16.f605daf0d1ea.png">
    <link rel="manifest" href="/assets/img/favicon/site.817e3ae080d3.webmanifest">
    <link rel="mask-icon" href="/assets/img/favicon/safari-pinned-tab.c76c7a5fcf04.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/assets/img/favicon/favicon.ec1c6d614e6f.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="/assets/img/favicon/browserconfig.b012ba50631f.xml">
    <meta name="theme-color" content="#ffffff">
    
    <!-- CSS FILES -->
    <!-- LIBS -->
    <link rel="stylesheet" type="text/css" href="/assets/styles/slick.f38b2db10e01.css"/>
    <link rel="stylesheet" type="text/css" href="/assets/styles/swiper-bundle.min.8f1466ab740d.css" />
    <link rel="stylesheet" type="text/css" href="/assets/styles/slick-theme.590ee7f4d13f.css"/>
    
    <!-- SITE -->
    <link rel="stylesheet" type="text/css" href="/assets/styles/navbar.de572a705be5.css"/>
    <link rel="stylesheet" href="/assets/styles/main.e409fa259d14.css">
    <link rel="stylesheet" href="/assets/styles/utils.517c35081614.css">

    <!-- Extra CSS files -->
    


</head>
 
<body >
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M5DJSX" height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>

    <header id="header" class="main-header">
        <!-- Desktop Header & Menu -->
        <div class="desktop-header">
            <div class="main-header-wrapper container">
                <div class="main-logo">
                    
                        <a href="/"><svg xmlns="http://www.w3.org/2000/svg" width="201.547" height="31.56" viewBox="0 0 201.547 31.56"><defs><style>.a{fill:#fff;}</style></defs><g transform="translate(-594.635 -482.788)"><g transform="translate(594.635 482.788)"><path class="a" d="M818.031,510.742h15.683v2.865H821.308v3.56h11.128v2.846H821.308v4.016h12.413v2.866h-15.69Z" transform="translate(-756.415 -503.032)"/><path class="a" d="M891.713,514.093a5.235,5.235,0,0,0,0,7.832,7.183,7.183,0,0,0,7.986.565,5.493,5.493,0,0,0,2.165-2.686l2.866,1.446A7.311,7.311,0,0,1,901.517,525a10.321,10.321,0,0,1-5.391,1.356,9.888,9.888,0,0,1-6.836-2.4A7.523,7.523,0,0,1,886.56,518a7.613,7.613,0,0,1,2.731-5.982,10.023,10.023,0,0,1,6.836-2.365,10.493,10.493,0,0,1,5.391,1.33,7.435,7.435,0,0,1,3.212,3.765l-2.866,1.446a5.659,5.659,0,0,0-2.165-2.7,6.566,6.566,0,0,0-3.547-.925A6.463,6.463,0,0,0,891.713,514.093Z" transform="translate(-806.041 -502.238)"/><path class="a" d="M1035.261,512.1a11.128,11.128,0,0,1,13.718,0,7.953,7.953,0,0,1,0,11.963,11.109,11.109,0,0,1-13.718,0,7.992,7.992,0,0,1,0-11.963Zm11.328,2.037a6.579,6.579,0,0,0-4.466-1.491,6.469,6.469,0,0,0-4.414,1.491,4.992,4.992,0,0,0-1.715,3.945,4.922,4.922,0,0,0,1.715,3.926,6.425,6.425,0,0,0,4.414,1.5,6.5,6.5,0,0,0,4.466-1.516,4.961,4.961,0,0,0,1.69-3.926A5.037,5.037,0,0,0,1046.589,514.14Z" transform="translate(-911.778 -502.305)"/><path class="a" d="M1120.41,520.849v6.027h-3.322V510.7h10.177a7.066,7.066,0,0,1,4.536,1.285,4.632,4.632,0,0,1,1.626,3.765,4.682,4.682,0,0,1-.97,3.026,5.184,5.184,0,0,1-2.776,1.735l4.132,6.342H1130l-3.81-6.027Zm0-2.776h6.676a3.636,3.636,0,0,0,2.255-.61,1.927,1.927,0,0,0,.79-1.664,2.044,2.044,0,0,0-.79-1.716,3.758,3.758,0,0,0-2.255-.591h-6.676Z" transform="translate(-972.987 -502.994)"/><path class="a" d="M1193.935,514.093a5.236,5.236,0,0,0,0,7.832,6.5,6.5,0,0,0,4.465,1.516,6.425,6.425,0,0,0,3.547-.951,5.5,5.5,0,0,0,2.165-2.686l2.865,1.446a7.369,7.369,0,0,1-3.213,3.746,10.32,10.32,0,0,1-5.391,1.356,9.888,9.888,0,0,1-6.836-2.4,7.523,7.523,0,0,1-2.73-5.956,7.612,7.612,0,0,1,2.73-5.982,10.024,10.024,0,0,1,6.836-2.365,10.492,10.492,0,0,1,5.391,1.33,7.493,7.493,0,0,1,3.213,3.765l-2.865,1.446a5.662,5.662,0,0,0-2.165-2.7,6.578,6.578,0,0,0-3.547-.906A6.475,6.475,0,0,0,1193.935,514.093Z" transform="translate(-1024.924 -502.238)"/><path class="a" d="M1268.5,510.742h15.683v2.865H1271.78v3.56H1282.9v2.846H1271.78v4.016h12.407v2.866H1268.5Z" transform="translate(-1082.639 -503.032)"/><path class="a" d="M757.494,514.327a4.093,4.093,0,0,0-1.966-3.393c-2.249-1.407-10.64-1.793-13.493,0a4.222,4.222,0,0,0-1.979,3.894,3.9,3.9,0,0,0,2.345,3.784c1.7.835,4.844.8,9.265,1.067,1.041.1,2.1.469,2.2,1.684.039.642-.154,1.76-1.927,2.184a20.993,20.993,0,0,1-6.374,0c-1.555-.36-1.773-1.285-1.844-1.716h-3.669c.25,4.093,4.375,4.6,8.77,4.6,3.136,0,5.384-.431,6.676-1.234a4.228,4.228,0,0,0,1.979-3.893c0-3.457-3.013-4.08-4.009-4.266-2.274-.43-2.814-.27-7.633-.591-1.028-.154-1.985-.353-2.165-1.555-.084-.643.038-1.761,1.76-2.236a20.152,20.152,0,0,1,6.547-.032c1.574.353,1.786,1.285,1.857,1.7Z" transform="translate(-699.939 -502.299)"/><rect class="a" width="15.433" height="2.866" transform="translate(102.525 7.678)"/><path class="a" d="M966.348,535.667v9.3h3.27v-6.431H980.5v-2.866Z" transform="translate(-863.823 -521.082)"/><path class="a" d="M666.909,485.544l2.5,2.5v3.54l-2.5,2.506h-3.54l-2.5-2.506v-3.54l2.5-2.5h3.54m1.144-2.757h-5.828l-4.112,4.119v5.821l4.112,4.118h5.828l4.112-4.118v-5.821Z" transform="translate(-640.605 -482.788)"/><path class="a" d="M594.635,486.907v5.821l4.118,4.118h5.821l4.118-4.118v-5.821l-4.118-4.118h-5.821Z" transform="translate(-594.635 -482.788)"/><path class="a" d="M603.431,549.023l2.506,2.5v3.54l-2.506,2.5h-3.54l-2.5-2.5v-3.54l2.5-2.5h3.54m1.144-2.757h-5.821l-4.118,4.112v5.827l4.118,4.112h5.821l4.118-4.112v-5.827Z" transform="translate(-594.635 -528.758)"/><path class="a" d="M672.164,556.206v-5.828l-4.112-4.112h-5.828l-4.112,4.112v5.828l4.112,4.112h5.828Z" transform="translate(-640.604 -528.758)"/></g></g></svg></a>
                        
                </div>
                
                <nav class="desktop-nav">
                    <ul class="main-menu nav-links current-thelab">
                        <!--
                        <li class="menu-item"><a href="/" class="nav-item">Home</a></li>
                        <li class="menu-item"><a href="/services/" class="nav-item">Services</a></li>
                        <li class="menu-item"><a href="/case-studies/" class="nav-item">Case Studies</a></li>
                        <li class="menu-item"><a href="/blog/" class="nav-item">The Lab</a></li>
                        <li class="menu-item"><a href="/why-secforce/" class="nav-item">Why SECFORCE</a></li>
                        <li class="menu-item"><a href="/about-us/" class="nav-item">About us</a></li>
                        <li class="menu-item"><a href="/join-the-force/" class="nav-item">Join the Force</a></li>
                        <li class="menu-item"><a href="/contact-us/" class="nav-item">Contact us</a></li>
                        -->
                        
                            
                            
                                <li class="menu-item "><a class="nav-item" href="/services/" >Testing Assurance</a>
                                
                                </li>
                            
                                <li class="menu-item dropdown-parent"><a class="nav-item" href="/consulting-services/" >Consulting Services</a>
                                
                                    <ul class="sub-menu">
                                        
                                            <li class="sub-menu-item">
                                                <a class="sub-nav-item" href="/penetration-testing-maturity/" >Penetration Testing Maturity</a>
                                            </li>
                                        
                                            <li class="sub-menu-item">
                                                <a class="sub-nav-item" href="/dora-compliance/" >DORA Compliance</a>
                                            </li>
                                        
                                    </ul>
                                
                                </li>
                            
                                <li class="menu-item "><a class="nav-item" href="/blog/" >The Lab</a>
                                
                                </li>
                            
                                <li class="menu-item "><a class="nav-item" href="/the-blog/" >The Blog</a>
                                
                                </li>
                            
                                <li class="menu-item "><a class="nav-item" href="/case-studies/" >Case Studies</a>
                                
                                </li>
                            
                                <li class="menu-item dropdown-parent"><a class="nav-item" href="/about-us/" >About us</a>
                                
                                    <ul class="sub-menu">
                                        
                                            <li class="sub-menu-item">
                                                <a class="sub-nav-item" href="/why-secforce/" >Why SECFORCE</a>
                                            </li>
                                        
                                            <li class="sub-menu-item">
                                                <a class="sub-nav-item" href="/join/" >Join</a>
                                            </li>
                                        
                                    </ul>
                                
                                </li>
                            
                                <li class="menu-item "><a class="nav-item" href="/contact-us/" >Contact</a>
                                
                                </li>
                            
                    </ul>
                </nav>
                
            </div>
        </div>

        
        <!-- Mobile Header -->
        <div class="mobile-header">
            <div class="main-header-wrapper container">
                <div class="main-logo">
                    <a href="/"><svg xmlns="http://www.w3.org/2000/svg" width="201.547" height="31.56" viewBox="0 0 201.547 31.56"><defs><style>.a{fill:#fff;}</style></defs><g transform="translate(-594.635 -482.788)"><g transform="translate(594.635 482.788)"><path class="a" d="M818.031,510.742h15.683v2.865H821.308v3.56h11.128v2.846H821.308v4.016h12.413v2.866h-15.69Z" transform="translate(-756.415 -503.032)"/><path class="a" d="M891.713,514.093a5.235,5.235,0,0,0,0,7.832,7.183,7.183,0,0,0,7.986.565,5.493,5.493,0,0,0,2.165-2.686l2.866,1.446A7.311,7.311,0,0,1,901.517,525a10.321,10.321,0,0,1-5.391,1.356,9.888,9.888,0,0,1-6.836-2.4A7.523,7.523,0,0,1,886.56,518a7.613,7.613,0,0,1,2.731-5.982,10.023,10.023,0,0,1,6.836-2.365,10.493,10.493,0,0,1,5.391,1.33,7.435,7.435,0,0,1,3.212,3.765l-2.866,1.446a5.659,5.659,0,0,0-2.165-2.7,6.566,6.566,0,0,0-3.547-.925A6.463,6.463,0,0,0,891.713,514.093Z" transform="translate(-806.041 -502.238)"/><path class="a" d="M1035.261,512.1a11.128,11.128,0,0,1,13.718,0,7.953,7.953,0,0,1,0,11.963,11.109,11.109,0,0,1-13.718,0,7.992,7.992,0,0,1,0-11.963Zm11.328,2.037a6.579,6.579,0,0,0-4.466-1.491,6.469,6.469,0,0,0-4.414,1.491,4.992,4.992,0,0,0-1.715,3.945,4.922,4.922,0,0,0,1.715,3.926,6.425,6.425,0,0,0,4.414,1.5,6.5,6.5,0,0,0,4.466-1.516,4.961,4.961,0,0,0,1.69-3.926A5.037,5.037,0,0,0,1046.589,514.14Z" transform="translate(-911.778 -502.305)"/><path class="a" d="M1120.41,520.849v6.027h-3.322V510.7h10.177a7.066,7.066,0,0,1,4.536,1.285,4.632,4.632,0,0,1,1.626,3.765,4.682,4.682,0,0,1-.97,3.026,5.184,5.184,0,0,1-2.776,1.735l4.132,6.342H1130l-3.81-6.027Zm0-2.776h6.676a3.636,3.636,0,0,0,2.255-.61,1.927,1.927,0,0,0,.79-1.664,2.044,2.044,0,0,0-.79-1.716,3.758,3.758,0,0,0-2.255-.591h-6.676Z" transform="translate(-972.987 -502.994)"/><path class="a" d="M1193.935,514.093a5.236,5.236,0,0,0,0,7.832,6.5,6.5,0,0,0,4.465,1.516,6.425,6.425,0,0,0,3.547-.951,5.5,5.5,0,0,0,2.165-2.686l2.865,1.446a7.369,7.369,0,0,1-3.213,3.746,10.32,10.32,0,0,1-5.391,1.356,9.888,9.888,0,0,1-6.836-2.4,7.523,7.523,0,0,1-2.73-5.956,7.612,7.612,0,0,1,2.73-5.982,10.024,10.024,0,0,1,6.836-2.365,10.492,10.492,0,0,1,5.391,1.33,7.493,7.493,0,0,1,3.213,3.765l-2.865,1.446a5.662,5.662,0,0,0-2.165-2.7,6.578,6.578,0,0,0-3.547-.906A6.475,6.475,0,0,0,1193.935,514.093Z" transform="translate(-1024.924 -502.238)"/><path class="a" d="M1268.5,510.742h15.683v2.865H1271.78v3.56H1282.9v2.846H1271.78v4.016h12.407v2.866H1268.5Z" transform="translate(-1082.639 -503.032)"/><path class="a" d="M757.494,514.327a4.093,4.093,0,0,0-1.966-3.393c-2.249-1.407-10.64-1.793-13.493,0a4.222,4.222,0,0,0-1.979,3.894,3.9,3.9,0,0,0,2.345,3.784c1.7.835,4.844.8,9.265,1.067,1.041.1,2.1.469,2.2,1.684.039.642-.154,1.76-1.927,2.184a20.993,20.993,0,0,1-6.374,0c-1.555-.36-1.773-1.285-1.844-1.716h-3.669c.25,4.093,4.375,4.6,8.77,4.6,3.136,0,5.384-.431,6.676-1.234a4.228,4.228,0,0,0,1.979-3.893c0-3.457-3.013-4.08-4.009-4.266-2.274-.43-2.814-.27-7.633-.591-1.028-.154-1.985-.353-2.165-1.555-.084-.643.038-1.761,1.76-2.236a20.152,20.152,0,0,1,6.547-.032c1.574.353,1.786,1.285,1.857,1.7Z" transform="translate(-699.939 -502.299)"/><rect class="a" width="15.433" height="2.866" transform="translate(102.525 7.678)"/><path class="a" d="M966.348,535.667v9.3h3.27v-6.431H980.5v-2.866Z" transform="translate(-863.823 -521.082)"/><path class="a" d="M666.909,485.544l2.5,2.5v3.54l-2.5,2.506h-3.54l-2.5-2.506v-3.54l2.5-2.5h3.54m1.144-2.757h-5.828l-4.112,4.119v5.821l4.112,4.118h5.828l4.112-4.118v-5.821Z" transform="translate(-640.605 -482.788)"/><path class="a" d="M594.635,486.907v5.821l4.118,4.118h5.821l4.118-4.118v-5.821l-4.118-4.118h-5.821Z" transform="translate(-594.635 -482.788)"/><path class="a" d="M603.431,549.023l2.506,2.5v3.54l-2.506,2.5h-3.54l-2.5-2.5v-3.54l2.5-2.5h3.54m1.144-2.757h-5.821l-4.118,4.112v5.827l4.118,4.112h5.821l4.118-4.112v-5.827Z" transform="translate(-594.635 -528.758)"/><path class="a" d="M672.164,556.206v-5.828l-4.112-4.112h-5.828l-4.112,4.112v5.828l4.112,4.112h5.828Z" transform="translate(-640.604 -528.758)"/></g></g></svg></a>
                </div>

                <div class="nav-burger">
                
                    <div class="open-icon"></div>
                    <div class="close-icon"></div>
                
                </div>

            </div>
        </div>


        <!-- Mobile Menu -->
        <div class="menu-panel">
        
            <div class="menu-panel-wrapper">
                <nav class="mobile-nav">
                    <ul class="main-menu current-thelab">
                        
                        
                            <li class="menu-item "><a class="nav-item" href="/services/" >Testing Assurance</a>
                            
                            </li>
                        
                            <li class="menu-item dropdown-parent"><a class="nav-item" href="/consulting-services/" >Consulting Services</a>
                            
                                <ul class="sub-menu">
                                    
                                        <li class="sub-menu-item">
                                            <a class="sub-nav-item" href="/penetration-testing-maturity/" >Penetration Testing Maturity</a>
                                        </li>
                                    
                                        <li class="sub-menu-item">
                                            <a class="sub-nav-item" href="/dora-compliance/" >DORA Compliance</a>
                                        </li>
                                    
                                </ul>
                            
                            </li>
                        
                            <li class="menu-item "><a class="nav-item" href="/blog/" >The Lab</a>
                            
                            </li>
                        
                            <li class="menu-item "><a class="nav-item" href="/the-blog/" >The Blog</a>
                            
                            </li>
                        
                            <li class="menu-item "><a class="nav-item" href="/case-studies/" >Case Studies</a>
                            
                            </li>
                        
                            <li class="menu-item dropdown-parent"><a class="nav-item" href="/about-us/" >About us</a>
                            
                                <ul class="sub-menu">
                                    
                                        <li class="sub-menu-item">
                                            <a class="sub-nav-item" href="/why-secforce/" >Why SECFORCE</a>
                                        </li>
                                    
                                        <li class="sub-menu-item">
                                            <a class="sub-nav-item" href="/join/" >Join</a>
                                        </li>
                                    
                                </ul>
                            
                            </li>
                        
                            <li class="menu-item "><a class="nav-item" href="/contact-us/" >Contact</a>
                            
                            </li>
                        
                    </ul>
                </nav>
            </div>
        
        </div>

    </header>
    
    
    <!-- Page transition curtain -->
    <div class="transition-curtain" id="transition-curtain"></div>

    

<link rel="stylesheet" href="/assets/styles/code.css">

<div id="pageContent" class="main-wrapper page-post">
	<section class="section-post-meta">
		<div class="section-inner container align-center">
			<h1 class="post-title">Pre-Auth MySQL remote DOS (Integer Overflow)</h1>
			<div class="post-meta h4">Published on April 13, 2017 by SECFORCE</div>
			<div class="post-image">
				<img alt="imagensecforcepost.png" src="/media/images/imagensecforcepost.width-1000.png" width="1000">
			</div>
		</div>
	</section>

	
	<section class="section-content container section-post-content text-editor-content">	
		
<p data-block-key="07fly">MySQL server is affected by a remote DoS attack, which could be exploited by a remote unauthenticated attacker to cause a loss of availability on the targeted service.</p><p data-block-key="1eong">The issue has been verified to affect 5.6.X branch up to 5.6.35 and 5.7.X branch up to 5.7.17. It is strongly recommended that MySQL servers are updated to the <a href="https://dev.mysql.com/downloads/mysql/">latest version</a>.</p><p data-block-key="2i7te">Upon connection from a client, the server sends a greeting message and the client continues the communication by starting the authentication process. The authentication packet sent by the client contains a wealth of information including the client capabilities, username, password, etc. The packet is received by the server, and parsed by <i>parse_client_handshake_packet()</i> function, in /sql/auth/sql_authentication.cc.</p><p data-block-key="8qn7v">In particular, the following code retrieves the password from the packet:</p>

	</section>
	
	<section class="section-content container section-post-content text-editor-content">	
		<div class="code syntax"><pre><span></span><span class="n">passwd</span><span class="o">=</span><span class="w"> </span><span class="n">get_length_encoded_string</span><span class="p">(</span><span class="o">&amp;</span><span class="n">end</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bytes_remaining_in_packet</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">passwd_len</span><span class="p">);</span>
</pre></div>

	</section>
	
	<section class="section-content container section-post-content text-editor-content">	
		
<p data-block-key="07fly"><i>get_length_encoded_string()</i> in turn calls <i>get_56_lenc_string()</i> function.</p><p data-block-key="b4dvp">The password field in the packet is defined by two values: the length of the password (1 byte), followed by the actual password field content. This length is calculated by calling the <i>net_field_length_ll()</i> function.</p>

	</section>
	
	<section class="section-content container section-post-content text-editor-content">	
		<div class="code syntax"><pre><span></span><span class="n">my_ulonglong</span><span class="w"> </span><span class="nf">net_field_length_ll</span><span class="p">(</span><span class="n">uchar</span><span class="w"> </span><span class="o">**</span><span class="n">packet</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">uchar</span><span class="w"> </span><span class="o">*</span><span class="n">pos</span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">packet</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="w"> </span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="w"> </span><span class="mi">251</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="o">*</span><span class="n">packet</span><span class="p">)</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">my_ulonglong</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="n">pos</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">251</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="o">*</span><span class="n">packet</span><span class="p">)</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">my_ulonglong</span><span class="p">)</span><span class="w"> </span><span class="n">NULL_LENGTH</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">252</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="o">*</span><span class="n">packet</span><span class="p">)</span><span class="o">+=</span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">my_ulonglong</span><span class="p">)</span><span class="w"> </span><span class="n">uint2korr</span><span class="p">(</span><span class="n">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">253</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="o">*</span><span class="n">packet</span><span class="p">)</span><span class="o">+=</span><span class="mi">4</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">my_ulonglong</span><span class="p">)</span><span class="w"> </span><span class="n">uint3korr</span><span class="p">(</span><span class="n">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="n">packet</span><span class="p">)</span><span class="o">+=</span><span class="mi">9</span><span class="p">;</span><span class="w">					</span><span class="cm">/* Must be 254 when here */</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">my_ulonglong</span><span class="p">)</span><span class="w"> </span><span class="n">uint8korr</span><span class="p">(</span><span class="n">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

	</section>
	
	<section class="section-content container section-post-content text-editor-content">	
		
<p data-block-key="07fly">As shown in the code above, if the buffer sent to the MySQL server points to a length of \xFF, the pointer to the packet would be increased by 9 bytes.</p><p data-block-key="c40m5">If an attacker sends an authentication packet with a password length of \xFE or \xFF with less than 9 bytes following that value, the <i>net_field_length_ll</i> function will position the pointer to the packet outside the boundaries of the variable.</p><p data-block-key="e3rgk">The <i>get_56_lenc_string</i> function will continue the execution calculating the number of bytes remaining in the packet.</p><p data-block-key="75d40">The instruction <i>max_bytes_available -= len_len</i> will provoke an integer overflow where the value of <i>max_bytes_available</i> will become a very large unsigned integer.</p><p data-block-key="42mg7">The next time get_string function is called, it will make <i>memchr</i> read out of boundaries and exit with a segmentation fault.</p><p data-block-key="59etg">A <a href="https://github.com/SECFORCE/CVE-2017-3599">Proof of Concept</a> code for this vulnerability has been released.</p><p data-block-key="1vk9">References:</p><p data-block-key="664vi"><a href="http://www.oracle.com/technetwork/security-advisory/cpuapr2017-3236618.html">Oracle Critical Patch Update</a></p>

	</section>
	
	
	<!-- POST SHARE -->
	<section class="post-share">
		<div class="section-inner container">
			<div class="share-wrapper">
				<div class="share-label"><h3>Share on</h3></div>
				<div class="share-icons">
					<div class="share-icon"><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.secforce.com/blog/pre-auth-mysql-remote-dos-integer-overflow/"><img src="/assets/img/post/share-linkedin.svg" alt=""></a></div>
					<div class="share-icon"><a href="https://twitter.com/intent/tweet?url=https://www.secforce.com/blog/pre-auth-mysql-remote-dos-integer-overflow/"><img src="/assets/img/post/share-twitter.svg" alt=""></a></div>
					<div class="share-icon"><a href="https://www.facebook.com/sharer.php?u=https://www.secforce.com/blog/pre-auth-mysql-remote-dos-integer-overflow/"><img src="/assets/img/post/share-facebook.svg" alt=""></a></div>
				</div>
			</div>
		</div>
	</section>
	

	<!-- RELATED -->
	<section class="post-related">
		<div class="section-inner container">
			<div class="section-title">
				<h3 class="align-left">You may also be interested in...</h3>
			</div>
			<div class="row two-columns">
				<div class="column">
					<div class="column-inner">
						<div class="grid-item lab-item">
						<div class="grid-item-inner">
							<div class="thumb">
								<a href="/blog/proxyfuzz-fuzzer-rpm-binary/"><img alt="imagensecforcepost.png" height="1392" src="/media/images/imagensecforcepost.original.png" width="2184"></a>
							</div>
							<div class="meta-info">
								<div class="meta-date">Sept. 22, 2011</div>
							</div>
							<h3 class="title"><a href="/blog/proxyfuzz-fuzzer-rpm-binary/">Proxyfuzz fuzzer RPM binary</a></h3>
							<p class="excerpt">Proxyfuzz fuzzer RPM binary is now availabe for Fedora users</p>
							<a href="/blog/proxyfuzz-fuzzer-rpm-binary/" class="more-link">See more</a>
						</div>
					</div>
					</div>
				</div>

				<div class="column">
					<div class="column-inner">
						<div class="grid-item lab-item">
						<div class="grid-item-inner">
							<div class="thumb">
								<a href="/blog/shortcomings-of-following-iis-security-best-practices/"><img alt="imagensecforcepost.png" height="1392" src="/media/images/imagensecforcepost.original.png" width="2184"></a>
							</div>
							<div class="meta-info">
								<div class="meta-date">Nov. 16, 2012</div>
							</div>
							<h3 class="title"><a href="/blog/shortcomings-of-following-iis-security-best-practices/">Shortcomings of following IIS security best practices</a></h3>
							<p class="excerpt">Benefits of a layered security approach</p>
							<a href="/blog/shortcomings-of-following-iis-security-best-practices/" class="more-link">See more</a>
						</div>
					</div>
					</div>
				</div>
			</div>
		</div>
	</section>
</div>



    <footer id="footer" class="bgcolor-black textcolor-white">
        
        
        
        
        <section class="separator-section bgcolor-black">
            <div class="separator separator-white container-fluid"></div>
        </section>
        
	
                <div class="footer-bottom">
                    <div class="row container">
                        <div class="column footer-corp">
                            <div class="footer-logo">
                                <a href="/"><img src="/assets/img/logos/secforce.011a81db89c9.svg" /></a>
                            </div>
                            <div class="footer-address">
                                <a href="tel:+448450568694">+44 (0) 845 056 8694</a><br />
                                <a href="mailto:info@secforce.com">info@secforce.com</a>
                            </div>
                        </div>
                        <div class="column footer-menu-holder">
                            
                            <div class="column footer-menu-column">
                                <ul class="footer-nav">
                                    
                                    
                                        <li class="footer-nav-item"><a href="/services/" >Testing Assurance</a></li>
                                    
                                        <li class="footer-nav-item"><a href="/consulting-services/" >Consulting Services</a></li>
                                    
                                        <li class="footer-nav-item"><a href="/case-studies/" >Case Studies</a></li>
                                    
                                        <li class="footer-nav-item"><a href="/blog/" >The Lab</a></li>
                                    
                                </ul>
                            </div>
                            <div class="column footer-menu-column">
                                <ul class="footer-nav">
                                    
                                    
                                        <li class="footer-nav-item"><a href="/about-us/" >About us</a></li>
                                    
                                        <li class="footer-nav-item"><a href="/contact-us/" >Contact</a></li>
                                                                        
                                </ul>
                            </div>
                            <div class="column footer-menu-column">
                                <ul class="footer-nav footer-social">
                                    
                                    
                                        <li class="footer-nav-item"><a href="https://www.linkedin.com/company/secforce-ltd/" >Linkedin</a></li>
                                    
                                        <li class="footer-nav-item"><a href="https://www.youtube.com/channel/UCuN3JqLlbwmk02G37Q2ba4Q" >Youtube</a></li>
                                    
                                        <li class="footer-nav-item"><a href="https://twitter.com/secforce_ltd" >Twitter</a></li>
                                    
                                        <li class="footer-nav-item"><a href="https://github.com/SECFORCE" >Github</a></li>
                                    
                                </ul>
                            </div>
                            
                            <div class="column footer-certs">
                                <div class="certs-container">
                                    <div class="cert-item"><img src="/assets/img/logos/cert-crest.99aba48998a9.png" title="" width="46" /></div>
                                    <div class="cert-item"><img src="/assets/img/logos/Crest-VA-White.b0d4236905dd.png" title="" width="59" /></div>
                                    <div class="cert-item"><img src="/assets/img/logos/Pen_testing_white.556108808b3f.svg" title="" width="88" /></div>
                                    <div class="cert-item"><img src="/assets/img/logos/cert-cbest.5150c9733347.png" title="" width="87" /></div>
                                    <div><img src="/assets/img/logos/ISO_27001_white.38f60fb721f7.svg" title="" width="100px" /></div>
                                    <div><img src="/assets/img/logos/ISO_9001_white.6e59f5c5bee6.svg" title="" width="100px" /></div>
                                    <div class="cert-item"><img src="/assets/img/logos/cert-tiber.35d361a6904c.png" title="" width="34" /></div>
                                </div>
                            </div>
                        </div>
                        <div class="column footer-newsletter">
                            <div class="form-wrapper newsletter-form">
                                <form id="subscribe_data_form" >
                                    <p class="title-newsletter h4">Subscribe to our newsletter</p>
                                    <div class="form-field">
                                        <input type="email" id="email_newsletter" name="email_newsletter" class="email-newsletter" required />
                                    </div>
                                    <div class="form-field">
                                        <button type="submit" name="send_newsletter" value="Send" class="send-newsletter oct-button oct-button-small oct-button-yellow" >Send</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
	        
    </footer>
    <!-- JS FILES -->
    <!-- LIBS -->
    <script src="/assets/scripts/jquery.min.8fb8fee4fcc3.js" ></script>
    <script src="/assets/scripts/swiper-bundle.min.5f5b251a8ea7.js" ></script>
    <script src="/assets/scripts/slick.min.d5a61c749e44.js" ></script>
    <script src="/assets/scripts/lottie.min.146c6c0637da.js" ></script>

    <!-- SITE -->
    <script src="/assets/scripts/app.4b40abeb99ef.js"></script>
    <script src="/assets/scripts/main.fc5f09ddd9c4.js?v=2.1.0"></script>
        


    <!-- LINKEDIN -->
    <noscript>
    <img height="1" width="1" style="display:none;" alt="" src="https://px.ads.linkedin.com/collect/?pid=5245225&fmt=gif" />
    </noscript>

    <!-- END LINKEDIN -->

    <script type="text/javascript" src="/assets/scripts/780193.816a8a59a76b.js"></script>
    <noscript>
        <img alt="" src="/assets/img/780193.d41d8cd98f00.png" style="display:none;" />
    </noscript>


    <!-- LIGHTBOX OK -->

    <div id="box-ok" class="lightbox-wrapper">
        <div id="box-ok-overlay" class="overlay-bg"></div>
        <div class="lightbox-container">
            <div class="lightbox-inner">
                 <div class="casestudy-download-form textcolor-white">
                    <p id="mybox-large-text" class="h2 align-center">Thank you!</p>
                    <div class="form-title h4 align-center">All done, my friend. The information reached SECFORCE goblins safely.</div>
                </div>
            </div>
        </div>
    </div>

    <!-- LIGHTBOX ERROR -->
    <div id="box-error" class="lightbox-wrapper">
        <div id="box-error-overlay" class="overlay-bg"></div>
        <div class="lightbox-container">
            <div class="lightbox-inner">
                 <div class="casestudy-download-form textcolor-white">
                    <p id="mybox-large-text" class="h2 align-center">Please try again later.</p>
                    <div class="form-title h4 align-center">Oops... Something went wrong. Please check that the form fields are correct.</div>
                    
                </div>
            </div>
        </div>
    </div>
    
    
</body>
</html>
