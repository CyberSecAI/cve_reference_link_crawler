

* [Testing Assurance](/services/)
* [Consulting Services](/consulting-services/)
  + [Penetration Testing Maturity](/penetration-testing-maturity/)
  + [DORA Compliance](/dora-compliance/)
* [The Lab](/blog/)
* [The Blog](/the-blog/)
* [Case Studies](/case-studies/)
* [About us](/about-us/)
  + [Why SECFORCE](/why-secforce/)
  + [Join](/join/)
* [Contact](/contact-us/)

* [Testing Assurance](/services/)
* [Consulting Services](/consulting-services/)
  + [Penetration Testing Maturity](/penetration-testing-maturity/)
  + [DORA Compliance](/dora-compliance/)
* [The Lab](/blog/)
* [The Blog](/the-blog/)
* [Case Studies](/case-studies/)
* [About us](/about-us/)
  + [Why SECFORCE](/why-secforce/)
  + [Join](/join/)
* [Contact](/contact-us/)

# Pre-Auth MySQL remote DOS (Integer Overflow)

Published on April 13, 2017 by SECFORCE
![imagensecforcepost.png](/media/images/imagensecforcepost.width-1000.png)

MySQL server is affected by a remote DoS attack, which could be exploited by a remote unauthenticated attacker to cause a loss of availability on the targeted service.

The issue has been verified to affect 5.6.X branch up to 5.6.35 and 5.7.X branch up to 5.7.17. It is strongly recommended that MySQL servers are updated to the [latest version](https://dev.mysql.com/downloads/mysql/).

Upon connection from a client, the server sends a greeting message and the client continues the communication by starting the authentication process. The authentication packet sent by the client contains a wealth of information including the client capabilities, username, password, etc. The packet is received by the server, and parsed by *parse\_client\_handshake\_packet()* function, in /sql/auth/sql\_authentication.cc.

In particular, the following code retrieves the password from the packet:

```
passwd= get_length_encoded_string(&end, &bytes_remaining_in_packet, &passwd_len);

```

*get\_length\_encoded\_string()* in turn calls *get\_56\_lenc\_string()* function.

The password field in the packet is defined by two values: the length of the password (1 byte), followed by the actual password field content. This length is calculated by calling the *net\_field\_length\_ll()* function.

```
my_ulonglong net_field_length_ll(uchar **packet)
{
  uchar *pos= *packet;
  if (*pos &lt; 251)
  {
    (*packet)++;
    return (my_ulonglong) *pos;
  }
  if (*pos == 251)
  {
    (*packet)++;
    return (my_ulonglong) NULL_LENGTH;
  }
  if (*pos == 252)
  {
    (*packet)+=3;
    return (my_ulonglong) uint2korr(pos+1);
  }
  if (*pos == 253)
  {
    (*packet)+=4;
    return (my_ulonglong) uint3korr(pos+1);
  }
  (*packet)+=9;					/* Must be 254 when here */
  return (my_ulonglong) uint8korr(pos+1);
}

```

As shown in the code above, if the buffer sent to the MySQL server points to a length of \xFF, the pointer to the packet would be increased by 9 bytes.

If an attacker sends an authentication packet with a password length of \xFE or \xFF with less than 9 bytes following that value, the *net\_field\_length\_ll* function will position the pointer to the packet outside the boundaries of the variable.

The *get\_56\_lenc\_string* function will continue the execution calculating the number of bytes remaining in the packet.

The instruction *max\_bytes\_available -= len\_len* will provoke an integer overflow where the value ofÂ *max\_bytes\_available* will become a very large unsigned integer.

The next time get\_string function is called, it will make *memchr* read out of boundaries and exit with a segmentation fault.

A [Proof of Concept](https://github.com/SECFORCE/CVE-2017-3599) code for this vulnerability has been released.

References:

[Oracle Critical Patch Update](http://www.oracle.com/technetwork/security-advisory/cpuapr2017-3236618.html)

### Share on

[![](/assets/img/post/share-linkedin.svg)](https://www.linkedin.com/sharing/share-offsite/?url=https://www.secforce.com/blog/pre-auth-mysql-remote-dos-integer-overflow/)
[![](/assets/img/post/share-twitter.svg)](https://twitter.com/intent/tweet?url=https://www.secforce.com/blog/pre-auth-mysql-remote-dos-integer-overflow/)
[![](/assets/img/post/share-facebook.svg)](https://www.facebook.com/sharer.php?u=https://www.secforce.com/blog/pre-auth-mysql-remote-dos-integer-overflow/)

### You may also be interested in...

[![imagensecforcepost.png](/media/images/imagensecforcepost.original.png)](/blog/proxyfuzz-fuzzer-rpm-binary/)

Sept. 22, 2011
### [Proxyfuzz fuzzer RPM binary](/blog/proxyfuzz-fuzzer-rpm-binary/)

Proxyfuzz fuzzer RPM binary is now availabe for Fedora users

[See more](/blog/proxyfuzz-fuzzer-rpm-binary/)

[![imagensecforcepost.png](/media/images/imagensecforcepost.original.png)](/blog/shortcomings-of-following-iis-security-best-practices/)

Nov. 16, 2012
### [Shortcomings of following IIS security best practices](/blog/shortcomings-of-following-iis-security-best-practices/)

Benefits of a layered security approach

[See more](/blog/shortcomings-of-following-iis-security-best-practices/)

[![](/assets/img/logos/secforce.011a81db89c9.svg)](/)

+44 (0) 845 056 8694

info@secforce.com

* [Testing Assurance](/services/)
* [Consulting Services](/consulting-services/)
* [Case Studies](/case-studies/)
* [The Lab](/blog/)

* [About us](/about-us/)
* [Contact](/contact-us/)

* [Linkedin](https://www.linkedin.com/company/secforce-ltd/)
* [Youtube](https://www.youtube.com/channel/UCuN3JqLlbwmk02G37Q2ba4Q)
* [Twitter](https://twitter.com/secforce_ltd)
* [Github](https://github.com/SECFORCE)

![](/assets/img/logos/cert-crest.99aba48998a9.png)
![](/assets/img/logos/Crest-VA-White.b0d4236905dd.png)
![](/assets/img/logos/Pen_testing_white.556108808b3f.svg)
![](/assets/img/logos/cert-cbest.5150c9733347.png)
![](/assets/img/logos/ISO_27001_white.38f60fb721f7.svg)
![](/assets/img/logos/ISO_9001_white.6e59f5c5bee6.svg)
![](/assets/img/logos/cert-tiber.35d361a6904c.png)

Subscribe to our newsletter

Send

![](https://px.ads.linkedin.com/collect/?pid=5245225&fmt=gif)

![](/assets/img/780193.d41d8cd98f00.png)

Thank you!

All done, my friend. The information reached SECFORCE goblins safely.

Please try again later.

Oops... Something went wrong. Please check that the form fields are correct.

