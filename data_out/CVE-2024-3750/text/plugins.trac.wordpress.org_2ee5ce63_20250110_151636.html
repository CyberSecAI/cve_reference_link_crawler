

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3086048%2Fvisualizer%2Ftags%2F3.11.0%2Fclasses%2FVisualizer%2FModule%2FChart.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3072683/visualizer/trunk/classes/Visualizer/Module/Chart.php "Changeset 3072683 for visualizer/tags/3.11.0/classes/Visualizer/Module/Chart.php")
* Next Change →

---

# Changeset [3086048](/changeset/3086048 "Show full changeset") for [visualizer/tags/3.11.0/classes/Visualizer/Module/Chart.php](/browser/visualizer/tags/3.11.0/classes/Visualizer/Module/Chart.php?rev=3086048 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
05/13/2024 06:08:31 PM
([8 months](/timeline?from=2024-05-13T18%3A08%3A31Z&precision=second "See timeline at 05/13/2024 06:08:31 PM") ago)

Author:
themeisle
Message:

Update to version 3.11.0 from GitHub

Location:
[visualizer/tags/3.11.0](/browser/visualizer/tags/3.11.0?rev=3086048)
Files:

1 edited
1 copied

* [.](/browser/visualizer/tags/3.11.0?rev=3086048 "Show entry in browser")
  (copied)
  *(copied from [visualizer/trunk](/browser/visualizer/trunk?rev=3084696 "Show original file (revision 3086047)"))*
* [classes/Visualizer/Module/Chart.php](/browser/visualizer/tags/3.11.0/classes/Visualizer/Module/Chart.php?rev=3086048 "Show entry in browser")
  (modified)
  ([7 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [visualizer/tags/3.11.0/classes/Visualizer/Module/Chart.php](/changeset/3086048/visualizer/tags/3.11.0/classes/Visualizer/Module/Chart.php "Show the changeset 3086048 restricted to visualizer/tags/3.11.0/classes/Visualizer/Module/Chart.php")

  | [r3072683](/browser/visualizer/trunk/classes/Visualizer/Module/Chart.php?rev=3072683#L753 "Show revision 3072683 of this file in browser") | [r3086048](/browser/visualizer/tags/3.11.0/classes/Visualizer/Module/Chart.php?rev=3086048#L753 "Show revision 3086048 of this file in browser") |  |
  | --- | --- | --- |
  | 753 | 753 | 'matchBrackets'     => true, |
  | 754 | 754 | 'autoCloseBrackets' => true, |
  | 755 |  | 'extraKeys'         => array( '~~Ctrl~~-Space' => 'autocomplete' ), |
  |  | 755 | 'extraKeys'         => array( 'Shift-Space' => 'autocomplete' ), |
  | 756 | 756 | 'hintOptions'       => array( 'tables' => $table\_col\_mapping ), |
  | 757 | 757 | ), |
  | […](/browser/visualizer/trunk/classes/Visualizer/Module/Chart.php?rev=3072683#L789) | […](/browser/visualizer/tags/3.11.0/classes/Visualizer/Module/Chart.php?rev=3086048#L789) |  |
  | 789 | 789 |  |
  | 790 | 790 | if ( $\_SERVER['REQUEST\_METHOD'] === 'POST' && isset( $\_GET['nonce'] ) && wp\_verify\_nonce( $\_GET['nonce'] ) ) { |
  | 791 |  | if ( $this->\_chart->post\_status === 'auto-draft' ) { |
  |  | 791 | $is\_canceled      = isset( $\_POST['cancel'] ) && 1 === intval( $\_POST['cancel'] ); |
  |  | 792 | $is\_newly\_created = $this->\_chart->post\_status === 'auto-draft'; |
  |  | 793 |  |
  |  | 794 | if ( $is\_newly\_created && ! $is\_canceled ) { |
  | 792 | 795 | $this->\_chart->post\_status = 'publish'; |
  | 793 | 796 |  |
  | […](/browser/visualizer/trunk/classes/Visualizer/Module/Chart.php?rev=3072683#L799) | […](/browser/visualizer/tags/3.11.0/classes/Visualizer/Module/Chart.php?rev=3086048#L802) |  |
  | 799 | 802 | } |
  | 800 | 803 | // save meta data only when it is NOT being canceled. |
  | 801 |  | if ( ! ~~( isset( $\_POST['cancel'] ) && 1 === intval( $\_POST['cancel'] ) )~~ ) { |
  |  | 804 | if ( ! $is\_canceled ) { |
  | 802 | 805 | update\_post\_meta( $this->\_chart->ID, Visualizer\_Plugin::CF\_SETTINGS, $\_POST ); |
  | 803 | 806 |  |
  | […](/browser/visualizer/trunk/classes/Visualizer/Module/Chart.php?rev=3072683#L875) | […](/browser/visualizer/tags/3.11.0/classes/Visualizer/Module/Chart.php?rev=3086048#L878) |  |
  | 875 | 878 | 'l10n'   => array( |
  | 876 | 879 | 'invalid\_source' => esc\_html\_\_( 'You have entered an invalid URL. Please provide a valid URL.', 'visualizer' ), |
  | 877 |  | 'loading'       => esc\_html\_\_( 'Loading...', 'visualizer' ), |
  | 878 |  | 'json\_error'    => esc\_html\_\_( 'An error occured in fetching data.', 'visualizer' ), |
  | 879 |  | 'select\_columns'    => esc\_html\_\_( 'Please select a few columns to include in the chart.', 'visualizer' ), |
  | 880 |  | 'save\_settings'    => \_\_( 'You have modified the chart\'s settings. To modify the source/data again, you must save this chart and reopen it for editing. If you continue without saving the chart, you may lose your changes.', 'visualizer' ), |
  |  | 880 | 'loading'        => esc\_html\_\_( 'Loading...', 'visualizer' ), |
  |  | 881 | 'json\_error'     => esc\_html\_\_( 'An error occured in fetching data.', 'visualizer' ), |
  |  | 882 | 'select\_columns' => esc\_html\_\_( 'Please select a few columns to include in the chart.', 'visualizer' ), |
  |  | 883 | 'save\_settings'  => \_\_( 'You have modified the chart\'s settings. To modify the source/data again, you must save this chart and reopen it for editing. If you continue without saving the chart, you may lose your changes.', 'visualizer' ), |
  |  | 884 | 'copied'         => \_\_( 'The data has been copied to your clipboard. Hit Ctrl-V/Cmd-V in your spreadsheet editor to paste the data.', 'visualizer' ), |
  | 881 | 885 | ), |
  | 882 | 886 | 'charts' => array( |
  | […](/browser/visualizer/trunk/classes/Visualizer/Module/Chart.php?rev=3072683#L924) | […](/browser/visualizer/tags/3.11.0/classes/Visualizer/Module/Chart.php?rev=3086048#L928) |  |
  | 924 | 928 | ? esc\_html\_\_( 'Save Chart', 'visualizer' ) |
  | 925 | 929 | : esc\_html\_\_( 'Create Chart', 'visualizer' ); |
  | 926 |  | if ( filter\_input( INPUT\_GET, 'action' ) === Visualizer\_Plugin::ACTION\_EDIT\_CHART ) { |
  | 927 |  | $render->cancel\_button = esc\_html\_\_( 'Cancel', 'visualizer' ); |
  | 928 |  | } |
  |  | 930 |  |
  |  | 931 | $render->cancel\_button = esc\_html\_\_( 'Cancel', 'visualizer' ); |
  | 929 | 932 | } else { |
  | 930 | 933 | $render->button = esc\_attr\_\_( 'Insert Chart', 'visualizer' ); |
  | […](/browser/visualizer/trunk/classes/Visualizer/Module/Chart.php?rev=3072683#L1425) | […](/browser/visualizer/tags/3.11.0/classes/Visualizer/Module/Chart.php?rev=3086048#L1428) |  |
  | 1425 | 1428 | wp\_send\_json\_error( array( 'msg' => \_\_( 'Action not allowed for this user.', 'visualizer' ) ) ); |
  | 1426 | 1429 | } |
  |  | 1430 | if ( ! is\_super\_admin() ) { |
  |  | 1431 | wp\_send\_json\_error( array( 'msg' => \_\_( 'Action not allowed for this user.', 'visualizer' ) ) ); |
  |  | 1432 | } |
  | 1427 | 1433 |  |
  | 1428 | 1434 | $params     = wp\_parse\_args( $\_POST['params'] ); |
  | 1429 | 1435 | $chart\_id   = filter\_var( $params['chart\_id'], FILTER\_VALIDATE\_INT ); |
  | 1430 |  |  |
  | 1431 |  | $source     = new Visualizer\_Source\_Query( stripslashes( $params['query'] ), $chart\_id, $params ); |
  |  | 1436 | $query      = trim( $params['query'], ';' ); |
  |  | 1437 |  |
  |  | 1438 | $source     = new Visualizer\_Source\_Query( stripslashes( $query ), $chart\_id, $params ); |
  | 1432 | 1439 | $html       = $source->fetch( true ); |
  | 1433 | 1440 | $error      = $source->get\_error(); |
  | […](/browser/visualizer/trunk/classes/Visualizer/Module/Chart.php?rev=3072683#L1476) | […](/browser/visualizer/tags/3.11.0/classes/Visualizer/Module/Chart.php?rev=3086048#L1483) |  |
  | 1476 | 1483 | if ( $chart\_id ) { |
  | 1477 | 1484 | $params     = wp\_parse\_args( $\_POST['params'] ); |
  | 1478 |  | $source     = new Visualizer\_Source\_Query( stripslashes( $params['query'] ), $chart\_id, $params ); |
  |  | 1485 | $query      = trim( $params['query'], ';' ); |
  |  | 1486 | $source     = new Visualizer\_Source\_Query( stripslashes( $query ), $chart\_id, $params ); |
  | 1479 | 1487 | $source->fetch( false ); |
  | 1480 | 1488 | $error      = $source->get\_error(); |
  | 1481 | 1489 | if ( empty( $error ) ) { |
  | 1482 |  | update\_post\_meta( $chart\_id, Visualizer\_Plugin::CF\_DB\_QUERY, stripslashes( $~~params['query']~~ ) ); |
  |  | 1490 | update\_post\_meta( $chart\_id, Visualizer\_Plugin::CF\_DB\_QUERY, stripslashes( $query ) ); |
  | 1483 | 1491 | update\_post\_meta( $chart\_id, Visualizer\_Plugin::CF\_SOURCE, $source->getSourceName() ); |
  | 1484 | 1492 | update\_post\_meta( $chart\_id, Visualizer\_Plugin::CF\_SERIES, $source->getSeries() ); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3086048)
* [Zip Archive](?format=zip&new=3086048)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

