=== Content from plugins.trac.wordpress.org_4c0ffc8a_20250111_143009.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3154854%2Feasy-digital-downloads%2Ftags%2F3.3.4%2Fsrc%2FUtils%2FFileSystem.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3060808/easy-digital-downloads/trunk/src/Utils/FileSystem.php "Changeset 3060808 for easy-digital-downloads/tags/3.3.4/src/Utils/FileSystem.php")
* Next Change →

---

# Changeset [3154854](/changeset/3154854 "Show full changeset") for [easy-digital-downloads/tags/3.3.4/src/Utils/FileSystem.php](/browser/easy-digital-downloads/tags/3.3.4/src/Utils/FileSystem.php?rev=3154854 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
09/19/2024 09:59:46 PM
([4 months](/timeline?from=2024-09-19T21%3A59%3A46Z&precision=second "See timeline at 09/19/2024 09:59:46 PM") ago)

Author:
cklosows
Message:

Tagging version 3.3.4

Location:
[easy-digital-downloads/tags/3.3.4](/browser/easy-digital-downloads/tags/3.3.4?rev=3154854)
Files:

1 edited
1 copied

* [.](/browser/easy-digital-downloads/tags/3.3.4?rev=3154854 "Show entry in browser")
  (copied)
  *(copied from [easy-digital-downloads/trunk](/browser/easy-digital-downloads/trunk?rev=3131805 "Show original file (revision 3154853)"))*
* [src/Utils/FileSystem.php](/browser/easy-digital-downloads/tags/3.3.4/src/Utils/FileSystem.php?rev=3154854 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [easy-digital-downloads/tags/3.3.4/src/Utils/FileSystem.php](/changeset/3154854/easy-digital-downloads/tags/3.3.4/src/Utils/FileSystem.php "Show the changeset 3154854 restricted to easy-digital-downloads/tags/3.3.4/src/Utils/FileSystem.php")

  | [r3060808](/browser/easy-digital-downloads/trunk/src/Utils/FileSystem.php?rev=3060808#L1 "Show revision 3060808 of this file in browser") | [r3154854](/browser/easy-digital-downloads/tags/3.3.4/src/Utils/FileSystem.php?rev=3154854#L1 "Show revision 3154854 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 | /\*\* |
  |  | 3 | \* File system utility class. |
  |  | 4 | \* |
  |  | 5 | \* @package EDD\Utils |
  |  | 6 | \* @since 3.2.10 |
  |  | 7 | \*/ |
  | 2 | 8 |  |
  | 3 | 9 | namespace EDD\Utils; |
  | […](/browser/easy-digital-downloads/trunk/src/Utils/FileSystem.php?rev=3060808#L61) | […](/browser/easy-digital-downloads/tags/3.3.4/src/Utils/FileSystem.php?rev=3154854#L67) |  |
  | 61 | 67 | $uploads      = wp\_upload\_dir(); |
  | 62 | 68 | $uploads\_file = trailingslashit( $uploads['basedir'] ) . $file\_name; |
  | 63 |  | if ( self::~~get\_fs()->~~exists( $uploads\_file ) ) { |
  |  | 69 | if ( self::file\_exists( $uploads\_file ) ) { |
  | 64 | 70 | self::get\_fs()->move( $uploads\_file, $file ); |
  | 65 | 71 | } |
  | 66 | 72 | } |
  |  | 73 |  |
  |  | 74 | /\*\* |
  |  | 75 | \* Check if a file exists. |
  |  | 76 | \* |
  |  | 77 | \* @since 3.3.4 |
  |  | 78 | \* @param string $file The file to check. |
  |  | 79 | \* @return bool True if the file exists, false otherwise. |
  |  | 80 | \*/ |
  |  | 81 | public static function file\_exists( $file ) { |
  |  | 82 | // Strip any protocol/file wrappers. |
  |  | 83 | $file = self::sanitize\_file\_path( $file ); |
  |  | 84 | if ( ! self::is\_direct() ) { |
  |  | 85 | return file\_exists( $file ); |
  |  | 86 | } |
  |  | 87 |  |
  |  | 88 | return self::get\_fs()->exists( $file ); |
  |  | 89 | } |
  |  | 90 |  |
  |  | 91 | /\*\* |
  |  | 92 | \* Open a file. |
  |  | 93 | \* |
  |  | 94 | \* @since 3.3.4 |
  |  | 95 | \* @param string $file The file to open. |
  |  | 96 | \* @param string $mode The mode to open the file in. |
  |  | 97 | \* @return resource|bool The file resource on success, false on failure. |
  |  | 98 | \*/ |
  |  | 99 | public static function fopen( $file, $mode ) { |
  |  | 100 | $file = self::sanitize\_file\_path( $file ); |
  |  | 101 |  |
  |  | 102 | return @fopen( $file, $mode ); |
  |  | 103 | } |
  |  | 104 |  |
  |  | 105 | /\*\* |
  |  | 106 | \* Get the filesize. |
  |  | 107 | \* |
  |  | 108 | \* @since 3.3.4 |
  |  | 109 | \* @param string $file The file to get the size of. |
  |  | 110 | \* @return int|bool The file size on success, false on failure. |
  |  | 111 | \*/ |
  |  | 112 | public static function size( $file ) { |
  |  | 113 | $file = self::sanitize\_file\_path( $file ); |
  |  | 114 |  |
  |  | 115 | return self::get\_fs()->size( $file ); |
  |  | 116 | } |
  |  | 117 |  |
  |  | 118 | /\*\* |
  |  | 119 | \* Get the file contents as a string. |
  |  | 120 | \* |
  |  | 121 | \* Returns the file contents as a string. If you need the file contents as an array (such as for CSV files), use `file()` instead. |
  |  | 122 | \* |
  |  | 123 | \* @since 3.3.4 |
  |  | 124 | \* @param string $file The file to get the contents of. |
  |  | 125 | \* @return string|bool The file contents on success, false on failure. |
  |  | 126 | \*/ |
  |  | 127 | public static function get\_contents( $file ) { |
  |  | 128 | $file = self::sanitize\_file\_path( $file ); |
  |  | 129 | if ( ! self::is\_direct() ) { |
  |  | 130 | return file\_get\_contents( $file ); |
  |  | 131 | } |
  |  | 132 |  |
  |  | 133 | return self::get\_fs()->get\_contents( $file ); |
  |  | 134 | } |
  |  | 135 |  |
  |  | 136 | /\*\* |
  |  | 137 | \* Write contents to a file. |
  |  | 138 | \* |
  |  | 139 | \* @since 3.3.4 |
  |  | 140 | \* @param string $file     The file to write to. |
  |  | 141 | \* @param string $contents The contents to write. |
  |  | 142 | \* @return int|bool The number of bytes written to the file on success, false on failure. |
  |  | 143 | \*/ |
  |  | 144 | public static function put\_contents( $file, $contents ) { |
  |  | 145 | $file = self::sanitize\_file\_path( $file ); |
  |  | 146 | if ( ! self::is\_direct() ) { |
  |  | 147 | return file\_put\_contents( $file, $contents ); |
  |  | 148 | } |
  |  | 149 |  |
  |  | 150 | return self::get\_fs()->put\_contents( $file, $contents ); |
  |  | 151 | } |
  |  | 152 |  |
  |  | 153 | /\*\* |
  |  | 154 | \* Get the file contents as an array. |
  |  | 155 | \* |
  |  | 156 | \* Returns the file contents as an array. Each line in the file is an element in the array. |
  |  | 157 | \* |
  |  | 158 | \* @since 3.3.4 |
  |  | 159 | \* @param string $file The file to get the contents of. |
  |  | 160 | \* @return array|bool The file contents as an array on success, false on failure. |
  |  | 161 | \*/ |
  |  | 162 | public static function file( $file ) { |
  |  | 163 | $file = self::sanitize\_file\_path( $file ); |
  |  | 164 | if ( ! self::is\_direct() ) { |
  |  | 165 | return file( $file ); |
  |  | 166 | } |
  |  | 167 |  |
  |  | 168 | return self::get\_fs()->get\_contents\_array( $file ); |
  |  | 169 | } |
  |  | 170 |  |
  |  | 171 | /\*\* |
  |  | 172 | \* Get the modified time of a file. |
  |  | 173 | \* |
  |  | 174 | \* @since 3.3.4 |
  |  | 175 | \* @param string $file The file to get the modified time of. |
  |  | 176 | \* @return int|bool The modified time on success, false on failure. |
  |  | 177 | \*/ |
  |  | 178 | public static function filemtime( $file ) { |
  |  | 179 | $file = self::sanitize\_file\_path( $file ); |
  |  | 180 |  |
  |  | 181 | return self::get\_fs()->mtime( $file ); |
  |  | 182 | } |
  |  | 183 |  |
  |  | 184 | /\*\* |
  |  | 185 | \* Create a symbolic link to a file. |
  |  | 186 | \* |
  |  | 187 | \* @since 3.3.4 |
  |  | 188 | \* @param string $target The target of the link. |
  |  | 189 | \* @param string $link The link to create. |
  |  | 190 | \* @return bool True on success, false on failure. |
  |  | 191 | \*/ |
  |  | 192 | public static function symlink( $target, $link ) { |
  |  | 193 | $target = self::sanitize\_file\_path( realpath( $target ) ); |
  |  | 194 | $link   = self::sanitize\_file\_path( $link ); |
  |  | 195 |  |
  |  | 196 | return @symlink( $target, $link ); |
  |  | 197 | } |
  |  | 198 |  |
  |  | 199 | /\*\* |
  |  | 200 | \* Sanitize a file path. |
  |  | 201 | \* |
  |  | 202 | \* Removes potentially risky protocols from the file path. |
  |  | 203 | \* |
  |  | 204 | \* @since 3.3.4 |
  |  | 205 | \* @param string $file The file path to sanitize. |
  |  | 206 | \* @return string The sanitized file path. |
  |  | 207 | \*/ |
  |  | 208 | public static function sanitize\_file\_path( $file ) { |
  |  | 209 | // If the file path doesn't have a protocol just return it. |
  |  | 210 | if ( false === strpos( $file, '://' ) && false === strpos( $file, urlencode( '://' ) ) ) { |
  |  | 211 | return $file; |
  |  | 212 | } |
  |  | 213 |  |
  |  | 214 | $restricted\_protocols = self::get\_restricted\_file\_protocols(); |
  |  | 215 |  |
  |  | 216 | foreach ( $restricted\_protocols as $protocol ) { |
  |  | 217 | // Create a case-insensitive pattern for each protocol. |
  |  | 218 | $pattern = '#^' . preg\_quote( $protocol, '#' ) . '#i'; |
  |  | 219 | $file    = preg\_replace( $pattern, '', $file ); |
  |  | 220 | } |
  |  | 221 |  |
  |  | 222 | return $file; |
  |  | 223 | } |
  |  | 224 |  |
  |  | 225 | /\*\* |
  |  | 226 | \* Get the restricted file protocols. |
  |  | 227 | \* |
  |  | 228 | \* @since 3.3.4 |
  |  | 229 | \* @return array The restricted file protocols. |
  |  | 230 | \*/ |
  |  | 231 | private static function get\_restricted\_file\_protocols() { |
  |  | 232 | /\*\* |
  |  | 233 | \* Filter the protocols that are restricted from file paths. |
  |  | 234 | \* |
  |  | 235 | \* @since 3.3.4 |
  |  | 236 | \* |
  |  | 237 | \* @param array $protocols The protocols to restrict. |
  |  | 238 | \*/ |
  |  | 239 | $protocols = (array) apply\_filters( |
  |  | 240 | 'edd\_file\_system\_restricted\_protocols', |
  |  | 241 | array( |
  |  | 242 | 'phar://', |
  |  | 243 | 'php://', |
  |  | 244 | 'glob://', |
  |  | 245 | 'data://', |
  |  | 246 | 'expect://', |
  |  | 247 | 'zip://', |
  |  | 248 | 'rar://', |
  |  | 249 | 'zlib://', |
  |  | 250 | ), |
  |  | 251 | ); |
  |  | 252 |  |
  |  | 253 | // Now we need the URL encoded protocols to ensure we catch all variations. |
  |  | 254 | return array\_merge( |
  |  | 255 | $protocols, |
  |  | 256 | array\_map( 'urlencode', $protocols ) |
  |  | 257 | ); |
  |  | 258 | } |
  |  | 259 |  |
  |  | 260 | /\*\* |
  |  | 261 | \* Check if the file system is direct. |
  |  | 262 | \* |
  |  | 263 | \* @since 3.3.4 |
  |  | 264 | \* @return bool True if the file system is direct, false otherwise. |
  |  | 265 | \*/ |
  |  | 266 | private static function is\_direct() { |
  |  | 267 | return self::get\_fs() instanceof \WP\_Filesystem\_Direct; |
  |  | 268 | } |
  | 67 | 269 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3154854)
* [Zip Archive](?format=zip&new=3154854)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_2752b5dc_20250111_143006.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3154854%2Feasy-digital-downloads%2Ftags%2F3.3.4%2Fincludes%2Fadmin%2Fimport%2Fimport-functions.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3120759/easy-digital-downloads/trunk/includes/admin/import/import-functions.php "Changeset 3120759 for easy-digital-downloads/tags/3.3.4/includes/admin/import/import-functions.php")
* Next Change →

---

# Changeset [3154854](/changeset/3154854 "Show full changeset") for [easy-digital-downloads/tags/3.3.4/includes/admin/import/import-functions.php](/browser/easy-digital-downloads/tags/3.3.4/includes/admin/import/import-functions.php?rev=3154854 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
09/19/2024 09:59:46 PM
([4 months](/timeline?from=2024-09-19T21%3A59%3A46Z&precision=second "See timeline at 09/19/2024 09:59:46 PM") ago)

Author:
cklosows
Message:

Tagging version 3.3.4

Location:
[easy-digital-downloads/tags/3.3.4](/browser/easy-digital-downloads/tags/3.3.4?rev=3154854)
Files:

1 edited
1 copied

* [.](/browser/easy-digital-downloads/tags/3.3.4?rev=3154854 "Show entry in browser")
  (copied)
  *(copied from [easy-digital-downloads/trunk](/browser/easy-digital-downloads/trunk?rev=3131805 "Show original file (revision 3154853)"))*
* [includes/admin/import/import-functions.php](/browser/easy-digital-downloads/tags/3.3.4/includes/admin/import/import-functions.php?rev=3154854 "Show entry in browser")
  (modified)
  ([3 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [easy-digital-downloads/tags/3.3.4/includes/admin/import/import-functions.php](/changeset/3154854/easy-digital-downloads/tags/3.3.4/includes/admin/import/import-functions.php "Show the changeset 3154854 restricted to easy-digital-downloads/tags/3.3.4/includes/admin/import/import-functions.php")

  | [r3120759](/browser/easy-digital-downloads/trunk/includes/admin/import/import-functions.php?rev=3120759#L11 "Show revision 3120759 of this file in browser") | [r3154854](/browser/easy-digital-downloads/tags/3.3.4/includes/admin/import/import-functions.php?rev=3154854#L11 "Show revision 3154854 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | \*/ |
  | 12 | 12 |  |
  | 13 |  | // Exit if accessed directly |
  |  | 13 | // Exit if accessed directly. |
  | 14 | 14 | defined( 'ABSPATH' ) || exit; |
  |  | 15 |  |
  |  | 16 | use EDD\Utils\FileSystem; |
  | 15 | 17 |  |
  | 16 | 18 | /\*\* |
  | […](/browser/easy-digital-downloads/trunk/includes/admin/import/import-functions.php?rev=3120759#L59) | […](/browser/easy-digital-downloads/tags/3.3.4/includes/admin/import/import-functions.php?rev=3154854#L61) |  |
  | 59 | 61 | } |
  | 60 | 62 |  |
  | 61 |  | if ( ! file\_exists( $\_FILES['edd-import-file']['tmp\_name'] ) ) { |
  |  | 63 | if ( ! FileSystem::file\_exists( $\_FILES['edd-import-file']['tmp\_name'] ) ) { |
  | 62 | 64 | wp\_send\_json\_error( array( 'error' => \_\_( 'Something went wrong during the upload process, please try again.', 'easy-digital-downloads' ), 'request' => $\_REQUEST ) ); |
  | 63 | 65 | } |
  | […](/browser/easy-digital-downloads/trunk/includes/admin/import/import-functions.php?rev=3120759#L111) | […](/browser/easy-digital-downloads/tags/3.3.4/includes/admin/import/import-functions.php?rev=3154854#L113) |  |
  | 111 | 113 | } |
  | 112 | 114 |  |
  | 113 |  | if ( ! file\_exists( $\_REQUEST['upload']['file'] ) ) { |
  |  | 115 | if ( ! FileSystem::file\_exists( $\_REQUEST['upload']['file'] ) ) { |
  | 114 | 116 | wp\_send\_json\_error( array( 'error' => \_\_( 'Something went wrong during the upload process, please try again.', 'easy-digital-downloads' ), 'request' => $\_REQUEST ) ); |
  | 115 | 117 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3154854)
* [Zip Archive](?format=zip&new=3154854)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_eae72567_20250111_143010.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Easy Digital Downloads – Simple eCommerce for Selling Digital Files <= 3.3.3 - Authenticated (Admin+) PHAR Deserialization

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Easy Digital Downloads – Simple eCommerce for Selling Digital Files <= 3.3.3 - Authenticated (Admin+) PHAR Deserialization

7.2

**Deserialization of Untrusted Data**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2022-2439](https://www.cve.org/CVERecord?id=CVE-2022-2439) |
| --- | --- |
| CVSS | 7.2 (High) |
| Publicly Published | September 23, 2024 |
| Last Updated | September 24, 2024 |
| Researcher | [Rasoul Jahanshahi](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/rasoul-jahanshahi) |

### Description

The Easy Digital Downloads – Simple eCommerce for Selling Digital Files plugin for WordPress is vulnerable to deserialization of untrusted input via the 'upload[file]' parameter in versions up to, and including 3.3.3. This makes it possible for authenticated administrative users to call files using a PHAR wrapper, that will deserialize and call arbitrary PHP Objects that can be used to perform a variety of malicious actions granted a POP chain is also present.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3154854/easy-digital-downloads/tags/3.3.4/includes/admin/import/import-functions.php)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3154854/easy-digital-downloads/tags/3.3.4/src/Utils/FileSystem.php)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Feasy-digital-downloads%2Feasy-digital-downloads-simple-ecommerce-for-selling-digital-files-333-authenticated-admin-phar-deserialization&t=Easy%20Digital%20Downloads%20%E2%80%93%20Simple%20eCommerce%20for%20Selling%20Digital%20Files%20%3C%3D%203.3.3%20-%20Authenticated%20%28Admin%2B%29%20PHAR%20Deserialization "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Feasy-digital-downloads%2Feasy-digital-downloads-simple-ecommerce-for-selling-digital-files-333-authenticated-admin-phar-deserialization&text=Easy%20Digital%20Downloads%20%E2%80%93%20Simple%20eCommerce%20for%20Selling%20Digital%20Files%20%3C%3D%203.3.3%20-%20Authenticated%20%28Admin%2B%29%20PHAR%20Deserialization "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Feasy-digital-downloads%2Feasy-digital-downloads-simple-ecommerce-for-selling-digital-files-333-authenticated-admin-phar-deserialization "LinkedIn")
Email

## Vulnerability Details for Easy Digital Downloads – eCommerce Payments and Subscriptions made easy

#### [Easy Digital Downloads – eCommerce Payments and Subscriptions made easy](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/easy-digital-downloads)

| Software Type | Plugin |
| --- | --- |
| Software Slug | easy-digital-downloads [(view on wordpress.org)](https://wordpress.org/plugins/easy-digital-downloads) |
| Patched? | Yes |
| Remediation | Update to version 3.3.4, or a newer patched version |
| Affected Version | * <= 3.3.3 |
| Patched Version | * 3.3.4 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


