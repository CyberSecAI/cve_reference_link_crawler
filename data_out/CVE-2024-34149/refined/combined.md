=== Content from github.com_564c099c_20250111_185432.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin%2Fpull%2F29769)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin%2Fpull%2F29769)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=bitcoin%2Fbitcoin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bitcoin](/bitcoin)
/
**[bitcoin](/bitcoin/bitcoin)**
Public

* [Notifications](/login?return_to=%2Fbitcoin%2Fbitcoin) You must be signed in to change notification settings
* [Fork
  36.5k](/login?return_to=%2Fbitcoin%2Fbitcoin)
* [Star
   81.3k](/login?return_to=%2Fbitcoin%2Fbitcoin)

* [Code](/bitcoin/bitcoin)
* [Issues
  374](/bitcoin/bitcoin/issues)
* [Pull requests
  313](/bitcoin/bitcoin/pulls)
* [Actions](/bitcoin/bitcoin/actions)
* [Projects
  5](/bitcoin/bitcoin/projects)
* [Security](/bitcoin/bitcoin/security)
* [Insights](/bitcoin/bitcoin/pulse)

Additional navigation options

* [Code](/bitcoin/bitcoin)
* [Issues](/bitcoin/bitcoin/issues)
* [Pull requests](/bitcoin/bitcoin/pulls)
* [Actions](/bitcoin/bitcoin/actions)
* [Projects](/bitcoin/bitcoin/projects)
* [Security](/bitcoin/bitcoin/security)
* [Insights](/bitcoin/bitcoin/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fbitcoin%2Fbitcoin%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fbitcoin%2Fbitcoin%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Policy: Enforce witness script size limit for tapscript #29769

 Closed

[luke-jr](/luke-jr)
wants to merge
1
commit into
[bitcoin:master](/bitcoin/bitcoin/tree/master "bitcoin/bitcoin:master")
from
[luke-jr:policy\_tapscript\_size](/luke-jr/bitcoin/tree/policy_tapscript_size "luke-jr/bitcoin:policy_tapscript_size")

 Closed

# [Policy: Enforce witness script size limit for tapscript](#top) #29769

[luke-jr](/luke-jr)
wants to merge
1
commit into
[bitcoin:master](/bitcoin/bitcoin/tree/master "bitcoin/bitcoin:master")
from
[luke-jr:policy\_tapscript\_size](/luke-jr/bitcoin/tree/policy_tapscript_size "luke-jr/bitcoin:policy_tapscript_size")

[Conversation
27](/bitcoin/bitcoin/pull/29769)
[Commits
1](/bitcoin/bitcoin/pull/29769/commits)
[Checks
16](/bitcoin/bitcoin/pull/29769/checks)
[Files changed](/bitcoin/bitcoin/pull/29769/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![luke-jr](https://avatars.githubusercontent.com/u/1095675?s=60&v=4)](/luke-jr)

Copy link

Member

### @luke-jr **[luke-jr](/luke-jr)** commented [Mar 30, 2024](#issue-2216640949)

Tapscript is missing the policy size limit check. The limit is inconsistent between witness and scriptSig, so for now this uses the (higher) witness size limit.

We should probably unify these on a single limit size (and make it configurable?), but for now this just addresses the oversight the same way it is for the other checks.

Sorry, something went wrong.

 üëç
11
 dani69654, ChrisMartl, Retropex, praveenperera, David-glitc, 22388o, 0300dbdd1b, Sun0fABeach, Conza88, maluquices, and crediblebytes reacted with thumbs up emoji
 üëé
1
 tzarebczan reacted with thumbs down emoji
 üòÑ
6
 larifortres, 1440000bytes, bitdeep, t4t5, otaliptus, and russeree reacted with laugh emoji

All reactions

* üëç
  11 reactions
* üëé
  1 reaction
* üòÑ
  6 reactions

[![@DrahtBot](https://avatars.githubusercontent.com/u/39886733?s=80&u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4)](/DrahtBot)

Copy link

Contributor

### **[DrahtBot](/DrahtBot)** commented [Mar 30, 2024](#issuecomment-2028452089) ‚Ä¢ edited Loading

|  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- |
| The following sections might be updated with supplementary metadata relevant to reviewers and maintainers. Code Coverage For detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29769). Reviews See [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.   | Type | Reviewers | | --- | --- | | Concept NACK | [vostrnad](https://github.com/bitcoin/bitcoin/pull/29769#issuecomment-2028607860), [Psifour](https://github.com/bitcoin/bitcoin/pull/29769#issuecomment-2028721361), [reardencode](https://github.com/bitcoin/bitcoin/pull/29769#issuecomment-2028798771), [russeree](https://github.com/bitcoin/bitcoin/pull/29769#issuecomment-2028895561), [petertodd](https://github.com/bitcoin/bitcoin/pull/29769#issuecomment-2028942771), [1440000bytes](https://github.com/bitcoin/bitcoin/pull/29769#issuecomment-2028979354), [sipa](https://github.com/bitcoin/bitcoin/pull/29769#issuecomment-2029843185) | | Concept ACK | [ChrisMartl](https://github.com/bitcoin/bitcoin/pull/29769#issuecomment-2028455656), [Retropex](https://github.com/bitcoin/bitcoin/pull/29769#pullrequestreview-1970054565), [nsvrn](https://github.com/bitcoin/bitcoin/pull/29769#issuecomment-2028847877) |   If your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update. |

All reactions

Sorry, something went wrong.

[![@DrahtBot](https://avatars.githubusercontent.com/u/39886733?s=40&u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4)](/DrahtBot)
[DrahtBot](/DrahtBot)
added
the
[TX fees and policy](/bitcoin/bitcoin/labels/TX%20fees%20and%20policy)
label
[Mar 30, 2024](#event-12301564365)

[![@ChrisMartl](https://avatars.githubusercontent.com/u/125733092?s=80&u=eb2819edcd5dbee98ba67a7d4bf63884c0e6a1bb&v=4)](/ChrisMartl)

Copy link

### **[ChrisMartl](/ChrisMartl)** commented [Mar 30, 2024](#issuecomment-2028455656) ‚Ä¢ edited Loading

| ACK  This policy should have been added with the SegWit V1 deployment. |
| --- |

 üëç
1
 Conza88 reacted with thumbs up emoji
 üëé
2
 tzarebczan and lylepratt reacted with thumbs down emoji

All reactions

* üëç
  1 reaction
* üëé
  2 reactions

Sorry, something went wrong.

[![Retropex](https://avatars.githubusercontent.com/u/74937347?s=60&v=4)](/Retropex)

**[Retropex](/Retropex)**
approved these changes
[Mar 30, 2024](#pullrequestreview-1970054565)

 [View reviewed changes](/bitcoin/bitcoin/pull/29769/files)

Copy link

### @Retropex **[Retropex](/Retropex)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

ACK, don't know why this has not been implemented with Taproot.

Sorry, something went wrong.

 üëç
4
 Conza88, ChrisMartl, Sun0fABeach, and crediblebytes reacted with thumbs up emoji
 üëé
3
 tzarebczan, earonesty, and lylepratt reacted with thumbs down emoji

All reactions

* üëç
  4 reactions
* üëé
  3 reactions

[![@DrahtBot](https://avatars.githubusercontent.com/u/39886733?s=40&u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4)](/DrahtBot)
[DrahtBot](/DrahtBot)
added
the
[CI failed](/bitcoin/bitcoin/labels/CI%20failed)
label
[Mar 30, 2024](#event-12301688629)

[![@luke-jr](https://avatars.githubusercontent.com/u/1095675?s=40&v=4)](/luke-jr)

`[Policy: Enforce witness script size limit for tapscript](/bitcoin/bitcoin/pull/29769/commits/f612a52b919470e7cceaffd9db577acfd97dc8e1 "Policy: Enforce witness script size limit for tapscript")`

`[f612a52](/bitcoin/bitcoin/pull/29769/commits/f612a52b919470e7cceaffd9db577acfd97dc8e1)`

 [![@luke-jr](https://avatars.githubusercontent.com/u/1095675?s=40&v=4)](/luke-jr)
[luke-jr](/luke-jr)
[force-pushed](/bitcoin/bitcoin/compare/8396747ca3b94d60a94bf81eba8134db15eb49c0..f612a52b919470e7cceaffd9db577acfd97dc8e1)
the
policy\_tapscript\_size

branch
from
[`8396747`](/bitcoin/bitcoin/commit/8396747ca3b94d60a94bf81eba8134db15eb49c0) to
[`f612a52`](/bitcoin/bitcoin/commit/f612a52b919470e7cceaffd9db577acfd97dc8e1)  [Compare](/bitcoin/bitcoin/compare/8396747ca3b94d60a94bf81eba8134db15eb49c0..f612a52b919470e7cceaffd9db577acfd97dc8e1)
[March 31, 2024 05:31](#event-12302394946)

[![@1440000bytes](https://avatars.githubusercontent.com/u/147166694?s=80&u=bdb6242ea068af2a8842bc8ab849f49700864700&v=4)](/1440000bytes)

Copy link

### **[1440000bytes](/1440000bytes)** commented [Mar 31, 2024](#issuecomment-2028606611)

| What is the goal of this pull request?  ACK, don't know why this has not been implemented with Taproot.  *Why is a limit on script size no longer needed? Since there is no scriptCode directly included in the signature hash (only indirectly through a precomputable tapleaf hash), the CPU time spent on a signature check is no longer proportional to the size of the script being executed.*  <https://github.com/bitcoin/bips/blob/master/bip-0342.mediawiki#resource-limits> |
| --- |

 üëç
5
 reardencode, rot13maxi, jlopp, aekasitt, and GregTonoski reacted with thumbs up emoji
 üëé
1
 GregTonoski reacted with thumbs down emoji

All reactions

* üëç
  5 reactions
* üëé
  1 reaction

Sorry, something went wrong.

[![@vostrnad](https://avatars.githubusercontent.com/u/43024885?s=80&u=63029aa255f1cc37fc06ae03551a3fceafe8da01&v=4)](/vostrnad)

Copy link

### **[vostrnad](/vostrnad)** commented [Mar 31, 2024](#issuecomment-2028607860)

| Concept NACK  The reason for the relaxed policy on tapscripts is that OP\_CHECKSIGADD multisig is no longer [limited to 20 public keys like OP\_CHECKMULTISIG](https://github.com/bitcoin/bitcoin/blob/61de64df6790077857faba84796bb874b59c5d15/src/script/interpreter.cpp#L1119), and is only [implicitly bound by the block weight limit](https://github.com/bitcoin/bips/blob/master/bip-0342.mediawiki#resource-limits) (and max tx weight by standardness rules). This has been discussed during the development of Taproot, there is no oversight, and the author knows this because he actively participated in those discussions.  As always, I recommend anyone proposing a change to Bitcoin Core's default policy to first start a thread on the mailing list. |
| --- |

 üëç
11
 earonesty, michaelfolkson, reardencode, nikicat, monlovesmango, ottosch, tzarebczan, delta1, aekasitt, glozow, and murchandamus reacted with thumbs up emoji

All reactions

* üëç
  11 reactions

Sorry, something went wrong.

[![@earonesty](https://avatars.githubusercontent.com/u/50769?s=80&v=4)](/earonesty)

Copy link

### **[earonesty](/earonesty)** commented [Mar 31, 2024](#issuecomment-2028688032)

| Concept NACK  The reason for the relaxed policy on tapscripts is that OP\_CHECKSIGADD multisig is no longer [limited to 20 public keys like OP\_CHECKMULTISIG](<https://github.com/bitcoin/bitcoin/blob/61de64df>  Maybe the policy can be added back with an account exception for multi-sig limits? |
| --- |

All reactions

Sorry, something went wrong.

[![@vostrnad](https://avatars.githubusercontent.com/u/43024885?s=80&u=63029aa255f1cc37fc06ae03551a3fceafe8da01&v=4)](/vostrnad)

Copy link

### **[vostrnad](/vostrnad)** commented [Mar 31, 2024](#issuecomment-2028717927)

| Maybe the policy can be added back with an account exception for multi-sig limits?  I don't know how you'd ensure that scripts that aren't pure multisig aren't affected, for example a multisig + time lock, and not have the policy be trivially bypassable at the same time.  In any case, this PR has the same goal as [#28408](https://github.com/bitcoin/bitcoin/pull/28408) (filtering inscriptions) and most NACKs from that PR apply here as well. |
| --- |

 üëç
1
 tzarebczan reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@Psifour](https://avatars.githubusercontent.com/u/6956441?s=80&u=9498b73fabae685d97398ad4b51a415c0c4d8fd4&v=4)](/Psifour)

Copy link

### **[Psifour](/Psifour)** commented [Mar 31, 2024](#issuecomment-2028721361) ‚Ä¢ edited Loading

| Concept NACK   * attempt to rehash [datacarriersize: Match more datacarrying¬†#28408](https://github.com/bitcoin/bitcoin/pull/28408) in different clothing * lacks context and/or fails to address why we should discard the previously agreed upon decision to NOT do this (we all forget past conversations at times so it is completely understandable) * attempts to expand an existing policy rule to cover a case where there is no technical reason to inhibit users   For further context please see (9) of the Rationale section of BIP342 which explains why the threat that this policy rule was created to mitigate doesn't apply to tapscript. |
| --- |

 üëç
9
 t4t5, cbspears, reardencode, jlopp, monlovesmango, tzarebczan, earonesty, AngusP, and lylepratt reacted with thumbs up emoji
 üëé
2
 Retropex and GregTonoski reacted with thumbs down emoji

All reactions

* üëç
  9 reactions
* üëé
  2 reactions

Sorry, something went wrong.

[![@Retropex](https://avatars.githubusercontent.com/u/74937347?s=80&u=ad4dbd917a6cad87ed371a07c59e690d10f4873a&v=4)](/Retropex)

Copy link

### **[Retropex](/Retropex)** commented [Mar 31, 2024](#issuecomment-2028742212)

| there is conflict of interests, i guess... [Capture d‚ÄôeÃÅcran 2024-03-31 aÃÄ 15 29 14](https://private-user-images.githubusercontent.com/74937347/318272687-7e5c9110-d833-44cd-a476-151f7b4f481e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MjE5NzAsIm5iZiI6MTczNjYyMTY3MCwicGF0aCI6Ii83NDkzNzM0Ny8zMTgyNzI2ODctN2U1YzkxMTAtZDgzMy00NGNkLWE0NzYtMTUxZjdiNGY0ODFlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE4NTQzMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTI0Y2M2ZjRjOGFlOTc1MTk4YzdhMWRjMWIwMDhkOTg5NjY0M2IyOWIxNDJmZGJiODQzZmQwMTNhNDM0OWE4MzYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.LTPnt5x4Ukizlh8n9iE5QCzzL5_MA222MMPAgaZasGI) |
| --- |

 üëç
8
 1ma, GregTonoski, Sun0fABeach, Bitcoin-Lebowski, maluquices, bilthon, crediblebytes, and Conza88 reacted with thumbs up emoji
 üëé
4
 cbspears, monlovesmango, tzarebczan, and AngusP reacted with thumbs down emoji

All reactions

* üëç
  8 reactions
* üëé
  4 reactions

Sorry, something went wrong.

[![@Retropex](https://avatars.githubusercontent.com/u/74937347?s=80&u=ad4dbd917a6cad87ed371a07c59e690d10f4873a&v=4)](/Retropex)

Copy link

### **[Retropex](/Retropex)** commented [Mar 31, 2024](#issuecomment-2028743892)

| Why is a limit on script size no longer needed? Since there is no scriptCode directly included in the signature hash (only indirectly through a precomputable tapleaf hash), the CPU time spent on a signature check is no longer proportional to the size of the script being executed.  This is clearly not enough to justify an abandonment of limits. It's as if Google was disabling gmail's anti-spam filters because the cost of processing an email is marginal on their servers. Makes literally no sense. |
| --- |

 üëç
4
 earonesty, Bitcoin-Lebowski, luke-jr, and Conza88 reacted with thumbs up emoji

All reactions

* üëç
  4 reactions

Sorry, something went wrong.

[![@Psifour](https://avatars.githubusercontent.com/u/6956441?s=80&u=9498b73fabae685d97398ad4b51a415c0c4d8fd4&v=4)](/Psifour)

Copy link

### **[Psifour](/Psifour)** commented [Mar 31, 2024](#issuecomment-2028753110) ‚Ä¢ edited Loading

| This is clearly not enough to justify an abandonment of limits.  This is not 'abandonment of limits'. The rule was created for a specific situation that presented a specific threat, SegWit (tapscript specifically) is outside the scope of that threat.  For reference as to how absurd this is, it would be like me proposing that we should apply the bare multi-sig limit (a policy rule created to address a specific threat) to all multisigs.  there is conflict of interests, i guess...  Thank you for acknowledging the work I put in. It has been a great experience of onboarding people to Bitcoin and helping hundreds of people get nodes setup. |
| --- |

 üëç
2
 tzarebczan and earonesty reacted with thumbs up emoji
 üëé
5
 Retropex, Bitcoin-Lebowski, crediblebytes, Conza88, and GregTonoski reacted with thumbs down emoji

All reactions

* üëç
  2 reactions
* üëé
  5 reactions

Sorry, something went wrong.

[![@reardencode](https://avatars.githubusercontent.com/u/730881?s=80&v=4)](/reardencode)

Copy link

### **[reardencode](/reardencode)** commented [Mar 31, 2024](#issuecomment-2028798771)

| Concept NACK  This limit was also removed to reduce the complexity of formal verification systems for script. The limit is no longer needed for the reasons already stated. |
| --- |

 üëç
3
 monlovesmango, delta1, and lylepratt reacted with thumbs up emoji
 üëé
3
 Retropex, Conza88, and GregTonoski reacted with thumbs down emoji

All reactions

* üëç
  3 reactions
* üëé
  3 reactions

Sorry, something went wrong.

[![@rot13maxi](https://avatars.githubusercontent.com/u/115941166?s=80&u=c3abac6d89accf04e4bac7d5406fee698579aae4&v=4)](/rot13maxi)

Copy link

### **[rot13maxi](/rot13maxi)** commented [Mar 31, 2024](#issuecomment-2028801265) ‚Ä¢ edited Loading

| People are trying to build applications and protocols that use large scripts (BitVM which is a generalized optimistic state channel, for example). We‚Äôve had an implicit policy on tapscripts since taproot was activated, which is the block size. In order to keep this from being a breaking change, if you want to add a new policy option, then the default should match current behavior. Users can choose to dial the limit downwards. |
| --- |

 üëç
5
 petertodd, tzarebczan, delta1, lylepratt, and lorenzolfm reacted with thumbs up emoji
 üëé
5
 GregTonoski, Conza88, Retropex, maluquices, and crediblebytes reacted with thumbs down emoji
 ‚ù§Ô∏è
4
 reardencode, russeree, tzarebczan, and lorenzolfm reacted with heart emoji

All reactions

* üëç
  5 reactions
* üëé
  5 reactions
* ‚ù§Ô∏è
  4 reactions

Sorry, something went wrong.

[![@nsvrn](https://avatars.githubusercontent.com/u/120062368?s=80&v=4)](/nsvrn)

Copy link

Contributor

### **[nsvrn](/nsvrn)** commented [Mar 31, 2024](#issuecomment-2028847877)

| Concept ACK  The only current use case that is abusing no-limit script is for filling the entire block with non-monetary transactions. The case for adding a limit strengthens further if the only other "future" no-limit use-case argument is coming from those with malicious intent of creating secondary markets for trading dust transactions. |
| --- |

 üëç
2
 Retropex and Conza88 reacted with thumbs up emoji
 üëé
1
 tzarebczan reacted with thumbs down emoji

All reactions

* üëç
  2 reactions
* üëé
  1 reaction

Sorry, something went wrong.

[![@russeree](https://avatars.githubusercontent.com/u/3104223?s=80&u=ea6d34e4f4edbbf6382c19248fb2df32273120bb&v=4)](/russeree)

Copy link

Contributor

### **[russeree](/russeree)** commented [Mar 31, 2024](#issuecomment-2028895561) ‚Ä¢ edited Loading

| Concept NACK, the implied size of the Taproot witness script is up to 4,000,000 weight units (bytes) via consensus rules. *A.k.a up to the size of a block.* There also already exists a second policy check on the size of these scripts which is up to 400,000 WU for the maximum transaction weight or 1/10th of a block. As an aside, I will likely be NACKing any PRs that attempt to further tighten relay policy for non CPU based DoS vectors as these endeavors now are causing actual fragmentation a somewhat consistent view across mempools.  In it's current state this change would make it hard for users to redeem their existing tap scripts that are larger your proposed limit.  In addition to this there are projects such as BitVM that do depend on large tap scripts to secure users funds. |
| --- |

 üëé
1
 GregTonoski reacted with thumbs down emoji

All reactions

* üëé
  1 reaction

Sorry, something went wrong.

[![@petertodd](https://avatars.githubusercontent.com/u/7042?s=80&u=57b50a05caa63fb86d8f910668719907e9ecf667&v=4)](/petertodd)

Copy link

Contributor

### **[petertodd](/petertodd)** commented [Mar 31, 2024](#issuecomment-2028942771)

| Concept NACK  I won't add this to Libre Relay. So it'll be yet another pointless change the profit maximizing miners ignore, rendering Bitcoin Core less useful out of the box. |
| --- |

 üëç
1
 lylepratt reacted with thumbs up emoji
 üëé
2
 maluquices and GregTonoski reacted with thumbs down emoji

All reactions

* üëç
  1 reaction
* üëé
  2 reactions

Sorry, something went wrong.

[![@1440000bytes](https://avatars.githubusercontent.com/u/147166694?s=80&u=bdb6242ea068af2a8842bc8ab849f49700864700&v=4)](/1440000bytes)

Copy link

### **[1440000bytes](/1440000bytes)** commented [Apr 1, 2024](#issuecomment-2028979354)

| Since PR author failed to answer the question about goal of this PR: [#29769 (comment)](https://github.com/bitcoin/bitcoin/pull/29769#issuecomment-2028606611)  Concept NACK  IIUC primary goal of this pull request is to educate everyone about taproot and some drama |
| --- |

 üëé
1
 GregTonoski reacted with thumbs down emoji

All reactions

* üëé
  1 reaction

Sorry, something went wrong.

[![@earonesty](https://avatars.githubusercontent.com/u/50769?s=80&v=4)](/earonesty)

Copy link

### **[earonesty](/earonesty)** commented [Apr 1, 2024](#issuecomment-2029733953)

| Concept NACK  I won't add this to Libre Relay. So it'll be yet another pointless change the profit maximizing miners ignore, rendering Bitcoin Core less useful out of the box.  So you're implying that the only reasonable limits are consensus changes and that relay level filtering doesn't matter |
| --- |

 üëç
1
 GregTonoski reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@petertodd](https://avatars.githubusercontent.com/u/7042?s=80&u=57b50a05caa63fb86d8f910668719907e9ecf667&v=4)](/petertodd)

Copy link

Contributor

### **[petertodd](/petertodd)** commented [Apr 1, 2024](#issuecomment-2029783889)

| So you're implying that the only reasonable limits are consensus changes and that relay level filtering doesn't matter  Basically yes. As long as there is non-trivial economic demand for a particular transaction form, trying to filter it will cause problems.  The only reasonable filters for for clear technical reasons. Eg the script version zero DoS attacks, bits reserved for soft-fork upgrades, etc. |
| --- |

 üëç
3
 vostrnad, lylepratt, and monlovesmango reacted with thumbs up emoji
 üëé
1
 GregTonoski reacted with thumbs down emoji
 üéâ
1
 reardencode reacted with hooray emoji

All reactions

* üëç
  3 reactions
* üëé
  1 reaction
* üéâ
  1 reaction

Sorry, something went wrong.

[![@sipa](https://avatars.githubusercontent.com/u/548488?s=80&u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4)](/sipa)

Copy link

Member

### **[sipa](/sipa)** commented [Apr 1, 2024](#issuecomment-2029843185)

| Concept NACK. This is not an oversight, and a step backwards.  The reason for having this type of policy rule in earlier Script version environments is to discourage constructs that suffer from DoS concerns in the interpreter (known and unknown). For BIP342 we carefully analyzed any sources of non-linear scaling effects such as the amount of data hashed, and data structure growth:   * some were addressed   + quadratic hashing through an O(1) hashing scheme, see [BIP341 fn15](https://github.com/bitcoin/bips/blob/master/bip-0341.mediawiki#cite_note-15)   + execution stack growth which was addressed in [O(1) OP\_IF/NOTIF/ELSE/ENDIF script implementation¬†#16902](https://github.com/bitcoin/bitcoin/pull/16902) * others have remaining consensus rules to curb their impact (the 1000 stack element limit remains in [BIP342](https://github.com/bitcoin/bips/blob/master/bip-0342.mediawiki#resource-limits), as e.g. the cost of OP\_ROT scales with the stack size).   It is of course possible there are oversights, and those might warrant measures to address them, but absent such concerns, I don't think this applies.  My belief that most proponents of this change however see this as a way to reduce unwanted on-chain data storage. While there is certainly a ton of data that I personally consider unwanted (and frankly, dumb), I don't believe this will address that:   * Given the clear economic demand for this data (for better or worse), the best a policy rule can do is provide a mild inconvenience. The worst it can do is cause the development of mempool-bypassing transaction relay rails to miners, which I consider far more harmful in the long term that any current hype. * The specific change here might not even do that, as it's only a tiny marginal cost to satisfy the policy (split things across multiple inputs, or use other mechanisms). * The justification that once existed for data-filtering policies just doesn't apply anymore. Before organic transaction demand was sufficient to fill blocks, I think it was quite reasonable to discourage applications from freeloading on the unused space, as it actively increased resource costs for fully validating nodes of the nascent ecosystem. Today, unwanted data or not, blocks are full anyway, and the cost to validating nodes in the same.   In short, my view is that on-chain data storage is inherent to having a flexible scripting system, and ultimately Bitcoin already has a mitigation to bound its impact on validators: the block weight limit. |
| --- |

 üëç
15
 reardencode, michaelfolkson, lylepratt, ursuscamp, monlovesmango, vostrnad, Rob1Ham, ajtowns, darosior, glozow, and 5 more reacted with thumbs up emoji
 üëé
1
 GregTonoski reacted with thumbs down emoji

All reactions

* üëç
  15 reactions
* üëé
  1 reaction

Sorry, something went wrong.

[![@lorenzolfm](https://avatars.githubusercontent.com/u/38786333?s=40&v=4)](/lorenzolfm)
[lorenzolfm](/lorenzolfm)
mentioned this pull request
[Apr 1, 2024](#ref-issue-2218578118)

[Topicos Abril 2024
saopaulobitdevs/saopaulobitdevs.org#23](/saopaulobitdevs/saopaulobitdevs.org/issues/23)

Closed

[![@glozow](https://avatars.githubusercontent.com/u/25183001?s=40&u=300ffe27f349299862614f00df51cc1e07fe07d1&v=4)](/glozow)
[glozow](/glozow)
closed this
[Apr 2, 2024](#event-12321846506)

[![ajtowns](https://avatars.githubusercontent.com/u/127186?s=60&v=4)](/ajtowns)

**[ajtowns](/ajtowns)**
reviewed
[Apr 2, 2024](#pullrequestreview-1973164513)

 [View reviewed changes](/bitcoin/bitcoin/pull/29769/files/f612a52b919470e7cceaffd9db577acfd97dc8e1)

[test/functional/wallet\_miniscript.py](/bitcoin/bitcoin/pull/29769/files/f612a52b919470e7cceaffd9db577acfd97dc8e1#diff-35a0ff768d0d9845eeac1bed96db5f5a221e63b8aff5843a1d6a25ffc7adb5cc)

|  |  | @@ -208,6 +208,7 @@ def add\_options(self, parser): | |
| --- | --- | --- | --- |
|  |  |  |
|  |  | def set\_test\_params(self): |
|  |  | self.num\_nodes = 1 |
|  |  | self.extra\_args = [["-acceptnonstdtxn"]] |

Copy link

Contributor

### @ajtowns **[ajtowns](/ajtowns)** [Apr 2, 2024](#discussion_r1547487513)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Just want to add: even if this change were a good idea, changing the wallet tests to allow non standard txs in the mempool is a terrible idea.

The point of wallet tests is to check that we actually can create and spend payments to addresses we support. If any of those addresses aren't acceptable to our own mempool by default, that's a bug, and it shouldn't be hidden in this way. If we're deliberately making some addresses unspendable with a default config despite having previously supported them, that should be addressed by explicitly removing those classes of addresses from the test cases.

Sorry, something went wrong.

 üëç
4
 maflcko, sipa, murchandamus, and glozow reacted with thumbs up emoji

All reactions

* üëç
  4 reactions

[![@luke-jr](https://avatars.githubusercontent.com/u/1095675?s=80&v=4)](/luke-jr)

Copy link

Member

Author

### **[luke-jr](/luke-jr)** commented [Apr 20, 2024](#issuecomment-2067767242)

| Many people here conflating consensus (as modified by BIPs) with spam filters/policy. The reason why it's reasonable to relax consensus rules is in a large part *because* spam is mitigated by policy. If policy is to be discarded, we will need to impose all these limits strictly in consensus - that has not been proposed, and as such, reasonable policies must be maintained until it is. You can't just throw out an important security check without replacing it by something else!  Taproot's purpose was to make it so scripts could be omitted on-chain entirely (all parties verify the script passes, and sign the keypath instead), not to make for unlimited on-chain spamming.  I will likely be NACKing any PRs that attempt to further tighten relay policy for non CPU based DoS vectors as these endeavors now are causing actual fragmentation a somewhat consistent view across mempools.  [@russeree](https://github.com/russeree) Mempools are not SUPPOSED to be consistent in the first place.  This is not an oversight, and a step backwards.  If it is not an oversight, then you're saying it was intentionally snuck in behind the Bitcoin community's backs. There was no discussion of removing spam filters, and no consensus to do so. The very idea is absurd and would never have gained support.  [@glozow](https://github.com/glozow) Why did you abuse your repo access to inappropriately close this PR? |
| --- |

 üëç
10
 Sun0fABeach, Retropex, nsvrn, BitcoinMechanic, maluquices, OminousPeace, crediblebytes, psychoet, Conza88, and GregTonoski reacted with thumbs up emoji

All reactions

* üëç
  10 reactions

Sorry, something went wrong.

[![@glozow](https://avatars.githubusercontent.com/u/25183001?s=80&u=300ffe27f349299862614f00df51cc1e07fe07d1&v=4)](/glozow)

Copy link

Member

### **[glozow](/glozow)** commented [May 2, 2024](#issuecomment-2090895336)

| The decision to close this PR was primarily based on the well-reasoned NACKs. Based on the technical arguments given by you and the reviewers, it is clear that the PR isn't a good idea or is at least very controversial. Changes to transaction relay policy that can impact people beyond the node operator should be discussed in the broader community beyond just Bitcoin Core. For example, I'd recommend starting a thread on the mailing list or Delving Bitcoin.  If you disagree and believe it was closed unfairly, I think it would be appropriate to bring this up to the larger group during the weekly irc meeting. I would be happy to re-open this PR if it seems that actually this has strong technical motivation, is more accepted by the community, and/or is determined to have been closed unfairly. |
| --- |

 üëç
3
 stickies-v, monlovesmango, and theStack reacted with thumbs up emoji
 üëé
1
 luke-jr reacted with thumbs down emoji

All reactions

* üëç
  3 reactions
* üëé
  1 reaction

Sorry, something went wrong.

[![@GregTonoski](https://avatars.githubusercontent.com/u/111286121?s=80&u=fe75b1197a431b21e74e8d23b17075c00151f815&v=4)](/GregTonoski)

Copy link

### **[GregTonoski](/GregTonoski)** commented [May 19, 2024](#issuecomment-2119182536) ‚Ä¢ edited Loading

| Can I ask [@glozow](https://github.com/glozow) to summarize cons, please? I couldn't find any in spite of huge amount of text in the comments. The PR does not introduce a "breaking change" contrary to what is claimed by opponents. |
| --- |

All reactions

Sorry, something went wrong.

[![@Psifour](https://avatars.githubusercontent.com/u/6956441?s=80&u=9498b73fabae685d97398ad4b51a415c0c4d8fd4&v=4)](/Psifour)

Copy link

### **[Psifour](/Psifour)** commented [May 19, 2024](#issuecomment-2119197600)

| You are asking the wrong question, instead it should be framed as "what technical threat is posed and is said threat sufficient to warrant the creation of a new standardness rule?" The answers to those questions are "none" and subsequently "no".  Applying rules meant to solve a specific problem to systems that can't/don't exhibit the same vulnerabilities would be wildly inappropriate. It would be similar to applying the bare multi-sig limit (3) to ALL multisigs.  TL;DR: The PR attempts to solve a non-issue with sub-par engineering. Luckily the standard for core is slightly hire than "isn't a breaking change". |
| --- |

 üëç
1
 monlovesmango reacted with thumbs up emoji
 üëé
2
 Retropex and GregTonoski reacted with thumbs down emoji

All reactions

* üëç
  1 reaction
* üëé
  2 reactions

Sorry, something went wrong.

[![@GregTonoski](https://avatars.githubusercontent.com/u/111286121?s=80&u=fe75b1197a431b21e74e8d23b17075c00151f815&v=4)](/GregTonoski)

Copy link

### **[GregTonoski](/GregTonoski)** commented [May 19, 2024](#issuecomment-2119239759) ‚Ä¢ edited Loading

| ... policy rule in earlier Script version environments is to discourage constructs that suffer from DoS concerns in the interpreter (known and unknown) (...) It is of course possible there are oversights...  Can I ask to point to test results of the change introduced in TapRoot (relaxation of the 3600 bytes script size standard limit/mempool policy rule which is not described in BIPs), please? |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin%2Fpull%2F29769)

Reviewers

[![@ajtowns](https://avatars.githubusercontent.com/u/127186?s=40&v=4)](/ajtowns) [ajtowns](/ajtowns)

ajtowns left review comments

[![@Retropex](https://avatars.githubusercontent.com/u/74937347?s=40&v=4)](/Retropex) [Retropex](/Retropex)

Retropex approved these changes

Assignees

No one assigned

Labels

[CI failed](/bitcoin/bitcoin/labels/CI%20failed)
[TX fees and policy](/bitcoin/bitcoin/labels/TX%20fees%20and%20policy)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

17 participants

[![@luke-jr](https://avatars.githubusercontent.com/u/1095675?s=52&v=4)](/luke-jr) [![@DrahtBot](https://avatars.githubusercontent.com/u/39886733?s=52&v=4)](/DrahtBot) [![@ChrisMartl](https://avatars.githubusercontent.com/u/125733092?s=52&v=4)](/ChrisMartl) [![@1440000bytes](https://avatars.githubusercontent.com/u/147166694?s=52&v=4)](/1440000bytes) [![@vostrnad](https://avatars.githubusercontent.com/u/43024885?s=52&v=4)](/vostrnad) [![@earonesty](https://avatars.githubusercontent.com/u/50769?s=52&v=4)](/earonesty) [![@Psifour](https://avatars.githubusercontent.com/u/6956441?s=52&v=4)](/Psifour) [![@Retropex](https://avatars.githubusercontent.com/u/74937347?s=52&v=4)](/Retropex) [![@reardencode](https://avatars.githubusercontent.com/u/730881?s=52&v=4)](/reardencode) [![@rot13maxi](https://avatars.githubusercontent.com/u/115941166?s=52&v=4)](/rot13maxi) [![@nsvrn](https://avatars.githubusercontent.com/u/120062368?s=52&v=4)](/nsvrn) [![@russeree](https://avatars.githubusercontent.com/u/3104223?s=52&v=4)](/russeree) [![@petertodd](https://avatars.githubusercontent.com/u/7042?s=52&v=4)](/petertodd) [![@sipa](https://avatars.githubusercontent.com/u/548488?s=52&v=4)](/sipa) [![@glozow](https://avatars.githubusercontent.com/u/25183001?s=52&v=4)](/glozow) [![@GregTonoski](https://avatars.githubusercontent.com/u/111286121?s=52&v=4)](/GregTonoski) [![@ajtowns](https://avatars.githubusercontent.com/u/127186?s=52&v=4)](/ajtowns)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


