<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>src/usr.sbin/smtpd/envelope.c - diff - 1.50.4.1</title>
<style type="text/css">
.diff-heading {
  background-color: #99cccc;
}
.diff-same {
  font-family: Helvetica,Arial;
  font-size: smaller;
}
.diff-empty {
  background-color: #cccccc;
}
.diff-added {
  background-color: #ccccff;
  font-family: Helvetica,Arial;
  font-size: smaller;
}
.diff-removed {
  background-color: #ff9999;
  font-family: Helvetica,Arial;
  font-size: smaller;
}
.diff-changed {
  background-color: #99ff99;
  font-family: Helvetica,Arial;
  font-size: smaller;
}
.diff-changed-missing {
  background-color: #99cc99;
}
</style>
<meta name="robots" content="nofollow">
<meta name="generator" content="OpenBSD-CVSweb 2.0.6">
<meta name="description" content="OpenBSD source via CVSweb">
<meta name="keywords" content="openbsd,cvs,source,cvsweb">
<meta name="distribution" content="global">
<meta name="copyright" content="content copyright 2014 by OpenBSD.">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="Content-Style-Type" content="text/css">
</head>
<body text="#000000" bgcolor="#eeeeee">
<table width="100%" style="border: none; background-color: #9999ee" cellspacing="0" cellpadding="1">
<tr valign="bottom"><td>
<a href="/cgi-bin/cvsweb/src/usr.sbin/smtpd/envelope.c?f=h#rev1.50.4.1"><img src="/icons/back.gif" alt="[BACK]" border="0" width="20" height="22"></a><b>Return to <a href="/cgi-bin/cvsweb/src/usr.sbin/smtpd/envelope.c?f=h#rev1.50.4.1">envelope.c</a> CVS log</b> <img src="/icons/text.gif" alt="[TXT]" border="0" width="20" height="22"></td><td align="right"><img src="/icons/dir.gif" alt="[DIR]" border="0" width="20" height="22"> <b>Up to  <a href="/cgi-bin/cvsweb/?f=h#dirlist">[local]</a> / <a href="/cgi-bin/cvsweb/src/?f=h#dirlist">src</a> / <a href="/cgi-bin/cvsweb/src/usr.sbin/?f=h#dirlist">usr.sbin</a> / <a href="/cgi-bin/cvsweb/src/usr.sbin/smtpd/?f=h#dirlist">smtpd</a></b></td></tr></table><h3 style="text-align: center">Diff for /src/usr.sbin/smtpd/envelope.c between version 1.50 and 1.50.4.1</h3>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr style="background-color: #ffffff">
<th width="50%" valign="top">version 1.50, 2022/09/24 17:08:32</th>
<th width="50%" valign="top">version 1.50.4.1, 2023/02/07 15:50:30</th>
<tr class="diff-heading">
<td width="50%"><table width="100%" border="1" cellpadding="5">
<tr>
<td><b>Line&nbsp;270</b>&nbsp;<span style="font-size: smaller"></span></td>
</tr>
</table></td>
<td width="50%"><table width="100%" border="1" cellpadding="5">
<tr>
<td><b>Line&nbsp;270</b>&nbsp;<span style="font-size: smaller"></span></td>
</tr>
</table>
</td>
<tr>
<td class="diff-same">&nbsp;static int</td>
<td class="diff-same">&nbsp;static int</td>
</tr>
<tr>
<td class="diff-same">&nbsp;ascii_load_sockaddr(struct sockaddr_storage *ss, char *buf)</td>
<td class="diff-same">&nbsp;ascii_load_sockaddr(struct sockaddr_storage *ss, char *buf)</td>
</tr>
<tr>
<td class="diff-same">&nbsp;{</td>
<td class="diff-same">&nbsp;{</td>
</tr>
<tr>
<td class="diff-removed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;struct sockaddr_in6 ssin6;</td>
<td class="diff-empty">&nbsp;</td>
</tr>
<tr>
<td class="diff-removed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;struct sockaddr_in &nbsp;ssin;</td>
<td class="diff-empty">&nbsp;</td>
</tr>
<tr>
<td class="diff-removed">&nbsp;</td>
<td class="diff-empty">&nbsp;</td>
</tr>
<tr>
<td class="diff-removed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memset(&amp;ssin, 0, sizeof ssin);</td>
<td class="diff-empty">&nbsp;</td>
</tr>
<tr>
<td class="diff-removed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memset(&amp;ssin6, 0, sizeof ssin6);</td>
<td class="diff-empty">&nbsp;</td>
</tr>
<tr>
<td class="diff-removed">&nbsp;</td>
<td class="diff-empty">&nbsp;</td>
</tr>
<tr>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!strcmp(&quot;local&quot;, buf)) {</td>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!strcmp(&quot;local&quot;, buf)) {</td>
</tr>
<tr>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ss-&gt;ss_family = AF_LOCAL;</td>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ss-&gt;ss_family = AF_LOCAL;</td>
</tr>
<tr>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</td>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</td>
</tr>
<tr>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else if (buf[0] == '[' &amp;&amp; buf[strlen(buf)-1] == ']') {</td>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else if (buf[0] == '[' &amp;&amp; buf[strlen(buf)-1] == ']') {</td>
</tr>
<tr>
<td class="diff-empty">&nbsp;</td>
<td class="diff-added">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;struct addrinfo hints, *res0;</td>
</tr>
<tr>
<td class="diff-empty">&nbsp;</td>
<td class="diff-added">&nbsp;</td>
</tr>
<tr>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;buf[strlen(buf)-1] = '\0';</td>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;buf[strlen(buf)-1] = '\0';</td>
</tr>
<tr>
<td class="diff-changed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (inet_pton(AF_INET6, buf+1, &amp;ssin6.sin6_addr) != 1)</td>
<td class="diff-changed">&nbsp;</td>
</tr>
<tr>
<td class="diff-changed-missing">&nbsp;</td>
<td class="diff-changed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* getaddrinfo() is used to support scoped addresses. */</td>
</tr>
<tr>
<td class="diff-changed-missing">&nbsp;</td>
<td class="diff-changed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memset(&amp;hints, 0, sizeof(hints));</td>
</tr>
<tr>
<td class="diff-changed-missing">&nbsp;</td>
<td class="diff-changed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hints.ai_family = AF_INET6;</td>
</tr>
<tr>
<td class="diff-changed-missing">&nbsp;</td>
<td class="diff-changed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hints.ai_flags = AI_NUMERICHOST;</td>
</tr>
<tr>
<td class="diff-changed-missing">&nbsp;</td>
<td class="diff-changed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (getaddrinfo(buf+1, NULL, &amp;hints, &amp;res0) != 0)</td>
</tr>
<tr>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return 0;</td>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return 0;</td>
</tr>
<tr>
<td class="diff-changed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ssin6.sin6_family = AF_INET6;</td>
<td class="diff-changed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memcpy(ss, res0-&gt;ai_addr, res0-&gt;ai_addrlen);</td>
</tr>
<tr>
<td class="diff-changed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memcpy(ss, &amp;ssin6, sizeof(ssin6));</td>
<td class="diff-changed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ss-&gt;ss_len = res0-&gt;ai_addrlen;</td>
</tr>
<tr>
<td class="diff-changed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ss-&gt;ss_len = sizeof(struct sockaddr_in6);</td>
<td class="diff-changed">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;freeaddrinfo(res0);</td>
</tr>
<tr>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</td>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</td>
</tr>
<tr>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else {</td>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else {</td>
</tr>
<tr>
<td class="diff-empty">&nbsp;</td>
<td class="diff-added">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;struct sockaddr_in ssin;</td>
</tr>
<tr>
<td class="diff-empty">&nbsp;</td>
<td class="diff-added">&nbsp;</td>
</tr>
<tr>
<td class="diff-empty">&nbsp;</td>
<td class="diff-added">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memset(&amp;ssin, 0, sizeof ssin);</td>
</tr>
<tr>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (inet_pton(AF_INET, buf, &amp;ssin.sin_addr) != 1)</td>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (inet_pton(AF_INET, buf, &amp;ssin.sin_addr) != 1)</td>
</tr>
<tr>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return 0;</td>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return 0;</td>
</tr>
<tr>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ssin.sin_family = AF_INET;</td>
<td class="diff-same">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ssin.sin_family = AF_INET;</td>
</tr>
</table>
<hr style="width: 100%" noshade>
<form method="get" action="/cgi-bin/cvsweb/src/usr.sbin/smtpd/envelope.c.diff">
<table style="border: none">
<tr>
<td>
<table border="1">
<tr>
<td>Legend:<br><table style="border: none" cellspacing="0" cellpadding="1">
<tr>
<td align="center" class="diff-removed">Removed from v.1.50</td>
<td class="diff-empty">&nbsp;</td>
</tr>
<tr class="diff-changed">
<td align="center" colspan="2">changed lines</td>
</tr>
<tr>
<td class="diff-empty">&nbsp;</td>
<td align="center" class="diff-added">Added in v.1.50.4.1</td>
</tr>
</table>
</td>
</tr>
</table>
</td>
<td><input type="hidden" name="r1" value="1.50">
<input type="hidden" name="r2" value="1.50.4.1">
<select id="f" name="f" onchange="this.form.submit()">
<option value="h" selected>Colored</option>
<option value="H">Long colored</option>
<option value="u">Unified</option>
<option value="c">Context</option>
</select><input type="submit" value="Show">
</td>
</tr>
</table>
</form>
</body>
</html>
