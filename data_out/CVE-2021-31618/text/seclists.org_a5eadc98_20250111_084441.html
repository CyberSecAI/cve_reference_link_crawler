
[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](205)
[By Date](date.html#206)
[![Next](/images/right-icon-16x16.png)](207)

[![Previous](/images/left-icon-16x16.png)](205)
[By Thread](index.html#206)
[![Next](/images/right-icon-16x16.png)](212)

![](/shared/images/nst-icons.svg#search)

# CVE-2021-31618: Apache httpd: NULL pointer dereference on specially crafted HTTP/2 request

---

*From*: Christophe JAILLET <jailletc36 () apache org>

*Date*: Wed, 09 Jun 2021 23:11:00 +0200

---

```

CVE-2021-31618: NULL pointer dereference on specially crafted HTTP/2 request

Severity: important

Vendor: The Apache Software Foundation

Versions Affected:
2.4.47
httpd
Description:
Apache HTTP Server 2.4.47
Apache HTTP Server protocol handler for the HTTP/2 protocol checks received request headers against the size
limitations as configured for the server and used for the HTTP/1 protocol as well. On violation of these restrictions
and HTTP response is sent to the client with a status code indicating why the request was rejected.

This rejection response was not fully initialised in the HTTP/2 protocol handler if the offending header was the very
first one received or appeared in a a footer. This led to a NULL pointer dereference on initialised memory, crashing
reliably the child process. Since such a triggering HTTP/2 request is easy to craft and submit, this can be exploited
to DoS the server.

This affected versions prior to 2.4.47

Mitigation:
none

Credit:
Apache HTTP server would like to thank  LI ZHI XIN from NSFocus for reporting this.

References:
<https://httpd.apache.org/security/vulnerabilities_24.html>

```

---

[![Previous](/images/left-icon-16x16.png)](205)
[By Date](date.html#206)
[![Next](/images/right-icon-16x16.png)](207)

[![Previous](/images/left-icon-16x16.png)](205)
[By Thread](index.html#206)
[![Next](/images/right-icon-16x16.png)](212)

### Current thread:

* **CVE-2021-31618: Apache httpd: NULL pointer dereference on specially crafted HTTP/2 request** *Christophe JAILLET (Jun 10)*
  + [Re: CVE-2021-31618: Apache httpd: NULL pointer dereference on specially crafted HTTP/2 request](212) *John Helmert III (Jun 10)*
    - [Re: CVE-2021-31618: Apache httpd: NULL pointer dereference on specially crafted HTTP/2 request](213) *Christophe JAILLET (Jun 10)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")

