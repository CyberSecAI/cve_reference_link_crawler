

[Skip to main content](#content)

[Menu](#mobile-menu)

* Products
   Back
  + [Security](https://jetpack.com/features/security/)
    - [VaultPress Backup](https://jetpack.com/upgrade/backup/)
    - [Scan](https://jetpack.com/upgrade/scan/)
    - [Akismet Anti-spam](https://jetpack.com/upgrade/anti-spam/)
  + [Performance](https://jetpack.com/features/performance/)
    - [Site Search](https://jetpack.com/upgrade/search/)
    - [Boost](https://jetpack.com/boost/)
    - [VideoPress](https://jetpack.com/videopress/)
  + [Growth](https://jetpack.com/features/growth/)
    - [Stats](https://jetpack.com/stats/)
    - [Social](https://jetpack.com/social/)
    - [Blaze](https://jetpack.com/blaze/)
  + [Management](https://jetpack.com/pro-dashboard/)
    - [For Agencies](https://jetpack.com/for-agencies/)
    - [CRM](https://jetpackcrm.com/?utm_medium=automattic_referred&utm_source=jpcom_header)
    - [Mobile app](https://jetpack.com/mobile/)
  + [Create](https://jetpack.com/ai/)
    - [AI Assistant](https://jetpack.com/ai/)

  Product Bundles

  + [Complete

    VaultPress Backup

    Akismet Anti-Spam

    Scan

    Search

    Social

    VideoPress

    Boost

    CRM](https://jetpack.com/complete/)
  + [Security

    VaultPress Backup

    Akismet Anti-Spam

    Scan](https://jetpack.com/features/security/)
  + [Growth

    Stats

    Social

    Newsletter](https://jetpack.com/features/growth/)
* [Pricing](https://jetpack.com/pricing/)
* [Partners](https://jetpack.com/jetpack-partners/)
* [Support](https://jetpack.com/support/)
* [Blog](https://jetpack.com/blog/)
* More

* [Search](/?s=)
* [Log in](https://jetpack.com/login/)
* [Get started](https://jetpack.com/pricing/)

![](https://jetpack.com/wp-content/uploads/2021/01/jetpack-blog-malware-header-6.jpg?w=850)
# Severe Vulnerability Fixed In UpdraftPlus 1.22.3

Updated on February 17, 2022 - Marc Montpas

During an internal audit of [the UpdraftPlus plugin](https://wordpress.org/plugins/updraftplus/), we uncovered an arbitrary backup download vulnerability that could allow low-privileged users like subscribers to download a site’s latest backups.

If exploited, the vulnerability could grant attackers access to privileged information from the affected site’s database (e.g., usernames and hashed passwords).

We reported the vulnerability to the plugin’s authors, and they recently released version 1.22.3 to address it. Forced auto-updates have also been pushed due to the severity of this issue. If your site hasn’t already, we strongly recommend that you update to the latest version (1.22.3) and have an established security solution on your site, such as [Jetpack Security](https://jetpack.com/features/security/).

You can find [UpdraftPlus’ own advisory here](https://updraftplus.com/updraftplus-security-release-1-22-3-2-22-3/).

## Details

Plugin Name: UpdraftPlus
Plugin URI: <https://wordpress.org/plugins/updraftplus/>
Author: <https://updraftplus.com/>

## The Vulnerability

### Arbitrary Backup Downloads

**Affected versions:** Every version between 1.16.7 and 1.22.3 (Free version), and
**CVE-ID:** [CVE-20](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0633)[2](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0633)[2-0633](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0633)
**WPVDB ID:** [d257c28f-3c7e-422b-a5c2-e618ed3c0bf3](https://wpscan.com/vulnerability/d257c28f-3c7e-422b-a5c2-e618ed3c0bf3)
**CVSSv3.1:** [8.5](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N)
**CWSS:** [87.6](https://www.cwss-score.info/#TI:H,0.9/AP:NA,1/AL:NA,1/IC:NA,1.0/FC:T,1/RP:L,0.9/RL:NA,1/AV:NA,1/AS:NA,1/IN:A,1/SC:M,0.9/BI:H,0.9/DI:H,1/EX:H,1/EC:NA,1/P:NA,1/)

The plugin [uses custom “nonces”](https://plugins.trac.wordpress.org/browser/updraftplus/tags/1.22.1/class-updraftplus.php#L802) and timestamps to securely identify backups. Given the knowledge of said nonce and timestamp can give someone access to quite a few of the plugin’s features, making sure this info is only accessible to those who legitimately need it is crucial.

Unfortunately, as we’ll demonstrate, it wasn’t the case.

#### Nonce Leak

The first culprit was located on the UpdraftPlus\_Admin::process\_status\_in\_heartbeatmethod.

```

	/**
	 * Receive Heartbeat data and respond.
	 *
	 * Processes data received via a Heartbeat request, and returns additional data to pass back to the front end.
	 *
	 * @param array $response - Heartbeat response data to pass back to front end.
	 * @param array $data     - Data received from the front end (unslashed).
	 */
	public function process_status_in_heartbeat($response, $data) {
		if (!is_array($response) || empty($data['updraftplus'])) return $response;
		try {
			$response['updraftplus'] = $this->get_activejobs_list(UpdraftPlus_Manipulation_Functions::wp_unslash($data['updraftplus']));
		} catch (Exception $e) {
			$log_message = 'PHP Fatal Exception error ('.get_class($e).') has occurred during get active job list. Error Message: '.$e->getMessage().' (Code: '.$e->getCode().', line '.$e->getLine().' in '.$e->getFile().')';
			error_log($log_message);
			$response['updraftplus'] = array(
				'fatal_error' => true,
				'fatal_error_message' => $log_message
			);
		// @codingStandardsIgnoreLine
		} catch (Error $e) {
			$log_message = 'PHP Fatal error ('.get_class($e).') has occurred during get active job list. Error Message: '.$e->getMessage().' (Code: '.$e->getCode().', line '.$e->getLine().' in '.$e->getFile().')';
			error_log($log_message);
			$response['updraftplus'] = array(
				'fatal_error' => true,
				'fatal_error_message' => $log_message
			);
		}

		if (UpdraftPlus_Options::user_can_manage() && isset($data['updraftplus']['updraft_credentialtest_nonce'])) {
			if (!wp_verify_nonce($data['updraftplus']['updraft_credentialtest_nonce'], 'updraftplus-credentialtest-nonce')) {
				$response['updraftplus']['updraft_credentialtest_nonce'] = wp_create_nonce('updraftplus-credentialtest-nonce');
			}
		}

		$response['updraftplus']['time_now'] = get_date_from_gmt(gmdate('Y-m-d H:i:s'), 'D, F j, Y H:i');

		return $response;
	}

```

It did not properly ensure that the user sending this heartbeat request was an administrator (e.g. via functions like [current\_user\_can](https://developer.wordpress.org/reference/functions/current_user_can/)), which was a problem since the first thing this function tries to do is grab the list of active backup jobs via the **get\_activejobs\_list** method.

An attacker could thus craft a malicious request targeting this heartbeat callback to get access to information about the site’s latest backup to date, which will among other things contain a backup’s nonce.

Explore the benefits of Jetpack

Learn how Jetpack can help you protect, speed up, and grow your WordPress site. [Get up to 53% off your first year.](https://jetpack.com/pricing/)

[Explore plans](https://jetpack.com/pricing/)

Have a question?

Comments are closed for this article, but we're still here to help! Visit the support forum and we'll be happy to answer any questions.

[View support forum](https://wordpress.org/support/plugin/jetpack/)

- Search
- Enter your email address to receive news and updates from Jetpack
- Type your email…

  Subscribe

  Join 113K other subscribers
- ### Browse by Topic

  * [AI](https://jetpack.com/blog/category/ai/) (2)
  * [Analytics](https://jetpack.com/blog/category/analytics/) (20)
  * [Code snippets](https://jetpack.com/blog/category/developers/code-snippets/) (32)
  * [Contribute](https://jetpack.com/blog/category/contribute-2/) (6)
  * [Customer stories](https://jetpack.com/blog/category/customer-stories/) (6)
  * [Developers](https://jetpack.com/blog/category/developers/) (3)
  * [Ecommerce](https://jetpack.com/blog/category/ecommerce/) (18)
  * [Events](https://jetpack.com/blog/category/events/) (6)
  * [Features](https://jetpack.com/blog/category/features/) (69)
  * [Grow](https://jetpack.com/blog/category/grow/) (35)
  * [Hosting](https://jetpack.com/blog/category/hosting/) (7)
  * [Innovate](https://jetpack.com/blog/category/innovate/) (7)
  * [Jetpack News](https://jetpack.com/blog/category/jetpack-news/) (77)
  * [Learn](https://jetpack.com/blog/category/learn/) (117)
  * [Meet Jetpack](https://jetpack.com/blog/category/meet-jetpack/) (15)
  * [Mobile](https://jetpack.com/blog/category/mobile/) (1)
  * [Performance](https://jetpack.com/blog/category/performance/) (50)
  * [Photos & Videos](https://jetpack.com/blog/category/photos-videos/) (14)
  * [Promotions](https://jetpack.com/blog/category/promotions/) (2)
  * [Releases](https://jetpack.com/blog/category/releases/) (189)
  * [Scan](https://jetpack.com/blog/category/scan/) (2)
  * [Search Engine Optimization](https://jetpack.com/blog/category/search-engine-optimization/) (12)
  * [Security](https://jetpack.com/blog/category/security/) (145)
  * [Small Business](https://jetpack.com/blog/category/small-business/) (17)
  * [Social Media](https://jetpack.com/blog/category/social-media/) (48)
  * [Stats](https://jetpack.com/blog/category/stats/) (2)
  * [Support Stories](https://jetpack.com/blog/category/support-stories/) (3)
  * [Tips & Tricks](https://jetpack.com/blog/category/tips-tricks/) (90)
  * [Utilities & Maintenance](https://jetpack.com/blog/category/utilities-maintenance/) (13)
  * [Vulnerabilities](https://jetpack.com/blog/category/vulnerabilities/) (28)
  * [Webinars](https://jetpack.com/blog/category/webinars/) (2)
  * [Website Design](https://jetpack.com/blog/category/website-design/) (17)
  * [WordAds](https://jetpack.com/blog/category/wordads/) (1)
  * [WordCamp](https://jetpack.com/blog/category/events/wordcamp/) (5)

Jetpack

Explore the benefits of Jetpack

Learn how Jetpack can help you protect, speed up, and grow your WordPress site. [Get up to 53% off your first year.](https://jetpack.com/pricing/)

[Explore plans](https://jetpack.com/pricing/)

en

* WordPress Plugins
  + [Akismet Anti-spam](https://wordpress.org/plugins/akismet/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack](https://wordpress.org/plugins/jetpack/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack Boost](https://wordpress.org/plugins/jetpack-boost/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack CRM](https://wordpress.org/plugins/zero-bs-crm/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack Protect](https://wordpress.org/plugins/jetpack-protect/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack Search](https://wordpress.org/plugins/jetpack-search/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack Social](https://wordpress.org/plugins/jetpack-social/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack VideoPress](https://wordpress.org/plugins/jetpack-videopress/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [VaultPress Backup](https://wordpress.org/plugins/jetpack-backup/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [WP Super Cache](https://wordpress.org/plugins/wp-super-cache/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Download](https://jetpack.com/download/)
* Partners
  + [Recommended Hosts](https://jetpack.com/hosting/)
  + [For Hosts](https://jetpack.com/for/hosts/)
  + [For Agencies](https://jetpack.com/for-agencies/)
  + [For Affiliates](https://jetpack.com/affiliates/)
* Developers
  + [Documentation](https://developer.jetpack.com/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Beta Program](https://jetpack.com/beta/)
  + [Contribute to Jetpack](https://jetpack.com/contribute/)
  + [Jetpack on GitHub](https://github.com/Automattic/jetpack)
* Legal
  + [Terms of Service](https://wordpress.com/tos/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Privacy Policy](https://automattic.com/privacy/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [GDPR](https://jetpack.com/gdpr/)
  + Do Not Sell or Share My Personal Information
  + [Privacy Notice for California Users](https://automattic.com/privacy/?utm_medium=automattic_referred&utm_source=jpcom_footer#california-consumer-privacy-act-ccpa)
* Help
  + [Knowledge Base](https://jetpack.com/support/)
  + [Forums](https://wordpress.org/support/plugin/jetpack/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Webinars](https://jetpack.com/webinars/)
  + [Reviews and Testimonials](https://jetpack.com/testimonials/)
  + [Security Library](https://jetpack.com/features/security/library)
  + [Contact Us](https://jetpack.com/contact-support/)
  + [Press](https://jetpack.com/newsroom/)
* Social
  + [![X (formerly known as Twitter)](https://s2.wp.com/wp-content/themes/a8c/jetpackme-new/images/icons/icon-x.svg)](https://twitter.com/jetpack)
  + [![Facebook](https://s2.wp.com/wp-content/themes/a8c/jetpackme-new/images/icons/icon-facebook.svg)](https://www.facebook.com/jetpackme/)
  + [![LinkedIn](https://s2.wp.com/wp-content/themes/a8c/jetpackme-new/images/icons/icon-linkedin.svg)](https://www.linkedin.com/company/jetpack-for-wordpress/)
  + [![Youtube](https://s2.wp.com/wp-content/themes/a8c/jetpackme-new/images/icons/icon-youtube.svg)](https://www.youtube.com/JetpackOfficial)
* Mobile Apps
  + [![Get Jetpack on Google Play](https://s1.wp.com/wp-content/lib/app-badge-buttons/android/en.png?version=20220321)](https://play.google.com/store/apps/details?id=com.jetpack.android&referrer=utm_source%3Djetpack.com%26utm_campaign%3Djp_site_shortcode%26utm_medium%3Dwebsite)
  + [![Download Jetpack on the App Store](https://s1.wp.com/wp-content/lib/app-badge-buttons/ios/en.png?version=20220321)](https://apps.apple.com/app/apple-store/id1565481562?ct=jetpack.com--jp_site_shortcode&mt=8&pt=299112)

* [An ![Automattic](https://s2.wp.com/wp-content/themes/a8c/jetpackme-new/images/logos/logo-a8c-white.svg)](https://automattic.com/?utm_medium=automattic_referred&utm_source=jpcom_footer)
* [Work With Us](https://automattic.com/work-with-us/?utm_medium=automattic_referred&utm_source=jpcom_footer)

* Reblog
* Subscribe
  Subscribed

  + [![](https://jetpack.com/wp-content/uploads/2022/06/cropped-jp-favicon-new-3.png?w=50)](http://jetpack.com)

  Join 60,926 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fjetpack.com%252Fblog%252Fsevere-vulnerability-fixed-in-updraftplus-1-22-3%252F)
* Privacy
* + [![](https://jetpack.com/wp-content/uploads/2022/06/cropped-jp-favicon-new-3.png?w=50)](http://jetpack.com)
  + [Customize](https://jetpackme.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fjetpackme.wordpress.com%2Fblog%2Fsevere-vulnerability-fixed-in-updraftplus-1-22-3%2F)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fjetpack.com%252Fblog%252Fsevere-vulnerability-fixed-in-updraftplus-1-22-3%252F)
  + [Copy shortlink](https://wp.me/p1moTy-ALg)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://jetpack.com/blog/severe-vulnerability-fixed-in-updraftplus-1-22-3/)
  + [View post in Reader](https://wordpress.com/read/blogs/20115252/posts/141314)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)

