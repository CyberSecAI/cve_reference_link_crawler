The provided content is related to CVE-2022-48974.

**Root cause of vulnerability:**
The vulnerability stems from the use of `NF_CT_STAT_INC()` in a preemptible context within the `nf_conntrack_hash_check_insert()` function, specifically when `nf_ct_ext_valid_pre()` or `nf_ct_ext_valid_post()` fail. `NF_CT_STAT_INC()` uses `__this_cpu_add()`, which is not safe to call in a preemptible context.

**Weaknesses/vulnerabilities present:**
-   Incorrect use of `__this_cpu_add()` in a preemptible context, leading to a potential race condition.

**Impact of exploitation:**
-   The primary impact is a kernel BUG which leads to a system crash or denial of service.

**Attack vectors:**
-   The vulnerability can be triggered by creating new conntrack entries that fail either the `nf_ct_ext_valid_pre()` or `nf_ct_ext_valid_post()` checks. This can be done by a local attacker via the `netlink` interface

**Required attacker capabilities/position:**
-   A local attacker needs to be able to send netlink messages to trigger the vulnerable code path.

**Additional notes:**
-   The fix replaces `NF_CT_STAT_INC()` with `NF_CT_STAT_INC_ATOMIC()` in the identified vulnerable locations, which is thread-safe.
-   The problematic code is in the `nf_conntrack_hash_check_insert()` and `__nf_conntrack_confirm()` functions when `nf_ct_ext_valid_pre()` or `nf_ct_ext_valid_post()` fail.
-   The fix is applied to the `net/netfilter/nf_conntrack_core.c` file.