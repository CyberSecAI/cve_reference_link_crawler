=== Content from securitylab.github.com_6cae5ebc_20250111_135620.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

December 14, 2023
# GHSL-2023-192\_GHSL-2023-194: Several vulnerabilities in bazarr - CVE-2023-50264, CVE-2023-50265, CVE-2023-50266

[![Author avatar](https://avatars.githubusercontent.com/u/102833689)
Sylwia Budzynska](https://github.com/sylwia-budzynska)

## Coordinated Disclosure Timeline

* 2023-09-18: Sent report to the maintainer.
* 2023-09-18: Received a reply with fixes for the two Arbitrary File Read issues and a question about the Blind SSRF one.
* 2023-09-19: Answered with a few possible fixes for the SSRF issue and asked to create an advisory.
* 2023-09-29: Received a response, with a partial fix to the SSRF, which limits the vulnerability to HTTP/HTTPS protocols.
* 2023-12-11: Sent a reminder about creating advisories and assigning CVEs.
* 2023-12-13: Received a response from the maintainer that they don’t find it necessary to publish CVEs for these vulnerabilities. GitHub Security Lab finds it valuable to publish CVEs for the issues to provide transparency and inform the users about the vulnerabilities. The Security Lab requested CVEs for the issues.

## Summary

Bazarr is vulnerable to unauthenticated arbitrary file reads in two endpoints and a blind server-side request forgery (SSRF).

## Project

bazarr

## Tested Version

[v1.2.4](https://github.com/morpheus65535/bazarr/releases/tag/v1.2.4)

## Details

### Issue 1: Arbitrary file read in `/system/backup/download/` endpoint (`GHSL-2023-192`)

The [`/system/backup/download/`](https://github.com/morpheus65535/bazarr/blob/6e7858fc7ce0905ba1f241885c386d70507f6b56/bazarr/app/ui.py#L141-L144) endpoint in `bazarr/app/ui.py` does not validate the user-controlled [`filename`](https://github.com/morpheus65535/bazarr/blob/6e7858fc7ce0905ba1f241885c386d70507f6b56/bazarr/app/ui.py#L143) variable and uses it in the [`send_file`](https://github.com/morpheus65535/bazarr/blob/6e7858fc7ce0905ba1f241885c386d70507f6b56/bazarr/app/ui.py#L144) function, which leads to an arbitrary file read on the system.

`backup_download` method in `bazarr/app/ui.py`

```
@check_login
@ui_bp.route('/system/backup/download/<path:filename>', methods=['GET'])
def backup_download(filename):
    return send_file(os.path.join(settings.backup.folder, filename), max_age=0, as_attachment=True)

```

This issue was found with the CodeQL query [Uncontrolled data used in path expression](https://codeql.github.com/codeql-query-help/python/py-path-injection/).

#### Impact

This issue may lead to unauthenticated `arbitrary file read`.

#### PoC

1. Start Bazarr. We assume that it is running on http://127.0.0.1:6767.
2. Send the following request.
   ```
   curl -X GET 'http://127.0.0.1:6767/system/backup/download/../../../../../../../etc/passwd' --path-as-is

   ```
3. Observe that `/etc/passwd` is displayed in the response.

### Issue 2: Arbitrary file read in `/api/swaggerui/static` endpoint (`GHSL-2023-193`)

The [`/api/swaggerui/static`](https://github.com/morpheus65535/bazarr/blob/6e7858fc7ce0905ba1f241885c386d70507f6b56/bazarr/app/ui.py#L148-L150) endpoint in `bazarr/app/ui.py` does not validate the user-controlled [`filename`](https://github.com/morpheus65535/bazarr/blob/6e7858fc7ce0905ba1f241885c386d70507f6b56/bazarr/app/ui.py#L148) variable and uses it in the [`send_file`](https://github.com/morpheus65535/bazarr/blob/6e7858fc7ce0905ba1f241885c386d70507f6b56/bazarr/app/ui.py#L149C1-L150) function, which leads to an arbitrary file read on the system.

`swaggerui_static` method in `bazarr/app/ui.py`

```
@ui_bp.route('/api/swaggerui/static/<path:filename>', methods=['GET'])
def swaggerui_static(filename):
    return send_file(os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(__file__))), 'libs', 'flask_restx',
                     'static', filename))

```

This issue was found with the CodeQL query [Uncontrolled data used in path expression](https://codeql.github.com/codeql-query-help/python/py-path-injection/).

#### Impact

This issue may lead to `arbitrary file read`.

#### PoC

1.. Start Bazarr. We assume that it is running on http://127.0.0.1:6767.

1. Send the following request.
   ```
   curl -X GET 'http://127.0.0.1:6767/api/swaggerui/static/../../../../../../../etc/passwd' --path-as-is

   ```
2. Observe that `/etc/passwd` is displayed in the response.

### Issue 3: Blind Server-Side Request Forgery (SSRF) in the `/test/<protocol>/` endpoint (`GHSL-2023-194`)

The [`proxy`](https://github.com/morpheus65535/bazarr/blob/6e7858fc7ce0905ba1f241885c386d70507f6b56/bazarr/app/ui.py#L160) method in `bazarr/bazarr/app/ui.py` does not validate the user-controlled `protocol` and [`url`](https://github.com/morpheus65535/bazarr/blob/6e7858fc7ce0905ba1f241885c386d70507f6b56/bazarr/app/ui.py#L160) variables and passes them to `requests.get()` without any sanitization, which leads to a server-side request forgery. Since the contents of the response to the GET request are not visible to the one making the request (the contents are visible only if there’s a JSON in the response with a “version” key value pair, see [lines 168-171](https://github.com/morpheus65535/bazarr/blob/6e7858fc7ce0905ba1f241885c386d70507f6b56/bazarr/app/ui.py#L168-L171)), this is a blind server-side request forgery.

`proxy` method

```
def proxy(protocol, url):
    url = protocol + '://' + unquote(url)
    params = request.args
    try:
        result = requests.get(url, params, allow_redirects=False, verify=False, timeout=5, headers=headers)
    except Exception as e:
        return dict(status=False, error=repr(e))
    else:
        if result.status_code == 200:
            try:
                version = result.json()['version']
                return dict(status=True, version=version)
            except Exception:
                return dict(status=False, error='Error Occurred. Check your settings.')
        elif result.status_code == 401:
            return dict(status=False, error='Access Denied. Check API key.')
        elif result.status_code == 404:
            return dict(status=False, error='Cannot get version. Maybe unsupported legacy API call?')
        elif 300 <= result.status_code <= 399:
            return dict(status=False, error='Wrong URL Base.')
        else:
            return dict(status=False, error=result.raise_for_status())

```

This issue was found with the CodeQL query [Full server-side request forgery](https://codeql.github.com/codeql-query-help/python/py-full-ssrf/).

#### Impact

This issue allows for crafting GET requests to internal and external resources on behalf of the server. For example, this issue would allow for determining whether certain resources on the internal network exist or not, even though these resources may not be accessible on the internet.

#### Proof of Concept

1. Start a simple python web server in a folder containing a example file called file.txt with python -m http.server 9000 This command will serve the file.txt file on http://127.0.0.1:9000
2. Start Bazarr. We assume that it is running on http://127.0.0.1:6767.
3. Send the following request.
   ```
   curl -X GET 'http://127.0.0.1:6767/test/http/localhost:9000/file.txt'

   ```
4. If the file exists, the response will be:
   ```
   {
     "error": "Error Occurred. Check your settings.",
     "status": false
   }

   ```

   You can also test if a file doesn’t exist by sending a request for a resource that doesn’t exist, like `foo.txt`, for example:

   ```
   curl -X GET 'http://127.0.0.1:6767/test/http/localhost:9000/foo.txt'

   ```

   If the file doesn’t exist, the response will be:

   ```
   {
     "error": "Cannot get version. Maybe unsupported legacy API call?",
     "status": false
   }

   ```

#### Resources

[SSRF prevention cheatsheet](https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html)

## CVE

* GHSL-2023-192 has CVE-2023-50264
* GHSL-2023-193 has CVE-2023-50265
* GHSL-2023-194 has CVE-2023-50266

## Credit

These issues were discovered and reported by GHSL team member [@sylwia-budzynska (Sylwia Budzynska)](https://github.com/sylwia-budzynska).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2023-192`, `GHSL-2023-193`, or `GHSL-2023-194` in any communication regarding these issues.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from github.com_d75a8421_20250111_135620.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmorpheus65535%2Fbazarr%2Freleases%2Ftag%2Fv1.3.1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmorpheus65535%2Fbazarr%2Freleases%2Ftag%2Fv1.3.1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=morpheus65535%2Fbazarr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[morpheus65535](/morpheus65535)
/
**[bazarr](/morpheus65535/bazarr)**
Public

* [Notifications](/login?return_to=%2Fmorpheus65535%2Fbazarr) You must be signed in to change notification settings
* [Fork
  232](/login?return_to=%2Fmorpheus65535%2Fbazarr)
* [Star
   3k](/login?return_to=%2Fmorpheus65535%2Fbazarr)

* [Code](/morpheus65535/bazarr/tree/v1.3.1)
* [Issues
  12](/morpheus65535/bazarr/issues)
* [Pull requests
  6](/morpheus65535/bazarr/pulls)
* [Actions](/morpheus65535/bazarr/actions)
* [Projects
  0](/morpheus65535/bazarr/projects)
* [Security](/morpheus65535/bazarr/security)
* [Insights](/morpheus65535/bazarr/pulse)

Additional navigation options

* [Code](/morpheus65535/bazarr/tree/v1.3.1)
* [Issues](/morpheus65535/bazarr/issues)
* [Pull requests](/morpheus65535/bazarr/pulls)
* [Actions](/morpheus65535/bazarr/actions)
* [Projects](/morpheus65535/bazarr/projects)
* [Security](/morpheus65535/bazarr/security)
* [Insights](/morpheus65535/bazarr/pulse)

1. [Releases](/morpheus65535/bazarr/releases)
2. [v1.3.1](/morpheus65535/bazarr/releases/tag/v1.3.1)

# v1.3.1

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/morpheus65535/bazarr/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.3.1)

 Loading

[View all tags](/morpheus65535/bazarr/tags)

![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)
[github-actions](/apps/github-actions)
released this
14 Oct 12:45

·
[514 commits](/morpheus65535/bazarr/compare/v1.3.1...master)
to master
since this release

[v1.3.1](/morpheus65535/bazarr/tree/v1.3.1)

[`d657941`](/morpheus65535/bazarr/commit/d6579417ba3b3555bff3af446bef8a56e2d7a7c6)

From newest to oldest:

* HDBits provider: add search filters [d657941](https://github.com/morpheus65535/bazarr/commit/d6579417ba3b3555bff3af446bef8a56e2d7a7c6)
* EmbeddedSubtitles provider: add blacklist support [bee6919](https://github.com/morpheus65535/bazarr/commit/bee6919979409ccbc6e8174b117d091ec8d2e0c2)
* HDBits provider: handle JSON errors [0031abc](https://github.com/morpheus65535/bazarr/commit/0031abcea4b7a054e55d96005ec9d0eb76490691)
* Exposed subtitle file size through API [4e7dedc](https://github.com/morpheus65535/bazarr/commit/4e7dedc43c1ceb936b093338363a8c6ff46505c1)
* Fixed hosszupuska website parsing issue. [#2246](https://github.com/morpheus65535/bazarr/issues/2246) [33af93a](https://github.com/morpheus65535/bazarr/commit/33af93a341b326ca314de31c2d312513b209b307)
* Improved throttling duration for some common configuration or connection issues. [09295dc](https://github.com/morpheus65535/bazarr/commit/09295dcd10ff3727de2546f9af27fdca66dc7baa)
* Fixed history logging of downloaded and uploaded subtitles. [#2261](https://github.com/morpheus65535/bazarr/issues/2261) [2972c38](https://github.com/morpheus65535/bazarr/commit/2972c3881c525cad183d66e2540459c0f19cad77)
* Improved synchronization speed for Sonarr and Radarr. [#2260](https://github.com/morpheus65535/bazarr/issues/2260) [0f216ab](https://github.com/morpheus65535/bazarr/commit/0f216ab69f5d2b386e101f27e679513942d05e41)
* Fixed history logging issue for episodes and movies subtitles. [1f187d8](https://github.com/morpheus65535/bazarr/commit/1f187d89ca80e3734bf0831e2f7940bb01235695)
* EmbeddedSubtitles provider: update subtitles checker [654934b](https://github.com/morpheus65535/bazarr/commit/654934b5e1d9a4637e53c6882b2dfc3213600f54)
* HDBits provider: improve episode matching [3942264](https://github.com/morpheus65535/bazarr/commit/3942264d0057860e53be8d18e8dfb093352f0dbe)
* Fixed an additional issue with [85d300f](https://github.com/morpheus65535/bazarr/commit/85d300f94ef60ef60416786a80db2d89917b8266). [#2243](https://github.com/morpheus65535/bazarr/issues/2243) [807621a](https://github.com/morpheus65535/bazarr/commit/807621a612a0734e91b8271278099f7d950d01de)
* Add HDBits.org provider [63335f4](https://github.com/morpheus65535/bazarr/commit/63335f40fcefd773405c11db8550988662ac88ae)
* Fixed database migration process causing UNIQUE constraint in some edge cases where duplicate ID root folders where stored. [#2253](https://github.com/morpheus65535/bazarr/issues/2253) [166d0cc](https://github.com/morpheus65535/bazarr/commit/166d0ccc95112173acf6f6967b2d13cbb5d662c9)
* Fixed latest migration that cleared history for sqlite users. [0ddadb2](https://github.com/morpheus65535/bazarr/commit/0ddadb273e8671e183a2d37cd5fc3054b9adbccc)
* Added error logging when trying to determine malformed audio track languages. [#2250](https://github.com/morpheus65535/bazarr/issues/2250) [81159a0](https://github.com/morpheus65535/bazarr/commit/81159a09789aa0251c5a6935ff06ae9e886e7a05)
* Added logging for opensubtitles.com 400 error. [#2232](https://github.com/morpheus65535/bazarr/issues/2232) [e7703ca](https://github.com/morpheus65535/bazarr/commit/e7703ca5a08f6a25590bd9d678f844857c41a108)
* Fixed Postgres issues while creating new database with v1.3.0. [#2249](https://github.com/morpheus65535/bazarr/issues/2249) [e2d0647](https://github.com/morpheus65535/bazarr/commit/e2d0647d550972aa28b6917c3d2faf6f000efe71)
* Subdivx provider: improve movies matches
* Update providers exception regex for Windows [e06aad7](https://github.com/morpheus65535/bazarr/commit/e06aad7fc6658d7a04479e66b4efb3ce2626b3da)
* Fixed some code to prevent arbitrary file read and blind SSRF. [17add7f](https://github.com/morpheus65535/bazarr/commit/17add7fbb3ae1919a40d505470d499d46df9ae6b)
* Removed sucha provider that doesn't exist anymore. [#2242](https://github.com/morpheus65535/bazarr/issues/2242) [aa0af3f](https://github.com/morpheus65535/bazarr/commit/aa0af3f601bad55294ec241009293c60bbb3dce3)

 Assets
3

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_49882b23_20250111_135619.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmorpheus65535%2Fbazarr%2Fcommit%2F17add7fbb3ae1919a40d505470d499d46df9ae6b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmorpheus65535%2Fbazarr%2Fcommit%2F17add7fbb3ae1919a40d505470d499d46df9ae6b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=morpheus65535%2Fbazarr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[morpheus65535](/morpheus65535)
/
**[bazarr](/morpheus65535/bazarr)**
Public

* [Notifications](/login?return_to=%2Fmorpheus65535%2Fbazarr) You must be signed in to change notification settings
* [Fork
  232](/login?return_to=%2Fmorpheus65535%2Fbazarr)
* [Star
   3k](/login?return_to=%2Fmorpheus65535%2Fbazarr)

* [Code](/morpheus65535/bazarr)
* [Issues
  12](/morpheus65535/bazarr/issues)
* [Pull requests
  6](/morpheus65535/bazarr/pulls)
* [Actions](/morpheus65535/bazarr/actions)
* [Projects
  0](/morpheus65535/bazarr/projects)
* [Security](/morpheus65535/bazarr/security)
* [Insights](/morpheus65535/bazarr/pulse)

Additional navigation options

* [Code](/morpheus65535/bazarr)
* [Issues](/morpheus65535/bazarr/issues)
* [Pull requests](/morpheus65535/bazarr/pulls)
* [Actions](/morpheus65535/bazarr/actions)
* [Projects](/morpheus65535/bazarr/projects)
* [Security](/morpheus65535/bazarr/security)
* [Insights](/morpheus65535/bazarr/pulse)

## Commit

[Permalink](/morpheus65535/bazarr/commit/17add7fbb3ae1919a40d505470d499d46df9ae6b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fixed some code to prevent arbitrary file read and blind SSRF.

[Browse files](/morpheus65535/bazarr/tree/17add7fbb3ae1919a40d505470d499d46df9ae6b)
Browse the repository at this point in the history

* Loading branch information

[![@morpheus65535](https://avatars.githubusercontent.com/u/5130500?s=40&v=4)](/morpheus65535)

[morpheus65535](/morpheus65535/bazarr/commits?author=morpheus65535 "View all commits by morpheus65535")
committed
Sep 18, 2023

1 parent
[aa0af3f](/morpheus65535/bazarr/commit/aa0af3f601bad55294ec241009293c60bbb3dce3)

commit 17add7f

Showing
**1 changed file**
with
**14 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

17 changes: 14 additions & 3 deletions

17
[bazarr/app/ui.py](#diff-0925fa8544c0514f5dbd00bcd7419cd9f84adb20d3dd3403529dc7a103d91a9f "bazarr/app/ui.py")

Show comments

[View file](/morpheus65535/bazarr/blob/17add7fbb3ae1919a40d505470d499d46df9ae6b/bazarr/app/ui.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -143,13 +143,22 @@ def movies\_images(url): |
|  |  | @check\_login |
|  |  | @ui\_bp.route('/system/backup/download/<path:filename>', methods=['GET']) |
|  |  | def backup\_download(filename): |
|  |  | return send\_file(os.path.join(settings.backup.folder, filename), max\_age=0, as\_attachment=True) |
|  |  | fullpath = os.path.normpath(os.path.join(settings.backup.folder, filename)) |
|  |  | if not fullpath.startswith(settings.backup.folder): |
|  |  | return '', 404 |
|  |  | else: |
|  |  | return send\_file(fullpath, max\_age=0, as\_attachment=True) |
|  |  |  |
|  |  |  |
|  |  | @ui\_bp.route('/api/swaggerui/static/<path:filename>', methods=['GET']) |
|  |  | def swaggerui\_static(filename): |
|  |  | return send\_file(os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(\_\_file\_\_))), 'libs', 'flask\_restx', |
|  |  | 'static', filename)) |
|  |  | basepath = os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(\_\_file\_\_))), 'libs', 'flask\_restx', |
|  |  | 'static') |
|  |  | fullpath = os.path.join(basepath, filename) |
|  |  | if not fullpath.startswith(basepath): |
|  |  | return '', 404 |
|  |  | else: |
|  |  | return send\_file(fullpath) |
|  |  |  |
|  |  |  |
|  |  | def configured(): |
| Expand All | | @@ -160,6 +169,8 @@ def configured(): |
|  |  | @ui\_bp.route('/test', methods=['GET']) |
|  |  | @ui\_bp.route('/test/<protocol>/<path:url>', methods=['GET']) |
|  |  | def proxy(protocol, url): |
|  |  | if protocol.lower not in ['http', 'https']: |
|  |  | return dict(status=False, error='Unsupported protocol') |
|  |  | url = protocol + '://' + unquote(url) |
|  |  | params = request.args |
|  |  | try: |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `17add7f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmorpheus65535%2Fbazarr%2Fcommit%2F17add7fbb3ae1919a40d505470d499d46df9ae6b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


