=== Content from www.fa.omron.co.jp_648144bb_20250111_070943.html ===
マシンオートメーションコントローラ NJ/NX シリーズにおける

                          No. OMSR-2024-001_ja (  1  /  6  )

パス・トラバーサル脆弱性

公開日 2024 年 3 月 7 日

最終更新日 2024 年 5 月 27 日

オムロン株式会社

■概要

マシンオートメーションコントローラ NJ／NX シリーズにおいて、パストラバーサル（CWE-22）の脆弱性が存在す

ることが判明しました。攻撃者は当該脆弱性を用いて、当該コントローラ製品に不正にアクセスでき、リモートで意図

しないコードが実行される可能性があります。

この脆弱性の影響を受ける製品、バージョン、および軽減策・回避方法を以下に示します。弊社が推奨する軽減

策・回避策を実施することで、本脆弱性の悪用リスクを最小限に抑えることができます。また、お客様に製品をより安

心して利用いただくために、今回製品セキュリティ強化の対策バージョンを用意いたしました。各製品の対策バージョン

の提供について本文の対策方法に示しますので、対策の実施をお願いいたします。

■対象製品

本脆弱性の影響を受ける製品の形式、およびバージョンは以下の通りです。

マシンオートメーションコントローラ  NJ シリーズ

形式

NJ101-□□□□

NJ301-□□□□

NJ501-1□0□

NJ501-1□2□

NJ501-1340

NJ501-4□□□

NJ501-5300

NJ501-R□□□

対象バージョン

ロット番号（製造年月日）

Ver.1.64.03 以前

25424（2024 年 4 月 25 日）以前

Ver.1.64.00 以前

Ver.1.64.03 以前

Ver.1.64.00 以前

Ver.1.64.00 以前

Ver.1.64.00 以前

Ver.1.64.00 以前

Ver.1.64.00 以前

対象バージョンの確認方法は、「別紙  製品バージョンの確認方法」を参照してください。

ロット番号の確認方法は以下のマニュアルの「識別情報表示」を参照してください。

⚫  NJ シリーズ  CPU ユニット  ユーザーズマニュアル  ハードウェア編（SBCA-466）

マシンオートメーションコントローラ  NX シリーズ

形式

対象バージョン

ロット番号（製造年月日）

NX102-□□□□

Ver.1.64.00 以前

25424（2024 年 4 月 25 日）以前

C09-27-01B

                          No. OMSR-2024-001_ja (  2  /  6  )

NX1P2-□□□□□□

Ver.1.64.00 以前

NX1P2-□□□□□□1

Ver.1.64.00 以前

NX502-□□□□

NX701-□□□□

NX-EIP201

Ver.1.65.01 以前

Ver.1.35.00 以前

Ver.1.00.01 以前

対象バージョンの確認方法は、「別紙  製品バージョンの確認方法」を参照してください。

ロット番号の確認方法は以下のマニュアルの「識別情報表示」を参照してください。

⚫  NX シリーズ  NX102 CPU ユニット  ユーザーズマニュアル  ハードウェア編（SBCA-462）

⚫  NX シリーズ  NX1P2 CPU ユニット  ユーザーズマニュアル  ハードウェア編（SBCA-448）

⚫  NX シリーズ  NX5 CPU ユニット  ユーザーズマニュアル  ハードウェア編（SBCA-497）

⚫  NX シリーズ  NX7 CPU ユニット  ユーザーズマニュアル  ハードウェア編（SBCA-418）
⚫  NX シリーズ  NX-EIP201 EtherNet/IPTM ユニット  ユーザーズマニュアル（SBCD-382）

■脆弱性内容

マシンオートメーションコントローラ NJ／NX シリーズにおいて、パス・トラバーサル（CWE-22）の脆弱性により、当該

コントローラ製品に不正にアクセスでき、リモートで意図しないコードが実行される可能性があります。

■CVSS スコア

パス・トラバーサル  (CWE-22)

CVE-2024-27121

CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H  基本値  7.2

■対策方法

各製品を対策バージョンに更新することで、本脆弱性の対策が可能です。

以下に各製品の対策バージョン、および対策バージョンの提供時期を示します。

マシンオートメーションコントローラ  NJ シリーズ

形式

NJ101-□□□□

NJ301-□□□□

NJ501-1□0□

NJ501-1□2□

NJ501-1340

NJ501-4□□□

NJ501-5300

NJ501-R□□□

対策バージョン

ロット番号（対策バージョン提供時期）

Ver.1.64.04 以(cid:3083)

26424（2024 年 4 月 26 日）以(cid:3083)

Ver.1.64.04 以(cid:3083)

Ver.1.64.04 以(cid:3083)

Ver.1.64.04 以(cid:3083)

Ver.1.64.04 以(cid:3083)

Ver.1.64.04 以(cid:3083)

Ver.1.64.04 以(cid:3083)

Ver.1.64.04 以(cid:3083)

対策バージョンの入手および更新方法については、当社営業にお問い合わせください。

C09-27-01B

マシンオートメーションコントローラ  NX シリーズ

形式

対策バージョン

ロット番号（対策バージョン提供時期）

NX102-□□□□

Ver.1.64.04 以(cid:3083)

26424（2024 年 4 月 26 日）以(cid:3083)

                          No. OMSR-2024-001_ja (  3  /  6  )

NX1P2-□□□□□□

Ver.1.64.04 以(cid:3083)

NX1P2-□□□□□□1

Ver.1.64.04 以(cid:3083)

NX502-□□□□

NX701-□□□□

NX-EIP201

Ver.1.66.01 以(cid:3083)

Ver.1.35.04 以(cid:3083)

Ver.1.01.00 以(cid:3083)

対策バージョンの入手および更新方法については、当社営業にお問い合わせください。

■軽減策・回避策

    本脆弱性の悪用リスクを最小限に抑えるため、以下に示す軽減策を講じることを推奨します。

1.  セキュア通信機能の使用

セキュア通信機能は、第三者によるデータの盗聴や改ざんを防止します。セキュア通信機能は、以下の CPU ユ

ニットのユニットバージョンで使用可能です。

⚫  NJ シリーズ、NX102、NX1P2 CPU ユニット：Ver.1.49 以(cid:3083)

⚫  NX701 CPU ユニット：Ver.1.29 以(cid:3083)

⚫  NX502 CPU ユニット：Ver.1.60 以(cid:3083)

⚫  NX-EIP201：Ver.1.00 以(cid:3083)

2.  アンチウィルス保護

制御システムに接続するパソコンに最新の商用品質のウイルス対策ソフトの導入・保守

3.  不正アクセスの防止

以下に示す対策を講じることを推奨します。

⚫  制御システムや装置のネットワーク接続を最小限に抑え、信頼できないデバイスからのアクセス禁止

⚫  ファイアウォールの導入による IT ネットワークからの分離（未使用通信ポートの遮断、通信ホストの制

限）

⚫  制御システムや装置へのリモートアクセスが必要な場合、仮想プライベートネットワーク  (VPN)の使用

⚫  強固なパスワードの採用と頻繁な変更

⚫  権限保有者のみを制御システムや装置へのアクセスを可能とする物理的統制の導入

⚫  制御システムや装置で USB メモリなど外部ストレージデバイスを使用する場合の事前ウイルススキャン

⚫  制御システムや装置へのリモートアクセス時の多要素認証の導入

4.  データ入出力の保護

制御システムや装置への入出力データの意図せぬ改変に備えた、バックアップや範囲チェックなどの妥当性の確

認

C09-27-01B

                          No. OMSR-2024-001_ja (  4  /  6  )

5.  紛失データの復元

            データ紛失対策としての定期的な設定データのバックアップと保守

■お問い合わせ先

当社営業または販売店にお問い合わせください。

国内お問い合わせ先：https://www.fa.omron.co.jp/sales/local/

海外お問い合わせ先：https://www.ia.omron.com/global_network/index.html

■謝辞

Microsoft 社の  CPS Research Team の Tamir Ariel 氏から報告されました。

Dragos 社の  Principle Vulnerability Analyst の Logan Carpenter 氏から報告されました。

脆弱性を発見、報告いただいた  Tamir Ariel 氏及び Logan Carpenter 氏に感謝いたします。

■更新履歴

    2024/3/7  新規作成

2024/5/27  対象製品、対策バージョンのロット番号(cid:3082)正

C09-27-01B

別紙  製品バージョンの確認方法

製品バージョンの確認方法はシリーズにより異なります。

                          No. OMSR-2024-001_ja (  5  /  6  )

NJ シリーズでの確認方法

Sysmac Studio のマルチビューエクスプローラで【構成・設定】→【CPU・増設ラック】をダブルクリックします。

ユニットエディタの空欄上で右クリックして【生産情報表示】を選択します。

【生産情報】→【詳細表示】を選択します。下図は、Ver.1.10.05 の表示です。

NX シリーズでの確認方法

Sysmac Studio のマルチビューエクスプローラで［構成・設定］の［CPU・増設ラック］の［CPU  ラック］を右クリ

ックして［生産情報表示］を選択します。［生産情報］ダイアログボックスが表示されます。

C09-27-01B

                          No. OMSR-2024-001_ja (  6  /  6  )

［生産情報］ダイアログボックスの右下の、［簡易表示］または［詳細表示］を選択します。［生産情報］の簡

易表示と詳細表示が、切り替わります。下図は、NX502-1500 が Ver.1.60.02、NX-EIP201 が

Ver.1.00.00 の表示です。

C09-27-01B



=== Content from www.fa.omron.co.jp_731d28f0_20250111_070941.html ===
Path Traversal Vulnerabilities

No. OMSR-2024-001_en (  1  /  6  )

in NJ/NX-series Machine Automation Controllers

Release date: March 7, 2024

Last modified on May 27, 2024

OMRON  Corporation

■Overview

Path Traversal Vulnerabilities (CWE-22) exist in NJ/NX-series Machine Automation Controllers.

An  attacker  may  use  these  vulnerabilities  to  perform  unauthorized  access  and  to  execute

unauthorized code remotely to the controller products.

The  products  and  versions  affected  by  these  vulnerabilities,  mitigation  and  protection

measures are shown below. Make sure to implement these recommended mitigations and

protections to minimize the risk of exploitation of these vulnerabilities. Moreover, to ensure

that  customers  use  our  products  with  confidence,  the  security  enhanced  countermeasure

version of each product has been prepared. Please check countermeasure shown below in

this document and implement appropriate countermeasure.

■Affected products

Affected products and versions are below.

Machine Automation Controller NJ-series

Model

Version

Lot No. (Date of Manufacture)

NJ101-[][][][]

Ver.1.64.03 or lower

Until 25424 (April 25, 2024)

NJ301-[][][][]

Ver.1.64.00 or lower

NJ501-1[]0[]

NJ501-1[]2[]

NJ501-1340

Ver.1.64.03 or lower

Ver.1.64.00 or lower

Ver.1.64.00 or lower

NJ501-4[][][]

Ver.1.64.00 or lower

NJ501-5300

Ver.1.64.00 or lower

NJ501-R[][][]

Ver.1.64.00 or lower

Refer to the appendix for how to check the target product version.

Refer to the “ID Information Indication” section in the above manuals for how to check the

lot number.

-  NJ-series CPU unit Hardware User’s Manual (W500)

C09-27-01B

Machine Automation Controller NX-series

Model

Version

Lot No. (Date of Manufacture)

NX102-[][][][]

Ver.1.64.00 or lower

Until 25424 (April 25, 2024)

No. OMSR-2024-001_en (  2  /  6  )

NX1P2-[][][][][][]

Ver.1.64.00 or lower

NX1P2-[][][][][][]1

Ver.1.64.00 or lower

NX502-[][][][]

Ver.1.65.01 or lower

NX701-[][][][]

Ver.1.35.00 or lower

NX-EIP201

Ver.1.00.01 or lower

Refer to the appendix for how to check the target product version.

Refer to the “ID Information Indication” section in the above manuals for how to check the

lot number.

-  NX102 CPU Unit User’s Manual (Hardware) (W593)

-  NX1P2 CPU Unit User’s Manual (Hardware) (W578)

-  NX5 CPU Unit User’s Manual (Hardware) (W629)

-  NX7 CPU Unit User’s Manual (Hardware) (W535)
-  NX-EIP201 EtherNet/IPTM Units User’s Manual (W627)

■Description

Due  to  the  Path  Traversal  Vulnerabilities  (CWE-22)  which  exist  in  NJ/NX-series  Machine

Automation  Controllers,  the  products  may  be  performed  unauthorized  access  and  RCE

(Remote Code Execution).

■CVSS Scores

Path Traversal (CWE-22)

CVE-2024-27121

CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H Base Score 7.2

■Countermeasure

The  countermeasure  against  the  vulnerabilities  can  be  implemented  by  updating  each

product  to  the  countermeasure  version.  The  countermeasure  version  and  respective

release date for each product is shown in the table below.

Machine Automation Controller NJ-series

Model

Version

Lot No. (Release Date)

NJ101-[][][][]

Ver.1.64.04 or higher  26424 (April 26, 2024) or later

NJ301-[][][][]

Ver.1.64.04 or higher

NJ501-1[]0[]

NJ501-1[]2[]

Ver.1.64.04 or higher

Ver.1.64.04 or higher

C09-27-01B

No. OMSR-2024-001_en (  3  /  6  )

NJ501-1340

Ver.1.64.04 or higher

NJ501-4[][][]

Ver.1.64.04 or higher

NJ501-5300

Ver.1.64.04 or higher

NJ501-R[][][]

Ver.1.64.04 or higher

For information on how to obtain and update the firmware for the countermeasure version

of the product, please contact our sales office or distributors.

Machine Automation Controller NX-series

Model

Version

Lot No. (Date of Manufacture)

NX102-[][][][]

Ver.1.64.04 or higher  26424 (April 26, 2024) or later

NX1P2-[][][][][][]

Ver.1.64.04 or higher

NX1P2-[][][][][][]1

Ver.1.64.04 or higher

NX502-[][][][]

Ver.1.66.01 or higher

NX701-[][][][]

Ver.1.35.04 or higher

NX-EIP201

Ver.1.01.00 or higher

For information on how to obtain and update the firmware for the countermeasure version

of the product, please contact our sales office or distributors.

■Mitigations and Protections

OMRON recommends that customers take the following mitigation measures to minimize

the risk of exploitation of these vulnerabilities.

1.  Secure Communication Function

The  secure  communication  function  can  prevent  data  from  being  eavesdropped  or

tampered with by a third party. Secure communication is available in the following CPU

Units of the stated versions.

-  NJ series, NX102, NX1P2 CPU Unit: Version 1.49 or higher

-  NX701 CPU Unit: Version 1.29 or higher

-  NX502 CPU Unit: Version 1.60 or higher

-  NX-EIP201：Ver.1.00 or higher

2.  Anti-virus protection

Protect  any  PC  with  access  to  the  control  system  against  malware  and  ensure

installation  and  maintenance  of  up-to-date  commercial  grade  anti-virus  software

protection.

3.  Security measures to prevent unauthorized access

C09-27-01B

No. OMSR-2024-001_en (  4  /  6  )

-  Minimize connection of control systems and equipment to open networks, so that

untrusted devices will be unable to access them.

-

Implement  firewalls  (by  shutting  down  unused  communications  ports,  limiting

communications hosts) and isolate them from the IT network.

-  Use  a  virtual  private  network  (VPN)  for  remote  access  to  control  systems  and

equipment.

-  Use strong passwords and change them frequently.

-

Install  physical  controls  so  that  only  authorized  personnel  can  access  control

systems and equipment.

-  Scan virus to ensure safety of any USB drives or similar devices before connecting

them to systems and devices.

-  Enforce  multifactor  authentication  to  all  devices  with  remote  access  to  control

systems and equipment whenever possible.

4.  Data input and output protection

Validation  processing  such  as  backup  and  range  check  to  cope  with  unintentional

modification of input/output data to control systems and devices.

5.  Data recovery

Periodical data backup and maintenance to prepare for data loss.

■Contact information

Please contact our sales office or distributors.

https://www.ia.omron.com/global_network/index.html

■Acknowledgment

Tamir  Ariel,  CPS  Research  Team,  Microsoft,  and  Logan  Carpenter,  Principle  Vulnerability

Analyst, Dragos, reported these vulnerabilities.

Thanks to Tamir Ariel and Logan Carpenter for finding and reporting them.

■Update history

-  March 7, 2024: New Release

-  May 27, 2024: Update the Lot No. of affected products and countermeasure version.

C09-27-01B

Appendix  How to check the product version

The method of checking the product version varies depending on the series.

No. OMSR-2024-001_en (  5  /  6  )

For NJ-series

Double-click CPU/Expansion Racks under Configurations and Setup in the Multiview

Explorer.

Right-click any open space in the Unit Editor and select Production Information.

Click the Show Detail Button at the lower right of the Production Information Dialog Box.

The figure below shows Ver.1.10.05.

C09-27-01B

For NX-series

Right-click CPU Rack under Configurations and Setup - CPU/Expansion Racks in the

Multiview Explorer and select Display Production Information. The Production

Information Dialog Box is displayed.

No. OMSR-2024-001_en (  6  /  6  )

Click the Show Detail or Show Outline Button at the lower right of the Production

Information Dialog Box. The view will change between the production information details

and outline. The figure below shows Ver.1.60.02(NX502-1500) and Ver.1.00.00(NX-

EIP201).

C09-27-01B



=== Content from jvn.jp_d14a6452_20250111_070939.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2024/03/07  Last Updated:2024/03/07
# JVNVU#95852116 OMRON NJ/NX series vulnerable to path traversal

## Overview

OMRON NJ/NX series contain a path traversal vulnerability.

## Products Affected

* Machine Automation Controller NJ Series
  + NJ101-[][][][] Ver.1.64.03 and earlier
  + NJ301-[][][][] Ver.1.64.00 and earlier
  + NJ501-1[]0[] Ver.1.64.03 and earlier
  + NJ501-1[]2[] Ver.1.64.00 and earlier
  + NJ501-1340 Ver.1.64.00 and earlier
  + NJ501-4[][][] Ver.1.64.00 and earlier
  + NJ501-5300 Ver.1.64.00 and earlier
  + NJ501-R[][][] Ver.1.64.00 and earlier
* Machine Automation Controller NX Series
  + NX1P2-[][][][][][] Ver.1.64.00 and earlier
  + NX1P2-[][][][][][]1 Ver.1.64.00 and earlier
  + NX102-[][][][] Ver.1.64.00 and earlier
  + NX502-[][][][] Ver.1.65.01 and earlier
  + NX701-[][][][] Ver.1.35.00 and earlier
  + NX-EIP201 Ver.1.00.01 and earlier

As for the details of the affected products/models/versions, refer to the information provided by the developer.

## Description

Machine Automation Controller NJ/NX series provided by OMRON Corporation contain a path traversal vulnerability ([CWE-22](https://cwe.mitre.org/data/definitions/22.html), [CVE-2024-27121](https://www.cve.org/CVERecord?id=CVE-2024-27121)).

## Impact

An arbitrary file in the affected product may be accessed or arbitrary code may be executed by processing a specially crafted request sent from a remote attacker with an administrative privilege.

## Solution

The developer states that the updates that contain a fix for this vulnerability are scheduled to be released in April 2024.

**Apply the workarounds**

The developer recommends that users apply the following workarounds to mitigate the impact of this vulnerability.

* Use "Secure Communication Function" which is implemented in the following products/versions
  + NJ series, NX102, NX1P2 CPU Unit Ver.1.49 and later
  + NX701 CPU Unit Ver.1.29 and later
  + NX502 CPU Unit Ver.1.60 and later
  + NX-EIP201 Ver.1.00 and later
* Restrict access from the untrusted devices and only allow limited network accesses
* Isolate from IT network by placing firewall (block the unused communication ports, restrict communication hosts, etc.)
* Use Virtual Private Network (VPN)

For more information, refer to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| OMRON Corporation | [Path Traversal Vulnerabilities in NJ/NX-series Machine Automation Controllers](https://www.fa.omron.co.jp/product/security/assets/pdf/en/OMSR-2024-001_en.pdf) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
Base Score:
7.2

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

## Credit

OMRON Corporation reported this vulnerability to JPCERT/CC to notify users of its solution through JVN.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2024-27121](https://www.cve.org/CVERecord?id=CVE-2024-27121) |
| JVN iPedia |  |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2024 JPCERT/CC and IPA. All rights reserved.


