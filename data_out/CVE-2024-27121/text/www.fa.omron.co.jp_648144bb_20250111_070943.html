マシンオートメーションコントローラ NJ/NX シリーズにおける

                          No. OMSR-2024-001_ja (  1  /  6  )

パス・トラバーサル脆弱性

公開日 2024 年 3 月 7 日

最終更新日 2024 年 5 月 27 日

オムロン株式会社

■概要

マシンオートメーションコントローラ NJ／NX シリーズにおいて、パストラバーサル（CWE-22）の脆弱性が存在す

ることが判明しました。攻撃者は当該脆弱性を用いて、当該コントローラ製品に不正にアクセスでき、リモートで意図

しないコードが実行される可能性があります。

この脆弱性の影響を受ける製品、バージョン、および軽減策・回避方法を以下に示します。弊社が推奨する軽減

策・回避策を実施することで、本脆弱性の悪用リスクを最小限に抑えることができます。また、お客様に製品をより安

心して利用いただくために、今回製品セキュリティ強化の対策バージョンを用意いたしました。各製品の対策バージョン

の提供について本文の対策方法に示しますので、対策の実施をお願いいたします。

■対象製品

本脆弱性の影響を受ける製品の形式、およびバージョンは以下の通りです。

マシンオートメーションコントローラ  NJ シリーズ

形式

NJ101-□□□□

NJ301-□□□□

NJ501-1□0□

NJ501-1□2□

NJ501-1340

NJ501-4□□□

NJ501-5300

NJ501-R□□□

対象バージョン

ロット番号（製造年月日）

Ver.1.64.03 以前

25424（2024 年 4 月 25 日）以前

Ver.1.64.00 以前

Ver.1.64.03 以前

Ver.1.64.00 以前

Ver.1.64.00 以前

Ver.1.64.00 以前

Ver.1.64.00 以前

Ver.1.64.00 以前

対象バージョンの確認方法は、「別紙  製品バージョンの確認方法」を参照してください。

ロット番号の確認方法は以下のマニュアルの「識別情報表示」を参照してください。

⚫  NJ シリーズ  CPU ユニット  ユーザーズマニュアル  ハードウェア編（SBCA-466）

マシンオートメーションコントローラ  NX シリーズ

形式

対象バージョン

ロット番号（製造年月日）

NX102-□□□□

Ver.1.64.00 以前

25424（2024 年 4 月 25 日）以前

C09-27-01B

                          No. OMSR-2024-001_ja (  2  /  6  )

NX1P2-□□□□□□

Ver.1.64.00 以前

NX1P2-□□□□□□1

Ver.1.64.00 以前

NX502-□□□□

NX701-□□□□

NX-EIP201

Ver.1.65.01 以前

Ver.1.35.00 以前

Ver.1.00.01 以前

対象バージョンの確認方法は、「別紙  製品バージョンの確認方法」を参照してください。

ロット番号の確認方法は以下のマニュアルの「識別情報表示」を参照してください。

⚫  NX シリーズ  NX102 CPU ユニット  ユーザーズマニュアル  ハードウェア編（SBCA-462）

⚫  NX シリーズ  NX1P2 CPU ユニット  ユーザーズマニュアル  ハードウェア編（SBCA-448）

⚫  NX シリーズ  NX5 CPU ユニット  ユーザーズマニュアル  ハードウェア編（SBCA-497）

⚫  NX シリーズ  NX7 CPU ユニット  ユーザーズマニュアル  ハードウェア編（SBCA-418）
⚫  NX シリーズ  NX-EIP201 EtherNet/IPTM ユニット  ユーザーズマニュアル（SBCD-382）

■脆弱性内容

マシンオートメーションコントローラ NJ／NX シリーズにおいて、パス・トラバーサル（CWE-22）の脆弱性により、当該

コントローラ製品に不正にアクセスでき、リモートで意図しないコードが実行される可能性があります。

■CVSS スコア

パス・トラバーサル  (CWE-22)

CVE-2024-27121

CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H  基本値  7.2

■対策方法

各製品を対策バージョンに更新することで、本脆弱性の対策が可能です。

以下に各製品の対策バージョン、および対策バージョンの提供時期を示します。

マシンオートメーションコントローラ  NJ シリーズ

形式

NJ101-□□□□

NJ301-□□□□

NJ501-1□0□

NJ501-1□2□

NJ501-1340

NJ501-4□□□

NJ501-5300

NJ501-R□□□

対策バージョン

ロット番号（対策バージョン提供時期）

Ver.1.64.04 以(cid:3083)

26424（2024 年 4 月 26 日）以(cid:3083)

Ver.1.64.04 以(cid:3083)

Ver.1.64.04 以(cid:3083)

Ver.1.64.04 以(cid:3083)

Ver.1.64.04 以(cid:3083)

Ver.1.64.04 以(cid:3083)

Ver.1.64.04 以(cid:3083)

Ver.1.64.04 以(cid:3083)

対策バージョンの入手および更新方法については、当社営業にお問い合わせください。

C09-27-01B

マシンオートメーションコントローラ  NX シリーズ

形式

対策バージョン

ロット番号（対策バージョン提供時期）

NX102-□□□□

Ver.1.64.04 以(cid:3083)

26424（2024 年 4 月 26 日）以(cid:3083)

                          No. OMSR-2024-001_ja (  3  /  6  )

NX1P2-□□□□□□

Ver.1.64.04 以(cid:3083)

NX1P2-□□□□□□1

Ver.1.64.04 以(cid:3083)

NX502-□□□□

NX701-□□□□

NX-EIP201

Ver.1.66.01 以(cid:3083)

Ver.1.35.04 以(cid:3083)

Ver.1.01.00 以(cid:3083)

対策バージョンの入手および更新方法については、当社営業にお問い合わせください。

■軽減策・回避策

    本脆弱性の悪用リスクを最小限に抑えるため、以下に示す軽減策を講じることを推奨します。

1.  セキュア通信機能の使用

セキュア通信機能は、第三者によるデータの盗聴や改ざんを防止します。セキュア通信機能は、以下の CPU ユ

ニットのユニットバージョンで使用可能です。

⚫  NJ シリーズ、NX102、NX1P2 CPU ユニット：Ver.1.49 以(cid:3083)

⚫  NX701 CPU ユニット：Ver.1.29 以(cid:3083)

⚫  NX502 CPU ユニット：Ver.1.60 以(cid:3083)

⚫  NX-EIP201：Ver.1.00 以(cid:3083)

2.  アンチウィルス保護

制御システムに接続するパソコンに最新の商用品質のウイルス対策ソフトの導入・保守

3.  不正アクセスの防止

以下に示す対策を講じることを推奨します。

⚫  制御システムや装置のネットワーク接続を最小限に抑え、信頼できないデバイスからのアクセス禁止

⚫  ファイアウォールの導入による IT ネットワークからの分離（未使用通信ポートの遮断、通信ホストの制

限）

⚫  制御システムや装置へのリモートアクセスが必要な場合、仮想プライベートネットワーク  (VPN)の使用

⚫  強固なパスワードの採用と頻繁な変更

⚫  権限保有者のみを制御システムや装置へのアクセスを可能とする物理的統制の導入

⚫  制御システムや装置で USB メモリなど外部ストレージデバイスを使用する場合の事前ウイルススキャン

⚫  制御システムや装置へのリモートアクセス時の多要素認証の導入

4.  データ入出力の保護

制御システムや装置への入出力データの意図せぬ改変に備えた、バックアップや範囲チェックなどの妥当性の確

認

C09-27-01B

                          No. OMSR-2024-001_ja (  4  /  6  )

5.  紛失データの復元

            データ紛失対策としての定期的な設定データのバックアップと保守

■お問い合わせ先

当社営業または販売店にお問い合わせください。

国内お問い合わせ先：https://www.fa.omron.co.jp/sales/local/

海外お問い合わせ先：https://www.ia.omron.com/global_network/index.html

■謝辞

Microsoft 社の  CPS Research Team の Tamir Ariel 氏から報告されました。

Dragos 社の  Principle Vulnerability Analyst の Logan Carpenter 氏から報告されました。

脆弱性を発見、報告いただいた  Tamir Ariel 氏及び Logan Carpenter 氏に感謝いたします。

■更新履歴

    2024/3/7  新規作成

2024/5/27  対象製品、対策バージョンのロット番号(cid:3082)正

C09-27-01B

別紙  製品バージョンの確認方法

製品バージョンの確認方法はシリーズにより異なります。

                          No. OMSR-2024-001_ja (  5  /  6  )

NJ シリーズでの確認方法

Sysmac Studio のマルチビューエクスプローラで【構成・設定】→【CPU・増設ラック】をダブルクリックします。

ユニットエディタの空欄上で右クリックして【生産情報表示】を選択します。

【生産情報】→【詳細表示】を選択します。下図は、Ver.1.10.05 の表示です。

NX シリーズでの確認方法

Sysmac Studio のマルチビューエクスプローラで［構成・設定］の［CPU・増設ラック］の［CPU  ラック］を右クリ

ックして［生産情報表示］を選択します。［生産情報］ダイアログボックスが表示されます。

C09-27-01B

                          No. OMSR-2024-001_ja (  6  /  6  )

［生産情報］ダイアログボックスの右下の、［簡易表示］または［詳細表示］を選択します。［生産情報］の簡

易表示と詳細表示が、切り替わります。下図は、NX502-1500 が Ver.1.60.02、NX-EIP201 が

Ver.1.00.00 の表示です。

C09-27-01B

