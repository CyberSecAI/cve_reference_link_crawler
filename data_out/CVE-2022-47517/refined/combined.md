=== Content from github.com_1870f705_20250108_143033.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdavehorton%2Fsofia-sip%2Fcommit%2Fbfc79d85c8f3a4798a3305fb98f5a11c11d0d29f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdavehorton%2Fsofia-sip%2Fcommit%2Fbfc79d85c8f3a4798a3305fb98f5a11c11d0d29f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=davehorton%2Fsofia-sip)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[davehorton](/davehorton)
/
**[sofia-sip](/davehorton/sofia-sip)**
Public

* [Notifications](/login?return_to=%2Fdavehorton%2Fsofia-sip) You must be signed in to change notification settings
* [Fork
  13](/login?return_to=%2Fdavehorton%2Fsofia-sip)
* [Star
   18](/login?return_to=%2Fdavehorton%2Fsofia-sip)

* [Code](/davehorton/sofia-sip)
* [Issues
  5](/davehorton/sofia-sip/issues)
* [Pull requests
  2](/davehorton/sofia-sip/pulls)
* [Actions](/davehorton/sofia-sip/actions)
* [Projects
  0](/davehorton/sofia-sip/projects)
* [Wiki](/davehorton/sofia-sip/wiki)
* [Security](/davehorton/sofia-sip/security)
* [Insights](/davehorton/sofia-sip/pulse)

Additional navigation options

* [Code](/davehorton/sofia-sip)
* [Issues](/davehorton/sofia-sip/issues)
* [Pull requests](/davehorton/sofia-sip/pulls)
* [Actions](/davehorton/sofia-sip/actions)
* [Projects](/davehorton/sofia-sip/projects)
* [Wiki](/davehorton/sofia-sip/wiki)
* [Security](/davehorton/sofia-sip/security)
* [Insights](/davehorton/sofia-sip/pulse)

## Commit

[Permalink](/davehorton/sofia-sip/commit/bfc79d85c8f3a4798a3305fb98f5a11c11d0d29f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

better fix for prev commit

[Browse files](/davehorton/sofia-sip/tree/bfc79d85c8f3a4798a3305fb98f5a11c11d0d29f)
Browse the repository at this point in the history

* Loading branch information

[![@davehorton](https://avatars.githubusercontent.com/u/1884973?s=40&v=4)](/davehorton)

[davehorton](/davehorton/sofia-sip/commits?author=davehorton "View all commits by davehorton")
committed
Nov 28, 2022

1 parent
[22c1bd1](/davehorton/sofia-sip/commit/22c1bd191f0acbf11f0c0fbea1845d9bf9dcd47e)

commit bfc79d8

Showing
**1 changed file**
with
**6 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

9 changes: 6 additions & 3 deletions

9
[libsofia-sip-ua/url/url.c](#diff-b6aaf30fba9ea640bb21d9afaa2852959e0d46cdbffce5930e59e13a0967847f "libsofia-sip-ua/url/url.c")

Show comments

[View file](/davehorton/sofia-sip/blob/bfc79d85c8f3a4798a3305fb98f5a11c11d0d29f/libsofia-sip-ua/url/url.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -364,8 +364,12 @@ char \*url\_canonize2(char \*d, char const \* const s, size\_t n, |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | if (i >= strlen(s) - 1) return NULL; |
|  |  | h1 = s[i + 1], h2 = s[i + 2]; |
|  |  | h1 = s[i + 1]; |
|  |  | if (!h1) { |
|  |  | \*d = '\0'; |
|  |  | return NULL; |
|  |  | } |
|  |  | h2 = s[i + 2]; |
|  |  |  |
|  |  | if (!IS\_HEX(h1) || !IS\_HEX(h2)) { |
|  |  | \*d = '\0'; |
| Expand Down  Expand Up | | @@ -398,7 +402,6 @@ char \*url\_canonize2(char \*d, char const \* const s, size\_t n, |
|  |  | return d; |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\*\* Canonize a URL component (with precomputed mask). |
|  |  | \* |
|  |  | \* This version does not flag error if \*s contains character that should |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `bfc79d8`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdavehorton%2Fsofia-sip%2Fcommit%2Fbfc79d85c8f3a4798a3305fb98f5a11c11d0d29f) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_9b2eefea_20250108_163456.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-c8mq-83h4-gm57)

**CVE-2022-47517**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-c8mq-83h4-gm57)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2022-47517](/advisories/GHSA-c8mq-83h4-gm57)

## An issue was discovered in the libsofia-sip fork in...

High severity

Unreviewed

Published
Dec 18, 2022
to the GitHub Advisory Database
‚Ä¢
Updated Jan 31, 2023

## Package

No package listed‚Äî
[Suggest a package](/advisories/GHSA-c8mq-83h4-gm57/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

An issue was discovered in the libsofia-sip fork in drachtio-server before 0.8.19. It allows remote attackers to cause a denial of service (daemon crash) via a crafted UDP message that causes a url\_canonize2 heap-based buffer over-read because of an off-by-one error.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2022-47517>
* [drachtio/drachtio-server#243](https://github.com/drachtio/drachtio-server/issues/243)
* [davehorton/sofia-sip@22c1bd1](https://github.com/davehorton/sofia-sip/commit/22c1bd191f0acbf11f0c0fbea1845d9bf9dcd47e)
* [davehorton/sofia-sip@bfc79d8](https://github.com/davehorton/sofia-sip/commit/bfc79d85c8f3a4798a3305fb98f5a11c11d0d29f)

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2022-47517)
Dec 18, 2022

Published to the GitHub Advisory Database
Dec 18, 2022

Last updated
Jan 31, 2023

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.898%
 (83rd percentile)

### Weaknesses

[CWE-787](/advisories?query=cwe%3A787)

### CVE ID

CVE-2022-47517

### GHSA ID

GHSA-c8mq-83h4-gm57

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-c8mq-83h4-gm57/improve).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_09c72fcc_20250108_143033.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdrachtio%2Fdrachtio-server%2Fissues%2F243)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdrachtio%2Fdrachtio-server%2Fissues%2F243)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=drachtio%2Fdrachtio-server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[drachtio](/drachtio)
/
**[drachtio-server](/drachtio/drachtio-server)**
Public

* [Notifications](/login?return_to=%2Fdrachtio%2Fdrachtio-server) You must be signed in to change notification settings
* [Fork
  97](/login?return_to=%2Fdrachtio%2Fdrachtio-server)
* [Star
   250](/login?return_to=%2Fdrachtio%2Fdrachtio-server)

* [Code](/drachtio/drachtio-server)
* [Issues
  104](/drachtio/drachtio-server/issues)
* [Pull requests
  30](/drachtio/drachtio-server/pulls)
* [Actions](/drachtio/drachtio-server/actions)
* [Projects
  0](/drachtio/drachtio-server/projects)
* [Wiki](/drachtio/drachtio-server/wiki)
* [Security](/drachtio/drachtio-server/security)
* [Insights](/drachtio/drachtio-server/pulse)

Additional navigation options

* [Code](/drachtio/drachtio-server)
* [Issues](/drachtio/drachtio-server/issues)
* [Pull requests](/drachtio/drachtio-server/pulls)
* [Actions](/drachtio/drachtio-server/actions)
* [Projects](/drachtio/drachtio-server/projects)
* [Wiki](/drachtio/drachtio-server/wiki)
* [Security](/drachtio/drachtio-server/security)
* [Insights](/drachtio/drachtio-server/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fdrachtio%2Fdrachtio-server%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fdrachtio%2Fdrachtio-server%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# CVE-2022-47517: heap-based buffer overflow in (url\_canonize2 libsofia-sip-ua/url/url.c ?) #243

Closed

[asarubbo](/asarubbo) opened this issue
Nov 26, 2022
¬∑ 9 comments

Closed

# [CVE-2022-47517: heap-based buffer overflow in (url\_canonize2 libsofia-sip-ua/url/url.c ?)](#top) #243

[asarubbo](/asarubbo) opened this issue
Nov 26, 2022
¬∑ 9 comments

## Comments

[![@asarubbo](https://avatars.githubusercontent.com/u/4741819?s=80&v=4)](/asarubbo)

Copy link

### **[asarubbo](/asarubbo)** commented [Nov 26, 2022](#issue-1465246697)

| Hi,  the following remote request is able to crash drachtio:  ``` nc -u PUBLIC_IP 5060 < file  ==3439==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60f0000012ba at pc 0x000000a45552 bp 0x7ffcb041b950 sp 0x7ffcb041b948 READ of size 1 at 0x60f0000012ba thread T0     #0 0xa45551 in url_canonize2 /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/url/url.c:367     #1 0xa4756b in url_d /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/url/url.c:802     #2 0x9bd29d in sip_name_addr_d /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/sip/sip_basic.c:725     #3 0x9bd9b1 in sip_contact_d /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/sip/sip_basic.c:1407     #4 0x9556c5 in header_parse /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/msg/msg_parser.c:1132     #5 0x9556c5 in extract_header /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/msg/msg_parser.c:1071     #6 0x958e4e in extract_next /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/msg/msg_parser.c:1001     #7 0x958e4e in msg_extract /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/msg/msg_parser.c:903     #8 0xa224f1 in tport_parse /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/tport/tport.c:2984     #9 0xa23edf in tport_recv_event /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/tport/tport.c:2954     #10 0xa2a2ff in tport_base_wakeup /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/tport/tport.c:2855     #11 0xa83e2b in su_epoll_port_wait_events /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/su/su_epoll_port.c:510     #12 0xa82a34 in su_base_port_run /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/su/su_base_port.c:349     #13 0x4dc07b in drachtio::DrachtioController::run() ../src/controller.cpp:1336     #14 0x4647ae in main ../src/main.cpp:47     #15 0x7fcb1ded1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x23d09)     #16 0x4846a9 in _start (/usr/local/bin/drachtio-asan+0x4846a9)  0x60f0000012ba is located 0 bytes to the right of 170-byte region [0x60f000001210,0x60f0000012ba) allocated by thread T0 here:     #0 0x7fcb1e8b8e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145     #1 0x9eadce in sub_alloc /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/su/su_alloc.c:541     #2 0x9ebaaa in su_alloc /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/su/su_alloc.c:960     #3 0x954ab7 in msg_header_alloc /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/msg/msg_parser.c:2314     #4 0x955eaf in header_parse /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/msg/msg_parser.c:1114     #5 0x955eaf in extract_header /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/msg/msg_parser.c:1071     #6 0x958e4e in extract_next /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/msg/msg_parser.c:1001     #7 0x958e4e in msg_extract /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/msg/msg_parser.c:903     #8 0xa224f1 in tport_parse /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/tport/tport.c:2984     #9 0xa23edf in tport_recv_event /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/tport/tport.c:2954     #10 0xa2a2ff in tport_base_wakeup /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/tport/tport.c:2855     #11 0xa83e2b in su_epoll_port_wait_events /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/su/su_epoll_port.c:510     #12 0xa82a34 in su_base_port_run /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/su/su_base_port.c:349     #13 0x4dc07b in drachtio::DrachtioController::run() ../src/controller.cpp:1336     #14 0x4647ae in main ../src/main.cpp:47     #15 0x7fcb1ded1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x23d09)  SUMMARY: AddressSanitizer: heap-buffer-overflow /usr/local/src/drachtio-server/deps/sofia-sip/libsofia-sip-ua/url/url.c:367 in url_canonize2 Shadow bytes around the buggy address:   0x0c1e7fff8200: fa fa fa fa fa fa fd fd fd fd fd fd fd fd fd fd   0x0c1e7fff8210: fd fd fd fd fd fd fd fd fd fd fd fd fa fa fa fa   0x0c1e7fff8220: fa fa fa fa fd fd fd fd fd fd fd fd fd fd fd fd   0x0c1e7fff8230: fd fd fd fd fd fd fd fd fd fd fa fa fa fa fa fa   0x0c1e7fff8240: fa fa 00 00 00 00 00 00 00 00 00 00 00 00 00 00 =>0x0c1e7fff8250: 00 00 00 00 00 00 00[02]fa fa fa fa fa fa fa fa   0x0c1e7fff8260: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c1e7fff8270: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c1e7fff8280: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c1e7fff8290: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c1e7fff82a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes):   Addressable:           00   Partially addressable: 01 02 03 04 05 06 07    Heap left redzone:       fa   Freed heap region:       fd   Stack left redzone:      f1   Stack mid redzone:       f2   Stack right redzone:     f3   Stack after return:      f5   Stack use after scope:   f8   Global redzone:          f9   Global init order:       f6   Poisoned by user:        f7   Container overflow:      fc   Array cookie:            ac   Intra object redzone:    bb   ASan internal:           fe   Left alloca redzone:     ca   Right alloca redzone:    cb   Shadow gap:              cc ==3439==ABORTING  ```  While I'm not sure if the issue is in libsofia-sip or drachtio, my guess is that it is in libsofia-sip but I'm filing the issue here because I can reproduce via drachtio.  I'm on v0.8.19-rc12  ``` # drachtio -v 4f3530f  ```  Attaching the testcase as zipped, but to reproduce you need to unzip. [off-by-one.zip](https://github.com/drachtio/drachtio-server/files/10096959/off-by-one.zip) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@davehorton](https://avatars.githubusercontent.com/u/1884973?s=80&u=8fe1bf0343d9113be72cd503ad9cf5ba2749e57b&v=4)](/davehorton)

Copy link

Collaborator

### **[davehorton](/davehorton)** commented [Nov 27, 2022](#issuecomment-1328367643)

| I'm unable to recreate this on the latest build. Log below  ``` 2022-11-27 23:25:02.792103 tport.c:3267 tport_recv_iovec() tport_recv_iovec(0x559aef0c4f20) msg 0x559aef0d1fe0 from (udp/172.20.111.204:5060) has 469 bytes, veclen = 1 2022-11-27 23:25:02.792203 recv 469 bytes from udp/[172.20.111.204]:54228 at 23:25:02.792137: REGISTER sip:drachtio1a SIP/2.0 Via: SIP/2.0/UDP 10.10.5.144:5060;branch=z9hG4bK355579564;rport Route: <sip:drachtio1a:5060;lr> From: <sip:100@drachtio1a>;tag=2013202359 To: <sip:100@drachtio1a> Call-ID: 1844442003-5060-1@BA.BA.F.BEE CSeq: 94363 REGISTER Contact: % X-Grandstream-PBX: true Max-Forwards: 70 User-Agent: Grandstream GXP2160 1.0.9.134 Expires: 0 Allow: INVITE, ACK, OPTIONS, CANCEL, BYE, SUBSCRIBE, NOTIFY, INFO, REFER, UPDATE, MESSAGE Content-Length: 0  2022-11-27 23:25:02.792247 tport.c:3085 tport_deliver() tport_deliver(0x559aef0c4f20): msg 0x559aef0d1fe0 (469 bytes) from udp/172.20.111.204:5060 next=(nil) 2022-11-27 23:25:02.792268 tport.c:1171 tport_ref() tport_ref(0x559aef0c4f20): refcount is now 1 2022-11-27 23:25:02.792283 nta.c:3046 agent_recv_request() nta: received REGISTER sip:drachtio1a SIP/2.0 (CSeq 94363) 2022-11-27 23:25:02.792296 nta.c:3111 agent_recv_request() nta: REGISTER has bad Contact header 2022-11-27 23:25:02.792312 nta.c:3346 agent_check_request_via() nta: Via check: received=172.20.111.204 2022-11-27 23:25:02.792333 nta.c:3127 agent_recv_request() nta: REGISTER (94363) is Bad Contact Header 2022-11-27 23:25:02.792359 tport.c:3322 tport_tsend() tport_tsend(0x559aef0c4f20) tpn = UDP/172.20.111.204:54228 2022-11-27 23:25:02.792379 tport.c:4122 tport_resolve() tport_resolve addrinfo = 172.20.111.204:54228 2022-11-27 23:25:02.792397 tport.c:4811 tport_by_addrinfo() tport_by_addrinfo(0x559aef0c4f20): not found by name UDP/172.20.111.204:54228 2022-11-27 23:25:02.792410 tport.c:4811 tport_by_addrinfo() tport_by_addrinfo(0x559aef0c53d0): not found by name UDP/172.20.111.204:54228 2022-11-27 23:25:02.792422 tport.c:4811 tport_by_addrinfo() tport_by_addrinfo(0x559aef0c58a0): not found by name UDP/172.20.111.204:54228 2022-11-27 23:25:02.792438 tport.c:4811 tport_by_addrinfo() tport_by_addrinfo(0x559aef0c5da0): not found by name UDP/172.20.111.204:54228 2022-11-27 23:25:02.792454 tport.c:4811 tport_by_addrinfo() tport_by_addrinfo(0x559aef0c6270): not found by name UDP/172.20.111.204:54228 2022-11-27 23:25:02.792467 tport.c:4811 tport_by_addrinfo() tport_by_addrinfo(0x559aef0c6740): not found by name UDP/172.20.111.204:54228 2022-11-27 23:25:02.792567 tport.c:3572 tport_send_msg() tport_vsend returned 297 2022-11-27 23:25:02.792604 send 297 bytes to udp/[172.20.111.204]:54228 at 23:25:02.792489: SIP/2.0 400 Bad Contact Header Via: SIP/2.0/UDP 10.10.5.144:5060;branch=z9hG4bK355579564;rport=54228;received=172.20.111.204 From: <sip:100@drachtio1a>;tag=2013202359 To: <sip:100@drachtio1a>;tag=ct3yD4504ZaKg Call-ID: 1844442003-5060-1@BA.BA.F.BEE CSeq: 94363 REGISTER Content-Length: 0  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@davehorton](https://avatars.githubusercontent.com/u/1884973?s=80&u=8fe1bf0343d9113be72cd503ad9cf5ba2749e57b&v=4)](/davehorton)

Copy link

Collaborator

### **[davehorton](/davehorton)** commented [Nov 28, 2022](#issuecomment-1328402667)

| I was able to see the off-by-one access when using valgrind. Fixed in v0.8.19-rc14 |
| --- |

All reactions

Sorry, something went wrong.

[![@davehorton](https://avatars.githubusercontent.com/u/1884973?s=40&u=8fe1bf0343d9113be72cd503ad9cf5ba2749e57b&v=4)](/davehorton)
[davehorton](/davehorton)
closed this as [completed](/drachtio/drachtio-server/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Nov 28, 2022](#event-7898546296)

[![@asarubbo](https://avatars.githubusercontent.com/u/4741819?s=80&v=4)](/asarubbo)

Copy link

Author

### **[asarubbo](/asarubbo)** commented [Dec 20, 2022](#issuecomment-1359370294)

| [CVE-2022-47517](https://github.com/advisories/GHSA-c8mq-83h4-gm57 "CVE-2022-47517") has been assigned to this issue. |
| --- |

All reactions

Sorry, something went wrong.

[![@asarubbo](https://avatars.githubusercontent.com/u/4741819?s=40&v=4)](/asarubbo)
[asarubbo](/asarubbo)
changed the title
~~heap-based buffer overflow in (url\_canonize2 libsofia-sip-ua/url/url.c ?)~~
CVE-2022-47517: heap-based buffer overflow in (url\_canonize2 libsofia-sip-ua/url/url.c ?)
[Dec 20, 2022](#event-8078548572)

[![@davehorton](https://avatars.githubusercontent.com/u/1884973?s=80&u=8fe1bf0343d9113be72cd503ad9cf5ba2749e57b&v=4)](/davehorton)

Copy link

Collaborator

### **[davehorton](/davehorton)** commented [Dec 20, 2022](#issuecomment-1359659773)

| ok it seems like you opened this CVE 2 days ago, with no fix information, yet per above I fixed it 3 weeks ago |
| --- |

All reactions

Sorry, something went wrong.

[![@asarubbo](https://avatars.githubusercontent.com/u/4741819?s=80&v=4)](/asarubbo)

Copy link

Author

### **[asarubbo](/asarubbo)** commented [Dec 20, 2022](#issuecomment-1359674316)

| where did you see no fix information? |
| --- |

All reactions

Sorry, something went wrong.

[![@davehorton](https://avatars.githubusercontent.com/u/1884973?s=80&u=8fe1bf0343d9113be72cd503ad9cf5ba2749e57b&v=4)](/davehorton)

Copy link

Collaborator

### **[davehorton](/davehorton)** commented [Dec 20, 2022](#issuecomment-1359678305)

| Oh, I was looking at "Patched versions: unknown". I see the description indicates the fix version now, so that is good. Thanks, sorry for the misunderstanding |
| --- |

All reactions

Sorry, something went wrong.

[![@asarubbo](https://avatars.githubusercontent.com/u/4741819?s=80&v=4)](/asarubbo)

Copy link

Author

### **[asarubbo](/asarubbo)** commented [Dec 21, 2022](#issuecomment-1361345759) ‚Ä¢ edited Loading

| Hi Dave, no problem. Just keep in mind that the link you can see as [CVE-2022-47517](https://github.com/advisories/GHSA-c8mq-83h4-gm57 "CVE-2022-47517") ([GHSA-c8mq-83h4-gm57](https://github.com/advisories/GHSA-c8mq-83h4-gm57 "GHSA-c8mq-83h4-gm57")) is done automatically by github. The official reference is always at <https://cve.mitre.org> |
| --- |

All reactions

Sorry, something went wrong.

[![@AdrianBunk](https://avatars.githubusercontent.com/u/3358267?s=80&u=86d7f4d590bfcf024de4837ad6e841fe4f2f1b2f&v=4)](/AdrianBunk)

Copy link

### **[AdrianBunk](/AdrianBunk)** commented [Feb 22, 2023](#issuecomment-1440044083)

| [@davehorton](https://github.com/davehorton) [@asarubbo](https://github.com/asarubbo) Looking at [davehorton/sofia-sip@bfc79d8](https://github.com/davehorton/sofia-sip/commit/bfc79d85c8f3a4798a3305fb98f5a11c11d0d29f), is [CVE-2022-47517](https://nvd.nist.gov/vuln/detail/CVE-2022-47517) a duplicate of the first part of [CVE-2022-31002](https://nvd.nist.gov/vuln/detail/CVE-2022-31002), and the `url_canonize3()` part of [freeswitch/sofia-sip@51841eb](https://github.com/freeswitch/sofia-sip/commit/51841eb53679434a386fb2dcbca925dcc48d58ba) is still missing here? |
| --- |

 üëç
1
 ccppprogrammer reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@davehorton](https://avatars.githubusercontent.com/u/1884973?s=80&u=8fe1bf0343d9113be72cd503ad9cf5ba2749e57b&v=4)](/davehorton)

Copy link

Collaborator

### **[davehorton](/davehorton)** commented [Feb 22, 2023](#issuecomment-1440746072)

| yes, you are right. I will commit the second part of that change shortly |
| --- |

All reactions

Sorry, something went wrong.

[davehorton](/davehorton)
added a commit
to davehorton/sofia-sip
that referenced
this issue
[Feb 22, 2023](#ref-commit-77e79d2)
[![@davehorton](https://avatars.githubusercontent.com/u/1884973?s=40&u=8fe1bf0343d9113be72cd503ad9cf5ba2749e57b&v=4)](/davehorton)

`[fix url_canonize3() heap overflow as mentioned in](/davehorton/sofia-sip/commit/77e79d2d917fc2bac1f416b4da48284a3eaaf5be "fix url_canonize3() heap overflow as mentioned in https://github.com/drachtio/drachtio-server/issues/243") [drachtio/drachtio-s‚Ä¶](https://github.com/drachtio/drachtio-server/issues/243)`
‚Ä¶

`[77e79d2](/davehorton/sofia-sip/commit/77e79d2d917fc2bac1f416b4da48284a3eaaf5be)`

```
[‚Ä¶erver#243](https://github.com/drachtio/drachtio-server/issues/243)
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fdrachtio%2Fdrachtio-server%2Fissues%2F243)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

3 participants

[![@davehorton](https://avatars.githubusercontent.com/u/1884973?s=52&v=4)](/davehorton) [![@AdrianBunk](https://avatars.githubusercontent.com/u/3358267?s=52&v=4)](/AdrianBunk) [![@asarubbo](https://avatars.githubusercontent.com/u/4741819?s=52&v=4)](/asarubbo)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_23185493_20250108_143032.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdavehorton%2Fsofia-sip%2Fcommit%2F22c1bd191f0acbf11f0c0fbea1845d9bf9dcd47e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdavehorton%2Fsofia-sip%2Fcommit%2F22c1bd191f0acbf11f0c0fbea1845d9bf9dcd47e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=davehorton%2Fsofia-sip)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[davehorton](/davehorton)
/
**[sofia-sip](/davehorton/sofia-sip)**
Public

* [Notifications](/login?return_to=%2Fdavehorton%2Fsofia-sip) You must be signed in to change notification settings
* [Fork
  13](/login?return_to=%2Fdavehorton%2Fsofia-sip)
* [Star
   18](/login?return_to=%2Fdavehorton%2Fsofia-sip)

* [Code](/davehorton/sofia-sip)
* [Issues
  5](/davehorton/sofia-sip/issues)
* [Pull requests
  2](/davehorton/sofia-sip/pulls)
* [Actions](/davehorton/sofia-sip/actions)
* [Projects
  0](/davehorton/sofia-sip/projects)
* [Wiki](/davehorton/sofia-sip/wiki)
* [Security](/davehorton/sofia-sip/security)
* [Insights](/davehorton/sofia-sip/pulse)

Additional navigation options

* [Code](/davehorton/sofia-sip)
* [Issues](/davehorton/sofia-sip/issues)
* [Pull requests](/davehorton/sofia-sip/pulls)
* [Actions](/davehorton/sofia-sip/actions)
* [Projects](/davehorton/sofia-sip/projects)
* [Wiki](/davehorton/sofia-sip/wiki)
* [Security](/davehorton/sofia-sip/security)
* [Insights](/davehorton/sofia-sip/pulse)

## Commit

[Permalink](/davehorton/sofia-sip/commit/22c1bd191f0acbf11f0c0fbea1845d9bf9dcd47e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix off-by-one access triggered eg by Contact: %

[Browse files](/davehorton/sofia-sip/tree/22c1bd191f0acbf11f0c0fbea1845d9bf9dcd47e)
Browse the repository at this point in the history

* Loading branch information

[![@davehorton](https://avatars.githubusercontent.com/u/1884973?s=40&v=4)](/davehorton)

[davehorton](/davehorton/sofia-sip/commits?author=davehorton "View all commits by davehorton")
committed
Nov 28, 2022

1 parent
[0309d0b](/davehorton/sofia-sip/commit/0309d0bb7db116cd7cc65227d2af781353fc337d)

commit 22c1bd1

Showing
**1 changed file**
with
**4 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

7 changes: 4 additions & 3 deletions

7
[libsofia-sip-ua/url/url.c](#diff-b6aaf30fba9ea640bb21d9afaa2852959e0d46cdbffce5930e59e13a0967847f "libsofia-sip-ua/url/url.c")

Show comments

[View file](/davehorton/sofia-sip/blob/22c1bd191f0acbf11f0c0fbea1845d9bf9dcd47e/libsofia-sip-ua/url/url.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -185,7 +185,7 @@ int url\_reserved\_p(char const \*s) |
|  |  | \* The number of characters in corresponding but escaped string. |
|  |  | \* |
|  |  | \* You can handle a part of URL with reserved characters like this: |
|  |  | \*¬†@code |
|  |  | \*ÔøΩ@code |
|  |  | \* if (url\_reserved\_p(s)) { |
|  |  | \* n = malloc(url\_esclen(s, NULL) + 1); |
|  |  | \* if (n) url\_escape(n, s); |
| Expand Down  Expand Up | | @@ -364,6 +364,7 @@ char \*url\_canonize2(char \*d, char const \* const s, size\_t n, |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | if (i >= strlen(s) - 1) return NULL; |
|  |  | h1 = s[i + 1], h2 = s[i + 2]; |
|  |  |  |
|  |  | if (!IS\_HEX(h1) || !IS\_HEX(h2)) { |
| Expand Down  Expand Up | | @@ -1088,7 +1089,7 @@ char \*copy(char \*buf, char \*end, char const \*src) |
|  |  | \* @param buf Buffer for non-constant strings copied from @a src. |
|  |  | \* @param bufsize Size of @a buf. |
|  |  | \* @param dst Destination URL structure. |
|  |  | \*¬†@param src Source URL structure. |
|  |  | \*ÔøΩ@param src Source URL structure. |
|  |  | \* |
|  |  | \* @return Number of characters required for |
|  |  | \* duplicating the strings in @a str, or -1 if an error |
| Expand Down  Expand Up | | @@ -1172,7 +1173,7 @@ issize\_t url\_dup(char \*buf, isize\_t bufsize, url\_t \*dst, url\_t const \*src) |
|  |  | \* @param buf Buffer for non-constant strings copied from @a src. |
|  |  | \* @param end End of @a buf. |
|  |  | \* @param dst Destination URL structure. |
|  |  | \*¬†@param src Source URL structure. |
|  |  | \*ÔøΩ@param src Source URL structure. |
|  |  | \* |
|  |  | \* @return |
|  |  | \* The macro URL\_DUP() returns pointer to first unused byte in the |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `22c1bd1`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdavehorton%2Fsofia-sip%2Fcommit%2F22c1bd191f0acbf11f0c0fbea1845d9bf9dcd47e) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


