=== Content from learn.liferay.com_dc4d6cfb_20250110_202134.html ===

[Skip to Main Content](#main-content)

Liferay Sites

[Liferay.com](https://www.liferay.com)
[Community](https://liferay.dev)
[Marketplace](https://marketplace.liferay.com)

EN (US)

* English
* [日本語](/c/portal/update_language?redirect=%2Fw%2F%2Fdxp%2Fsystem-administration%2Fusing-the-script-engine%2Frunning-scripts-from-the-script-console&groupId=23484947&privateLayout=false&layoutId=69&languageId=ja_JP)

Account

[Dashboard](https://learn.liferay.com/user-dashboard)

[Create An Account](https://login.liferay.com/signin/register)
[Sign In](https://learn.liferay.com/c/portal/login?p_l_id=5051)

[Learn](https://learn.liferay.com/home)

Menu

Close

Documentation

Capabilities
[Cloud
Use Liferay's Cloud infrastructure to launch your solutions more quickly and securely.](https://learn.liferay.com/capabilities/cloud)
[Commerce
Increase orders with enriching product information, easy ordering tools, and product recommendations.](https://learn.liferay.com/capabilities/commerce)
[Content Management System
Create, publish, and manage content, pages, and multimedia across different channels faster.](https://learn.liferay.com/capabilities/content-management-system)
[Development and Tooling
Use out-of-the-box features and development tools to deliver solutions to users faster.](https://learn.liferay.com/capabilities/development-and-tooling)
[Digital Asset Mangement
Use Liferay's Cloud infrastructure to launch your solutions more quickly and securely.](https://learn.liferay.com/capabilities/digital-asset-management)
[All Capabilities
Discover all of DXP's product capabilities](https://learn.liferay.com/documentation)

Products
[Analytics Cloud
Understand your audience with integrated analytics for Liferay DXP.](/w/analytics-cloud/index)
[Commerce
Launch modern B2B commerce experiences on Liferay DXP.](/w/commerce/index)
[Liferay Cloud
Enterprise PaaS tailored for Liferay Digital Experience Platform.](/w/liferay-cloud/index)
[DXP
Transition from legacy systems and build digital experiences on a single powerful platform.](/w/dxp/index)
[Reference
Documents and resources to further help implementation.](/w/reference/index)

Education

Education
[Education Resources
Become a Liferay master with guided content created by Liferay experts.](https://learn.liferay.com/education/index)
[Courses
Learn at your own pace with self-directed courses that guide you through specific topics in-depth.](https://learn.liferay.com/education/courses)
[Learning Paths
Take a structured learning path tailored to your role and experience level, ensuring you gain the Liferay skills you need.](https://learn.liferay.com/education/learning-paths)

![](/documents/d/guest/dxp_p-svg)

DXP / Portal

* [![](/documents/d/guest/analytics_c-svg)

  Analytics Cloud](/w/analytics-cloud/index)
* [![](/documents/d/guest/commerce_product-svg)

  Commerce](/w/commerce/index)
* [![](/documents/d/guest/dxp_p-svg)

  DXP / Portal](/w/dxp/index)
* [![](/documents/d/guest/dxp_c-svg)

  Liferay Cloud](/w/liferay-cloud/index)
* [![](/documents/d/guest/reference-svg)

  Reference](/w/reference/index)

Using the Script Engine

* [Invoking Liferay Services From Scripts](/w/dxp/system-administration/using-the-script-engine/invoking-liferay-services-from-scripts)
* [Running Scripts From the Script Console](/w/dxp/system-administration/using-the-script-engine/running-scripts-from-the-script-console)
* [Script Examples](/w/dxp/system-administration/using-the-script-engine/script-examples)

* [DXP](/w/dxp/index)
* [System Administration](/w/dxp/system-administration)
* [Using the Script Engine](/w/dxp/system-administration/using-the-script-engine)
* Running Scripts From the Script Console

[Submit Feedback](https://liferay.dev/c/portal/login?redirect=https://liferay.dev/ask/questions/liferay-learn-feedback/new)

# [Running Scripts From the Script Console](#running-scripts-from-the-script-console)

The Script Console provides a single view for executing Groovy scripts and printing their output. It has predefined variables that facilitate working with widgets and users. The following topics get you started with the Script Console:

* [Running a Sample Script in the Script Console](#running-a-sample-script-in-the-script-console)
* [Predefined variables available in the Script Console](#predefined-variables)
* [Tips for running scripts in the Script Console](#tips)

Important

The Script Console is for system operations and maintenance—it’s not for end users. Limit Script Console access to portal administrators.

Start with running the Script Console’s sample script.

## [Running a Sample Script in the Script Console](#running-a-sample-script-in-the-script-console)

Here’s how to run the sample script in the Script Console:

1. Sign in as an administrator.
2. In the Product Menu, navigate to *Control Panel* and select *System* → *Server Administration*.
3. Click on *Script*. This is the Script Console. The default sample script prints the User count to the console output.

   ```
   // ### Groovy Sample ###

   number = com.liferay.portal.kernel.service.UserLocalServiceUtil.getUsersCount();

   out.println(number);

   ```
4. Click *Execute* and check the Script Console *Output* for the User count.

   ![The Script Console's sample Groovy script prints the User count to Script Console output.](https://resources.learn.liferay.com/images/dxp/latest/en/system-administration/using-the-script-engine/running-scripts-from-the-script-console/images/01.png)

The Groovy sample invokes the Liferay service utility [`UserLocalServiceUtil`](https://resources.learn.liferay.com/reference/latest/en/dxp/javadocs/portal-kernel/com/liferay/portal/kernel/service/UserLocalServiceUtil.html) to get the user count. Then it uses `out` (a built-in `PrintWriter`) to write the count to the Script Console.

Note

If you use *System.out.println* instead of *out.println*, your output is printed to Liferay’s log file rather than to the Script Console.

## [Predefined Script Console Variables](#predefined-script-console-variables)

Here are the predefined variables available to scripts in the Script Console:

| Variable | Class |
| --- | --- |
| `out` | `java.io.PrintWriter` |
| `actionRequest` | `javax.portlet.ActionRequest` |
| `actionResponse` | `javax.portlet.ActionReponse` |
| `portletConfig` | `javax.portlet.PortletConfig` |
| `portletContext` | `javax.portlet.PortletContext` |
| `preferences` | `javax.portlet.PortletPreferences` |
| `userInfo` | `java.util.Map<String, String>` |

### [Variable Usage](#variable-usage)

This script demonstrates using the `actionRequest` variable to get the portal instance’s `Company`:

```
import com.liferay.portal.kernel.util.*

company = PortalUtil.getCompany(actionRequest)
out.println("Current Company:${company.getName()}\n")

out.println("User Info:")
userInfo.each {
        k,v -> out.println("${k}:${v}")
}

```

![Here's an example of invoking a Groovy script that uses the predefined out, actionRequest, and userInfo variables to print information about the Company and User.](https://resources.learn.liferay.com/images/dxp/latest/en/system-administration/using-the-script-engine/running-scripts-from-the-script-console/images/02.png)

## [Tips](#tips)

Keep these things in mind when using the Script Console:

* There is no undo.
* There is no preview.
* Permissions checking is not enforced for local services.
* Scripts are executed synchronously. Avoid executing scripts that might take a long time.

Use the Script Console cautiously and test your scripts on non-production systems before running them on production.

The script engine can be used outside of the Script Console, such as in a Kaleo Workflow. Using the script engine in workflows is next.

## [Related Topics](#related-topics)

* [Invoking Liferay services](./invoking-liferay-services-from-scripts)
* [Using the Script Engine in Workflow](../../process-automation/workflow/developer-guide/using-the-script-engine-in-workflow)
* [Script Examples](./script-examples)

Capability:

[Development and Tooling](/search?category=23488667)

Resource Type:

[Official Documentation](/search?category=23488725)

Feature:

[Developer Tools](/search?category=23488966)

Deployment Approach:

[Liferay PaaS](/search?category=23490691)

[Liferay Self-Hosted](/search?category=23493270)

[Liferay.com](https://www.liferay.com)

[Ask](https://liferay.dev/ask)

[Events](https://www.liferay.com/events)

[Meet](https://liferay.dev/meet)

Capabilities

[View All Capabilities](/)

Product

[Analytics Cloud](/w/analytics-cloud/index)

[Commerce](/w/commerce/index)

[DXP](/w/dxp/index)

[Liferay Cloud](/w/liferay-cloud/index)

[Reference](/w/reference/index)

Education

[Courses](/education/courses)

[Learning Paths](/education/learning-paths)

Contact Us

[Submit Feedback](https://liferay.dev/c/portal/login?redirect=https://liferay.dev/ask/questions/liferay-learn-feedback/new)

Connect

Powered by [Liferay](https://www.liferay.com)

© 2024 Liferay Inc. All Rights Reserved • Privacy Policy

Hidden

We use cookies to deliver personalized content, analyze trends, administer the site, track user movements on the site, and collect demographic information about our user base as a whole. Accept all cookies for the best possible experience on our website or manage your preferences.
Visit our Privacy Policy

Configuration

Accept All

Decline All



=== Content from medium.com_17a58a93_20250110_202134.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F84498bde18d3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40tranpdanh%2Fsome-way-to-execute-os-command-in-liferay-portal-84498bde18d3&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40tranpdanh%2Fsome-way-to-execute-os-command-in-liferay-portal-84498bde18d3&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Some way to execute OS command in Liferay Portal

[![TPDanh](https://miro.medium.com/v2/resize:fill:88:88/0*dpUI7w3rpCPYVGRq.jpg)](/%40tranpdanh?source=post_page---byline--84498bde18d3--------------------------------)

[TPDanh](/%40tranpdanh?source=post_page---byline--84498bde18d3--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffb70136f517e&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40tranpdanh%2Fsome-way-to-execute-os-command-in-liferay-portal-84498bde18d3&user=TPDanh&userId=fb70136f517e&source=post_page-fb70136f517e--byline--84498bde18d3---------------------post_header-----------)

3 min read·Nov 15, 2020

--

Listen

Share

Recently, I have a chance to work with Liferay CE Portal and explore some attack vectors to execute OS command on it.

**What is Liferay Portal?**

Liferay Portal is a portal solution designed in accordance with application models in agencies, organizations and businesses wishing to develop information systems on the web environment to perform online transactions and use the Intranet / Internet as an essential tool in operations, information provision, communication, management, and administration, with a variety of utilities, exchange and collaboration.

![]()

Deployment diagram for a Liferay Portal instance

**The journey to discover Vulnerabilitiess**

When try to exploit the target (Liferay Portal Server), I found that I can access with admin privilage with default account **test@liferay.com**/**test**(critical bug)**.** With admin privilage, I can do many thing but my purpose is Remote Code Execution (RCE) the target. That’s why I found 2 way to execute OS command in Liferay Portal Server.

**First vulnerability**: Admin user can execute any OS command on Liferay Portal Server via Groovy Script.

Try to find the way to execute command on the target server, I read lots about Liferay Portal and found out Administrator can execute Groovy Script. [The document](https://learn.liferay.com/dxp/7.x/en/system-administration/using-the-script-engine/running-scripts-from-the-script-console.html) about Groovy Script shows that this module has predefined variables that facilitate working with widgets and users. That sound like a box, what happend if I can escape the box ? I can execute OS command on the Sever. That is my purpose.

Let’s go ahead. Access this path, I can run Groovy Script.

> https://[domain]/group/control\_panel/manage?p\_p\_id=com\_liferay\_server\_admin\_web\_portlet\_ServerAdminPortlet&p\_p\_lifecycle=0&p\_p\_state=maximized&p\_p\_mode=view&\_com\_liferay\_server\_admin\_web\_portlet\_ServerAdminPortlet\_mvcRenderCommandName=%2Fserver\_admin%2Fview&\_com\_liferay\_server\_admin\_web\_portlet\_ServerAdminPortlet\_tabs1=script

![]()

After a while I searched for the script can help my purpose, I found this one. Inject the script below to the Script box to execute any OS command.

```
def sout = new StringBuilder(), serr = new StringBuilder()
def proc = '[command]'.execute()
proc.consumeProcessOutput(sout, serr)
proc.waitForOrKill(1000)
println "out> $sout err> $serr"
```

Replace [command] with any OS command, I tested on Linux server with command “ls -la”.

![]()

The script get the command, execute it on the server and get standard output, standard error then print to browser.

**Second vulnerability**: Admin user can execute any OS command on Liferay Portal Server via Gogo Shell module.

When access Liferay Portal control panel, I saw the module named “Gogo shell”. The name is very promising for my purposes. I found and read [the document](https://learn.liferay.com/dxp/7.x/en/liferay-internals/fundamentals/using-the-gogo-shell/using-the-gogo-shell.html) about this module. The Gogo shell provides a way to interact with the module framework. There a [list command](https://learn.liferay.com/dxp/7.x/en/liferay-internals/fundamentals/using-the-gogo-shell/gogo-shell-commands.html) that were defined. Example run “help” to show list command, “lb” to list all of the bundles installed in Liferay’s module framework. That like a box same with first vulnerability. I must figure out the way to escape that box.
The URL to access Gogo Shell module:

> https://[domain]/group/control\_panel/manage?p\_p\_id=com\_liferay\_gogo\_shell\_web\_internal\_portlet\_GogoShellPortlet&p\_p\_lifecycle=0&p\_p\_state=maximized&p\_p\_mode=view&\_com\_liferay\_gogo\_shell\_web\_internal\_portlet\_GogoShellPortlet\_javax.portlet.action=executeCommand&p\_p\_auth=GQ1fDPiH

I try to insert command not in list command defined. And success, the OS command run on the target server and print the result on the browser.

![]()

I think Liferay Portal need more mechanisms to check which script/command can be executed via Groovy Script and Gogo Shell module.

Both vulnerabilities were tested on Liferay Portal CE 7.3.5 GA6 and Liferay Portal CE 7.2.0 GA1.

I am @[babywolf](https://www.linkedin.com/in/tran-phu-danh-51a4b0135/). Thank @[ledz1996](https://hackerone.com/ledz1996?type=user) for suppoting me to find out these vulneratbilities.

[Liferay](/tag/liferay?source=post_page-----84498bde18d3--------------------------------)[Rce](/tag/rce?source=post_page-----84498bde18d3--------------------------------)[Exploit](/tag/exploit?source=post_page-----84498bde18d3--------------------------------)

--

--

[![TPDanh](https://miro.medium.com/v2/resize:fill:96:96/0*dpUI7w3rpCPYVGRq.jpg)](/%40tranpdanh?source=post_page---post_author_info--84498bde18d3--------------------------------)[![TPDanh](https://miro.medium.com/v2/resize:fill:128:128/0*dpUI7w3rpCPYVGRq.jpg)](/%40tranpdanh?source=post_page---post_author_info--84498bde18d3--------------------------------)Follow[## Written by TPDanh](/%40tranpdanh?source=post_page---post_author_info--84498bde18d3--------------------------------)[1 Follower](/%40tranpdanh/followers?source=post_page---post_author_info--84498bde18d3--------------------------------)·[7 Following](/%40tranpdanh/following?source=post_page---post_author_info--84498bde18d3--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----84498bde18d3--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----84498bde18d3--------------------------------)[About](/about?autoplay=1&source=post_page-----84498bde18d3--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----84498bde18d3--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----84498bde18d3--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----84498bde18d3--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----84498bde18d3--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----84498bde18d3--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----84498bde18d3--------------------------------)[Teams](/business?source=post_page-----84498bde18d3--------------------------------)


