```
{
  "vulnerability": {
    "root_cause": "The Weave GitOps Terraform Controller was inadvertently printing sensitive data to pod logs via the tf-runner component. Specifically, the `tfexec.ShowPlan`, `tfexec.ShowPlanRaw`, and `tfexec.Output` functions were configured to write to `os.Stdout` and `os.Stderr`.",
    "weaknesses": [
      "CWE-200",
      "CWE-312",
      "CWE-522",
      "CWE-532"
    ],
    "impact": "An authenticated remote attacker could exploit this vulnerability to access sensitive information, such as configurations or tokens, which could allow for unauthorized control or access to resources managed by the Terraform controller.",
    "attack_vectors": "The vulnerability is exploitable via the network by accessing pod logs containing the sensitive information.",
    "attacker_capabilities": "An attacker needs to be authenticated and have the capability to access the pod logs where the sensitive information was exposed."
  },
  "fixes": [
    {
      "commit_id": "9708fda28ccd0466cb0a8fd409854ab4d92f7dca",
      "description": "This commit addresses the issue of sensitive data being logged in tf-runner by disabling stdout and stderr logging during `tfexec.ShowPlan` and `tfexec.ShowPlanRaw` calls. The logging is then re-enabled after the call."
    },
    {
      "commit_id": "6323b355bd7f5d2ce85d0244fe0883af3881df4e",
        "description": "This commit introduces helper functions `tfShowPlanFile` and `tfShowPlanFileRaw` that disable logging before calling `tfexec.ShowPlanFile` and `tfexec.ShowPlanFileRaw` and re-enables them afterwards. This ensures sensitive information is not leaked via logs during plan operations."
    },
   {
      "commit_id": "28282bc644054e157c3b9a3d38f1f9551ce09074",
        "description": "This commit addresses the sensitive information leak in the `tf.Output` function by adding a wrapper `tfOutput` that disables logging before the call and re-enables it after. This prevents sensitive data from being exposed in logs."
    },
   {
     "commit_id": "98a0688036e9dbcf43fa84960d9a1ef3e09a69cf",
      "description": "This commit fixes the logging issue related to `tf.Output`. A new function `tfOutput` is introduced to disable logging before calling `tf.Output` and re-enables it after. This prevents sensitive data from being printed to logs during output operations."
   }

  ],
  "workarounds": "Users can set the environment variable `DISABLE_TF_LOGS` to `1` in the tf-runner pod template to temporarily disable the logging of sensitive information.",
  "cvss": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N"
}
```