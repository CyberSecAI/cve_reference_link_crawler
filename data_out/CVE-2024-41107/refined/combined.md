=== Content from www.openwall.com_c308adf3_20250111_170528.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2024/07/18/4) [[next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAM1si4Xe91A5i2qHLBfcu-OPwDu-cN8xeG8KsmEL6MD_3xpVeQ@mail.gmail.com>
Date: Fri, 19 Jul 2024 15:38:30 +0530
From: Abhishek Kumar <shwstppr@...che.org>
To: oss-security@...ts.openwall.com
Subject: [ANNOUNCE] Apache CloudStack CVE-2024-41107: SAML Signature Exclusion

Apache CloudStack project announces the release of LTS releases 4.19.1.0
and 4.18.2.2 that addresses CVE-2024-41107 that affects CloudStack SAML
users, of severity 'important' explained below.

# CVE-2024-41107: SAML Signature Exclusion

The CloudStack SAML authentication (disabled by default) does not enforce
signature check. In CloudStack environments where SAML authentication is
enabled, an attacker that initiates CloudStack SAML single sign-on
authentication can bypass SAML authentication by submitting a spoofed SAML
response with no signature and known or guessed username and other user
details of a SAML-enabled CloudStack user-account. In such environments,
this can result in a complete compromise of the resources owned and/or
accessible by a SAML enabled user-account.

# Credits

The original issue was reported by Christian Gross of Netcloud AG who filed
it as a bug report at <https://github.com/apache/cloudstack/issues/4519>.

More recently it was reported as a security issue by the following
reporters from the Apple Services Engineering Security team:

- Damon Smith
- Adam Pond
- Terry Thibault

# Affected Versions

- Apache CloudStack 4.5.0 through 4.18.2.1
- Apache CloudStack 4.19.0.0 through 4.19.0.2

# Resolution

Affected users are recommended to disable the SAML authentication plugin
by setting the "saml2.enabled" global setting to "false", or upgrade to
version 4.18.2.2, 4.19.1.0 or later, which addresses this issue.

# Downloads and Documentation

The official source code for the 4.18.2.2 and 4.19.1.0 releases can be
downloaded from the project downloads page:
<https://cloudstack.apache.org/downloads>

The 4.18.2.2 and 4.19.1.0 release notes can be found at:
<https://docs.cloudstack.apache.org/en/4.18.2.2/releasenotes/about.html>
<https://docs.cloudstack.apache.org/en/4.19.1.0/releasenotes/about.html>

In addition to the official source code release, individual contributors
have also made release packages available on the Apache CloudStack
download page, and available at:

<https://download.cloudstack.org/el/7/>
<https://download.cloudstack.org/el/8/>
<https://download.cloudstack.org/el/9/>
<https://download.cloudstack.org/suse/15/>
<https://download.cloudstack.org/ubuntu/dists/>
<https://www.shapeblue.com/cloudstack-packages/>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from cloudstack.apache.org_7d35fe6f_20250111_170528.html ===

[Skip to main content](#__docusaurus_skipToContent_fallback)[![apache-cloudstack](/img/navlogo.png)![apache-cloudstack](/img/navlogo.png)](/)About

* [About](/about)
* [History](/history)
* [Features](/features)
* [Who We Are](/who)
* [Community Bylaws](/bylaws)
* [Trademark Guidelines](/trademark-guidelines)
* [Security](/security)
Community

* [Get Involved](/contribute)
* [Developer Resources](/developers)
* [Join Mailing Lists](/mailing-lists)
* [Issues Tracker](https://github.com/apache/cloudstack/issues)
* [Community Slack](https://join.slack.com/t/apachecloudstack/shared_invite/zt-1u8qwbivp-u16HRI~LWioLmF1G2D3Iyg)
* [Events and Meetups](/events)
* [Collab Conference](https://www.cloudstackcollab.org/)
Use Cases

* [Cloud Builders](/cloud-builders)
* [Kubernetes](/kubernetes)
* [Integrations](/integrations)
Users

* [Known Users](/users)
* [Case Studies](/blog/tags/case-studies)
* [Take Survey](https://docs.google.com/forms/d/e/1FAIpQLScPHIRetdt-pxPT62IesXMoQUmhQ8ATGKcYZa507mB9uwzn-Q/viewform)
Documentation

* [CloudStack Documentation](https://docs.cloudstack.apache.org)
* [Project Wiki](https://cwiki.apache.org/confluence/display/CLOUDSTACK/Home)
* [CloudStack Books](https://cwiki.apache.org/confluence/display/CLOUDSTACK/CloudStack%2BBooks)
* [API Documentation](/api/)
[Download](/downloads)[Blog](/blog)`ctrl``K`ASF

* [Foundation](https://www.apache.org/)
* [License](https://www.apache.org/licenses/)
* [Events](https://www.apache.org/events/current-event)
* [Sponsorship](https://www.apache.org/foundation/sponsorship.html)
* [Privacy](https://www.apache.org/foundation/policies/privacy.html)
* [Thanks](https://www.apache.org/foundation/thanks.html)
CloudStack Blog

* [All Posts](/blog)
* [News](/blog/tags/news)
* [Announcements](/blog/tags/announcement)
* [Past Events](/blog/tags/roundup)
* [Case Studies & Integrations](/blog/tags/case-studies)
* [Meet the Community](/blog/tags/community)
# [ADVISORY] Apache CloudStack CVE-2024-41107: SAML Signature Exclusion

July 19, 2024[![Abhishek Kumar](https://github.com/shwstppr.png)](https://github.com/shwstppr)[Abhishek Kumar](https://github.com/shwstppr)PMC Member

[![](/assets/images/banner-f04ebbcacda59dc9db61c16461d002aa.jpg "Apache CloudStack CVE-2024-41107")](/blog/security-release-advisory-cve-2024-41107)

Apache CloudStack project announces the release of LTS security releases
[4.19.1.0](https://github.com/apache/cloudstack/releases/tag/4.19.1.0) and
[4.18.2.2](https://github.com/apache/cloudstack/releases/tag/4.18.2.2) that
addresses CVE-2024-41107 that affects CloudStack SAML users, of severity
'important' explained below.

## [CVE-2024-41107](https://www.cve.org/CVERecord?id=CVE-2024-41107): SAML Signature Exclusion[â](#cve-2024-41107-saml-signature-exclusion "Direct link to cve-2024-41107-saml-signature-exclusion")

The CloudStack SAML authentication (disabled by default) does not enforce
signature check. In CloudStack environments where SAML authentication is
enabled, an attacker that initiates CloudStack SAML single sign-on
authentication can bypass SAML authentication by submitting a spoofed SAML
response with no signature and known or guessed username and other user
details of a SAML-enabled CloudStack user-account. In such environments,
this can result in a complete compromise of the resources owned and/or
accessible by a SAML enabled user-account.

## Credits[â](#credits "Direct link to Credits")

The original issue was reported by Christian Gross of Netcloud AG who filed
it as a bug report at
<https://github.com/apache/cloudstack/issues/4519>.

More recently it was reported as a security issue by the following
reporters from the Apple Services Engineering Security team:

* Damon Smith
* Adam Pond
* Terry Thibault

## Affected versions:[â](#affected-versions "Direct link to Affected versions:")

* Apache CloudStack 4.5.0 through 4.18.2.1
* Apache CloudStack 4.19.0.0 through 4.19.0.2

## Resolution[â](#resolution "Direct link to Resolution")

Affected users are recommended to disable the SAML authentication plugin
by setting the "saml2.enabled" global setting to "false", or upgrade to
version 4.18.2.2, 4.19.1.0 or later, which addresses this issue.

## Downloads and Documentation[â](#downloads-and-documentation "Direct link to Downloads and Documentation")

The official source code for the 4.18.2.2 and 4.19.1.0 releases can be
downloaded from the project downloads page:

<https://cloudstack.apache.org/downloads>

The 4.18.2.2 and 4.19.1.0 release notes can be found at:

* <https://docs.cloudstack.apache.org/en/4.18.2.2/releasenotes/about.html>
* <https://docs.cloudstack.apache.org/en/4.19.1.0/releasenotes/about.html>

In addition to the official source code release, individual contributors
have also made release packages available on the Apache CloudStack
download page, and available at:

* <https://download.cloudstack.org/el/7/>
* <https://download.cloudstack.org/el/8/>
* <https://download.cloudstack.org/el/9/>
* <https://download.cloudstack.org/suse/15/>
* <https://download.cloudstack.org/ubuntu/dists/>
* <https://www.shapeblue.com/cloudstack-packages/>
**Tags:**

* [announcement](/blog/tags/announcement)
[Edit this page](https://github.com/apache/cloudstack-www/tree/main/blog/2024-07-19-security-release-advisory-cve-2024-41107/index.md)[Newer PostApache CloudStack 4.19.1.0 Release](/blog/cloudstack-4.19.1.0-release)[Older Post[ADVISORY] Apache CloudStack LTS Security Releases 4.18.2.1 and 4.19.0.2](/blog/security-release-advisory-4.19.0.2-4.18.2.1)

* [CVE-2024-41107: SAML Signature Exclusion](#cve-2024-41107-saml-signature-exclusion)
* [Credits](#credits)
* [Affected versions:](#affected-versions)
* [Resolution](#resolution)
* [Downloads and Documentation](#downloads-and-documentation)
[![Apache CloudStack logo](/img/ACS_logo_slogan.svg)![Apache CloudStack logo](/img/ACS_logo_slogan.svg)](https://cloudstack.apache.org/)
![](/img/mail_mini_icon.svg)
[![](/img/slack_mini_icon.svg)](https://join.slack.com/t/apachecloudstack/shared_invite/zt-2aegc22z7-tPCxpptfcebTBtd59qcZSQ)
[![](/img/git_mini_icon.svg)](https://github.com/apache/cloudstack)
[![](/img/twitter_X_mini_icon.svg)](https://twitter.com/CloudStack)
[![](/img/reddit_icon.svg)](https://www.reddit.com/r/ApacheCloudStack/)
[![](/img/youtube_mini_icon.svg)](https://www.youtube.com/%40ApacheCloudStack)
[![](/img/linkedin_icon.svg)](https://www.linkedin.com/company/apachecloudstack/posts/)

Copyright Â© 2012 - 2024 The Apache
Software Foundation, Licensed under the Apache License, Version 2.0.
âApacheâ, âCloudStackâ, âApache CloudStackâ, the Apache CloudStack logo,
the Apache CloudStack Cloud Monkey logo and the Apache feather logos
are registered trademarks or trademarks of The Apache Software
Foundation.

[Apache CloudStack Trademark Usage](/trademark-guidelines) - [Apache CloudStack Community ByLaws](/bylaws) - [Website Source Code](https://github.com/apache/cloudstack-www)



=== Content from lists.apache.org_0d503bed_20250111_170530.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.



=== Content from github.com_5dbbac83_20250111_170530.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fcloudstack%2Fissues%2F4519)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fcloudstack%2Fissues%2F4519)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=apache%2Fcloudstack)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[apache](/apache)
/
**[cloudstack](/apache/cloudstack)**
Public

* [Notifications](/login?return_to=%2Fapache%2Fcloudstack) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Fapache%2Fcloudstack)
* [Star
   2.2k](/login?return_to=%2Fapache%2Fcloudstack)

* [Code](/apache/cloudstack)
* [Issues
  447](/apache/cloudstack/issues)
* [Pull requests
  155](/apache/cloudstack/pulls)
* [Discussions](/apache/cloudstack/discussions)
* [Actions](/apache/cloudstack/actions)
* [Projects
  1](/apache/cloudstack/projects)
* [Wiki](/apache/cloudstack/wiki)
* [Security](/apache/cloudstack/security)
* [Insights](/apache/cloudstack/pulse)

Additional navigation options

* [Code](/apache/cloudstack)
* [Issues](/apache/cloudstack/issues)
* [Pull requests](/apache/cloudstack/pulls)
* [Discussions](/apache/cloudstack/discussions)
* [Actions](/apache/cloudstack/actions)
* [Projects](/apache/cloudstack/projects)
* [Wiki](/apache/cloudstack/wiki)
* [Security](/apache/cloudstack/security)
* [Insights](/apache/cloudstack/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fapache%2Fcloudstack%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fapache%2Fcloudstack%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# SAML signature is optional #4519

Closed

[ngrosc](/ngrosc) opened this issue
Dec 4, 2020
· 24 comments
 · Fixed by [#9219](https://github.com/apache/cloudstack/pull/9219)

Closed

# [SAML signature is optional](#top) #4519

[ngrosc](/ngrosc) opened this issue
Dec 4, 2020
· 24 comments
 · Fixed by [#9219](https://github.com/apache/cloudstack/pull/9219)

Assignees
[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=40&v=4)](/rohityadavcloud)

Labels
[age:2years\_plus](/apache/cloudstack/labels/age%3A2years_plus)
[complexity:normal](/apache/cloudstack/labels/complexity%3Anormal)
[component:saml](/apache/cloudstack/labels/component%3Asaml)
[Severity:Major](/apache/cloudstack/labels/Severity%3AMajor)
[type:improvement](/apache/cloudstack/labels/type%3Aimprovement)
[type:security](/apache/cloudstack/labels/type%3Asecurity)

Milestone
[4.19.1.0](/apache/cloudstack/milestone/31 "4.19.1.0")

## Comments

[![@ngrosc](https://avatars.githubusercontent.com/u/71492633?s=80&u=000b7ca0e4f28ab6a0a4a8a11d75d4d8f2c27c22&v=4)](/ngrosc)

Copy link

### **[ngrosc](/ngrosc)** commented [Dec 4, 2020](#issue-757137507)

| ISSUE TYPE  * Bug Report  COMPONENT NAME ``` UI: SAML login  ``` CLOUDSTACK VERSION ``` 4.14.0.0  ``` CONFIGURATION SAML authentication activated OS / ENVIRONMENT N/A SUMMARY The SAML signature is optional and not mandatory. A user can login into a domain where he's not allowed to. STEPS TO REPRODUCE Use a tool to intercept the web requests between your browser ant the cloudstack UI (our pentester used "burp"). Login to cloudstack using a SSO account (SAML). Now, you're logged in successfully to your cloudstack domain. Logout from cloudstack.  Now, log in again to cloudstack, but with the "interceptor" active. In the request, delete the whole saml-signature and change the username to another SSO user from within another tenant. Run the modified request, and you're logged in into this foreign account.  ```   ``` EXPECTED RESULTS User can't log in into foreign tenant  ```   ``` ACTUAL RESULTS User can log in into foreign tenant  ```   ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@kiwiflyer](https://avatars.githubusercontent.com/u/17278194?s=40&u=6e707dbe1c2b268211d631dab80332da3da45fb3&v=4)](/kiwiflyer)
[kiwiflyer](/kiwiflyer)
added
[component:saml](/apache/cloudstack/labels/component%3Asaml)
[type:security](/apache/cloudstack/labels/type%3Asecurity)
labels
[Dec 4, 2020](#event-4073230437)

[![@kiwiflyer](https://avatars.githubusercontent.com/u/17278194?s=80&u=6e707dbe1c2b268211d631dab80332da3da45fb3&v=4)](/kiwiflyer)

Copy link

Contributor

### **[kiwiflyer](/kiwiflyer)** commented [Dec 4, 2020](#issuecomment-738850954)

| [@DaanHoogland](https://github.com/DaanHoogland) [@rhtyd](https://github.com/rhtyd) Guys, this looks like a pretty nasty security bug. SAML isn't used by default, but regardless this may be a blocker for 4.15 and 4.14.x. |
| --- |

All reactions

Sorry, something went wrong.

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=80&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)

Copy link

Member

### **[rohityadavcloud](/rohityadavcloud)** commented [Dec 4, 2020](#issuecomment-738883712) • edited Loading

| [@kiwiflyer](https://github.com/kiwiflyer) yes let's discuss and understand how the env was setup, I suspect it may related to env configuration.  [@ngrosc](https://github.com/ngrosc) can you share details of your IDP setup? For example the IDP xml metadata, what IDP server are you using (Shibboleth, keycloak etc). Usually, the SP (CloudStack acts as a service provider in SAML terminology) is not in control of whether the SAML token is encrypted or not, and signing and encryption is enforced by the IDP server. For best practices, IDP servers generally should enforce that both signing and encryption be done and (authn) tokens be signed/encrypted (when this is done correctly we should see the encryption and signing public keys in the IDP metadata xml, for example see <https://samltest.id/saml/idp>). I think only if encryption is not enforced you'll be able to read/extract/change the token parameters, can you try to enforce encryption in your IDP and try your attack/test again? In case that works then we certainly have a blocker.  CloudStack's SAML support (SP) was implemented and tested against Shibboleth and you may use <https://samltest.id/> to test the setup. For doc ref: <http://docs.cloudstack.apache.org/en/latest/adminguide/accounts.html#using-a-saml-2-0-identity-provider-for-user-authentication> |
| --- |

All reactions

Sorry, something went wrong.

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=80&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)

Copy link

Member

### **[rohityadavcloud](/rohityadavcloud)** commented [Dec 4, 2020](#issuecomment-738883827)

| cc [@PaulAngus](https://github.com/PaulAngus) [@DaanHoogland](https://github.com/DaanHoogland) |
| --- |

All reactions

Sorry, something went wrong.

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=80&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)

Copy link

Member

### **[rohityadavcloud](/rohityadavcloud)** commented [Dec 4, 2020](#issuecomment-738888486)

| I did a quick code investigation, looks like when there is no encryption in place we get the unencrypted username (`uid` usually) parameter from the SAML token: (if I recall correctly this was done only to allow and test unsecure IDP servers) <https://github.com/apache/cloudstack/blob/master/plugins/user-authenticators/saml2/src/main/java/org/apache/cloudstack/api/command/SAML2LoginAPIAuthenticatorCmd.java#L241>  ... however, I'm not sure if changing the whole SAML token/response should fail at <https://github.com/apache/cloudstack/blob/master/plugins/user-authenticators/saml2/src/main/java/org/apache/cloudstack/api/command/SAML2LoginAPIAuthenticatorCmd.java#L232> which was signed by a signature?  However, if the SAML IDP server has encryption enforced (see for example <https://wiki.shibboleth.net/confluence/display/IDP30/SecurityConfiguration#SecurityConfiguration-SigningandEncryptionEnablement>) we get the username from the encrypted assertion value: <https://github.com/apache/cloudstack/blob/master/plugins/user-authenticators/saml2/src/main/java/org/apache/cloudstack/api/command/SAML2LoginAPIAuthenticatorCmd.java#L289> |
| --- |

All reactions

Sorry, something went wrong.

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=80&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)

Copy link

Member

### **[rohityadavcloud](/rohityadavcloud)** commented [Dec 4, 2020](#issuecomment-738893634)

| I guess we need exact steps of reproduction if encryption and signing are both enabled. In which case, [@ngrosc](https://github.com/ngrosc) can you email me privately on rohit AT apache.org? Thanks.  I ran a quick test, this server is SAML enabled: <http://primate-qa.cloudstack.cloud:8080/client/master>  [Screenshot from 2020-12-04 22-21-20](https://user-images.githubusercontent.com/95203/101191111-43224d00-367f-11eb-8c4b-3fce6f43e548.png)  I tracked both SAML request and response. SAML request (base64 encoded) was encrypted so couldn't decode it, SAML response (base64 encoded) was not but I see the username attribute is not plaintext in the XML as encryption in enforced:  ``` <?xml version="1.0" encoding="UTF-8"?> <saml2p:Response Destination="http://primate-qa.cloudstack.cloud:8080/client/api?command=samlSso" ID="_12f9925a270fb1652e82e635fa6fde35" InResponseTo="uk3foqohiipf3948r0gn2tavbdgo1gsc" IssueInstant="2020-12-04T16:50:45.549Z" Version="2.0" xmlns:saml2p="urn:oasis:names:tc:SAML:2.0:protocol"><saml2:Issuer xmlns:saml2="urn:oasis:names:tc:SAML:2.0:assertion">https://samltest.id/saml/idp</saml2:Issuer><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><ds:SignedInfo><ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/><ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/><ds:Reference URI="#_12f9925a270fb1652e82e635fa6fde35"><ds:Transforms><ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/><ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/></ds:Transforms><ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/><ds:DigestValue>Ru6R2nqZCGs532STdqd5alLYCOxgMooNlfww1JWVR4U=</ds:DigestValue></ds:Reference></ds:SignedInfo><ds:SignatureValue>FKUtzP59Vht1Pd77s9jW0KejzbG1m6B2txUyVOi3Y1ioTAg1Xvy/VvxNui8u9G6mVV4s1n5l/gFDGi5v2SIN7YcxH+yX9GJ1TW8XX1WJqxtiDFgGbm+KL8DHeVgyc8kJmAC1zOMRUKOy7arvWc42KmhilAumXbS5oo0qwfnvjNmyhzGQW+lZcMcd/K3eE6ZvdsetRToWlXpnzwKuBqy1iZfZZpxKwgKhBtXDTwCltJjH97FOGP7G9epJH/sfNir/970oNzr+y3TXYL2uDoQKVP5SYOzBPtRvUBR4+qcY0SLIsSNn7X9iXMgKAr2GPfgNMG7zgP4F14ElErYlPiBGgA==</ds:SignatureValue><ds:KeyInfo><ds:X509Data><ds:X509Certificate>MIIDEjCCAfqgAwIBAgIVAMECQ1tjghafm5OxWDh9hwZfxthWMA0GCSqGSIb3DQEBCwUAMBYxFDAS BgNVBAMMC3NhbWx0ZXN0LmlkMB4XDTE4MDgyNDIxMTQwOVoXDTM4MDgyNDIxMTQwOVowFjEUMBIG A1UEAwwLc2FtbHRlc3QuaWQwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC0Z4QX1NFK s71ufbQwoQoW7qkNAJRIANGA4iM0ThYghul3pC+FwrGv37aTxWXfA1UG9njKbbDreiDAZKngCgyj xj0uJ4lArgkr4AOEjj5zXA81uGHARfUBctvQcsZpBIxDOvUUImAl+3NqLgMGF2fktxMG7kX3GEVN c1klbN3dfYsaw5dUrw25DheL9np7G/+28GwHPvLb4aptOiONbCaVvh9UMHEA9F7c0zfF/cL5fOpd Va54wTI0u12CsFKt78h6lEGG5jUs/qX9clZncJM7EFkN3imPPy+0HC8nspXiH/MZW8o2cqWRkrw3 MzBZW3Ojk5nQj40V6NUbjb7kfejzAgMBAAGjVzBVMB0GA1UdDgQWBBQT6Y9J3Tw/hOGc8PNV7JEE 4k2ZNTA0BgNVHREELTArggtzYW1sdGVzdC5pZIYcaHR0cHM6Ly9zYW1sdGVzdC5pZC9zYW1sL2lk cDANBgkqhkiG9w0BAQsFAAOCAQEASk3guKfTkVhEaIVvxEPNR2w3vWt3fwmwJCccW98XXLWgNbu3 YaMb2RSn7Th4p3h+mfyk2don6au7Uyzc1Jd39RNv80TG5iQoxfCgphy1FYmmdaSfO8wvDtHTTNiL ArAxOYtzfYbzb5QrNNH/gQEN8RJaEf/g/1GTw9x/103dSMK0RXtl+fRs2nblD1JJKSQ3AdhxK/we P3aUPtLxVVJ9wMOQOfcy02l+hHMb6uAjsPOpOVKqi3M8XmcUZOpx4swtgGdeoSpeRyrtMvRwdcci NBp9UZome44qZAYH1iqrpmmjsfI9pJItsgWu3kXPjhSfj1AJGR1l9JGvJrHki1iHTA==</ds:X509Certificate></ds:X509Data></ds:KeyInfo></ds:Signature><saml2p:Status xmlns:saml2p="urn:oasis:names:tc:SAML:2.0:protocol"><saml2p:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success"/></saml2p:Status><saml2:EncryptedAssertion xmlns:saml2="urn:oasis:names:tc:SAML:2.0:assertion"><xenc:EncryptedData Id="_82ae30113dddb0a1a6677d2847cbfae8" Type="http://www.w3.org/2001/04/xmlenc#Element" xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"><xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes128-cbc" xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"/><ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><xenc:EncryptedKey Id="_34573737ef07781b5a5b2182effbc2db" Recipient="http://primate-qa.cloudstack.cloud:8080" xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"><xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p" xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"><ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" xmlns:ds="http://www.w3.org/2000/09/xmldsig#"/></xenc:EncryptionMethod><ds:KeyInfo><ds:X509Data><ds:X509Certificate>MIIEsjCCApoCCQCHoExIZv8R3TANBgkqhkiG9w0BAQsFADAbMRkwFwYDVQQDDBBBcGFjaGVDbG91 ZFN0YWNrMB4XDTIwMDMwNTE5MzQyMVoXDTIzMDMwNjE5MzQyMVowGzEZMBcGA1UEAwwQQXBhY2hl Q2xvdWRTdGFjazCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAJzSnSTViczgkNXMWVLI ccxjdzRG30ptPfBWEsjWdQBgtn/BXEZpj4yeVyYN4p3gdRvtkW6TdwGOyrQksNdAxDhPpG2xQKY7 j01Sato1Kpdk/QfNfTJMd/asdipbgQ/41sttAlO39zn4Q+nmauWJnt7YbWFaAMslRxx7y3nPqfgZ RlBINK3ltrGYHsvojybjRfGvZ3ewGKeJ7rtSrjGLKbCRqKHYmyFPQxErDaabgEl7/T9wl1kdREl0 UWUiVXcV25Uzq4gZ9253C+KzbAOHyl2MUNJDnPrw4cmwai/mmjvcODNmN4D2wEXQMCYBnoKa+/wl BEKanoE5pJje9tj84zwnj1UMvU6PXup9RuKcVO7TUsCZPMcKxZn9iKpRIiedWYWBJREL27GP4FTx cjtBG/4tBzcEGMSXT4Rjcp67yc7NnuSW3XD01olMeGUYdya5t5kkiWIAmxz009SoyopW2MFzufWj p1uZTeDiO9T+q8hdlSazD7UO3yqrj2ACuAc1xBRI8tbos5ZnQ/ZecR3Z6ZC7uYzJhKoEVDxIC5WI APYVTTyvXihU1fBIo2ATJpHoI/3IdO8Ug1Xjq5EH+IRCcCXUZbigNxtv+oYQsTt2SpAK4aRhM6T2 f5tk7ZcvCE+DrsL55Wx9RH/iAs2fuY5TrYQulEatWUE1TEJ4JdqdTNeJAgMBAAEwDQYJKoZIhvcN AQELBQADggIBAAtgfVTPNZbimb4NywnTJx60+LPJ70yCVRuVTzMhmpdpjgqmNYF5l1TEc5pNWvR6 ghJOivr4iWlYFr9mlZ+ifCS2jjde4V3I/Fp4vuzxYXGsw805hSksl+u/BOChq6L32Xf9UVPWwj/Q xIv1kZ+ZV5uAp4YKAYlAyWO+WknPV6tSYGIjxRNfYacqf0yQPGwSlDG1cAYfBbMxweWD79n0b2ZR o3e8LPRvODxZigSIW6FG2J4naa8rYxs3B7dSrEKTSMqXLSNqJwEY/7gnwgP/j/NDPtjvRh/ESoUY dNvDnUQBFK37POI4dJUYSgj4axjBsIE0cvqLoXkO773hRZZzKQima0AwCWTmm2HbeAs8xk4MmDYM 8SsXrbmketEsEq3QgJzyYAeFEvn9Nxrs93KSh/onHaFgI4fo7VVJD4Wwi9nlSsQlCkalcTVJEkbT upx/0mWGZBQC70Alo9ACr21OgFUDDW5xuewazE7TO6h00WnJe9uuoMV8+5q6yWJKCLCYBaZeVxqu Pa2bki4+w8ZcWmlc2T9ErhE76hgUjo0Lz3MSfWY+86e4kirZBP3U3zWPVHduyF6bJlik22T879Ns JG3kPSSrAFvE151cYf2QlqChO/mwbQFurht985Y5uMnnORMU8qTTtoIU8hNQkKrktN4XHEIF3IiI DxOpmM3iFAVh</ds:X509Certificate></ds:X509Data></ds:KeyInfo><xenc:CipherData xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"><xenc:CipherValue>UTlSgRyKSc/gYMHmCiS4EUHm6vZGoVZUNVfTXupfVP1FNB7B4nelClhajG+soCrLA4LMVdrc2R96vuwJalroS0V7To1WlXCxOoS8qwxVj7npafR65vLNt7DnE/p1p4biphTZOAlEVYBcFEMwTxnugWfnEBaoMZcAFAU4YFd3ZAdlK6Urn41F8bpTxPk9grzRbF2qFZb/KfHonUV9+klhemA64tcQoifyA6EzstZLI2qFvdHxGikZDWwATFBSLYuYJX0cAUp0EBQQvIduQZm2d7UzZwbSRTp+WgN318e4wRFgI0cCjH5MrxDI0B7cW48807s3wJiM1lHIRfYKBy1X/P8zFguBXnWv+5QsADMTyIfCT64s5rBjzJ9ll1+LrLMIFwMlUvKeenMrkhLxELWROS4i21lItDOKCDNdlIKXyVuMlZnt2nVkQqcxNOoFE1qGBhCQqnf7rAMuOwp58ENr6R03VUYYwtZ7z6fPnwVdr1LralhZPJ+kRY/e709wMXQ1n3SeQpP+xhpLhCHlbM1GEXCM76tQTFT1sJlzB1Kv5EqyozLiInWqZsovrGdPCWzfiL2/MDn4M0gxFqQU/kwvsIhFFDC5A6izvX7Hu9noVkEZ3Xk7fLyon+qJmeYDxRbXc2AQAYdadRsha+pPEZq+vSGeYkL7GNKquo8H+q/MBVk=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"><xenc:CipherValue>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</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAssertion></saml2p:Response>  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@PaulAngus](https://avatars.githubusercontent.com/u/4810220?s=80&v=4)](/PaulAngus)

Copy link

Member

### **[PaulAngus](/PaulAngus)** commented [Dec 4, 2020](#issuecomment-738907120)

| Hand-waving the details, it *sounds* to me like we're saying that it's the IDP that controls whether the token is encrypted. IF so, I agree with Rohit; This is not a CloudStack issue, as CloudStack *can* work with encrypted tokens. If the IDP is not configured to send encrypted tokens, that's not CloudStack's 'fault'. |
| --- |

 👍
1
 rohityadavcloud reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@andrijapanicsb](https://avatars.githubusercontent.com/u/45762285?s=80&u=3d099e4a8c122dffdc8705359ece7dceeebf0d66&v=4)](/andrijapanicsb)

Copy link

Contributor

### **[andrijapanicsb](/andrijapanicsb)** commented [Dec 4, 2020](#issuecomment-738940766)

| +1 on what Paul and Rohit said. That sounds the same as "if user uses insecure HTTP instead of HTTPS it's ACS security issue" Cloud operator is in charge of the configuration of everything, encryption included everywhere. |
| --- |

All reactions

Sorry, something went wrong.

[![@kiwiflyer](https://avatars.githubusercontent.com/u/17278194?s=80&u=6e707dbe1c2b268211d631dab80332da3da45fb3&v=4)](/kiwiflyer)

Copy link

Contributor

### **[kiwiflyer](/kiwiflyer)** commented [Dec 4, 2020](#issuecomment-738949122)

| So, agreed that everything should be encrypted. I'm not going to claim in anyway that I'm a SAML expert, but if the username changes, shouldn't we be sending a new AuthnRequest back to the IDP? |
| --- |

All reactions

Sorry, something went wrong.

[![@ngrosc](https://avatars.githubusercontent.com/u/71492633?s=80&u=000b7ca0e4f28ab6a0a4a8a11d75d4d8f2c27c22&v=4)](/ngrosc)

Copy link

Author

### **[ngrosc](/ngrosc)** commented [Dec 4, 2020](#issuecomment-738984435)

| hi guys  sorry for the late answer.  we're using https, not http. so that should not be the the main issue.  as IDP, we're using keycloack with the following config:  `{ "clientId": "iaas.cloudstack", "baseUrl": "https://**********/client", "surrogateAuthRequired": false, "enabled": true, "clientAuthenticatorType": "client-secret", "redirectUris": [ "https://**********/client/api?command=samlSso", "https://**********/client/api?command=samlSlo", ], "webOrigins": [], "notBefore": 0, "bearerOnly": false, "consentRequired": false, "standardFlowEnabled": true, "implicitFlowEnabled": false, "directAccessGrantsEnabled": false, "serviceAccountsEnabled": false, "publicClient": false, "frontchannelLogout": true, "protocol": "saml", "attributes": { "saml.assertion.signature": "false", "saml_assertion_consumer_url_redirect": "https://**********/client/api?command=samlSso", "saml.force.post.binding": "true", "saml.multivalued.roles": "false", "saml_single_logout_service_url_post": "https://**********/client/api?command=samlSlo", "saml.encrypt": "false", "saml_assertion_consumer_url_post": "https://**********/client/api?command=samlSso", "saml.server.signature": "true", "saml.server.signature.keyinfo.ext": "false", "exclude.session.state.from.auth.response": "false", "saml.signing.certificate": "**********", "saml_single_logout_service_url_redirect": "https://**********/client/api?command=samlSlo", "saml.signature.algorithm": "RSA_SHA256", "saml_force_name_id_format": "false", "saml.client.signature": "false", "tls.client.certificate.bound.access.tokens": "false", "saml.authnstatement": "true", "display.on.consent.screen": "false", "saml.signing.private.key": "**********", "saml_name_id_format": "username", "saml.onetimeuse.condition": "false", "saml_signature_canonicalization_method": "http://www.w3.org/2001/10/xml-exc-c14n#" }, "authenticationFlowBindingOverrides": {}, "fullScopeAllowed": true, "nodeReRegistrationTimeout": -1, "protocolMappers": [ { "name": "username-2-userid", "protocol": "saml", "protocolMapper": "saml-user-property-mapper", "consentRequired": false, "config": { "attribute.nameformat": "Basic", "user.attribute": "username", "attribute.name": "uid" } } ], "defaultClientScopes": [ "web-origins", "role_list", "profile", "roles", "email" ], "optionalClientScopes": [ "address", "phone", "offline_access" ], "access": { "view": true, "configure": true, "manage": true } }`  regarding to PaulAngus' answer: yes, we have saml.client.signature and saml.encrypt set to false in keycloack. so that might be the issue for all of this. I'll try to change that in an emergency maintenance window an post an update.  thanks for your help! |
| --- |

All reactions

Sorry, something went wrong.

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=80&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)

Copy link

Member

### **[rohityadavcloud](/rohityadavcloud)** commented [Dec 5, 2020](#issuecomment-739244881)

| [@ngrosc](https://github.com/ngrosc) in that case can you please close the issue. Thanks. |
| --- |

All reactions

Sorry, something went wrong.

[![@ngrosc](https://avatars.githubusercontent.com/u/71492633?s=40&u=000b7ca0e4f28ab6a0a4a8a11d75d4d8f2c27c22&v=4)](/ngrosc)
[ngrosc](/ngrosc)
closed this as [completed](/apache/cloudstack/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Dec 7, 2020](#event-4079331634)

[![@ngrosc](https://avatars.githubusercontent.com/u/71492633?s=80&u=000b7ca0e4f28ab6a0a4a8a11d75d4d8f2c27c22&v=4)](/ngrosc)

Copy link

Author

### **[ngrosc](/ngrosc)** commented [Dec 23, 2020](#issuecomment-750322450)

| Hi guys  Meanwhile we were able to secure the connection between our IDP and Cloudstack and are now encrypting the assertions. But the initial issue still exists.  When someone removes the signature, cloudstack accepts this. Of course, if someone is able to intercept, decrypt, edit and reencrypt the assertion, we have some other major problems.  But from my point of view, it should be possible to enforce signature checking. As far as I understood, the underlying java component has a flag for this, but its not used from cloudstack. Even it is almost impossible to manipulate such a request, pentesters will classify this as "critical design flaw". |
| --- |

All reactions

Sorry, something went wrong.

[![@ngrosc](https://avatars.githubusercontent.com/u/71492633?s=40&u=000b7ca0e4f28ab6a0a4a8a11d75d4d8f2c27c22&v=4)](/ngrosc)
[ngrosc](/ngrosc)
reopened this
[Dec 23, 2020](#event-4144391678)

[![@DaanHoogland](https://avatars.githubusercontent.com/u/2486961?s=80&v=4)](/DaanHoogland)

Copy link

Contributor

### **[DaanHoogland](/DaanHoogland)** commented [Dec 30, 2020](#issuecomment-752380557)

| i agree it is an issue but only if a demontrable exploit exists can it be critival, [@ngrosc](https://github.com/ngrosc) . that said, it should be addressed. |
| --- |

All reactions

Sorry, something went wrong.

[![@DaanHoogland](https://avatars.githubusercontent.com/u/2486961?s=40&v=4)](/DaanHoogland)
[DaanHoogland](/DaanHoogland)
added
[complexity:normal](/apache/cloudstack/labels/complexity%3Anormal)
[Severity:Major](/apache/cloudstack/labels/Severity%3AMajor)
labels
[Dec 30, 2020](#event-4156666914)

[![@DaanHoogland](https://avatars.githubusercontent.com/u/2486961?s=80&v=4)](/DaanHoogland)

Copy link

Contributor

### **[DaanHoogland](/DaanHoogland)** commented [Feb 1, 2021](#issuecomment-770888915)

| [@rhtyd](https://github.com/rhtyd) can you shed a light on why teh signature is ignored (and how to fix)? |
| --- |

All reactions

Sorry, something went wrong.

[![@DaanHoogland](https://avatars.githubusercontent.com/u/2486961?s=40&v=4)](/DaanHoogland)
[DaanHoogland](/DaanHoogland)
added this to the [4.16.0.0](/apache/cloudstack/milestone/16) milestone
[Feb 5, 2021](#event-4295406736)

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=80&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)

Copy link

Member

### **[rohityadavcloud](/rohityadavcloud)** commented [Mar 6, 2021](#issuecomment-791907116)

| Needs investigation, I don't remember if it does or does not. However, if the assertions are not encrypted - I suppose that's issue of the overall IDP setup. |
| --- |

All reactions

Sorry, something went wrong.

[![@ngrosc](https://avatars.githubusercontent.com/u/71492633?s=80&u=000b7ca0e4f28ab6a0a4a8a11d75d4d8f2c27c22&v=4)](/ngrosc)

Copy link

Author

### **[ngrosc](/ngrosc)** commented [Mar 6, 2021](#issuecomment-791910614) via email

| Hi Rohit I completely agree with you. If the assertion is encrypted or not is an IDP "issue". But if a signature is present or not, has to be enforced on client side (cloudstack). Because even when the IDP adds a signature, a man in the middle can remove it and fake data. Of course, in case of encrypted assertions only if he has the private key of the IDP, and then you definitely have other issues.. Nevertheless, it should be possible to enforce the check of the signature. Then, cloudstack can ensure, that the data is valid.. Am Sa., 6. März 2021 um 11:13 Uhr schrieb Rohit Yadav < notifications@github.com>: …  Needs investigation, I don't remember if it does or does not. However, if the assertions are not encrypted - I suppose that's issue of the overall IDP setup. — You are receiving this because you were mentioned. Reply to this email directly, view it on GitHub <[#4519 (comment)](https://github.com/apache/cloudstack/issues/4519#issuecomment-791907116)>, or unsubscribe <<https://github.com/notifications/unsubscribe-auth/ARBOIGJTIFMRSXJYLMUWPL3TCH54HANCNFSM4UNP732Q>> . |
| --- |

All reactions

Sorry, something went wrong.

[![@s-seitz](https://avatars.githubusercontent.com/u/4659439?s=80&u=afd1166ed7c4e8f7a1554c1bfedf3ee3ad456b21&v=4)](/s-seitz)

Copy link

### **[s-seitz](/s-seitz)** commented [Jul 16, 2021](#issuecomment-881731817)

| Hi, at least on 4.15.1 cloudstack is unable to find (or decrypt?) saml2.user.attribute if the assertions are encrypted (which is default in keycloak, and also enabled after importing cloudstack's metadata.xml). I do not know, if this exactly relates to this topic. |
| --- |

All reactions

Sorry, something went wrong.

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=80&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)

Copy link

Member

### **[rohityadavcloud](/rohityadavcloud)** commented [Jul 27, 2021](#issuecomment-887235552)

| [@s-seitz](https://github.com/s-seitz) yes, there is no issue if the SAML IDP enforces encryption.  The issue reporter is essentially asking that assertions/signature be checked even when encryption is not enforced. |
| --- |

All reactions

Sorry, something went wrong.

[![@nvazquez](https://avatars.githubusercontent.com/u/5295080?s=40&v=4)](/nvazquez)
[nvazquez](/nvazquez)
added
the
[type:improvement](/apache/cloudstack/labels/type%3Aimprovement)
label
[Sep 7, 2021](#event-5267330904)

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=40&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)
[rohityadavcloud](/rohityadavcloud)
modified the milestones:
[4.16.0.0](/apache/cloudstack/milestone/16),
[4.17.0.0](/apache/cloudstack/milestone/21)
[Sep 14, 2021](#event-5297451080)

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=40&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)
[rohityadavcloud](/rohityadavcloud)
added
the
[status:Not a problem](/apache/cloudstack/labels/status%3ANot%20a%20problem)
label
[Sep 14, 2021](#event-5297452046)

[![@nvazquez](https://avatars.githubusercontent.com/u/5295080?s=40&v=4)](/nvazquez)
[nvazquez](/nvazquez)
added this to [Apache CloudStack 4.17.0](/orgs/apache/projects/30)
[Feb 6, 2022](#event-15220695182)

[![@nvazquez](https://avatars.githubusercontent.com/u/5295080?s=40&v=4)](/nvazquez)
[nvazquez](/nvazquez)
removed this from the [4.17.0.0](/apache/cloudstack/milestone/21) milestone
[Mar 5, 2022](#event-6188610220)

11 hidden items

Load more…

[![@DaanHoogland](https://avatars.githubusercontent.com/u/2486961?s=40&v=4)](/DaanHoogland)
[DaanHoogland](/DaanHoogland)
modified the milestones:
[4.19.0.0](/apache/cloudstack/milestone/24),
[4.18.1.0](/apache/cloudstack/milestone/27)
[Jan 9, 2023](#event-8179294078)

[![@mlsorensen](https://avatars.githubusercontent.com/u/1047709?s=80&u=543c61c9faa3cb50f50e1b279de3f840e0d06266&v=4)](/mlsorensen)

Copy link

Contributor

### **[mlsorensen](/mlsorensen)** commented [Feb 20, 2023](#issuecomment-1437648244) • edited Loading

| I stumbled upon this - and from what I can see the validation of signature is dependent upon the IDP metadata containing a signing cert. If the IDP metadata XML doesn't specify a signing cert, cloudstack simply doesn't check the signature.  The sig checks are wrapped in code like `if (idpMetadata.getSigningCertificate() != null)`. So again I'd go back to the IDP configuration. Not sure if the IDP metadata in question is in an XML file on the cloudstack management server, or if it is being fetched via URL in this case. |
| --- |

All reactions

Sorry, something went wrong.

[![@DaanHoogland](https://avatars.githubusercontent.com/u/2486961?s=80&v=4)](/DaanHoogland)

Copy link

Contributor

### **[DaanHoogland](/DaanHoogland)** commented [Feb 21, 2023](#issuecomment-1438326291)

| [@mlsorensen](https://github.com/mlsorensen) are you saying this is a security issue (as opposed to how it was ruled earlier)? |
| --- |

All reactions

Sorry, something went wrong.

[![@ngrosc](https://avatars.githubusercontent.com/u/71492633?s=80&u=000b7ca0e4f28ab6a0a4a8a11d75d4d8f2c27c22&v=4)](/ngrosc)

Copy link

Author

### **[ngrosc](/ngrosc)** commented [Feb 21, 2023](#issuecomment-1438780835)

| [@mlsorensen](https://github.com/mlsorensen) From my point of view, the origin of the IDP data doesen't matter. As long as Cloudstack does not enforce a signature, any unsigned message would be accepted and processed.  A man in the middle could easy modify the original message, remove the signature and send it to Cloudstack. Of course, as soon as the assertions are encrypted, thats not a real issue anymore.  But from a security point of view, it's not uncritical when a security mechanism can be removed without any problems.  I'm still thinking about a simple true/false flag named "require signed assertions". In case of not set, assertions will be processed with or without signature. But as soon as enabled, every assertion must be signed or it will be dropped. |
| --- |

 👍
1
 DaanHoogland reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=40&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)
[rohityadavcloud](/rohityadavcloud)
removed this from [ACS Backlog](/orgs/apache/projects/45)
[Jun 12, 2023](#event-14865983377)

[![@DaanHoogland](https://avatars.githubusercontent.com/u/2486961?s=40&v=4)](/DaanHoogland)
[DaanHoogland](/DaanHoogland)
modified the milestones:
[4.18.1.0](/apache/cloudstack/milestone/27),
[4.19.0.0](/apache/cloudstack/milestone/24)
[Jun 22, 2023](#event-9605928406)

[![@shwstppr](https://avatars.githubusercontent.com/u/153340?s=40&u=11124e338b50c8290a0e8c513d5e21134b78f170&v=4)](/shwstppr)
[shwstppr](/shwstppr)
modified the milestones:
[4.19.0.0](/apache/cloudstack/milestone/24),
[4.19.1.0](/apache/cloudstack/milestone/31)
[Dec 14, 2023](#event-11247767669)

[![@sureshanaparti](https://avatars.githubusercontent.com/u/12028987?s=40&v=4)](/sureshanaparti)
[sureshanaparti](/sureshanaparti)
added this to [Apache CloudStack 4.19.1](/orgs/apache/projects/341)
[Mar 11, 2024](#event-14895471176)

[![@sureshanaparti](https://avatars.githubusercontent.com/u/12028987?s=40&v=4)](/sureshanaparti)
[sureshanaparti](/sureshanaparti)
moved this to **Todo**
in [Apache CloudStack 4.19.1](/orgs/apache/projects/341)
[Mar 12, 2024](#event-15081211108)

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=40&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)
[rohityadavcloud](/rohityadavcloud)
added
[age:2years\_plus](/apache/cloudstack/labels/age%3A2years_plus)
[status:stale](/apache/cloudstack/labels/status%3Astale)
labels
[Apr 30, 2024](#event-12662160335)

[![@sureshanaparti](https://avatars.githubusercontent.com/u/12028987?s=40&v=4)](/sureshanaparti)
[sureshanaparti](/sureshanaparti)
added this to [Apache CloudStack BugFest - Issues](/orgs/apache/projects/362)
[Jun 3, 2024](#event-14876131010)

[![@sureshanaparti](https://avatars.githubusercontent.com/u/12028987?s=40&v=4)](/sureshanaparti)
[sureshanaparti](/sureshanaparti)
moved this to **Todo**
in [Apache CloudStack BugFest - Issues](/orgs/apache/projects/362)
[Jun 3, 2024](#event-15085561910)

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=40&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)
[rohityadavcloud](/rohityadavcloud)
self-assigned this
[Jun 10, 2024](#event-13095418647)

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=40&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)
[rohityadavcloud](/rohityadavcloud)
removed
the
[status:stale](/apache/cloudstack/labels/status%3Astale)
label
[Jun 11, 2024](#event-13115019899)

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=40&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)
[rohityadavcloud](/rohityadavcloud)
mentioned this issue
[Jun 11, 2024](#ref-pullrequest-2346113646)

[saml: introduce saml2.check.signature
#9219](/apache/cloudstack/pull/9219)
 Merged

6 tasks

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=40&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)
[rohityadavcloud](/rohityadavcloud)
linked a pull request
[Jun 11, 2024](#event-13115277949)
that will
close
this issue

[saml: introduce saml2.check.signature
#9219](/apache/cloudstack/pull/9219)
 Merged

6 tasks

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=80&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)

Copy link

Member

### **[rohityadavcloud](/rohityadavcloud)** commented [Jun 11, 2024](#issuecomment-2160475777)

| I tend to agree with [@mlsorensen](https://github.com/mlsorensen) 's remarks, if the IDP configuration/metadata has the signing key then the signature check would be performed. I'm less worried about the MITM, as long as API activities are happening on https. Nonetheless, I've introduced a global setting that can fail a SAML based login check when enabled for more stricter env or http-based env, when the signature is missing from the SAMl response - [#9219](https://github.com/apache/cloudstack/pull/9219) cc [@ngrosc](https://github.com/ngrosc) |
| --- |

All reactions

Sorry, something went wrong.

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=40&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)
[rohityadavcloud](/rohityadavcloud)
moved this from **Todo**
to **In Review**
in [Apache CloudStack BugFest - Issues](/orgs/apache/projects/362)
[Jun 11, 2024](#event-15038705626)

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=80&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)

Copy link

Member

### **[rohityadavcloud](/rohityadavcloud)** commented [Jun 13, 2024](#issuecomment-2164504118) • edited Loading

| Addressed by [#9219](https://github.com/apache/cloudstack/pull/9219) |
| --- |

All reactions

Sorry, something went wrong.

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=40&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)
[rohityadavcloud](/rohityadavcloud)
closed this as [completed](/apache/cloudstack/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jun 13, 2024](#event-13140765067)

[![@github-project-automation](https://avatars.githubusercontent.com/in/235829?s=40&v=4)](/apps/github-project-automation)
[github-project-automation](/apps/github-project-automation)
bot
moved this from **Todo**
to **Done**
in [Apache CloudStack 4.19.1](/orgs/apache/projects/341)
[Jun 13, 2024](#event-14934011048)

[![@github-project-automation](https://avatars.githubusercontent.com/in/235829?s=40&v=4)](/apps/github-project-automation)
[github-project-automation](/apps/github-project-automation)
bot
moved this from **In Review**
to **Done**
in [Apache CloudStack BugFest - Issues](/orgs/apache/projects/362)
[Jun 13, 2024](#event-14942544898)

[![@NuxRo](https://avatars.githubusercontent.com/u/2357012?s=80&v=4)](/NuxRo)

Copy link

Contributor

### **[NuxRo](/NuxRo)** commented [Jul 12, 2024](#issuecomment-2226463343)

| [@ngrosc](https://github.com/ngrosc) - regarding this issue, please ping me: nux@apache.org, need some info from you. |
| --- |

All reactions

Sorry, something went wrong.

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=40&u=5f4c8534f2fafb0ccdb4085361da336fb33e7de4&v=4)](/rohityadavcloud)
[rohityadavcloud](/rohityadavcloud)
removed
the
[status:Not a problem](/apache/cloudstack/labels/status%3ANot%20a%20problem)
label
[Jul 17, 2024](#event-13530904523)

[![@wornet-mwo](https://avatars.githubusercontent.com/u/28052857?s=80&u=5adba5eea26ea08effc833985982b9508352a6c3&v=4)](/wornet-mwo)

Copy link

Contributor

### **[wornet-mwo](/wornet-mwo)** commented [Jul 31, 2024](#issuecomment-2260154287)

| As the documentation does not state the exact verification of signatures: The linked and integrated PR expects the whole SAMLResponse to be signed, not only the assertion. As far i can see in the source code the assertion signature is not validated. That's a problem with Authentik as it only signs the assertions (which itself would be also valid, [Link to authentik issue](https://github.com/goauthentik/authentik/issues/7909)). E.g. Nextcloud offers a more fine grained control about the validation.  Hope this helps someone to save time debugging SAML in that case. A workaround is to disable signature validation here for now. |
| --- |

All reactions

Sorry, something went wrong.

[![@DaanHoogland](https://avatars.githubusercontent.com/u/2486961?s=40&v=4)](/DaanHoogland)
[DaanHoogland](/DaanHoogland)
removed this from [Apache CloudStack BugFest - Issues](/orgs/apache/projects/362)
[Dec 10, 2024](#event-15597695674)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fcloudstack%2Fissues%2F4519)

Assignees

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=40&v=4)](/rohityadavcloud) [rohityadavcloud](/rohityadavcloud)

Labels

[age:2years\_plus](/apache/cloudstack/labels/age%3A2years_plus)
[complexity:normal](/apache/cloudstack/labels/complexity%3Anormal)
[component:saml](/apache/cloudstack/labels/component%3Asaml)
[Severity:Major](/apache/cloudstack/labels/Severity%3AMajor)
[type:improvement](/apache/cloudstack/labels/type%3Aimprovement)
[type:security](/apache/cloudstack/labels/type%3Asecurity)

Projects

No open projects
1 closed project

[Apache CloudStack 4.19.1](/orgs/apache/projects/341)

Status: Done

 +3 more

Milestone

 [**4.19.1.0**](/apache/cloudstack/milestone/31 "4.19.1.0")

Development

Successfully merging a pull request may close this issue.

 [saml: introduce saml2.check.signature](/apache/cloudstack/pull/9219)
 [shapeblue/cloudstack](/shapeblue/cloudstack)

12 participants

[![@rohityadavcloud](https://avatars.githubusercontent.com/u/95203?s=52&v=4)](/rohityadavcloud) [![@shwstppr](https://avatars.githubusercontent.com/u/153340?s=52&v=4)](/shwstppr) [![@mlsorensen](https://avatars.githubusercontent.com/u/1047709?s=52&v=4)](/mlsorensen) [![@NuxRo](https://avatars.githubusercontent.com/u/2357012?s=52&v=4)](/NuxRo) [![@DaanHoogland](https://avatars.githubusercontent.com/u/2486961?s=52&v=4)](/DaanHoogland) [![@s-seitz](https://avatars.githubusercontent.com/u/4659439?s=52&v=4)](/s-seitz) [![@PaulAngus](https://avatars.githubusercontent.com/u/4810220?s=52&v=4)](/PaulAngus) [![@nvazquez](https://avatars.githubusercontent.com/u/5295080?s=52&v=4)](/nvazquez) [![@kiwiflyer](https://avatars.githubusercontent.com/u/17278194?s=52&v=4)](/kiwiflyer) [![@wornet-mwo](https://avatars.githubusercontent.com/u/28052857?s=52&v=4)](/wornet-mwo) [![@andrijapanicsb](https://avatars.githubusercontent.com/u/45762285?s=52&v=4)](/andrijapanicsb) [![@ngrosc](https://avatars.githubusercontent.com/u/71492633?s=52&v=4)](/ngrosc)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.shapeblue.com_94d37f18_20250111_170531.html ===


[Skip to content](#content)
[![](https://www.shapeblue.com/wp-content/uploads/2023/07/Shape_blue_recreated_logo.svg)](https://www.shapeblue.com)

* Apache CloudStack
  Close Apache CloudStack

  Open Apache CloudStack

  ## Apache CloudStack

  [Overview](https://www.shapeblue.com/apache-cloudstack-overview/)

  [Integrations](https://www.shapeblue.com/apache-cloudstack-integrations/)

  [Use Cases](https://www.shapeblue.com/apache-cloudstack-use-cases/)

  [Community](https://www.shapeblue.com/apache-cloudstack-community/)

  [Events](https://www.shapeblue.com/events/)
* Services

  Close Services

  Open Services

  ## Our Services

  [CloudStack Software Engineering](https://www.shapeblue.com/cloudstack-software-engineering/)

  [CloudStack Support](https://www.shapeblue.com/cloudstack-infrastructure-support/)

  [IaaS Design and Build](https://www.shapeblue.com/iaas-cloud-design-and-build/)

  [CloudStack Consulting](https://www.shapeblue.com/cloudstack-consulting/)

  [CloudStack Training](https://www.shapeblue.com/cloudstack-training)

  [VMware Migration](https://www.shapeblue.com/vmware-migration-to-apache-cloudstack/)
* Resources
  Close Resources

  Open Resources

  ## RESOURCES

  [Blogs and News](https://www.shapeblue.com/blogs-news/)

  [Case Studies](https://www.shapeblue.com/case-studies/)

  [CloudStack Packages](https://www.shapeblue.com/cloudstack-packages/)

  [Documents](https://www.shapeblue.com/documents/)
* About

  Close About

  Open About

  ## About ShapeBlue

  [The Company](https://www.shapeblue.com/about/)

  [Careers](https://www.shapeblue.com/careers/)

  [Employee Ownership](https://www.shapeblue.com/employee-ownership/)

  [Leadership Team](https://www.shapeblue.com/leadership-team/)
* Contact

  Close Contact

  Open Contact

  ## Contact

  [Offices](https://www.shapeblue.com/offices/)

  [Support](https://www.shapeblue.com/support/)
* [Get In Touch](https://www.shapeblue.com/get-in-touch/)

* [Blog Home](https://www.shapeblue.com/blogs-news/%20)

* [by Rohit Yadav](https://www.shapeblue.com/author/rohit/)
* < 1  min read
* July 19, 2024
* [Advisories](https://www.shapeblue.com/category/advisories/)

Share:

![](https://www.shapeblue.com/wp-content/uploads/2024/07/sb-security-advisory-jul.png)

## ShapeBlue Security Advisory: Apache CloudStack CVE-2024-41107 SAML Signature Exclusion

The Apache CloudStack project has announced an [advisory](https://cloudstack.apache.org/blog/security-release-advisory-cve-2024-41107) against  [CVE-2024-41107](https://www.cve.org/CVERecord?id=CVE-2024-41107) that affects CloudStack SAML users, of severity ‘important’ explained below.

### [CVE-2024-41107](https://www.cve.org/CVERecord?id=CVE-2024-41107): SAML Signature Exclusion

The CloudStack SAML authentication (disabled by default) does not enforce signature check. In CloudStack environments where SAML authentication is enabled, an attacker that initiates CloudStack SAML single sign-on authentication can bypass SAML authentication by submitting a spoofed SAML response with no signature and known or guessed username and other user details of a SAML-enabled CloudStack user-account. In such environments, this can result in a complete compromise of the resources owned and/or accessible by a SAML enabled user-account.

### Credits

The original issue was reported by Christian Gross of Netcloud AG who filed it as a [bug report](https://github.com/apache/cloudstack/issues/4519). More recently it was reported as a security issue by the following reporters from the Apple Services Engineering Security team:

* Damon Smith
* Adam Pond
* Terry Thibault

### Affected Versions

* Apache CloudStack 4.5.0 through 4.18.2.1
* Apache CloudStack 4.19.0.0 through 4.19.0.2

## Resolution

ShapeBlue, along with the Apache CloudStack community have released LTS releases [4.19.1.0](https://github.com/apache/cloudstack/releases/tag/4.19.1.0) and [4.18.2.2](https://github.com/apache/cloudstack/releases/tag/4.18.2.2) to address the CVE that affects CloudStack SAML users.

Affected users are recommended to disable the SAML authentication plugin by setting the “saml2.enabled” global setting to “false”, or upgrade to version 4.18.2.2, 4.19.1.0 or later, which addresses this issue.

Please refer to <https://www.shapeblue.com/cloudstack-packages/> for usage of ShapeBlue provided 4.18-based and 4.19-based patch releases. To apply these patches, use the ShapeBlue CloudStack 4.18 or 4.19 repositories to upgrade packages on the management server hosts.

## Further information

For ShapeBlue support customers, please [get in touch with the support team](https://www.shapeblue.com/support/) for further information. For other CloudStack users, please use the [community mailing lists](https://cloudstack.apache.org/mailing-lists).

![Rohit Yadav](https://secure.gravatar.com/avatar/d4b37f873c552c5b3c5e12354e098e06?s=100&d=mm&r=g)[Rohit Yadav](https://www.shapeblue.com/author/rohit/)

Rohit Yadav oversees the Software Engineering function at ShapeBlue, providing leadership and mentorship to our ever-growing Engineering Team. He has been a PMC member of the project since 2015. Rohit is the author & maintainer of the CloudStack CloudMonkey project and has been instrumental in the development of many of CloudStack’s flagship features. Rohit regularly speaks at events, focussing on developer access to the project, and has also mentored Google Summer of Code students.

* [by Rohit Yadav](https://www.shapeblue.com/author/rohit/)
* < 1  min read
* July 19, 2024
* [Advisories](https://www.shapeblue.com/category/advisories/)

Share:

### Related Posts:

[![](https://www.shapeblue.com/wp-content/uploads/2024/11/acs-security-release-november-1024x536.jpg)](https://www.shapeblue.com/shapeblue-security-advisory-apache-cloudstack-security-releases-4-18-2-5-and-4-19-1-3/)

## [ShapeBlue Security Advisory: Apache CloudStack Security Releases 4.18.2.5 and 4.19.1.3](https://www.shapeblue.com/shapeblue-security-advisory-apache-cloudstack-security-releases-4-18-2-5-and-4-19-1-3/)

* [Ivet Petrova](https://www.shapeblue.com/author/ivet-petrova/)
* November 12, 2024

* Category:
* [Advisories](https://www.shapeblue.com/category/advisories/)

[![](https://www.shapeblue.com/wp-content/uploads/2024/10/SA-October-1024x536.jpg)](https://www.shapeblue.com/shapeblue-security-advisory-apache-cloudstack-security-releases-4-18-2-4-and-4-19-1-2/)

## [ShapeBlue Security Advisory: Apache CloudStack Security Releases 4.18.2.4 and 4.19.1.2](https://www.shapeblue.com/shapeblue-security-advisory-apache-cloudstack-security-releases-4-18-2-4-and-4-19-1-2/)

* [Rohit Yadav](https://www.shapeblue.com/author/rohit/)
* October 15, 2024

* Category:
* [Advisories](https://www.shapeblue.com/category/advisories/)

## Our Services

* [CloudStack Software Engineering](https://www.shapeblue.com/cloudstack-software-engineering/)
* [CloudStack Support](https://www.shapeblue.com/cloudstack-infrastructure-support/)
* [IAAS Cloud Design & Build](https://www.shapeblue.com/iaas-cloud-design-and-build/)
* [CloudStack Consulting](https://www.shapeblue.com/cloudstack-consulting/)
* [CloudStack Training](https://www.shapeblue.com/cloudstack-training/)

## Apache CloudStack

* [Overview](https://www.shapeblue.com/apache-cloudstack-overview/)
* [Integrations](https://www.shapeblue.com/apache-cloudstack-integrations/)
* [Use Cases](https://www.shapeblue.com/apache-cloudstack-use-cases/)
* [Community](https://www.shapeblue.com/apache-cloudstack-community/)
* [Events](https://www.shapeblue.com/events/)

[![Good Business Charter White Logo](https://www.shapeblue.com/wp-content/uploads/elementor/thumbs/gbc-accredited-stamp-transparent-white-rgb-qkt4y8oxgxbzzhs3mpkbdemggj1zipykifp2biclss.png "gbc-accredited-stamp-transparent-white-rgb")](https://www.shapeblue.com/shapeblue-joins-the-good-business-charter/)

![](https://www.shapeblue.com/wp-content/uploads/2023/07/eoa-proudly-employee-owned-1024x434-1.png)

## Resources

* [Blogs & News](https://www.shapeblue.com/blogs-news/)
* [Case Studies](https://www.shapeblue.com/case-studies/)

## [Contact](https://www.shapeblue.com/offices/)

## [About](https://www.shapeblue.com/about/)

## [CloudStack Packages](https://www.shapeblue.com/cloudstack-packages/)

* eursales@shapeblue.com
* +44(0) 20 3603 0540

[Twitter](https://twitter.com/shapeblue)

[Facebook](https://www.facebook.com/shapeblueltd/)

[Linkedin-in](https://www.linkedin.com/company/shapeblue/)

[![Good Business Charter White Logo](https://www.shapeblue.com/wp-content/uploads/elementor/thumbs/gbc-accredited-stamp-transparent-white-rgb-qkt4y8oxgxbzzhs3mpkbdemggj1zipykifp2biclss.png "gbc-accredited-stamp-transparent-white-rgb")](https://www.shapeblue.com/shapeblue-joins-the-good-business-charter/)

![](https://www.shapeblue.com/wp-content/uploads/2023/07/eoa-proudly-employee-owned-1024x434-1-300x127.png)

![](https://www.shapeblue.com/wp-content/uploads/2023/07/Map-1.svg)
[London](https://www.shapeblue.com/offices#london)
[MOUNTAINVIEW, CA](https://www.shapeblue.com/offices#mountain-view)
[SÃO PAULO](https://www.shapeblue.com/offices#brasil)
[Cape town](https://www.shapeblue.com/offices#cape-town)
[bangalore](https://www.shapeblue.com/offices#india)

[Twitter](https://twitter.com/shapeblue)

[Facebook](https://www.facebook.com/shapeblueltd/)

[Linkedin-in](https://www.linkedin.com/company/shapeblue/)

[Github](https://github.com/shapeblue)

© Copyright – ShapeBlue Ltd 2013-2024. All rights reserved.

ShapeBlue Ltd is a company incorporated in England & Wales. ShapeBlue is a registered trademark.

CloudStack and the CloudStack logo are trademarks of the Apache Software Foundation.

* [ShapeBlue Support Matrix](https://www.shapeblue.com/wp-content/uploads/2024/08/Support-Matrix-August-2024.pdf)
* [Terms and Conditions](https://www.shapeblue.com/terms-and-conditions/)
* [Privacy Policy](https://www.shapeblue.com/privacy-policy/)

![Cleantalk Pixel](https://moderate8-v4.cleantalk.org/pixel/f5e35a5f461d42949bec31c0e1c1bd76.gif "Cleantalk Pixel")[ShapeBlue](https://www.shapeblue.com/?blackhole=02d64de29b "Do NOT follow this link or you will be banned from the site!")

![](https://www.shapeblue.com/wp-content/uploads/2024/04/vmware-to-apache-cloudstack-768x401.png)

#### [**Migration Guide: VMware to Apache CloudStack**](https://www.shapeblue.com/vmware-to-apache-cloudstack-migration-guide/)

Download a step-by-step guide to migrate your existing vSphere environment to a robust IaaS cloud environment based on Apache CloudStack and the KVM Hypervisor, ensuring a smooth, low-friction migration journey.

[Learn more](https://www.shapeblue.com/vmware-to-apache-cloudstack-migration-guide/)



=== Content from www.openwall.com_1fe468b6_20250111_170528.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <a2ad502e-1c23-e0af-6030-90a41b556079@apache.org>
Date: Fri, 19 Jul 2024 10:11:23 +0000
From: Rohit Yadav <rohit@...che.org>
To: oss-security@...ts.openwall.com
Subject: CVE-2024-41107: Apache CloudStack: SAML Signature Exclusion

Severity: important

Affected versions:

- Apache CloudStack 4.5.0 through 4.18.2.1
- Apache CloudStack 4.19.0.0 through 4.19.0.2

Description:

The CloudStack SAML authentication (disabled by default) does not enforce signature check. In CloudStack environments where SAML authentication is enabled, an attacker that initiates CloudStack SAML single sign-on authentication can bypass SAML authentication by submitting a spoofed SAML response with no signature and known or guessed username and other user details of a SAML-enabled CloudStack user-account. In such environments, this can result in a complete compromise of the resources owned and/or accessible by a SAML enabled user-account.

Affected users are recommended to disable the SAML authentication plugin by setting the "saml2.enabled" global setting to "false", or upgrade to version 4.18.2.2, 4.19.1.0 or later, which addresses this issue.

Credit:

Christian Gross of Netcloud AG (finder)
Damon Smith of Apple Services Engineering Security (finder)
Adam Pond of Apple Services Engineering Security (finder)
Terry Thibault of Apple Services Engineering Security (finder)

References:

<https://lists.apache.org/thread/5q06g8zvmhcw6w3tjr6r5prqdw6zckg3>
<https://cloudstack.apache.org/blog/security-release-advisory-cve-2024-41107>
<https://github.com/apache/cloudstack/issues/4519>
<https://www.shapeblue.com/shapeblue-security-advisory-apache-cloudstack-cve-2024-41107>
<https://cloudstack.apache.org/>
<https://www.cve.org/CVERecord?id=CVE-2024-41107>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


