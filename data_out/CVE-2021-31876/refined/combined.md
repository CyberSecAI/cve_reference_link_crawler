=== Content from bitcoinops.org_bbbc9b8e_20250108_135906.html ===

[![OpTech Logo](/img/logos/optech-horiz.png)](/)

[About](/en/about/)
[Publications](/en/publications/)
[Topics](/en/topics/)
[Workshops](/en/workshops/)
[Compatibility](/en/compatibility/)
[Dashboard](https://dashboard.bitcoinops.org/)

/ [home](/) / [topics](/en/topics/) /

# Replace-by-fee (RBF)

*Also covering BIP125, Opt-in Replace-by-Fee, and Full-RBF*

**Replace-By-Fee (RBF)** is a node policy that allows an unconfirmed transaction in a mempool to be replaced with a different transaction that spends at least one of the same inputs and which pays a higher transaction fee.

Different node software can use different RBF rules, so there have
been several variations. The most widely-used form of RBF today is
[BIP125](https://github.com/bitcoin/bips/blob/master/bip-0125.mediawiki) **opt-in RBF** as
implemented in [Bitcoin Core 0.12.0](https://bitcoincore.org/en/releases/0.12.0/#opt-in-replace-by-fee-transactions) and subsequent
versions; this allows the creator of a transaction to signal that
they’re willing to allow it to be replaced by a higher-paying version.
An alternative form of RBF is **full-RBF** that allows any transaction to
be replaced whether or not it signals BIP125 replaceability.

BIP125 requires a replacement transaction to pay both higher feerate
(BTC/vbyte) and a higher absolute fee (total BTC). This can make
multiparty transactions that want to use RBF vulnerable to
[transaction pinning](https://bitcoin.stackexchange.com/questions/80803/what-is-meant-by-transaction-pinning) attacks, and so an occasional discussion
topic is proposals to allow RBF to operate solely on a feerate basis.

## Primary code and documentation

* [BIP125](https://github.com/bitcoin/bips/blob/master/bip-0125.mediawiki)
* [Bitcoin Core PR #6871: nSequence-based Full-RBF opt-in](https://github.com/bitcoin/bitcoin/pull/6871)

## Optech newsletter and website mentions

**2024**

* [Bitcoin Core #30592 removes the `mempoolfullrbf` setting](/en/newsletters/2024/11/15/#bitcoin-core-30592)
* [Nodes with full-RBF successfully reconstructing more compact blocks than nodes with only opt-in RBF](/en/newsletters/2024/08/09/#replacement-cycle-attack-against-pay-to-anchor)
* [Bitcoin Core #30493 enables full RBF by default](/en/newsletters/2024/08/09/#bitcoin-core-30493)
* [Question: why does RBF rule #3 exist?](/en/newsletters/2024/07/26/#why-does-rbf-rule-3-exist)
* [Bitcoin Core #28984 adds support for a limited version of package replace-by-fee](/en/newsletters/2024/06/28/#bitcoin-core-28984)
* [Question about the size of transactions that opt-in to RBF, opt-out of RBF, and replacements](/en/newsletters/2024/04/24/#are-replacement-transactions-larger-in-size-than-their-predecessors-and-than-non-rbf-transactions)
* [Analysis of how cluster mempool would’ve affected RBF in 2023](/en/newsletters/2024/04/17/#rbf-differences-were-negligible)
* [Bitcoin Core #29242 lays the groundwork for package replace by fee](/en/newsletters/2024/04/03/#bitcoin-core-29242)
* [BitGo adds RBF support](/en/newsletters/2024/03/20/#bitgo-adds-rbf-support)
* [Pure replace by feerate is not guaranteed to be incentive compatible](/en/newsletters/2024/02/21/#pure-replace-by-feerate-doesn-t-guarantee-incentive-compatibility)
* [Proposal for replace-by-feerate to avoid transaction pinning](/en/newsletters/2024/02/07/#proposal-for-replace-by-feerate-to-escape-pinning)
* [Idea to apply RBF rules to v3 transactions to allow removing CPFP carve-out for cluster mempool](/en/newsletters/2024/01/31/#kindred-replace-by-fee)

**2023**

* [Discussion of cluster mempool for RBF](/en/newsletters/2023/12/06/#post-cluster-package-rbf)
* [Summary of well-known behavior for wallets to avoid when creating multiple replacements](/en/newsletters/2023/10/25/#fn:rbf-warning)
* [Replacement cycle attacks on HTLCs](/en/newsletters/2023/10/25/#replacement-cycling-vulnerability-against-htlcs)
* [Recommendation to RBF fee bump pre-signed transactions with more pre-signed transactions](/en/newsletters/2023/10/25/#presigned-fee-bumps)
* [Proposal for miners to automatically retry previously replaced transactions](/en/newsletters/2023/10/25/#automatic-retrying-of-past-transactions)
* [Proposal to enable full-RBF by default](/en/newsletters/2023/08/09/#full-rbf-by-default)
* [Question about whether 0 OP\_CSV forces the spending transaction to signal BIP125 replaceability?](/en/newsletters/2023/07/26/#does-0-op-csv-force-the-spending-transaction-to-signal-bip125-replaceability)
* [Suggested best practices for CPFP or RBF fee-bumping a previous CPFP fee bump](/en/newsletters/2023/04/26/#best-practices-with-multiple-cpfps-cpfp-rbf)
* [Bitcoin Core #25344 updates the fee-bumping RPCs to allow altering replacement outputs](/en/newsletters/2023/02/22/#bitcoin-core-25344)
* [Continued RBF discussion, including number of full-RBF nodes, RBF-FSS, and RBF motivation](/en/newsletters/2023/01/04/#continued-rbf-discussion)

**2022**

* [2022 year-in-review: replace-by-fee](/en/newsletters/2022/12/21/#rbf)
* [Website to monitor unsignaled transaction replacements](/en/newsletters/2022/12/14/#monitoring-of-full-rbf-replacements)
* [Continued discussion about enabling full-RBF in Bitcoin Core](/en/newsletters/2022/11/09/#continued-discussion-about-enabling-full-rbf)
* [Discussion about `mempoolfullrbf` option’s effect on mempool consistency](/en/newsletters/2022/11/02/#mempool-consistency)
* [Continued discussion about `mempoolfullrbf` option for enabling full RBF](/en/newsletters/2022/10/26/#continued-discussion-about-full-rbf)
* [History of the term “full RBF”](/en/newsletters/2022/10/19/#fn:full-rbf)
* [Concerns raised about configuration option allowing full replace by fee in Bitcoin Core](/en/newsletters/2022/10/19/#transaction-replacement-option)
* [Proposal for relay of v3 transactions allows replacement](/en/newsletters/2022/10/05/#proposed-new-transaction-relay-policies-designed-for-ln-penalty)
* [Bitcoin Core #25610 opts-in the RPCs and `-walletrbf` to RBF by default](/en/newsletters/2022/08/10/#bitcoin-core-25610)
* [Bitcoin Core fullrbf setting where the node always allows transaction replacement](/en/newsletters/2022/07/13/#bitcoin-core-25353)
* [Discussion about enabling full replace by fee in Bitcoin Core (off by default)](/en/newsletters/2022/06/22/#full-replace-by-fee)
* [Discussion about allowing transaction witness replacement without a fee bump](/en/newsletters/2022/03/30/#transaction-witness-replacement)
* [Summary of recent proposed changes to RBF policy](/en/newsletters/2022/03/16/#ideas-for-improving-rbf-policy)
* [Discussion about RBF policy, including suggested changes](/en/newsletters/2022/02/09/#discussion-about-rbf-policy)
* [Proposal to briefly allow full RBF before using default opt-in RBF](/en/newsletters/2022/01/05/#brief-full-rbf-then-opt-in-rbf)

**2021**

* [2021 year-in-review: default transaction replacement by fee](/en/newsletters/2021/12/22/#default-rbf)
* [2021 year-in-review: BIP125 opt-in replace-by-fee discrepency](/en/newsletters/2021/12/22/#bip125)
* [Proposal of initial RBF rules for mempool package acceptance before implementing package relay](/en/newsletters/2021/09/22/#package-mempool-acceptance-and-package-rbf)
* [Trezor wallet software defaults to enabling BIP125 RBF](/en/newsletters/2021/06/23/#trezor-suite-adds-rbf-support)
* [Proposal to allow any mempool transaction to be replaced by default](/en/newsletters/2021/06/23/#allowing-transaction-replacement-by-default)
* [Continued discussion about CVE-2021-31876’s impact on protocols using RBF](/en/newsletters/2021/05/19/#cve-2021-31876-bip125-implementation-discrepancy-follow-up)
* [CVE-2021-31876 discrepancy between BIP125 and Bitcoin Core implementation](/en/newsletters/2021/05/12/#cve-2021-31876-discrepancy-between-bip125-and-bitcoin-core-implementation)
* [Upcoming relay policy workshop to discuss RBF and other topics](/en/newsletters/2021/04/28/#call-for-topics-in-layer-crossing-workshop)
* [Recovering lost LN funding transactions after RBF fee bumping](/en/newsletters/2021/03/17/#rescuing-lost-ln-funding-transactions)
* [Question: would first-seen-safe prevent confirmed RBF double spends?](/en/newsletters/2021/01/27/#would-first-seen-prevent-a-double-spend-attack)

**2020**

* [Sparrow wallet adds support for RBF fee bumping](/en/newsletters/2020/12/16/#sparrow-adds-replace-by-fee)
* [C-Lightning #3870 implements RBF scorched earth for penalty transactions](/en/newsletters/2020/09/16/#c-lightning-3870)
* [Bitcoin Core #16373 allows the bumpfee RPC used for RBF to return a PSBT](/en/newsletters/2020/01/15/#bitcoin-core-16373)

**2019**

* [Compatibility matrix—Replace by Fee](/en/compatibility#replace-by-fee-rbf)
* [Bitcoin Core removes `mempoolreplacement` configuration option](/en/newsletters/2019/06/26/#bitcoin-core-16171)
* [LND adds support for RBF fee bumping](/en/newsletters/2019/06/19/#lnd-3140)
* [Proposal to override some BIP125 RBF conditions](/en/newsletters/2019/06/12/#proposal-to-override-some-bip125-rbf-conditions)
* [RBF in the wild (survey of RBF usage)](/en/rbf-in-the-wild/)

**2018**

* [2018 year-in-review: transaction statistics](/en/newsletters/2018/12/28/#opt-in-rbf)

## See also

* [Transaction pinning](/en/topics/transaction-pinning/)
* [Version 3 transaction relay](/en/topics/version-3-transaction-relay/)
* [Opt-in RBF FAQ](https://bitcoincore.org/en/faq/optin_rbf/)
* [Optech Dashboard: BIP125 usage](https://dashboard.bitcoinops.org/d/ZsCio4Dmz/rbf-signalling?orgId=1)

**Previous Topic:**
[Rendez-vous routing](/en/topics/rendez-vous-routing/)

**Next Topic:**
[Replacement cycling](/en/topics/replacement-cycling/)

[Edit page](https://github.com/bitcoinops/bitcoinops.github.io/edit/master/_topics/en/replace-by-fee.md)

[Report Issue](https://github.com/bitcoinops/bitcoinops.github.io/issues/new?body=Source file: _topics/en/replace-by-fee.md)

## Bitcoin Optech

* Bitcoin Optech
* info@bitcoinops.org

* [bitcoinops](https://github.com/bitcoinops)
* [bitcoinoptech](https://x0f.org/%40bitcoinoptech)
* [bitcoinoptech](https://www.twitter.com/bitcoinoptech)

Helping Bitcoin-based businesses integrate scaling technology.



=== Content from en.bitcoin.it_c480364a_20250108_135906.html ===


# Common Vulnerabilities and Exposures

From Bitcoin Wiki

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)

| CVE | Announced | Affects | Severity | Attack is... | Flaw | Net |
| --- | --- | --- | --- | --- | --- | --- |
| Pre-BIP protocol changes | n/a | All Bitcoin clients | Netsplit[[1]](#cite_note-Netsplit-1) | Implicit[[2]](#cite_note-hardfork-2) | [Various hardforks and softforks](/wiki/Consensus_versions "Consensus versions") | 100% |
| [CVE-2010-5137](#CVE-2010-5137) | 2010-07-28 | wxBitcoin and bitcoind | DoS[[3]](#cite_note-DoS-3) | Easy | OP\_LSHIFT crash | 100% |
| [CVE-2010-5141](#CVE-2010-5141) | 2010-07-28 | wxBitcoin and bitcoind | Theft[[4]](#cite_note-Theft-4) | Easy | OP\_RETURN could be used to spend any output. | 100% |
| [CVE-2010-5138](#CVE-2010-5138) | 2010-07-29 | wxBitcoin and bitcoind | DoS[[3]](#cite_note-DoS-3) | Easy | Unlimited SigOp DoS | 100% |
| **[CVE-2010-5139](/wiki/CVE-2010-5139 "CVE-2010-5139")** | 2010-08-15 | wxBitcoin and bitcoind | Inflation[[5]](#cite_note-inflation-5) | Easy | Combined output overflow | 100% |
| [CVE-2010-5140](#CVE-2010-5140) | 2010-09-29 | wxBitcoin and bitcoind | DoS[[3]](#cite_note-DoS-3) | Easy | Never confirming transactions | 100% |
| [CVE-2011-4447](#CVE-2011-4447) | 2011-11-11 | wxBitcoin and bitcoind | Exposure[[6]](#cite_note-Exposure-6) | Hard | Wallet non-encryption | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2011-4447.html) |
| [CVE-2012-1909](#CVE-2012-1909) | 2012-03-07 | Bitcoin protocol and all clients | Netsplit[[1]](#cite_note-Netsplit-1) | Very hard | Transaction overwriting | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-1909.html) |
| [CVE-2012-1910](#CVE-2012-1910) | 2012-03-17 | bitcoind & Bitcoin-Qt for Windows | Unknown[[7]](#cite_note-Unknown-7) | Hard | Non-thread safe MingW exceptions | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-1910.html) |
| [BIP 0016](#BIP-0016) | 2012-04-01 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: P2SH | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/BIP-0016.html) |
| [CVE-2012-2459](#CVE-2012-2459) | 2012-05-14 | bitcoind and Bitcoin-Qt | Netsplit[[1]](#cite_note-Netsplit-1) | Easy | Block hash collision (via merkle root) | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-2459.html) |
| **[CVE-2012-3789](/wiki/CVE-2012-3789 "CVE-2012-3789")** | 2012-06-20 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | (Lack of) orphan txn resource limits | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20123789) |
| [CVE-2012-4682](#CVE-2012-4682) |  | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) |  |  | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-4682.html) |
| **[CVE-2012-4683](/wiki/CVE-2012-4683 "CVE-2012-4683")** | 2012-08-23 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Targeted DoS by CPU exhaustion using alerts | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-4683.html) |
| **[CVE-2012-4684](/wiki/CVE-2012-4684 "CVE-2012-4684")** | 2012-08-24 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Network-wide DoS using malleable signatures in alerts | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20124684) |
| [CVE-2013-2272](#CVE-2013-2272) | 2013-01-11 | bitcoind and Bitcoin-Qt | Exposure[[6]](#cite_note-Exposure-6) | Easy | Remote discovery of node's wallet addresses | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132272) |
| [CVE-2013-2273](#CVE-2013-2273) | 2013-01-30 | bitcoind and Bitcoin-Qt | Exposure[[6]](#cite_note-Exposure-6) | Easy | Predictable change output | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132273) |
| [CVE-2013-2292](#CVE-2013-2292) | 2013-01-30 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Hard | A transaction that takes at least 3 minutes to verify | [0%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132292) |
| **[CVE-2013-2293](/wiki/CVE-2013-2293 "CVE-2013-2293")** | 2013-02-14 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Continuous hard disk seek | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132293) |
| [CVE-2013-3219](#CVE-2013-3219) | 2013-03-11 | bitcoind and Bitcoin-Qt 0.8.0 | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Unenforced block protocol rule | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20133219) |
| [CVE-2013-3220](#CVE-2013-3220) | 2013-03-11 | bitcoind and Bitcoin-Qt | Netsplit[[1]](#cite_note-Netsplit-1) | Hard | Inconsistent BDB lock limit interactions | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20133220) |
| [BIP 0034](#BIP-0034) | 2013-03-25 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Height in coinbase | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/BIP-0034.html) |
| [BIP 0050](#BIP-0050) | 2013-05-15 | All Bitcoin clients | Netsplit[[1]](#cite_note-Netsplit-1) | Implicit[[2]](#cite_note-hardfork-2) | Hard fork to remove txid limit protocol rule | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?50) |
| [CVE-2013-4627](#CVE-2013-4627) | 2013-06-?? | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Memory exhaustion with excess tx message data | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20134627) |
| [CVE-2013-4165](#CVE-2013-4165) | 2013-07-20 | bitcoind and Bitcoin-Qt | Theft[[10]](#cite_note-theft-local-timing-10) | Local | Timing leak in RPC authentication | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20134165) |
| [CVE-2013-5700](#CVE-2013-5700) | 2013-09-04 | bitcoind and Bitcoin-Qt 0.8.x | DoS[[3]](#cite_note-DoS-3) | Easy | Remote p2p crash via bloom filters | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20135700) |
| [CVE-2014-0160](#CVE-2014-0160) | 2014-04-07 | Anything using OpenSSL for TLS | Unknown[[7]](#cite_note-Unknown-7) | Easy | Remote memory leak via payment protocol | Unknown |
| [CVE-2015-3641](https://bitcoincore.org/en/2024/07/03/disclose_receive_buffer_oom/) | 2014-07-07 | bitcoind and Bitcoin-Qt prior to 0.10.2 | DoS[[3]](#cite_note-DoS-3) | Easy | OOM via p2p | [99.9%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20135700) |
| BIP 66 | 2015-02-13 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Strict DER signatures | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?66) |
| BIP 65 | 2015-11-12 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: OP\_CHECKLOCKTIMEVERIFY | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?65) |
| BIPs 68, 112 & 113 | 2016-04-11 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softforks: Rel locktime, CSV & MTP locktime | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?68) |
| CVE-2015-6031 | 2015-09-15 | MiniUPnPcBitcoin Core/Knots prior to 0.11.2 | Anything | LAN | Buffer overflow |
| BIPs 141, 143 & 147 | 2016-10-27 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Segwit | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?141) |
| [CVE-2016-8889](#CVE-2016-8889) | 2016-10-27 | Bitcoin Knots GUI 0.11.0 - 0.13.0 | Exposure | Hard | Debug console history storing sensitive info | 100% |
| CVE-2017-9230 | ? | Bitcoin | ? | ? | ASICBoost | 0% |
| BIP 148 | 2017-03-12 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Segwit UASF | ? |
| [CVE-2017-12842](#CVE-2017-12842) | 2018-06-09 |  |  |  | No commitment to block merkle tree depth |  |
| [CVE-2016-10724](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-July/016189.html) | 2018-07-02 | bitcoind and Bitcoin-Qt prior to 0.13.0 | DoS[[3]](#cite_note-DoS-3) | Keyholders[[11]](#cite_note-KeyholderEasy-11) | Alert memory exhaustion | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201610724) |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-header-spam/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.15.0 | DoS[[3]](#cite_note-DoS-3) | Easy | OOM via fake block headers |
| [CVE-2016-10725](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-July/016189.html) | 2018-07-02 | bitcoind and Bitcoin-Qt prior to 0.13.0 | DoS[[3]](#cite_note-DoS-3) | Keyholders[[11]](#cite_note-KeyholderEasy-11) | Final alert cancellation | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201610724) |
| [CVE-2018-17144](#CVE-2018-17144) | 2018-09-17 | bitcoind and Bitcoin-Qt prior to 0.16.3 | Inflation[[5]](#cite_note-inflation-5) | Miners[[9]](#cite_note-MinerEasy-9) | Missing check for duplicate inputs | [80%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201817144) |
| [CVE-2018-20587](https://medium.com/%40lukedashjr/cve-2018-20587-advisory-and-full-disclosure-a3105551e78b) | 2019-02-08 | Bitcoin Knots prior to 0.17.1, and all current Bitcoin Core releases | Theft[[10]](#cite_note-theft-local-timing-10) | Local | No alert for RPC service binding failure | [<1%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201820587) |
| [CVE-2017-18350](#CVE-2017-18350) | 2019-06-22 | bitcoind and Bitcoin-Qt prior to 0.15.1 | Unknown | Varies[[12]](#cite_note-12) | Buffer overflow from SOCKS proxy | [94%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201718350) |
| [CVE-2018-20586](#CVE-2018-20586) | 2019-06-22 | bitcoind and Bitcoin-Qt prior to 0.17.1 | Deception | RPC access | Debug log injection via unauthenticated RPC | [77%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201820586) |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-orphan-dos/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.18.0 | DoS | Easy | Orphan transaction CPU tieup |
| [CVE-2019-12998](https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-September/002174.html) | 2019-08-30 | c-lightning prior to 0.7.1 | Theft | Easy | Missing check of channel funding UTXO |
| [CVE-2019-12999](https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-September/002174.html) | 2019-08-30 | lnd prior to 0.7 | Theft | Easy | Missing check of channel funding UTXO amount |
| [CVE-2019-13000](https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-September/002174.html) | 2019-08-30 | eclair prior to 0.3 | Theft | Easy | Missing check of channel funding UTXO |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-inv-buffer-blowup/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.0 | DoS | Easy | Network buffer OOM |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-getdata-cpu/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.0 | CPU usage | Easy | Infinite loop via p2p |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-bip70-crash/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.0 | DoS | Recipient[[13]](#cite_note-Recipient-13) | OOM via malicious BIP72 URI |
| [CVE-2020-14199](#CVE-2020-14199) | 2020-06-03 | Trezor and others | Theft | Social[[14]](#cite_note-14) | Double-signing can enable unintended fees |
| [CVE-2018-17145](https://invdos.net/) | 2020-09-09 | Bitcoin Core prior to 0.16.2Bitcoin Knots prior to 0.16.1Bcoin prior to 1.0.2Btcd prior to 0.21.0 | DoS[[3]](#cite_note-DoS-3) | Easy | p2p memory blow-up | [87%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201817145) |
| [CVE-2020-26895](#CVE-2020-26895) | 2020-10-08 | lnd prior to 0.10 | Theft | Easy | Missing low-S normalization for HTLC signatures |
| [CVE-2020-26896](#CVE-2020-26896) | 2020-10-08 | lnd prior to 0.11 | Theft | Varies[[15]](#cite_note-15) | Invoice preimage extraction via forwarded HTLC |
| [CVE-2020-14198](https://bitcoincore.org/en/2024/07/03/disclose-unbounded-banlist/) |  | Bitcoin Core 0.20.1 | DoS[[3]](#cite_note-DoS-3) | Easy | Remote DoS | [93%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?202014198) |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-timestamp-overflow/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.2 | Netsplit[[1]](#cite_note-Netsplit-1) | Varies | Adjusted time manipulation |
| [CVE-2021-3401](#CVE-2021-3401) | 2021-02-01 | Bitcoin Core GUI prior to 0.19.0Bitcoin Knots GUI prior to 0.18.1 | Theft | Hard | Qt5 remote execution | [64%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20213401) |
| [TBD](https://bitcoincore.org/en/2024/07/31/disclose-upnp-oom/) | 2024-07-31 | Bitcoin Core/Knots prior to 22.0 with UPnP enabled | DoS | Local | OOM via LAN spam |
| [TBD](https://bitcoincore.org/en/2024/07/31/disclose-addrman-int-overflow/) | 2024-07-31 | Bitcoin Core/Knots prior to 22.0 | DoS | Easy | OOM via p2p spam |
| [CVE-2021-31876](#CVE-2021-31876) | 2021-05-06 | Various wallets |  |  |  |
| CVE-2021-41591 | 2021-10-04 | Lightning software |  |  |  |
| CVE-2021-41592 | 2021-10-04 | Lightning software |  |  |  |
| CVE-2021-41593 | 2021-10-04 | Lightning software |  |  |  |
| BIPs 341-343 | 2021-11-13 | All Bitcoin nodes | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Taproot | [57%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?343) |
| [CVE-2022-31246](https://github.com/spesmilo/electrum/security/advisories/GHSA-4fh4-hx35-r355) | 2022-06-07 | Electrum 2.1 until before 4.2.2 | Theft | Social |  |
| [CVE-2023-50428](#CVE-2023-50428) | 2023 | All Bitcoin nodes | DoS[[3]](#cite_note-DoS-3) | Easy | Bypass of datacarriersize limit using OP\_FALSE,OP\_IF |  |
| [CVE-2024-34149](#CVE-2024-34149) | 2024-03-30 | Bitcoin Core 0.21.1 and newer (not fixed)Bitcoin Knots 0.21.1 - 0.23.0 | DoS[[3]](#cite_note-DoS-3) | Easy | Script size limit not enforced for Tapscript |  |

1. ↑ [1.0](#cite_ref-Netsplit_1-0) [1.1](#cite_ref-Netsplit_1-1) [1.2](#cite_ref-Netsplit_1-2) [1.3](#cite_ref-Netsplit_1-3) [1.4](#cite_ref-Netsplit_1-4) [1.5](#cite_ref-Netsplit_1-5) Attacker can create multiple views of the network, enabling [double-spending](/wiki/Double-spending "Double-spending") with over 1 confirmation
2. ↑ [2.0](#cite_ref-hardfork_2-0) [2.1](#cite_ref-hardfork_2-1) This is a protocol "hard-fork" that old clients will reject as invalid and must therefore not be used.
3. ↑ [3.00](#cite_ref-DoS_3-0) [3.01](#cite_ref-DoS_3-1) [3.02](#cite_ref-DoS_3-2) [3.03](#cite_ref-DoS_3-3) [3.04](#cite_ref-DoS_3-4) [3.05](#cite_ref-DoS_3-5) [3.06](#cite_ref-DoS_3-6) [3.07](#cite_ref-DoS_3-7) [3.08](#cite_ref-DoS_3-8) [3.09](#cite_ref-DoS_3-9) [3.10](#cite_ref-DoS_3-10) [3.11](#cite_ref-DoS_3-11) [3.12](#cite_ref-DoS_3-12) [3.13](#cite_ref-DoS_3-13) [3.14](#cite_ref-DoS_3-14) [3.15](#cite_ref-DoS_3-15) [3.16](#cite_ref-DoS_3-16) [3.17](#cite_ref-DoS_3-17) [3.18](#cite_ref-DoS_3-18) Attacker can disable some functionality, for example by crashing clients
4. [↑](#cite_ref-Theft_4-0) Attacker can take coins outside known network rules
5. ↑ [5.0](#cite_ref-inflation_5-0) [5.1](#cite_ref-inflation_5-1) Attacker can create coins outside known network rules
6. ↑ [6.0](#cite_ref-Exposure_6-0) [6.1](#cite_ref-Exposure_6-1) [6.2](#cite_ref-Exposure_6-2) Attacker can access user data outside known acceptable methods
7. ↑ [7.0](#cite_ref-Unknown_7-0) [7.1](#cite_ref-Unknown_7-1) Extent of possible abuse is unknown
8. ↑ [8.0](#cite_ref-FakeConf_8-0) [8.1](#cite_ref-FakeConf_8-1) [8.2](#cite_ref-FakeConf_8-2) [8.3](#cite_ref-FakeConf_8-3) [8.4](#cite_ref-FakeConf_8-4) [8.5](#cite_ref-FakeConf_8-5) [8.6](#cite_ref-FakeConf_8-6) [8.7](#cite_ref-FakeConf_8-7) [8.8](#cite_ref-FakeConf_8-8) Attacker can double-spend with 1 confirmation
9. ↑ [9.00](#cite_ref-MinerEasy_9-0) [9.01](#cite_ref-MinerEasy_9-1) [9.02](#cite_ref-MinerEasy_9-2) [9.03](#cite_ref-MinerEasy_9-3) [9.04](#cite_ref-MinerEasy_9-4) [9.05](#cite_ref-MinerEasy_9-5) [9.06](#cite_ref-MinerEasy_9-6) [9.07](#cite_ref-MinerEasy_9-7) [9.08](#cite_ref-MinerEasy_9-8) [9.09](#cite_ref-MinerEasy_9-9) Attacking requires mining block(s)
10. ↑ [10.0](#cite_ref-theft-local-timing_10-0) [10.1](#cite_ref-theft-local-timing_10-1) Local attacker could potentially determine the RPC passphrase via a timing sidechannel.
11. ↑ [11.0](#cite_ref-KeyholderEasy_11-0) [11.1](#cite_ref-KeyholderEasy_11-1) Attacking requires signing with the publicly-disclosed alert key
12. [↑](#cite_ref-12) Depends on software configuration
13. [↑](#cite_ref-Recipient_13-0) Can only be exploited by the recipient the victim intends to pay
14. [↑](#cite_ref-14) User must be tricked into cooperating (social engineering)
15. [↑](#cite_ref-15) Depends on node configuration, only affects routable merchants, requires external knowledge of receiver's invoices and/or luck to identify receiver, only works against single-shot HTLCs (legacy or MPP)

## CVE-2010-5137

```
Date: 2010-07-28
Summary: OP_LSHIFT crash
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.4 | 0.3.5 |

On July 28 2010, two bugs were discovered and demonstrated on the test network. One caused bitcoin to crash on some machines when processing a transaction containing an OP\_LSHIFT. This was never exploited on the main network, and was fixed by Bitcoin version 0.3.5.

After these bugs were discovered, many currently-unused script words were disabled for safety.

### References

* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5137)

## CVE-2010-5141

```
Date: 2010-07-28
Summary: ?
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.4 | 0.3.5 |

On July 28 2010, two bugs were discovered and demonstrated on the test network. One exploited a bug in the transaction handling code and allowed an attacker to spend coins that they did not own. This was never exploited on the main network, and was fixed by Bitcoin version 0.3.5.

After these bugs were discovered, many currently-unused script words were disabled for safety.

### References

* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5141)

## CVE-2010-5138

```
Date: 2010-07-29
Summary: Unlimited SigOp DoS
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.? | 0.3.? |

On July 29 2010, it was discovered that block [71036](http://blockexplorer.com/block/00000000000997f9fd2fe1ee376293ef8c42ad09193a5d2086dddf8e5c426b56) contained several transactions with a ton of OP\_CHECKSIG commands. There should only ever be one such command. This caused every node to do extra unnecessary work, and it could have been used as a denial-of-service attack. A new version of Bitcoin was quickly released. The new version did not cause a fork on the main network, though it did cause one on the test network (where someone had played around with the attack more).

### References

* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5138)

## CVE-2010-5139

*Main article: [CVE-2010-5139](/wiki/CVE-2010-5139 "CVE-2010-5139")*
```
Date: 2010-08-15
Summary: Combined output overflow
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.10 | 0.3.11 |

On August 15 2010, it was [discovered](http://bitcointalk.org/index.php?topic=822.0) that block 74638 contained a transaction that created over 184 billion bitcoins for two different addresses. This was possible because the code used for checking transactions before including them in a block didn't account for the case of outputs so large that they overflowed when summed. A new version was published within a few hours of the discovery. The block chain had to be forked. Although many unpatched nodes continued to build on the "bad" block chain, the "good" block chain overtook it at a block height of 74691. The bad transaction no longer exists for people using the longest chain.

The block and transaction:

```
CBlock(hash=0000000000790ab3, ver=1, hashPrevBlock=0000000000606865, hashMerkleRoot=618eba,
nTime=1281891957, nBits=1c00800e, nNonce=28192719, vtx=2)
  CTransaction(hash=012cd8, ver=1, vin.size=1, vout.size=1, nLockTime=0)
    CTxIn(COutPoint(000000, -1), coinbase 040e80001c028f00)
    CTxOut(nValue=50.51000000, scriptPubKey=0x4F4BA55D1580F8C3A8A2C7)
  CTransaction(hash=1d5e51, ver=1, vin.size=1, vout.size=2, nLockTime=0)
    CTxIn(COutPoint(237fe8, 0), scriptSig=0xA87C02384E1F184B79C6AC)
    CTxOut(nValue=92233720368.54275808, scriptPubKey=OP_DUP OP_HASH160 0xB7A7)
    CTxOut(nValue=92233720368.54275808, scriptPubKey=OP_DUP OP_HASH160 0x1512)
  vMerkleTree: 012cd8 1d5e51 618eba

Block hash: 0000000000790ab3f22ec756ad43b6ab569abf0bddeb97c67a6f7b1470a7ec1c
Transaction hash: 1d5e512a9723cbef373b970eb52f1e9598ad67e7408077a82fdac194b65333c9
```
### References

* [Discovery](https://bitcointalk.org/index.php?topic=822.0)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5139)

## CVE-2010-5140

```
Date: 2010-09-29
Summary: Never confirming transactions
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.12 | 0.3.13 |

Around September 29, 2010, people started [reporting](https://bitcointalk.org/index.php?topic=1306.0) that their sent transactions would not confirm. This happened because people modified Bitcoin to send sub-0.01 transactions without any fees. A 0.01 fee was at that time required by the network for such transactions (essentially prohibiting them), so the transactions remained at 0 confirmations forever. This became a more serious issue because Bitcoin would send transactions using bitcoins gotten from transactions with 0 confirmations, and these resulting transactions would also never confirm. Because Bitcoin tends to prefer sending smaller coins, these invalid transactions quickly multiplied, contaminating the wallets of everyone who received them.

Bitcoin was changed to only select coins with at least 1 confirmation. The remaining sub-0.01 transactions were cleared by generators who modified their version of Bitcoin to not require the micropayment fee. It took a while for everything to get cleared, though, because many of the intermediate transactions had been forgotten by the network by this point and had to be rebroadcast by the original senders.

### References

* [Initial reports](https://bitcointalk.org/index.php?topic=1306.0)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5140)

## CVE-2011-4447

```
Date: 2011-11-11
Summary: Wallet non-encryption
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | 0.4.0 - 0.4.1rc6 | 0.4.10.5.0 |

### References

* [Announcement](https://bitcointalk.org/index.php?topic=51604.0)
* [Finding](https://bitcointalk.org/index.php?topic=51474.0)
* [0.5.0](http://bitcoin.org/releases/2011/11/21/v0.5.0.html)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2011-4447)

## CVE-2012-1909

```
Date: 2012-03-07
Summary: Transaction overwriting
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin protocol | Before March 15th, 2012 | BIP 30 |
| Bitcoin-Qtbitcoind | \* - 0.4.4rc20.5.0rc1 - 0.5.0.4rc20.5.1rc1 - 0.5.3rc20.6.0rc1 - 0.6.0rc2 | 0.4.40.5.0.40.5.30.6.0rc3 |
| wxBitcoin | ALL | NONE |

### References

* [Announcement](https://bitcointalk.org/index.php?topic=67738.0)
* [Fix](https://en.bitcoin.it/wiki/BIP_0030)
* [Gentoo bug tracker](https://bugs.gentoo.org/show_bug.cgi?id=407793)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-1909)

## CVE-2012-1910

```
Date: 2012-03-17
Summary: Non-thread safe MingW exceptions
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoind for WindowsBitcoin-Qt for Windows | 0.5.0rc1 - 0.5.0.40.5.1rc1 - 0.5.3.00.6.0rc1 - 0.6.0rc3 | 0.5.0.50.5.3.10.5.40.6.0rc4 |

### References

* [Announcement](https://bitcointalk.org/index.php?topic=69120.0)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-1910)
* [Full disclosure](http://gavintech.blogspot.com/2012/03/full-disclosure-bitcoin-qt-on-windows.html)

## BIP-0016

```
Date: 2012-04-01
Summary: Mandatory P2SH protocol update
Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.40.5.0rc1 - 0.5.0.50.5.1rc1 - 0.5.30.6.0rc1 | 0.4.50.5.0.60.5.4rc10.6.0rc2 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 0016](/wiki/BIP_0016 "BIP 0016")

## CVE-2012-2459

```
Date: 2012-05-14
Summary: Block hash collision (via merkle tree)
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.6rc10.5.0rc1 - 0.5.5rc10.6.0rc1 - 0.6.0.7rc10.6.1rc1 - 0.6.1rc1 | 0.4.60.5.50.6.0.70.6.1rc2 |

Block hash collisions can easily be made by duplicating transactions in the merkle tree.
Such a collision is invalid, but if recorded (as Bitcoin-Qt and bitcoind prior to 0.6.1 did) would prevent acceptance of the legitimate block with the same hash.
This could be used to fork the blockchain, including deep double-spend attacks.

### References

* [Announcement](https://bitcointalk.org/?topic=81749)
* [Gentoo bug tracker](https://bugs.gentoo.org/show_bug.cgi?id=415973)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-2459)
* [Full Disclosure](https://bitcointalk.org/?topic=102395)

## CVE-2012-3789

*Main article: [CVE-2012-3789](/wiki/CVE-2012-3789 "CVE-2012-3789")*
```
Date: 2012-06-20
Summary: (Lack of) orphan txn resource limits
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 | 0.4.7rc30.5.6rc30.6.0.9rc10.6.3rc1 |

### References

* [CVE-2012-3789](/wiki/CVE-2012-3789 "CVE-2012-3789")
* [0.6.3rc1 Announcement](https://bitcointalk.org/?topic=88734)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-3789)

## CVE-2012-4682

```
Date:
Summary:
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 | 0.4.7rc30.5.6rc30.6.0.9rc10.6.3rc1 |

### References

* [CVE-2012-4682](/w/index.php?title=CVE-2012-4682&action=edit&redlink=1 "CVE-2012-4682 (page does not exist)")
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=435216)

## CVE-2012-4683

*Main article: [CVE-2012-4683](/wiki/CVE-2012-4683 "CVE-2012-4683")*
```
Date: 2012-08-23
Summary: Targeted DoS by CPU exhaustion using alerts
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 | 0.7.0 |

### References

* [CVE-2012-4683](/wiki/CVE-2012-4683 "CVE-2012-4683")
* [Announcement](https://bitcointalk.org/index.php?topic=148038.0)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=435216)

## CVE-2012-4684

*Main article: [CVE-2012-4684](/wiki/CVE-2012-4684 "CVE-2012-4684")*
```
Date: 2012-08-24
Summary: Network-wide DoS using malleable signatures in alerts
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 - 0.6.3rc1 | 0.7.0 |

### References

* [CVE-2012-4684](/wiki/CVE-2012-4684 "CVE-2012-4684")
* [Announcement](https://bitcointalk.org/index.php?topic=148109.0)

## CVE-2013-2272

```
Date: 2013-01-11
Summary: Remote discovery of node's wallet addresses
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.8rc40.5.0rc1 - 0.5.70.6.0rc1 - 0.6.0.10rc40.6.1rc1 - 0.6.4rc40.7.0rc1 - 0.7.2 | 0.4.9rc10.5.8rc10.6.0.11rc10.6.5rc10.7.3rc1 |

### References

* [Announcement](https://bitcointalk.org/?topic=135856)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-2273

```
Date: 2013-01-30
Summary: Predictable change output
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.8rc40.5.0rc1 - 0.5.70.6.0rc1 - 0.6.0.10rc40.6.1rc1 - 0.6.4rc40.7.0rc1 - 0.7.2 | 0.4.9rc10.5.8rc10.6.0.11rc10.6.5rc10.7.3rc1 |

### References

* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-2292

```
Date: 2013-01-30
Summary: A transaction that takes at least 3 minutes to verify
Fix Deployment: 0%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | All versions | No fix yet |

### References

* [CVE-2013-2292](/w/index.php?title=CVE-2013-2292&action=edit&redlink=1 "CVE-2013-2292 (page does not exist)")
* [Announcement](https://bitcointalk.org/?topic=140078)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-2293

*Main article: [CVE-2013-2293](/wiki/CVE-2013-2293 "CVE-2013-2293")*
```
Date: 2013-02-14
Summary: Continuous hard disk seek
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.7.3rc1 | No fix yet (0.8.0 unaffected) |

### References

* [CVE-2013-2293](/wiki/CVE-2013-2293 "CVE-2013-2293")
* [Announcement](https://bitcointalk.org/?topic=144122)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-3219

```
Date: 2013-03-11
Summary: Unenforced block protocol rule
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.8.0rc1 - 0.8.0 | 0.8.1 |

### References

* [BIP 50](/wiki/BIP_0050 "BIP 0050")

## CVE-2013-3220

```
Date: 2013-03-11
Summary: Inconsistent BDB lock limit interactions
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc10.5.0rc1 - 0.5.8rc10.6.0rc1 - 0.6.5rc10.7.0rc1 - 0.7.3rc1 | 0.4.9rc20.5.8rc20.6.5rc20.7.3rc2 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 50](/wiki/BIP_0050 "BIP 0050")

## BIP-0034

```
Date: 2013-03-25
Summary: Mandatory block protocol update
Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.70.5.0rc1 - 0.5.70.6.0rc1 - 0.6.0.90.6.1rc1 - 0.6.3 | 0.4.8rc10.5.7rc10.6.0.10rc10.6.4rc1 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 0034](/wiki/BIP_0034 "BIP 0034")

## BIP-0050

```
Date: 2013-05-15
Summary: Hard fork to remove txid limit protocol rule
Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc10.5.0rc1 - 0.5.8rc10.6.0rc1 - 0.6.5rc10.7.0rc1 - 0.7.3rc1 | 0.4.9rc20.5.8rc20.6.5rc20.7.3rc2 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 0050](/wiki/BIP_0050 "BIP 0050")

## CVE-2013-4627

```
Date: 2013-06-??
Summary: Memory exhaustion with excess tx message data
Fix Deployment: 99.9%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc30.5.0rc1 - 0.5.8rc30.6.0rc1 - 0.6.5rc30.7.0rc1 - 0.7.3rc30.8.0rc1 - 0.8.3 | 0.4.9rc40.5.8rc40.6.5rc40.7.3rc40.8.4 |
| wxBitcoin | ALL | NONE |

### References

## CVE-2013-4165

```
Date: 2013-07-20
Summary: Timing leak in RPC authentication
Fix Deployment: 99.9%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc30.5.0rc1 - 0.5.8rc30.6.0rc1 - 0.6.5rc30.7.0rc1 - 0.7.3rc30.8.0rc1 - 0.8.3 | 0.4.9rc40.5.8rc40.6.5rc40.7.3rc40.8.4rc1 |
| wxBitcoin | ALL | NONE |

### References

* [Bitcoin-Qt 0.8.4 release notes](https://bitcointalk.org/index.php?topic=287351)
* [The initial bug report](https://github.com/bitcoin/bitcoin/issues/2838)

## CVE-2013-5700

```
Date: 2013-09-04
Summary: Remote p2p crash via bloom filters
Fix Deployment: 99.9%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.8.0rc1 - 0.8.3 | 0.8.4rc1 |

### References

* [Bitcoin-Qt 0.8.4 release notes](https://bitcointalk.org/index.php?topic=287351)
* [The fix](https://github.com/bitcoin/bitcoin/commit/37c6389c5a0ca63ae3573440ecdfe95d28ad8f07)
* [An added test](https://github.com/bitcoin/bitcoin/pull/18515)

## CVE-2016-8889

```
Date: 2016-10-27
Summary: Debug console history storing sensitive info
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Knots GUI | 0.11.0 - 0.13.0 | 0.13.1 |

### References

* [Bitcoin Knots 0.16.1.knots20161027 release notes](https://github.com/bitcoinknots/bitcoin/blob/v0.13.1.knots20161027/doc/release-notes.md)
* [US-CERT/NIST](https://nvd.nist.gov/vuln/detail/CVE-2016-8889)

## CVE-2017-12842

```
Date: 2018-06-09
Summary: No commitment to block merkle tree depth

```
### References

* [Explanation by Sergio Demian Lerner](https://bitslog.wordpress.com/2018/06/09/leaf-node-weakness-in-bitcoin-merkle-tree-design/)
* [Further elaboration by Suhas Daftuar](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2019-February/016697.html)

## CVE-2017-18350

```
Date: 2019-06-22
Summary: Buffer overflow from SOCKS proxy

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.7.0rc1 - 0.15.0 | 0.15.1rc1 |

### References

* [Disclosure of details](https://medium.com/%40lukedashjr/cve-2017-18350-disclosure-fe6d695f45d5)

## CVE-2018-17144

```
Date: 2018-09-17
Summary: Missing check for duplicate inputs
Fix Deployment: 31%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.14.0rc1 - 0.14.20.15.0rc1 - 0.15.10.16.0rc1 - 0.16.2 | 0.14.30.15.20.16.3 |

### References

* [Full disclosure by Bitcoin Core](https://bitcoincore.org/en/2018/09/20/notice/)
* [Bitcoin Core 0.16.3 release notes](https://bitcoincore.org/en/2018/09/18/release-0.16.3/)
* [Bitcoin Knots 0.16.3.knots20180918 release notes](https://github.com/bitcoinknots/bitcoin/blob/v0.16.3.knots20180918/doc/release-notes.md)
* [US-CERT/NIST](https://nvd.nist.gov/vuln/detail/CVE-2018-17144)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=666669)

## CVE-2018-20586

```
Date: 2019-06-22
Summary: Debug log injection via unauthenticated RPC

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.12.0rc1 - 0.17.0 | 0.17.1rc1 |

## CVE-2020-14199

```
Date: 2020-06-03
Summary: Double-signing can enable unintended fees

```

| Affected | | Fix |
| --- | --- | --- |
| Trezor One |  | 1.9.1 |
| Trezor Model T |  | 2.3.1 |
| ??? |

### References

* [Disclosure of details by Trezor team](https://blog.trezor.io/details-of-firmware-updates-for-trezor-one-version-1-9-1-and-trezor-model-t-version-2-3-1-1eba8f60f2dd)

## CVE-2020-26895

```
Date: 2020-10-08
Summary: Missing low-S normalization for HTLC signatures.

```

| Affected | | Fix |
| --- | --- | --- |
| lnd |  | 0.10.0 |

### References

* [CVE-2020-26895: LND Low-S Tx-Relay Standardness](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002858.html)
* [Full Disclosure: Full Disclosure: CVE-2020-26895 LND "Hodl my Shitsig"](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002856.html)

## CVE-2020-26896

```
Date: 2020-10-08
Summary: Invoice preimage extraction via forwarded HTLC.

```

| Affected | | Fix |
| --- | --- | --- |
| lnd |  | 0.11.0 |

### References

* [CVE-2020-26896: LND Invoice Preimage Extraction](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002857.html)
* [Full Disclosure: CVE-2020-26896 LND "The (un)covert channel"](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002855.html)

## CVE-2021-3401

```
Date: 2021-02-01
Summary: Qt5 remote execution

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Core GUI |  | 0.19.0 |
| Bitcoin Knots GUI |  | 0.18.1 |

## CVE-2021-31876

```
Date: 2021-05-06

```
### References

* [Full Disclosure: CVE-2021-31876 Defect in Bitcoin Core's bip125 logic](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-May/018893.html)

### References

* [URI Argument Injection Vulnerability in Bitcoin Core 0.18 and Earlier](https://achow101.com/2021/02/0.18-uri-vuln)

## CVE-2023-50428

```
Date: 2023
Summary: Bypass of datacarriersize limit using OP_FALSE,OP_IF

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Core | 0.9 and later | NOT FIXED |
| Bitcoin Knots | 0.9 - 23.0 | 25.1.knots20231115 |
| btcd | ? | NOT FIXED |
| libbitcoin | ? | NOT FIXED |

## CVE-2024-34149

```
Date: 2024-03-30
Summary: Script size limit not enforced for Tapscript

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Core | 0.21.1 and later | NOT FIXED |
| Bitcoin Knots | 0.21.1 - 23.0 | 25.1.knots20231115 |
| btcd | ? | ? |
| libbitcoin | ? | ? |

## Definitions

A critical vulnerability is one that will have disastrous consequences if it is exploited. A serious vulnerability is one that will have serious consequences if it is exploited[[1]](#cite_note-16).

## See Also

* [Changelog](/wiki/Changelog "Changelog")
* <https://blog.bitmex.com/bitcoins-consensus-forks/>

## References

1. [↑](#cite_ref-16) <http://bitcointalk.org/index.php?topic=88892.0>

| | [Bitcoin Core](/wiki/Bitcoin_Core "Bitcoin Core") documentation | | | --- | --- | |  | | User documentation | [Alert system](/wiki/Alert_system "Alert system") • [Bitcoin Core compatible devices](/wiki/Bitcoin_Core_compatible_devices "Bitcoin Core compatible devices") • [Data directory](/wiki/Data_directory "Data directory") • [Fallback Nodes](/wiki/Fallback_Nodes "Fallback Nodes") • [How to import private keys in Bitcoin Core 0.7+](/wiki/Help%3AHow_to_import_private_keys_in_Bitcoin_Core_0.7%2B "Help:How to import private keys in Bitcoin Core 0.7+") • [Installing Bitcoin Core](/wiki/Help%3AInstalling_Bitcoin_Core "Help:Installing Bitcoin Core") • [Running Bitcoin](/wiki/Running_Bitcoin "Running Bitcoin") • [Transaction fees](/wiki/Transaction_fees "Transaction fees") • [Vocabulary](/wiki/Vocabulary "Vocabulary") | |  | | Developer documentation | [Accounts explained](/wiki/Help%3AAccounts_explained "Help:Accounts explained") • [API calls list](/wiki/Original_Bitcoin_client/API_calls_list "Original Bitcoin client/API calls list") • [API reference (JSON-RPC)](/wiki/API_reference_%28JSON-RPC%29 "API reference (JSON-RPC)") • [Block chain download](/wiki/Block_chain_download "Block chain download") • [Dump format](/wiki/Dump_format "Dump format") • [getblocktemplate](/wiki/Getblocktemplate "Getblocktemplate") • [List of address prefixes](/wiki/List_of_address_prefixes "List of address prefixes") • [Protocol documentation](/wiki/Protocol_documentation "Protocol documentation") • [Script](/wiki/Script "Script") • [Technical background of version 1 Bitcoin addresses](/wiki/Technical_background_of_version_1_Bitcoin_addresses "Technical background of version 1 Bitcoin addresses") • [Testnet](/wiki/Testnet "Testnet") • [Transaction Malleability](/wiki/Transaction_Malleability "Transaction Malleability") • [Wallet import format](/wiki/Wallet_import_format "Wallet import format") | |  | | History & theory | Common Vulnerabilities and Exposures • [DOS/STONED incident](/wiki/DOS/STONED_incident "DOS/STONED incident") • [Economic majority](/wiki/Economic_majority "Economic majority") • [Full node](/wiki/Full_node "Full node") • [Original Bitcoin client](/wiki/Original_Bitcoin_client "Original Bitcoin client") • [Value overflow incident](/wiki/Value_overflow_incident "Value overflow incident") | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

Retrieved from "<https://en.bitcoin.it/w/index.php?title=Common_Vulnerabilities_and_Exposures&oldid=70310>"
[Categories](/wiki/Special%3ACategories "Special:Categories"):

* [Security](/wiki/Category%3ASecurity "Category:Security")
* [Bitcoin Core documentation](/wiki/Category%3ABitcoin_Core_documentation "Category:Bitcoin Core documentation")

## Navigation menu

### Personal tools

* [Create account](/w/index.php?title=Special:CreateAccount&returnto=Common+Vulnerabilities+and+Exposures "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=Common+Vulnerabilities+and+Exposures "You are encouraged to log in; however, it is not mandatory [o]")

### Namespaces

* [Page](/wiki/Common_Vulnerabilities_and_Exposures "View the content page [c]")
* [Discussion](/wiki/Talk%3ACommon_Vulnerabilities_and_Exposures "Discussion about the content page [t]")

English

### Views

* [Read](/wiki/Common_Vulnerabilities_and_Exposures)
* [View source](/w/index.php?title=Common_Vulnerabilities_and_Exposures&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/w/index.php?title=Common_Vulnerabilities_and_Exposures&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/wiki/Main_Page "Visit the main page [z]")
* [Bitcoin FAQ](/wiki/Help%3AFAQ)
* [Editing help](/wiki/Bitcoin_Wiki%3AHelp)
* [Forums](/wiki/Forums)
* [Chatrooms](/wiki/IRC_channels)
* [Recent changes](/wiki/Special%3ARecentChanges)
* [Page index](/wiki/Special%3AAllPages)

### Tools

* [What links here](/wiki/Special%3AWhatLinksHere/Common_Vulnerabilities_and_Exposures "A list of all wiki pages that link here [j]")
* [Related changes](/wiki/Special%3ARecentChangesLinked/Common_Vulnerabilities_and_Exposures "Recent changes in pages linked from this page [k]")
* [Special pages](/wiki/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/w/index.php?title=Common_Vulnerabilities_and_Exposures&oldid=70310 "Permanent link to this revision of this page")
* [Page information](/w/index.php?title=Common_Vulnerabilities_and_Exposures&action=info "More information about this page")

### Sister projects

* [Essays](/wiki/Bitcoin_Wiki%3AEssay_main_page)
* [Source](/wiki/Bitcoin_Wiki%3ASource_main_page)

* This page was last edited on 31 July 2024, at 17:40.
* Content is available under [Creative Commons Attribution 3.0](http://creativecommons.org/licenses/by/3.0/) unless otherwise noted.

* [Privacy policy](/wiki/Bitcoin_Wiki%3APrivacy_policy)
* [About Bitcoin Wiki](/wiki/Bitcoin_Wiki%3AAbout)
* [Disclaimers](/wiki/Bitcoin_Wiki%3AGeneral_disclaimer)

* [![Powered by MediaWiki](/w/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from lists.linuxfoundation.org_1e438cc5_20250108_135909.html ===

```
[public inbox for bitcoindev@googlegroups.com](../?t=20210506135609)
 [help](../_/text/help/) / [color](../_/text/color/) / [mirror](../_/text/mirror/) / [Atom feed](../new.atom)
```
```
From: Antoine Riard <antoine.riard@gmail•com>
To: Bitcoin Protocol Discussion <bitcoin-dev@lists•linuxfoundation.org>
Subject: [[bitcoin-dev] Full Disclosure: CVE-2021-31876 Defect in Bitcoin Core's bip125 logic](#r)
Date: Thu, 6 May 2021 09:55:53 -0400	[[thread overview]](#r)
Message-ID: <CALZpt+GK4WNBmKim3w9LAd1b69+uAyAsNu5tVniHzN6Ue4KJCw@mail.gmail.com> (<raw>)

[[-- Attachment #1: Type: text/plain, Size: 7675 bytes --]](1-a.txt)

Hi,

I'm writing to report a defect in Bitcoin Core bip125 logic with minor
security and operational implications for downstream projects. Though this
defect grieves Bitcoin Core nodes 0.12.0 and above, base layer safety isn't
impacted.

# Problem

Bip 125 specification describes the following signalling mechanism :

"
This policy specifies two ways a transaction can signal that it is
replaceable.

* Explicit signaling: A transaction is considered to have opted in to
allowing replacement of itself if any of its inputs have an nSequence
number less than (0xffffffff - 1).

* Inherited signaling: Transactions that don't explicitly signal
replaceability are replaceable under this policy for as long as any one of
their ancestors signals replaceability and remains unconfirmed.

One or more transactions currently in the mempool (original transactions)
will be replaced by a new transaction (replacement transaction) that spends
one or more of the same inputs if,

# The original transactions signal replaceability explicitly or through
inheritance as described in the above Summary section.
"

An unconfirmed child transaction with nSequence = 0xff_ff_ff_ff spending an
unconfirmed parent with nSequence <= 0xff_ff_ff_fd should be replaceable as
the child transaction signals "through inheritance". However, the
replacement code as implemented in Core's `PreChecks()` shows that this
behavior isn't  enforced and Core's mempool rejects replacement attempts of
an unconfirmed child transaction.

Branch asserting the behavior is here :
<https://github.com/ariard/bitcoin/commits/2021-03-test-rbf>

# Solution

The defect has not been patched.

# Downstream Projects Affected

* LN : State-of-the-art pinning attacks against second-stage HTLCs
transactions were thought to be only possible by exploiting RBF rule 3 on
the necessity of a higher absolute fee [0]. However, this replacement
defect opens the way for an attacker to only pin with an opt-out child
without a higher fee than the honest competing transaction. This lowers the
cost of attack as the malicious pinning transaction only has to be above
mempools'min feerate. This also increases odds of attack success for a
reduced feerate diminishes odds of confirmation ending the pinning.

A functional test demo illustrating cases is available on this branch:
<https://github.com/ariard/bitcoin/commits/2021-05-htlc-preimage-pinnings>

LN nodes operators concerned by this defect might favor anchor outputs
channels, fully mitigating this specific pinning vector.

* Onchain DLC/Coinswap/Vault : Those contract protocols have also multiple
stages of execution with time-sensitive transactions opening the way to
pinning attacks. Those protocols being non-deployed or in early phase, I
would recommend that any in-protocol competing transactions explicitly
signal RBF.

* Coinjoin/Cut-Through : if CPFP is employed as a fee-bumping strategy, if
the coinjoin transaction is still laying in network mempools, if a
fee-bumping output is spendable by any protocol participant, this
fee-bumping mechanism might be halted by a malicious protocol participant
broadcasting an low-feerate opt-out child. According to bip125, if the
coinjoin parent tx signals replaceability, the child transaction should be
replaceable, whatever its signaling. However Core doesn't apply this
policy. RBF of the coinjoin transaction itself should be used as a
fallback. I'm not aware of any deployed coinjoin using such
"anyone-can-bump" fee-bumping strategy.

* Simple wallets : RBF engines' behaviors might be altered in ways not
matching the intent of their developers. I invite RBF engines dev to verify
what those components are doing in the light of disclosed information.

# Discovery

While reviewing the LN dual-funding flow, I inquired on potential new DoS
vectors introduced by relying on counterparty utxos in this following
analysis [1]. The second DoS issue "RBF opt-out by a Counterparty
Double-Spend" is relying on a malicious chain of transactions where the
parent is signaling RBF opt-in through nSequence<=0xff_ff_ff_ff-1 but the
child, servicing as a pinning transaction, opt-out from the RBF policy.
This pinning trick conception was matching my understanding of Core code
but while reading again the specification, I observed that it was
inconsistent from the inherited signaling mechanism as described in the
bip's "Summary" section.

After exercising the logic, I did submit the defect to Dave Harding, asking
confirmation of divergence between Bitcoin Core and BIP 125. Soon after, he
did confirm it and pointed that the defect has been there since the 2015's
PR introducing the opt-in RBF, advicing to to consider security
implications for deployed second-layer protocols. After noticing the minor
implications for pinning attacks on second-stage LN transactions while
talking with Matt Corallo, I did disclose to the Bitcoin Core security list.

My initial report was recommending avoiding a covert patch in the mempool
as risks of introducing DoS in this part of the codebase seemed to outweigh
security of deployed LN channels. This direction was agreed by the opinions
expressed on the security list. Beyond, there was a lack of agreement on
how to proceed with the disclosure as so far in the history project,
transaction relay policy have not been considered as strongly reliable.
Though from now on, L2 protocols like Lightning are making assumptions on
subset of this policy for their safety, such as the highlighted RBF one.

Defect was disclosed to the LN projects maintainers, informing them that
currently in deployment anchor outputs protocol upgrade was mitigating
against this defect though old channels will stay vulnerable. To the best
of my knowledge, I didn't identify other deployed protocols of which coins
safety are impacted by this defect.

# Ecosystem Observations

This long-standing defect with benign security implications provided an
opportunity to exercise coordinated security disclosure across layers and
development teams.

IMO, it underlies few interesting points:
* the lack of an established policy for coordinated security disclosures
between a base layer implementation and its downstream projects
* the lack of a clear methodology to identify downstream projects affected
by a transaction relay policy wreckage
* the lack of minimally-disruptive, emergency upgrade mechanisms
implemented by downstream projects [2]

Finally, security implications for downstream projects provoked by base
layer issues shouldn't be minimized as they do have a risk of windblow on
base layer operations. I believe we should minimize risks of disaster
scenarios such as thousands of LN channels manually closed by worried
operators due to a non-concerted security disclosure, provoking mempool
cloaks and disrupting regular transactions for a while.

# Timeline

2021-03-18 : Defect discovered, report to Dave Harding original author of
bip125, confirmation of the defect
2021-03-19 : Disclosure to the Bitcoin Core security list, Dave Harding,
Matt Corallo, acknowledgment of the issue
2021-04-05 : Disclosure to the LN projects maintainers (c-lightning, lnd,
eclair, electrum, rust-lightning)
2021-04-28 : CVE-2021-31876 assigned
2021-05-06 : Full disclosure to the bitcoin-dev mailing list

I believe the information reported is correct and reflects the best of my
knowledge, please point any shortcoming.

Cheers,
Antoine

[0]
<https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-April/002639.html>
[1] See "On Mempool Funny Games against Multi-Party Funded Transactions",
published 2021-05-06
[2] Such as
<https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-July/002763.html>

[[-- Attachment #2: Type: text/html, Size: 8442 bytes --]](2-a.bin)

```

---

```
[next](../MT4soB8ro1-wKY5ht6hqY0c2OutPMDgdLrSny8I9-KPn75p6CdatFkwDZCPNI98yYXOqMeKLu9Z1EBwMXXWZQmCE6Nv70gPo6Mv8FjsGnxc%3D%40protonmail.com/)             [reply](#R)	other threads:[[~2021-05-06 13:56 UTC](../?t=20210506135609)|[newest](../)]

Thread overview: 7+ messages / expand[[flat](T/#u)|[nested](t/#u)]  [mbox.gz](t.mbox.gz)  [Atom feed](t.atom)  [top](#b)
2021-05-06 13:55 [Antoine Riard [this message]](#t)
2021-05-09  7:56 ` [darosior](../MT4soB8ro1-wKY5ht6hqY0c2OutPMDgdLrSny8I9-KPn75p6CdatFkwDZCPNI98yYXOqMeKLu9Z1EBwMXXWZQmCE6Nv70gPo6Mv8FjsGnxc%3D%40protonmail.com/)
2021-05-11 21:16   ` [Ruben Somsen](../CAPv7Tjb5%2BB5MMrf5QZySbqgoQL2%2BrTpcHDh5E8pBdcRgc5ZNUw%40mail.gmail.com/)
2021-05-12 13:11     ` [Antoine Riard](../CALZpt%2BGxNF_PPN2-fSWXT3RNHTdOb1emwuXvK%2Biw23%2BXsCBaxA%40mail.gmail.com/)
2021-05-11 21:50 ` [Luke Dashjr](../202105112150.51410.luke%40dashjr.org/)
2021-05-12 13:19   ` [Antoine Riard](../CALZpt%2BFNGtXQuVF9JmtK-OQTxEu89ks42Y7j1NWqHSxc79uiWg%40mail.gmail.com/)
2021-05-13  1:06 ` [Olaoluwa Osuntokun](../CAO3Pvs_0iaQDOUuddQHESVYz6V23hWPOu54FT%3DA9%3DcCOEjFBAg%40mail.gmail.com/)

```

---

```
Reply instructions:

You may reply publicly to [this message](#t) via plain-text email
using any one of the following methods:

* Save the following mbox file, import it into your mail client,
  and reply-to-all from there: [mbox](raw)

  Avoid top-posting and favor interleaved quoting:
  <https://en.wikipedia.org/wiki/Posting_style#Interleaved_style>

* Reply using the --to, --cc, and --in-reply-to
  switches of git-send-email(1):

  git send-email \
    --in-reply-to=CALZpt+GK4WNBmKim3w9LAd1b69+uAyAsNu5tVniHzN6Ue4KJCw@mail.gmail.com \
    --to=antoine.riard@gmail$(echo .)com \
    --cc=bitcoin-dev@lists$(echo .)linuxfoundation.org \
    /path/to/YOUR_REPLY

  <https://kernel.org/pub/software/scm/git/docs/git-send-email.html>

```
Be sure your reply has a **Subject:** header at the top and a blank line
before the message body.

---

```
This is a public inbox, see [mirroring instructions](../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox
```


=== Content from github.com_f3122bdd_20250108_135907.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=bitcoin%2Fbitcoin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bitcoin](/bitcoin)
/
**[bitcoin](/bitcoin/bitcoin)**
Public

* [Notifications](/login?return_to=%2Fbitcoin%2Fbitcoin) You must be signed in to change notification settings
* [Fork
  36.5k](/login?return_to=%2Fbitcoin%2Fbitcoin)
* [Star
   81.2k](/login?return_to=%2Fbitcoin%2Fbitcoin)

Bitcoin Core integration/staging tree

[bitcoincore.org/en/download](https://bitcoincore.org/en/download "https://bitcoincore.org/en/download")

### License

[MIT license](/bitcoin/bitcoin/blob/master/COPYING)

[81.2k
stars](/bitcoin/bitcoin/stargazers) [36.5k
forks](/bitcoin/bitcoin/forks) [Branches](/bitcoin/bitcoin/branches) [Tags](/bitcoin/bitcoin/tags) [Activity](/bitcoin/bitcoin/activity)
 [Star](/login?return_to=%2Fbitcoin%2Fbitcoin)

 [Notifications](/login?return_to=%2Fbitcoin%2Fbitcoin) You must be signed in to change notification settings

* [Code](/bitcoin/bitcoin)
* [Issues
  374](/bitcoin/bitcoin/issues)
* [Pull requests
  313](/bitcoin/bitcoin/pulls)
* [Actions](/bitcoin/bitcoin/actions)
* [Projects
  5](/bitcoin/bitcoin/projects)
* [Security](/bitcoin/bitcoin/security)
* [Insights](/bitcoin/bitcoin/pulse)

Additional navigation options

* [Code](/bitcoin/bitcoin)
* [Issues](/bitcoin/bitcoin/issues)
* [Pull requests](/bitcoin/bitcoin/pulls)
* [Actions](/bitcoin/bitcoin/actions)
* [Projects](/bitcoin/bitcoin/projects)
* [Security](/bitcoin/bitcoin/security)
* [Insights](/bitcoin/bitcoin/pulse)

# bitcoin/bitcoin

    master[Branches](/bitcoin/bitcoin/branches)[Tags](/bitcoin/bitcoin/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[43,511 Commits](/bitcoin/bitcoin/commits/master/) | | |
| [.github](/bitcoin/bitcoin/tree/master/.github ".github") | | [.github](/bitcoin/bitcoin/tree/master/.github ".github") |  |  |
| [.tx](/bitcoin/bitcoin/tree/master/.tx ".tx") | | [.tx](/bitcoin/bitcoin/tree/master/.tx ".tx") |  |  |
| [ci](/bitcoin/bitcoin/tree/master/ci "ci") | | [ci](/bitcoin/bitcoin/tree/master/ci "ci") |  |  |
| [cmake](/bitcoin/bitcoin/tree/master/cmake "cmake") | | [cmake](/bitcoin/bitcoin/tree/master/cmake "cmake") |  |  |
| [contrib](/bitcoin/bitcoin/tree/master/contrib "contrib") | | [contrib](/bitcoin/bitcoin/tree/master/contrib "contrib") |  |  |
| [depends](/bitcoin/bitcoin/tree/master/depends "depends") | | [depends](/bitcoin/bitcoin/tree/master/depends "depends") |  |  |
| [doc](/bitcoin/bitcoin/tree/master/doc "doc") | | [doc](/bitcoin/bitcoin/tree/master/doc "doc") |  |  |
| [share](/bitcoin/bitcoin/tree/master/share "share") | | [share](/bitcoin/bitcoin/tree/master/share "share") |  |  |
| [src](/bitcoin/bitcoin/tree/master/src "src") | | [src](/bitcoin/bitcoin/tree/master/src "src") |  |  |
| [test](/bitcoin/bitcoin/tree/master/test "test") | | [test](/bitcoin/bitcoin/tree/master/test "test") |  |  |
| [.cirrus.yml](/bitcoin/bitcoin/blob/master/.cirrus.yml ".cirrus.yml") | | [.cirrus.yml](/bitcoin/bitcoin/blob/master/.cirrus.yml ".cirrus.yml") |  |  |
| [.editorconfig](/bitcoin/bitcoin/blob/master/.editorconfig ".editorconfig") | | [.editorconfig](/bitcoin/bitcoin/blob/master/.editorconfig ".editorconfig") |  |  |
| [.gitattributes](/bitcoin/bitcoin/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/bitcoin/bitcoin/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/bitcoin/bitcoin/blob/master/.gitignore ".gitignore") | | [.gitignore](/bitcoin/bitcoin/blob/master/.gitignore ".gitignore") |  |  |
| [.python-version](/bitcoin/bitcoin/blob/master/.python-version ".python-version") | | [.python-version](/bitcoin/bitcoin/blob/master/.python-version ".python-version") |  |  |
| [.style.yapf](/bitcoin/bitcoin/blob/master/.style.yapf ".style.yapf") | | [.style.yapf](/bitcoin/bitcoin/blob/master/.style.yapf ".style.yapf") |  |  |
| [CMakeLists.txt](/bitcoin/bitcoin/blob/master/CMakeLists.txt "CMakeLists.txt") | | [CMakeLists.txt](/bitcoin/bitcoin/blob/master/CMakeLists.txt "CMakeLists.txt") |  |  |
| [CMakePresets.json](/bitcoin/bitcoin/blob/master/CMakePresets.json "CMakePresets.json") | | [CMakePresets.json](/bitcoin/bitcoin/blob/master/CMakePresets.json "CMakePresets.json") |  |  |
| [CONTRIBUTING.md](/bitcoin/bitcoin/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") | | [CONTRIBUTING.md](/bitcoin/bitcoin/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") |  |  |
| [COPYING](/bitcoin/bitcoin/blob/master/COPYING "COPYING") | | [COPYING](/bitcoin/bitcoin/blob/master/COPYING "COPYING") |  |  |
| [INSTALL.md](/bitcoin/bitcoin/blob/master/INSTALL.md "INSTALL.md") | | [INSTALL.md](/bitcoin/bitcoin/blob/master/INSTALL.md "INSTALL.md") |  |  |
| [README.md](/bitcoin/bitcoin/blob/master/README.md "README.md") | | [README.md](/bitcoin/bitcoin/blob/master/README.md "README.md") |  |  |
| [SECURITY.md](/bitcoin/bitcoin/blob/master/SECURITY.md "SECURITY.md") | | [SECURITY.md](/bitcoin/bitcoin/blob/master/SECURITY.md "SECURITY.md") |  |  |
| [libbitcoinkernel.pc.in](/bitcoin/bitcoin/blob/master/libbitcoinkernel.pc.in "libbitcoinkernel.pc.in") | | [libbitcoinkernel.pc.in](/bitcoin/bitcoin/blob/master/libbitcoinkernel.pc.in "libbitcoinkernel.pc.in") |  |  |
| [vcpkg.json](/bitcoin/bitcoin/blob/master/vcpkg.json "vcpkg.json") | | [vcpkg.json](/bitcoin/bitcoin/blob/master/vcpkg.json "vcpkg.json") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
* Security
# Bitcoin Core integration/staging tree

<https://bitcoincore.org>

For an immediately usable, binary version of the Bitcoin Core software, see
<https://bitcoincore.org/en/download/>.

## What is Bitcoin Core?

Bitcoin Core connects to the Bitcoin peer-to-peer network to download and fully
validate blocks and transactions. It also includes a wallet and graphical user
interface, which can be optionally built.

Further information about Bitcoin Core is available in the [doc folder](/bitcoin/bitcoin/blob/master/doc).

## License

Bitcoin Core is released under the terms of the MIT license. See [COPYING](/bitcoin/bitcoin/blob/master/COPYING) for more
information or see <https://opensource.org/licenses/MIT>.

## Development Process

The `master` branch is regularly built (see `doc/build-*.md` for instructions) and tested, but it is not guaranteed to be
completely stable. [Tags](https://github.com/bitcoin/bitcoin/tags) are created
regularly from release branches to indicate new official, stable release versions of Bitcoin Core.

The <https://github.com/bitcoin-core/gui> repository is used exclusively for the
development of the GUI. Its master branch is identical in all monotree
repositories. Release branches and tags do not exist, so please do not fork
that repository unless it is for development reasons.

The contribution workflow is described in [CONTRIBUTING.md](/bitcoin/bitcoin/blob/master/CONTRIBUTING.md)
and useful hints for developers can be found in [doc/developer-notes.md](/bitcoin/bitcoin/blob/master/doc/developer-notes.md).

## Testing

Testing and code review is the bottleneck for development; we get more pull
requests than we can review and test on short notice. Please be patient and help out by testing
other people's pull requests, and remember this is a security-critical project where any mistake might cost people
lots of money.

### Automated Testing

Developers are strongly encouraged to write [unit tests](/bitcoin/bitcoin/blob/master/src/test/README.md) for new code, and to
submit new unit tests for old code. Unit tests can be compiled and run
(assuming they weren't disabled during the generation of the build system) with: `ctest`. Further details on running
and extending unit tests can be found in [/src/test/README.md](/bitcoin/bitcoin/blob/master/src/test/README.md).

There are also [regression and integration tests](/bitcoin/bitcoin/blob/master/test), written
in Python.
These tests can be run (if the [test dependencies](/bitcoin/bitcoin/blob/master/test) are installed) with: `build/test/functional/test_runner.py`
(assuming `build` is your build directory).

The CI (Continuous Integration) systems make sure that every pull request is built for Windows, Linux, and macOS,
and that unit/sanity tests are run automatically.

### Manual Quality Assurance (QA) Testing

Changes should be tested by somebody other than the developer who wrote the
code. This is especially important for large or high-risk changes. It is useful
to add a test plan to the pull request description if testing the changes is
not straightforward.

## Translations

Changes to translations as well as new translations can be submitted to
[Bitcoin Core's Transifex page](https://www.transifex.com/bitcoin/bitcoin/).

Translations are periodically pulled from Transifex and merged into the git repository. See the
[translation process](/bitcoin/bitcoin/blob/master/doc/translation_process.md) for details on how this works.

**Important**: We do not accept translation changes as GitHub pull requests because the next
pull from Transifex would automatically overwrite them again.

## About

Bitcoin Core integration/staging tree

[bitcoincore.org/en/download](https://bitcoincore.org/en/download "https://bitcoincore.org/en/download")

### Topics

[c-plus-plus](/topics/c-plus-plus "Topic: c-plus-plus")
[cryptography](/topics/cryptography "Topic: cryptography")
[bitcoin](/topics/bitcoin "Topic: bitcoin")
[p2p](/topics/p2p "Topic: p2p")
[cryptocurrency](/topics/cryptocurrency "Topic: cryptocurrency")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/bitcoin/bitcoin/activity)
[Custom properties](/bitcoin/bitcoin/custom-properties)
### Stars

[**81.2k**
stars](/bitcoin/bitcoin/stargazers)
### Watchers

[**4k**
watching](/bitcoin/bitcoin/watchers)
### Forks

[**36.5k**
forks](/bitcoin/bitcoin/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin&report=bitcoin+%28user%29)

## [Releases 53](/bitcoin/bitcoin/releases)

[Bitcoin Core 28.0
Latest

Oct 5, 2024](/bitcoin/bitcoin/releases/tag/v28.0)
[+ 52 releases](/bitcoin/bitcoin/releases)

## [Contributors 970](/bitcoin/bitcoin/graphs/contributors)

* [![@laanwj](https://avatars.githubusercontent.com/u/126646?s=64&v=4)](https://github.com/laanwj)
* [![@fanquake](https://avatars.githubusercontent.com/u/863730?s=64&v=4)](https://github.com/fanquake)
* [![@sipa](https://avatars.githubusercontent.com/u/548488?s=64&v=4)](https://github.com/sipa)
* [![@hebasto](https://avatars.githubusercontent.com/u/32963518?s=64&v=4)](https://github.com/hebasto)
* [![@achow101](https://avatars.githubusercontent.com/u/3782274?s=64&v=4)](https://github.com/achow101)
* [![@gavinandresen](https://avatars.githubusercontent.com/u/331997?s=64&v=4)](https://github.com/gavinandresen)
* [![@jnewbery](https://avatars.githubusercontent.com/u/1063656?s=64&v=4)](https://github.com/jnewbery)
* [![@ryanofsky](https://avatars.githubusercontent.com/u/7133040?s=64&v=4)](https://github.com/ryanofsky)
* [![@jonasschnelli](https://avatars.githubusercontent.com/u/178464?s=64&v=4)](https://github.com/jonasschnelli)
* [![@jonatack](https://avatars.githubusercontent.com/u/2415484?s=64&v=4)](https://github.com/jonatack)
* [![@practicalswift](https://avatars.githubusercontent.com/u/7826565?s=64&v=4)](https://github.com/practicalswift)
* [![@theuni](https://avatars.githubusercontent.com/u/417043?s=64&v=4)](https://github.com/theuni)
* [![@theStack](https://avatars.githubusercontent.com/u/91535?s=64&v=4)](https://github.com/theStack)
* [![@glozow](https://avatars.githubusercontent.com/u/25183001?s=64&v=4)](https://github.com/glozow)

[+ 956 contributors](/bitcoin/bitcoin/graphs/contributors)

## Languages

* [C++
  64.8%](/bitcoin/bitcoin/search?l=c%2B%2B)
* [Python
  20.1%](/bitcoin/bitcoin/search?l=python)
* [C
  11.5%](/bitcoin/bitcoin/search?l=c)
* [CMake
  1.2%](/bitcoin/bitcoin/search?l=cmake)
* [Shell
  0.9%](/bitcoin/bitcoin/search?l=shell)
* [Makefile
  0.5%](/bitcoin/bitcoin/search?l=makefile)
* Other
  1.0%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bitcoinops.org_f811fa3b_20250108_135906.html ===

[![OpTech Logo](/img/logos/optech-horiz.png)](/)

[About](/en/about/)
[Publications](/en/publications/)
[Topics](/en/topics/)
[Workshops](/en/workshops/)
[Compatibility](/en/compatibility/)
[Dashboard](https://dashboard.bitcoinops.org/)

[en](/en/newsletters/2021/05/12/)
| [ja](/ja/newsletters/2021/05/12/)
| [es](/translations/ "No Spanish translation currently available")
| [cs](/translations/ "No Czech translation currently available")
| [hi](/translations/ "No Hindi translation currently available")
| [zh](/zh/newsletters/2021/05/12/)
| [de](/translations/ "No German translation currently available")
| [fr](/translations/ "No French translation currently available")

/ [home](/) / [newsletters](/en/newsletters/) /

# Bitcoin Optech Newsletter #148

May 12, 2021

This week’s newsletter describes a security disclosure affecting
protocols depending on a certain BIP125 opt-in replace by fee behavior
and includes our regular sections with the summary of a Bitcoin Core PR
Review Club meeting, announcements of new software releases and release
candidates, and descriptions of notable changes to popular Bitcoin
infrastructure software.

## News

* [●](#cve-2021-31876-discrepancy-between-bip125-and-bitcoin-core-implementation) **CVE-2021-31876 discrepancy between BIP125 and Bitcoin Core implementation:**
  the [BIP125](https://github.com/bitcoin/bips/blob/master/bip-0125.mediawiki) specification of opt-in Replace By Fee ([RBF](/en/topics/replace-by-fee/)) says that an unconfirmed parent transaction that signals
  replaceability makes any child transactions that spend the parent’s
  outputs also replaceable through inferred inheritance. This week,
  Antoine Riard [posted](https://gnusha.org/url/https%3A//lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-May/018893.html) to the Bitcoin-Dev
  mailing list the full disclosure of his previously privately reported
  finding that Bitcoin Core does not implement this behavior. It is
  still possible for child transactions to be replaced if they
  explicitly signal replaceability or for them to be evicted from the
  mempool if their parent transaction is replaced.

  Riard analyzed how the inability to use inherited replaceability
  might affect various current and proposed protocols. Only LN
  appears to be affected and only in the sense that an existing attack
  (see [Newsletter #95](/en/newsletters/2020/04/29/#new-attack-against-ln-payment-atomicity)) that uses
  [pinning](/en/topics/transaction-pinning/) becomes cheaper. The ongoing
  deployment of [anchor outputs](/en/topics/anchor-outputs/) by
  various LN implementations will eliminate the ability to perform that
  pinning.

  As of this writing, there has not been any substantial discussion of
  the issue on the mailing list.
* [●](#call-for-brink-grant-applications) **Call for Brink grant applications:**
  Bitcoin Optech encourages any engineer contributing to open source
  Bitcoin or Lightning projects to [apply for a Brink grant](https://brink.homerun.co/grants) before the application deadline on May 17th. Initial grants are
  one year long and allow developers to work full time on open source projects
  from anywhere in the world.

## Bitcoin Core PR Review Club

*In this monthly section, we summarize a recent [Bitcoin Core PR Review Club](https://bitcoincore.reviews/)
meeting, highlighting some of the important questions and answers. Click on a
question below to see a summary of the answer from the meeting.*

[Introduce node rebroadcast module](https://bitcoincore.reviews/21061) is a PR ([#21061](https://github.com/bitcoin/bitcoin/issues/21061)) by Amiti Uttarwar that continues
work on the rebroadcast project (see Newsletters [#64](/en/newsletters/2019/09/18/#bitcoin-core-rebroadcasting-logic),
[#96](/en/newsletters/2020/05/06/#bitcoin-core-18038), [#129](/en/newsletters/2020/12/23/#transaction-origin-privacy) and [#142](/en/newsletters/2021/03/31/#will-nodes-with-a-larger-than-default-mempool-retransmit-transactions-that-have-been-dropped-from-smaller-mempools)),
previously discussed in review clubs [#16698](https://bitcoincore.reviews/16698) and [#18038](https://bitcoincore.reviews/18038), whose goal is to make node
rebroadcast behavior for wallet transactions indistinguishable from that of
other peers’ transactions.

The review club discussion focused on current transaction behavior and the
proposed changes:

* Why might we want to rebroadcast a transaction?

  When our transaction didn’t propagate (perhaps our node was offline) or
  appears to have been dropped by other nodes’ mempools in the network. [➚](https://bitcoincore.reviews/21061#l-39)
* Why does a node drop a transaction from its mempool?

  Apart from being included in a block, a transaction can expire after 14
  days, be squeezed out of a node’s limited mempool size (default size 300
  MiB) by higher-fee transactions, be replaced via [BIP125](https://github.com/bitcoin/bips/blob/master/bip-0125.mediawiki) opt-in
  Replace-By-Fee ([RBF](/en/topics/replace-by-fee/)), be removed if a conflicting transaction
  is included in a block, or be included in a block that is later reorged
  out (in which case the node will try to re-add it while [updating the
  mempool](https://github.com/bitcoin/bitcoin/blob/e175a20769/src/validation.cpp#L357) to be consistent again after the reorg). [➚](https://bitcoincore.reviews/21061#l-53)
* What could be an issue with the current behavior of each wallet being
  responsible for rebroadcasting its own transactions?

  This can be a privacy leak that allows linking the IP address to the
  wallet address, as under the current rebroadcasting behavior, a node that
  broadcasts a transaction more than once is essentially announcing that the
  transaction is from its wallet. [➚](https://bitcoincore.reviews/21061#l-58)
* When might a miner exclude a transaction that is in our mempool?

  When the miner deprioritized it for having a low fee, didn’t see it yet,
  removed it from its mempool by RBF, censored it, or mined an empty block.
* When might a miner include a transaction that is not in our mempool?

  When the miner manually prioritized the transaction (e.g. as a commercial
  service), received it before our node, or the transaction conflicted with
  another one in our mempool but not in theirs.
* How would the proposal under review decide which transactions to
  rebroadcast?

  Once per new block, it proposes to rebroadcast transactions above an
  estimated feerate that are at least 30 minutes old, have been rebroadcast
  no more than 6 times and not more recently than 4 hours ago, with up to
  3/4 of the transactions that fit the block. [➚](https://bitcoincore.reviews/21061#l-63)
* Why might we want to keep a transaction in our rebroadcast attempt tracker even after
  it has been removed from our mempool?

  After a consensus rule change, there can be non-updated nodes on the
  network rebroadcasting transactions that don’t meet the new consensus
  rules. Keeping transactions in the rebroadcast attempt tracker would avoid these
  nodes rebroadcasting them too many times (a maximum of 6 times over 90
  days) and allow the transactions to expire. [➚](https://bitcoincore.reviews/21061#l-178)
* When would we remove a transaction from our rebroadcast attempt tracker?

  When the transaction is confirmed, [RBFed](/en/topics/replace-by-fee/), or conflicts with
  another transaction included in a block. [➚](https://bitcoincore.reviews/21061#l-199)
* How would the estimated minimum feerate for rebroadcast be calculated?
  Why not use the lowest feerate in the last mined block?

  The rebroadcast feerate floor would be estimated once a minute by
  assembling a block from the mempool to simulate inclusion in the next
  mined block. This approach is better than using the lowest feerate of the
  last mined block because it calculates fees based on the immediate future
  in a changing environment instead of based on the past. [➚](https://bitcoincore.reviews/21061#l-227)
## Releases and release candidates

*New releases and release candidates for popular Bitcoin infrastructure
projects. Please consider upgrading to new releases or helping to test
release candidates.*

* [●](#rust-lightning-0-0-14) [Rust-Lightning 0.0.14](https://github.com/rust-bitcoin/rust-lightning/releases/tag/v0.0.14) is a new release that makes Rust Lightning
  more compatible with getting data from Electrum-style servers, adds
  additional configuration options, and improves compliance with the LN
  specification, among other bug fixes and improvements.

## Notable code and documentation changes

*Notable changes this week in [Bitcoin Core](https://github.com/bitcoin/bitcoin),
[C-Lightning](https://github.com/ElementsProject/lightning), [Eclair](https://github.com/ACINQ/eclair), [LND](https://github.com/lightningnetwork/lnd/),
[Rust-Lightning](https://github.com/rust-bitcoin/rust-lightning), [libsecp256k1](https://github.com/bitcoin-core/secp256k1), [Hardware Wallet Interface (HWI)](https://github.com/bitcoin-core/HWI),
[Rust Bitcoin](https://github.com/rust-bitcoin/rust-bitcoin), [BTCPay Server](https://github.com/btcpayserver/btcpayserver/),
[Bitcoin Improvement Proposals (BIPs)](https://github.com/bitcoin/bips/), and [Lightning
BOLTs](https://github.com/lightning/bolts).*

* [●](#bitcoin-core-20867) [Bitcoin Core #20867](https://github.com/bitcoin/bitcoin/issues/20867) increases the number of keys that can be included in
  multisig [descriptors](/en/topics/output-script-descriptors/) and used in the
  `addmultisigaddress` and `createmultisig` RPCs from 16 to 20. The increased
  limit can only be used in P2WSH outputs. P2SH outputs are limited to 520
  byte scripts which are only large enough to hold 15 compressed public keys.
* [●](#bitcoin-core-gui-125) [Bitcoin Core GUI #125](https://github.com/bitcoin-core/gui/issues/125) enables users to adjust the autoprune block space
  size from the default in the intro dialog. It also adds an improved
  description for how the pruned storage works, clarifying that the entire
  blockchain must be downloaded and processed but will be discarded in
  the future to keep disk usage low.
* [●](#c-lightning-4489) [C-Lightning #4489](https://github.com/ElementsProject/lightning/issues/4489) adds a `funder` plugin for configuring
  [dual-funding](/en/topics/dual-funding/) contribution behavior in response to
  incoming channel open requests. Users will be able to specify a general
  contribution policy (percent match, percent available funds, or fixed
  contribution), a wallet reserve amount under which no dual-funding
  contributions will happen, a maximum contribution amount for any single
  channel open request, and more.

  This PR represents the last step in enabling experimental dual-funding support between
  C-Lightning nodes. The interactive transaction construction and channel
  establishment v2 protocols arising out of this work is still being
  standardized in the open [BOLTs #851](https://github.com/lightning/bolts/issues/851) PR.
* [●](#c-lightning-4496) [C-Lightning #4496](https://github.com/ElementsProject/lightning/issues/4496) adds the ability for plugins to register topics
  about which they plan to publish notifications. Other plugins can
  subscribe to those topics to receive notifications.
  C-Lightning already had several built-in topics, but this merged PR
  allows plugin authors to create and consume notifications for any
  new topic category they’d like to use.
* [●](#rust-bitcoin-589) [Rust Bitcoin #589](https://github.com/rust-bitcoin/rust-bitcoin/issues/589) starts the process of implementing support for [taproot](/en/topics/taproot/) with [schnorr signatures](/en/topics/schnorr-signatures/). The
  existing ECDSA support is moved to a new module but continues to be
  exported under existing names to preserve API compatibility. A new
  `util::schnorr` module adds support for [BIP340](https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki) schnorr key
  encodings. Issue [#588](https://github.com/rust-bitcoin/rust-bitcoin/issues/588) is being used to track the
  complete implementation of taproot compatibility.

Subscribe to our newsletter

## Bitcoin Optech

* Bitcoin Optech
* info@bitcoinops.org

* [bitcoinops](https://github.com/bitcoinops)
* [bitcoinoptech](https://x0f.org/%40bitcoinoptech)
* [bitcoinoptech](https://www.twitter.com/bitcoinoptech)

Helping Bitcoin-based businesses integrate scaling technology.


