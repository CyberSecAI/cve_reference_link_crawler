
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFRRouting%2Ffrr%2Fissues%2F10503)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFRRouting%2Ffrr%2Fissues%2F10503)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=FRRouting%2Ffrr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[FRRouting](/FRRouting)
/
**[frr](/FRRouting/frr)**
Public

* [Notifications](/login?return_to=%2FFRRouting%2Ffrr) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2FFRRouting%2Ffrr)
* [Star
   3.5k](/login?return_to=%2FFRRouting%2Ffrr)

* [Code](/FRRouting/frr)
* [Issues
  352](/FRRouting/frr/issues)
* [Pull requests
  215](/FRRouting/frr/pulls)
* [Discussions](/FRRouting/frr/discussions)
* [Actions](/FRRouting/frr/actions)
* [Projects
  1](/FRRouting/frr/projects)
* [Wiki](/FRRouting/frr/wiki)
* [Security](/FRRouting/frr/security)
* [Insights](/FRRouting/frr/pulse)

Additional navigation options

* [Code](/FRRouting/frr)
* [Issues](/FRRouting/frr/issues)
* [Pull requests](/FRRouting/frr/pulls)
* [Discussions](/FRRouting/frr/discussions)
* [Actions](/FRRouting/frr/actions)
* [Projects](/FRRouting/frr/projects)
* [Wiki](/FRRouting/frr/wiki)
* [Security](/FRRouting/frr/security)
* [Insights](/FRRouting/frr/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FFRRouting%2Ffrr%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FFRRouting%2Ffrr%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# babeld: bugs in parse\_hello\_subtlv, parse\_ihu\_subtlv, and parse\_update\_subtlv #10503

Closed

[qingkaishi](/qingkaishi) opened this issue
Feb 4, 2022
· 6 comments
 · Fixed by [#10504](https://github.com/FRRouting/frr/pull/10504)

Closed

# [babeld: bugs in parse\_hello\_subtlv, parse\_ihu\_subtlv, and parse\_update\_subtlv](#top) #10503

[qingkaishi](/qingkaishi) opened this issue
Feb 4, 2022
· 6 comments
 · Fixed by [#10504](https://github.com/FRRouting/frr/pull/10504)

Labels
[triage](/FRRouting/frr/labels/triage)
Needs further investigation

## Comments

[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=80&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

Copy link

Contributor

### **[qingkaishi](/qingkaishi)** commented [Feb 4, 2022](#issue-1124623649)

| [frr/babeld/message.c](https://github.com/FRRouting/frr/blob/e743c1b8e7989d7e3dc9092603bfb638958fa166/babeld/message.c#L131-L151)  Lines 131 to 151 in [e743c1b](/FRRouting/frr/commit/e743c1b8e7989d7e3dc9092603bfb638958fa166)   |  | parse\_update\_subtlv(const unsigned char \*a, int alen, | | --- | --- | |  | unsigned char \*channels) | |  | { | |  | int type, len, i = 0; | |  |  | |  | while(i < alen) { | |  | type = a[i]; | |  | if(type == SUBTLV\_PAD1) { | |  | i++; | |  | continue; | |  | } | |  |  | |  | if(i + 1 > alen) { | |  | flog\_err(EC\_BABEL\_PACKET, "Received truncated attributes."); | |  | return; | |  | } | |  | len = a[i + 1]; | |  | if(i + len > alen) { | |  | flog\_err(EC\_BABEL\_PACKET, "Received truncated attributes."); | |  | return; | |  | } |      Line 143: the condition should be `i + 1 >= alen` instead of `i + 1 > alen`. Otherwise, overflows will happen at 147.  Line 148: the condition should be `i + len + 2 > alen` instead of `i + len > alen`. We need include extra two bytes, a[i] and a[i + 1] in this check. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)
[qingkaishi](/qingkaishi)
added
the
[triage](/FRRouting/frr/labels/triage)
Needs further investigation
label
[Feb 4, 2022](#event-6012073729)

[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=80&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

Copy link

Contributor

Author

### **[qingkaishi](/qingkaishi)** commented [Feb 4, 2022](#issuecomment-1030357451)

| [frr/babeld/message.c](https://github.com/FRRouting/frr/blob/e743c1b8e7989d7e3dc9092603bfb638958fa166/babeld/message.c#L179-L201)  Lines 179 to 201 in [e743c1b](/FRRouting/frr/commit/e743c1b8e7989d7e3dc9092603bfb638958fa166)   |  | parse\_hello\_subtlv(const unsigned char \*a, int alen, | | --- | --- | |  | unsigned int \*hello\_send\_us) | |  | { | |  | int type, len, i = 0, ret = 0; | |  |  | |  | while(i < alen) { | |  | type = a[0]; | |  | if(type == SUBTLV\_PAD1) { | |  | i++; | |  | continue; | |  | } | |  |  | |  | if(i + 1 > alen) { | |  | flog\_err(EC\_BABEL\_PACKET, | |  | "Received truncated sub-TLV on Hello message."); | |  | return -1; | |  | } | |  | len = a[i + 1]; | |  | if(i + len > alen) { | |  | flog\_err(EC\_BABEL\_PACKET, | |  | "Received truncated sub-TLV on Hello message."); | |  | return -1; | |  | } |      Line 185: it should be `a[i]` instead of `a[0]`.  Line 191: the condition should be `i + 1 >= alen` instead of `i + 1 > alen`  Line 197: the condition should be `i + len + 2 > alen` instead of `i + len > alen` |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=80&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

Copy link

Contributor

Author

### **[qingkaishi](/qingkaishi)** commented [Feb 4, 2022](#issuecomment-1030358293) • edited Loading

| [frr/babeld/message.c](https://github.com/FRRouting/frr/blob/e743c1b8e7989d7e3dc9092603bfb638958fa166/babeld/message.c#L224-L247)  Lines 224 to 247 in [e743c1b](/FRRouting/frr/commit/e743c1b8e7989d7e3dc9092603bfb638958fa166)   |  | parse\_ihu\_subtlv(const unsigned char \*a, int alen, | | --- | --- | |  | unsigned int \*hello\_send\_us, | |  | unsigned int \*hello\_rtt\_receive\_time) | |  | { | |  | int type, len, i = 0, ret = 0; | |  |  | |  | while(i < alen) { | |  | type = a[0]; | |  | if(type == SUBTLV\_PAD1) { | |  | i++; | |  | continue; | |  | } | |  |  | |  | if(i + 1 > alen) { | |  | flog\_err(EC\_BABEL\_PACKET, | |  | "Received truncated sub-TLV on IHU message."); | |  | return -1; | |  | } | |  | len = a[i + 1]; | |  | if(i + len > alen) { | |  | flog\_err(EC\_BABEL\_PACKET, | |  | "Received truncated sub-TLV on IHU message."); | |  | return -1; | |  | } |      Line 231: it should be `a[i]` instead of `a[0]`.  Line 237: the condition should be `i + 1 >= alen` instead of `i + 1 > alen`.  Line 243: the condition should be `i + len + 2 > alen` instead of `i + len > alen`. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=80&u=51fd13af16a6eb7beaa64b47f435e1dfe9beb920&v=4)](/idryzhov)

Copy link

Contributor

### **[idryzhov](/idryzhov)** commented [Feb 4, 2022](#issuecomment-1030359993)

| Hi [@qingkaishi](https://github.com/qingkaishi), thanks for letting everyone know about the issues. But as you already know how to fix all of them, it would be much easier for us if you provide a PR with the fixes instead. |
| --- |

All reactions

Sorry, something went wrong.

[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=80&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

Copy link

Contributor

Author

### **[qingkaishi](/qingkaishi)** commented [Feb 4, 2022](#issuecomment-1030360432)

| Hi [@qingkaishi](https://github.com/qingkaishi), thanks for letting everyone know about the issues. But as you already know how to fix all of them, it would be much easier for us if you provide a PR with the fixes instead.  Sure. I will do that soon. |
| --- |

All reactions

Sorry, something went wrong.

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=80&u=51fd13af16a6eb7beaa64b47f435e1dfe9beb920&v=4)](/idryzhov)

Copy link

Contributor

### **[idryzhov](/idryzhov)** commented [Feb 4, 2022](#issuecomment-1030360569)

| Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[qingkaishi](/qingkaishi)
added a commit
to qingkaishi/frr
that referenced
this issue
[Feb 4, 2022](#ref-commit-05a1985)
[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

`[babeld:](/qingkaishi/frr/commit/05a19855c534e9de2b3fac088c14436e873c72b4 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [fix](/qingkaishi/frr/commit/05a19855c534e9de2b3fac088c14436e873c72b4 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [FRRouting#10502](https://github.com/FRRouting/frr/issues/10502) [FRRouting#10503](https://github.com/FRRouting/frr/issues/10503) [by repairing the checks o…](/qingkaishi/frr/commit/05a19855c534e9de2b3fac088c14436e873c72b4 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>")`
…

`[05a1985](/qingkaishi/frr/commit/05a19855c534e9de2b3fac088c14436e873c72b4)`

```
…n length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
```

[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)
[qingkaishi](/qingkaishi)
mentioned this issue
[Feb 4, 2022](#ref-pullrequest-1124646113)

[babeld: fix the checks for truncated packets
#10504](/FRRouting/frr/pull/10504)
 Merged

[qingkaishi](/qingkaishi)
added a commit
to qingkaishi/frr
that referenced
this issue
[Feb 4, 2022](#ref-commit-c379335)
[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

`[babeld:](/qingkaishi/frr/commit/c3793352a8d76d2eee1edc38a9a16c1c8a6573f4 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [fix](/qingkaishi/frr/commit/c3793352a8d76d2eee1edc38a9a16c1c8a6573f4 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [FRRouting#10502](https://github.com/FRRouting/frr/issues/10502) [FRRouting#10503](https://github.com/FRRouting/frr/issues/10503) [by repairing the checks o…](/qingkaishi/frr/commit/c3793352a8d76d2eee1edc38a9a16c1c8a6573f4 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>")`
…

`[c379335](/qingkaishi/frr/commit/c3793352a8d76d2eee1edc38a9a16c1c8a6573f4)`

```
…n length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
```

[![@donaldsharp](https://avatars.githubusercontent.com/u/10601296?s=40&u=958b931080d7b7d0c32fd5ae39c914f7d8c405e9&v=4)](/donaldsharp)
[donaldsharp](/donaldsharp)
closed this as [completed](/FRRouting/frr/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#10504](/FRRouting/frr/pull/10504)
[Feb 8, 2022](#event-6027586034)

[mergify](/apps/mergify) bot
pushed a commit
that referenced
this issue
[Feb 8, 2022](#ref-commit-8d45143)
[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

`[babeld:](/FRRouting/frr/commit/8d451431b0f7977aad7759dff2640d0a8d7ee7e8 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
(cherry picked from commit c3793352a8d76d2eee1edc38a9a16c1c8a6573f4)") [fix](/FRRouting/frr/commit/8d451431b0f7977aad7759dff2640d0a8d7ee7e8 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
(cherry picked from commit c3793352a8d76d2eee1edc38a9a16c1c8a6573f4)") [#10502](https://github.com/FRRouting/frr/issues/10502) [#10503](https://github.com/FRRouting/frr/issues/10503) [by repairing the checks on length](/FRRouting/frr/commit/8d451431b0f7977aad7759dff2640d0a8d7ee7e8 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
(cherry picked from commit c3793352a8d76d2eee1edc38a9a16c1c8a6573f4)")`
…

`[8d45143](/FRRouting/frr/commit/8d451431b0f7977aad7759dff2640d0a8d7ee7e8)`

```
This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
(cherry picked from commit [c379335](https://github.com/FRRouting/frr/commit/c3793352a8d76d2eee1edc38a9a16c1c8a6573f4))
```

[plsaranya](/plsaranya)
pushed a commit
to plsaranya/frr
that referenced
this issue
[Feb 28, 2022](#ref-commit-ac79863)
[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi) [![@plsaranya](https://avatars.githubusercontent.com/u/10954528?s=40&v=4)](/plsaranya)

`[babeld:](/plsaranya/frr/commit/ac7986373a29cc7e53556c0f7f37e7e44d751523 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [fix](/plsaranya/frr/commit/ac7986373a29cc7e53556c0f7f37e7e44d751523 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [FRRouting#10502](https://github.com/FRRouting/frr/issues/10502) [FRRouting#10503](https://github.com/FRRouting/frr/issues/10503) [by repairing the checks o…](/plsaranya/frr/commit/ac7986373a29cc7e53556c0f7f37e7e44d751523 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>")`
…

`[ac79863](/plsaranya/frr/commit/ac7986373a29cc7e53556c0f7f37e7e44d751523)`

```
…n length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
```

[![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=80&u=e4fb7eefa8244a2824931fa7e2c426cd89802ac1&v=4)](/qlyoung)

Copy link

Member

### **[qlyoung](/qlyoung)** commented [Mar 28, 2022](#issuecomment-1080998468)

| This has been assigned [CVE-2022-26129](https://nvd.nist.gov/vuln/detail/CVE-2022-26129) with a severity score of 7.8.  No assessment of exploitability has been made.  Please see my comment [here](https://github.com/FRRouting/frr/issues/10507#issuecomment-1080985102). |
| --- |

All reactions

Sorry, something went wrong.

[patrasar](/patrasar)
pushed a commit
to patrasar/frr
that referenced
this issue
[Apr 28, 2022](#ref-commit-5916eb6)
[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi) [![@patrasar](https://avatars.githubusercontent.com/u/40834655?s=40&v=4)](/patrasar)

`[babeld:](/patrasar/frr/commit/5916eb6bc92a7887d7022d4a107c7ea020281a5b "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [fix](/patrasar/frr/commit/5916eb6bc92a7887d7022d4a107c7ea020281a5b "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [FRRouting#10502](https://github.com/FRRouting/frr/issues/10502) [FRRouting#10503](https://github.com/FRRouting/frr/issues/10503) [by repairing the checks o…](/patrasar/frr/commit/5916eb6bc92a7887d7022d4a107c7ea020281a5b "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>")`
…

`[5916eb6](/patrasar/frr/commit/5916eb6bc92a7887d7022d4a107c7ea020281a5b)`

```
…n length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
```

[gpnaveen](/gpnaveen)
pushed a commit
to gpnaveen/frr
that referenced
this issue
[Jun 7, 2022](#ref-commit-8876609)
[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

`[babeld:](/gpnaveen/frr/commit/88766097535a8b8b84344e631594eadf7ce1961e "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [fix](/gpnaveen/frr/commit/88766097535a8b8b84344e631594eadf7ce1961e "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [FRRouting#10502](https://github.com/FRRouting/frr/issues/10502) [FRRouting#10503](https://github.com/FRRouting/frr/issues/10503) [by repairing the checks o…](/gpnaveen/frr/commit/88766097535a8b8b84344e631594eadf7ce1961e "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>")`
…

`[8876609](/gpnaveen/frr/commit/88766097535a8b8b84344e631594eadf7ce1961e)`

```
…n length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FFRRouting%2Ffrr%2Fissues%2F10503)

Assignees

No one assigned

Labels

[triage](/FRRouting/frr/labels/triage)
Needs further investigation

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [babeld: fix the checks for truncated packets](/FRRouting/frr/pull/10504)
 [qingkaishi/frr](/qingkaishi/frr)

3 participants

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=52&v=4)](/idryzhov) [![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=52&v=4)](/qingkaishi) [![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=52&v=4)](/qlyoung)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

