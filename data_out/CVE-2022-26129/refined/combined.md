=== Content from github.com_8b9a1c7c_20250108_164611.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFRRouting%2Ffrr%2Fissues%2F10507)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFRRouting%2Ffrr%2Fissues%2F10507)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=FRRouting%2Ffrr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[FRRouting](/FRRouting)
/
**[frr](/FRRouting/frr)**
Public

* [Notifications](/login?return_to=%2FFRRouting%2Ffrr) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2FFRRouting%2Ffrr)
* [Star
   3.5k](/login?return_to=%2FFRRouting%2Ffrr)

* [Code](/FRRouting/frr)
* [Issues
  351](/FRRouting/frr/issues)
* [Pull requests
  216](/FRRouting/frr/pulls)
* [Discussions](/FRRouting/frr/discussions)
* [Actions](/FRRouting/frr/actions)
* [Projects
  1](/FRRouting/frr/projects)
* [Wiki](/FRRouting/frr/wiki)
* [Security](/FRRouting/frr/security)
* [Insights](/FRRouting/frr/pulse)

Additional navigation options

* [Code](/FRRouting/frr)
* [Issues](/FRRouting/frr/issues)
* [Pull requests](/FRRouting/frr/pulls)
* [Discussions](/FRRouting/frr/discussions)
* [Actions](/FRRouting/frr/actions)
* [Projects](/FRRouting/frr/projects)
* [Wiki](/FRRouting/frr/wiki)
* [Security](/FRRouting/frr/security)
* [Insights](/FRRouting/frr/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FFRRouting%2Ffrr%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FFRRouting%2Ffrr%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# isisd: overflow bugs in unpack\_tlv\_router\_cap #10507

Closed

[whichbug](/whichbug) opened this issue
Feb 6, 2022
· 21 comments

Closed

# [isisd: overflow bugs in unpack\_tlv\_router\_cap](#top) #10507

[whichbug](/whichbug) opened this issue
Feb 6, 2022
· 21 comments

## Comments

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

### **[whichbug](/whichbug)** commented [Feb 6, 2022](#issue-1125093957) • edited Loading

| [frr/isisd/isis\_tlvs.c](https://github.com/FRRouting/frr/blob/18ed776ca29533f6c49479b1a0dd95d36bb6b5ec/isisd/isis_tlvs.c#L3004-L3114)  Lines 3004 to 3114 in [18ed776](/FRRouting/frr/commit/18ed776ca29533f6c49479b1a0dd95d36bb6b5ec)   |  | subtlv\_len = tlv\_len - ISIS\_ROUTER\_CAP\_SIZE; | | --- | --- | |  | while (subtlv\_len > 2) { | |  | uint8\_t msd\_type; | |  |  | |  | type = stream\_getc(s); | |  | length = stream\_getc(s); | |  | switch (type) { | |  | case ISIS\_SUBTLV\_SID\_LABEL\_RANGE: | |  | /\* Check that SRGB is correctly formated \*/ | |  | if (length < SUBTLV\_RANGE\_LABEL\_SIZE | |  | || length > SUBTLV\_RANGE\_INDEX\_SIZE) { | |  | stream\_forward\_getp(s, length); | |  | continue; | |  | } | |  | /\* Only one SRGB is supported. Skip subsequent one \*/ | |  | if (rcap->srgb.range\_size != 0) { | |  | stream\_forward\_getp(s, length); | |  | continue; | |  | } | |  | rcap->srgb.flags = stream\_getc(s); | |  | rcap->srgb.range\_size = stream\_get3(s); | |  | /\* Skip Type and get Length of SID Label \*/ | |  | stream\_getc(s); | |  | size = stream\_getc(s); | |  | if (size == ISIS\_SUBTLV\_SID\_LABEL\_SIZE) | |  | rcap->srgb.lower\_bound = stream\_get3(s); | |  | else | |  | rcap->srgb.lower\_bound = stream\_getl(s); | |  |  | |  | /\* SRGB sanity checks. \*/ | |  | if (rcap->srgb.range\_size == 0 | |  | || (rcap->srgb.lower\_bound <= MPLS\_LABEL\_RESERVED\_MAX) | |  | || ((rcap->srgb.lower\_bound + rcap->srgb.range\_size - 1) | |  | > MPLS\_LABEL\_UNRESERVED\_MAX)) { | |  | sbuf\_push(log, indent, "Invalid label range. Reset SRGB\n"); | |  | rcap->srgb.lower\_bound = 0; | |  | rcap->srgb.range\_size = 0; | |  | } | |  | /\* Only one range is supported. Skip subsequent one \*/ | |  | size = length - (size + SUBTLV\_SR\_BLOCK\_SIZE); | |  | if (size > 0) | |  | stream\_forward\_getp(s, length); | |  | break; | |  | case ISIS\_SUBTLV\_ALGORITHM: | |  | /\* Only 2 algorithms are supported: SPF & Strict SPF \*/ | |  | stream\_get(&rcap->algo, s, | |  | length > SR\_ALGORITHM\_COUNT | |  | ? SR\_ALGORITHM\_COUNT | |  | : length); | |  | if (length > SR\_ALGORITHM\_COUNT) | |  | stream\_forward\_getp( | |  | s, length - SR\_ALGORITHM\_COUNT); | |  | break; | |  | case ISIS\_SUBTLV\_SRLB: | |  | /\* Check that SRLB is correctly formated \*/ | |  | if (length < SUBTLV\_RANGE\_LABEL\_SIZE | |  | || length > SUBTLV\_RANGE\_INDEX\_SIZE) { | |  | stream\_forward\_getp(s, length); | |  | continue; | |  | } | |  | /\* RFC 8667 section #3.3: Only one SRLB is authorized \*/ | |  | if (rcap->srlb.range\_size != 0) { | |  | stream\_forward\_getp(s, length); | |  | continue; | |  | } | |  | /\* Ignore Flags which are not defined \*/ | |  | stream\_getc(s); | |  | rcap->srlb.range\_size = stream\_get3(s); | |  | /\* Skip Type and get Length of SID Label \*/ | |  | stream\_getc(s); | |  | size = stream\_getc(s); | |  | if (size == ISIS\_SUBTLV\_SID\_LABEL\_SIZE) | |  | rcap->srlb.lower\_bound = stream\_get3(s); | |  | else | |  | rcap->srlb.lower\_bound = stream\_getl(s); | |  |  | |  | /\* SRLB sanity checks. \*/ | |  | if (rcap->srlb.range\_size == 0 | |  | || (rcap->srlb.lower\_bound <= MPLS\_LABEL\_RESERVED\_MAX) | |  | || ((rcap->srlb.lower\_bound + rcap->srlb.range\_size - 1) | |  | > MPLS\_LABEL\_UNRESERVED\_MAX)) { | |  | sbuf\_push(log, indent, "Invalid label range. Reset SRLB\n"); | |  | rcap->srlb.lower\_bound = 0; | |  | rcap->srlb.range\_size = 0; | |  | } | |  | /\* Only one range is supported. Skip subsequent one \*/ | |  | size = length - (size + SUBTLV\_SR\_BLOCK\_SIZE); | |  | if (size > 0) | |  | stream\_forward\_getp(s, length); | |  | break; | |  | case ISIS\_SUBTLV\_NODE\_MSD: | |  | /\* Check that MSD is correctly formated \*/ | |  | if (length < MSD\_TLV\_SIZE) { | |  | stream\_forward\_getp(s, length); | |  | continue; | |  | } | |  | msd\_type = stream\_getc(s); | |  | rcap->msd = stream\_getc(s); | |  | /\* Only BMI-MSD type has been defined in RFC 8491 \*/ | |  | if (msd\_type != MSD\_TYPE\_BASE\_MPLS\_IMPOSITION) | |  | rcap->msd = 0; | |  | /\* Only one MSD is standardized. Skip others \*/ | |  | if (length > MSD\_TLV\_SIZE) | |  | stream\_forward\_getp(s, length - MSD\_TLV\_SIZE); | |  | break; | |  | default: | |  | stream\_forward\_getp(s, length); | |  | break; | |  | } | |  | subtlv\_len = subtlv\_len - length - 2; | |  | } |      There are a few issues in the loop above leading to overflow vulnerabilities. The loop condition is `subtlv_len > 2` and `subtlv_len` is updated at the end of the loop (Line 3113: `subtlv_len = subtlv_len - length - 2`).  **The Issue on Loop Condition**: at Line 3113, when we update `subtlv_len`, if `subtlv_len < length + 2`, integer overflow will happen, leading to heap overflows in the next loop iteration. Note that `subtlv_len` and `length` are of `uint8_t`, which makes it easy to overflow, e.g., `subtlv_len=35`, `length=38`... An example output of the address sanitizer can be found below:  ``` 2022/02/05 21:54:53 ISIS: [S48XV-GT1WC][EC 100663311] stream_getc: Attempt to get char out of bounds 2022/02/05 21:54:53 ISIS: [RF6RD-ZCBTC][EC 100663311] &(struct stream): 0x61200000f940, size: 231, getp: 74, endp: 74 ==86437==      #1 0x7fe6ec3a118a in __libc_signal_restore_set /build/glibc-eX1tMB/glibc-2.31/signal/../sysdeps/unix/sysv/linux/internal-signals.h:86:3     #2 0x7fe6ec3a118a in raise /build/glibc-eX1tMB/glibc-2.31/signal/../sysdeps/unix/sysv/linux/raise.c:48:3     #3 0x7fe6ec380858 in abort /build/glibc-eX1tMB/glibc-2.31/stdlib/abort.c:79:7     #4 0x880f5c in _zlog_assert_failed /home/parallels/myfrr/lib/zlog.c:700:2     #5 0x7f2f6f in stream_getc /home/parallels/myfrr/lib/stream.c     #6 0x63c10c in unpack_tlv_router_cap /home/parallels/myfrr/isisd/isis_tlvs.c:3016:10     #7 0x6242a5 in unpack_tlv /home/parallels/myfrr/isisd/isis_tlvs.c:4332:10     #8 0x6242a5 in unpack_tlvs /home/parallels/myfrr/isisd/isis_tlvs.c:4354:8     #9 0x623ce4 in isis_unpack_tlvs /home/parallels/myfrr/isisd/isis_tlvs.c:4385:7     #10 0x5d5b5b in process_lsp /home/parallels/myfrr/isisd/isis_pdu.c:940:6     #11 0x5cf009 in isis_handle_pdu /home/parallels/myfrr/isisd/isis_pdu.c:1781:12  ```  **Other Issues**: at Line 3016, Line 3021, Line 3062, Line 3067, and Line 3098, I think we need to use `break` instead of `continue`. Using `continue` will let us miss the update of the loop condition variable at Line 3113.  Please check if my understanding of the code above is correct. If so, I can make a pull request to fix these issues then. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Feb 6, 2022](#issuecomment-1030748475)

| **Issues on stream\_forward\_getp**: Also in the loop shown above, at Line 3015, Line 3020, Line 3045, Line 3054, Line 3061, Line 3066, Line 3097, Line 3107, and Line 3110, when we call `stream_forward_getp(s, length)`, there is no check whether `s + length` exceeds the bound of the stream, thus causing assertion failures in `stream_forward_getp`. |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Feb 6, 2022](#issuecomment-1030749486)

| **Issues on stream\_get**: Also in the loop shown above, at Line 3049, when we call `stream_get`, we do not check if enough data are available in the buffer, which will cause overflows... |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Feb 6, 2022](#issuecomment-1030751064) • edited Loading

| **Integer overflow bugs**: Also in the loop shown above, at Line 3043 and Line 3090, when we do the operation `size = length - (size + SUBTLV_SR_BLOCK_SIZE)`, integer overflows often happens, when `length < size + SUBTLV_SR_BLOCK_SIZE`. Both `length` and `size` are of uint8\_t, making the overflow happen frequently...  And I think the following code at Lines 3045 and 3092 should be `stream_forward_getp(s, size)` rather than `stream_forward_getp(s, length)`. Please check... |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Feb 6, 2022](#issuecomment-1030751762) • edited Loading

| **Heap overflows**: Also in the loop shown above, at Line 3031 and Line 3078, the operation `stream_getl(s)` is valid only when `length = 10` but `length` may be `9`... |
| --- |

All reactions

Sorry, something went wrong.

[![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=80&u=e4fb7eefa8244a2824931fa7e2c426cd89802ac1&v=4)](/qlyoung)

Copy link

Member

### **[qlyoung](/qlyoung)** commented [Feb 7, 2022](#issuecomment-1031573152)

| Hi! Are you fuzzing or auditing manually? |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Feb 7, 2022](#issuecomment-1031589945)

| Hi! Are you fuzzing or auditing manually?  Hi, I am using FRR in one of our projects and trying to test its reliability. You can regard it as a kind of testing.  I carefully went through every problem I found and reported the issue only when I thought it is really a problem. I also tried to propose fixes as I also want to make contributions to FRR's community. |
| --- |

All reactions

Sorry, something went wrong.

[![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=80&u=e4fb7eefa8244a2824931fa7e2c426cd89802ac1&v=4)](/qlyoung)

Copy link

Member

### **[qlyoung](/qlyoung)** commented [Feb 7, 2022](#issuecomment-1031654819)

| Yes, your reports are good quality and appreciated. I'm just curious what techniques you're using to find the issues. Are you part of a group? Others seem to be reporting the same type of issues recently. |
| --- |

All reactions

Sorry, something went wrong.

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=80&u=51fd13af16a6eb7beaa64b47f435e1dfe9beb920&v=4)](/idryzhov)

Copy link

Contributor

### **[idryzhov](/idryzhov)** commented [Feb 7, 2022](#issuecomment-1031723672)

| Please check PR [#9850](https://github.com/FRRouting/frr/pull/9850). I believe most of the reported issues are solved there. Or even all of them. The PR is finished and the code is approved, but unfortunately it breaks some of our tests so it was not merged. I believe the tests could be wrong and should be fixed so it would be great if you look into that. |
| --- |

All reactions

Sorry, something went wrong.

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=80&u=51fd13af16a6eb7beaa64b47f435e1dfe9beb920&v=4)](/idryzhov)

Copy link

Contributor

### **[idryzhov](/idryzhov)** commented [Feb 7, 2022](#issuecomment-1031757046)

| Update: [#9850](https://github.com/FRRouting/frr/pull/9850) has conflicts with current master, so I pushed a rebased version in [#10517](https://github.com/FRRouting/frr/pull/10517). Let's see whether it passes the tests. |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Feb 7, 2022](#issuecomment-1031769717)

| Update: [#9850](https://github.com/FRRouting/frr/pull/9850) has conflicts with current master, so I pushed a rebased version in [#10517](https://github.com/FRRouting/frr/pull/10517). Let's see whether it passes the tests.  Thanks very much. That patch is helpful for me. |
| --- |

All reactions

Sorry, something went wrong.

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=80&u=51fd13af16a6eb7beaa64b47f435e1dfe9beb920&v=4)](/idryzhov)

Copy link

Contributor

### **[idryzhov](/idryzhov)** commented [Feb 8, 2022](#issuecomment-1032622613)

| [#10517](https://github.com/FRRouting/frr/pull/10517) is now merged, could you please check if it fixes all reported issues? |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Feb 8, 2022](#issuecomment-1032785144)

| [#10517](https://github.com/FRRouting/frr/pull/10517) is now merged, could you please check if it fixes all reported issues?  Yes, I think all are fixed. This issue can be closed. Thanks for your great efforts! |
| --- |

All reactions

Sorry, something went wrong.

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=80&u=51fd13af16a6eb7beaa64b47f435e1dfe9beb920&v=4)](/idryzhov)

Copy link

Contributor

### **[idryzhov](/idryzhov)** commented [Feb 8, 2022](#issuecomment-1032807144)

| Thanks for reporting! |
| --- |

All reactions

Sorry, something went wrong.

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=40&u=51fd13af16a6eb7beaa64b47f435e1dfe9beb920&v=4)](/idryzhov)
[idryzhov](/idryzhov)
closed this as [completed](/FRRouting/frr/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Feb 8, 2022](#event-6028145024)

[![@00xc](https://avatars.githubusercontent.com/u/48725664?s=80&u=8fd4aab32c746d120f56a49a3c29b8b492d06bae&v=4)](/00xc)

Copy link

### **[00xc](/00xc)** commented [Feb 25, 2022](#issuecomment-1051023668)

| This was assigned [CVE-2022-26125](https://github.com/advisories/GHSA-9hg8-8wq3-mhhg "CVE-2022-26125"). |
| --- |

All reactions

Sorry, something went wrong.

[![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=80&u=e4fb7eefa8244a2824931fa7e2c426cd89802ac1&v=4)](/qlyoung)

Copy link

Member

### **[qlyoung](/qlyoung)** commented [Mar 25, 2022](#issuecomment-1079095009)

| Yeah, so...this is an assertion failure unless I'm reading the issue wrong. We push a stream buffer until a point where automatic bounds checks kick in and terminate the program to *prevent* a buffer overflow. Yet this is labeled as a buffer overflow and assigned a CVE score of 7.8.  [@00xc](https://github.com/00xc) [@whichbug](https://github.com/whichbug) can one of you guys clarify the situation here? |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Mar 25, 2022](#issuecomment-1079197150)

| Yeah, so...this is an assertion failure unless I'm reading the issue wrong. We push a stream buffer until a point where automatic bounds checks kick in and terminate the program to *prevent* a buffer overflow. Yet this is labeled as a buffer overflow and assigned a CVE score of 7.8.  [@00xc](https://github.com/00xc) [@whichbug](https://github.com/whichbug) can one of you guys clarify the situation here?  I guess the problem is that the assertion failures are caused by potential overflows. The CVE score could be reduced. |
| --- |

All reactions

Sorry, something went wrong.

[![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=80&u=e4fb7eefa8244a2824931fa7e2c426cd89802ac1&v=4)](/qlyoung)

Copy link

Member

### **[qlyoung](/qlyoung)** commented [Mar 28, 2022](#issuecomment-1080985102)

| There are no potential overflows. The potential for overflow is eliminated by the assert. That's the whole point of the assert, that's why we put it there.  Since it sounds like you agree with my assessment, can you work with the CVE people to fix the CVE you filed? Frankly I don't even think this deserves a CVE but if you are set on filing them, please make sure you accurately report the problem.  So that you have some insight into what happens when the CVE process is used, we now have people from Debian emailing us regarding the high-severity CVEs you've filed for these issues. So now that I've found that this one isn't accurate, now I have to go through and cross check each of your reports against the CVEs you've filed to make sure they're actually accurate.  On that topic, usually when you file CVEs against projects, it's expected that you work with the people who run the project to agree on a characterization of what is going to be filed and when it's going to be disclosed. Unless we missed some communication from you, you haven't done that, which is inconsiderate to us. We're volunteers, not a major company selling a product. We aren't going to sue you to prevent you from filing CVEs. We have an established process for reporting security vulnerabilities that's in the project README. Your research is appreciated but please, follow common practices, spend the time to reach out and work with us regarding reporting and disclosure. |
| --- |

All reactions

Sorry, something went wrong.

This was referenced Mar 28, 2022

[isisd: misusing strdup leads to stack overflow
#10505](/FRRouting/frr/issues/10505)

Closed

[Miss a check on length in Babel
#10487](/FRRouting/frr/issues/10487)

Closed

[Incorrect checks on length in babeld
#10502](/FRRouting/frr/issues/10502)

Closed

[babeld: bugs in parse\_hello\_subtlv, parse\_ihu\_subtlv, and parse\_update\_subtlv
#10503](/FRRouting/frr/issues/10503)

Closed

[![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=80&u=e4fb7eefa8244a2824931fa7e2c426cd89802ac1&v=4)](/qlyoung)

Copy link

Member

### **[qlyoung](/qlyoung)** commented [Mar 28, 2022](#issuecomment-1081000685)

| [@00xc](https://github.com/00xc) [@whichbug](https://github.com/whichbug) By the way, if you guys are really interested in helping us with project security, we have a big list of issues just like this one found via our own security processes (such as Coverity, LLVM scan-build, ClusterFuzz, etc) that we need help fixing. Let me know if you're interested in contributing and I'll get you connected with our services so we can get some patches rolling. |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Mar 28, 2022](#issuecomment-1081037476)

| [@00xc](https://github.com/00xc) [@whichbug](https://github.com/whichbug) By the way, if you guys are really interested in helping us with project security, we have a big list of issues just like this one found via our own security processes (such as Coverity, LLVM scan-build, ClusterFuzz, etc) that we need help fixing. Let me know if you're interested in contributing and I'll get you connected with our services so we can get some patches rolling.  Thanks for your information. It looks good to me if I can contribute. You see I always tried to fix these reported bugs. |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Mar 28, 2022](#issuecomment-1081233408)

| Since it sounds like you agree with my assessment, can you work with the CVE people to fix the CVE you filed?  I have sent a request to update. I think it will be updated soon. |
| --- |

All reactions

Sorry, something went wrong.

[![@00xc](https://avatars.githubusercontent.com/u/48725664?s=80&u=8fd4aab32c746d120f56a49a3c29b8b492d06bae&v=4)](/00xc)

Copy link

### **[00xc](/00xc)** commented [Mar 29, 2022](#issuecomment-1081736549)

| On that topic, usually when you file CVEs against projects, it's expected that you work with the people who run the project to agree on a characterization of what is going to be filed and when it's going to be disclosed.  I don't think this was directed to me, but to be clear, I did not request the CVE, I just tried to make everyone aware. For what is worth, I updated [our downstream CVSS score](https://www.suse.com/es-es/security/cve/CVE-2022-26125.html) for this issue accordingly. Hopefully MITRE will do the same soon.  Frankly I don't even think this deserves a CVE  Not that my personal opinion matters much here, but a remotely reachable assertion (i.e. remote DoS) seems severe enough, although I might be missing something. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FFRRouting%2Ffrr%2Fissues%2F10507)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=52&v=4)](/idryzhov) [![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=52&v=4)](/qlyoung) [![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=52&v=4)](/whichbug) [![@00xc](https://avatars.githubusercontent.com/u/48725664?s=52&v=4)](/00xc)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a807b59f_20250108_144354.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFRRouting%2Ffrr%2Fissues%2F10503)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFRRouting%2Ffrr%2Fissues%2F10503)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=FRRouting%2Ffrr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[FRRouting](/FRRouting)
/
**[frr](/FRRouting/frr)**
Public

* [Notifications](/login?return_to=%2FFRRouting%2Ffrr) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2FFRRouting%2Ffrr)
* [Star
   3.5k](/login?return_to=%2FFRRouting%2Ffrr)

* [Code](/FRRouting/frr)
* [Issues
  352](/FRRouting/frr/issues)
* [Pull requests
  215](/FRRouting/frr/pulls)
* [Discussions](/FRRouting/frr/discussions)
* [Actions](/FRRouting/frr/actions)
* [Projects
  1](/FRRouting/frr/projects)
* [Wiki](/FRRouting/frr/wiki)
* [Security](/FRRouting/frr/security)
* [Insights](/FRRouting/frr/pulse)

Additional navigation options

* [Code](/FRRouting/frr)
* [Issues](/FRRouting/frr/issues)
* [Pull requests](/FRRouting/frr/pulls)
* [Discussions](/FRRouting/frr/discussions)
* [Actions](/FRRouting/frr/actions)
* [Projects](/FRRouting/frr/projects)
* [Wiki](/FRRouting/frr/wiki)
* [Security](/FRRouting/frr/security)
* [Insights](/FRRouting/frr/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FFRRouting%2Ffrr%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FFRRouting%2Ffrr%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# babeld: bugs in parse\_hello\_subtlv, parse\_ihu\_subtlv, and parse\_update\_subtlv #10503

Closed

[qingkaishi](/qingkaishi) opened this issue
Feb 4, 2022
· 6 comments
 · Fixed by [#10504](https://github.com/FRRouting/frr/pull/10504)

Closed

# [babeld: bugs in parse\_hello\_subtlv, parse\_ihu\_subtlv, and parse\_update\_subtlv](#top) #10503

[qingkaishi](/qingkaishi) opened this issue
Feb 4, 2022
· 6 comments
 · Fixed by [#10504](https://github.com/FRRouting/frr/pull/10504)

Labels
[triage](/FRRouting/frr/labels/triage)
Needs further investigation

## Comments

[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=80&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

Copy link

Contributor

### **[qingkaishi](/qingkaishi)** commented [Feb 4, 2022](#issue-1124623649)

| [frr/babeld/message.c](https://github.com/FRRouting/frr/blob/e743c1b8e7989d7e3dc9092603bfb638958fa166/babeld/message.c#L131-L151)  Lines 131 to 151 in [e743c1b](/FRRouting/frr/commit/e743c1b8e7989d7e3dc9092603bfb638958fa166)   |  | parse\_update\_subtlv(const unsigned char \*a, int alen, | | --- | --- | |  | unsigned char \*channels) | |  | { | |  | int type, len, i = 0; | |  |  | |  | while(i < alen) { | |  | type = a[i]; | |  | if(type == SUBTLV\_PAD1) { | |  | i++; | |  | continue; | |  | } | |  |  | |  | if(i + 1 > alen) { | |  | flog\_err(EC\_BABEL\_PACKET, "Received truncated attributes."); | |  | return; | |  | } | |  | len = a[i + 1]; | |  | if(i + len > alen) { | |  | flog\_err(EC\_BABEL\_PACKET, "Received truncated attributes."); | |  | return; | |  | } |      Line 143: the condition should be `i + 1 >= alen` instead of `i + 1 > alen`. Otherwise, overflows will happen at 147.  Line 148: the condition should be `i + len + 2 > alen` instead of `i + len > alen`. We need include extra two bytes, a[i] and a[i + 1] in this check. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)
[qingkaishi](/qingkaishi)
added
the
[triage](/FRRouting/frr/labels/triage)
Needs further investigation
label
[Feb 4, 2022](#event-6012073729)

[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=80&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

Copy link

Contributor

Author

### **[qingkaishi](/qingkaishi)** commented [Feb 4, 2022](#issuecomment-1030357451)

| [frr/babeld/message.c](https://github.com/FRRouting/frr/blob/e743c1b8e7989d7e3dc9092603bfb638958fa166/babeld/message.c#L179-L201)  Lines 179 to 201 in [e743c1b](/FRRouting/frr/commit/e743c1b8e7989d7e3dc9092603bfb638958fa166)   |  | parse\_hello\_subtlv(const unsigned char \*a, int alen, | | --- | --- | |  | unsigned int \*hello\_send\_us) | |  | { | |  | int type, len, i = 0, ret = 0; | |  |  | |  | while(i < alen) { | |  | type = a[0]; | |  | if(type == SUBTLV\_PAD1) { | |  | i++; | |  | continue; | |  | } | |  |  | |  | if(i + 1 > alen) { | |  | flog\_err(EC\_BABEL\_PACKET, | |  | "Received truncated sub-TLV on Hello message."); | |  | return -1; | |  | } | |  | len = a[i + 1]; | |  | if(i + len > alen) { | |  | flog\_err(EC\_BABEL\_PACKET, | |  | "Received truncated sub-TLV on Hello message."); | |  | return -1; | |  | } |      Line 185: it should be `a[i]` instead of `a[0]`.  Line 191: the condition should be `i + 1 >= alen` instead of `i + 1 > alen`  Line 197: the condition should be `i + len + 2 > alen` instead of `i + len > alen` |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=80&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

Copy link

Contributor

Author

### **[qingkaishi](/qingkaishi)** commented [Feb 4, 2022](#issuecomment-1030358293) • edited Loading

| [frr/babeld/message.c](https://github.com/FRRouting/frr/blob/e743c1b8e7989d7e3dc9092603bfb638958fa166/babeld/message.c#L224-L247)  Lines 224 to 247 in [e743c1b](/FRRouting/frr/commit/e743c1b8e7989d7e3dc9092603bfb638958fa166)   |  | parse\_ihu\_subtlv(const unsigned char \*a, int alen, | | --- | --- | |  | unsigned int \*hello\_send\_us, | |  | unsigned int \*hello\_rtt\_receive\_time) | |  | { | |  | int type, len, i = 0, ret = 0; | |  |  | |  | while(i < alen) { | |  | type = a[0]; | |  | if(type == SUBTLV\_PAD1) { | |  | i++; | |  | continue; | |  | } | |  |  | |  | if(i + 1 > alen) { | |  | flog\_err(EC\_BABEL\_PACKET, | |  | "Received truncated sub-TLV on IHU message."); | |  | return -1; | |  | } | |  | len = a[i + 1]; | |  | if(i + len > alen) { | |  | flog\_err(EC\_BABEL\_PACKET, | |  | "Received truncated sub-TLV on IHU message."); | |  | return -1; | |  | } |      Line 231: it should be `a[i]` instead of `a[0]`.  Line 237: the condition should be `i + 1 >= alen` instead of `i + 1 > alen`.  Line 243: the condition should be `i + len + 2 > alen` instead of `i + len > alen`. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=80&u=51fd13af16a6eb7beaa64b47f435e1dfe9beb920&v=4)](/idryzhov)

Copy link

Contributor

### **[idryzhov](/idryzhov)** commented [Feb 4, 2022](#issuecomment-1030359993)

| Hi [@qingkaishi](https://github.com/qingkaishi), thanks for letting everyone know about the issues. But as you already know how to fix all of them, it would be much easier for us if you provide a PR with the fixes instead. |
| --- |

All reactions

Sorry, something went wrong.

[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=80&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

Copy link

Contributor

Author

### **[qingkaishi](/qingkaishi)** commented [Feb 4, 2022](#issuecomment-1030360432)

| Hi [@qingkaishi](https://github.com/qingkaishi), thanks for letting everyone know about the issues. But as you already know how to fix all of them, it would be much easier for us if you provide a PR with the fixes instead.  Sure. I will do that soon. |
| --- |

All reactions

Sorry, something went wrong.

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=80&u=51fd13af16a6eb7beaa64b47f435e1dfe9beb920&v=4)](/idryzhov)

Copy link

Contributor

### **[idryzhov](/idryzhov)** commented [Feb 4, 2022](#issuecomment-1030360569)

| Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[qingkaishi](/qingkaishi)
added a commit
to qingkaishi/frr
that referenced
this issue
[Feb 4, 2022](#ref-commit-05a1985)
[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

`[babeld:](/qingkaishi/frr/commit/05a19855c534e9de2b3fac088c14436e873c72b4 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [fix](/qingkaishi/frr/commit/05a19855c534e9de2b3fac088c14436e873c72b4 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [FRRouting#10502](https://github.com/FRRouting/frr/issues/10502) [FRRouting#10503](https://github.com/FRRouting/frr/issues/10503) [by repairing the checks o…](/qingkaishi/frr/commit/05a19855c534e9de2b3fac088c14436e873c72b4 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>")`
…

`[05a1985](/qingkaishi/frr/commit/05a19855c534e9de2b3fac088c14436e873c72b4)`

```
…n length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
```

[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)
[qingkaishi](/qingkaishi)
mentioned this issue
[Feb 4, 2022](#ref-pullrequest-1124646113)

[babeld: fix the checks for truncated packets
#10504](/FRRouting/frr/pull/10504)
 Merged

[qingkaishi](/qingkaishi)
added a commit
to qingkaishi/frr
that referenced
this issue
[Feb 4, 2022](#ref-commit-c379335)
[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

`[babeld:](/qingkaishi/frr/commit/c3793352a8d76d2eee1edc38a9a16c1c8a6573f4 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [fix](/qingkaishi/frr/commit/c3793352a8d76d2eee1edc38a9a16c1c8a6573f4 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [FRRouting#10502](https://github.com/FRRouting/frr/issues/10502) [FRRouting#10503](https://github.com/FRRouting/frr/issues/10503) [by repairing the checks o…](/qingkaishi/frr/commit/c3793352a8d76d2eee1edc38a9a16c1c8a6573f4 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>")`
…

`[c379335](/qingkaishi/frr/commit/c3793352a8d76d2eee1edc38a9a16c1c8a6573f4)`

```
…n length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
```

[![@donaldsharp](https://avatars.githubusercontent.com/u/10601296?s=40&u=958b931080d7b7d0c32fd5ae39c914f7d8c405e9&v=4)](/donaldsharp)
[donaldsharp](/donaldsharp)
closed this as [completed](/FRRouting/frr/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#10504](/FRRouting/frr/pull/10504)
[Feb 8, 2022](#event-6027586034)

[mergify](/apps/mergify) bot
pushed a commit
that referenced
this issue
[Feb 8, 2022](#ref-commit-8d45143)
[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

`[babeld:](/FRRouting/frr/commit/8d451431b0f7977aad7759dff2640d0a8d7ee7e8 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
(cherry picked from commit c3793352a8d76d2eee1edc38a9a16c1c8a6573f4)") [fix](/FRRouting/frr/commit/8d451431b0f7977aad7759dff2640d0a8d7ee7e8 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
(cherry picked from commit c3793352a8d76d2eee1edc38a9a16c1c8a6573f4)") [#10502](https://github.com/FRRouting/frr/issues/10502) [#10503](https://github.com/FRRouting/frr/issues/10503) [by repairing the checks on length](/FRRouting/frr/commit/8d451431b0f7977aad7759dff2640d0a8d7ee7e8 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
(cherry picked from commit c3793352a8d76d2eee1edc38a9a16c1c8a6573f4)")`
…

`[8d45143](/FRRouting/frr/commit/8d451431b0f7977aad7759dff2640d0a8d7ee7e8)`

```
This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
(cherry picked from commit [c379335](https://github.com/FRRouting/frr/commit/c3793352a8d76d2eee1edc38a9a16c1c8a6573f4))
```

[plsaranya](/plsaranya)
pushed a commit
to plsaranya/frr
that referenced
this issue
[Feb 28, 2022](#ref-commit-ac79863)
[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi) [![@plsaranya](https://avatars.githubusercontent.com/u/10954528?s=40&v=4)](/plsaranya)

`[babeld:](/plsaranya/frr/commit/ac7986373a29cc7e53556c0f7f37e7e44d751523 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [fix](/plsaranya/frr/commit/ac7986373a29cc7e53556c0f7f37e7e44d751523 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [FRRouting#10502](https://github.com/FRRouting/frr/issues/10502) [FRRouting#10503](https://github.com/FRRouting/frr/issues/10503) [by repairing the checks o…](/plsaranya/frr/commit/ac7986373a29cc7e53556c0f7f37e7e44d751523 "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>")`
…

`[ac79863](/plsaranya/frr/commit/ac7986373a29cc7e53556c0f7f37e7e44d751523)`

```
…n length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
```

[![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=80&u=e4fb7eefa8244a2824931fa7e2c426cd89802ac1&v=4)](/qlyoung)

Copy link

Member

### **[qlyoung](/qlyoung)** commented [Mar 28, 2022](#issuecomment-1080998468)

| This has been assigned [CVE-2022-26129](https://nvd.nist.gov/vuln/detail/CVE-2022-26129) with a severity score of 7.8.  No assessment of exploitability has been made.  Please see my comment [here](https://github.com/FRRouting/frr/issues/10507#issuecomment-1080985102). |
| --- |

All reactions

Sorry, something went wrong.

[patrasar](/patrasar)
pushed a commit
to patrasar/frr
that referenced
this issue
[Apr 28, 2022](#ref-commit-5916eb6)
[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi) [![@patrasar](https://avatars.githubusercontent.com/u/40834655?s=40&v=4)](/patrasar)

`[babeld:](/patrasar/frr/commit/5916eb6bc92a7887d7022d4a107c7ea020281a5b "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [fix](/patrasar/frr/commit/5916eb6bc92a7887d7022d4a107c7ea020281a5b "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [FRRouting#10502](https://github.com/FRRouting/frr/issues/10502) [FRRouting#10503](https://github.com/FRRouting/frr/issues/10503) [by repairing the checks o…](/patrasar/frr/commit/5916eb6bc92a7887d7022d4a107c7ea020281a5b "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>")`
…

`[5916eb6](/patrasar/frr/commit/5916eb6bc92a7887d7022d4a107c7ea020281a5b)`

```
…n length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
```

[gpnaveen](/gpnaveen)
pushed a commit
to gpnaveen/frr
that referenced
this issue
[Jun 7, 2022](#ref-commit-8876609)
[![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=40&u=61f5601b5ba93dc6bcbb4803538be64bf1a3485d&v=4)](/qingkaishi)

`[babeld:](/gpnaveen/frr/commit/88766097535a8b8b84344e631594eadf7ce1961e "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [fix](/gpnaveen/frr/commit/88766097535a8b8b84344e631594eadf7ce1961e "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>") [FRRouting#10502](https://github.com/FRRouting/frr/issues/10502) [FRRouting#10503](https://github.com/FRRouting/frr/issues/10503) [by repairing the checks o…](/gpnaveen/frr/commit/88766097535a8b8b84344e631594eadf7ce1961e "babeld: fix #10502 #10503 by repairing the checks on length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>")`
…

`[8876609](/gpnaveen/frr/commit/88766097535a8b8b84344e631594eadf7ce1961e)`

```
…n length

This patch repairs the checking conditions on length in four functions:
babel_packet_examin, parse_hello_subtlv, parse_ihu_subtlv, and parse_update_subtlv

Signed-off-by: qingkaishi <qingkaishi@gmail.com>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FFRRouting%2Ffrr%2Fissues%2F10503)

Assignees

No one assigned

Labels

[triage](/FRRouting/frr/labels/triage)
Needs further investigation

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [babeld: fix the checks for truncated packets](/FRRouting/frr/pull/10504)
 [qingkaishi/frr](/qingkaishi/frr)

3 participants

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=52&v=4)](/idryzhov) [![@qingkaishi](https://avatars.githubusercontent.com/u/6349384?s=52&v=4)](/qingkaishi) [![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=52&v=4)](/qlyoung)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_0bd0ef10_20250108_144354.html ===


---

[[Date Prev](msg00018.html)][[Date Next](msg00020.html)]
[[Thread Prev](msg00018.html)][[Thread Next](msg00020.html)]
[[Date Index](maillist.html#00019)]
[[Thread Index](threads.html#00019)]

# [SECURITY] [DLA 3797-1] frr security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3797-1] frr security update
* *From*: Tobias Frost <tobi@debian.org>
* *Date*: Sun, 28 Apr 2024 08:30:09 +0200
* *Message-id*: <[[🔎]](/msgid-search/Zi3s8ct9CeoSKkSt%40isildor2.loewenhoehle.ip) [Zi3s8ct9CeoSKkSt@isildor2.loewenhoehle.ip](msg00019.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3797-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                         Tobias Frost
April 28, 2024                                <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : frr
Version        : 7.5.1-1.1+deb10u2
CVE ID         : CVE-2022-26125 CVE-2022-26126 CVE-2022-26127 CVE-2022-26128
                 CVE-2022-26129 CVE-2022-37035 CVE-2023-38406 CVE-2023-38407
                 CVE-2023-46752 CVE-2023-46753 CVE-2023-47234 CVE-2023-47235
                 CVE-2024-31948 CVE-2024-31949
Debian Bug     : 1008010 1016978 1055852

Several vulnerabilities have been found in frr, the FRRouting suite of
internet protocols. An attacker could craft packages to trigger buffer
overflows with the possibility to gain remote code execution, buffer
overreads, crashes or trick the software to enter an infinite loop.

CVE-2022-26125

    Buffer overflow vulnerabilities exist in FRRouting through 8.1.0 due to
    wrong checks on the input packet length in isisd/isis_tlvs.c.

CVE-2022-26126

    Buffer overflow vulnerabilities exist in FRRouting through 8.1.0 due to
    the use of strdup with a non-zero-terminated binary string in
    isis_nb_notifications.c.

CVE-2022-26127

    A buffer overflow vulnerability exists in FRRouting through 8.1.0 due to
    missing a check on the input packet length in the babel_packet_examin
    function in babeld/message.c.

CVE-2022-26128

    A buffer overflow vulnerability exists in FRRouting through 8.1.0 due to
    a wrong check on the input packet length in the babel_packet_examin
    function in babeld/message.c.

CVE-2022-26129

    Buffer overflow vulnerabilities exist in FRRouting through 8.1.0 due to
    wrong checks on the subtlv length in the functions, parse_hello_subtlv,
    parse_ihu_subtlv, and parse_update_subtlv in babeld/message.c.

CVE-2022-37035

    An issue was discovered in bgpd in FRRouting (FRR) 8.3. In
    bgp_notify_send_with_data() and bgp_process_packet() in bgp_packet.c,
    there is a possible use-after-free due to a race condition. This could
    lead to Remote Code Execution or Information Disclosure by sending
    crafted BGP packets. User interaction is not needed for exploitation.

CVE-2023-38406

    bgpd/bgp_flowspec.c in FRRouting (FRR) before 8.4.3 mishandles an nlri
    length of zero, aka a "flowspec overflow."

CVE-2023-38407

    bgpd/bgp_label.c in FRRouting (FRR) before 8.5 attempts to read beyond
    the end of the stream during labeled unicast parsing.

CVE-2023-46752

    An issue was discovered in FRRouting FRR through 9.0.1. It mishandles
    malformed MP_REACH_NLRI data, leading to a crash.

CVE-2023-46753

    An issue was discovered in FRRouting FRR through 9.0.1. A crash can
    occur for a crafted BGP UPDATE message without mandatory attributes,
    e.g., one with only an unknown transit attribute.

CVE-2023-47234

    An issue was discovered in bgpd in FRRouting (FRR) 8.3. In
    bgp_notify_send_with_data() and bgp_process_packet() in bgp_packet.c,
    there is a possible use-after-free due to a race condition. This could
    lead to Remote Code Execution or Information Disclosure by sending
    crafted BGP packets. User interaction is not needed for exploitation.

CVE-2023-47235

    An issue was discovered in FRRouting FRR through 9.0.1. A crash can
    occur when a malformed BGP UPDATE message with an EOR is processed,
    because the presence of EOR does not lead to a treat-as-withdraw
    outcome.

CVE-2024-31948

    In FRRouting (FRR) through 9.1, an attacker using a malformed Prefix SID
    attribute in a BGP UPDATE packet can cause the bgpd daemon to crash.

CVE-2024-31949

    In FRRouting (FRR) through 9.1, an infinite loop can occur when
    receiving a MP/GR capability as a dynamic capability because malformed
    data results in a pointer not advancing.

For Debian 10 buster, these problems have been fixed in version
7.5.1-1.1+deb10u2.

We recommend that you upgrade your frr packages.

For the detailed security status of frr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/frr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgp02u889jLNL.pgp)**

*Description:* PGP signature

---


