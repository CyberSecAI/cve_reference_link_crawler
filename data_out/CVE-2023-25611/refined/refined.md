- **Root cause of vulnerability**: Improper neutralization of formula elements in macro names when generating CSV report files.
- **Weaknesses/vulnerabilities present**: CSV Injection (CWE-1236)
- **Impact of exploitation**: An attacker can execute arbitrary code on an end-user's host by inserting spreadsheet formulas in the macro names. This occurs when the user downloads and opens the maliciously crafted CSV report file.
- **Attack vectors**: A local, authenticated attacker with high privileges can insert malicious formulas into macro names. When a user downloads the report and opens it, the spreadsheet application will execute the formulas.
- **Required attacker capabilities/position**: The attacker needs to be a local, authenticated user with high privileges on the FortiAnalyzer system to insert the malicious macro names.

**Affected Versions:**
- FortiAnalyzer 7.2: 7.2.0 through 7.2.1
- FortiAnalyzer 7.0: 7.0.0 through 7.0.6
- FortiAnalyzer 6.4: all versions

**Fixed Versions:**
- FortiAnalyzer 7.2: 7.2.2 or above
- FortiAnalyzer 7.0: 7.0.7 or above
- FortiAnalyzer 6.4: Migrate to a fixed release.