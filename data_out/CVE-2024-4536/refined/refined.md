Based on the provided information, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**
The vulnerability stems from the provider data plane resolving OAuth2 clientSecretKeys from the provider's vault using data address properties provided by the consumer.  Specifically, when using an OAuth2-protected data sink, the `clientSecretKey` parameter, which should be resolved in the context of the consumer, is instead resolved in the context of the providerâ€™s vault. The resolved secret is then sent to a consumer-controlled `tokenUrl`.

**Weaknesses/Vulnerabilities Present:**
- **CWE-201: Insertion of Sensitive Information Into Sent Data:** The provider is sending sensitive information (secrets from its vault) to an external endpoint controlled by the consumer.
- **CWE-522: Insufficiently Protected Credentials:** The application does not properly protect the client secret by retrieving it based on consumer input in the context of the provider.
- **OAuth2 Credential Exfiltration:** The vulnerability allows an attacker to exfiltrate OAuth2 access tokens and arbitrary secrets stored in the provider's vault. This is due to the provider using a client secret retrieved from its vault based on the consumer-provided key and using a consumer-provided token URL.

**Impact of Exploitation:**
- **Credential Exfiltration:** An attacker can obtain sensitive credentials (OAuth2 access tokens, cryptographic keys, etc.) from the provider's vault.
- **Unauthorized Access:**  Exfiltrated OAuth2 access tokens can be used to gain unauthorized access to resources intended to be accessed only by the provider.
- **Data Breach:** The exfiltration of long-lived secrets can lead to a larger security breach.
- **Compromise of internal credentials:** Attackers can obtain internal credentials that can be used to authenticate via SSI/MIW or DAPS.

**Attack Vectors:**
- **Network:** The attack occurs over the network through the EDC data plane using a malicious consumer-provided data destination.
- **Data Plane:** The vulnerability lies in the data plane where the provider resolves the client secret.

**Required Attacker Capabilities/Position:**
- **Dataspace Membership:** The attacker needs to be a member of the same dataspace as the provider, with the ability to negotiate contracts and initiate data transfers.
- **Knowledge of Target Secret Key:** To exploit the vulnerability, the attacker must know or be able to guess a secret key name (alias) that exists in the provider's vault or, alternatively, induce the provider to use a known secret key through a fixed name in third-party integrations.
- **Control of Data Sink:** The attacker must be able to control the `tokenUrl` and `baseUrl` of the data sink.
- **Ability to negotiate and initiate data transfer:** The attacker has to be able to negotiate a contract and initiate a data transfer to a malicious data sink.

**Additional Technical Details:**
- The vulnerability is triggered when using the `data-plane-http-oauth2` extension in combination with `ProviderPushTransferDataFlowController`.
- The `Oauth2HttpRequestParamsDecorator` is invoked for both `SourceDataAddress` and `DestinationDataAddress`, but the vulnerability occurs because the `clientSecretKey` is resolved in the context of the provider when processing the `DestinationDataAddress`.
- The `Oauth2CredentialsRequestFactory` invokes the vault to resolve the secret using the consumer-provided `clientSecretKey`.

**Mitigations:**
- Disable support for OAuth2-protected data sinks entirely (by removing the `oauth2ParamsDecorator` for sinks).
- Employ WAF solutions to reject requests containing `clientSecretKeys`.
- Include a cryptographically secure random component in each secret name.
- Ensure contract definitions can only be consumed by trusted consumers.
- Disable data plane secrets vault access entirely.

**Versions Affected:**
- Eclipse EDC versions 0.2.1 to 0.6.2 (at least)
- Tractus-X EDC versions including 0.5.4 (and likely 0.7.0)

**CVSS Score:**
- The initial report assessed the vulnerability with a CVSS v4.0 score of 9.3/10 (CRITICAL).
- Later assessment uses a CVSS v4.0 score of 6.9.

The provided content gives a detailed explanation of a vulnerability in the Eclipse EDC, including its root cause, impact, and mitigation strategies.