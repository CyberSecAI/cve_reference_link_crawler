

![HashiCorp Discuss](data:image/svg;base64...)
Loading

[HashiCorp Discuss](/)

# [HCSEC-2022-28 - Consul Cluster Peering Leaks Imported Nodes/Services Information](/t/hcsec-2022-28-consul-cluster-peering-leaks-imported-nodes-services-information/46946)

[Security](/c/security/52)

[security-consul](https://discuss.hashicorp.com/tag/security-consul)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

November 15, 2022, 11:19pm

1

**Bulletin ID:** HCSEC-2022-28

**Affected Products / Versions:** Consul and Consul Enterprise 1.13.0 up to 1.13.3; fixed in 1.14.0.

**Publication Date:** November 15, 2022

**Summary**

A vulnerability was identified in Consul and Consul Enterprise (“Consul”) such that the `/v1/internal/ui/nodes` and `/v1/internal/ui/services` HTTP endpoints do not properly filter information by ACL policies. This vulnerability, CVE-2022-3920, was fixed in Consul 1.14.0.

**Background**

Consul [cluster peering](https://developer.hashicorp.com/consul/docs/v1.13.x/connect/cluster-peering) is a beta feature to support peering connections between two or more independent clusters so that services deployed to different partitions or datacenters can communicate.

**Details**

During internal testing, we observed that node and service information imported through cluster peering was being leaked.

To exploit this vulnerability, an attacker does not require access to an ACL token. The peering feature was introduced in Consul 1.13.0 as a beta feature. For more information on cluster peering, see the [documentation](https://developer.hashicorp.com/consul/docs/connect/cluster-peering).

**Remediation**

Customers, particularly those using the new cluster peering feature, should evaluate the risk associated with this issue and consider upgrading to Consul 1.14.0, or newer.

**Acknowledgement**

This issue was identified by the Consul engineering team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2023-15 - Consul Cluster Peering can Result in Denial of Service](https://discuss.hashicorp.com/t/hcsec-2023-15-consul-cluster-peering-can-result-in-denial-of-service/54515)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 6411 | June 2, 2023 |
| [HCSEC-2023-06 - Consul Server Panic when Ingress and API Gateways Configured with Peering Connections](https://discuss.hashicorp.com/t/hcsec-2023-06-consul-server-panic-when-ingress-and-api-gateways-configured-with-peering-connections/51197)  [Security](/c/security/52) | 0 | 5700 | March 9, 2023 |
| [HCSEC-2022-07 - Consul’s Connect Service Mesh Affected By Recent Envoy Security Releases](https://discuss.hashicorp.com/t/hcsec-2022-07-consul-s-connect-service-mesh-affected-by-recent-envoy-security-releases/36332)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 4784 | March 1, 2022 |
| [HCSEC-2021-24 - Consul Missing Authorization Check on Txn.Apply Endpoint](https://discuss.hashicorp.com/t/hcsec-2021-24-consul-missing-authorization-check-on-txn-apply-endpoint/29026)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 7715 | September 1, 2021 |
| [HCSEC-2020-04 - Consul's Health Check API Endpoints May Disclose Information](https://discuss.hashicorp.com/t/hcsec-2020-04-consuls-health-check-api-endpoints-may-disclose-information/18087)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 4182 | November 25, 2020 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

