
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmpdavis%2Fpython-jose%2Fissues%2F344)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmpdavis%2Fpython-jose%2Fissues%2F344)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=mpdavis%2Fpython-jose)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mpdavis](/mpdavis)
/
**[python-jose](/mpdavis/python-jose)**
Public

* [Notifications](/login?return_to=%2Fmpdavis%2Fpython-jose) You must be signed in to change notification settings
* [Fork
  238](/login?return_to=%2Fmpdavis%2Fpython-jose)
* [Star
   1.6k](/login?return_to=%2Fmpdavis%2Fpython-jose)

* [Code](/mpdavis/python-jose)
* [Issues
  81](/mpdavis/python-jose/issues)
* [Pull requests
  23](/mpdavis/python-jose/pulls)
* [Actions](/mpdavis/python-jose/actions)
* [Projects
  0](/mpdavis/python-jose/projects)
* [Wiki](/mpdavis/python-jose/wiki)
* [Security](/mpdavis/python-jose/security)
* [Insights](/mpdavis/python-jose/pulse)

Additional navigation options

* [Code](/mpdavis/python-jose)
* [Issues](/mpdavis/python-jose/issues)
* [Pull requests](/mpdavis/python-jose/pulls)
* [Actions](/mpdavis/python-jose/actions)
* [Projects](/mpdavis/python-jose/projects)
* [Wiki](/mpdavis/python-jose/wiki)
* [Security](/mpdavis/python-jose/security)
* [Insights](/mpdavis/python-jose/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmpdavis%2Fpython-jose%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmpdavis%2Fpython-jose%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [Vuln] JWT bomb Attack in decode function #344

Open

[P3ngu1nW](/P3ngu1nW) opened this issue
Mar 11, 2024
¬∑ 11 comments

Open

# [[Vuln] JWT bomb Attack in decode function](#top) #344

[P3ngu1nW](/P3ngu1nW) opened this issue
Mar 11, 2024
¬∑ 11 comments

## Comments

[![@P3ngu1nW](https://avatars.githubusercontent.com/u/133195620?s=80&u=6168f9c868c2c2273f11d244655715e9bccaf6f9&v=4)](/P3ngu1nW)

Copy link

### **[P3ngu1nW](/P3ngu1nW)** commented [Mar 11, 2024](#issue-2178333080)

| JWT bomb Attack in decode function0x01 Affected version vendor: <https://github.com/mpdavis/python-jose>  version: 3.3.0 0x02 What kind of vulnerability is it? Who is impacted? This vulnerability allows an attacker to cause a Denial-of-Service (DoS) condition by crafting a malicious JSON Web Encryption (JWE) token with an exceptionally high compression ratio. When this token is processed by the server, it results in significant memory allocation and processing time during decompression. 0x03 Vulnerability details The Proof of Concept (PoC) below demonstrates how this vulnerability can lead to a DoS attack:  ``` from jose import jwe  import time  s = '{"u": "' + "u" * 40000000 + '", "uu":"' + "u" * 40000000 + '"}'  print(len(s))  v1 = jwe.encrypt(s, b'asecret128bitkey', algorithm='A128KW', zip='DEF', encryption='A128GCM')  print(len(v1))  begin = time.time()  jwe.decrypt(v1, b'asecret128bitkey')  print(time.time() - begin)  s = '{"u": "' + "u" * 40000 + '", "uu":"' + "u" * 40000 + '"}'  v2 = jwe.encrypt(s, b'asecret128bitkey', algorithm='A128KW', encryption='A128GCM')  begin = time.time()  print(len(v2))  jwe.decrypt(v2, b'asecret128bitkey')  print(time.time() - begin) ```  This vulnerability is demonstrated by comparing the processing times of a compressed token to an uncompressed token of the same length. The compressed token's processing time is significantly higher, showcasing the vulnerability's potential impact. 0x04 Mitigation To mitigate this vulnerability, it is recommended to limit the maximum token length to 250K. This approach has also been adopted by the JWT library System.IdentityModel.Tokens.Jwt used in Microsoft Azure [1], effectively preventing attackers from exploiting this vulnerability with high compression ratio tokens. 0x05 References [1] [CVE-2024-21319](https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet/security/advisories/GHSA-8g9c-28fc-mcx2) |
| --- |
| The text was updated successfully, but these errors were encountered: |

 üëç
1
 joeygrable94 reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[![@princekhunt](https://avatars.githubusercontent.com/u/63849074?s=80&u=a5f38d81d38abe79369459fdb6a2ba2dfd8940f3&v=4)](/princekhunt)

Copy link

### **[princekhunt](/princekhunt)** commented [Mar 20, 2024](#issuecomment-2010051279)

| Hello [@P3ngu1nW](https://github.com/P3ngu1nW)  I'm fairly new to this field, so please bear with me. I've been trying to understand this issue and have read up on the JWT bomb attack.  To tackle it, do we simply need to cap the token size at 250K? If so, I've made the necessary changes in the decrypt function of my forked repository. Could you please review it and let me know if there's anything else required?  [Check the update](https://github.com/princekhunt/python-jose/blob/483529ee93a3ab510ab579d4d4cc644dba926ade/jose/jwe.py#L81)  Thank You, Prince |
| --- |

All reactions

Sorry, something went wrong.

[![@P3ngu1nW](https://avatars.githubusercontent.com/u/133195620?s=80&u=6168f9c868c2c2273f11d244655715e9bccaf6f9&v=4)](/P3ngu1nW)

Copy link

Author

### **[P3ngu1nW](/P3ngu1nW)** commented [Mar 29, 2024](#issuecomment-2026641713)

| Hi! I think that's reasonable. Thank you! |
| --- |

All reactions

Sorry, something went wrong.

[![@princekhunt](https://avatars.githubusercontent.com/u/63849074?s=80&u=a5f38d81d38abe79369459fdb6a2ba2dfd8940f3&v=4)](/princekhunt)

Copy link

### **[princekhunt](/princekhunt)** commented [Mar 31, 2024](#issuecomment-2028584426)

| Hello,  Thanks for the confirmation!. Created PR [#345](https://github.com/mpdavis/python-jose/pull/345) |
| --- |

All reactions

Sorry, something went wrong.

[![@smittysmee](https://avatars.githubusercontent.com/u/8376011?s=80&u=8637f4b6730b20494bf3c0fead6a5d86d9b01485&v=4)](/smittysmee)

Copy link

### **[smittysmee](/smittysmee)** commented [Apr 29, 2024](#issuecomment-2082990017)

| Following up on this. |
| --- |

All reactions

Sorry, something went wrong.

[![@alistairwatts](https://avatars.githubusercontent.com/u/7370644?s=80&v=4)](/alistairwatts)

Copy link

### **[alistairwatts](/alistairwatts)** commented [May 7, 2024](#issuecomment-2098486704)

| I've created a more comprehensive pull request which includes tests: [#352](https://github.com/mpdavis/python-jose/pull/352) |
| --- |

 üëç
1
 smittysmee reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@stigtsp](https://avatars.githubusercontent.com/u/75371?s=80&u=07f2c9eaa4df07b236648c9ccd97a951735fb8d2&v=4)](/stigtsp)

Copy link

### **[stigtsp](/stigtsp)** commented [May 7, 2024](#issuecomment-2099240251)

| This is [CVE-2024-33664](https://github.com/advisories/GHSA-cjwg-qfpm-7377 "CVE-2024-33664") |
| --- |

All reactions

Sorry, something went wrong.

[![@stigtsp](https://avatars.githubusercontent.com/u/75371?s=40&u=07f2c9eaa4df07b236648c9ccd97a951735fb8d2&v=4)](/stigtsp)
[stigtsp](/stigtsp)
mentioned this issue
[May 7, 2024](#ref-pullrequest-2284255709)

[python3Packages.python-jose: Add patches for CVE-2024-33663 and CVE-2024-33664
NixOS/nixpkgs#309943](/NixOS/nixpkgs/pull/309943)
 Merged

13 tasks

[![@heidemn-faro](https://avatars.githubusercontent.com/u/66078329?s=80&u=44e370564221a2beaaa2a56db23d05ee1520569f&v=4)](/heidemn-faro)

Copy link

### **[heidemn-faro](/heidemn-faro)** commented [May 8, 2024](#issuecomment-2099887821)

| [@P3ngu1nW](https://github.com/P3ngu1nW) or [@alistairwatts](https://github.com/alistairwatts), thanks for reporting this CVE. It seems to be specific to tokens with compression. If I know that for my application, all valid tokens are uncompressed, is there a way how I could disable compression support in python-jose?  I also don't quite understand which functions of the library are affected:   * Issue title: "JWT bomb Attack in decode function" -> do you mean `jwt.decode()`? * Your example code is using `jwe.decrypt()`. * Is `jwt.decode()` affected or not?   Your description has a section "Who is impacted?", which is a good idea, but unfortunately does not contain enough information for non-crypto-experts to determine if their library usage is safe regarding this CVE or not. |
| --- |

 üëç
1
 leahein reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@alistairwatts](https://avatars.githubusercontent.com/u/7370644?s=80&v=4)](/alistairwatts)

Copy link

### **[alistairwatts](/alistairwatts)** commented [May 8, 2024](#issuecomment-2100534807) ‚Ä¢ edited Loading

| [@heidemn-faro](https://github.com/heidemn-faro), if your application is not supporting encrypted tokens, then it doesn't look like the vulnerability affects you. You should be fine if you're not using `jose.jwe`, but please check this for yourself. If you wanted to be sure that this vulnerability doesn't affect your application then you could consider removing `jwe.py` from the `jose` package and checking your application is unaffected.  If `jose.jwe` is used then the following will monkey-patch the library and remove support for the `DEF` compression.  ``` import jose.constants jose.constants.ZIPS.SUPPORTED.discard('DEF') ``` |
| --- |

 ‚ù§Ô∏è
3
 heidemn-faro, leahein, and calvincs reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  3 reactions

Sorry, something went wrong.

[![@lukehsiao](https://avatars.githubusercontent.com/u/7573542?s=40&v=4)](/lukehsiao)
[lukehsiao](/lukehsiao)
mentioned this issue
[May 17, 2024](#ref-issue-2058590869)

[Dependency python-Jose appears to be unmaintained
okta/okta-jwt-verifier-python#54](/okta/okta-jwt-verifier-python/issues/54)

Closed

[![@gitjkesslergs](https://avatars.githubusercontent.com/u/84694017?s=80&v=4)](/gitjkesslergs)

Copy link

### **[gitjkesslergs](/gitjkesslergs)** commented [May 31, 2024](#issuecomment-2142533979)

| There are patch files that need to be added into this repo: [https://build.opensuse.org/projects/openSUSE:Factory/packages/python-python-jose/files/CVE-2024-33663.patch](https://build.opensuse.org/projects/openSUSE%3AFactory/packages/python-python-jose/files/CVE-2024-33663.patch) and [https://build.opensuse.org/projects/openSUSE:Factory/packages/python-python-jose/files/CVE-2024-33664.patch](https://build.opensuse.org/projects/openSUSE%3AFactory/packages/python-python-jose/files/CVE-2024-33664.patch) |
| --- |

All reactions

Sorry, something went wrong.

[![@P3ngu1nW](https://avatars.githubusercontent.com/u/133195620?s=40&u=6168f9c868c2c2273f11d244655715e9bccaf6f9&v=4)](/P3ngu1nW)
[P3ngu1nW](/P3ngu1nW)
closed this as [completed](/mpdavis/python-jose/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jul 1, 2024](#event-13345838623)

[![@heidemn-faro](https://avatars.githubusercontent.com/u/66078329?s=80&u=44e370564221a2beaaa2a56db23d05ee1520569f&v=4)](/heidemn-faro)

Copy link

### **[heidemn-faro](/heidemn-faro)** commented [Jul 1, 2024](#issuecomment-2199377395)

| [@P3ngu1nW](https://github.com/P3ngu1nW) please help me understand why you've closed the ticket? I don't see any related commit on the master branch. |
| --- |

All reactions

Sorry, something went wrong.

[![@P3ngu1nW](https://avatars.githubusercontent.com/u/133195620?s=80&u=6168f9c868c2c2273f11d244655715e9bccaf6f9&v=4)](/P3ngu1nW)

Copy link

Author

### **[P3ngu1nW](/P3ngu1nW)** commented [Jul 1, 2024](#issuecomment-2199383415)

| [@P3ngu1nW](https://github.com/P3ngu1nW) please help me understand why you've closed the ticket? I don't see any related commit on the master branch.  I saw [@gitjkesslergs](https://github.com/gitjkesslergs) mentioned a fix for this |
| --- |

All reactions

Sorry, something went wrong.

[![@P3ngu1nW](https://avatars.githubusercontent.com/u/133195620?s=40&u=6168f9c868c2c2273f11d244655715e9bccaf6f9&v=4)](/P3ngu1nW)
[P3ngu1nW](/P3ngu1nW)
reopened this
[Jul 1, 2024](#event-13346210697)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmpdavis%2Fpython-jose%2Fissues%2F344)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

7 participants

[![@stigtsp](https://avatars.githubusercontent.com/u/75371?s=52&v=4)](/stigtsp) [![@alistairwatts](https://avatars.githubusercontent.com/u/7370644?s=52&v=4)](/alistairwatts) [![@smittysmee](https://avatars.githubusercontent.com/u/8376011?s=52&v=4)](/smittysmee) [![@princekhunt](https://avatars.githubusercontent.com/u/63849074?s=52&v=4)](/princekhunt) [![@heidemn-faro](https://avatars.githubusercontent.com/u/66078329?s=52&v=4)](/heidemn-faro) [![@gitjkesslergs](https://avatars.githubusercontent.com/u/84694017?s=52&v=4)](/gitjkesslergs) [![@P3ngu1nW](https://avatars.githubusercontent.com/u/133195620?s=52&v=4)](/P3ngu1nW)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.

