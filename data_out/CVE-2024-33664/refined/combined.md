=== Content from github.com_65f5096e_20250111_142145.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmpdavis%2Fpython-jose%2Fpull%2F345)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmpdavis%2Fpython-jose%2Fpull%2F345)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=mpdavis%2Fpython-jose)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mpdavis](/mpdavis)
/
**[python-jose](/mpdavis/python-jose)**
Public

* [Notifications](/login?return_to=%2Fmpdavis%2Fpython-jose) You must be signed in to change notification settings
* [Fork
  238](/login?return_to=%2Fmpdavis%2Fpython-jose)
* [Star
   1.6k](/login?return_to=%2Fmpdavis%2Fpython-jose)

* [Code](/mpdavis/python-jose)
* [Issues
  81](/mpdavis/python-jose/issues)
* [Pull requests
  23](/mpdavis/python-jose/pulls)
* [Actions](/mpdavis/python-jose/actions)
* [Projects
  0](/mpdavis/python-jose/projects)
* [Wiki](/mpdavis/python-jose/wiki)
* [Security](/mpdavis/python-jose/security)
* [Insights](/mpdavis/python-jose/pulse)

Additional navigation options

* [Code](/mpdavis/python-jose)
* [Issues](/mpdavis/python-jose/issues)
* [Pull requests](/mpdavis/python-jose/pulls)
* [Actions](/mpdavis/python-jose/actions)
* [Projects](/mpdavis/python-jose/projects)
* [Wiki](/mpdavis/python-jose/wiki)
* [Security](/mpdavis/python-jose/security)
* [Insights](/mpdavis/python-jose/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmpdavis%2Fpython-jose%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmpdavis%2Fpython-jose%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Limit token size to 250 KB #345

 Closed

[princekhunt](/princekhunt)
wants to merge
1
commit into
[mpdavis:master](/mpdavis/python-jose/tree/master "mpdavis/python-jose:master")
from
[princekhunt:master](/princekhunt/python-jose/tree/master "princekhunt/python-jose:master")

 Closed

# [Limit token size to 250 KB](#top) #345

[princekhunt](/princekhunt)
wants to merge
1
commit into
[mpdavis:master](/mpdavis/python-jose/tree/master "mpdavis/python-jose:master")
from
[princekhunt:master](/princekhunt/python-jose/tree/master "princekhunt/python-jose:master")

[Conversation
7](/mpdavis/python-jose/pull/345)
[Commits
1](/mpdavis/python-jose/pull/345/commits)
[Checks
0](/mpdavis/python-jose/pull/345/checks)
[Files changed](/mpdavis/python-jose/pull/345/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![princekhunt](https://avatars.githubusercontent.com/u/63849074?s=60&v=4)](/princekhunt)

Copy link

### @princekhunt **[princekhunt](/princekhunt)** commented [Mar 31, 2024](#issue-2216821994)

 *No description provided.*

Sorry, something went wrong.

 üëç
1
 joeygrable94 reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[![@princekhunt](https://avatars.githubusercontent.com/u/63849074?s=40&v=4)](/princekhunt)

`[limit token size to 250 KB](/mpdavis/python-jose/pull/345/commits/483529ee93a3ab510ab579d4d4cc644dba926ade "limit token size to 250 KB")`

`[483529e](/mpdavis/python-jose/pull/345/commits/483529ee93a3ab510ab579d4d4cc644dba926ade)`

[![@princekhunt](https://avatars.githubusercontent.com/u/63849074?s=40&u=a5f38d81d38abe79369459fdb6a2ba2dfd8940f3&v=4)](/princekhunt)
[princekhunt](/princekhunt)
mentioned this pull request
[Mar 31, 2024](#ref-issue-2178333080)

[[Vuln] JWT bomb Attack in decode function
#344](/mpdavis/python-jose/issues/344)

Open

[![@smittysmee](https://avatars.githubusercontent.com/u/8376011?s=80&u=8637f4b6730b20494bf3c0fead6a5d86d9b01485&v=4)](/smittysmee)

Copy link

### **[smittysmee](/smittysmee)** commented [Apr 29, 2024](#issuecomment-2082988832)

| Bump on this |
| --- |

 üëç
1
 dong-li-plutoflume reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![smittysmee](https://avatars.githubusercontent.com/u/8376011?s=60&v=4)](/smittysmee)

**[smittysmee](/smittysmee)**
reviewed
[May 2, 2024](#pullrequestreview-2036177873)

 [View reviewed changes](/mpdavis/python-jose/pull/345/files/483529ee93a3ab510ab579d4d4cc644dba926ade)

[jose/jwe.py](/mpdavis/python-jose/pull/345/files/483529ee93a3ab510ab579d4d4cc644dba926ade#diff-32dbf930b9c6a76beffc707a79e5ea59d37b0beb8db3594e922747433f9308d5)

|  |  | @@ -76,6 +76,11 @@ def decrypt(jwe\_str, key): | |
| --- | --- | --- | --- |
|  |  | >>> jwe.decrypt(jwe\_string, 'asecret128bitkey') |
|  |  | 'Hello, World!' |
|  |  | """ |
|  |  |  |
|  |  | # limit the token size to 250 KB |

Copy link

### @smittysmee **[smittysmee](/smittysmee)** [May 2, 2024](#discussion_r1587886617)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Suggested change

|  | # limit the token size to 250 KB |
| --- | --- |
|  | # limit the token size to 250 KB - when this token is processed by the server, it results in significant memory allocation and processing time during decompression. |

Sorry, something went wrong.

All reactions

[bmwiedemann](/bmwiedemann)
pushed a commit
to bmwiedemann/openSUSE
that referenced
this pull request
[May 6, 2024](#ref-commit-fb0ad57)
[![@bmwiedemann](https://avatars.githubusercontent.com/u/637990?s=40&v=4)](/bmwiedemann)

`[Update python-python-jose to version 3.3.0 / rev 7 via SR 1172135](/bmwiedemann/openSUSE/commit/fb0ad57dcb75ecb12fac30e7556497c2b2f1c8dc "Update python-python-jose to version 3.3.0 / rev 7 via SR 1172135

https://build.opensuse.org/request/show/1172135
by user dgarcia + anag+factory
- Add upstream patches:
   * CVE-2024-33663.patch, bsc#1223417, gh#mpdavis/python-jose#349
   * CVE-2024-33664.patch, bsc#1223422, gh#mpdavis/python-jose#345
   * fix-tests-ecdsa-019.patch, gh#mpdavis/python-jose#350")`
‚Ä¶

`[fb0ad57](/bmwiedemann/openSUSE/commit/fb0ad57dcb75ecb12fac30e7556497c2b2f1c8dc)`

```
<https://build.opensuse.org/request/show/1172135>
by user dgarcia + anag+factory
- Add upstream patches:
   * [CVE-2024-33663](https://github.com/advisories/GHSA-6c5p-j8vq-pqhj "CVE-2024-33663").patch, bsc#1223417, gh#[mpdavis/python-jose#349](https://github.com/mpdavis/python-jose/pull/349)
   * [CVE-2024-33664](https://github.com/advisories/GHSA-cjwg-qfpm-7377 "CVE-2024-33664").patch, bsc#1223422, gh#[mpdavis/python-jose#345](https://github.com/mpdavis/python-jose/pull/345)
   * fix-tests-ecdsa-019.patch, gh#[mpdavis/python-jose#350](https://github.com/mpdavis/python-jose/pull/350)
```

[![@alistairwatts](https://avatars.githubusercontent.com/u/7370644?s=80&v=4)](/alistairwatts)

Copy link

### **[alistairwatts](/alistairwatts)** commented [May 7, 2024](#issuecomment-2097762814)

| Unfortunately the proposed fix just checks that the incoming uncompressed data is no more than than 250KB. I don't know what the maximum size a maliciously crafted 250KB token could expand to, but I imagine it could be significant. Some basic tests suggest that a 250KB token can expand to about 250MB.  In addition to sensibly checking the size of the compressed token, I would suggest changing the `decompress` function in `jwe.py` to use the `decompress` method on an instance of `zlib.Decompress`. The `decompress` method accepts a `max_length` which can limit the size of the decompressed data. |
| --- |

 üëç
1
 princekhunt reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@smittysmee](https://avatars.githubusercontent.com/u/8376011?s=80&u=8637f4b6730b20494bf3c0fead6a5d86d9b01485&v=4)](/smittysmee)

Copy link

### **[smittysmee](/smittysmee)** commented [May 21, 2024](#issuecomment-2123267993)

| [@princekhunt](https://github.com/princekhunt) see above ‚òùÔ∏è |
| --- |

 üëç
1
 princekhunt reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@alistairwatts](https://avatars.githubusercontent.com/u/7370644?s=80&v=4)](/alistairwatts)

Copy link

### **[alistairwatts](/alistairwatts)** commented [May 21, 2024](#issuecomment-2123431416)

| I've already opened a pull request for a more robust fix. See [#352](https://github.com/mpdavis/python-jose/pull/352) |
| --- |

 ‚ù§Ô∏è
1
 princekhunt reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  1 reaction

Sorry, something went wrong.

[![@smittysmee](https://avatars.githubusercontent.com/u/8376011?s=80&u=8637f4b6730b20494bf3c0fead6a5d86d9b01485&v=4)](/smittysmee)

Copy link

### **[smittysmee](/smittysmee)** commented [May 21, 2024](#issuecomment-2123471827)

| üëå |
| --- |

All reactions

Sorry, something went wrong.

[![@twwildey](https://avatars.githubusercontent.com/u/43767290?s=80&v=4)](/twwildey)

Copy link

Collaborator

### **[twwildey](/twwildey)** commented [May 30, 2024](#issuecomment-2141018402)

| This appears duplicative to [#352](https://github.com/mpdavis/python-jose/pull/352) - I will close this in favor of the other PR. |
| --- |

All reactions

Sorry, something went wrong.

[![@twwildey](https://avatars.githubusercontent.com/u/43767290?s=40&v=4)](/twwildey)
[twwildey](/twwildey)
closed this
[May 30, 2024](#event-12992950171)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmpdavis%2Fpython-jose%2Fpull%2F345)

Reviewers

[![@smittysmee](https://avatars.githubusercontent.com/u/8376011?s=40&v=4)](/smittysmee) [smittysmee](/smittysmee)

smittysmee left review comments

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@princekhunt](https://avatars.githubusercontent.com/u/63849074?s=52&v=4)](/princekhunt) [![@smittysmee](https://avatars.githubusercontent.com/u/8376011?s=52&v=4)](/smittysmee) [![@alistairwatts](https://avatars.githubusercontent.com/u/7370644?s=52&v=4)](/alistairwatts) [![@twwildey](https://avatars.githubusercontent.com/u/43767290?s=52&v=4)](/twwildey)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_e7ea941b_20250111_142144.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmpdavis%2Fpython-jose%2Fissues%2F344)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmpdavis%2Fpython-jose%2Fissues%2F344)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=mpdavis%2Fpython-jose)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mpdavis](/mpdavis)
/
**[python-jose](/mpdavis/python-jose)**
Public

* [Notifications](/login?return_to=%2Fmpdavis%2Fpython-jose) You must be signed in to change notification settings
* [Fork
  238](/login?return_to=%2Fmpdavis%2Fpython-jose)
* [Star
   1.6k](/login?return_to=%2Fmpdavis%2Fpython-jose)

* [Code](/mpdavis/python-jose)
* [Issues
  81](/mpdavis/python-jose/issues)
* [Pull requests
  23](/mpdavis/python-jose/pulls)
* [Actions](/mpdavis/python-jose/actions)
* [Projects
  0](/mpdavis/python-jose/projects)
* [Wiki](/mpdavis/python-jose/wiki)
* [Security](/mpdavis/python-jose/security)
* [Insights](/mpdavis/python-jose/pulse)

Additional navigation options

* [Code](/mpdavis/python-jose)
* [Issues](/mpdavis/python-jose/issues)
* [Pull requests](/mpdavis/python-jose/pulls)
* [Actions](/mpdavis/python-jose/actions)
* [Projects](/mpdavis/python-jose/projects)
* [Wiki](/mpdavis/python-jose/wiki)
* [Security](/mpdavis/python-jose/security)
* [Insights](/mpdavis/python-jose/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmpdavis%2Fpython-jose%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmpdavis%2Fpython-jose%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [Vuln] JWT bomb Attack in decode function #344

Open

[P3ngu1nW](/P3ngu1nW) opened this issue
Mar 11, 2024
¬∑ 11 comments

Open

# [[Vuln] JWT bomb Attack in decode function](#top) #344

[P3ngu1nW](/P3ngu1nW) opened this issue
Mar 11, 2024
¬∑ 11 comments

## Comments

[![@P3ngu1nW](https://avatars.githubusercontent.com/u/133195620?s=80&u=6168f9c868c2c2273f11d244655715e9bccaf6f9&v=4)](/P3ngu1nW)

Copy link

### **[P3ngu1nW](/P3ngu1nW)** commented [Mar 11, 2024](#issue-2178333080)

| JWT bomb Attack in decode function0x01 Affected version vendor: <https://github.com/mpdavis/python-jose>  version: 3.3.0 0x02 What kind of vulnerability is it? Who is impacted? This vulnerability allows an attacker to cause a Denial-of-Service (DoS) condition by crafting a malicious JSON Web Encryption (JWE) token with an exceptionally high compression ratio. When this token is processed by the server, it results in significant memory allocation and processing time during decompression. 0x03 Vulnerability details The Proof of Concept (PoC) below demonstrates how this vulnerability can lead to a DoS attack:  ``` from jose import jwe  import time  s = '{"u": "' + "u" * 40000000 + '", "uu":"' + "u" * 40000000 + '"}'  print(len(s))  v1 = jwe.encrypt(s, b'asecret128bitkey', algorithm='A128KW', zip='DEF', encryption='A128GCM')  print(len(v1))  begin = time.time()  jwe.decrypt(v1, b'asecret128bitkey')  print(time.time() - begin)  s = '{"u": "' + "u" * 40000 + '", "uu":"' + "u" * 40000 + '"}'  v2 = jwe.encrypt(s, b'asecret128bitkey', algorithm='A128KW', encryption='A128GCM')  begin = time.time()  print(len(v2))  jwe.decrypt(v2, b'asecret128bitkey')  print(time.time() - begin) ```  This vulnerability is demonstrated by comparing the processing times of a compressed token to an uncompressed token of the same length. The compressed token's processing time is significantly higher, showcasing the vulnerability's potential impact. 0x04 Mitigation To mitigate this vulnerability, it is recommended to limit the maximum token length to 250K. This approach has also been adopted by the JWT library System.IdentityModel.Tokens.Jwt used in Microsoft Azure [1], effectively preventing attackers from exploiting this vulnerability with high compression ratio tokens. 0x05 References [1] [CVE-2024-21319](https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet/security/advisories/GHSA-8g9c-28fc-mcx2) |
| --- |
| The text was updated successfully, but these errors were encountered: |

 üëç
1
 joeygrable94 reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[![@princekhunt](https://avatars.githubusercontent.com/u/63849074?s=80&u=a5f38d81d38abe79369459fdb6a2ba2dfd8940f3&v=4)](/princekhunt)

Copy link

### **[princekhunt](/princekhunt)** commented [Mar 20, 2024](#issuecomment-2010051279)

| Hello [@P3ngu1nW](https://github.com/P3ngu1nW)  I'm fairly new to this field, so please bear with me. I've been trying to understand this issue and have read up on the JWT bomb attack.  To tackle it, do we simply need to cap the token size at 250K? If so, I've made the necessary changes in the decrypt function of my forked repository. Could you please review it and let me know if there's anything else required?  [Check the update](https://github.com/princekhunt/python-jose/blob/483529ee93a3ab510ab579d4d4cc644dba926ade/jose/jwe.py#L81)  Thank You, Prince |
| --- |

All reactions

Sorry, something went wrong.

[![@P3ngu1nW](https://avatars.githubusercontent.com/u/133195620?s=80&u=6168f9c868c2c2273f11d244655715e9bccaf6f9&v=4)](/P3ngu1nW)

Copy link

Author

### **[P3ngu1nW](/P3ngu1nW)** commented [Mar 29, 2024](#issuecomment-2026641713)

| Hi! I think that's reasonable. Thank you! |
| --- |

All reactions

Sorry, something went wrong.

[![@princekhunt](https://avatars.githubusercontent.com/u/63849074?s=80&u=a5f38d81d38abe79369459fdb6a2ba2dfd8940f3&v=4)](/princekhunt)

Copy link

### **[princekhunt](/princekhunt)** commented [Mar 31, 2024](#issuecomment-2028584426)

| Hello,  Thanks for the confirmation!. Created PR [#345](https://github.com/mpdavis/python-jose/pull/345) |
| --- |

All reactions

Sorry, something went wrong.

[![@smittysmee](https://avatars.githubusercontent.com/u/8376011?s=80&u=8637f4b6730b20494bf3c0fead6a5d86d9b01485&v=4)](/smittysmee)

Copy link

### **[smittysmee](/smittysmee)** commented [Apr 29, 2024](#issuecomment-2082990017)

| Following up on this. |
| --- |

All reactions

Sorry, something went wrong.

[![@alistairwatts](https://avatars.githubusercontent.com/u/7370644?s=80&v=4)](/alistairwatts)

Copy link

### **[alistairwatts](/alistairwatts)** commented [May 7, 2024](#issuecomment-2098486704)

| I've created a more comprehensive pull request which includes tests: [#352](https://github.com/mpdavis/python-jose/pull/352) |
| --- |

 üëç
1
 smittysmee reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@stigtsp](https://avatars.githubusercontent.com/u/75371?s=80&u=07f2c9eaa4df07b236648c9ccd97a951735fb8d2&v=4)](/stigtsp)

Copy link

### **[stigtsp](/stigtsp)** commented [May 7, 2024](#issuecomment-2099240251)

| This is [CVE-2024-33664](https://github.com/advisories/GHSA-cjwg-qfpm-7377 "CVE-2024-33664") |
| --- |

All reactions

Sorry, something went wrong.

[![@stigtsp](https://avatars.githubusercontent.com/u/75371?s=40&u=07f2c9eaa4df07b236648c9ccd97a951735fb8d2&v=4)](/stigtsp)
[stigtsp](/stigtsp)
mentioned this issue
[May 7, 2024](#ref-pullrequest-2284255709)

[python3Packages.python-jose: Add patches for CVE-2024-33663 and CVE-2024-33664
NixOS/nixpkgs#309943](/NixOS/nixpkgs/pull/309943)
 Merged

13 tasks

[![@heidemn-faro](https://avatars.githubusercontent.com/u/66078329?s=80&u=44e370564221a2beaaa2a56db23d05ee1520569f&v=4)](/heidemn-faro)

Copy link

### **[heidemn-faro](/heidemn-faro)** commented [May 8, 2024](#issuecomment-2099887821)

| [@P3ngu1nW](https://github.com/P3ngu1nW) or [@alistairwatts](https://github.com/alistairwatts), thanks for reporting this CVE. It seems to be specific to tokens with compression. If I know that for my application, all valid tokens are uncompressed, is there a way how I could disable compression support in python-jose?  I also don't quite understand which functions of the library are affected:   * Issue title: "JWT bomb Attack in decode function" -> do you mean `jwt.decode()`? * Your example code is using `jwe.decrypt()`. * Is `jwt.decode()` affected or not?   Your description has a section "Who is impacted?", which is a good idea, but unfortunately does not contain enough information for non-crypto-experts to determine if their library usage is safe regarding this CVE or not. |
| --- |

 üëç
1
 leahein reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@alistairwatts](https://avatars.githubusercontent.com/u/7370644?s=80&v=4)](/alistairwatts)

Copy link

### **[alistairwatts](/alistairwatts)** commented [May 8, 2024](#issuecomment-2100534807) ‚Ä¢ edited Loading

| [@heidemn-faro](https://github.com/heidemn-faro), if your application is not supporting encrypted tokens, then it doesn't look like the vulnerability affects you. You should be fine if you're not using `jose.jwe`, but please check this for yourself. If you wanted to be sure that this vulnerability doesn't affect your application then you could consider removing `jwe.py` from the `jose` package and checking your application is unaffected.  If `jose.jwe` is used then the following will monkey-patch the library and remove support for the `DEF` compression.  ``` import jose.constants jose.constants.ZIPS.SUPPORTED.discard('DEF') ``` |
| --- |

 ‚ù§Ô∏è
3
 heidemn-faro, leahein, and calvincs reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  3 reactions

Sorry, something went wrong.

[![@lukehsiao](https://avatars.githubusercontent.com/u/7573542?s=40&v=4)](/lukehsiao)
[lukehsiao](/lukehsiao)
mentioned this issue
[May 17, 2024](#ref-issue-2058590869)

[Dependency python-Jose appears to be unmaintained
okta/okta-jwt-verifier-python#54](/okta/okta-jwt-verifier-python/issues/54)

Closed

[![@gitjkesslergs](https://avatars.githubusercontent.com/u/84694017?s=80&v=4)](/gitjkesslergs)

Copy link

### **[gitjkesslergs](/gitjkesslergs)** commented [May 31, 2024](#issuecomment-2142533979)

| There are patch files that need to be added into this repo: [https://build.opensuse.org/projects/openSUSE:Factory/packages/python-python-jose/files/CVE-2024-33663.patch](https://build.opensuse.org/projects/openSUSE%3AFactory/packages/python-python-jose/files/CVE-2024-33663.patch) and [https://build.opensuse.org/projects/openSUSE:Factory/packages/python-python-jose/files/CVE-2024-33664.patch](https://build.opensuse.org/projects/openSUSE%3AFactory/packages/python-python-jose/files/CVE-2024-33664.patch) |
| --- |

All reactions

Sorry, something went wrong.

[![@P3ngu1nW](https://avatars.githubusercontent.com/u/133195620?s=40&u=6168f9c868c2c2273f11d244655715e9bccaf6f9&v=4)](/P3ngu1nW)
[P3ngu1nW](/P3ngu1nW)
closed this as [completed](/mpdavis/python-jose/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jul 1, 2024](#event-13345838623)

[![@heidemn-faro](https://avatars.githubusercontent.com/u/66078329?s=80&u=44e370564221a2beaaa2a56db23d05ee1520569f&v=4)](/heidemn-faro)

Copy link

### **[heidemn-faro](/heidemn-faro)** commented [Jul 1, 2024](#issuecomment-2199377395)

| [@P3ngu1nW](https://github.com/P3ngu1nW) please help me understand why you've closed the ticket? I don't see any related commit on the master branch. |
| --- |

All reactions

Sorry, something went wrong.

[![@P3ngu1nW](https://avatars.githubusercontent.com/u/133195620?s=80&u=6168f9c868c2c2273f11d244655715e9bccaf6f9&v=4)](/P3ngu1nW)

Copy link

Author

### **[P3ngu1nW](/P3ngu1nW)** commented [Jul 1, 2024](#issuecomment-2199383415)

| [@P3ngu1nW](https://github.com/P3ngu1nW) please help me understand why you've closed the ticket? I don't see any related commit on the master branch.  I saw [@gitjkesslergs](https://github.com/gitjkesslergs) mentioned a fix for this |
| --- |

All reactions

Sorry, something went wrong.

[![@P3ngu1nW](https://avatars.githubusercontent.com/u/133195620?s=40&u=6168f9c868c2c2273f11d244655715e9bccaf6f9&v=4)](/P3ngu1nW)
[P3ngu1nW](/P3ngu1nW)
reopened this
[Jul 1, 2024](#event-13346210697)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmpdavis%2Fpython-jose%2Fissues%2F344)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

7 participants

[![@stigtsp](https://avatars.githubusercontent.com/u/75371?s=52&v=4)](/stigtsp) [![@alistairwatts](https://avatars.githubusercontent.com/u/7370644?s=52&v=4)](/alistairwatts) [![@smittysmee](https://avatars.githubusercontent.com/u/8376011?s=52&v=4)](/smittysmee) [![@princekhunt](https://avatars.githubusercontent.com/u/63849074?s=52&v=4)](/princekhunt) [![@heidemn-faro](https://avatars.githubusercontent.com/u/66078329?s=52&v=4)](/heidemn-faro) [![@gitjkesslergs](https://avatars.githubusercontent.com/u/84694017?s=52&v=4)](/gitjkesslergs) [![@P3ngu1nW](https://avatars.githubusercontent.com/u/133195620?s=52&v=4)](/P3ngu1nW)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from www.vicarius.io_2ba1f228_20250111_142146.html ===


 [about](/vsociety/about) [by vicarius](https://vicarius.io/) [log in](/vsociety/sign/in) [join community](/vsociety/sign/up)

* [scripts](/vsociety/posts)
* [CVEs](/vsociety/vulnerabilities)
* [apps](/vsociety/products)
* [OS](/vsociety/operating-systems)

 [by @Emmharnuherl](/vsociety/users/Emmharnuherl)01 Jul 2024010591#cve\_analysis

Write a blog analysis for a CVE

[publish](/vsociety/sign/in)see all related posts
# JWT Bomb in Python-JOSE (CVE-2024-33664)

 [by @Emmharnuherl](/vsociety/users/Emmharnuherl)01 [by @Emmharnuherl](/vsociety/users/Emmharnuherl)01 Jul 2024010591#cve\_analysis

Write a blog analysis for a CVE

[publish](/vsociety/sign/in)see all related posts
# JWT Bomb in Python-JOSE (CVE-2024-33664)

CVEs

[CVE-2024-33664](/vsociety/vulnerabilities/cve-2024-33664)5.3 Medium Severity
## PoC video

## Summary

Versions of Python-Jose up to and including version 3.3.0 are affected by the JWT bomb; a vulnerability that leads to denial of service in the system when exploited by an attacker. This analysis shows how this vulnerability can be exploited and mitigated in the vulnerable versions of Python-Jose.

## Description

Tags

[#python](/vsociety/search?hashtags=python)[#trending](/vsociety/search?hashtags=trending)[#cve-analysis](/vsociety/search?hashtags=cve-analysis)[#denial-of-service-attacks](/vsociety/search?hashtags=denial-of-service-attacks)[#python-jose](/vsociety/search?hashtags=python-jose)[#JWT-bomb](/vsociety/search?hashtags=jwt-bomb)[@Emmharnuherl](/vsociety/users/Emmharnuherl)

7 posts

subscribe to user

Total vcoins

9.8K

Social media links

Emeka Onyeagwazi 67aa811a7

show more

 remediate more CVEs with vRx  [explore more](https://www.vicarius.io/?utm_source=vsociety&utm_medium=organic&utm_campaign=cve_scripts%26analysis) Comments (0)submitshow 5 more replies[@Emmharnuherl](/vsociety/users/Emmharnuherl)

7 posts

subscribe to user

Total vcoins

9.8K

Share

Social media links

Emeka Onyeagwazi 67aa811a7

show more

CVEs

[CVE-2024-33664](/vsociety/vulnerabilities/cve-2024-33664)5.3 Medium Severity

Tags

[#python](/vsociety/search?hashtags=python)[#trending](/vsociety/search?hashtags=trending)[#cve-analysis](/vsociety/search?hashtags=cve-analysis)[#denial-of-service-attacks](/vsociety/search?hashtags=denial-of-service-attacks)[#python-jose](/vsociety/search?hashtags=python-jose)[#JWT-bomb](/vsociety/search?hashtags=jwt-bomb)

Democratizing infosec research for a more secure society. Be a part of the movement.

##### about

* [An Origin Story: vsociety](/vsociety/posts/an-origin-story-vsociety)
* [Frequently Asked Questions](/vsociety/faq)
##### be Part

* [Join Community](/vsociety/sign/up)
* [Login](/vsociety/sign/in)
##### legal

* [Privacy Policy](/vsociety/privacy-policy)
* [Terms of Use](/vsociety/terms)

Copyright ¬© Vicarius 2022. [Privacy Policy](https://www.vicarius.io/privacy) and [Terms of Use](/vsociety/terms)


