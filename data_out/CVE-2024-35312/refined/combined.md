=== Content from gitlab.torproject.org_7cdf0622_20250110_110427.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

# TROVE-2024-003: With lite vanguards, STUB circuits always have length 2

In [!2145 (comment 3030149)](https://gitlab.torproject.org/tpo/core/arti/-/merge_requests/2145#note_3030149 "tor-circmgr: If necessary, extend the circuit to become STUB+."), we spotted a bug where STUB circuits were never extended past the L2 vanguard. The problem was that [this condition](https://gitlab.torproject.org/tpo/core/arti/-/blob/main/crates/tor-circmgr/src/path/hspath.rs#L227-256) does not have an else branch (unless full vanguards are in use, the circuit is returned after adding an L2 vanguard, which is incorrect).

**EDIT**: This is also tracked as CVE-2024-35313.

Edited May 17, 2024 by [Nick Mathewson](/nickm)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


