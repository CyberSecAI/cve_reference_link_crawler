<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - Security sensitive bug in the i915 kernel driver (CVE-2022-4139)</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://twitter.com/openwall">
Follow @Openwall on Twitter for new release announcements and other news</a>

</TABLE>
</TABLE>

<a href="../../../2022/11/29/4">[&lt;prev]</a> <a href="2">[next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;c9089e54-bc0d-773c-233e-d63980ad49d4&#64;intel.com&gt;
Date: Wed, 30 Nov 2022 11:22:16 +0100
From: Andrzej Hajda &lt;andrzej.hajda&#64;...el.com&gt;
To: oss-security&#64;...ts.openwall.com
Cc: Daniel Vetter &lt;daniel&#64;...ll.ch&gt;, Dave Airlie &lt;airlied&#64;...il.com&gt;,
 Joonas Lahtinen &lt;joonas.lahtinen&#64;...ux.intel.com&gt;,
 Jani Nikula &lt;jani.nikula&#64;...ux.intel.com&gt;,
 Tvrtko Ursulin &lt;tvrtko.ursulin&#64;...ux.intel.com&gt;,
 Linus Torvalds &lt;torvalds&#64;...ux-foundation.org&gt;,
 Marian Rehak &lt;mrehak&#64;...hat.com&gt;,
 Greg Kroah-Hartman &lt;gregkh&#64;...uxfoundation.org&gt;,
 Vegard Nossum &lt;vegard.nossum&#64;...cle.com&gt;
Subject: Security sensitive bug in the i915 kernel driver (CVE-2022-4139)

Hi all,

[This is a public disclosure of an issue reported 7 days ago to 
linux-distros&#64;...openwall.org. CVE-2022-4139 has been assigned to the 
issue since.]

Incorrect GPU TLB flush code has been discovered in i915 kernel driver.
In some cases (Gen12 hardware with specific types of engine) the 
engine's TLB is not flushed at all.
Depending on whether the GPU is running behindÂ an active IOMMU there are 
two possible scenarios which can happen, due to stale TLB mapping:
1. Without IOMMU - GPU can still access physical memory which could be 
already assigned by OS to different process.
2. With IOMMU - GPU can access any memory, if the malicious process is 
able to create/reuse necessary IOMMU mappings.

It is currently not known if specific memory could be targeted, but 
random memory corruption or data leaks are a known possibility.

All Intel integrated and discrete GPUs Gen12 are affected, including 
Tiger Lake, Rocket Lake, Alder Lake, DG1, Raptor Lake, DG2, Arctic 
Sound, Meteor Lake.
Fix has already been developed and consists of fixing the method of 
writing to specific registers.
I am attaching a set of back-ported patches which implement the fix for 
all affected stable branches (all since 5.4).

This vulnerability has similar impact as CVE-2022-0330[1].

I will try to follow Linux Security Process[2]. So I hope to send the 
fix for public mailing list after 7 days.

[1]:<a href="https://nvd.nist.gov/vuln/detail/cve-2022-0330" rel="nofollow">https://nvd.nist.gov/vuln/detail/cve-2022-0330</a>
[2]:<a href="https://www.kernel.org/doc/html/latest/admin-guide/security-bugs.html" rel="nofollow">https://www.kernel.org/doc/html/latest/admin-guide/security-bugs.html</a>

Regards
Andrzej



<span style="font-family: times;"><strong>Download attachment "</strong><a href="1/1" rel="nofollow" download>media-tlb.tar</a><strong>" of type "</strong>application/x-tar<strong>" (20480 bytes)</strong></span>
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
