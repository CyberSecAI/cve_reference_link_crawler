Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**

The vulnerability stems from insufficient sanitization of user-controlled input when displaying object names and complementary names in an n:n relation context within the "tagset" widget. Specifically, the `friendlyname` and `additional_field` values are not properly escaped before being included in the HTML output.

**Weaknesses/Vulnerabilities:**

*   **Cross-Site Scripting (XSS):** The primary vulnerability is a stored XSS issue. Malicious JavaScript code injected into the `friendlyname` or a `complementary` attribute of an object is executed when that object is displayed as part of a many-to-many relationship in another object's view.
*   **Lack of Input Sanitization:** The application fails to sanitize or properly encode user-supplied data before rendering it within HTML, allowing for the injection of arbitrary code.

**Impact of Exploitation:**

*   **Arbitrary JavaScript Execution:** Successful exploitation allows an attacker to execute arbitrary JavaScript code in the context of a user's browser when they view a vulnerable page, which could lead to:
    *   Session hijacking
    *   Sensitive data theft
    *   Defacement of the application
    *   Redirection to malicious sites

**Attack Vectors:**

*   **Malicious Input:** An attacker injects malicious JavaScript code into an object's `friendlyname` or `complementary` name field.
*   **Triggered on View:** The XSS payload is executed when a user views an object that contains a relation to the maliciously crafted object within the n:n "tagset" widget

**Required Attacker Capabilities/Position:**

*   **Low Privileges:** The attacker requires low-level privileges within the application to create or modify objects that can hold malicious code in friendlyname/complementary name fields.
*   **Network Access:** The attacker needs network access to the application to exploit the vulnerability remotely.
*   **User Interaction:** The vulnerability requires user interaction, as the malicious script is executed when another user views a page containing the vulnerable element.

**Additional Notes**

*   The fix involves escaping the `friendlyname` and `additional_field` using `utils::EscapeHtml` before they are included in the HTML output, preventing the browser from interpreting them as executable code.
*   The vulnerability affects versions of iTop prior to 3.1.1 and 3.2.0.
*   The provided commit diff (34ba4fa0ce99534f751d9f170fe0eda103e20c72) shows the fix where `utils::EscapeHtml()` is applied to the `friendlyname` and `additional_field` variables within the `ComputeOthersData` function.
*  The CVSS score is 8.7 (High) with a vector of CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N.

This information is more detailed than a typical CVE description, which is generally shorter and less specific about the code changes.