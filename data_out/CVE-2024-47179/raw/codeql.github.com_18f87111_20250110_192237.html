<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Expression injection in Actions &#8212; CodeQL query help  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=278098cb" />
    <script src="../../_static/documentation_options.js?v=187304be"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="Failure to abandon session" href="../js-session-fixation/" />
    <link rel="prev" title="Expression has no effect" href="../js-useless-expression/" />

<title>CodeQL docs</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
<link rel="stylesheet" href="../../_static/primer.css" type="text/css" />


  </head><body>
<header class="Header">
    <div class="Header-item--full">
        <a href="https://codeql.github.com/docs" class="Header-link f2 d-flex flex-items-center">
            <!-- <%= octicon "mark-github", class: "mr-2", height: 32 %> -->
            <svg height="32" class="octicon octicon-mark-github mr-2" viewBox="0 0 16 16" version="1.1" width="32"
                aria-hidden="true">
                <path fill-rule="evenodd"
                    d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z">
                </path>
            </svg>
            <span class="hide-sm">CodeQL documentation</span>
        </a>
    </div>
    <div class="Header-item hide-sm hide-md">
        <script src="https://addsearch.com/js/?key=93b4d287e2fc079a4089412b669785d5&categories=!0xhelp.semmle.com,0xcodeql.github.com,1xdocs,1xcodeql-standard-libraries,1xcodeql-query-help"></script>
    </div>
    <div class="Header-item">

        <details class="dropdown details-reset details-overlay d-inline-block">
            <summary class="btn bg-gray-dark text-white border" aria-haspopup="true">
                CodeQL resources
                <div class="dropdown-caret"></div>
            </summary>
            <ul class="dropdown-menu dropdown-menu-se dropdown-menu-dark">
                <li><a class="dropdown-item" href="https://codeql.github.com/docs/codeql-overview">CodeQL overview</a></li>
                <li class="dropdown-divider" role="separator"></li>
                <div class="dropdown-header">
                    CodeQL guides
                </div>
                <li><a class="dropdown-item" href="https://codeql.github.com/docs/writing-codeql-queries">Writing CodeQL queries</a></li>
                <li><a class="dropdown-item" href="https://codeql.github.com/docs/codeql-language-guides">CodeQL language guides</a>
                <li class="dropdown-divider" role="separator"></li>
                <div class="dropdown-header">
                    Reference docs
                </div>
                <li><a class="dropdown-item" href="https://codeql.github.com/docs/ql-language-reference/">QL language
                        reference</a>
                <li><a class="dropdown-item" href="https://codeql.github.com/codeql-standard-libraries">CodeQL
                        standard-libraries</a>
                <li><a class="dropdown-item" href="https://codeql.github.com/codeql-query-help">CodeQL
                        query help</a>
                <li class="dropdown-divider" role="separator"></li>
                <div class="dropdown-header">
                    Source files
                </div>
                <li><a class="dropdown-item" href="https://github.com/github/codeql">CodeQL repository</a>
                <li class="dropdown-divider" role="separator"></li>
                <div class="dropdown-header">
                    Academic
                </div>
                <li><a class="dropdown-item" href="https://codeql.github.com/publications">QL publications</a>
            </ul>
        </details>

    </div>

</header>
<main class="bg-gray-light clearfix">
<nav class="SideNav position-sticky top-0 col-lg-3 col-md-3 float-left p-4 hide-sm hide-md overflow-y-auto">

    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../cpp/">CodeQL query help for C and C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../csharp/">CodeQL query help for C#</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../go/">CodeQL query help for Go</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../java/">CodeQL query help for Java and Kotlin</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">CodeQL query help for JavaScript and TypeScript</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../js-variable-use-in-temporal-dead-zone/">Access to let-bound variable in temporal dead zone</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-zipslip/">Arbitrary file access during archive extraction (”Zip Slip”)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-arguments-redefinition/">Arguments redefined</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-vue-arrow-method-on-vue-instance/">Arrow method on Vue instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-assignment-to-constant/">Assignment to constant</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-node-assignment-to-exports-variable/">Assignment to exports variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-property-assignment-on-primitive/">Assignment to property of primitive value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-regex-back-reference-to-negative-lookahead/">Back reference into negative lookahead assertion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-regex-back-reference-before-group/">Back reference precedes capture group</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-bad-tag-filter/">Bad HTML filtering regexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-cors-misconfiguration-for-credentials/">CORS misconfiguration for credentials transfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-eval-like-call/">Call to eval-like DOM function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-case-sensitive-middleware-path/">Case-sensitive middleware path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-clear-text-storage-of-sensitive-data/">Clear text storage of sensitive information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-clear-text-cookie/">Clear text transmission of sensitive cookie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-clear-text-logging/">Clear-text logging of sensitive information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-client-side-unvalidated-url-redirection/">Client-side URL redirect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-xss/">Client-side cross-site scripting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-client-side-request-forgery/">Client-side request forgery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-code-injection/">Code injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-comparison-between-incompatible-types/">Comparison between inconvertible types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-comparison-with-nan/">Comparison with NaN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-conditional-comment/">Conditional comments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-function-declaration-conflict/">Conflicting function declarations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-variable-initialization-conflict/">Conflicting variable initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-biased-cryptographic-random/">Creating biased random numbers from a cryptographically secure source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-cross-window-information-leak/">Cross-window communication with unrestricted target origin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-xss-through-dom/">DOM text reinterpreted as HTML</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-sql-injection/">Database query built from user-controlled sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-nested-function-reference-in-default-parameter/">Default parameter references nested function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-deletion-of-non-property/">Deleting non-property</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-insecure-dependency/">Dependency download using unencrypted communication channel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-angular-dependency-injection-mismatch/">Dependency mismatch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unsafe-deserialization/">Deserialization of user-controlled data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-react-direct-state-mutation/">Direct state mutation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-disabling-electron-websecurity/">Disabling Electron webSecurity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-angular-disabling-sce/">Disabling SCE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-disabling-certificate-validation/">Disabling certificate validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-angular-double-compilation/">Double compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-double-escaping/">Double escaping or unescaping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-insecure-download/">Download of sensitive file through insecure connection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-duplicate-condition/">Duplicate ‘if’ condition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-duplicate-html-attribute/">Duplicate HTML element attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-regex-duplicate-in-character-class/">Duplicate character in character class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-angular-duplicate-dependency/">Duplicate dependency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-duplicate-parameter-name/">Duplicate parameter names</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-duplicate-property/">Duplicate property</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-duplicate-switch-case/">Duplicate switch case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-duplicate-variable-declaration/">Duplicate variable declaration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-regex-empty-character-class/">Empty character class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-empty-password-in-configuration-file/">Empty password in configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-enabling-electron-insecure-content/">Enabling Electron allowRunningInsecureContent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-xss-through-exception/">Exception text reinterpreted as HTML</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-exposure-of-private-files/">Exposure of private files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-useless-expression/">Expression has no effect</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Expression injection in Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-session-fixation/">Failure to abandon session</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-file-access-to-http/">File data in outbound network request</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-hardcoded-credentials/">Hard-coded credentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-hardcoded-data-interpreted-as-code/">Hard-coded data interpreted as code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-host-header-forgery-in-email-generation/">Host header poisoning in email generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-redundant-operation/">Identical operands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-ignore-array-result/">Ignoring result from pure array method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-illegal-invocation/">Illegal invocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-implicit-operand-conversion/">Implicit operand conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-bad-code-sanitization/">Improper code sanitization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-functionality-from-untrusted-source/">Inclusion of functionality from an untrusted source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-angular-incompatible-service/">Incompatible dependency injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-incomplete-html-attribute-sanitization/">Incomplete HTML attribute sanitization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-incomplete-url-scheme-check/">Incomplete URL scheme check</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-incomplete-url-substring-sanitization/">Incomplete URL substring sanitization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-incomplete-multi-character-sanitization/">Incomplete multi-character sanitization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-incomplete-hostname-regexp/">Incomplete regular expression for hostnames</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-incomplete-sanitization/">Incomplete string escaping or encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-inconsistent-loop-direction/">Inconsistent direction of for loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-inconsistent-use-of-new/">Inconsistent use of ‘new’</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-incorrect-suffix-check/">Incorrect suffix check</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-indirect-command-line-injection/">Indirect uncontrolled command line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-ineffective-parameter-type/">Ineffective parameter type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-redos/">Inefficient regular expression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-stack-trace-exposure/">Information exposure through a stack trace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-angular-insecure-url-whitelist/">Insecure URL whitelist</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-insecure-helmet-configuration/">Insecure configuration of Helmet security middleware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-insecure-randomness/">Insecure randomness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-insecure-temporary-file/">Insecure temporary file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-invalid-prototype-value/">Invalid prototype value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-call-to-non-callable/">Invocation of non-function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-jwt-missing-verification/">JWT missing secret or public key verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-log-injection/">Log injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-loop-bound-injection/">Loop bound injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-loop-iteration-skipped-due-to-shifting/">Loop iteration skipped due to shifting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-malformed-html-id/">Malformed id attribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-misleading-indentation-after-control-statement/">Misleading indentation after control statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-misleading-indentation-of-dangling-else/">Misleading indentation of dangling ‘else’</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-missing-dot-length-in-comparison/">Missing ‘.length’ in comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-missing-this-qualifier/">Missing ‘this’ qualifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-missing-token-validation/">Missing CSRF middleware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-missing-await/">Missing await</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-angular-missing-explicit-injection/">Missing explicit dependency injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-node-missing-exports-qualifier/">Missing exports qualifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-missing-origin-check/">Missing origin verification in <code class="docutils literal notranslate"><span class="pre">postMessage</span></code> handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-missing-rate-limiting/">Missing rate limiting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-regex-missing-regexp-anchor/">Missing regular expression anchor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-missing-space-in-concatenation/">Missing space in string concatenation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-missing-variable-declaration/">Missing variable declaration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-misspelled-variable-name/">Misspelled variable name</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-http-to-file-access/">Network data written to file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-label-in-switch/">Non-case label in switch statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-non-linear-pattern/">Non-linear pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-index-out-of-bounds/">Off-by-one comparison against length</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-overly-large-range/">Overly permissive regular expression range</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-overwritten-property/">Overwritten property</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-password-in-configuration-file/">Password in configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-polynomial-redos/">Polynomial regular expression used on uncontrolled data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-file-system-race/">Potential file system race condition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-react-inconsistent-state-update/">Potentially inconsistent state update</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-property-access-on-non-object/">Property access on null or undefined</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-prototype-polluting-assignment/">Prototype-polluting assignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-prototype-pollution-utility/">Prototype-polluting function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-prototype-pollution/">Prototype-polluting merge call</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-reflected-xss/">Reflected cross-site scripting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-regex-always-matches/">Regular expression always matches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-regex-injection/">Regular expression injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-remote-property-injection/">Remote property injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-angular-repeated-dependency-injection/">Repeated dependency injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-identity-replacement/">Replacement of a substring with itself</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-resource-exhaustion/">Resource exhaustion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-resource-exhaustion-from-deep-object-traversal/">Resources exhaustion from deep object traversal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-useless-assignment-in-return/">Return statement assigns local variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-second-order-command-line-injection/">Second order command injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-redundant-assignment/">Self assignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-automatic-semicolon-insertion/">Semicolon insertion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-samesite-none-cookie/">Sensitive cookie without SameSite restrictions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-sensitive-get-query/">Sensitive data read from GET request</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-client-exposed-cookie/">Sensitive server cookie exposed to the client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-server-crash/">Server crash</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-server-side-unvalidated-url-redirection/">Server-side URL redirect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-request-forgery/">Server-side request forgery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-shell-command-injection-from-environment/">Shell command built from environment values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-shift-out-of-range/">Shift out of range</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-actions-actions-artifact-leak/">Storage of sensitive information in GitHub Actions artifact</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-build-artifact-leak/">Storage of sensitive information in build artifact</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-stored-xss/">Stored cross-site scripting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-string-instead-of-regex/">String instead of regular expression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-superfluous-trailing-arguments/">Superfluous trailing arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-suspicious-method-name-declaration/">Suspicious method name declaration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-syntax-error/">Syntax error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-template-object-injection/">Template Object Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-template-syntax-in-string-literal/">Template syntax in string literal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-type-confusion-through-parameter-tampering/">Type confusion through parameter tampering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-regex-unbound-back-reference/">Unbound back reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unbound-event-handler-receiver/">Unbound event handler receiver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unclear-operator-precedence/">Unclear precedence of nested operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-command-line-injection/">Uncontrolled command line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-path-injection/">Uncontrolled data used in path expression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unknown-directive/">Unknown directive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-regex-unmatchable-caret/">Unmatchable caret in regular expression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-regex-unmatchable-dollar/">Unmatchable dollar in regular expression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unnecessary-use-of-cat/">Unnecessary use of <code class="docutils literal notranslate"><span class="pre">cat</span></code> process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unneeded-defensive-code/">Unneeded defensive code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unreachable-method-overloads/">Unreachable method overloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unreachable-statement/">Unreachable statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-html-constructed-from-input/">Unsafe HTML constructed from library input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unsafe-code-construction/">Unsafe code constructed from library input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unsafe-dynamic-method-access/">Unsafe dynamic method access</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unsafe-html-expansion/">Unsafe expansion of self-closing HTML tag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unsafe-jquery-plugin/">Unsafe jQuery plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-shell-command-constructed-from-input/">Unsafe shell command constructed from library input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-react-unsupported-state-update-in-lifecycle-method/">Unsupported state update in lifecycle method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-functionality-from-untrusted-domain/">Untrusted domain used in script or other content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unused-index-variable/">Unused index variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unused-loop-variable/">Unused loop iteration variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-react-unused-or-undefined-state-property/">Unused or undefined state property</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unused-local-variable/">Unused variable, import, function or class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-unvalidated-dynamic-method-call/">Unvalidated dynamic method call</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-angular-expression-in-url-attribute/">Use of AngularJS markup in URL-valued attribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-weak-cryptographic-algorithm/">Use of a broken or weak cryptographic algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-insufficient-key-size/">Use of a weak cryptographic key</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-strict-mode-call-stack-introspection/">Use of call stack introspection in strict mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-tainted-format-string/">Use of externally-controlled format string</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-for-in-comprehension/">Use of for-in comprehension blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-incomplete-object-initialization/">Use of incompletely initialized object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-insufficient-password-hash/">Use of password hash with insufficient computational effort</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-non-standard-language-feature/">Use of platform-specific language features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-use-of-returnless-function/">Use of returnless function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-useless-assignment-to-local/">Useless assignment to local variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-useless-assignment-to-property/">Useless assignment to property</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-useless-comparison-test/">Useless comparison test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-trivial-conditional/">Useless conditional</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-useless-regexp-character-escape/">Useless regular-expression character escape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-setter-return/">Useless return in setter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-useless-type-test/">Useless type test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-user-controlled-bypass/">User-controlled bypass of security check</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-use-before-declaration/">Variable not declared before use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-whitespace-contradicts-precedence/">Whitespace contradicts operator precedence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-with-statement/">With statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-mixed-static-instance-this-access/">Wrong use of ‘this’ for static method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-xxe/">XML external entity expansion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-xml-bomb/">XML internal entity expansion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-xpath-injection/">XPath injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-yield-outside-generator/">Yield in non-generator function</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../python/">CodeQL query help for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ruby/">CodeQL query help for Ruby</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../swift/">CodeQL query help for Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../codeql-cwe-coverage/">CodeQL CWE coverage</a></li>
</ul>


</nav>


<div class="body col-sm-12 col-md-9 col-lg-9 float-left border-left">

    <div class="hide-lg hide-xl px-4 pt-4">
        
<div class="related" role="navigation" aria-label="related navigation">
    <ul>
        <li class="nav-item nav-item-0"><a href="../../">CodeQL query help  documentation</a> &#187;</li>
        <li class="nav-item nav-item-1"><a href="../"
                accesskey="U">CodeQL query help for JavaScript and TypeScript</a> &#187;</li> 
    </ul>
</div>
    </div>

    <article class="p-4 col-lg-10 col-md-10 col-sm-12">
        
  <section id="expression-injection-in-actions">
<h1>Expression injection in Actions<a class="headerlink" href="#expression-injection-in-actions" title="Link to this heading">¶</a></h1>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ID: js/actions/command-injection
Kind: problem
Security severity: 9.3
Severity: warning
Precision: high
Tags:
   - actions
   - security
   - external/cwe/cwe-094
Query suites:
   - javascript-code-scanning.qls
   - javascript-security-extended.qls
   - javascript-security-and-quality.qls
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/github/codeql/blob/main/javascript/ql/src/Security/CWE-094/ExpressionInjection.ql">Click to see the query in the CodeQL repository</a></p>
<p>Using user-controlled input in GitHub Actions may lead to code injection in contexts like <em>run:</em> or <em>script:</em>.</p>
<p>Code injection in GitHub Actions may allow an attacker to exfiltrate any secrets used in the workflow and the temporary GitHub repository authorization token. The token might have write access to the repository, allowing an attacker to use the token to make changes to the repository.</p>
<section id="recommendation">
<h2>Recommendation<a class="headerlink" href="#recommendation" title="Link to this heading">¶</a></h2>
<p>The best practice to avoid code injection vulnerabilities in GitHub workflows is to set the untrusted input value of the expression to an intermediate environment variable and then use the environment variable using the native syntax of the shell/script interpreter (that is, not <em>${{ env.VAR }}</em>).</p>
<p>It is also recommended to limit the permissions of any tokens used by a workflow such as the GITHUB_TOKEN.</p>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Link to this heading">¶</a></h2>
<p>The following example lets a user inject an arbitrary shell command:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">issue_comment</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">echo-body</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">echo &#39;${{ github.event.comment.body }}&#39;</span>
</pre></div>
</div>
<p>The following example uses an environment variable, but <strong>still allows the injection</strong> because of the use of expression syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">issue_comment</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">echo-body</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w">  </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="nt">BODY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.event.issue.body }}</span>
<span class="w">    </span><span class="w w-Error">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">echo &#39;${{ env.BODY }}&#39;</span>
</pre></div>
</div>
<p>The following example uses shell syntax to read the environment variable and will prevent the attack:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">issue_comment</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">echo-body</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="nt">BODY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.event.issue.body }}</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">echo &quot;$BODY&quot;</span>
</pre></div>
</div>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>GitHub Security Lab Research: <a class="reference external" href="https://securitylab.github.com/research/github-actions-untrusted-input">Keeping your GitHub Actions and workflows secure: Untrusted input</a>.</p></li>
<li><p>GitHub Docs: <a class="reference external" href="https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions">Security hardening for GitHub Actions</a>.</p></li>
<li><p>GitHub Docs: <a class="reference external" href="https://docs.github.com/en/actions/security-guides/automatic-token-authentication#permissions-for-the-github_token">Permissions for the GITHUB_TOKEN</a>.</p></li>
<li><p>Common Weakness Enumeration: <a class="reference external" href="https://cwe.mitre.org/data/definitions/94.html">CWE-94</a>.</p></li>
</ul>
</section>
</section>


    </article>

    <!-- GitHub footer, with links to terms and privacy statement -->
    <div class="px-3 px-md-6 f6 py-4 d-sm-flex flex-justify-between flex-row-reverse flex-items-center border-top">
        <ul class="list-style-none d-flex flex-items-center mb-3 mb-sm-0 lh-condensed-ultra">
            <li class="mr-3">
                <a href="https://twitter.com/github" title="GitHub on Twitter" style="color: #959da5;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 273.5 222.3" class="d-block" height="18">
                        <path
                            d="M273.5 26.3a109.77 109.77 0 0 1-32.2 8.8 56.07 56.07 0 0 0 24.7-31 113.39 113.39 0 0 1-35.7 13.6 56.1 56.1 0 0 0-97 38.4 54 54 0 0 0 1.5 12.8A159.68 159.68 0 0 1 19.1 10.3a56.12 56.12 0 0 0 17.4 74.9 56.06 56.06 0 0 1-25.4-7v.7a56.11 56.11 0 0 0 45 55 55.65 55.65 0 0 1-14.8 2 62.39 62.39 0 0 1-10.6-1 56.24 56.24 0 0 0 52.4 39 112.87 112.87 0 0 1-69.7 24 119 119 0 0 1-13.4-.8 158.83 158.83 0 0 0 86 25.2c103.2 0 159.6-85.5 159.6-159.6 0-2.4-.1-4.9-.2-7.3a114.25 114.25 0 0 0 28.1-29.1"
                            fill="currentColor"></path>
                    </svg>
                </a>
            </li>
            <li class="mr-3">
                <a href="https://www.facebook.com/GitHub" title="GitHub on Facebook" style="color: #959da5;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.3 15.4" class="d-block" height="18">
                        <path
                            d="M14.5 0H.8a.88.88 0 0 0-.8.9v13.6a.88.88 0 0 0 .8.9h7.3v-6h-2V7.1h2V5.4a2.87 2.87 0 0 1 2.5-3.1h.5a10.87 10.87 0 0 1 1.8.1v2.1h-1.3c-1 0-1.1.5-1.1 1.1v1.5h2.3l-.3 2.3h-2v5.9h3.9a.88.88 0 0 0 .9-.8V.8a.86.86 0 0 0-.8-.8z"
                            fill="currentColor"></path>
                    </svg>
                </a>
            </li>
            <li class="mr-3">
                <a href="https://www.youtube.com/github" title="GitHub on YouTube" style="color: #959da5;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.17 13.6" class="d-block" height="16">
                        <path
                            d="M18.77 2.13A2.4 2.4 0 0 0 17.09.42C15.59 0 9.58 0 9.58 0a57.55 57.55 0 0 0-7.5.4A2.49 2.49 0 0 0 .39 2.13 26.27 26.27 0 0 0 0 6.8a26.15 26.15 0 0 0 .39 4.67 2.43 2.43 0 0 0 1.69 1.71c1.52.42 7.5.42 7.5.42a57.69 57.69 0 0 0 7.51-.4 2.4 2.4 0 0 0 1.68-1.71 25.63 25.63 0 0 0 .4-4.67 24 24 0 0 0-.4-4.69zM7.67 9.71V3.89l5 2.91z"
                            fill="currentColor"></path>
                    </svg>
                </a>
            </li>
            <li class="mr-3 flex-self-start">
                <a href="https://www.linkedin.com/company/github" title="GitHub on Linkedin" style="color: #959da5;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19 18" class="d-block" height="18">
                        <path
                            d="M3.94 2A2 2 0 1 1 2 0a2 2 0 0 1 1.94 2zM4 5.48H0V18h4zm6.32 0H6.34V18h3.94v-6.57c0-3.66 4.77-4 4.77 0V18H19v-7.93c0-6.17-7.06-5.94-8.72-2.91z"
                            fill="currentColor"></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="https://github.com/github" title="GitHub's organization" style="color: #959da5;">
                    <svg version="1.1" width="20" height="20" viewBox="0 0 16 16" class="octicon octicon-mark-github"
                        aria-hidden="true">
                        <path fill-rule="evenodd"
                            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
                        </path>
                    </svg>
                </a>
            </li>
        </ul>
        <ul class="list-style-none d-flex text-gray">
            <li class="mr-3">&copy;
                <script type="text/javascript">document.write(new Date().getFullYear());</script> GitHub, Inc.</li>
            <li class="mr-3"><a
                    href="https://docs.github.com/site-policy/github-terms/github-terms-of-service"
                    class="link-gray">Terms </a></li>
            <li><a href="https://docs.github.com/site-policy/privacy-policies/github-privacy-statement"
                    class="link-gray">Privacy </a></li>
        </ul>
    </div>
</div>
</main>

<script type="text/javascript">
    $(document).ready(function () {
        $(".toggle > *").hide();
        $(".toggle .name").show();
        $(".toggle .name").click(function () {
            $(this).parent().children().not(".name").toggle(400);
            $(this).parent().children(".name").toggleClass("open");
        })
    });
</script>

  </body>
</html>