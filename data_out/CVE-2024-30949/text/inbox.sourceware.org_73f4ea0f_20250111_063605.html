
```
[public inbox for newlib@sourceware.org](../?t=20231129035721)
 [help](../_/text/help/) / [color](../_/text/color/) / [mirror](../_/text/mirror/) / [Atom feed](../new.atom)
```
```
From: Kuan-Wei Chiu <visitorckw@gmail.com>
To: newlib@sourceware.org
Cc: kito.cheng@sifive.com, Kuan-Wei Chiu <visitorckw@gmail.com>
Subject: [[PATCH v2] RISC-V: Fix timeval conversion in _gettimeofday()](#r)
Date: Wed, 29 Nov 2023 11:57:14 +0800	[[thread overview]](#r)
Message-ID: <20231129035714.469943-1-visitorckw@gmail.com> (<raw>)
In-Reply-To: <[20231128223739.463754-1-visitorckw@gmail.com](../20231128223739.463754-1-visitorckw%40gmail.com/)>

Replace multiplication with division for microseconds calculation from
nanoseconds in _gettimeofday function.

Signed-off-by: Kuan-Wei Chiu <visitorckw@gmail.com>
---
v1 -> v2:
   - Add missing Signed-off-by tag.

 [libgloss/riscv/sys_gettimeofday.c](#Z31libgloss:riscv:sys_gettimeofday.c) | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

[diff](#iZ31libgloss:riscv:sys_gettimeofday.c) --git a/libgloss/riscv/sys_gettimeofday.c b/libgloss/riscv/sys_gettimeofday.c
index 81bea8e55..5379a8963 100644
--- a/libgloss/riscv/sys_gettimeofday.c
+++ b/libgloss/riscv/sys_gettimeofday.c
@@ -23,7 +23,7 @@ _gettimeofday(struct timeval *tp, void *tzp)
   int rv;
   rv = syscall_errno (SYS_clock_gettime64, 2, 0, (long)&ts64, 0, 0, 0, 0);
   tp->tv_sec = ts64.tv_sec;
-  tp->tv_usec = ts64.tv_nsec * 1000;
+  tp->tv_usec = ts64.tv_nsec / 1000;
   return rv;
 #else
   return syscall_errno (SYS_gettimeofday, 1, tp, 0, 0, 0, 0, 0);
--
2.25.1

```

---

```
[next](../CALLt3TgYipHZ%2BHaKSrMAOiVV0fj3BwROM-nJo57XMehXTqi0pQ%40mail.gmail.com/) [prev parent](../20231128223739.463754-1-visitorckw%40gmail.com/) [reply](#R)	other threads:[[~2023-11-29  3:57 UTC](../?t=20231129035721)|[newest](../)]

Thread overview: 4+ messages / expand[[flat](T/#u)|[nested](t/#u)]  [mbox.gz](t.mbox.gz)  [Atom feed](t.atom)  [top](#b)
2023-11-28 22:37 [[PATCH]](../20231128223739.463754-1-visitorckw%40gmail.com/) " Kuan-Wei Chiu
2023-11-29  3:57 ` [Kuan-Wei Chiu [this message]](#t)
2023-11-29  6:41   ` [[PATCH v2]](../CALLt3TgYipHZ%2BHaKSrMAOiVV0fj3BwROM-nJo57XMehXTqi0pQ%40mail.gmail.com/) " Kito Cheng
2023-11-29  9:15   ` [Corinna Vinschen](../ZWcBQDYtkb21LPGn%40calimero.vinschen.de/)

```

---

```
Reply instructions:

You may reply publicly to [this message](#t) via plain-text email
using any one of the following methods:

* Save the following mbox file, import it into your mail client,
  and reply-to-all from there: [mbox](raw)

  Avoid top-posting and favor interleaved quoting:
  <https://en.wikipedia.org/wiki/Posting_style#Interleaved_style>

* Reply using the --to, --cc, and --in-reply-to
  switches of git-send-email(1):

  git send-email \
    --in-reply-to=20231129035714.469943-1-visitorckw@gmail.com \
    --to=visitorckw@gmail.com \
    --cc=kito.cheng@sifive.com \
    --cc=newlib@sourceware.org \
    /path/to/YOUR_REPLY

  <https://kernel.org/pub/software/scm/git/docs/git-send-email.html>

* If your mail client supports setting the In-Reply-To header
  via mailto: links, try the mailto: link

```
Be sure your reply has a **Subject:** header at the top and a blank line
before the message body.

---

```
This is a public inbox, see [mirroring instructions](../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox;
as well as URLs for read-only IMAP folder(s) and NNTP newsgroup(s).
```
