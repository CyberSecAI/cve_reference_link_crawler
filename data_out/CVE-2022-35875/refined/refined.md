```
{
  "Root cause of vulnerability": "The `log` function uses `vsnprintf` with a format string that can be controlled by an attacker through the device's configuration parameters. This function is used to create log messages, and the format string vulnerability allows an attacker to read stack memory and potentially write arbitrary memory via format string specifiers.",
  "Weaknesses/vulnerabilities present": [
    "Format string injection vulnerability in the `log` function due to the use of attacker-controlled input as the format string parameter in `vsnprintf`."
  ],
  "Impact of exploitation": "An attacker can cause memory corruption, information disclosure (reading stack memory) and potentially achieve denial of service. The format string vulnerability is exposed on the device's UART console.",
  "Attack vectors": "The attacker can modify Wi-Fi configuration parameters via mobile application, web application, `setWifiAP` XCMD, `/action/wirelessPost` or `/action/configPost` endpoints, then trigger the vulnerable `testWifiAP` XCMD via UDP/55050. The format string injection is triggered within the `do_test_wifiap` function when processing the configuration data for logging purposes.",
  "Required attacker capabilities/position": "The attacker must be able to modify the device's Wi-Fi configuration via the mobile application, the web application or using the exposed API endpoints. The attacker needs network access to the device to send the `testWifiAP` XCMD via UDP/55050. To view the output of the format string injection, physical access to the device's UART console is required."
}
```