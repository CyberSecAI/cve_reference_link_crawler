- **Root cause of vulnerability**: The plugin lacks CSRF (Cross-Site Request Forgery) protection when updating its settings. Additionally, it fails to sanitize and escape user inputs, leading to Stored XSS.
- **Weaknesses/vulnerabilities present**:
    - CSRF vulnerability:  An attacker can forge requests to modify plugin settings without the user's knowledge or consent.
    - Stored XSS vulnerability: Malicious JavaScript code can be injected into the plugin settings and executed in the victim's browser when the settings page is accessed by an administrator.
-  **Impact of exploitation**: An attacker can achieve Stored XSS by exploiting the CSRF vulnerability. This allows the attacker to execute arbitrary JavaScript code in the context of an administrator’s browser session. This can lead to account takeover, data theft, or further malicious actions.
- **Attack vectors**: The attack is carried out through a crafted HTTP POST request targeting the plugin’s settings update endpoint ( `https://example.com/wp-admin/plugins.php?page=clean_contact` ). The attacker would need to trick a logged-in administrator into submitting this crafted request.
- **Required attacker capabilities/position**:
    - The attacker needs to convince a logged-in administrator to visit a malicious page or click a malicious link that submits the crafted request.
    - The attacker does not need to be authenticated, only the administrator needs to be authenticated
    - The attacker needs to be able to craft a specific HTML form