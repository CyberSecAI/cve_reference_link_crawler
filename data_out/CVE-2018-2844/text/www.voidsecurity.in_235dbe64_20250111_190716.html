

# [voidsecurity](https://www.voidsecurity.in/)

Yet another blog by a security enthusiast !

## Vulnerabilities

* [Writeups](https://www.voidsecurity.in/)
* [List of Vulnerabilities](https://www.voidsecurity.in/p/vulnerabilities.html)

## Tuesday, August 28, 2018

### From Compiler Optimization to Code Execution - VirtualBox VM Escape - CVE-2018-2844

Oracle fixed some of the issues I reported in VirtualBox during the Oracle Critical Patch Update - April 2018. CVE-2018-2844 was an interesting double fetch vulnerability in VirtualBox Video Acceleration (VBVA) feature affecting Linux hosts. VBVA feature works on top of VirtualBox Host-Guest Shared Memory Interface (HGSMI), a shared memory implemented using Video RAM buffer.
The VRAM buffer is at physical address 0xE0000000

```
sudo lspci -vvv

00:02.0 VGA compatible controller: InnoTek Systemberatung GmbH VirtualBox Graphics Adapter (prog-if 00 [VGA controller])
 ...
 Interrupt: pin A routed to IRQ 10
 Region 0: Memory at e0000000 (32-bit, prefetchable) [size=16M]
 Expansion ROM at  [disabled]
 Kernel modules: vboxvideo

```
The guest sets up command buffer using HGSMI as below and writes the offset in VRAM to IO port VGA\_PORT\_HGSMI\_GUEST (0x3d0) to notify the host.

```
 HGSMIBUFFERHEADER header;
 uint8_t data[header.u32BufferSize];
 HGSMIBUFFERTAIL tail;

```
The bug specifically occurs in code handling Video DMA (VDMA) commands passed from Guest to Host. The VDMA command handling function vboxVDMACmdExec() dispatches to specific functions based on VDMA command types. This is implemented as switch case statements.

```
static int
vboxVDMACmdExec(PVBOXVDMAHOST pVdma, const uint8_t *pvBuffer, uint32_t cbBuffer)
{
 /* pvBuffer is shared memory in VRAM */
        PVBOXVDMACMD pCmd = (PVBOXVDMACMD)pvBuffer;

        switch (pCmd->enmType) {
                case VBOXVDMACMD_TYPE_CHROMIUM_CMD: {
                        ...
                }
                case VBOXVDMACMD_TYPE_DMA_PRESENT_BLT: {
                        ...
                }
                case VBOXVDMACMD_TYPE_DMA_BPB_TRANSFER: {
                        ...
                }
                case VBOXVDMACMD_TYPE_DMA_NOP: {
                        ...
                }
                case VBOXVDMACMD_TYPE_CHILD_STATUS_IRQ: {
                        ...
                }
                default: {
                         ...
                }
        }
}

```
The compiler optimizes the switch cases to jump tables. This is what it looks like after optimization:

```
; first fetch happens for cmp
.text:00000000000B957A                 cmp     dword ptr [r12], 0Ah ; switch 11 cases
.text:00000000000B957F                 ja      VBOXVDMACMD_TYPE_DEFAULT ; jumptable 00000000000B9597 default case

; second fetch again for pCmd->enmType from shared memory
.text:00000000000B9585                 mov     eax, [r12]
.text:00000000000B9589                 lea     rbx, vboxVDMACmdExec_JMPS
.text:00000000000B9590                 movsxd  rax, dword ptr [rbx+rax*4]
.text:00000000000B9594                 add     rax, rbx
.text:00000000000B9597                 jmp     rax             ; switch jump

```
```
.rodata:0000000000185538 vboxVDMACmdExec_JMPS dd offset VBOXVDMACMD_TYPE_DEFAULT - 185538h
.rodata:0000000000185538                                         ; DATA XREF: vboxVDMACommand+1D9o
.rodata:0000000000185538                 dd offset VBOXVDMACMD_TYPE_DMA_PRESENT_BLT - 185538h ; jump table for switch statement
.rodata:0000000000185538                 dd offset VBOXVDMACMD_TYPE_DMA_BPB_TRANSFER - 185538h
.rodata:0000000000185538                 dd offset VBOXVDMACMD_TYPE_DEFAULT - 185538h
.rodata:0000000000185538                 dd offset VBOXVDMACMD_TYPE_DEFAULT - 185538h
.rodata:0000000000185538                 dd offset VBOXVDMACMD_TYPE_DEFAULT - 185538h
.rodata:0000000000185538                 dd offset VBOXVDMACMD_TYPE_DEFAULT - 185538h
.rodata:0000000000185538                 dd offset VBOXVDMACMD_TYPE_DMA_NOP - 185538h
.rodata:0000000000185538                 dd offset VBOXVDMACMD_TYPE_DMA_NOP - 185538h
.rodata:0000000000185538                 dd offset VBOXVDMACMD_TYPE_DEFAULT - 185538h
.rodata:0000000000185538                 dd offset VBOXVDMACMD_TYPE_DMA_NOP - 185538h
.rodata:0000000000185564                 align 20h

```
The issue is quite clear, its a TOCTOU bug. Since the variable is not marked volatile, GCC optimizations resulted in double fetch from shared VRAM memory. I didn't see such optimization in VirtualBox for Windows and OSX. Only Linux hosts are affected.

Note that this kind of issue is not new. We have prior research [Xenpwn - Breaking Paravirtualized Devices](https://www.ernw.de/download/xenpwn.pdf) by Felix Wilhelm on similar issue found in [Xen](https://xenbits.xen.org/xsa/advisory-155.html)

**Exploitation:**

Though the race window is really small, it can be reliably won on guests having more than one vCPU.

```
 RAX  0xdeadbeef
 RBX  0x7fff8abf2538 ◂— rol    byte ptr [rdx - 0xd], 1
 RCX  0x7fff9c508ac0 —▸ 0x7ffff7e30000 ◂— 0x5
 RDX  0xe7b
 RDI  0xeeb
 RSI  0x7fffdc022000 ◂— xor    byte ptr [rax], al /* 0xffe40030; '0' */
 R8   0x7fff89d20000 ◂— jmp    0x7fff89d20010 /* 0xb020000000eeb */
 R9   0x7fff8ab06040 ◂— push   rbp
 R10  0x7fff9c50ad48 ◂— 0x1
 R11  0x7fff9c508d48 ◂— 0x0
 R12  0x7fff89d20078 ◂— 0xa /* '\n' */
 R13  0xf3b
 R14  0x7fff9c50d0e0 —▸ 0x7fff9c508ac0 —▸ 0x7ffff7e30000 ◂— 0x5
 R15  0x7fff89d20030 ◂— 0xffffffdc0f3b0eeb
 RBP  0x7fffba44dc40 —▸ 0x7fffba44dca0 —▸ 0x7fffba44dce0 —▸ 0x7fffba44dd00 —▸ 0x7fffba44dd50 ◂— ...
 RSP  0x7fffba44db80 —▸ 0x7fffba44dbb0 —▸ 0x7fff9c508ac0 —▸ 0x7ffff7e30000 ◂— 0x5
 RIP  0x7fff8ab26590 ◂— movsxd rax, dword ptr [rbx + rax*4]

 ► 0x7fff8ab26590    movsxd rax, dword ptr [rbx + rax*4]
   0x7fff8ab26594    add    rax, rbx
   0x7fff8ab26597    jmp    rax

```
RAX is controlled by guest. R8, R12 and R15 points to offsets within HGSMI buffer during the crash. The jump table uses relative addressing, hence once cannot directly call into a pointer. First plan was to find a feature, which allows to write a controlled value in VBoxDD.so from guest and further use it as fake jump table. However, I failed to find one.

Next option is to directly jump to the VRAM buffer mapped with RWX permissions using whatever value available for fake jump table.

```
    // VRAM buffer
    0x7fff88d21000     0x7fff89d21000 rwxp  1000000 0

    // VBoxDD.so
    0x7fff8aa6d000     0x7fff8adff000 r-xp   392000 0      /usr/lib/virtualbox/VBoxDD.so
    0x7fff8adff000     0x7fff8afff000 ---p   200000 392000 /usr/lib/virtualbox/VBoxDD.so
    0x7fff8afff000     0x7fff8b010000 r--p    11000 392000 /usr/lib/virtualbox/VBoxDD.so
    0x7fff8b010000     0x7fff8b018000 rw-p     8000 3a3000 /usr/lib/virtualbox/VBoxDD.so

```
Find a value in VBoxDD.so (assume as some fake jump table), which during relative address calculation will point into the 16MB shared VRAM buffer. For the proof-of-concept exploit fill the entire VRAM with NOP's and place the shellcode at the final pages of the mapping. No ASLR bypass is needed since the jump is relative.

In the guest, add vboxvideo to /etc/modprobe.d/blacklist.conf. vboxvideo.ko driver has a custom allocator to manage VRAM memory and HGSMI guest side implementations. Blacklisting vboxvideo reduces activity on VRAM and keeps the payload intact. The exploit was tested with Ubuntu Server 16.04.3 64-bit as guest and Ubuntu Desktop 16.04.4 64-bit as host running [VirtualBox 5.2.6.r120293](https://download.virtualbox.org/virtualbox/5.2.6/virtualbox-5.2_5.2.6-120293~Ubuntu~xenial_amd64.deb).

The proof-of-concept exploit code with process continuation and connect back over network can be found at [virtualbox-cve-2018-2844](https://github.com/renorobert/virtualbox-cve-2018-2844)

**References:**

[1] [Xenpwn - Breaking Paravirtualized Devices by Felix Wilhelm](https://www.ernw.de/download/xenpwn.pdf)

[2] [SSD Advisory – Oracle VirtualBox Multiple Guest to Host Escape Vulnerabilities by Niklas Baumstark](https://blogs.securiteam.com/index.php/archives/3649)

[3] [VM escape - QEMU Case Study by Mehdi Talbi & Paul Fariello](http://www.phrack.org/papers/vm-escape-qemu-case-study.html)

[4] [Xen Security Advisory CVE-2015-8550 / XSA-155](https://xenbits.xen.org/xsa/advisory-155.html)

[5] [Oracle Critical Patch Update Advisory - April 2018](http://www.oracle.com/technetwork/security-advisory/cpuapr2018-3678067.html)

Posted by
[Reno Robert](https://www.blogger.com/profile/01980174423078410529 "author profile")

at
[2:34 PM](https://www.voidsecurity.in/2018/08/from-compiler-optimization-to-code.html "permanent link")

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=3932878064881956934&postID=7496832723622885651&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=3932878064881956934&postID=7496832723622885651&target=email "Email This")
[BlogThis!](https://www.blogger.com/share-post.g?blogID=3932878064881956934&postID=7496832723622885651&target=blog "BlogThis!")
[Share to X](https://www.blogger.com/share-post.g?blogID=3932878064881956934&postID=7496832723622885651&target=twitter "Share to X")
[Share to Facebook](https://www.blogger.com/share-post.g?blogID=3932878064881956934&postID=7496832723622885651&target=facebook "Share to Facebook")

#### 10 comments :

1. ![](//www.blogger.com/img/blogger_logo_round_35.png)[3n4t5yu6io](https://www.blogger.com/profile/12453150270310506192)[August 29, 2018 at 8:07 AM](https://www.voidsecurity.in/2018/08/from-compiler-optimization-to-code.html?showComment=1535510240721#c4411604916712135157)

   excellent

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=3932878064881956934&postID=4411604916712135157)Replies
   - ![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhgjbB_2lopZfQ0Y54zNluwcaFSh-pv0BiILYtDBKQHUGudApZopkXz2di9qFMVtWJWRVKXjX0fRgb3wako8bvh_-6kRMPjx-C_48RVdzHYsqXPlbTePCLSRtpTI-wGjA/s45-c/*)[Reno Robert](https://www.blogger.com/profile/01980174423078410529)[August 29, 2018 at 9:53 PM](https://www.voidsecurity.in/2018/08/from-compiler-optimization-to-code.html?showComment=1535559784014#c7845071484178851381)

     Thanks!

     [Delete](https://www.blogger.com/delete-comment.g?blogID=3932878064881956934&postID=7845071484178851381)Replies
     Reply
   Reply
2. ![](//www.blogger.com/img/blogger_logo_round_35.png)[nullptr](https://www.blogger.com/profile/11186103388271684699)[August 29, 2018 at 1:43 PM](https://www.voidsecurity.in/2018/08/from-compiler-optimization-to-code.html?showComment=1535530382206#c7895070312717650902)

   just awesome

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=3932878064881956934&postID=7895070312717650902)Replies
   Reply
3. ![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhgjbB_2lopZfQ0Y54zNluwcaFSh-pv0BiILYtDBKQHUGudApZopkXz2di9qFMVtWJWRVKXjX0fRgb3wako8bvh_-6kRMPjx-C_48RVdzHYsqXPlbTePCLSRtpTI-wGjA/s45-c/*)[Reno Robert](https://www.blogger.com/profile/01980174423078410529)[August 29, 2018 at 9:53 PM](https://www.voidsecurity.in/2018/08/from-compiler-optimization-to-code.html?showComment=1535559802350#c7595624508354503603)

   Thanks!

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=3932878064881956934&postID=7595624508354503603)Replies
   Reply
4. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Valentin Shilnenkov](https://www.blogger.com/profile/09846698158007506540)[August 30, 2018 at 11:27 AM](https://www.voidsecurity.in/2018/08/from-compiler-optimization-to-code.html?showComment=1535608673001#c6037703026084959321)

   Thanks for post)
   I have a question. What is about relative offset between VRAM and VBoxDD.so because of ASLR affects them or not?

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=3932878064881956934&postID=6037703026084959321)Replies
   - ![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhgjbB_2lopZfQ0Y54zNluwcaFSh-pv0BiILYtDBKQHUGudApZopkXz2di9qFMVtWJWRVKXjX0fRgb3wako8bvh_-6kRMPjx-C_48RVdzHYsqXPlbTePCLSRtpTI-wGjA/s45-c/*)[Reno Robert](https://www.blogger.com/profile/01980174423078410529)[August 31, 2018 at 10:17 AM](https://www.voidsecurity.in/2018/08/from-compiler-optimization-to-code.html?showComment=1535690852109#c4510184269546745253)

     Valentin,

     The relative offset between VRAM and VBoxDD.so remains the same in the Ubuntu host I tested. There is no randomization between shared libs/mmap'ed pages etc or load order randomization.

     [Delete](https://www.blogger.com/delete-comment.g?blogID=3932878064881956934&postID=4510184269546745253)Replies
     Reply
   Reply
5. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/16086480983574146551)[September 11, 2018 at 1:52 PM](https://www.voidsecurity.in/2018/08/from-compiler-optimization-to-code.html?showComment=1536654137073#c6854520227217422058)

   Do the vbox newer version still have VRAM remaining rwx? Or Oracle fixed it?

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=3932878064881956934&postID=6854520227217422058)Replies
   - ![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhgjbB_2lopZfQ0Y54zNluwcaFSh-pv0BiILYtDBKQHUGudApZopkXz2di9qFMVtWJWRVKXjX0fRgb3wako8bvh_-6kRMPjx-C_48RVdzHYsqXPlbTePCLSRtpTI-wGjA/s45-c/*)[Reno Robert](https://www.blogger.com/profile/01980174423078410529)[November 1, 2018 at 9:38 PM](https://www.voidsecurity.in/2018/08/from-compiler-optimization-to-code.html?showComment=1541088505080#c1177826130618595269)

     I didn't check the recent one, but VRAM is RWX even in 5.2.x based on this post https://blogs.securiteam.com/index.php/archives/3736

     [Delete](https://www.blogger.com/delete-comment.g?blogID=3932878064881956934&postID=1177826130618595269)Replies
     Reply
   Reply
6. ![](//resources.blogblog.com/img/blank.gif)Anonymous[September 11, 2018 at 2:31 PM](https://www.voidsecurity.in/2018/08/from-compiler-optimization-to-code.html?showComment=1536656501210#c5441972559949326294)

   Very nice work

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=3932878064881956934&postID=5441972559949326294)Replies
   - ![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhgjbB_2lopZfQ0Y54zNluwcaFSh-pv0BiILYtDBKQHUGudApZopkXz2di9qFMVtWJWRVKXjX0fRgb3wako8bvh_-6kRMPjx-C_48RVdzHYsqXPlbTePCLSRtpTI-wGjA/s45-c/*)[Reno Robert](https://www.blogger.com/profile/01980174423078410529)[November 1, 2018 at 9:38 PM](https://www.voidsecurity.in/2018/08/from-compiler-optimization-to-code.html?showComment=1541088515985#c8105133519797177316)

     Thanks!

     [Delete](https://www.blogger.com/delete-comment.g?blogID=3932878064881956934&postID=8105133519797177316)Replies
     Reply
   Reply

Add commentLoad more...

[Newer Post](https://www.voidsecurity.in/2018/11/virtualbox-vmsvga-vm-escape.html "Newer Post")

[Older Post](https://www.voidsecurity.in/2018/08/real-world-ctf-kidvm.html "Older Post")

[Home](https://www.voidsecurity.in/)

Subscribe to:
[Post Comments
(
Atom
)](https://www.voidsecurity.in/feeds/7496832723622885651/comments/default)

## About Me

[![My Photo](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhgjbB_2lopZfQ0Y54zNluwcaFSh-pv0BiILYtDBKQHUGudApZopkXz2di9qFMVtWJWRVKXjX0fRgb3wako8bvh_-6kRMPjx-C_48RVdzHYsqXPlbTePCLSRtpTI-wGjA/s1600/*)](https://www.blogger.com/profile/01980174423078410529)
[Reno Robert](https://www.blogger.com/profile/01980174423078410529)

[View my complete profile](https://www.blogger.com/profile/01980174423078410529)

[Follow @renorobertr](https://twitter.com/renorobertr)

## Blog Archive

* ►
  [2019](https://www.voidsecurity.in/2019/)
  + ►
    [January](https://www.voidsecurity.in/2019/01/)

* ▼
  [2018](https://www.voidsecurity.in/2018/)
  + ►
    [November](https://www.voidsecurity.in/2018/11/)
  + ▼
    [August](https://www.voidsecurity.in/2018/08/)
    - [From Compiler Optimization to Code Execution - Vir...](https://www.voidsecurity.in/2018/08/from-compiler-optimization-to-code.html)
    - [Real World CTF - kid\_vm](https://www.voidsecurity.in/2018/08/real-world-ctf-kidvm.html)

* ►
  [2017](https://www.voidsecurity.in/2017/)
  + ►
    [July](https://www.voidsecurity.in/2017/07/)

* ►
  [2016](https://www.voidsecurity.in/2016/)
  + ►
    [April](https://www.voidsecurity.in/2016/04/)
  + ►
    [February](https://www.voidsecurity.in/2016/02/)

* ►
  [2015](https://www.voidsecurity.in/2015/)
  + ►
    [December](https://www.voidsecurity.in/2015/12/)
  + ►
    [October](https://www.voidsecurity.in/2015/10/)
  + ►
    [September](https://www.voidsecurity.in/2015/09/)
  + ►
    [July](https://www.voidsecurity.in/2015/07/)
  + ►
    [June](https://www.voidsecurity.in/2015/06/)
  + ►
    [April](https://www.voidsecurity.in/2015/04/)
  + ►
    [February](https://www.voidsecurity.in/2015/02/)
  + ►
    [January](https://www.voidsecurity.in/2015/01/)

* ►
  [2014](https://www.voidsecurity.in/2014/)
  + ►
    [December](https://www.voidsecurity.in/2014/12/)
  + ►
    [October](https://www.voidsecurity.in/2014/10/)
  + ►
    [September](https://www.voidsecurity.in/2014/09/)
  + ►
    [August](https://www.voidsecurity.in/2014/08/)
  + ►
    [July](https://www.voidsecurity.in/2014/07/)
  + ►
    [May](https://www.voidsecurity.in/2014/05/)
  + ►
    [March](https://www.voidsecurity.in/2014/03/)
  + ►
    [February](https://www.voidsecurity.in/2014/02/)
  + ►
    [January](https://www.voidsecurity.in/2014/01/)

* ►
  [2013](https://www.voidsecurity.in/2013/)
  + ►
    [December](https://www.voidsecurity.in/2013/12/)
  + ►
    [November](https://www.voidsecurity.in/2013/11/)
  + ►
    [October](https://www.voidsecurity.in/2013/10/)
  + ►
    [September](https://www.voidsecurity.in/2013/09/)
  + ►
    [August](https://www.voidsecurity.in/2013/08/)
  + ►
    [July](https://www.voidsecurity.in/2013/07/)
  + ►
    [June](https://www.voidsecurity.in/2013/06/)
  + ►
    [May](https://www.voidsecurity.in/2013/05/)
  + ►
    [April](https://www.voidsecurity.in/2013/04/)
  + ►
    [March](https://www.voidsecurity.in/2013/03/)
  + ►
    [February](https://www.voidsecurity.in/2013/02/)
  + ►
    [January](https://www.voidsecurity.in/2013/01/)

* ►
  [2012](https://www.voidsecurity.in/2012/)
  + ►
    [December](https://www.voidsecurity.in/2012/12/)
  + ►
    [November](https://www.voidsecurity.in/2012/11/)
  + ►
    [October](https://www.voidsecurity.in/2012/10/)
  + ►
    [September](https://www.voidsecurity.in/2012/09/)

## Labels

* [Exploitation](https://www.voidsecurity.in/search/label/Exploitation)
* [Crypto](https://www.voidsecurity.in/search/label/Crypto)
* [2014](https://www.voidsecurity.in/search/label/2014)
* [Reverse](https://www.voidsecurity.in/search/label/Reverse)
* [2015](https://www.voidsecurity.in/search/label/2015)
* [Exploit Exercise](https://www.voidsecurity.in/search/label/Exploit%20Exercise)
* [ROP](https://www.voidsecurity.in/search/label/ROP)
* [Hackim](https://www.voidsecurity.in/search/label/Hackim)
* [CSAW15](https://www.voidsecurity.in/search/label/CSAW15)
* [Hack You CTF](https://www.voidsecurity.in/search/label/Hack%20You%20CTF)
* [Cscamp CTF Quals](https://www.voidsecurity.in/search/label/Cscamp%20CTF%20Quals)
* [2016](https://www.voidsecurity.in/search/label/2016)
* [Boston Key Party CTF](https://www.voidsecurity.in/search/label/Boston%20Key%20Party%20CTF)
* [Codegate CTF](https://www.voidsecurity.in/search/label/Codegate%20CTF)
* [Hack You Too CTF](https://www.voidsecurity.in/search/label/Hack%20You%20Too%20CTF)
* [Plaid CTF](https://www.voidsecurity.in/search/label/Plaid%20CTF)
* [RSA](https://www.voidsecurity.in/search/label/RSA)
* [Bug](https://www.voidsecurity.in/search/label/Bug)
* [EB CTF](https://www.voidsecurity.in/search/label/EB%20CTF)
* [Volga CTF](https://www.voidsecurity.in/search/label/Volga%20CTF)
* [32C3 CTF](https://www.voidsecurity.in/search/label/32C3%20CTF)
* [DIMVA CTF](https://www.voidsecurity.in/search/label/DIMVA%20CTF)
* [Defcon](https://www.voidsecurity.in/search/label/Defcon)
* [InCTF](https://www.voidsecurity.in/search/label/InCTF)
* [PoliCTF](https://www.voidsecurity.in/search/label/PoliCTF)
* [Pwnium CTF](https://www.voidsecurity.in/search/label/Pwnium%20CTF)
* [SIGINT CTF](https://www.voidsecurity.in/search/label/SIGINT%20CTF)
* [UAF](https://www.voidsecurity.in/search/label/UAF)
* [2018](https://www.voidsecurity.in/search/label/2018)
* [29C3 CTF](https://www.voidsecurity.in/search/label/29C3%20CTF)
* [AES](https://www.voidsecurity.in/search/label/AES)
* [Backdoor CTF](https://www.voidsecurity.in/search/label/Backdoor%20CTF)
* [Balt CTF](https://www.voidsecurity.in/search/label/Balt%20CTF)
* [CSAW CTF](https://www.voidsecurity.in/search/label/CSAW%20CTF)
* [ForbiddenBITS CTF](https://www.voidsecurity.in/search/label/ForbiddenBITS%20CTF)
* [GITS CTF](https://www.voidsecurity.in/search/label/GITS%20CTF)
* [Information Leak](https://www.voidsecurity.in/search/label/Information%20Leak)
* [KVM](https://www.voidsecurity.in/search/label/KVM)
* [Knapsack](https://www.voidsecurity.in/search/label/Knapsack)
* [RuCTF Quals](https://www.voidsecurity.in/search/label/RuCTF%20Quals)
* [UFO CTF](https://www.voidsecurity.in/search/label/UFO%20CTF)
* [VM escape](https://www.voidsecurity.in/search/label/VM%20escape)
* [Web](https://www.voidsecurity.in/search/label/Web)

## Popular Posts

* [Exploit Exercise - Orphan Process and Race Condition](https://www.voidsecurity.in/2012/09/blog-post.html)

  Lets see how to solve level [19] in Nebula. The code given checks whether its parent process is root using /proc entry. int mai...
* [From Compiler Optimization to Code Execution - VirtualBox VM Escape - CVE-2018-2844](https://www.voidsecurity.in/2018/08/from-compiler-optimization-to-code.html)

  Oracle fixed some of the issues I reported in VirtualBox during the Oracle Critical Patch Update - April 2018. CVE-2018-2844 was an inter...
* [Return to VDSO using ELF Auxiliary Vectors](https://www.voidsecurity.in/2014/12/return-to-vdso-using-elf-auxiliary.html)

  This post is about exploiting a minimal binary without SigReturn Oriented Programming (SROP). Below is demo code, thanks to my frie...
* [Exploit Exercise - Python Pickles](https://www.voidsecurity.in/2012/10/exploit-exercise-python-pickles.html)

  Level [ 17 ] in nebula is pretty straight forward. The first look of it reveals the use of python's potentially vulnerable fun...
* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiWRykneMWwY58-kIzE47v9LdBxNlrUv9I-3ar6as4zlRggBt_AENELQ3vlokruNZImI7IlbEbj4Lw4T966cWhTDtQLjQ0INEpTvq_JnZZX5gzfjbAFBahUklDCXdovBjqFxam1_tLIjCVC/s72-w1046-c-h459-no/image+1.jpeg)](https://www.voidsecurity.in/2013/05/defeating-anti-debugging-techniques.html)

  [Defeating anti-debugging techniques using IDA and x86 emulator plugin](https://www.voidsecurity.in/2013/05/defeating-anti-debugging-techniques.html)

  Recently I was trying to reverse a small crackme by Tosh. The challenge was to find a password by reversing the binary, bypassing ...
* [Exploiting PHP Bug #66550 - SQLite prepared statement use-after-free - [A local PHP exploit]](https://www.voidsecurity.in/2015/04/exploiting-php-bug-66550-sqlite.html)

  As the title says, this bug is useful only for post exploitation to bypass protections when the attacker already has arbitrary PHP...
* [VirtualBox NAT DHCP/BOOTP server vulnerabilities](https://www.voidsecurity.in/2018/11/virtualbox-nat-dhcpbootp-server.html)

  Continuing from my previous blog posts, this is another old set of VirtualBox bugs which can lead to VM escape. VirtualBox guest in NAT m...
* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhdsXrIhTFHfq9wbAm2xROAZ7fM65L-WLrw5jNaxQZfWm7kxC3x_eOcLcQd2OlueBROmtbBDmEc6_wvRPMm9F-fo5TBewAr8bQdva8iznJbe7jwwyBm0LPcquot8e9EgNchqY8QN1yFjfhO/s72-c/SinglyLinkedListGraph.png)](https://www.voidsecurity.in/2015/04/data-structure-recovery-using-pin-and.html)

  [Data Structure Recovery using PIN and PyGraphviz](https://www.voidsecurity.in/2015/04/data-structure-recovery-using-pin-and.html)

  This is a simple POC PIN tool to recover data structures in dynamically linked stripped executables, mainly for analyzing small pr...
* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgab7LcfufzWoou4ctu5ldYcm6ABRtDLVVhb8TegW2nQX5hRHCDnEbRY6V2g0xBXIoIGyN_zbL4dkrvam7Ilvq-ANM5n_eqJkOvixosGg45z0BKG2pRTK7487mO27jBXybgV6BWe_OERTft/s72-c/Untitled+drawing+%25286%2529.png)](https://www.voidsecurity.in/2018/11/virtualbox-vmsvga-vm-escape.html)

  [VirtualBox VMSVGA VM Escape](https://www.voidsecurity.in/2018/11/virtualbox-vmsvga-vm-escape.html)

  VirtualBox emulates VMware virtual SVGA device whose interface details and programming model is available publicly [2]. Moreover, the pap...
* [Revisiting Defcon CTF Shitsco Use-After-Free Vulnerability - Remote Code Execution](https://www.voidsecurity.in/2015/02/revisiting-defcon-ctf-shitsco-use-after.html)

  Defcon Quals 2014 Shitsco was an interesting challenge. There were two vulnerability in the binary - strcmp information leak and ...

## Followers

|  |  |
| --- | --- |

Powered by [Blogger](https://www.blogger.com).

