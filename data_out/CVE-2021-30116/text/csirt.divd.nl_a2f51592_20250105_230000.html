
[Skip to the content.](#content)

[Home](/) / [Blog](/blog/) / Kaseya vsa limited disclosure

# DIVD CSIRT

Making the internet safer through Coordinated Vulnerability Disclosure

 Menu

* [Home](/)
  + [DIVD](https://www.divd.nl)
  + [CSIRT](/)
* [Cases](/cases/)
  + [DIVD-2024-00052 - Remote code execution in Cleo Harmony, VLCTrader and Lexi

    Cleo has identified an unrestricted file upload and download vulnerability ...](/cases/DIVD-2024-00052/)
  + [DIVD-2024-00051 - Improper authorization vulnerabilty in ProjectSend,

    Improper authorization vulnerabilty, CVE-2024-11680, in open-source file-sh...](/cases/DIVD-2024-00051/)
  + [DIVD-2024-00050 - Path traversal vulnerabilty in Mitel MiCollab

    A path traversal vulnerability, CVE-2024-41713, in the NuPoint Unified Mess...](/cases/DIVD-2024-00050/)
  + [DIVD-2024-00049 - Vulnerabilities in D-Link NAS: Backdoor and Command Injec

    D-Link NAS are affected by a backdoor vulnerability facilitated by hardcode...](/cases/DIVD-2024-00049/)
  + [DIVD-2024-00048 - VMware vCenter Server heap-overflow and remote code execu

    The vCenter Server contains a heap-overflow vulnerability and a privilege e...](/cases/DIVD-2024-00048/)
  + [DIVD-2024-00047 - Multiple critical vulnerablilties in Palo Alto Networks P

    An authentication bypass in Palo Alto Networks PAN-OS software (CVE-2024-00...](/cases/DIVD-2024-00047/)
  + [DIVD-2024-00046 - Multiple critical vulnerablilties in Ivanti Cloud Service

    Ivanti CSA is affected by two critical vulnerabilities, allowing a remote u...](/cases/DIVD-2024-00046/)
  + [DIVD-2024-00045 - SysAid ITSM SQL Injection vulnerability

    In March 2024, a SQL Injection vulnerability has been discovered in SysAid ...](/cases/DIVD-2024-00045/)
  + [DIVD-2024-00044 - Missing authentication in Fortinet FortiManager fgfmsd

    A missing authentication for critical function vulnerability [CWE-306] in F...](/cases/DIVD-2024-00044/)
  + [DIVD-2024-00042 - Multiple critical vulnerabilities in Solarwinds Web Help

    The SolarWinds Web Help Desk software is affected by three critical vulnera...](/cases/DIVD-2024-00042/)
  + [DIVD-2024-00041 - Progress Software WhatsUp Gold SQL Injection Authenticati

    A SQL Injection vulnerability allows an unauthenticated attacker to retriev...](/cases/DIVD-2024-00041/)
  + [DIVD-2024-00040 - Zimbra Collaboration (ZCS) vulnerable for RCE under speci

    The postjournal in Zimbra Collaboration (ZCS) sometimes allows unauthentica...](/cases/DIVD-2024-00040/)
  + [DIVD-2024-00039 - Incorrect authorization vulnerability in Apache OFBiz res

    In Apache OFBiz, version 18.12.14 and below, an Incorrect Authorization vul...](/cases/DIVD-2024-00039/)
  + [DIVD-2024-00038 - Remote Code Execution CUPS

    A remote attacker can replace or install printers with malicious IPP URLs, ...](/cases/DIVD-2024-00038/)
  + [DIVD-2024-00033 - ServiceNow - unauthenticated remote code execution (RCE)

    Multiple vulnerabilities have been found in ServiceNow. Combining these vul...](/cases/DIVD-2024-00033/)
  + [DIVD-2024-00032 - Unauthenticated Remote Code Execution (RCE) vulnerability

    Geoserver has a Remote Code Execution (RCE) vulnerability in evaluating pro...](/cases/DIVD-2024-00032/)
  + [DIVD-2024-00031 - Unauthenticated Local File Inclusion vulnerability in Com

    An Unautheticated Local File Inclusion vulnerability has been found in Comf...](/cases/DIVD-2024-00031/)
  + [DIVD-2024-00030 - Zyxel NAS - unauthenticated OS command injection

    Multiple vulnerabilities have been found in the firmware of the Zyxel NAS d...](/cases/DIVD-2024-00030/)
  + [DIVD-2024-00029 - VMware vCenter Server multiple heap-overflow vulnerabilit

    The vCenter Server contains multiple heap-overflow vulnerabilities in the i...](/cases/DIVD-2024-00029/)
  + [DIVD-2024-00028 - Local File Inclusion in SolarWinds U-Serv

    SolarWinds U-Serv was susceptible to a Path Traversal vulnerability, result...](/cases/DIVD-2024-00028/)
  + [All cases](/cases/)
* [CVEs](/cves/)
  + [CVE-2024-27120 - Local File Inclusion in ComfortKey before version 24.1.2...](/cves/CVE-2024-27120/)
  + [CVE-2024-27115 - Remote Code Execution through File Upload in SOPlanning befo...](/cves/CVE-2024-27115/)
  + [CVE-2024-27114 - Remote Code Execution through File Upload in SOPlanning befo...](/cves/CVE-2024-27114/)
  + [CVE-2024-27113 - Insecure Direct Object Reference to export Database in SOPla...](/cves/CVE-2024-27113/)
  + [CVE-2024-27112 - SQL Injection in SOPlanning before 1.52.02...](/cves/CVE-2024-27112/)
  + [CVE-2024-21881 - Upload of encrypted packages allows authenticated command ex...](/cves/CVE-2024-21881/)
  + [CVE-2024-21880 - URL parameter manipulations allows an authenticated attacker...](/cves/CVE-2024-21880/)
  + [CVE-2024-21879 - URL parameter manipulations allows an authenticated attacker...](/cves/CVE-2024-21879/)
  + [CVE-2024-21878 - Command Injection through Unsafe File Name Evaluation in int...](/cves/CVE-2024-21878/)
  + [CVE-2024-21877 - Insecure File Generation Based on User Input in Enphase IQ G...](/cves/CVE-2024-21877/)
  + [More...](/cves/)
* [CNA](/cna/)
* [Stolen credentials](/credentials/)
* [Blog](/blog/)
  + [2024-08-12 : Research of Wietse Boonstra and Hidde Smit featured in Follow the Money and...](/2024/08/12/DIVD-researchers-in-the-media/)
  + [2024-05-30 : DIVD CSIRT performs victim notification for Operation Endgame...](/2024/05/30/Endgame/)
  + [2024-04-25 : DIVD CSIRT Congratulates Project Melissa...](/2024/04/25/Congratulations-to-Project-Melissa/)
  + [2023-07-10 : Limited disclosure of 6 vulnerabilities in OSNexus Quantastor...](/2023/07/10/Limited-disclosure-OSNexus-vulnerabilities/)
  + [2023-02-24 : DIVDâs response regard the involvement of a DIVD volunteer in a major data ...](/2023/02/24/DIVD-reaction-data-theft-case/)
  + [2023-01-18 : Fox-IT and DIVD cooperate to warn owners of vulnerable Citrix servers...](/2023/01/18/Cooperation-Fox-IT-and-DIVD/)
  + [2022-12-14 : Fortinet sslvpnd vulnerability - update...](/2022/12/14/DIVD-2022-00063-Fortinet-sslvpnd-update/)
  + [2022-12-13 : Fortinet SSL VPN Vulnerability...](/2022/12/13/DIVD-2022-00063-Fortinet-SSL-VPN/)
  + [2022-08-15 : Closing GeyNoise Ukraine Only case...](/2022/08/15/Closing-DIVD-2022-00014-GrayNoise-Ukraine-Only/)
  + [2022-08-10 : Itarian Full disclosure...](/2022/08/10/Itarian-Full-Disclosure/)
  + [More...](/blog)
* [Donate](https://www.divd.nl/donate/)
* [Search...](/search/)
* [RSS](/feed.xml)
* [Contact](/contact/)

# Kaseya VSA Limited Disclosure

07 Jul 2021 -
[Frank Breedijk](https://www.divd.nl/who-we-are/team/people/frank-breedijk/)

## Why we are only disclosing limited details on the Kaseya vulnerabilities

Last weekend we found ourselves in the middle of a storm. A storm created by the ransomware attacks executed via Kaseya VSA, using a vulnerability which we confidentially disclosed to Kaseya, together with six other vulnerabilities.

Ever since we released the news that we indeed notified Kaseya of a vulnerability used in the ransomware attack, we have been getting requests to release details about these vulnerabilities and the disclosure timeline. In line with the guidelines for [Coordinated Vulnerability Disclosure](https://english.ncsc.nl/publications/publications/2019/juni/01/coordinated-vulnerability-disclosure-the-guideline) we have not disclosed any details so far. And, while we feel it is time to be more open about this process and our decisions regarding this matter, we will still not release the full details.

## Why the secrecy?

As the ransomware attack using Kaseya VSA software has shown, the effects of a malicious actor knowing the full details of a vulnerability can be devastating. This immediately poses a dilemma to anybody that discovers a critical vulnerability in a critical piece of software, do we disclose the details or not?

Letâs use an analogy. Say a security researcher discovers a vulnerability in a high-end car. When you kick the left rear bumper in just the right way, the car doors open, and the engine starts. What should the researcher do? Tell everybody, tell all the owners of this type of car, or inform the manufacturer so he can recall and fix the car?

If the full details are made public, it is evident that many cars will get stolen very soon. If you inform the owners, this will likely happen too. The chances of the details remaining secret are slim if you inform a broad audience. Even if you limit the details to âa security issue involving the bumperâ, you might tip off the wrong people. Telling the manufacturer there is a good chance that he comes up with a fix before large-scale car thefts are happening, and consider if you need to tell the owners to keep their car behind closed doors in the meantime.

## How does this relate to Kaseya VSA?

When we discovered the vulnerabilities in early April, it was evident to us that we could not let these vulnerabilities fall into the wrong hands. After some deliberation, we decided that informing the vendor and awaiting the delivery of a patch was the right thing to do. We hypothesized that, in the wrong hands, these vulnerabilities could lead to the compromise of large numbers of computers managed by Kaseya VSA.

As we stated before, Kaseyaâs response to our disclosure has been on point and timely; unlike other vendors, we have previously disclosed vulnerabilities to. They listened to our findings, and addressed some of them by releasing a [patch](https://helpdesk.kaseya.com/hc/en-gb/articles/360019054377-9-5-5-Feature-Release-10-April-2021) resolving a number of these vulnerabilities. Followed by a [second patch](https://helpdesk.kaseya.com/hc/en-gb/articles/360019966738-9-5-6-Feature-Release-8-May-2021) resolving even more. Weâve been in contact with Kaseya ahead of the release of both these patches, allowing us to validate that these vulnerabilities had indeed been resolved by the patch in development.

Unfortunately, the worst-case scenario came true on Friday the 2nd of July. Kaseya VSA was used in an attack to spread ransomware, and Kaseya was compelled to use the nuclear option: shutting down their Kaseya Cloud and advising customers to turn off their on-premise Kaseya VSA servers. A message that unfortunately arrived too late for some of their customers.

We later learned that one of the two vulnerabilities used in the attack was one we previously disclosed to Kasya VSA.

## What can we tell?

In this blogpost and DIVD case [DIVD-2021-00011](https://csirt.divd.nl/DIVD-2021-00011/) we publish the timeline and limited details of the vulnerabilities we notified Kaseya of.

## Full disclosure?

Given the serious nature of these vulnerabilities and the obvious consequences of abuse of Kaseya VSA we will not disclose the full details of the vulnerabilities until such time that Kaseya has released a patch and this patch has been installed on a sufficient number of systems, something for which we have the monitoring scripts. In the past few days we have been working with Kaseya to make sure customers turn off their systems, by tipping them off about customers that still have systems online, and hope to be able to continue to work together to ensure that their patch is installed everywhere. We have no indication that Kaseya is hesitant to release a patch. Instead they are still working hard to make sure that after their patch the system is as secure as possible, to avoid a repeat of this scenario. Therefore we do not feel the need to lay down any kind of deadline for full disclosure at this point in time. A properly patched and secure Kaseya VSA is in the best interest of security of Kaseya customers and the internet at large.

## The vulnerabilities

We notified Kaseya of the following vulnerabilities:

* [CVE-2021-30116](https://csirt.divd.nl/cves/CVE-2021-30116) - A credentials leak and business logic flaw, resolution in progress.
* [CVE-2021-30117](https://csirt.divd.nl/cves/CVE-2021-30117) - An SQL injection vulnerability, resolved in May 8th patch.
* [CVE-2021-30118](https://csirt.divd.nl/cves/CVE-2021-30118) - A Remote Code Execution vulnerability, resolved in April 10th patch. (v9.5.6)
* [CVE-2021-30119](https://csirt.divd.nl/cves/CVE-2021-30119) - A Cross Site Scripting vulnerability, resolution in progress.
* [CVE-2021-30120](https://csirt.divd.nl/cves/CVE-2021-30120) - 2FA bypass, resolution in progress.
* [CVE-2021-30121](https://csirt.divd.nl/cves/CVE-2021-30121) - A Local File Inclusion vulnerability, resolved in May 8th patch.
* [CVE-2021-30201](https://csirt.divd.nl/cves/CVE-2021-30201) - A XML External Entity vulnerability, resolved in May 8th patch.

## Timeline

| Date | Description |
| --- | --- |
| 01 Apr 2021 | Research start |
| 02 Apr 2021 | DIVD starts scanning internet-facing implementations. |
| 04 Apr 2021 | Start of the identification of possible victims (with internet-facing systems). |
| 06 Apr 2021 | Kaseya informed. |
| 10 Apr 2021 | Vendor starts issuing [patches v9.5.5](https://helpdesk.kaseya.com/hc/en-gb/articles/360019054377-9-5-5-Feature-Release-10-April-2021). Resolving CVE-2021-30118. |
| 8 May 2021 | Vendor issues another [patch v9.5.6](https://helpdesk.kaseya.com/hc/en-gb/articles/360019966738-9-5-6-Feature-Release-8-May-2021). Resolving CVE-2021-30117, CVE-2021-30121, CVE-2021-30201. |
| 04 Jun 2021 | DIVD CSIRT hands over a list of identified Kaseya VSA hosts to Kaseya. |
| 26 Jun 2021 | [9.5.7 on SaaS](https://helpdesk.kaseya.com/hc/en-gb/articles/4403021283217-9-5-7-Feature-Release-26-June-2021-) Resolving CVE-2021-30116 and CVE-2021-30119. |
| 02 Jul 2021 | DIVD responds to the ransomware, by scanning for Kaseya VSA instances reachable via the Internet and sends out notifications to network owners |
| 07 Jul 2021 | Limited publication (after 3 months). |

---

Last modified: 18 Jan 2023 13:28 CET

* [Twitter](https://twitter.com/DIVDnl)
* [LinkedIn](https://www.linkedin.com/company/divd-nl)

