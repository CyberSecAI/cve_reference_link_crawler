
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpyca%2Fcryptography%2Fpull%2F9208)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpyca%2Fcryptography%2Fpull%2F9208)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=pyca%2Fcryptography)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pyca](/pyca)
/
**[cryptography](/pyca/cryptography)**
Public

* [Notifications](/login?return_to=%2Fpyca%2Fcryptography) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Fpyca%2Fcryptography)
* [Star
   6.8k](/login?return_to=%2Fpyca%2Fcryptography)

* [Code](/pyca/cryptography)
* [Issues
  44](/pyca/cryptography/issues)
* [Pull requests
  8](/pyca/cryptography/pulls)
* [Actions](/pyca/cryptography/actions)
* [Security](/pyca/cryptography/security)
* [Insights](/pyca/cryptography/pulse)

Additional navigation options

* [Code](/pyca/cryptography)
* [Issues](/pyca/cryptography/issues)
* [Pull requests](/pyca/cryptography/pulls)
* [Actions](/pyca/cryptography/actions)
* [Security](/pyca/cryptography/security)
* [Insights](/pyca/cryptography/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpyca%2Fcryptography%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpyca%2Fcryptography%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix encoding of SSH certs with critical options #9208

 Merged

[reaperhulk](/reaperhulk)
merged 3 commits into
[pyca:main](/pyca/cryptography/tree/main "pyca/cryptography:main")
from
[lkubb:ssh-critical-options](/lkubb/pyca-cryptography/tree/ssh-critical-options "lkubb/pyca-cryptography:ssh-critical-options")

Jul 10, 2023

 Merged

# [Fix encoding of SSH certs with critical options](#top) #9208

[reaperhulk](/reaperhulk)
merged 3 commits into
[pyca:main](/pyca/cryptography/tree/main "pyca/cryptography:main")
from
[lkubb:ssh-critical-options](/lkubb/pyca-cryptography/tree/ssh-critical-options "lkubb/pyca-cryptography:ssh-critical-options")

Jul 10, 2023

[Conversation
10](/pyca/cryptography/pull/9208)
[Commits
3](/pyca/cryptography/pull/9208/commits)
[Checks
0](/pyca/cryptography/pull/9208/checks)
[Files changed](/pyca/cryptography/pull/9208/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![lkubb](https://avatars.githubusercontent.com/u/2163936?s=60&v=4)](/lkubb)

Copy link

Contributor

### @lkubb **[lkubb](/lkubb)** commented [Jul 10, 2023](#issue-1796435215) ‚Ä¢ edited Loading

This corrects loading and serialization of SSH certificate critical options/extensions with non-empty values. Note that it does not add support for value types other than `string` since there is no official option that uses any.

Also breaks loading of certificates that were generated with previous versions of `cryptography`, I'm not sure if you want to keep backwards-compatibility with that custom format.

Thanks for your hard work on `cryptography`!

Fixes: [#9207](https://github.com/pyca/cryptography/issues/9207)

Sorry, something went wrong.

All reactions

 [lkubb](/lkubb)
added 2 commits
[July 10, 2023 12:09](#commits-pushed-7ff431e)

[![@lkubb](https://avatars.githubusercontent.com/u/2163936?s=40&v=4)](/lkubb)

`[Add tests for issue](/pyca/cryptography/pull/9208/commits/7ff431e8baa6403f397b36f9ab1a965dcb66e8fd "Add tests for issue #9207") [pyca#9207](https://github.com/pyca/cryptography/issues/9207)`

`[7ff431e](/pyca/cryptography/pull/9208/commits/7ff431e8baa6403f397b36f9ab1a965dcb66e8fd)`

[![@lkubb](https://avatars.githubusercontent.com/u/2163936?s=40&v=4)](/lkubb)

`[Fix encoding of SSH certs with critical options](/pyca/cryptography/pull/9208/commits/041a66c8aa4b8d5fc6b03579ec77b519d87c75dd "Fix encoding of SSH certs with critical options")`

`[041a66c](/pyca/cryptography/pull/9208/commits/041a66c8aa4b8d5fc6b03579ec77b519d87c75dd)`

[![@alex](https://avatars.githubusercontent.com/u/772?s=80&u=7c00c7c8ac3691da556d7686e16ff08b797d4a38&v=4)](/alex)

Copy link

Member

### **[alex](/alex)** commented [Jul 10, 2023](#issuecomment-1628726829)

| Thanks for sending a PR. Can you please add an extra test case so that this has full coverage? |
| --- |

All reactions

Sorry, something went wrong.

[![@lkubb](https://avatars.githubusercontent.com/u/2163936?s=80&v=4)](/lkubb)

Copy link

Contributor

Author

### **[lkubb](/lkubb)** commented [Jul 10, 2023](#issuecomment-1628730099)

| Thanks for sending a PR. Can you please add an extra test case so that this has full coverage?  Yup, on it already. Would it be sufficient to add a single new vector that tests unexpected data for critical options only or should I add one for extensions as well? |
| --- |

All reactions

Sorry, something went wrong.

[![@alex](https://avatars.githubusercontent.com/u/772?s=80&u=7c00c7c8ac3691da556d7686e16ff08b797d4a38&v=4)](/alex)

Copy link

Member

### **[alex](/alex)** commented [Jul 10, 2023](#issuecomment-1628734410)

| Only one is required, but having both is fine. |
| --- |

 üëç
1
 lkubb reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@reaperhulk](https://avatars.githubusercontent.com/u/161495?s=80&u=5f0232a38e50d219b679bc014de04922fba33ae0&v=4)](/reaperhulk)

Copy link

Member

### **[reaperhulk](/reaperhulk)** commented [Jul 10, 2023](#issuecomment-1628745986)

| Thanks for catching this. That is a very confusing subtlety for a spec that is otherwise pretty well documented! |
| --- |

 üëç
1
 lkubb reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@lkubb](https://avatars.githubusercontent.com/u/2163936?s=40&v=4)](/lkubb)

`[Test unexpected additional values for crit opts/exts](/pyca/cryptography/pull/9208/commits/91c3f72d8bb6a9be8a6bebb0a8456b0ecd3298dc "Test unexpected additional values for crit opts/exts")`

`[91c3f72](/pyca/cryptography/pull/9208/commits/91c3f72d8bb6a9be8a6bebb0a8456b0ecd3298dc)`

[![@reaperhulk](https://avatars.githubusercontent.com/u/161495?s=80&u=5f0232a38e50d219b679bc014de04922fba33ae0&v=4)](/reaperhulk)

Copy link

Member

### **[reaperhulk](/reaperhulk)** commented [Jul 10, 2023](#issuecomment-1629083158)

| So when we encode an empty string for value should we expect to see `UNKNOWN FLAG OPTION` as part of the parsed output for ssh-keygen? |
| --- |

All reactions

Sorry, something went wrong.

[![@lkubb](https://avatars.githubusercontent.com/u/2163936?s=80&v=4)](/lkubb)

Copy link

Contributor

Author

### **[lkubb](/lkubb)** commented [Jul 10, 2023](#issuecomment-1629139559)

| So when we encode an empty string for value should we expect to see `UNKNOWN FLAG OPTION` as part of the parsed output for ssh-keygen?  No, empty strings should behave as before. `UNKNOWN FLAG OPTION` indicates the option/extension name is not specified as an official one. |
| --- |

All reactions

Sorry, something went wrong.

[![@reaperhulk](https://avatars.githubusercontent.com/u/161495?s=80&u=5f0232a38e50d219b679bc014de04922fba33ae0&v=4)](/reaperhulk)

Copy link

Member

### **[reaperhulk](/reaperhulk)** commented [Jul 10, 2023](#issuecomment-1629145194)

| When I parse `p256-ed25519-non-singular-ext-val.pub` I get:  ``` p256-ed25519-non-singular-ext-val.pub:         Type: ecdsa-sha2-nistp256-cert-v01@openssh.com user certificate         Public key: ECDSA-CERT SHA256:W6Wr6d8N5R5y1rzZl8L03NTgrxc8adxeET7GkXdJSvU         Signing CA: ED25519 SHA256:knottK/0LBWlxvM2cDgzzCJdQ0ppFlY/hzlHWlZTOLk (using ssh-ed25519)         Key ID: ""         Serial: 0         Valid: from 2022-12-31T18:00:00 to 2023-01-01T18:00:00         Principals: (none)         Critical Options:                  verify-required UNKNOWN FLAG OPTION         Extensions:                  contains-extra-value UNKNOWN OPTION: 0000000568656c6c6f0000000620776f726c64 (len 19)  ```  So we get the error in extensions that we expect, but I wouldn't have expected `verify-required` to display that message given that it is an official option. |
| --- |

All reactions

Sorry, something went wrong.

[![@lkubb](https://avatars.githubusercontent.com/u/2163936?s=80&v=4)](/lkubb)

Copy link

Contributor

Author

### **[lkubb](/lkubb)** commented [Jul 10, 2023](#issuecomment-1629153145)

| That is indeed surprising, I will investigate when I have the time later. Note that I cannot reproduce this with `ssh-keygen` 9.3:  ``` ssh-keygen -L -f vectors/cryptography_vectors/asymmetric/OpenSSH/certs/p256-ed25519-non-singular-ext-val.pub vectors/cryptography_vectors/asymmetric/OpenSSH/certs/p256-ed25519-non-singular-ext-val.pub:         Type: ecdsa-sha2-nistp256-cert-v01@openssh.com user certificate         Public key: ECDSA-CERT SHA256:W6Wr6d8N5R5y1rzZl8L03NTgrxc8adxeET7GkXdJSvU         Signing CA: ED25519 SHA256:knottK/0LBWlxvM2cDgzzCJdQ0ppFlY/hzlHWlZTOLk (using ssh-ed25519)         Key ID: ""         Serial: 0         Valid: from 2023-01-01T00:00:00 to 2023-01-02T00:00:00         Principals: (none)         Critical Options:                 verify-required         Extensions:                 contains-extra-value UNKNOWN OPTION: 0000000568656c6c6f0000000620776f726c64 (len 19) ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@lkubb](https://avatars.githubusercontent.com/u/2163936?s=80&v=4)](/lkubb)

Copy link

Contributor

Author

### **[lkubb](/lkubb)** commented [Jul 10, 2023](#issuecomment-1629249492)

| [@reaperhulk](https://github.com/reaperhulk)  It seems `verify-required` was added to `ssh-keygen` in release 9.1, hence it's unknown below that version:  * [ssh-keygen(1)](https://man.openbsd.org/ssh-keygen.1): implement the "verify-required" certificate option.   This was already documented when support for user-verified FIDO   keys was added, but the [ssh-keygen(1)](https://man.openbsd.org/ssh-keygen.1) code was missing.  <https://www.openssh.com/txt/release-9.1> |
| --- |

All reactions

Sorry, something went wrong.

[![@reaperhulk](https://avatars.githubusercontent.com/u/161495?s=80&u=5f0232a38e50d219b679bc014de04922fba33ae0&v=4)](/reaperhulk)

Copy link

Member

### **[reaperhulk](/reaperhulk)** commented [Jul 10, 2023](#issuecomment-1629299076)

| And I'm on 9.0, so alright then üòÑ |
| --- |

 üòÑ
1
 lkubb reacted with laugh emoji

All reactions

* üòÑ
  1 reaction

Sorry, something went wrong.

[![reaperhulk](https://avatars.githubusercontent.com/u/161495?s=60&v=4)](/reaperhulk)

**[reaperhulk](/reaperhulk)**
approved these changes
[Jul 10, 2023](#pullrequestreview-1522548871)

 [View reviewed changes](/pyca/cryptography/pull/9208/files/91c3f72d8bb6a9be8a6bebb0a8456b0ecd3298dc)

[![@reaperhulk](https://avatars.githubusercontent.com/u/161495?s=40&u=5f0232a38e50d219b679bc014de04922fba33ae0&v=4)](/reaperhulk)
[reaperhulk](/reaperhulk)
merged commit [`1ca7adc`](/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3)
into
pyca:main

[Jul 10, 2023](https://github.com/pyca/cryptography/pull/9208#event-9777321475)

[reaperhulk](/reaperhulk)
pushed a commit
to reaperhulk/cryptography
that referenced
this pull request
[Jul 10, 2023](#ref-commit-e068c6f)
[![@lkubb](https://avatars.githubusercontent.com/u/2163936?s=40&v=4)](/lkubb) [![@reaperhulk](https://avatars.githubusercontent.com/u/161495?s=40&v=4)](/reaperhulk)

`[Fix encoding of SSH certs with critical options (](/reaperhulk/cryptography/commit/e068c6fd66cb166c4a2e405a0c344b68352cc99a "Fix encoding of SSH certs with critical options (#9208)

* Add tests for issue #9207

* Fix encoding of SSH certs with critical options

* Test unexpected additional values for crit opts/exts")[pyca#9208](https://github.com/pyca/cryptography/pull/9208)[)](/reaperhulk/cryptography/commit/e068c6fd66cb166c4a2e405a0c344b68352cc99a "Fix encoding of SSH certs with critical options (#9208)

* Add tests for issue #9207

* Fix encoding of SSH certs with critical options

* Test unexpected additional values for crit opts/exts")`
‚Ä¶

`[e068c6f](/reaperhulk/cryptography/commit/e068c6fd66cb166c4a2e405a0c344b68352cc99a)`

```
* Add tests for issue [pyca#9207](https://github.com/pyca/cryptography/issues/9207)

* Fix encoding of SSH certs with critical options

* Test unexpected additional values for crit opts/exts
```

[alex](/alex)
pushed a commit
that referenced
this pull request
[Jul 11, 2023](#ref-commit-e190ef1)
[![@reaperhulk](https://avatars.githubusercontent.com/u/161495?s=40&u=5f0232a38e50d219b679bc014de04922fba33ae0&v=4)](/reaperhulk) [![@lkubb](https://avatars.githubusercontent.com/u/2163936?s=40&v=4)](/lkubb)

`[Backport ssh cert fix (](/pyca/cryptography/commit/e190ef190525999d1f599cf8c3aef5cb7f3a8bc4 "Backport ssh cert fix (#9211)

* Fix encoding of SSH certs with critical options (#9208)

* Add tests for issue #9207

* Fix encoding of SSH certs with critical options

* Test unexpected additional values for crit opts/exts

* temporarily allow invalid ssh cert encoding

---------

Co-authored-by: jeanluc <2163936+lkubb@users.noreply.github.com>")[#9211](https://github.com/pyca/cryptography/pull/9211)[)](/pyca/cryptography/commit/e190ef190525999d1f599cf8c3aef5cb7f3a8bc4 "Backport ssh cert fix (#9211)

* Fix encoding of SSH certs with critical options (#9208)

* Add tests for issue #9207

* Fix encoding of SSH certs with critical options

* Test unexpected additional values for crit opts/exts

* temporarily allow invalid ssh cert encoding

---------

Co-authored-by: jeanluc <2163936+lkubb@users.noreply.github.com>")`
‚Ä¶

`[e190ef1](/pyca/cryptography/commit/e190ef190525999d1f599cf8c3aef5cb7f3a8bc4)`

```
* Fix encoding of SSH certs with critical options ([#9208](https://github.com/pyca/cryptography/pull/9208))

* Add tests for issue [#9207](https://github.com/pyca/cryptography/issues/9207)

* Fix encoding of SSH certs with critical options

* Test unexpected additional values for crit opts/exts

* temporarily allow invalid ssh cert encoding

---------

Co-authored-by: jeanluc <2163936+lkubb@users.noreply.github.com>
```

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[Jul 14, 2023](#ref-issue-1805574671)

[x/vulndb: potential Go vuln in github.com/pyca/cryptography: CVE-2023-38325
golang/vulndb#1920](/golang/vulndb/issues/1920)

Closed

[s0undt3ch](/s0undt3ch)
added a commit
to s0undt3ch/salt
that referenced
this pull request
[Jul 16, 2023](#ref-commit-e512e79)
[![@s0undt3ch](https://avatars.githubusercontent.com/u/300048?s=40&v=4)](/s0undt3ch)

`[Bump to](/s0undt3ch/salt/commit/e512e79038872bf97e7bf26b3914735f5953a6fc "Bump to `cryptography==41.0.2` to address GHSA-cf7p-gm2m-833m

The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

    https://nvd.nist.gov/vuln/detail/CVE-2023-38325
    pyca/cryptography#9207
    pyca/cryptography#9208
    pyca/cryptography@41.0.1...41.0.2
    https://pypi.org/project/cryptography/#history
    pyca/cryptography@1ca7adc

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>") [cryptography==41.0.2](/s0undt3ch/salt/commit/e512e79038872bf97e7bf26b3914735f5953a6fc "Bump to `cryptography==41.0.2` to address GHSA-cf7p-gm2m-833m

The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

    https://nvd.nist.gov/vuln/detail/CVE-2023-38325
    pyca/cryptography#9207
    pyca/cryptography#9208
    pyca/cryptography@41.0.1...41.0.2
    https://pypi.org/project/cryptography/#history
    pyca/cryptography@1ca7adc

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>") [to address](/s0undt3ch/salt/commit/e512e79038872bf97e7bf26b3914735f5953a6fc "Bump to `cryptography==41.0.2` to address GHSA-cf7p-gm2m-833m

The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

    https://nvd.nist.gov/vuln/detail/CVE-2023-38325
    pyca/cryptography#9207
    pyca/cryptography#9208
    pyca/cryptography@41.0.1...41.0.2
    https://pypi.org/project/cryptography/#history
    pyca/cryptography@1ca7adc

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>") [GHSA-cf7p-gm2m-833m](https://github.com/advisories/GHSA-cf7p-gm2m-833m "GHSA-cf7p-gm2m-833m")`
‚Ä¶

`[e512e79](/s0undt3ch/salt/commit/e512e79038872bf97e7bf26b3914735f5953a6fc)`

```
The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

    <https://nvd.nist.gov/vuln/detail/CVE-2023-38325>
    [pyca/cryptography#9207](https://github.com/pyca/cryptography/issues/9207)
    [pyca/cryptography#9208](https://github.com/pyca/cryptography/pull/9208)
    pyca/cryptography@41.0.1...41.0.2
    <https://pypi.org/project/cryptography/#history>
    [pyca/cryptography@1ca7adc](https://github.com/pyca/cryptography/commit/1ca7adc)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>
```

[s0undt3ch](/s0undt3ch)
referenced
this pull request
in s0undt3ch/salt
[Jul 16, 2023](#ref-commit-560e4ed)
[![@s0undt3ch](https://avatars.githubusercontent.com/u/300048?s=40&v=4)](/s0undt3ch)

`[Bump to](/s0undt3ch/salt/commit/560e4eda3d9da15cf2387130951f5363cc0fb61f "Bump to `cryptography==41.0.2` to address GHSA-cf7p-gm2m-833m

The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

https://nvd.nist.gov/vuln/detail/CVE-2023-38325
[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)
[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)
[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)
https://pypi.org/project/cryptography/#history
[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>") [cryptography==41.0.2](/s0undt3ch/salt/commit/560e4eda3d9da15cf2387130951f5363cc0fb61f "Bump to `cryptography==41.0.2` to address GHSA-cf7p-gm2m-833m

The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

https://nvd.nist.gov/vuln/detail/CVE-2023-38325
[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)
[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)
[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)
https://pypi.org/project/cryptography/#history
[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>") [to address](/s0undt3ch/salt/commit/560e4eda3d9da15cf2387130951f5363cc0fb61f "Bump to `cryptography==41.0.2` to address GHSA-cf7p-gm2m-833m

The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

https://nvd.nist.gov/vuln/detail/CVE-2023-38325
[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)
[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)
[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)
https://pypi.org/project/cryptography/#history
[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>") [GHSA-cf7p-gm2m-833m](https://github.com/advisories/GHSA-cf7p-gm2m-833m "GHSA-cf7p-gm2m-833m")`
‚Ä¶

`[560e4ed](/s0undt3ch/salt/commit/560e4eda3d9da15cf2387130951f5363cc0fb61f)`

```
The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

<https://nvd.nist.gov/vuln/detail/CVE-2023-38325>
[[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)](https://github.com/pyca/cryptography/issues/9207%5D%28pyca/cryptography#9207))
[[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)](https://github.com/pyca/cryptography/issues/9208%5D%28pyca/cryptography#9208))
[[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)](https://github.com/pyca/cryptography/compare/41.0.1...41.0.2%5D%28pyca/cryptography%4041.0.1...41.0.2%29)
<https://pypi.org/project/cryptography/#history>
[[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)](https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3%5D%28pyca/cryptography%401ca7adc%29)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>
```

[s0undt3ch](/s0undt3ch)
referenced
this pull request
in s0undt3ch/salt
[Jul 16, 2023](#ref-commit-0a9def0)
[![@s0undt3ch](https://avatars.githubusercontent.com/u/300048?s=40&v=4)](/s0undt3ch)

`[Bump to](/s0undt3ch/salt/commit/0a9def0c30093e7c2250626a123e200e6c34fb8a "Bump to `cryptography==41.0.2` to address GHSA-cf7p-gm2m-833m

The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

https://nvd.nist.gov/vuln/detail/CVE-2023-38325
[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)
[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)
[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)
https://pypi.org/project/cryptography/#history
[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>") [cryptography==41.0.2](/s0undt3ch/salt/commit/0a9def0c30093e7c2250626a123e200e6c34fb8a "Bump to `cryptography==41.0.2` to address GHSA-cf7p-gm2m-833m

The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

https://nvd.nist.gov/vuln/detail/CVE-2023-38325
[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)
[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)
[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)
https://pypi.org/project/cryptography/#history
[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>") [to address](/s0undt3ch/salt/commit/0a9def0c30093e7c2250626a123e200e6c34fb8a "Bump to `cryptography==41.0.2` to address GHSA-cf7p-gm2m-833m

The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

https://nvd.nist.gov/vuln/detail/CVE-2023-38325
[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)
[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)
[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)
https://pypi.org/project/cryptography/#history
[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>") [GHSA-cf7p-gm2m-833m](https://github.com/advisories/GHSA-cf7p-gm2m-833m "GHSA-cf7p-gm2m-833m")`
‚Ä¶

`[0a9def0](/s0undt3ch/salt/commit/0a9def0c30093e7c2250626a123e200e6c34fb8a)`

```
The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

<https://nvd.nist.gov/vuln/detail/CVE-2023-38325>
[[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)](https://github.com/pyca/cryptography/issues/9207%5D%28pyca/cryptography#9207))
[[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)](https://github.com/pyca/cryptography/issues/9208%5D%28pyca/cryptography#9208))
[[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)](https://github.com/pyca/cryptography/compare/41.0.1...41.0.2%5D%28pyca/cryptography%4041.0.1...41.0.2%29)
<https://pypi.org/project/cryptography/#history>
[[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)](https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3%5D%28pyca/cryptography%401ca7adc%29)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>
```

[s0undt3ch](/s0undt3ch)
referenced
this pull request
in s0undt3ch/salt
[Jul 16, 2023](#ref-commit-28b052c)
[![@s0undt3ch](https://avatars.githubusercontent.com/u/300048?s=40&v=4)](/s0undt3ch)

`[Bump to](/s0undt3ch/salt/commit/28b052ce4478346b28561af6f670f029e6322dce "Bump to `cryptography==41.0.2` to address GHSA-cf7p-gm2m-833m

The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

https://nvd.nist.gov/vuln/detail/CVE-2023-38325
[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)
[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)
[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)
https://pypi.org/project/cryptography/#history
[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>") [cryptography==41.0.2](/s0undt3ch/salt/commit/28b052ce4478346b28561af6f670f029e6322dce "Bump to `cryptography==41.0.2` to address GHSA-cf7p-gm2m-833m

The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

https://nvd.nist.gov/vuln/detail/CVE-2023-38325
[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)
[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)
[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)
https://pypi.org/project/cryptography/#history
[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>") [to address](/s0undt3ch/salt/commit/28b052ce4478346b28561af6f670f029e6322dce "Bump to `cryptography==41.0.2` to address GHSA-cf7p-gm2m-833m

The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

https://nvd.nist.gov/vuln/detail/CVE-2023-38325
[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)
[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)
[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)
https://pypi.org/project/cryptography/#history
[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>") [GHSA-cf7p-gm2m-833m](https://github.com/advisories/GHSA-cf7p-gm2m-833m "GHSA-cf7p-gm2m-833m")`
‚Ä¶

`[28b052c](/s0undt3ch/salt/commit/28b052ce4478346b28561af6f670f029e6322dce)`

```
The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

<https://nvd.nist.gov/vuln/detail/CVE-2023-38325>
[[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)](https://github.com/pyca/cryptography/issues/9207%5D%28pyca/cryptography#9207))
[[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)](https://github.com/pyca/cryptography/issues/9208%5D%28pyca/cryptography#9208))
[[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)](https://github.com/pyca/cryptography/compare/41.0.1...41.0.2%5D%28pyca/cryptography%4041.0.1...41.0.2%29)
<https://pypi.org/project/cryptography/#history>
[[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)](https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3%5D%28pyca/cryptography%401ca7adc%29)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>
```

[garethgreenaway](/garethgreenaway)
referenced
this pull request
in saltstack/salt
[Jul 17, 2023](#ref-commit-5b2e752)
[![@s0undt3ch](https://avatars.githubusercontent.com/u/300048?s=40&v=4)](/s0undt3ch) [![@garethgreenaway](https://avatars.githubusercontent.com/u/718525?s=40&v=4)](/garethgreenaway)

`[Bump to](/saltstack/salt/commit/5b2e752d5e04886fb8017a1c0e7f30cd9a20f17d "Bump to `cryptography==41.0.2` to address GHSA-cf7p-gm2m-833m

The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

https://nvd.nist.gov/vuln/detail/CVE-2023-38325
[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)
[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)
[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)
https://pypi.org/project/cryptography/#history
[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>") [cryptography==41.0.2](/saltstack/salt/commit/5b2e752d5e04886fb8017a1c0e7f30cd9a20f17d "Bump to `cryptography==41.0.2` to address GHSA-cf7p-gm2m-833m

The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

https://nvd.nist.gov/vuln/detail/CVE-2023-38325
[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)
[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)
[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)
https://pypi.org/project/cryptography/#history
[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>") [to address](/saltstack/salt/commit/5b2e752d5e04886fb8017a1c0e7f30cd9a20f17d "Bump to `cryptography==41.0.2` to address GHSA-cf7p-gm2m-833m

The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

https://nvd.nist.gov/vuln/detail/CVE-2023-38325
[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)
[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)
[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)
https://pypi.org/project/cryptography/#history
[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>") [GHSA-cf7p-gm2m-833m](https://github.com/advisories/GHSA-cf7p-gm2m-833m "GHSA-cf7p-gm2m-833m")`
‚Ä¶

`[5b2e752](/saltstack/salt/commit/5b2e752d5e04886fb8017a1c0e7f30cd9a20f17d)`

```
The cryptography package before 41.0.2 for Python mishandles SSH certificates that have critical options.
References:

<https://nvd.nist.gov/vuln/detail/CVE-2023-38325>
[[https://github.com/pyca/cryptography/issues/9207](pyca/cryptography#9207)](https://github.com/pyca/cryptography/issues/9207%5D%28pyca/cryptography#9207))
[[https://github.com/pyca/cryptography/issues/9208](pyca/cryptography#9208)](https://github.com/pyca/cryptography/issues/9208%5D%28pyca/cryptography#9208))
[[https://github.com/pyca/cryptography/compare/41.0.1...41.0.2](pyca/cryptography@41.0.1...41.0.2)](https://github.com/pyca/cryptography/compare/41.0.1...41.0.2%5D%28pyca/cryptography%4041.0.1...41.0.2%29)
<https://pypi.org/project/cryptography/#history>
[[https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3](pyca/cryptography@1ca7adc)](https://github.com/pyca/cryptography/commit/1ca7adc97b76a9dfbd3d850628b613eb93b78fc3%5D%28pyca/cryptography%401ca7adc%29)

Signed-off-by: Pedro Algarvio <palgarvio@vmware.com>
```

[![@Shilpi-J](https://avatars.githubusercontent.com/u/65765546?s=40&v=4)](/Shilpi-J)
[Shilpi-J](/Shilpi-J)
mentioned this pull request
[Sep 28, 2023](#ref-pullrequest-1916774024)

[Update README.md
ansible-collections/ibm.storage\_virtualize#16](/ansible-collections/ibm.storage_virtualize/pull/16)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fpyca%2Fcryptography%2Fpull%2F9208)

Reviewers

[![@reaperhulk](https://avatars.githubusercontent.com/u/161495?s=40&v=4)](/reaperhulk) [reaperhulk](/reaperhulk)

reaperhulk approved these changes

Assignees

No one assigned

Labels

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [SSH certificate encoding/parsing incompatibility with OpenSSH](https://github.com/pyca/cryptography/issues/9207)

3 participants

[![@lkubb](https://avatars.githubusercontent.com/u/2163936?s=52&v=4)](/lkubb) [![@alex](https://avatars.githubusercontent.com/u/772?s=52&v=4)](/alex) [![@reaperhulk](https://avatars.githubusercontent.com/u/161495?s=52&v=4)](/reaperhulk)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.

