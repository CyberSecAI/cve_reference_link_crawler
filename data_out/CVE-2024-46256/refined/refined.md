```
{
  "vulnerability": {
    "root_cause": "The application was vulnerable to command injection because it was using user-supplied input without proper sanitization when constructing shell commands.",
    "weaknesses": [
      "Command Injection",
	    "Improper Input Sanitization"
    ],
    "impact": "An attacker could execute arbitrary shell commands on the server by injecting malicious commands into the DNS provider credentials field.",
    "attack_vectors": [
      "By crafting a malicious string containing shell commands in the 'dns_provider_credentials' field when requesting or renewing a Let's Encrypt certificate via a DNS challenge."
    ],
    "required_attacker_capabilities": "The attacker needs to be an authenticated user with the ability to create or modify certificates and specify DNS provider credentials.",
    "additional_details": "The vulnerability was present in how the application handled DNS provider credentials for Let's Encrypt certificate requests using DNS challenges. Specifically, when creating a temporary file to store credentials, the application concatenated the unsanitized user input into the shell command used to create the file and set the permissions, resulting in code execution. This was resolved by using built-in Node.js functions to write and delete the credential file instead of using shell commands."
  }
}
```