

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2865322%2Fwp-cerber%2Ftrunk%2Fcerber-common.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2851742/wp-cerber/trunk/cerber-common.php "Changeset 2851742 for wp-cerber/trunk/cerber-common.php")
* [Next Change](/changeset/2887397/wp-cerber/trunk/cerber-common.php "Changeset 2887397 for wp-cerber/trunk/cerber-common.php") →

---

# Changeset [2865322](/changeset/2865322 "Show full changeset") for [wp-cerber/trunk/cerber-common.php](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
02/14/2023 09:00:56 PM
([2 years](/timeline?from=2023-02-14T21%3A00%3A56Z&precision=second "See timeline at 02/14/2023 09:00:56 PM") ago)

Author:
Gioni
Message:

A new 9.5 version of WP Cerber Security

File:

1 edited

* [wp-cerber/trunk/cerber-common.php](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322 "Show entry in browser")
  (modified)
  ([36 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wp-cerber/trunk/cerber-common.php](/changeset/2865322/wp-cerber/trunk/cerber-common.php "Show the changeset 2865322 restricted to wp-cerber/trunk/cerber-common.php")

  | [r2851742](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L69 "Show revision 2851742 of this file in browser") | [r2865322](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L69 "Show revision 2865322 of this file in browser") |  |
  | --- | --- | --- |
  | 69 | 69 | 'al\_send\_emails'     => 0, // 15 |
  | 70 | 70 | 'al\_send\_pushbullet' => 0, // 16 |
  |  | 71 | // @since 9.4.2 |
  |  | 72 | 'al\_send\_me'         => 0, // 17 |
  | 71 | 73 | ); |
  | 72 | 74 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L77) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L79) |  |
  | 77 | 79 | 'al\_ignore\_rate', |
  | 78 | 80 | 'al\_send\_emails', |
  | 79 |  | 'al\_send\_pushbullet' |
  |  | 81 | 'al\_send\_pushbullet', |
  |  | 82 | 'al\_send\_me', |
  | 80 | 83 | ); |
  | 81 | 84 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L291) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L294) |  |
  | 291 | 294 |  |
  | 292 | 295 | /\*\* |
  | 293 |  | \* @param array $set |
  |  | 296 | \* @param array $act |
  |  | 297 | \* @param int $status |
  | 294 | 298 | \* |
  | 295 | 299 | \* @return string |
  | 296 | 300 | \*/ |
  | 297 |  | function cerber\_activity\_link( $~~set = array()~~ ) { |
  |  | 301 | function cerber\_activity\_link( $act = array(), $status = null ) { |
  | 298 | 302 | static $link; |
  | 299 | 303 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L304) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L308) |  |
  | 304 | 308 | $filter = ''; |
  | 305 | 309 |  |
  | 306 |  | $c = ~~count( $set )~~; |
  |  | 310 | $c = $act ? count( $act ) : 0; |
  | 307 | 311 |  |
  | 308 | 312 | if ( 1 == $c ) { |
  | 309 |  | $filter .= '&amp;filter\_activity=' . ~~absint( array\_shift( $se~~t ) ); |
  |  | 313 | $filter .= '&amp;filter\_activity=' . crb\_absint( array\_shift( $act ) ); |
  | 310 | 314 | } |
  | 311 | 315 | elseif ( $c ) { |
  | 312 |  | foreach ( $set as $key => $item ) { |
  | 313 |  | $filter .= '&amp;filter\_activity[' . $key . ']=' . absint( $item ); |
  | 314 |  | } |
  |  | 316 | foreach ( $act as $key => $item ) { |
  |  | 317 | $filter .= '&amp;filter\_activity[' . $key . ']=' . crb\_absint( $item ); |
  |  | 318 | } |
  |  | 319 | } |
  |  | 320 |  |
  |  | 321 | if ( $status ) { |
  |  | 322 | $filter .= '&amp;filter\_status=' . crb\_absint( $status ); |
  | 315 | 323 | } |
  | 316 | 324 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L681) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L689) |  |
  | 681 | 689 | \* @param string $code |
  | 682 | 690 | \* @param string $text |
  | 683 |  | \* @param string $related\_setting |
  | 684 |  | \* @param string $section |
  |  | 691 | \* @param array $data |
  | 685 | 692 | \* |
  | 686 | 693 | \* @since 9.3.4 |
  | 687 | 694 | \*/ |
  | 688 |  | function cerber\_add\_issue( $code, $text, $related\_setting = '', $section = '' ) { |
  | 689 |  |  |
  |  | 695 | function cerber\_add\_issue( $code, $text, $data = array() ) { |
  | 690 | 696 | static $issues = null; |
  |  | 697 |  |
  |  | 698 | return; // TODO: it was commented out until we implement the proper UI for viewing/clearing the list of issues |
  |  | 699 | // TODO: implement storing issues in a file as a fallback if no DB connection. |
  | 691 | 700 |  |
  | 692 | 701 | if ( $issues === null ) { |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L694) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L703) |  |
  | 694 | 703 | } |
  | 695 | 704 |  |
  |  | 705 | $section = (string) $data['section'] ?? 'generic'; |
  | 696 | 706 | $code = (string) $code; |
  | 697 |  | ~~$section = (string) $section;~~ |
  | 698 |  |  |
  | 699 |  | ~~if ( ! $section ) {~~ |
  | 700 |  | ~~$section = 'generic';~~ |
  | 701 |  | ~~}~~ |
  | 702 | 707 |  |
  | 703 | 708 | if ( ! isset( $issues[ $section ][ $code ] ) ) { |
  | 704 |  | $issues[ $section ][ $code ] = array( $text, $related\_setting ); |
  |  | 709 | $issues[ $section ][ $code ] = array( $text, $data['setting'] ?? '', $data['details'] ?? array() ); |
  |  | 710 |  |
  | 705 | 711 | cerber\_update\_set( CRB\_ISSUE\_SET, $issues ); |
  | 706 | 712 | } |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L790) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L796) |  |
  | 790 | 796 |  |
  | 791 | 797 | if ( defined( 'CERBER\_IP\_KEY' ) ) { |
  | 792 |  | $remote\_ip = filter\_var( $\_SERVER[ CERBER\_IP\_KEY ], FILTER\_VALIDATE\_IP ); |
  | 793 |  | } |
  | 794 |  | elseif ( crb\_get\_settings( 'proxy' ) && isset( $\_SERVER['HTTP\_X\_FORWARDED\_FOR'] ) ) { |
  | 795 |  | $list = explode( ',', $\_SERVER['HTTP\_X\_FORWARDED\_FOR'] ); |
  | 796 |  | foreach ( $list as $maybe\_ip ) { |
  | 797 |  | $remote\_ip = filter\_var( trim( $maybe\_ip ), FILTER\_VALIDATE\_IP ); |
  | 798 |  | if ( $remote\_ip ) { |
  | 799 |  | break; |
  | 800 |  | } |
  | 801 |  | } |
  | 802 |  | if ( ! $remote\_ip && isset( $\_SERVER['HTTP\_X\_REAL\_IP'] ) ) { |
  | 803 |  | $remote\_ip = filter\_var( $\_SERVER['HTTP\_X\_REAL\_IP'], FILTER\_VALIDATE\_IP ); |
  | 804 |  | } |
  |  | 798 | $remote\_ip = filter\_var( $\_SERVER[ CERBER\_IP\_KEY ] ?? '', FILTER\_VALIDATE\_IP ); |
  |  | 799 | } |
  |  | 800 | elseif ( crb\_get\_settings( 'proxy' ) ) { |
  |  | 801 | $remote\_ip = crb\_extract\_ip\_from\_headers(); |
  | 805 | 802 | } |
  | 806 | 803 | else { |
  | 807 |  | if ( ! empty( $\_SERVER['REMOTE\_ADDR'] ) ) { |
  | 808 |  | $remote\_ip = $\_SERVER['REMOTE\_ADDR']; |
  | 809 |  | } |
  | 810 |  | elseif ( ! empty( $\_SERVER['HTTP\_X\_REAL\_IP'] ) ) { |
  | 811 |  | $remote\_ip = $\_SERVER['HTTP\_X\_REAL\_IP']; |
  | 812 |  | } |
  | 813 |  | elseif ( ! empty( $\_SERVER['HTTP\_CLIENT\_IP'] ) ) { |
  | 814 |  | $remote\_ip = $\_SERVER['HTTP\_CLIENT\_IP']; |
  | 815 |  | } |
  | 816 |  | $remote\_ip = filter\_var( $remote\_ip, FILTER\_VALIDATE\_IP ); |
  |  | 804 | $remote\_ip = filter\_var( $\_SERVER['REMOTE\_ADDR'] ?? '', FILTER\_VALIDATE\_IP ); |
  | 817 | 805 | } |
  | 818 | 806 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L828) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L816) |  |
  | 828 | 816 | } |
  | 829 | 817 |  |
  |  | 818 | /\*\* |
  |  | 819 | \* Extracting the client remote IP address from HTTP headers |
  |  | 820 | \* |
  |  | 821 | \* @return string|false The valid IP address, false otherwise |
  |  | 822 | \* |
  |  | 823 | \* @since 9.4.2.4 |
  |  | 824 | \*/ |
  |  | 825 | function crb\_extract\_ip\_from\_headers( $strict = false ) { |
  |  | 826 |  |
  |  | 827 | $remote\_ip = false; |
  |  | 828 |  |
  |  | 829 | if ( ! empty( $\_SERVER['HTTP\_X\_FORWARDED\_FOR'] ) ) { |
  |  | 830 |  |
  |  | 831 | $list = explode( ',', $\_SERVER['HTTP\_X\_FORWARDED\_FOR'] ); |
  |  | 832 |  |
  |  | 833 | // We have to start with the left-most IP address |
  |  | 834 |  |
  |  | 835 | foreach ( $list as $maybe\_ip ) { |
  |  | 836 | if ( $remote\_ip = filter\_var( trim( $maybe\_ip ), FILTER\_VALIDATE\_IP ) ) { |
  |  | 837 | return $remote\_ip; |
  |  | 838 | } |
  |  | 839 | } |
  |  | 840 | } |
  |  | 841 |  |
  |  | 842 | if ( $strict ) { |
  |  | 843 | return $remote\_ip; |
  |  | 844 | } |
  |  | 845 |  |
  |  | 846 | // The last resort if no IP address in the $\_SERVER['HTTP\_X\_FORWARDED\_FOR'] |
  |  | 847 |  |
  |  | 848 | $remote\_ip = filter\_var( $\_SERVER['HTTP\_X\_REAL\_IP'] ?? $\_SERVER['HTTP\_CLIENT\_IP'] ?? '', FILTER\_VALIDATE\_IP ); |
  |  | 849 |  |
  |  | 850 | return $remote\_ip; |
  |  | 851 | } |
  | 830 | 852 |  |
  | 831 | 853 | /\*\* |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L1194) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L1216) |  |
  | 1194 | 1216 | } |
  | 1195 | 1217 | else { |
  | 1196 |  | return absint( $val ); |
  |  | 1218 | return crb\_absint( $val ); |
  | 1197 | 1219 | } |
  | 1198 | 1220 | } |
  | 1199 | 1221 |  |
  | 1200 | 1222 | array\_walk\_recursive( $val, function ( &$v ) { |
  | 1201 |  | $v = absint( $v ); |
  |  | 1223 | $v = crb\_absint( $v ); |
  | 1202 | 1224 | } ); |
  | 1203 | 1225 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L1207) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L1229) |  |
  | 1207 | 1229 |  |
  | 1208 | 1230 | return $val; |
  |  | 1231 | } |
  |  | 1232 |  |
  |  | 1233 | /\*\* |
  |  | 1234 | \* Simple and quick "escaping/sanitizing" for manually coded plain ASCII alphanumeric values. |
  |  | 1235 | \* Should not be used for any external data (user input, DB, network etc.) |
  |  | 1236 | \* |
  |  | 1237 | \* @param string $val |
  |  | 1238 | \* |
  |  | 1239 | \* @return string |
  |  | 1240 | \* |
  |  | 1241 | \* @since 9.3.4 |
  |  | 1242 | \*/ |
  |  | 1243 | function crb\_boring\_escape( $val = '' ) { |
  |  | 1244 | if ( ! $val |
  |  | 1245 | || is\_numeric( $val ) ) { |
  |  | 1246 | return $val; |
  |  | 1247 | } |
  |  | 1248 |  |
  |  | 1249 | return preg\_replace( '/[^\w\-\[\].]/', '', (string) $val ); |
  | 1209 | 1250 | } |
  | 1210 | 1251 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L1334) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L1375) |  |
  | 1334 | 1375 |  |
  | 1335 | 1376 | if ( $add\_issue ) { |
  | 1336 |  | cerber\_add\_issue( $thing->get\_error\_code(), $thing->get\_error\_message(), ~~'', $issue\_section~~ ); |
  |  | 1377 | cerber\_add\_issue( $thing->get\_error\_code(), $thing->get\_error\_message(), array( 'section' => $issue\_section ) ); |
  | 1337 | 1378 | } |
  | 1338 | 1379 | } |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L1471) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L1512) |  |
  | 1471 | 1512 | function cerber\_is\_rest\_permitted() { |
  | 1472 | 1513 |  |
  |  | 1514 | $rest\_path = crb\_get\_rest\_path(); |
  |  | 1515 |  |
  | 1473 | 1516 | // Exception: application passwords route @since WP Cerber 8.8 & WP 5.6 -> permissions are checked in the WP core |
  | 1474 |  | if ( preg\_match( '#^wp/v\d+/users/\d+/application-passwords#', ~~crb\_get\_rest\_path()~~ ) ) { |
  |  | 1517 | if ( preg\_match( '#^wp/v\d+/users/\d+/application-passwords#', $rest\_path ) ) { |
  | 1475 | 1518 |  |
  | 1476 | 1519 | return true; |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L1480) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L1523) |  |
  | 1480 | 1523 |  |
  | 1481 | 1524 | if ( ! empty( $opt['norestuser'] ) ) { |
  | 1482 |  | $path = explode( '/', crb\_get\_rest\_path() ); |
  | 1483 |  | if ( $path && count( $path ) > 2 && $path[0] == 'wp' && $path[2] == 'users' ) { |
  |  | 1525 | $path = explode( '/', $rest\_path ); |
  |  | 1526 | if ( $path |
  |  | 1527 | && count( $path ) > 2 |
  |  | 1528 | && $path[0] == 'wp' |
  |  | 1529 | && $path[2] == 'users' ) { |
  |  | 1530 |  |
  | 1484 | 1531 | if ( is\_super\_admin() ) { |
  | 1485 | 1532 | return true; // @since 8.3.4 |
  | 1486 | 1533 | } |
  |  | 1534 | if ( crb\_wp\_user\_has\_role( $opt['norestuser\_roles'] ) ) { |
  |  | 1535 | return true; |
  |  | 1536 | } |
  | 1487 | 1537 |  |
  | 1488 | 1538 | return false; |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L1501) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L1551) |  |
  | 1501 | 1551 | } |
  | 1502 | 1552 |  |
  | 1503 |  | if ( ! empty( $opt['restwhite'] ) || is\_array( $opt['restwhite'] ) ) { |
  | 1504 |  | $rest\_path = crb\_get\_rest\_path(); |
  |  | 1553 | if ( ! empty( $opt['restwhite'] ) ) { |
  | 1505 | 1554 | $namespace = substr( $rest\_path, 0, strpos( $rest\_path, '/' ) ); |
  | 1506 |  | foreach ( $opt['restwhite'] as $~~exception~~ ) { |
  | 1507 |  | if ( $~~exception~~ == $namespace ) { |
  |  | 1555 | foreach ( $opt['restwhite'] as $allowed ) { |
  |  | 1556 | if ( $allowed == $namespace ) { |
  | 1508 | 1557 | CRB\_Globals::$req\_status = 503; |
  | 1509 | 1558 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L1514) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L1563) |  |
  | 1514 | 1563 | } |
  | 1515 | 1564 |  |
  | 1516 |  | if ( ! empty( $opt['restroles'] ) || is\_array( $opt['restroles'] ) ) { |
  | 1517 |  | if ( cerber\_user\_has\_role( $opt['restroles'] ) ) { |
  | 1518 |  | return true; |
  | 1519 |  | } |
  |  | 1565 | if ( crb\_wp\_user\_has\_role( $opt['restroles'] ) ) { |
  |  | 1566 | return true; |
  | 1520 | 1567 | } |
  | 1521 | 1568 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L1526) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L1573) |  |
  | 1526 | 1573 | \* Requested REST API route without leading and trailing slashes |
  | 1527 | 1574 | \* |
  | 1528 |  | \* @return string Empty string for any nonREST API request |
  |  | 1575 | \* @return string Empty string for any non-REST API request |
  | 1529 | 1576 | \*/ |
  | 1530 | 1577 | function crb\_get\_rest\_path() { |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L1585) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L1632) |  |
  | 1585 | 1632 | \* @return bool |
  | 1586 | 1633 | \*/ |
  | 1587 |  | function c~~erber~~\_user\_has\_role( $roles = array(), $user\_id = null ) { |
  |  | 1634 | function crb\_wp\_user\_has\_role( $roles = array(), $user\_id = null ) { |
  | 1588 | 1635 | if ( ! $roles ) { |
  | 1589 | 1636 | return false; |
  | 1590 | 1637 | } |
  | 1591 | 1638 |  |
  |  | 1639 | if ( ! is\_array( $roles ) ) { |
  |  | 1640 | $roles = array( (string) $roles ); |
  |  | 1641 | } |
  |  | 1642 |  |
  | 1592 | 1643 | if ( ! $user\_id ) { |
  | 1593 | 1644 | $user = wp\_get\_current\_user(); |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L1599) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L1650) |  |
  | 1599 | 1650 | if ( ! $user || empty( $user->roles ) ) { |
  | 1600 | 1651 | return false; |
  | 1601 |  | ~~}~~ |
  | 1602 |  |  |
  | 1603 |  | ~~if ( ! is\_array( $roles ) ) {~~ |
  | 1604 |  | ~~$roles = array( $roles );~~ |
  | 1605 | 1652 | } |
  | 1606 | 1653 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L1915) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L1962) |  |
  | 1915 | 1962 | // User actions |
  | 1916 | 1963 | $act[1] = \_\_( 'User created', 'wp-cerber' ); |
  | 1917 |  | /\* translators: %s is the name of a website administrator who created the user. \*/ |
  |  | 1964 | /\* translators: Here %s is the name of a website administrator who created the user. \*/ |
  | 1918 | 1965 | $act\_by[1] = \_\_( 'User created by %s', 'wp-cerber' ); |
  | 1919 | 1966 | $act[2] = \_\_( 'User registered', 'wp-cerber' ); |
  | 1920 | 1967 | $act[3] = \_\_( 'User deleted', 'wp-cerber' ); |
  | 1921 |  | /\* translators: %s is the name of a website administrator who deleted the user. \*/ |
  |  | 1968 | /\* translators: Here %s is the name of a website administrator who deleted the user. \*/ |
  | 1922 | 1969 | $act\_by[3] = \_\_( 'User deleted by %s', 'wp-cerber' ); |
  | 1923 | 1970 | $act[ CRB\_EV\_LIN ] = \_\_( 'Logged in', 'wp-cerber' ); |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L1944) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L1991) |  |
  | 1944 | 1991 | // Other events |
  | 1945 | 1992 | $act[20] = \_\_( 'Password changed', 'wp-cerber' ); |
  | 1946 |  | /\* translators: %s is the name of a website administrator who changed the password. \*/ |
  |  | 1993 | /\* translators: Here %s is the name of a website administrator who changed the password. \*/ |
  | 1947 | 1994 | $act\_by[20] = \_\_( 'Password changed by %s', 'wp-cerber' ); |
  | 1948 | 1995 | $act[ CRB\_EV\_PRS ] = \_\_( 'Password reset requested', 'wp-cerber' ); |
  | 1949 | 1996 | $act[ CRB\_EV\_UST ] = \_\_( 'User session terminated', 'wp-cerber' ); |
  | 1950 |  | /\* translators: %s is the name of a website administrator who terminated the session. \*/ |
  |  | 1997 | /\* translators: Here %s is the name of a website administrator who terminated the session. \*/ |
  | 1951 | 1998 | $act\_by[ CRB\_EV\_UST ] = \_\_( 'User session terminated by %s', 'wp-cerber' ); |
  | 1952 | 1999 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L1984) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L2031) |  |
  | 1984 | 2031 | $act[149] = \_\_( 'User application password updated', 'wp-cerber' ); |
  | 1985 | 2032 | $act[150] = \_\_( 'User application password created', 'wp-cerber' ); |
  | 1986 |  | /\* translators: %s is the name of a website administrator who created the password. \*/ |
  |  | 2033 | /\* translators: Here %s is the name of a website administrator who created the password. \*/ |
  | 1987 | 2034 | $act\_by[150] = \_\_( 'User application password created by %s', 'wp-cerber' ); |
  | 1988 | 2035 | $act[151] = \_\_( 'API request authorized', 'wp-cerber' ); |
  | 1989 | 2036 | $act[152] = \_\_( 'API request authorization failed', 'wp-cerber' ); |
  | 1990 | 2037 | $act[153] = \_\_( 'User application password deleted', 'wp-cerber' ); |
  | 1991 |  | /\* translators: %s is the name of a website administrator who deleted the password. \*/ |
  |  | 2038 | /\* translators: Here %s is the name of a website administrator who deleted the password. \*/ |
  | 1992 | 2039 | $act\_by[153] = \_\_( 'User application password deleted by %s', 'wp-cerber' ); |
  | 1993 | 2040 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L2577) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L2624) |  |
  | 2577 | 2624 | } |
  | 2578 | 2625 |  |
  | 2579 |  | /\* |
  | 2580 |  | Checks for a new version of WP Cerber and creates messages if needed |
  | 2581 |  | \*/ |
  | 2582 |  | function cerber\_check\_for\_newer() { |
  |  | 2626 | /\*\* |
  |  | 2627 | \* Checks for a new version of WP Cerber and generates messages if needed |
  |  | 2628 | \* |
  |  | 2629 | \* @param bool $check\_only if true, no messages are generated / sent |
  |  | 2630 | \* |
  |  | 2631 | \* @return string A new version, empty string otherwise |
  |  | 2632 | \* |
  |  | 2633 | \*/ |
  |  | 2634 | function cerber\_check\_new\_version( $check\_only = true ) { |
  | 2583 | 2635 | if ( ! $updates = get\_site\_transient( 'update\_plugins' ) ) { |
  | 2584 |  | return false; |
  | 2585 |  | } |
  | 2586 |  |  |
  | 2587 |  | $ret = false; |
  |  | 2636 | return ''; |
  |  | 2637 | } |
  |  | 2638 |  |
  |  | 2639 | $result = false; |
  |  | 2640 | $new\_ver = ''; |
  | 2588 | 2641 | $key = CERBER\_PLUGIN\_ID; |
  | 2589 | 2642 |  |
  | 2590 |  | if ( isset( $updates->checked[ $key ] ) && isset( $updates->response[ $key ] ) ) { |
  | 2591 |  | $old = $updates->checked[ $key ]; |
  | 2592 |  | $new = $updates->response[ $key ]->new\_version; |
  | 2593 |  | if ( 1 === version\_compare( $new, $old ) ) { // current version is lower than latest |
  | 2594 |  | $msg = sprintf( \_\_( 'A new version of %s is available. Please install it.', 'wp-cerber' ), 'WP Cerber Security' ); |
  | 2595 |  | $ret = array( 'msg' => $msg, 'ver' => $new ); |
  | 2596 |  | } |
  | 2597 |  | } |
  | 2598 |  |  |
  | 2599 |  | return $ret; |
  |  | 2643 | if ( isset( $updates->checked[ $key ] ) |
  |  | 2644 | && isset( $updates->response[ $key ] ) ) { |
  |  | 2645 |  |
  |  | 2646 | $old\_ver = $updates->checked[ $key ]; |
  |  | 2647 | $new\_ver = crb\_boring\_escape( $updates->response[ $key ]->new\_version ); |
  |  | 2648 |  |
  |  | 2649 | if ( 1 === version\_compare( $new\_ver, $old\_ver ) ) { |
  |  | 2650 | $result = true; |
  |  | 2651 | } |
  |  | 2652 | else { |
  |  | 2653 | $new\_ver = ''; |
  |  | 2654 | } |
  |  | 2655 | } |
  |  | 2656 |  |
  |  | 2657 | if ( $check\_only || ! $result ) { |
  |  | 2658 | return $new\_ver; |
  |  | 2659 | } |
  |  | 2660 |  |
  |  | 2661 | $link = 'https://wpcerber.com/?plugin\_version=' . $new\_ver; |
  |  | 2662 | $msg\_one = \_\_( 'A new version of WP Cerber Security is available. It is strongly advised to install it.', 'wp-cerber' ); |
  |  | 2663 | $msg\_two = \_\_( 'Know more details about this version here:', 'wp-cerber' ); |
  |  | 2664 |  |
  |  | 2665 | if ( ! cerber\_get\_set( '\_cerber\_message\_new', null, false ) ) { |
  |  | 2666 | cerber\_admin\_message( array( $msg\_one, $msg\_two . ' ' . '<a href="' . $link . '" target="\_blank">' . $link . '</a>' ) ); |
  |  | 2667 | cerber\_update\_set( '\_cerber\_message\_new', 1, null, false, time() + HOUR\_IN\_SECONDS ); |
  |  | 2668 | } |
  |  | 2669 |  |
  |  | 2670 | if ( ! crb\_get\_settings( 'notify-new-ver' ) ) { |
  |  | 2671 | return $new\_ver; |
  |  | 2672 | } |
  |  | 2673 |  |
  |  | 2674 | $history = get\_site\_option( '\_cerber\_notify\_new' ); |
  |  | 2675 |  |
  |  | 2676 | if ( ! $history || ! is\_array( $history ) ) { |
  |  | 2677 | $history = array(); |
  |  | 2678 | } |
  |  | 2679 |  |
  |  | 2680 | if ( in\_array( $new\_ver, $history ) ) { |
  |  | 2681 | return $new\_ver; |
  |  | 2682 | } |
  |  | 2683 |  |
  |  | 2684 | cerber\_send\_notification( 'new\_version', array( |
  |  | 2685 | 'subj' => sprintf( \_\_( 'WP Cerber %s is available. Please update.', 'wp-cerber' ), $new\_ver ), |
  |  | 2686 | 'text' => array( $msg\_one, $msg\_two . ' ' . $link ) |
  |  | 2687 | ) ); |
  |  | 2688 |  |
  |  | 2689 | $history[] = $new\_ver; |
  |  | 2690 | update\_site\_option( '\_cerber\_notify\_new', $history ); |
  |  | 2691 |  |
  |  | 2692 | return $new\_ver; |
  | 2600 | 2693 | } |
  | 2601 | 2694 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L2678) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L2771) |  |
  | 2678 | 2771 | } |
  | 2679 | 2772 |  |
  | 2680 |  | if ( $flat ) { |
  |  | 2773 | if ( $ret && $flat ) { |
  | 2681 | 2774 | $ret = array\_map( function ( $e ) { |
  | 2682 | 2775 | if ( is\_array( $e ) ) { |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L2850) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L2943) |  |
  | 2850 | 2943 | } |
  | 2851 | 2944 |  |
  |  | 2945 | /\*\* |
  |  | 2946 | \* @param string $query |
  |  | 2947 | \* |
  |  | 2948 | \* @return bool|mixed |
  |  | 2949 | \*/ |
  | 2852 | 2950 | function cerber\_db\_get\_var( $query ) { |
  | 2853 | 2951 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L3046) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L3144) |  |
  | 3046 | 3144 | \* @param bool $use\_cache |
  | 3047 | 3145 | \* |
  | 3048 |  | \* @return bool|array |
  |  | 3146 | \* @return bool|array|string |
  | 3049 | 3147 | \*/ |
  | 3050 | 3148 | function cerber\_get\_set( $key, $id = null, $unserialize = true, $use\_cache = null ) { |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L3393) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L3491) |  |
  | 3393 | 3491 | $rules = array(); |
  | 3394 | 3492 |  |
  | 3395 |  | if ( ! empty( $settings['adminphp'] ) && ( ! defined( 'CONCATENATE\_SCRIPTS' ) || ! CONCATENATE\_SCRIPTS ) ) { |
  |  | 3493 | if ( ! empty( $settings['adminphp'] ) |
  |  | 3494 | && ( ! defined( 'CONCATENATE\_SCRIPTS' ) || ! CONCATENATE\_SCRIPTS ) ) { |
  | 3396 | 3495 | // https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6389 |
  | 3397 |  | if ( ! apache\_mod\_loaded( 'mod\_rewrite', true ) ) { |
  | 3398 |  | cerber\_add\_issue( 'no\_mod', 'The Apache mod\_rewrite module is not enabled on your web server. Ask your server administrator for assistance.', 'adminphp' ); |
  |  | 3496 | if ( ! crb\_is\_apache\_mod\_loaded( 'mod\_rewrite' ) ) { |
  | 3399 | 3497 |  |
  | 3400 | 3498 | return new WP\_Error( 'no\_mod', 'The Apache mod\_rewrite module is not enabled on your web server. Ask your server administrator for assistance.' ); |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L3554) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L3652) |  |
  | 3554 | 3652 |  |
  | 3555 | 3653 | /\*\* |
  | 3556 |  | \* ~~Prepare files (install/deinstall)~~ for different boot modes |
  |  | 3654 | \* Install and de-install WP Cerber files for different boot modes |
  | 3557 | 3655 | \* |
  | 3558 | 3656 | \* @param $mode int A plugin boot mode |
  | 3559 |  | \*~~@param $old\_mode int~~ |
  | 3560 |  | \* |
  | 3561 |  | \*~~@return bool|WP\_Error~~ |
  |  | 3657 | \* |
  |  | 3658 | \* @return int|WP\_Error |
  |  | 3659 | \* |
  | 3562 | 3660 | \* @since 6.3 |
  | 3563 | 3661 | \*/ |
  | 3564 |  | function cerber\_set\_boot\_mode( $mode = null~~, $old\_mode = null~~ ) { |
  |  | 3662 | function cerber\_set\_boot\_mode( $mode = null ) { |
  | 3565 | 3663 | if ( $mode === null ) { |
  | 3566 | 3664 | $mode = crb\_get\_settings( 'boot-mode' ); |
  | 3567 | 3665 | } |
  |  | 3666 |  |
  | 3568 | 3667 | $source = dirname( cerber\_plugin\_file() ) . '/modules/aaa-wp-cerber.php'; |
  | 3569 | 3668 | $target = WPMU\_PLUGIN\_DIR . '/aaa-wp-cerber.php'; |
  |  | 3669 |  |
  | 3570 | 3670 | if ( $mode == 1 ) { |
  |  | 3671 |  |
  | 3571 | 3672 | if ( file\_exists( $target ) ) { |
  | 3572 | 3673 | if ( sha1\_file( $source, true ) == sha1\_file( $target, true ) ) { |
  | 3573 |  | return ~~true~~; |
  |  | 3674 | return 1; |
  | 3574 | 3675 | } |
  | 3575 | 3676 | } |
  |  | 3677 |  |
  |  | 3678 | // Copying the file |
  |  | 3679 |  |
  | 3576 | 3680 | if ( ! is\_dir( WPMU\_PLUGIN\_DIR ) ) { |
  | 3577 | 3681 | if ( ! mkdir( WPMU\_PLUGIN\_DIR, 0755, true ) ) { |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L3579) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L3683) |  |
  | 3579 | 3683 | } |
  | 3580 | 3684 | } |
  |  | 3685 |  |
  | 3581 | 3686 | if ( ! copy( $source, $target ) ) { |
  | 3582 | 3687 | if ( ! wp\_is\_writable( WPMU\_PLUGIN\_DIR ) ) { |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L3589) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L3694) |  |
  | 3589 | 3694 | return new WP\_Error( 'cerber-boot', \_\_( 'Unable to copy the file', 'wp-cerber' ) . ' ' . $source . ' to the folder ' . WPMU\_PLUGIN\_DIR ); |
  | 3590 | 3695 | } |
  | 3591 |  | } |
  | 3592 |  | else { |
  | 3593 |  | if ( file\_exists( $target ) ) { |
  | 3594 |  | if ( ! unlink( $target ) ) { |
  | 3595 |  | return new WP\_Error( 'cerber-boot', \_\_( 'Unable to delete the file', 'wp-cerber' ) . ' ' . $target ); |
  | 3596 |  | } |
  | 3597 |  | } |
  | 3598 |  |  |
  | 3599 |  | return true; |
  | 3600 |  | } |
  | 3601 |  |  |
  | 3602 |  | return true; |
  |  | 3696 | else { |
  |  | 3697 | return 2; |
  |  | 3698 | } |
  |  | 3699 | } |
  |  | 3700 |  |
  |  | 3701 | if ( file\_exists( $target ) ) { |
  |  | 3702 | if ( ! unlink( $target ) ) { |
  |  | 3703 | return new WP\_Error( 'cerber-boot', \_\_( 'Unable to delete the file', 'wp-cerber' ) . ' ' . $target ); |
  |  | 3704 | } |
  |  | 3705 | else { |
  |  | 3706 | cerber\_diag\_log( 'MU module deleted. IP:' . cerber\_get\_remote\_ip() . ' METHOD: ' . $\_SERVER['REQUEST\_METHOD'] . ' ' . print\_r( crb\_get\_post\_fields(), 1 ) . ' UA: ' . $\_SERVER['HTTP\_USER\_AGENT'] . ' REQ: ' . $\_SERVER['REQUEST\_URI'] ); |
  |  | 3707 | return 3; |
  |  | 3708 | } |
  |  | 3709 | } |
  |  | 3710 |  |
  |  | 3711 | return 4; |
  | 3603 | 3712 | } |
  | 3604 | 3713 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L3624) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L3733) |  |
  | 3624 | 3733 | } |
  | 3625 | 3734 |  |
  | 3626 |  | $ret = (~~get\_option( 'permalink\_structure' ) ) ? true : false~~; |
  |  | 3735 | $ret = (bool) get\_option( 'permalink\_structure' ); |
  | 3627 | 3736 |  |
  | 3628 | 3737 | return $ret; |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L3691) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L3800) |  |
  | 3691 | 3800 | \* @return bool|int |
  | 3692 | 3801 | \*/ |
  | 3693 |  | function crb\_wp\_version\_compare( $ver ) { |
  | 3694 |  | return version\_compare( cerber\_get\_wp\_version(), ~~$ver, '>='~~ ); |
  |  | 3802 | function crb\_wp\_version\_compare( $ver, $comp = '>=' ) { |
  |  | 3803 | return version\_compare( cerber\_get\_wp\_version(), (string) $ver, $comp ); |
  | 3695 | 3804 | } |
  | 3696 | 3805 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L3721) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L3830) |  |
  | 3721 | 3830 |  |
  | 3722 | 3831 | if ( ! $lc ) { |
  | 3723 |  | global $wp\_local\_package; |
  |  | 3832 | //global $wp\_local\_package; |
  | 3724 | 3833 | include( ABSPATH . WPINC . DIRECTORY\_SEPARATOR . 'version.php' ); |
  | 3725 |  | $lc = ~~isset( $wp\_local\_package ) ? $wp\_local\_package :~~ 'en\_US'; |
  |  | 3834 | $lc = $wp\_local\_package ?? 'en\_US'; |
  | 3726 | 3835 | } |
  | 3727 | 3836 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L4226) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L4335) |  |
  | 4226 | 4335 |  |
  | 4227 | 4336 | add\_filter( 'filesystem\_method', '\_\_ret\_direct' ); |
  |  | 4337 |  |
  | 4228 | 4338 | if ( ! WP\_Filesystem() ) { |
  | 4229 | 4339 | return new WP\_Error( 'cerber-file', 'Unable to init WP\_Filesystem' ); |
  | 4230 | 4340 | } |
  |  | 4341 |  |
  | 4231 | 4342 | remove\_filter( 'filesystem\_method', '\_\_ret\_direct' ); |
  | 4232 | 4343 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L4304) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L4415) |  |
  | 4304 | 4415 | } |
  | 4305 | 4416 |  |
  | 4306 |  | $int\_fields = array( 'al\_limit', 'al\_ignore\_rate', 'al\_send\_emails', 'al\_send\_pushbullet' ); |
  |  | 4417 | $int\_fields = array( 'al\_limit', 'al\_ignore\_rate', 'al\_send\_emails', 'al\_send\_pushbullet', 'al\_send\_me', ); |
  | 4307 | 4418 |  |
  | 4308 | 4419 | foreach ( $int\_fields as $f ) { |
  | 4309 |  | $params[ $f ] = absint( $params[ $f ] ); |
  |  | 4420 | $params[ $f ] = crb\_absint( $params[ $f ] ); |
  | 4310 | 4421 | } |
  | 4311 | 4422 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L4465) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L4576) |  |
  | 4465 | 4576 | } |
  | 4466 | 4577 |  |
  |  | 4578 | function crb\_is\_apache\_mod\_loaded( $mod = '' ) { |
  |  | 4579 | static $loaded = array(); |
  |  | 4580 |  |
  |  | 4581 | if ( ! isset( $loaded[ $mod ] ) ) { |
  |  | 4582 | $loaded[ $mod ] = apache\_mod\_loaded( 'mod\_rewrite' ); |
  |  | 4583 | } |
  |  | 4584 |  |
  |  | 4585 | return $loaded[ $mod ]; |
  |  | 4586 | } |
  |  | 4587 |  |
  | 4467 | 4588 | // The key-value cache |
  | 4468 | 4589 |  |
  | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2851742#L4765) | […](/browser/wp-cerber/trunk/cerber-common.php?rev=2865322#L4886) |  |
  | 4765 | 4886 |  |
  | 4766 | 4887 | } |
  |  | 4888 |  |
  |  | 4889 | /\*\* |
  |  | 4890 | \* Returns full last login info if it exists, false otherwise. |
  |  | 4891 | \* Updates last login information, it it's empty. |
  |  | 4892 | \* |
  |  | 4893 | \* @param $user\_id |
  |  | 4894 | \* |
  |  | 4895 | \* @return false|array |
  |  | 4896 | \* |
  |  | 4897 | \* @since 9.4.1 |
  |  | 4898 | \*/ |
  |  | 4899 | function crb\_get\_last\_user\_login( $user\_id ) { |
  |  | 4900 | $user\_set = cerber\_get\_set( CRB\_USER\_SET, $user\_id ); |
  |  | 4901 |  |
  |  | 4902 | if ( $user\_set['last\_login']['cn'] ?? false ) { |
  |  | 4903 | return $user\_set['last\_login']; |
  |  | 4904 | } |
  |  | 4905 |  |
  |  | 4906 | if ( ! $row = cerber\_get\_last\_login( $user\_id ) ) { |
  |  | 4907 | return false; |
  |  | 4908 | } |
  |  | 4909 |  |
  |  | 4910 | // Updating introduced in 9.4.1 elements |
  |  | 4911 |  |
  |  | 4912 | $user\_set['last\_login']['ts'] = $row->stamp; |
  |  | 4913 | $user\_set['last\_login']['cn'] = $row->country ?: lab\_get\_country( $row->ip, false ); |
  |  | 4914 |  |
  |  | 4915 | cerber\_update\_set( CRB\_USER\_SET, $user\_set, $user\_id ); |
  |  | 4916 |  |
  |  | 4917 | return $user\_set['last\_login']; |
  |  | 4918 | } |
  |  | 4919 |  |
  | 4767 | 4920 |  |
  | 4768 | 4921 | /\*\* |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2865322)
* [Zip Archive](?format=zip&new=2865322)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

