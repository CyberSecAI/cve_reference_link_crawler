

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3027723%2540guest-author-name%26old%3D3027723%2540guest-author-name)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2993474/guest-author-name "Changeset 2993474 for guest-author-name")
* [Next Change](/changeset/3030950/guest-author-name "Changeset 3030950 for guest-author-name") →

---

# Changeset [3027723](/changeset/3027723 "Show full changeset") for [guest-author-name](/browser/guest-author-name?rev=3027723 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
01/28/2024 02:30:10 AM
([12 months](/timeline?from=2024-01-28T02%3A30%3A10Z&precision=second "See timeline at 01/28/2024 02:30:10 AM") ago)

Author:
nomadcoder
Message:
# 4.35

Unable to duplicate security issue reported by the hard working volunteers

> at wordpress.org, but did find an issue with the guest author description.
>
> This may unavoidably cause issues on some sites.
>
> Added more escaping & sanitizing of fields.

Location:
[guest-author-name/trunk](/browser/guest-author-name/trunk?rev=3027723)
Files:

2 edited

* [readme.txt](/browser/guest-author-name/trunk/readme.txt?rev=3027723 "Show entry in browser")
  (modified)
  ([3 diffs](#file0 "Show differences"))
* [sfly-guest-author.php](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723 "Show entry in browser")
  (modified)
  ([21 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [guest-author-name/trunk/readme.txt](/changeset/3027723/guest-author-name/trunk/readme.txt "Show the changeset 3027723 restricted to guest-author-name/trunk/readme.txt")

  | [r2993474](/browser/guest-author-name/trunk/readme.txt?rev=2993474#L5 "Show revision 2993474 of this file in browser") | [r3027723](/browser/guest-author-name/trunk/readme.txt?rev=3027723#L5 "Show revision 3027723 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Requires at least: 4.1 |
  | 6 | 6 | Tested up to: 6.4 |
  | 7 |  | Stable Tag: ~~6.4~~ |
  |  | 7 | Stable Tag: 4.35 |
  | 8 | 8 | License: GPLv2 or later |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/guest-author-name/trunk/readme.txt?rev=2993474#L13) | […](/browser/guest-author-name/trunk/readme.txt?rev=3027723#L13) |  |
  | 13 | 13 |  |
  | 14 | 14 | == Description == |
  | 15 |  | Version 4.3~~4~~ |
  |  | 15 | Version 4.35 |
  | 16 | 16 |  |
  | 17 | 17 | Free |
  | […](/browser/guest-author-name/trunk/readme.txt?rev=2993474#L112) | […](/browser/guest-author-name/trunk/readme.txt?rev=3027723#L112) |  |
  | 112 | 112 | 3. Settings Page |
  | 113 | 113 | == Changelog == |
  |  | 114 | = 4.35 = |
  |  | 115 | Unable to duplicate security issue reported by the hard working volunteers |
  |  | 116 | at wordpress.org, but did find an issue with the guest author description. |
  |  | 117 | This may unavoidably cause issues on some sites. |
  |  | 118 | Added more escaping & sanitizing of fields. |
  | 114 | 119 | = 4.34 = |
  | 115 | 120 | Remove error loging |
* ## [guest-author-name/trunk/sfly-guest-author.php](/changeset/3027723/guest-author-name/trunk/sfly-guest-author.php "Show the changeset 3027723 restricted to guest-author-name/trunk/sfly-guest-author.php")

  | [r2813035](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L172 "Show revision 2813035 of this file in browser") | [r3027723](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L172 "Show revision 3027723 of this file in browser") |  |
  | --- | --- | --- |
  | 172 | 172 | add\_filter( 'body\_class',        array( $this, 'sfly\_guest\_author\_body\_class') );            //add some classes to the body class |
  | 173 | 173 |  |
  | 174 |  | ~~/\*~~ |
  | 175 |  | ~~add\_filter( 'author\_link',                 array( $this, 'guest\_author\_link' ), $this->priority, 2 ); //the author url~~ |
  | 176 |  | ~~add\_filter( 'get\_the\_author\_link',         array( $this, 'guest\_author\_link' ), $this->priority, 2 );~~ |
  | 177 |  | ~~add\_filter( 'get\_the\_author\_url',          array( $this, 'guest\_author\_link' ), $this->priority, 2 );~~ |
  | 178 |  | ~~add\_filter( 'get\_the\_author\_user\_url',     array( $this, 'guest\_author\_url' ), $this->priority, 2 );~~ |
  | 179 |  | ~~add\_filter( 'bp\_core\_get\_user\_domain',     array( $this, 'guest\_author\_link' ), $this->priority, 2 );~~ |
  | 180 |  |  |
  | 181 |  | ~~//          add\_filter( 'the\_author\_posts\_link',       array( $this, 'guest\_author\_posts\_link'), $this->priority, 1 );~~ |
  | 182 |  | ~~add\_filter( 'get\_the\_author\_first\_name', array( $this, 'guest\_author\_empty' ) , 10 );~~ |
  | 183 |  | ~~add\_filter( 'get\_the\_author\_last\_name', array( $this, 'guest\_author\_empty' ) , 10 );~~ |
  | 184 |  |  |
  | 185 |  | ~~add\_filter( 'author\_description',          array( $this, 'guest\_author\_description'), 10) ;   //the author description/bio~~ |
  | 186 |  | ~~add\_filter( 'get\_the\_author\_description',  array( $this,  'guest\_author\_description' ), 10) ;~~ |
  | 187 |  | ~~add\_filter( 'get\_the\_author\_user\_description', array( $this,  'guest\_author\_description' ), 10) ;~~ |
  | 188 |  |  |
  | 189 |  |  |
  | 190 |  | ~~add\_filter( 'get\_the\_author\_user\_email',  array( $this, 'guest\_author\_email' ), $this->priority ); //the author email~~ |
  | 191 |  | ~~add\_filter( 'get\_the\_author\_email', array( $this, 'guest\_author\_email' ), $this->priority ); //the author email)\*/~~ |
  | 192 | 174 | } |
  | 193 | 175 | } |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L348) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L330) |  |
  | 348 | 330 | global $post; |
  | 349 | 331 | if ( is\_single() ) { |
  | 350 |  | $author = ~~get\_post\_meta( $post->ID, 'sfly\_guest\_author\_names', true~~ ); |
  |  | 332 | $author = esc\_attr(get\_post\_meta( $post->ID, 'sfly\_guest\_author\_names', true )); |
  | 351 | 333 | if ($author) |
  | 352 | 334 |  |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L363) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L345) |  |
  | 363 | 345 | function register\_author() { |
  | 364 | 346 | $id = $this->get\_post\_id(); |
  | 365 |  | $gauthor = ~~get\_post\_meta( $id, 'sfly\_guest\_author\_names', true~~ ); |
  |  | 347 | $gauthor = esc\_attr(get\_post\_meta( $id, 'sfly\_guest\_author\_names', true )); |
  | 366 | 348 | $guest\_author\_post\_id = null; |
  | 367 | 349 | if (!$gauthor) |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L409) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L391) |  |
  | 409 | 391 | function guest\_author\_id( $id ) { |
  | 410 | 392 | $id = $this->get\_post\_id(); |
  | 411 |  | $author = ~~get\_post\_meta( $id, 'sfly\_guest\_author\_names', true~~ ); |
  |  | 393 | $author = esc\_attr(get\_post\_meta( $id, 'sfly\_guest\_author\_names', true )); |
  | 412 | 394 | if ( $author ) |
  | 413 | 395 | $id = NULL; |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L462) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L444) |  |
  | 462 | 444 | $id = $this->get\_post\_id(); |
  | 463 | 445 |  |
  | 464 |  | $author = ~~get\_post\_meta( $id, 'sfly\_guest\_author\_names', true~~ ); |
  |  | 446 | $author = esc\_attr(get\_post\_meta( $id, 'sfly\_guest\_author\_names', true )); |
  | 465 | 447 | if ( $author ) { |
  | 466 | 448 | $name = $author; |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L478) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L460) |  |
  | 478 | 460 | function guest\_author\_link( $link ) { |
  | 479 | 461 | $id = $this->get\_post\_id(); |
  | 480 |  | $author = ~~get\_post\_meta( $id, 'sfly\_guest\_author\_names', true~~ ); |
  |  | 462 | $author = esc\_attr( get\_post\_meta( $id, 'sfly\_guest\_author\_names', true )); |
  | 481 | 463 | if ( $author ) |
  | 482 | 464 | { |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L496) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L478) |  |
  | 496 | 478 | function guest\_author\_description( $description ) { |
  | 497 | 479 | $id = $this->get\_post\_id(); |
  | 498 |  | $author = ~~get\_post\_meta( $id, 'sfly\_guest\_author\_names', true~~ ); |
  |  | 480 | $author = esc\_attr(get\_post\_meta( $id, 'sfly\_guest\_author\_names', true )); |
  | 499 | 481 | if ( $author ) |
  | 500 | 482 | { |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L503) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L485) |  |
  | 503 | 485 |  |
  | 504 | 486 | if ( $allowhtml ) |
  | 505 |  | $description =  ~~html\_entity\_decode~~(get\_post\_meta( $id, 'sfly\_guest\_author\_description', true ) ); |
  |  | 487 | $description =  wp\_kses\_post(get\_post\_meta( $id, 'sfly\_guest\_author\_description', true ) ); |
  | 506 | 488 | else |
  | 507 |  | $description =   ~~get\_post\_meta( $id, 'sfly\_guest\_author\_description', true~~ ) ; |
  |  | 489 | $description =   esc\_attr(get\_post\_meta( $id, 'sfly\_guest\_author\_description', true )) ; |
  | 508 | 490 |  |
  | 509 | 491 | if (!$description) |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L540) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L522) |  |
  | 540 | 522 | function guest\_author\_email( $email ) { |
  | 541 | 523 | $id = $this->get\_post\_id(); |
  | 542 |  | $author = ~~get\_post\_meta( $id, 'sfly\_guest\_author\_names', true~~ ); |
  |  | 524 | $author = esc\_attr(get\_post\_meta( $id, 'sfly\_guest\_author\_names', true )); |
  | 543 | 525 | if ( $author ) |
  | 544 | 526 | { |
  | 545 |  | $email = ~~get\_post\_meta( $id, 'sfly\_guest\_author\_email', true~~ ); |
  |  | 527 | $email = esc\_html(get\_post\_meta( $id, 'sfly\_guest\_author\_email', true )); |
  | 546 | 528 | if (!$email) |
  | 547 | 529 | $email = ""; |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L582) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L564) |  |
  | 582 | 564 | $id = $this->get\_post\_id(); |
  | 583 | 565 |  |
  | 584 |  | $author = ~~get\_post\_meta( $id, 'sfly\_guest\_author\_names', true~~ ); |
  |  | 566 | $author = esc\_attr(get\_post\_meta( $id, 'sfly\_guest\_author\_names', true )); |
  | 585 | 567 |  |
  | 586 | 568 | if ( $author ) |
  | 587 | 569 | { |
  | 588 |  | $email = ~~get\_post\_meta( $id, 'sfly\_guest\_author\_email', true~~ ); |
  |  | 570 | $email = esc\_html(get\_post\_meta( $id, 'sfly\_guest\_author\_email', true )); |
  | 589 | 571 |  |
  | 590 | 572 |  |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L621) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L603) |  |
  | 621 | 603 | $id = $this->get\_post\_id(); |
  | 622 | 604 |  |
  | 623 |  | $author = ~~get\_post\_meta( $id, 'sfly\_guest\_author\_names', true~~ ); |
  |  | 605 | $author = esc\_attr(get\_post\_meta( $id, 'sfly\_guest\_author\_names', true )); |
  | 624 | 606 |  |
  | 625 | 607 | if ( $author ) |
  | 626 | 608 | { |
  | 627 |  | $email = ~~get\_post\_meta( $id, 'sfly\_guest\_author\_email', true~~ ); |
  |  | 609 | $email = esc\_html(get\_post\_meta( $id, 'sfly\_guest\_author\_email', true )); |
  | 628 | 610 | if ($email) { |
  | 629 | 611 | $url = $this->get\_guest\_gravatar\_link($email); |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L668) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L650) |  |
  | 668 | 650 | $id = $this->get\_post\_id(); |
  | 669 | 651 |  |
  | 670 |  | $author = ~~get\_post\_meta( $id, 'sfly\_guest\_author\_names', true~~ ); |
  |  | 652 | $author = esc\_attr(get\_post\_meta( $id, 'sfly\_guest\_author\_names', true )); |
  | 671 | 653 |  |
  | 672 | 654 | if ( $author ) |
  | 673 | 655 | { |
  | 674 |  | $email = ~~get\_post\_meta( $id, 'sfly\_guest\_author\_email', true~~ ); |
  |  | 656 | $email = esc\_html(get\_post\_meta( $id, 'sfly\_guest\_author\_email', true )); |
  | 675 | 657 |  |
  | 676 | 658 | if ($email) { |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L832) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L814) |  |
  | 832 | 814 | \*/ |
  | 833 | 815 | function render\_post\_columns($column\_name, $id) { |
  |  | 816 | $options = get\_option( 'guest\_author\_name\_settings' ); |
  |  | 817 | $allowhtml = isset( $options['guest\_author\_allow\_html'] ) ? true : false ; |
  |  | 818 |  |
  |  | 819 | if ( $allowhtml ) |
  |  | 820 | $description =  wp\_kses\_post(get\_post\_meta( $id, 'sfly\_guest\_author\_description', true ) ); |
  |  | 821 | else |
  |  | 822 | $description =   esc\_attr(get\_post\_meta( $id, 'sfly\_guest\_author\_description', true )) ; |
  |  | 823 |  |
  |  | 824 | if (!$description) |
  |  | 825 | $description = ""; |
  | 834 | 826 |  |
  | 835 | 827 | switch ($column\_name) { |
  | 836 | 828 | case 'sfly\_guest\_author': |
  | 837 |  | echo ~~get\_post\_meta( $id, 'sfly\_guest\_author\_names', TRUE~~); |
  |  | 829 | echo sanitize\_text\_field(get\_post\_meta( $id, 'sfly\_guest\_author\_names', TRUE)); |
  | 838 | 830 | break; |
  | 839 | 831 | case 'sfly\_guest\_link': |
  | 840 |  | echo ~~get\_post\_meta( $id, 'sfly\_guest\_link', TRUE~~); |
  |  | 832 | echo esc\_url(get\_post\_meta( $id, 'sfly\_guest\_link', TRUE)); |
  | 841 | 833 | break; |
  | 842 | 834 | case 'sfly\_guest\_author\_description': |
  | 843 |  | echo ~~get\_post\_meta( $id, 'sfly\_guest\_author\_description', TRUE)~~; |
  |  | 835 | echo $description; |
  | 844 | 836 | break; |
  | 845 | 837 | case 'sfly\_guest\_author\_email': |
  | 846 |  | echo ~~get\_post\_meta( $id, 'sfly\_guest\_author\_email', TRUE~~); |
  |  | 838 | echo esc\_html(get\_post\_meta( $id, 'sfly\_guest\_author\_email', TRUE)); |
  | 847 | 839 |  |
  | 848 | 840 |  |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L869) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L861) |  |
  | 869 | 861 | } |
  | 870 | 862 | if ( isset( $\_REQUEST['sfly\_guest\_author'] ) ) { |
  | 871 |  | update\_post\_meta( $post\_id, 'sfly\_guest\_author', ~~$\_REQUEST['sfly\_guest\_author']~~ ); |
  |  | 863 | update\_post\_meta( $post\_id, 'sfly\_guest\_author', santize\_text\_field( $\_REQUEST['sfly\_guest\_author'] ) ); |
  | 872 | 864 | } |
  | 873 | 865 | if ( isset( $\_REQUEST['sfly\_guest\_link'] ) ) { |
  | 874 |  | update\_post\_meta( $post\_id, 'sfly\_guest\_link', ~~$\_REQUEST['sfly\_guest\_link']~~ ); |
  |  | 866 | update\_post\_meta( $post\_id, 'sfly\_guest\_link', esc\_url( $\_REQUEST['sfly\_guest\_link'] )); |
  | 875 | 867 | } |
  | 876 | 868 | if ( isset( $\_REQUEST['sfly\_guest\_author\_description'] ) ) { |
  | 877 |  | update\_post\_meta( $post\_id, 'sfly\_guest\_author\_description', ~~$\_REQUEST['sfly\_guest\_author\_description']~~ ); |
  |  | 869 | update\_post\_meta( $post\_id, 'sfly\_guest\_author\_description', wp\_kses\_post($\_REQUEST['sfly\_guest\_author\_description'] )); |
  | 878 | 870 | } |
  | 879 | 871 | if ( isset( $\_REQUEST['sfly\_guest\_author\_email'] ) ) { |
  | 880 |  | update\_post\_meta( $post\_id, 'sfly\_guest\_author\_email', ~~$\_REQUEST['sfly\_guest\_author\_email']~~ ); |
  |  | 872 | update\_post\_meta( $post\_id, 'sfly\_guest\_author\_email', esc\_html($\_REQUEST['sfly\_guest\_author\_email'] )); |
  | 881 | 873 | } |
  | 882 | 874 | } |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L905) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L897) |  |
  | 905 | 897 |  |
  | 906 | 898 | <?php |
  |  | 899 |  |
  | 907 | 900 | switch ( $col ) { |
  | 908 | 901 | case 'sfly\_guest\_author': |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L963) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L956) |  |
  | 963 | 956 | $link = esc\_url($\_POST['sfly\_guest\_link']); |
  | 964 | 957 |  |
  | 965 |  | $options = get\_option( 'guest\_author\_name\_settings' ); |
  | 966 |  | $allowhtml = isset( $options['guest\_author\_allow\_html'] ) ? true : false ; |
  |  | 958 | $options = get\_option( 'guest\_author\_name\_settings' ); |
  |  | 959 | $allowhtml = isset( $options['guest\_author\_allow\_html'] ) ? true : false ; |
  |  | 960 |  |
  | 967 | 961 |  |
  | 968 | 962 | if ($allowhtml) |
  | 969 |  | ~~$description = htmlentities~~(  $\_POST['sfly\_guest\_author\_description'] ); |
  | 970 |  | else |
  | 971 |  | $description = sanitize\_text\_field( $\_POST['sfly\_guest\_author\_description']); |
  |  | 963 | $description = wp\_kses\_post(  $\_POST['sfly\_guest\_author\_description'] ); |
  |  | 964 | else |
  |  | 965 | $description = sanitize\_text\_field( $\_POST['sfly\_guest\_author\_description']); |
  | 972 | 966 |  |
  | 973 | 967 | $email = sanitize\_email( $\_POST['sfly\_guest\_author\_email'] ); |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L979) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L973) |  |
  | 979 | 973 | } |
  | 980 | 974 |  |
  | 981 |  | /\* render\_meta\_box\_content function. |
  | 982 |  | \* |
  | 983 |  | \* @access public |
  | 984 |  | \* @param mixed $post |
  | 985 |  | \* @return void |
  | 986 |  | \*/ |
  | 987 |  | /\*\* |
  |  | 975 | /\* |
  | 988 | 976 | \* render\_meta\_box\_content function. |
  | 989 | 977 | \* |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L996) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L984) |  |
  | 996 | 984 | wp\_nonce\_field( 'sfly\_guest\_author\_box', 'sfly\_guest\_author\_nonce' ); |
  | 997 | 985 | // Use get\_post\_meta to retrieve an existing values from the database. |
  | 998 |  | $value = get\_post\_meta( $post->ID, 'sfly\_guest\_author\_names', true ); |
  | 999 |  | $link = get\_post\_meta( $post->ID, 'sfly\_guest\_link', true ); |
  | 1000 |  | $description = get\_post\_meta($post->ID, 'sfly\_guest\_author\_description', true); |
  | 1001 |  | $email = get\_post\_meta($post->ID, 'sfly\_guest\_author\_email', true); |
  |  | 986 | $value = sanitize\_text\_field(get\_post\_meta( $post->ID, 'sfly\_guest\_author\_names', true ) ); |
  |  | 987 | $link = esc\_url( get\_post\_meta( $post->ID, 'sfly\_guest\_link', true ) ); |
  |  | 988 |  |
  |  | 989 | $options = get\_option( 'guest\_author\_name\_settings' ); |
  |  | 990 | $allowhtml = isset( $options['guest\_author\_allow\_html'] ) ? true : false ; |
  |  | 991 | $id = $post->ID; |
  |  | 992 | if ( $allowhtml ) |
  |  | 993 | $description =  wp\_kses\_post(get\_post\_meta( $id, 'sfly\_guest\_author\_description', true ) ); |
  |  | 994 | else |
  |  | 995 | $description =   esc\_attr(get\_post\_meta( $id, 'sfly\_guest\_author\_description', true ) ) ; |
  |  | 996 |  |
  |  | 997 | if (!$description) |
  |  | 998 | $description = ""; |
  |  | 999 |  |
  |  | 1000 | $email = esc\_html( get\_post\_meta( $post->ID, 'sfly\_guest\_author\_email', true ) ); |
  | 1002 | 1001 | // Display the form, using the current values. |
  | 1003 | 1002 | echo '<label for="sfly\_guest\_author">'; |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L1005) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L1004) |  |
  | 1005 | 1004 | echo '</label> '; |
  | 1006 | 1005 | echo '<input type="text" id="sfly\_guest\_author" name="sfly\_guest\_author"'; |
  | 1007 |  | echo ' value="' . ~~esc\_attr( $value )~~ . '" style="max-width:100%" size="150" class="widefat" />'; |
  |  | 1006 | echo ' value="' .  $value  . '" style="max-width:100%" size="150" class="widefat" />'; |
  | 1008 | 1007 | echo '<br/><label for="sfly\_guest\_link">'; |
  | 1009 | 1008 | \_e( 'Guest URL', 'sfly\_guest\_link' ); |
  | 1010 | 1009 | echo '</label><br/>'; |
  | 1011 | 1010 | echo '<input type="text" id="sfly\_guest\_link" name="sfly\_guest\_link"'; |
  | 1012 |  | echo ' value="' . ~~esc\_url( $link )~~ . '" style="max-width:100%" class="widefat"  />'; |
  |  | 1011 | echo ' value="' .  $link  . '" style="max-width:100%" class="widefat"  />'; |
  | 1013 | 1012 | echo '<br/><label for="sfly\_guest\_description">'; |
  | 1014 | 1013 | \_e( 'Guest Description', 'sfly\_guest\_description' ); |
  | 1015 | 1014 | echo '</label><br/> '; |
  | 1016 |  | echo '<textarea id="sfly\_guest\_author\_description" name="sfly\_guest\_author\_description" style="width:100%;height:40px;">' . ~~esc\_attr($description)~~ . '</textarea>'; |
  |  | 1015 | echo '<textarea id="sfly\_guest\_author\_description" name="sfly\_guest\_author\_description" style="width:100%;height:40px;">' . $description . '</textarea>'; |
  | 1017 | 1016 | echo '<label for="sfly\_guest\_author\_email">'; |
  | 1018 | 1017 | \_e( 'Guest Gravatar Email', 'sfly\_guest\_author\_email' ); |
  | 1019 | 1018 | echo '</label> '; |
  | 1020 | 1019 | echo '<input type="text" id="sfly\_guest\_author\_email" name="sfly\_guest\_author\_email"'; |
  | 1021 |  | echo ' value="' . ~~esc\_attr( $email )~~ . '" style="max-width:100%" class="widefat" size="150" />'; |
  |  | 1020 | echo ' value="' .  $email  . '" style="max-width:100%" class="widefat" size="150" />'; |
  | 1022 | 1021 | } |
  | 1023 | 1022 | /\*\*\*\*Functions for tag\_div only \*\*\*/ |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L1045) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L1044) |  |
  | 1045 | 1044 | if ( isset(  $g\_post\_id ) &&  $g\_post\_id > 0 ) |
  | 1046 | 1045 | { |
  | 1047 |  | $author = ~~get\_post\_meta( $g\_post\_id, 'sfly\_guest\_author\_names', true~~ ); |
  |  | 1046 | $author = esc\_attr(get\_post\_meta( $g\_post\_id, 'sfly\_guest\_author\_names', true )); |
  | 1048 | 1047 | if ( $author ) |
  | 1049 | 1048 | $name = $author; |
  | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=2813035#L1059) | […](/browser/guest-author-name/trunk/sfly-guest-author.php?rev=3027723#L1058) |  |
  | 1059 | 1058 |  |
  | 1060 | 1059 | if ( isset ( $g\_post\_id ) && $g\_post\_id  > 0 ) { |
  | 1061 |  | $author = ~~get\_post\_meta( $g\_post\_id, 'sfly\_guest\_author\_names', true~~ ); |
  |  | 1060 | $author = esc\_attr(get\_post\_meta( $g\_post\_id, 'sfly\_guest\_author\_names', true )); |
  | 1062 | 1061 | if ( $author ) |
  | 1063 | 1062 | { |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3027723)
* [Zip Archive](?format=zip&new=3027723)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

