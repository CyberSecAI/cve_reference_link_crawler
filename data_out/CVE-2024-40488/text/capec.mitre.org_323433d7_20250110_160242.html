

|  |  |
| --- | --- |
| [CAPECCommon Attack Pattern Enumeration and Classification A Community Resource for Identifying and Understanding Attacks](/index.html) |

 [New to CAPEC? Start Here](/about/new_to_capec.html "New to CAPEC? Start Here") |

| [Home](/) > [CAPEC List](/data/index.html) > CAPEC-62: Cross Site Request Forgery (Version 3.9) | ID Lookup: |
| --- | --- |

---

* [Home](/index.html)
* [About](/about/index.html)
  [Overview](/about/index.html)
  [Board](/about/board.html)
  [Glossary](/about/glossary.html)
  [Use Cases](/about/use_cases.html)
  [Resources](/about/resources.html)
  [Documents](/about/documents.html)
  [FAQs](/about/faq.html)
  [New to CAPEC?](/about/new_to_capec.html)
* [CAPEC List](/data/index.html)
  [Latest Version](/data/index.html)
  [Downloads](/data/downloads.html)
  [Reports](/data/reports.html)
  [Archive](/data/archive.html)
* [Community](/community/index.html)
  [Community](/community/index.html)
  [Citations](/community/citations.html)
  [Organization Usage](/community/usage.html)
  [Related Activities](/community/related.html)
  [Discussion List](/community/registration.html)
  [Discussion Archives](https://www.mail-archive.com/capec-research-list%40mitre.org/)
  [CAPEC User Summit](/about/documents.html#capec_user_summit)
* [News](/news/index.html)
  [Current News](/news/index.html)
  [CAPEC on Twitter![](/images/twitter_sm.png "Twitter")](https://twitter.com/CweCapec)
  [CAPEC on LinkedIn![LinkedIn](/images/linkedin_sm.jpg)](https://www.linkedin.com/showcase/cve-cwe-capec)
  [CAPEC Blog ![Medium](/images/medium.png)](https://medium.com/%40CWE_CAPEC)
  [CAPEC Podcast![Out of Bounds Read Podcast](/images/out_of_bounds_read_logo_B_W.png)](https://outofbounds.buzzsprout.com/)
  [CAPEC on YouTube![YouTube](/images/youtube.png)](https://www.youtube.com/channel/UCpY9VIpRmFK4ebD6orssifA)
  [News Archive](/news/archives/index.html)
* [Search](/find/index.html)

|  |  |  |
| --- | --- | --- |
| | CAPEC-62: Cross Site Request Forgery | | --- |  | Attack Pattern ID: 62**Abstraction: Standard** |  |  | | --- | --- | --- |   View customized information:  Conceptual Operational Mapping-Friendly Complete   + DescriptionAn attacker crafts malicious web links and distributes them (via web pages, email, etc.), typically in a targeted manner, hoping to induce users to click on the link and execute the malicious action against some third-party application. If successful, the action embedded in the malicious link will be processed and accepted by the targeted application with the users' privilege level. This type of attack leverages the persistence and implicit trust placed in user session cookies by many web applications today. In such an architecture, once the user authenticates to an application and a session cookie is created on the user's system, all following transactions for that session are authenticated using that cookie including potential actions initiated by an attacker and simply "riding" the existing session cookie. + Alternate Terms **Term:**  Session Riding + Likelihood Of Attack High + Typical Severity Very High + RelationshipsSection HelpThis table shows the other attack patterns and high level categories that are related to this attack pattern. These relationships are defined as ChildOf and ParentOf, and give insight to similar items that may exist at higher and lower levels of abstraction. In addition, relationships such as CanFollow, PeerOf, and CanAlsoBe are defined to show similar attack patterns that the user may want to explore.  | Nature | Type | ID | Name | | --- | --- | --- | --- | | ChildOf | Meta Attack PatternMeta Attack Pattern - A meta level attack pattern in CAPEC is a decidedly abstract characterization of a specific methodology or technique used in an attack. A meta attack pattern is often void of a specific technology or implementation and is meant to provide an understanding of a high level approach. A meta level attack pattern is a generalization of related group of standard level attack patterns. Meta level attack patterns are particularly useful for architecture and design level threat modeling exercises. | 21 | [Exploitation of Trusted Identifiers](/data/definitions/21.html) | | --- | --- | --- | --- | | ParentOf | Detailed Attack PatternDetailed Attack Pattern - A detailed level attack pattern in CAPEC provides a low level of detail, typically leveraging a specific technique and targeting a specific technology, and expresses a complete execution flow. Detailed attack patterns are more specific than meta attack patterns and standard attack patterns and often require a specific protection mechanism to mitigate actual attacks. A detailed level attack pattern often will leverage a number of different standard level attack patterns chained together to accomplish a goal. | 467 | [Cross Site Identification](/data/definitions/467.html) |  Section HelpThis table shows the views that this attack pattern belongs to and top level categories within that view.  | View Name | Top Level Categories | | --- | --- | | [Domains of Attack](http://capec.mitre.org/data/definitions/3000.html) | [Software](http://capec.mitre.org/data/definitions/513.html) | | [Mechanisms of Attack](http://capec.mitre.org/data/definitions/1000.html) | [Subvert Access Control](http://capec.mitre.org/data/definitions/225.html) |  + Execution FlowExplore  1. **Explore target website:** The attacker first explores the target website to determine pieces of functionality that are of interest to them (e.g. money transfers). The attacker will need a legitimate user account on the target website. It would help to have two accounts.         | Techniques |    | --- |    | Use web application debugging tool such as WebScarab, Tamper Data or TamperIE to analyze the information exchanged between the client and the server |    | Use network sniffing tool such as Wireshark to analyze the information exchanged between the client and the server |    | View HTML source of web pages that contain links or buttons that perform actions of interest. |  Experiment  1. **Create a link that when clicked on, will execute the interesting functionality.:** The attacker needs to create a link that will execute some interesting functionality such as transfer money, change a password, etc.         | Techniques |    | --- |    | Create a GET request containing all required parameters (e.g. https://www.somebank.com/members/transfer.asp?to=012345678901&amt=10000) |    | Create a form that will submit a POST request (e.g. <form method="POST" action="https://www.somebank.com/members/transfer.asp"><input type="hidden" Name="to" value="012345678901"/><input type="hidden" Name="amt" value="10000"/><input type="submit" src="clickhere.jpg"/></form> |  Exploit  1. **Convince user to click on link:** Finally, the attacker needs to convince a user that is logged into the target website to click on a link to execute the CSRF attack.         | Techniques |    | --- |    | Execute a phishing attack and send the user an e-mail convincing them to click on a link. |    | Execute a stored XSS attack on a website to permanently embed the malicious link into the website. |    | Execute a stored XSS attack on a website where an XMLHTTPRequest object will automatically execute the attack as soon as a user visits the page. This removes the step of convincing a user to click on a link. |    | Include the malicious link on the attackers' own website where the user may have to click on the link, or where an XMLHTTPRequest object may automatically execute the attack when a user visits the site. | + Skills Required  | [Level: Medium]The attacker needs to figure out the exact invocation of the targeted malicious action and then craft a link that performs the said action. Having the user click on such a link is often accomplished by sending an email or posting such a link to a bulletin board or the likes. | | --- |  + Resources Required  | All the attacker needs is the exact representation of requests to be made to the application and to be able to get the malicious link across to a victim. | | --- |  + ConsequencesSection HelpThis table specifies different individual consequences associated with the attack pattern. The Scope identifies the security property that is violated, while the Impact describes the negative technical impact that arises if an adversary succeeds in their attack. The Likelihood provides information about how likely the specific consequence is expected to be seen relative to the other consequences in the list. For example, there may be high likelihood that a pattern will be used to achieve a certain impact, but a low likelihood that it will be exploited to achieve a different impact.  | Scope | Impact | Likelihood | | --- | --- | --- | | ConfidentialityAccess ControlAuthorization | Gain Privileges |  | | Confidentiality | Read Data |  | | Integrity | Modify Data |  |  + Mitigations  | Use cryptographic tokens to associate a request with a specific action. The token can be regenerated at every request so that if a request with an invalid token is encountered, it can be reliably discarded. The token is considered invalid if it arrived with a request other than the action it was supposed to be associated with. | | --- | | Although less reliable, the use of the optional HTTP Referrer header can also be used to determine whether an incoming request was actually one that the user is authorized for, in the current context. | | Additionally, the user can also be prompted to confirm an action every time an action concerning potentially sensitive data is invoked. This way, even if the attacker manages to get the user to click on a malicious link and request the desired action, the user has a chance to recover by denying confirmation. This solution is also implicitly tied to using a second factor of authentication before performing such actions. | | In general, every request must be checked for the appropriate authentication token as well as authorization in the current session context. |  + Example Instances  | While a user is logged into their bank account, an attacker can send an email with some potentially interesting content and require the user to click on a link in the email.  The link points to or contains an attacker setup script, probably even within an iFrame, that mimics an actual user form submission to perform a malicious activity, such as transferring funds from the victim's account.  The attacker can have the script embedded in, or targeted by, the link perform any arbitrary action as the authenticated user. When this script is executed, the targeted application authenticates and accepts the actions based on the victims existing session cookie. See also: Cross-site request forgery (CSRF) vulnerability in util.pl in @Mail WebMail 4.51 allows remote attackers to modify arbitrary settings and perform unauthorized actions as an arbitrary user, as demonstrated using a settings action in the SRC attribute of an IMG element in an HTML e-mail. | | --- |  + Related WeaknessesSection HelpA Related Weakness relationship associates a weakness with this attack pattern. Each association implies a weakness that must exist for a given attack to be successful. If multiple weaknesses are associated with the attack pattern, then any of the weaknesses (but not necessarily all) may be present for the attack to be successful. Each related weakness is identified by a CWE identifier.  | CWE-ID | Weakness Name | | --- | --- | | [352](http://cwe.mitre.org/data/definitions/352.html) | Cross-Site Request Forgery (CSRF) | | [306](http://cwe.mitre.org/data/definitions/306.html) | Missing Authentication for Critical Function | | [664](http://cwe.mitre.org/data/definitions/664.html) | Improper Control of a Resource Through its Lifetime | | [732](http://cwe.mitre.org/data/definitions/732.html) | Incorrect Permission Assignment for Critical Resource | | [1275](http://cwe.mitre.org/data/definitions/1275.html) | Sensitive Cookie with Improper SameSite Attribute |  + Taxonomy MappingsSection HelpCAPEC mappings to ATT&CK techniques leverage an inheritance model to streamline and minimize direct CAPEC/ATT&CK mappings. Inheritance of a mapping is indicated by text stating that the parent CAPEC has relevant ATT&CK mappings. Note that the ATT&CK Enterprise Framework does not use an inheritance model as part of the mapping to CAPEC.Relevant to the ATT&CK taxonomy mapping (see [parent](/data/definitions/21.html))Relevant to the WASC taxonomy mapping  | Entry ID | Entry Name | | --- | --- | | [09](http://projects.webappsec.org/Cross-Site-Request-Forgery) | Cross-Site Request Forgery |  Relevant to the OWASP taxonomy mapping  | Entry Name | | --- | | [Cross Site Request Forgery (CSRF)](https://owasp.org/www-community/attacks/csrf) |  + References  | [REF-62] Thomas Schreiber. "Session Riding: A Widespread Vulnerability in Today's Web Applications". SecureNet GmbH. <<https://crypto.stanford.edu/cs155old/cs155-spring08/papers/Session_Riding.pdf>>. | | --- | | [REF-602] "OWASP Web Security Testing Guide". Testing for Cross Site Request Forgery. The Open Web Application Security Project (OWASP). <<https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery.html>>. |  + Content History  | Submissions | | | | --- | --- | --- | | Submission Date | Submitter | Organization | | 2014-06-23(Version 2.6) | CAPEC Content Team | The MITRE Corporation | |  | | | Modifications | | | | --- | --- | --- | | Modification Date | Modifier | Organization | | 2015-11-09(Version 2.7) | CAPEC Content Team | The MITRE Corporation | | Updated Attack\_Phases | | | 2015-12-07(Version 2.8) | CAPEC Content Team | The MITRE Corporation | | Updated Attack\_Phases | | | 2017-01-09(Version 2.9) | CAPEC Content Team | The MITRE Corporation | | Updated Alternate\_Terms, Attack\_Phases | | | 2017-05-01(Version 2.10) | CAPEC Content Team | The MITRE Corporation | | Updated Attack\_Phases | | | 2017-08-04(Version 2.11) | CAPEC Content Team | The MITRE Corporation | | Updated Attack\_Phases, Related\_Attack\_Patterns | | | 2018-07-31(Version 2.12) | CAPEC Content Team | The MITRE Corporation | | Updated Attack\_Phases, References | | | 2020-07-30(Version 3.3) | CAPEC Content Team | The MITRE Corporation | | Updated Example\_Instances, Execution\_Flow, Related\_Weaknesses | | | 2020-12-17(Version 3.4) | CAPEC Content Team | The MITRE Corporation | | Updated References, Taxonomy\_Mappings | | | 2021-06-24(Version 3.5) | CAPEC Content Team | The MITRE Corporation | | Updated Related\_Weaknesses | | | Previous Entry Names | | | | --- | --- | --- | | Change Date | Previous Entry Name | | | | 2017-01-09(Version 2.9) | Cross Site Request Forgery (aka Session Riding) | | |  | | |   More information is available — Please select a different filter. |

**Page Last Updated or Reviewed:**
July 31, 2018

|  | | |
| --- | --- | --- |
| [MITRE](https://www.mitre.org) | [Site Map](/sitemap.html) | [Terms of Use](/about/termsofuse.html) | Manage Cookies | [Cookie Notice](/about/cookie_notice.html) | [Privacy Policy](https://cwe.mitre.org/about/privacy_policy.html) | Contact Us | [CAPEC on Twitter](https://twitter.com/CweCapec) [CAPEC on LinkedIn](https://www.linkedin.com/showcase/cve-cwe-capec) [CAPEC on YouTube](https://www.youtube.com/channel/UCpY9VIpRmFK4ebD6orssifA) [CAPEC Out-of-Bounds-Read Podcast](https://outofbounds.buzzsprout.com/) [CAPEC Blog on Medium](https://medium.com/%40CWE_CAPEC)  Use of the Common Attack Pattern Enumeration and Classification (CAPEC), and the associated references from this website are subject to the [Terms of Use](/about/termsofuse.html). Copyright © 2007–2025, The MITRE Corporation. CAPEC and the CAPEC logo are trademarks of The MITRE Corporation. | [HSSEDI](https://www.dhs.gov/science-and-technology/hssedi) |

