- **Root cause of vulnerability**: The vulnerability stems from insufficient sanitization of the `filename` parameter during database restoration. While user inputs are generally passed through `htmlspecialchars` at startup, the `filename` parameter of the admin `tool/upload.upload` route bypasses this sanitization by using `html_entity_decode` later, allowing an attacker to inject malicious code into the database. Subsequently, during database restoration, this unsanitized data is used to create a backup file with an arbitrary filename, enabling the creation of malicious files.
- **Weaknesses/vulnerabilities present**:
    -  Arbitrary File Creation: The ability to create files with attacker-controlled names and content in the `/system/storage/backup` directory.
    -  Insufficient Input Sanitization: The `filename` parameter is not properly sanitized and bypasses the initial `htmlspecialchars` encoding through `html_entity_decode`.
- **Impact of exploitation**: An attacker with admin privileges can inject PHP code into the database through the vulnerable `filename` parameter, and later restore it as a backup file with a chosen name (e.g., `my_script.php`), potentially leading to arbitrary code execution on the server.
- **Attack vectors**:
    - Network-based attack via HTTP requests.
    - Exploitation of the `tool/upload.upload` route and `tool/backup.backup` route in the admin panel.
- **Required attacker capabilities/position**:
    - Requires admin privileges to access the vulnerable backup and upload functionality.
    - Ability to send HTTP POST requests with malicious parameters.