=== Content from fuchsia.googlesource.com_8a166f31_20250111_162312.html ===
[![Google Git](//www.gstatic.com/images/branding/lockups/2x/lockup_git_color_108x24dp.png)](/) [Sign in](https://accounts.google.com/AccountChooser?faa=1&service=gerritcodereview&continue=https://fuchsia.googlesource.com/login/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00) [fuchsia](/?format=HTML) / [fuchsia](/fuchsia/) / 7d731b4e9599088ac3073956933559da7bca6a00

| commit | 7d731b4e9599088ac3073956933559da7bca6a00 | [[log](/fuchsia/%2Blog/7d731b4e9599088ac3073956933559da7bca6a00)] [[tgz](/fuchsia/%2Barchive/7d731b4e9599088ac3073956933559da7bca6a00.tar.gz)] |
| --- | --- | --- |
| author | Travis Geiselbrecht <travisg@google.com> | Tue Dec 07 03:27:16 2021 +0000 |
| committer | Commit Bot <commit-bot@chromium.org> | Tue Dec 07 03:27:16 2021 +0000 |
| tree | [22482985c7dac6dfd52e418d423880cad15437d9](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/) |
| parent | [85cf47932359ea76deef555e5ee0c79422c5ae98](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00%5E) [[diff](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00%5E%21/)] |

```
[kernel][arm64][mmu] Fix bug where privileged executable pages are executable from EL0

Previously, was always setting UXN and PXN bits on pages explicitly
mapped as non executable, not taking into account that user (EL0) code
could access a privileged page because UXN wasn't set.

Change the logic to appropriately set PXN and UXN bits on user and
privleged executable pages, appropriately:

user/privileged non-executable page: UXN=1, PXN=1
user executable page: UXN=0, PXN=1
privileged executable page: UXN=1, PXN=0

EL2 mappings for the kernel interpret these bits slightly differently,
so simply map the non executable code as XN=1 (bit 54).

Add kernel unit test to validate that pages mapped this way at least
appear to be in sync with the aspace.Query() api.

Bug: 88451
Change-Id: [Icea7a3c5b5effa8b8fe828b3ed6d8e27433caaf0](https://fuchsia-review.googlesource.com/#/q/Icea7a3c5b5effa8b8fe828b3ed6d8e27433caaf0)
Reviewed-on: [https://fuchsia-review.googlesource.com/c/fuchsia/+/614141](https://fuchsia-review.googlesource.com/c/fuchsia/%2B/614141)
Reviewed-by: Marco Vanotti <mvanotti@google.com>
Commit-Queue: Travis Geiselbrecht <travisg@google.com>

```

* [zircon/kernel/arch/arm64/BUILD.gn](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/zircon/kernel/arch/arm64/BUILD.gn)[[diff](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00%5E%21/#F0)]
* [zircon/kernel/arch/arm64/include/arch/arm64/mmu.h](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/zircon/kernel/arch/arm64/include/arch/arm64/mmu.h)[[diff](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00%5E%21/#F1)]
* [zircon/kernel/arch/arm64/mmu.cc](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/zircon/kernel/arch/arm64/mmu.cc)[[diff](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00%5E%21/#F2)]
* [zircon/kernel/arch/arm64/mmu\_tests.cc](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/zircon/kernel/arch/arm64/mmu_tests.cc)[Added - [diff](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00%5E%21/#F3)]
* [zircon/kernel/arch/arm64/start.S](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/zircon/kernel/arch/arm64/start.S)[[diff](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00%5E%21/#F4)]

5 files changedtree: 22482985c7dac6dfd52e418d423880cad15437d9

1. [boards/](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/boards/)
2. [build/](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/build/)
3. [bundles/](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/bundles/)
4. [docs/](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/docs/)
5. [examples/](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/examples/)
6. [garnet/](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/garnet/)
7. [products/](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/products/)
8. [scripts/](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/scripts/)
9. [sdk/](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/sdk/)
10. [src/](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/src/)
11. [third\_party/](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/third_party/)
12. [tools/](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/tools/)
13. [zircon/](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/zircon/)
14. [.clang-format](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/.clang-format)
15. [.clang-tidy](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/.clang-tidy)
16. [.git-blame-ignore-revs](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/.git-blame-ignore-revs)
17. [.gitattributes](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/.gitattributes)
18. [.gitignore](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/.gitignore)
19. [.gn](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/.gn)
20. [.style.yapf](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/.style.yapf)
21. [analysis\_options.yaml](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/analysis_options.yaml)
22. [AUTHORS](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/AUTHORS)
23. [BUILD.gn](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/BUILD.gn)
24. [CODE\_OF\_CONDUCT.md](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/CODE_OF_CONDUCT.md)
25. [CONTRIBUTING.md](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/CONTRIBUTING.md)
26. [LICENSE](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/LICENSE)
27. [OWNERS](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/OWNERS)
28. [PATENTS](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/PATENTS)
29. [pyrightconfig.json](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/pyrightconfig.json)
30. [README.md](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/README.md)
31. [rustfmt.toml](/fuchsia/%2B/7d731b4e9599088ac3073956933559da7bca6a00/rustfmt.toml)

README.md
# Fuchsia

## What is Fuchsia?

Fuchsia an open source, general purpose operating system supporting modern 64-bit Intel and ARM processors.

We expect everyone interacting with our project to respect our [code of conduct](7d731b4e9599088ac3073956933559da7bca6a00/CODE_OF_CONDUCT.md).

[Read more about Fuchsia's principles](https://fuchsia.dev/fuchsia-src/concepts.md).

## How can I build and run Fuchsia?

See [Getting Started](https://fuchsia.dev/fuchsia-src/getting_started.md).

## Where can I learn more about Fuchsia?

See [fuchsia.dev](https://fuchsia.dev).

  Powered by [Gitiles](https://gerrit.googlesource.com/gitiles/)| [Privacy](https://policies.google.com/privacy)| [Terms](https://policies.google.com/terms)[txt](?format=TEXT) [json](?format=JSON)
