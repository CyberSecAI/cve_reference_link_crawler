=== Content from research.splunk.com_828c561f_20250110_225752.html ===

[![Splunk Security Content Logo](https://research.splunk.com/images/logo.svg)](https://research.splunk.com/)

* [Analytic Stories](https://research.splunk.com/stories/)
* [Detections](https://research.splunk.com/detections/)
* [Playbooks](https://research.splunk.com/playbooks/)
* [Data Sources](https://research.splunk.com/sources/)
* [Blog](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)
* [About](http://splunk.com/threat-research)
* [![GitHub Repo](https://research.splunk.com/images/GitHubMarkLight.svg)](https://github.com/splunk/security_content)

## Table of Contents

* + [Description](#description)
  + [Search](#search)
  + [Data Source](#data-source)
  + [Macros Used](#macros-used)
  + [Annotations](#annotations)
  + [Default Configuration](#default-configuration)
  + [Implementation](#implementation)
  + [Known False Positives](#known-false-positives)
  + [Associated Analytic Story](#associated-analytic-story)
  + [Risk Based Analytics (RBA)](#risk-based-analytics-rba)
  + [References](#references)
  + [Detection Testing](#detection-testing)

# Detection: Splunk Low-Priv Search as nobody SplunkDeploymentServerConfig App

Updated Date: 2024-10-17
ID: f765c3fe-c3b6-4afe-a932-11dd4f3a024f
Author: Rod Soto, Deivid Aguero
[Type: Hunting](#default-configuration)
[Product: Splunk Enterprise Security](https://www.splunk.com/en_us/products/enterprise-security.html)
### Description

In Splunk Enterprise versions below 9.3.1, and 9.2.0 versions below 9.2.3, and Splunk Cloud Platform versions below 9.2.2403.103, 9.1.2312.200, 9.1.2312.110 and 9.1.2308.208, a low-privileged user that does not hold the âadminâ or âpowerâ Splunk roles could run a search as ânobodyâ in the SplunkDeploymentServerConfig app allowing access to potentially restricted data.

### Search

```
1
2| rest services/apps/local/SplunkDeploymentServerConfig
3
4| table label, splunk_server, eai:acl.perms.read, eai:acl.perms.write, eai:acl.can_change_perms
5
6| `splunk_low_priv_search_as_nobody_splunkdeploymentserverconfig_app_filter`

```
### Data Source

| Name | Platform | Sourcetype | Source |
| --- | --- | --- | --- |
| [Splunk](/sources/d8a2c791-460b-4756-a8e5-ecade77b21e3) | Splunk icon [Splunk](/platform/splunk) | `'splunkd_ui_access'` | `'splunkd_ui_access.log'` |

### Macros Used

| Name | Value |
| --- | --- |

| splunk\_low\_priv\_search\_as\_nobody\_splunkdeploymentserverconfig\_app\_filter | `search *` |

`splunk_low_priv_search_as_nobody_splunkdeploymentserverconfig_app_filter` is an empty macro by default. It allows the user to filter out any results (false positives) without editing the SPL.
### Annotations

- MITRE ATT&CK

+ Kill Chain Phases

+ NIST

+ CIS

- Threat Actors

| ID | Technique | Tactic |
| --- | --- | --- |
| [T1068](https://attack.mitre.org/techniques/T1068/) | Exploitation for Privilege Escalation | Privilege Escalation |

KillChainPhase.EXPLOITAITON

NistCategory.DE\_AE

Cis18Value.CIS\_10

APT28
APT29
APT32
APT33
BITTER
Cobalt Group
FIN6
FIN8
LAPSUS$
MoustachedBouncer
PLATINUM
Scattered Spider
Threat Group-3390
Tonto Team
Turla
Volt Typhoon
Whitefly
ZIRCONIUM

### Default Configuration

This detection is configured by default in Splunk Enterprise Security to run with the following settings:

| Setting | Value |
| --- | --- |
| Disabled | true |
| Cron Schedule | `0 * * * *` |
| Earliest Time | `-70m@m` |
| Latest Time | `-10m@m` |
| Schedule Window | `auto` |
| Creates Risk Event | False |

This configuration file applies to all detections of type hunting.
### Implementation

Requires access to REST Api.

### Known False Positives

This search displays effective permissions for SplunkDeploymentServerConfig. If permissions are inadequate they must be fixed. Please refer to the SVD-2024-1002 for more information about these permissions.

### Associated Analytic Story

* [Splunk Vulnerabilities](/stories/splunk_vulnerabilities/)

### Risk Based Analytics (RBA)

| Risk Message | Risk Score | Impact | Confidence |
| --- | --- | --- | --- |
| Please verify and adjust permissions on $splunk\_server$ for $label$ according to SVD-2024-1002 Advisory | 90 | 90 | 100 |

The Risk Score is calculated by the following formula: Risk Score = (Impact \* Confidence/100). Initial Confidence and Impact is set by the analytic author.
### References

* <https://advisory.splunk.com/advisories/SVD-2024-1002>

### Detection Testing

| Test Type | Status | Dataset | Source | Sourcetype |
| --- | --- | --- | --- | --- |
| Validation | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | N/A | N/A |
| Unit | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | `N/A` | `N/A` |
| Integration | â Passing | N/A | `N/A` | `N/A` |

Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)

---

Source: [GitHub](https://github.com/splunk/security_content/tree/develop/detections/application/splunk_low-priv_search_as_nobody_splunkdeploymentserverconfig_app.yml) |
Version: **2**

[Detection: Splunk Low Privilege User Can View Hashed Splunk Password](https://research.splunk.com/application/a1be424d-e59c-4583-b6f9-2dcc23be4875/ "Detection: Splunk Low Privilege User Can View Hashed Splunk Password")

[Detection: Splunk Path Traversal In Splunk App For Lookup File Edit](https://research.splunk.com/application/8ed58987-738d-4917-9e44-b8ef6ab948a6/ "Detection: Splunk Path Traversal In Splunk App For Lookup File Edit")

Â© 2005 - 2024 Splunk LLC All rights reserved.



=== Content from advisory.splunk.com_62a33b75_20250110_225751.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Low-privileged user could run search as nobody in SplunkDeploymentServerConfig app

**Advisory ID:** SVD-2024-1002

**CVE ID:** [CVE-2024-45732](https://www.cve.org/CVERecord?id=CVE-2024-45732)

**Published:** 2024-10-14

**Last Update:** 2024-10-14

**CVSSv3.1 Score:** 7.1, High

**CVSSv3.1 Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N)

**CWE:** [CWE-862](https://cwe.mitre.org/data/definitions/862.html)

**Bug ID:** VULN-14891

## Description

In Splunk Enterprise versions below 9.3.1, and 9.2.0 versions below 9.2.3, and Splunk Cloud Platform versions below 9.2.2403.103, 9.1.2312.200, 9.1.2312.110 and 9.1.2308.208, a low-privileged user that does not hold the “admin” or “power” Splunk roles could run a search as the “nobody” Splunk user in the SplunkDeploymentServerConfig app. This could let the low-privileged user access potentially restricted data.

## Solution

Upgrade Splunk Enterprise to versions 9.3.1, 9.2.3 or higher. Splunk Enterprise 9.1 versions and below are not affected.
Splunk is actively monitoring and patching Splunk Cloud Platform instances.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk Enterprise | 9.3 | SplunkDeploymentServerConfig | 9.3.0 | 9.3.1 |
| Splunk Enterprise | 9.2 | SplunkDeploymentServerConfig | 9.2.0 to 9.2.2 | 9.2.3 |
| Splunk Cloud Platform | 9.2.2403 | SplunkDeploymentServerConfig | 9.2.2403.102 to 9.2.2403.102 | 9.2.2403.103 |
| Splunk Cloud Platform | 9.1.2312 | SplunkDeploymentServerConfig | 9.1.2312.100 to 9.1.2312.109 | 9.1.2312.110, 9.1.2312.200 |
| Splunk Cloud Platform | 9.1.2308 | SplunkDeploymentServerConfig | Below 9.1.2308.207 | 9.1.2308.208 |

## Mitigations and Workarounds

You can modify the local.meta file in the `$SPLUNK_HOME/etc/apps/SplunkDeploymentServerConfig/metadata` directory to restrict write access to knowledge objects within Splunk apps.
Use the following metadata settings in each file to restrict access:
   `[]`
   `access = read : [ * ], write : [ admin ]`

To apply the same restrictions to other apps by default, you may add the same configuration to the local.meta file in the `$SPLUNK_HOME/etc/apps/<app name>/metadata` directory.

The vulnerability affects instances with [Splunk Web](https://docs.splunk.com/Documentation/Splunk/latest/Security/DisableunnecessarySplunkcomponents) enabled, turning Splunk Web off is a possible workaround. See [Disable unnecessary Splunk Enterprise components](https://docs.splunk.com/Documentation/Splunk/latest/Security/DisableunnecessarySplunkcomponents) and the [web.conf](https://docs.splunk.com/Documentation/Splunk/latest/Admin/Webconf) configuration specification file for more information on disabling Splunk Web.

## Detections

* [Splunk Low-priv search as nobody SplunkDeploymentServerConfig app](https://research.splunk.com/application/f765c3fe-c3b6-4afe-a932-11dd4f3a024f/)

## Severity

Splunk rates this vulnerability as a 7.1, High, with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N.

If the local.meta file in the app directory has the proper metadata settings, there should be no impact and the severity would be Informational.

If the Splunk Enterprise instance does not run Splunk Web, there should be no impact and the severity would be informational.

## Acknowledgments

Anton (therceman)

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)
