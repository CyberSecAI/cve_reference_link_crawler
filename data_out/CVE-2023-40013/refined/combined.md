=== Content from github.com_4ebf88f0_20250111_055502.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshubhamjain%2Fsvg-loader%2Fsecurity%2Fadvisories%2FGHSA-xc2r-jf2x-gjr8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshubhamjain%2Fsvg-loader%2Fsecurity%2Fadvisories%2FGHSA-xc2r-jf2x-gjr8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=shubhamjain%2Fsvg-loader)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[shubhamjain](/shubhamjain)
/
**[svg-loader](/shubhamjain/svg-loader)**
Public

* [Notifications](/login?return_to=%2Fshubhamjain%2Fsvg-loader) You must be signed in to change notification settings
* [Fork
  23](/login?return_to=%2Fshubhamjain%2Fsvg-loader)
* [Star
   199](/login?return_to=%2Fshubhamjain%2Fsvg-loader)

* [Code](/shubhamjain/svg-loader)
* [Issues
  3](/shubhamjain/svg-loader/issues)
* [Pull requests
  1](/shubhamjain/svg-loader/pulls)
* [Actions](/shubhamjain/svg-loader/actions)
* [Projects
  0](/shubhamjain/svg-loader/projects)
* [Security](/shubhamjain/svg-loader/security)
* [Insights](/shubhamjain/svg-loader/pulse)

Additional navigation options

* [Code](/shubhamjain/svg-loader)
* [Issues](/shubhamjain/svg-loader/issues)
* [Pull requests](/shubhamjain/svg-loader/pulls)
* [Actions](/shubhamjain/svg-loader/actions)
* [Projects](/shubhamjain/svg-loader/projects)
* [Security](/shubhamjain/svg-loader/security)
* [Insights](/shubhamjain/svg-loader/pulse)

# Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') in external-svg-loader

Critical

[shubhamjain](/shubhamjain)
published
GHSA-xc2r-jf2x-gjr8
Aug 14, 2023

## Package

npm

external-svg-loader
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

<=1.6.8

## Patched versions

1.6.9

## Description

### Summary

According to the [docs](https://github.com/shubhamjain/svg-loader/tree/main#2-enable-javascript), svg-loader will strip all JS code before injecting the SVG file for security reasons but the input sanitization logic is not sufficient and can be trivially bypassed. This allows an attacker to craft a malicious SVG which can result in XSS.

### Details

When trying to sanitize the svg the lib [removes event attributes](https://github.com/shubhamjain/svg-loader/blob/main/svg-loader.js#L125-L128) such as `onmouseover`, `onclick` but the list of events is not exhaustive. Here's a list of events not removed by svg-loader.

`onafterscriptexecute, onbeforecopy, onbeforecut, onbeforescriptexecute, onbeforetoggle, onbegin, onbounce, onend, onfinish, onfocusin, onfocusout, onmousewheel, onpointerrawupdate, onrepeat, onsearch, onshow, onstart, ontoggle(popover), ontouchend, ontouchmove, ontouchstart`

As you can see in the POC we can use `onbegin` in `animate` tag to execute JS code without needing to add `data-js="enabled"`.

### PoC

```
<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
  <animate onbegin=alert(1) attributeName=x dur=1s>
</svg>
```

```
<html>
    <head>
        <script src="./dist/svg-loader.js" type="text/javascript"></script>
    </head>
    <body>
        <svg data-src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGJhc2VQcm9maWxlPSJmdWxsIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxwb2x5Z29uIGlkPSJ0cmlhbmdsZSIgcG9pbnRzPSIwLDAgMCw1MCA1MCwwIiBmaWxsPSIjMDA5OTAwIiBzdHJva2U9IiMwMDQ0MDAiLz4KICA8YW5pbWF0ZSBvbmJlZ2luPWFsZXJ0KDEpIGF0dHJpYnV0ZU5hbWU9eCBkdXI9MXM+Cjwvc3ZnPgo="></svg>
    </body>
</html>
```
### Impact

Any website which uses external-svg-loader and allows its users to provide svg src, upload svg files would be susceptible to stored XSS attack.

### Severity

Critical

9.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

### CVE ID

CVE-2023-40013

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### Credits

* [![@r00tdaemon](https://avatars.githubusercontent.com/u/16747982?s=40&v=4)](/r00tdaemon)
  [r00tdaemon](/r00tdaemon)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_559c7c1e_20250111_055503.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshubhamjain%2Fsvg-loader%2Ftree%2Fmain)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshubhamjain%2Fsvg-loader%2Ftree%2Fmain)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=shubhamjain%2Fsvg-loader)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[shubhamjain](/shubhamjain)
/
**[svg-loader](/shubhamjain/svg-loader)**
Public

* [Notifications](/login?return_to=%2Fshubhamjain%2Fsvg-loader) You must be signed in to change notification settings
* [Fork
  23](/login?return_to=%2Fshubhamjain%2Fsvg-loader)
* [Star
   199](/login?return_to=%2Fshubhamjain%2Fsvg-loader)

Plug 'n Play external SVG loader

### License

[MIT license](/shubhamjain/svg-loader/blob/main/LICENSE)

[199
stars](/shubhamjain/svg-loader/stargazers) [23
forks](/shubhamjain/svg-loader/forks) [Branches](/shubhamjain/svg-loader/branches) [Tags](/shubhamjain/svg-loader/tags) [Activity](/shubhamjain/svg-loader/activity)
 [Star](/login?return_to=%2Fshubhamjain%2Fsvg-loader)

 [Notifications](/login?return_to=%2Fshubhamjain%2Fsvg-loader) You must be signed in to change notification settings

* [Code](/shubhamjain/svg-loader)
* [Issues
  3](/shubhamjain/svg-loader/issues)
* [Pull requests
  1](/shubhamjain/svg-loader/pulls)
* [Actions](/shubhamjain/svg-loader/actions)
* [Projects
  0](/shubhamjain/svg-loader/projects)
* [Security](/shubhamjain/svg-loader/security)
* [Insights](/shubhamjain/svg-loader/pulse)

Additional navigation options

* [Code](/shubhamjain/svg-loader)
* [Issues](/shubhamjain/svg-loader/issues)
* [Pull requests](/shubhamjain/svg-loader/pulls)
* [Actions](/shubhamjain/svg-loader/actions)
* [Projects](/shubhamjain/svg-loader/projects)
* [Security](/shubhamjain/svg-loader/security)
* [Insights](/shubhamjain/svg-loader/pulse)

# shubhamjain/svg-loader

    main[Branches](/shubhamjain/svg-loader/branches)[Tags](/shubhamjain/svg-loader/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[115 Commits](/shubhamjain/svg-loader/commits/main/) | | |
| [.github/workflows](/shubhamjain/svg-loader/tree/main/.github/workflows "This path skips through empty directories") | | [.github/workflows](/shubhamjain/svg-loader/tree/main/.github/workflows "This path skips through empty directories") |  |  |
| [.husky](/shubhamjain/svg-loader/tree/main/.husky ".husky") | | [.husky](/shubhamjain/svg-loader/tree/main/.husky ".husky") |  |  |
| [lib](/shubhamjain/svg-loader/tree/main/lib "lib") | | [lib](/shubhamjain/svg-loader/tree/main/lib "lib") |  |  |
| [test](/shubhamjain/svg-loader/tree/main/test "test") | | [test](/shubhamjain/svg-loader/tree/main/test "test") |  |  |
| [.gitignore](/shubhamjain/svg-loader/blob/main/.gitignore ".gitignore") | | [.gitignore](/shubhamjain/svg-loader/blob/main/.gitignore ".gitignore") |  |  |
| [.npmignore](/shubhamjain/svg-loader/blob/main/.npmignore ".npmignore") | | [.npmignore](/shubhamjain/svg-loader/blob/main/.npmignore ".npmignore") |  |  |
| [LICENSE](/shubhamjain/svg-loader/blob/main/LICENSE "LICENSE") | | [LICENSE](/shubhamjain/svg-loader/blob/main/LICENSE "LICENSE") |  |  |
| [README.md](/shubhamjain/svg-loader/blob/main/README.md "README.md") | | [README.md](/shubhamjain/svg-loader/blob/main/README.md "README.md") |  |  |
| [package.json](/shubhamjain/svg-loader/blob/main/package.json "package.json") | | [package.json](/shubhamjain/svg-loader/blob/main/package.json "package.json") |  |  |
| [svg-loader.d.ts](/shubhamjain/svg-loader/blob/main/svg-loader.d.ts "svg-loader.d.ts") | | [svg-loader.d.ts](/shubhamjain/svg-loader/blob/main/svg-loader.d.ts "svg-loader.d.ts") |  |  |
| [svg-loader.js](/shubhamjain/svg-loader/blob/main/svg-loader.js "svg-loader.js") | | [svg-loader.js](/shubhamjain/svg-loader/blob/main/svg-loader.js "svg-loader.js") |  |  |
| [svg-loader.min.js](/shubhamjain/svg-loader/blob/main/svg-loader.min.js "svg-loader.min.js") | | [svg-loader.min.js](/shubhamjain/svg-loader/blob/main/svg-loader.min.js "svg-loader.min.js") |  |  |
| [webpack.config.js](/shubhamjain/svg-loader/blob/main/webpack.config.js "webpack.config.js") | | [webpack.config.js](/shubhamjain/svg-loader/blob/main/webpack.config.js "webpack.config.js") |  |  |
| [yarn.lock](/shubhamjain/svg-loader/blob/main/yarn.lock "yarn.lock") | | [yarn.lock](/shubhamjain/svg-loader/blob/main/yarn.lock "yarn.lock") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# SVG Loader

[![NPM](https://camo.githubusercontent.com/25ee8428e8f63e64f47f6d7299e6eb62032138af718c3b78d80e11feb55f7012/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f762f65787465726e616c2d7376672d6c6f616465722e737667)](https://www.npmjs.com/package/external-svg-loader)
[![minified size](https://camo.githubusercontent.com/a0965e3e78ba79c30fe4d939f9b60def041a3292fde76a75900cac6c662674d8/687474703a2f2f696d672e626164676573697a652e696f2f7368756268616d6a61696e2f7376672d6c6f616465722f6d61737465722f7376672d6c6f616465722e6d696e2e6a733f6c6162656c3d6d696e696669656425323073697a6526763d3130)](https://camo.githubusercontent.com/a0965e3e78ba79c30fe4d939f9b60def041a3292fde76a75900cac6c662674d8/687474703a2f2f696d672e626164676573697a652e696f2f7368756268616d6a61696e2f7376672d6c6f616465722f6d61737465722f7376672d6c6f616465722e6d696e2e6a733f6c6162656c3d6d696e696669656425323073697a6526763d3130) [![gzip size](https://camo.githubusercontent.com/6997c5c4a46344dada6433360a1fb0122fcaf57e9112657a4138d521ba7cf751/687474703a2f2f696d672e626164676573697a652e696f2f7368756268616d6a61696e2f7376672d6c6f616465722f6d61737465722f7376672d6c6f616465722e6d696e2e6a733f636f6d7072657373696f6e3d677a697026763d3130)](https://camo.githubusercontent.com/6997c5c4a46344dada6433360a1fb0122fcaf57e9112657a4138d521ba7cf751/687474703a2f2f696d672e626164676573697a652e696f2f7368756268616d6a61696e2f7376672d6c6f616465722f6d61737465722f7376672d6c6f616465722e6d696e2e6a733f636f6d7072657373696f6e3d677a697026763d3130)

SVGs from an external source can be rendered with `<img>` tags, but this has multiple drawbacks: you can't customize the fill or stroke colors, use CSS variables, or use focus/hover states.

SVG Loader is a simple JS library that fetches SVGs using XHR and injects the SVG code in the tag's place. This lets you use externally stored SVGs (e.g, on CDN) just like inline SVGs.

It's super-tiny, works with all frameworks, requires no additional code except the initial script load, and has minimal to no impact on performance.

[**Demo →**](https://codepen.io/shubhamjainco/pen/rNyBVmY)

## How to Use?

SVG Loader is designed to be plug and play. Hence, all you need to is to include the loader JS anywhere in your code, and then start using the code like this:

### Download and Include

```
<!--
    Include this script anywhere in your code, preferably <HEAD> so
    icons can be fetched faster.
-->
<script type="text/javascript" src="svg-loader.min.js" async></script>

<!-- Use an external SVG -->
<svg
  data-src="https://unpkg.com/@mdi/svg@5.9.55/svg/star.svg"
  width="50"
  height="50"
  fill="red"></svg>
<svg
  data-src="https://unpkg.com/@mdi/svg@5.9.55/svg/heart.svg"
  width="50"
  height="50"
  fill="red"></svg>

<svg
  data-src="https://unpkg.com/@mdi/svg@5.9.55/svg/cog.svg"
  width="50"
  height="50"
  fill="currentColor"
  style="color: purple;"></svg>
```

[**See Here →**](https://codepen.io/shubhamjainco/pen/jOBEgPY)

**Note**: Because SVG Loader fetches file using XHRs, it's limited by CORS policies of the browser.
So you need to ensure that correct `Access-Control-Allow-Origin` headers are sent with the file being served or that the files are hosted on your own domain.

### Or, use from the npm package

The library is framework/platform agnostic. You should be able to use it in React, Vue.js and others
as long as you're using the correct attributes.

```
npm install external-svg-loader

```

Then, in your app, require/import `external-svg-loader` anywhere. Here's an example:

```
import React from "react";
import ReactDOM from "react-dom";

import "external-svg-loader";

class App extends React.Component {
  render() {
    return (
      <svg
        data-src="https://s2.svgbox.net/materialui.svg?ic=mail"
        fill="currentColor"
        width="50px"
        height="50px"
        style={{
          color: "red"
        }}
      />
    );
  }
}

ReactDOM.render(<App />, document.getElementById("container"));
```

[**See Here →**](https://codesandbox.io/s/react-playground-forked-x7w1l?file=/index.js)

### Or, use a CDN

SVG loader can also be included via unpkg CDN. Example:

```
<script
    type="text/javascript"
    src="https://unpkg.com/external-svg-loader@latest/svg-loader.min.js"
    async></script>
```

## Configuration

### 1. Disable/Modify Caching

By default, the XHR response is cached for 30 days, so that any subsequent loads are instantenous. You can disable this behavior by passing `data-cache="disabled"`.

You can destroy the currently stored cache by calling:

```
SVGLoader.destroyCache();
```

You can also modify the caching period by passing number of seconds. Example:

#### Cache for a week

```
<svg
  data-src="https://unpkg.com/@mdi/svg@5.9.55/svg/heart.svg"
  data-cache="604800"
  width="50"
  height="50"></svg>
```

#### Cache for a six hours

```
<svg
  data-src="https://unpkg.com/@mdi/svg@5.9.55/svg/heart.svg"
  data-cache="21600"
  width="50"
  height="50"></svg>
```

#### Disable Caching

```
<svg
  data-src="https://unpkg.com/@mdi/svg@5.9.55/svg/heart.svg"
  data-cache="disabled"
  width="50"
  height="50"></svg>
```

### 2. Enable Javascript

SVG format supports scripting. However, for security reasons, svg-loader will strip all JS code before injecting the SVG file.
You can enable it by:

```
<svg
  data-src="https://unpkg.com/@mdi/svg@5.9.55/svg/heart.svg"
  data-js="enabled"
  onclick="alert('clicked')"
  width="50"
  height="50"
  fill="red"></svg>
```

### 3. Disable Unique IDs, Styling

To prevent conflicts between conflicting identifiers of different SVGs, svg-loader scopes the identifiers and styling rules by adding prefixes.

You can disable this behavior by:

#### Disable Unique IDs

```
<svg
  data-src="https://unpkg.com/@mdi/svg@5.9.55/svg/heart.svg"
  data-unique-ids="disabled"
  width="50"
  height="50"
  fill="red"></svg>
```

#### Disable CSS Scoping

```
<svg
  data-src="https://unpkg.com/@mdi/svg@5.9.55/svg/heart.svg"
  data-css-scoping="disabled"
  width="50"
  height="50"
  fill="red"></svg>
```

## Lazy Loading

You can also lazy load icons by using `data-loading=lazy`. This will make icon not load until it's about to enter the viewport. For lazy loading, `external-svg-loader` uses [Intersection Observer API](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API).

```
<svg
  data-src="https://unpkg.com/@mdi/svg@5.9.55/svg/heart.svg"
  data-loading="lazy"
  width="50"
  height="50"></svg>
```

## Event

When the SVG has been loaded an event `iconload` is triggered. This can be used to get the references to the loaded SVG element and do some further processing. You can also use the `oniconload` inline function.

### Using `oniconload` inline function

```
<svg
  data-src="https://unpkg.com/@mdi/svg@5.9.55/svg/cog.svg"
  oniconload="console.log('Icon loaded', this)"></svg>
```

### Using addEventListener

```
<svg data-src="https://unpkg.com/@mdi/svg@5.9.55/svg/cog.svg"></svg>

<script>
  window.addEventListener('iconload', (e) => {
      if (e.target.id === 'iconload') {
        console.log('Icon loaded', e.target);
      }
  });
</script>
```

### Using the `iconloaderror` event

When an error occurs during loading of the SVG file, an `iconloaderror` event is triggered, passing the error message as the event's `detail`.

```
<svg data-src="https://unpkg.com/@mdi/svg@5.9.55/svg/this-svg-does-not-exist.svg"></svg>

<script>
  window.addEventListener('iconloaderror', (e) => {
    console.error('Failed to load SVG:', e.detail);
  });
</script>
```

Similarly to the `iconload` event, `iconloaderror` can also be used with an inline function, which will have access to an `error` argument (the `Error` object that was thrown):

```
<svg
  data-src="https://unpkg.com/@mdi/svg@5.9.55/svg/cog.svg"
  oniconloaderror="console.log('Error loading SVG:', error.toString())"></svg>
```

### Using Events in React

React doesn't support custom events out of the box. To circumvent this limitation, you can use [refs](https://reactjs.org/docs/refs-and-the-dom.html).

```
class MyApp extends React.Component {
  constructor(props) {
    super(props);
    this.ref = React.createRef()
  }
  render() {
    return (<svg data-src="https://unpkg.com/@mdi/svg@5.9.55/svg/cog.svg" ref={this.ref}></svg>);
  }
  componentDidMount() {
    this.ref.current.addEventListener('iconload', () => {
      console.log("Icon Loaded", this.ref.current)
    });
    this.ref.current.addEventListener('iconloaderror', (e) => {
      console.error('Failed to load SVG:', e.detail);
    });
  }
}
```

## LICENSE

MIT

## About

Plug 'n Play external SVG loader

### Topics

[css](/topics/css "Topic: css")
[svg](/topics/svg "Topic: svg")
[html](/topics/html "Topic: html")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/shubhamjain/svg-loader/activity)
### Stars

[**199**
stars](/shubhamjain/svg-loader/stargazers)
### Watchers

[**6**
watching](/shubhamjain/svg-loader/watchers)
### Forks

[**23**
forks](/shubhamjain/svg-loader/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fshubhamjain%2Fsvg-loader&report=shubhamjain+%28user%29)

## [Releases](/shubhamjain/svg-loader/releases)

No releases published

## [Packages 0](/users/shubhamjain/packages?repo_name=svg-loader)

No packages published

## [Contributors 9](/shubhamjain/svg-loader/graphs/contributors)

## Languages

* [JavaScript
  73.8%](/shubhamjain/svg-loader/search?l=javascript)
* [HTML
  25.8%](/shubhamjain/svg-loader/search?l=html)
* [Shell
  0.4%](/shubhamjain/svg-loader/search?l=shell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b806aba2_20250111_055501.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshubhamjain%2Fsvg-loader%2Fcommit%2Fd3562fc08497aec5f33eb82017fa1417b3319e2c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshubhamjain%2Fsvg-loader%2Fcommit%2Fd3562fc08497aec5f33eb82017fa1417b3319e2c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=shubhamjain%2Fsvg-loader)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[shubhamjain](/shubhamjain)
/
**[svg-loader](/shubhamjain/svg-loader)**
Public

* [Notifications](/login?return_to=%2Fshubhamjain%2Fsvg-loader) You must be signed in to change notification settings
* [Fork
  23](/login?return_to=%2Fshubhamjain%2Fsvg-loader)
* [Star
   199](/login?return_to=%2Fshubhamjain%2Fsvg-loader)

* [Code](/shubhamjain/svg-loader)
* [Issues
  3](/shubhamjain/svg-loader/issues)
* [Pull requests
  1](/shubhamjain/svg-loader/pulls)
* [Actions](/shubhamjain/svg-loader/actions)
* [Projects
  0](/shubhamjain/svg-loader/projects)
* [Security](/shubhamjain/svg-loader/security)
* [Insights](/shubhamjain/svg-loader/pulse)

Additional navigation options

* [Code](/shubhamjain/svg-loader)
* [Issues](/shubhamjain/svg-loader/issues)
* [Pull requests](/shubhamjain/svg-loader/pulls)
* [Actions](/shubhamjain/svg-loader/actions)
* [Projects](/shubhamjain/svg-loader/projects)
* [Security](/shubhamjain/svg-loader/security)
* [Insights](/shubhamjain/svg-loader/pulse)

## Commit

[Permalink](/shubhamjain/svg-loader/commit/d3562fc08497aec5f33eb82017fa1417b3319e2c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-xc2r-jf2x-gjr8](https://github.com/advisories/GHSA-xc2r-jf2x-gjr8 "GHSA-xc2r-jf2x-gjr8")

[Browse files](/shubhamjain/svg-loader/tree/d3562fc08497aec5f33eb82017fa1417b3319e2c)
Browse the repository at this point in the history

```
Fix XSS vulnerability
```

* Loading branch information

[![@shubhamjain](https://avatars.githubusercontent.com/u/309760?s=40&v=4)](/shubhamjain)

[shubhamjain](/shubhamjain/svg-loader/commits?author=shubhamjain "View all commits by shubhamjain")
authored
Aug 12, 2023

2 parents
[0004635](/shubhamjain/svg-loader/commit/00046354aaa388f7ba14e7e8d9680a8d49186fe3)
+
[c35e032](/shubhamjain/svg-loader/commit/c35e03285a4ab3cca8338799f6a62bd2ea4fe0c7)

commit d3562fc

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**24 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)
* svg-loader.js
  [svg-loader.js](#diff-869f8e2100fcb88711e1c113209db1fa2559624a4b340fc7055ac72bbb0e9616)
* test

  + icons

    - test/icons/svg-xss-2.svg
      [svg-xss-2.svg](#diff-201d2a8965ee9f3f94d5ed2026b310a7804039ee32d0261a8bcc56320ee84fa0)
    - test/icons/svg-xss.svg
      [svg-xss.svg](#diff-6e391a525e19c700537d7756b4ab64f59fd4a83a9921fd816fd2af01d4fa18e3)
  + test/index.html
    [index.html](#diff-4080554e0937ffce8b737b24c50236633f05f3f4c370405f001f79db500e95d0)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/shubhamjain/svg-loader/blob/d3562fc08497aec5f33eb82017fa1417b3319e2c/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -9,7 +9,7 @@ |
|  |  | "url": "https://github.com/shubhamjain/svg-loader.git" |
|  |  | }, |
|  |  | "main": "dist/svg-loader.min.js", |
|  |  | "version": "1.6.8", |
|  |  | "version": "1.6.9", |
|  |  | "scripts": { |
|  |  | "postinstall": "npm-run-all build:\*", |
|  |  | "build:js": "cross-env NODE\_ENV=production webpack build", |
| Expand Down | |  |

10 changes: 8 additions & 2 deletions

10
[svg-loader.js](#diff-869f8e2100fcb88711e1c113209db1fa2559624a4b340fc7055ac72bbb0e9616 "svg-loader.js")

Show comments

[View file](/shubhamjain/svg-loader/blob/d3562fc08497aec5f33eb82017fa1417b3319e2c/svg-loader.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -62,6 +62,12 @@ const getAllEventNames = () => { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // SVG <animate> events |
|  |  | DOM\_EVENTS.push('onbegin', 'onend', 'onrepeat'); |
|  |  |  |
|  |  | // Some non-standard events, just in case the browser is handling them |
|  |  | DOM\_EVENTS.push('onfocusin', 'onfocusout', 'onbounce', 'onfinish', 'onshow'); |
|  |  |  |
|  |  | return DOM\_EVENTS; |
|  |  | }; |
|  |  |  |
| Expand Down  Expand Up | | @@ -128,7 +134,7 @@ const renderBody = (elem, options, body) => { |
|  |  | } |
|  |  |  |
|  |  | // Remove "javascript:..." unless specifically enabled |
|  |  | if (["href", "xlink:href"].includes(name) && value.startsWith("javascript") && !enableJs) { |
|  |  | if (["href", "xlink:href", "values"].includes(name) && value.startsWith("javascript") && !enableJs) { |
|  |  | attributesToRemove.push(name); |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -391,4 +397,4 @@ globalThis.SVGLoader.destroyCache = async () => { |
|  |  | localStorage.removeItem(key); |
|  |  | } |
|  |  | }); |
|  |  | } |
|  |  | } |

3 changes: 3 additions & 0 deletions

3
[test/icons/svg-xss-2.svg](#diff-201d2a8965ee9f3f94d5ed2026b310a7804039ee32d0261a8bcc56320ee84fa0 "test/icons/svg-xss-2.svg")

Show comments

[View file](/shubhamjain/svg-loader/blob/d3562fc08497aec5f33eb82017fa1417b3319e2c/test/icons/svg-xss-2.svg)
Edit file

Delete file

 Loading

Sorry, something went wrong. [Reload?](https://github.com/_view_fragments/Voltron%3A%3ACommitFragmentsController/show/shubhamjain/svg-loader/d3562fc08497aec5f33eb82017fa1417b3319e2c/commit_show_contents)
Sorry, we cannot display this file.
Sorry, this file is invalid so it cannot be displayed.
Viewer requires iframe.

3 changes: 3 additions & 0 deletions

3
[test/icons/svg-xss.svg](#diff-6e391a525e19c700537d7756b4ab64f59fd4a83a9921fd816fd2af01d4fa18e3 "test/icons/svg-xss.svg")

Show comments

[View file](/shubhamjain/svg-loader/blob/d3562fc08497aec5f33eb82017fa1417b3319e2c/test/icons/svg-xss.svg)
Edit file

Delete file

 Loading

Sorry, something went wrong. [Reload?](https://github.com/_view_fragments/Voltron%3A%3ACommitFragmentsController/show/shubhamjain/svg-loader/d3562fc08497aec5f33eb82017fa1417b3319e2c/commit_show_contents)
Sorry, we cannot display this file.
Sorry, this file is invalid so it cannot be displayed.
Viewer requires iframe.

10 changes: 9 additions & 1 deletion

10
[test/index.html](#diff-4080554e0937ffce8b737b24c50236633f05f3f4c370405f001f79db500e95d0 "test/index.html")

Show comments

[View file](/shubhamjain/svg-loader/blob/d3562fc08497aec5f33eb82017fa1417b3319e2c/test/index.html)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,5 @@ |
|  |  | <html> |
|  |  | <head> |
|  |  | <link rel="stylesheet" href="/main.css"> |
|  |  | <style> |
|  |  | body { |
|  |  | padding-bottom: 80px; |
| Expand Down  Expand Up | | @@ -61,6 +60,15 @@ <h1> |
|  |  | <div>This is a more complicated SVG with JS, only map with overlay message should be shown</div> |
|  |  | <svg data-src="./USStates.svg"></svg> |
|  |  |  |
|  |  | <div class="heading">Icon with XSS</div> |
|  |  | <div>Tricky XSS that needs to be filtered out. On clicking "X" nothing should happen </div> |
|  |  | <svg data-src="/icons/svg-xss.svg"></svg> |
|  |  |  |
|  |  | <div class="heading">Icon with XSS 2</div> |
|  |  | <div>Alert should not come</div> |
|  |  | <svg data-src="/icons/svg-xss-2.svg"></svg> |
|  |  |  |
|  |  |  |
|  |  | <div class="heading">Icon with JS (enabled)</div> |
|  |  | <div>On hover alert should be thrown</div> |
|  |  | <svg data-src="/icons/cog-with-script.svg" data-js="enabled"></svg> |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d3562fc`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshubhamjain%2Fsvg-loader%2Fcommit%2Fd3562fc08497aec5f33eb82017fa1417b3319e2c) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e1109abc_20250111_055500.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshubhamjain%2Fsvg-loader%2Fblob%2Fmain%2Fsvg-loader.js)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshubhamjain%2Fsvg-loader%2Fblob%2Fmain%2Fsvg-loader.js)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=shubhamjain%2Fsvg-loader)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[shubhamjain](/shubhamjain)
/
**[svg-loader](/shubhamjain/svg-loader)**
Public

* [Notifications](/login?return_to=%2Fshubhamjain%2Fsvg-loader) You must be signed in to change notification settings
* [Fork
  23](/login?return_to=%2Fshubhamjain%2Fsvg-loader)
* [Star
   199](/login?return_to=%2Fshubhamjain%2Fsvg-loader)

* [Code](/shubhamjain/svg-loader)
* [Issues
  3](/shubhamjain/svg-loader/issues)
* [Pull requests
  1](/shubhamjain/svg-loader/pulls)
* [Actions](/shubhamjain/svg-loader/actions)
* [Projects
  0](/shubhamjain/svg-loader/projects)
* [Security](/shubhamjain/svg-loader/security)
* [Insights](/shubhamjain/svg-loader/pulse)

Additional navigation options

* [Code](/shubhamjain/svg-loader)
* [Issues](/shubhamjain/svg-loader/issues)
* [Pull requests](/shubhamjain/svg-loader/pulls)
* [Actions](/shubhamjain/svg-loader/actions)
* [Projects](/shubhamjain/svg-loader/projects)
* [Security](/shubhamjain/svg-loader/security)
* [Insights](/shubhamjain/svg-loader/pulse)

## Files

 main
## Breadcrumbs

1. [svg-loader](/shubhamjain/svg-loader/tree/main)
/
# svg-loader.js

Copy path Blame  Blame
## Latest commit

## History

[History](/shubhamjain/svg-loader/commits/main/svg-loader.js)410 lines (340 loc) · 12.9 KB main
## Breadcrumbs

1. [svg-loader](/shubhamjain/svg-loader/tree/main)
/
# svg-loader.js

Top
## File metadata and controls

* Code
* Blame

410 lines (340 loc) · 12.9 KB[Raw](https://github.com/shubhamjain/svg-loader/raw/refs/heads/main/svg-loader.js)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410"use strict";
const { get, set, del, entries } = require("idb-keyval");const cssScope = require("./lib/scope-css");const cssUrlFixer = require("./lib/css-url-fixer");const counter = require("./lib/counter");
const isCacheAvailable = async (url) => { let item;
 try { item = await get(`loader\_${url}`); } catch (e) {}
 if (!item) { try { item = localStorage.getItem(`loader\_${url}`); } catch(e) {} }
 if (!item) { return; }
 item = JSON.parse(item);
 if (Date.now() < item.expiry) { return item.data; } else { del(`loader\_${url}`); return; }};
const setCache = async (url, data, cacheOpt) => { const cacheExp = parseInt(cacheOpt, 10); const dataToSet = JSON.stringify({ data, expiry: Date.now() + (Number.isNaN(cacheExp) ? 60 \* 60 \* 1000 \* 24 \* 30 : cacheExp \* 1000) });
 try { await set(`loader\_${url}`, dataToSet); } catch (e) { try { localStorage.setItem(`loader\_${url}`, dataToSet) } catch (e) { console.warn("Failed to set cache: ", e) } };};
const DOM\_EVENTS = [];const getAllEventNames = () => { if (DOM\_EVENTS.length) { return DOM\_EVENTS; }
 for (const prop in document.body) { if (prop.startsWith("on")) { DOM\_EVENTS.push(prop); } }
 // SVG <animate> events DOM\_EVENTS.push('onbegin', 'onend', 'onrepeat');
 // Some non-standard events, just in case the browser is handling them DOM\_EVENTS.push('onfocusin', 'onfocusout', 'onbounce', 'onfinish', 'onshow');
 return DOM\_EVENTS;};
const attributesSet = {};const renderBody = (elem, options, body) => { const { enableJs, disableUniqueIds, disableCssScoping, spriteIconId } = options;
 const isSpriteIcon = !!spriteIconId; const parser = new DOMParser(); const doc = parser.parseFromString(body, "text/html"); const fragment = isSpriteIcon ? doc.getElementById(spriteIconId) : doc.querySelector("svg");
 const eventNames = getAllEventNames();
 // When svg-loader is loading in the same element, it's // important to keep track of original properties. const elemAttributesSet = attributesSet[elem.getAttribute("data-id")] || new Set();
 const elemUniqueId = elem.getAttribute("data-id") || `svg-loader\_${counter.incr()}`;
 const idMap = {};
 if (!disableUniqueIds) { // Append a unique suffix for every ID so elements don't conflict. Array.from(fragment.querySelectorAll("[id]")).forEach((elem) => { const id = elem.getAttribute("id"); const newId = `${id}\_${counter.incr()}`; elem.setAttribute("id", newId);
 idMap[id] = newId; }); }
 Array.from(fragment.querySelectorAll("\*")).concat(fragment).forEach((el) => { // Unless explicitly set, remove JS code (default) if (el.tagName === "script") { el.remove(); if (!enableJs) { return; } else { const scriptEl = document.createElement("script"); scriptEl.appendChild(el.childNodes[0]); elem.appendChild(scriptEl) } }
 const attributesToRemove = [] for (let i = 0; i < el.attributes.length; i++) { const { name, value } = el.attributes[i];
 const newValue = cssUrlFixer(idMap, value, name);
 if (value !== newValue) { el.setAttribute(name, newValue); }
 // Remove event functions: onmouseover, onclick ... unless specifically enabled if (eventNames.includes(name.toLowerCase()) && !enableJs) { attributesToRemove.push(name); continue; }
 // Remove "javascript:..." unless specifically enabled if (["href", "xlink:href", "values"].includes(name) && value.startsWith("javascript") && !enableJs) { attributesToRemove.push(name); } }
 attributesToRemove.forEach((attr) => el.removeAttribute(attr))
 // .first -> [data-id="svg\_loader\_341xx"] .first // Makes sure that class names don't conflict with each other. if (el.tagName === "style" && !disableCssScoping) { let newValue = cssScope(el.innerHTML, `[data-id="${elemUniqueId}"]`, idMap); newValue = cssUrlFixer(idMap, newValue); if (newValue !== el.innerHTML) el.innerHTML = newValue; } });  // For a sprite we want to include the whole DOM of sprite element elem.innerHTML = spriteIconId ? fragment.outerHTML : fragment.innerHTML;
 // This code block basically merges attributes of the original SVG // the SVG element where it is called from. For eg, // // Let's say the original SVG is this: //  // a.svg = <svg viewBox='..' ...></svg> //  // and it is used as with svg-loader as <svg data-src="./a.svg" width="32"></svg> // this will create a combined element <svg data-src="./a.svg" width="32" viewBox='..' ...></svg> //  // For sprite icons, we don't need this as we are including the whole outerHTML.  if (!isSpriteIcon) { for (let i = 0; i < fragment.attributes.length; i++) { const { name, value } = fragment.attributes[i];  // Don't override the attributes already defined, but override the ones that // were in the original element if (!elem.getAttribute(name) || elemAttributesSet.has(name)) { elemAttributesSet.add(name); elem.setAttribute(name, value); } } }
 attributesSet[elemUniqueId] = elemAttributesSet;
 elem.setAttribute("data-id", elemUniqueId);
 const event = new CustomEvent('iconload', { bubbles: true }); elem.dispatchEvent(event);
 if (elem.getAttribute('oniconload')) { // Handling (and executing) event attribute for our event (oniconload) // isn't straightforward. Because a) the code is a raw string b) there's // no way to specify the context for execution. So, `this` in the attribute // will point to `window` instead of the element itself.  // // Here we are recycling a rarely used GlobalEventHandler 'onauxclick' // and offloading the execution to the browser. This is a hack, but because // the event doesn't bubble, it shouldn't affect anything else in the code.  elem.setAttribute('onauxclick', elem.getAttribute('oniconload'));  const event = new CustomEvent('auxclick', { bubbles: false, view: window }); elem.dispatchEvent(event);
 elem.removeAttribute('onauxclick'); }};
const requestsInProgress = {};const memoryCache = {};
const renderIcon = async (elem) => { const url = new URL(elem.getAttribute("data-src"), globalThis.location); const src = url.toString().replace(url.hash, ""); const spriteIconId = url.hash.replace("#", "");  const cacheOpt = elem.getAttribute("data-cache");
 const enableJs = elem.getAttribute("data-js") === "enabled"; const disableUniqueIds = elem.getAttribute("data-unique-ids") === "disabled"; const disableCssScoping = elem.getAttribute("data-css-scoping") === "disabled";
 const lsCache = await isCacheAvailable(src); const isCachingEnabled = cacheOpt !== "disabled";
 const renderBodyCb = renderBody.bind(self, elem, { enableJs, disableUniqueIds, disableCssScoping, spriteIconId });
 // Memory cache optimizes same icon requested multiple // times on the page if (memoryCache[src] || (isCachingEnabled && lsCache)) { const cache = memoryCache[src] || lsCache;
 renderBodyCb(cache); } else { // If the same icon is being requested to rendered // avoid firing multiple XHRs if (requestsInProgress[src]) { setTimeout(() => renderIcon(elem), 20); return; }
 requestsInProgress[src] = true;
 fetch(src) .then((response) => { if (!response.ok) { throw Error(`Request for '${src}' returned ${response.status} (${response.statusText})`); } return response.text(); }) .then((body) => { const bodyLower = body.toLowerCase().trim();
 if (!(bodyLower.startsWith("<svg") || bodyLower.startsWith("<?xml") || bodyLower.startsWith("<!doctype") )) { throw Error(`Resource '${src}' returned an invalid SVG file`); }
 if (isCachingEnabled) { setCache(src, body, cacheOpt); }
 memoryCache[src] = body;
 renderBodyCb(body); }) .catch((e) => { console.error(e); const event = new CustomEvent('iconloaderror', { bubbles: true, detail: e.toString(), }); elem.dispatchEvent(event); if(elem.getAttribute('oniconloaderror')){ // the oniconloaderror inline function will have access to an `error` argument const loadErrorFunction = Function("error", elem.getAttribute('oniconloaderror')); loadErrorFunction(e); } }) .finally(() => { delete requestsInProgress[src]; }); }};
let intObserver;if (globalThis.IntersectionObserver) { intObserver = new IntersectionObserver( (entries) => { entries.forEach((entry) => { if (entry.isIntersecting) { renderIcon(entry.target);  // Unobserve as soon as soon the icon is rendered intObserver.unobserve(entry.target); } }); }, { // Keep high root margin because intersection observer  // can be slow to react rootMargin: "1200px" } );}
const handled = [];function renderAllSVGs() { Array.from(document.querySelectorAll("svg[data-src]:not([data-id])")) .forEach((element) => { if (handled.indexOf(element) !== -1) { return; }
 handled.push(element); if (element.getAttribute("data-loading") === "lazy") { intObserver.observe(element); } else { renderIcon(element); } });}
let observerAdded = false;const addObservers = () => { if (observerAdded) { return; }
 observerAdded = true; const observer = new MutationObserver((mutationRecords) => { const shouldTriggerRender = mutationRecords.some( (record) => Array.from(record.addedNodes).some( (elem) => elem.nodeType === Node.ELEMENT\_NODE && ((elem.getAttribute("data-src") && !elem.getAttribute("data-id")) // Check if the element needs to be rendered || elem.querySelector("svg[data-src]:not([data-id])")) // Check if any of the element's children need to be rendered ) );
 // If any node is added, render all new nodes because the nodes that have already // been rendered won't be rendered again. if (shouldTriggerRender) { renderAllSVGs(); }
 // If data-src is changed, re-render mutationRecords.forEach((record) => { if (record.type === "attributes") { renderIcon(record.target); } }); });
 observer.observe( document.documentElement, { attributeFilter: ["data-src"], attributes: true, childList: true, subtree: true } );};
if (globalThis.addEventListener) { // Start rendering SVGs as soon as possible const intervalCheck = setInterval(() => { renderAllSVGs(); }, 100);
 function init() { clearInterval(intervalCheck);  renderAllSVGs(); addObservers(); }
 if (document.readyState === 'interactive') { init(); } else { globalThis.addEventListener("DOMContentLoaded", () => { init(); }); }}
globalThis.SVGLoader = {}globalThis.SVGLoader.destroyCache = async () => { // Handle error, "mutation operation was attempted on a database" // with try-catch try { const entriesCache = await entries();  for (const entry of entriesCache) { if (entry[0].startsWith('loader\_')) { await del(entry[0]); } } } catch(e) {}
 Object.keys(localStorage).forEach((key) => { if (key.startsWith('loader\_')) { localStorage.removeItem(key); } });}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


