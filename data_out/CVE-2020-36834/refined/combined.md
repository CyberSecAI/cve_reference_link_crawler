=== Content from www.wordfence.com_8efc4417_20250111_200948.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Discount Rules for WooCommerce <= 2.0.2 - Missing Authorization

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Discount Rules for WooCommerce <= 2.0.2 - Missing Authorization

6.3

**Missing Authorization**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L)

| CVE | [CVE-2020-36834](https://www.cve.org/CVERecord?id=CVE-2020-36834) |
| --- | --- |
| CVSS | 6.3 (Medium) |
| Publicly Published | August 20, 2020 |
| Last Updated | October 16, 2024 |
| Researcher | [Patchstack - Patchstack](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/patchstack) |

### Description

The Discount Rules for WooCommerce plugin for WordPress is vulnerable to missing authorization via several AJAX actions in versions up to, and including, 2.0.2 due to missing capability checks on various functions. This makes it possible for subscriber-level attackers to execute various actions and perform a wide variety of actions such as modifying rules and saving configurations.

Wordfence blocked **34 attacks** targeting this vulnerability in the past 24 hours.

#### References

* [patchstack.com](https://patchstack.com/articles/multiple-vulnerabilities-in-discount-rules-for-woocommerce-plugin/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwoo-discount-rules%2Fdiscount-rules-for-woocommerce-202-missing-authorization&t=Discount%20Rules%20for%20WooCommerce%20%3C%3D%202.0.2%20-%20Missing%20Authorization "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwoo-discount-rules%2Fdiscount-rules-for-woocommerce-202-missing-authorization&text=Discount%20Rules%20for%20WooCommerce%20%3C%3D%202.0.2%20-%20Missing%20Authorization "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwoo-discount-rules%2Fdiscount-rules-for-woocommerce-202-missing-authorization "LinkedIn")
Email

## Vulnerability Details for Discount Rules for WooCommerce – Create Smart WooCommerce Coupons & Discounts, Bulk Discount, BOGO Coupons

#### [Discount Rules for WooCommerce – Create Smart WooCommerce Coupons & Discounts, Bulk Discount, BOGO Coupons](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/woo-discount-rules)

| Software Type | Plugin |
| --- | --- |
| Software Slug | woo-discount-rules [(view on wordpress.org)](https://wordpress.org/plugins/woo-discount-rules) |
| Patched? | Yes |
| Remediation | Update to version 2.1.0, or a newer patched version |
| Affected Version | * <= 2.0.2 |
| Patched Version | * 2.1.0 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from patchstack.com_f9fb36a5_20250111_200946.html ===


[Skip to main content](#main)
[![](https://patchstack.com/wp-content/uploads/2021/11/logo.svg)](/)

JavaScript is disabled in your browser. Please enable JavaScript for a better experience.

* [Pricing](/pricing/)
* Solutions
  + [WordPress security](https://patchstack.com/wordpress-security/)
  + [Enterprise API](https://patchstack.com/for-hosts/)
  + [Managed VDP](https://patchstack.com/for-plugins/)
  + [Bug Bounty](https://patchstack.com/bug-bounty/)
  + [Plugin auditing](https://patchstack.com/auditing/)
  + [Vulnerability database](https://patchstack.com/database/)
* [Login](https://app.patchstack.com/login)

* ![]()

  + ![]()

    - ![]()

[Start trial](https://app.patchstack.com/register)

# Multiple Vulnerabilities In Discount Rules for WooCommerce Plugin

[Security advisories](https://patchstack.com/category/security-advisories/)
[Discount Rules for WooCommerce](https://patchstack.com/tag/discount-rules-for-woocommerce/)
Published 20 August 2020Updated 23 November 2023![](https://secure.gravatar.com/avatar/1282b2779ad15ea2f1b873dfbf119cc8?s=200&d=mm&r=g)[Agnes Talalaev](https://patchstack.com/author/agnes-talalaev/)SEO wizard at PatchstackTable of Contents

*There are SQLi and unauthenticated stored XSS vulnerabilities in Discount Rules for the WooCommerce WordPress plugin.*

The [Discount Rules for the](https://wordpress.org/plugins/woo-discount-rules/) WooCommerce plugin (versions 2.0.2 and below) suffer from multiple vulnerabilities such as SQL injection, authorization issues, and unauthenticated stored cross-site scripting.

In this scenario, the unauthenticated stored cross-site scripting issue could potentially lead to remote code execution.

![Discount Rules for WooCommerce](https://i.imgur.com/H3EDPPp.png)

The plugin is described as a plugin that helps you to create any type of bulk discounts, dynamic pricing, advanced discounts, percentage discounts, product-based discounts, tiered discounts for your products. It has 30.000+ active installations as of August 7th, 2020.

The described issues were fixed in version 2.1.0 after a rapid response by the developer team of the plugin in question.

### Update August 24, 2020

Based on our logs, there was another influx of attacks blocked on August 23rd. The IP address *95.181.152.136* attempted to inject the scripts *stock[dot]developerstatss[dot]ga/stock.js?v=1* and *stock[dot]developerstatss[dot]ga/stock.js?v=2* into the template hooks *woocommerce\_before\_main\_content*, *woocommerce\_after\_main\_content* and *footer*. This script seems to redirect the visitor to their own malicious site.

### Update August 21, 2020

We have seen an influx of attacks against this vulnerability. Primarily from the IP address *45.140.167.17* which attempts to inject the script *poponclick[dot]info/click.js* into the *woocommerce\_before\_main\_content* template hook. This seems to indicate that they are attempting to target WooCommerce based sites with this outdated plugin version installed.

We will continue to monitor this threat and will update this post with more information when available.

## The vulnerability in Discount Rules for WooCommerce

The issues in this plugin are caused due to a lack of authorization and nonce token check. The plugin registers several AJAX actions of which one, *wp\_ajax\_wdr\_ajax*, handles a bulk of different AJAX actions which are supposedly only be accessed by administrators.

Unfortunately this AJAX action is also registered as *wp\_ajax\_nopriv\_wdr\_ajax*. Even if *wp\_ajax\_nopriv\_wdr\_ajax* was not registered, authenticated users could still exploit this since *wp\_ajax\_wdr\_ajax* does not perform any type of authorization or CSRF check.

A snippet of what the function wdr\_ajax\_requests looks like (which is bound to both AJAX actions) can be found below.

```
public function wdr_ajax_requests()
{   $result = null;
   $method = $this->input->post('method', '');
   $method_name = 'wdr_ajax_' . $method;
   if (method_exists($this, $method_name)) {
   $result = $this->$method_name();
    }
   wp_send_json_success($result);
}
```

It grabs the method that it needs to execute from the *method* POST parameter and then executes it as long as it’s part of the current class scope. Some of the methods in the class are of no interest, but there are a few that could lead to serious vulnerabilities.

These actions can be executed by **any unauthenticated user**. There is no authentication, authorization, or CSRF check. Some of the methods of interest can be found below.

* **wdr\_ajax\_users\_list**
  + Retrieve list (userid and username only) of all users.
* **wdr\_ajax\_cart\_coupon**
  + Retrieve the list of all coupon codes.
* **wdr\_ajax\_save\_configuration**
  + Update any of the configuration settings (of the plugin only), allowing you to cause a great financial loss if a shop notices too late.
  + Since the values of some of the configuration settings are displayed to the user, unauthenticated stored XSS is possible at both frontend and backend in values such as on\_sale\_badge\_html, applied\_rule\_message, and awdr\_banner\_editor which in turn could trigger a remote code execution exploit since we can execute any type of code on the admin screen.
  + The combination of overwriting the values awdr\_banner\_editor and display\_banner\_text allows any unauthenticated user to inject XSS into any display location they desire, such as the header, footer or any admin page.
* **wdr\_ajax\_save\_rule**
  + Save a discount rule.
* **wdr\_ajax\_delete\_rule**
  + Delete a discount rule.
* **wdr\_ajax\_duplicate\_rule**
  + Duplicate a discount rule.
  + This method is also vulnerable to SQL injection since the *rowid* POST parameter is directly used in a SQL query.
* **wdr\_ajax\_bulk\_action**
  + Bulk enable, disable, or delete discount rules.

## The patch in Discount Rules for WooCommerce

The patch for version 2.1.0 can be found [here](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2359660%40woo-discount-rules%2Ftrunk&old=2348192%40woo-discount-rules%2Ftrunk&sfp_email=&sfph_mail=) which shows that they added an authorization and CSRF check to the admin methods.

The image below shows that the AJAX action handler can now only be executed by authorized users. Or if the action is a public frontend AJAX action. The individual AJAX admin actions also determine if a valid CSRF token is present.

![Discount Rules for WooCommerce](https://i.imgur.com/WnBRp6G.png)
## Timeline

**07-08-2020** – We discovered the vulnerability in Discount Rules for WooCommerce and released a [vPatch](https://patchstack.com/virtual-patching/) to all Patchstack paid version customers.
****07-08-2020**** – We reported the issue to the developer of the plugin.
**07-08-2020** – The developer replied and started working on a fix.
**12-08-2020** – The developer asked us to review the fixed version, which we approved.
**13-08-2020** – Version 2.1.0 was released which contains the proper fixes.
**20-08-2020** – Published the article.

Websites with Patchstack paid version are protected from the issue and have received a vPatch.

Found this useful? Share on

* ![](https://patchstack.com/wp-content/uploads/2024/06/twitter-x-line.svg)
* ![](https://patchstack.com/wp-content/uploads/2024/03/facebook-fill.svg)
* ![](https://patchstack.com/wp-content/uploads/2024/03/linkedin-fill.svg)

Protect your websites against WordPress vulnerabilities[Get started](/pricing/)
### Monthly security advice

Get the latest WordPress security intelligence delivered to your inbox.**NEW**: Get started with 5 bite-sized security lessons.
Email SignupEmailSubscribe
### The latest in Security advisories

[See all](https://patchstack.com/category/security-advisories/)[![](https://patchstack.com/wp-content/uploads/2025/01/Critical-Vulnerability-Patched-in-GiveWP-Plugin-main.png)10 January, 2025
#### Critical Vulnerability Patched in GiveWP Plugin

Critical Vulnerability
php object injection
Zeroday bounties
zeroday
givewp](https://patchstack.com/articles/critical-vulnerability-patched-in-givewp-plugin/)[![](https://patchstack.com/wp-content/uploads/2025/01/Critical-Vulnerabilities-Found-in-Fancy-Product-Designer-Plugin-main.png)8 January, 2025
#### Critical Vulnerabilities Found in Fancy Product Designer Plugin

Critical Vulnerability
arbitrary file upload
SQL Injection
ENVATO](https://patchstack.com/articles/critical-vulnerabilities-found-in-fancy-product-designer-plugin/)[![](https://patchstack.com/wp-content/uploads/2024/12/Multiple-Critical-Vulnerabilities-Patched-in-WPLMS-and-VibeBP-Plugins-main.png)23 December, 2024
#### Multiple Critical Vulnerabilities Patched in WPLMS and VibeBP Plugins

Critical Vulnerability
privilege escalation
arbitrary file upload
theme
SQL Injection
ENVATO](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wplms-and-vibebp-plugins/)

### Website security

[Pricing](https://patchstack.com/pricing/)[For WordPress](https://patchstack.com/wordpress-security/)[For WooCommerce](https://patchstack.com/woocommerce-security)[For agencies](https://patchstack.com/for-agencies/)[API for hosts](https://patchstack.com/for-hosts/)[Documentation](https://docs.patchstack.com/)[Log in](https://app.patchstack.com/login)
### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)[Log in](https://vdp.patchstack.com/vdp/login)[Active programs](https://patchstack.com/database/vdp/)[Security auditing](https://patchstack.com/auditing/)
### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)[Log in](https://vdp.patchstack.com/researchers/login)[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)[Learn](https://patchstack.com/academy)[Discord](https://discord.gg/rkE8yxtNmS)
### Resources

[Vulnerability database](https://patchstack.com/database/)[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024/)[Vulnerability statistics](https://patchstack.com/database/statistics/wordpress)[Case studies](https://patchstack.com/category/case-studies/)[Articles](https://patchstack.com/articles/)
### Patchstack

[About](https://patchstack.com/about/)[Careers](https://patchstack.com/about/#careers)[Merch store](https://store.patchstack.com)[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)
### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)[Facebook](https://www.facebook.com/patchstackapp)[X](https://twitter.com/patchstackapp)[![Patchstack logo](https://patchstack.com/wp-content/uploads/2024/01/logo-opt-300x32.webp)](/)© 2025 Patchstack[DPA](https://patchstack.com/data-processing-agreement-dpa/)[Privacy Policy](https://patchstack.com/privacy-policy/)[Terms & Conditions](https://patchstack.com/terms-and-conditions/)![Co-funded by EU logo](https://patchstack.com/wp-content/uploads/2024/01/EIC-logo-CoFundedBy-opt.webp)
[![](https://patchstack.com/wp-content/uploads/2021/01/logo.png)](/)
### Website security

[Pricing](https://patchstack.com/pricing/)[For WordPress](https://patchstack.com/wordpress-security/)[For WooCommerce](https://patchstack.com/woocommerce-security)[For agencies](https://patchstack.com/for-agencies/)[API for hosts](https://patchstack.com/for-hosts/)[Documentation](https://docs.patchstack.com/)[Log in](https://app.patchstack.com/login)
### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)[Log in](https://vdp.patchstack.com/vdp/login)[Active programs](https://patchstack.com/database/vdp/)[Security auditing](https://patchstack.com/auditing/)
### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)[Log in](https://vdp.patchstack.com/researchers/login)[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)[Learn](https://patchstack.com/academy)[Discord](https://discord.gg/rkE8yxtNmS)
### Resources

[Vulnerability database](https://patchstack.com/database/)[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024/)[Vulnerability statistics](https://patchstack.com/database/statistics/wordpress)[Case studies](https://patchstack.com/category/case-studies/)[Articles](https://patchstack.com/articles/)
### Patchstack

[About](https://patchstack.com/about/)[Careers](https://patchstack.com/about/#careers)[Merch store](https://store.patchstack.com)[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)
### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)[Facebook](https://www.facebook.com/patchstackapp)[X](https://twitter.com/patchstackapp)© 2025 Patchstack[DPA](https://patchstack.com/data-processing-agreement-dpa/)[Privacy Policy](https://patchstack.com/privacy-policy/)[Terms & Conditions](https://patchstack.com/terms-and-conditions/)

Looks like your browser is blocking our support chat widget. Turn off adblockers and reload the page.Reload page

xml version="1.0"?closechevron-downchainbarsangle-rightangle-upxml version="1.0"?crossmenu


