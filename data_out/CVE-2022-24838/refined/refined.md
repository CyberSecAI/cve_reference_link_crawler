Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

The vulnerability stems from a lack of proper sanitization of the email address provided in the JSON request when booking an appointment. Specifically, newline characters and other special characters were not being sanitized, allowing for SMTP command injection.

**Weaknesses/Vulnerabilities:**

*   **SMTP Command Injection (CWE-93):** The primary vulnerability is the ability to inject arbitrary SMTP commands by including newline characters and other special characters in the email parameter of the JSON request.

**Impact of Exploitation:**

*   A malicious actor could inject newlines to break out of the `RCPT TO:<BOOKING USER'S EMAIL>` SMTP command and inject arbitrary SMTP commands. This allows the attacker to manipulate the email sending process.

**Attack Vectors:**

*   **Network:** The attack vector is over the network, as the attacker sends a crafted JSON request to the server.

**Required Attacker Capabilities/Position:**

*   **No privileges required:** The attacker does not need any specific privileges on the system.
*   **No User Interaction:** The attack does not require any user interaction.
*   The attacker needs to be able to send a crafted JSON request to the server.

**Additional Details:**

*   The vulnerability affects versions of Nextcloud Calendar prior to 3.2.2.
*   The fix for this issue includes email validation to ensure that injected special characters are blocked, as well as integration testing.
*   The CVSS score is 5.3, indicating a moderate severity.
*   The attack complexity is low.
*   The impact of the attack is limited to a low impact on confidentiality with no impact on integrity and availability.
*   The vulnerability was discovered by `spaceraccoon` and `IntiDC`.
*   The fix was implemented in pull request #4073.