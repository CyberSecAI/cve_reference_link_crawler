





<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>1 comment DoS exploiting Kroki lib (#338721) · Issues · GitLab.org / GitLab · GitLab</title>
<script nonce="YujjprKJfn8Uu2VzrcA6HA==">
//<![CDATA[
window.gon={};gon.math_rendering_limits_enabled=true;gon.features={"preserveMarkdown":true,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":true,"workItemsBeta":true,"workItemsAlpha":false,"workItems":true,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false,"workItemsViewPreference":false,"okrsMvc":false,"workItemEpics":true};gon.licensed_features={"escalationPolicies":true,"okrs":true};gon.abilities={"summarizeComments":false,"measureCommentTemperature":false};
//]]>
</script>


<script nonce="YujjprKJfn8Uu2VzrcA6HA==">
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/gitlab-org/gitlab/-/issues/338721/related_branches":{},"/gitlab-org/gitlab/-/issues/338721/discussions.json?per_page=20":{},"/gitlab-org/gitlab/-/issues/338721.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = [{"query":"query getDesignList($fullPath: ID!, $iid: String!, $atVersion: DesignManagementVersionID) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      designCollection {\n        __typename\n        copyState\n        designs(atVersion: $atVersion) {\n          __typename\n          nodes {\n            __typename\n            id\n            event\n            filename\n            notesCount\n            image\n            imageV432x230\n            currentUserTodos(state: pending) {\n              __typename\n              nodes {\n                __typename\n                id\n              }\n            }\n          }\n        }\n        versions {\n          __typename\n          nodes {\n            __typename\n            id\n            sha\n            createdAt\n            author {\n              __typename\n              id\n              name\n              avatarUrl\n            }\n          }\n        }\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"338721","atVersion":null}},{"query":"query permissions($fullPath: ID!, $iid: String!) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      userPermissions {\n        __typename\n        createDesign\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"338721"}}];

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"zfox_-PN9kggb-X3KPv5XvU-gEQQN_bhsp57a35pr5UZvn7x2UL_g4tBbLGTFfX7g9ClWFSrwRWyhKDD_FnWsA","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.com/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-9de688b302d723d15d70ba51a5410625092e3bc978dbb160cc523f86c4807968.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-f20ae9b5b8c9a0f793e3ffa2ddc13953bfd683e1d351c8e6cc75e0fcd4ddde90.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-b9f383aefa56f0a72990496e4a4b3aaf2c525843283a1c0c3d85876537187397.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-e25480d2326300d5c49ad31dbd847a53e39fc33a5fd595a961dd7238e411b558.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-7e727ab1e91b421915feadeb04a1b9d57213cb1b2f8f56f4d894b34d6b42e9b3.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-22a76cdd1fe2ae5431b7ff603f86212acaf81b49c4a932f19e3b3222dc1881ee.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-73b9a1c83703ccfccd0e1e418c7d8dc606fcac533fa38b9fa86792f098db0f9a.css" />
<link rel="stylesheet" href="/assets/tailwind-284f33824923c600abd24d7884ff853fd38734b17a1441a1b7e31d4aa365acc2.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" />

<script src="/assets/webpack/runtime.f0860ff2.bundle.js" defer="defer" nonce="YujjprKJfn8Uu2VzrcA6HA=="></script>
<script src="/assets/webpack/main.78bd52ff.chunk.js" defer="defer" nonce="YujjprKJfn8Uu2VzrcA6HA=="></script>
<script src="/assets/webpack/tracker.868aa839.chunk.js" defer="defer" nonce="YujjprKJfn8Uu2VzrcA6HA=="></script>
<script src="/assets/webpack/analytics.cb60a77a.chunk.js" defer="defer" nonce="YujjprKJfn8Uu2VzrcA6HA=="></script>
<script nonce="YujjprKJfn8Uu2VzrcA6HA==">
//<![CDATA[
window.snowplowOptions = {"namespace":"gl","hostname":"snowplowprd.trx.gitlab.net","cookieDomain":".gitlab.com","appId":"gitlab","formTracking":true,"linkClickTracking":true}

gl = window.gl || {};
gl.snowplowStandardContext = {"schema":"iglu:com.gitlab/gitlab_standard/jsonschema/1-1-1","data":{"environment":"production","source":"gitlab-rails","correlation_id":"01JGVPQWRSMYWD8CJCYD3VSQK0","plan":"gold","extra":{},"user_id":null,"global_user_id":null,"is_gitlab_team_member":null,"namespace_id":9970,"project_id":278964,"feature_enabled_by_namespace_ids":null,"realm":"saas","instance_id":"ea8bf810-1d6f-4a6a-b4fd-93e8cbd8b57f","host_name":"gitlab-cny-webservice-web-7b99886bd6-8ww8g","instance_version":"17.8.0","context_generated_at":"2025-01-05T17:03:29.288Z"}}
gl.snowplowPseudonymizedPageUrl = "https://gitlab.com/namespace9970/project278964/-/issues/338721";
gl.maskedDefaultReferrerUrl = null;
gl.ga4MeasurementId = 'G-ENFH3X7M5Y';


//]]>
</script>
<link rel="preload" href="/assets/application_utilities-73b9a1c83703ccfccd0e1e418c7d8dc606fcac533fa38b9fa86792f098db0f9a.css" as="style" type="text/css" nonce="PD+ppE1k5Q6/1NMp5TB/OQ==">
<link rel="preload" href="/assets/application-9de688b302d723d15d70ba51a5410625092e3bc978dbb160cc523f86c4807968.css" as="style" type="text/css" nonce="PD+ppE1k5Q6/1NMp5TB/OQ==">
<link rel="preload" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" as="style" type="text/css" nonce="PD+ppE1k5Q6/1NMp5TB/OQ==">
<link crossorigin="" href="https://snowplowprd.trx.gitlab.net" rel="preconnect">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-1e0a5107ea3bbd4be93e8ad2c503467e43166cd37e4293570b490e0812ede98b.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-Italic-38eaf1a569a54ab28c58b92a4a8de3afb96b6ebc250cf372003a7b38151848cc.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-08d2c5e8ff8fd3d2d6ec55bc7713380f8981c35f9d2df14e12b835464d6e8f23.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-Italic-38e58d8df29485a20c550da1d0111e2c2169f6dcbcf894f2cd3afbdd97bcc588.woff2" rel="preload">
<link rel="preload" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" as="style" type="text/css" nonce="PD+ppE1k5Q6/1NMp5TB/OQ==">



<script src="/assets/webpack/sentry.907cf3e4.chunk.js" defer="defer" nonce="YujjprKJfn8Uu2VzrcA6HA=="></script>

<script src="/assets/webpack/9.49e5c3e3.chunk.js" defer="defer" nonce="YujjprKJfn8Uu2VzrcA6HA=="></script>
<script src="/assets/webpack/11.e2e145a2.chunk.js" defer="defer" nonce="YujjprKJfn8Uu2VzrcA6HA=="></script>
<script src="/assets/webpack/13.3d62f21f.chunk.js" defer="defer" nonce="YujjprKJfn8Uu2VzrcA6HA=="></script>
<script src="/assets/webpack/commons-pages.groups.analytics.dashboards-pages.groups.harbor.repositories-pages.groups.iteration_ca-b07ae190.ba6536d6.chunk.js" defer="defer" nonce="YujjprKJfn8Uu2VzrcA6HA=="></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.3be560a5.chunk.js" defer="defer" nonce="YujjprKJfn8Uu2VzrcA6HA=="></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.ca4ee38a.chunk.js" defer="defer" nonce="YujjprKJfn8Uu2VzrcA6HA=="></script>
<script src="/assets/webpack/super_sidebar.14e23139.chunk.js" defer="defer" nonce="YujjprKJfn8Uu2VzrcA6HA=="></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-bce54798.cf2cb6b5.chunk.js" defer="defer" nonce="YujjprKJfn8Uu2VzrcA6HA=="></script>
<script src="/assets/webpack/pages.projects.issues.show.779fd13b.chunk.js" defer="defer" nonce="YujjprKJfn8Uu2VzrcA6HA=="></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="1 comment DoS exploiting Kroki lib (#338721) · Issues · GitLab.org / GitLab · GitLab" property="og:title">
<meta content="HackerOne report #1305431 by scaramouche31 on 2021-08-14, assigned to @ankelly:..." property="og:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.com/gitlab-org/gitlab/-/issues/338721" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="1 comment DoS exploiting Kroki lib (#338721) · Issues · GitLab.org / GitLab · GitLab" property="twitter:title">
<meta content="HackerOne report #1305431 by scaramouche31 on 2021-08-14, assigned to @ankelly:..." property="twitter:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="GitLab SecurityBot"><meta property="twitter:label2" content="Assignee"><meta property="twitter:data2" content="Coung Ngo">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="dRRf7tWbrTCEiyt6vOspyPGY2nIIObpkjFHz1PipaFChUBDg7xSk-y-lojwHBSVth3b_bkyljZCMSyh8epkRdQ" />
<meta name="csp-nonce" content="YujjprKJfn8Uu2VzrcA6HA==" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" id="favicon" data-original-href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content="HackerOne report #1305431 by scaramouche31 on 2021-08-14, assigned to @ankelly:..." name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-group="gitlab-org" data-group-full-path="gitlab-org" data-namespace-id="9970" data-page="projects:issues:show" data-page-type-id="338721" data-project="gitlab" data-project-full-path="gitlab-org/gitlab" data-project-id="278964">
<script nonce="YujjprKJfn8Uu2VzrcA6HA==">
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"epics":"/gitlab-org/gitlab/-/autocomplete_sources/epics","iterations":"/gitlab-org/gitlab/-/autocomplete_sources/iterations","vulnerabilities":"/gitlab-org/gitlab/-/autocomplete_sources/vulnerabilities","members":"/gitlab-org/gitlab/-/autocomplete_sources/members?type=Issue\u0026type_id=338721","issues":"/gitlab-org/gitlab/-/autocomplete_sources/issues","mergeRequests":"/gitlab-org/gitlab/-/autocomplete_sources/merge_requests","labels":"/gitlab-org/gitlab/-/autocomplete_sources/labels?type=Issue\u0026type_id=338721","milestones":"/gitlab-org/gitlab/-/autocomplete_sources/milestones","commands":"/gitlab-org/gitlab/-/autocomplete_sources/commands?type=Issue\u0026type_id=338721","snippets":"/gitlab-org/gitlab/-/autocomplete_sources/snippets","contacts":"/gitlab-org/gitlab/-/autocomplete_sources/contacts?type=Issue\u0026type_id=338721","wikis":null};


//]]>
</script>
<script nonce="YujjprKJfn8Uu2VzrcA6HA==">
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" data-track-label="main_navigation" data-track-action="click_gitlab_logo_link" data-track-property="navigation_top" href="/"><svg aria-hidden="true" role="img" class="tanuki-logo" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path class="tanuki-shape tanuki" d="m24.507 9.5-.034-.09L21.082.562a.896.896 0 0 0-1.694.091l-2.29 7.01H7.825L5.535.653a.898.898 0 0 0-1.694-.09L.451 9.411.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 2.56 1.935 1.554 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#E24329"/>
  <path class="tanuki-shape right-cheek" d="m24.507 9.5-.034-.09a11.44 11.44 0 0 0-4.56 2.051l-7.447 5.632 4.742 3.584 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#FC6D26"/>
  <path class="tanuki-shape chin" d="m7.707 20.677 2.56 1.935 1.555 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935-4.743-3.584-4.755 3.584Z"
        fill="#FCA326"/>
  <path class="tanuki-shape left-cheek" d="M5.01 11.461a11.43 11.43 0 0 0-4.56-2.05L.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 4.745-3.584-7.444-5.632Z"
        fill="#FC6D26"/>
</svg>

</a><a class="gl-badge badge badge-pill badge-success canary-badge" data-testid="canary_badge_link" href="https://next.gitlab.com" rel="noopener noreferrer" target="_blank"><span class="gl-badge-content">Next
</span></a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item header-logged-out-dropdown md:gl-hidden">
<button class="header-logged-out-toggle" data-toggle="dropdown" type="button">
<span class="gl-sr-only">
Menu
</span>
<svg class="s16" data-testid="hamburger-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#hamburger"></use></svg>
</button>
<div class="dropdown-menu">
<ul>
<li>
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li>
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li>
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li>
<a href="/explore">Explore</a>
</li>
</ul>
</div>
</li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li class="header-logged-out-nav-item gl-hidden gl-inline-block">
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
<li class="header-logged-out-nav-item">
<a class="gl-button btn btn-md btn-confirm !gl-inline-flex" href="/users/sign_up"><span class="gl-button-text">
Get free trial

</span>

</a></li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/gitlab-org/gitlab/-/files/master?format=json&quot;,&quot;project_blob_url&quot;:&quot;/gitlab-org/gitlab/-/blob/master&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="true" data-root-path="/" data-sidebar="{&quot;whats_new_most_recent_release_items_count&quot;:6,&quot;whats_new_version_digest&quot;:&quot;c955dbe1b30a1468b032fe6896086eda50f884ff9559d966e5ef75c34eee3ff0&quot;,&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;GitLab&quot;,&quot;avatar&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;,&quot;entity_id&quot;:278964,&quot;link&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;pill_count_field&quot;:&quot;openIssuesCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/milestones&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;iterations&quot;,&quot;title&quot;:&quot;Iterations&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/cadences&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;requirements&quot;,&quot;title&quot;:&quot;Requirements&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/requirements_management/requirements&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;project_merge_request_list&quot;,&quot;title&quot;:&quot;Merge requests&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;pill_count_field&quot;:&quot;openMergeRequestsCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-merge_requests&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tree/master&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/commits/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/network/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/compare?from=master\u0026to=master&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_snippets&quot;,&quot;title&quot;:&quot;Snippets&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/snippets&quot;,&quot;link_classes&quot;:&quot;shortcuts-snippets&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;file_locks&quot;,&quot;title&quot;:&quot;Locked files&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/path_locks&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;test_cases&quot;,&quot;title&quot;:&quot;Test cases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/quality/test_cases&quot;,&quot;link_classes&quot;:&quot;shortcuts-test-cases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;packages_registry&quot;,&quot;title&quot;:&quot;Package Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/packages&quot;,&quot;link_classes&quot;:&quot;shortcuts-container-registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;container_registry&quot;,&quot;title&quot;:&quot;Container Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/container_registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/models&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;operations_menu&quot;,&quot;title&quot;:&quot;Operate&quot;,&quot;icon&quot;:&quot;cloud-pod&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;environments&quot;,&quot;title&quot;:&quot;Environments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;link_classes&quot;:&quot;shortcuts-environments&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;infrastructure_registry&quot;,&quot;title&quot;:&quot;Terraform modules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/terraform_module_registry&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;incidents&quot;,&quot;title&quot;:&quot;Incidents&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;service_desk&quot;,&quot;title&quot;:&quot;Service Desk&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues/service_desk&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;code_review&quot;,&quot;title&quot;:&quot;Code review analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/code_reviews&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;issues&quot;,&quot;title&quot;:&quot;Issue analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/issues_analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;insights&quot;,&quot;title&quot;:&quot;Insights&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/insights/&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-insights&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_experiments&quot;,&quot;title&quot;:&quot;Model experiments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/experiments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:true,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:9970,&quot;name&quot;:&quot;GitLab.org&quot;,&quot;full_name&quot;:&quot;GitLab.org&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/gitlab-org/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/gitlab-org/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:278964,&quot;name&quot;:&quot;GitLab&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">






























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"GitLab.org","item":"https://gitlab.com/gitlab-org"},{"@type":"ListItem","position":2,"name":"GitLab","item":"https://gitlab.com/gitlab-org/gitlab"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.com/gitlab-org/gitlab/-/issues"},{"@type":"ListItem","position":4,"name":"#338721","item":"https://gitlab.com/gitlab-org/gitlab/-/issues/338721"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;GitLab.org&quot;,&quot;href&quot;:&quot;/gitlab-org&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/group/avatar/9970/project_avatar.png&quot;},{&quot;text&quot;:&quot;GitLab&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#338721&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues/338721&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/338721&quot;,&quot;new_issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/new?add_related_issue=338721&quot;,&quot;project_path&quot;:&quot;gitlab-org/gitlab&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:2741139,&quot;reported_from_url&quot;:&quot;https://gitlab.com/gitlab-org/gitlab/-/issues/338721&quot;,&quot;submit_as_spam_path&quot;:&quot;/gitlab-org/gitlab/-/issues/338721/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null,&quot;can_promote_to_epic&quot;:&quot;false&quot;}" data-initial="{&quot;endpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/338721&quot;,&quot;updateEndpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/338721.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#338721&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=338721\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:2,&quot;issuableTemplateNamesPath&quot;:&quot;/gitlab-org/gitlab/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;1 comment DoS exploiting Kroki lib&quot;,&quot;initialTitleText&quot;:&quot;1 comment DoS exploiting Kroki lib&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003cp data-sourcepos=\&quot;1:1-1:126\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;1:1-1:70\&quot;\u003e\u003ca data-sourcepos=\&quot;1:3-1:68\&quot; href=\&quot;https://hackerone.com/reports/1305431\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eHackerOne report #1305431\u003c/a\u003e\u003c/strong\u003e by \u003ccode data-sourcepos=\&quot;1:76-1:88\&quot;\u003escaramouche31\u003c/code\u003e on 2021-08-14, assigned to \u003ca href=\&quot;/ankelly\&quot; data-reference-type=\&quot;user\&quot; data-user=\&quot;4226366\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; class=\&quot;gfm gfm-project_member js-user-link\&quot; title=\&quot;Andrew Kelly\&quot;\u003e@ankelly\u003c/a\u003e:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:1-3:47\&quot; dir=\&quot;auto\&quot;\u003e\u003ca data-sourcepos=\&quot;3:1-3:17\&quot; href=\&quot;#report\&quot;\u003eReport\u003c/a\u003e | \u003ca data-sourcepos=\&quot;3:21-3:47\&quot; href=\&quot;#attachments\&quot;\u003eAttachments\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;5:1-5:9\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-report\&quot; class=\&quot;anchor\&quot; href=\&quot;#report\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eReport\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;7:1-7:193\&quot; dir=\&quot;auto\&quot;\u003eHello, Gitlab Team! Today I stumbled upon this report: \u003ca href=\&quot;https://hackerone.com/reports/470067\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://hackerone.com/reports/470067\u003c/a\u003e. I immediately tried to reproduce this behaviour using the Gitlab Kroki library and... it just works.\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;9:1-9:16\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-summary\&quot; class=\&quot;anchor\&quot; href=\&quot;#summary\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSummary\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;10:1-10:190\&quot; dir=\&quot;auto\&quot;\u003eA low privileged attacker can exploit Kroki library to DoS any section with comments (Issues, Merge requests, Milestones, Snippets, Wiki pages, Markdown documents inside repositories, Epics)\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;12:1-12:25\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-steps-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#steps-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSteps to reproduce\u003c/h5\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;14:1-20:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;14:1-20:0\&quot;\u003eEnable Kroki in your Gitlab build.\u003cbr data-sourcepos=\&quot;14:41-14:41\&quot;\u003e\u0026#x000A;On the top bar, select Menu \u0026gt; Admin.\u003cbr data-sourcepos=\&quot;15:42-15:42\&quot;\u003e\u0026#x000A;Go to Settings \u0026gt; General.\u003cbr data-sourcepos=\&quot;16:31-16:31\&quot;\u003e\u0026#x000A;Expand the Kroki section.\u003cbr data-sourcepos=\&quot;17:31-17:31\&quot;\u003e\u0026#x000A;Select Enable Kroki checkbox.\u003cbr data-sourcepos=\&quot;18:35-18:35\&quot;\u003e\u0026#x000A;Enter the Kroki URL. It may be a Kroki server on \u003ca href=\&quot;https://kroki.io\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://kroki.io\u003c/a\u003e, but I used my own in a docker container, just run\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;21:1-21:60\&quot; dir=\&quot;auto\&quot;\u003e\u003ccode data-sourcepos=\&quot;21:4-21:57\&quot;\u003edocker run -d --name kroki -p 8030:8000 yuzutech/kroki\u003c/code\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;23:1-23:86\&quot; dir=\&quot;auto\&quot;\u003eand then specify \u003ca href=\&quot;http://127.0.0.1:8030\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttp://127.0.0.1:8030\u003c/a\u003e (dont forget to add 127.0.0.1 to the whitelist)\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;25:1-29:0\&quot; start=\&quot;2\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;25:1-25:54\&quot;\u003eCreate a new project, then create an issue in it.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;26:1-26:143\&quot;\u003eInsert this payload in the comments section: \u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/348cf25344942c6aadfcb608bf26c2d38db92314/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34393962663932642d653035382d346634302d623235632d3130333866366364333463652f7061796c6f61642e747874\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/499bf92d-e058-4f40-b25c-1038f6cd34ce/payload.txt\&quot;\u003e\u003cimg data-sourcepos=\&quot;26:49-26:140\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;payload.txt\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/499bf92d-e058-4f40-b25c-1038f6cd34ce/payload.txt\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/348cf25344942c6aadfcb608bf26c2d38db92314/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34393962663932642d653035382d346634302d623235632d3130333866366364333463652f7061796c6f61642e747874\&quot;\u003e\u003c/a\u003e.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;27:1-29:0\&quot;\u003eReload the page.\u003cbr data-sourcepos=\&quot;27:22-27:22\&quot;\u003e\u0026#x000A;DoS!\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;30:1-31:118\&quot; dir=\&quot;auto\&quot;\u003ePoC video:\u003cbr data-sourcepos=\&quot;30:13-30:13\&quot;\u003e\u0026#x000A;\u003cspan class=\&quot;media-container video-container\&quot;\u003e\u003cvideo src=\&quot;https://user-content.gitlab-static.net/28cc1f104f6ffc7f05280628f799a9f8cee0f027/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f66396666616232312d643161622d343363612d623035352d6237633939653465346431352f6b617a616d5f77387573763235782e6d6f7669652e6d7034\&quot; controls=\&quot;true\&quot; data-setup=\&quot;{}\&quot; data-title=\&quot;kazam_w8usv25x.movie.mp4\&quot; preload=\&quot;metadata\&quot; width=\&quot;400\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/f9ffab21-d1ab-43ca-b055-b7c99e4e4d15/kazam_w8usv25x.movie.mp4\&quot;\u003e\u003c/video\u003e\u003ca href=\&quot;https://user-content.gitlab-static.net/28cc1f104f6ffc7f05280628f799a9f8cee0f027/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f66396666616232312d643161622d343363612d623035352d6237633939653465346431352f6b617a616d5f77387573763235782e6d6f7669652e6d7034\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; title=\&quot;Download &#39;kazam_w8usv25x.movie.mp4&#39;\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/f9ffab21-d1ab-43ca-b055-b7c99e4e4d15/kazam_w8usv25x.movie.mp4\&quot;\u003ekazam_w8usv25x.movie.mp4\u003c/a\u003e\u003c/span\u003e\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;33:1-33:10\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-fix\&quot; class=\&quot;anchor\&quot; href=\&quot;#fix\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eFix\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;35:1-35:79\&quot; dir=\&quot;auto\&quot;\u003eThe fix should be something like as for the Mermaid and Math in .com edition:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;36:1-44:5\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e if (  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e          !WHITELISTED_PAGES.includes(pageName) \u0026amp;\u0026amp;  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e          ((source \u0026amp;\u0026amp; source.length \u0026gt; MAX_CHAR_LIMIT) ||  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e            renderedChars \u0026gt; MAX_CHAR_LIMIT ||  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e            renderedMermaidBlocks \u0026gt;= MAX_MERMAID_BLOCK_LIMIT ||  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e            shouldLazyLoadMermaidBlock(source))  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e        ) { raise a warning and dont render }  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;45:1-46:107\&quot; dir=\&quot;auto\&quot;\u003e\u003ca href=\&quot;https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/behaviors/markdown/render_mermaid.js\&quot;\u003ehttps://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/behaviors/markdown/render_mermaid.js\u003c/a\u003e\u003cbr data-sourcepos=\&quot;45:113-45:113\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/behaviors/markdown/render_math.js\&quot;\u003ehttps://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/behaviors/markdown/render_math.js\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;48:1-49:64\&quot; dir=\&quot;auto\&quot;\u003eBut the problem is about every lib that Kroki supports: Bytefield, Ditaa, PlantUML, the one I used, and so on, the full list is here:\u003cbr data-sourcepos=\&quot;48:136-48:136\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;https://docs.gitlab.com/ee/administration/integration/kroki.html\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://docs.gitlab.com/ee/administration/integration/kroki.html\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;51:1-51:23\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-output-of-checks\&quot; class=\&quot;anchor\&quot; href=\&quot;#output-of-checks\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eOutput of checks\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;53:1-53:45\&quot; dir=\&quot;auto\&quot;\u003eThis bug happens on the local Gitlab version.\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;55:1-55:13\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-ps\&quot; class=\&quot;anchor\&quot; href=\&quot;#ps\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eP.s.\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;56:1-56:90\&quot; dir=\&quot;auto\&quot;\u003eThis bug doesnt fall under Timeout limits, because the DoS is caused using only 1 comment:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;58:1-62:118\&quot; dir=\&quot;auto\&quot;\u003eSize/Length limits (e.g. not able to add more than 2MB per Redis entry) - the payload weights only 0.1 Mb\u003cbr data-sourcepos=\&quot;58:108-58:108\&quot;\u003e\u0026#x000A;Count limits (e.g. not more than X comments per issue) - you need only 1 comment\u003cbr data-sourcepos=\&quot;59:83-59:83\&quot;\u003e\u0026#x000A;Call/time limits (e.g. User can only do 1000 API calls per 10 minutes) - you dont need any API calls\u003cbr data-sourcepos=\&quot;60:103-60:103\&quot;\u003e\u0026#x000A;Complexity limits (e.g. 1000 calls to endpoint X compared to 1000 calls to endpoint Y can be totally different) - you need only 1 call to the comment create endpoint\u003cbr data-sourcepos=\&quot;61:168-61:168\&quot;\u003e\u0026#x000A;Max result limit (e.g. Only return max 1000 results and say refine your search) - you dont need to search for anything\u003c/p\u003e\u0026#x000A;\u003ch6 data-sourcepos=\&quot;64:1-64:42\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-results-of-gitlab-environment-info\&quot; class=\&quot;anchor\&quot; href=\&quot;#results-of-gitlab-environment-info\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eResults of GitLab environment info\u003c/h6\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;66:1-104:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003escara@scara:~$ sudo gitlab-rake gitlab:env:info\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSystem information  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSystem:\t\tUbuntu 20.04  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eProxy:\t\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eCurrent User:\tgit  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing RVM:\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRuby Version:\t2.7.2p137  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGem Version:\t3.1.4  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eBundler Version:2.1.4  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRake Version:\t13.0.3  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRedis Version:\t6.0.14  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGit Version:\t2.32.0  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSidekiq Version:5.2.9  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGo Version:\tunknown\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab information  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eVersion:\t14.1.2-ee  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRevision:\t0bf9b154ab4  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDirectory:\t/opt/gitlab/embedded/service/gitlab-rails  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDB Adapter:\tPostgreSQL  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDB Version:\t12.6  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eURL:\t\thttp://gitlab.local  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eHTTP Clone URL:\thttp://gitlab.local/some-group/some-project.git  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSSH Clone URL:\tgit@gitlab.local:some-group/some-project.git  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eElasticsearch:\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC27\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGeo:\t\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC28\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing LDAP:\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC29\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing Omniauth:\tyes  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC30\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOmniauth Providers: \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC31\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC32\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab Shell  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC33\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eVersion:\t13.19.1  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC34\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRepository storage paths:  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC35\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e- default: \t/var/opt/gitlab/git-data/repositories  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC36\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab Shell path:\t\t/opt/gitlab/embedded/service/gitlab-shell  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC37\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGit:\t\t/opt/gitlab/embedded/bin/git  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;106:1-106:12\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-impact\&quot; class=\&quot;anchor\&quot; href=\&quot;#impact\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eImpact\u003c/h4\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;108:1-108:13\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-impact-1\&quot; class=\&quot;anchor\&quot; href=\&quot;#impact-1\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eImpact\u003c/h5\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;110:1-112:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;110:1-110:126\&quot;\u003eAny page with the malicious comment won&#39;t work normally anymore (it doesnt load). You can ruin issues, wikis, merges, etc\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;111:1-112:0\&quot;\u003eBecause of the rendering attempt the CPU usage increases dramatically, which is quite serious for companies that run Gitlab on cloud provider&#39;s server.\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;113:1-113:14\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-attachments\&quot; class=\&quot;anchor\&quot; href=\&quot;#attachments\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eAttachments\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;115:1-115:77\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;115:1-115:12\&quot;\u003eWarning:\u003c/strong\u003e Attachments received through HackerOne, please exercise caution!\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;117:1-118:119\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;117:1-117:93\&quot;\u003e\u003ca data-sourcepos=\&quot;117:3-117:93\&quot; href=\&quot;https://h1.sec.gitlab.net/a/499bf92d-e058-4f40-b25c-1038f6cd34ce/payload.txt\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003epayload.txt\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;118:1-118:119\&quot;\u003e\u003ca data-sourcepos=\&quot;118:3-118:119\&quot; href=\&quot;https://h1.sec.gitlab.net/a/f9ffab21-d1ab-43ca-b055-b7c99e4e4d15/kazam_w8usv25x.movie.mp4\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ekazam_w8usv25x.movie.mp4\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;**[HackerOne report #1305431](https://hackerone.com/reports/1305431)** by `scaramouche31` on 2021-08-14, assigned to @ankelly:\n\n[Report](#report) | [Attachments](#attachments)\n\n## Report\n\nHello, Gitlab Team! Today I stumbled upon this report: https://hackerone.com/reports/470067. I immediately tried to reproduce this behaviour using the Gitlab Kroki library and... it just works.\n\n#####  Summary  \nA low privileged attacker can exploit Kroki library to DoS any section with comments (Issues, Merge requests, Milestones, Snippets, Wiki pages, Markdown documents inside repositories, Epics)\n\n#####  Steps to reproduce\n\n1. Enable Kroki in your Gitlab build.   \nOn the top bar, select Menu \u003e Admin.  \nGo to Settings \u003e General.  \nExpand the Kroki section.  \nSelect Enable Kroki checkbox.  \nEnter the Kroki URL. It may be a Kroki server on https://kroki.io, but I used my own in a docker container, just run\n\n```docker run -d --name kroki -p 8030:8000 yuzutech/kroki```\n\nand then specify http://127.0.0.1:8030 (dont forget to add 127.0.0.1 to the whitelist)\n\n2. Create a new project, then create an issue in it.  \n3. Insert this payload in the comments section: ![payload.txt](https://h1.sec.gitlab.net/a/499bf92d-e058-4f40-b25c-1038f6cd34ce/payload.txt).  \n4. Reload the page.  \nDoS!\n\nPoC video:  \n![kazam_w8usv25x.movie.mp4](https://h1.sec.gitlab.net/a/f9ffab21-d1ab-43ca-b055-b7c99e4e4d15/kazam_w8usv25x.movie.mp4)\n\n#####  Fix\n\nThe fix should be something like as for the Mermaid and Math in .com edition:  \n```  \n if (  \n          !WHITELISTED_PAGES.includes(pageName) \u0026\u0026  \n          ((source \u0026\u0026 source.length \u003e MAX_CHAR_LIMIT) ||  \n            renderedChars \u003e MAX_CHAR_LIMIT ||  \n            renderedMermaidBlocks \u003e= MAX_MERMAID_BLOCK_LIMIT ||  \n            shouldLazyLoadMermaidBlock(source))  \n        ) { raise a warning and dont render }  \n```  \nhttps://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/behaviors/markdown/render_mermaid.js  \nhttps://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/behaviors/markdown/render_math.js\n\nBut the problem is about every lib that Kroki supports: Bytefield, Ditaa, PlantUML, the one I used, and so on, the full list is here:  \nhttps://docs.gitlab.com/ee/administration/integration/kroki.html\n\n#####  Output of checks\n\nThis bug happens on the local Gitlab version.\n\n#####  P.s.  \nThis bug doesnt fall under Timeout limits, because the DoS is caused using only 1 comment:\n\nSize/Length limits (e.g. not able to add more than 2MB per Redis entry) - the payload weights only 0.1 Mb  \nCount limits (e.g. not more than X comments per issue) - you need only 1 comment  \nCall/time limits (e.g. User can only do 1000 API calls per 10 minutes) - you dont need any API calls  \nComplexity limits (e.g. 1000 calls to endpoint X compared to 1000 calls to endpoint Y can be totally different) - you need only 1 call to the comment create endpoint  \nMax result limit (e.g. Only return max 1000 results and say refine your search) - you dont need to search for anything\n\n######  Results of GitLab environment info\n\n```  \nscara@scara:~$ sudo gitlab-rake gitlab:env:info\n\nSystem information  \nSystem:\t\tUbuntu 20.04  \nProxy:\t\tno  \nCurrent User:\tgit  \nUsing RVM:\tno  \nRuby Version:\t2.7.2p137  \nGem Version:\t3.1.4  \nBundler Version:2.1.4  \nRake Version:\t13.0.3  \nRedis Version:\t6.0.14  \nGit Version:\t2.32.0  \nSidekiq Version:5.2.9  \nGo Version:\tunknown\n\nGitLab information  \nVersion:\t14.1.2-ee  \nRevision:\t0bf9b154ab4  \nDirectory:\t/opt/gitlab/embedded/service/gitlab-rails  \nDB Adapter:\tPostgreSQL  \nDB Version:\t12.6  \nURL:\t\thttp://gitlab.local  \nHTTP Clone URL:\thttp://gitlab.local/some-group/some-project.git  \nSSH Clone URL:\tgit@gitlab.local:some-group/some-project.git  \nElasticsearch:\tno  \nGeo:\t\tno  \nUsing LDAP:\tno  \nUsing Omniauth:\tyes  \nOmniauth Providers: \n\nGitLab Shell  \nVersion:\t13.19.1  \nRepository storage paths:  \n- default: \t/var/opt/gitlab/git-data/repositories  \nGitLab Shell path:\t\t/opt/gitlab/embedded/service/gitlab-shell  \nGit:\t\t/opt/gitlab/embedded/bin/git  \n```\n\n####  Impact\n\n#####  Impact\n\n1. Any page with the malicious comment won&#39;t work normally anymore (it doesnt load). You can ruin issues, wikis, merges, etc  \n2. Because of the rendering attempt the CPU usage increases dramatically, which is quite serious for companies that run Gitlab on cloud provider&#39;s server.\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [payload.txt](https://h1.sec.gitlab.net/a/499bf92d-e058-4f40-b25c-1038f6cd34ce/payload.txt)\n* [kazam_w8usv25x.movie.mp4](https://h1.sec.gitlab.net/a/f9ffab21-d1ab-43ca-b055-b7c99e4e4d15/kazam_w8usv25x.movie.mp4)&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;gitlab-org/gitlab&quot;,&quot;iid&quot;:338721,&quot;issuableId&quot;:92135914,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:2741139,&quot;authorName&quot;:&quot;GitLab SecurityBot&quot;,&quot;authorUsername&quot;:&quot;gitlab-securitybot&quot;,&quot;authorWebUrl&quot;:&quot;/gitlab-securitybot&quot;,&quot;createdAt&quot;:&quot;2021-08-17T16:47:59+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;publishedIncidentUrl&quot;:null,&quot;slaFeatureAvailable&quot;:&quot;false&quot;,&quot;uploadMetricsFeatureAvailable&quot;:&quot;false&quot;,&quot;projectId&quot;:278964,&quot;projectPath&quot;:&quot;gitlab&quot;,&quot;projectNamespace&quot;:&quot;gitlab-org&quot;,&quot;updatedAt&quot;:&quot;2021-08-17T16:48:29+00:00&quot;,&quot;updatedBy&quot;:{&quot;name&quot;:&quot;Andrew Kelly&quot;,&quot;path&quot;:&quot;/ankelly&quot;},&quot;canAdmin&quot;:false,&quot;hasIssueWeightsFeature&quot;:true,&quot;hasIterationsFeature&quot;:true,&quot;canAdminRelation&quot;:false}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">1 comment DoS exploiting Kroki lib</h1>
</div>
<div class="description">
<div class="md"><p data-sourcepos="1:1-1:126" dir="auto"><strong data-sourcepos="1:1-1:70"><a data-sourcepos="1:3-1:68" href="https://hackerone.com/reports/1305431" rel="nofollow noreferrer noopener" target="_blank">HackerOne report #1305431</a></strong> by <code data-sourcepos="1:76-1:88">scaramouche31</code> on 2021-08-14, assigned to <a href="/ankelly" data-reference-type="user" data-user="4226366" data-container="body" data-placement="top" class="gfm gfm-project_member js-user-link" title="Andrew Kelly">@ankelly</a>:</p>&#x000A;<p data-sourcepos="3:1-3:47" dir="auto"><a data-sourcepos="3:1-3:17" href="#report">Report</a> | <a data-sourcepos="3:21-3:47" href="#attachments">Attachments</a></p>&#x000A;<h2 data-sourcepos="5:1-5:9" dir="auto">&#x000A;<a id="user-content-report" class="anchor" href="#report" aria-hidden="true"></a>Report</h2>&#x000A;<p data-sourcepos="7:1-7:193" dir="auto">Hello, Gitlab Team! Today I stumbled upon this report: <a href="https://hackerone.com/reports/470067" rel="nofollow noreferrer noopener" target="_blank">https://hackerone.com/reports/470067</a>. I immediately tried to reproduce this behaviour using the Gitlab Kroki library and... it just works.</p>&#x000A;<h5 data-sourcepos="9:1-9:16" dir="auto">&#x000A;<a id="user-content-summary" class="anchor" href="#summary" aria-hidden="true"></a>Summary</h5>&#x000A;<p data-sourcepos="10:1-10:190" dir="auto">A low privileged attacker can exploit Kroki library to DoS any section with comments (Issues, Merge requests, Milestones, Snippets, Wiki pages, Markdown documents inside repositories, Epics)</p>&#x000A;<h5 data-sourcepos="12:1-12:25" dir="auto">&#x000A;<a id="user-content-steps-to-reproduce" class="anchor" href="#steps-to-reproduce" aria-hidden="true"></a>Steps to reproduce</h5>&#x000A;<ol data-sourcepos="14:1-20:0" dir="auto">&#x000A;<li data-sourcepos="14:1-20:0">Enable Kroki in your Gitlab build.<br data-sourcepos="14:41-14:41">&#x000A;On the top bar, select Menu &gt; Admin.<br data-sourcepos="15:42-15:42">&#x000A;Go to Settings &gt; General.<br data-sourcepos="16:31-16:31">&#x000A;Expand the Kroki section.<br data-sourcepos="17:31-17:31">&#x000A;Select Enable Kroki checkbox.<br data-sourcepos="18:35-18:35">&#x000A;Enter the Kroki URL. It may be a Kroki server on <a href="https://kroki.io" rel="nofollow noreferrer noopener" target="_blank">https://kroki.io</a>, but I used my own in a docker container, just run</li>&#x000A;</ol>&#x000A;<p data-sourcepos="21:1-21:60" dir="auto"><code data-sourcepos="21:4-21:57">docker run -d --name kroki -p 8030:8000 yuzutech/kroki</code></p>&#x000A;<p data-sourcepos="23:1-23:86" dir="auto">and then specify <a href="http://127.0.0.1:8030" rel="nofollow noreferrer noopener" target="_blank">http://127.0.0.1:8030</a> (dont forget to add 127.0.0.1 to the whitelist)</p>&#x000A;<ol data-sourcepos="25:1-29:0" start="2" dir="auto">&#x000A;<li data-sourcepos="25:1-25:54">Create a new project, then create an issue in it.</li>&#x000A;<li data-sourcepos="26:1-26:143">Insert this payload in the comments section: <a class="no-attachment-icon" href="https://user-content.gitlab-static.net/348cf25344942c6aadfcb608bf26c2d38db92314/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34393962663932642d653035382d346634302d623235632d3130333866366364333463652f7061796c6f61642e747874" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/499bf92d-e058-4f40-b25c-1038f6cd34ce/payload.txt"><img data-sourcepos="26:49-26:140" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="payload.txt" data-canonical-src="https://h1.sec.gitlab.net/a/499bf92d-e058-4f40-b25c-1038f6cd34ce/payload.txt" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/348cf25344942c6aadfcb608bf26c2d38db92314/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34393962663932642d653035382d346634302d623235632d3130333866366364333463652f7061796c6f61642e747874"></a>.</li>&#x000A;<li data-sourcepos="27:1-29:0">Reload the page.<br data-sourcepos="27:22-27:22">&#x000A;DoS!</li>&#x000A;</ol>&#x000A;<p data-sourcepos="30:1-31:118" dir="auto">PoC video:<br data-sourcepos="30:13-30:13">&#x000A;<span class="media-container video-container"><video src="https://user-content.gitlab-static.net/28cc1f104f6ffc7f05280628f799a9f8cee0f027/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f66396666616232312d643161622d343363612d623035352d6237633939653465346431352f6b617a616d5f77387573763235782e6d6f7669652e6d7034" controls="true" data-setup="{}" data-title="kazam_w8usv25x.movie.mp4" preload="metadata" width="400" data-canonical-src="https://h1.sec.gitlab.net/a/f9ffab21-d1ab-43ca-b055-b7c99e4e4d15/kazam_w8usv25x.movie.mp4"></video><a href="https://user-content.gitlab-static.net/28cc1f104f6ffc7f05280628f799a9f8cee0f027/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f66396666616232312d643161622d343363612d623035352d6237633939653465346431352f6b617a616d5f77387573763235782e6d6f7669652e6d7034" target="_blank" rel="nofollow noreferrer noopener" title="Download 'kazam_w8usv25x.movie.mp4'" data-canonical-src="https://h1.sec.gitlab.net/a/f9ffab21-d1ab-43ca-b055-b7c99e4e4d15/kazam_w8usv25x.movie.mp4">kazam_w8usv25x.movie.mp4</a></span></p>&#x000A;<h5 data-sourcepos="33:1-33:10" dir="auto">&#x000A;<a id="user-content-fix" class="anchor" href="#fix" aria-hidden="true"></a>Fix</h5>&#x000A;<p data-sourcepos="35:1-35:79" dir="auto">The fix should be something like as for the Mermaid and Math in .com edition:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="36:1-44:5" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext"> if (  </span>&#x000A;<span id="LC2" class="line" lang="plaintext">          !WHITELISTED_PAGES.includes(pageName) &amp;&amp;  </span>&#x000A;<span id="LC3" class="line" lang="plaintext">          ((source &amp;&amp; source.length &gt; MAX_CHAR_LIMIT) ||  </span>&#x000A;<span id="LC4" class="line" lang="plaintext">            renderedChars &gt; MAX_CHAR_LIMIT ||  </span>&#x000A;<span id="LC5" class="line" lang="plaintext">            renderedMermaidBlocks &gt;= MAX_MERMAID_BLOCK_LIMIT ||  </span>&#x000A;<span id="LC6" class="line" lang="plaintext">            shouldLazyLoadMermaidBlock(source))  </span>&#x000A;<span id="LC7" class="line" lang="plaintext">        ) { raise a warning and dont render }  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="45:1-46:107" dir="auto"><a href="https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/behaviors/markdown/render_mermaid.js">https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/behaviors/markdown/render_mermaid.js</a><br data-sourcepos="45:113-45:113">&#x000A;<a href="https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/behaviors/markdown/render_math.js">https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/behaviors/markdown/render_math.js</a></p>&#x000A;<p data-sourcepos="48:1-49:64" dir="auto">But the problem is about every lib that Kroki supports: Bytefield, Ditaa, PlantUML, the one I used, and so on, the full list is here:<br data-sourcepos="48:136-48:136">&#x000A;<a href="https://docs.gitlab.com/ee/administration/integration/kroki.html" rel="nofollow noreferrer noopener" target="_blank">https://docs.gitlab.com/ee/administration/integration/kroki.html</a></p>&#x000A;<h5 data-sourcepos="51:1-51:23" dir="auto">&#x000A;<a id="user-content-output-of-checks" class="anchor" href="#output-of-checks" aria-hidden="true"></a>Output of checks</h5>&#x000A;<p data-sourcepos="53:1-53:45" dir="auto">This bug happens on the local Gitlab version.</p>&#x000A;<h5 data-sourcepos="55:1-55:13" dir="auto">&#x000A;<a id="user-content-ps" class="anchor" href="#ps" aria-hidden="true"></a>P.s.</h5>&#x000A;<p data-sourcepos="56:1-56:90" dir="auto">This bug doesnt fall under Timeout limits, because the DoS is caused using only 1 comment:</p>&#x000A;<p data-sourcepos="58:1-62:118" dir="auto">Size/Length limits (e.g. not able to add more than 2MB per Redis entry) - the payload weights only 0.1 Mb<br data-sourcepos="58:108-58:108">&#x000A;Count limits (e.g. not more than X comments per issue) - you need only 1 comment<br data-sourcepos="59:83-59:83">&#x000A;Call/time limits (e.g. User can only do 1000 API calls per 10 minutes) - you dont need any API calls<br data-sourcepos="60:103-60:103">&#x000A;Complexity limits (e.g. 1000 calls to endpoint X compared to 1000 calls to endpoint Y can be totally different) - you need only 1 call to the comment create endpoint<br data-sourcepos="61:168-61:168">&#x000A;Max result limit (e.g. Only return max 1000 results and say refine your search) - you dont need to search for anything</p>&#x000A;<h6 data-sourcepos="64:1-64:42" dir="auto">&#x000A;<a id="user-content-results-of-gitlab-environment-info" class="anchor" href="#results-of-gitlab-environment-info" aria-hidden="true"></a>Results of GitLab environment info</h6>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="66:1-104:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">scara@scara:~$ sudo gitlab-rake gitlab:env:info</span>&#x000A;<span id="LC2" class="line" lang="plaintext"></span>&#x000A;<span id="LC3" class="line" lang="plaintext">System information  </span>&#x000A;<span id="LC4" class="line" lang="plaintext">System:		Ubuntu 20.04  </span>&#x000A;<span id="LC5" class="line" lang="plaintext">Proxy:		no  </span>&#x000A;<span id="LC6" class="line" lang="plaintext">Current User:	git  </span>&#x000A;<span id="LC7" class="line" lang="plaintext">Using RVM:	no  </span>&#x000A;<span id="LC8" class="line" lang="plaintext">Ruby Version:	2.7.2p137  </span>&#x000A;<span id="LC9" class="line" lang="plaintext">Gem Version:	3.1.4  </span>&#x000A;<span id="LC10" class="line" lang="plaintext">Bundler Version:2.1.4  </span>&#x000A;<span id="LC11" class="line" lang="plaintext">Rake Version:	13.0.3  </span>&#x000A;<span id="LC12" class="line" lang="plaintext">Redis Version:	6.0.14  </span>&#x000A;<span id="LC13" class="line" lang="plaintext">Git Version:	2.32.0  </span>&#x000A;<span id="LC14" class="line" lang="plaintext">Sidekiq Version:5.2.9  </span>&#x000A;<span id="LC15" class="line" lang="plaintext">Go Version:	unknown</span>&#x000A;<span id="LC16" class="line" lang="plaintext"></span>&#x000A;<span id="LC17" class="line" lang="plaintext">GitLab information  </span>&#x000A;<span id="LC18" class="line" lang="plaintext">Version:	14.1.2-ee  </span>&#x000A;<span id="LC19" class="line" lang="plaintext">Revision:	0bf9b154ab4  </span>&#x000A;<span id="LC20" class="line" lang="plaintext">Directory:	/opt/gitlab/embedded/service/gitlab-rails  </span>&#x000A;<span id="LC21" class="line" lang="plaintext">DB Adapter:	PostgreSQL  </span>&#x000A;<span id="LC22" class="line" lang="plaintext">DB Version:	12.6  </span>&#x000A;<span id="LC23" class="line" lang="plaintext">URL:		http://gitlab.local  </span>&#x000A;<span id="LC24" class="line" lang="plaintext">HTTP Clone URL:	http://gitlab.local/some-group/some-project.git  </span>&#x000A;<span id="LC25" class="line" lang="plaintext">SSH Clone URL:	git@gitlab.local:some-group/some-project.git  </span>&#x000A;<span id="LC26" class="line" lang="plaintext">Elasticsearch:	no  </span>&#x000A;<span id="LC27" class="line" lang="plaintext">Geo:		no  </span>&#x000A;<span id="LC28" class="line" lang="plaintext">Using LDAP:	no  </span>&#x000A;<span id="LC29" class="line" lang="plaintext">Using Omniauth:	yes  </span>&#x000A;<span id="LC30" class="line" lang="plaintext">Omniauth Providers: </span>&#x000A;<span id="LC31" class="line" lang="plaintext"></span>&#x000A;<span id="LC32" class="line" lang="plaintext">GitLab Shell  </span>&#x000A;<span id="LC33" class="line" lang="plaintext">Version:	13.19.1  </span>&#x000A;<span id="LC34" class="line" lang="plaintext">Repository storage paths:  </span>&#x000A;<span id="LC35" class="line" lang="plaintext">- default: 	/var/opt/gitlab/git-data/repositories  </span>&#x000A;<span id="LC36" class="line" lang="plaintext">GitLab Shell path:		/opt/gitlab/embedded/service/gitlab-shell  </span>&#x000A;<span id="LC37" class="line" lang="plaintext">Git:		/opt/gitlab/embedded/bin/git  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h4 data-sourcepos="106:1-106:12" dir="auto">&#x000A;<a id="user-content-impact" class="anchor" href="#impact" aria-hidden="true"></a>Impact</h4>&#x000A;<h5 data-sourcepos="108:1-108:13" dir="auto">&#x000A;<a id="user-content-impact-1" class="anchor" href="#impact-1" aria-hidden="true"></a>Impact</h5>&#x000A;<ol data-sourcepos="110:1-112:0" dir="auto">&#x000A;<li data-sourcepos="110:1-110:126">Any page with the malicious comment won't work normally anymore (it doesnt load). You can ruin issues, wikis, merges, etc</li>&#x000A;<li data-sourcepos="111:1-112:0">Because of the rendering attempt the CPU usage increases dramatically, which is quite serious for companies that run Gitlab on cloud provider's server.</li>&#x000A;</ol>&#x000A;<h2 data-sourcepos="113:1-113:14" dir="auto">&#x000A;<a id="user-content-attachments" class="anchor" href="#attachments" aria-hidden="true"></a>Attachments</h2>&#x000A;<p data-sourcepos="115:1-115:77" dir="auto"><strong data-sourcepos="115:1-115:12">Warning:</strong> Attachments received through HackerOne, please exercise caution!</p>&#x000A;<ul data-sourcepos="117:1-118:119" dir="auto">&#x000A;<li data-sourcepos="117:1-117:93"><a data-sourcepos="117:3-117:93" href="https://h1.sec.gitlab.net/a/499bf92d-e058-4f40-b25c-1038f6cd34ce/payload.txt" rel="nofollow noreferrer noopener" target="_blank">payload.txt</a></li>&#x000A;<li data-sourcepos="118:1-118:119"><a data-sourcepos="118:3-118:119" href="https://h1.sec.gitlab.net/a/f9ffab21-d1ab-43ca-b055-b7c99e4e4d15/kazam_w8usv25x.movie.mp4" rel="nofollow noreferrer noopener" target="_blank">kazam_w8usv25x.movie.mp4</a></li>&#x000A;</ul></div>
</div>
<div class="edited-text gl-mt-4 gl-text-subtle gl-text-sm">Edited <time class="js-timeago issue-edited-ago js-issue-edited-ago" title="Aug 17, 2021 4:48pm" datetime="2021-08-17T16:48:29Z" data-toggle="tooltip" data-placement="bottom" data-container="body">Aug 17, 2021</time> by <a class="author-link hover:gl-underline gl-text-subtle js-user-link" data-user-id="4226366" data-username="ankelly" data-name="Andrew Kelly" href="/ankelly"><span class="">Andrew Kelly</span></a></div>
</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/278964/issues/338721/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="js-design-management" data-issue-iid="338721" data-issue-path="/gitlab-org/gitlab/-/issues/338721" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-project-path="gitlab-org/gitlab" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div class="js-work-item-links-root" data-full-path="gitlab-org/gitlab" data-issuable-id="92135914" data-issuable-iid="338721" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/gitlab-org/gitlab/-/issues/338721/links" data-full-path="gitlab-org/gitlab" data-has-issue-weights-feature="true" data-has-iterations-feature="true" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="true" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="false" data-iid="338721" data-project-path="gitlab-org/gitlab" id="js-related-merge-requests"></div>
<div data-url="/gitlab-org/gitlab/-/issues/338721/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:92135914,&quot;iid&quot;:338721,&quot;description&quot;:&quot;**[HackerOne report #1305431](https://hackerone.com/reports/1305431)** by `scaramouche31` on 2021-08-14, assigned to @ankelly:\n\n[Report](#report) | [Attachments](#attachments)\n\n## Report\n\nHello, Gitlab Team! Today I stumbled upon this report: https://hackerone.com/reports/470067. I immediately tried to reproduce this behaviour using the Gitlab Kroki library and... it just works.\n\n#####  Summary  \nA low privileged attacker can exploit Kroki library to DoS any section with comments (Issues, Merge requests, Milestones, Snippets, Wiki pages, Markdown documents inside repositories, Epics)\n\n#####  Steps to reproduce\n\n1. Enable Kroki in your Gitlab build.   \nOn the top bar, select Menu \u003e Admin.  \nGo to Settings \u003e General.  \nExpand the Kroki section.  \nSelect Enable Kroki checkbox.  \nEnter the Kroki URL. It may be a Kroki server on https://kroki.io, but I used my own in a docker container, just run\n\n```docker run -d --name kroki -p 8030:8000 yuzutech/kroki```\n\nand then specify http://127.0.0.1:8030 (dont forget to add 127.0.0.1 to the whitelist)\n\n2. Create a new project, then create an issue in it.  \n3. Insert this payload in the comments section: ![payload.txt](https://h1.sec.gitlab.net/a/499bf92d-e058-4f40-b25c-1038f6cd34ce/payload.txt).  \n4. Reload the page.  \nDoS!\n\nPoC video:  \n![kazam_w8usv25x.movie.mp4](https://h1.sec.gitlab.net/a/f9ffab21-d1ab-43ca-b055-b7c99e4e4d15/kazam_w8usv25x.movie.mp4)\n\n#####  Fix\n\nThe fix should be something like as for the Mermaid and Math in .com edition:  \n```  \n if (  \n          !WHITELISTED_PAGES.includes(pageName) \u0026\u0026  \n          ((source \u0026\u0026 source.length \u003e MAX_CHAR_LIMIT) ||  \n            renderedChars \u003e MAX_CHAR_LIMIT ||  \n            renderedMermaidBlocks \u003e= MAX_MERMAID_BLOCK_LIMIT ||  \n            shouldLazyLoadMermaidBlock(source))  \n        ) { raise a warning and dont render }  \n```  \nhttps://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/behaviors/markdown/render_mermaid.js  \nhttps://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/behaviors/markdown/render_math.js\n\nBut the problem is about every lib that Kroki supports: Bytefield, Ditaa, PlantUML, the one I used, and so on, the full list is here:  \nhttps://docs.gitlab.com/ee/administration/integration/kroki.html\n\n#####  Output of checks\n\nThis bug happens on the local Gitlab version.\n\n#####  P.s.  \nThis bug doesnt fall under Timeout limits, because the DoS is caused using only 1 comment:\n\nSize/Length limits (e.g. not able to add more than 2MB per Redis entry) - the payload weights only 0.1 Mb  \nCount limits (e.g. not more than X comments per issue) - you need only 1 comment  \nCall/time limits (e.g. User can only do 1000 API calls per 10 minutes) - you dont need any API calls  \nComplexity limits (e.g. 1000 calls to endpoint X compared to 1000 calls to endpoint Y can be totally different) - you need only 1 call to the comment create endpoint  \nMax result limit (e.g. Only return max 1000 results and say refine your search) - you dont need to search for anything\n\n######  Results of GitLab environment info\n\n```  \nscara@scara:~$ sudo gitlab-rake gitlab:env:info\n\nSystem information  \nSystem:\t\tUbuntu 20.04  \nProxy:\t\tno  \nCurrent User:\tgit  \nUsing RVM:\tno  \nRuby Version:\t2.7.2p137  \nGem Version:\t3.1.4  \nBundler Version:2.1.4  \nRake Version:\t13.0.3  \nRedis Version:\t6.0.14  \nGit Version:\t2.32.0  \nSidekiq Version:5.2.9  \nGo Version:\tunknown\n\nGitLab information  \nVersion:\t14.1.2-ee  \nRevision:\t0bf9b154ab4  \nDirectory:\t/opt/gitlab/embedded/service/gitlab-rails  \nDB Adapter:\tPostgreSQL  \nDB Version:\t12.6  \nURL:\t\thttp://gitlab.local  \nHTTP Clone URL:\thttp://gitlab.local/some-group/some-project.git  \nSSH Clone URL:\tgit@gitlab.local:some-group/some-project.git  \nElasticsearch:\tno  \nGeo:\t\tno  \nUsing LDAP:\tno  \nUsing Omniauth:\tyes  \nOmniauth Providers: \n\nGitLab Shell  \nVersion:\t13.19.1  \nRepository storage paths:  \n- default: \t/var/opt/gitlab/git-data/repositories  \nGitLab Shell path:\t\t/opt/gitlab/embedded/service/gitlab-shell  \nGit:\t\t/opt/gitlab/embedded/bin/git  \n```\n\n####  Impact\n\n#####  Impact\n\n1. Any page with the malicious comment won&#39;t work normally anymore (it doesnt load). You can ruin issues, wikis, merges, etc  \n2. Because of the rendering attempt the CPU usage increases dramatically, which is quite serious for companies that run Gitlab on cloud provider&#39;s server.\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [payload.txt](https://h1.sec.gitlab.net/a/499bf92d-e058-4f40-b25c-1038f6cd34ce/payload.txt)\n* [kazam_w8usv25x.movie.mp4](https://h1.sec.gitlab.net/a/f9ffab21-d1ab-43ca-b055-b7c99e4e4d15/kazam_w8usv25x.movie.mp4)&quot;,&quot;title&quot;:&quot;1 comment DoS exploiting Kroki lib&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:2204140,&quot;updated_by_id&quot;:4159863,&quot;created_at&quot;:&quot;2021-08-17T16:47:59Z&quot;,&quot;updated_at&quot;:&quot;2024-09-04T17:21:56Z&quot;,&quot;milestone&quot;:{&quot;id&quot;:2204140,&quot;iid&quot;:71,&quot;group_id&quot;:9970,&quot;title&quot;:&quot;14.9&quot;,&quot;description&quot;:&quot;&quot;,&quot;state&quot;:&quot;closed&quot;,&quot;created_at&quot;:&quot;2021-08-26T19:11:46.841Z&quot;,&quot;updated_at&quot;:&quot;2023-07-18T12:52:39.975Z&quot;,&quot;due_date&quot;:&quot;2022-03-17&quot;,&quot;start_date&quot;:&quot;2022-02-18&quot;,&quot;expired&quot;:true,&quot;web_url&quot;:&quot;https://gitlab.com/groups/gitlab-org/-/milestones/71&quot;},&quot;labels&quot;:[{&quot;id&quot;:36540920,&quot;title&quot;:&quot;Category:Markdown&quot;,&quot;color&quot;:&quot;#6699cc&quot;,&quot;description&quot;:&quot;Work related to markdown.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2024-08-30T20:34:06.202Z&quot;,&quot;updated_at&quot;:&quot;2024-08-30T20:34:06.202Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:17006635,&quot;title&quot;:&quot;Weakness::CWE-400&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Denial of Service&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-11-09T22:14:41.441Z&quot;,&quot;updated_at&quot;:&quot;2020-11-09T22:14:41.441Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2677574,&quot;title&quot;:&quot;auto updated&quot;,&quot;color&quot;:&quot;#FFECDB&quot;,&quot;description&quot;:&quot;Issues that have been updated in accordance with our issue triage policies (https://gitlab.com/gitlab-org/gitlab-ce/blob/master/doc/development/contributing/issue_workflow.md)&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2017-09-19T02:09:18.221Z&quot;,&quot;updated_at&quot;:&quot;2019-05-02T11:05:59.557Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:23635421,&quot;title&quot;:&quot;availability::limit&quot;,&quot;color&quot;:&quot;#eee600&quot;,&quot;description&quot;:&quot; GitLab, like most large applications, enforces limits within certain features. The absences of limits can impact security, performance, and availability. For this reason issues related to limits are considered as another category of ~\&quot;type::bug\&quot;. https://about.gitlab.com/handbook/engineering/quality/issue-triage/#limit-related-bugs &quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2022-02-02T17:10:26.326Z&quot;,&quot;updated_at&quot;:&quot;2022-02-02T17:10:26.326Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3103451,&quot;title&quot;:&quot;devops::plan&quot;,&quot;color&quot;:&quot;#E44D2A&quot;,&quot;description&quot;:&quot;Issues for the Plan stage of the DevOps lifecycle (e.g. Project Management, Agile Portfolio Management, Requirements Management)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-12-01T19:00:23.723Z&quot;,&quot;updated_at&quot;:&quot;2022-05-11T06:40:37.661Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3412464,&quot;title&quot;:&quot;frontend&quot;,&quot;color&quot;:&quot;#3cb371&quot;,&quot;description&quot;:&quot;Issues for the Frontend team. Covers everything related to the way GitLab behaves (and, to an extent, looks) inside your browser.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-30T21:42:37.900Z&quot;,&quot;updated_at&quot;:&quot;2022-05-13T09:23:38.237Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:10690691,&quot;title&quot;:&quot;group::project management&quot;,&quot;color&quot;:&quot;#A8D695&quot;,&quot;description&quot;:&quot;Issues belonging to the Project Management group of the Plan stage of the DevOps lifecycle. See https://about.gitlab.com/handbook/product/categories/#team-planning-group | PM: @gweaver&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2019-05-22T19:55:45.218Z&quot;,&quot;updated_at&quot;:&quot;2020-08-28T15:40:02.313Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107676,&quot;title&quot;:&quot;markdown(deprecated)&quot;,&quot;color&quot;:&quot;#428bca&quot;,&quot;description&quot;:&quot;Use Category::Markdown instead&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:04:10.170Z&quot;,&quot;updated_at&quot;:&quot;2024-09-05T13:01:09.543Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857529,&quot;title&quot;:&quot;priority::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;We want to address this but may have other higher priority items. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:02:52.659Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:23:53.318Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918378,&quot;title&quot;:&quot;section::dev&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Issues related to the Dev section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;updated_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:21977643,&quot;title&quot;:&quot;security-backlog::review-complete&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Signifies that this security-backlog issue has been reviewed by an Appsec team member&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-10-04T18:05:29.766Z&quot;,&quot;updated_at&quot;:&quot;2021-10-04T18:06:23.334Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713901,&quot;title&quot;:&quot;severity::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;Major - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:22.464Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:27.359Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:11838120,&quot;title&quot;:&quot;workflow::production&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Merge request has been deployed to GitLab.com&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2019-08-21T12:05:06.918Z&quot;,&quot;updated_at&quot;:&quot;2019-08-22T12:18:15.680Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}],&quot;lock_version&quot;:2,&quot;author_id&quot;:2741139,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[{&quot;id&quot;:4545397,&quot;username&quot;:&quot;cngo&quot;,&quot;name&quot;:&quot;Coung Ngo&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://gitlab.com/uploads/-/system/user/avatar/4545397/avatar.png&quot;,&quot;web_url&quot;:&quot;https://gitlab.com/cngo&quot;}],&quot;due_date&quot;:&quot;2021-11-15&quot;,&quot;project_id&quot;:278964,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/gitlab-org/gitlab/-/issues/338721&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/gitlab-org/gitlab/notes?target_id=92135914\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=338721\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;,&quot;weight&quot;:null,&quot;blocked&quot;:false,&quot;blocked_by_issues&quot;:[]}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:92135914,&quot;projectId&quot;:278964,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/gitlab-org/gitlab/-/issues/338721/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/gitlab-org/gitlab/-/issues/338721.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/gitlab-org/gitlab/-/issues/338721.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/gitlab-org/gitlab/noteable/issue/92135914/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736096609000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-border-0" type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/gitlab-org/gitlab/-/issues/338721.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="200">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>
<div class="block epic" data-testid="sidebar-epic">
<div class="js-sidebar-epic-widget-root" data-can-edit="false" data-group-path="gitlab-org" data-issue-id="92135914" data-issue-iid="338721" data-project-path="gitlab-org/gitlab"></div>
</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="true" data-can-edit="" data-iid="338721" data-issuable-type="issue" data-labels-fetch-path="/gitlab-org/gitlab/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/gitlab-org/gitlab/-/labels" data-project-issues-path="/gitlab-org/gitlab/-/issues" data-project-path="gitlab-org/gitlab" data-selected-labels="[{&quot;id&quot;:36540920,&quot;title&quot;:&quot;Category:Markdown&quot;,&quot;color&quot;:&quot;#6699cc&quot;,&quot;description&quot;:&quot;Work related to markdown.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2024-08-30T20:34:06.202Z&quot;,&quot;updated_at&quot;:&quot;2024-08-30T20:34:06.202Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:17006635,&quot;title&quot;:&quot;Weakness::CWE-400&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Denial of Service&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-11-09T22:14:41.441Z&quot;,&quot;updated_at&quot;:&quot;2020-11-09T22:14:41.441Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2677574,&quot;title&quot;:&quot;auto updated&quot;,&quot;color&quot;:&quot;#FFECDB&quot;,&quot;description&quot;:&quot;Issues that have been updated in accordance with our issue triage policies (https://gitlab.com/gitlab-org/gitlab-ce/blob/master/doc/development/contributing/issue_workflow.md)&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2017-09-19T02:09:18.221Z&quot;,&quot;updated_at&quot;:&quot;2019-05-02T11:05:59.557Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:23635421,&quot;title&quot;:&quot;availability::limit&quot;,&quot;color&quot;:&quot;#eee600&quot;,&quot;description&quot;:&quot; GitLab, like most large applications, enforces limits within certain features. The absences of limits can impact security, performance, and availability. For this reason issues related to limits are considered as another category of ~\&quot;type::bug\&quot;. https://about.gitlab.com/handbook/engineering/quality/issue-triage/#limit-related-bugs &quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2022-02-02T17:10:26.326Z&quot;,&quot;updated_at&quot;:&quot;2022-02-02T17:10:26.326Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3103451,&quot;title&quot;:&quot;devops::plan&quot;,&quot;color&quot;:&quot;#E44D2A&quot;,&quot;description&quot;:&quot;Issues for the Plan stage of the DevOps lifecycle (e.g. Project Management, Agile Portfolio Management, Requirements Management)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-12-01T19:00:23.723Z&quot;,&quot;updated_at&quot;:&quot;2022-05-11T06:40:37.661Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3412464,&quot;title&quot;:&quot;frontend&quot;,&quot;color&quot;:&quot;#3cb371&quot;,&quot;description&quot;:&quot;Issues for the Frontend team. Covers everything related to the way GitLab behaves (and, to an extent, looks) inside your browser.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-30T21:42:37.900Z&quot;,&quot;updated_at&quot;:&quot;2022-05-13T09:23:38.237Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:10690691,&quot;title&quot;:&quot;group::project management&quot;,&quot;color&quot;:&quot;#A8D695&quot;,&quot;description&quot;:&quot;Issues belonging to the Project Management group of the Plan stage of the DevOps lifecycle. See https://about.gitlab.com/handbook/product/categories/#team-planning-group | PM: @gweaver&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2019-05-22T19:55:45.218Z&quot;,&quot;updated_at&quot;:&quot;2020-08-28T15:40:02.313Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107676,&quot;title&quot;:&quot;markdown(deprecated)&quot;,&quot;color&quot;:&quot;#428bca&quot;,&quot;description&quot;:&quot;Use Category::Markdown instead&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:04:10.170Z&quot;,&quot;updated_at&quot;:&quot;2024-09-05T13:01:09.543Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857529,&quot;title&quot;:&quot;priority::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;We want to address this but may have other higher priority items. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:02:52.659Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:23:53.318Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918378,&quot;title&quot;:&quot;section::dev&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Issues related to the Dev section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;updated_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:21977643,&quot;title&quot;:&quot;security-backlog::review-complete&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Signifies that this security-backlog issue has been reviewed by an Appsec team member&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-10-04T18:05:29.766Z&quot;,&quot;updated_at&quot;:&quot;2021-10-04T18:06:23.334Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713901,&quot;title&quot;:&quot;severity::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;Major - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:22.464Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:27.359Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:11838120,&quot;title&quot;:&quot;workflow::production&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Merge request has been deployed to GitLab.com&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2019-08-21T12:05:06.918Z&quot;,&quot;updated_at&quot;:&quot;2019-08-22T12:18:15.680Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="338721" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="block" data-testid="iteration-container"><div class="js-sidebar-iteration-widget-root" data-can-edit="" data-group-path="gitlab-org" data-issue-id="92135914" data-issue-iid="338721" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="js-sidebar-weight-widget-root" data-can-edit="" data-issue-iid="338721" data-project-path="gitlab-org/gitlab"></div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<div class="js-sidebar-health-status-widget-root" data-can-edit="" data-full-path="gitlab-org/gitlab" data-iid="338721" data-issuable-type="issue"></div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="block">
<div class="hide-collapsed gl-flex gl-items-center gl-font-bold gl-leading-20 gl-text-default">
Confidentiality
</div>
<div class="hide-collapsed gl-text-subtle">
Confidentiality controls have moved to the issue actions menu (<svg class="s12 gl-align-middle" data-testid="ellipsis_v-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#ellipsis_v"></use></svg>) at the top of the page.
</div>
</div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/gitlab-org/gitlab/-/issues/338721.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/gitlab-org/gitlab/-/issues/338721/toggle_subscription","moveIssueEndpoint":"/gitlab-org/gitlab/-/issues/338721/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=278964","editable":"","currentUser":{},"rootPath":"/","fullPath":"gitlab-org/gitlab","iid":338721,"id":92135914,"severity":"unknown","timeTrackingLimitToHours":true,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false","weightOptions":["None","Any",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"weightNoneValue":"None","multipleApprovalRulesAvailable":null}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script nonce="YujjprKJfn8Uu2VzrcA6HA==">
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script nonce="YujjprKJfn8Uu2VzrcA6HA==">
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

