- **Root cause of vulnerability**: The SANDRA Kernel Driver does not validate data received from the `IRP->SystemBuffer`. Specifically, it directly passes user-controlled parameters (physical address and size) to the `MmMapIoSpace` function, which maps physical memory into system memory.
- **Weaknesses/vulnerabilities present**:
    - **Insufficient input validation**: The driver does not validate the physical address and size provided by the user through the `IRP->SystemBuffer`.
    - **Direct Memory Mapping**:  The driver uses the unvalidated user-supplied data to map physical memory into the system's address space using `MmMapIoSpace`, without proper checks.
- **Impact of exploitation**:
    - **Privilege Escalation**: A low-privileged user can gain NT System privileges by mapping arbitrary physical memory and using it to locate and modify an elevated process token, effectively taking over the system.
- **Attack vectors**:
    - **IOCTL call**:  The vulnerability is triggered via a specific IOCTL code (0x22a428).
- **Required attacker capabilities/position**:
    - **Low-privileged user**: Any user on the system can exploit this vulnerability.
    - **Ability to send IOCTL**: The attacker needs to be able to interact with the vulnerable kernel driver by sending it a specific IOCTL.