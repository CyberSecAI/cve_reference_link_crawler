```
{
  "cve": "CVE-2021-4417",
  "description": "The Forminator – Contact Form, Payment Form & Custom Form Builder plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 1.13.4. This is due to missing or incorrect nonce validation on the listen_for_saving_export_schedule() function. This makes it possible for unauthenticated attackers to export form submissions via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.",
  "affected_software": {
    "name": "Forminator – Contact Form, Payment Form & Custom Form Builder",
    "version": "<= 1.13.4"
  },
  "vulnerability_details": {
    "root_cause": "The plugin fails to properly validate nonces in the listen_for_saving_export_schedule() function.",
    "weaknesses": [
      "Cross-Site Request Forgery (CSRF)",
      "Improper nonce validation"
    ],
      "impact": "An unauthenticated attacker can export form submissions via a forged request.",
        "attack_vector": "An attacker can craft a malicious link or form that, when clicked or submitted by an authenticated administrator, triggers the export functionality. This can be achieved through social engineering.",
        "required_capabilities": "The attacker needs to trick a logged-in administrator to interact with the malicious crafted link or form to trigger the export action."
  },
  "patch_details": {
    "remediation": "Update to version 1.13.5, or a newer patched version",
    "changes": "The fix involves changing the nonce check from `if ( isset( $_POST['_forminator_nonce'] ) && ! wp_verify_nonce( $_POST['_forminator_nonce'], 'forminator_export' ) )` to `if ( ! isset( $_POST['_forminator_nonce'] ) || ! wp_verify_nonce( $_POST['_forminator_nonce'], 'forminator_export' ) )`. This ensures that the nonce is always checked, regardless of whether it is set or not."
  },
    "additional_notes": "The provided blog posts describe multiple CSRF vulnerabilities across different WordPress plugins, all stemming from similar issues in nonce validation. The core issue is that in many instances, the nonce check is only performed if a specific POST parameter is set. When these parameters are not set, the nonce check is skipped, thus allowing for CSRF attacks."
}
```