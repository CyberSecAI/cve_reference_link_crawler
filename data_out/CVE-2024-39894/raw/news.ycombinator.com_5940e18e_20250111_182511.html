<html lang="en" op="item"><head><meta name="referrer" content="origin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" type="text/css" href="news.css?Brdi972UYWdRcVgheWmW">
        <link rel="icon" href="y18.svg">
    <link rel="canonical" href="https://news.ycombinator.com/item?id=41508530"/>            <title>OpenSSH Keystroke Obfuscation Bypass | Hacker News</title></head><body><center><table id="hnmain" border="0" cellpadding="0" cellspacing="0" width="85%" bgcolor="#f6f6ef">
        <tr><td bgcolor="#ff6600"><table border="0" cellpadding="0" cellspacing="0" width="100%" style="padding:2px"><tr><td style="width:18px;padding-right:4px"><a href="https://news.ycombinator.com"><img src="y18.svg" width="18" height="18" style="border:1px white solid; display:block"></a></td>
                  <td style="line-height:12pt; height:10px;"><span class="pagetop"><b class="hnname"><a href="news">Hacker News</a></b>
                            <a href="newest">new</a> | <a href="front">past</a> | <a href="newcomments">comments</a> | <a href="ask">ask</a> | <a href="show">show</a> | <a href="jobs">jobs</a> | <a href="submit" rel="nofollow">submit</a>            </span></td><td style="text-align:right;padding-right:4px;"><span class="pagetop">
                              <a href="login?goto=item%3Fid%3D41508530">login</a>
                          </span></td>
              </tr></table></td></tr>
<tr id="pagespace" title="OpenSSH Keystroke Obfuscation Bypass" style="height:10px"></tr><tr><td><table class="fatitem" border="0">
        <tr class='athing submission' id='41508530'>
      <td align="right" valign="top" class="title"><span class="rank"></span></td>      <td valign="top" class="votelinks"><center><a id='up_41508530' href='vote?id=41508530&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center></td><td class="title"><span class="titleline"><a href="https://crzphil.github.io/posts/ssh-obfuscation-bypass/">OpenSSH Keystroke Obfuscation Bypass</a><span class="sitebit comhead"> (<a href="from?site=crzphil.github.io"><span class="sitestr">crzphil.github.io</span></a>)</span></span></td></tr><tr><td colspan="2"></td><td class="subtext"><span class="subline">
          <span class="score" id="score_41508530">200 points</span> by <a href="user?id=pabs3" class="hnuser">pabs3</a> <span class="age" title="2024-09-11T06:19:52 1726035592"><a href="item?id=41508530">4 months ago</a></span> <span id="unv_41508530"></span> | <a href="hide?id=41508530&amp;goto=item%3Fid%3D41508530">hide</a> | <a href="https://hn.algolia.com/?query=OpenSSH%20Keystroke%20Obfuscation%20Bypass&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0" class="hnpast">past</a> | <a href="fave?id=41508530&amp;auth=38bbee41cc541769def503d336195e27a8680566">favorite</a> | <a href="item?id=41508530">25&nbsp;comments</a>        </span>
              </td></tr>
        </table><br><br><table border="0" class='comment-tree'>
            <tr class='athing comtr' id='41513691'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_41513691' href='vote?id=41513691&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=qhwudbebd" class="hnuser">qhwudbebd</a> <span class="age" title="2024-09-11T17:53:16 1726077196"><a href="item?id=41513691">4 months ago</a></span> <span id="unv_41513691"></span>          <span class='navs'>
             | <a href="#41515521" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41513691" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">This was present in versions 9.5 - 9.7 of OpenSSH and fixed in 9.8p1 released at the beginning of July. Philippos (along with others) is credited for reporting it in the release notes:<p><pre><code>  https:&#x2F;&#x2F;www.openssh.com&#x2F;releasenotes.html#9.8p1</code></pre></div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='41516594'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_41516594' href='vote?id=41516594&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=palisade" class="hnuser">palisade</a> <span class="age" title="2024-09-12T00:44:01 1726101841"><a href="item?id=41516594">4 months ago</a></span> <span id="unv_41516594"></span>          <span class='navs'>
             | <a href="#41513691" class="clicky" aria-hidden="true">parent</a> | <a href="#41515521" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41516594" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Worth noting too, that other linux systems using 8.9, e.g. ubuntu are 8.9p1 and have the patch applied but to an older version so they&#x27;re also safe. Just in case anyone was worried about that.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='41518691'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_41518691' href='vote?id=41518691&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=0x0" class="hnuser">0x0</a> <span class="age" title="2024-09-12T08:21:30 1726129290"><a href="item?id=41518691">4 months ago</a></span> <span id="unv_41518691"></span>          <span class='navs'>
             | <a href="#41513691" class="clicky" aria-hidden="true">root</a> | <a href="#41516594" class="clicky" aria-hidden="true">parent</a> | <a href="#41515521" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41518691" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">I&#x27;d be very surprised if ubuntu has backported the keystroke obfuscation feature (which was introduced in 9.5) to 8.9.<p>When the feature is missing, you&#x27;re not safe from keystroke interception at all, which is what this bug is all about, so any 8.9 version would be actually considered &quot;unsafe&quot; until the whole feature is backported, which seems unlikely to happen?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                        <tr class='athing comtr' id='41515521'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_41515521' href='vote?id=41515521&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=jonmon6691" class="hnuser">jonmon6691</a> <span class="age" title="2024-09-11T21:32:14 1726090334"><a href="item?id=41515521">4 months ago</a></span> <span id="unv_41515521"></span>          <span class='navs'>
             | <a href="#41513691" class="clicky" aria-hidden="true">prev</a> | <a href="#41515320" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41515521" n="4" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Most people would consider streaming music to be a negligible amount of bandwidth. Seems to me like SSH in a &quot;high security mode&quot; could just send X Kbps of bi-directional pad at a layer directly above encryption but below application. Then just use that channel for all the normal SSH traffic. You could either treat this as a bandwidth limited channel or do some slow time-constant ramping up and down at the risk of leaking information about file downloads or large command outputs.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='41516522'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_41516522' href='vote?id=41516522&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=advael" class="hnuser">advael</a> <span class="age" title="2024-09-12T00:29:04 1726100944"><a href="item?id=41516522">4 months ago</a></span> <span id="unv_41516522"></span>          <span class='navs'>
             | <a href="#41515521" class="clicky" aria-hidden="true">parent</a> | <a href="#41524538" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41516522" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">This seems like a reasonable solution to me, and I often stream music through my ssh sessions via port forwards so I may well already be getting the benefit in some places</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='41524538'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_41524538' href='vote?id=41524538&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=mrngm" class="hnuser">mrngm</a> <span class="age" title="2024-09-12T19:24:42 1726169082"><a href="item?id=41524538">4 months ago</a></span> <span id="unv_41524538"></span>          <span class='navs'>
             | <a href="#41515521" class="clicky" aria-hidden="true">parent</a> | <a href="#41516522" class="clicky" aria-hidden="true">prev</a> | <a href="#41515320" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41524538" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">This and a similar suggestion in another thread may sound nice and easy, &quot;just add a constant stream of noise&quot;, but it assumes you can generate enough constant noise <i>and</i> be able to intersperse the noise with valid commands without being able to distinguish these events. The problem is not necessarily that you want to hide (to a network adversary) that you&#x27;ve been typing. It&#x27;s that you do not want to reveal, through some side-channel, what the exact <i>contents</i> were.<p>On the openssh-unix-dev mailing list, someone recently pointed out[0] that just periodically (without jitter) sending out packets may be problematic due to subtle differences in clock timing. Aside, they also link to a presentation[1] [PDF] that shows influence of temperature on clock skew (especially page 18) and that this gives a possibility for fingerprinting.<p>Then there&#x27;s the challenge of keeping SSH interactive enough that people do not experience too much input lag while typing. What if the user typed a character, but due to such a timing side-channel preventive measure, that character needs to be sent in the next packet, adding latency to the user experience? Surely it improves security, but it may add too much frustration for regular usage.<p>[0] <a href="https:&#x2F;&#x2F;marc.info&#x2F;?l=openssh-unix-dev&amp;m=169402700622936&amp;w=2" rel="nofollow">https:&#x2F;&#x2F;marc.info&#x2F;?l=openssh-unix-dev&amp;m=169402700622936&amp;w=2</a>
[1] <a href="https:&#x2F;&#x2F;murdoch.is&#x2F;talks&#x2F;ccs06hotornot.pdf" rel="nofollow">https:&#x2F;&#x2F;murdoch.is&#x2F;talks&#x2F;ccs06hotornot.pdf</a> ([2006] Hot or Not: Revealing hidden services by their clock skew, see also <a href="https:&#x2F;&#x2F;doi.org&#x2F;10.1145&#x2F;1180405.1180410" rel="nofollow">https:&#x2F;&#x2F;doi.org&#x2F;10.1145&#x2F;1180405.1180410</a> and an HN thread from 2014: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=7694612">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=7694612</a>)</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='41532576'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_41532576' href='vote?id=41532576&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=jonmon6691" class="hnuser">jonmon6691</a> <span class="age" title="2024-09-13T16:14:36 1726244076"><a href="item?id=41532576">4 months ago</a></span> <span id="unv_41532576"></span>          <span class='navs'>
             | <a href="#41515521" class="clicky" aria-hidden="true">root</a> | <a href="#41524538" class="clicky" aria-hidden="true">parent</a> | <a href="#41515320" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41532576" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">But I don&#x27;t think the conversation here is about anonymity, its about side channels to discover the actual content of the SSH session. The OP is looking at determining the command typed based on keystroke timing. The attacks you link would work for any traffic that could be intercepted, SSH or otherwise, and they wouldn&#x27;t give any info about the content of the stream.<p>If we&#x27;re just focused on removing all traces of keystroke timing from the channel, then I think a decoupled SSH transport layer which is providing say 1kB of zero-pad every 20ms to the the shell to fill up, along with a FIFO to spread that out, and maybe some logic to ramp up and down the channel bandwidth based on queue length, you would go a long way to mitigating this specific attack.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                        <tr class='athing comtr' id='41515320'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_41515320' href='vote?id=41515320&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=mrguyorama" class="hnuser">mrguyorama</a> <span class="age" title="2024-09-11T21:04:30 1726088670"><a href="item?id=41515320">4 months ago</a></span> <span id="unv_41515320"></span>          <span class='navs'>
             | <a href="#41515521" class="clicky" aria-hidden="true">prev</a> | <a href="#41511976" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41515320" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Regardless of what the &quot;cause&quot; of this is (ie bug or bad design), it&#x27;s obvious nobody even took a look at this after it was coded up and merged in. The larger packets and double server ACKs are very clearly obviously giving the game away. This feature just doesn&#x27;t even come close to what it supposedly does, was it even shipped as a feature or something that wasn&#x27;t yet done?<p>Not exactly encouraging, to see a system so integral to security seemingly shipping code without even a minor test of intended function.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='41515362'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_41515362' href='vote?id=41515362&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=tedunangst" class="hnuser">tedunangst</a> <span class="age" title="2024-09-11T21:10:53 1726089053"><a href="item?id=41515362">4 months ago</a></span> <span id="unv_41515362"></span>          <span class='navs'>
             | <a href="#41515320" class="clicky" aria-hidden="true">parent</a> | <a href="#41511976" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41515362" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">I think it&#x27;s worth asking how important the feature is in the grand scheme of things. But what about the CIA timing my keystrokes is more of a nerd forum thing than an actual attack vector you read about in intrusion post mortems.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='41518321'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_41518321' href='vote?id=41518321&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=talkin" class="hnuser">talkin</a> <span class="age" title="2024-09-12T07:17:54 1726125474"><a href="item?id=41518321">4 months ago</a></span> <span id="unv_41518321"></span>          <span class='navs'>
             | <a href="#41515320" class="clicky" aria-hidden="true">root</a> | <a href="#41515362" class="clicky" aria-hidden="true">parent</a> | <a href="#41511976" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41518321" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Well, or it is important, and then you add the countermeasures. These countermeasures are quite easy to mess up, so doing the validation (on an ongoing basis!) MUST be part of the deal.<p>Or if you think it’s not important enough to do those assertions in CI, then it might be better to just reject the obfuscation attempts.<p>There’s no middleground: doing the implementation without checks, means you added complexity, you dont know if security improved (or worsened!), and the the release note might come down to a false sense of security.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                        <tr class='athing comtr' id='41511976'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_41511976' href='vote?id=41511976&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=thadt" class="hnuser">thadt</a> <span class="age" title="2024-09-11T14:55:59 1726066559"><a href="item?id=41511976">4 months ago</a></span> <span id="unv_41511976"></span>          <span class='navs'>
             | <a href="#41515320" class="clicky" aria-hidden="true">prev</a> | <a href="#41512075" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41511976" n="6" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Good work. But - this is an implementation bug right? If the underlying stream of packets gives you a distinguisher (in this case, slightly larger packets), then this attack works. So adjusting the chaff and payload packet sizes to some fixed capacity restores obfuscation, if I&#x27;m understanding this correctly. And response packets - those also have to be managed to prevent leakage.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='41512061'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_41512061' href='vote?id=41512061&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=KyleSanderson" class="hnuser">KyleSanderson</a> <span class="age" title="2024-09-11T15:05:56 1726067156"><a href="item?id=41512061">4 months ago</a></span> <span id="unv_41512061"></span>          <span class='navs'>
             | <a href="#41511976" class="clicky" aria-hidden="true">parent</a> | <a href="#41512075" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41512061" n="5" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">The implementation is just wrong from what&#x27;s been presented. basic jitter (20-100ms), and a dynamic payload size are what&#x27;s actually missing here. The question now becomes though how interactive should your session be. Timing the connection latency might help to an extent, but this is about mitm and you don&#x27;t necessarily know where your adversary is (first hop, or towards the end). Batching keystrokes would also help here.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='41513339'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_41513339' href='vote?id=41513339&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=tialaramex" class="hnuser">tialaramex</a> <span class="age" title="2024-09-11T17:09:59 1726074599"><a href="item?id=41513339">4 months ago</a></span> <span id="unv_41513339"></span>          <span class='navs'>
             | <a href="#41511976" class="clicky" aria-hidden="true">root</a> | <a href="#41512061" class="clicky" aria-hidden="true">parent</a> | <a href="#41512075" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41513339" n="4" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Basically there are two &quot;modes&quot; in normal mode OpenSSH is content to idle with no packets moving except any requested keepalives. In &quot;chaff mode&quot; currently they try to send a chaff packet every time they can to disguise your keypresses, but they forgot keystrokes will just get bundled into the existing chaff packet, growing it, so it stands out as special.<p>All they need to do is retain the &quot;chaff mode&quot; but when they have a keystroke ready to be sent they should suppress the chaff that would otherwise go in the same packet.<p>No need for &quot;basic jitter&quot; or &quot;dynamic payload size&quot; that I can see, with this change the packets are indistinguishable in terms of size or (encrypted) content, and they have no more or less jitter than would be normal for the network they&#x27;re traversing.<p>[Various small edits to clarify]</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='41516028'><td><table border='0'>  <tr>    <td class='ind' indent='3'><img src="s.gif" height="1" width="120"></td><td valign="top" class="votelinks">
      <center><a id='up_41516028' href='vote?id=41516028&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=aidenn0" class="hnuser">aidenn0</a> <span class="age" title="2024-09-11T22:59:40 1726095580"><a href="item?id=41516028">4 months ago</a></span> <span id="unv_41516028"></span>          <span class='navs'>
             | <a href="#41511976" class="clicky" aria-hidden="true">root</a> | <a href="#41513339" class="clicky" aria-hidden="true">parent</a> | <a href="#41512075" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41516028" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">They will also need to increase the minimum size of a non-chaff keystroke to be the size of the largest keystroke that they wish to keep confidential; 3 bytes is a minimum for the basic control characters (e.g. arrow keys which are ESC &#x27;[&#x27; X where X depends on the arrow direction).<p>I did find it interesting that the return keystroke was of a differing size to other characters; on unix systems it should just send a ^J.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='41517652'><td><table border='0'>  <tr>    <td class='ind' indent='4'><img src="s.gif" height="1" width="160"></td><td valign="top" class="votelinks">
      <center><a id='up_41517652' href='vote?id=41517652&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=ec109685" class="hnuser">ec109685</a> <span class="age" title="2024-09-12T04:38:05 1726115885"><a href="item?id=41517652">4 months ago</a></span> <span id="unv_41517652"></span>          <span class='navs'>
             | <a href="#41511976" class="clicky" aria-hidden="true">root</a> | <a href="#41516028" class="clicky" aria-hidden="true">parent</a> | <a href="#41512075" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41517652" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Can’t they just send large control characters as three separate key presses?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='41523334'><td><table border='0'>  <tr>    <td class='ind' indent='5'><img src="s.gif" height="1" width="200"></td><td valign="top" class="votelinks">
      <center><a id='up_41523334' href='vote?id=41523334&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=aidenn0" class="hnuser">aidenn0</a> <span class="age" title="2024-09-12T17:34:30 1726162470"><a href="item?id=41523334">4 months ago</a></span> <span id="unv_41523334"></span>          <span class='navs'>
             | <a href="#41511976" class="clicky" aria-hidden="true">root</a> | <a href="#41517652" class="clicky" aria-hidden="true">parent</a> | <a href="#41512075" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41523334" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">That will confuse screen&#x2F;tmux which needs to distinguish between escape codes and a press of the escape key.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                                          <tr class='athing comtr' id='41512075'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_41512075' href='vote?id=41512075&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=SoftTalker" class="hnuser">SoftTalker</a> <span class="age" title="2024-09-11T15:07:37 1726067257"><a href="item?id=41512075">4 months ago</a></span> <span id="unv_41512075"></span>          <span class='navs'>
             | <a href="#41511976" class="clicky" aria-hidden="true">prev</a> | <a href="#41514343" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41512075" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">I&#x27;m not an expert in this area at all but I recall reading that trying to hide a signal in random noise doesn&#x27;t really work, as you can still find the signal with statistical analysis or looking for distingishing characteristics that are not obscured. That was my first thought when I read about this new feature in OpenSSH, and it seems to have proven correct.<p>Edit: wanted to add that I recognize that the people working on OpenSSH know a lot more about this than I do, and I had assumed they wouldn&#x27;t bother implementing this if it wasn&#x27;t a good idea, so willing to accept that &quot;proven correct&quot; may be an overstatement or even flat-out wrong.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='41520381'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_41520381' href='vote?id=41520381&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=6502nerdface" class="hnuser">6502nerdface</a> <span class="age" title="2024-09-12T12:58:45 1726145925"><a href="item?id=41520381">4 months ago</a></span> <span id="unv_41520381"></span>          <span class='navs'>
             | <a href="#41512075" class="clicky" aria-hidden="true">parent</a> | <a href="#41512281" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41520381" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">&gt; trying to hide a signal in random noise doesn&#x27;t really work<p>Actually it works perfectly and it&#x27;s called a one-time pad!</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='41512281'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_41512281' href='vote?id=41512281&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=milliams" class="hnuser">milliams</a> <span class="age" title="2024-09-11T15:27:10 1726068430"><a href="item?id=41512281">4 months ago</a></span> <span id="unv_41512281"></span>          <span class='navs'>
             | <a href="#41512075" class="clicky" aria-hidden="true">parent</a> | <a href="#41520381" class="clicky" aria-hidden="true">prev</a> | <a href="#41514343" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41512281" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">The advantage that OpenSSH have here is that they don&#x27;t have to just hide the signal using noise, they can actually change the signal to look like the noise (or vice versa). For example they are making the signal packets some at a regular interval (since the &quot;signal&quot; being discussed is the timings). That alone would not hide the number of keypresses, but adding the chaff should do so.<p>In this case, as said above, it seems like there&#x27;s an implementation issue with actually doing those obfuscations, allowing the signal to be identified.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='41514343'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_41514343' href='vote?id=41514343&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=hi-v-rocknroll" class="hnuser">hi-v-rocknroll</a> <span class="age" title="2024-09-11T19:04:31 1726081471"><a href="item?id=41514343">4 months ago</a></span> <span id="unv_41514343"></span>          <span class='navs'>
             | <a href="#41512075" class="clicky" aria-hidden="true">prev</a> | <a href="#41513768" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41514343" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Perhaps instead shooting off individual keypresses with some random chaff packets, it would be wiser to have constant interval, constant low data rate, (say 8 KBps) data rate trickling packets through and let the other side throw away pick out the needles from the haystack of no ops. Good luck finding a side-channel in that.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='41515689'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_41515689' href='vote?id=41515689&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=pshc" class="hnuser">pshc</a> <span class="age" title="2024-09-11T21:58:55 1726091935"><a href="item?id=41515689">4 months ago</a></span> <span id="unv_41515689"></span>          <span class='navs'>
             | <a href="#41514343" class="clicky" aria-hidden="true">parent</a> | <a href="#41513768" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41515689" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Sounds good until (for example) you find out the SSH client library wasn&#x27;t queueing up packets ahead of time, but instead building them at send time, and a chaff packet takes less time to build than a real packet... so many ways to get side-channeled.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='41518315'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_41518315' href='vote?id=41518315&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=bubblesnort" class="hnuser">bubblesnort</a> <span class="age" title="2024-09-12T07:16:44 1726125404"><a href="item?id=41518315">4 months ago</a></span> <span id="unv_41518315"></span>          <span class='navs'>
             | <a href="#41514343" class="clicky" aria-hidden="true">root</a> | <a href="#41515689" class="clicky" aria-hidden="true">parent</a> | <a href="#41513768" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41518315" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c5A">Crypto requires a good source of random entropy. I suppose if you want more traffic for obscurity, you&#x27;ll also have to find more random bits. Without enough entropy, you&#x27;d sacrifice security for obscurity. Just my ¢2, ymmv, etc</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                        <tr class='athing comtr' id='41513768'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_41513768' href='vote?id=41513768&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=keyboardcaper" class="hnuser">keyboardcaper</a> <span class="age" title="2024-09-11T18:02:16 1726077736"><a href="item?id=41513768">4 months ago</a></span> <span id="unv_41513768"></span>          <span class='navs'>
             | <a href="#41514343" class="clicky" aria-hidden="true">prev</a> | <a href="#41513965" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="41513768" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c5A">There is a market for keyboards which obscure keypress timings.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='41513965'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_41513965' href='vote?id=41513965&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=gunapologist99" class="hnuser">gunapologist99</a> <span class="age" title="2024-09-11T18:24:06 1726079046"><a href="item?id=41513965">4 months ago</a></span> <span id="unv_41513965"></span>          <span class='navs'>
             | <a href="#41513768" class="clicky" aria-hidden="true">prev</a> <a class="togg clicky" id="41513965" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Yet another reason to switch to SSH keys instead of passwords wherever possible. Simple and bulletproof, with a minimum of footguns.<p>EDIT: @tedunangst is right, wouldn&#x27;t have helped. Even so, switch to keys!</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='41514036'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_41514036' href='vote?id=41514036&amp;how=up&amp;goto=item%3Fid%3D41508530'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=tedunangst" class="hnuser">tedunangst</a> <span class="age" title="2024-09-11T18:32:45 1726079565"><a href="item?id=41514036">4 months ago</a></span> <span id="unv_41514036"></span>          <span class='navs'>
             | <a href="#41513965" class="clicky" aria-hidden="true">parent</a> <a class="togg clicky" id="41514036" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Does nothing here.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                            </table>
  <br><br>
</td></tr>
<tr><td><img src="s.gif" height="10" width="0"><table width="100%" cellspacing="0" cellpadding="1"><tr><td bgcolor="#ff6600"></td></tr></table><br>
<center><span class="yclinks"><a href="newsguidelines.html">Guidelines</a> | <a href="newsfaq.html">FAQ</a> | <a href="lists">Lists</a> | <a href="https://github.com/HackerNews/API">API</a> | <a href="security.html">Security</a> | <a href="https://www.ycombinator.com/legal/">Legal</a> | <a href="https://www.ycombinator.com/apply/">Apply to YC</a> | <a href="mailto:hn@ycombinator.com">Contact</a></span><br><br>
<form method="get" action="//hn.algolia.com/">Search: <input type="text" name="q" size="17" autocorrect="off" spellcheck="false" autocapitalize="off" autocomplete="off"></form></center></td></tr>      </table></center></body>
      <script type='text/javascript' src='hn.js?Brdi972UYWdRcVgheWmW'></script>
  </html>
