=== Content from lists.mindrot.org_a05f68a2_20250111_182510.html ===

# [openssh-unix-announce] Announce: OpenSSH 9.8 released

**Damien Miller**
djm at cvs.openbsd.org

*Mon Jul 1 18:10:04 AEST 2024*

* **Messages sorted by:**
  [[ date ]](date.html#158)
  [[ thread ]](thread.html#158)
  [[ subject ]](subject.html#158)
  [[ author ]](author.html#158)

---

```
OpenSSH 9.8 has just been released. It will be available from the
mirrors listed at <https://www.openssh.com/> shortly.

OpenSSH is a 100% complete SSH protocol 2.0 implementation and
includes sftp client and server support.

Once again, we would like to thank the OpenSSH community for their
continued support of the project, especially those who contributed
code or patches, reported bugs, tested snapshots or donated to the
project. More information on donations may be found at:
<https://www.openssh.com/donations.html>

Security
========

This release contains fixes for two security problems, one critical
and one minor.

1) Race condition in sshd(8)

A critical vulnerability in sshd(8) was present in Portable OpenSSH
versions 8.5p1 and 9.7p1 (inclusive) that may allow arbitrary code
execution with root privileges.

Successful exploitation has been demonstrated on 32-bit Linux/glibc
systems with ASLR. Under lab conditions, the attack requires on
average 6-8 hours of continuous connections up to the maximum the
server will accept. Exploitation on 64-bit systems is believed to be
possible but has not been demonstrated at this time. It's likely that
these attacks will be improved upon.

Exploitation on non-glibc systems is conceivable but has not been
examined. Systems that lack ASLR or users of downstream Linux
distributions that have modified OpenSSH to disable per-connection
ASLR re-randomisation (yes - this is a thing, no - we don't
understand why) may potentially have an easier path to exploitation.
OpenBSD is not vulnerable.

We thank the Qualys Security Advisory Team for discovering, reporting
and demonstrating exploitability of this problem, and for providing
detailed feedback on additional mitigation measures.

2) Logic error in ssh(1) ObscureKeystrokeTiming

In OpenSSH version 9.5 through 9.7 (inclusive), when connected to an
OpenSSH server version 9.5 or later, a logic error in the ssh(1)
ObscureKeystrokeTiming feature (on by default) rendered this feature
ineffective - a passive observer could still detect which network
packets contained real keystrokes when the countermeasure was active
because both fake and real keystroke packets were being sent
unconditionally.

This bug was found by Philippos Giavridis and also independently by
Jacky Wei En Kung, Daniel Hugenroth and Alastair Beresford of the
University of Cambridge Computer Lab.

Worse, the unconditional sending of both fake and real keystroke
packets broke another long-standing timing attack mitigation. Since
OpenSSH 2.9.9 sshd(8) has sent fake keystoke echo packets for
traffic received on TTYs in echo-off mode, such as when entering a
password into su(8) or sudo(8). This bug rendered these fake
keystroke echoes ineffective and could allow a passive observer of
a SSH session to once again detect when echo was off and obtain
fairly limited timing information about keystrokes in this situation
(20ms granularity by default).

This additional implication of the bug was identified by Jacky Wei
En Kung, Daniel Hugenroth and Alastair Beresford and we thank them
for their detailed analysis.

This bug does not affect connections when ObscureKeystrokeTiming
was disabled or sessions where no TTY was requested.

Future deprecation notice
=========================

OpenSSH plans to remove support for the DSA signature algorithm in
early 2025. This release disables DSA by default at compile time.

DSA, as specified in the SSHv2 protocol, is inherently weak - being
limited to a 160 bit private key and use of the SHA1 digest. Its
estimated security level is only 80 bits symmetric equivalent.

OpenSSH has disabled DSA keys by default since 2015 but has retained
run-time optional support for them. DSA was the only mandatory-to-
implement algorithm in the SSHv2 RFCs, mostly because alternative
algorithms were encumbered by patents when the SSHv2 protocol was
specified.

This has not been the case for decades at this point and better
algorithms are well supported by all actively-maintained SSH
implementations. We do not consider the costs of maintaining DSA
in OpenSSH to be justified and hope that removing it from OpenSSH
can accelerate its wider deprecation in supporting cryptography
libraries.

This release, and its deactivation of DSA by default at compile-time,
marks the second step in our timeline to finally deprecate DSA. The
final step of removing DSA support entirely is planned for the first
OpenSSH release of 2025.

DSA support may be re-enabled in OpenBSD by setting "DSAKEY=yes"
in Makefile.inc. To enable DSA support in portable OpenSSH, pass
the "--enable-dsa-keys" option to configure.

Potentially-incompatible changes
--------------------------------

 * all: as mentioned above, the DSA signature algorithm is now
   disabled at compile time.

 * sshd(8): the server will now block client addresses that
   repeatedly fail authentication, repeatedly connect without ever
   completing authentication or that crash the server. See the
   discussion of PerSourcePenalties below for more information.
   Operators of servers that accept connections from many users, or
   servers that accept connections from addresses behind NAT or
   proxies may need to consider these settings.

 * sshd(8): the server has been split into a listener binary, sshd(8),
   and a per-session binary "sshd-session". This allows for a much
   smaller listener binary, as it no longer needs to support the SSH
   protocol. As part of this work, support for disabling privilege
   separation (which previously required code changes to disable) and
   disabling re-execution of sshd(8) has been removed. Further
   separation of sshd-session into additional, minimal binaries is
   planned for the future.

 * sshd(8): several log messages have changed. In particular, some
   log messages will be tagged with as originating from a process
   named "sshd-session" rather than "sshd".

 * ssh-keyscan(1): this tool previously emitted comment lines
   containing the hostname and SSH protocol banner to standard error.
   This release now emits them to standard output, but adds a new
   "-q" flag to silence them altogether.

 * sshd(8): (portable OpenSSH only) sshd will no longer use argv[0]
   as the PAM service name. A new "PAMServiceName" sshd_config(5)
   directive allows selecting the service name at runtime. This
   defaults to "sshd". bz2101

 * (portable OpenSSH only) Automatically-generated files, such as
   configure, config.h.in, etc will now be checked in to the portable
   OpenSSH git release branch (e.g. V_9_8). This should ensure that
   the contents of the signed release branch exactly match the
   contents of the signed release tarball.

Changes since OpenSSH 9.7
=========================

This release contains mostly bugfixes.

New features
------------

 * sshd(8): as described above, sshd(8) will now penalise client
   addresses that, for various reasons, do not successfully complete
   authentication. This feature is controlled by a new sshd_config(5)
   PerSourcePenalties option and is on by default.

   sshd(8) will now identify situations where the session did not
   authenticate as expected. These conditions include when the client
   repeatedly attempted authentication unsucessfully (possibly
   indicating an attack against one or more accounts, e.g. password
   guessing), or when client behaviour caused sshd to crash (possibly
   indicating attempts to exploit bugs in sshd).

   When such a condition is observed, sshd will record a penalty of
   some duration (e.g. 30 seconds) against the client's address. If
   this time is above a minimum configurable threshold, then all
   connections from the client address will be refused (along with any
   others in the same PerSourceNetBlockSize CIDR range) until the
   penalty expire.

   Repeated offenses by the same client address will accrue greater
   penalties, up to a configurable maximum. Address ranges may be
   fully exempted from penalties, e.g. to guarantee access from a set
   of trusted management addresses, using the new sshd_config(5)
   PerSourcePenaltyExemptList option.

   We hope these options will make it significantly more difficult for
   attackers to find accounts with weak/guessable passwords or exploit
   bugs in sshd(8) itself. This option is enabled by default.

 * ssh(8): allow the HostkeyAlgorithms directive to disable the
   implicit fallback from certificate host key to plain host keys.

Bugfixes
--------

 * misc: fix a number of inaccuracies in the PROTOCOL.*
   documentation files. GHPR430 GHPR487

 * all: switch to strtonum(3) for more robust integer parsing in most
   places.

 * ssh(1), sshd(8): correctly restore sigprocmask around ppoll()

 * ssh-keysign(8): stricter validation of messaging socket fd GHPR492

 * sftp(1): flush stdout after writing "sftp>" prompt when not using
   editline. GHPR480

 * sftp-server(8): fix home-directory extension implementation, it
   previously always returned the current user's home directory
   contrary to the spec. GHPR477

 * ssh-keyscan(1): do not close stdin to prevent error messages when
   stdin is read multiple times. E.g.
   echo localhost | ssh-keyscan -f - -f -

 * regression tests: fix rekey test that was testing the same KEX
   algorithm repeatedly instead of testing all of them. bz3692

 * ssh_config(5), sshd_config(5): clarify the KEXAlgorithms directive
   documentation, especially around what is supported vs available.
   bz3701.

Portability
-----------

 * sshd(8): expose SSH_AUTH_INFO_0 always to PAM auth modules
   unconditionally. The previous behaviour was to expose it only when
   particular authentication methods were in use.

 * build: fix OpenSSL ED25519 support detection. An incorrect function
   signature in configure.ac previously prevented enabling the recently
   added support for ED25519 private keys in PEM PKCS8 format.

 * ssh(1), ssh-agent(8): allow the presence of the WAYLAND_DISPLAY
   environment variable to enable SSH_ASKPASS, similarly to the X11
   DISPLAY environment variable. GHPR479

 * build: improve detection of the -fzero-call-used-regs compiler
   flag. bz3673.

 * build: relax OpenSSL version check to accept all OpenSSL 3.x
   versions.

 * sshd(8): add support for notifying systemd on server listen and
   reload, using a standalone implementation that doesn't depend on
   libsystemd. bz2641

Checksums:
==========

 - SHA1 (openssh-9.8.tar.gz) = bc45cedae7f70b41e9922ef4c9f56e74b9a659b7
 - SHA256 (openssh-9.8.tar.gz) = Dnc69VLWFBFdiaz8wySPlvHjb7wZfh/kblQ8ISuQr1Y=

 - SHA1 (openssh-9.8p1.tar.gz) = a0bb501b11349f5c5c33a269351be091dc2c2727
 - SHA256 (openssh-9.8p1.tar.gz) = 3YvQAqN5tdSZ37BQ3R+pr4Ap6ARh9LtsUjxJlz9aOfM=

Please note that the SHA256 signatures are base64 encoded and not
hexadecimal (which is the default for most checksum tools). The PGP
key used to sign the releases is available from the mirror sites:
<https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/RELEASE_KEY.asc>

Reporting Bugs:
===============

- Please read <https://www.openssh.com/report.html>
  Security bugs should be reported directly to [openssh at openssh.com](https://lists.mindrot.org/mailman/listinfo/openssh-unix-announce)

```

---

* **Messages sorted by:**
  [[ date ]](date.html#158)
  [[ thread ]](thread.html#158)
  [[ subject ]](subject.html#158)
  [[ author ]](author.html#158)

---

[More information about the openssh-unix-announce
mailing list](https://lists.mindrot.org/mailman/listinfo/openssh-unix-announce)



=== Content from www.openssh.com_cc36382f_20250111_182512.html ===
OpenSSH 9.8 was released on 2024-07-01. It is available from the
mirrors listed at https://www.openssh.com/.
OpenSSH is a 100% complete SSH protocol 2.0 implementation and
includes sftp client and server support.
Once again, we would like to thank the OpenSSH community for their
continued support of the project, especially those who contributed
code or patches, reported bugs, tested snapshots or donated to the
project. More information on donations may be found at:
https://www.openssh.com/donations.html
Security
========
This release contains fixes for two security problems, one critical
and one minor.
1) Race condition in sshd(8)
A critical vulnerability in sshd(8) was present in Portable OpenSSH
versions between 8.5p1 and 9.7p1 (inclusive) that may allow arbitrary
code execution with root privileges.
Successful exploitation has been demonstrated on 32-bit Linux/glibc
systems with ASLR. Under lab conditions, the attack requires on
average 6-8 hours of continuous connections up to the maximum the
server will accept. Exploitation on 64-bit systems is believed to be
possible but has not been demonstrated at this time. It's likely that
these attacks will be improved upon.
Exploitation on non-glibc systems is conceivable but has not been
examined. Systems that lack ASLR or users of downstream Linux
distributions that have modified OpenSSH to disable per-connection
ASLR re-randomisation (yes - this is a thing, no - we don't
understand why) may potentially have an easier path to exploitation.
OpenBSD is not vulnerable.
We thank the Qualys Security Advisory Team for discovering, reporting
and demonstrating exploitability of this problem, and for providing
detailed feedback on additional mitigation measures.
2) Logic error in ssh(1) ObscureKeystrokeTiming
In OpenSSH version 9.5 through 9.7 (inclusive), when connected to an
OpenSSH server version 9.5 or later, a logic error in the ssh(1)
ObscureKeystrokeTiming feature (on by default) rendered this feature
ineffective - a passive observer could still detect which network
packets contained real keystrokes when the countermeasure was active
because both fake and real keystroke packets were being sent
unconditionally.
This bug was found by Philippos Giavridis and also independently by
Jacky Wei En Kung, Daniel Hugenroth and Alastair Beresford of the
University of Cambridge Computer Lab.
Worse, the unconditional sending of both fake and real keystroke
packets broke another long-standing timing attack mitigation. Since
OpenSSH 2.9.9 sshd(8) has sent fake keystoke echo packets for
traffic received on TTYs in echo-off mode, such as when entering a
password into su(8) or sudo(8). This bug rendered these fake
keystroke echoes ineffective and could allow a passive observer of
a SSH session to once again detect when echo was off and obtain
fairly limited timing information about keystrokes in this situation
(20ms granularity by default).
This additional implication of the bug was identified by Jacky Wei
En Kung, Daniel Hugenroth and Alastair Beresford and we thank them
for their detailed analysis.
This bug does not affect connections when ObscureKeystrokeTiming
was disabled or sessions where no TTY was requested.
Future deprecation notice
=========================
OpenSSH plans to remove support for the DSA signature algorithm in
early 2025. This release disables DSA by default at compile time.
DSA, as specified in the SSHv2 protocol, is inherently weak - being
limited to a 160 bit private key and use of the SHA1 digest. Its
estimated security level is only 80 bits symmetric equivalent.
OpenSSH has disabled DSA keys by default since 2015 but has retained
run-time optional support for them. DSA was the only mandatory-to-
implement algorithm in the SSHv2 RFCs, mostly because alternative
algorithms were encumbered by patents when the SSHv2 protocol was
specified.
This has not been the case for decades at this point and better
algorithms are well supported by all actively-maintained SSH
implementations. We do not consider the costs of maintaining DSA
in OpenSSH to be justified and hope that removing it from OpenSSH
can accelerate its wider deprecation in supporting cryptography
libraries.
This release, and its deactivation of DSA by default at compile-time,
marks the second step in our timeline to finally deprecate DSA. The
final step of removing DSA support entirely is planned for the first
OpenSSH release of 2025.
DSA support may be re-enabled in OpenBSD by setting "DSAKEY=yes"
in Makefile.inc. To enable DSA support in portable OpenSSH, pass
the "--enable-dsa-keys" option to configure.
Potentially-incompatible changes
--------------------------------
\* all: as mentioned above, the DSA signature algorithm is now
disabled at compile time.
\* sshd(8): the server will now block client addresses that
repeatedly fail authentication, repeatedly connect without ever
completing authentication or that crash the server. See the
discussion of PerSourcePenalties below for more information.
Operators of servers that accept connections from many users, or
servers that accept connections from addresses behind NAT or
proxies may need to consider these settings.
\* sshd(8): the server has been split into a listener binary, sshd(8),
and a per-session binary "sshd-session". This allows for a much
smaller listener binary, as it no longer needs to support the SSH
protocol. As part of this work, support for disabling privilege
separation (which previously required code changes to disable) and
disabling re-execution of sshd(8) has been removed. Further
separation of sshd-session into additional, minimal binaries is
planned for the future.
\* sshd(8): several log messages have changed. In particular, some
log messages will be tagged with as originating from a process
named "sshd-session" rather than "sshd".
\* ssh-keyscan(1): this tool previously emitted comment lines
containing the hostname and SSH protocol banner to standard error.
This release now emits them to standard output, but adds a new
"-q" flag to silence them altogether.
\* sshd(8): (portable OpenSSH only) sshd will no longer use argv[0]
as the PAM service name. A new "PAMServiceName" sshd\_config(5)
directive allows selecting the service name at runtime. This
defaults to "sshd". bz2101
\* (portable OpenSSH only) Automatically-generated files, such as
configure, config.h.in, etc will now be checked in to the portable
OpenSSH git release branch (e.g. V\_9\_8). This should ensure that
the contents of the signed release branch exactly match the
contents of the signed release tarball.
Changes since OpenSSH 9.7
=========================
This release contains mostly bugfixes.
New features
------------
\* sshd(8): as described above, sshd(8) will now penalise client
addresses that, for various reasons, do not successfully complete
authentication. This feature is controlled by a new sshd\_config(5)
PerSourcePenalties option and is on by default.
sshd(8) will now identify situations where the session did not
authenticate as expected. These conditions include when the client
repeatedly attempted authentication unsucessfully (possibly
indicating an attack against one or more accounts, e.g. password
guessing), or when client behaviour caused sshd to crash (possibly
indicating attempts to exploit bugs in sshd).
When such a condition is observed, sshd will record a penalty of
some duration (e.g. 30 seconds) against the client's address. If
this time is above a minimum configurable threshold, then all
connections from the client address will be refused (along with any
others in the same PerSourceNetBlockSize CIDR range) until the
penalty expire.
Repeated offenses by the same client address will accrue greater
penalties, up to a configurable maximum. Address ranges may be
fully exempted from penalties, e.g. to guarantee access from a set
of trusted management addresses, using the new sshd\_config(5)
PerSourcePenaltyExemptList option.
We hope these options will make it significantly more difficult for
attackers to find accounts with weak/guessable passwords or exploit
bugs in sshd(8) itself. This option is enabled by default.
\* ssh(8): allow the HostkeyAlgorithms directive to disable the
implicit fallback from certificate host key to plain host keys.
Bugfixes
--------
\* misc: fix a number of inaccuracies in the PROTOCOL.\*
documentation files. GHPR430 GHPR487
\* all: switch to strtonum(3) for more robust integer parsing in most
places.
\* ssh(1), sshd(8): correctly restore sigprocmask around ppoll()
\* ssh-keysign(8): stricter validation of messaging socket fd GHPR492
\* sftp(1): flush stdout after writing "sftp>" prompt when not using
editline. GHPR480
\* sftp-server(8): fix home-directory extension implementation, it
previously always returned the current user's home directory
contrary to the spec. GHPR477
\* ssh-keyscan(1): do not close stdin to prevent error messages when
stdin is read multiple times. E.g.
echo localhost | ssh-keyscan -f - -f -
\* regression tests: fix rekey test that was testing the same KEX
algorithm repeatedly instead of testing all of them. bz3692
\* ssh\_config(5), sshd\_config(5): clarify the KEXAlgorithms directive
documentation, especially around what is supported vs available.
bz3701.
Portability
-----------
\* sshd(8): expose SSH\_AUTH\_INFO\_0 always to PAM auth modules
unconditionally. The previous behaviour was to expose it only when
particular authentication methods were in use.
\* build: fix OpenSSL ED25519 support detection. An incorrect function
signature in configure.ac previously prevented enabling the recently
added support for ED25519 private keys in PEM PKCS8 format.
\* ssh(1), ssh-agent(8): allow the presence of the WAYLAND\_DISPLAY
environment variable to enable SSH\_ASKPASS, similarly to the X11
DISPLAY environment variable. GHPR479
\* build: improve detection of the -fzero-call-used-regs compiler
flag. bz3673.
\* build: relax OpenSSL version check to accept all OpenSSL 3.x
versions.
\* sshd(8): add support for notifying systemd on server listen and
reload, using a standalone implementation that doesn't depend on
libsystemd. bz2641
Checksums:
==========
- SHA1 (openssh-9.8.tar.gz) = bc45cedae7f70b41e9922ef4c9f56e74b9a659b7
- SHA256 (openssh-9.8.tar.gz) = Dnc69VLWFBFdiaz8wySPlvHjb7wZfh/kblQ8ISuQr1Y=
- SHA1 (openssh-9.8p1.tar.gz) = a0bb501b11349f5c5c33a269351be091dc2c2727
- SHA256 (openssh-9.8p1.tar.gz) = 3YvQAqN5tdSZ37BQ3R+pr4Ap6ARh9LtsUjxJlz9aOfM=
Please note that the SHA256 signatures are base64 encoded and not
hexadecimal (which is the default for most checksum tools). The PGP
key used to sign the releases is available from the mirror sites:
https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/RELEASE\_KEY.asc
Reporting Bugs:
===============
- Please read https://www.openssh.com/report.html
Security bugs should be reported directly to openssh@openssh.com


=== Content from www.openwall.com_5bce49e4_20250111_182507.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](../../../2024/07/24/1) [[<thread-prev]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <ZqAWEWkm6Y5LMGli@michel-fedora-PC198L6J>
Date: Tue, 23 Jul 2024 15:44:01 -0500
From: Michel Lind <michel@...hel-slm.name>
To: oss-security@...ts.openwall.com
Subject: Re: linux-distros application for CentOS Project's
 Hyperscale SIG

Hi Alexander,

On Tue, Jul 23, 2024 at 09:23:10PM +0200, Solar Designer wrote:
> Hi,
>
> I've finally reviewed the links and re-read the thread.  Looks like
> we're OK to proceed with adding CentOS Project's Hyperscale SIG as a
> linux-distros member.
>
> Michel, please e-mail me off-list with PGP keys for all of you who need
> to be subscribed for Hyperscale.  I also need to know who will be
> managing this subscription on your end (informing me of any changes in
> who's to stay subscribed).
>
Thank you! I'll email once I have collected all the keys.

> On Wed, Jul 10, 2024 at 06:54:13PM -0500, Michel Lind wrote:
> > All three of us are Fedora developers - but AIUI, we will not and can not use
> > membership here to contribute Fedora patches - until the embargo is
> > over.
> >
> > For Hyperscale itself we plan to use the head start to have local builds
> > ready to go, and commit and do a public build as soon as the embargo is
> > over; if it needs collaboration we can use private Git repos and E2EE
> > private chats to discuss the fix among ourselves.
> >
> > This is, to the best of my knowledge, similar to how AlmaLinux handles
> > embargoed security issues - the fix is ready to go but is only made
> > available once the embargo is lifted.
> >
> > Now - wearing our Fedora hats, we certainly would try and help get this
> > fixed in Fedora once the embargo is over (as we've done before) - and
> > knowing a CVE is going to be made public would certainly help (e.g.
> > trying to make sure one of us is around) - but we won't be participating
> > in the list wearing our Fedora hat, or discuss embargoed issues with
> > people not on the list.
>
> This understanding is correct.  The membership and embargoed info is
> only for the specific distro "except with the reporter's explicit
> approval".  This exception means that you may occasionally ask whoever
> reported the issue to linux-distros for permission to use the
> information e.g. also for preparing a fix for Fedora even though you're
> subscribed for Hyperscale.  To avoid miscoordination, please keep such
> requests also CC'ed to the list.  Uses of this exception have been very
> rare so far, and it is expected that you wouldn't use it often, or else
> it'd make more sense to discuss the additional distro becoming a member.
>
Thanks. Good to know this exception exists, but I'm hoping to prod
Fedora to onboard itself as a member anyway.

> FWIW, Fedora's fix for CVE-2024-6387 was quite timely as-is:
>
> commit dcbca7b947cf82c30d6f477a26efd2f765204fe6
> Author:     Gordon Messmer <gordon.messmer@...il.com>
> AuthorDate: Mon Jul 1 20:49:16 2024 -0700
> Commit:     Gordon Messmer <gordon.messmer@...il.com>
> CommitDate: Tue Jul 2 00:48:16 2024 -0700
>
>     Patch 9.6p1 for CVE-2024-6387
>
> * Mon Jul 01 2024 Gordon Messmer <gordon.messmer@...il.com> - 9.6p1-12
> - Patch 9.6p1 for CVE-2024-6387
>
> On one hand, this confirms that Fedora cares.  On the other, for an
> issue with a trivial patch, I don't know if Fedora could have done much
> or anything more to prepare.
>
It was timely .. but there was some scramble in Fedora's security room
the morning the embargo was lifted. It turns out the development Rawhide
branch was not in a buildable state at that moment - not a big deal, I
pointed out at the time that it's more important to fix the stable
releases - but with access to the embargo, someone could have fixed the
Rawhide build in preparation I suppose.

> OpenSSH 9.8 released on July 1 also fixed "Logic error in ssh(1)
> ObscureKeystrokeTiming", which became CVE-2024-39894 by July 3:
>
> <https://www.openwall.com/lists/oss-security/2024/07/03/6>
>
> Per upstream, this issue affects "9.5 through 9.7 (inclusive)", so I
> guess Fedora's package based on 9.6p1 is vulnerable.  There doesn't
> appear to be a fix in the package yet.  I see this is being tracked in:
>
> <https://bugzilla.redhat.com/show_bug.cgi?id=2295615>
>
> which is assigned to Dmitry Belyavskiy, who is also the maintainer of
> the OpenSSH package in RHEL and CentOS Stream.  RHEL is not affected and
> the issue is low severity, so will probably take a long while to fix in
> Fedora via Red Hat.  Maybe something the community could do quicker?
> This is not directly related to possible linux-distros membership; this
> issue wasn't even on linux-distros.
>
Yeah - the CVE fixes were done by a non-maintainer anyway (Dmitry
understandably has his hands full with fixing RHEL and CentOS Stream).
This is tangential - but having a well-coordinated security team in
Fedora, that participates in this list and in linux-distros, would
likely help - e.g. by ensuring that the ACL of key packages like openssh
correlates to who often contributes to it, and by making sure issues
like these get addressed sooner rather than later.

--
 _o) Michel Lind
_( ) identities: <https://keyoxide.org/5dce2e7e9c3b1cffd335c1d78b229d2f7ccc04f2>

Download attachment "[signature.asc](6/1)" of type "application/pgp-signature" (229 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_b677442f_20250111_182507.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[<thread-prev]](../../../2024/07/15/3) [[thread-next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20240723192310.GA23154@openwall.com>
Date: Tue, 23 Jul 2024 21:23:10 +0200
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Subject: Re: linux-distros application for CentOS Project's Hyperscale SIG

Hi,

I've finally reviewed the links and re-read the thread.  Looks like
we're OK to proceed with adding CentOS Project's Hyperscale SIG as a
linux-distros member.

Michel, please e-mail me off-list with PGP keys for all of you who need
to be subscribed for Hyperscale.  I also need to know who will be
managing this subscription on your end (informing me of any changes in
who's to stay subscribed).

On Wed, Jul 10, 2024 at 06:54:13PM -0500, Michel Lind wrote:
> All three of us are Fedora developers - but AIUI, we will not and can not use
> membership here to contribute Fedora patches - until the embargo is
> over.
>
> For Hyperscale itself we plan to use the head start to have local builds
> ready to go, and commit and do a public build as soon as the embargo is
> over; if it needs collaboration we can use private Git repos and E2EE
> private chats to discuss the fix among ourselves.
>
> This is, to the best of my knowledge, similar to how AlmaLinux handles
> embargoed security issues - the fix is ready to go but is only made
> available once the embargo is lifted.
>
> Now - wearing our Fedora hats, we certainly would try and help get this
> fixed in Fedora once the embargo is over (as we've done before) - and
> knowing a CVE is going to be made public would certainly help (e.g.
> trying to make sure one of us is around) - but we won't be participating
> in the list wearing our Fedora hat, or discuss embargoed issues with
> people not on the list.

This understanding is correct.  The membership and embargoed info is
only for the specific distro "except with the reporter's explicit
approval".  This exception means that you may occasionally ask whoever
reported the issue to linux-distros for permission to use the
information e.g. also for preparing a fix for Fedora even though you're
subscribed for Hyperscale.  To avoid miscoordination, please keep such
requests also CC'ed to the list.  Uses of this exception have been very
rare so far, and it is expected that you wouldn't use it often, or else
it'd make more sense to discuss the additional distro becoming a member.

> > I am curious what this could mean for Fedora Asahi Remix [0], as the
> > applicants maintain both distros.
> >
> > Is there interest in the Asahi SIG applying as well?
> >
> > I heartily endorse the applicants membership request and appreciate
> > their work. Hooray for ARM \o/
>
> So... if this works for Hyperscale, we could potentially discuss with
> other Fedora developers about having Fedora itself be represented in
> linux-distros. Something to bring up at Flock! There's already some
> discussion of this in the Fedora Security Matrix room w.r.t. last week's
> OpenSSH CVE.

FWIW, Fedora's fix for CVE-2024-6387 was quite timely as-is:

commit dcbca7b947cf82c30d6f477a26efd2f765204fe6
Author:     Gordon Messmer <gordon.messmer@...il.com>
AuthorDate: Mon Jul 1 20:49:16 2024 -0700
Commit:     Gordon Messmer <gordon.messmer@...il.com>
CommitDate: Tue Jul 2 00:48:16 2024 -0700

    Patch 9.6p1 for CVE-2024-6387

* Mon Jul 01 2024 Gordon Messmer <gordon.messmer@...il.com> - 9.6p1-12
- Patch 9.6p1 for CVE-2024-6387

On one hand, this confirms that Fedora cares.  On the other, for an
issue with a trivial patch, I don't know if Fedora could have done much
or anything more to prepare.

OpenSSH 9.8 released on July 1 also fixed "Logic error in ssh(1)
ObscureKeystrokeTiming", which became CVE-2024-39894 by July 3:

<https://www.openwall.com/lists/oss-security/2024/07/03/6>

Per upstream, this issue affects "9.5 through 9.7 (inclusive)", so I
guess Fedora's package based on 9.6p1 is vulnerable.  There doesn't
appear to be a fix in the package yet.  I see this is being tracked in:

<https://bugzilla.redhat.com/show_bug.cgi?id=2295615>

which is assigned to Dmitry Belyavskiy, who is also the maintainer of
the OpenSSH package in RHEL and CentOS Stream.  RHEL is not affected and
the issue is low severity, so will probably take a long while to fix in
Fedora via Red Hat.  Maybe something the community could do quicker?
This is not directly related to possible linux-distros membership; this
issue wasn't even on linux-distros.

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_de8f2e48_20250111_182507.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[<thread-prev]](../../../2024/07/02/1) [[thread-next>]](../../../2024/07/28/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <92ac6cec-1f5b-475d-a4eb-374dc065e488@greenbone.net>
Date: Wed, 3 Jul 2024 13:20:22 +0200
From: Christian Fischer <christian.fischer@...enbone.net>
To: oss-security@...ts.openwall.com,
 Dominique Martinet <asmadeus@...ewreck.org>
Subject: Re: Announce: OpenSSH 9.8 released

Hi,

On 02.07.24 1:47 AM, Dominique Martinet wrote:
>> 2) Logic error in ssh(1) ObscureKeystrokeTiming
>
> I couldn't find anything on this one.

it seems CVE-2024-39894 got assigned to this now:

 > OpenSSH 9.5 through 9.7 before 9.8 sometimes allows timing attacks
against echo-off password entry (e.g., for su and Sudo) because of an
ObscureKeystrokeTiming logic error. Similarly, other timing attacks
against keystroke entry could occur.
 >
 > <https://www.cve.org/CVERecord?id=CVE-2024-39894>

Regards,

--

Christian Fischer | PGP Key: 0x54F3CE5B76C597AD
Greenbone AG, Neumarkt 12, 49074 Osnabrück, Germany
<https://www.greenbone.net/>
Company registry: Amtsgericht Osnabrück, HRB 218768
Board of directors: Dr. Jan-Oliver Wagner (CEO), Elmar Geese
Chairman of the Supervisory Board: Lukas Grunwald

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security.netapp.com_0a86d611_20250111_182511.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2024-39894 OpenSSH Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20240712-0004)

## CVE-2024-39894 OpenSSH Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20240712-0004 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20240712-0004 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20240712-0004 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20240712-0004 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20240712-0004
**Version:**
10.0

**Last updated:**
12/20/2024

**Status:**
Interim.

**CVEs:** CVE-2024-39894

Overview
#### Summary

Multiple NetApp products incorporate OpenSSH. OpenSSH versions 9.5 prior to 9.8 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information.

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information.

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2024-39894](https://nvd.nist.gov/vuln/detail/CVE-2024-39894) | 5.3 (MEDIUM) | CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://www.openssh.com/txt/release-9.8>

Affected Products
#### Affected Products

* AFF Baseboard Management Controller (BMC) - A700s
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820

#### Products Under Investigation

* NetApp HCI Compute Node (Bootstrap OS)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* ONTAP tools for VMware vSphere 10

#### Products Not Affected

* AFF BIOS - A1K/A70/A90
* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A1K/A70/A90
* AFF LOADER- A1K/A70/A90
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Volumes ONTAP Mediator
* Data Infrastructure Insights Acquisition Unit (formerly Cloud Insights Acquisition Unit)
* Data Infrastructure Insights Storage Workload Security Agent (formerly Cloud Insights Storage Workload Security Agent)
* Data Infrastructure Insights Telegraf Agent (formerly Cloud Insights Telegraf Agent)
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Service Processor - A300/8200
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp DataOps Toolkit
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG5812/SG5860
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* StorageGRID Baseboard Management Controller (BMC) SG5812/SG5860
* System Manager 9.x
* Terraform Provider for ONTAP
* Workload Factory for VMware

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250** | <https://mysupport.netapp.com/site/downloads/firmware/system-firmware-diagnostics/download/SYSTEM/30804197_ontap/BMC_FW_308-04197_15.12.zip> |
| **FAS/AFF Baseboard Management Controller (BMC) - A800/C800** | <https://mysupport.netapp.com/site/downloads/firmware/system-firmware-diagnostics/download/SYSTEM/30804194_ontap/SP_FW_308-04194_10.9P2.zip> |
| **FAS/AFF Baseboard Management Controller (BMC) - A900/9500** | <https://mysupport.netapp.com/site/downloads/firmware/system-firmware-diagnostics/download/SYSTEM/30804209_ontap/SP_FW_308-04209_16.6.zip> |
| **FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750** | <https://mysupport.netapp.com/site/downloads/firmware/system-firmware-diagnostics/download/SYSTEM/30804195_ontap/SP_FW_308-04195_11.11.zip> |
| **FAS/AFF Baseboard Management Controller (BMC) - FAS2820** | <https://mysupport.netapp.com/site/downloads/firmware/system-firmware-diagnostics/download/SYSTEM/30804210_ontap/SP_FW_308-04210_17.3.zip> |

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20240712-0004>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20240712 | Initial Public Release |
| 2.0 | 20240719 | FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400, ONTAP tools for VMware vSphere 9, SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine, and ONTAP 9 (formerly Clustered Data ONTAP) moved to Products Not Affected, FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250 moved to Affected Products |
| 3.0 | 20240726 | FAS/AFF Service Processor - A300/8200/A200/2650/2620, FAS/AFF Baseboard Management Controller (BMC) - A320, and FAS/AFF Service Processor - A700/9000 moved to Products Not Affected |
| 4.0 | 20240808 | FAS/AFF Baseboard Management Controller (BMC) - A900/9500, FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750, FAS/AFF Baseboard Management Controller (BMC) - A800/C800, and FAS/AFF Baseboard Management Controller (BMC) - FAS2820 moved to Affected Products |
| 5.0 | 20240930 | Active IQ Unified Manager for VMware vSphere moved to Products Not Affected |
| 6.0 | 20241024 | AFF Baseboard Management Controller (BMC) - A700s moved to Affected Products |
| 7.0 | 20241030 | Brocade Fabric Operating System Firmware moved to Products Not Affected |
| 8.0 | 20241111 | FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750 added to Software Versions and Fixes |
| 9.0 | 20241114 | FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250 and FAS/AFF Baseboard Management Controller (BMC) - A800/C800 added to Software Versions and Fixes |
| 10.0 | 20241220 | FAS/AFF Baseboard Management Controller (BMC) - A900/9500 and FAS/AFF Baseboard Management Controller (BMC) - FAS2820 added to Software Versions and Fixes |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from crzphil.github.io_cd600634_20250111_182507.html ===

[Enigmelo Blog](https://crzphil.github.io/)

* [About](/about/)

# SSH Keystroke Obfuscation Bypass

14 min read

June 24, 2024

2873 words

A disclosure for an OpenSSH keystroke obfuscation bypass affecting current OpenSSH versions after 9.4.

# Introduction

OpenSSH version `9.5` introduced measures to mitigate a keystroke timing attack via traffic analysis. The patch involved adding keystroke timing obfuscation to the SSH client. As per the release notes, this feature “*attempts to hide inter-keystroke timings by sending interactive traffic at fixed intervals (default: every 20ms) when there is only a small amount of data being sent*”. Additionally, fake `chaff` packets are sent after the last real keystroke, significantly complicating traffic analysis by shrouding the real keystrokes in a stream of impostors. The feature can be controlled and disabled via the `ObscureKeystrokeTiming` option in the SSH config.

As part of my Bachelor dissertation, I researched the impact of using keystroke latency analysis to infer an SSH session’s underlying commands being run by the client. As a part of this endeavour, I discovered a way to bypass the measures introduced in OpenSSH `9.5`, reaching up until the latest release. I notified the developers on April 24th and received a response from [Damien Miller](https://undeadly.org/cgi?action=article;sid=20230829051257) himself (the developer who introduced the patch), but unfortunately all further correspondence was met with silence. Hence, the publication of the disclosure.

# The existing problem

Previous implementations of the SSH protocol leaked a significant amount of metadata, especially when used interactively. Despite being fully encrypted, this metadata can be used, in principle, to breach the confidentiality of the underlying session. Simply put, each time you press a keystroke in an interactive SSH session, that keystroke is packaged, padded, encrypted, and sent over the wire to the server, on its own. It is then echoed back from the server. This means that each keystroke can be clearly identified and timestamped, opening up potential keystroke-latency attacks to infer what was typed by the client. This can be taken further by also incorporating additional context such as the size of the server’s responses, as well as other metadata points, which I have analysed in detail in my paper for university, which will be published once it is marked.

![](./images/4a6ec79b892ce902954670b4a00c16f6.png)

The above can be observed using Wireshark, with a display filter for `ssh`. However, to make this process easier, I wrote a tool called [SSHniff](https://github.com/CrzPhil/SSHniff) to automate the metadata extraction process. As part of my research project, I also included [Jupyter notebooks](https://github.com/CrzPhil/SSH-Keystroke-Latency-Analysis) where I showcase how the intercepted latencies can be leveraged to infer the underlying UNIX command, using algorithms like Dynamic Time Warp (DTW) and/or Time Series Forests. This is also summarised in [this blogpost](/posts/sshniff).

# Obfuscation in a Nutshell

While this attack vector was discarded by many individuals in the past, preventative measures were first introduced in October of last year (2023). The idea is to veil the real keystroke packets among a wave of fake packets that look just the same to an external observer. These are the so-called `chaff`. Further, all outgoing packets are quantised to a latency of roughly 20ms. The “chaff” is in reality just `SSH2_MSG_PING` and `SSH2_MSG_PONG` packets, that have the same size as the keystroke packets. Whenever a keystroke is typed, these chaff packets start flooding out, hiding any subsequent keystrokes. They are also sent for a certain time interval after the last real keystroke.

# Discovering the Bypass

Part of my thesis was to evaluate how effective these preventative measures introduced by OpenSSH are. While I expected them to completely break this attack vector, when I loaded a Wireshark capture into `SSHniff`, I realised that certain packets still stick out substantially, among the hundreds of packets hovering around 20ms intervals.

![](./images/bbcb839ec928a5c51fd29e66bd16b5f9.png)

> In this session, I ran `uptime`. As you can see, there is one spike for each letter in `uptime`, but note that the **first** real keystroke is at latency zero, and the **last** spike corresponds to the `Enter` keystroke, for a total of seven real keystrokes.

To verify, I ran some additional commands and found the same behaviour. `netstat -tlpn`, for instance, has thirteen letters. The `Enter` keystroke was omitted in this session.

![](./images/44ef14ac58128dfd18cb736aa3efbf91.png)

As I came to realise, these spikes were caused by `SSHniff` skipping three packets each time (hence the 60ms relative latency for each spike), which boiled down to the tool’s implementation, as it only looks for packets of a certain size `K`, corresponding to the keystroke packets. This implied that among the chaff, certain packets were slightly larger or smaller than the tool expected, so it ignored them.

This prompted me to take a closer look at Wireshark, and indeed, I realised that for each keystroke typed **after** the chaff is triggered, these real keystroke packets produce larger packets (as well as two server-side echoes), which means they can be quite clearly identified. I used the previous methods like DTW to check if I can use these outlying packets to infer the underlying command just as before, and it worked, which served as verification that these are indeed the real keystroke packets.

![](./images/0c83179733cb7154e77094ff535c4a0e.png)

> For more information on the latency analysis part of this attack, refer to the [Keystroke Latency Analysis](#keystroke-latency-analysis) section.

I then notified the OpenSSH developers and started digging deeper into the observed behaviour.

# Fat Packets

These outlying packets were roughly twice the size of “normal” keystrokes (and therefore also twice the size of the chaff packets). I say roughly because the absolute on-the-wire size depends on the encryption ciphers used, among other things.

![](./images/1552468f7cd07f3fc2386868c2c39d9d.png)

The chaff are the packets of `102` length, which, normally, using this cipher set would be the size of regular keystrokes (those that `SSHniff` would also filter out). Since the client-side packet initiating these triplets is larger (`138`), all three packets slip through the cracks and cause the aforementioned spikes when plotted.

![](./images/8eec58308d1272323b1a66404df2a14e.png)

It is interesting to note that the initial keystroke is sent “normally”, without being packaged in a fat packet. Only once the chaff flood is initiated do subsequent real keystrokes produce these larger packets. Similarly, waiting for the chaff to subside before writing out the next keystroke, also produces a regular packet pair (followed by chaff).

## OpenSSH Verbose Output

I compiled `OpenSSH v9.7` with the `-DPACKET_DEBUG` flag, to get a more verbose view of the session. In the following session, I ran the `whoami` command. I will now show how the client constructs/packages keystrokes.

Starting with the initial keystroke, which, as stated, is sent with a normal size and followed by chaff packets.

```
debug1: packet_start[94]
plain:     buffer len = 15
0000: 00 00 00 00 00 5e 00 00 00 00 00 00 00 01 77     .....^........w
debug1: send: len 20 (includes padlen 5, aadlen 4)
encrypted: buffer len = 36
0000: c7 e4 05 07 10 e1 f3 4b 24 ba 61 e8 fe 6e 0b 01  .......K$.a..n..
0016: 79 50 4e af 6a 96 31 5e ff fa ec bf 2b 3b 91 42  yPN.j.1^....+;.B
0032: a7 14 64 a6                                      ..d.
debug3: obfuscate_keystroke_timing: starting: interval ~20ms
debug1: input: packet len 20
debug1: partial packet: block 8, need 16, maclen 0, authlen 16, aadlen 4
read_poll enc/full: buffer len = 36
0000: d7 47 be 72 2c e8 e7 e1 ae 38 fe a2 f4 e9 e0 04  .G.r,....8......
0016: 9c 00 fd 1d 41 f8 d9 6e 61 4b 90 4e a4 e6 2c 30  ....A..naK.N..,0
0032: 92 92 42 54                                      ..BT
debug1: input: padlen 5
debug1: input: len before de-compress 10

```

Packet type `94` is `SSH2_MSG_CHANNEL_DATA` (defined in [ssh2.h](https://github.com/openssh/openssh-portable/blob/master/ssh2.h#L142C9-L142C34)) and stores an individual keystroke. We can also see the obfuscation starting, with an interval of ~20ms (default). The packet has an encrypted length of 36 bytes, which matches what we see on Wireshark when looking at the TCP payload length.

This is followed by the server-side echo, which we “read” on the client side:

```
read/plain[94]:
buffer len = 9
0000: 00 00 00 00 00 00 00 01 77                       ........w
debug1: received packet type 94
w

```

Next, have a look at some of the chaff that follows the first real keystroke. This is sent by the client:

```
debug1: packet_start[192]
plain:     buffer len = 15
0000: 00 00 00 00 00 c0 00 00 00 05 50 49 4e 47 21     ..........PING!
debug1: send: len 20 (includes padlen 5, aadlen 4)
encrypted: buffer len = 36
0000: d7 cf 6b 64 25 d6 40 89 68 eb 4d 6c a0 cb de e6  ..kd%.@.h.Ml....
0016: d0 b5 14 81 c4 57 6f c4 3a 82 eb 55 44 d2 b4 9d  .....Wo.:..UD...
0032: 3b 58 12 ac                                      ;X..
debug1: input: packet len 20
debug1: partial packet: block 8, need 16, maclen 0, authlen 16, aadlen 4
read_poll enc/full: buffer len = 36
0000: 88 40 00 52 0e 4b fc eb 89 f7 72 1f d6 a4 3f dd  .@.R.K....r...?.
0016: 0b dd 27 19 0e a8 84 f7 74 6f 43 e7 8c eb 16 9e  ..\'.....toC.....
0032: 37 4e 89 95                                      7N..
debug1: input: padlen 5
debug1: input: len before de-compress 10

```

We can see it is an [SSH2\_MSG\_PING](https://github.com/openssh/openssh-portable/blob/master/ssh2.h#L113), and most importantly, it is also 36 bytes, perfectly matching the real keystroke. Several of these PINGs are sent, and each are followed by the server’s PONG ([SSH2\_MSG\_PONG](https://github.com/openssh/openssh-portable/blob/master/ssh2.h#L114)), of 36 bytes, again.

```
read/plain[193]:
buffer len = 9
0000: 00 00 00 05 50 49 4e 47 21                       ....PING!
debug1: received packet type 193
debug1: Received SSH2_MSG_PONG len 5

```

So far, everything seems to run as intended. However, when we reach the second real keystroke, namely `h`, things start behaving differently.

First, the keystroke packet is constructed, just as before:

```
debug1: packet_start[94]
plain:     buffer len = 15
0000: 00 00 00 00 00 5e 00 00 00 00 00 00 00 01 68     .....^........h
debug1: send: len 20 (includes padlen 5, aadlen 4)
encrypted: buffer len = 36
0000: c3 22 ea f0 f5 47 15 db 95 c9 64 ec e6 66 40 a2  .\"...G....d..f@.
0016: d2 fc 71 e2 59 35 c3 a7 85 90 4c b9 7f 17 fd 65  ..q.Y5....L....e
0032: 97 54 c3 e6                                      .T..

```

Same length, but notably the `partial packet` and `read_poll` debug entries are missing, which is because the packet is not actually sent yet. What follows is the construction of a PING packet, **before** this keystroke is sent:

```
debug1: packet_start[192]
plain:     buffer len = 15
0000: 00 00 00 00 00 c0 00 00 00 05 50 49 4e 47 21     ..........PING!
debug1: send: len 20 (includes padlen 5, aadlen 4)
encrypted: buffer len = 72
0000: c3 22 ea f0 f5 47 15 db 95 c9 64 ec e6 66 40 a2  .\"...G....d..f@.
0016: d2 fc 71 e2 59 35 c3 a7 85 90 4c b9 7f 17 fd 65  ..q.Y5....L....e
0032: 97 54 c3 e6 c6 59 df 64 eb c8 ba d4 f7 ed 5a 88  .T...Y.d......Z.
0048: 53 13 da 7e 7f 1d 63 9d dd 23 40 b4 b9 67 6e f3  S..~..c..#@..gn.
0064: 76 12 66 1b 89 5b 5a 21                          v.f..[Z!
debug1: input: packet len 20
debug1: partial packet: block 8, need 16, maclen 0, authlen 16, aadlen 4
read_poll enc/full: buffer len = 36
0000: 47 3e ca 40 05 b8 a8 5b 1d 1a 2b bd bd c6 d5 35  G>.@...[..+....5
0016: d1 dc 56 f2 28 8a c4 07 df cb 73 e1 fb cc 0a 9e  ..V.(.....s.....
0032: 20 73 c7 97                                       s..
debug1: input: padlen 5
debug1: input: len before de-compress 10

```

Here we see the previously-missing `partial packet` and `read_poll` debug entries, but we also see that because these two packets were essentially combined, the encrypted buffer length is now 72, instead of 36 bytes.

Finally, we get **two** server-side echoes, starting with the PONG, followed by the keystroke echo for `h`:

```
read/plain[193]:
buffer len = 9
0000: 00 00 00 05 50 49 4e 47 21                       ....PING!
debug1: received packet type 193
debug1: Received SSH2_MSG_PONG len 5
debug1: input: packet len 20
debug1: partial packet: block 8, need 16, maclen 0, authlen 16, aadlen 4
read_poll enc/full: buffer len = 36
0000: ec 9f ef a2 55 7e c3 4c f8 75 08 a9 8d 45 7e 14  ....U~.L.u...E~.
0016: 1f 55 b1 44 6e ea c7 f9 c9 ef ed ef 33 42 a7 29  .U.Dn.......3B.)
0032: 67 84 fa 94                                      g...
debug1: input: padlen 5
debug1: input: len before de-compress 10
read/plain[94]:
buffer len = 9
0000: 00 00 00 00 00 00 00 01 68                       ........h
debug1: received packet type 94
h

```

This is what the triplet spikes look like at the verbose debug level. It also explains the larger size and the duplicate echoes, as the real keystrokes are packaged up together with a PING packet, producing a single packet twice the size of a “normal” packet, and triggering two server-side responses.

# SSHniff

In the spirit of following the good old “*PoC or GTFO*” mindset, I wrote an atrocious but functional “patch” into `SSHniff`, where if SSH versions after `9.4` are detected, it is assumed that obfuscation is in use and the bypass is employed. Note that it really is an atrocious bunch of code that I polluted my text editor with, but it ought to suffice in showing that the current keystroke obfuscation is completely transparent.

Here is an example of running `SSHniff` on an intercepted SSH session that used the obfuscation: I ran `iptables -S`, `whoami`, `ls -al`, and finally fat-fingered `exi`, followed by `exit`. You can verify this for yourself, as I included the PCAP [here](https://github.com/CrzPhil/SSH-Keystroke-Latency-Analysis/blob/main/test_sessions/patch_iptablesS_whoami_lsal_exi_exit.pcapng).

```
<SNIP>
┃╭─────────────────Client─────────────────╮      ╭─────────────────Server─────────────────╮
┃│           192.168.0.19:55932           │      │            192.168.0.16:22             │
┃│    e42184b06d45385a906f0803d04c83da    │----->│    aae6b9604f6f3356543709a376d7f657    │
┃│          SSH-2.0-OpenSSH_9.7           │      │          SSH-2.0-OpenSSH_9.7           │
┃╰────────────────────────────────────────╯      ╰────────────────────────────────────────╯
<SNIP>
┣━ tcp.seq ─ Latency μs ─ Type
┣  [4450]  ─ (       0) ─ Keystroke
┣  [4774]  ─ (  177182) ─ Keystroke
┣  [5026]  ─ (  119630) ─ Keystroke
┣  [5170]  ─ (   60477) ─ Keystroke
┣  [5530]  ─ (  182991) ─ Keystroke
┣  [5638]  ─ (   36727) ─ Keystroke
┣  [5998]  ─ (  175786) ─ Keystroke
┣  [6142]  ─ (   59886) ─ Keystroke
┣  [6394]  ─ (  119464) ─ Keystroke
┣  [6646]  ─ (  117633) ─ Keystroke
┣  [7078]  ─ (  219396) ─ Keystroke
┣╮ [10858]  ─ ( 3478329) ─ Enter
┃╰─╼[236]
┣━
┣  [10858]  ─ (       0) ─ Keystroke
┣  [11290]  ─ (  238980) ─ Keystroke
┣  [11470]  ─ (   80064) ─ Keystroke
┣  [11650]  ─ (   79103) ─ Keystroke
┣  [11902]  ─ (  122768) ─ Keystroke
┣  [12226]  ─ (  158690) ─ Keystroke
┣╮ [15034]  ─ ( 3324090) ─ Enter
┃╰─╼[204]
┣━
┣  [15034]  ─ (       0) ─ Keystroke
┣  [15322]  ─ (  162362) ─ Keystroke
┣  [15502]  ─ (   81398) ─ Keystroke
┣  [15682]  ─ (   83084) ─ Keystroke
┣  [15862]  ─ (   79398) ─ Keystroke
┣  [16114]  ─ (  123489) ─ Keystroke
┣╮ [18598]  ─ ( 1363393) ─ Enter
┃╰─╼[3116]
┣━
┣  [18598]  ─ (       0) ─ Keystroke
┣  [18922]  ─ (  164250) ─ Keystroke
┣  [19210]  ─ (  144942) ─ Keystroke
┣╮ [22522]  ─ ( 1822534) ─ Enter
┃╰─╼[256]
┣━
┣  [22522]  ─ (       0) ─ Keystroke
┣  [22846]  ─ (  162024) ─ Keystroke
┣  [23134]  ─ (  149977) ─ Keystroke
┣  [23458]  ─ (  158038) ─ Keystroke
┣╮ [27350]  ─ (  204709) ─ Enter
┃╰─╼[272]
┣━
┃
┣━━━━

```

As you can see, the keystrokes are extracted seamlessly and are ripe to be fed to the analysis tool.

# Keystroke Latency Analysis

This is not part of the initial disclosure for the obfuscation bypass, but it should help understand both the impact of the metadata leaked by the SSH protocol and also the need for such preventative measures. It will also paint a more complete picture of the entire attack and discovery process.

To demonstrate how SSH metadata can be used to breach confidentiality, I will show a PoC of how to use SSHniff to extract keystrokes and infer the underlying command(s).

Wireshark captures can be fed to the tool, which then produces output like this:

![](./images/5c2083f73e99055406936eaeb9162440.png)

Among other things it shows any keystroke sequences typed out during the session, as well as their relative latency (in microseconds), TCP sequence numbers, and the inferred keystroke type. Using the packet sizings, we can discern between certain keystrokes, like backspaces, Enter (Return), and horizontal arrow keys, which is yet another crucial point in traffic analysis. Here, the only thing typed in the session was `exit`, followed by Enter (Return).

The tool can also serialise the data, such that it can then be plotted and processed. Using Jupyter notebook, I set up this proof of concept, using a small dataset accumulated for my thesis.

## Rhythmic Commands

> For a full look at the research, consult the paper (link TBD), and/or consult the [notebook](https://github.com/CrzPhil/SSH-Keystroke-Latency-Analysis/blob/main/analysis.ipynb) on the SSHniff repository. If you are only interested in the obfuscation bypass, scroll all the way down in the notebook until the “Patch Analysis” section.

In a nutshell, I show that commands can produce certain “profiles”, or rhythms, when typed, which are identifiable by their latency. The below plot is an example where I myself typed out `sudo apt upgrade` 18 times:

![](./images/fe72082d2f544a73b05f64eb69c4757d.png)

The dataset collected by external participants also showed this to be the case (although naturally, some commands were more identifiable than others):

![](./images/3e2c60de75572861d751f8f3713dfde9.png)

Using algorithms like the Euclidean Distance or DTW, an intercepted (unlabelled) keystroke sequence could be compared to the commands in the dataset, therefore calculating the “similarity” between the sequences.

This is what such a sequence, observed by SSHniff might look like:

![](./images/8e6251e0e412b9ae838ce9429366ad5a.png)

Some of the results are summarised in this table:

![](./images/ab8893e363109a37ac43521741f22b76.png)



=== Content from www.openwall.com_04d94863_20250111_182512.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2024/07/01/13) [[next>]](2) [[<thread-prev]](../../../2024/07/01/1) [[thread-next>]](../../../2024/07/03/6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <ZoNACurP_90GPyp5@codewreck.org>
Date: Tue, 2 Jul 2024 08:47:22 +0900
From: Dominique Martinet <asmadeus@...ewreck.org>
To: Damien Miller <djm@....openbsd.org>, oss-security@...ts.openwall.com
Subject: Re: Announce: OpenSSH 9.8 released

Damien Miller wrote on Mon, Jul 01, 2024 at 02:10:04AM -0600:
> OpenSSH 9.8 has just been released. It will be available from the
> mirrors listed at <https://www.openssh.com/> shortly.

Thanks for all the work towards this release.

Just a paperwork question as I couldn't find the information anywhere,
was there any CVE assigned to the 2nd security issue?

I'm asking because I tried updating the alpine package[1], and given the
first issue is a slightly different problem on musl it probably needs a
different label than CVE-2024-6387 ; I'm honestly still not quite sure
how all this works after all these years but at the very least a search
on cve.mitre.org[2] didn't turn up anything, so I assume redhat (who
issued the first CVE) didn't process the second problem?

(although to be fair the non-safety is still a problem on alpine, so
that CVE might still apply, it's just no longer a free/malloc race with
syslog but something that hasn't been studied as extensively... labeling
is hard.)

[1] <https://gitlab.alpinelinux.org/alpine/aports/-/merge_requests/68482#note_417509>
[2] <https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=openssh>

Damien Miller wrote on Mon, Jul 01, 2024 at 02:10:04AM -0600:
> 1) Race condition in sshd(8)

Looking at other announces I assume CVE-2024-6387 is specific to this.

> 2) Logic error in ssh(1) ObscureKeystrokeTiming

I couldn't find anything on this one.

Thanks,
--
Dominique Martinet | Asmadeus

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_d64d8b49_20250111_182507.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](../../../2024/07/29/1) [[<thread-prev]](../../../2024/07/03/6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20240728194223.GA20674@openwall.com>
Date: Sun, 28 Jul 2024 21:42:23 +0200
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Subject: Re: Announce: OpenSSH 9.8 released

Some nitpicks:

CVE-2006-5051 found by Mark Dowd, which was the original bug that got
relatively recently reintroduced as CVE-2024-6387, still has in its
description an erroneous reference to GSSAPI:

> Signal handler race condition in OpenSSH before 4.4 allows remote
> attackers to cause a denial of service (crash), and possibly execute
> arbitrary code if GSSAPI authentication is enabled, via unspecified
> vectors that lead to a double-free.

It was understood back in 2006 that this bug's exposure did not in fact
depend on GSSAPI:

<https://bugzilla.redhat.com/show_bug.cgi?id=208347>

> Josh Bressers 2006-09-28 15:17:17 UTC
>
> I've done some analysis of this issue and received a mail from Mark Dowd
> regarding this vulnerability.  The upstream details are misleading.
>
> The problem is that the signal handling in openssh does quite a lot and can
> introduce a race condition during cleanup.  This flaw could possibly cause a
> double free condition within the kerberos cleanup code.  The GSSAPI code is
> completely harmless, upstream calling this issue a GSSAPI issue leads me to
> believe they did not analyze, nor try to understand this issue.
>
> There is also PAM cleanup code which is executed.  This PAM source hasn't been
> investigated so the possible outcome is currently unknown.

I suggest removing " if GSSAPI authentication is enabled" from
CVE-2006-5051 description.  Maybe someone reading this can correct that.

Maybe I pay too much attention to historical detail, but this error in
CVE-2006-5051 did cause the question of GSSAPI (ir)relevance to come up
in CVE-2024-6387 discussions at least twice (that I know of).

On Mon, Jul 01, 2024 at 02:10:04AM -0600, Damien Miller wrote:
> 2) Logic error in ssh(1) ObscureKeystrokeTiming
>
> In OpenSSH version 9.5 through 9.7 (inclusive), when connected to an
> OpenSSH server version 9.5 or later, a logic error in the ssh(1)
> ObscureKeystrokeTiming feature (on by default) rendered this feature
> ineffective - a passive observer could still detect which network
> packets contained real keystrokes when the countermeasure was active
> because both fake and real keystroke packets were being sent
> unconditionally.
>
> This bug was found by Philippos Giavridis and also independently by
> Jacky Wei En Kung, Daniel Hugenroth and Alastair Beresford of the
> University of Cambridge Computer Lab.
>
> Worse, the unconditional sending of both fake and real keystroke
> packets broke another long-standing timing attack mitigation. Since
> OpenSSH 2.9.9 sshd(8) has sent fake keystoke echo packets for
> traffic received on TTYs in echo-off mode, such as when entering a
> password into su(8) or sudo(8). This bug rendered these fake
> keystroke echoes ineffective and could allow a passive observer of
> a SSH session to once again detect when echo was off and obtain
> fairly limited timing information about keystrokes in this situation
> (20ms granularity by default).
>
> This additional implication of the bug was identified by Jacky Wei
> En Kung, Daniel Hugenroth and Alastair Beresford and we thank them
> for their detailed analysis.
>
> This bug does not affect connections when ObscureKeystrokeTiming
> was disabled or sessions where no TTY was requested.

Dug Song and I designed the original fake keystroke echo packets
mitigation, and per our advisory/article back then this was "initially
applied to OpenSSH starting with version 2.5.0.  OpenSSH 2.5.2 contains
the more complete versions of the fixes and solves certain
interoperability issues associated with the earlier versions."

<https://www.openwall.com/articles/SSH-Traffic-Analysis>

After the 9.8 release, I've added an update (clearly marked as such) to
the article above to refer to the issue reintroduction and the new fix.
I was also surprised by the reference to 2.9.9 above, so I checked
OpenSSH-portable commits.  To me, our original references to 2.5.x look
correct, and I have no idea where 2.9.9 came from.

Luckily, those old version references are not part of the CVE-2024-39894
description, so nothing to correct there.

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from news.ycombinator.com_5940e18e_20250111_182511.html ===


| |  | **[Hacker News](news)** [new](newest) | [past](front) | [comments](newcomments) | <ask> | <show> | <jobs> | <submit> | [login](login?goto=item%3Fid%3D41508530) | | --- | --- | --- | |
| --- | --- | --- | --- |
|
| |  |  | [OpenSSH Keystroke Obfuscation Bypass](https://crzphil.github.io/posts/ssh-obfuscation-bypass/) ([crzphil.github.io](from?site=crzphil.github.io)) | | --- | --- | --- | |  | | 200 points by [pabs3](user?id=pabs3) [4 months ago](item?id=41508530)  | [hide](hide?id=41508530&goto=item%3Fid%3D41508530) | [past](https://hn.algolia.com/?query=OpenSSH%20Keystroke%20Obfuscation%20Bypass&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0) | [favorite](fave?id=41508530&auth=38bbee41cc541769def503d336195e27a8680566) | [25 comments](item?id=41508530) |  | |  |  | [qhwudbebd](user?id=qhwudbebd) [4 months ago](item?id=41513691)   | [next](#41515521) [–]  This was present in versions 9.5 - 9.7 of OpenSSH and fixed in 9.8p1 released at the beginning of July. Philippos (along with others) is credited for reporting it in the release notes: ```   https://www.openssh.com/releasenotes.html#9.8p1 ``` | | --- | --- | --- | | | --- | --- | --- | --- | | |  |  | [palisade](user?id=palisade) [4 months ago](item?id=41516594)   | [parent](#41513691) | [next](#41515521) [–]  Worth noting too, that other linux systems using 8.9, e.g. ubuntu are 8.9p1 and have the patch applied but to an older version so they're also safe. Just in case anyone was worried about that. | | --- | --- | --- | | | |  |  | [0x0](user?id=0x0) [4 months ago](item?id=41518691)   | [root](#41513691) | [parent](#41516594) | [next](#41515521) [–]  I'd be very surprised if ubuntu has backported the keystroke obfuscation feature (which was introduced in 9.5) to 8.9. When the feature is missing, you're not safe from keystroke interception at all, which is what this bug is all about, so any 8.9 version would be actually considered "unsafe" until the whole feature is backported, which seems unlikely to happen? | | --- | --- | --- | | | |  |  | [jonmon6691](user?id=jonmon6691) [4 months ago](item?id=41515521)   | [prev](#41513691) | [next](#41515320) [–]  Most people would consider streaming music to be a negligible amount of bandwidth. Seems to me like SSH in a "high security mode" could just send X Kbps of bi-directional pad at a layer directly above encryption but below application. Then just use that channel for all the normal SSH traffic. You could either treat this as a bandwidth limited channel or do some slow time-constant ramping up and down at the risk of leaking information about file downloads or large command outputs. | | --- | --- | --- | | | |  |  | [advael](user?id=advael) [4 months ago](item?id=41516522)   | [parent](#41515521) | [next](#41524538) [–]  This seems like a reasonable solution to me, and I often stream music through my ssh sessions via port forwards so I may well already be getting the benefit in some places | | --- | --- | --- | | | |  |  | [mrngm](user?id=mrngm) [4 months ago](item?id=41524538)   | [parent](#41515521) | [prev](#41516522) | [next](#41515320) [–]  This and a similar suggestion in another thread may sound nice and easy, "just add a constant stream of noise", but it assumes you can generate enough constant noise *and* be able to intersperse the noise with valid commands without being able to distinguish these events. The problem is not necessarily that you want to hide (to a network adversary) that you've been typing. It's that you do not want to reveal, through some side-channel, what the exact *contents* were. On the openssh-unix-dev mailing list, someone recently pointed out[0] that just periodically (without jitter) sending out packets may be problematic due to subtle differences in clock timing. Aside, they also link to a presentation[1] [PDF] that shows influence of temperature on clock skew (especially page 18) and that this gives a possibility for fingerprinting. Then there's the challenge of keeping SSH interactive enough that people do not experience too much input lag while typing. What if the user typed a character, but due to such a timing side-channel preventive measure, that character needs to be sent in the next packet, adding latency to the user experience? Surely it improves security, but it may add too much frustration for regular usage. [0] <https://marc.info/?l=openssh-unix-dev&m=169402700622936&w=2> [1] <https://murdoch.is/talks/ccs06hotornot.pdf> ([2006] Hot or Not: Revealing hidden services by their clock skew, see also <https://doi.org/10.1145/1180405.1180410> and an HN thread from 2014: <https://news.ycombinator.com/item?id=7694612>) | | --- | --- | --- | | | |  |  | [jonmon6691](user?id=jonmon6691) [4 months ago](item?id=41532576)   | [root](#41515521) | [parent](#41524538) | [next](#41515320) [–]  But I don't think the conversation here is about anonymity, its about side channels to discover the actual content of the SSH session. The OP is looking at determining the command typed based on keystroke timing. The attacks you link would work for any traffic that could be intercepted, SSH or otherwise, and they wouldn't give any info about the content of the stream. If we're just focused on removing all traces of keystroke timing from the channel, then I think a decoupled SSH transport layer which is providing say 1kB of zero-pad every 20ms to the the shell to fill up, along with a FIFO to spread that out, and maybe some logic to ramp up and down the channel bandwidth based on queue length, you would go a long way to mitigating this specific attack. | | --- | --- | --- | | | |  |  | [mrguyorama](user?id=mrguyorama) [4 months ago](item?id=41515320)   | [prev](#41515521) | [next](#41511976) [–]  Regardless of what the "cause" of this is (ie bug or bad design), it's obvious nobody even took a look at this after it was coded up and merged in. The larger packets and double server ACKs are very clearly obviously giving the game away. This feature just doesn't even come close to what it supposedly does, was it even shipped as a feature or something that wasn't yet done? Not exactly encouraging, to see a system so integral to security seemingly shipping code without even a minor test of intended function. | | --- | --- | --- | | | |  |  | [tedunangst](user?id=tedunangst) [4 months ago](item?id=41515362)   | [parent](#41515320) | [next](#41511976) [–]  I think it's worth asking how important the feature is in the grand scheme of things. But what about the CIA timing my keystrokes is more of a nerd forum thing than an actual attack vector you read about in intrusion post mortems. | | --- | --- | --- | | | |  |  | [talkin](user?id=talkin) [4 months ago](item?id=41518321)   | [root](#41515320) | [parent](#41515362) | [next](#41511976) [–]  Well, or it is important, and then you add the countermeasures. These countermeasures are quite easy to mess up, so doing the validation (on an ongoing basis!) MUST be part of the deal. Or if you think it’s not important enough to do those assertions in CI, then it might be better to just reject the obfuscation attempts. There’s no middleground: doing the implementation without checks, means you added complexity, you dont know if security improved (or worsened!), and the the release note might come down to a false sense of security. | | --- | --- | --- | | | |  |  | [thadt](user?id=thadt) [4 months ago](item?id=41511976)   | [prev](#41515320) | [next](#41512075) [–]  Good work. But - this is an implementation bug right? If the underlying stream of packets gives you a distinguisher (in this case, slightly larger packets), then this attack works. So adjusting the chaff and payload packet sizes to some fixed capacity restores obfuscation, if I'm understanding this correctly. And response packets - those also have to be managed to prevent leakage. | | --- | --- | --- | | | |  |  | [KyleSanderson](user?id=KyleSanderson) [4 months ago](item?id=41512061)   | [parent](#41511976) | [next](#41512075) [–]  The implementation is just wrong from what's been presented. basic jitter (20-100ms), and a dynamic payload size are what's actually missing here. The question now becomes though how interactive should your session be. Timing the connection latency might help to an extent, but this is about mitm and you don't necessarily know where your adversary is (first hop, or towards the end). Batching keystrokes would also help here. | | --- | --- | --- | | | |  |  | [tialaramex](user?id=tialaramex) [4 months ago](item?id=41513339)   | [root](#41511976) | [parent](#41512061) | [next](#41512075) [–]  Basically there are two "modes" in normal mode OpenSSH is content to idle with no packets moving except any requested keepalives. In "chaff mode" currently they try to send a chaff packet every time they can to disguise your keypresses, but they forgot keystrokes will just get bundled into the existing chaff packet, growing it, so it stands out as special. All they need to do is retain the "chaff mode" but when they have a keystroke ready to be sent they should suppress the chaff that would otherwise go in the same packet. No need for "basic jitter" or "dynamic payload size" that I can see, with this change the packets are indistinguishable in terms of size or (encrypted) content, and they have no more or less jitter than would be normal for the network they're traversing. [Various small edits to clarify] | | --- | --- | --- | | | |  |  | [aidenn0](user?id=aidenn0) [4 months ago](item?id=41516028)   | [root](#41511976) | [parent](#41513339) | [next](#41512075) [–]  They will also need to increase the minimum size of a non-chaff keystroke to be the size of the largest keystroke that they wish to keep confidential; 3 bytes is a minimum for the basic control characters (e.g. arrow keys which are ESC '[' X where X depends on the arrow direction). I did find it interesting that the return keystroke was of a differing size to other characters; on unix systems it should just send a ^J. | | --- | --- | --- | | | |  |  | [ec109685](user?id=ec109685) [4 months ago](item?id=41517652)   | [root](#41511976) | [parent](#41516028) | [next](#41512075) [–]  Can’t they just send large control characters as three separate key presses? | | --- | --- | --- | | | |  |  | [aidenn0](user?id=aidenn0) [4 months ago](item?id=41523334)   | [root](#41511976) | [parent](#41517652) | [next](#41512075) [–]  That will confuse screen/tmux which needs to distinguish between escape codes and a press of the escape key. | | --- | --- | --- | | | |  |  | [SoftTalker](user?id=SoftTalker) [4 months ago](item?id=41512075)   | [prev](#41511976) | [next](#41514343) [–]  I'm not an expert in this area at all but I recall reading that trying to hide a signal in random noise doesn't really work, as you can still find the signal with statistical analysis or looking for distingishing characteristics that are not obscured. That was my first thought when I read about this new feature in OpenSSH, and it seems to have proven correct. Edit: wanted to add that I recognize that the people working on OpenSSH know a lot more about this than I do, and I had assumed they wouldn't bother implementing this if it wasn't a good idea, so willing to accept that "proven correct" may be an overstatement or even flat-out wrong. | | --- | --- | --- | | | |  |  | [6502nerdface](user?id=6502nerdface) [4 months ago](item?id=41520381)   | [parent](#41512075) | [next](#41512281) [–]  > trying to hide a signal in random noise doesn't really work Actually it works perfectly and it's called a one-time pad! | | --- | --- | --- | | | |  |  | [milliams](user?id=milliams) [4 months ago](item?id=41512281)   | [parent](#41512075) | [prev](#41520381) | [next](#41514343) [–]  The advantage that OpenSSH have here is that they don't have to just hide the signal using noise, they can actually change the signal to look like the noise (or vice versa). For example they are making the signal packets some at a regular interval (since the "signal" being discussed is the timings). That alone would not hide the number of keypresses, but adding the chaff should do so. In this case, as said above, it seems like there's an implementation issue with actually doing those obfuscations, allowing the signal to be identified. | | --- | --- | --- | | | |  |  | [hi-v-rocknroll](user?id=hi-v-rocknroll) [4 months ago](item?id=41514343)   | [prev](#41512075) | [next](#41513768) [–]  Perhaps instead shooting off individual keypresses with some random chaff packets, it would be wiser to have constant interval, constant low data rate, (say 8 KBps) data rate trickling packets through and let the other side throw away pick out the needles from the haystack of no ops. Good luck finding a side-channel in that. | | --- | --- | --- | | | |  |  | [pshc](user?id=pshc) [4 months ago](item?id=41515689)   | [parent](#41514343) | [next](#41513768) [–]  Sounds good until (for example) you find out the SSH client library wasn't queueing up packets ahead of time, but instead building them at send time, and a chaff packet takes less time to build than a real packet... so many ways to get side-channeled. | | --- | --- | --- | | | |  |  | [bubblesnort](user?id=bubblesnort) [4 months ago](item?id=41518315)   | [root](#41514343) | [parent](#41515689) | [next](#41513768) [–]  Crypto requires a good source of random entropy. I suppose if you want more traffic for obscurity, you'll also have to find more random bits. Without enough entropy, you'd sacrifice security for obscurity. Just my ¢2, ymmv, etc | | --- | --- | --- | | | |  |  | [keyboardcaper](user?id=keyboardcaper) [4 months ago](item?id=41513768)   | [prev](#41514343) | [next](#41513965) [–]  There is a market for keyboards which obscure keypress timings. | | --- | --- | --- | | | |  |  | [gunapologist99](user?id=gunapologist99) [4 months ago](item?id=41513965)   | [prev](#41513768) [–]  Yet another reason to switch to SSH keys instead of passwords wherever possible. Simple and bulletproof, with a minimum of footguns. EDIT: @tedunangst is right, wouldn't have helped. Even so, switch to keys! | | --- | --- | --- | | | |  |  | [tedunangst](user?id=tedunangst) [4 months ago](item?id=41514036)   | [parent](#41513965) [–]  Does nothing here. | | --- | --- | --- | | |
| |  | | --- |   [Guidelines](newsguidelines.html) | [FAQ](newsfaq.html) | [Lists](lists) | [API](https://github.com/HackerNews/API) | [Security](security.html) | [Legal](https://www.ycombinator.com/legal/) | [Apply to YC](https://www.ycombinator.com/apply/) | Contact Search: |


