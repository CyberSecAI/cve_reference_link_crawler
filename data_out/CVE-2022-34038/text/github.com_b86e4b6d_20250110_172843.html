
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fvulndb%2Fissues%2F2016)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fvulndb%2Fissues%2F2016)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=golang%2Fvulndb)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[golang](/golang)
/
**[vulndb](/golang/vulndb)**
Public

* [Notifications](/login?return_to=%2Fgolang%2Fvulndb) You must be signed in to change notification settings
* [Fork
  62](/login?return_to=%2Fgolang%2Fvulndb)
* [Star
   570](/login?return_to=%2Fgolang%2Fvulndb)

* [Code](/golang/vulndb)
* [Issues
  4](/golang/vulndb/issues)
* [Pull requests
  4](/golang/vulndb/pulls)
* [Actions](/golang/vulndb/actions)
* [Security](/golang/vulndb/security)
* [Insights](/golang/vulndb/pulse)

Additional navigation options

* [Code](/golang/vulndb)
* [Issues](/golang/vulndb/issues)
* [Pull requests](/golang/vulndb/pulls)
* [Actions](/golang/vulndb/actions)
* [Security](/golang/vulndb/security)
* [Insights](/golang/vulndb/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgolang%2Fvulndb%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgolang%2Fvulndb%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# x/vulndb: potential Go vuln in github.com/etcd-io/etcd: CVE-2022-34038 #2016

Closed

[GoVulnBot](/GoVulnBot) opened this issue
Aug 22, 2023
· 5 comments

Closed

# [x/vulndb: potential Go vuln in github.com/etcd-io/etcd: CVE-2022-34038](#top) #2016

[GoVulnBot](/GoVulnBot) opened this issue
Aug 22, 2023
· 5 comments

Assignees
[![@maceonthompson](https://avatars.githubusercontent.com/u/39141964?s=40&v=4)](/maceonthompson)

Labels
[excluded: NOT\_A\_VULNERABILITY](/golang/vulndb/labels/excluded%3A%20NOT_A_VULNERABILITY)
This is not a vulnerability.

## Comments

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=80&v=4)](/GoVulnBot)

Copy link

### **[GoVulnBot](/GoVulnBot)** commented [Aug 22, 2023](#issue-1862033789)

| [CVE-2022-34038](https://github.com/advisories/GHSA-65rp-cv85-263x "CVE-2022-34038") references [github.com/etcd-io/etcd](https://github.com/etcd-io/etcd), which may be a Go module.  Description: Etcd v3.5.4 allows remote attackers to cause a denial of service via function PageWriter.write in pagewriter.go  References:   * NIST: <https://nvd.nist.gov/vuln/detail/CVE-2022-34038> * JSON: <https://github.com/CVEProject/cvelist/tree/62ab537d070a2a3f96e8fd27d3e754204f5d5fef/2022/34xxx/CVE-2022-34038.json> * fix: [fix(pkg/ioutil):avoid panic in PageWriter.Write() when pageBytes is 0 etcd-io/etcd#14022](https://github.com/etcd-io/etcd/pull/14022) * fix: [add a verification on the pagebytes which must be > 0 etcd-io/etcd#14452](https://github.com/etcd-io/etcd/pull/14452) * Imported by: <https://pkg.go.dev/github.com/etcd-io/etcd?tab=importedby>   Cross references:   * Module github.com/etcd-io/etcd appears in issue [x/vulndb: potential Go vuln in github.com/etcd-io/etcd: CVE-2021-28235 #1689](https://github.com/golang/vulndb/issues/1689) EFFECTIVELY\_PRIVATE * Module github.com/etcd-io/etcd appears in issue [x/vulndb: potential Go vuln in github.com/etcd-io/etcd: CVE-2023-32082 #1771](https://github.com/golang/vulndb/issues/1771) EFFECTIVELY\_PRIVATE   See [doc/triage.md](https://github.com/golang/vulndb/blob/master/doc/triage.md) for instructions on how to triage this report.  ``` modules:     - module: github.com/etcd-io/etcd       vulnerable_at: 2.3.8+incompatible       packages:         - package: n/a description: |-     Etcd v3.5.4 allows remote attackers to cause a denial of service via function     PageWriter.write in pagewriter.go cves:     - CVE-2022-34038 references:     - fix: https://github.com/etcd-io/etcd/pull/14022     - fix: https://github.com/etcd-io/etcd/pull/14452   ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@maceonthompson](https://avatars.githubusercontent.com/u/39141964?s=40&u=a7e6ed5b584f163c1f9e0fdca1a525d64f9ca476&v=4)](/maceonthompson)
[maceonthompson](/maceonthompson)
self-assigned this
[Aug 23, 2023](#event-10171363113)

[![@maceonthompson](https://avatars.githubusercontent.com/u/39141964?s=40&u=a7e6ed5b584f163c1f9e0fdca1a525d64f9ca476&v=4)](/maceonthompson)
[maceonthompson](/maceonthompson)
added
the
[excluded: EFFECTIVELY\_PRIVATE](/golang/vulndb/labels/excluded%3A%20EFFECTIVELY_PRIVATE)
This vulnerability exists in a package can be imported, but isn't meant to be outside that module.
label
[Aug 23, 2023](#event-10171363700)

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Aug 24, 2023](#issuecomment-1692065471)

| Change <https://go.dev/cl/522555> mentions this issue: `data/excluded: batch add 11 excluded reports` |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)
[gopherbot](/gopherbot)
closed this as [completed](/golang/vulndb/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
`[7fdbb06](/golang/vulndb/commit/7fdbb06ec0fe141ac2471591990c8894857c47f1)`
[Aug 24, 2023](#event-10184318699)

[![@ahrtr](https://avatars.githubusercontent.com/u/30739825?s=80&u=7103d2d37664ace643337a0f648788c72132ae28&v=4)](/ahrtr)

Copy link

### **[ahrtr](/ahrtr)** commented [Aug 29, 2023](#issuecomment-1698004702)

| The only way to trigger this CVE is to dynamically change an [unexported variable's value](https://github.com/etcd-io/etcd/blob/70eb293754ae333a1b2e0d761043bb183ad01726/server/storage/wal/encoder.go#L32) at runtime.  I am curious how can it be done? |
| --- |

All reactions

Sorry, something went wrong.

[![@serathius](https://avatars.githubusercontent.com/u/5873433?s=80&u=db75a9ad7956b6116229c5b05d20c74a5a3e1cab&v=4)](/serathius)

Copy link

### **[serathius](/serathius)** commented [Aug 30, 2023](#issuecomment-1698677762)

| This is some big misunderstanding. Yes, there is a function in etcd util packages called `NewpageWriter`. Yes, you can pass `pageBytes` negative argument, it will cause this function to panic. However, this argument is set based on `const`, not user configurable, neigher remotely.  There is no way to exploit this. Also [etcd-io/etcd#14452](https://github.com/etcd-io/etcd/pull/14452) is not a proper fix, it adds validation that will also panic, but will provide a nice error. |
| --- |

All reactions

Sorry, something went wrong.

[![@maceonthompson](https://avatars.githubusercontent.com/u/39141964?s=40&u=a7e6ed5b584f163c1f9e0fdca1a525d64f9ca476&v=4)](/maceonthompson)
[maceonthompson](/maceonthompson)
added
[excluded: NOT\_A\_VULNERABILITY](/golang/vulndb/labels/excluded%3A%20NOT_A_VULNERABILITY)
This is not a vulnerability.
and removed
[excluded: EFFECTIVELY\_PRIVATE](/golang/vulndb/labels/excluded%3A%20EFFECTIVELY_PRIVATE)
This vulnerability exists in a package can be imported, but isn't meant to be outside that module.
labels
[Aug 30, 2023](#event-10234975076)

[![@maceonthompson](https://avatars.githubusercontent.com/u/39141964?s=80&u=a7e6ed5b584f163c1f9e0fdca1a525d64f9ca476&v=4)](/maceonthompson)

Copy link

### **[maceonthompson](/maceonthompson)** commented [Aug 30, 2023](#issuecomment-1699458463)

| Thanks for pointing this out! It would have been excluded from the database either way, but we'll update the reason to be "not a vuln" |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Aug 30, 2023](#issuecomment-1699465134)

| Change <https://go.dev/cl/524456> mentions this issue: `data/excluded: update GO-2023-2016.yaml` |
| --- |

All reactions

Sorry, something went wrong.

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Aug 30, 2023](#ref-commit-9270f56)

`[data/excluded: update GO-2023-2016.yaml](/golang/vulndb/commit/9270f564efdb346c0a629a5f875a0b3d181533ee "data/excluded: update GO-2023-2016.yaml

Aliases: CVE-2022-34038, GHSA-65rp-cv85-263x

Updates golang/vulndb#2016

Change-Id: I9008796db816c8005579b3f809127d0b2ccef56d
Reviewed-on: https://go-review.googlesource.com/c/vulndb/+/524456
Run-TryBot: Maceo Thompson <maceothompson@google.com>
TryBot-Result: Gopher Robot <gobot@golang.org>
Reviewed-by: Damien Neil <dneil@google.com>")`
…

`[9270f56](/golang/vulndb/commit/9270f564efdb346c0a629a5f875a0b3d181533ee)`

```
Aliases: [CVE-2022-34038](https://github.com/advisories/GHSA-65rp-cv85-263x "CVE-2022-34038"), [GHSA-65rp-cv85-263x](https://github.com/advisories/GHSA-65rp-cv85-263x "GHSA-65rp-cv85-263x")

Updates [#2016](https://github.com/golang/vulndb/issues/2016)

Change-Id: I9008796db816c8005579b3f809127d0b2ccef56d
Reviewed-on: [https://go-review.googlesource.com/c/vulndb/+/524456](https://go-review.googlesource.com/c/vulndb/%2B/524456)
Run-TryBot: Maceo Thompson <maceothompson@google.com>
TryBot-Result: Gopher Robot <gobot@golang.org>
Reviewed-by: Damien Neil <dneil@google.com>
```

[![@reedloden](https://avatars.githubusercontent.com/u/352251?s=40&v=4)](/reedloden)
[reedloden](/reedloden)
mentioned this issue
[Oct 6, 2023](#ref-pullrequest-1931021165)

[[GHSA-65rp-cv85-263x] etcd denial of service vulnerability
github/advisory-database#2825](/github/advisory-database/pull/2825)
 Merged

This was referenced Nov 8, 2023

[x/vulndb: potential Go vuln in github.com/etcd-io/etcd: CVE-2020-15113
#2280](/golang/vulndb/issues/2280)

Closed

[x/vulndb: potential Go vuln in github.com/etcd-io/etcd: CVE-2020-15114
#2281](/golang/vulndb/issues/2281)

Closed

[x/vulndb: potential Go vuln in github.com/etcd-io/etcd: CVE-2020-15136
#2283](/golang/vulndb/issues/2283)

Closed

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this issue
[Jan 31, 2024](#ref-issue-2109020599)

[x/vulndb: potential Go vuln in github.com/etcd-io/etcd: GHSA-chh6-ppwq-jh92
#2484](/golang/vulndb/issues/2484)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fvulndb%2Fissues%2F2016)

Assignees

[![@maceonthompson](https://avatars.githubusercontent.com/u/39141964?s=40&v=4)](/maceonthompson) [maceonthompson](/maceonthompson)

Labels

[excluded: NOT\_A\_VULNERABILITY](/golang/vulndb/labels/excluded%3A%20NOT_A_VULNERABILITY)
This is not a vulnerability.

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

5 participants

[![@serathius](https://avatars.githubusercontent.com/u/5873433?s=52&v=4)](/serathius) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=52&v=4)](/gopherbot) [![@ahrtr](https://avatars.githubusercontent.com/u/30739825?s=52&v=4)](/ahrtr) [![@maceonthompson](https://avatars.githubusercontent.com/u/39141964?s=52&v=4)](/maceonthompson) [![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=52&v=4)](/GoVulnBot)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

