- **Root cause:** Vtiger CRM's `MailManager::lookupMailInVtiger` function constructs SQL queries using string concatenation with user-supplied input in the `WHERE LIKE` condition. When searching in the `Users` module with a non-admin user, the query is passed to the `pquery` function, which executes the SQL query directly without proper sanitization.
- **Weaknesses/vulnerabilities:** SQL injection vulnerability due to unsanitized user input in SQL queries, specifically within the `MailManager` module when querying the `Users` module with a non-admin user. Broken access control can be chained with the SQLi to achieve exploitation.
- **Impact:** An authenticated non-administrative attacker can exploit the SQL injection vulnerability to leak sensitive data from the Vtiger database, such as usernames and password hashes.
- **Attack vectors:**
    -  An authenticated low-privilege user sends a crafted POST request to the `/index.php` endpoint with the `MailManager` module, `search` operation and a malicious payload in the `q` parameter.
    -  The attacker needs to know a valid PHPSESSID cookie and a valid CSRF token
    -  The attacker should first disable all modules but `Users` from an admin account.
- **Required attacker capabilities/position:**
    - The attacker must have a valid account with non-administrative privileges in the Vtiger CRM application.
    - The attacker must know a valid PHPSESSID cookie and a valid CSRF token.
    - The attacker must be able to send POST requests to the vulnerable endpoint.
    - The attacker must first disable all modules but `Users` from an admin account.