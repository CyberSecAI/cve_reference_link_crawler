The provided content relates to CVE-2023-5810.

**Root cause of vulnerability:**
The vulnerability is due to the lack of sanitization of the `edit_post_id` parameter in the `posts.php` file. The value of this parameter, taken directly from the URL, is directly injected into a JavaScript block without proper encoding or sanitization.

**Weaknesses/vulnerabilities present:**
- Cross-Site Scripting (XSS): The primary vulnerability is an XSS vulnerability. The lack of input sanitization for the `edit_post_id` parameter allows an attacker to inject malicious JavaScript code into the page.

**Impact of exploitation:**
- Arbitrary JavaScript execution: An attacker can execute arbitrary JavaScript code in the context of the victim's browser. This can lead to various malicious activities, including:
  - Session hijacking
  - Stealing cookies
  - Redirecting users to malicious websites
  - Defacing the website
  - Performing actions on behalf of the user.

**Attack vectors:**
- The attack vector is through a crafted URL containing the `edit_post_id` parameter with the malicious payload. For example: `?edit_post_id=3);</script><script>alert(1024)</script>`

**Required attacker capabilities/position:**
- The attacker needs to be able to craft a malicious URL and trick a user into accessing it. This could be done via social engineering or by embedding the malicious link on another website.
- The attacker does not need to be authenticated to exploit this vulnerability, but would require the user to be logged into the backend.

**Additional Details:**
The provided content shows the vulnerable code and the fix implemented by the developer. The vulnerable code was located in `core/tools/posts.php` at line 274:

```php
if (isset($_GET['edit_post_id'])) {
    $edit_post_id = $_GET['edit_post_id'];
    echo "<script>loadPostEditForm($edit_post_id);</script>";
}
```
The fix involved using `filter_input` and `htmlspecialchars` to sanitize the input:
```php
if (isset($_GET['edit_post_id'])) {
    $edit_post_id = filter_input(INPUT_GET, 'edit_post_id', FILTER_SANITIZE_NUMBER_INT);
    $safe_edit_post_id = htmlspecialchars($edit_post_id, ENT_QUOTES, 'UTF-8');
    echo "<script>loadPostEditForm($safe_edit_post_id);</script>";
}
```