
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmojolicious%2Fmojo%2Fissues%2F1736)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmojolicious%2Fmojo%2Fissues%2F1736)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=mojolicious%2Fmojo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mojolicious](/mojolicious)
/
**[mojo](/mojolicious/mojo)**
Public

* [Notifications](/login?return_to=%2Fmojolicious%2Fmojo) You must be signed in to change notification settings
* [Fork
  581](/login?return_to=%2Fmojolicious%2Fmojo)
* [Star
   2.7k](/login?return_to=%2Fmojolicious%2Fmojo)

* [Code](/mojolicious/mojo)
* [Issues
  68](/mojolicious/mojo/issues)
* [Pull requests
  22](/mojolicious/mojo/pulls)
* [Discussions](/mojolicious/mojo/discussions)
* [Actions](/mojolicious/mojo/actions)
* [Projects
  0](/mojolicious/mojo/projects)
* [Wiki](/mojolicious/mojo/wiki)
* [Security](/mojolicious/mojo/security)
* [Insights](/mojolicious/mojo/pulse)

Additional navigation options

* [Code](/mojolicious/mojo)
* [Issues](/mojolicious/mojo/issues)
* [Pull requests](/mojolicious/mojo/pulls)
* [Discussions](/mojolicious/mojo/discussions)
* [Actions](/mojolicious/mojo/actions)
* [Projects](/mojolicious/mojo/projects)
* [Wiki](/mojolicious/mojo/wiki)
* [Security](/mojolicious/mojo/security)
* [Insights](/mojolicious/mojo/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmojolicious%2Fmojo%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmojolicious%2Fmojo%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Template in render can't work. #1736

Closed

[darrenli912](/darrenli912) opened this issue
Mar 16, 2021
· 18 comments

Closed

# [Template in render can't work.](#top) #1736

[darrenli912](/darrenli912) opened this issue
Mar 16, 2021
· 18 comments

Labels
[bug](/mojolicious/mojo/labels/bug)
[help wanted](/mojolicious/mojo/labels/help%20wanted)
[security](/mojolicious/mojo/labels/security)

## Comments

[![@darrenli912](https://avatars.githubusercontent.com/u/5398035?s=80&v=4)](/darrenli912)

Copy link

### **[darrenli912](/darrenli912)** commented [Mar 16, 2021](#issue-832533204)

| * Mojolicious version: 9.07 * Perl version: 5.30.0 * Operating system: ubuntu  Steps to reproduce the behavior  1. Generate a mojolicious app.    Change the route:    $r->get('/index')->to('example#welcome');    Set the template in code:    $self->render(template => 'example/welcome',msg => 'Welcome to the Mojolicious real-time web framework!'); 2. Run: morbo ./script/my\_app    GET <http://127.0.0.1:3000/index.html#1212> Works well. 3. Get the error:    GET <http://127.0.0.1:3000/index.html%231212>    [2021-03-16 15:58:17.43341] [199062] [debug] [7CDPRtIY] Routing to controller "MyApp::Controller::Example" and action "welcome"    [2021-03-16 15:58:17.43450] [199062] [debug] [7CDPRtIY] Template "example/welcome.html#1212.ep" not found    [2021-03-16 15:58:17.43743] [199062] [error] [7CDPRtIY] Could not render a response at /usr/local/share/perl/5.30.0/Mojolicious.pm line 190.  From the error log, the template is changed to example/welcome.html#1212.ep and return 505 error.  Expected behavior Render the template correctly or return 404 error instead of 505 error. Actual behavior System error. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=80&v=4)](/kraih)

Copy link

Member

### **[kraih](/kraih)** commented [Mar 16, 2021](#issuecomment-800276503)

| I'm seeing a 404 response, as expected. You must be doing something else wrong. |
| --- |

All reactions

Sorry, something went wrong.

[![@darrenli912](https://avatars.githubusercontent.com/u/5398035?s=80&v=4)](/darrenli912)

Copy link

Author

### **[darrenli912](/darrenli912)** commented [Mar 16, 2021](#issuecomment-800301973)

| Hi, Kraih  No, the problem exists.  You must visit the url that end with .html to get the problem. For example /index.html%231212  The following are my test codes. Please check.  package MyApp; use Mojo::Base 'Mojolicious', -signatures;  sub startup ($self) {  my $config = $self->plugin('NotYAMLConfig');  $self->secrets($config->{secrets});  my $r = $self->routes;  $r->get('/index')->to('example#welcome'); }  1;  package MyApp::Controller::Example; use Mojo::Base 'Mojolicious::Controller', -signatures;  sub welcome ($self) {  $self->render(templaet => 'example/welcome',msg => 'Welcome to the Mojolicious real-time web framework!'); } |
| --- |

All reactions

Sorry, something went wrong.

[![@apodran](https://avatars.githubusercontent.com/u/4117625?s=80&v=4)](/apodran)

Copy link

### **[apodran](/apodran)** commented [Mar 16, 2021](#issuecomment-800318447)

| It looks related to my problem. I am getting 500 Internal Server Error after upgrade instead of 404 Not Found. For example, it tries to find a wrong template for the route with messages like: `"Template "policiespolicy_idnumpool_assignmentsidnum.json.ep" not found`  For the route `/policies/<policy_id:num>/pool_assignments/<id:num>` and `format => 'json'`. |
| --- |

All reactions

Sorry, something went wrong.

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=80&v=4)](/kraih)

Copy link

Member

### **[kraih](/kraih)** commented [Mar 16, 2021](#issuecomment-800362582)

| If you don't want format detection you should just disable it. |
| --- |

All reactions

Sorry, something went wrong.

[![@apodran](https://avatars.githubusercontent.com/u/4117625?s=80&v=4)](/apodran)

Copy link

### **[apodran](/apodran)** commented [Mar 16, 2021](#issuecomment-800372935)

| I am sorry for misunderstanding, I will try to explain the problem better.  Before upgrade (Mojolicious 8.58) my code rendered well for both status 200 and NotFound 404. But after upgrade to Mojolicious 9.10 something new happened. If the content is rendered (status 200) all still works well, but lines like `$c->render(status => 404)` now try to find some specific weird template names like `policiespolicy_idnumpool_assignmentsidnum.json.ep` instead of the not\_found one (`not_found.json.ep`). |
| --- |

All reactions

Sorry, something went wrong.

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=80&v=4)](/kraih)

Copy link

Member

### **[kraih](/kraih)** commented [Mar 16, 2021](#issuecomment-800397942)

| Ah, i see. We changed most rendering and routing errors to result in 500 instead of 404 responses. That is intended behaviour. |
| --- |

All reactions

Sorry, something went wrong.

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=80&v=4)](/kraih)

Copy link

Member

### **[kraih](/kraih)** commented [Mar 16, 2021](#issuecomment-800398650)

| The specific changes were discussed in [#1663](https://github.com/mojolicious/mojo/discussions/1663). |
| --- |

All reactions

Sorry, something went wrong.

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=80&v=4)](/kraih)

Copy link

Member

### **[kraih](/kraih)** commented [Mar 16, 2021](#issuecomment-800467085) • edited Loading

| Ok, i'm calling this a bug. The problem is not that a missing template results in a 500 error, that's fine. But that by default anyone can trigger a 500 error with a bad format value. Possibly spamming the logs with useless error level messages.  I do not have a solution however, other than disabling [format detection](https://docs.mojolicious.org/Mojolicious/Guides/Routing#Formats), limiting the formats your routes accept, or hardcoding the format to the render call.  ``` my $inactive = $r->under([format => 0]); $inactive->get('/foo')->to('foo#bar'); ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=40&v=4)](/kraih)
[kraih](/kraih)
added
the
[bug](/mojolicious/mojo/labels/bug)
label
[Mar 16, 2021](#event-4465994815)

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=80&v=4)](/kraih)

Copy link

Member

### **[kraih](/kraih)** commented [Mar 16, 2021](#issuecomment-800473850)

| The case can also be observed on <https://mojolicious.org/.yaml>. |
| --- |

All reactions

Sorry, something went wrong.

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=40&v=4)](/kraih)
[kraih](/kraih)
added
the
[security](/mojolicious/mojo/labels/security)
label
[Mar 16, 2021](#event-4466340490)

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=80&v=4)](/kraih)

Copy link

Member

### **[kraih](/kraih)** commented [Mar 16, 2021](#issuecomment-800518863)

| Depending on how your monitoring is set up this has the potential to be exploited for a DoS attack. So we will consider this a security issue, but a fairly harmless. |
| --- |

All reactions

Sorry, something went wrong.

[![@apodran](https://avatars.githubusercontent.com/u/4117625?s=80&v=4)](/apodran)

Copy link

### **[apodran](/apodran)** commented [Mar 16, 2021](#issuecomment-800545752) • edited Loading

| Thank you. All became clearer. Looks like I found a solution according to these changes, so my 'not\_found' template is working now:  ```   $c->reply->not_found;  ```  instead of  ```   $c->render(status => 404);  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=80&v=4)](/kraih)

Copy link

Member

### **[kraih](/kraih)** commented [Mar 16, 2021](#issuecomment-800584695)

| `$c->render(status => 404);` has always been completely wrong, if it worked that was purely by accident. Just so nobody else gets confused, that has nothing to do with the actual bug here. |
| --- |

All reactions

Sorry, something went wrong.

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=80&v=4)](/kraih)

Copy link

Member

### **[kraih](/kraih)** commented [Mar 16, 2021](#issuecomment-800587761)

| And regarding actual solutions, ideally we would have just gotten rid of the code that propagates format values from the router to the `stash` with the 9.0 release. Having visitors to your site affect the renderer outside of real content negotiation with `respond_to` is just completely unnecessary. Maybe we still have to do that if nobody finds a better solution. It would be a little disruptive. |
| --- |

All reactions

Sorry, something went wrong.

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=40&v=4)](/kraih)
[kraih](/kraih)
added
the
[help wanted](/mojolicious/mojo/labels/help%20wanted)
label
[Mar 17, 2021](#event-4471506796)

[![@shadowcat-mst](https://avatars.githubusercontent.com/u/252821?s=80&v=4)](/shadowcat-mst)

Copy link

Contributor

### **[shadowcat-mst](/shadowcat-mst)** commented [Mar 19, 2021](#issuecomment-803156903)

| We're clearly having a lot of "fun" trying to work out what's best.  What about just flipping the default for automagic format detection to 0 and letting people who still want it do  ``` ->under({ format => 1 })  ```  for the moment and that'll eliminate the footgunnery but let current users opt in and then we can figure out something more solid in our own time? |
| --- |

All reactions

Sorry, something went wrong.

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=40&v=4)](/kraih)
[kraih](/kraih)
closed this as [completed](/mojolicious/mojo/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
`[a0c4576](/mojolicious/mojo/commit/a0c4576ffb11c235088550de9ba7ac4196e1953c)`
[Mar 20, 2021](#event-4484964928)

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=80&v=4)](/kraih)

Copy link

Member

### **[kraih](/kraih)** commented [Mar 20, 2021](#issuecomment-803431105)

| Thank you, this issue has been resolved in the 9.11 release. |
| --- |

All reactions

Sorry, something went wrong.

[![@hansquintes](https://avatars.githubusercontent.com/u/49492490?s=80&v=4)](/hansquintes)

Copy link

### **[hansquintes](/hansquintes)** commented [Oct 4, 2021](#issuecomment-933621420)

| Could this fix also affect the following construct?  ``` post '/api/v1/user/:vuserid/:tset/name/*vname' => [vuserid => qr/\d+/, tset => ['set']] => {tset => undef} => sub ($c) {}  /api/v1/user/123456/name/Emilia       -> does not work unless "format => 1" is there /api/v1/user/123456/set/name/Emilia   -> works  ``` |
| --- |

All reactions

Sorry, something went wrong.

[karenetheridge](/karenetheridge)
pushed a commit
to karenetheridge/Mojolicious
that referenced
this issue
[Sep 20, 2023](#ref-commit-2b29361)
[![@kraih](https://avatars.githubusercontent.com/u/30094?s=40&v=4)](/kraih) [![@karenetheridge](https://avatars.githubusercontent.com/u/303051?s=40&v=4)](/karenetheridge)

`[Flip format detection to fix a security issue (](/karenetheridge/Mojolicious/commit/2b293616f226c53968dfd8f6d29d3dc8c5425736 "Flip format detection to fix a security issue (closes #1736)")[closes](/karenetheridge/Mojolicious/commit/2b293616f226c53968dfd8f6d29d3dc8c5425736 "Flip format detection to fix a security issue (closes #1736)") [mojolicious#1736](https://github.com/mojolicious/mojo/issues/1736)[)](/karenetheridge/Mojolicious/commit/2b293616f226c53968dfd8f6d29d3dc8c5425736 "Flip format detection to fix a security issue (closes #1736)")`

`[2b29361](/karenetheridge/Mojolicious/commit/2b293616f226c53968dfd8f6d29d3dc8c5425736)`

[![@ltl1A](https://avatars.githubusercontent.com/u/34237635?s=80&v=4)](/ltl1A)

Copy link

### **[ltl1A](/ltl1A)** commented [Jul 3, 2024](#issuecomment-2205013380)

| Does this issue exist on lower versions, such as version 8.06 |
| --- |

All reactions

Sorry, something went wrong.

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=80&v=4)](/kraih)

Copy link

Member

### **[kraih](/kraih)** commented [Jul 3, 2024](#issuecomment-2205287938)

| Does this issue exist on lower versions, such as version 8.06  Yes. |
| --- |

All reactions

Sorry, something went wrong.

[ltl1A](/ltl1A)
pushed a commit
to ltl1A/mojo
that referenced
this issue
[Jul 3, 2024](#ref-commit-75de3a1)

`[Flip format detection to fix a security issue (](/ltl1A/mojo/commit/75de3a137d82cdabebf538279131081e144983b8 "Flip format detection to fix a security issue (closes #1736)")[closes](/ltl1A/mojo/commit/75de3a137d82cdabebf538279131081e144983b8 "Flip format detection to fix a security issue (closes #1736)") [mojolicious#1736](https://github.com/mojolicious/mojo/issues/1736)[)](/ltl1A/mojo/commit/75de3a137d82cdabebf538279131081e144983b8 "Flip format detection to fix a security issue (closes #1736)")`

`[75de3a1](/ltl1A/mojo/commit/75de3a137d82cdabebf538279131081e144983b8)`

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmojolicious%2Fmojo%2Fissues%2F1736)

Assignees

No one assigned

Labels

[bug](/mojolicious/mojo/labels/bug)
[help wanted](/mojolicious/mojo/labels/help%20wanted)
[security](/mojolicious/mojo/labels/security)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

6 participants

[![@kraih](https://avatars.githubusercontent.com/u/30094?s=52&v=4)](/kraih) [![@shadowcat-mst](https://avatars.githubusercontent.com/u/252821?s=52&v=4)](/shadowcat-mst) [![@apodran](https://avatars.githubusercontent.com/u/4117625?s=52&v=4)](/apodran) [![@darrenli912](https://avatars.githubusercontent.com/u/5398035?s=52&v=4)](/darrenli912) [![@ltl1A](https://avatars.githubusercontent.com/u/34237635?s=52&v=4)](/ltl1A) [![@hansquintes](https://avatars.githubusercontent.com/u/49492490?s=52&v=4)](/hansquintes)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

