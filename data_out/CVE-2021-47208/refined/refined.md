The provided content relates to CVE-2021-47208.

**Root cause of vulnerability:**
The vulnerability stems from how Mojolicious handles format detection in routes. Specifically, it automatically propagates format values from the router to the stash, which can be influenced by user-provided input through file extensions in URLs. This behavior allows an attacker to manipulate the format value, leading to the application attempting to render non-existent template files, and triggering 500 errors, potentially spamming logs and causing a denial-of-service (DoS).

**Weaknesses/vulnerabilities present:**
- **Uncontrolled Format Detection:** The application automatically detects the format from the URL file extension and uses it to determine which template to render.
- **Propagation of Format Values:**  Format values are passed from the router to the stash, allowing user-controlled input to influence template rendering.
- **Error Handling:**  Missing template errors result in 500 Internal Server Error instead of 404 Not Found, which can be abused.

**Impact of exploitation:**
- **Denial of Service (DoS):** An attacker can cause a DoS by repeatedly sending requests with invalid format extensions, which will cause the application to try to render non-existent templates and generate 500 errors, potentially overwhelming the server.
- **Log Spamming:** Repeatedly triggering the vulnerability can cause log files to be flooded with error messages.

**Attack vectors:**
- **URL manipulation:** Appending arbitrary file extensions to URLs to trigger format detection. For example, `/index.html%231212`, or `/foo.some_invalid_format`

**Required attacker capabilities/position:**
- The attacker needs the ability to send HTTP requests to the web application.
- No special privileges or authentication is required.