
[Bandit](../index.html)
1.7.8

* [Getting Started](../start.html)
* [Configuration](../config.html)
* [Test Plugins](index.html)
  + [Writing Tests](index.html#writing-tests)
  + [Config Generation](index.html#config-generation)
  + [Example Test Plugin](index.html#example-test-plugin)
  + [Plugin ID Groupings](index.html#plugin-id-groupings)
  + [Complete Test Plugin Listing](index.html#complete-test-plugin-listing)
    - [B101: assert\_used](b101_assert_used.html)
    - [B102: exec\_used](b102_exec_used.html)
    - [B103: set\_bad\_file\_permissions](b103_set_bad_file_permissions.html)
    - [B104: hardcoded\_bind\_all\_interfaces](b104_hardcoded_bind_all_interfaces.html)
    - [B105: hardcoded\_password\_string](b105_hardcoded_password_string.html)
    - [B106: hardcoded\_password\_funcarg](b106_hardcoded_password_funcarg.html)
    - [B107: hardcoded\_password\_default](b107_hardcoded_password_default.html)
    - [B108: hardcoded\_tmp\_directory](b108_hardcoded_tmp_directory.html)
    - [B109: password\_config\_option\_not\_marked\_secret](b109_password_config_option_not_marked_secret.html)
    - [B110: try\_except\_pass](b110_try_except_pass.html)
    - [B111: execute\_with\_run\_as\_root\_equals\_true](b111_execute_with_run_as_root_equals_true.html)
    - [B112: try\_except\_continue](b112_try_except_continue.html)
    - [B113: request\_without\_timeout](b113_request_without_timeout.html)
    - [B201: flask\_debug\_true](b201_flask_debug_true.html)
    - [B202: tarfile\_unsafe\_members](b202_tarfile_unsafe_members.html)
    - [B324: hashlib](b324_hashlib.html)
    - [B501: request\_with\_no\_cert\_validation](b501_request_with_no_cert_validation.html)
    - [B502: ssl\_with\_bad\_version](b502_ssl_with_bad_version.html)
    - [B503: ssl\_with\_bad\_defaults](b503_ssl_with_bad_defaults.html)
    - [B504: ssl\_with\_no\_version](b504_ssl_with_no_version.html)
    - [B505: weak\_cryptographic\_key](b505_weak_cryptographic_key.html)
    - [B506: yaml\_load](b506_yaml_load.html)
    - [B507: ssh\_no\_host\_key\_verification](b507_ssh_no_host_key_verification.html)
    - [B508: snmp\_insecure\_version](b508_snmp_insecure_version.html)
    - [B509: snmp\_weak\_cryptography](b509_snmp_weak_cryptography.html)
    - [B601: paramiko\_calls](b601_paramiko_calls.html)
    - B602: subprocess\_popen\_with\_shell\_equals\_true
    - [B603: subprocess\_without\_shell\_equals\_true](b603_subprocess_without_shell_equals_true.html)
    - [B604: any\_other\_function\_with\_shell\_equals\_true](b604_any_other_function_with_shell_equals_true.html)
    - [B605: start\_process\_with\_a\_shell](b605_start_process_with_a_shell.html)
    - [B606: start\_process\_with\_no\_shell](b606_start_process_with_no_shell.html)
    - [B607: start\_process\_with\_partial\_path](b607_start_process_with_partial_path.html)
    - [B608: hardcoded\_sql\_expressions](b608_hardcoded_sql_expressions.html)
    - [B609: linux\_commands\_wildcard\_injection](b609_linux_commands_wildcard_injection.html)
    - [B610: django\_extra\_used](b610_django_extra_used.html)
    - [B611: django\_rawsql\_used](b611_django_rawsql_used.html)
    - [B612: logging\_config\_insecure\_listen](b612_logging_config_insecure_listen.html)
    - [B701: jinja2\_autoescape\_false](b701_jinja2_autoescape_false.html)
    - [B702: use\_of\_mako\_templates](b702_use_of_mako_templates.html)
    - [B703: django\_mark\_safe](b703_django_mark_safe.html)
* [Blacklist Plugins](../blacklists/index.html)
* [Report Formatters](../formatters/index.html)
* [Frequently Asked Questions](../faq.html)

[Bandit](../index.html)

* [Test Plugins](index.html)
* B602: subprocess\_popen\_with\_shell\_equals\_true
* [Edit on GitHub](https://github.com/PyCQA/bandit/blob/1.7.8/doc/source/plugins/b602_subprocess_popen_with_shell_equals_true.rst)

---

# B602: subprocess\_popen\_with\_shell\_equals\_true[](#b602-subprocess-popen-with-shell-equals-true "Permalink to this heading")

bandit.plugins.injection\_shell.subprocess\_popen\_with\_shell\_equals\_true(*context*, *config*)[[source]](../_modules/bandit/plugins/injection_shell.html#subprocess_popen_with_shell_equals_true)

**B602: Test for use of popen with shell equals true**

Python possesses many mechanisms to invoke an external executable. However,
doing so may present a security issue if appropriate care is not taken to
sanitize any user provided or variable input.

This plugin test is part of a family of tests built to check for process
spawning and warn appropriately. Specifically, this test looks for the
spawning of a subprocess using a command shell. This type of subprocess
invocation is dangerous as it is vulnerable to various shell injection
attacks. Great care should be taken to sanitize all input in order to
mitigate this risk. Calls of this type are identified by a parameter of
‘shell=True’ being given.

Additionally, this plugin scans the command string given and adjusts its
reported severity based on how it is presented. If the command string is a
simple static string containing no special shell characters, then the
resulting issue has low severity. If the string is static, but contains
shell formatting characters or wildcards, then the reported issue is
medium. Finally, if the string is computed using Python’s string
manipulation or formatting operations, then the reported issue has high
severity. These severity levels reflect the likelihood that the code is
vulnerable to injection.

See also:

* ../plugins/linux\_commands\_wildcard\_injection
* ../plugins/subprocess\_without\_shell\_equals\_true
* ../plugins/start\_process\_with\_no\_shell
* ../plugins/start\_process\_with\_a\_shell
* ../plugins/start\_process\_with\_partial\_path

**Config Options:**

This plugin test shares a configuration with others in the same family,
namely shell\_injection. This configuration is divided up into three
sections, subprocess, shell and no\_shell. They each list Python calls
that spawn subprocesses, invoke commands within a shell, or invoke commands
without a shell (by replacing the calling process) respectively.

This plugin specifically scans for methods listed in subprocess section
that have shell=True specified.

```
shell_injection:

    # Start a process using the subprocess module, or one of its
    wrappers.
    subprocess:
        - subprocess.Popen
        - subprocess.call

```

Example:

```
>> Issue: subprocess call with shell=True seems safe, but may be
changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   Location: ./examples/subprocess_shell.py:21
20  subprocess.check_call(['/bin/ls', '-l'], shell=False)
21  subprocess.check_call('/bin/ls -l', shell=True)
22

>> Issue: call with shell=True contains special shell characters,
consider moving extra logic into Python code
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   Location: ./examples/subprocess_shell.py:26
25
26  subprocess.Popen('/bin/ls *', shell=True)
27  subprocess.Popen('/bin/ls %s' % ('something',), shell=True)

>> Issue: subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   Location: ./examples/subprocess_shell.py:27
26  subprocess.Popen('/bin/ls *', shell=True)
27  subprocess.Popen('/bin/ls %s' % ('something',), shell=True)
28  subprocess.Popen('/bin/ls {}'.format('something'), shell=True)

```

See also

* <https://security.openstack.org>
* <https://docs.python.org/3/library/subprocess.html#frequently-used-arguments>
* <https://security.openstack.org/guidelines/dg_use-subprocess-securely.html>
* <https://security.openstack.org/guidelines/dg_avoid-shell-true.html>
* <https://cwe.mitre.org/data/definitions/78.html>

New in version 0.9.0.

Changed in version 1.7.3: CWE information added

 [Previous](b601_paramiko_calls.html "B601: paramiko_calls")
[Next](b603_subprocess_without_shell_equals_true.html "B603: subprocess_without_shell_equals_true")

---

© Copyright 2024, Bandit Developers.
Revision `22b42260`.

Built with [Sphinx](https://www.sphinx-doc.org/) using a
[theme](https://github.com/readthedocs/sphinx_rtd_theme)
provided by [Read the Docs](https://readthedocs.org).

