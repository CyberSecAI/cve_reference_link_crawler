<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>B602: subprocess_popen_with_shell_equals_true &mdash; Bandit  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=b3ba4146"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="B603: subprocess_without_shell_equals_true" href="b603_subprocess_without_shell_equals_true.html" />
    <link rel="prev" title="B601: paramiko_calls" href="b601_paramiko_calls.html" /> 

<!-- RTD Extra Head -->



<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": false, "api_host": "https://readthedocs.org", "builder": "sphinx", "canonical_url": null, "docroot": "/doc/source/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "plugins/b602_subprocess_popen_with_shell_equals_true", "programming_language": "py", "project": "bandit", "proxied_api_host": "/_", "source_suffix": ".rst", "subprojects": {}, "theme": "sphinx_rtd_theme", "user_analytics_code": "", "version": "1.7.8"}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>



<!-- end RTD <extrahead> -->
<script async type="text/javascript" src="/_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="bandit" /><meta name="readthedocs-version-slug" content="1.7.8" /><meta name="readthedocs-resolver-filename" content="/plugins/b602_subprocess_popen_with_shell_equals_true.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Bandit
          </a>
              <div class="version">
                1.7.8
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Test Plugins</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#writing-tests">Writing Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#config-generation">Config Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#example-test-plugin">Example Test Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#plugin-id-groupings">Plugin ID Groupings</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#complete-test-plugin-listing">Complete Test Plugin Listing</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="b101_assert_used.html">B101: assert_used</a></li>
<li class="toctree-l3"><a class="reference internal" href="b102_exec_used.html">B102: exec_used</a></li>
<li class="toctree-l3"><a class="reference internal" href="b103_set_bad_file_permissions.html">B103: set_bad_file_permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="b104_hardcoded_bind_all_interfaces.html">B104: hardcoded_bind_all_interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="b105_hardcoded_password_string.html">B105: hardcoded_password_string</a></li>
<li class="toctree-l3"><a class="reference internal" href="b106_hardcoded_password_funcarg.html">B106: hardcoded_password_funcarg</a></li>
<li class="toctree-l3"><a class="reference internal" href="b107_hardcoded_password_default.html">B107: hardcoded_password_default</a></li>
<li class="toctree-l3"><a class="reference internal" href="b108_hardcoded_tmp_directory.html">B108: hardcoded_tmp_directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="b109_password_config_option_not_marked_secret.html">B109: password_config_option_not_marked_secret</a></li>
<li class="toctree-l3"><a class="reference internal" href="b110_try_except_pass.html">B110: try_except_pass</a></li>
<li class="toctree-l3"><a class="reference internal" href="b111_execute_with_run_as_root_equals_true.html">B111: execute_with_run_as_root_equals_true</a></li>
<li class="toctree-l3"><a class="reference internal" href="b112_try_except_continue.html">B112: try_except_continue</a></li>
<li class="toctree-l3"><a class="reference internal" href="b113_request_without_timeout.html">B113: request_without_timeout</a></li>
<li class="toctree-l3"><a class="reference internal" href="b201_flask_debug_true.html">B201: flask_debug_true</a></li>
<li class="toctree-l3"><a class="reference internal" href="b202_tarfile_unsafe_members.html">B202: tarfile_unsafe_members</a></li>
<li class="toctree-l3"><a class="reference internal" href="b324_hashlib.html">B324: hashlib</a></li>
<li class="toctree-l3"><a class="reference internal" href="b501_request_with_no_cert_validation.html">B501: request_with_no_cert_validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="b502_ssl_with_bad_version.html">B502: ssl_with_bad_version</a></li>
<li class="toctree-l3"><a class="reference internal" href="b503_ssl_with_bad_defaults.html">B503: ssl_with_bad_defaults</a></li>
<li class="toctree-l3"><a class="reference internal" href="b504_ssl_with_no_version.html">B504: ssl_with_no_version</a></li>
<li class="toctree-l3"><a class="reference internal" href="b505_weak_cryptographic_key.html">B505: weak_cryptographic_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="b506_yaml_load.html">B506: yaml_load</a></li>
<li class="toctree-l3"><a class="reference internal" href="b507_ssh_no_host_key_verification.html">B507: ssh_no_host_key_verification</a></li>
<li class="toctree-l3"><a class="reference internal" href="b508_snmp_insecure_version.html">B508: snmp_insecure_version</a></li>
<li class="toctree-l3"><a class="reference internal" href="b509_snmp_weak_cryptography.html">B509: snmp_weak_cryptography</a></li>
<li class="toctree-l3"><a class="reference internal" href="b601_paramiko_calls.html">B601: paramiko_calls</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">B602: subprocess_popen_with_shell_equals_true</a></li>
<li class="toctree-l3"><a class="reference internal" href="b603_subprocess_without_shell_equals_true.html">B603: subprocess_without_shell_equals_true</a></li>
<li class="toctree-l3"><a class="reference internal" href="b604_any_other_function_with_shell_equals_true.html">B604: any_other_function_with_shell_equals_true</a></li>
<li class="toctree-l3"><a class="reference internal" href="b605_start_process_with_a_shell.html">B605: start_process_with_a_shell</a></li>
<li class="toctree-l3"><a class="reference internal" href="b606_start_process_with_no_shell.html">B606: start_process_with_no_shell</a></li>
<li class="toctree-l3"><a class="reference internal" href="b607_start_process_with_partial_path.html">B607: start_process_with_partial_path</a></li>
<li class="toctree-l3"><a class="reference internal" href="b608_hardcoded_sql_expressions.html">B608: hardcoded_sql_expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="b609_linux_commands_wildcard_injection.html">B609: linux_commands_wildcard_injection</a></li>
<li class="toctree-l3"><a class="reference internal" href="b610_django_extra_used.html">B610: django_extra_used</a></li>
<li class="toctree-l3"><a class="reference internal" href="b611_django_rawsql_used.html">B611: django_rawsql_used</a></li>
<li class="toctree-l3"><a class="reference internal" href="b612_logging_config_insecure_listen.html">B612: logging_config_insecure_listen</a></li>
<li class="toctree-l3"><a class="reference internal" href="b701_jinja2_autoescape_false.html">B701: jinja2_autoescape_false</a></li>
<li class="toctree-l3"><a class="reference internal" href="b702_use_of_mako_templates.html">B702: use_of_mako_templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="b703_django_mark_safe.html">B703: django_mark_safe</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../blacklists/index.html">Blacklist Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../formatters/index.html">Report Formatters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Bandit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Test Plugins</a></li>
      <li class="breadcrumb-item active">B602: subprocess_popen_with_shell_equals_true</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/PyCQA/bandit/blob/1.7.8/doc/source/plugins/b602_subprocess_popen_with_shell_equals_true.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="b602-subprocess-popen-with-shell-equals-true">
<h1>B602: subprocess_popen_with_shell_equals_true<a class="headerlink" href="#b602-subprocess-popen-with-shell-equals-true" title="Permalink to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">bandit.plugins.injection_shell.</span></span><span class="sig-name descname"><span class="pre">subprocess_popen_with_shell_equals_true</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bandit/plugins/injection_shell.html#subprocess_popen_with_shell_equals_true"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p><strong>B602: Test for use of popen with shell equals true</strong></p>
<p>Python possesses many mechanisms to invoke an external executable. However,
doing so may present a security issue if appropriate care is not taken to
sanitize any user provided or variable input.</p>
<p>This plugin test is part of a family of tests built to check for process
spawning and warn appropriately. Specifically, this test looks for the
spawning of a subprocess using a command shell. This type of subprocess
invocation is dangerous as it is vulnerable to various shell injection
attacks. Great care should be taken to sanitize all input in order to
mitigate this risk. Calls of this type are identified by a parameter of
‘shell=True’ being given.</p>
<p>Additionally, this plugin scans the command string given and adjusts its
reported severity based on how it is presented. If the command string is a
simple static string containing no special shell characters, then the
resulting issue has low severity. If the string is static, but contains
shell formatting characters or wildcards, then the reported issue is
medium. Finally, if the string is computed using Python’s string
manipulation or formatting operations, then the reported issue has high
severity. These severity levels reflect the likelihood that the code is
vulnerable to injection.</p>
<p>See also:</p>
<ul class="simple">
<li><p><span class="xref std std-doc">../plugins/linux_commands_wildcard_injection</span></p></li>
<li><p><span class="xref std std-doc">../plugins/subprocess_without_shell_equals_true</span></p></li>
<li><p><span class="xref std std-doc">../plugins/start_process_with_no_shell</span></p></li>
<li><p><span class="xref std std-doc">../plugins/start_process_with_a_shell</span></p></li>
<li><p><span class="xref std std-doc">../plugins/start_process_with_partial_path</span></p></li>
</ul>
<p><strong>Config Options:</strong></p>
<p>This plugin test shares a configuration with others in the same family,
namely <cite>shell_injection</cite>. This configuration is divided up into three
sections, <cite>subprocess</cite>, <cite>shell</cite> and <cite>no_shell</cite>. They each list Python calls
that spawn subprocesses, invoke commands within a shell, or invoke commands
without a shell (by replacing the calling process) respectively.</p>
<p>This plugin specifically scans for methods listed in <cite>subprocess</cite> section
that have shell=True specified.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">shell_injection</span><span class="p">:</span>

<span class="w">    </span><span class="c1"># Start a process using the subprocess module, or one of its</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">wrappers.</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">subprocess</span><span class="p p-Indicator">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subprocess.Popen</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subprocess.call</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt;&gt; Issue: subprocess call with shell=True seems safe, but may be
changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   Location: ./examples/subprocess_shell.py:21
20  subprocess.check_call([&#39;/bin/ls&#39;, &#39;-l&#39;], shell=False)
21  subprocess.check_call(&#39;/bin/ls -l&#39;, shell=True)
22

&gt;&gt; Issue: call with shell=True contains special shell characters,
consider moving extra logic into Python code
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   Location: ./examples/subprocess_shell.py:26
25
26  subprocess.Popen(&#39;/bin/ls *&#39;, shell=True)
27  subprocess.Popen(&#39;/bin/ls %s&#39; % (&#39;something&#39;,), shell=True)

&gt;&gt; Issue: subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   Location: ./examples/subprocess_shell.py:27
26  subprocess.Popen(&#39;/bin/ls *&#39;, shell=True)
27  subprocess.Popen(&#39;/bin/ls %s&#39; % (&#39;something&#39;,), shell=True)
28  subprocess.Popen(&#39;/bin/ls {}&#39;.format(&#39;something&#39;), shell=True)
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://security.openstack.org">https://security.openstack.org</a></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/subprocess.html#frequently-used-arguments">https://docs.python.org/3/library/subprocess.html#frequently-used-arguments</a></p></li>
<li><p><a class="reference external" href="https://security.openstack.org/guidelines/dg_use-subprocess-securely.html">https://security.openstack.org/guidelines/dg_use-subprocess-securely.html</a></p></li>
<li><p><a class="reference external" href="https://security.openstack.org/guidelines/dg_avoid-shell-true.html">https://security.openstack.org/guidelines/dg_avoid-shell-true.html</a></p></li>
<li><p><a class="reference external" href="https://cwe.mitre.org/data/definitions/78.html">https://cwe.mitre.org/data/definitions/78.html</a></p></li>
</ul>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.7.3: </span>CWE information added</p>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="b601_paramiko_calls.html" class="btn btn-neutral float-left" title="B601: paramiko_calls" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="b603_subprocess_without_shell_equals_true.html" class="btn btn-neutral float-right" title="B603: subprocess_without_shell_equals_true" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Bandit Developers.
      <span class="commit">Revision <code>22b42260</code>.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  

  
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>