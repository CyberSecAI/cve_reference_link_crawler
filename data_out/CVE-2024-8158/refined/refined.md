- **Root cause of vulnerability:** The vulnerability stems from a flaw in the lib9p authentication process where the user name used for Tauth and Tattach operations was not verified against the user name returned by the factotum authentication service. This allowed a client to initiate a connection with one user name and then authenticate with a different user name using factotum.
- **Weaknesses/vulnerabilities:** The core weakness is the lack of consistent user name verification during the authentication handshake. Specifically, the `uname` from the initial Tauth/Tattach was not checked against the `cuid` returned by factotum's `AuthInfo`.
- **Impact of exploitation:** An attacker could potentially bypass access controls and gain unauthorized access to resources by authenticating as a different user than they initially connected as.
- **Attack vectors:** The attack vector involves a malicious 9p client using one user name for Tauth and Tattach and then using a different user name during the factotum authentication.
- **Required attacker capabilities/position:** The attacker needs to be able to interact with a 9p server and have the ability to use different user names during different phases of the authentication process. They would also require the ability to authenticate using the factotum service with the alternate user name.