=== Content from github.com_6264fb2c_20250110_212313.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsilverstripe%2Fsilverstripe-graphql%2Fcommit%2Ff6d5976ec4608e51184b0db1ee5b9e9a99d2501c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsilverstripe%2Fsilverstripe-graphql%2Fcommit%2Ff6d5976ec4608e51184b0db1ee5b9e9a99d2501c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=silverstripe%2Fsilverstripe-graphql)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[silverstripe](/silverstripe)
/
**[silverstripe-graphql](/silverstripe/silverstripe-graphql)**
Public

* [Notifications](/login?return_to=%2Fsilverstripe%2Fsilverstripe-graphql) You must be signed in to change notification settings
* [Fork
  61](/login?return_to=%2Fsilverstripe%2Fsilverstripe-graphql)
* [Star
   52](/login?return_to=%2Fsilverstripe%2Fsilverstripe-graphql)

* [Code](/silverstripe/silverstripe-graphql)
* [Issues
  78](/silverstripe/silverstripe-graphql/issues)
* [Pull requests
  2](/silverstripe/silverstripe-graphql/pulls)
* [Actions](/silverstripe/silverstripe-graphql/actions)
* [Projects
  0](/silverstripe/silverstripe-graphql/projects)
* [Security](/silverstripe/silverstripe-graphql/security)
* [Insights](/silverstripe/silverstripe-graphql/pulse)

Additional navigation options

* [Code](/silverstripe/silverstripe-graphql)
* [Issues](/silverstripe/silverstripe-graphql/issues)
* [Pull requests](/silverstripe/silverstripe-graphql/pulls)
* [Actions](/silverstripe/silverstripe-graphql/actions)
* [Projects](/silverstripe/silverstripe-graphql/projects)
* [Security](/silverstripe/silverstripe-graphql/security)
* [Insights](/silverstripe/silverstripe-graphql/pulse)

## Commit

[Permalink](/silverstripe/silverstripe-graphql/commit/f6d5976ec4608e51184b0db1ee5b9e9a99d2501c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[[CVE-2023-40180](https://github.com/advisories/GHSA-v23w-pppm-jh66 "CVE-2023-40180")] Add protection against recursive queries ([#558](https://github.com/silverstripe/silverstripe-graphql/pull/558))

[Browse files](/silverstripe/silverstripe-graphql/tree/f6d5976ec4608e51184b0db1ee5b9e9a99d2501c)
Browse the repository at this point in the history

* Loading branch information

[![@GuySartorelli](https://avatars.githubusercontent.com/u/36352093?s=40&v=4)](/GuySartorelli)

[GuySartorelli](/silverstripe/silverstripe-graphql/commits?author=GuySartorelli "View all commits by GuySartorelli")
authored
Oct 16, 2023

1 parent
[1d360f2](/silverstripe/silverstripe-graphql/commit/1d360f246a74884efdbd1f08bb45c583bdf61a2a)

commit f6d5976

 Show file tree

 Hide file tree

Showing
**17 changed files**
with
**362 additions**
and
**14 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* \_config

  + \_config/schema-global.yml
    [schema-global.yml](#diff-2485b4a1dd5c1e13d8be5880975f88c0133ea82229c1073c45a7383831391c87)
* src

  + src/Controller.php
    [Controller.php](#diff-b0fd9520808d2a4eb3db3fab48d26a471185043bc6e3541fc75a0a47c6e1cb34)
  + QueryHandler

    - src/QueryHandler/QueryHandler.php
      [QueryHandler.php](#diff-6a3da5a6a90ad1017dbd5141bba282c7f2f272d25ace410e667bff521884713c)
* tests

  + Fake

    - tests/Fake/FakeSiteTree.php
      [FakeSiteTree.php](#diff-d16cff0887b2dc793772eb456f5d41d98b89c492a3b64c3a1bac229b678a41de)
  + Schema

    - tests/Schema/IntegrationTest.php
      [IntegrationTest.php](#diff-185c0371539557bb7be75e037e0082fd661eafa9d5a2c59ef11886da20f66f5e)
    - \_testCustomComplexityLimit

      * tests/Schema/\_testCustomComplexityLimit/config.yml
        [config.yml](#diff-57091e32561cc44c3a629fc0536c003091da2c27faa5239234cd637f9aa885bb)
      * tests/Schema/\_testCustomComplexityLimit/models.yml
        [models.yml](#diff-b6a5e15d406143ea1fb641b4152a0aeb9476b8210891d6e80c897f35522db29e)
    - \_testCustomDepthLimit

      * tests/Schema/\_testCustomDepthLimit/config.yml
        [config.yml](#diff-31faf5c63cc322905aac46817943f072e84e8b56d07ccfdc026439cb6ef920ed)
      * tests/Schema/\_testCustomDepthLimit/models.yml
        [models.yml](#diff-f9137c817bbc6d44aea7cd85403324997ba8fe70be08625dab59ef1dade20624)
    - \_testCustomNodeLimit

      * tests/Schema/\_testCustomNodeLimit/config.yml
        [config.yml](#diff-8a64c671fff71b7e46c2934cd695055acc39a7b08e7127fdf6a86f03d9316dc2)
      * tests/Schema/\_testCustomNodeLimit/models.yml
        [models.yml](#diff-d31cf90d17d176c01abfd058bebff9ae55d34934c56607c95f1d12736c4ba34f)
    - \_testDefaultDepthLimit

      * tests/Schema/\_testDefaultDepthLimit/config.yml
        [config.yml](#diff-82b8ee49d7a830a73c2de63f743e16cb704d2ed632c56cc354263c19a681ee6a)
      * tests/Schema/\_testDefaultDepthLimit/models.yml
        [models.yml](#diff-c9e7d82605f11569f8e569009340d2102bf364ffc2f0a006616f905289bc5307)
    - \_testDefaultNodeLimit

      * tests/Schema/\_testDefaultNodeLimit/models.yml
        [models.yml](#diff-02e23e4c63e7e5a8e9d5d4c97f87656ba66b2104d763aecef35825c8c2ca326f)
    - \_testGlobalRuleNotRemoved

      * tests/Schema/\_testGlobalRuleNotRemoved/config.yml
        [config.yml](#diff-a87ab9231627839fec99a79c0f32ecbd09e78f460e2907e1a97d8a7637dc4dff)
      * tests/Schema/\_testGlobalRuleNotRemoved/models.yml
        [models.yml](#diff-c4766b626c5ee89f5fb177bcdb82adad8b8aba7dc187b12cdd93480015c638ca)
    - tests/Schema/fixtures.yml
      [fixtures.yml](#diff-03792828d20803b63d3615bd2b384157c927e24335f05a446be85f7b9a1bee53)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[\_config/schema-global.yml](#diff-2485b4a1dd5c1e13d8be5880975f88c0133ea82229c1073c45a7383831391c87 "_config/schema-global.yml")

Show comments

[View file](/silverstripe/silverstripe-graphql/blob/f6d5976ec4608e51184b0db1ee5b9e9a99d2501c/_config/schema-global.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,6 +10,8 @@ SilverStripe\GraphQL\Schema\Schema: |
|  |  | valueParser: 'SilverStripe\GraphQL\Schema\Resolver\JSONResolver::parseValue' |
|  |  | literalParser: 'SilverStripe\GraphQL\Schema\Resolver\JSONResolver::parseLiteral' |
|  |  | config: |
|  |  | max\_query\_depth: 15 |
|  |  | max\_query\_nodes: 500 |
|  |  | resolverStrategy: 'SilverStripe\GraphQL\Schema\Resolver\DefaultResolverStrategy::getResolverMethod' |
|  |  | defaultResolver: 'SilverStripe\GraphQL\Schema\Resolver\DefaultResolver::defaultFieldResolver' |
|  |  | modelCreators: |
| Expand Down | |  |

6 changes: 5 additions & 1 deletion

6
[src/Controller.php](#diff-b0fd9520808d2a4eb3db3fab48d26a471185043bc6e3541fc75a0a47c6e1cb34 "src/Controller.php")

Show comments

[View file](/silverstripe/silverstripe-graphql/blob/f6d5976ec4608e51184b0db1ee5b9e9a99d2501c/src/Controller.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,6 +30,7 @@ |
|  |  | use SilverStripe\Security\Permission; |
|  |  | use SilverStripe\Versioned\Versioned; |
|  |  | use BadMethodCallException; |
|  |  | use SilverStripe\Core\ClassInfo; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Top level controller for handling graphql requests. |
| Expand Down  Expand Up | | @@ -113,8 +114,11 @@ public function index(HTTPRequest $request): HTTPResponse |
|  |  | } |
|  |  | $handler = $this->getQueryHandler(); |
|  |  | $this->applyContext($handler); |
|  |  | $queryDocument = Parser::parse(new Source($query)); |
|  |  | $ctx = $handler->getContext(); |
|  |  | if (ClassInfo::hasMethod($handler, 'validateQueryBeforeParsing')) { |
|  |  | $handler->validateQueryBeforeParsing($query, $ctx); |
|  |  | } |
|  |  | $queryDocument = Parser::parse(new Source($query)); |
|  |  | $result = $handler->query($graphqlSchema, $query, $variables); |
|  |  |  |
|  |  | // Fire an eventYou |
| Expand Down | |  |

58 changes: 57 additions & 1 deletion

58
[src/QueryHandler/QueryHandler.php](#diff-6a3da5a6a90ad1017dbd5141bba282c7f2f272d25ace410e667bff521884713c "src/QueryHandler/QueryHandler.php")

Show comments

[View file](/silverstripe/silverstripe-graphql/blob/f6d5976ec4608e51184b0db1ee5b9e9a99d2501c/src/QueryHandler/QueryHandler.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,14 +5,20 @@ |
|  |  |  |
|  |  | use GraphQL\Error\Error; |
|  |  | use GraphQL\Error\SyntaxError; |
|  |  | use GraphQL\Error\UserError; |
|  |  | use GraphQL\Executor\ExecutionResult; |
|  |  | use GraphQL\GraphQL; |
|  |  | use GraphQL\Language\AST\DocumentNode; |
|  |  | use GraphQL\Language\AST\NodeKind; |
|  |  | use GraphQL\Language\Lexer; |
|  |  | use GraphQL\Language\Parser; |
|  |  | use GraphQL\Language\Source; |
|  |  | use GraphQL\Language\SourceLocation; |
|  |  | use GraphQL\Language\Token; |
|  |  | use GraphQL\Type\Schema as GraphQLSchema; |
|  |  | use GraphQL\Validator\DocumentValidator; |
|  |  | use GraphQL\Validator\Rules\QueryComplexity; |
|  |  | use GraphQL\Validator\Rules\QueryDepth; |
|  |  | use SilverStripe\Control\Director; |
|  |  | use SilverStripe\Core\Config\Configurable; |
|  |  | use SilverStripe\Core\Extensible; |
| Expand All | | @@ -24,6 +30,7 @@ |
|  |  | use SilverStripe\GraphQL\PersistedQuery\PersistedQueryProvider; |
|  |  | use SilverStripe\GraphQL\Schema\Interfaces\ContextProvider; |
|  |  | use SilverStripe\GraphQL\Schema\Schema; |
|  |  | use SilverStripe\GraphQL\Schema\SchemaConfig; |
|  |  | use SilverStripe\ORM\ValidationException; |
|  |  |  |
|  |  | /\*\* |
| Expand Down  Expand Up | | @@ -99,12 +106,61 @@ public function queryAndReturnResult(GraphQLSchema $schema, $query, ?array $vars |
|  |  | } |
|  |  | $context = $this->getContext(); |
|  |  | $last = function ($schema, $query, $context, $vars) { |
|  |  | return GraphQL::executeQuery($schema, $query, null, $context, $vars); |
|  |  | if (is\_string($query)) { |
|  |  | $this->validateQueryBeforeParsing($query, $context); |
|  |  | } |
|  |  |  |
|  |  | $validationRules = DocumentValidator::allRules(); |
|  |  | if (isset($context[SchemaConfigProvider::KEY])) { |
|  |  | /\*\* @var SchemaConfig $config \*/ |
|  |  | $config = $context[SchemaConfigProvider::KEY]; |
|  |  | $maxDepth = $config->get('max\_query\_depth'); |
|  |  | $maxComplexity = $config->get('max\_query\_complexity'); |
|  |  | if ($maxDepth) { |
|  |  | $validationRules[QueryDepth::class] = new QueryDepth($maxDepth); |
|  |  | } |
|  |  | if ($maxComplexity) { |
|  |  | $validationRules[QueryComplexity::class] = new QueryComplexity($maxComplexity); |
|  |  | } |
|  |  | } |
|  |  | return GraphQL::executeQuery($schema, $query, null, $context, $vars, null, null, $validationRules); |
|  |  | }; |
|  |  |  |
|  |  | return $this->callMiddleware($schema, $query, $context, $vars ?? [], $last); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Validate a query before parsing it in case there are issues we can catch early. |
|  |  | \*/ |
|  |  | public function validateQueryBeforeParsing(string $query, array $context): void |
|  |  | { |
|  |  | if (!isset($context[SchemaConfigProvider::KEY])) { |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | /\*\* @var SchemaConfig $config \*/ |
|  |  | $config = $context[SchemaConfigProvider::KEY]; |
|  |  | $maxNodes = $config->get('max\_query\_nodes'); |
|  |  | if (!$maxNodes) { |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | $lexer = new Lexer(new Source($query)); |
|  |  | $numNodes = 0; |
|  |  |  |
|  |  | // Check how many nodes there are in this query |
|  |  | do { |
|  |  | $next = $lexer->advance(); |
|  |  | if ($next->kind === Token::NAME) { |
|  |  | $numNodes++; |
|  |  | } |
|  |  | } while ($next->kind !== Token::EOF && $numNodes <= $maxNodes); |
|  |  |  |
|  |  | // Throw a UserError if there are too many nodes |
|  |  | if ($numNodes > $maxNodes) { |
|  |  | throw new UserError("GraphQL query body must not be longer than $maxNodes nodes."); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* get query from persisted id, return null if not found |
| Expand Down | |  |

8 changes: 8 additions & 0 deletions

8
[tests/Fake/FakeSiteTree.php](#diff-d16cff0887b2dc793772eb456f5d41d98b89c492a3b64c3a1bac229b678a41de "tests/Fake/FakeSiteTree.php")

Show comments

[View file](/silverstripe/silverstripe-graphql/blob/f6d5976ec4608e51184b0db1ee5b9e9a99d2501c/tests/Fake/FakeSiteTree.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,6 +15,14 @@ class FakeSiteTree extends DataObject implements TestOnly |
|  |  | 'Content' => 'HTMLText' |
|  |  | ]; |
|  |  |  |
|  |  | private static $has\_one = [ |
|  |  | 'Parent' => self::class, |
|  |  | ]; |
|  |  |  |
|  |  | private static $has\_many = [ |
|  |  | 'Children' => self::class, |
|  |  | ]; |
|  |  |  |
|  |  | private static $extensions = [ |
|  |  | Versioned::class, |
|  |  | ]; |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f6d5976`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsilverstripe%2Fsilverstripe-graphql%2Fcommit%2Ff6d5976ec4608e51184b0db1ee5b9e9a99d2501c) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_390434ea_20250110_212314.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsilverstripe%2Fsilverstripe-graphql%2Fsecurity%2Fadvisories%2FGHSA-v23w-pppm-jh66)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsilverstripe%2Fsilverstripe-graphql%2Fsecurity%2Fadvisories%2FGHSA-v23w-pppm-jh66)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=silverstripe%2Fsilverstripe-graphql)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[silverstripe](/silverstripe)
/
**[silverstripe-graphql](/silverstripe/silverstripe-graphql)**
Public

* [Notifications](/login?return_to=%2Fsilverstripe%2Fsilverstripe-graphql) You must be signed in to change notification settings
* [Fork
  61](/login?return_to=%2Fsilverstripe%2Fsilverstripe-graphql)
* [Star
   52](/login?return_to=%2Fsilverstripe%2Fsilverstripe-graphql)

* [Code](/silverstripe/silverstripe-graphql)
* [Issues
  78](/silverstripe/silverstripe-graphql/issues)
* [Pull requests
  2](/silverstripe/silverstripe-graphql/pulls)
* [Actions](/silverstripe/silverstripe-graphql/actions)
* [Projects
  0](/silverstripe/silverstripe-graphql/projects)
* [Security](/silverstripe/silverstripe-graphql/security)
* [Insights](/silverstripe/silverstripe-graphql/pulse)

Additional navigation options

* [Code](/silverstripe/silverstripe-graphql)
* [Issues](/silverstripe/silverstripe-graphql/issues)
* [Pull requests](/silverstripe/silverstripe-graphql/pulls)
* [Actions](/silverstripe/silverstripe-graphql/actions)
* [Projects](/silverstripe/silverstripe-graphql/projects)
* [Security](/silverstripe/silverstripe-graphql/security)
* [Insights](/silverstripe/silverstripe-graphql/pulse)

# DDOS Vulnerability on GraphQL due to lack of protection against recursive queries

High

[GuySartorelli](/GuySartorelli)
published
GHSA-v23w-pppm-jh66
Oct 16, 2023

## Package

composer

silverstripe/graphql
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

>= 3.0.0, < 3.8.2
>= 4.0.0, < 4.1.3
>= 4.2.0, < 4.2.5
>= 4.3.0, < 4.3.4
>= 5.0.0, < 5.0.3

## Patched versions

3.8.2
4.1.3
4.2.5
4.3.4
5.0.3

## Description

### Impact

An attacker could use a recursive graphql query to execute a Distributed Denial of Service attack (DDOS attack) against a website. This mostly affects websites with publicly exposed graphql schemas.

If your Silverstripe CMS project does not expose a public facing graphql schema, a user account is required to trigger the DDOS attack. If your site is hosted behind a content delivery network (CDN), such as Imperva or CloudFlare, this may further mitigate the risk.

The fix includes some new configuration options which you might want to tweak for your project, based on your own requirements. See the documentation in the references for details.

### Patches

Patched in [3.8.2](https://github.com/silverstripe/silverstripe-graphql/releases/tag/3.8.2), [4.1.3](https://github.com/silverstripe/silverstripe-graphql/releases/tag/4.1.3), [4.2.5](https://github.com/silverstripe/silverstripe-graphql/releases/tag/4.2.5), [4.3.4](https://github.com/silverstripe/silverstripe-graphql/releases/tag/4.3.4), [5.0.3](https://github.com/silverstripe/silverstripe-graphql/releases/tag/5.0.3)

### References

* [CVE-2023-40180 on silverstripe.org](https://www.silverstripe.org/download/security-releases/CVE-2023-40180)
* [Documentation about protection against recursive or complex queries for silverstripe/graphql 4.x/5.x](https://docs.silverstripe.org/en/developer_guides/graphql/security_and_best_practices/recursive_or_complex_queries)
* [Documentation about protection against recursive or complex queries for silverstripe/graphql 3.x](https://github.com/silverstripe/silverstripe-graphql/tree/3.8#recursive-or-complex-queries)

### Reported by

Jason Nguyen from phew (<https://phew.co.nz/>)

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2023-40180

### Weaknesses

[CWE-400](/advisories?query=cwe%3A400)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c79251e4_20250110_212315.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsilverstripe%2Fsilverstripe-graphql%2Ftree%2F3.8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsilverstripe%2Fsilverstripe-graphql%2Ftree%2F3.8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=silverstripe%2Fsilverstripe-graphql)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[silverstripe](/silverstripe)
/
**[silverstripe-graphql](/silverstripe/silverstripe-graphql)**
Public

* [Notifications](/login?return_to=%2Fsilverstripe%2Fsilverstripe-graphql) You must be signed in to change notification settings
* [Fork
  61](/login?return_to=%2Fsilverstripe%2Fsilverstripe-graphql)
* [Star
   52](/login?return_to=%2Fsilverstripe%2Fsilverstripe-graphql)

Serves Silverstripe data as GraphQL representations

### License

[BSD-3-Clause license](/silverstripe/silverstripe-graphql/blob/5/LICENSE)

[52
stars](/silverstripe/silverstripe-graphql/stargazers) [61
forks](/silverstripe/silverstripe-graphql/forks) [Branches](/silverstripe/silverstripe-graphql/branches) [Tags](/silverstripe/silverstripe-graphql/tags) [Activity](/silverstripe/silverstripe-graphql/activity)
 [Star](/login?return_to=%2Fsilverstripe%2Fsilverstripe-graphql)

 [Notifications](/login?return_to=%2Fsilverstripe%2Fsilverstripe-graphql) You must be signed in to change notification settings

* [Code](/silverstripe/silverstripe-graphql/tree/3.8)
* [Issues
  78](/silverstripe/silverstripe-graphql/issues)
* [Pull requests
  2](/silverstripe/silverstripe-graphql/pulls)
* [Actions](/silverstripe/silverstripe-graphql/actions)
* [Projects
  0](/silverstripe/silverstripe-graphql/projects)
* [Security](/silverstripe/silverstripe-graphql/security)
* [Insights](/silverstripe/silverstripe-graphql/pulse)

Additional navigation options

* [Code](/silverstripe/silverstripe-graphql/tree/3.8)
* [Issues](/silverstripe/silverstripe-graphql/issues)
* [Pull requests](/silverstripe/silverstripe-graphql/pulls)
* [Actions](/silverstripe/silverstripe-graphql/actions)
* [Projects](/silverstripe/silverstripe-graphql/projects)
* [Security](/silverstripe/silverstripe-graphql/security)
* [Insights](/silverstripe/silverstripe-graphql/pulse)

# silverstripe/silverstripe-graphql

    3.8[Branches](/silverstripe/silverstripe-graphql/branches)[Tags](/silverstripe/silverstripe-graphql/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[434 Commits](/silverstripe/silverstripe-graphql/commits/3.8/) | | |
| [.github/workflows](/silverstripe/silverstripe-graphql/tree/3.8/.github/workflows "This path skips through empty directories") | | [.github/workflows](/silverstripe/silverstripe-graphql/tree/3.8/.github/workflows "This path skips through empty directories") |  |  |
| [\_config](/silverstripe/silverstripe-graphql/tree/3.8/_config "_config") | | [\_config](/silverstripe/silverstripe-graphql/tree/3.8/_config "_config") |  |  |
| [examples](/silverstripe/silverstripe-graphql/tree/3.8/examples "examples") | | [examples](/silverstripe/silverstripe-graphql/tree/3.8/examples "examples") |  |  |
| [src](/silverstripe/silverstripe-graphql/tree/3.8/src "src") | | [src](/silverstripe/silverstripe-graphql/tree/3.8/src "src") |  |  |
| [tests](/silverstripe/silverstripe-graphql/tree/3.8/tests "tests") | | [tests](/silverstripe/silverstripe-graphql/tree/3.8/tests "tests") |  |  |
| [.editorconfig](/silverstripe/silverstripe-graphql/blob/3.8/.editorconfig ".editorconfig") | | [.editorconfig](/silverstripe/silverstripe-graphql/blob/3.8/.editorconfig ".editorconfig") |  |  |
| [.gitattributes](/silverstripe/silverstripe-graphql/blob/3.8/.gitattributes ".gitattributes") | | [.gitattributes](/silverstripe/silverstripe-graphql/blob/3.8/.gitattributes ".gitattributes") |  |  |
| [.travis.yml](/silverstripe/silverstripe-graphql/blob/3.8/.travis.yml ".travis.yml") | | [.travis.yml](/silverstripe/silverstripe-graphql/blob/3.8/.travis.yml ".travis.yml") |  |  |
| [.upgrade.yml](/silverstripe/silverstripe-graphql/blob/3.8/.upgrade.yml ".upgrade.yml") | | [.upgrade.yml](/silverstripe/silverstripe-graphql/blob/3.8/.upgrade.yml ".upgrade.yml") |  |  |
| [LICENSE](/silverstripe/silverstripe-graphql/blob/3.8/LICENSE "LICENSE") | | [LICENSE](/silverstripe/silverstripe-graphql/blob/3.8/LICENSE "LICENSE") |  |  |
| [README.md](/silverstripe/silverstripe-graphql/blob/3.8/README.md "README.md") | | [README.md](/silverstripe/silverstripe-graphql/blob/3.8/README.md "README.md") |  |  |
| [\_config.php](/silverstripe/silverstripe-graphql/blob/3.8/_config.php "_config.php") | | [\_config.php](/silverstripe/silverstripe-graphql/blob/3.8/_config.php "_config.php") |  |  |
| [composer.json](/silverstripe/silverstripe-graphql/blob/3.8/composer.json "composer.json") | | [composer.json](/silverstripe/silverstripe-graphql/blob/3.8/composer.json "composer.json") |  |  |
| [phpcs.xml.dist](/silverstripe/silverstripe-graphql/blob/3.8/phpcs.xml.dist "phpcs.xml.dist") | | [phpcs.xml.dist](/silverstripe/silverstripe-graphql/blob/3.8/phpcs.xml.dist "phpcs.xml.dist") |  |  |
| [phpunit.xml.dist](/silverstripe/silverstripe-graphql/blob/3.8/phpunit.xml.dist "phpunit.xml.dist") | | [phpunit.xml.dist](/silverstripe/silverstripe-graphql/blob/3.8/phpunit.xml.dist "phpunit.xml.dist") |  |  |
| View all files | | |

## Repository files navigation

* README
* License
# Silverstripe GraphQL Server

[![CI](https://github.com/silverstripe/silverstripe-graphql/actions/workflows/ci.yml/badge.svg)](https://github.com/silverstripe/silverstripe-graphql/actions/workflows/ci.yml)
[![codecov](https://camo.githubusercontent.com/f47ab06c15a0614010813907389b941a8667d4b18e291c120becb767f137a3d1/68747470733a2f2f636f6465636f762e696f2f67682f73696c7665727374726970652f73696c7665727374726970652d6772617068716c2f6272616e63682f6d61737465722f67726170682f62616467652e737667)](https://codecov.io/gh/silverstripe/silverstripe-graphql)
[![SilverStripe supported module](https://camo.githubusercontent.com/ca8e73001e7d76865e6142223ea7f412e248c73502ade2e6989c728f8067e91d/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f73696c7665727374726970652d737570706f727465642d3030373143342e737667)](https://www.silverstripe.org/software/addons/silverstripe-commercially-supported-module-list/)

This modules serves Silverstripe data as
[GraphQL](http://facebook.github.io/react/blog/2015/05/01/graphql-introduction.html)
representations, with helpers to generate schemas based on Silverstripe model
introspection. It layers a pluggable schema registration system on top of the
[graphql-php](https://github.com/webonyx/graphql-php) library. The APIs are
very similar.

## Installation

Require the [composer](http://getcomposer.org) package in your `composer.json`

```
composer require silverstripe/graphql

```

## Table of contents

* [Usage](#usage)
* [Examples](#examples)
* [Configuration](#configuration)
  + [Define types](#define-types)
  + [Define queries](#define-queries)
  + [Pagination](#pagination)
    - [Setting pagination and sorting options](#setting-pagination-and-sorting-options)
  + [Nested connections](#nested-connections)
  + [Adding search params](#adding-search-params)
  + [Define Mutations](#define-mutations)
* [Scaffolding DataObjects into the schema](#scaffolding-dataobjects-into-the-schema)
  + [Our example](#our-example)
  + [Scaffolding through the config layer](#scaffolding-through-the-config-layer)
  + [Scaffolding through procedural code](#scaffolding-through-procedural-code)
  + [Exposing a DataObject to GraphQL](#exposing-a-dataobject-to-graphql)
    - [Available operations](#available-operations)
    - [Scaffolding search params](#adding-search-params-read-operations-only)
    - [Setting field and operation descriptions](#setting-field-and-operation-descriptions)
    - [Setting field descriptions](#setting-field-descriptions)
    - [Wildcarding and whitelisting fields](#wildcarding-and-whitelisting-fields)
    - [Adding arguments](#adding-arguments)
    - [Argument definition shorthand](#argument-definition-shorthand)
    - [Adding more definition to arguments](#adding-more-definition-to-arguments)
    - [Using a custom resolver](#using-a-custom-resolver)
    - [Configuring pagination and sorting](#configuring-pagination-and-sorting)
    - [Adding related objects](#adding-related-objects)
    - [Adding arbitrary queries and mutations](#adding-arbitrary-queries-and-mutations)
    - [Dealing with inheritance](#dealing-with-inheritance)
    - [Querying types that have descendants](#querying-types-that-have-descendants)
    - [Customising the names of types and operations](#customising-the-names-of-types-and-operations)
  + [Versioned content](#versioned-content)
    - [Version-specific-operations](#version-specific-operations)
    - [Version-specific arguments](#version-specific-arguments)
    - [Version-specific fields](#version-specific-fields)
  + [Define interfaces](#define-interfaces)
  + [Define input types](#define-input-types)
* [Extending](#extending)
  + [Adding/removing fields from thirdparty code](#adding-removing-fields-from-thirdparty-code)
  + [Updating the core operations](#updating-the-core-operations)
  + [Adding new operations](#adding-new-operations)
  + [Changing behaviour with Middleware](#changing-behaviour-with-middleware)
* [Testing/debugging queries and mutations](#testingdebugging-queries-and-mutations)
* [Authentication](#authentication)
  + [Default authentication](#default-authentication)
  + [HTTP basic authentication](#http-basic-authentication)
    - [In GraphiQL](#in-graphiql)
  + [Defining your own authenticators](#defining-your-own-authenticators)
* [CSRF tokens (required for mutations)](#csrf-tokens-required-for-mutations)
* [Cross-Origin Resource Sharing (CORS)](#cross-origin-resource-sharing-cors)
  + [Sample Custom CORS Config](#sample-custom-cors-config)
* [Recursive or complex queries](#recursive-or-complex-queries)
* [Persisting Queries](#persisting-queries)
* [Schema introspection](#schema-introspection)
* [Setting up a new GraphQL schema](#setting-up-a-new-graphql-schema)
* [Strict HTTP Method Checking](#strict-http-method-checking)
* [TODO](#todo)

## Usage

GraphQL is used through a single route, typically `/graphql`. You need
to define *Types* and *Queries* to expose your data via this endpoint. While this recommended
route is left open for you to configure on your own, the modules contained in the [CMS recipe](https://github.com/silverstripe/recipe-cms),
(e.g. `asset-admin`, `campaign-admin`) run off a separate GraphQL server with its own endpoint
(`admin/graphql`) with its own permissions and schema.

These separate endpoints have their own identifiers. `default` refers to the GraphQL server
in the user space (e.g. `/graphql`) while `admin` refers to the GraphQL server used by CMS modules
(`admin/graphql`). You can also [set up a new schema](#setting-up-a-new-graphql-schema) if you wish.

By default, this module does not route any GraphQL servers. To activate the default,
public-facing GraphQL server that ships with the module, just add a rule to `Director`.

```
SilverStripe\Control\Director:
  rules:
    'graphql': '%$SilverStripe\GraphQL\Controller.default'
```

## Examples

Code examples can be found in the `examples/` folder (built out from the
configuration docs below).

## Configuration

### The manager

The primary class used to define your schema is `SilverStripe\GraphQL\Manager`, which is a container
for types and queries which get negotiated and transformed into a schema on a just-in-time
basis for every request. All types, queries, mutations, interfaces, and fragments must be
registered in a `Manager` instance.

### Define types

Types describe your data. While your data could be any arbitrary structure, in
a Silverstripe project a GraphQL type usually relates to a `DataObject`.
GraphQL uses this information to validate queries and allow GraphQL clients to
introspect your API capabilities. The GraphQL type system is hierarchical, so
the `fields()` definition declares object properties as scalar types within
your complex type. Refer to the
[graphql-php type definitions](http://webonyx.github.io/graphql-php/type-system/)
for available types.

```
<?php

namespace MyProject\GraphQL;

use GraphQL\Type\Definition\Type;
use SilverStripe\GraphQL\TypeCreator;
use SilverStripe\GraphQL\Pagination\Connection;

class MemberTypeCreator extends TypeCreator
{
    public function attributes()
    {
        return [
            'name' => 'member'
        ];
    }

    public function fields()
    {
        return [
            'ID' => ['type' => Type::nonNull(Type::id())],
            'Email' => ['type' => Type::string()],
            'FirstName' => ['type' => Type::string()],
            'Surname' => ['type' => Type::string()],
        ];
    }
}
```

Each type class needs to be registered with a unique name against the schema
through YAML configuration:

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      types:
        member: 'MyProject\GraphQL\MemberTypeCreator'
```

### Define queries

Types can be exposed via "queries". These queries are in charge of retrieving
data through the Silverstripe ORM. The response itself is handled by the
underlying GraphQL PHP library, which loops through the resulting `DataList`
and accesses fields based on the referred "type" definition.

**Note:** This will return ALL records. See below for a paginated example.

```
<?php

namespace MyProject\GraphQL;

use GraphQL\Type\Definition\ResolveInfo;
use GraphQL\Type\Definition\Type;
use SilverStripe\Security\Member;
use SilverStripe\GraphQL\OperationResolver;
use SilverStripe\GraphQL\QueryCreator;

class ReadMembersQueryCreator extends QueryCreator implements OperationResolver
{
    public function attributes()
    {
        return [
            'name' => 'readMembers'
        ];
    }

    public function args()
    {
        return [
            'Email' => ['type' => Type::string()]
        ];
    }

    public function type()
    {
        return Type::listOf($this->manager->getType('member'));
    }

    public function resolve($object, array $args, $context, ResolveInfo $info)
    {
        $member = Member::singleton();
        if (!$member->canView($context['currentUser'])) {
            throw new \InvalidArgumentException(sprintf(
                '%s view access not permitted',
                Member::class
            ));
        }
        $list = Member::get();

        // Optional filtering by properties
        if (isset($args['Email'])) {
            $list = $list->filter('Email', $args['Email']);
        }

        return $list;
    }
}
```

We'll register the query with a unique name through YAML configuration:

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      queries:
        readMembers: 'MyProject\GraphQL\ReadMembersQueryCreator'
```

You can query data with the following URL:

```
/graphql/?query={readMembers{ID+FirstName+Email}}

```

The query contained in the `query` parameter can be reformatted as follows:

```
{
  readMembers {
    edges {
      node {
        ID
        FirstName
        Email
      }
    }
  }
}
```

You can apply the `Email` filter in the above example like so:

```
query ($Email: String) {
  readMembers(Email: $Email) {
    edges {
      node {
        ID
        FirstName
        Email
      }
    }
  }
}
```

And add a query variable:

```
{
  "Email": "john@example.com"
}
```

You could express this query inline as a single query as below:

```
{
  readMembers(Email: "john@example.com") {
    edges {
      node {
        ID
        FirstName
        Email
      }
    }
  }
}
```

### Pagination

The GraphQL module also provides a wrapper to return paginated and sorted
records using offset based pagination.

> This module currently does not support Relay (cursor based) pagination.
> [This blog post](https://dev-blog.apollodata.com/understanding-pagination-rest-graphql-and-relay-b10f835549e7#.kg5qkwvuz)
> describes the differences.

To have a `Query` return a page-able list of records queries should extend the
`PaginatedQueryCreator` class and return a `Connection` instance.

```
<?php

namespace MyProject\GraphQL;

use GraphQL\Type\Definition\ResolveInfo;
use GraphQL\Type\Definition\Type;
use SilverStripe\Security\Member;
use SilverStripe\GraphQL\Pagination\Connection;
use SilverStripe\GraphQL\Pagination\PaginatedQueryCreator;

class PaginatedReadMembersQueryCreator extends PaginatedQueryCreator
{
    public function createConnection()
    {
        return Connection::create('paginatedReadMembers')
            ->setConnectionType($this->manager->getType('member'))
            ->setArgs([
                'Email' => [
                    'type' => Type::string()
                ]
            ])
            ->setSortableFields(['ID', 'FirstName', 'Email'])
            ->setConnectionResolver(function ($object, array $args, $context, ResolveInfo $info) {
                $member = Member::singleton();
                if (!$member->canView($context['currentUser'])) {
                    throw new \InvalidArgumentException(sprintf(
                        '%s view access not permitted',
                        Member::class
                    ));
                }
                $list = Member::get();

                // Optional filtering by properties
                if (isset($args['Email'])) {
                    $list = $list->filter('Email', $args['Email']);
                }

                return $list;
            });
    }
}
```

You will need to add a new unique query alias to your configuration:

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      queries:
        paginatedReadMembers: 'MyProject\GraphQL\PaginatedReadMembersQueryCreator'
```

Using a `Connection` the GraphQL server will return the results wrapped under
the `edges` result type. `Connection` supports the following arguments:

* `limit`
* `offset`
* `sortBy`

Additional arguments can be added by providing the `setArgs` function (such as
`Email` in the previous example). Each argument must be given a specific type.

Pagination information is provided under the `pageInfo` type. This object type
supports the following fields:

* `totalCount` returns the total number of items in the list,
* `hasNextPage` returns whether more records are available.
* `hasPreviousPage` returns whether more records are available by decreasing
  the offset.

You can query paginated data with the following URL:

```
/graphql/?query=query+Members{paginatedReadMembers(limit:1,offset:0){edges{node{ID+FirstName+Email}}pageInfo{hasNextPage+hasPreviousPage+totalCount}}}

```

The query contained in the `query` parameter can be reformatted as follows:

```
query Members {
  paginatedReadMembers(limit: 1, offset: 0) {
    edges {
      node {
        ID
        FirstName
        Email
      }
    }
    pageInfo {
      hasNextPage
      hasPreviousPage
      totalCount
    }
  }
}

```

#### Setting pagination and sorting options

To limit the ability for users to perform searching and ordering as they wish,
`Collection` instances can define their own limits and defaults.

* `setSortableFields` an array of allowed sort columns.
* `setDefaultLimit` integer for the default page length (default 100)
* `setMaximumLimit` integer for the maximum `limit` records per page to prevent
  excessive load trying to load millions of records (default 100)

```
return Connection::create('paginatedReadMembers')
    // ...
    ->setDefaultLimit(10)
    ->setMaximumLimit(100); // prevents users requesting more than 100 records
```

### Nested connections

`Connection` can be used to return related objects such as `has_many` and
`many_many` models.

```
<?php

namespace MyProject\GraphQL;

use GraphQL\Type\Definition\ResolveInfo;
use GraphQL\Type\Definition\Type;
use SilverStripe\GraphQL\TypeCreator;
use SilverStripe\GraphQL\Pagination\Connection;

class MemberTypeCreator extends TypeCreator
{
    public function attributes()
    {
        return [
            'name' => 'member'
        ];
    }

    public function fields()
    {
        $groupsConnection = Connection::create('Groups')
            ->setConnectionType($this->manager->getType('group'))
            ->setDescription('A list of the users groups')
            ->setSortableFields(['ID', 'Title']);

        return [
            'ID' => ['type' => Type::nonNull(Type::id())],
            'Email' => ['type' => Type::string()],
            'FirstName' => ['type' => Type::string()],
            'Surname' => ['type' => Type::string()],
            'Groups' => [
                'type' => $groupsConnection->toType(),
                'args' => $groupsConnection->args(),
                'resolve' => function($object, array $args, $context, ResolveInfo $info) use ($groupsConnection) {
                    return $groupsConnection->resolveList(
                        $object->Groups(),
                        $args,
                        $context
                    );
                }
            ]
        ];
    }
}
```

```
query Members {
  paginatedReadMembers(limit: 10) {
    edges {
      node {
        ID
        FirstName
        Email
        Groups(sortBy: [{field: Title, direction: DESC}]) {
          edges {
            node {
              ID
              Title
              Description
            }
          }
          pageInfo {
            hasNextPage
            hasPreviousPage
            totalCount
          }
        }
      }
    }
    pageInfo {
      hasNextPage
      hasPreviousPage
      totalCount
    }
  }
}
```

### Adding search params

You can add search parameters your query to filter results using the `DataObjectQueryFilter` class.
Much like pagination, this is done using a reusable service that wraps your existing queries.

The end result will allow you to do something like this:

```
query readBlogs(
  Filter: {
    Title__contains: "food",
    CommentCount__gt: 5,
    Categories__Title__in: ["Recipes", "Cooking tips"]
  },
  Exclude: {
    Hidden__eq: true
  }
) {
  ID
  Title
}
```

So how do we do it? If you're using `QueryCreator` classes, a good approach is to add an instance of the query filter
in your constructor.

```
$this->queryFilter = DataObjectQueryFilter::create(MyDataObject::class);
```

You can then add filters to fields of the dataobject.

```
$this->queryFilter
    ->addFieldFilterByIdentifier('Title', 'contains')
    ->addFieldFilterByIdentifier('CommentCount', 'gt')
    ->addFieldFilterByIdentifier('Categories__Title', 'in')
    ->addFieldFilterByIdentifier('Hidden', 'eq');
```

Don't worry about the filter keys (`contains`, `gt`, `eq`, etc) for now. That will be explained [further down](#the-filter-registry).

Now that we have composed a `DataObjectQueryFilter`, we can now use it to create input types.

```
public function args()
{
    return [
        'Filter' => $this->queryFilter->getInputType('MyDataObjectFilterInputType'),
        'Exclude' => $this->queryFilter->getInputType('MyDataObjectExcludeInputType'),
    ];
}
```
> Make sure your argument names match the names configured in `DataObjectQueryFilter`. By default,
> they are `Filter` and `Exclude`. If you want to use different names, use `setFilterKey()` and
> `setExcludeKey()`.

Lastly, let's update the resolver to apply the filters.

```
public function resolve($obj, $args = [], $context = [], ResolveInfo $info)
{
    $list = MyDataObject::get();
    $list = $this->queryFilter->applyArgsToList($list, $args);

    return $list;
}
```

#### Shortcuts (for the 80% case)

All `SilverStripe\ORM\DBField` instances are configured to have a set of "default" filters (see `filters.yml`).
For instance, most string and text fields just use `eq`, `contains`, and `in`, and omit integer-specific
filters like `gt` and `lt`.

To make things easier, you can simply add the default filters for each field.

```
$this->queryFilter->addDefaultFilters('MyTextField');
$this->queryFilter->addDefaultFilters('MyInt');
```

Even better, if you want all fields on your object filterable, just use `addAllFilters` to add
all the default filters for each field (including inherited) on your model.

```
$this->queryFilter->addAllFilters();
```

#### The filter registry

The reason why we're able to use `contains`, `gt`, etc. as filters is because they have been added
to the filter registry, a singleton that is composed through the config yaml. (See `filters.yml`).

```
SilverStripe\Core\Injector\Injector:
  SilverStripe\GraphQL\QueryFilter\FilterRegistryInterface:
    class: SilverStripe\GraphQL\QueryFilter\FieldFilterRegistry
    constructor:
      contains: '%$SilverStripe\GraphQL\QueryFilter\Filters\ContainsFilter'
      eq: '%$SilverStripe\GraphQL\QueryFilter\Filters\EqualToFilter'
      # etc...
```

You can add your own filters. You just need to implement the `SilverStripe\GraphQL\QueryFilter\FieldFilterInterface`
interface, which requires methods for `applyInclusion()` and `applyExclusion()`. It also must declare
a unique identifier (e.g. `contains`). Once you've defined a class, just add it to the registry via config.

> If you want your filter to accept an array of values, implement `SilverStripe\GraphQL\QueryFilter\ListFieldFilterInterface`
> instead.

#### Default filters

| Identifier | ORM Mapping | Classname |
| --- | --- | --- |
| eq | ExactMatch | SilverStripe\GraphQL\QueryFilter\Filters\EqualToFilter |
| contains | PartialMatch | SilverStripe\GraphQL\QueryFilter\Filters\ContainsFilter |
| gt | GreaterThan | SilverStripe\GraphQL\QueryFilter\Filters\GreaterThanFilter |
| lt | LessThan | SilverStripe\GraphQL\QueryFilter\Filters\LessThanFilter |
| gte | GreaterThanOrEqual | SilverStripe\GraphQL\QueryFilter\Filters\GreaterThanOrEqualFilter |
| lte | LessThanOrEqual | SilverStripe\GraphQL\QueryFilter\Filters\LessThanOrEqualFilter |
| startswith | StartsWith | SilverStripe\GraphQL\QueryFilter\Filters\LessThanFilter |
| endswith | EndsWith | SilverStripe\GraphQL\QueryFilter\Filters\LessThanFilter |
| in | ExactMatch (array) | SilverStripe\GraphQL\QueryFilter\Filters\InFilter |

#### Custom filters

For some queries, you may want to use a default filter identifier (e.g. `eq`) but with a custom
implementation of its filtering mechanism. For this, you can use `addFieldFilter` method.

One example might be searching by date, where the provided date does not have to be an exact
match on the full timestamp to satisfy the filter.

```
$this->queryFilter->addFieldFilter('PublishedDate', new FuzzyDateFilter());
```

Where `FuzzyDateFilter` is an implementation of `FieldFilterInterface.

```
class MyCustomFieldFilter implements FieldFilterInterface
{
    public function getIdentifier()
    {
        return 'eq';
    }

    public function applyInclusion(DataList $list, $fieldName, $value)
    {
        return $list->addWhere([
            'DATE(PublishedDate) = ?' => $value
        ]);
    }
}
```

You can now query all posts for a given day with:

```
query readMyPosts(Filter: {
  PublishedDate__eq: "2018-01-29"
}) {
  Title
}

```

### Define mutations

A "mutation" is a specialised GraphQL query which has side effects on your data,
such as create, update or delete. Each of these operations would be expressed
as its own mutation class. Returning an object from the `resolve()` method
will automatically include it in the response.

```
<?php
namespace MyProject\GraphQL;

use GraphQL\Type\Definition\ResolveInfo;
use GraphQL\Type\Definition\Type;
use SilverStripe\GraphQL\MutationCreator;
use SilverStripe\GraphQL\OperationResolver;
use SilverStripe\Security\Member;

class CreateMemberMutationCreator extends MutationCreator implements OperationResolver
{
    public function attributes()
    {
        return [
            'name' => 'createMember',
            'description' => 'Creates a member without permissions or group assignments'
        ];
    }

    public function type()
    {
        return $this->manager->getType('member');
    }

    public function args()
    {
        return [
            'Email' => ['type' => Type::nonNull(Type::string())],
            'FirstName' => ['type' => Type::string()],
            'LastName' => ['type' => Type::string()],
        ];
    }

    public function resolve($object, array $args, $context, ResolveInfo $info)
    {
        if (!singleton(Member::class)->canCreate($context['currentUser'])) {
            throw new \InvalidArgumentException('Member creation not allowed');
        }

        return (new Member($args))->write();
    }
}
```

We'll register this mutation through YAML configuration:

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      mutations:
        createMember: 'MyProject\GraphQL\CreateMemberMutationCreator'
```

You can run a mutation with the following query:

```
mutation ($Email: String!) {
  createMember(Email: $Email) {
    ID
  }
}
```

This will create a new member with an email address, which you can pass in as
query variables: `{"Email": "test@test.com"}`. It'll return the new `ID`
property of the created member.

## Scaffolding DataObjects into the schema

Making a DataObject accessible through the GraphQL API involves quite a bit of boilerplate. In the above example, we can
see that creating endpoints for a query and a mutation requires creating three new classes, along with an update to the
configuration, and we haven't even dealt with data relations yet. For applications that require a lot of business logic
and specific functionality, an architecture like this affords the developer a lot of control, but for developers who
just want to make a given model accessible through GraphQL with some basic create, read, update, and delete operations,
scaffolding them can save a lot of time and reduce the clutter in your project.

Scaffolding DataObjects can be achieved in two non-exclusive ways:

* Via executable code (procedurally)
* Via the config layer (declaratively)

Examples of both methods will be demonstrated below.

### Our example

For these examples, we'll imagine we have the following model:

```
namespace MyProject;

use MyProject\Comment;
use SilverStripe\Assets\File;
use SilverStripe\Security\Member;

class Post extends DataObject
{
    private static $db = [
        'Title' => 'Varchar',
        'Content' => 'HTMLText'
    ];

    private static $has_one = [
        'Author' => Member::class
    ];

    private static $has_many = [
        'Comments' => Comment::class
    ];

    private static $many_many = [
        'Files' => File::class
    ];
}
```

### Scaffolding through the Config layer

Many of the declarations you make through procedural code can be done via YAML. If you don't have any logic in your
scaffolding, using YAML is a simple approach to adding scaffolding.

We'll need to define a `scaffolding` node in the `SilverStripe\GraphQL\Manager.schemas.mySchemaKey` setting.

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      scaffolding:
      ## scaffolding will go here

```

### Scaffolding through procedural code

Alternatively, for more complex requirements, you can create the scaffolding with code. The GraphQL `Manager` class will
bootstrap itself with any scaffolders that are registered in its config. These scaffolders must implement the
`ScaffoldingProvider` interface. A logical place to add this code may be in your DataObject, but it could be anywhere.

As a `ScaffoldingProvider`, the class must now offer the `provideGraphQLScaffolding()` method.

```
namespace MyProject;

use SilverStripe\GraphQL\Scaffolding\Interfaces\ScaffoldingProvider;
use SilverStripe\GraphQL\Scaffolding\Scaffolders\SchemaScaffolder;
use SilverStripe\ORM\DataObject;

class Post extends DataObject implements ScaffoldingProvider
{
    //...
    public function provideGraphQLScaffolding(SchemaScaffolder $scaffolder)
    {
        // update the scaffolder here
    }
}
```

In order to register the scaffolding provider with the manager, we'll need to make an update to the config.

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      scaffolding_providers:
        - MyProject\Post
```

### Exposing a DataObject to GraphQL

Let's now expose the `Post` type. We'll choose the fields we want to offer, along with a simple query and mutation. To
resolve queries and mutations, we'll need to specify the name of a resolver class. This class
must implement the `SilverStripe\GraphQL\OperationResolver`. (More on this below).

**Via YAML**:

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      scaffolding:
        types:
          MyProject\Post:
            fields: [ID, Title, Content]
            operations:
              read: true
              create: true
```

**...Or with code**:

```
namespace MyProject;

use SilverStripe\GraphQL\Scaffolding\Interfaces\ScaffoldingProvider;
use SilverStripe\GraphQL\Scaffolding\Scaffolders\SchemaScaffolder;
use SilverStripe\ORM\DataObject;

class Post extends DataObject implements ScaffoldingProvider
{
    //...
    public function provideGraphQLScaffolding(SchemaScaffolder $scaffolder)
    {
        $scaffolder
            ->type(Post::class)
                ->addFields(['ID', 'Title', 'Content'])
                ->operation(SchemaScaffolder::READ)
                    ->end()
                ->operation(SchemaScaffolder::UPDATE)
                    ->end()
                ->end();

        return $scaffolder;
    }
}
```

By declaring these two operations, we have automatically added a new query and
mutation to the GraphQL schema, using naming conventions derived from
the operation type and the `singular_name` or `plural_name` of the DataObject.

```
query {
  readPosts {
    edges {
      node {
        Title
        Content
      }
    }
  }
}
```

```
mutation CreatePost($Input: PostCreateInputType!) {
  createPost(Input: $Input) {
    Title
  }
}
```

```
{
  "Input": {
    "Title": "My Title"
  }
}
```

Permission constraints (in this case `canView()` and `canCreate()`) are enforced
by the operation resolvers.

#### Available operations

For each type, all the basic `CRUD` operations are afforded to you by default (`create`, `read`, `update`, `delete`),
plus an operation for `readoOne`, which retrieves a record by ID. Each operation can be activated by setting their
identifier to `true` in YAML.

```
...
  operations:
    read: true
    update: true
    create: true
    delete: true
    readOne: true

```

To add configuration to these operations, define a map rather than assigning a boolean.

```
...
  operations:
    read:
      paginate: false

```

Alternatively, when using procedural code, just call `opertation($identifier)`, where `$identifier`
is a constant on the `SchemaScaffolder` class definition.

```
$scaffolder->type(MyDataObject::class)
  ->operation(SchemaScaffolder::READ)
    ->setUsePagination(false)
  ->end();
```

#### Adding search params (read operations only)

You can add all default filters for every field on your dataobject with `filters: '*'`.

```
read:
  filters: '*'
```
> Note: "every field" means every field exposed by `searchable_fields` on the dataobject -- not just those exposed on its GraphQL type.

To be more granular, break it up into a list of specific fields.

```
read:
  filters:
    MyField: true # All default filters for this field type
    MyInt:
      gt: true # Greater than
      gte: true # Greater than or equal
```

**Or with procedural code**...

```
$scaffolder->type(MyDataObject::class)
  ->operation(SchemaScaffolder::READ)
    ->queryFilter()
      ->addDefaultFilters('MyField')
      ->addFieldFilterByIdentifier('MyInt', 'gt')
      ->addFieldFilterByIdentifier('MyInt', 'gte')
    ->end()
  ->end();
```

These filter options are also available on`readOne` operations, but be aware that they are mutually
exclusive with its `ID` parameter.

#### Setting field and operation descriptions

Adding field descriptions is a great way to maintain a well-documented API. To do this,
use a map of `FieldName: 'Your description'` instead of an enumerated list of field names.

**Via YAML**:

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      scaffolding:
        types:
          MyProject\Post:
            fields:
              ID: The unique identifier of the post
              Title: The title of the post
              Content: The main body of the post (HTML)
            operations:
              read:
                description: Reads all posts
              create: true
```

**...Or with code**:

```
namespace MyProject;

use SilverStripe\GraphQL\Scaffolding\Interfaces\ScaffoldingProvider;
use SilverStripe\GraphQL\Scaffolding\Scaffolders\SchemaScaffolder;
use SilverStripe\ORM\DataObject;

class Post extends DataObject implements ScaffoldingProvider
{
    //...
    public function provideGraphQLScaffolding(SchemaScaffolder $scaffolder)
    {
        $scaffolder
            ->type(Post::class)
                ->addFields([
                    'ID' => 'The unique identifier of the post',
                    'Title' => 'The title of the post',
                    'Content' => 'The main body of the post (HTML)'
                ])
                ->operation(SchemaScaffolder::READ)
                    ->setDescription('Reads all posts')
                    ->end()
                ->operation(SchemaScaffolder::UPDATE)
                    ->end()
                ->end();

            return $scaffolder;
    }
}
```

#### Wildcarding and whitelisting fields

If you have a type you want to be fairly well exposed, it can be tedious to add each
field piecemeal. As a shortcut, you can use `addAllFields()` (code) or `fields: "*"` (YAML).
If you have specific fields you want omitted from that list, you can use
`addAllFieldsExcept()` (code) or `excludeFields` (YAML).

**Via YAML**:

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      scaffolding:
        types:
          MyProject\Post:
            fields: "*"
            excludeFields: [SecretThing]
```

**... Or with code**:

```
$scaffolder
    ->type(Post::class)
        ->addAllFieldsExcept(['SecretThing'])
    ->end()
```

#### Adding arguments

You can add arguments to basic crud operations, but keep in mind you'll need to use your own
resolver, as the default resolvers will not be aware of any custom arguments you've allowed.

Using YAML, simply use a map of options instead of `true`.

**Via YAML**

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      scaffolding:
        types:
          MyProject\Post:
            fields: [ID, Title, Content]
            operations:
              read:
                args:
                  Title: String
                resolver: MyProject\ReadPostResolver
              create: true
```

**... Or with code**

```
$scaffolder
    ->type(Post::class)
        ->addFields(['ID', 'Title', 'Content'])
        ->operation(SchemaScaffolder::READ)
            ->addArgs([
                'Title' => 'String'
            ])
            ->setResolver(function($object, array $args, $context, ResolveInfo $info) {
                if (!singleton(Post::class)->canView($context['currentUser'])) {
                    throw new \Exception('Cannot view Post');
                }
                $list = Post::get();
                if (isset($args['Title'])) {
                    $list = $list->filter('Title:PartialMatch', $args['Title']);
                }

                return $list;
                })
            ->end()
        ->operation(SchemaScaffolder::UPDATE)
            ->end()
        ->end();
```

**GraphQL**

```
query {
  readPosts(Title: "Barcelona") {
    edges {
      node {
        Title
        Content
      }
    }
  }
}
```

#### Argument definition shorthand

You can make your scaffolding delcaration a bit more expressive by using argument shorthand.

* `String!`: A required string
* `Int!(50)`: A required integer with a default value of 50
* `Boolean(0)`: A boolean defaulting to false
* `String`: An optional string, defaulting to null

#### Adding more definition to arguments

To add descriptions, and to use a more granular level of control over your arguments,
you can use a more long-form syntax.

**Via YAML**

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      scaffolding:
        types:
          MyProject\Post:
            fields: [ID, Title, Content]
            operations:
              read:
                args:
                  Title: String!
                  MinimumCommentCount:
                    type: Int
                    default: 5
                    description: 'Use this parameter to specify the minimum number of comments per post'
                resolver: MyProject\ReadPostResolver
              create: true
```

**... Or with code**

```
$scaffolder
    ->type(Post::class)
        ->addFields(['ID', 'Title', 'Content'])
        ->operation(SchemaScaffolder::READ)
            ->addArgs([
                'Title' => 'String!',
                'MinimumCommentCount' => 'Int'
            ])
            ->setArgDefaults([
                'MinimumCommentCount' => 5
            ])
            ->setArgDescriptions([
                'MinimumCommentCount' => 'Use this parameter to specify the minimum number of comments per post'
            ])
            ->setResolver(function($object, array $args, $context, ResolveInfo $info) {
                if (!singleton(Post::class)->canView($context['currentUser'])) {
                    throw new \Exception('Cannot view Post');
                }
                $list = Post::get();
                if (isset($args['Title'])) {
                    $list = $list->filter('Title:PartialMatch', $args['Title']);
                }

                return $list;
            })
            ->end()
        ->operation(SchemaScaffolder::UPDATE)
            ->end()
        ->end();
```

#### Using a custom resolver

As seen in the code example above, the simplest way to add a resolver is via an anonymous function
via the `setResolver()` method. In YAML, you can't define such functions, so resolvers be names or instances of
classes that implement the `OperationResolver`.

**When using the YAML approach, custom resolver classes are compulsory**, since you can't define closures in YAML.

```
namespace MyProject\GraphQL;

use GraphQL\Type\Definition\ResolveInfo;
use SilverStripe\GraphQL\OperationResolver;

class MyResolver implements OperationResolver
{
    public function resolve($object, array $args, $context, ResolveInfo $info)
    {
        $post = Post::get()->byID($args['ID']);
        $post->Title = $args['NewTitle'];
        $post->write();
    }
}
```

This resolver class may now be assigned as either an instance, or a string to the query or mutation definition.

```
$scaffolder
    ->type(Post::class)
        ->operation(SchemaScaffolder::UPDATE)
            ->setResolver(MyResolver::class)
            /* Or...
            ->setResolver(new MyResolver())
            */
            ->end();
```

#### Configuring pagination and sorting

By default, all queries are paginated and have no sortable fields. Both of these settings are
configurable.

**Via YAML**

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      scaffolding:
        types:
          MyProject\Post:
            fields: [ID, Title, Content]
            operations:
              read:
                args:
                  Title: String
                resolver: MyProject\ReadPostResolver
                sortableFields: [Title]
              create: true
          MyProject\Comment:
            fields: [Comment, Author]
            operations:
              read:
                paginate: false
```

**... Or with code**

```
$scaffolder
    ->type(Post::class)
        ->addFields(['ID', 'Title', 'Content'])
        ->operation(SchemaScaffolder::READ)
            ->addArgs([
                'Title' => 'String'
            ])
            ->setResolver(function ($object, array $args, $context, ResolveInfo $info) {
                if (!singleton(Post::class)->canView($context['currentUser'])) {
                    throw new \Exception('Cannot view Post');
                }
                $list = Post::get();
                if (isset($args['Title'])) {
                    $list = $list->filter('Title:PartialMatch', $args['Title']);
                }

                return $list;
            })
            ->addSortableFields(['Title'])
            ->end()
        ->operation(SchemaScaffolder::UPDATE)
            ->end()
        ->end()
    ->type(Comment::class)
        ->addFields(['Comment', 'Author'])
        ->operation(SchemaScaffolder::READ)
            ->setUsePagination(false)
            ->end();
```

**GraphQL**

```
query readPosts(Title: "Japan", sortBy: [{field:Title, direction:DESC}]) {
  edges {
    node {
      Title
    }
  }
}
```

```
query readComments {
  edges {
    node {
      Author
      Comment
    }
  }
}
```

#### Adding related objects

The `Post` type we're using has a `$has_one` relation to `Author` (Member), and plural relationships
to `File` and `Comment`. Let's expose both of those to the query.

For the `$has_one`, the relationship can simply be declared as a field. For `$has_many`, `$many_many`,
and any custom getter that returns a `DataList`, we can set up a nested query using `nestedQueries`:

**Via YAML**:

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      scaffolding:
        types:
          MyProject\Post:
            fields: [ID, Title, Content, Author]
            operations:
              read:
                args:
                  Title: String
                resolver: MyProject\ReadPostResolver
                sortableFields: [Title]
              create: true
            nestedQueries:
              Comments: true
              Files: true
          MyProject\Comment:
            fields: [Comment, Author]
            operations:
              read:
                paginate: false

```

**... Or with code**:

```
$scaffolder
    ->type(Post::class)
        ->addFields(['ID', 'Title', 'Content', 'Author'])
        ->operation(SchemaScaffolder::READ)
            ->addArgs([
                'Title' => 'String'
            ])
            ->setResolver(function ($object, array $args, $context, ResolveInfo $info) {
                if (!singleton(Post::class)->canView($context['currentUser'])) {
                    throw new \Exception('Cannot view Post');
                }
                $list = Post::get();
                if (isset($args['Title'])) {
                    $list = $list->filter('Title:PartialMatch', $args['Title']);
                }

                return $list;
            })
            ->addSortableFields(['Title'])
            ->end()
        ->operation(SchemaScaffolder::UPDATE)
            ->end()
        ->nestedQuery('Comments')
            ->end()
        ->nestedQuery('Files')
            ->end()
        ->end()
    ->type(Comment::class)
        ->addFields(['Comment', 'Author'])
        ->operation(SchemaScaffolder::READ)
            ->setUsePagination(false)
            ->end();
```

**GraphQL**

```
query {
  readPosts(Title: "Texas") {
    edges {
      node {
        Title
        Content
        Date
        Author {
          ID
        }
        Comments {
          edges {
            node {
              Comment
            }
          }
        }
        Files(limit: 2) {
          edges {
            node {
              ID
            }
          }
        }
      }
    }
  }
}
```

Notice that we can only query the `ID` field of `Files` and `Author`, our new related fields.
This is because the types are implicitly created by the configuration, but only to the point that
they exist in the schema. They won't eagerly add fields. That's still up to you. By default, you'll only
get the `ID` field, as configured in `SilverStripe\GraphQL\Scaffolding\Scaffolders\DataObjectScaffolder.default_fields`.

Let's add some more fields.

\**Via YAML*:

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      scaffolding:
        types:
          MyProject\Post:
            ## ...
          MyProject\Comment:
            ## ...
          SilverStripe\Security\Member:
            fields: [FirstName, Surname, Name, Email]
          SilverStripe\Assets\File:
            fields: [Filename, URL]
```

**... Or with code**

```
$scaffolder
    ->type(Post::class)
    //...
    ->type(Member::class)
        ->addFields(['FirstName', 'Surname', 'Name', 'Email'])
        ->end()
    ->type(File::class)
        ->addFields(['Filename', 'URL'])
        ->end();
```

Notice that we can freely use the custom getter `Name` on the `Member` record. Fields and `$db` are not one-to-one.

Nested queries can be configured just like operations.

\**Via YAML*:

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      scaffolding:
        types:
          MyProject\Post:
            ## ...
            nestedQueries:
              Comments:
                args:
                  OnlyToday: Boolean
                resolver: MyProject\CommentResolver
            ##...
```

**... Or with code**

```
$scaffolder
    ->type(Post::class)
        ->nestedQuery('Comments')
            ->addArgs([
                'OnlyToday' => 'Boolean'
            ])
            ->setResolver(function($object, array $args, $context, ResolveInfo $info) {
                if (!singleton(Comment::class)->canView($context['currentUser'])) {
                    throw new \Exception('Cannot view Comment');
                }
                $comments = $object->Comments();
                if (isset($args['OnlyToday']) && $args['OnlyToday']) {
                    $comments = $comments->where('DATE(Created) = DATE(NOW())');
                }

                return $comments;
            })
        ->end()
        //...
    //...
```

**GraphQL**

```
query {
  readPosts(Title: "Sydney") {
    edges {
      node {
        Title
        Content
        Date
        Author {
          Name
          Email
        }
        Comments(OnlyToday: true) {
          edges {
            node {
              Comment
            }
          }
        }
        Files(limit: 2) {
          edges {
            node {
              Filename
              URL
            }
          }
        }
      }
    }
  }
}
```

#### Adding arbitrary queries and mutations

Not every operation maps to simple CRUD. For this, you can define custom queries and mutations
in your schema, so long as they map to an existing type.

**Via YAML**

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      scaffolding:
        types:
          MyProject\Post:
            ##...
        mutations:
          updatePostTitle:
            type: MyProject\Post
            args:
              ID: ID!
              NewTitle: String!
            resolver: MyProject\UpdatePostResolver
        queries:
          latestPost:
            type: MyProject\Post
            paginate: false
            resolver: MyProject\LatestPostResolver
```

**... Or with code**:

```
$scaffolder
    ->type(Post::class)
        //...
    ->mutation('updatePostTitle', Post::class)
        ->addArgs([
            'ID' => 'ID!',
            'NewTitle' => 'String!'
        ])
        ->setResolver(function ($object, array $args, $context, ResolveInfo $info) {
            $post = Post::get()->byID($args['ID']);
            if ($post->canEdit($context['currentUser'])) {
                $post->Title = $args['NewTitle'];
                $post->write();
            }

            return $post;
        })
        ->end()
    ->query('latestPost', Post::class)
        ->setUsePagination(false)
        ->setResolver(function ($object, array $args, $context, ResolveInfo $info) {
            if (singleton(Post::class)->canView($context['currentUser'])) {
                return Post::get()->sort('Date', 'DESC')->first();
            }
        })
        ->end()
```

**GraphQL**

```
mutation updatePostTitle($ID: 123, $NewTitle: 'Foo') {
  Title
}
```

```
query latestPost {
  Title
}
```

Alternatively, if you want to customise a nested query, you can specify `QueryScaffolder` subclass, which
will allow you to write your own resolver and build your own set of arguments. This is particularly
useful if your nested query does not return a `DataList`, from which a dataobject class can be
inferred.

```
class MyCustomListQueryScaffolder extends ListQueryScaffolder
{
    public function resolve ($object, array $args, $context, ResolveInfo $info)
    {
        // .. custom query code
    }

    protected function createArgs(Manager $manager)
    {
        return [
            'SpecialArg' => [
                'type' => $manager->getType('SpecialInputType')
            ]
        ];
    }
}
```

**Via YAML**:

```
...
  nestedQueries:
    MyCustomList: My\Project\Scaffolders\MyCustomListQueryScaffolder
```

**... Or with code**:

```
 $scaffolder->type(MyObject::class)
    ->nestedQuery(
        'MyNestedField',  // the name of the field on the parent object
        new MyCustomListQueryScaffolder(
          'customOperation', // The name of the operation. Must be unique.
          'MyCustomType' // The type the query will return. Make sure it's been registered.
        )
    );
```

#### Dealing with inheritance

Adding any given type will implicitly add all of its ancestors, all the way back to `DataObject`.
Any fields you've listed on a descendant that are available on those ancestors will be exposed on the ancestors
as well. For CRUD operations, each ancestor gets its own set of operations and input types.

When reading types that have exposed descendants (e.g. reading Page, when RedirectorPage is also exposed),
the return type is a *union* of the base type and all exposed descendants. This union type takes on the name
`{BaseType}WithDescendants`.

**Via YAML**:

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      scaffolding:
        types:
          MyProject\Post:
            ##...
          SilverStripe\CMS\Model\RedirectorPage:
            fields: [ID, ExternalURL, Content]
            operations:
              read: true
              create: true
          Page:
            fields: [MyCustomField]
```

**... Or with code**:

```
$scaffolder
    ->type('SilverStripe\CMS\Model\RedirectorPage')
        ->addFields(['ID', 'ExternalURL', 'Content'])
        ->operation(SchemaScaffolder::READ)
            ->setName('readRedirectors')
            ->end()
        ->operation(SchemaScaffolder::CREATE)
            ->setName('createRedirector')
            ->end()
        ->end()
    ->type('Page')
        ->addFields(['MyCustomField'])
        ->end();
```

We now have the following added to our schema:

```
type RedirectorPage {
  ID: Int
  ExternalURL: String
  Content: String
  MyCustomField: String
}

type Page {
  ID: Int
  Content: String
  MyCustomField: String
}

type SiteTree {
  ID: Int
  Content: String
}

type PageWithDescendants {
  Page | RedirectorPage
}

type SiteTreeWithDescendants {
  SiteTree | Page | RedirectorPage
}

input RedirectorPageCreateInputType {
  ExternalURL: String
  RedirectionType: String
  MyCustomField: String
  Content: String
  # all other fields from RedirectorPage, Page and SiteTree
}

input PageCreateInputType {
  MyCustomField: String
  Content: String
  # all other fields from Page and SiteTree
}

input SiteTreeCreateInputType {
  # all fields from SiteTree
}

query readRedirectors {
  RedirectorPage
}

query readPages {
  PageWithDescendants
}

query readSiteTrees {
  SiteTreeWithDescendants
}

mutation createRedirector {
  RedirectorPageCreateInputType
}

mutation createPage {
  PageCreateInputType
}

mutation createSiteTree {
  SiteTreeCreateInputType
}
```

#### Querying types that have descendants

Keep in mind that when querying a base class that has descendant types exposed (e.g. querying `Page`
when `RedirectorPage` is also exposed), a union is returned, and you will need to resolve it
with the `...on {type}` GraphQL syntax.

```
query readSiteTrees {
  readSiteTrees {
    edges {
      node {
        __typename
        ...on Page {
          ID
        }
        ...on RedirectorPage {
          RedirectionType
        }
      }
    }
  }
}
```

#### Customising the names of types and operations

By default, the scaffolder will generate a type name for you based on the dataobject's `$table_name`
setting and the output of its `singular_name()` method. Often times, these are poor proxies for
a canonical name, e.g. `readMy_Really_Long_NameSpaced_BlogPosts`. To customise the type name, simply map a name to it in the `SilverStripe\GraphQL\Scaffolding\Schema`
class.

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      typeNames:
        My\Really\Long\Namespaced\BlogPost: Blog
```

Note that `typeNames` is the mapping of dataobjects to the graphql types, whereas the `types`
config is the list of type creators for non-scaffolded types, backed by php classes.
`typeNames` is also used (and required by) scaffolding, whether via PHP or YML.

Operations names are expressed using the type name of the dataobject they serve. That type name
may be customised or computed automatically, as described above. For a deeper level of control, you can
name the operation using the `name` property.

```
...
  operations:
    read:
      name: currentBlogs
```

The name of the operation has been fully customised to `currentBlogs`, returning the type `Blog`.

```
...
  operations:
    read: true
```

Otherwise, the name of the read operation, given the `Schema` config above, will be `readBlogs`.

### Versioned content

If the `silversrtripe/versioned` module is installed in your project (as it is with a default CMS install),
a series of schema updates specific to versioning will be provided to all types that use the `Versioned` extension.
These include:

#### Version-specific operations

* `publish<MyType>(ID: Int!)`
* `unpublish<MyType>(ID: Int!)`
* `copy<MyType>ToStage(Input: CopyToStageInputType { ID: Int, FromStage: String, ToStage: String, Version: Int })`

```
...
  operations:
    publish: true
    unpublish: true
    copyToStage: true
```

#### Version-specific arguments

Types that use the `Versioned` extension will also have their `read` operations extended to accept
a `Versioning` parameter which allows you define very specifically what versioning filters to apply
to the result set.

**The "Versioning" input**

| Field | Description |
| --- | --- |
| Mode | One of:   * **ARCHIVE** (Read from a specific date in the archive) * **LIVE** (Read from the live stage) * **DRAFT** (Read from the draft stage) * **LATEST** (Read the latest version from each record) * **STATUS** (Filter records by their status. Must supply a `Status` parameter) |
| ArchiveDate | The date, in `YYYY-MM-DD` format to use when in `ARCHIVE` mode. |
| [Status] | A list of statuses that records must match. Options:   * **PUBLISHED** (Include published records) * **DRAFT** (Include draft records) * **MODIFIED** (Include records that have draft changes) * **ARCHIVED** (Include records that have been deleted from stage) |

**GraphQL**

```
readBlogPosts(Versioning: {
  Mode: "DRAFT"
}) {
  Title
}

readBlogPosts(Versioning: {
  Mode: "ARCHIVE",
  ArchiveDate: "2016-11-08"
}) {
  Title
}

readBlogPosts(Versioning: {
  Mode: "STATUS",
  Status: [DRAFT, MODIFIED]
}) {
  Title
}

```

`readOne` operations also allow a `Version` parameter, which allows you to read a specific version.

**GraphQL**

```
readBlogPosts(Version: 5, ID: 100) {
  Title
}

```

#### Version-specific fields

Types that use the `Versioned` extension will also benefit from two new fields:

* `Version:Int` The version number of the record
* `Versions:[<MyTypeName>Version]` A paginated list of all the previous versions of this record. The type
  returned by this query contains a few additional fields: `Author:Member`, `Publisher:Member`, and `Published:Boolean`.

**GraphQL**

```
readBlogPosts {
  Title
  Version
  Versions(limit: 5) {
    Title
    Author {
      FirstName
    }
    Publisher {
      Email
    }
    Published
  }
}

```

### Define interfaces

TODO

### Define input types

TODO

## Extending

Many of the scaffolding classes use the `Extensible` trait, allowing you to influence the scaffolding process
with custom needs.

### Adding/removing fields from thirdparty code

Suppose you have a module that adds new fields to dataobjects that use your extension. You can write
and extension for `DataObjectScaffolder` to update the scaffolding before it is sent to the `Manager`.

```
class MyDataObjectScaffolderExtension extends Extension
{

  public function onBeforeAddToManager(Manager $manager)
  {
    if ($this->owner->getDataObjectInstance()->hasExtension(MyExtension::class)) {
      $this->owner->addField('MyField');
    }
  }
}
```

### Updating the core operations

The basic `CRUD` operations that come with the module are all extensible with`updateArgs` and `augmentMutation` (or `updateList` for read operations).

```
class MyCreateExtension extends Extension
{

  public function updateArgs(&$args, Manager $manager)
  {
    $args['SendEmail'] = ['type' => Type::bool()];
  }

  public function augmentMutation($object, array $args, $context, ResolveInfo $info)
  {
    if ($args['SendEmail']) {
      MyService::inst()->sendEmail();
      $object->EmailSent = true;
    }
  }
}
```

### Adding new operations

If you have a custom operation, in addition to `read`, `update`, `delete`, etc., that you want available
to some or all types, you can write one and register it with the scaffolder. Let's suppose we have
an ecommerce module that wants to offer an `addToCart` mutation to any dataobject that implements
the `Product` interface.

```
class AddToCartOperation extends MutationScaffolder
{

   public function __construct($dataObjectClass)
   {
      parent::__construct($this->createOperationName(), $dataObjectClass);
      if (!$this->getDataObjectInstance() instanceof ProductInterface) {
        throw new InvalidArgumentException(
            'addToCart operation is only for implementors of ProductInterface'
        );
      }
      $this->setResolver(function($object, array $args, $context, ResolveInfo $info) {
        $record = DataObject::get_by_id($this->dataObjectClass, $args['ID']);
        if (!$record) {
          throw new Exception('ID not found');
        }

        $record->addToCart();

        return $record;
      });
   }

   protected function createArgs(Manager $manager)
   {
      return [
        'ID' => ['type' => Type::nonNull(Type::id())]
      ];
   }

   protected function createOperationName()
   {
        return 'add' . ucfirst($this->typeName()) . 'ToCart';
   }

}
```

Now, register it as an opt-in operation.

```
SilverStripe\GraphQL\Scaffolding\Scaffolders\OperationScaffolder:
  operations:
    addToCart: My\Project\AddToCartOperation
```

### Changing behaviour with Middleware

You can influence behaviour based on query data or passed-in parameters.
This can be useful for features which would be too cumbersome on a resolver level,
for example logging and caching.

Note this is separate from [HTTP Middleware](https://docs.silverstripe.org/en/developer_guides/controllers/middlewares/)
which are more suited to influence behaviour based on HTTP request introspection
(for example, by enforcing authentication for any request matching `/graphql`).

Example middleware to log all mutations (but not queries):

```
<?php
use GraphQL\Type\Schema;
use SilverStripe\GraphQL\Middleware\QueryMiddleware;

class MyMutationLoggingMiddleware implements QueryMiddleware
{
    public function process(Schema $schema, $query, $context, $params, callable $next)
    {
        if (preg_match('/^mutation/', $query)) {
            $this->log('Executed mutation: ' . $query);
        }

        return $next($schema, $query, $context, $params);
    }

    protected function log($str)
    {
        // ...
    }
}
```

```
SilverStripe\Core\Injector\Injector:
  SilverStripe\GraphQL\Manager:
    properties:
      Middlewares:
        MyMutationLoggingMiddleware: '%$MyMutationLoggingMiddleware'
```

If you want to use middleware to cache responses,
here's a more [comprehensive caching middleware example](https://gist.github.com/tractorcow/fe6571d2d00340a311ca31a677a05a29).

## Testing/debugging queries and mutations

An in-browser IDE for the GraphQL server is available via the [silverstripe-graphql-devtools](https://github.com/silverstripe/silverstripe-graphql-devtools) module.

As an alternative, a [desktop version](https://github.com/skevy/graphiql-app) of this application is also available. (OSX only)

## Authentication

Some Silverstripe resources have permission requirements to perform CRUD operations
on, for example the `Member` object in the previous examples.

If you are logged into the CMS and performing a request from the same session then
the same Member session is used to authenticate GraphQL requests, however if you
are performing requests from an anonymous/external application you may need to
authenticate before you can complete a request.

Please note that when implementing GraphQL resources it is the developer's
responsibility to ensure that permission checks are implemented wherever
resources are accessed.

### Default authentication

The `MemberAuthenticator` class is configured as the default option for authentication,
and will attempt to use the current CMS `Member` session for authentication context.

**If you are using the default session-based authentication, please be sure that you have
the [CSRF Middleware](#csrf-tokens-required-for-mutations) enabled. (It is by default).**

### HTTP basic authentication

Silverstripe has built in support for [HTTP basic authentication](https://en.wikipedia.org/wiki/Basic_access_authentication).
There is a `BasicAuthAuthenticator` which is configured for GraphQL by default, but
will only activate when required. It is kept separate from the Silverstripe CMS
authenticator because GraphQL needs to use the successfully authenticated member
for CMS permission filtering, whereas the global `BasicAuth` does not log the
member in or use it for model security.

When using HTTP basic authentication, you can feel free to remove the [CSRF Middleware](#csrf-tokens-required-for-mutations),
as it just adds unnecessary overhead to the request.

#### In GraphiQL

If you want to add basic authentication support to your GraphQL requests you can
do so by adding a custom `Authorization` HTTP header to your GraphiQL requests.

If you are using the [GraphiQL macOS app](https://github.com/skevy/graphiql-app)
this can be done from "Edit HTTP Headers". The `/dev/graphiql` implementation
does not support custom HTTP headers at this point.

Your custom header should follow the following format:

```
# Key: Value
Authorization: Basic aGVsbG86d29ybGQ=

```

`Basic` is followed by a [base64 encoded](https://en.wikipedia.org/wiki/Base64)
combination of your username, colon and password. The above example is `hello:world`.

**Note:** Authentication credentials are transferred in plain text when using HTTP
basic authentication. We strongly recommend using TLS for non-development use.

Example:

```
php -r 'echo base64_encode("hello:world");'
# aGVsbG86d29ybGQ=
```

### Defining your own authenticators

You will need to define the class under `SilverStripe\GraphQL\Auth\Handlers.authenticators`.
You can optionally provide a `priority` number if you want to control which
Authenticator is used when multiple are defined (higher priority returns first).

Authenticator classes will need to implement the `SilverStripe\GraphQL\Auth\AuthenticatorInterface`
interface, which requires you to define an `authenticate` method to return a Member, or false, and
and `isApplicable` method which tells the `Handler` whether or not this authentication method
is applicable in the current request context (provided as an argument).

Here's an example for implementing HTTP basic authentication (note that basic auth is enabled by default anyway):

```
SilverStripe\GraphQL\Auth\Handler:
  authenticators:
    - class: SilverStripe\GraphQL\Auth\BasicAuthAuthenticator
      priority: 10
```

## CSRF tokens (required for mutations)

Even if your graphql endpoints are behind authentication, it is still possible for unauthorised
users to access that endpoint through a [CSRF exploitation](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29). This involves
forcing an already authenticated user to access an HTTP resource unknowingly (e.g. through a fake image), thereby hijacking the user's
session.

In the absence of a token-based authentication system, like OAuth, the best countermeasure to this
is the use of a CSRF token for any requests that destroy or mutate data.

By default, this module comes with a `CSRFMiddleware` implementation that forces all mutations to check
for the presence of a CSRF token in the request. That token must be applied to a header named `X-CSRF-TOKEN`.

In Silverstripe, CSRF tokens are most commonly stored in the session as `SecurityID`, or accessed through
the `SecurityToken` API, using `SecurityToken::inst()->getValue()`.

Queries do not require CSRF tokens.

### Disabling CSRF protection (for token-based authentication only)

If you are using HTTP basic authentication or a token-based system like OAuth or [JWT](https://github.com/Firesphere/silverstripe-graphql-jwt),
you will want to remove the CSRF protection, as it just adds unnecessary overhead. You can do this by setting
the middleware to `false`.

```
SilverStripe\Core\Injector\Injector:
  SilverStripe\GraphQL\Manager.default:
    properties:
      Middlewares:
        CSRFMiddleware: false
```

## Cross-Origin Resource Sharing (CORS)

By default [CORS](https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS) is disabled in the GraphQL Server. This can be easily enabled via YAML:

```
SilverStripe\GraphQL\Controller:
  cors:
    Enabled: true
```

Once you have enabled CORS you can then control four new headers in the HTTP Response.

1. **Access-Control-Allow-Origin.**

This lets you define which domains are allowed to access your GraphQL API. There are
4 options:

* **Blank**:
  Deny all domains (except localhost)

```
Allow-Origin:
```

* **'\*'**:
  Allow requests from all domains.

```
Allow-Origin: '*'
```

* **Single Domain**:

Allow requests from one specific external domain.

```
Allow-Origin: 'my.domain.com'
```

* **Multiple Domains**:

Allow requests from multiple specified external domains.

```
Allow-Origin:
  - 'my.domain.com'
  - 'your.domain.org'
```

2. **Access-Control-Allow-Headers.**

Access-Control-Allow-Headers is part of a CORS 'pre-flight' request to identify
what headers a CORS request may include. By default, the GraphQL server enables the
`Authorization` and `Content-Type` headers. You can add extra allowed headers that
your GraphQL may need by adding them here. For example:

```
Allow-Headers: 'Authorization, Content-Type, Content-Language'
```

**Note** If you add extra headers to your GraphQL server, you will need to write a
custom resolver function to handle the response.

3. **Access-Control-Allow-Methods.**

This defines the HTTP request methods that the GraphQL server will handle. By
default this is set to `GET, PUT, OPTIONS`. Again, if you need to support extra
methods you will need to write a custom resolver to handle this. For example:

```
Allow-Methods: 'GET, PUT, DELETE, OPTIONS'
```

4. **Access-Control-Max-Age.**

Sets the maximum cache age (in seconds) for the CORS pre-flight response. When
the client makes a successful OPTIONS request, it will cache the response
headers for this specified duration. If the time expires or the required
headers are different for a new CORS request, the client will send a new OPTIONS
pre-flight request to ensure it still has authorisation to make the request.
This is set to 86400 seconds (24 hours) by default but can be changed in YAML as
in this example:

```
Max-Age: 600
```

5. **Access-Control-Allow-Credentials.**

When a request's credentials mode (Request.credentials) is "include", browsers
will only expose the response to frontend JavaScript code if the
Access-Control-Allow-Credentials value is true.

The Access-Control-Allow-Credentials header works in conjunction with the
XMLHttpRequest.withCredentials property or with the credentials option in the
Request() constructor of the Fetch API. For a CORS request with credentials,
in order for browsers to expose the response to frontend JavaScript code, both
the server (using the Access-Control-Allow-Credentials header) and the client
(by setting the credentials mode for the XHR, Fetch, or Ajax request) must
indicate that they’re opting in to including credentials.

This is set to empty by default but can be changed in YAML as in this example:

```
Allow-Credentials: 'true'
```

### Apply a CORS config to all GraphQL endpoints

```
## CORS Config
SilverStripe\GraphQL\Controller:
  cors:
    Enabled: true
    Allow-Origin: 'silverstripe.org'
    Allow-Headers: 'Authorization, Content-Type'
    Allow-Methods:  'GET, POST, OPTIONS'
    Allow-Credentials: 'true'
    Max-Age:  600  # 600 seconds = 10 minutes.
```

### Apply a CORS config to a single GraphQL endpoint

```
## CORS Config
SilverStripe\Core\Injector\Injector:
  SilverStripe\GraphQL\Controller.default
    properties:
      corsConfig:
        Enabled: false
```

## Recursive or complex queries

GraphQL schemas can contain recursive types and circular dependencies. Recursive or overly complex queries can take up a lot of resources,
and could have a high impact on server performance and even result in a denial of service if not handled carefully.

Before parsing queries, if a query is found to have more than 500 nodes, it is rejected.

While executing queries, there is a default query depth limit of 15 for all schemas, and no current complexity limit.

For calculating the query complexity, every field in the query gets a default score 1 (including ObjectType nodes). Total complexity of the query is the sum of all field scores.

You can customise the node limit and query depth and complexity limits by setting the following configuration:

**app/\_config/graphql.yml**

```
SilverStripe\GraphQL\Manager:
  default_max_query_nodes: 250 # default 500
  default_max_query_depth: 20 # default 15
  default_max_query_complexity: 100 # default unlimited
```

You can also configure these settings for individual schemas. This allows you to fine-tune the security of your custom public-facing schema without affecting the security of the schema used in the CMS. To do so, set the values for your schema like so:

**app/\_config/graphql.yml**

```
SilverStripe\GraphQL\Manager:
  schemas:
    default:
      max_query_nodes: 250
      max_query_depth: 20
      max_query_complexity: 100
```

## Persisting queries

A common pattern in GraphQL APIs is to store queries on the server by an identifier. This helps save
on bandwidth, as the client need not put a fully expressed query in the request body, but rather a
simple identifier. Also, it allows you to whitelist only specific query IDs, and block all other ad-hoc,
potentially malicious queries, which adds an extra layer of security to your API, particularly if it's public.

To implement persisted queries, you need an implementation of the
`SilverStripe\GraphQL\PersistedQuery\PersistedQueryMappingProvider` interface. By default, three are provided,
which cover most use cases:

* `FileProvider`: Store your queries in a flat JSON file on the local filesystem.
* `HTTPProvider`: Store your queries on a remote server and reference a JSON file by URL.
* `JSONStringProvider`: Store your queries as hardcoded JSON

### Configuring query mapping providers

All of these implementations can be configured through `Injector`. Note that each schema gets its
own set of persisted queries. In these examples, we're using the `default`schema.

#### FileProvider

```
SilverStripe\Core\Injector\Injector:
  SilverStripe\GraphQL\PersistedQuery\PersistedQueryMappingProvider:
    class: SilverStripe\GraphQL\PersistedQuery\FileProvider:
      properties:
       schemaMapping:
         default: '/var/www/project/query-mapping.json'
```

A flat file in the path `/var/www/project/query-mapping.json` should contain something like:

```
{"someUniqueID":"query{validateToken{Valid Message Code}}"}
```

#### HTTPProvider

```
SilverStripe\Core\Injector\Injector:
  SilverStripe\GraphQL\PersistedQuery\PersistedQueryMappingProvider:
    class: SilverStripe\GraphQL\PersistedQuery\HTTPProvider:
      properties:
       schemaMapping:
         default: 'http://example.com/myqueries.json'
```

A flat file at the URL `http://example.com/myqueries.json` should contain something like:

```
{"someUniqueID":"query{readMembers{Name+Email}}"}
```

#### JSONStringProvider

```
SilverStripe\Core\Injector\Injector:
  SilverStripe\GraphQL\PersistedQuery\PersistedQueryMappingProvider:
    class: SilverStripe\GraphQL\PersistedQuery\HTTPProvider:
      properties:
       schemaMapping:
         default: '{"myMutation":"mutation{createComment($comment:String!){Comment}}"}'
```

The queries are hardcoded into the configuration.

### Requesting queries by identifier

To access a persisted query, simply pass an `id` parameter in the request in lieu of `query`.

`GET http://example.com/graphql?id=someID`

Note that if you pass `query` along with `id`, an exception will be thrown.

## Schema introspection

Some GraphQL clients such as [Apollo](http://apollographql.com) require some level of introspection
into the schema. While introspection is [part of the GraphQL spec](http://graphql.org/learn/introspection/),
this module provides a limited API for fetching it via non-graphql endpoints. By default, the `graphql/`
controller provides a `types` action that will return the type schema (serialised as JSON) dynamically.

*GET <http://example.com/graphql/types>*

```
{
   "data":{
      "__schema":{
         "types":[
            {
               "kind":"OBJECT",
               "name":"Query",
               "possibleTypes":null
            }
            // etc ...
         ]
      }
   }
```

As your schema grows, introspecting it dynamically may have a performance hit. Alternatively,
if you have the `silverstripe/assets` module installed (as it is in the default Silverstripe installation),
GraphQL can cache your schema as a flat file in the `assets/` directory. To enable this, simply
set the `cache_types_in_filesystem` setting to `true` on `SilverStripe\GraphQL\Controller`. Once enabled,
a `types.graphql` file will be written to your `assets/` directory on `flush`.

When `cache_types_in_filesystem` is enabled, it is recommended that you remove the extension that
provides the dynamic introspection endpoint.

```
use SilverStripe\GraphQL\Controller;
use SilverStripe\GraphQL\Extensions\IntrospectionProvider;

Controller::remove_extension(IntrospectionProvider::class);
```

## Setting up a new GraphQL schema

In addition to the default `/graphql` endpoint provided by this module by default,
along with the `admin/graphql` endpoint provided by the CMS modules (if they're installed),
you may want to set up another GraphQL server running on the same installation of Silverstripe.

First, set up a new `Manager` implementation for your custom server.

*app/\_config/graphql.yml*

```
SilverStripe\Core\Injector\Injector:
  SilverStripe\GraphQL\Manager.myApp:
    class: SilverStripe\GraphQL\Manager
    constructor:
      schemaKey: mySchema
```

The `schemaKey` setting is a bit of meta-configuration used to tell the Manager where to
look in the `SilverStripe\GraphQL\Manager.schemas` config for the schema information.

Now let's setup a new controller to handle the requests. It will use our custom Manager instance.

```
SilverStripe\Core\Injector\Injector:
  # ...
  SilverStripe\GraphQL\Controller.myApp:
    class: SilverStripe\GraphQL\Controller
    constructor:
      manager: %$SilverStripe\GraphQL\Manager.myApp

```

Lastly, we'll need to route the controller.

```
SilverStripe\Control\Director:
  rules:
    'my-graphql': '%$SilverStripe\GraphQL\Controller.myApp'
```

Now, configure your schema.

```
SilverStripe\GraphQL\Manager:
  schemas:
    myApp:
      # Your config will go here..
```

## Strict HTTP Method Checking

According to GraphQL best practices, mutations should be done over `POST`, while queries have the option
to use either `GET` or `POST`. By default, this module enforces the `POST` request method for all mutations.

To disable that requirement, you can remove the `HTTPMethodMiddleware` from your `Manager` implementation.

```
  SilverStripe\GraphQL\Manager:
    properties:
      Middlewares:
        HTTPMethodMiddleware: false
```

## TODO

* Permission checks
* Input/constraint validation on mutations (with third-party validator)
* CSRF protection (or token-based auth)
* Create Enum GraphQL types from DBEnum
* Date casting
* Schema serialisation/caching (performance)
* Scaffolding description, deprecation attributes
* Remove operations/fields via YAML
* Refine CRUD operations

## About

Serves Silverstripe data as GraphQL representations

### Topics

[hacktoberfest](/topics/hacktoberfest "Topic: hacktoberfest")

### Resources

[Readme](#readme-ov-file)
### License

[BSD-3-Clause license](/silverstripe/silverstripe-graphql/blob/5/LICENSE)

[Activity](/silverstripe/silverstripe-graphql/activity)
[Custom properties](/silverstripe/silverstripe-graphql/custom-properties)
### Stars

[**52**
stars](/silverstripe/silverstripe-graphql/stargazers)
### Watchers

[**16**
watching](/silverstripe/silverstripe-graphql/watchers)
### Forks

[**61**
forks](/silverstripe/silverstripe-graphql/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fsilverstripe%2Fsilverstripe-graphql&report=silverstripe+%28user%29)

## [Releases 61](/silverstripe/silverstripe-graphql/releases)

[5.2.3
Latest

Jun 18, 2024](/silverstripe/silverstripe-graphql/releases/tag/5.2.3)
[+ 60 releases](/silverstripe/silverstripe-graphql/releases)

## [Contributors 36](/silverstripe/silverstripe-graphql/graphs/contributors)

[+ 22 contributors](/silverstripe/silverstripe-graphql/graphs/contributors)

## Languages

* [PHP
  100.0%](/silverstripe/silverstripe-graphql/search?l=php)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from docs.silverstripe.org_b445ad8e_20250110_212313.html ===
This app works best with JavaScript enabled.[Silverstripe CMS Documentation](/en/5/ "Go to the home page")CMS DocsSearch

* V6V5V4V3

* [Getting Started](/en/5/getting_started/)
* [Server Requirements](/en/5/getting_started/server_requirements/)
* [Composer](/en/5/getting_started/composer/)
* [Environment Management](/en/5/getting_started/environment_management/)
* [Directory Structure](/en/5/getting_started/directory_structure/)
* [Recipes](/en/5/getting_started/recipes/)
* [Lessons](/en/5/lessons/)
* [Developer Guides](/en/5/developer_guides/)
* [Model and Databases](/en/5/developer_guides/model/)
* [Templates and Views](/en/5/developer_guides/templates/)
* [Controllers](/en/5/developer_guides/controllers/)
* [Forms](/en/5/developer_guides/forms/)
* [Configuration](/en/5/developer_guides/configuration/)
* [Extending Silverstripe CMS](/en/5/developer_guides/extending/)
* [Testing](/en/5/developer_guides/testing/)
* [Debugging](/en/5/developer_guides/debugging/)
* [Performance](/en/5/developer_guides/performance/)
* [Security](/en/5/developer_guides/security/)
* [Email](/en/5/developer_guides/email/)
* [Integration and Web Services](/en/5/developer_guides/integration/)
* [Search](/en/5/developer_guides/search/)
* [i18n](/en/5/developer_guides/i18n/)
* [Files](/en/5/developer_guides/files/)
* [Customising the Admin Interface](/en/5/developer_guides/customising_the_admin_interface/)
* [Execution pipeline](/en/5/developer_guides/execution_pipeline/)
* [Command Line Interface](/en/5/developer_guides/cli/)
* [Cookies and Sessions](/en/5/developer_guides/cookies_and_sessions/)
* [GraphQL](/en/5/developer_guides/graphql/)
* [Getting started](/en/5/developer_guides/graphql/getting_started/)
* [Working with DataObject models](/en/5/developer_guides/graphql/working_with_dataobjects/)
* [Working with generic types](/en/5/developer_guides/graphql/working_with_generic_types/)
* [Security & best practices](/en/5/developer_guides/graphql/security_and_best_practices/)
* [Plugins](/en/5/developer_guides/graphql/plugins/)
* [Extending the schema](/en/5/developer_guides/graphql/extending/)
* [Tips & Tricks](/en/5/developer_guides/graphql/tips_and_tricks/)
* [Architecture Diagrams](/en/5/developer_guides/graphql/architecture_diagrams/)
* [Optional features](/en/5/optional_features/)
* [Elemental blocks](/en/5/optional_features/elemental/)
* [Linkfield](/en/5/optional_features/linkfield/)
* [Multi-factor authentication (MFA)](/en/5/optional_features/mfa/)
* [Taxonomies](/en/5/optional_features/taxonomies/)
* [UserForms](/en/5/optional_features/userforms/)
* [Upgrading](/en/5/upgrading/)
* [Staying up to date with CMS releases](/en/5/upgrading/keeping_projects_up_to_date/)
* [Deprecations](/en/5/upgrading/deprecations/)
* [Changelogs](/en/5/changelogs/)
* [Contributing](/en/5/contributing/)
* [Issues and Bug Reports](/en/5/contributing/issues_and_bugs/)
* [Contributing Code](/en/5/contributing/code/)
* [Contributing Documentation](/en/5/contributing/documentation/)
* [Contributing Translations](/en/5/contributing/translations/)
* [Coding conventions](/en/5/contributing/coding_conventions/)
* [Build tooling](/en/5/contributing/build_tooling/)
* [Triage and peer review](/en/5/contributing/triage_resources/)
* [Release process](/en/5/contributing/release_process/)
* [Managing security issues](/en/5/contributing/managing_security_issues/)
* [Project Governance](/en/5/project_governance/)
* [Core committers](/en/5/project_governance/core_committers/)
* [Code of conduct](/en/5/project_governance/code_of_conduct/)
* [Maintainer guidelines](/en/5/project_governance/maintainer_guidelines/)
* [Request for comment](/en/5/project_governance/request_for_comment/)
* [Major Release Policy](/en/5/project_governance/major_release_policy/)
* [Minor Release Policy](/en/5/project_governance/minor_release_policy/)
* [Supported modules](/en/5/project_governance/supported_modules/)
* [Fixed dependencies](/en/5/project_governance/fixed_dependencies/)
* [Definition of Public API](/en/5/project_governance/public_api/)
* [GitHub repository management](/en/5/project_governance/repository_management/)
Version 5
supported
# Security & best practices[#](#security-and-best-practices)

[Cross-Origin Resource Sharing (CORS)](/en/5/developer_guides/graphql/security_and_best_practices/cors/)Ensure that requests to your API come from a whitelist of origins[Strict HTTP method checking](/en/5/developer_guides/graphql/security_and_best_practices/http_method_checking/)Ensure requests are GET or POST[CSRF protection](/en/5/developer_guides/graphql/security_and_best_practices/csrf_protection/)Protect destructive actions from cross-site request forgery[Authentication](/en/5/developer_guides/graphql/security_and_best_practices/authentication/)Ensure your GraphQL api is only accessible to provisioned users[Recursive or complex queries](/en/5/developer_guides/graphql/security_and_best_practices/recursive_or_complex_queries/)Protecting against potentially malicious queries
## Recursive or complex queries[#](#recursive-or-complex-queries)

GraphQL schemas can contain recursive types and circular dependencies. Recursive or overly complex queries can take up a lot of resources,
and could have a high impact on server performance and even result in a denial of service if not handled carefully.

Before parsing queries, if a query is found to have more than 500 nodes, it is rejected. While executing queries there is a default query depth limit of 15 for all schemas with no complexity limit.

You can customise the node limit and query depth and complexity limits by setting the following configuration:

```
# app/_config/graphql.yml
---
After: 'graphql-schema-global'
---
SilverStripe\GraphQL\Schema\Schema:
  schemas:
    '*':
      config:
        max_query_nodes: 250 # default 500
        max_query_depth: 20 # default 15
        max_query_complexity: 100 # default unlimited
```

For calculating the query complexity, every field in the query gets a default score 1 (including ObjectType nodes). Total complexity of the query is the sum of all field scores.

You can also configure these settings for individual schemas. This allows you to fine-tune the security of your custom public-facing schema without affecting the security of the schema used in the CMS. To do so, either replace `'*'` with the name of your schema in the YAML configuration above, or set the values under the `config` key for your schema using preferred file structure as defined in [configuring your schema](/en/5/developer_guides/graphql/getting_started/configuring_your_schema/). For example:

```
# app/_graphql/config.yml
max_query_nodes: 250
max_query_depth: 20
max_query_complexity: 100
```
### Further reading[#](#further-reading)

##### Cross-Origin Resource Sharing (CORS)

Ensure that requests to your API come from a whitelist of origins
##### Strict HTTP method checking

Ensure requests are GET or POST
##### CSRF protection

Protect destructive actions from cross-site request forgery
##### Authentication

Ensure your GraphQL api is only accessible to provisioned users
##### Recursive or complex queries

Protecting against potentially malicious queries [Edit on Github](https://github.com/silverstripe/developer-docs/edit/5.3/en/02_Developer_Guides/19_GraphQL/04_security_and_best_practices/05_recursive_or_complex_queries.md "Edit on Github")

=== Content from www.silverstripe.org_f1818812_20250110_212317.html ===

[Skip to main content](/download/security-releases/CVE-2023-40180#content)

**This site requires you to enable JavaScript.** Your browsing experience may not be as good as with it turned on.

**This site requires you to update your browser.** Your browsing experience maybe affected by not having the most up to date version.

Site Navigation
# [Open Source](//www.silverstripe.org "Silverstripe CMS")

Mobile site navigation

* Search
  Site search

* [Software](//www.silverstripe.org/software/ "Go to the Software page")
  + [CMS](//www.silverstripe.org/software/cms/ " Go to the CMS page")
  + [Framework](//www.silverstripe.org/software/framework/ " Go to the Framework page")
  + [Addons](//www.silverstripe.org/software/addons/ " Go to the Addons page")
  + [Hosting](//www.silverstripe.org/software/hosting/ " Go to the Hosting page")
  + [Roadmap](//www.silverstripe.org/software/roadmap/ " Go to the Roadmap page")
  + [History](//www.silverstripe.org/software/history/ " Go to the History page")
  + [BSD License](//www.silverstripe.org/software/bsd-license/ " Go to the BSD License page")
* [Community](//www.silverstripe.org/community/ "Go to the Community page")
  + [Developer directory](//www.silverstripe.org/community/developer-and-partner-directory/ " Go to the Developer directory page")
  + [Showcase](//www.silverstripe.org/community/showcase/ " Go to the Showcase page")
  + [Forums](//forum.silverstripe.org " Go to the Forums page")
  + [Slack](//www.silverstripe.org/community/slack-signup/ " Go to the Join the community page")
  + [Join us](//www.silverstripe.org/ForumMemberProfile/register " Go to the Join us page")
  + [Contribute](//www.silverstripe.org/community/contributing-to-silverstripe/ " Go to the Contributing to SilverStripe page")
* [Learn](//www.silverstripe.org/learn/ "Go to the Learn page")
  + [Using the CMS](//userhelp.silverstripe.org " Go to the Using the CMS page")
  + [Developer Docs](//docs.silverstripe.org " Go to the Developer Documentation page")
  + [API Docs](//api.silverstripe.org " Go to the API Documentation page")
  + [Lessons](//www.silverstripe.org/learn/lessons/v4/ " Go to the Lessons page")
* [Blog](//www.silverstripe.org/blog/ "Go to the Blog page")
* [Download](//www.silverstripe.org/download/ "Go to the Download page")
  + [Addons](//addons.silverstripe.org/add-ons " Go to the Addons page")
  + [Security Releases](//www.silverstripe.org/download/security-releases/ " Go to the Security Releases page")
  + [Release Archive](//www.silverstripe.org/download/release-archive/ " Go to the Release Archive page")
  + [Changelog](//docs.silverstripe.org/en/4/changelogs/ " Go to the Changelog page")
  + [Release process](//docs.silverstripe.org/en/4/contributing/release_process/ " Go to the About the release process page")
* [Try](//www.silverstripe.org/try/ "Go to the Try page")

* [Open Source](//www.silverstripe.org/ "Go to the Open Source page")
  + [Software](//www.silverstripe.org/software/ "Go to the Software page")
    - [CMS](//www.silverstripe.org/software/cms/ "Go to the CMS page")
      * [Screencasts](//www.silverstripe.org/software/cms/screencasts/ "Go to the Screencasts page")
    - [Framework](//www.silverstripe.org/software/framework/ "Go to the Framework page")
    - [Addons](//www.silverstripe.org/software/addons/ "Go to the Addons page")
      * [Modules](//addons.silverstripe.org/add-ons "Go to the Modules page")
      * [Themes](//addons.silverstripe.org/add-ons?type=theme&view=expanded "Go to the Themes page")
      * [Vendors](//addons.silverstripe.org/vendors "Go to the Vendors page")
      * [Authors](//addons.silverstripe.org/authors "Go to the Authors page")
      * [Tags](//addons.silverstripe.org/tags "Go to the Tags page")
      * [Submit](//addons.silverstripe.org/submit "Go to the Submit page")
      * [Supported Modules Definition](//www.silverstripe.org/software/addons/supported-modules-definition/ "Go to the Supported Modules Definition page")
      * [Commercially Supported Modules](//docs.silverstripe.org/en/project_governance/supported_modules/ "Go to the SilverStripe Commercially Supported Module List page")
    - [Hosting](//www.silverstripe.org/software/hosting/ "Go to the Hosting page")
    - [Roadmap](//www.silverstripe.org/software/roadmap/ "Go to the Roadmap page")
    - [History](//www.silverstripe.org/software/history/ "Go to the History page")
      * [Feedback and reviews](//www.silverstripe.org/software/history/read-feedback/ "Go to the Feedback and reviews page")
    - [BSD License](//www.silverstripe.org/software/bsd-license/ "Go to the BSD License page")
  + [Community](//www.silverstripe.org/community/ "Go to the Community page")
    - [Developer directory](//www.silverstripe.org/community/developer-and-partner-directory/ "Go to the Developer directory page")
    - [Showcase](//www.silverstripe.org/community/showcase/ "Go to the Showcase page")
      * [New Submission](//www.silverstripe.org/community/showcase/listing/new/manage "Go to the New Submission page")
    - [Forums](//forum.silverstripe.org "Go to the Forums page")
    - [Slack](//www.silverstripe.org/community/slack-signup/ "Go to the Join the community page")
    - [Join us](//www.silverstripe.org/ForumMemberProfile/register "Go to the Join us page")
    - [Contribute](//www.silverstripe.org/community/contributing-to-silverstripe/ "Go to the Contributing to SilverStripe page")
      * [Designers](//www.silverstripe.org/community/contributing-to-silverstripe/designers/ "Go to the Designers page")
      * [Github All Open UX issues](//elvis.silverstripe.org/?supported=1&mode=ux "Go to the Github All Open UX issues page")
  + [Learn](//www.silverstripe.org/learn/ "Go to the Learn page")
    - [Using the CMS](//userhelp.silverstripe.org "Go to the Using the CMS page")
    - [Developer Docs](//docs.silverstripe.org "Go to the Developer Documentation page")
    - [API Docs](//api.silverstripe.org "Go to the API Documentation page")
    - [Lessons](//www.silverstripe.org/learn/lessons/v4/ "Go to the Lessons page")
      * [Lessons (v4)](//www.silverstripe.org/learn/lessons/v4/ "Go to the Lessons page")
      * [Lessons (v3)](//www.silverstripe.org/learn/lessons/v3/ "Go to the Lessons page")
  + [Blog](//www.silverstripe.org/blog/ "Go to the Blog page")
  + [Download](//www.silverstripe.org/download/ "Go to the Download page")
    - [Addons](//addons.silverstripe.org/add-ons "Go to the Addons page")
    - [Security Releases](//www.silverstripe.org/download/security-releases/ "Go to the Security Releases page")
      * [CVE-2019-12245: Incorrect access control vulnerability in files uploaded to protected folders](//www.silverstripe.org/download/security-releases/cve-2019-12245/ "Go to the CVE-2019-12245: Incorrect access control vulnerability in files uploaded to protected folders page")
      * [CVE-2019-12149: Potential SQL injection in restfulserver and registry modules](//www.silverstripe.org/download/security-releases/cve-2019-12149/ "Go to the CVE-2019-12149: Potential SQL injection in restfulserver and registry modules page")
      * [CVE-2019-12246: Denial of Service on flush and development URL tools](//www.silverstripe.org/download/security-releases/cve-2019-12246/ "Go to the CVE-2019-12246: Denial of Service on flush and development URL tools page")
      * [CVE-2019-12437: Cross Site Request Forgery (CSRF) Protection Bypass in GraphQL](//www.silverstripe.org/download/security-releases/cve-2019-12437/ "Go to the CVE-2019-12437: Cross Site Request Forgery (CSRF) Protection Bypass in GraphQL page")
      * [CVE-2019-5715: Reflected SQL Injection through Form and DataObject](//www.silverstripe.org/download/security-releases/ss-2018-021/ "Go to the CVE-2019-5715: Reflected SQL Injection through Form and DataObject page")
      * [SS-2018-024: GraphQL does not validate X-CSRF-TOKEN](//www.silverstripe.org/download/security-releases/ss-2018-024/ "Go to the SS-2018-024: GraphQL does not validate X-CSRF-TOKEN page")
      * [SS-2018-020: Potential SQL vulnerability in PostgreSQL database connector](//www.silverstripe.org/download/security-releases/ss-2018-020/ "Go to the SS-2018-020: Potential SQL vulnerability in PostgreSQL database connector page")
      * [SS-2018-019: Possible denial of service attack vector when flushing](//www.silverstripe.org/download/security-releases/ss-2018-019/ "Go to the SS-2018-019: Possible denial of service attack vector when flushing page")
      * [SS-2018-018: Database credentials disclosure during connection failure](//www.silverstripe.org/download/security-releases/ss-2018-018/ "Go to the SS-2018-018: Database credentials disclosure during connection failure page")
      * [SS-2018-017: Possible PHP Object Injection via Multi-Value Field Extension](//www.silverstripe.org/download/security-releases/ss-2018-017/ "Go to the SS-2018-017: Possible PHP Object Injection via Multi-Value Field Extension page")
      * [SS-2018-016: Unsafe SQL Query Construction (Safe Data Source)](//www.silverstripe.org/download/security-releases/ss-2018-016/ "Go to the SS-2018-016: Unsafe SQL Query Construction (Safe Data Source) page")
      * [SS-2018-015: Vulnerable dependency](//www.silverstripe.org/download/security-releases/ss-2018-015/ "Go to the SS-2018-015: Vulnerable dependency page")
      * [SS-2018-014: Dangerous file types in allowed upload](//www.silverstripe.org/download/security-releases/ss-2018-014/ "Go to the SS-2018-014: Dangerous file types in allowed upload page")
      * [SS-2018-013: Passwords sent back to browsers under some circumstances](//www.silverstripe.org/download/security-releases/ss-2018-013/ "Go to the SS-2018-013: Passwords sent back to browsers under some circumstances page")
      * [SS-2018-012: Uploaded PHP script execution in assets](//www.silverstripe.org/download/security-releases/ss-2018-012/ "Go to the SS-2018-012: Uploaded PHP script execution in assets page")
      * [SS-2018-011: SQL injection vulnerability](//www.silverstripe.org/download/security-releases/ss-2018-011/ "Go to the SS-2018-011: SQL injection vulnerability page")
      * [SS-2018-010: Member disclosure in login form](//www.silverstripe.org/download/security-releases/ss-2018-010/ "Go to the SS-2018-010: Member disclosure in login form page")
      * [SS-2018-008: BackURL validation bypass with malformed URLs](//www.silverstripe.org/download/security-releases/ss-2018-008/ "Go to the SS-2018-008: BackURL validation bypass with malformed URLs page")
      * [SS-2018-007: CSRF vulnerability in graphql](//www.silverstripe.org/download/security-releases/ss-2018-007/ "Go to the SS-2018-007: CSRF vulnerability in graphql page")
      * [SS-2018-007: GraphQL lacks CSRF](//www.silverstripe.org/download/security-releases/ss-2018-007-graphql-lacks-csrf/ "Go to the SS-2018-007: GraphQL lacks CSRF page")
      * [SS-2018-006: Code execution vulnerability](//www.silverstripe.org/download/security-releases/ss-2018-006/ "Go to the SS-2018-006: Code execution vulnerability page")
      * [SS-2018-005: isDev and isTest unguarded](//www.silverstripe.org/download/security-releases/ss-2018-005/ "Go to the SS-2018-005: isDev and isTest unguarded page")
      * [SS-2018-004: XSS Vulnerability via WYSIWYG editor](//www.silverstripe.org/download/security-releases/ss-2018-004/ "Go to the SS-2018-004: XSS Vulnerability via WYSIWYG editor page")
      * [SS-2018-001: Privilege Escalation Risk in Member Edit form](//www.silverstripe.org/download/security-releases/ss-2018-001/ "Go to the SS-2018-001: Privilege Escalation Risk in Member Edit form page")
      * [SS-2017-010: install.php discloses sensitive data by pre-populating DB credential forms](//www.silverstripe.org/download/security-releases/ss-2017-010/ "Go to the SS-2017-010: install.php discloses sensitive data by pre-populating DB credential forms page")
      * [SS-2017-009: Users inadvertently passing sensitive data to LoginAttempt](//www.silverstripe.org/download/security-releases/ss-2017-009/ "Go to the SS-2017-009: Users inadvertently passing sensitive data to LoginAttempt page")
      * [SS-2017-008: SQL injection in full text search of SilverStripe 4](//www.silverstripe.org/download/security-releases/ss-2017-008/ "Go to the SS-2017-008: SQL injection in full text search of SilverStripe 4 page")
      * [SS-2017-007: CSV Excel Macro Injection](//www.silverstripe.org/download/security-releases/ss-2017-007/ "Go to the SS-2017-007: CSV Excel Macro Injection page")
      * [SS-2017-006: Session user agent change detection](//www.silverstripe.org/download/security-releases/ss-2017-006/ "Go to the SS-2017-006: Session user agent change detection page")
      * [SS-2017-005: User enumeration via timing attack on login and password reset forms](//www.silverstripe.org/download/security-releases/ss-2017-005/ "Go to the SS-2017-005: User enumeration via timing attack on login and password reset forms page")
      * [SS-2017-004: XSS in page history comparison](//www.silverstripe.org/download/security-releases/ss-2017-004/ "Go to the SS-2017-004: XSS in page history comparison page")
      * [SS-2017-003: XSS in RedirectorPage](//www.silverstripe.org/download/security-releases/ss-2017-003/ "Go to the SS-2017-003: XSS in RedirectorPage page")
      * [SS-2017-002: Member disclosure in login form](//www.silverstripe.org/download/security-releases/ss-2017-002/ "Go to the SS-2017-002: Member disclosure in login form page")
      * [SS-2017-001: XSS In page name](//www.silverstripe.org/download/security-releases/ss-2017-001/ "Go to the SS-2017-001: XSS In page name page")
      * [SS-2016-017: SVG Uploads](//www.silverstripe.org/download/security-releases/ss-2016-017/ "Go to the SS-2016-017: SVG Uploads page")
      * [SS-2016-016: XSS In CMSSecurity BackURL](//www.silverstripe.org/download/security-releases/ss-2016-016/ "Go to the SS-2016-016: XSS In CMSSecurity BackURL page")
      * [SS-2016-015: XSS In OptionsetField and CheckboxSetField](//www.silverstripe.org/download/security-releases/ss-2016-015/ "Go to the SS-2016-015: XSS In OptionsetField and CheckboxSetField page")
      * [SS-2016-014: Pre-existing alc\_enc cookies log users in if remember me is disabled](//www.silverstripe.org/download/security-releases/ss-2016-014/ "Go to the SS-2016-014: Pre-existing alc_enc cookies log users in if remember me is disabled page")
      * [SS-2016-013: Member.Name isn't escaped](//www.silverstripe.org/download/security-releases/ss-2016-013/ "Go to the SS-2016-013: Member.Name isn't escaped page")
      * [SS-2016-012: Missing ACL on reports](//www.silverstripe.org/download/security-releases/ss-2016-012/ "Go to the SS-2016-012: Missing ACL on reports page")
      * [SS-2016-011: ChangePasswordForm doesn't check Member::canLogIn()](//www.silverstripe.org/download/security-releases/ss-2016-011/ "Go to the SS-2016-011: ChangePasswordForm doesn't check Member::canLogIn() page")
      * [SS-2016-010: ReadOnly transformation for formfields exploitable](//www.silverstripe.org/download/security-releases/ss-2016-010/ "Go to the SS-2016-010: ReadOnly transformation for formfields exploitable page")
      * [SS-2016-008: Password encryption salt expiry](//www.silverstripe.org/download/security-releases/ss-2016-008/ "Go to the SS-2016-008: Password encryption salt expiry page")
      * [SS-2016-007: VersionedRequestFilter vulnerability](//www.silverstripe.org/download/security-releases/ss-2016-007/ "Go to the SS-2016-007: VersionedRequestFilter vulnerability page")
      * [SS-2016-006: Missing CSRF protection in login form](//www.silverstripe.org/download/security-releases/ss-2016-006/ "Go to the SS-2016-006: Missing CSRF protection in login form page")
      * [SS-2016-005: Brute force bypass on default admin](//www.silverstripe.org/download/security-releases/ss-2016-005/ "Go to the SS-2016-005: Brute force bypass on default admin page")
      * [SS-2016-004: XSS in CMS Edit Page](//www.silverstripe.org/download/security-releases/ss-2016-004/ "Go to the SS-2016-004: XSS in CMS Edit Page page")
      * [SS-2016-003: Hostname, IP and Protocol Spoofing through HTTP Headers](//www.silverstripe.org/download/security-releases/ss-2016-003/ "Go to the SS-2016-003: Hostname, IP and Protocol Spoofing through HTTP Headers page")
      * [SS-2016-002: CSRF vulnerability in GridFieldAddExistingAutocompleter](//www.silverstripe.org/download/security-releases/ss-2016-002/ "Go to the SS-2016-002: CSRF vulnerability in GridFieldAddExistingAutocompleter page")
      * [SS-2016-001: XSS in CMSController BackURL](//www.silverstripe.org/download/security-releases/ss-2016-001/ "Go to the SS-2016-001: XSS in CMSController BackURL page")
      * [SS-2015-029: CSRF vulnerability in savetreenodes](//www.silverstripe.org/download/security-releases/ss-2015-029/ "Go to the SS-2015-029: CSRF vulnerability in savetreenodes page")
      * [SS-2015-028: Missing security check on dev/build/defaults](//www.silverstripe.org/download/security-releases/ss-2015-028/ "Go to the SS-2015-028: Missing security check on dev/build/defaults page")
      * [SS-2015-027: HtmlEditor embed url sanitisation](//www.silverstripe.org/download/security-releases/ss-2015-027/ "Go to the SS-2015-027: HtmlEditor embed url sanitisation page")
      * [SS-2015-026: Form field validation message XSS vulnerability](//www.silverstripe.org/download/security-releases/ss-2015-026/ "Go to the SS-2015-026: Form field validation message XSS vulnerability page")
      * [SS-2015-025: Request class name exposure on error](//www.silverstripe.org/download/security-releases/ss-2015-025/ "Go to the SS-2015-025: Request class name exposure on error page")
      * [SS-2015-024: Queued jobs serialised data exposure](//www.silverstripe.org/download/security-releases/ss-2015-024/ "Go to the SS-2015-024: Queued jobs serialised data exposure page")
      * [SS-2015-023: Advanced workflow member field exposure](//www.silverstripe.org/download/security-releases/ss-2015-023/ "Go to the SS-2015-023: Advanced workflow member field exposure page")
      * [SS-2015-022: XML escape RSSFeed $link parameter](//www.silverstripe.org/download/security-releases/ss-2015-022/ "Go to the SS-2015-022: XML escape RSSFeed $link parameter page")
      * [SS-2015-021: Hash rewrite URL filtering](//www.silverstripe.org/download/security-releases/ss-2015-021/ "Go to the SS-2015-021: Hash rewrite URL filtering page")
      * [SS-2015-020: Privilege Escalation Risk in Security Admin](//www.silverstripe.org/download/security-releases/ss-2015-020/ "Go to the SS-2015-020: Privilege Escalation Risk in Security Admin page")
      * [SS-2015-019: Leaky draft stage risk](//www.silverstripe.org/download/security-releases/ss-2015-019/ "Go to the SS-2015-019: Leaky draft stage risk page")
      * [SS-2015-018: File upload exposure on UserForms module](//www.silverstripe.org/download/security-releases/ss-2015-018/ "Go to the SS-2015-018: File upload exposure on UserForms module page")
      * [SS-2015-017: Forum Module CSRF Vulnerability](//www.silverstripe.org/download/security-releases/ss-2015-017/ "Go to the SS-2015-017: Forum Module CSRF Vulnerability page")
      * [SS-2015-016: XSS in install.php](//www.silverstripe.org/download/security-releases/ss-2015-016/ "Go to the SS-2015-016: XSS in install.php page")
      * [SS-2015-015: XSS in dev/build returnURL Parameter](//www.silverstripe.org/download/security-releases/ss-2015-015/ "Go to the SS-2015-015: XSS in dev/build returnURL Parameter page")
      * [SS-2015-014: Vulnerability on "isDev", "isTest" and "flush" $\_GET validation](//www.silverstripe.org/download/security-releases/ss-2015-014/ "Go to the SS-2015-014: Vulnerability on \"isDev\", \"isTest\" and \"flush\" $_GET validation page")
      * [SS-2015-013: X-Forwarded-Host request hostname injection](//www.silverstripe.org/download/security-releases/ss-2015-013/ "Go to the SS-2015-013: X-Forwarded-Host request hostname injection page")
      * [SS-2015-012: External redirection risk in Security?ReturnURL](//www.silverstripe.org/download/security-releases/ss-2015-012/ "Go to the SS-2015-012: External redirection risk in Security?ReturnURL page")
      * [SS-2015-011: Potential SQL Injection Vulnerability](//www.silverstripe.org/download/security-releases/ss-2015-011/ "Go to the SS-2015-011: Potential SQL Injection Vulnerability page")
      * [SS-2015-010: XSS in Director::force\_redirect()](//www.silverstripe.org/download/security-releases/ss-2015-010-xss-in-directorforce-redirect/ "Go to the SS-2015-010: XSS in Director::force_redirect() page")
      * [SS-2015-009: XSS In rewritten hash links](//www.silverstripe.org/download/security-releases/ss-2015-009-xss-in-rewritten-hash-links/ "Go to the SS-2015-009: XSS In rewritten hash links page")
      * [SS-2015-008: SiteTree Creation Permission Vulnerability](//www.silverstripe.org/download/security-releases/ss-2015-008-sitetree-creation-permission-vulnerability/ "Go to the SS-2015-008: SiteTree Creation Permission Vulnerability page")
      * [SS-2015-007: XSS In FormAction](//www.silverstripe.org/download/security-releases/ss-2015-007/ "Go to the SS-2015-007: XSS In FormAction page")
      * [SS-2015-006: XSS In GridField print](//www.silverstripe.org/download/security-releases/ss-2015-006/ "Go to the SS-2015-006: XSS In GridField print page")
      * [SS-2015-005: VirtualPage XSS](//www.silverstripe.org/download/security-releases/ss-2015-005/ "Go to the SS-2015-005: VirtualPage XSS page")
      * [SS-2015-004: TreeDropdownField and TreeMultiSelectField XSS](//www.silverstripe.org/download/security-releases/ss-2015-004/ "Go to the SS-2015-004: TreeDropdownField and TreeMultiSelectField XSS page")
      * [SS-2015-003: History XSS Vulnerability](//www.silverstripe.org/download/security-releases/ss-2015-003/ "Go to the SS-2015-003: History XSS Vulnerability page")
      * [SS-2015-001: Debug information exposed](//www.silverstripe.org/download/security-releases/ss-2015-001/ "Go to the SS-2015-001: Debug information exposed page")
      * [SS-2014-018](//www.silverstripe.org/download/security-releases/ss-2014-018-open-file-permissions/ "Go to the SS-2014-018: Open file permissions vulnerability page")
      * [SS-2014-017: XML Quadratic Blowup Attack](//www.silverstripe.org/download/security-releases/ss-2014-017-xml-quadratic-blowup-attack/ "Go to the SS-2014-017: XML Quadratic Blowup Attack page")
      * [SS-2014-016](//www.silverstripe.org/download/security-releases/ss-2014-016/ "Go to the SS-2014-016: Login count is not updated properly when basicauth is used. page")
      * [SS-2014-015: IE requests not properly behaving with rewritehashlinks](//www.silverstripe.org/download/security-releases/ss-2014-015-ie-requests-not-properly-behaving-with-rewritehashlinks/ "Go to the SS-2014-015: IE requests not properly behaving with rewritehashlinks page")
      * [SS-2014-014](//www.silverstripe.org/download/security-releases/ss-2014-014-front-end-uploadfield-exposes-lists-of-assets/ "Go to the SS-2014-014: Front end UploadField exposes lists of assets page")
      * [SS-2014-013](//www.silverstripe.org/download/security-releases/ss-2014-013-upload-fileexists-vulnerability/ "Go to the SS-2014-013: Upload fileexists vulnerability page")
      * [SS-2014-012](//www.silverstripe.org/download/security-releases/ss-2014-012-file-upload-restrictions/ "Go to the SS-2014-012: File Upload Restrictions page")
      * [SS-2014-011](//www.silverstripe.org/download/security-releases/ss-2014-011-folder-filename-injection/ "Go to the SS-2014-011: Folder filename injection page")
      * [SS-2014-010](//www.silverstripe.org/download/security-releases/ss-2014-010-injection-filesystem-vulnerability-in-generatesecuretoken/ "Go to the SS-2014-010: Injection / Filesystem vulnerability in generatesecuretoken page")
      * [SS-2014-009](//www.silverstripe.org/download/security-releases/ss-2014-009-potential-dos-exploit-in-tinymce/ "Go to the SS-2014-009: Potential DoS exploit in TinyMCE page")
      * [SS-2014-008](//www.silverstripe.org/download/security-releases/ss-2014-008-lack-of-csrf-tokens-in-forum-module/ "Go to the SS-2014-008: Lack of CSRF tokens in Forum module page")
      * [SS-2014-007](//www.silverstripe.org/download/security-releases/ss-2014-007-confidentiality-breach-can-occur-between-draft-and-live-modes/ "Go to the SS-2014-007: Confidentiality breach can occur between draft and live modes page")
      * [SS-2014-006](//www.silverstripe.org/download/security-releases/ss-2014-006-xss-in-returnurl-redirection/ "Go to the SS-2014-006: XSS in returnURL redirection page")
      * [SS-2014-005](//www.silverstripe.org/download/security-releases/ss-2014-005-arbitrary-class-creation-in-cms-backend/ "Go to the SS-2014-005: Arbitrary class creation in CMS backend page")
      * [SS-2014-004](//www.silverstripe.org/download/security-releases/ss-2014-004-sql-injection-in-sitetree-with-custom-urlsegmentfilter-rules/ "Go to the SS-2014-004: SQL injection in SiteTree with custom URLSegmentFilter rules page")
      * [SS-2014-003](//www.silverstripe.org/download/security-releases/ss-2014-003-extrameta-allows-javascript-for-malicious-cms-authors-/ "Go to the SS-2014-003: ExtraMeta allows JavaScript for malicious CMS authors  page")
      * [SS-2014-002](//www.silverstripe.org/download/security-releases/ss-2014-002-xss-in-third-party-library-swfupload/ "Go to the SS-2014-002: XSS in third party library (SWFUpload) page")
      * [SS-2014-001](//www.silverstripe.org/download/security-releases/ss-2014-001-require-admin-for-flush1-and-isdev1/ "Go to the SS-2014-001: Require ADMIN for ?flush=1&isDev=1 page")
      * [SS-2013-001: Require ADMIN for ?flush=1](//www.silverstripe.org/download/security-releases/ss-2013-001-require-admin-for-flush1/ "Go to the SS-2013-001: Require ADMIN for ?flush=1 page")
      * [SS-2013-002: SQL injection in Versioned.php](//www.silverstripe.org/download/security-releases/ss-2013-002-sql-injection-in-versioned-php/ "Go to the SS-2013-002: SQL injection in Versioned.php page")
      * [Undefined or empty `$allowed\_actions` overrides parent definitions](//www.silverstripe.org/download/security-releases/undefined-or-empty-allowed-actions-overrides-parent-definitions/ "Go to the Undefined or empty `$allowed_actions` overrides parent definitions page")
      * [Information exposure through web access on YAML configuration files](//www.silverstripe.org/download/security-releases/information-exposure-through-web-access-on-yaml-configuration-files/ "Go to the Information exposure through web access on YAML configuration files page")
      * [Information exposure through web access on composer files](//www.silverstripe.org/download/security-releases/information-exposure-through-web-access-on-composer-files/ "Go to the Information exposure through web access on composer files page")
      * [Require ADMIN permissions for ?showtemplate=1](//www.silverstripe.org/download/security-releases/require-admin-permissions-for-showtemplate1/ "Go to the Require ADMIN permissions for ?showtemplate=1 page")
      * [Stored XSS in the "New Group" dialog, XSS in CMS status messages](//www.silverstripe.org/download/security-releases/stored-xss-in-the-new-group-dialog-xss-in-cms-status-messages/ "Go to the Stored XSS in the \"New Group\" dialog, XSS in CMS status messages page")
      * [Older releases](//www.silverstripe.org/download/security-releases/older-releases/ "Go to the Older releases page")
      * [SS-2013-003: Privilege escalation through Group hierarchy setting](//www.silverstripe.org/download/security-releases/ss-2013-003-privilege-escalation-through-group-hierarchy-setting/ "Go to the SS-2013-003: Privilege escalation through Group hierarchy setting page")
      * [SS-2013-004: Privilege escalation through Group and Member CSV upload](//www.silverstripe.org/download/security-releases/ss-2013-004-privilege-escalation-through-group-and-member-csv-upload/ "Go to the SS-2013-004: Privilege escalation through Group and Member CSV upload page")
      * [SS-2013-005: Privilege escalation with APPLY\_ROLES](//www.silverstripe.org/download/security-releases/ss-2013-005-privilege-escalation-through-apply-roles-assignment/ "Go to the SS-2013-005: Privilege escalation with APPLY_ROLES page")
      * [SS-2013-006: Information disclosure in Versioned.php](//www.silverstripe.org/download/security-releases/ss-2013-006-information-disclosure-in-versioned/ "Go to the SS-2013-006: Information disclosure in Versioned.php page")
      * [SS-2013-007: XSS in CMS "Security" section](//www.silverstripe.org/download/security-releases/ss-2013-007-xss-in-cms-security-section/ "Go to the SS-2013-007: XSS in CMS \"Security\" section page")
      * [SS-2013-008: XSS in form validation errors](//www.silverstripe.org/download/security-releases/ss-2013-008-xss-in-numericfield-validation/ "Go to the SS-2013-008: XSS in form validation errors page")
      * [SS-2013-009: XSS in CMS "Pages" section](//www.silverstripe.org/download/security-releases/ss-2013-009-xss-in-cms-pages-section/ "Go to the SS-2013-009: XSS in CMS \"Pages\" section page")
      * [CVE-2019-16409 secureassets and versionedfiles modules can expose versions of protected files](//www.silverstripe.org/download/security-releases/cve-2019-16409/ "Go to the CVE-2019-16409 secureassets and versionedfiles modules can expose versions of protected files page")
      * [CVE-2019-14273 Broken Access control on files](//www.silverstripe.org/download/security-releases/cve-2019-14273/ "Go to the CVE-2019-14273 Broken Access control on files page")
      * [CVE-2019-12617 Access escalation for CMS users with limited access through permission cache pollution](//www.silverstripe.org/download/security-releases/cve-2019-12617/ "Go to the CVE-2019-12617 Access escalation for CMS users with limited access through permission cache pollution page")
      * [CVE-2019-12203 Session fixation in "change password" form](//www.silverstripe.org/download/security-releases/cve-2019-12203/ "Go to the CVE-2019-12203 Session fixation in \"change password\" form page")
      * [CVE-2019-12204 Missing warning on install.php on public webroot can lead to unauthenticated admin access](//www.silverstripe.org/download/security-releases/cve-2019-12204/ "Go to the CVE-2019-12204 Missing warning on install.php on public webroot can lead to unauthenticated admin access page")
      * [CVE-2019-14272 XSS in file titles managed through the CMS](//www.silverstripe.org/download/security-releases/cve-2019-14272/ "Go to the CVE-2019-14272 XSS in file titles managed through the CMS page")
      * [CVE-2019-12205 Flash Clipboard Reflected XSS](//www.silverstripe.org/download/security-releases/cve-2019-12205/ "Go to the CVE-2019-12205 Flash Clipboard Reflected XSS page")
      * [CVE-2019-19325 XSS through non-scalar FormField attributes](//www.silverstripe.org/download/security-releases/cve-2019-19325/ "Go to the CVE-2019-19325 XSS through non-scalar FormField attributes page")
      * [CVE-2020-6165](//www.silverstripe.org/download/security-releases/cve-2020-6165/ "Go to the CVE-2020-6165 Limited queries break CanViewPermissionChecker page")
      * [CVE-2020-9280 Folders migrated from 3.x may be unsafe to upload to](//www.silverstripe.org/download/security-releases/cve-2020-9280/ "Go to the CVE-2020-9280 Folders migrated from 3.x may be unsafe to upload to page")
      * [CVE-2020-6164](//www.silverstripe.org/download/security-releases/cve-2020-6164/ "Go to the CVE-2020-6164 Information disclosure on /interactive URL path page")
      * [CVE-2020-9309](//www.silverstripe.org/download/security-releases/cve-2020-9309/ "Go to the CVE-2020-9309 Script execution on protected files with MIME spoofing content page")
      * [CVE-2020-9311](//www.silverstripe.org/download/security-releases/cve-2020-9311/ "Go to the CVE-2020-9311 Malicious user profile information can cause login form XSS page")
      * [CVE-2019-19326](//www.silverstripe.org/download/security-releases/cve-2019-19326/ "Go to the CVE-2019-19326 Web Cache Poisoning through HTTPRequestBuilder page")
      * [CVE-2021-27938](//www.silverstripe.org/download/security-releases/cve-2021-27938/ "Go to the CVE-2021-27938 XSS in CreateQueuedJobTask page")
      * [CVE-2021-25817](//www.silverstripe.org/download/security-releases/cve-2021-25817/ "Go to the CVE-2021-25817 XXE Vulnerability in CSSContentParser page")
      * [CVE-2020-26138](//www.silverstripe.org/download/security-releases/cve-2020-26138/ "Go to the CVE-2020-26138 FormField with square brackets in field name skips validation page")
      * [CVE-2020-26136](//www.silverstripe.org/download/security-releases/cve-2020-26136/ "Go to the CVE-2020-26136 GraphQL doesn't honour MFA when using basic auth page")
      * [CVE-2021-28661](//www.silverstripe.org/download/security-releases/cve-2021-28661/ "Go to the CVE-2021-28661 Default GraphQL permission checker not inherited by query subclass page")
      * [CVE-2021-36150](//www.silverstripe.org/download/security-releases/cve-2021-36150/ "Go to the CVE-2021-36150 - Insert from files link text - Reflective (self) Cross Site Scripting page")
      * [CVE-2022-28803](//www.silverstripe.org/download/security-releases/cve-2022-28803/ "Go to the CVE-2022-28803 - Stored XSS in link tags added via XHR page")
      * [CVE-2022-25238](//www.silverstripe.org/download/security-releases/cve-2022-25238/ "Go to the CVE-2022-25238 - Stored XSS via HTML fields page")
      * [CVE-2021-41559](//www.silverstripe.org/download/security-releases/cve-2021-41559/ "Go to the CVE-2021-41559 - Quadratic blowup in Convert::xml2array() page")
      * [CVE-2022-24444](//www.silverstripe.org/download/security-releases/cve-2022-24444/ "Go to the CVE-2022-24444 - Hybridsessions does not expire session id on logout page")
      * [CVE-2022-29858](//www.silverstripe.org/download/security-releases/cve-2022-29858/ "Go to the CVE-2022-29858 - Unpublished, protected files can be published via shortcode page")
      * [CVE-2022-29254](//www.silverstripe.org/download/security-releases/cve-2022-29254/ "Go to the CVE-2022-29254 Failed payment recorded has completed  page")
      * [CVE-2022-37421](//www.silverstripe.org/download/security-releases/cve-2022-37421/ "Go to the CVE-2022-37421 Stored XSS in custom meta tags page")
      * [CVE-2022-37429](//www.silverstripe.org/download/security-releases/cve-2022-37429/ "Go to the CVE-2022-37429 Stored XSS using HTMLEditor page")
      * [CVE-2022-37430](//www.silverstripe.org/download/security-releases/cve-2022-37430/ "Go to the CVE-2022-37430 Stored XSS using uppercase characters in HTMLEditor page")
      * [CVE-2022-38145](//www.silverstripe.org/download/security-releases/cve-2022-38145/ "Go to the CVE-2022-38145 Stored XSS in Compare Mode page")
      * [CVE-2022-38146](//www.silverstripe.org/download/security-releases/cve-2022-38146/ "Go to the CVE-2022-38146 URL XSS vulnerability due to outdated jquery in CMS page")
      * [CVE-2022-38147](//www.silverstripe.org/download/security-releases/cve-2022-38147/ "Go to the CVE-2022-38147 XSS via uploaded gpx file page")
      * [CVE-2022-38148](//www.silverstripe.org/download/security-releases/cve-2022-38148/ "Go to the CVE-2022-38148 Blind SQL Injection via GridFieldSortableHeader page")
      * [CVE-2022-38462](//www.silverstripe.org/download/security-releases/cve-2022-38462/ "Go to the CVE-2022-38462 Reflected XSS in querystring parameters page")
      * [CVE-2022-38724](//www.silverstripe.org/download/security-releases/cve-2022-38724/ "Go to the CVE-2022-38724 XSS in shortcodes page")
      * [CVE-2022-42949](//www.silverstripe.org/download/security-releases/cve-2022-42949/ "Go to the CVE-2022-42949 - Subsite weakens file permissions page")
      * [CVE-2023-28104 - DDOS attack on graphql endpoints](//www.silverstripe.org/download/security-releases/cve-2023-28104/ "Go to the CVE-2023-28104 - DDOS attack on graphql endpoints page")
      * [SS-2023-001](//www.silverstripe.org/download/security-releases/ss-2023-001/ "Go to the SS-2023-001 - XSS vulnerability in underlying TinyMCE library page")
      * [CVE-2023-22728](//www.silverstripe.org/download/security-releases/cve-2023-22728/ "Go to the CVE-2023-22728 - Missing permission check in GridFieldPrintButton page")
      * [CVE-2023-22729](//www.silverstripe.org/download/security-releases/cve-2023-22729/ "Go to the CVE-2023-22729 - Open redirect vulnerability on CMSSecurity relogin screen page")
      * [SS-2023-002](//www.silverstripe.org/download/security-releases/ss-2023-002/ "Go to the SS-2023-002 Cross-site scripting (XSS) vulnerabilities inherited form TinyMCE page")
      * [CVE-2023-32302](//www.silverstripe.org/download/security-releases/cve-2023-32302/ "Go to the CVE-2023-32302 Members with no password can be created and bypass custom login forms page")
      * [CVE-2023-40180](//www.silverstripe.org/download/security-releases/cve-2023-40180/ "Go to the CVE-2023-40180 - DDOS Vulnerability on GraphQL due to lack of protection against recursive queries page")
      * [CVE-2023-49783](//www.silverstripe.org/download/security-releases/cve-2023-49783/ "Go to the CVE-2023-49783 - No permission checks for editing or deleting records with CSV import form  page")
      * [CVE-2023-48714](//www.silverstripe.org/download/security-releases/cve-2023-48714/ "Go to the CVE-2023-48714 - Record titles for restricted records can be viewed if exposed by GridFieldAddExistingAutocompleter page")
      * [CVE-2023-44401](//www.silverstripe.org/download/security-releases/cve-2023-44401/ "Go to the CVE-2023-44401 - View permissions are bypassed for paginated lists of ORM data in GraphQL queries page")
      * [SS-2024-001](//www.silverstripe.org/download/security-releases/ss-2024-001/ "Go to the SS-2024-001 TinyMCE allows svg files linked in object tags  page")
      * [CVE-2024-29885](//www.silverstripe.org/download/security-releases/cve-2024-29885/ "Go to the CVE-2024-29885 Reports are still accessible even when canView is set to false page")
      * [CVE-2024-32981](//www.silverstripe.org/download/security-releases/cve-2024-32981/ "Go to the CVE-2024-32981 XSS Vulnerability with text/html base64-encoded payload page")
    - [Release Archive](//www.silverstripe.org/download/release-archive/ "Go to the Release Archive page")
    - [Changelog](//docs.silverstripe.org/en/4/changelogs/ "Go to the Changelog page")
    - [Release process](//docs.silverstripe.org/en/4/contributing/release_process/ "Go to the About the release process page")
  + [Try](//www.silverstripe.org/try/ "Go to the Try page")
* [Company](//www.silverstripe.com "Go to the Company page")
  + [What we do](//www.silverstripe.com/what-we-do/ "Go to the What we do page")
  + [Our work](//www.silverstripe.com/our-work/ "Go to the Our work page")
  + [SilverStripe CMS](//www.silverstripe.com/silverstripe-cms/ "Go to the New Redirector Page page")
  + [Partners](//www.silverstripe.com/partners "Go to the Partners page")
  + [Contact](//www.silverstripe.com/contact/ "Go to the Contact page")
  + [Careers](//www.silverstripe.com/careers/ "Go to the Careers  page")
  + [Resources](//www.silverstripe.com/resources "Go to the Resources page")
* [Cloud Platform](//www.silverstripe.com/platform/ "Go to the Cloud Platform page")
  + [Features & Benefits](//www.silverstripe.com/platform/features-and-benefits "Go to the Features & Benefits page")
  + [Expert Support](//www.silverstripe.com/platform/expert-support/ "Go to the Expert Support page")
  + [Private Sector](//www.silverstripe.com/platform/private-sector/ "Go to the Private Sector page")
  + [Public Sector](//www.silverstripe.com/platform/public-sector/ "Go to the Public Sector page")
  + [Pricing](//www.silverstripe.com/platform/private-sector/pricing/ "Go to the Pricing page")

Site Menu
### Silverstripe Silverstripe

[##### Open SourceOpen Source](//www.silverstripe.org/)

* [Software](//www.silverstripe.org/software/)
* [Community](//www.silverstripe.org/community/)
* [Learn](//www.silverstripe.org/learn/)
* [Blog](//www.silverstripe.org/blog/)
* [Download](//www.silverstripe.org/download/)
* [Try](//www.silverstripe.org/try/)

[##### CompanyCompany](//www.silverstripe.com)

* [What we do](//www.silverstripe.com/what-we-do/)
* [Our work](//www.silverstripe.com/our-work/)
* [SilverStripe CMS](//www.silverstripe.com/silverstripe-cms/)
* [Partners](//www.silverstripe.com/partners)
* [Contact](//www.silverstripe.com/contact/)
* [Careers](//www.silverstripe.com/careers/)
* [Resources](//www.silverstripe.com/resources)

[##### Cloud PlatformCloud Platform](//www.silverstripe.com/platform/)

* [Features & Benefits](//www.silverstripe.com/platform/features-and-benefits)
* [Expert Support](//www.silverstripe.com/platform/expert-support/)
* [Private Sector](//www.silverstripe.com/platform/private-sector/)
* [Public Sector](//www.silverstripe.com/platform/public-sector/)
* [Pricing](//www.silverstripe.com/platform/private-sector/pricing/)

# CVE-2023-40180 - DDOS Vulnerability on GraphQL due to lack of protection against recursive queries

×

Search
Site search

# CVE-2023-40180 - DDOS Vulnerability on GraphQL due to lack of protection against recursive queries

Severity:
High ([?](https://docs.silverstripe.org/en/contributing/release_process/#security-releases))
Identifier:CVE-2023-40180
Versions Affected:silverstripe/graphql: ^3.0.0, ^4.0.0, ^5.0.0
Versions Fixed:3.8.2, 4.1.3, 4.2.5, 4.3.4, 5.0.3
Release Date:2023-10-16

An attacker could use a recursive graphql query to execute a Distributed Denial of Service attack (DDOS attack) against a website. This mostly affects websites with publicly exposed graphql schemas.

If your Silverstripe CMS project does not expose a public facing graphql schema, a user account is required to trigger the DDOS attack. If your site is hosted behind a content delivery network (CDN), such as Imperva or CloudFlare, this may further mitigate the risk.

The fix includes some new configuration options which you might want to tweak for your project, based on your own requirements. See the documentation in the references for details.

**Base CVSS: [7.5](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C&version=3.1)**

**Reported by:** Jason Nguyen from [phew](https://phew.co.nz/)

#### References

* [Documentation about protection against recursive or complex queries for silverstripe/graphql 4.x/5.x](https://docs.silverstripe.org/en/developer_guides/graphql/security_and_best_practices/recursive_or_complex_queries)
* [Documentation about protection against recursive or complex queries for silverstripe/graphql 3.x](https://github.com/silverstripe/silverstripe-graphql/tree/3.8#recursive-or-complex-queries)

* Silverstripe
* Silverstripe
* [Open Source](/ "Go to the Open Source page")
* [Company](http://www.silverstripe.com "Go to the Company page")
* [Cloud Platform](https://www.silverstripe.com/platform/ "Go to the Cloud Platform page")

* [facebook](http://facebook.com/silverstripe)
* [Twitter](http://twitter.com/silverstripe)
* [GitHub](http://github.com/silverstripe)
* [Vimeo](http://vimeo.com/silverstripe)
* [Linkedin](https://www.linkedin.com/company/silverstripe/)
* [xml version="1.0" encoding="utf-8"?](http://silverstripe.meetup.com/)

* [Privacy Policy](/home/footer-menu/privacy-policy/ "Go to the SilverStripe Privacy Policy page")
* [Branding guidelines](https://www.silverstripe.com/silverstripe-brand-guides/silverstripe-cms-style-guide/ "Go to the Branding guidelines page")
* [BSD License](/software/bsd-license/ "Go to the BSD License page")

© [Silverstripe Limited](http://silverstripe.com "Visit Silverstripe Limited ")

![Quantcast](//pixel.quantserve.com/pixel/p-c660wp5qmFVXF.gif?labels=_fp.event.Default)


