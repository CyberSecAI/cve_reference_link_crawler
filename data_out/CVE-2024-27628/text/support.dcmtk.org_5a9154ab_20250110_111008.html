

⚲

### Project

### General

### Profile

* [Sign in](/redmine/login)

* [Home](/redmine)
* [Projects](/redmine/projects)
* [Help](https://www.redmine.org/guide)

[Search](/redmine/projects/dcmtk/search?scope=subprojects):

 DCMTK[All Projects](/redmine/projects?jump=issues)
# DCMTK

* [Overview](/redmine/projects/dcmtk)
* [Activity](/redmine/projects/dcmtk/activity)
* [Roadmap](/redmine/projects/dcmtk/roadmap)
* [Issues](/redmine/projects/dcmtk/issues)
* [News](/redmine/projects/dcmtk/news)
* [Documents](/redmine/projects/dcmtk/documents)
* [Wiki](/redmine/projects/dcmtk/wiki)
* [Files](/redmine/projects/dcmtk/files)

Actions
Copy link
## Bug #1108

closed
![](https://www.gravatar.com/avatar/9bc18058d001965082ab4096119700dc?rating=PG&size=50&default= "Author: Michael Onken")
![](https://www.gravatar.com/avatar/9bc18058d001965082ab4096119700dc?rating=PG&size=22&default= "Assignee: Michael Onken")

### Possible overflow in EctEnhancedCT

Added by [Michael Onken](/redmine/users/5) [11 months](/redmine/projects/dcmtk/activity?from=2024-02-21 "2024-02-21 11:17") ago.

Status:ClosedPriority:NormalAssignee:[Michael Onken](/redmine/users/5)Category:LibraryTarget version:-Start date:2024-02-21Due date:% Done:

|  |
| --- |

100%

Estimated time:1:00 h
Module:dcmectOperating System:Compiler:

---

**Description**

The first problem stems from the fact that the multiplication of rows and cols may overflow 'int' before it is converted to 'size\_t'. For example, if the EctEnhancedCT::create method is used where a user has control over the value of rows and cols.
```
Uint16 rows = 0;
Uint16 cols = 0;
m_CT.getRows(rows);
m_CT.getColumns(cols);
const size_t numFrames      = m_CT.m_Frames.size();
const size_t numBytesFrame  = m_CT.m_Frames[0]->length;
// HERE:
const size_t numPixelsFrame = rows * cols;

```

Inside the below method the expected number of pixel bytes is not validated, leading to uncontrolled access to memory in a memcpy() call.
```
OFCondition EctEnhancedCT::WriteVisitor::operator()(ImagePixel& pixel)

```

This has been fixed in commit #ec52e9.

Thanks to GitHub user "bananabr" (Daniel Berredo) for the report and suggested patch.

No data to display

Actions
Copy link

Also available in: [Atom](/redmine/issues/1108.atom)
[PDF](/redmine/issues/1108.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2022 Jean-Philippe Lang

Loading...

