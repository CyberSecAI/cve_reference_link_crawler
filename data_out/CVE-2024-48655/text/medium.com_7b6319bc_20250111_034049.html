[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc5fc18359bdc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%400x0d0x0a%2Fcve-2024-48655-server-side-javascript-code-injection-in-total-js-cms-c5fc18359bdc&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%400x0d0x0a%2Fcve-2024-48655-server-side-javascript-code-injection-in-total-js-cms-c5fc18359bdc&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE — 2024–48655: Server-side JavaScript Code Injection in Total.js CMS

[![0x0D 0x0A](https://miro.medium.com/v2/resize:fill:88:88/1*vwweSavrapon1R2J7S05OQ.jpeg)](/%400x0d0x0a?source=post_page---byline--c5fc18359bdc--------------------------------)

[0x0D 0x0A](/%400x0d0x0a?source=post_page---byline--c5fc18359bdc--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fade851528f4&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%400x0d0x0a%2Fcve-2024-48655-server-side-javascript-code-injection-in-total-js-cms-c5fc18359bdc&user=0x0D+0x0A&userId=ade851528f4&source=post_page-ade851528f4--byline--c5fc18359bdc---------------------post_header-----------)

3 min read·Oct 19, 2024

--

Listen

Share

# CVE — 2024–48655

## **The name of an affected Product**

Total.js CMS (<https://github.com/totaljs/cms/issues/49>)

**Vendor of Product:**
github

**The affected or fixed version(s)**

1.0

**CVE-ID**

CVE — 2024–48655

**Vulnerability Type:**

Code Injection

**Root Cause and Impact**

We have identified a Server-Side JavaScript Code Injection vulnerability in total.js Content Management System, specifically in func.js file. The value of the parameter `meta.total`is taken from user input and not sanitized. Then this value is passed as `new Function('exports', meta.total)`which allows backend JS to create a new function with user controlled function body. This will result in backend code injection and we’ll illustrate potential security risks by utilizing **sensitive information** and conducting a **denial of service (DoS)** attack.

**Vulnerable code**
/cms/definitions/func.js : Line 10
`... try{ new Function('exports', meta.total))(item.ref) ...`

**Description**

Server-side code injection vulnerabilities arise when an application incorporates user-controllable data into a string that is dynamically evaluated by a code interpreter. If the user data is not strictly validated, an attacker can use crafted input to modify the code to be executed, and inject arbitrary code that will be executed by the server.

Even though there are business requirements to run server-side script in components such as widgets, certain sensitive methods (e.g. process) used for system interaction are not restricted, which could lead to security issues.

**Evidences**
In this scenario, we’ll illustrate potential security risks by utilizing sensitive information and conducting a denial of service (DoS) attack.

**Simple POC**
As shown below, the parameter meta.total is taken from user-input and has no proper sanitization. Then this value is passed to `new Function()` which results in Server-side JavaScript code injection.

![]()

After user login, the user navigates to function Widget -> create widget and input the payload `console.log("HACKED")` inside script total tag.

![]()

Observe that the injected `console.log('HACKED')` function is executed on server side.

![]()

**Sensitive information obtained**
Through this vulnerability, attackers are able to obtain sensitive system information or make it RCE or DOS. Take sensitive information `process.env` as an example below:

![]()

This lead to sensitive information disclosure.

![]()

The attacker can then send out those information via a HTTP request.

![]()

Note in this case the server at localhost received the information from `process.env`

![]()

**DOS**
Another realistic payload is to use `process.exit()` to end the entire process and result in DOS attack:

![]()

Note after submitting the widget, the node process is ended and the server is down.

![]()![]()

**Conclusion**
We would recommend to restrict the sensitive methods/instance such as `process` in the widget function to make it safer but still won't affect the functionality.

--

--

[![0x0D 0x0A](https://miro.medium.com/v2/resize:fill:96:96/1*vwweSavrapon1R2J7S05OQ.jpeg)](/%400x0d0x0a?source=post_page---post_author_info--c5fc18359bdc--------------------------------)[![0x0D 0x0A](https://miro.medium.com/v2/resize:fill:128:128/1*vwweSavrapon1R2J7S05OQ.jpeg)](/%400x0d0x0a?source=post_page---post_author_info--c5fc18359bdc--------------------------------)Follow[## Written by 0x0D 0x0A](/%400x0d0x0a?source=post_page---post_author_info--c5fc18359bdc--------------------------------)[2 Followers](/%400x0d0x0a/followers?source=post_page---post_author_info--c5fc18359bdc--------------------------------)·[1 Following](/%400x0d0x0a/following?source=post_page---post_author_info--c5fc18359bdc--------------------------------)

web pentesters :)

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----c5fc18359bdc--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----c5fc18359bdc--------------------------------)[About](/about?autoplay=1&source=post_page-----c5fc18359bdc--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----c5fc18359bdc--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----c5fc18359bdc--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----c5fc18359bdc--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c5fc18359bdc--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c5fc18359bdc--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----c5fc18359bdc--------------------------------)[Teams](/business?source=post_page-----c5fc18359bdc--------------------------------)

