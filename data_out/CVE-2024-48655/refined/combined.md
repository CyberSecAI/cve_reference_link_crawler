=== Content from medium.com_7b6319bc_20250111_034049.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc5fc18359bdc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%400x0d0x0a%2Fcve-2024-48655-server-side-javascript-code-injection-in-total-js-cms-c5fc18359bdc&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%400x0d0x0a%2Fcve-2024-48655-server-side-javascript-code-injection-in-total-js-cms-c5fc18359bdc&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE — 2024–48655: Server-side JavaScript Code Injection in Total.js CMS

[![0x0D 0x0A](https://miro.medium.com/v2/resize:fill:88:88/1*vwweSavrapon1R2J7S05OQ.jpeg)](/%400x0d0x0a?source=post_page---byline--c5fc18359bdc--------------------------------)

[0x0D 0x0A](/%400x0d0x0a?source=post_page---byline--c5fc18359bdc--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fade851528f4&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%400x0d0x0a%2Fcve-2024-48655-server-side-javascript-code-injection-in-total-js-cms-c5fc18359bdc&user=0x0D+0x0A&userId=ade851528f4&source=post_page-ade851528f4--byline--c5fc18359bdc---------------------post_header-----------)

3 min read·Oct 19, 2024

--

Listen

Share

# CVE — 2024–48655

## **The name of an affected Product**

Total.js CMS (<https://github.com/totaljs/cms/issues/49>)

**Vendor of Product:**
github

**The affected or fixed version(s)**

1.0

**CVE-ID**

CVE — 2024–48655

**Vulnerability Type:**

Code Injection

**Root Cause and Impact**

We have identified a Server-Side JavaScript Code Injection vulnerability in total.js Content Management System, specifically in func.js file. The value of the parameter `meta.total`is taken from user input and not sanitized. Then this value is passed as `new Function('exports', meta.total)`which allows backend JS to create a new function with user controlled function body. This will result in backend code injection and we’ll illustrate potential security risks by utilizing **sensitive information** and conducting a **denial of service (DoS)** attack.

**Vulnerable code**
/cms/definitions/func.js : Line 10
`... try{ new Function('exports', meta.total))(item.ref) ...`

**Description**

Server-side code injection vulnerabilities arise when an application incorporates user-controllable data into a string that is dynamically evaluated by a code interpreter. If the user data is not strictly validated, an attacker can use crafted input to modify the code to be executed, and inject arbitrary code that will be executed by the server.

Even though there are business requirements to run server-side script in components such as widgets, certain sensitive methods (e.g. process) used for system interaction are not restricted, which could lead to security issues.

**Evidences**
In this scenario, we’ll illustrate potential security risks by utilizing sensitive information and conducting a denial of service (DoS) attack.

**Simple POC**
As shown below, the parameter meta.total is taken from user-input and has no proper sanitization. Then this value is passed to `new Function()` which results in Server-side JavaScript code injection.

![]()

After user login, the user navigates to function Widget -> create widget and input the payload `console.log("HACKED")` inside script total tag.

![]()

Observe that the injected `console.log('HACKED')` function is executed on server side.

![]()

**Sensitive information obtained**
Through this vulnerability, attackers are able to obtain sensitive system information or make it RCE or DOS. Take sensitive information `process.env` as an example below:

![]()

This lead to sensitive information disclosure.

![]()

The attacker can then send out those information via a HTTP request.

![]()

Note in this case the server at localhost received the information from `process.env`

![]()

**DOS**
Another realistic payload is to use `process.exit()` to end the entire process and result in DOS attack:

![]()

Note after submitting the widget, the node process is ended and the server is down.

![]()![]()

**Conclusion**
We would recommend to restrict the sensitive methods/instance such as `process` in the widget function to make it safer but still won't affect the functionality.

--

--

[![0x0D 0x0A](https://miro.medium.com/v2/resize:fill:96:96/1*vwweSavrapon1R2J7S05OQ.jpeg)](/%400x0d0x0a?source=post_page---post_author_info--c5fc18359bdc--------------------------------)[![0x0D 0x0A](https://miro.medium.com/v2/resize:fill:128:128/1*vwweSavrapon1R2J7S05OQ.jpeg)](/%400x0d0x0a?source=post_page---post_author_info--c5fc18359bdc--------------------------------)Follow[## Written by 0x0D 0x0A](/%400x0d0x0a?source=post_page---post_author_info--c5fc18359bdc--------------------------------)[2 Followers](/%400x0d0x0a/followers?source=post_page---post_author_info--c5fc18359bdc--------------------------------)·[1 Following](/%400x0d0x0a/following?source=post_page---post_author_info--c5fc18359bdc--------------------------------)

web pentesters :)

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----c5fc18359bdc--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----c5fc18359bdc--------------------------------)[About](/about?autoplay=1&source=post_page-----c5fc18359bdc--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----c5fc18359bdc--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----c5fc18359bdc--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----c5fc18359bdc--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c5fc18359bdc--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c5fc18359bdc--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----c5fc18359bdc--------------------------------)[Teams](/business?source=post_page-----c5fc18359bdc--------------------------------)



=== Content from github.com_883fd6a5_20250111_034048.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftotaljs%2Fcms%2Fissues%2F49)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftotaljs%2Fcms%2Fissues%2F49)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=totaljs%2Fcms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[totaljs](/totaljs)
/
**[cms](/totaljs/cms)**
Public

* [Notifications](/login?return_to=%2Ftotaljs%2Fcms) You must be signed in to change notification settings
* [Fork
  95](/login?return_to=%2Ftotaljs%2Fcms)
* [Star
   230](/login?return_to=%2Ftotaljs%2Fcms)

* [Code](/totaljs/cms)
* [Issues
  0](/totaljs/cms/issues)
* [Pull requests
  0](/totaljs/cms/pulls)
* [Discussions](/totaljs/cms/discussions)
* [Actions](/totaljs/cms/actions)
* [Projects
  0](/totaljs/cms/projects)
* [Security](/totaljs/cms/security)
* [Insights](/totaljs/cms/pulse)

Additional navigation options

* [Code](/totaljs/cms)
* [Issues](/totaljs/cms/issues)
* [Pull requests](/totaljs/cms/pulls)
* [Discussions](/totaljs/cms/discussions)
* [Actions](/totaljs/cms/actions)
* [Projects](/totaljs/cms/projects)
* [Security](/totaljs/cms/security)
* [Insights](/totaljs/cms/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Ftotaljs%2Fcms%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Ftotaljs%2Fcms%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Server Side JavaScript Code Injection Vulnerability was detected for func.js #49

Closed

[piggyctf](/piggyctf) opened this issue
Sep 28, 2024
· 1 comment

Closed

# [Server Side JavaScript Code Injection Vulnerability was detected for func.js](#top) #49

[piggyctf](/piggyctf) opened this issue
Sep 28, 2024
· 1 comment

Labels
[invalid](/totaljs/cms/labels/invalid)

## Comments

[![@piggyctf](https://avatars.githubusercontent.com/u/87955125?s=80&v=4)](/piggyctf)

Copy link

### **[piggyctf](/piggyctf)** commented [Sep 28, 2024](#issue-2553977410) • edited Loading

| **Description** We have identified a Server-Side JavaScript Code Injection vulnerability in total.js Content Management System, specifically in func.js file. Server-side code injection vulnerabilities arise when an application incorporates user-controllable data into a string that is dynamically evaluated by a code interpreter. If the user data is not strictly validated, an attacker can use crafted input to modify the code to be executed, and inject arbitrary code that will be executed by the server.  Even though there are business requirements to run server-side script in components such as widgets, certain sensitive methods (e.g. process) used for system interaction are not restricted, which could lead to security issues.  **Vulnerable code** /cms/definitions/func.js : Line 10 `... try{ new Function('exports', meta.total))(item.ref) ...`  **Evidence** In this scenario, we'll illustrate potential security risks by **utilizing sensitive information** and conducting a **denial of service (DoS)** attack.  **Simple POC** As shown below, the parameter meta.total is taken from user-input and has no proper sanitization. Then this value is passed to `new Function()` which results in Server-side JavaScript code injection. [1](https://private-user-images.githubusercontent.com/87955125/371720791-f6bbd7a7-13e7-4530-8e05-6888b28cbba8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxNDcsIm5iZiI6MTczNjU2Njg0NywicGF0aCI6Ii84Nzk1NTEyNS8zNzE3MjA3OTEtZjZiYmQ3YTctMTNlNy00NTMwLThlMDUtNjg4OGIyOGNiYmE4LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDA0N1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTIxN2ZhMDlhY2QzY2ZiOGNkM2U3MDA2YWIzYzE5Zjg1MjhiYTRiZWI1NjIxNDAzOTFjMDZjMzM2ZTIyY2VkODkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.5E0HuC653JzniYfnE6FUiE0lbV8D_QbkFJFGIgJG0IM)  After user login, the user navigates to function Widget -> create widget and input the payload `console.log("HACKED")` inside script total tag. [2](https://private-user-images.githubusercontent.com/87955125/371720792-4a1112b6-50e1-46ae-bbaa-3948dfb94235.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxNDcsIm5iZiI6MTczNjU2Njg0NywicGF0aCI6Ii84Nzk1NTEyNS8zNzE3MjA3OTItNGExMTEyYjYtNTBlMS00NmFlLWJiYWEtMzk0OGRmYjk0MjM1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDA0N1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTFiY2ZjZjYxYjIwMjc3Y2QwMjljMDgxOWExOGEzNGY3NzJlMWVlOWUzYTc0ODE0ZjFiZjZlMjhhNWVlMzMyNWUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.7i5qlyuuGBbSzKht3eUgIprfVU7qZsuIeaFEqLRYbpk)  Observe that the injected `console.log('HACKED')` function is executed on server side. [3](https://private-user-images.githubusercontent.com/87955125/371721155-0820b2a8-9230-4660-a7ac-33952784dab9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxNDcsIm5iZiI6MTczNjU2Njg0NywicGF0aCI6Ii84Nzk1NTEyNS8zNzE3MjExNTUtMDgyMGIyYTgtOTIzMC00NjYwLWE3YWMtMzM5NTI3ODRkYWI5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDA0N1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTg4Y2FhZTA1ZTViMDU2Y2VhNzc3M2NhNDZkN2JiZDAwMTgzYWRiZjE5MjNjZmE5N2JhMDY1MDZiNDBkYjBmMzkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0._UvBMC_qr_r45E4zfP9aHgTDQXiC3Tbcc2i_wZNwKec)  **Sensitive information obtained** Through this vulnerability, attackers are able to obtain sensitive system information or make it RCE or DOS. Take sensitive information `process.env` as an example below: [4](https://private-user-images.githubusercontent.com/87955125/371721195-7b76e1af-45e2-4830-ad3b-8d2abb6edd65.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxNDcsIm5iZiI6MTczNjU2Njg0NywicGF0aCI6Ii84Nzk1NTEyNS8zNzE3MjExOTUtN2I3NmUxYWYtNDVlMi00ODMwLWFkM2ItOGQyYWJiNmVkZDY1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDA0N1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTljMzJlZmIxNzYxMTk5YmY5ODZhNmVhZjI0MjQ4NDNmNzY1YWFjNTZjZjU2MTVmMzAwMTM1M2NiNWUwNzNiNWEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.Rqjx5NGIkw5es7l1O16VtL1--Zu04amOLWWCRtWe40c)  Note from debugger, the value is passed to `meta.total`: [1 1](https://private-user-images.githubusercontent.com/87955125/371721199-d2142d2e-3734-4a4f-a26b-8fb13f637814.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxNDcsIm5iZiI6MTczNjU2Njg0NywicGF0aCI6Ii84Nzk1NTEyNS8zNzE3MjExOTktZDIxNDJkMmUtMzczNC00YTRmLWEyNmItOGZiMTNmNjM3ODE0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDA0N1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTM5MTQzMzhmYmI4Zjg4ODBjY2M0ZmQxZjBkMTY3MjNmYzZkM2FmYjJlY2U4ZmFmMTg0ZGE4YjVjNDU0MWU2MDEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.rY8CZKUbpSawDLNOtHmsR5SxZ-WurIvoJHWQEYsQFSo)  This lead to **sensitive information disclosure**. [5](https://private-user-images.githubusercontent.com/87955125/371721377-2213ba34-c057-489c-8fd4-1afe3018c8ca.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxNDcsIm5iZiI6MTczNjU2Njg0NywicGF0aCI6Ii84Nzk1NTEyNS8zNzE3MjEzNzctMjIxM2JhMzQtYzA1Ny00ODljLThmZDQtMWFmZTMwMThjOGNhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDA0N1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWQwMzZlYzJkNzA3Zjg2ODJjYjhhNDliNmY5M2FkZDFlZDBhNmUyNTJjNWFmYzAzYzg1YThkNDhiMTA5NmZjMTcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.7D-AmQegeppep9T-37XYL06EvEctikYK0OaMKwCw3WY)  The attacker can then send out those information via a HTTP request. [9](https://private-user-images.githubusercontent.com/87955125/371812039-22b8eb7e-3e52-430d-a055-bd92f7f3c9e8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxNDcsIm5iZiI6MTczNjU2Njg0NywicGF0aCI6Ii84Nzk1NTEyNS8zNzE4MTIwMzktMjJiOGViN2UtM2U1Mi00MzBkLWEwNTUtYmQ5MmY3ZjNjOWU4LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDA0N1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWYzNWFjMWRjZGYwMTFlMDJkNTc2YTgyZTFkMjM2YmEyMGRhZjgzNGJhNTBjYjNiYTk4ZTM0MGY0MWUzOGZhMzEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.XOFYFhLXouG1mchVyHqPy-dzcxXk780CVA8kuy4MBJ0)  Note in this case the server at localhost received the information from `process.env` [10](https://private-user-images.githubusercontent.com/87955125/371812685-d1e59bc1-442f-4fe0-8a4c-8f68d1104869.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxNDcsIm5iZiI6MTczNjU2Njg0NywicGF0aCI6Ii84Nzk1NTEyNS8zNzE4MTI2ODUtZDFlNTliYzEtNDQyZi00ZmUwLThhNGMtOGY2OGQxMTA0ODY5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDA0N1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTgyOWQzOGM1ODI5NWY1NmQzMmQ5YWFkNzg5NTIxNWQxNDc1ZDA0YWUxNDBiMTNlMWVlMWEzMTU1ZTYwZjg3YTMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.gbqn3GesT-XxiNszANE3BG4w-h1AcN-PFxqp2vSm114)  **DOS** Another realistic payload is to use `process.exit()` to end the entire process and result in **DOS** attack: [6](https://private-user-images.githubusercontent.com/87955125/371809188-19a3e7c4-32bc-4662-8580-746a78004f8f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxNDcsIm5iZiI6MTczNjU2Njg0NywicGF0aCI6Ii84Nzk1NTEyNS8zNzE4MDkxODgtMTlhM2U3YzQtMzJiYy00NjYyLTg1ODAtNzQ2YTc4MDA0ZjhmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDA0N1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTliZDgzZWNjOGNiYjUxZGVlZDJmYjY2N2FlODE0OTAwYTc5OTk1YzQ0NmJlODU3NGU0YTA5MjE5MzY4ODg5MTYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.jSWG9qMtceR8mQ20duoB8tsBUdRxvlzwv2Ulu8egOnY)  Note after submitting the widget, the node process is ended and the server is down. [7](https://private-user-images.githubusercontent.com/87955125/371812661-c672dd4f-68af-4a67-8d91-a13dd121cd8a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxNDcsIm5iZiI6MTczNjU2Njg0NywicGF0aCI6Ii84Nzk1NTEyNS8zNzE4MTI2NjEtYzY3MmRkNGYtNjhhZi00YTY3LThkOTEtYTEzZGQxMjFjZDhhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDA0N1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU4YTIxNjk2NzExNzg1ODJhYTU4NTM0OGIxMDU0MTkyZTJjZWUwYzgxNGI2ODcyNzMyMzc2NTc1YzYzMDBkYTImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.eSJB9fxCqeGH5LfJIb5xUZJMDuM3_mWwUABbdXRBgek) [8](https://private-user-images.githubusercontent.com/87955125/371809191-95c06f67-7e5a-425a-bb4a-6da4d7d7df9a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxNDcsIm5iZiI6MTczNjU2Njg0NywicGF0aCI6Ii84Nzk1NTEyNS8zNzE4MDkxOTEtOTVjMDZmNjctN2U1YS00MjVhLWJiNGEtNmRhNGQ3ZDdkZjlhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDA0N1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTA2N2Y5YzIzODM4YmJmNGM3NmY0YTNjNGVkODMzNmI1YjQ4Yzg3Yjg1ZTYyOWExZTU2YTljNjJhMzM4MWE2ZmEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.MJ0J51e787I7KJREXAfwE8UrnMejd25fmaKhxkppa1M)  **Conclusion** We would recommend to restrict the sensitive methods/instance such as `process` in the widget function to make it safer but still won't affect the functionality. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@petersirka](https://avatars.githubusercontent.com/u/2414252?s=40&u=53668c88aff6493c6c5a4c5619f62f02a9575b43&v=4)](/petersirka)
[petersirka](/petersirka)
added
the
[invalid](/totaljs/cms/labels/invalid)
label
[Jan 9, 2025](#event-15872393002)

[![@petersirka](https://avatars.githubusercontent.com/u/2414252?s=80&u=53668c88aff6493c6c5a4c5619f62f02a9575b43&v=4)](/petersirka)

Copy link

Collaborator

### **[petersirka](/petersirka)** commented [Jan 9, 2025](#issuecomment-2581063049)

| Widgets can evaluate server-side code and can only be edited by the admin. |
| --- |

All reactions

Sorry, something went wrong.

[![@petersirka](https://avatars.githubusercontent.com/u/2414252?s=40&u=53668c88aff6493c6c5a4c5619f62f02a9575b43&v=4)](/petersirka)
[petersirka](/petersirka)
closed this as [completed](/totaljs/cms/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jan 9, 2025](#event-15872404593)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Ftotaljs%2Fcms%2Fissues%2F49)

Assignees

No one assigned

Labels

[invalid](/totaljs/cms/labels/invalid)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@petersirka](https://avatars.githubusercontent.com/u/2414252?s=52&v=4)](/petersirka) [![@piggyctf](https://avatars.githubusercontent.com/u/87955125?s=52&v=4)](/piggyctf)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


