```
{
  "cveId": "CVE-2021-46959",
  "date": "2021-04-07",
  "description": "The provided commits address a use-after-free vulnerability in the Linux kernel's SPI subsystem.",
  "fixes": [
    {
      "commit": "8735248ebb918d25427965f0db07939ed0473ec6",
      "component": "drivers/spi/spi.c, include/linux/spi/spi.h",
      "rootCause": "The vulnerability occurs in the `spi_unregister_controller()` function, where it attempts to use `devres_find()` to locate and release resources associated with a device. However, the devres list is already being torn down during this process, leading to a use-after-free scenario.",
      "weakness": "Use-after-free",
      "impact": "Decrementing reference counters below 0 resulting in memory corruption",
       "attackVector": "Unloading an SPI driver, triggering the cleanup procedure.",
      "capabilities": "An attacker would need to have the ability to load and unload SPI drivers."
    },
    {
       "commit": "794aaf01444d4e765e2b067cba01cc69c1c68ed9",
        "component": "drivers/spi/spi.c, include/linux/spi/spi.h",
      "rootCause": "The vulnerability occurs in the `spi_unregister_controller()` function, where it attempts to use `devres_find()` to locate and release resources associated with a device. However, the devres list is already being torn down during this process, leading to a use-after-free scenario.",
      "weakness": "Use-after-free",
     "impact": "Decrementing reference counters below 0 resulting in memory corruption",
       "attackVector": "Unloading an SPI driver, triggering the cleanup procedure.",
      "capabilities": "An attacker would need to have the ability to load and unload SPI drivers."
    },
    {
      "commit": "c7fabe372a9031acd00498bc718ce27c253abfd1",
      "component": "drivers/spi/spi.c, include/linux/spi/spi.h",
       "rootCause": "The vulnerability occurs in the `spi_unregister_controller()` function, where it attempts to use `devres_find()` to locate and release resources associated with a device. However, the devres list is already being torn down during this process, leading to a use-after-free scenario.",
      "weakness": "Use-after-free",
      "impact": "Decrementing reference counters below 0 resulting in memory corruption",
       "attackVector": "Unloading an SPI driver, triggering the cleanup procedure.",
      "capabilities": "An attacker would need to have the ability to load and unload SPI drivers."
    },
    {
      "commit": "62bb2c7f2411a0045c24831f11ecacfc35610815",
      "component": "drivers/spi/spi.c, include/linux/spi/spi.h",
      "rootCause": "The vulnerability occurs in the `spi_unregister_controller()` function, where it attempts to use `devres_find()` to locate and release resources associated with a device. However, the devres list is already being torn down during this process, leading to a use-after-free scenario.",
       "weakness": "Use-after-free",
      "impact": "Decrementing reference counters below 0 resulting in memory corruption",
      "attackVector": "Unloading an SPI driver, triggering the cleanup procedure.",
      "capabilities": "An attacker would need to have the ability to load and unload SPI drivers."
    },
     {
      "commit": "8e029707f50a82c53172359c686b2536ab54e58c",
      "component": "drivers/spi/spi.c, include/linux/spi/spi.h",
      "rootCause": "The vulnerability occurs in the `spi_unregister_controller()` function, where it attempts to use `devres_find()` to locate and release resources associated with a device. However, the devres list is already being torn down during this process, leading to a use-after-free scenario.",
       "weakness": "Use-after-free",
      "impact": "Decrementing reference counters below 0 resulting in memory corruption",
       "attackVector": "Unloading an SPI driver, triggering the cleanup procedure.",
      "capabilities": "An attacker would need to have the ability to load and unload SPI drivers."
    },
    {
      "commit": "cee78aa24578edac8cf00513dca618c0acc17cd7",
      "component": "drivers/spi/spi.c, include/linux/spi/spi.h",
       "rootCause": "The vulnerability occurs in the `spi_unregister_controller()` function, where it attempts to use `devres_find()` to locate and release resources associated with a device. However, the devres list is already being torn down during this process, leading to a use-after-free scenario.",
       "weakness": "Use-after-free",
      "impact": "Decrementing reference counters below 0 resulting in memory corruption",
       "attackVector": "Unloading an SPI driver, triggering the cleanup procedure.",
      "capabilities": "An attacker would need to have the ability to load and unload SPI drivers."
    },
    {
      "commit": "001c8e83646ad3b847b18f6ac55a54367d917d74",
      "component": "drivers/spi/spi.c, include/linux/spi/spi.h",
      "rootCause": "The vulnerability occurs in the `spi_unregister_controller()` function, where it attempts to use `devres_find()` to locate and release resources associated with a device. However, the devres list is already being torn down during this process, leading to a use-after-free scenario.",
      "weakness": "Use-after-free",
     "impact": "Decrementing reference counters below 0 resulting in memory corruption",
        "attackVector": "Unloading an SPI driver, triggering the cleanup procedure.",
      "capabilities": "An attacker would need to have the ability to load and unload SPI drivers."
    },
    {
      "commit": "8bf96425c90f5c1dcf3b7b9df568019a1d4b8a0e",
       "component": "drivers/spi/spi.c, include/linux/spi/spi.h",
      "rootCause": "The vulnerability occurs in the `spi_unregister_controller()` function, where it attempts to use `devres_find()` to locate and release resources associated with a device. However, the devres list is already being torn down during this process, leading to a use-after-free scenario.",
       "weakness": "Use-after-free",
      "impact": "Decrementing reference counters below 0 resulting in memory corruption",
       "attackVector": "Unloading an SPI driver, triggering the cleanup procedure.",
      "capabilities": "An attacker would need to have the ability to load and unload SPI drivers."
    }
  ]
}
```