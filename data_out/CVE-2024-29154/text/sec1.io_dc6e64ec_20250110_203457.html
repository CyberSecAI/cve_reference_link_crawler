
Skip links

* [Skip to primary navigation](#primary-nav)
* [Skip to content](#lqd-site-content)

 [![Sec1](https://sec1.io/wp-content/uploads/2024/01/Sec1-logo.svg) ![Sec1](https://sec1.io/wp-content/uploads/2024/01/Sec1-logo.svg)](https://sec1.io/)

* [Products](https://sec1.io/products/)
  #### Application Security

  ## Software Composition Analysis

  Scopy - Secure your software
  supply chain

  ## SAST

  ProSAST - detect vulnerabilities in source code

  ## DAST

  Kairo - find runtime vulnerabilities in website

  ## WordPress Scanner

  WPFort - the ultimate defense against WordPress cyber threats

  #### Cloud Security

  ## Container Scanner

  ConTek - secure containers before deployment

  ## Security Posture Management

  CloudSight - ensure cloud security and compliance

  ## Kubernetes Security   NEW

  Sec1Kube - AI-Powered Kubernetes Defense

  #### Vulnerability Management

  ## Vulnerability database

  Galaxy Guard – world’s largest vulnerability database

  ## Notifications

  Sec1Hawk – AI based vulnerability alerts

  ## Zero Day Threats

  ZeroDefender - zero day threats in real-time

  ## API Integration   EXCLUSIVE

  CVEConnect - unlock vulnerability insights with API
* AI

  #### AI Based Application Security

  ## Vulnerability Prediction

  Threat Vision – predict cyber threats before they strike

  #### Generative AI

  ## Vulnerability Insight  COMING SOON

  CyberSage - gain comprehensive insights of vulnerabilities
* [Services](https://sec1.io/services/)
  #### Penetration Testing

  ## Comprehensive Pen Testing

  Penetration Testing Services for Ultimate Cyber Security

  ## Network Pen Testing

  Uncover and mitigate network vulnerabilities with advanced testing techniques
* Company
  + [About Us](https://sec1.io/about-us/)
  + [Meet The Team](https://sec1.io/about-us#meet-the-team)
  + [Become a Sales Partner](https://sec1.io/become-a-sales-partner/)
  + [Blog](https://sec1.io/blog/)
* Industry
  + [Financial Services and Banking](https://sec1.io/financial-services-and-banking/)
  + [Healthcare](https://sec1.io/healthcare-cybersecurity/)
  + [Government and Public Sector](https://sec1.io/government-and-public-sector/)
  + [Retail and E-Commerce](https://sec1.io/retail-and-e-commerce/)
  + [Technology and Telecommunications](https://sec1.io/technology-and-telecommunications/)
  + [Energy and Utilities](https://sec1.io/energy-and-utilities/)
  + [Manufacturing and Industrial](https://sec1.io/manufacturing-and-industrial/)
  + [Transportation and Logistics](https://sec1.io/transportation-and-logistics/)
  + [Education](https://sec1.io/cybersecurity-solutions-for-education/)

[Request a demo](https://sec1.io/book-a-demo/ "Book a Demo – Cybersecurity Solutions for Applications and Cloud Security")
[Sign In](https://account.sec1.io/login "Login to Sec1 Appstore")

Toggle navigation

[![Sec1](data:image/svg+xml...)![Sec1](https://sec1.io/wp-content/uploads/2023/10/sec1-logo-svg-orange.svg)](https://sec1.io/)

* Products
  #### Application Security

  ## Software Composition Analysis

  Scopy - Secure your software
  supply chain

  ## SAST

  ProSAST - detect vulnerabilities in source code

  ## DAST

  Kairo - find runtime vulnerabilities in website

  ## WordPress Scanner

  WPFort - the ultimate defense against WordPress cyber threats

  #### Cloud Security

  ## Container Scanner

  ConTek - secure containers before deployment

  ## Security Posture Management

  CloudSight - ensure cloud security and compliance

  ## Kubernetes Security   NEW

  Sec1Kube - AI-Powered Kubernetes Defense

  #### Vulnerability Management

  ## Vulnerability database

  Galaxy Guard – world’s largest vulnerability database

  ## Notifications

  Sec1Hawk – AI based vulnerability alerts

  ## Zero Day Threats

  ZeroDefender - zero day threats in real-time

  ## API Integration   EXCLUSIVE

  CVEConnect - unlock vulnerability insights with API
* AI

  #### AI Based Application Security

  ## Vulnerability Prediction

  Threat Vision – predict cyber threats before they strike

  #### Generative AI

  ## Vulnerability Insight  COMING SOON

  CyberSage - gain comprehensive insights of vulnerabilities
* [Services](https://sec1.io/services/)
  #### Penetration Testing

  ## Comprehensive Pen Testing

  Penetration Testing Services for Ultimate Cyber Security

  ## Network Pen Testing

  Uncover and mitigate network vulnerabilities with advanced testing techniques
* Company
  + [About Us](https://sec1.io/about-us/)
  + [Become a Sales Partner](https://sec1.io/become-a-sales-partner/)
  + [Meet The Team](https://sec1.io/about-us#meet-the-team)
  + [Blog](https://sec1.io/blog/)
* [Research](https://sec1.io/sec1-research/)
* [Book Instant Demo](https://sec1.io/book-a-demo/)
* [Connect with Expert](https://sec1.io/connect-with-expert/)
* [Contact Us](https://sec1.io/contact-us/)

**Vendor:**

fabric

**Product Name:**

fabric

**Affected Version:**

1.2.0

# Cross-Site Scripting (XSS)

 **Description:**
A cross-site scripting (XSS) vulnerability has been discovered in the Fabric Open Source (<https://github.com/danielmiessler/fabric>) in v1.2.0. This vulnerability is present in <https://github.com/danielmiessler/fabric/blob/main/installer/client/gui/static/js/index.js#L43> &  <https://github.com/danielmiessler/fabric/blob/main/installer/client/gui/static/js/index.js#L159> where tempDiv.innerHTML = html function in the provided code is intended to convert HTML content to plain text. However, it directly assigns the untrusted html variable to the innerHTML property of a temporary div element without proper sanitisation or validation.This allows an attacker to inject malicious scripts or HTML into the html variable, which will be executed when assigned to innerHTML. The vulnerability lies in the lack of input validation and sanitization before using innerHTML.

The vulnerable code is located in the htmlToPlainText function:

`function htmlToPlainText(html) {

var tempDiv = document.createElement("div");

tempDiv.innerHTML = html; // Vulnerable line

// ...

}`

**Vulnerability Type:**

CWE-79: Improper Neutralisation of Input During Web Page Generation (‘Cross-site Scripting’)

 **Additional Information:**

Steps to exploit:

1. Prepare a malicious HTML payload that includes a script, for example:

   `<script>alert('XSS');</script>`
2. Call the htmlToPlainText function with the malicious payload:
   * `const maliciousHtml = “<script>alert(‘XSS’);</script>”;`
   * `const result = htmlToPlainText(maliciousHtml);`
3. Observe that the injected script is executed, showing an alert box with the message “XSS”.

 **File:**

* <https://github.com/danielmiessler/fabric/blob/main/installer/client/gui/static/js/index.js#L43>
* <https://github.com/danielmiessler/fabric/blob/main/installer/client/gui/static/js/index.js#L159>

 **Impact:**

This is a cross-site scripting (XSS) vulnerability that allows an attacker to inject and execute arbitrary JavaScript code in the context of the victim’s browser. The vulnerability impacts any user who interacts with the application where the htmlToPlainText function is used with untrusted user input.

The potential consequences of this vulnerability include:

* Stealing sensitive information, such as cookies or authentication tokens.
* Performing unauthorized actions on behalf of the user.
* Manipulating the web page’s content and behavior.
* Redirecting users to malicious websites.

The severity of this vulnerability depends on how the htmlToPlainText function is used within the application and the sensitivity of the data it processes. If the function is used to handle user-provided content that is displayed to other users, the impact could be significant.

To mitigate this vulnerability, it is recommended to:

* Properly sanitize and validate the html input before assigning it to innerHTML.
* Use a library like dompurify to sanitize the HTML content.
* Consider using safer alternatives like textContent or innerText if the plain text content is sufficient.
* Implement a whitelist of allowed HTML elements and attributes if specific HTML formatting is required.

### Remediation

**Fixed Version:**

No Fix Version Available

**Workarounds:**

None at this time.

**Obtaining Software Fixes:**

N/A

**Contact US:**

For any question related to this vulnerability or upgrade, please [contact us](https://sec1.io/contact-us/).

### Ready to secure?

Get in touch for a personalized demo and see how Sec1 can protect your digital assets.

### Products

* [Galaxy Guard](https://sec1.io/products/galaxy-guard/)
* [Sec1Hawk](https://sec1.io/products/sec1hawk/)
* [ZeroDefender](https://sec1.io/?page_id=9150)
* [CVEConnect](https://sec1.io/products/cveconnect/)
* [WPFort](https://sec1.io/products/sec1wpfort/)
* [ProSAST](https://sec1.io/products/sast-scanner/)
* [Kairo](https://sec1.io/products/dast-scanner/)
* [Threat Vision](https://sec1.io/products/threat-vision/)
* [Container Security](https://sec1.io/products/container-security/)
* [CloudSight](https://sec1.io/products/cloudsight/)
* [Sec1Kube](https://sec1.io/products/sec1kube/)
### Resources

* [Zero Day Exploits](https://sec1.io/blog/auto-draft/)
* [Cloud Security Breaches](https://sec1.io/blog/navigating-the-cloud-understanding-and-preventing-cloud-security-breaches/)
* [IoT Vulnerabilities](https://sec1.io/blog/guarding-the-connected-world-exploring-iot-vulnerabilities/)
* [Supply Chain Attacks](https://sec1.io/blog/guarding-the-chain-unpacking-supply-chain-attacks/)
* [Malware Evolution](https://sec1.io/blog/the-shape-shifting-threat-a-journey-through-malware-evolution/)
* [Phishing](https://sec1.io/blog/unmasking-the-threat-the-ever-evolving-landscape-of-phishing-campaign-innovations/)
### Services

* [Cloud Security](https://sec1.io/cloud-security/)
* [Penetration Testing](https://sec1.io/comprehensive-pentesting/)
* [SOX](https://sec1.io/services/)
* [Incident Response](https://sec1.io/services/)
* [Security Consulting](https://sec1.io/services/)
* [Security Assessment](https://sec1.io/services/)
* [Virtual CISO](https://sec1.io/services/)
* [Security Review](https://sec1.io/services/)
* [Remediation](https://sec1.io/services/)
### Company

* [About Us](https://sec1.io/about-us/)
* [Become a Sales Partner](https://sec1.io/become-a-sales-partner/)
* [Blog](https://sec1.io/blog/)
* [Vulnerability Disclosure Policy](https://sec1.io/sec1-public-disclosure-policy-for-cve-reporting/)
* [Sec1 Security Advisories](https://sec1.io/sec1-security-advisories/)
### Connect

* [Contact Us](https://sec1.io/contact-us/)
* [Book Demo](https://sec1.io/book-a-demo/)

Copyright © 2024 Sec1 - Cybersecurity AI Fortified. All rights reserved

* [Terms and Conditions](https://sec1.io/sec1-terms-and-conditions/)
* [Privacy Policy](https://sec1.io/sec1-privacy-policy/)
* [Cookie Policy](https://sec1.io/sec1-cookie-policy/)

Adding {{itemName}} to cart

Added {{itemName}} to cart

Loading...

×

