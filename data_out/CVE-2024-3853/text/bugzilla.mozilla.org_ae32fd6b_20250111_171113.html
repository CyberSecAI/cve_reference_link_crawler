

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1884427)
* [XML](/show_bug.cgi?ctype=xml&id=1884427)

Closed
[Bug 1884427](/show_bug.cgi?id=1884427)
(CVE-2024-3853)

Opened 10 months ago
Closed 10 months ago

# Crash [@ js::CheckTracedThing]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash [@ js::CheckTracedThing]

## Categories

### (Core :: JavaScript: GC, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%3A%20GC#JavaScript%3A%20GC)

JavaScript: GC
▾

Core :: JavaScript: GC
File bugs here for issues involving the garbage collector (crashes, leaks, etc.), where the issue is *not* one caused by failure to use the JSAPI correctly.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20GC&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20GC&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%3A%20GC)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

126 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=unaffected) |
| firefox123 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=unaffected) |
| firefox124 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix) |
| firefox125 | [+](/buglist.cgi?f1=cf_tracking_firefox125&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=fixed) |
| firefox126 | [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | unaffected |
| firefox-esr128 | --- | --- |
| firefox123 |  | unaffected |
| firefox124 |  | wontfix |
| firefox125 | + | fixed |
| firefox126 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gkw, Assigned: jonco)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c9ec760b0d3a20a6775614baa4086871?d=mm&size=40)  [jonco](/user_profile?user_id=443194)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [gkw](/user_profile?user_id=132034)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

9 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[gkw-js-fuzzing](/show_bug.cgi?id=1890610 "NEW - [meta] Gary JavaScript engine Fuzzing")

Dependency [tree](/showdependencytree.cgi?id=1884427&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1884427)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (5 keywords, Whiteboard: [adv-main125+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-3853

[Keywords:](/describekeywords.cgi)

[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main125+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1555324_1689 "10 months ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [aryx](/user_profile?user_id=258347) | [in-testsuite](#c19 "9 months ago") | + |
| --- | --- | --- |
| [aryx](/user_profile?user_id=258347) | in-testsuite | + |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | [qe-verify](#a1679654_488993 "10 months ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [debug stack](/attachment.cgi?id=9390239)  [10 months ago](#c0)  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)   9.05 KB, text/plain |  | [Details](/attachment.cgi?id=9390239&action=edit) |
| --- | --- | --- |
| [Bug 1884427 - Don't destroy realms that were being initialised at the start of GC r?jandem](/attachment.cgi?id=9391005)  [10 months ago](#c5)  [Jon Coppeard (:jonco)](/user_profile?user_id=443194)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c14 "10 months ago")  tjr : [sec-approval+](#c8 "10 months ago") | [Details](/attachment.cgi?id=9391005&action=edit) | [Review](/attachment.cgi?id=9391005) |
| [Bug 1884427 - Add testcode r?jandem](/attachment.cgi?id=9391006)  [10 months ago](#c6)  [Jon Coppeard (:jonco)](/user_profile?user_id=443194)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9391006&action=edit) | [Review](/attachment.cgi?id=9391006) |
| [advisory.txt](/attachment.cgi?id=9396603)  [9 months ago](#c16)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   211 bytes, text/plain |  | [Details](/attachment.cgi?id=9396603&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1884427#c0)• 10 months ago |
|  | |

Attached file
[debug stack](attachment.cgi?id=9390239)
— [Details](attachment.cgi?id=9390239&action=edit)

```
gczeal(10);
x = 1;
newGlobal();
oomAtAllocation(8);
try {
  newGlobal();
} catch (e) {}
oomAtAllocation(8);
try {
  newGlobal();
} catch (e) {}
oomAtAllocation(8);
try {
  newGlobal();
} catch (e) {}
newGlobal();

```
```
136	  if (IsForwarded(thing)) {
(gdb) bt
#0  js::CheckTracedThing<JSObject> (trc=trc@entry=0x7fffffffbb38, thing=0xe5e5e5e5e5e5e5e5) at /home/yksubu/trees/mozilla-central/js/src/gc/Marking.cpp:136
#1  0x0000555557c8c134 in js::gc::TraceEdgeInternal (trc=0x7fffffffbb38, thingp=0x7fffffffbb68, Object=<optimized out>) at /home/yksubu/trees/mozilla-central/js/src/gc/Tracer.h:109
#2  js::TraceManuallyBarrieredEdge<JSObject*> (trc=0x7fffffffbb38, thingp=0x7fffffffbb68, name=<optimized out>) at /home/yksubu/trees/mozilla-central/js/src/gc/Tracer.h:252
#3  js::BaseShape::traceChildren (this=0x1bfc73d6e2e0, trc=0x7fffffffbb38) at /home/yksubu/trees/mozilla-central/js/src/gc/TraceMethods-inl.h:305
#4  UpdateCellPointers<js::BaseShape> (trc=0x7fffffffbb38, cell=0x1bfc73d6e2e0) at /home/yksubu/trees/mozilla-central/js/src/gc/Compacting.cpp:497
#5  UpdateArenaPointersTyped<js::BaseShape> (trc=0x7fffffffbb38, arena=0x1bfc73d6e000) at /home/yksubu/trees/mozilla-central/js/src/gc/Compacting.cpp:503
#6  UpdateArenaPointers (trc=0x7fffffffbb38, arena=0x1bfc73d6e000) at /home/yksubu/trees/mozilla-central/js/src/gc/Compacting.cpp:533
#7  UpdateArenaListSegmentPointers (gc=gc@entry=0x7ffff662f798, arenas=...) at /home/yksubu/trees/mozilla-central/js/src/gc/Compacting.cpp:557
#8  0x0000555557c8bb9d in js::gc::GCRuntime::updateCellPointers (this=this@entry=0x7ffff662f798, zone=zone@entry=0x7ffff65b4000, kinds=...) at /home/yksubu/trees/mozilla-central/js/src/gc/Compacting.cpp:676
#9  0x0000555557c86633 in js::gc::GCRuntime::updateAllCellPointers (this=0x7ffff662f798, trc=0x7fffffffc300, zone=0x7ffff65b4000) at /home/yksubu/trees/mozilla-central/js/src/gc/Compacting.cpp:744
#10 js::gc::GCRuntime::updateZonePointersToRelocatedCells (this=this@entry=0x7ffff662f798, zone=zone@entry=0x7ffff65b4000) at /home/yksubu/trees/mozilla-central/js/src/gc/Compacting.cpp:781
/snip

```

Run with `--fuzzing-safe --no-threads --no-baseline --no-ion`, compile with `AR=ar sh ../configure --enable-debug --enable-debug-symbols --with-ccache --enable-nspr-build --enable-ctypes --enable-gczeal --enable-rust-simd --disable-tests`, tested on m-c rev fe38c21e5d5b.

Setting s-s to be safe.

Flags: sec-bounty?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a28_75935)• 10 months ago |

Group: core-security → javascript-core-security

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1884427#c1)• 10 months ago |
|  | |

```
The first bad revision is:
changeset:   https://hg.mozilla.org/mozilla-central/rev/86209ac07283
user:        Jan de Mooij
date:        Tue Feb 06 12:51:28 2024 +0000
summary:     Bug 1877193 part 3 - Add testing functions to look up pref names and values. r=mgaudet

```

Jan, is [bug 1877193](/show_bug.cgi?id=1877193 "RESOLVED FIXED - Make StaticPrefList.yaml prefs available in SpiderMonkey") a likely (or unlikely) regressor?

Flags: needinfo?(jdemooij)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)Regressed by: [1877193](/show_bug.cgi?id=1877193 "RESOLVED FIXED - Make StaticPrefList.yaml prefs available in SpiderMonkey")

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1884427#c2)• 10 months ago |
|  | |

Set release status flags based on info from the regressing [bug 1877193](/show_bug.cgi?id=1877193 "RESOLVED FIXED - Make StaticPrefList.yaml prefs available in SpiderMonkey")

[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=unaffected)
[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=unaffected)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1884427#c3)• 10 months ago |
|  | |

(In reply to Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now) from [comment #1](/show_bug.cgi?id=1884427#c1 "RESOLVED FIXED - Crash [@ js::CheckTracedThing]"))

> Jan, is [bug 1877193](/show_bug.cgi?id=1877193 "RESOLVED FIXED - Make StaticPrefList.yaml prefs available in SpiderMonkey") a likely (or unlikely) regressor?

It's most likely that the new testing functions affect the GC heap in some way. I'll take a closer look.

No longer regressed by: [1877193](/show_bug.cgi?id=1877193 "RESOLVED FIXED - Make StaticPrefList.yaml prefs available in SpiderMonkey")

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1884427#c4)• 10 months ago |
|  | |

The test doesn't call the new testing functions. We destroy a realm but later trace a `BaseShape` pointing to that realm, so we crash when we try to trace its global.

Flags: needinfo?(jdemooij) → needinfo?(jcoppeard)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a330097_75935)• 10 months ago |

[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix)

|  | [Jon Coppeard (:jonco)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a335114_443194)• 10 months ago |

Assignee: nobody → jcoppeard

|  | [Jon Coppeard (:jonco)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1884427#c5)• 10 months ago |
|  | |

Attached file
[Bug 1884427 - Don't destroy realms that were being initialised at the start of GC r?jandem](attachment.cgi?id=9391005)
— [Details](attachment.cgi?id=9391005&action=edit)

The problem is that when global object creation fails it may leave a live base

shape with a pointer into a realm that has been destroyed. This happens when

the base shape is allocated during an incremental GC (and is therefore kept

alive), but the realm was allocated before the GC was started and can be freed.

If the realm was a GC thing it would have been placed in a Rooted and this

would work.

There is a flag to keep the realm alive if it was allocated during GC. The

patch also sets this flag if the realm is in the process of being initialized

at the start of GC.

|  | [Jon Coppeard (:jonco)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1884427#c6)• 10 months ago |
|  | |

Attached file
[Bug 1884427 - Add testcode r?jandem](attachment.cgi?id=9391006)
— [Details](attachment.cgi?id=9391006&action=edit)

|  | [Jon Coppeard (:jonco)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a421930_443194)• 10 months ago |

Flags: needinfo?(jcoppeard)

|  | [Jon Coppeard (:jonco)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a421975_443194)• 10 months ago |

Keywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---)

|  | [Jon Coppeard (:jonco)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1884427#c7)• 10 months ago |
|  | |

Comment on [attachment 9391005](/attachment.cgi?id=9391005 "Bug 1884427 - Don't destroy realms that were being initialised at the start of GC r?jandem") [[details]](/attachment.cgi?id=9391005&action=edit "Bug 1884427 - Don't destroy realms that were being initialised at the start of GC r?jandem")

[Bug 1884427](/show_bug.cgi?id=1884427 "RESOLVED FIXED - Crash [@ js::CheckTracedThing]") - Don't destroy realms that were being initialised at the start of GC r?jandem

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Pretty hard, requiring triggering OOM at just the right time.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which branches (beta, release, and/or ESR) are affected by this flaw, and do the release status flags reflect this affected/unaffected state correctly?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: The same fix should apply, or would be trivial to backport.
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely, as this is a simple change that keeps Realms alive longer in some cases.
* **Is the patch ready to land after security approval is given?**: Yes
* **Is Android affected?**: Yes
[Attachment #9391005](/attachment.cgi?id=9391005&action=edit "Bug 1884427 - Don't destroy realms that were being initialised at the start of GC r?jandem") -
Flags: sec-approval?

|  | [Jon Coppeard (:jonco)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a422085_443194)• 10 months ago |

[Attachment #9391006](/attachment.cgi?id=9391006&action=edit "Bug 1884427 - Add testcode r?jandem") -
Flags: sec-approval?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a422521_406194)• 10 months ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Steven DeTar [:sdetar]](/user_profile?user_id=607698) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a434627_607698)• 10 months ago |

Severity: -- → S2Priority: -- → P1

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a450268_75935)• 10 months ago |

[tracking-firefox125](/buglist.cgi?f1=cf_tracking_firefox125&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox125&o1=equals&v1=%2B)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a928447_695136)• 10 months ago |

[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected)
[tracking-firefox126](/buglist.cgi?f1=cf_tracking_firefox126&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1884427#c8)• 10 months ago |
|  | |

Comment on [attachment 9391005](/attachment.cgi?id=9391005 "Bug 1884427 - Don't destroy realms that were being initialised at the start of GC r?jandem") [[details]](/attachment.cgi?id=9391005&action=edit "Bug 1884427 - Don't destroy realms that were being initialised at the start of GC r?jandem")

[Bug 1884427](/show_bug.cgi?id=1884427 "RESOLVED FIXED - Crash [@ js::CheckTracedThing]") - Don't destroy realms that were being initialised at the start of GC r?jandem

sec-approvals were paused for a few days after merge, thanks for the patience. Normally I'd be circumspect about this level of detail in the commit message; but looking at the patch, I don't think it's really saying anything someone couldn't figure out *very* quickly from the flag, so there isn't a lot of reason to censor it and then try to add the comment later, leave the description in the bug, etc. So approved to land and uplift

[Attachment #9391005](/attachment.cgi?id=9391005&action=edit "Bug 1884427 - Don't destroy realms that were being initialised at the start of GC r?jandem") -
Flags: sec-approval? → sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1884427#c9)• 10 months ago |
|  | |

Comment on [attachment 9391006](/attachment.cgi?id=9391006 "Bug 1884427 - Add testcode r?jandem") [[details]](/attachment.cgi?id=9391006&action=edit "Bug 1884427 - Add testcode r?jandem")

[Bug 1884427](/show_bug.cgi?id=1884427 "RESOLVED FIXED - Crash [@ js::CheckTracedThing]") - Add testcode r?jandem

clearing sec-approval flag for the test, that can land when the reminder expires.

[Attachment #9391006](/attachment.cgi?id=9391006&action=edit "Bug 1884427 - Add testcode r?jandem") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a1110324_578488)• 10 months ago |

Whiteboard: [reminder-test 2024-05-28]

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1884427#c10)• 10 months ago |
|  | |

Pushed by jcoppeard@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/2b96ff9f9527>
Don't destroy realms that were being initialised at the start of GC r=jandem

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1884427#c11)• 10 months ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/2b96ff9f9527>

Group: javascript-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 10 months ago
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 126 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1884427#c12)• 10 months ago |
|  | |

The patch landed in nightly and beta is affected.

:jonco, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox125` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(jcoppeard)

|  | [Jon Coppeard (:jonco)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1884427#c13)• 10 months ago |
|  | |

Comment on [attachment 9391005](/attachment.cgi?id=9391005 "Bug 1884427 - Don't destroy realms that were being initialised at the start of GC r?jandem") [[details]](/attachment.cgi?id=9391005&action=edit "Bug 1884427 - Don't destroy realms that were being initialised at the start of GC r?jandem")

[Bug 1884427](/show_bug.cgi?id=1884427 "RESOLVED FIXED - Crash [@ js::CheckTracedThing]") - Don't destroy realms that were being initialised at the start of GC r?jandem

### Beta/Release Uplift Approval Request

* **User impact if declined**: Possible crash / security vulnerability
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This is a simple change and has baked on central for a few days.
* **String changes made/needed**: None
* **Is Android affected?**: Yes
Flags: needinfo?(jcoppeard)
[Attachment #9391005](/attachment.cgi?id=9391005&action=edit "Bug 1884427 - Don't destroy realms that were being initialised at the start of GC r?jandem") -
Flags: approval-mozilla-beta?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a1555324_1689)• 10 months ago |

Flags: sec-bounty? → sec-bounty+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1884427#c14)• 10 months ago |
|  | |

Comment on [attachment 9391005](/attachment.cgi?id=9391005 "Bug 1884427 - Don't destroy realms that were being initialised at the start of GC r?jandem") [[details]](/attachment.cgi?id=9391005&action=edit "Bug 1884427 - Don't destroy realms that were being initialised at the start of GC r?jandem")

[Bug 1884427](/show_bug.cgi?id=1884427 "RESOLVED FIXED - Crash [@ js::CheckTracedThing]") - Don't destroy realms that were being initialised at the start of GC r?jandem

Approved for 125.0b5.

[Attachment #9391005](/attachment.cgi?id=9391005&action=edit "Bug 1884427 - Don't destroy realms that were being initialised at the start of GC r?jandem") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a1565625_75935)• 10 months ago |

[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1884427#c15)• 10 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/774e8478df2c>

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a1679654_488993)• 10 months ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a2759483_132034)• 9 months ago |

Blocks: [gkw-js-fuzzing](/show_bug.cgi?id=1890610 "NEW - [meta] Gary JavaScript engine Fuzzing")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a2901917_1689)• 9 months ago |

Flags: in-testsuite?Whiteboard: [reminder-test 2024-05-28] → [reminder-test 2024-05-28][adv-main125+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1884427#c16)• 9 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9396603)
— [Details](attachment.cgi?id=9396603&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a3286843_1689)• 9 months ago |

Alias: CVE-2024-3853

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1884427#c17)• 8 months ago |
|  | |

2 months ago, tjr placed a reminder on the bug using the whiteboard tag `[reminder-test 2024-05-28]` .

jonco, please refer to the original comment to better understand the reason for the reminder.

Flags: needinfo?(jcoppeard)Whiteboard: [reminder-test 2024-05-28][adv-main125+] → [adv-main125+]

|  | [Jon Coppeard (:jonco)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a6973406_443194)• 8 months ago |

Flags: needinfo?(jcoppeard)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1884427#c18)• 8 months ago |
|  | |

Pushed by jcoppeard@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/b9d131b4a351>
Add testcode r=jandem

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1884427#c19)• 8 months ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/b9d131b4a351>

Flags: in-testsuite? → in-testsuite+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a7167340_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884427#a16787454_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1884427&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

