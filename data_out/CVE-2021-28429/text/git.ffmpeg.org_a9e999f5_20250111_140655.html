
[![git](static/git-logo.png)](http://git-scm.com/ "git homepage")[projects](/gitweb) / [ffmpeg.git](/gitweb/ffmpeg.git) / commitdiff

commit
grep
author
committer
pickaxe
 [?](/gitweb/ffmpeg.git/search_help "search help") search:

re

[summary](/gitweb/ffmpeg.git) | [shortlog](/gitweb/ffmpeg.git/shortlog/c94875471e3ba3dc396c6919ff3ec9b14539cd71) | [log](/gitweb/ffmpeg.git/log/c94875471e3ba3dc396c6919ff3ec9b14539cd71) | [commit](/gitweb/ffmpeg.git/commit/c94875471e3ba3dc396c6919ff3ec9b14539cd71) | commitdiff | [tree](/gitweb/ffmpeg.git/tree/c94875471e3ba3dc396c6919ff3ec9b14539cd71)

[raw](/gitweb/ffmpeg.git/commitdiff_plain/c94875471e3ba3dc396c6919ff3ec9b14539cd71) | [patch](/gitweb/ffmpeg.git/patch/c94875471e3ba3dc396c6919ff3ec9b14539cd71) | inline | [side by side](/gitweb/ffmpeg.git/commitdiff/c94875471e3ba3dc396c6919ff3ec9b14539cd71?ds=sidebyside) (parent: [403b35e](/gitweb/ffmpeg.git/commitdiff/403b35e16e16a8c4a13e531ccdc23598f685ca20))

[avutil/timecode: Avoid fps overflow](/gitweb/ffmpeg.git/commit/c94875471e3ba3dc396c6919ff3ec9b14539cd71)

| author | [Michael Niedermayer](/gitweb/ffmpeg.git/search/c94875471e3ba3dc396c6919ff3ec9b14539cd71?s=Michael+Niedermayer;st=author "Search for commits authored by Michael Niedermayer") [<michael@niedermayer.cc>](/gitweb/ffmpeg.git/search/c94875471e3ba3dc396c6919ff3ec9b14539cd71?s=michael@niedermayer.cc;st=author "Search for commits authored by michael@niedermayer.cc") |  |
| --- | --- | --- |
|  | Mon, 1 Mar 2021 12:44:12 +0000 (13:44 +0100) |
| committer | [Michael Niedermayer](/gitweb/ffmpeg.git/search/c94875471e3ba3dc396c6919ff3ec9b14539cd71?s=Michael+Niedermayer;st=committer "Search for commits committed by Michael Niedermayer") [<michael@niedermayer.cc>](/gitweb/ffmpeg.git/search/c94875471e3ba3dc396c6919ff3ec9b14539cd71?s=michael@niedermayer.cc;st=committer "Search for commits committed by michael@niedermayer.cc") |  |
|  | Sun, 14 Mar 2021 22:29:51 +0000 (23:29 +0100) |

Fixes: Integer overflow and division by 0

Fixes: poc-202102-div.mov

Found-by: 1vanChen of NSFOCUS Security Team

Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

| [libavutil/timecode.c](/gitweb/ffmpeg.git/blob/c94875471e3ba3dc396c6919ff3ec9b14539cd71%3A/libavutil/timecode.c) |  | [patch](/gitweb/ffmpeg.git/commitdiff/c94875471e3ba3dc396c6919ff3ec9b14539cd71#patch1) | [blob](/gitweb/ffmpeg.git/blob/c94875471e3ba3dc396c6919ff3ec9b14539cd71%3A/libavutil/timecode.c) | [history](/gitweb/ffmpeg.git/history/c94875471e3ba3dc396c6919ff3ec9b14539cd71%3A/libavutil/timecode.c) |
| --- | --- | --- |

diff --git [a/libavutil/timecode.c](/gitweb/ffmpeg.git/blob/b1b504edbf601d8cd59effa71b2edf97791aa0e6?f=libavutil/timecode.c) [b/libavutil/timecode.c](/gitweb/ffmpeg.git/blob/c94875471e3ba3dc396c6919ff3ec9b14539cd71%3A/libavutil/timecode.c)
index b1b504edbf601d8cd59effa71b2edf97791aa0e6..2fc3295e25dedc328a2943673b7c8734570516c1 100644 (file)

--- a/[libavutil/timecode.c](/gitweb/ffmpeg.git/blob/b1b504edbf601d8cd59effa71b2edf97791aa0e6?f=libavutil/timecode.c)
+++ b/[libavutil/timecode.c](/gitweb/ffmpeg.git/blob/c94875471e3ba3dc396c6919ff3ec9b14539cd71%3A/libavutil/timecode.c)
@@ [-114,8](/gitweb/ffmpeg.git/blob/b1b504edbf601d8cd59effa71b2edf97791aa0e6?f=libavutil/timecode.c#l114) [+114,8](/gitweb/ffmpeg.git/blob/c94875471e3ba3dc396c6919ff3ec9b14539cd71%3A/libavutil/timecode.c#l114) @@ char \*av\_timecode\_make\_string(const AVTimecode \*tc, char \*buf, int framenum)
     }
     ff = framenum % fps;
     ss = framenum / fps        % 60;
-    mm = framenum / (fps\*60)   % 60;
-    hh = framenum / (fps\*3600);
+    mm = framenum / (fps\*60LL) % 60;
+    hh = framenum / (fps\*3600LL);
     if (tc->flags & AV\_TIMECODE\_FLAG\_24HOURSMAX)
         hh = hh % 24;
     snprintf(buf, AV\_TIMECODE\_STR\_SIZE, "%s%02d:%02d:%02d%c%02d",

FFmpeg git repo
[RSS](/gitweb/ffmpeg.git/rss "log RSS feed")
[Atom](/gitweb/ffmpeg.git/atom "log Atom feed")

