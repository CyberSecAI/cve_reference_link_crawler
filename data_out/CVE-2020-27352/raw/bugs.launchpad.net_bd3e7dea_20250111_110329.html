<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://bugs.launchpad.net/snapd/+bug/1910456/+index" />

    <meta charset="UTF-8" />
    <title>Bug #1910456 “container management snaps should have Delegate=tr...” : Bugs : snapd</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/@@/apple-touch-icon.png?v=2022" />
    <link rel="icon" type="image/png" sizes="32x32" href="/@@/favicon-32x32.png?v=2022" />
    <link rel="icon" type="image/png" sizes="16x16" href="/@@/favicon-16x16.png?v=2022" />
    <link rel="manifest" href="/@@/site.webmanifest?v=2022" />
    <link rel="mask-icon" href="/@@/safari-pinned-tab.svg?v=2022" color="#e9531f" />
    <link rel="shortcut icon" href="/@@/favicon.ico?v=2022" />
    <meta name="msapplication-TileColor" content="#da532c" />
    <meta name="msapplication-config" content="/@@/browserconfig.xml?v=2022" />
    <meta name="theme-color" content="#ffffff" />
    <link rel="canonical" href="https://bugs.launchpad.net/bugs/1910456" />
    
      <link rel="alternate" type="application/atom+xml" href="http://feeds.launchpad.net/bugs/1910456/bug.atom" title="Bug 1910456 Feed" />
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev6394e03793719e8d73f5a60b5439440e693c92f1/combo.css" />


    

    
      <meta name="description" content="As reported to the ubuntu security team, and discussed in https://github.com/docker-snap/docker-snap/security/advisories/GHSA-798c-v3jq-h646, the docker snap's systemd unit for the dockerd process should have Delegate=true in it to prevent systemd from reaping the control groups for child processes (which in this case are docker containers that are put into control groups which are separate from the the docker snap) and moving the child processes back into the same control group as the parent..." />
      <meta property="og:description" content="As reported to the ubuntu security team, and discussed in https://github.com/docker-snap/docker-snap/security/advisories/GHSA-798c-v3jq-h646, the docker snap's systemd unit for the dockerd process should have Delegate=true in it to prevent systemd from reaping the control groups for child processes (which in this case are docker containers that are put into control groups which are separate from the the docker snap) and moving the child processes back into the same control group as the parent..." />
    

    
    
      <meta property="og:title" content="Bug #1910456 “container management snaps should have Delegate=tr...” : Bugs : snapd" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad-og-image.png" />
      <meta property="og:url" content="https://bugs.launchpad.net/bugs/1910456" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev6394e03793719e8d73f5a60b5439440e693c92f1/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev6394e03793719e8d73f5a60b5439440e693c92f1/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev6394e03793719e8d73f5a60b5439440e693c92f1/?lp/',
                    comboBase: '/+combo/rev6394e03793719e8d73f5a60b5439440e693c92f1/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
      <script type="text/javascript" id="available-official-tags-js">var available_official_tags = ["flaky-tests", "trusty"];</script>
      <script type="text/javascript">
        LPJS.use('base', 'node', 'oop', 'event', 'lp.bugs.bugtask_index',
                  'lp.bugs.subscribers', 'lp.code.branchmergeproposal.diff',
                  'lp.app.comment', 'lp.services.messages.edit', function(Y) {
            Y.on('domready', function() {
                Y.lp.code.branchmergeproposal.diff.connect_diff_links();
                Y.lp.bugs.bugtask_index.setup_bugtask_index();
                Y.lp.bugs.bugtask_index.setup_bugtask_table();
                LP.cache.comment_context = LP.cache.bug;
                var cl = new Y.lp.app.comment.CommentList();
                cl.render();
                var sl = new Y.lp.bugs.subscribers.createBugSubscribersLoader({
                    container_box: '#other-bug-subscribers',
                    subscribers_details_view:
                        '/+bug-portlet-subscribers-details',
                    subscribe_someone_else_link: '.menu-link-addsubscriber'
                }, window);

                Y.lp.services.messages.edit.setup();
            });
         });
      </script>
      <style type="text/css">
        /* Align the 'add comment' link to the right of the comment box. */
        #add-comment-form textarea { width: 100%; }
        #add-comment-form { max-width: 60em; padding-bottom: 4em; }
        #add-comment-form .actions {float: right;}
        .buglink-summary dd { font-size: 10px; }
        a#privacy-link:link:hover, a#privacy-link:visited:hover {text-decoration:none;}
      </style>
      <style type="text/css">
        .yui3-overlay .value label  {
          /* It normally makes sense for form labels to be bold, but since
          this form consists only of radio buttons, there's nothing but labels
          so we just get wall-to-wall bold. */
          font-weight: normal !important;
        }
      </style>
    
    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-bugs
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://bugs.launchpad.net/snapd/+bug/1910456/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/snapd"><img alt="" width="64" height="64" src="/@@/product-logo" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/snapd">snapd</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/snapd">Overview</a></li>
      
    
    
      
      <li class="branches"><a href="https://code.launchpad.net/snapd">Code</a></li>
      
    
    
      <li class="bugs active"><a href="https://bugs.launchpad.net/snapd">Bugs</a></li>
      
      
    
    
      
      <li class="specifications"><a href="https://blueprints.launchpad.net/snapd">Blueprints</a></li>
      
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/snapd">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/snapd">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              
      <h1 id="edit-title">
<span class="yui3-editable_text-text ellipsis" style="max-width: 95%;">
    container management snaps should have Delegate=true in their systemd unit
</span>
  
</h1>



    
              

              <div id="registration" class="registering">
                
      Bug #1910456 reported by
      <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson</a>
      <time title="2021-01-06 22:28:34 UTC" datetime="2021-01-06T22:28:34.575734+00:00">on 2021-01-06</time>
      
    
              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

      

      <div id="bug-is-duplicate">
          
      </div>
      

      <div style="float: right;">
        <span><a href="/+help-bugs/bug-heat.html" target="help" class="sprite flame">290</a></span>
      </div>

      


  
  
    <div class="actions">
      <span id="affectsmetoo" style="display: inline">This bug affects 2 people</span>
    </div>
  



    <table id="affected-software" class="listing">
      <thead>
        <tr>
          <th colspan="2">Affects</th>
          <th>Status</th>
          <th>Importance</th>
          <th>Assigned to</th>
          <th>Milestone</th>
        </tr>
      </thead>

      <tbody>
        
          
  <tr class="highlight" id="tasksummary2670669">
    <td>
      
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary2670669">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/snapd">snapd</a>
        </span>
        
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        <span style="float: left" class="value statusFIXRELEASED">Fix Released</span>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceCRITICAL">Critical</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2670669">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~anonymouse67">Ian Johnson</a>
            
          </span>
          
          
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href="https://launchpad.net/snapd/+milestone/2.49">snapd 2.49</a>
        
      </div>
    </td>

    
  </tr>

  


        
      </tbody>

    </table>








      <div id="maincontentsub">
        <div class="top-portlet">

      <div itemprop="mainContentOfPage" class="report">
        

        <div>
  <div class="lazr-multiline-edit" id="edit-description">
  <div class="clearfix">
    

    <h3>Bug Description</h3>
  </div>

  <div class="yui3-editable_text-text"><p>As reported to the ubuntu security team, and discussed in <a rel="nofollow" href="https://github.com/docker-snap/docker-snap/security/advisories/GHSA-798c-v3jq-h646">https:/<wbr />/github.<wbr />com/docker-<wbr />snap/docker-<wbr />snap/security/<wbr />advisories/<wbr />GHSA-798c-<wbr />v3jq-h646</a>, the docker snap&#x27;s systemd unit for the dockerd process should have Delegate=true in it to prevent systemd from reaping the control groups for child processes (which in this case are docker containers that are put into control groups which are separate from the the docker snap) and moving the child processes back into the same control group as the parent process that systemd is managing, which is dockerd.</p>
<p>More concretely, not including Delegate=true in the systemd service file means that after a systemctl daemon-reload is executed, docker containers now have the same privilege level as dockerd, which is a privilege escalation.</p>
<p>This was assigned CVE-2020-27352 by Alex Murray.</p>
<p>I have opened this private snapd bug, because this vulnerability affects more than just the docker snap, it also affects any other container management snaps, such as microk8s, Azure IoT Edge, AWS IoT Greengrass and potentially others. The list of snaps affected can be narrowed down to any snap which has been granted privilege to use a &quot;container management&quot; interfaces, which are all super-privileged and require a snap store assertion in order to be uploaded to the Snap Store. The current list of affected interfaces is:</p>
<p>- docker-support (all variants)<br />
- greengrass-support (with the &quot;legacy-containers&quot; flavor or with empty flavor)<br />
- kubernetes-support (with the &quot;kubelet&quot; flavor or with empty flavor)<br />
- lxd-support (though the LXD snap is not affected by this issue, we should fix the interface as if it was for consistencies sake) [1]</p>
<p>[1] This vulnerability specifically does not affect LXD though (or at least it should not), because LXD is already using Delegate=true in it&#x27;s own generated systemd setup, as shown in this segment of the snap packaging for LXD: <a rel="nofollow" href="https://github.com/lxc/lxd-pkg-snap/blob/latest-edge/snapcraft/commands/daemon.start#L308">https:/<wbr />/github.<wbr />com/lxc/<wbr />lxd-pkg-<wbr />snap/blob/<wbr />latest-<wbr />edge/snapcraft/<wbr />commands/<wbr />daemon.<wbr />start#L308</a>. See also <a rel="nofollow" href="https://github.com/lxc/lxc/issues/323">https:/<wbr />/github.<wbr />com/lxc/<wbr />lxc/issues/<wbr />323</a> which is when the LXD project first encountered the issue with Delegate and systemd.</p></div>
  </div>

  
</div>


        <div style="margin:-10px 0 20px 5px" class="clearfix">
          
        </div>

        <div id="bug-tags">
          <span id="tags-heading">
            
          </span>
          <span id="tag-list">
          </span>
          
        </div>

        <script type="text/javascript">
          LPJS.use('event', 'node', 'lp.bugs.tags_entry', function(Y) {
              Y.on('domready',
                   function(e) {
                       Y.lp.bugs.tags_entry.setup_tag_entry(
                           available_official_tags);
                   },
                   window);
          });
        </script>

        <div class="clearfix"></div>
      </div>

      <div id="branches-and-cves">
        <div id="bug-branches-container" style="float: left">
          
        </div><!-- bug-branch-container -->

        <div class="cves">
          <h2>CVE References</h2>
          <ul>
            <li class="sprite cve">
              <a href="/bugs/cve/2019-5736" title="runc through 1.0-rc6, as used in Dock...">2019-5736</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2020-15257" title="containerd is an industry-standard co...">2020-15257</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2020-27352" title="When generating the systemd service u...">2020-27352</a>
            </li>
          </ul>
        </div>

        <div class="clearfix"></div>
      </div> <!-- branches and CVEs -->

      </div>

      <div>
      
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
    
    <time title="2021-01-06 22:29:28 UTC" datetime="2021-01-06T22:29:28.728977+00:00">on 2021-01-06</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in snapd: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Confirmed
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; Critical
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/1" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-06T22:40:32.513869+00:00" title="2021-01-06 22:40:32 UTC">on 2021-01-06</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/1"> #1</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>We on the snapd team have a plan for fixing this, by essentially making it such that any snap that plugs these interfaces, will have Delegate=true put into the generated systemd unit.</p>
<p>Specifically, we would like to always include Delegate=true if the snap merely declares a plug for one of these interfaces, regardless of whether the plug is connected to a slot or not. This makes the code implementation much simpler for us, because it means we don&#x27;t need to modify the systemd service unit for the snap service every time the plug is connected or disconnected, which would be a lot of work codewise for us.</p>
<p>This has the important implication though that if a snap declares the plug for something like docker-support, but does not have docker-support connected to the slot, then it will not have the highly privileged policy that enables something like docker to create containers and confine those containers, _but_ it will still have the setting of Delegate=true which means that systemd will not clean up the control groups for child processes if the child processes were to somehow get into a different control group.</p>
<p>We do not think this is an issue because:<br />
* in order to have Delegate=true in the policy, you still need to declare the plug, and today all snaps that use these interfaces are not allowed to be uploaded to the store unless they are approved/allowed to by store reviewers (this is because the interfaces are super-privileged)<br />
* even if the snap has Delegate=true in it&#x27;s systemd unit, that alone does not provide the necessary privilege in order to create containers or otherwise create new control groups and place processes into those control groups</p>
<p>However, we would like input on this from the security team about whether this makes sense and is not introducing a vulnerability in this way.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">We on the snapd team have a plan for fixing this, by essentially making it such that any snap that plugs these interfaces, will have Delegate=true put into the generated systemd unit. 

Specifically, we would like to always include Delegate=true if the snap merely declares a plug for one of these interfaces, regardless of whether the plug is connected to a slot or not. This makes the code implementation much simpler for us, because it means we don't need to modify the systemd service unit for the snap service every time the plug is connected or disconnected, which would be a lot of work codewise for us. 

This has the important implication though that if a snap declares the plug for something like docker-support, but does not have docker-support connected to the slot, then it will not have the highly privileged policy that enables something like docker to create containers and confine those containers, _but_ it will still have the setting of Delegate=true which means that systemd will not clean up the control groups for child processes if the child processes were to somehow get into a different control group. 

We do not think this is an issue because: 
* in order to have Delegate=true in the policy, you still need to declare the plug, and today all snaps that use these interfaces are not allowed to be uploaded to the store unless they are approved/allowed to by store reviewers (this is because the interfaces are super-privileged)
* even if the snap has Delegate=true in it's systemd unit, that alone does not provide the necessary privilege in order to create containers or otherwise create new control groups and place processes into those control groups

However, we would like input on this from the security team about whether this makes sense and is not introducing a vulnerability in this way.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/2" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-06T22:56:50.860666+00:00" title="2021-01-06 22:56:50 UTC">on 2021-01-06</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/2"> #2</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The other outstanding question we have is whether the &quot;flavor&quot; variants as mentioned in the original description are sufficient or if there are other flavors which need to have Delegate=true generated for services declaring a plug.</p>
<p>Firstly, the greengrass-support interface currently has two flavors, the empty or &quot;legacy-container&quot; flavor, and the &quot;no-container&quot; flavor. The &quot;no-container&quot; flavor is meant as a super minimal interface which does not have the same set of privileges as the other one, really only the privileges necessary for AWS IoT Greengrass&#x27;s greengrassd to start processes using runC. The question here though is whether the policy that the &quot;no-container&quot; flavor has is actually enough to allow moving into new control groups. I don&#x27;t think it is, but here is the link to that policy: <a rel="nofollow" href="https://github.com/snapcore/snapd/blob/cc12dae3934eab08fbca39a9b661d8b1da0ba40d/interfaces/builtin/greengrass_support.go#L56-L65">https:/<wbr />/github.<wbr />com/snapcore/<wbr />snapd/blob/<wbr />cc12dae3934eab0<wbr />8fbca39a9b661d8<wbr />b1da0ba40d/<wbr />interfaces/<wbr />builtin/<wbr />greengrass_<wbr />support.<wbr />go#L56-<wbr />L65</a>. I&#x27;m specifically not sure if the &quot;rix&quot; rule for runc executable allows runC to create containers with different control groups, because if it is, then the &quot;no-container&quot; flavor also needs to have the Delegate=true directive added to the generated systemd service unit.</p>
<p>Secondly, the kubernetes-support interface has 4 flavors, which are as follows:</p>
<p>1. the empty flavor, which is used AIUI for a kubernetes daemon which needs all of the flavor policies, i.e. kubelet, kubeproxy, and autobind-unix.</p>
<p>2. the kubelet flavor, which is used only for kubelet, and has this comment in the policy:</p>
<p># allow managing pods&#x27; cgroups<br />
/sys/fs/<wbr />cgroup/<wbr />*/kubepods/<wbr />{,**} rw,</p>
<p>(from <a rel="nofollow" href="https://github.com/snapcore/snapd/blob/cc12dae3934eab08fbca39a9b661d8b1da0ba40d/interfaces/builtin/kubernetes_support.go#L125-L126">https:/<wbr />/github.<wbr />com/snapcore/<wbr />snapd/blob/<wbr />cc12dae3934eab0<wbr />8fbca39a9b661d8<wbr />b1da0ba40d/<wbr />interfaces/<wbr />builtin/<wbr />kubernetes_<wbr />support.<wbr />go#L125-<wbr />L126</a>) which means it needs Delegate=true.</p>
<p>3. the kubeproxy flavor, which from my understanding also manages control groups with similar policy as kubelet in it, and thus should have Delegate=true.</p>
<p>4. the autobind-unix flavor, which does not have any policy associated with managing control groups in it, and thus should _not_ have Delegate=true directive in the generated systemd service unit.</p>
<p>As such, it is my understanding that any kubernetes-support plug declaration, except one with the flavor: autobind-unix attribute, should get Delegate-true generated.</p>
<p>Thirdly, The lxd-support interface is entirely open and as such allows the LXD snap to escape confinement and is not tracked by systemd at all, so adding Delegate=true for the lxd-support interface is largely just educational and not necessary for securing LXD.</p>
<p>Fourthly, all variants of the docker-support interface (with either the privileged: true attribute or the privileged: false or no privileged attribute) are meant for dockerd to manage containers and thus all should get Delegate=true.</p>
<p>I think this is all of the interfaces that we have in snapd for managing contianers, but if someone could double-check this that would be good.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The other outstanding question we have is whether the "flavor" variants as mentioned in the original description are sufficient or if there are other flavors which need to have Delegate=true generated for services declaring a plug. 

Firstly, the greengrass-support interface currently has two flavors, the empty or "legacy-container" flavor, and the "no-container" flavor. The "no-container" flavor is meant as a super minimal interface which does not have the same set of privileges as the other one, really only the privileges necessary for AWS IoT Greengrass's greengrassd to start processes using runC. The question here though is whether the policy that the "no-container" flavor has is actually enough to allow moving into new control groups. I don't think it is, but here is the link to that policy: https://github.com/snapcore/snapd/blob/cc12dae3934eab08fbca39a9b661d8b1da0ba40d/interfaces/builtin/greengrass_support.go#L56-L65. I'm specifically not sure if the "rix" rule for runc executable allows runC to create containers with different control groups, because if it is, then the "no-container" flavor also needs to have the Delegate=true directive added to the generated systemd service unit.

Secondly, the kubernetes-support interface has 4 flavors, which are as follows:

1. the empty flavor, which is used AIUI for a kubernetes daemon which needs all of the flavor policies, i.e. kubelet, kubeproxy, and autobind-unix.

2. the kubelet flavor, which is used only for kubelet, and has this comment in the policy: 

# allow managing pods' cgroups
/sys/fs/cgroup/*/kubepods/{,**} rw,

(from https://github.com/snapcore/snapd/blob/cc12dae3934eab08fbca39a9b661d8b1da0ba40d/interfaces/builtin/kubernetes_support.go#L125-L126) which means it needs Delegate=true.

3. the kubeproxy flavor, which from my understanding also manages control groups with similar policy as kubelet in it, and thus should have Delegate=true.

4. the autobind-unix flavor, which does not have any policy associated with managing control groups in it, and thus should _not_ have Delegate=true directive in the generated systemd service unit.

As such, it is my understanding that any kubernetes-support plug declaration, except one with the flavor: autobind-unix attribute, should get Delegate-true generated.


Thirdly, The lxd-support interface is entirely open and as such allows the LXD snap to escape confinement and is not tracked by systemd at all, so adding Delegate=true for the lxd-support interface is largely just educational and not necessary for securing LXD.

Fourthly, all variants of the docker-support interface (with either the privileged: true attribute or the privileged: false or no privileged attribute) are meant for dockerd to manage containers and thus all should get Delegate=true.

I think this is all of the interfaces that we have in snapd for managing contianers, but if someone could double-check this that would be good.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/3" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-07T14:48:35.384579+00:00" title="2021-01-07 14:48:35 UTC">on 2021-01-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/3"> #3</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I have added the original reporters of the vulnerability to this bug report.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I have added the original reporters of the vulnerability to this bug report.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/4" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~jdstrand" class="sprite person">Jamie Strandboge (jdstrand)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-07T21:40:06.350954+00:00" title="2021-01-07 21:40:06 UTC">on 2021-01-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/4"> #4</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>First off, I want to be clear that with all of the listed interfaces (with the exception of some of the flavors), the policy is considered &#x27;advisory&#x27; and there are enough privileges to escape confinement. As such, I&#x27;m not convinced this should be granted a CVE because at some point, someone will point out how to break out, a CVE will be assigned and there will be no fix because that is precisely what the interface intends to give. As such I&#x27;d be more inclined to call this a normal bug in snapd. Alex, if you agree, we can burn the CVE.</p>
<p>The idea of adding Delegate=true when the affected interfaces are connected makes sense to me.</p>
<p>In terms of flavors, I would be in favor of only adding Delegate=true to affected flavors. I agree with your assessment to include it for all but autobind-unix in kubernetes-support. It should include it for both flavors of docker-support. Adding it for lxd-support makes sense for completeness, especially when we know that it intends to manage containers.</p>
<p>For greengress-support no-container (the legacy-container obviously needs it), rix means that runc will inherit the policies of the invoking process. This on its own is not enough IME to require adding Delegate=true, assuming the invoking process is coming from a snap and not unconfined.</p>
<p>I&#x27;ll mention that system-files could be used in a manner to require Delegate=true if using &#x27;write&#x27; with affected directories.</p>
<p>There is a question of classic snaps and container managers though, like microk8s. Should we add something to per command app yaml for Delegate=true for services? (we could have this flag for manual review in the store). I don&#x27;t think this should block the proposed fix for strict snaps though.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">First off, I want to be clear that with all of the listed interfaces (with the exception of some of the flavors), the policy is considered 'advisory' and there are enough privileges to escape confinement. As such, I'm not convinced this should be granted a CVE because at some point, someone will point out how to break out, a CVE will be assigned and there will be no fix because that is precisely what the interface intends to give. As such I'd be more inclined to call this a normal bug in snapd. Alex, if you agree, we can burn the CVE.

The idea of adding Delegate=true when the affected interfaces are connected makes sense to me.

In terms of flavors, I would be in favor of only adding Delegate=true to affected flavors. I agree with your assessment to include it for all but autobind-unix in kubernetes-support. It should include it for both flavors of docker-support. Adding it for lxd-support makes sense for completeness, especially when we know that it intends to manage containers.

For greengress-support no-container (the legacy-container obviously needs it), rix means that runc will inherit the policies of the invoking process. This on its own is not enough IME to require adding Delegate=true, assuming the invoking process is coming from a snap and not unconfined.

I'll mention that system-files could be used in a manner to require Delegate=true if using 'write' with affected directories.

There is a question of classic snaps and container managers though, like microk8s. Should we add something to per command app yaml for Delegate=true for services? (we could have this flag for manual review in the store). I don't think this should block the proposed fix for strict snaps though.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/5" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-07T21:52:59.028466+00:00" title="2021-01-07 21:52:59 UTC">on 2021-01-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/5"> #5</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p><span class="foldable-quoted">&gt; First off, I want to be clear that with all of the listed interfaces (with the exception of some of the flavors), the policy is considered &#x27;advisory&#x27; and there are enough privileges to escape confinement.
</span></p>
<p>I think the issue here (and why this deserves a CVE) is not that the snap services can escape confinement due to this issue, but rather that the container management agents like dockerd are not able to effectively confine their own containers without Delegate=true. For example, I want to launch a docker container and there is some reasonable expectation on my part that dockerd is going to confine the container to not have the same privilege level as dockerd.</p>
<p>Regarding classic snaps, I think you are correct in that we should also do this for classic snaps like microk8s; I would need to look into it a bit, but theoretically those classic snaps would also suffer from the same problem since their processes are containers and they are also presumably put into different control groups than the container management agent.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">&gt; First off, I want to be clear that with all of the listed interfaces (with the exception of some of the flavors), the policy is considered 'advisory' and there are enough privileges to escape confinement.

I think the issue here (and why this deserves a CVE) is not that the snap services can escape confinement due to this issue, but rather that the container management agents like dockerd are not able to effectively confine their own containers without Delegate=true. For example, I want to launch a docker container and there is some reasonable expectation on my part that dockerd is going to confine the container to not have the same privilege level as dockerd. 

Regarding classic snaps, I think you are correct in that we should also do this for classic snaps like microk8s; I would need to look into it a bit, but theoretically those classic snaps would also suffer from the same problem since their processes are containers and they are also presumably put into different control groups than the container management agent.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/6" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-07T21:55:39.114885+00:00" title="2021-01-07 21:55:39 UTC">on 2021-01-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/6"> #6</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p><span class="foldable-quoted">&gt; I&#x27;ll mention that system-files could be used in a manner to require Delegate=true if using &#x27;write&#x27; with affected directories.
</span></p>
<p>Do you know of any such usages currently in the field? If so, we should think about how to handle those cases, because we can&#x27;t really add Delegate=true for all system-files usages, and inspecting which system-files are vulnerable is probably rather difficult.</p>
<p>If there are no such usages in the field, perhaps we should just update the docs around granting system-files to not allow snaps to use system-files with those interfaces without first deciding about what snapd should do about using Delegate=true in that case. Perhaps the system-files interface could gain an attribute to reflect this or something like that.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">&gt; I'll mention that system-files could be used in a manner to require Delegate=true if using 'write' with affected directories.

Do you know of any such usages currently in the field? If so, we should think about how to handle those cases, because we can't really add Delegate=true for all system-files usages, and inspecting which system-files are vulnerable is probably rather difficult. 

If there are no such usages in the field, perhaps we should just update the docs around granting system-files to not allow snaps to use system-files with those interfaces without first deciding about what snapd should do about using Delegate=true in that case. Perhaps the system-files interface could gain an attribute to reflect this or something like that.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/7" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~jdstrand" class="sprite person">Jamie Strandboge (jdstrand)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-07T22:29:38.079745+00:00" title="2021-01-07 22:29:38 UTC">on 2021-01-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/7"> #7</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I don&#x27;t, no. I would&#x27;ve rejected them if they came across my desk. I suspect roadmr would&#x27;ve asked us about them as well. Would need a store query to be sure though.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I don't, no. I would've rejected them if they came across my desk. I suspect roadmr would've asked us about them as well. Would need a store query to be sure though.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/8" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~jdstrand" class="sprite person">Jamie Strandboge (jdstrand)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-07T22:38:44.209408+00:00" title="2021-01-07 22:38:44 UTC">on 2021-01-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/8"> #8</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p><span class="foldable-quoted">&gt; I think the issue here (and why this deserves a CVE) is not that the snap services can escape confinement due to this issue, but rather that the container management agents like dockerd are not able to effectively confine their own containers without Delegate=true.
</span></p>
<p>That&#x27;s a fair point. Based on your assessment, it surely isn&#x27;t a bug in the docker snap or any of the others because they aren&#x27;t in a position to fix the issue. It still seems like a bit of a gray area and feels more like a bug. I defer to Alex and Seth who are more up to date on the current guidelines.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">&gt; I think the issue here (and why this deserves a CVE) is not that the snap services can escape confinement due to this issue, but rather that the container management agents like dockerd are not able to effectively confine their own containers without Delegate=true.

That's a fair point. Based on your assessment, it surely isn't a bug in the docker snap or any of the others because they aren't in a position to fix the issue. It still seems like a bit of a gray area and feels more like a bug. I defer to Alex and Seth who are more up to date on the current guidelines.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/9" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-08T02:22:39.173537+00:00" title="2021-01-08 02:22:39 UTC">on 2021-01-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/9"> #9</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@jdstrand</p>
<p><span class="foldable-quoted">&gt; The idea of adding Delegate=true when the affected interfaces are connected makes sense to me.
</span></p>
<p>What do you think about our proposal to make adding Delegate=true a &quot;permanent plug property&quot; such that the interfaces do not need to be connected in order for Delegate=true to be included in the systemd unit? Doing it this way makes the code much simpler for us, and as detailed above I don&#x27;t think introduces any vulnerabilities because 1) the interfaces doing this are already super-privileged and 2) the line alone doesn&#x27;t do anything except tell systemd to not move control groups, but in order to take advantage of systemd not moving control groups, the confined process would need to have permissions to create/move control groups which isn&#x27;t allowed except when the interfaces are connected.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@jdstrand

&gt; The idea of adding Delegate=true when the affected interfaces are connected makes sense to me.

What do you think about our proposal to make adding Delegate=true a "permanent plug property" such that the interfaces do not need to be connected in order for Delegate=true to be included in the systemd unit? Doing it this way makes the code much simpler for us, and as detailed above I don't think introduces any vulnerabilities because 1) the interfaces doing this are already super-privileged and 2) the line alone doesn't do anything except tell systemd to not move control groups, but in order to take advantage of systemd not moving control groups, the confined process would need to have permissions to create/move control groups which isn't allowed except when the interfaces are connected.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/10" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alexmurray" class="sprite person">Alex Murray (alexmurray)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-08T04:08:54.405134+00:00" title="2021-01-08 04:08:54 UTC">on 2021-01-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/10"> #10</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Regarding the CVE - I agree this is a gray area, if we assume these interfaces are not expected to provide *any* meaningful confinement then there is no security boundary violated. However, whilst we recognise they are privileged, I think it is reasonable to assume they at least provide the isolation expected for containers which are managed by apps that plug these interfaces - as such I think this is a proper vulnerability and the CVE should stay assigned.</p>
<p>I also feel that making this a permanent plug property doesn&#x27;t appear to introduce any possible security issue, however I wonder if perhaps it would be better to just make snapd allow any snap to declare for a given daemon that it wants Delegate=True and then leave it up to the snap publisher to do the right thing here - and to then make this require a store assertion to be able to use. This feels more like the correct thing to do here since perhaps some daemons for a given snap would want this and others may not - so this provides a more flexible approach.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Regarding the CVE - I agree this is a gray area, if we assume these interfaces are not expected to provide *any* meaningful confinement then there is no security boundary violated. However, whilst we recognise they are privileged, I think it is reasonable to assume they at least provide the isolation expected for containers which are managed by apps that plug these interfaces - as such I think this is a proper vulnerability and the CVE should stay assigned.


I also feel that making this a permanent plug property doesn't appear to introduce any possible security issue, however I wonder if perhaps it would be better to just make snapd allow any snap to declare for a given daemon that it wants Delegate=True and then leave it up to the snap publisher to do the right thing here - and to then make this require a store assertion to be able to use. This feels more like the correct thing to do here since perhaps some daemons for a given snap would want this and others may not - so this provides a more flexible approach.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/11" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-08T21:26:57.712460+00:00" title="2021-01-08 21:26:57 UTC">on 2021-01-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/11"> #11</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p><span class="foldable-quoted">&gt; however I wonder if perhaps it would be better to just make snapd allow any snap to declare for a given daemon that it wants Delegate=True and then leave it up to the snap publisher to do the right thing here - and to then make this require a store assertion to be able to use.
</span></p>
<p>Yes after we have fixed this bug with the automatic adding of Delegate=true for snaps that need it, we want to have a way for snaps to &quot;opt-in&quot; to this behavior in the future. That feature however doesn&#x27;t need to be developed in private and can be a normal feature request for snapd.</p>
<p>I have gone ahead with preparing the PR to fix this bug, I think that given we are &quot;ok&quot; to go ahead with the permanent plug property (rather than strictly only &quot;connected plug&quot; property), the code is simple as we had hoped and we can probably get this reviewed next week and would be hypothetically ready for a release the week after, so sometime the week of Jan 18th. However, Canonical will be having an internal sprint with many folks who would be instrumental to this release (such as myself and Michael and Samuele from the snapd team) busy that entire week, so I would like to propose the week after, what do folks think of a CRD sometime the week of January 25th ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">&gt; however I wonder if perhaps it would be better to just make snapd allow any snap to declare for a given daemon that it wants Delegate=True and then leave it up to the snap publisher to do the right thing here - and to then make this require a store assertion to be able to use.

Yes after we have fixed this bug with the automatic adding of Delegate=true for snaps that need it, we want to have a way for snaps to "opt-in" to this behavior in the future. That feature however doesn't need to be developed in private and can be a normal feature request for snapd.

I have gone ahead with preparing the PR to fix this bug, I think that given we are "ok" to go ahead with the permanent plug property (rather than strictly only "connected plug" property), the code is simple as we had hoped and we can probably get this reviewed next week and would be hypothetically ready for a release the week after, so sometime the week of Jan 18th. However, Canonical will be having an internal sprint with many folks who would be instrumental to this release (such as myself and Michael and Samuele from the snapd team) busy that entire week, so I would like to propose the week after, what do folks think of a CRD sometime the week of January 25th ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/12" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alexmurray" class="sprite person">Alex Murray (alexmurray)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-09T02:12:24.563406+00:00" title="2021-01-09 02:12:24 UTC">on 2021-01-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/12"> #12</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>CRD week of the 25th sounds good to me - I am on leave myself on the 25/26 so perhaps later in the week is better for me but emitorino should be around to help out from the security team if needed on those days.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">CRD week of the 25th sounds good to me - I am on leave myself on the 25/26 so perhaps later in the week is better for me but emitorino should be around to help out from the security team if needed on those days. </textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/13" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~giladreti" class="sprite person">Gilad Reti (giladreti)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-10T11:16:02.903000+00:00" title="2021-01-10 11:16:02 UTC">on 2021-01-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/13"> #13</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi there,</p>
<p>Sorry for the unrelated message, but we would like to confirm with you that the issue we reported may indeed be triggered spontaneously, and does not require an intervention of an admin.</p>
<p>Thanks!</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi there,

Sorry for the unrelated message, but we would like to confirm with you that the issue we reported may indeed be triggered spontaneously, and does not require an intervention of an admin.

Thanks!</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/14" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-15T19:13:16.653152+00:00" title="2021-01-15 19:13:16 UTC">on 2021-01-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/14"> #14</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Alright the private PR I have prepared has been reviewed on our side and is now ready for a security review, @alexmurray, would you like to do the review of the code or is there someone else from the security team who will review the code? I will have to add whomever is reviewing to the private github repo.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Alright the private PR I have prepared has been reviewed on our side and is now ready for a security review, @alexmurray, would you like to do the review of the code or is there someone else from the security team who will review the code? I will have to add whomever is reviewing to the private github repo.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/15" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~giladreti" class="sprite person">Gilad Reti (giladreti)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-17T07:23:12.268006+00:00" title="2021-01-17 07:23:12 UTC">on 2021-01-17</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/15"> #15</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>We believe that there is another issue with this vulnerability that we would like to bring to your attention. Although @anonymouse67 referred to this issue as requiring<br />
systemctl daemon-reload<br />
we have seen this vulnerability triggered spontaneously, periodically, without any user intervention.</p>
<p>Any unit enabling, disabling, editing, or adding a dependency will cause a systemd reload. This means that if any service causes any other service unit to reload, systemd will do a complete reload and the relevant cgroups will be changed. Such a service may be for example the apt unattended-upgrade service. When upgrading some packages, unattended-upgrade may change systemd units and will thus cause it to do a system reload.<br />
Thus, after some unattended-<wbr />upgrades, systemd will reload and docker cgroups will be deleted which will make the host vulnerable, without any user interaction.</p>
<p>If you have a long running machine, you can use cat /var/log/<wbr />unattended-<wbr />upgrades/<wbr />unattended-<wbr />upgrades.<wbr />log | grep &quot;INFO Packages that will be upgraded&quot; to view recent unattended upgrades, and then check journalctl --no-pager | grep &quot;systemd\[1\]: Reloading&quot; to find out if a reload happened immediately after one of the unattended upgrades.</p>
<p>For example, on my machine I have</p>
<p>$ cat /var/log/<wbr />unattended-<wbr />upgrades/<wbr />unattended-<wbr />upgrades.<wbr />log<br />
...<br />
2020-12-10 04:55:33,391 INFO Starting unattended upgrades script<br />
2020-12-10 04:55:33,392 INFO Allowed origins are: o=Ubuntu,a=groovy, o=Ubuntu,<wbr />a=groovy-<wbr />security, o=UbuntuESMApps<wbr />,a=groovy-<wbr />apps-security, o=UbuntuESM,<wbr />a=groovy-<wbr />infra-security<br />
2020-12-10 04:55:33,392 INFO Initial blacklist:<br />
2020-12-10 04:55:33,392 INFO Initial whitelist (not strict):<br />
2020-12-10 06:49:05,474 INFO Starting unattended upgrades script<br />
2020-12-10 06:49:05,475 INFO Allowed origins are: o=Ubuntu,a=groovy, o=Ubuntu,<wbr />a=groovy-<wbr />security, o=UbuntuESMApps<wbr />,a=groovy-<wbr />apps-security, o=UbuntuESM,<wbr />a=groovy-<wbr />infra-security<br />
2020-12-10 06:49:05,476 INFO Initial blacklist:<br />
2020-12-10 06:49:05,476 INFO Initial whitelist (not strict):<br />
2020-12-10 06:49:09,571 INFO Packages that will be upgraded: apt apt-transport-https apt-utils curl libapt-pkg6.0 libcurl3-gnutls libcurl4 python-apt-common python3-apt<br />
2020-12-10 06:49:09,571 INFO Writing dpkg log to /var/log/<wbr />unattended-<wbr />upgrades/<wbr />unattended-<wbr />upgrades-<wbr />dpkg.log<br />
2020-12-10 06:50:21,609 INFO All upgrades installed<br />
...</p>
<p>and</p>
<p>$ journalctl --no-pager | grep &quot;systemd\[1\]: Reloading&quot;<br />
...<br />
Dec 10 06:49:17 ubuntu systemd[1]: Reloading.<br />
Dec 10 06:49:18 ubuntu systemd[1]: Reloading.<br />
Dec 10 06:49:19 ubuntu systemd[1]: Reloading.<br />
...</p>
<p>Therefore, we believe that this vulnerability has the following CVSS v3.1 Vector - AV:L/AC:<wbr />L/PR:N/<wbr />UI:N/S:<wbr />C/C:H/I:<wbr />H/A:H, since this vulnerability may be spontaneously triggered and it does not require an admin to trigger it.<br />
Let us know if you want us to supply a PoC.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">We believe that there is another issue with this vulnerability that we would like to bring to your attention. Although @anonymouse67 referred to this issue as requiring 
systemctl daemon-reload
we have seen this vulnerability triggered spontaneously, periodically, without any user intervention.

Any unit enabling, disabling, editing, or adding a dependency will cause a systemd reload. This means that if any service causes any other service unit to reload, systemd will do a complete reload and the relevant cgroups will be changed. Such a service may be for example the apt unattended-upgrade service. When upgrading some packages, unattended-upgrade may change systemd units and will thus cause it to do a system reload.
Thus, after some unattended-upgrades, systemd will reload and docker cgroups will be deleted which will make the host vulnerable, without any user interaction.

If you have a long running machine, you can use cat /var/log/unattended-upgrades/unattended-upgrades.log | grep "INFO Packages that will be upgraded" to view recent unattended upgrades, and then check journalctl --no-pager | grep "systemd\[1\]: Reloading" to find out if a reload happened immediately after one of the unattended upgrades.

For example, on my machine I have 

$ cat /var/log/unattended-upgrades/unattended-upgrades.log
...
2020-12-10 04:55:33,391 INFO Starting unattended upgrades script
2020-12-10 04:55:33,392 INFO Allowed origins are: o=Ubuntu,a=groovy, o=Ubuntu,a=groovy-security, o=UbuntuESMApps,a=groovy-apps-security, o=UbuntuESM,a=groovy-infra-security
2020-12-10 04:55:33,392 INFO Initial blacklist: 
2020-12-10 04:55:33,392 INFO Initial whitelist (not strict): 
2020-12-10 06:49:05,474 INFO Starting unattended upgrades script
2020-12-10 06:49:05,475 INFO Allowed origins are: o=Ubuntu,a=groovy, o=Ubuntu,a=groovy-security, o=UbuntuESMApps,a=groovy-apps-security, o=UbuntuESM,a=groovy-infra-security
2020-12-10 06:49:05,476 INFO Initial blacklist: 
2020-12-10 06:49:05,476 INFO Initial whitelist (not strict): 
2020-12-10 06:49:09,571 INFO Packages that will be upgraded: apt apt-transport-https apt-utils curl libapt-pkg6.0 libcurl3-gnutls libcurl4 python-apt-common python3-apt
2020-12-10 06:49:09,571 INFO Writing dpkg log to /var/log/unattended-upgrades/unattended-upgrades-dpkg.log
2020-12-10 06:50:21,609 INFO All upgrades installed
...

and

$ journalctl --no-pager | grep "systemd\[1\]: Reloading" 
...
Dec 10 06:49:17 ubuntu systemd[1]: Reloading.
Dec 10 06:49:18 ubuntu systemd[1]: Reloading.
Dec 10 06:49:19 ubuntu systemd[1]: Reloading.
...

Therefore, we believe that this vulnerability has the following CVSS v3.1 Vector - AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H, since this vulnerability may be spontaneously triggered and it does not require an admin to trigger it.
Let us know if you want us to supply a PoC.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/16" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-18T02:26:59.271629+00:00" title="2021-01-18 02:26:59 UTC">on 2021-01-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/16"> #16</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi Gilad, I will let our security team respond to your request about the CVSS Vector, but note that our proposed solution will always add Delegate=true to the service, so even if it can be triggered via different avenues, the fix will operate the same.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi Gilad, I will let our security team respond to your request about the CVSS Vector, but note that our proposed solution will always add Delegate=true to the service, so even if it can be triggered via different avenues, the fix will operate the same.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/17" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-18T21:32:09.425331+00:00" title="2021-01-18 21:32:09 UTC">on 2021-01-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/17"> #17</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hello again Gilad and Nimrod, due to unforeseen circumstances, we will be unable to get a full security review of our proposed fix until next week, so we would like to request to push the CRD out an additional week to sometime during the week of Feb 1st, is a CRD of Feb 3rd okay?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hello again Gilad and Nimrod, due to unforeseen circumstances, we will be unable to get a full security review of our proposed fix until next week, so we would like to request to push the CRD out an additional week to sometime during the week of Feb 1st, is a CRD of Feb 3rd okay?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/18" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-19T23:51:30.002280+00:00" title="2021-01-19 23:51:30 UTC">on 2021-01-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/18"> #18</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>For the record, I have subscribed some kubernetes folks from Canonical for awareness since this affects snaps using the kubernetes-support interface as well as docker-support.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">For the record, I have subscribed some kubernetes folks from Canonical for awareness since this affects snaps using the kubernetes-support interface as well as docker-support.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/19" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~giladreti" class="sprite person">Gilad Reti (giladreti)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-20T08:25:34.920970+00:00" title="2021-01-20 08:25:34 UTC">on 2021-01-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/19"> #19</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Feb 3rd is okay by us.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Feb 3rd is okay by us.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/20" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~giladreti" class="sprite person">Gilad Reti (giladreti)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-25T08:59:28.430591+00:00" title="2021-01-25 08:59:28 UTC">on 2021-01-25</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/20"> #20</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi @anonymouse67, are there any news?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi @anonymouse67, are there any news?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/21" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-25T12:15:05+00:00" title="2021-01-25 12:15:05 UTC">on 2021-01-25</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/snapd/+bug/1910456/comments/21">
                <strong>Re: [Bug 1910456] Re: container management snaps should have Delegates=true in their systemd unit</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/21"> #21</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  <a href="https://bugs.launchpad.net/snapd/+bug/1910456/comments/21/+download">Download full text</a> (3.7 KiB)
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi, we are waiting for our security team to review the code which should<br />
happen early this week. If you would like, I can build you a version of the<br />
snapd snap that you can install locally to test out the fix. After the fix<br />
has been approved by our security team we will also make the fix available<br />
via a hidden branch that you can install from as well, but we don&#x27;t want to<br />
publish it in a hidden branch until we have confirmation from our security<br />
team.</p>
<p>On Mon, Jan 25, 2021, 03:10 Gilad Reti &lt;email address hidden&gt; wrote:</p>
<p><span class="foldable-quoted">&gt; Hi @anonymouse67, are there any news?<br />
&gt;<br />
&gt; --<br />
&gt; You received this bug notification because you are subscribed to the bug<br />
&gt; report.<br />
&gt; <a rel="nofollow" href="https://bugs.launchpad.net/bugs/1910456">https:/<wbr />/bugs.launchpad<wbr />.net/bugs/<wbr />1910456</a><br />
&gt;<br />
&gt; Title:<br />
&gt;   container management snaps should have Delegates=true in their systemd<br />
&gt;   unit<br />
&gt;<br />
&gt; Status in snapd:<br />
&gt;   Confirmed<br />
&gt;<br />
&gt; Bug description:<br />
&gt;   As reported to the ubuntu security team, and discussed in<br />
&gt;   <a rel="nofollow" href="https://github.com/docker-snap/docker-snap/security/advisories/GHSA-">https:/<wbr />/github.<wbr />com/docker-<wbr />snap/docker-<wbr />snap/security/<wbr />advisories/<wbr />GHSA-</a><br />
&gt;   798c-v3jq-h646, the docker snap&#x27;s systemd unit for the dockerd process<br />
&gt;   should have Delegate=true in it to prevent systemd from reaping the<br />
&gt;   control groups for child processes (which in this case are docker<br />
&gt;   containers that are put into control groups which are separate from<br />
&gt;   the the docker snap) and moving the child processes back into the same<br />
&gt;   control group as the parent process that systemd is managing, which is<br />
&gt;   dockerd.<br />
&gt;<br />
&gt;   More concretely, not including Delegate=true in the systemd service<br />
&gt;   file means that after a systemctl daemon-reload is executed, docker<br />
&gt;   containers now have the same privilege level as dockerd, which is a<br />
&gt;   privilege escalation.<br />
&gt;<br />
&gt;   This was assigned CVE-2020-27352 by Alex Murray.<br />
&gt;<br />
&gt;   I have opened this private snapd bug, because this vulnerability<br />
&gt;   affects more than just the docker snap, it also affects any other<br />
&gt;   container management snaps, such as microk8s, Azure IoT Edge, AWS IoT<br />
&gt;   Greengrass and potentially others. The list of snaps affected can be<br />
&gt;   narrowed down to any snap which has been granted privilege to use a<br />
&gt;   &quot;container management&quot; interfaces, which are all super-privileged and<br />
&gt;   require a snap store assertion in order to be uploaded to the Snap<br />
&gt;   Store. The current list of affected interfaces is:<br />
&gt;<br />
&gt;   - docker-support (all variants)<br />
&gt;   - greengrass-support (with the &quot;legacy-containers&quot; flavor or with empty<br />
&gt; flavor)<br />
&gt;   - kubernetes-support (with the &quot;kubelet&quot; flavor or with empty flavor)<br />
&gt;   - lxd-support (though the LXD snap is not affected by this issue, we<br />
&gt; should fix the interface as if it was for consistencies sake) [1]<br />
&gt;<br />
&gt;   [1] This vulnerability specifically does not affect LXD though (or at<br />
&gt;   least it should not), because LXD is already using Delegate=true in<br />
&gt;   it&#x27;s own generated systemd setup, as shown in this segment of the snap<br />
&gt;   packaging for LXD: <a rel="nofollow" href="https://github.com/lxc/lxd-pkg-snap/blob/latest-">https:/<wbr />/github.<wbr />com/lxc/<wbr />lxd-pkg-<wbr />snap/blob/<wbr />latest-</a><br />
&gt;   edge/snapcraft/<wbr />commands/<wbr />daemon.<wbr />start#L308. See also<br />
&gt;   <a rel="nofollow" href="https://github.com/lxc/lxc/issues/323">https:/<wbr />/github.<wbr />com/lxc/<wbr />lxc/issues/<wbr />323</a> which is when the LXD project<br />
&gt;   first encountered the issue with Delegate and systemd.<br />
&gt;<br />
&gt; To manage notifications about this bug go to:<br />
&gt; <a rel="nofollow" href="https://bugs.launchpad">https:/<wbr />/bugs.launchpad</a>....
</span></p></div>
    
    <p>
      <a href="/snapd/+bug/1910456/comments/21">Read more...</a>
    </p>
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi, we are waiting for our security team to review the code which should
happen early this week. If you would like, I can build you a version of the
snapd snap that you can install locally to test out the fix. After the fix
has been approved by our security team we will also make the fix available
via a hidden branch that you can install from as well, but we don't want to
publish it in a hidden branch until we have confirmation from our security
team.

On Mon, Jan 25, 2021, 03:10 Gilad Reti &lt;1910456@bugs.launchpad.net&gt; wrote:

&gt; Hi @anonymouse67, are there any news?
&gt;
&gt; --
&gt; You received this bug notification because you are subscribed to the bug
&gt; report.
&gt; https://bugs.launchpad.net/bugs/1910456
&gt;
&gt; Title:
&gt;   container management snaps should have Delegates=true in their systemd
&gt;   unit
&gt;
&gt; Status in snapd:
&gt;   Confirmed
&gt;
&gt; Bug description:
&gt;   As reported to the ubuntu security team, and discussed in
&gt;   https://github.com/docker-snap/docker-snap/security/advisories/GHSA-
&gt;   798c-v3jq-h646, the docker snap's systemd unit for the dockerd process
&gt;   should have Delegate=true in it to prevent systemd from reaping the
&gt;   control groups for child processes (which in this case are docker
&gt;   containers that are put into control groups which are separate from
&gt;   the the docker snap) and moving the child processes back into the same
&gt;   control group as the parent process that systemd is managing, which is
&gt;   dockerd.
&gt;
&gt;   More concretely, not including Delegate=true in the systemd service
&gt;   file means that after a systemctl daemon-reload is executed, docker
&gt;   containers now have the same privilege level as dockerd, which is a
&gt;   privilege escalation.
&gt;
&gt;   This was assigned CVE-2020-27352 by Alex Murray.
&gt;
&gt;   I have opened this private snapd bug, because this vulnerability
&gt;   affects more than just the docker snap, it also affects any other
&gt;   container management snaps, such as microk8s, Azure IoT Edge, AWS IoT
&gt;   Greengrass and potentially others. The list of snaps affected can be
&gt;   narrowed down to any snap which has been granted privilege to use a
&gt;   "container management" interfaces, which are all super-privileged and
&gt;   require a snap store assertion in order to be uploaded to the Snap
&gt;   Store. The current list of affected interfaces is:
&gt;
&gt;   - docker-support (all variants)
&gt;   - greengrass-support (with the "legacy-containers" flavor or with empty
&gt; flavor)
&gt;   - kubernetes-support (with the "kubelet" flavor or with empty flavor)
&gt;   - lxd-support (though the LXD snap is not affected by this issue, we
&gt; should fix the interface as if it was for consistencies sake) [1]
&gt;
&gt;   [1] This vulnerability specifically does not affect LXD though (or at
&gt;   least it should not), because LXD is already using Delegate=true in
&gt;   it's own generated systemd setup, as shown in this segment of the snap
&gt;   packaging for LXD: https://github.com/lxc/lxd-pkg-snap/blob/latest-
&gt;   edge/snapcraft/commands/daemon.start#L308. See also
&gt;   https://github.com/lxc/lxc/issues/323 which is when the LXD project
&gt;   first encountered the issue with Delegate and systemd.
&gt;
&gt; To manage notifications about this bug go to:
&gt; https://bugs.launchpad.net/snapd/+bug/1910456/+subscriptions
&gt;
&gt; Launchpad-Notification-Type: bug
&gt; Launchpad-Bug: product=snapd; status=Confirmed; importance=Critical;
&gt; assignee=ian.johnson@canonical.com;
&gt; Launchpad-Bug-Information-Type: Private Security
&gt; Launchpad-Bug-Private: yes
&gt; Launchpad-Bug-Security-Vulnerability: yes
&gt; Launchpad-Bug-Commenters: alexmurray anonymouse67 giladreti jdstrand
&gt; Launchpad-Bug-Reporter: Ian Johnson (anonymouse67)
&gt; Launchpad-Bug-Modifier: Gilad Reti (giladreti)
&gt; Launchpad-Message-Rationale: Subscriber
&gt; Launchpad-Message-For: anonymouse67
&gt;
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/22" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~giladreti" class="sprite person">Gilad Reti (giladreti)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-27T09:36:35.888079+00:00" title="2021-01-27 09:36:35 UTC">on 2021-01-27</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/snapd/+bug/1910456/comments/22">
                <strong>Re: container management snaps should have Delegates=true in their systemd unit</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/22"> #22</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hello all,<br />
We intend to publish a blogpost regarding this bug after your CRD is out.<br />
@alexmurray, can you please confirm our CVSS vector?</p>
<p>Thanks again</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hello all,
We intend to publish a blogpost regarding this bug after your CRD is out.
@alexmurray, can you please confirm our CVSS vector?

Thanks again</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
    
    <time title="2021-01-27 22:49:30 UTC" datetime="2021-01-27T22:49:30.988017+00:00">on 2021-01-27</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
        - container management snaps should have Delegates=true in their systemd<br />+ container management snaps should have Delegate=true in their systemd<br />  unit
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/23" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alexmurray" class="sprite person">Alex Murray (alexmurray)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-29T04:19:50.131687+00:00" title="2021-01-29 04:19:50 UTC">on 2021-01-29</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/23"> #23</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@giladreti - so I have taken another look at the CVSS3.1 vector string you referenced above.</p>
<p>The threat in this case would appear to be from a malicious docker image or similar - would you agree? Given this, then I think the vector makes more sense as follows:</p>
<p>Attack Vector: Network<br />
Attack Complexity: Low<br />
Privileges Required: None<br />
User Interaction: None<br />
Scope: Changed<br />
Confidentiality: High<br />
Integrity: High<br />
Availability: High</p>
<p>The Attack Vector is from the Network since a malicious image has to be downloaded from dockerhub or similar</p>
<p>The Attack Complexity is Low since a malicious image is relatively easy to create</p>
<p>No special Privileges are Required other than what is normally provided to a docker container</p>
<p>There is no User Interaction required since as you state at some point it is quite likely the systemd will reload services and trigger this without any user interaction.</p>
<p>The Scope is changed since this then allows access to devices from the host system that were not originally part of the container&#x27;s device cgroup.</p>
<p>C/I/A as High is because from what I can tell the snap.docker.<wbr />dockerd.<wbr />service devices cgroup appears to allow access to all devices on the system:</p>
<p>$ sudo cat /sys/fs/<wbr />cgroup/<wbr />devices/<wbr />system.<wbr />slice/snap.<wbr />docker.<wbr />dockerd.<wbr />service/<wbr />devices.<wbr />list<br />
a *:* rwm</p>
<p>And so this would appear to allow the container then to have arbitrary read/write access to any device on the system, including the host filesystem etc.</p>
<p>This would then result in a CVSS 3.1 base score of 10.0</p>
<p>@anonymouse67 and others - does this seem to match with your understanding of the vulnerability as well?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@giladreti - so I have taken another look at the CVSS3.1 vector string you referenced above.

The threat in this case would appear to be from a malicious docker image or similar - would you agree? Given this, then I think the vector makes more sense as follows:

Attack Vector: Network
Attack Complexity: Low
Privileges Required: None
User Interaction: None
Scope: Changed
Confidentiality: High
Integrity: High
Availability: High

The Attack Vector is from the Network since a malicious image has to be downloaded from dockerhub or similar

The Attack Complexity is Low since a malicious image is relatively easy to create

No special Privileges are Required other than what is normally provided to a docker container

There is no User Interaction required since as you state at some point it is quite likely the systemd will reload services and trigger this without any user interaction.

The Scope is changed since this then allows access to devices from the host system that were not originally part of the container's device cgroup.

C/I/A as High is because from what I can tell the snap.docker.dockerd.service devices cgroup appears to allow access to all devices on the system:

$ sudo cat /sys/fs/cgroup/devices/system.slice/snap.docker.dockerd.service/devices.list 
a *:* rwm

And so this would appear to allow the container then to have arbitrary read/write access to any device on the system, including the host filesystem etc.

This would then result in a CVSS 3.1 base score of 10.0 

@anonymouse67 and others - does this seem to match with your understanding of the vulnerability as well?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/24" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alexmurray" class="sprite person">Alex Murray (alexmurray)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-29T07:04:00.830517+00:00" title="2021-01-29 07:04:00 UTC">on 2021-01-29</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/24"> #24</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@giladreti - actually I have thought about this some more and consulted with others and we feel that the most appropriate CVSS vector would be: CVSS:3.<wbr />1/AV:L/<wbr />AC:L/PR:<wbr />L/UI:N/<wbr />S:C/C:H/<wbr />I:H/A:H</p>
<p>ie. compared to my previous post above I have changed the following:</p>
<p>Attack Vector: Local since if you have a docker container already executing that you have control of (as the attacker) then this is local access.</p>
<p>Privilege Required: Low - since this does not need to be a privileged docker container but it does need some privileges so that it is actually runnning etc</p>
<p>this gives a CVSS base score of 8.8</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@giladreti - actually I have thought about this some more and consulted with others and we feel that the most appropriate CVSS vector would be: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H

ie. compared to my previous post above I have changed the following:

Attack Vector: Local since if you have a docker container already executing that you have control of (as the attacker) then this is local access.

Privilege Required: Low - since this does not need to be a privileged docker container but it does need some privileges so that it is actually runnning etc

this gives a CVSS base score of 8.8
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/25" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~giladreti" class="sprite person">Gilad Reti (giladreti)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-29T08:18:15.090440+00:00" title="2021-01-29 08:18:15 UTC">on 2021-01-29</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/25"> #25</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>First, @alexmurray, thanks for your response.<br />
Second, we believe that Privilege Required should be None. The running containerized process does not need any privileges on the host to take over it nor is authorized to perform any action on the vulnerable host. You can see the famous runC cve as a reference - <a rel="nofollow" href="https://nvd.nist.gov/vuln/detail/CVE-2019-5736">https:/<wbr />/nvd.nist.<wbr />gov/vuln/<wbr />detail/<wbr />CVE-2019-<wbr />5736</a> - although the exploit requires an attacker to sit inside a container it does not count as a required privilege since the vulnerable component is the host for which the attacker has no initial access.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">First, @alexmurray, thanks for your response.
Second, we believe that Privilege Required should be None. The running containerized process does not need any privileges on the host to take over it nor is authorized to perform any action on the vulnerable host. You can see the famous runC cve as a reference - https://nvd.nist.gov/vuln/detail/CVE-2019-5736 - although the exploit requires an attacker to sit inside a container it does not count as a required privilege since the vulnerable component is the host for which the attacker has no initial access. </textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/26" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-30T03:48:22.244285+00:00" title="2021-01-30 03:48:22 UTC">on 2021-01-30</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/26"> #26</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi Gilad and Alex, I tend to agree with Gilad here in that this bug has the same amount required privilege as the other runC CVE.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi Gilad and Alex, I tend to agree with Gilad here in that this bug has the same amount required privilege as the other runC CVE.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/27" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-01-30T04:17:32.337733+00:00" title="2021-01-30 04:17:32 UTC">on 2021-01-30</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/27"> #27</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Also, we need to request another extension of the CRD to one week later, to February 10th if no one objects.</p>
<p>Our reason for doing this is that we have actually found that our fix in snapd is not applied immediately to running containers and operators/users will need to restart their containers and snapd should not do this automatically. Instead, affected snaps should be refreshed after snapd has been refreshed, and this can be done by adding a small snippet to the snapcraft.yaml of the affected snaps, depending on whether the snap is strict or classic.</p>
<p>As such, we will need some time to communicate with all affected snap authors and coordinate them to release new versions of their snaps.</p>
<p>The specific change for strict snaps such as the docker snap that are affected is that a new revision should be uploaded to the store and released to the stable risk on all active tracks with no changes except to add this snippet to the snap.yaml (if just repacking the snap) or the snapcraft.yaml (if rebuilding the snap):</p>
<p>assumes: [snapd2.48.3]</p>
<p>This ensures that the snap will be automatically refreshed at the next refresh check after the device has been refreshed to snapd version 2.48.3 (which is the version of snapd which will contain the fix).</p>
<p>For affected classic snaps, the same assumes snippet should be added and additionally, all services which are managing containers, i.e. containerd, etc. should add to their plugs the kubernetes-support interface.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Also, we need to request another extension of the CRD to one week later, to February 10th if no one objects. 

Our reason for doing this is that we have actually found that our fix in snapd is not applied immediately to running containers and operators/users will need to restart their containers and snapd should not do this automatically. Instead, affected snaps should be refreshed after snapd has been refreshed, and this can be done by adding a small snippet to the snapcraft.yaml of the affected snaps, depending on whether the snap is strict or classic. 

As such, we will need some time to communicate with all affected snap authors and coordinate them to release new versions of their snaps.

The specific change for strict snaps such as the docker snap that are affected is that a new revision should be uploaded to the store and released to the stable risk on all active tracks with no changes except to add this snippet to the snap.yaml (if just repacking the snap) or the snapcraft.yaml (if rebuilding the snap):


assumes: [snapd2.48.3]


This ensures that the snap will be automatically refreshed at the next refresh check after the device has been refreshed to snapd version 2.48.3 (which is the version of snapd which will contain the fix). 


For affected classic snaps, the same assumes snippet should be added and additionally, all services which are managing containers, i.e. containerd, etc. should add to their plugs the kubernetes-support interface.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/28" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alexmurray" class="sprite person">Alex Murray (alexmurray)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-01T00:09:43.099629+00:00" title="2021-02-01 00:09:43 UTC">on 2021-02-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/28"> #28</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Re CVSS I can agree with this argument that Privileges Required: None - as such this leaves the CVSS vector as originally suggested by Gilad:</p>
<p>CVSS:3.<wbr />1/AV:L/<wbr />AC:L/PR:<wbr />N/UI:N/<wbr />S:C/C:H/<wbr />I:H/A:H</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Re CVSS I can agree with this argument that Privileges Required: None - as such this leaves the CVSS vector as originally suggested by Gilad:

CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/29" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mvo" class="sprite person">Michael Vogt (mvo)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-01T11:26:23.510109+00:00" title="2021-02-01 11:26:23 UTC">on 2021-02-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/29"> #29</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Here is my proposed changelog for the snapd source deb:</p>
<p>&quot;&quot;&quot;<br />
&nbsp;&nbsp;* SECURITY UPDATE: sandbox escape vulnerability for containers<br />
&nbsp;&nbsp;&nbsp;&nbsp;- many: add Delegate=true to generated systemd units for special<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interfaces<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2020-27352<br />
&nbsp;&nbsp;&nbsp;&nbsp;- LP: <a href="/bugs/1910456" class="bug-link">#1910456</a><br />
&quot;&quot;&quot;</p>
<p>Please double check, I will then attach the debdiffs for xenial,<wbr />bionic,<wbr />focal,groovy and prepare the private snapd/core snap builds.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Here is my proposed changelog for the snapd source deb:

"""
  * SECURITY UPDATE: sandbox escape vulnerability for containers
    - many: add Delegate=true to generated systemd units for special
      interfaces
    - CVE-2020-27352
    - LP: #1910456
"""

Please double check, I will then attach the debdiffs for xenial,bionic,focal,groovy and prepare the private snapd/core snap builds.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/30" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mvo" class="sprite person">Michael Vogt (mvo)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-01T12:06:22.343183+00:00" title="2021-02-01 12:06:22 UTC">on 2021-02-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/30"> #30</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Ian asked me to also pull in: <a rel="nofollow" href="https://github.com/snapcore/snapd/pull/9764">https:/<wbr />/github.<wbr />com/snapcore/<wbr />snapd/pull/<wbr />9764</a> to 2.48.3 to support the other docker CVE fix. With that the new changelog suggestion would be:</p>
<p>``<br />
+snapd (2.48.3) UNRELEASED; urgency=medium<br />
+<br />
+  * SECURITY UPDATE: sandbox escape vulnerability for containers<br />
+    - many: add Delegate=true to generated systemd units for special<br />
+      interfaces<br />
+    - CVE-2020-27352<br />
+    - LP: <a href="/bugs/1910456" class="bug-link">#1910456</a><br />
+  * interfaces/<wbr />builtin/<wbr />docker-<wbr />support: allow /run/containerd<wbr />/s/...<br />
+    - This is a new path that docker 19.03.14 (with a new version of<br />
+      containerd) uses to avoid containerd CVE issues around the unix<br />
+      socket. See also CVE-2020-15257.<br />
+<br />
+ -- Michael Vogt &lt;email address hidden&gt;  Mon, 01 Feb 2021 11:55:18 +0100<br />
```</p>
<p>Please let me know if this looks good, if so I will prepare debdiffs/snaps.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Ian asked me to also pull in: https://github.com/snapcore/snapd/pull/9764 to 2.48.3 to support the other docker CVE fix. With that the new changelog suggestion would be:

``
+snapd (2.48.3) UNRELEASED; urgency=medium
+
+  * SECURITY UPDATE: sandbox escape vulnerability for containers
+    - many: add Delegate=true to generated systemd units for special
+      interfaces
+    - CVE-2020-27352
+    - LP: #1910456
+  * interfaces/builtin/docker-support: allow /run/containerd/s/...
+    - This is a new path that docker 19.03.14 (with a new version of
+      containerd) uses to avoid containerd CVE issues around the unix
+      socket. See also CVE-2020-15257.
+
+ -- Michael Vogt &lt;michael.vogt@ubuntu.com&gt;  Mon, 01 Feb 2021 11:55:18 +0100
```

Please let me know if this looks good, if so I will prepare debdiffs/snaps.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/31" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alexmurray" class="sprite person">Alex Murray (alexmurray)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-01T23:42:11.447663+00:00" title="2021-02-01 23:42:11 UTC">on 2021-02-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/31"> #31</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@mvo - per <a rel="nofollow" href="https://wiki.ubuntu.com/SecurityTeam/UpdatePreparation">https:/<wbr />/wiki.ubuntu.<wbr />com/SecurityTea<wbr />m/UpdatePrepara<wbr />tion</a> this looks pretty good - we usually tend to put the LP bug in parentheses at the end of the SECURITY UPDATE line rather than as a separate sub-item but I don&#x27;t think this is crucial - if you have already started preparing debdiffs etc then that is fine to leave as is. Thanks.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@mvo - per https://wiki.ubuntu.com/SecurityTeam/UpdatePreparation this looks pretty good - we usually tend to put the LP bug in parentheses at the end of the SECURITY UPDATE line rather than as a separate sub-item but I don't think this is crucial - if you have already started preparing debdiffs etc then that is fine to leave as is. Thanks.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/32" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mvo" class="sprite person">Michael Vogt (mvo)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-02T08:51:07.436498+00:00" title="2021-02-02 08:51:07 UTC">on 2021-02-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/32"> #32</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a href="https://bugs.launchpad.net/snapd/+bug/1910456/+attachment/5459018/+files/snapd_2.48.3.debdiff" class="sprite haspatch-icon">debdiff for 2.48.2->2.48.3</a>
        <a class="sprite edit action-icon" href="/snapd/+bug/1910456/+attachment/5459018">Edit</a>
        
        (72.6 KiB,
        text/plain)
        
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This is the xenial debdiff for 2.48.2. Unfortunately 2.48 is the version in *-updates. The 2.48.2 version is in the ~snappy-dev/image PPA here <a rel="nofollow" href="https://launchpad.net/~snappy-dev/+archive/ubuntu/image/+sourcepub/11828035/+listing-archive-extra">https:/<wbr />/launchpad.<wbr />net/~snappy-<wbr />dev/+archive/<wbr />ubuntu/<wbr />image/+<wbr />sourcepub/<wbr />11828035/<wbr />+listing-<wbr />archive-<wbr />extra</a></p>
<p>I can either create a debdiff against 2.48 or upload the package to a private fileshare or a private PPA, whatever you guys prefer.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This is the xenial debdiff for 2.48.2. Unfortunately 2.48 is the version in *-updates. The 2.48.2 version is in the ~snappy-dev/image PPA here https://launchpad.net/~snappy-dev/+archive/ubuntu/image/+sourcepub/11828035/+listing-archive-extra

I can either create a debdiff against 2.48 or upload the package to a private fileshare or a private PPA, whatever you guys prefer. </textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in snapd: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; In Progress
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/33" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mvo" class="sprite person">Michael Vogt (mvo)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-02T09:06:55.443678+00:00" title="2021-02-02 09:06:55 UTC">on 2021-02-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/33"> #33</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I uploaded all packages signed and ready to push into the private drive <a rel="nofollow" href="https://drive.google.com/drive/folders/1_PkBI8MwWSBWErXCu66vGIAYcckCzulL?usp=sharing">https:/<wbr />/drive.<wbr />google.<wbr />com/drive/<wbr />folders/<wbr />1_PkBI8MwWSBWEr<wbr />XCu66vGIAYcckCz<wbr />ulL?usp=<wbr />sharing</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I uploaded all packages signed and ready to push into the private drive https://drive.google.com/drive/folders/1_PkBI8MwWSBWErXCu66vGIAYcckCzulL?usp=sharing</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/34" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~giladreti" class="sprite person">Gilad Reti (giladreti)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-02T11:17:57.995876+00:00" title="2021-02-02 11:17:57 UTC">on 2021-02-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/34"> #34</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@anonymouse67 another week is fine by us.</p>
<p>Also, will any of you like to read our blog post before we publish it? We intend to publish it when your CRD is out.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@anonymouse67 another week is fine by us.

Also, will any of you like to read our blog post before we publish it? We intend to publish it when your CRD is out.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/35" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alexmurray" class="sprite person">Alex Murray (alexmurray)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-02T23:49:48.078074+00:00" title="2021-02-02 23:49:48 UTC">on 2021-02-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/35"> #35</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Gilad, I would definitely be interested in reading your blog post in advance if possible? Thanks.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Gilad, I would definitely be interested in reading your blog post in advance if possible? Thanks.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/36" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~giladreti" class="sprite person">Gilad Reti (giladreti)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-03T14:11:57.711643+00:00" title="2021-02-03 14:11:57 UTC">on 2021-02-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/36"> #36</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a href="https://bugs.launchpad.net/snapd/+bug/1910456/+attachment/5459419/+files/strange%20case%20of%20jekyll%20and%20hyde_NS9_GR3_LL.docx" class="sprite download-icon">strange case of jekyll and hyde_NS9_GR3_LL.docx</a>
        <a class="sprite edit action-icon" href="/snapd/+bug/1910456/+attachment/5459419">Edit</a>
        
        (60.7 KiB,
        application/vnd.openxmlformats-officedocument.wordprocessingml.document)
        
      </li>
    </ul>

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I am attaching latest blog post version. Feel free to make any comments.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I am attaching latest blog post version. Feel free to make any comments.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/37" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alexmurray" class="sprite person">Alex Murray (alexmurray)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-05T03:36:50.782158+00:00" title="2021-02-05 03:36:50 UTC">on 2021-02-05</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/37"> #37</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  <a href="https://bugs.launchpad.net/snapd/+bug/1910456/comments/37/+download">Download full text</a> (3.6 KiB)
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Gilad, thanks for sharing that - there are just a couple changes that would help clarify this:</p>
<p>Replace:</p>
<p>&nbsp;&nbsp;This issue was a result of bad configurations in Canonical’s snap</p>
<p>With:</p>
<p>&nbsp;&nbsp;This issue was a result of bad configurations generated by Canonical’s snapd</p>
<p>Also in regards to the following part:</p>
<p>&nbsp;&nbsp;If you are using snap with any of these packages it is recommended that you upgrade your system immediately.</p>
<p>You may not know, but by default snaps automatically refresh to the latest version every 4 hours. So there is no manual step a user needs to take to &#x27;upgrade their system immediately&#x27; as in most cases they will have automatically refreshed to the fixed version by the time they read this blog post - if they want to ensure they have refreshed to this version though they can run `snap refresh` to force it to happen immediately.</p>
<p>Also I think the following part is a bit unclear:</p>
<p>-------</p>
<p>&nbsp;&nbsp;When installing a service through Snap, Snap forwards the service registration requests to systemd and registers it as a service under the following name structure:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;snap.<wbr />&lt;package_<wbr />name&gt;.&lt;<wbr />service_<wbr />name&gt;.service</p>
<p>&nbsp;&nbsp;When snap registered the dockerd service, the Docker Snap package did not request a systemd’s cgroup delegation, leaving the cgroup management in the hands of systemd. Moreover, the Snap daemon (snapd) did not expose this option to packages installed via Snap at all, thus any service installed via Snap had its cgroups managed by systemd. In particular, Docker, when installed via Snap, is vulnerable to this escape.</p>
<p>---</p>
<p>So to clarify this I&#x27;ll explain how snapd works with systemd - when a snap is installed that contains a daemon, snapd generates a systemd unit file on behalf of the snap daemon. In this case, since snapd had no awareness of/support for the Delegate property of systemd units, there was no way for the docker snap to request this functionality. I just want to ensure it is clear that it is snapd that is at fault here, not the snaps like Docker themselves.</p>
<p>As such you should then also change the following bit:</p>
<p>&nbsp;&nbsp;Due to a bug in Snap’s Docker package, the Docker daemon is no longer allowed to manage cgroups for its containers, while systemd is taking ownership of the containers’ cgroups, to cause a misconfiguration.</p>
<p>To instead be something like:</p>
<p>&nbsp;&nbsp;Due to this missing feature in snapd, the docker snap is not able to indicate to systemd that it will manage cgroups on behalf of its containers itself, and so systemd takes ownership of these cgroups, resulting in this misconfiguration.</p>
<p>Also there are easier ways to trigger apport to run on the host than having to write a program which causes a segmentation fault - instead you can just send the SIGSEGV (or SIGABORT) to an existing process - ie running the following from a terminal will cause Apport to be spawned:</p>
<p>&nbsp;bash -c &#x27;kill -SIGABRT $$&#x27;</p>
<p>Finally, I think the conclusion is a bit sensationalist - given that snaps auto-refresh (including snapd itself), the majority of users will have their snapd updated and hence patched against this vulnerabilility automatically. Also this only affects users of either the docker snap or other snaps which are container managers like the ...</p></div>
    
    <p>
      <a href="/snapd/+bug/1910456/comments/37">Read more...</a>
    </p>
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Gilad, thanks for sharing that - there are just a couple changes that would help clarify this:

Replace:

  This issue was a result of bad configurations in Canonical’s snap

With:

  This issue was a result of bad configurations generated by Canonical’s snapd



Also in regards to the following part:

  If you are using snap with any of these packages it is recommended that you upgrade your system immediately.


You may not know, but by default snaps automatically refresh to the latest version every 4 hours. So there is no manual step a user needs to take to 'upgrade their system immediately' as in most cases they will have automatically refreshed to the fixed version by the time they read this blog post - if they want to ensure they have refreshed to this version though they can run `snap refresh` to force it to happen immediately.


Also I think the following part is a bit unclear:

-------

  When installing a service through Snap, Snap forwards the service registration requests to systemd and registers it as a service under the following name structure:

    snap.&lt;package_name&gt;.&lt;service_name&gt;.service

  When snap registered the dockerd service, the Docker Snap package did not request a systemd’s cgroup delegation, leaving the cgroup management in the hands of systemd. Moreover, the Snap daemon (snapd) did not expose this option to packages installed via Snap at all, thus any service installed via Snap had its cgroups managed by systemd. In particular, Docker, when installed via Snap, is vulnerable to this escape.

---

So to clarify this I'll explain how snapd works with systemd - when a snap is installed that contains a daemon, snapd generates a systemd unit file on behalf of the snap daemon. In this case, since snapd had no awareness of/support for the Delegate property of systemd units, there was no way for the docker snap to request this functionality. I just want to ensure it is clear that it is snapd that is at fault here, not the snaps like Docker themselves.


As such you should then also change the following bit:

  Due to a bug in Snap’s Docker package, the Docker daemon is no longer allowed to manage cgroups for its containers, while systemd is taking ownership of the containers’ cgroups, to cause a misconfiguration. 


To instead be something like:

  Due to this missing feature in snapd, the docker snap is not able to indicate to systemd that it will manage cgroups on behalf of its containers itself, and so systemd takes ownership of these cgroups, resulting in this misconfiguration.




Also there are easier ways to trigger apport to run on the host than having to write a program which causes a segmentation fault - instead you can just send the SIGSEGV (or SIGABORT) to an existing process - ie running the following from a terminal will cause Apport to be spawned:

 bash -c 'kill -SIGABRT $$'


Finally, I think the conclusion is a bit sensationalist - given that snaps auto-refresh (including snapd itself), the majority of users will have their snapd updated and hence patched against this vulnerabilility automatically. Also this only affects users of either the docker snap or other snaps which are container managers like the few mentioned in your opening - of these the docker snap is the most widely deployed but even it doesn't have millions of users - the real number is an order of magnitude lower than this. 

So this doesn't affect everyone using snaps, only those using the docker snap etc *and* who may be running untrusted/malicious containers. If you are running trusted workloads as docker containers then there is no risk from this vulnerability.


Thanks again for sharing this ahead of the CRD, I really appreciate it.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/38" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~giladreti" class="sprite person">Gilad Reti (giladreti)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-07T12:13:04.620315+00:00" title="2021-02-07 12:13:04 UTC">on 2021-02-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/38"> #38</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks @alexmurray for your helpful comments. We would be glad if you will be able to clarify some things:<br />
1. Regarding the numbers of affected systems - we wouldn&#x27;t want to overestimate the numbers of course. The numbers that appear in the blogpost are rough estimates done by us, based on the numbers of ubuntu users etc. If you have better numbers or estimates (including the other products (greengrass, microk8s, etc) too that would be great and we would like to replace our estimates with it.<br />
2. Speaking of aws greengrass, we contacted aws too before publishing the blogpost. They insist that only the v1 package is affected which is deprecated, and that greengrass v2 is not vulnerable to this CVE. Is that true?</p>
<p>Thanks.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks @alexmurray for your helpful comments. We would be glad if you will be able to clarify some things:
1. Regarding the numbers of affected systems - we wouldn't want to overestimate the numbers of course. The numbers that appear in the blogpost are rough estimates done by us, based on the numbers of ubuntu users etc. If you have better numbers or estimates (including the other products (greengrass, microk8s, etc) too that would be great and we would like to replace our estimates with it.
2. Speaking of aws greengrass, we contacted aws too before publishing the blogpost. They insist that only the v1 package is affected which is deprecated, and that greengrass v2 is not vulnerable to this CVE. Is that true?

Thanks.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/39" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alexmurray" class="sprite person">Alex Murray (alexmurray)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-08T00:01:48.942729+00:00" title="2021-02-08 00:01:48 UTC">on 2021-02-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/39"> #39</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Yes the aws-iot-greengrass snap has 2 different tracks:</p>
<p>$ snap info aws-iot-greengrass<br />
...<br />
channels:<br />
&nbsp;&nbsp;latest/stable:    1.11.0 2020-12-30 (44) 111MB -<br />
&nbsp;&nbsp;latest/candidate: 1.11.0 2020-12-30 (44) 111MB -<br />
&nbsp;&nbsp;latest/beta:      1.11.0 2020-12-30 (44) 111MB -<br />
&nbsp;&nbsp;latest/edge:      1.11.0 2020-12-30 (44) 111MB -<br />
&nbsp;&nbsp;1.8.x/stable:     1.8.4  2020-12-30  (4)  98MB -<br />
&nbsp;&nbsp;1.8.x/candidate:  1.8.4  2020-12-30  (4)  98MB -<br />
&nbsp;&nbsp;1.8.x/beta:       ↑<br />
&nbsp;&nbsp;1.8.x/edge:       ↑</p>
<p>Only the 1.8.x snap uses one of the snapd interfaces which is affected by this bug - and this is deprecated. If a user goes to install this snap now, it will install from the the &#x27;latest&#x27; channel and this version does not use an affected interface and so those users are not affected by this bug.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Yes the aws-iot-greengrass snap has 2 different tracks:

$ snap info aws-iot-greengrass
...
channels:
  latest/stable:    1.11.0 2020-12-30 (44) 111MB -
  latest/candidate: 1.11.0 2020-12-30 (44) 111MB -
  latest/beta:      1.11.0 2020-12-30 (44) 111MB -
  latest/edge:      1.11.0 2020-12-30 (44) 111MB -
  1.8.x/stable:     1.8.4  2020-12-30  (4)  98MB -
  1.8.x/candidate:  1.8.4  2020-12-30  (4)  98MB -
  1.8.x/beta:       ↑                            
  1.8.x/edge:       ↑                            


Only the 1.8.x snap uses one of the snapd interfaces which is affected by this bug - and this is deprecated. If a user goes to install this snap now, it will install from the the 'latest' channel and this version does not use an affected interface and so those users are not affected by this bug.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/40" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~giladreti" class="sprite person">Gilad Reti (giladreti)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-10T20:43:23.926294+00:00" title="2021-02-10 20:43:23 UTC">on 2021-02-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/40"> #40</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hey all.<br />
We would like to have your assistance in to things:<br />
1. We would be glad if any if you can credit CyberArk Labs too, something like &quot;Gilad Reti and Nimrod Stoler from CyberArk Labs&quot;.<br />
2. Are you aware of any other products affected by this bug? Other than microk8s, Azure IoT Edge, AWS IoT Greengrass. We will need those before posting our blogpost, for legal reasons.</p>
<p>Thank you very much and sorry for the inconvenience.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hey all.
We would like to have your assistance in to things:
1. We would be glad if any if you can credit CyberArk Labs too, something like "Gilad Reti and Nimrod Stoler from CyberArk Labs".
2. Are you aware of any other products affected by this bug? Other than microk8s, Azure IoT Edge, AWS IoT Greengrass. We will need those before posting our blogpost, for legal reasons.

Thank you very much and sorry for the inconvenience. </textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/41" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alexmurray" class="sprite person">Alex Murray (alexmurray)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-11T00:47:36.687450+00:00" title="2021-02-11 00:47:36 UTC">on 2021-02-11</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/41"> #41</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi Gilad, our policy is to credit individuals, not companies, so I have updated the CVE and USN to add Nimrod as well.</p>
<p>As far as other affected products, the Azure IoT Edge snap is not publicly available to my knowledge so I don&#x27;t think this is as relevant. The affected snaps from the public <a rel="nofollow" href="https://snapcraft.io">https:/<wbr />/snapcraft.<wbr />io</a> store are docker, kubernetes-worker, aws-iot-greengrass (1.8.x only) and microk8s.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi Gilad, our policy is to credit individuals, not companies, so I have updated the CVE and USN to add Nimrod as well.

As far as other affected products, the Azure IoT Edge snap is not publicly available to my knowledge so I don't think this is as relevant. The affected snaps from the public https://snapcraft.io store are docker, kubernetes-worker, aws-iot-greengrass (1.8.x only) and microk8s.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/42" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~giladreti" class="sprite person">Gilad Reti (giladreti)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-15T13:02:43.153336+00:00" title="2021-02-15 13:02:43 UTC">on 2021-02-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/42"> #42</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi @alexmurray, sorry for bothering you again.<br />
Is the &quot;priority&quot; that appear on your site is the CVSS priority, or some inhouse scale?<br />
Thanks, and sorry again. We will publish our blogpost in the next couple of days, currently we are facing some legal issues.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi @alexmurray, sorry for bothering you again.
Is the "priority" that appear on your site is the CVSS priority, or some inhouse scale?
Thanks, and sorry again. We will publish our blogpost in the next couple of days, currently we are facing some legal issues. </textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/43" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-15T22:06:06.388813+00:00" title="2021-02-15 22:06:06 UTC">on 2021-02-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/43"> #43</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This was technically &quot;Fix Released&quot; with 2.48.3, but I can&#x27;t seem to create that milestone in LP so I used 2.49 instead (which does exist)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This was technically "Fix Released" with 2.48.3, but I can't seem to create that milestone in LP so I used 2.49 instead (which does exist)</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in snapd: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>milestone</b>:
      </td>
      <td>
        none &#8594; 2.49
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/44" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alexmurray" class="sprite person">Alex Murray (alexmurray)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-02-15T23:40:26.112112+00:00" title="2021-02-15 23:40:26 UTC">on 2021-02-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/44"> #44</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Gilad, the priority you see on <a rel="nofollow" href="https://ubuntu.com/security/CVE-2020-27352">https:/<wbr />/ubuntu.<wbr />com/security/<wbr />CVE-2020-<wbr />27352</a> as &#x27;high&#x27; is our own teams priority - we take CVSS into account when assigning this but this is not the only factor we consider - see <a rel="nofollow" href="https://people.canonical.com/~ubuntu-security/priority.html">https:/<wbr />/people.<wbr />canonical.<wbr />com/~ubuntu-<wbr />security/<wbr />priority.<wbr />html</a> for more technical detail on this priority score and <a rel="nofollow" href="https://ubuntu.com/blog/securing-open-source-through-cve-prioritisation">https:/<wbr />/ubuntu.<wbr />com/blog/<wbr />securing-<wbr />open-source-<wbr />through-<wbr />cve-prioritisat<wbr />ion</a> for some wider discussion on how we assign priority etc.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Gilad, the priority you see on https://ubuntu.com/security/CVE-2020-27352 as 'high' is our own teams priority - we take CVSS into account when assigning this but this is not the only factor we consider - see https://people.canonical.com/~ubuntu-security/priority.html for more technical detail on this priority score and https://ubuntu.com/blog/securing-open-source-through-cve-prioritisation for some wider discussion on how we assign priority etc.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/45" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~seth-arnold" class="sprite person">Seth Arnold (seth-arnold)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-05-18T16:18:09.241784+00:00" title="2021-05-18 16:18:09 UTC">on 2021-05-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/45"> #45</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Is there a reason to keep this bug private? I&#x27;m curious if this is related to <a rel="nofollow" href="https://bugs.launchpad.net/charm-kubernetes-master/+bug/1928806">https:/<wbr />/bugs.launchpad<wbr />.net/charm-<wbr />kubernetes-<wbr />master/<wbr />+bug/1928806</a> and this bug being private makes it awkward to suggest the connection in that bug.</p>
<p>Thanks</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Is there a reason to keep this bug private? I'm curious if this is related to https://bugs.launchpad.net/charm-kubernetes-master/+bug/1928806 and this bug being private makes it awkward to suggest the connection in that bug.

Thanks</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/snapd/+bug/1910456/comments/46" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~anonymouse67" class="sprite person">Ian Johnson (anonymouse67)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-05-18T16:59:40.934257+00:00" title="2021-05-18 16:59:40 UTC">on 2021-05-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/snapd/+bug/1910456/comments/46"> #46</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Seth, personally I was waiting for the security team to make this bug public after the CRD, now that that has happened, this can surely be made public.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Seth, personally I was waiting for the security team to make this bug public after the CRD, now that that has happened, this can surely be made public.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>information type</b>:
      </td>
      <td>
        Private Security &#8594; Public Security
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        <div style="float: right;">
          <a class="menu-link-activitylog" href="https://bugs.launchpad.net/snapd/+bug/1910456/+activity">See full activity log</a>
        </div>
        <div class="clearfix"></div>

        
          

          
            <div align="center" id="add-comment-login-first">
              To post a comment you must <a href="+login?comments=all">log in</a>.
            </div>
          
        
        
      

      </div><!-- class="top-portlet" -->
      </div><!--- id="maincontentsub"-->
      <div>
        <div id="duplicate-form-container"></div>
        <div id="privacy-form-container"></div>
      </div>
    </div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            
      <div id="involvement" class="portlet">
        <ul class="involvement">
          <li class="single">
            <a class="sprite bugs" href="/snapd/+filebug">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <div id="privacy" class="first portlet public">
  <div id="privacy-text">
     <span id="information-type-summary" class="sprite public">This report contains
         <strong id="information-type">Public Security</strong>
         information
     </span>&nbsp;

     <div id="information-type-description" style="padding-top: 5px">Everyone can see this security related information.
</div>
  </div>
</div>

      <div id="portlet-actions" class="portlet vertical">
  <ul id="duplicate-actions">
    
    
    
    
    
    
    
  </ul>
  <ul id="lock-status-actions">
    
  </ul>
</div>

      <div class="portlet" id="portlet-duplicates">
  <h2>Duplicates of this bug</h2>
  <ul>
  </ul>
</div>

      <div class="portlet vertical" id="portlet-subscription">
  <div class="section">
    <div id="current_user_subscription" class="False">
      
        <span>You are</span>
        
        <a class="menu-link-subscription sprite modify edit" href="/snapd/+bug/1910456/+subscribe">
           
           
           
           not directly subscribed to this bug's notifications.
        </a>
      
      
    </div>
    <div id="sub-unsub-spinner">Subscribing...</div>
    <ul>
      
      <li><a class="menu-link-editsubscriptions sprite modify edit" href="https://bugs.launchpad.net/snapd/+bug/1910456/+subscriptions" title="View and change your subscriptions to this bug">Edit bug mail</a></li>
    </ul>
  </div>
  <script type="text/javascript">
    LPJS.use('io-base', 'node',
            'lp.bugs.bugtask_index.portlets.subscription', function(Y) {
        Y.on('domready', function() {
            Y.lp.bugs.bugtask_index.portlets.subscription.initialize();
        });
    });
  </script>
</div>

      <div class="portlet vertical" id="portlet-subscribers">
  <h2>Other bug subscribers</h2>
  <div>
    <div><a class="menu-link-addsubscriber sprite add" href="https://bugs.launchpad.net/snapd/+bug/1910456/+addsubscriber" title="Launchpad will email that person whenever this bugs changes">Subscribe someone else</a></div>
  </div>
  <div id="other-bug-subscribers"></div>
</div>

      

      

      
  <div class="portlet" id="portlet-patches">
    <h2>Patches</h2>
    <ul>
      <li class="download-attachment">
        <a href="https://bugs.launchpad.net/snapd/+bug/1910456/+attachment/5459018/+files/snapd_2.48.3.debdiff" class="sprite haspatch-icon">debdiff for 2.48.2->2.48.3</a>
        <a class="sprite edit action-icon" title="Change patch details" href="/snapd/+bug/1910456/+attachment/5459018">Edit</a>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/snapd/+bug/1910456/+addcomment?field.patch=on">Add patch</a>
      </li>
    </ul>
  </div>
  <div class="portlet" id="portlet-attachments">
    <h2>Bug attachments</h2>
    <ul>
      <li class="download-attachment">
        <a href="https://bugs.launchpad.net/snapd/+bug/1910456/+attachment/5459419/+files/strange%20case%20of%20jekyll%20and%20hyde_NS9_GR3_LL.docx" class="sprite download-icon">strange case of jekyll and hyde_NS9_GR3_LL.docx</a>
        <a class="sprite edit action-icon" title="Change attachment details" href="/snapd/+bug/1910456/+attachment/5459419">Edit</a>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/snapd/+bug/1910456/+addcomment">Add attachment</a>
      </li>
    </ul>
  </div>


      <div class="portlet" id="portlet-watches">
  <h2>Remote bug watches</h2>
  <ul>
    <li>
      <span class="sprite bug-remote"></span>
      <a class="link-external" href="https://github.com/lxc/lxc/issues/323">lxc #323</a>
      
        <br />[<span>closed Bug</span>]
        <a class="sprite edit action-icon" title="Change watch details" href="/bugs/1910456/+watch/141714">Edit</a>
    </li>
  </ul>
  <p>Bug watches keep track of this bug in other bug trackers.</p>
</div>

    
          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-footer-logo.svg" alt="Launchpad" width="65" height="18" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://ubuntu.social/@launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        6394e03
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"related_features": {}, "bug": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1910456", "web_link": "https://bugs.launchpad.net/bugs/1910456", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug", "id": 1910456, "private": false, "information_type": "Public Security", "name": null, "title": "container management snaps should have Delegate=true in their systemd unit", "description": "As reported to the ubuntu security team, and discussed in https://github.com/docker-snap/docker-snap/security/advisories/GHSA-798c-v3jq-h646, the docker snap's systemd unit for the dockerd process should have Delegate=true in it to prevent systemd from reaping the control groups for child processes (which in this case are docker containers that are put into control groups which are separate from the the docker snap) and moving the child processes back into the same control group as the parent process that systemd is managing, which is dockerd. \n\nMore concretely, not including Delegate=true in the systemd service file means that after a systemctl daemon-reload is executed, docker containers now have the same privilege level as dockerd, which is a privilege escalation. \n\nThis was assigned CVE-2020-27352 by Alex Murray.\n\nI have opened this private snapd bug, because this vulnerability affects more than just the docker snap, it also affects any other container management snaps, such as microk8s, Azure IoT Edge, AWS IoT Greengrass and potentially others. The list of snaps affected can be narrowed down to any snap which has been granted privilege to use a \"container management\" interfaces, which are all super-privileged and require a snap store assertion in order to be uploaded to the Snap Store. The current list of affected interfaces is:\n\n- docker-support (all variants)\n- greengrass-support (with the \"legacy-containers\" flavor or with empty flavor)\n- kubernetes-support (with the \"kubelet\" flavor or with empty flavor)\n- lxd-support (though the LXD snap is not affected by this issue, we should fix the interface as if it was for consistencies sake) [1]\n\n[1] This vulnerability specifically does not affect LXD though (or at least it should not), because LXD is already using Delegate=true in it's own generated systemd setup, as shown in this segment of the snap packaging for LXD: https://github.com/lxc/lxd-pkg-snap/blob/latest-edge/snapcraft/commands/daemon.start#L308. See also https://github.com/lxc/lxc/issues/323 which is when the LXD project first encountered the issue with Delegate and systemd.", "owner_link": "https://bugs.launchpad.net/api/devel/~anonymouse67", "bug_tasks_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1910456/bug_tasks", "duplicate_of_link": null, "date_created": "2021-01-06T22:28:34.575734+00:00", "activity_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1910456/activity", "subscriptions_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1910456/subscriptions", "date_last_updated": "2021-05-18T16:59:58.573541+00:00", "who_made_private_link": null, "date_made_private": null, "heat": 290, "bug_watches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1910456/bug_watches", "cves_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1910456/cves", "vulnerabilities_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1910456/vulnerabilities", "duplicates_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1910456/duplicates", "attachments_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1910456/attachments", "security_related": true, "latest_patch_uploaded": "2021-02-02T08:51:07.436498+00:00", "tags": [], "date_last_message": "2021-05-18T16:59:40.934257+00:00", "number_of_duplicates": 1, "message_count": 47, "users_affected_count": 2, "users_unaffected_count": 0, "users_affected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1910456/users_affected", "users_unaffected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1910456/users_unaffected", "users_affected_count_with_dupes": 2, "other_users_affected_count_with_dupes": 2, "users_affected_with_dupes_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1910456/users_affected_with_dupes", "messages_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1910456/messages", "lock_status": "Unlocked", "lock_reason": null, "linked_branches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1910456/linked_branches", "linked_merge_proposals_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1910456/linked_merge_proposals", "http_etag": "\"cd924ffdfc379a0cbf9ec2af5bcb49ba375d331d-13ea7abf1a2f8a73fec455e2e687f129ea9cc71b\""}, "subscribers_portlet_url_data": {"web_link": "https://bugs.launchpad.net/bugs/1910456", "self_link": "https://bugs.launchpad.net/api/devel/bugs/1910456"}, "total_comments_and_activity": 72, "initial_comment_batch_offset": 41, "first visible_recent_comment": 6, "bugtask_data": {"2670669": {"id": 2670669, "row_id": "tasksummary2670669", "form_row_id": "task2670669", "bugtask_path": "/snapd/+bug/1910456", "prefix": "snapd", "targetname": "snapd", "bug_title": "container management snaps should have Delegate=true in their systemd unit", "assignee_value": "anonymouse67", "assignee_is_team": false, "assignee_vocabulary": "AllUserTeamsParticipation", "assignee_vocabulary_filters": [], "hide_assignee_team_selection": true, "user_can_unassign": false, "user_can_delete": false, "delete_link": "https://bugs.launchpad.net/snapd/+bug/1910456/+delete", "target_is_product": true, "status_widget_items": [{"name": "Fix Released", "value": "Fix Released", "description": "The fix was released.\n", "description_css_class": "choice-description", "style": "", "help": "", "disabled": false, "css_class": "statusFIXRELEASED"}], "status_value": "Fix Released", "importance_widget_items": "[]", "importance_value": "Critical", "milestone_widget_items": "[]", "milestone_value": "https://bugs.launchpad.net/api/devel/snapd/+milestone/2.49", "user_can_edit_assignee": false, "user_can_edit_milestone": false, "user_can_edit_status": false, "user_can_edit_importance": false}}, "information_type_data": {"PUBLIC": {"value": "PUBLIC", "description": "Everyone can see this information.\n", "name": "Public", "order": 0, "is_private": false, "description_css_class": "choice-description"}, "PUBLICSECURITY": {"value": "PUBLICSECURITY", "description": "Everyone can see this security related information.\n", "name": "Public Security", "order": 1, "is_private": false, "description_css_class": "choice-description"}, "PRIVATESECURITY": {"value": "PRIVATESECURITY", "description": "Only the security group can see this information.\n ", "name": "Private Security", "order": 2, "is_private": true, "description_css_class": "choice-description"}, "USERDATA": {"value": "USERDATA", "description": "Only shared with users permitted to see private user information.\n", "name": "Private", "order": 3, "is_private": true, "description_css_class": "choice-description"}}, "bug_is_private": false, "context": {"self_link": "https://bugs.launchpad.net/api/devel/snapd/+bug/1910456", "web_link": "https://bugs.launchpad.net/snapd/+bug/1910456", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug_task", "bug_link": "https://bugs.launchpad.net/api/devel/bugs/1910456", "milestone_link": "https://bugs.launchpad.net/api/devel/snapd/+milestone/2.49", "status": "Fix Released", "status_explanation": null, "importance": "Critical", "importance_explanation": null, "assignee_link": "https://bugs.launchpad.net/api/devel/~anonymouse67", "bug_target_display_name": "snapd", "bug_target_name": "snapd", "bug_watch_link": null, "date_assigned": "2021-01-06T22:28:35.115803+00:00", "date_created": "2021-01-06T22:28:34.575734+00:00", "date_confirmed": "2021-01-06T22:29:28.979769+00:00", "date_incomplete": null, "date_in_progress": "2021-02-02T08:51:30.891006+00:00", "date_closed": "2021-02-15T22:05:46.019264+00:00", "date_left_new": "2021-01-06T22:29:28.979769+00:00", "date_triaged": "2021-02-02T08:51:30.891006+00:00", "date_fix_committed": "2021-02-15T22:05:36.580421+00:00", "date_fix_released": "2021-02-15T22:05:46.019264+00:00", "date_left_closed": null, "owner_link": "https://bugs.launchpad.net/api/devel/~anonymouse67", "target_link": "https://bugs.launchpad.net/api/devel/snapd", "title": "Bug #1910456 in snapd: \"container management snaps should have Delegate=true in their systemd unit\"", "related_tasks_collection_link": "https://bugs.launchpad.net/api/devel/snapd/+bug/1910456/related_tasks", "is_complete": true, "http_etag": "\"d99d88cc15588ee5a9db9a36fe27a7e14708c173-98165a2cddfe3d270b2f3eef0483b11cdb5b86f1\""}};</script>

    
  

    
  </body>


  <!--
    Facet name: bugs
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 52 queries/external actions issued in 1.22 seconds

    Features: {'profiling.enabled': None, 'hard_timeout': '9000', 'app.mainsite_only.canonical_url': None, 'js.yui_version': None, 'app.maintenance_message': None, 'bugs.affected_count_includes_dupes.disabled': None, 'baselayout.careers_link.disabled': None, 'visible_render_time': None}

    r6394e03

    -->

</html>

