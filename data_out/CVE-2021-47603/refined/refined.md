The provided content relates to the following vulnerability:

**Root cause of vulnerability:**
The kernel's `kauditd_thread()` could get blocked when attempting to send audit records to the userspace audit daemon if the audit daemon was in a stopped state. This could cause the audit queue to grow unbounded, potentially leading to a deadlock.

**Weaknesses/vulnerabilities present:**
- The kernel thread's socket sending timeout was set to `MAX_SCHEDULE_TIMEOUT`, which could lead to blocking if the audit daemon was not responding.
- The `kauditd_send_queue()` function did not adequately manage audit queues during connection problems between the kernel and the audit daemon.

**Impact of exploitation:**
- A blocked kernel thread could cause an unbounded growth of the audit queue.
- Potential system deadlock.
- Slow system shutdown.

**Attack vectors:**
- Sending SIGSTOP to the audit daemon (requires root privileges).
- The system needs to be under heavy audit pressure, configured to audit every syscall to maximize the impact.

**Required attacker capabilities/position:**
- Root privileges to stop the audit daemon using SIGSTOP.
- Ability to generate a high volume of audit records, such as by auditing every syscall.