=== Content from github.com_b63de31b_20250110_160347.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fgitsign%2Fsecurity%2Fadvisories%2FGHSA-xvrc-2wvh-49vc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fgitsign%2Fsecurity%2Fadvisories%2FGHSA-xvrc-2wvh-49vc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=sigstore%2Fgitsign)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sigstore](/sigstore)
/
**[gitsign](/sigstore/gitsign)**
Public

generated from [sigstore/sigstore-project-template](/sigstore/sigstore-project-template)

* [Notifications](/login?return_to=%2Fsigstore%2Fgitsign) You must be signed in to change notification settings
* [Fork
  63](/login?return_to=%2Fsigstore%2Fgitsign)
* [Star
   963](/login?return_to=%2Fsigstore%2Fgitsign)

* [Code](/sigstore/gitsign)
* [Issues
  21](/sigstore/gitsign/issues)
* [Pull requests
  3](/sigstore/gitsign/pulls)
* [Discussions](/sigstore/gitsign/discussions)
* [Actions](/sigstore/gitsign/actions)
* [Projects
  0](/sigstore/gitsign/projects)
* [Security](/sigstore/gitsign/security)
* [Insights](/sigstore/gitsign/pulse)

Additional navigation options

* [Code](/sigstore/gitsign)
* [Issues](/sigstore/gitsign/issues)
* [Pull requests](/sigstore/gitsign/pulls)
* [Discussions](/sigstore/gitsign/discussions)
* [Actions](/sigstore/gitsign/actions)
* [Projects](/sigstore/gitsign/projects)
* [Security](/sigstore/gitsign/security)
* [Insights](/sigstore/gitsign/pulse)

# Rekor public keys fetched from upstream API instead of local TUF client.

Moderate

[wlynch](/wlynch)
published
GHSA-xvrc-2wvh-49vc
Nov 10, 2023

## Package

gomod

github.com/sigstore/gitsign
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

>=0.6.0

## Patched versions

v0.8.0

## Description

### Impact

In certain versions of gitsign, Rekor public keys were fetched via the Rekor API, instead of through the local TUF client. If the upstream Rekor server happened to be compromised, gitsign clients could potentially be tricked into trusting incorrect signatures.

There is no known compromise the default public good instance (`rekor.sigstore.dev`) - anyone using this instance is unlikely to be affected.

### Patches

This was fixed in v0.8.0 via [#399](https://github.com/sigstore/gitsign/pull/399)

### Workarounds

n/a

### References

*Are there any links users can visit to find out more?*

<https://docs.sigstore.dev/about/threat-model/#sigstore-threat-model>

### Severity

Moderate

4.2

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
High

User interaction
Required

Scope
Unchanged

Confidentiality
None

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:H/A:N

### CVE ID

CVE-2023-47122

### Weaknesses

No CWEs

### Credits

* [![@adityasaky](https://avatars.githubusercontent.com/u/8928778?s=40&v=4)](/adityasaky)
  [adityasaky](/adityasaky)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c978b87a_20250110_160347.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fgitsign%2Fpull%2F399)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fgitsign%2Fpull%2F399)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=sigstore%2Fgitsign)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sigstore](/sigstore)
/
**[gitsign](/sigstore/gitsign)**
Public

generated from [sigstore/sigstore-project-template](/sigstore/sigstore-project-template)

* [Notifications](/login?return_to=%2Fsigstore%2Fgitsign) You must be signed in to change notification settings
* [Fork
  63](/login?return_to=%2Fsigstore%2Fgitsign)
* [Star
   963](/login?return_to=%2Fsigstore%2Fgitsign)

* [Code](/sigstore/gitsign)
* [Issues
  21](/sigstore/gitsign/issues)
* [Pull requests
  3](/sigstore/gitsign/pulls)
* [Discussions](/sigstore/gitsign/discussions)
* [Actions](/sigstore/gitsign/actions)
* [Projects
  0](/sigstore/gitsign/projects)
* [Security](/sigstore/gitsign/security)
* [Insights](/sigstore/gitsign/pulse)

Additional navigation options

* [Code](/sigstore/gitsign)
* [Issues](/sigstore/gitsign/issues)
* [Pull requests](/sigstore/gitsign/pulls)
* [Discussions](/sigstore/gitsign/discussions)
* [Actions](/sigstore/gitsign/actions)
* [Projects](/sigstore/gitsign/projects)
* [Security](/sigstore/gitsign/security)
* [Insights](/sigstore/gitsign/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fsigstore%2Fgitsign%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fsigstore%2Fgitsign%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Add options for Rekor client, make public key fetcher configurable. #399

 Merged

[wlynch](/wlynch)
merged 1 commit into
[sigstore:main](/sigstore/gitsign/tree/main "sigstore/gitsign:main")
from
[wlynch:rekor-keys](/wlynch/gitsign/tree/rekor-keys "wlynch/gitsign:rekor-keys")

Nov 9, 2023

 Merged

# [Add options for Rekor client, make public key fetcher configurable.](#top) #399

[wlynch](/wlynch)
merged 1 commit into
[sigstore:main](/sigstore/gitsign/tree/main "sigstore/gitsign:main")
from
[wlynch:rekor-keys](/wlynch/gitsign/tree/rekor-keys "wlynch/gitsign:rekor-keys")

Nov 9, 2023

[Conversation
0](/sigstore/gitsign/pull/399)
[Commits
1](/sigstore/gitsign/pull/399/commits)
[Checks
8](/sigstore/gitsign/pull/399/checks)
[Files changed](/sigstore/gitsign/pull/399/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![wlynch](https://avatars.githubusercontent.com/u/1844673?s=60&v=4)](/wlynch)

Copy link

Member

### @wlynch **[wlynch](/wlynch)** commented [Nov 9, 2023](#issue-1986458781)

Also makes the default public key fetcher match the behavior of cosign, which also fixes a bug where verify was getting keys from Rekor directly.

#### Summary

Add options for Rekor client, make public key fetcher configurable.

Also makes the default public key fetcher match the behavior of cosign, which also fixes a bug where verify was getting keys from Rekor directly. s/o to [@adityasaky](https://github.com/adityasaky) for calling this out!

#### Release Note

* Gitsign now reads Rekor public keys directly from TUF root instead of from Rekor API.

#### Documentation

Sorry, something went wrong.

All reactions

 [![@wlynch](https://avatars.githubusercontent.com/u/1844673?s=40&u=608c2e4e3a71f0e7ddd59da1b0c551551c0a1bd1&v=4)](/wlynch)
[wlynch](/wlynch)
requested review from
[cpanato](/cpanato) and
[priyawadhwa](/priyawadhwa)
[November 9, 2023 21:51](#event-10918379487)

 [![@wlynch](https://avatars.githubusercontent.com/u/1844673?s=40&u=608c2e4e3a71f0e7ddd59da1b0c551551c0a1bd1&v=4)](/wlynch)
[wlynch](/wlynch)
[force-pushed](/sigstore/gitsign/compare/f4f22f1e4b0b0da11862e4bc173f76a553e29865..bbc7a08f7ff4d2e01e9da0499985138b9e2b2599)
the
rekor-keys

branch
from
[`f4f22f1`](/sigstore/gitsign/commit/f4f22f1e4b0b0da11862e4bc173f76a553e29865) to
[`bbc7a08`](/sigstore/gitsign/commit/bbc7a08f7ff4d2e01e9da0499985138b9e2b2599)  [Compare](/sigstore/gitsign/compare/f4f22f1e4b0b0da11862e4bc173f76a553e29865..bbc7a08f7ff4d2e01e9da0499985138b9e2b2599)
[November 9, 2023 21:57](#event-10918424499)

[![priyawadhwa](https://avatars.githubusercontent.com/u/10676490?s=60&v=4)](/priyawadhwa)

**[priyawadhwa](/priyawadhwa)**
previously approved these changes
[Nov 9, 2023](#pullrequestreview-1723575719)

 [View reviewed changes](/sigstore/gitsign/pull/399/files)

[![@wlynch](https://avatars.githubusercontent.com/u/1844673?s=40&v=4)](/wlynch)

`[Add options for Rekor client, make public key fetcher configurable.](/sigstore/gitsign/pull/399/commits/2b8e1cb7cbd4700beeaec3ca1fc83f53f0d167bf "Add options for Rekor client, make public key fetcher configurable.

Also makes the default public key fetcher match the behavior of cosign,
which also fixes a bug where verify was getting keys from Rekor
directly.

Signed-off-by: Billy Lynch <billy@chainguard.dev>")`
 …

`[2b8e1cb](/sigstore/gitsign/pull/399/commits/2b8e1cb7cbd4700beeaec3ca1fc83f53f0d167bf)`

```
Also makes the default public key fetcher match the behavior of cosign,
which also fixes a bug where verify was getting keys from Rekor
directly.

Signed-off-by: Billy Lynch <billy@chainguard.dev>
```

 [![@wlynch](https://avatars.githubusercontent.com/u/1844673?s=40&u=608c2e4e3a71f0e7ddd59da1b0c551551c0a1bd1&v=4)](/wlynch)
[wlynch](/wlynch)
dismissed
[priyawadhwa](/priyawadhwa)’s [stale review](#pullrequestreview-1723575719)
via
`[2b8e1cb](/sigstore/gitsign/commit/2b8e1cb7cbd4700beeaec3ca1fc83f53f0d167bf)`
[November 9, 2023 22:04](#event-10918469304)

 [![@wlynch](https://avatars.githubusercontent.com/u/1844673?s=40&u=608c2e4e3a71f0e7ddd59da1b0c551551c0a1bd1&v=4)](/wlynch)
[wlynch](/wlynch)
[force-pushed](/sigstore/gitsign/compare/bbc7a08f7ff4d2e01e9da0499985138b9e2b2599..2b8e1cb7cbd4700beeaec3ca1fc83f53f0d167bf)
the
rekor-keys

branch
from
[`bbc7a08`](/sigstore/gitsign/commit/bbc7a08f7ff4d2e01e9da0499985138b9e2b2599) to
[`2b8e1cb`](/sigstore/gitsign/commit/2b8e1cb7cbd4700beeaec3ca1fc83f53f0d167bf)  [Compare](/sigstore/gitsign/compare/bbc7a08f7ff4d2e01e9da0499985138b9e2b2599..2b8e1cb7cbd4700beeaec3ca1fc83f53f0d167bf)
[November 9, 2023 22:04](#event-10918469308)

 [![@wlynch](https://avatars.githubusercontent.com/u/1844673?s=40&u=608c2e4e3a71f0e7ddd59da1b0c551551c0a1bd1&v=4)](/wlynch)
[wlynch](/wlynch)
requested a review
from [priyawadhwa](/priyawadhwa)
[November 9, 2023 22:05](#event-10918481849)

[![priyawadhwa](https://avatars.githubusercontent.com/u/10676490?s=60&v=4)](/priyawadhwa)

**[priyawadhwa](/priyawadhwa)**
approved these changes
[Nov 9, 2023](#pullrequestreview-1723582197)

 [View reviewed changes](/sigstore/gitsign/pull/399/files/2b8e1cb7cbd4700beeaec3ca1fc83f53f0d167bf)

 Hide details
View details

[![@wlynch](https://avatars.githubusercontent.com/u/1844673?s=40&u=608c2e4e3a71f0e7ddd59da1b0c551551c0a1bd1&v=4)](/wlynch)
[wlynch](/wlynch)
merged commit [`cd66ccb`](/sigstore/gitsign/commit/cd66ccb03c86a3600955f0c15f6bfeb75f697236)
into
sigstore:main

[Nov 9, 2023](https://github.com/sigstore/gitsign/pull/399#event-10918586794)
8 checks passed

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[Nov 10, 2023](#ref-issue-1988531619)

[x/vulndb: potential Go vuln in github.com/sigstore/gitsign: CVE-2023-47122
golang/vulndb#2332](/golang/vulndb/issues/2332)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fgitsign%2Fpull%2F399)

Reviewers

[![@priyawadhwa](https://avatars.githubusercontent.com/u/10676490?s=40&v=4)](/priyawadhwa) [priyawadhwa](/priyawadhwa)

priyawadhwa approved these changes

[![@cpanato](https://avatars.githubusercontent.com/u/4115580?s=40&v=4)](/cpanato) [cpanato](/cpanato)

 Awaiting requested review from cpanato

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@wlynch](https://avatars.githubusercontent.com/u/1844673?s=52&v=4)](/wlynch) [![@priyawadhwa](https://avatars.githubusercontent.com/u/10676490?s=52&v=4)](/priyawadhwa)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_6a41b261_20250110_160346.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fgitsign%2Fcommit%2Fcd66ccb03c86a3600955f0c15f6bfeb75f697236)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fgitsign%2Fcommit%2Fcd66ccb03c86a3600955f0c15f6bfeb75f697236)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=sigstore%2Fgitsign)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sigstore](/sigstore)
/
**[gitsign](/sigstore/gitsign)**
Public

generated from [sigstore/sigstore-project-template](/sigstore/sigstore-project-template)

* [Notifications](/login?return_to=%2Fsigstore%2Fgitsign) You must be signed in to change notification settings
* [Fork
  63](/login?return_to=%2Fsigstore%2Fgitsign)
* [Star
   963](/login?return_to=%2Fsigstore%2Fgitsign)

* [Code](/sigstore/gitsign)
* [Issues
  21](/sigstore/gitsign/issues)
* [Pull requests
  3](/sigstore/gitsign/pulls)
* [Discussions](/sigstore/gitsign/discussions)
* [Actions](/sigstore/gitsign/actions)
* [Projects
  0](/sigstore/gitsign/projects)
* [Security](/sigstore/gitsign/security)
* [Insights](/sigstore/gitsign/pulse)

Additional navigation options

* [Code](/sigstore/gitsign)
* [Issues](/sigstore/gitsign/issues)
* [Pull requests](/sigstore/gitsign/pulls)
* [Discussions](/sigstore/gitsign/discussions)
* [Actions](/sigstore/gitsign/actions)
* [Projects](/sigstore/gitsign/projects)
* [Security](/sigstore/gitsign/security)
* [Insights](/sigstore/gitsign/pulse)

## Commit

[Permalink](/sigstore/gitsign/commit/cd66ccb03c86a3600955f0c15f6bfeb75f697236)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add options for Rekor client, make public key fetcher configurable. ([#…](https://github.com/sigstore/gitsign/pull/399)

[Browse files](/sigstore/gitsign/tree/cd66ccb03c86a3600955f0c15f6bfeb75f697236)
Browse the repository at this point in the history

```
[…399](https://github.com/sigstore/gitsign/pull/399))

Also makes the default public key fetcher match the behavior of cosign,
which also fixes a bug where verify was getting keys from Rekor
directly.

Signed-off-by: Billy Lynch <billy@chainguard.dev>
```

* Loading branch information

[![@wlynch](https://avatars.githubusercontent.com/u/1844673?s=40&v=4)](/wlynch)

[wlynch](/sigstore/gitsign/commits?author=wlynch "View all commits by wlynch")
authored
Nov 9, 2023

1 parent
[26b5e0e](/sigstore/gitsign/commit/26b5e0e646ccec3d733ef58bcd593a40f81e20df)

commit cd66ccb

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**72 additions**
and
**21 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* internal

  + commands/root

    - internal/commands/root/sign.go
      [sign.go](#diff-9f4f97c3fb03199fdb0f08e82bc81cfb427596a701d3a1538af48324bd3b56e1)
  + gitsign

    - internal/gitsign/gitsign.go
      [gitsign.go](#diff-9c6bacc096a73a9c64a7097e887a35f088e50620f209b0c72bef83adb9b1229e)
  + rekor

    - internal/rekor/client.go
      [client.go](#diff-e83b9fa3527a254d194103d29f63557d576a28e9f56a8a253303942347840fa9)
* pkg/rekor

  + pkg/rekor/option.go
    [option.go](#diff-c185c6131fe1158edea1cc06e6e638b36193b2e02436f98d77b84dbc06d24ff7)
  + pkg/rekor/rekor.go
    [rekor.go](#diff-3d2699f12bf7b2cc4464823f0b5b8a34d52401a8051704f422e72105218e2e5a)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[internal/commands/root/sign.go](#diff-9f4f97c3fb03199fdb0f08e82bc81cfb427596a701d3a1538af48324bd3b56e1 "internal/commands/root/sign.go")

Show comments

[View file](/sigstore/gitsign/blob/cd66ccb03c86a3600955f0c15f6bfeb75f697236/internal/commands/root/sign.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -73,7 +73,7 @@ func commandSign(o \*options, s \*gsio.Streams, args ...string) error { |
|  |  | return fmt.Errorf("failed to read message from stdin: %w", err) |
|  |  | } |
|  |  |  |
|  |  | rekor, err := rekor.NewClient(o.Config.Rekor) |
|  |  | rekor, err := rekor.NewClientContext(ctx, o.Config.Rekor) |
|  |  | if err != nil { |
|  |  | return fmt.Errorf("failed to create rekor client: %w", err) |
|  |  | } |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[internal/gitsign/gitsign.go](#diff-9c6bacc096a73a9c64a7097e887a35f088e50620f209b0c72bef83adb9b1229e "internal/gitsign/gitsign.go")

Show comments

[View file](/sigstore/gitsign/blob/cd66ccb03c86a3600955f0c15f6bfeb75f697236/internal/gitsign/gitsign.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -74,7 +74,7 @@ func NewVerifierWithCosignOpts(ctx context.Context, cfg \*config.Config, opts \*co |
|  |  | return nil, fmt.Errorf("error creating Git verifier: %w", err) |
|  |  | } |
|  |  |  |
|  |  | rekor, err := rekorinternal.NewClient(cfg.Rekor) |
|  |  | rekor, err := rekorinternal.NewClientContext(ctx, cfg.Rekor) |
|  |  | if err != nil { |
|  |  | return nil, fmt.Errorf("failed to create rekor client: %w", err) |
|  |  | } |
| Expand Down | |  |

10 changes: 9 additions & 1 deletion

10
[internal/rekor/client.go](#diff-e83b9fa3527a254d194103d29f63557d576a28e9f56a8a253303942347840fa9 "internal/rekor/client.go")

Show comments

[View file](/sigstore/gitsign/blob/cd66ccb03c86a3600955f0c15f6bfeb75f697236/internal/rekor/client.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,11 +15,19 @@ |
|  |  | package rekor |
|  |  |  |
|  |  | import ( |
|  |  | "context" |
|  |  |  |
|  |  | gitrekor "github.com/sigstore/gitsign/pkg/rekor" |
|  |  | rekor "github.com/sigstore/rekor/pkg/client" |
|  |  | ) |
|  |  |  |
|  |  | // NewClient returns a new Rekor client with common client options set. |
|  |  | // Deprecated: Use NewClientContext instead. |
|  |  | func NewClient(url string) (\*gitrekor.Client, error) { |
|  |  | return gitrekor.New(url, rekor.WithUserAgent("gitsign")) |
|  |  | return NewClientContext(context.TODO(), url) |
|  |  | } |
|  |  |  |
|  |  | // NewClientContext returns a new Rekor client with common client options set. |
|  |  | func NewClientContext(ctx context.Context, url string) (\*gitrekor.Client, error) { |
|  |  | return gitrekor.NewWithOptions(ctx, url, gitrekor.WithClientOption(rekor.WithUserAgent("gitsign"))) |
|  |  | } |

45 changes: 45 additions & 0 deletions

45
[pkg/rekor/option.go](#diff-c185c6131fe1158edea1cc06e6e638b36193b2e02436f98d77b84dbc06d24ff7 "pkg/rekor/option.go")

Show comments

[View file](/sigstore/gitsign/blob/cd66ccb03c86a3600955f0c15f6bfeb75f697236/pkg/rekor/option.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,45 @@ |
|  |  | // |
|  |  | // Copyright 2023 The Sigstore Authors. |
|  |  | // |
|  |  | // Licensed under the Apache License, Version 2.0 (the "License"); |
|  |  | // you may not use this file except in compliance with the License. |
|  |  | // You may obtain a copy of the License at |
|  |  | // |
|  |  | // http://www.apache.org/licenses/LICENSE-2.0 |
|  |  | // |
|  |  | // Unless required by applicable law or agreed to in writing, software |
|  |  | // distributed under the License is distributed on an "AS IS" BASIS, |
|  |  | // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. |
|  |  | // See the License for the specific language governing permissions and |
|  |  | // limitations under the License. |
|  |  |  |
|  |  | package rekor |
|  |  |  |
|  |  | import ( |
|  |  | "context" |
|  |  |  |
|  |  | "github.com/sigstore/cosign/v2/pkg/cosign" |
|  |  | "github.com/sigstore/rekor/pkg/client" |
|  |  | ) |
|  |  |  |
|  |  | type Option func(\*options) |
|  |  |  |
|  |  | type options struct { |
|  |  | rekorPublicKeys CosignRekorKeyProvider |
|  |  | clientOpts []client.Option |
|  |  | } |
|  |  |  |
|  |  | // CosignRekorKeyProvider is a function that returns the Rekor public keys in cosign's specialized format. |
|  |  | type CosignRekorKeyProvider func(ctx context.Context) (\*cosign.TrustedTransparencyLogPubKeys, error) |
|  |  |  |
|  |  | func WithCosignRekorKeyProvider(f CosignRekorKeyProvider) Option { |
|  |  | return func(o \*options) { |
|  |  | o.rekorPublicKeys = f |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func WithClientOption(opts ...client.Option) Option { |
|  |  | return func(o \*options) { |
|  |  | o.clientOpts = opts |
|  |  | } |
|  |  | } |

34 changes: 16 additions & 18 deletions

34
[pkg/rekor/rekor.go](#diff-3d2699f12bf7b2cc4464823f0b5b8a34d52401a8051704f422e72105218e2e5a "pkg/rekor/rekor.go")

Show comments

[View file](/sigstore/gitsign/blob/cd66ccb03c86a3600955f0c15f6bfeb75f697236/pkg/rekor/rekor.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -43,7 +43,6 @@ import ( |
|  |  | hashedrekord\_v001 "github.com/sigstore/rekor/pkg/types/hashedrekord/v0.0.1" |
|  |  | rekord\_v001 "github.com/sigstore/rekor/pkg/types/rekord/v0.0.1" |
|  |  | "github.com/sigstore/sigstore/pkg/cryptoutils" |
|  |  | "github.com/sigstore/sigstore/pkg/tuf" |
|  |  | ) |
|  |  |  |
|  |  | // Verifier represents a mechanism to get and verify Rekor entries for the given Git data. |
| Expand All | | @@ -64,12 +63,26 @@ type Client struct { |
|  |  | publicKeys \*cosign.TrustedTransparencyLogPubKeys |
|  |  | } |
|  |  |  |
|  |  | // Deprecated: Use NewWithOptions instead. |
|  |  | func New(url string, opts ...rekor.Option) (\*Client, error) { |
|  |  | c, err := rekor.GetRekorClient(url, opts...) |
|  |  | return NewWithOptions(context.TODO(), url, WithClientOption(opts...)) |
|  |  | } |
|  |  |  |
|  |  | func NewWithOptions(ctx context.Context, url string, opts ...Option) (\*Client, error) { |
|  |  | // Defaults |
|  |  | o := &options{ |
|  |  | rekorPublicKeys: cosign.GetRekorPubs, |
|  |  | } |
|  |  | for \_, f := range opts { |
|  |  | f(o) |
|  |  | } |
|  |  |  |
|  |  | c, err := rekor.GetRekorClient(url, o.clientOpts...) |
|  |  | if err != nil { |
|  |  | return nil, err |
|  |  | } |
|  |  | pubs, err := rekorPubsFromClient(c) |
|  |  |  |
|  |  | pubs, err := o.rekorPublicKeys(ctx) |
|  |  | if err != nil { |
|  |  | return nil, err |
|  |  | } |
| Expand Down  Expand Up | | @@ -158,21 +171,6 @@ func (c \*Client) findTLogEntriesByPayloadAndPK(ctx context.Context, payload, pub |
|  |  | return searchIndex.GetPayload(), nil |
|  |  | } |
|  |  |  |
|  |  | // rekorPubsFromClient returns a RekorPubKey keyed by the log ID from the Rekor client. |
|  |  | // NOTE: This \*\*must not\*\* be used in the verification path, but may be used in the |
|  |  | // sign path to validate return responses are consistent from Rekor. |
|  |  | func rekorPubsFromClient(rekorClient \*client.Rekor) (\*cosign.TrustedTransparencyLogPubKeys, error) { |
|  |  | publicKeys := cosign.NewTrustedTransparencyLogPubKeys() |
|  |  | pubOK, err := rekorClient.Pubkey.GetPublicKey(nil) |
|  |  | if err != nil { |
|  |  | return nil, fmt.Errorf("unable to fetch rekor public key from rekor: %w", err) |
|  |  | } |
|  |  | if err := publicKeys.AddTransparencyLogPubKey([]byte(pubOK.Payload), tuf.Active); err != nil { |
|  |  | return nil, fmt.Errorf("constructRekorPubKey: %w", err) |
|  |  | } |
|  |  | return &publicKeys, nil |
|  |  | } |
|  |  |  |
|  |  | // Verify verifies a commit using online verification. |
|  |  | // |
|  |  | // This is done by: |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `cd66ccb`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fgitsign%2Fcommit%2Fcd66ccb03c86a3600955f0c15f6bfeb75f697236) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from docs.sigstore.dev_07baf31d_20250110_160345.html ===
[![Sigstore logo](https://docs.sigstore.dev//sigstore-logo.png)](/)
## [Sigstore](/)

---

---

* [GitHub](https://github.com/sigstore/docs)
* [Twitter](https://twitter.com/projectsigstore)

---

* About
  + [Overview](https://docs.sigstore.dev/about/overview/)
  + [Tooling](https://docs.sigstore.dev/about/tooling/)
  + [Security Model](https://docs.sigstore.dev/about/security/)
  + [Threat Model](https://docs.sigstore.dev/about/threat-model/)
  + [Sigstore Bundle Format](https://docs.sigstore.dev/about/bundle/)
  + [API Stability and Deprecation Policy](https://docs.sigstore.dev/about/api-stability/)
  + [Contributing](https://docs.sigstore.dev/about/contributing/)
  + [Get Help](https://docs.sigstore.dev/about/support/)
  + [Documentation Locations](https://docs.sigstore.dev/about/doc_locations/)
  + [FAQs](https://docs.sigstore.dev/about/faq/)
  + [Research](https://docs.sigstore.dev/about/research/)
* Quickstart
  + [Sigstore Quickstart with Cosign](https://docs.sigstore.dev/quickstart/quickstart-cosign/)
* Cosign
  + Signing
    - [Overview](https://docs.sigstore.dev/cosign/signing/overview/)
    - [Signing Containers](https://docs.sigstore.dev/cosign/signing/signing_with_containers/)
    - [Signing Blobs](https://docs.sigstore.dev/cosign/signing/signing_with_blobs/)
    - [Git Support](https://docs.sigstore.dev/cosign/signing/git_support/)
    - [Gitsign](https://docs.sigstore.dev/cosign/signing/gitsign/)
    - [PKCS11 Tokens](https://docs.sigstore.dev/cosign/signing/pkcs11/)
    - [Signing Other Types](https://docs.sigstore.dev/cosign/signing/other_types/)
  + Verifying
    - [Verifying Signatures](https://docs.sigstore.dev/cosign/verifying/verify/)
    - [Timestamps](https://docs.sigstore.dev/cosign/verifying/timestamps/)
    - [In-Toto Attestations](https://docs.sigstore.dev/cosign/verifying/attestation/)
    - [Inspecting Gitsign Commit Signatures](https://docs.sigstore.dev/cosign/verifying/inspecting/)
  + Key Management
    - [Overview](https://docs.sigstore.dev/cosign/key_management/overview/)
    - [Signing with Self-Managed Keys](https://docs.sigstore.dev/cosign/key_management/signing_with_self-managed_keys/)
    - [Importing Key Pairs](https://docs.sigstore.dev/cosign/key_management/import-keypair/)
    - [Hardware Tokens](https://docs.sigstore.dev/cosign/key_management/hardware-based-tokens/)
  + System Configuration
    - [Installation](https://docs.sigstore.dev/cosign/system_config/installation/)
    - [Integration](https://docs.sigstore.dev/cosign/system_config/integration/)
    - [Configuring Cosign with Custom Components](https://docs.sigstore.dev/cosign/system_config/custom_components/)
    - [Public Deployment](https://docs.sigstore.dev/cosign/system_config/public_deployment/)
    - [Registry Support](https://docs.sigstore.dev/cosign/system_config/registry_support/)
    - [Specifications](https://docs.sigstore.dev/cosign/system_config/specifications/)
* Language Clients
  + [Language Client Overview](https://docs.sigstore.dev/language_clients/language_client_overview/)
  + [Go](https://docs.sigstore.dev/language_clients/go/)
  + [Java](https://docs.sigstore.dev/language_clients/java/)
  + [JavaScript](https://docs.sigstore.dev/language_clients/javascript/)
  + [Python](https://docs.sigstore.dev/language_clients/python/)
  + [Rust](https://docs.sigstore.dev/language_clients/rust/)
* Policy Controller
  + [Overview](https://docs.sigstore.dev/policy-controller/overview/)
  + [Installation](https://docs.sigstore.dev/policy-controller/installation/)
  + [Sample Policies](https://docs.sigstore.dev/policy-controller/sample-policies/)
* Certificate Authority
  + [Overview](https://docs.sigstore.dev/certificate_authority/overview/)
  + [Certificate Issuing](https://docs.sigstore.dev/certificate_authority/certificate-issuing-overview/)
  + [Transparency Log Info](https://docs.sigstore.dev/certificate_authority/cert-transparency-log-info/)
  + [Using OIDC Tokens](https://docs.sigstore.dev/certificate_authority/oidc-in-fulcio/)
  + [Release Log](https://docs.sigstore.dev/certificate_authority/release-log/)
  + [HSM Support](https://docs.sigstore.dev/certificate_authority/hsm-support/)
  + [Certificate Specification](https://docs.sigstore.dev/certificate_authority/cert_specification/)
* Transparency Log
  + [Overview](https://docs.sigstore.dev/logging/overview/)
  + [Installation](https://docs.sigstore.dev/logging/installation/)
  + [Sharding](https://docs.sigstore.dev/logging/sharding/)
  + [CLI](https://docs.sigstore.dev/logging/cli/)
  + [Pluggable Types](https://docs.sigstore.dev/logging/pluggable-types/)
  + [Signing and Uploading Other Types](https://docs.sigstore.dev/logging/sign-upload/)
  + [Verifying Binaries](https://docs.sigstore.dev/logging/verify-release/)
  + [Event Stream](https://docs.sigstore.dev/logging/event_stream/)
* Project Documentation
  + [Cosign](https://github.com/sigstore/cosign/tree/main/doc)
  + [Fulcio](https://github.com/sigstore/fulcio/tree/main/docs)
  + [Gitsign](https://github.com/sigstore/gitsign/tree/main/docs)
  + [Policy Controller](https://github.com/sigstore/policy-controller/blob/main/docs/api-types/index.md)
* API Reference
  + [OpenAPI Specification](https://www.sigstore.dev/swagger/)

* About
  + [Overview](https://docs.sigstore.dev/about/overview/)
  + [Tooling](https://docs.sigstore.dev/about/tooling/)
  + [Security Model](https://docs.sigstore.dev/about/security/)
  + [Threat Model](https://docs.sigstore.dev/about/threat-model/)
  + [Sigstore Bundle Format](https://docs.sigstore.dev/about/bundle/)
  + [API Stability and Deprecation Policy](https://docs.sigstore.dev/about/api-stability/)
  + [Contributing](https://docs.sigstore.dev/about/contributing/)
  + [Get Help](https://docs.sigstore.dev/about/support/)
  + [Documentation Locations](https://docs.sigstore.dev/about/doc_locations/)
  + [FAQs](https://docs.sigstore.dev/about/faq/)
  + [Research](https://docs.sigstore.dev/about/research/)
* Quickstart
  + [Sigstore Quickstart with Cosign](https://docs.sigstore.dev/quickstart/quickstart-cosign/)
* Cosign
  + Signing
    - [Overview](https://docs.sigstore.dev/cosign/signing/overview/)
    - [Signing Containers](https://docs.sigstore.dev/cosign/signing/signing_with_containers/)
    - [Signing Blobs](https://docs.sigstore.dev/cosign/signing/signing_with_blobs/)
    - [Git Support](https://docs.sigstore.dev/cosign/signing/git_support/)
    - [Gitsign](https://docs.sigstore.dev/cosign/signing/gitsign/)
    - [PKCS11 Tokens](https://docs.sigstore.dev/cosign/signing/pkcs11/)
    - [Signing Other Types](https://docs.sigstore.dev/cosign/signing/other_types/)
  + Verifying
    - [Verifying Signatures](https://docs.sigstore.dev/cosign/verifying/verify/)
    - [Timestamps](https://docs.sigstore.dev/cosign/verifying/timestamps/)
    - [In-Toto Attestations](https://docs.sigstore.dev/cosign/verifying/attestation/)
    - [Inspecting Gitsign Commit Signatures](https://docs.sigstore.dev/cosign/verifying/inspecting/)
  + Key Management
    - [Overview](https://docs.sigstore.dev/cosign/key_management/overview/)
    - [Signing with Self-Managed Keys](https://docs.sigstore.dev/cosign/key_management/signing_with_self-managed_keys/)
    - [Importing Key Pairs](https://docs.sigstore.dev/cosign/key_management/import-keypair/)
    - [Hardware Tokens](https://docs.sigstore.dev/cosign/key_management/hardware-based-tokens/)
  + System Configuration
    - [Installation](https://docs.sigstore.dev/cosign/system_config/installation/)
    - [Integration](https://docs.sigstore.dev/cosign/system_config/integration/)
    - [Configuring Cosign with Custom Components](https://docs.sigstore.dev/cosign/system_config/custom_components/)
    - [Public Deployment](https://docs.sigstore.dev/cosign/system_config/public_deployment/)
    - [Registry Support](https://docs.sigstore.dev/cosign/system_config/registry_support/)
    - [Specifications](https://docs.sigstore.dev/cosign/system_config/specifications/)
* Language Clients
  + [Language Client Overview](https://docs.sigstore.dev/language_clients/language_client_overview/)
  + [Go](https://docs.sigstore.dev/language_clients/go/)
  + [Java](https://docs.sigstore.dev/language_clients/java/)
  + [JavaScript](https://docs.sigstore.dev/language_clients/javascript/)
  + [Python](https://docs.sigstore.dev/language_clients/python/)
  + [Rust](https://docs.sigstore.dev/language_clients/rust/)
* Policy Controller
  + [Overview](https://docs.sigstore.dev/policy-controller/overview/)
  + [Installation](https://docs.sigstore.dev/policy-controller/installation/)
  + [Sample Policies](https://docs.sigstore.dev/policy-controller/sample-policies/)
* Certificate Authority
  + [Overview](https://docs.sigstore.dev/certificate_authority/overview/)
  + [Certificate Issuing](https://docs.sigstore.dev/certificate_authority/certificate-issuing-overview/)
  + [Transparency Log Info](https://docs.sigstore.dev/certificate_authority/cert-transparency-log-info/)
  + [Using OIDC Tokens](https://docs.sigstore.dev/certificate_authority/oidc-in-fulcio/)
  + [Release Log](https://docs.sigstore.dev/certificate_authority/release-log/)
  + [HSM Support](https://docs.sigstore.dev/certificate_authority/hsm-support/)
  + [Certificate Specification](https://docs.sigstore.dev/certificate_authority/cert_specification/)
* Transparency Log
  + [Overview](https://docs.sigstore.dev/logging/overview/)
  + [Installation](https://docs.sigstore.dev/logging/installation/)
  + [Sharding](https://docs.sigstore.dev/logging/sharding/)
  + [CLI](https://docs.sigstore.dev/logging/cli/)
  + [Pluggable Types](https://docs.sigstore.dev/logging/pluggable-types/)
  + [Signing and Uploading Other Types](https://docs.sigstore.dev/logging/sign-upload/)
  + [Verifying Binaries](https://docs.sigstore.dev/logging/verify-release/)
  + [Event Stream](https://docs.sigstore.dev/logging/event_stream/)
* Project Documentation
  + [Cosign](https://github.com/sigstore/cosign/tree/main/doc)
  + [Fulcio](https://github.com/sigstore/fulcio/tree/main/docs)
  + [Gitsign](https://github.com/sigstore/gitsign/tree/main/docs)
  + [Policy Controller](https://github.com/sigstore/policy-controller/blob/main/docs/api-types/index.md)
* API Reference
  + [OpenAPI Specification](https://www.sigstore.dev/swagger/)
On this page
ExpandCollapse

* [Introduction](#introduction)
* [Main takeaways](#main-takeaways)
* [Sigstore threat model](#sigstore-threat-model)
  + [Scenario for Table 1](#scenario-for-table-1)
  + [Action: Alice signs an artifact with Sigstore](#action-alice-signs-an-artifact-with-sigstore)
  + [Action: Bob verifies an artifact with Sigstore](#action-bob-verifies-an-artifact-with-sigstore)
  + [Action: Charlie monitors the Rekor CT log](#action-charlie-monitors-the-rekor-ct-log)
  + [Action: Deborah monitors the Fulcio CT log](#action-deborah-monitors-the-fulcio-ct-log)
* [Mitigations and recommendations](#mitigations-and-recommendations)
  + [2FA on OIDC accounts](#2fa-on-oidc-accounts)
  + [Identity monitors](#identity-monitors)
  + [Secure distribution (and revocation) of Sigstore key material](#secure-distribution-and-revocation-of-sigstore-key-material)
  + [Policy considerations](#policy-considerations)
### On this page

* [Introduction](#introduction)
* [Main takeaways](#main-takeaways)
* [Sigstore threat model](#sigstore-threat-model)
  + [Scenario for Table 1](#scenario-for-table-1)
  + [Action: Alice signs an artifact with Sigstore](#action-alice-signs-an-artifact-with-sigstore)
  + [Action: Bob verifies an artifact with Sigstore](#action-bob-verifies-an-artifact-with-sigstore)
  + [Action: Charlie monitors the Rekor CT log](#action-charlie-monitors-the-rekor-ct-log)
  + [Action: Deborah monitors the Fulcio CT log](#action-deborah-monitors-the-fulcio-ct-log)
* [Mitigations and recommendations](#mitigations-and-recommendations)
  + [2FA on OIDC accounts](#2fa-on-oidc-accounts)
  + [Identity monitors](#identity-monitors)
  + [Secure distribution (and revocation) of Sigstore key material](#secure-distribution-and-revocation-of-sigstore-key-material)
  + [Policy considerations](#policy-considerations)

1. [Home](/)
2. [About](/about/)
3. Threat Model
# Threat Model

On this page
ExpandCollapse

* [Introduction](#introduction)
* [Main takeaways](#main-takeaways)
* [Sigstore threat model](#sigstore-threat-model)
  + [Scenario for Table 1](#scenario-for-table-1)
  + [Action: Alice signs an artifact with Sigstore](#action-alice-signs-an-artifact-with-sigstore)
  + [Action: Bob verifies an artifact with Sigstore](#action-bob-verifies-an-artifact-with-sigstore)
  + [Action: Charlie monitors the Rekor CT log](#action-charlie-monitors-the-rekor-ct-log)
  + [Action: Deborah monitors the Fulcio CT log](#action-deborah-monitors-the-fulcio-ct-log)
* [Mitigations and recommendations](#mitigations-and-recommendations)
  + [2FA on OIDC accounts](#2fa-on-oidc-accounts)
  + [Identity monitors](#identity-monitors)
  + [Secure distribution (and revocation) of Sigstore key material](#secure-distribution-and-revocation-of-sigstore-key-material)
  + [Policy considerations](#policy-considerations)
### On this page

* [Introduction](#introduction)
* [Main takeaways](#main-takeaways)
* [Sigstore threat model](#sigstore-threat-model)
  + [Scenario for Table 1](#scenario-for-table-1)
  + [Action: Alice signs an artifact with Sigstore](#action-alice-signs-an-artifact-with-sigstore)
  + [Action: Bob verifies an artifact with Sigstore](#action-bob-verifies-an-artifact-with-sigstore)
  + [Action: Charlie monitors the Rekor CT log](#action-charlie-monitors-the-rekor-ct-log)
  + [Action: Deborah monitors the Fulcio CT log](#action-deborah-monitors-the-fulcio-ct-log)
* [Mitigations and recommendations](#mitigations-and-recommendations)
  + [2FA on OIDC accounts](#2fa-on-oidc-accounts)
  + [Identity monitors](#identity-monitors)
  + [Secure distribution (and revocation) of Sigstore key material](#secure-distribution-and-revocation-of-sigstore-key-material)
  + [Policy considerations](#policy-considerations)
## Introduction [#](#introduction)

**What types of security analysis have you done on Sigstore?**
This page contains the results of a threat modeling exercise on Sigstore. First, we enumerate the components of Sigstore along with third parties and infrastructure that it uses during the [“keyless” signing](/cosign/signing/overview/) and verification flows. Second, we postulate an attacker that can compromise various subsets of these parties. Finally, we analyze the impact of such an attacker on these security properties. The results of a similar exercise are included in the peer-reviewed paper [Sigstore: Software Signing for Everybody](https://dl.acm.org/doi/pdf/10.1145/3548606.3560596).

This will be most useful to those building secure systems on top of Sigstore, rather than end users. The security guarantees of such systems depends on the details of integration; an example analysis can be found in [TAP-18](https://github.com/theupdateframework/taps/blob/master/tap18.md), which proposes using Sigstore identities with a [TUF](https://theupdateframework.com/) repository used to securely distribute software artifacts.

**Which areas should I be confident in trusting?**
Provided that both Sigstore and its identity providers (like Google or GitHub) are not compromised, you can trust Sigstore signatures correspond to the purported identities. Even in the event of compromise, “auditors” and “monitors” will be able to detect misbehavior; you can run an auditor or monitor yourself! Further, the TUF root of trust provides strong revocation abilities that allow for recovery in the event of a compromise of any Sigstore service.

**Which areas might be more vulnerable in case of compromise?**
In the event of compromise of an identity provider (like Google or GitHub) or individual identity (an account with such a provider), Sigstore will issue certificates to those identities. These certificates will be logged and therefore such compromise can be detected, but this detection relies on monitoring.

**What does a signature guarantee?**

Under normal operation (no Sigstore compromise), verifying a “keyless” signature from `user@example.com` using the `ExampleIdP` identity provider at a given timestamp guarantees that the signature was created by a signer who successfully authenticated to Sigstore using that identity at that time.

It does not guarantee that the signer *should* be able to authenticate (for instance, in the event of a compromised account, or compromised identity provider), that the signer *should* have signed the given message, or that the software artifact in question is “good” (see the section on “Policy” below).

Further, if Sigstore itself is compromised, this property may not hold; see our analysis below.

**What should I do or keep in mind to mitigate these threats when using Sigstore?**
First, users of Sigstore should ensure that they have tooling to audit Sigstore’s transparency logs for consistency and to monitor the use of their identities in Sigstore. Sigstore operators provide [some tooling](https://github.com/sigstore/rekor-monitor) for these efforts. Second, all OIDC accounts used to create Sigstore signatures should have 2FA enabled to reduce the likelihood of a compromise.

In this threat model, we consider the compromise of any of the following:

* Fulcio CA server
* Fulcio CT Log
* Rekor server
* Fulcio monitor
* Rekor monitor
* OIDC server: OIDC issuer/IdP
* OIDC account
* TUF Root of trust

Here’s a high-level diagram of the Sigstore signing flow, with the components and steps that might be compromised highlighted in red:

![Sigstore signing flow](/sigstore-threat-model-signing.svg)

## Main takeaways [#](#main-takeaways)

* Identity and consistency monitoring is critical to mitigate risks of compromise to both the Fulcio CT log and Rekor. All signers should monitor the Fulcio CT log for unauthorized use of their identity, and all verifiers should look for alerts from consistency monitors.
* The Fulcio CA is a particularly important source of trust and must be hardened.
* OIDC issuers are highly trusted in Sigstore, and only properly hardened OIDC issuers should be used.
* OIDC account compromise is not handled by Sigstore, but we recommend that OIDC issuers provide revocation in the case of a compromised OIDC account. In addition, we recommend the use of 2FA on all OIDC accounts used with Sigstore in order to reduce the likelihood of a compromise.
* TUF root of trust provides strong revocation abilities for all services managed by Sigstore.

## Sigstore threat model [#](#sigstore-threat-model)

### Scenario for Table 1 [#](#scenario-for-table-1)

This table analyzes the attacker capabilities when the attacker compromises different Sigstore components. This table assumes that Fulcio is used to sign any software artifacts. The storage mechanism (repository, etc.) for artifacts and metadata are out of scope for this model. The table description assumes TUF is not in play, except in the root of trust defined by Sigstore. We assume that there are multiple monitors of Rekor and the Fulcio CT log that communicate with a gossip protocol. Each monitor ensures that the log remains append only by reviewing the full state of the log. A compromise would mean all monitors are compromised. The table is sorted by the impact of the attacker’s capabilities. Compromises which have different capabilities with the same impact are grouped together. The actors in this table are described below:

### Action: Alice signs an artifact with Sigstore [#](#action-alice-signs-an-artifact-with-sigstore)

Alice authenticates herself against the OIDC identity provider to get an OIDC ID token. She then sends a certificate request to the Fulcio CA with a generated public key and the OIDC ID token. The Fulcio CA verifies the authenticity of the OIDC ID token with the OIDC identity provider, then extracts the subject from the token to use as the SAN in the certificate. The Fulcio CA generates and signs a precertificate, which is uploaded to the Fulcio CT log. The Fulcio CT log generates and signs a SCT (signed certificate timestamp), which is sent back to the Fulcio CA. The Fulcio CA combines the SCT with the precertificate to get the final certificate which is sent to Alice. Alice uses the key associated with the certificate to sign the artifact. She uploads the certificate and signature to Rekor, which stores them in the logs and returns an SET (signed entry timestamp) that promises inclusion in the log at a particular time. The verifier can use this time to ensure the certificate was used while it was valid.

### Action: Bob verifies an artifact with Sigstore [#](#action-bob-verifies-an-artifact-with-sigstore)

Bob has an artifact, signature, and Fulcio certificate. He knows that Alice is trusted to sign this artifact due to either a TUF delegation that lists her as the identity, or some other namespacing mechanism such as a policy configuration. Bob gets trusted keys for Sigstore services using the TUF root of trust. He then checks that the certificate was signed by the Fulcio CA and that Alice is the subject. He verifies that the certificate is present in the Fulcio CT log. He checks the signature on the artifact using the key in the certificate. He then checks the Rekor SET embedded in the signature to ensure the signature was made during the validity window of the certificate. Next, he queries Rekor for the proof of inclusion to perform online verification and ensure that the signature is included in the Rekor TL.

### Action: Charlie monitors the Rekor CT log [#](#action-charlie-monitors-the-rekor-ct-log)

Charlie queries Rekor periodically and ensures that the log is append-only by ensuring that all entries that were in the log are still present. Charlie also talks to other Rekor monitors to ensure that the tree head is consistent for all users. If he notices an issue, he reports it to Sigstore admins, who verify the report before working toward recovery. Charlie may do additional checks for entry validity.

### Action: Deborah monitors the Fulcio CT log [#](#action-deborah-monitors-the-fulcio-ct-log)

Deborah queries the Fulcio CT log periodically to ensure that all entries that were in the log are still present. She also talks to other Fulcio monitors to ensure that the tree head is consistent for all users. If she notices an issue, she reports it to Sigstore admins, who verify the report before working toward recovery.

| **Compromise** | **Attacker capabilities** | **Other security impacts** |
| --- | --- | --- |
| Fulcio CT monitor | None: alerts will be logged, Sigstore admins manually check reports from Deborah by querying the log and will reject false reports. |  |
| Rekor monitor | None: alerts are logged, may be sent to Slack. Sigstore admins manually check reports from Charlie. |  |
| Fulcio CT log | Can remove certificates (invalidate them) by indicating that they are not in the log when Bob queries, fork attack by showing different times or certificates to different users (for things Fulcio has signed), and may block the issuance of Fulcio certificates by not creating an SCT. | Deletion / fork may be detected by Fulcio CT log monitors. |
| Rekor Server | Can change the timestamp on Fulcio signatures used outside the validity window to make them appear valid when Bob queries. Can deny the existence of valid signatures leading to them being untrusted. | Can later recover using offline delegation in Sigstore’s TUF root of trust. Deletion or fork attacks may be detected by Rekor monitors. Changes to the Rekor CT log would be challenging to recover as it eliminates the append-only promise of Rekor. |
| Fulcio CT log AND Fulcio CT log monitor | Same as Fulcio CT log. | Replay and fork attacks are undetected. |
| Fulcio CT log AND Rekor server | Same as Fulcio CT log and Rekor server rows, but can now use the replayed certs created by Fulcio CT log because Rekor will not report that they are already in the log, even with more sophisticated monitors. |  |
| Rekor Server AND Rekor monitor | Same as Rekor server, but changes to the CT log would not be reported by the monitor, would make recovery of the log much harder because the attacker could alter the historical entries, may require re-signing all metadata as previous timestamps are untrusted. |  |
| Fulcio CT log AND Fulcio CT log monitor AND Rekor server | Same as Fulcio CT log and Rekor server. | Replay and fork attacks will not be reported by monitors. |
| Fulcio CA server | Arbitrary software attack: Can issue certs for any OIDC issuer/identity and use those to sign any software desired. Bob will see these certificates as valid as they are signed by the Fulcio CA and included in the Fulcio CT log. | Fulcio CT log prevents changes to the history or blocking issuance/modification of past entries (which is not that relevant given the ability to issue keys, etc., now) To recover, the TUF root of trust for Fulcio needs to be invoked to revoke trust in the compromised Fulcio CA server. |
| Fulcio CA server AND Fulcio CT log | Arbitrary software attack: Same as Fulcio CA server, but can now also rewrite historical Fulcio certificates in the Fulcio CT log by changing the Merkle tree hash so that the times will appear different when Bob queries. | Modifying CT log history would be caught by the Fulcio monitor. Can recover using the Sigstore root of trust. |
| Fulcio CA server AND Fulcio CT log AND Fulcio CT log monitor | Same as Fulcio CA server and Fulcio CT | Replay and fork attacks will not be reported by the monitors. |
| OIDC account | Arbitrary software attack for whatever that specific account has access to. | Might be recoverable through a mechanism set up by the OIDC server. |
| OIDC server | Arbitrary software attack for anything that OIDC domain covers. |  |
| Sigstore root of trust | Can become the Fulcio CA, Rekor, the Fulcio CA log, etc. Arbitrary software attack is trivial from there with MITM. | Monitors may detect the attack, but Sigstore admins can’t recover without control of the root of trust. |

## Mitigations and recommendations [#](#mitigations-and-recommendations)

Here, we describe recommendations for using Sigstore in such a way that the likelihood and impact of a compromise are both mitigated.

### 2FA on OIDC accounts [#](#2fa-on-oidc-accounts)

As shown in the table above, compromise of an OIDC account is sufficient for an arbitrary software attack for any packages that account is trusted to sign. To mitigate this risk, we recommend reducing the likelihood of account compromise through the use of 2FA on all accounts that will be used with Sigstore. 2FA requires that not just a password, but a second factor like a YubiKey or authenticator app is also compromised. For maximum security, users should avoid less secure forms of 2FA such as text messages and phone calls.

OIDC does not provide a mechanism for checking if accounts have 2FA enabled, and so enforcement of this recommendation is up to individual signers in the ecosystem.

### Identity monitors [#](#identity-monitors)

All certificates that are issued by Fulcio are written to a Certificate Transparency log, accessible at ctfe.sigstore.dev. For each artifact, Sigstore clients publish the artifact’s hash, signature, and certificate to this transparency log. A signature verifier must check that an artifact has been uploaded to Rekor and the certificate has been published to Fulcio’s log before trusting the artifact. This ensures that the artifact and certificate are publicly auditable, so that the identity owner can monitor the log to find unexpected occurrences of their identity.

Sigstore provides an easy-to-use GitHub Actions-based log monitor, [rekor-monitor](https://github.com/sigstore/rekor-monitor). Currently, it supports monitoring identities only for the hashedrekord Rekor type, which is the default uploaded type for Cosign and other Sigstore clients. See the [README](https://github.com/sigstore/rekor-monitor#readme) for information on setting up the reusable workflow with identity monitoring.

Identities can include email or machine identity, for example for CI workflows such as GitHub Actions or GKE. rekor-monitor currently supports matching on exact string matches, which works well for email or specific CI workflows. We plan to add support for matching on regular expressions so that repository owners can monitor across repositories in an organization.

### Secure distribution (and revocation) of Sigstore key material [#](#secure-distribution-and-revocation-of-sigstore-key-material)

The above compromise scenarios for Fulcio, Rekor, and other parties describe either a compromise of the infrastructure itself or a compromise of the signing material used by those parties to make claims. That is, if you had Fulcio’s signing key, you wouldn’t need to additionally hack Fulcio to make false claims.

This means that secure distribution of Sigstore key material is paramount for security—if that process can be intercepted, we can consider all of the infrastructure effectively compromised.

To deal with this, we recommend the use of a strong root of trust for distributing the key material. Once that root of trust is established, all additional key material can flow through the root of trust. Specifically, we recommend using The Update Framework (TUF) to distribute this key material, as is done by the public good instance. This supports features like:

* Threshold signing by root-of-trust keys (the root of trust can comprise 5 keys, and signatures from 3 of 5 are needed to add new top-level key material).
* Root keys are offline.
* Rotation of both the root keys and other key material.
* Revocation: compromised material can be marked as such, with an indication of the compromise time to allow continued verification of legitimate signatures from before the compromise.
* Freshness: if an attacker tries to use an old key by preventing the victim from getting updates to key material (or serving old key material), the victim will detect this.

The Sigstore public good instance has a [root of trust](https://github.com/sigstore/root-signing) based on TUF that can be publicly audited, with geographically- and organizationally-distributed root key holders.

### Policy considerations [#](#policy-considerations)

The security guarantees that Sigstore provides are useful but relatively minimal: it can show you that a signature came from someone controlling a specific digital identity, but not whether you should trust that identity. Critically, [not everything that’s signed is secure](https://blog.sigstore.dev/signatus-ergo-securus-who-can-sign-what-with-tuf-and-sigstore-ea4d3d84b8b6): when verifying software, you need a policy for knowing whom to trust.

That policy should cover:

* How do you identify software artifacts (e.g., by their name)?
* Which identities are permitted to sign a given software artifact?
* Which identity providers can those identities come from?
  + Do the identity providers perform identity verification like “know-your-customer?”
  + Do they handle account compromise and recovery?
* Do you permit the use of public verification keys for identities, or must identities have an associated identity provider?
* Which Sigstore instance(s) do you trust, and how do you retrieve the key material for those instances?
* How do you handle revocation?

The answers will be different in different settings. For instance, a small organization may be able to meet their security needs by requiring signatures from one fixed party, with a blocklist for revoked artifacts. A large package repository may need to manage signing identities that change frequently over time. We hope to provide more detailed guidance for a variety of settings in future documentation.

[Edit this page on GitHub](https://github.com/sigstore/docs/blob/main/content/en/about/threat-model.md)[← Security Model](/about/security/)[Sigstore Bundle Format →](/about/bundle/)


