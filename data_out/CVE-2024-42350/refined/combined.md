=== Content from github.com_22495712_20250111_160459.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbiscuit-auth%2Fbiscuit%2Fcommit%2Fc87cbb5d778964d6574df3e9e6579567cad12fff)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbiscuit-auth%2Fbiscuit%2Fcommit%2Fc87cbb5d778964d6574df3e9e6579567cad12fff)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=biscuit-auth%2Fbiscuit)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[biscuit-auth](/biscuit-auth)
/
**[biscuit](/biscuit-auth/biscuit)**
Public

* [Notifications](/login?return_to=%2Fbiscuit-auth%2Fbiscuit) You must be signed in to change notification settings
* [Fork
  25](/login?return_to=%2Fbiscuit-auth%2Fbiscuit)
* [Star
   987](/login?return_to=%2Fbiscuit-auth%2Fbiscuit)

* [Code](/biscuit-auth/biscuit)
* [Issues
  34](/biscuit-auth/biscuit/issues)
* [Pull requests
  0](/biscuit-auth/biscuit/pulls)
* [Actions](/biscuit-auth/biscuit/actions)
* [Projects
  1](/biscuit-auth/biscuit/projects)
* [Security](/biscuit-auth/biscuit/security)
* [Insights](/biscuit-auth/biscuit/pulse)

Additional navigation options

* [Code](/biscuit-auth/biscuit)
* [Issues](/biscuit-auth/biscuit/issues)
* [Pull requests](/biscuit-auth/biscuit/pulls)
* [Actions](/biscuit-auth/biscuit/actions)
* [Projects](/biscuit-auth/biscuit/projects)
* [Security](/biscuit-auth/biscuit/security)
* [Insights](/biscuit-auth/biscuit/pulse)

## Commit

[Permalink](/biscuit-auth/biscuit/commit/c87cbb5d778964d6574df3e9e6579567cad12fff)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge commit from fork

[Browse files](/biscuit-auth/biscuit/tree/c87cbb5d778964d6574df3e9e6579567cad12fff)
Browse the repository at this point in the history

```
Third-party blocks should be completely isolated from the rest of the token, as the third-party has now way of assessing the consistency of the provided public key table with the token.
```

* Loading branch information

[![@divarvel](https://avatars.githubusercontent.com/u/173299?s=40&v=4)](/divarvel)

[divarvel](/biscuit-auth/biscuit/commits?author=divarvel "View all commits by divarvel")
authored
Jul 31, 2024

1 parent
[47f6d88](/biscuit-auth/biscuit/commit/47f6d887f99caecd1734e0472a05007272a45d55)

commit c87cbb5

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**37 additions**
and
**29 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* SPECIFICATIONS.md
  [SPECIFICATIONS.md](#diff-d52c9064bad21c96303e981f1e48953033ff20456ae22d65bebc842631f4d806)
* samples/current

  + samples/current/README.md
    [README.md](#diff-fb62904a710a5451c06b2a18cdea774a659de609ba7bae490b2805abbc5ae6e1)
  + samples/current/samples.json
    [samples.json](#diff-ef94dc3ba2c3d81a0a95fd0e2ac9a3d01c729dac8b0bbb955d18d406d08e9a4d)
  + samples/current/test024\_third\_party.bc
    [test024\_third\_party.bc](#diff-e660cf0ce8dc93ac6406633cf0f14b77493ee69a2fac3b4c7e0805c0eac9571e)
  + samples/current/test026\_public\_keys\_interning.bc
    [test026\_public\_keys\_interning.bc](#diff-b6717dd4356cbc569158d0a713284abf88ebd92e6600194d62ba4c12055ef031)

## There are no files selected for viewing

24 changes: 12 additions & 12 deletions

24
[SPECIFICATIONS.md](#diff-d52c9064bad21c96303e981f1e48953033ff20456ae22d65bebc842631f4d806 "SPECIFICATIONS.md")

Show comments

[View file](/biscuit-auth/biscuit/blob/c87cbb5d778964d6574df3e9e6579567cad12fff/SPECIFICATIONS.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -659,7 +659,7 @@ each block must carry its own version. |
|  |  | when possible, especially for biscuit versions that are only additive in terms of features. |
|  |  |  |
|  |  | - The lowest supported biscuit version is `3`; |
|  |  | - The highest supported biscuit version is `4`; |
|  |  | - The highest supported biscuit version is `5`; |
|  |  |  |
|  |  | # Version 2 |
|  |  |  |
| Expand Down  Expand Up | | @@ -776,6 +776,8 @@ Token { |
|  |  | } |
|  |  | ``` |
|  |  |  |
|  |  | Blocks signed with an external keypair must be at least v5. |
|  |  |  |
|  |  |  |
|  |  | #### Verifying |
|  |  |  |
| Expand Down  Expand Up | | @@ -917,28 +919,26 @@ Blocks that are signed by an external key don't use the token symbol table |
|  |  | and start from the default symbol table. Following blocks ignore the symbols |
|  |  | declared in their `symbols` field. |
|  |  |  |
|  |  | Similarly such blocks don't use the token public keys table and start from an empty table. Following blocks ignore the public keys defined in the `public\_keys` field. |
|  |  |  |
|  |  | The reason for this is that the party signing the block is not supposed to have |
|  |  | access to the token itself and can't use the token's symbol table. |
|  |  | access to the token itself and can't use the token's symbol table or its public keys table. |
|  |  |  |
|  |  | ### Public key tables |
|  |  |  |
|  |  | Public keys carried in `SignedBlock`s are stored as is, as they are required for verification. |
|  |  |  |
|  |  | Public keys carried in datalog scope annotations are stored in a table, to reduce token size. |
|  |  |  |
|  |  | Public keys are interned the same way for first-party and third-party tokens, unlike symbols. |
|  |  |  |
|  |  | #### Reading |
|  |  |  |
|  |  | Building a symbol table for a token can be done this way: |
|  |  |  |
|  |  | for each block: |
|  |  | for each block (if it does not have an external signature): |
|  |  |  |
|  |  | - add the external public key if defined (and if not already present) |
|  |  | - add the contents of the `publicKeys` field of the `Block` message |
|  |  |  |
|  |  | It is important to only add the external public key if it's not already |
|  |  | present, to avoid having it twice in the symbol table. |
|  |  | Blocks with an external signature use their own table and don't affect the rest of the token. |
|  |  |  |
|  |  | #### Appending |
|  |  |  |
| Expand All | | @@ -949,14 +949,14 @@ that were not present in the table yet. |
|  |  |  |
|  |  | Third party blocks are special blocks, that are meant to be signed by a trusted party, to either expand a token or fulfill special checks with dedicated public key constraints. |
|  |  |  |
|  |  | Unlike first-party blocks, the party signing the token should not have access to the token itself. The third party needs however some context in order to be able to properly serialize and sign block contents. Additionally, the third party needs to return both the serialized block and the external signature. |
|  |  | Unlike first-party blocks, the party signing the token should not have access to the token itself. The third party needs however some context in order to be able to properly sign block contents. Additionally, the third party needs to return both the serialized block and the external signature. |
|  |  |  |
|  |  | To support this use-case, the protobuf schema defines two message types: `ThirdPartyBlockRequest` and `ThirdPartyBlockContents`: |
|  |  |  |
|  |  | ``` |
|  |  | message ThirdPartyBlockRequest { |
|  |  | required PublicKey previousKey = 1; |
|  |  | repeated PublicKey publicKeys = 2; |
|  |  | repeated PublicKey legacyPublicKeys = 2; |
|  |  | } |
|  |  |  |
|  |  | message ThirdPartyBlockContents { |
| Expand All | | @@ -968,7 +968,7 @@ message ThirdPartyBlockContents { |
|  |  | `ThirdPartyBlockRequest` contains the necessary context for serializing and signing a datalog block: |
|  |  |  |
|  |  | - `previousKey` is needed for the signature (it makes sure that a third-party block can only be used for a specific biscuit token |
|  |  | - `publicKeys` is the list of public keys already present in the token table; they are used for serialization |
|  |  | - `legacyPublicKeys` is a legacy field. It must be empty (a non-empty field indicates that the request has been generated by an outdated implementation) |
|  |  |  |
|  |  | `ThirdPartyBlockContents` contains both the serialized `Block` and the external signature. |
|  |  |  |
| Expand All | | @@ -982,7 +982,7 @@ The expected sequence is |
|  |  |  |
|  |  | An implementation must be able to: |
|  |  |  |
|  |  | - generate a `ThirdPartyBlockRequest` from a token (by extracting its last ephemeral public key and its public key table) |
|  |  | - generate a `ThirdPartyBlockRequest` from a token (by extracting its last ephemeral public key) |
|  |  | - apply a `ThirdPartyBlockContents` on a token by appending the serialized block like a regular block |
|  |  |  |
|  |  | Same as biscuit tokens, the `ThirdPartyBlockRequest` and `ThirdPartyBlockContents` values can be transfered in text format |
| Expand Down | |  |

18 changes: 9 additions & 9 deletions

18
[samples/current/README.md](#diff-fb62904a710a5451c06b2a18cdea774a659de609ba7bae490b2805abbc5ae6e1 "samples/current/README.md")

Show comments

[View file](/biscuit-auth/biscuit/blob/c87cbb5d778964d6574df3e9e6579567cad12fff/samples/current/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -1841,7 +1841,7 @@ allow if true; |
|  |  |  |
|  |  | revocation ids: |
|  |  | - `470e4bf7aa2a01ab39c98150bd06aa15b4aa5d86509044a8809a8634cd8cf2b42269a51a774b65d10bac9369d013070b00187925196a8e680108473f11cf8f03` |
|  |  | - `93a7315ab1272da9eeef015f6fecbc9ac96fe4660e6204bf64ea2105ebe309e9c9cadc0a26c5604f13910fae3f2cd0800756afb6b6b208bf77adeb1ab2f42405` |
|  |  | - `342167bc54bc642b6718a276875e55b6d39e9b21e4ce13b926a3d398b6c057fc436385bf4c817a16f9ecdf0b0d950e8b8258a20aeb3fd8896c5e9c1f0a53da03` |
|  |  |  |
|  |  | authorizer world: |
|  |  | ``` |
| Expand Down  Expand Up | | @@ -2041,7 +2041,7 @@ check if true trusting previous, ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755 |
|  |  | 1: |
|  |  | symbols: [] |
|  |  |  |
|  |  | public keys: ["ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463"] |
|  |  | public keys: ["ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463", "ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5152947abc149bc20189"] |
|  |  |  |
|  |  | external signature by: "ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5152947abc149bc20189" |
|  |  |  |
| Expand All | | @@ -2055,7 +2055,7 @@ check if query(1) trusting ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5 |
|  |  | 2: |
|  |  | symbols: [] |
|  |  |  |
|  |  | public keys: [] |
|  |  | public keys: ["ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463", "ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5152947abc149bc20189"] |
|  |  |  |
|  |  | external signature by: "ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463" |
|  |  |  |
| Expand All | | @@ -2068,7 +2068,7 @@ check if query(1) trusting ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5 |
|  |  | 3: |
|  |  | symbols: [] |
|  |  |  |
|  |  | public keys: [] |
|  |  | public keys: ["ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463", "ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5152947abc149bc20189"] |
|  |  |  |
|  |  | external signature by: "ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463" |
|  |  |  |
| Expand All | | @@ -2081,7 +2081,7 @@ check if query(1) trusting ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5 |
|  |  | 4: |
|  |  | symbols: [] |
|  |  |  |
|  |  | public keys: ["ed25519/f98da8c1cf907856431bfc3dc87531e0eaadba90f919edc232405b85877ef136"] |
|  |  | public keys: ["ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463", "ed25519/f98da8c1cf907856431bfc3dc87531e0eaadba90f919edc232405b85877ef136"] |
|  |  |  |
|  |  | ``` |
|  |  | query(4); |
| Expand All | | @@ -2103,10 +2103,10 @@ allow if true; |
|  |  |  |
|  |  | revocation ids: |
|  |  | - `3771cefe71beb21ead35a59c8116ee82627a5717c0295f35980662abccb159fe1b37848cb1818e548656bd4fd882d0094a2daab631c76b2b72e3a093914bfe04` |
|  |  | - `45133b90f228a81fe4d3042a79f6c6b7608e656e903d6b1f4db32cd774b09b8315af360879a5f210ad7be37ff55e3eb34f237bcc9711407b6329ac6018bfb400` |
|  |  | - `179f054f3c572646aba5013159ae192ac42f5666dbdd984129955f4652b6829e59f54aa251e451f96329d42a2524ce569c3e1ec52e708b642dd8994af51dd703` |
|  |  | - `edab54789d6656936fcd28200b9c61643434842d531f09f209fad555e11ff53174db174dafba126e6de448983a56f78d2042bc5782d71a45799c022fe69fb30d` |
|  |  | - `6a62306831e9dbe83e7b33db96b758c77dd690930f2d2d87e239b210b1944c5582bf6d7e1bfea8e7f928c27f2fff0e2ee2e0adc41e11e0c3abe8d7b96b9ede07` |
|  |  | - `6528db2c9a561ada9086268549a600a8a52ff434ea8183812623eec0e9b6c5d3c41ab7868808623021d92294d583afdf92f4354bcdaa1bc50453e1b89afd630d` |
|  |  | - `5d5679fe69bfe74b7919323515e9ecba9d01422b16be9341b57f88e695b2bb0bd7966b781001d2b9e00ee618fdc239c96e17e32cb379f13f12d6bd7b1b47ad04` |
|  |  | - `c37bf24c063f0310eccab8864e48dbeffcdd7240b4f8d1e01eba4fc703e6c9082b845bb55543b10f008dc7f4e78540411912ac1f36fa2aa90011dca40f323b09` |
|  |  | - `3f675d6c364e06405d4868c904e40f3d81c32b083d91586db814d4cb4bf536b4ba209d82f11b4cb6da293b60b20d6122fc3e0e08e80c381dee83edd848211900` |
|  |  |  |
|  |  | authorizer world: |
|  |  | ``` |
| Expand Down | |  |

24 changes: 16 additions & 8 deletions

24
[samples/current/samples.json](#diff-ef94dc3ba2c3d81a0a95fd0e2ac9a3d01c729dac8b0bbb955d18d406d08e9a4d "samples/current/samples.json")

Show comments

[View file](/biscuit-auth/biscuit/blob/c87cbb5d778964d6574df3e9e6579567cad12fff/samples/current/samples.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1798,7 +1798,7 @@ |
|  |  | "authorizer\_code": "allow if true;\n", |
|  |  | "revocation\_ids": [ |
|  |  | "470e4bf7aa2a01ab39c98150bd06aa15b4aa5d86509044a8809a8634cd8cf2b42269a51a774b65d10bac9369d013070b00187925196a8e680108473f11cf8f03", |
|  |  | "93a7315ab1272da9eeef015f6fecbc9ac96fe4660e6204bf64ea2105ebe309e9c9cadc0a26c5604f13910fae3f2cd0800756afb6b6b208bf77adeb1ab2f42405" |
|  |  | "342167bc54bc642b6718a276875e55b6d39e9b21e4ce13b926a3d398b6c057fc436385bf4c817a16f9ecdf0b0d950e8b8258a20aeb3fd8896c5e9c1f0a53da03" |
|  |  | ] |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -1939,26 +1939,34 @@ |
|  |  | { |
|  |  | "symbols": [], |
|  |  | "public\_keys": [ |
|  |  | "ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463" |
|  |  | "ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463", |
|  |  | "ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5152947abc149bc20189" |
|  |  | ], |
|  |  | "external\_key": "ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5152947abc149bc20189", |
|  |  | "code": "query(1);\nquery(1, 2) <- query(1), query(2) trusting ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463;\ncheck if query(2), query(3) trusting ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463;\ncheck if query(1) trusting ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5152947abc149bc20189;\n" |
|  |  | }, |
|  |  | { |
|  |  | "symbols": [], |
|  |  | "public\_keys": [], |
|  |  | "public\_keys": [ |
|  |  | "ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463", |
|  |  | "ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5152947abc149bc20189" |
|  |  | ], |
|  |  | "external\_key": "ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463", |
|  |  | "code": "query(2);\ncheck if query(2), query(3) trusting ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463;\ncheck if query(1) trusting ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5152947abc149bc20189;\n" |
|  |  | }, |
|  |  | { |
|  |  | "symbols": [], |
|  |  | "public\_keys": [], |
|  |  | "public\_keys": [ |
|  |  | "ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463", |
|  |  | "ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5152947abc149bc20189" |
|  |  | ], |
|  |  | "external\_key": "ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463", |
|  |  | "code": "query(3);\ncheck if query(2), query(3) trusting ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463;\ncheck if query(1) trusting ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5152947abc149bc20189;\n" |
|  |  | }, |
|  |  | { |
|  |  | "symbols": [], |
|  |  | "public\_keys": [ |
|  |  | "ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463", |
|  |  | "ed25519/f98da8c1cf907856431bfc3dc87531e0eaadba90f919edc232405b85877ef136" |
|  |  | ], |
|  |  | "external\_key": null, |
| Expand Down  Expand Up | | @@ -2082,10 +2090,10 @@ |
|  |  | "authorizer\_code": "check if query(1, 2) trusting ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5152947abc149bc20189, ed25519/a060270db7e9c9f06e8f9cc33a64e99f6596af12cb01c4b638df8afc7b642463;\n\ndeny if query(3);\ndeny if query(1, 2);\ndeny if query(0) trusting ed25519/acdd6d5b53bfee478bf689f8e012fe7988bf755e3d7c5152947abc149bc20189;\nallow if true;\n", |
|  |  | "revocation\_ids": [ |
|  |  | "3771cefe71beb21ead35a59c8116ee82627a5717c0295f35980662abccb159fe1b37848cb1818e548656bd4fd882d0094a2daab631c76b2b72e3a093914bfe04", |
|  |  | "45133b90f228a81fe4d3042a79f6c6b7608e656e903d6b1f4db32cd774b09b8315af360879a5f210ad7be37ff55e3eb34f237bcc9711407b6329ac6018bfb400", |
|  |  | "179f054f3c572646aba5013159ae192ac42f5666dbdd984129955f4652b6829e59f54aa251e451f96329d42a2524ce569c3e1ec52e708b642dd8994af51dd703", |
|  |  | "edab54789d6656936fcd28200b9c61643434842d531f09f209fad555e11ff53174db174dafba126e6de448983a56f78d2042bc5782d71a45799c022fe69fb30d", |
|  |  | "6a62306831e9dbe83e7b33db96b758c77dd690930f2d2d87e239b210b1944c5582bf6d7e1bfea8e7f928c27f2fff0e2ee2e0adc41e11e0c3abe8d7b96b9ede07" |
|  |  | "6528db2c9a561ada9086268549a600a8a52ff434ea8183812623eec0e9b6c5d3c41ab7868808623021d92294d583afdf92f4354bcdaa1bc50453e1b89afd630d", |
|  |  | "5d5679fe69bfe74b7919323515e9ecba9d01422b16be9341b57f88e695b2bb0bd7966b781001d2b9e00ee618fdc239c96e17e32cb379f13f12d6bd7b1b47ad04", |
|  |  | "c37bf24c063f0310eccab8864e48dbeffcdd7240b4f8d1e01eba4fc703e6c9082b845bb55543b10f008dc7f4e78540411912ac1f36fa2aa90011dca40f323b09", |
|  |  | "3f675d6c364e06405d4868c904e40f3d81c32b083d91586db814d4cb4bf536b4ba209d82f11b4cb6da293b60b20d6122fc3e0e08e80c381dee83edd848211900" |
|  |  | ] |
|  |  | } |
|  |  | } |
| Expand Down | |  |

Binary file modified
BIN
+0 Bytes
(100%)

[samples/current/test024\_third\_party.bc](#diff-e660cf0ce8dc93ac6406633cf0f14b77493ee69a2fac3b4c7e0805c0eac9571e "samples/current/test024_third_party.bc")

Show comments

[View file](/biscuit-auth/biscuit/blob/c87cbb5d778964d6574df3e9e6579567cad12fff/samples/current/test024_third_party.bc)
Edit file

Delete file

Binary file not shown.

Binary file modified
BIN
+231 Bytes
(120%)

[samples/current/test026\_public\_keys\_interning.bc](#diff-b6717dd4356cbc569158d0a713284abf88ebd92e6600194d62ba4c12055ef031 "samples/current/test026_public_keys_interning.bc")

Show comments

[View file](/biscuit-auth/biscuit/blob/c87cbb5d778964d6574df3e9e6579567cad12fff/samples/current/test026_public_keys_interning.bc)
Edit file

Delete file

Binary file not shown.

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c87cbb5`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbiscuit-auth%2Fbiscuit%2Fcommit%2Fc87cbb5d778964d6574df3e9e6579567cad12fff) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c91c235b_20250111_160500.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbiscuit-auth%2Fbiscuit%2Fsecurity%2Fadvisories%2FGHSA-rgqv-mwc3-c78m)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbiscuit-auth%2Fbiscuit%2Fsecurity%2Fadvisories%2FGHSA-rgqv-mwc3-c78m)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=biscuit-auth%2Fbiscuit)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[biscuit-auth](/biscuit-auth)
/
**[biscuit](/biscuit-auth/biscuit)**
Public

* [Notifications](/login?return_to=%2Fbiscuit-auth%2Fbiscuit) You must be signed in to change notification settings
* [Fork
  25](/login?return_to=%2Fbiscuit-auth%2Fbiscuit)
* [Star
   987](/login?return_to=%2Fbiscuit-auth%2Fbiscuit)

* [Code](/biscuit-auth/biscuit)
* [Issues
  34](/biscuit-auth/biscuit/issues)
* [Pull requests
  0](/biscuit-auth/biscuit/pulls)
* [Actions](/biscuit-auth/biscuit/actions)
* [Projects
  1](/biscuit-auth/biscuit/projects)
* [Security](/biscuit-auth/biscuit/security)
* [Insights](/biscuit-auth/biscuit/pulse)

Additional navigation options

* [Code](/biscuit-auth/biscuit)
* [Issues](/biscuit-auth/biscuit/issues)
* [Pull requests](/biscuit-auth/biscuit/pulls)
* [Actions](/biscuit-auth/biscuit/actions)
* [Projects](/biscuit-auth/biscuit/projects)
* [Security](/biscuit-auth/biscuit/security)
* [Insights](/biscuit-auth/biscuit/pulse)

# Public key confusion in third party block

Low

[Geal](/Geal)
published
GHSA-rgqv-mwc3-c78m
Jul 31, 2024

## Package

cargo

biscuit-auth
([Rust](/advisories?query=ecosystem%3Arust))

## Affected versions

4

## Patched versions

5.0.0

maven

org.biscuitsec.biscuit
([Maven](/advisories?query=ecosystem%3Amaven))

3

4

specification
(Biscuit)

3

4

## Description

Third-party blocks can be generated without transferring the whole token to the third-party authority. Instead, a `ThirdPartyBlock` request can be sent, providing only the necessary info to generate a third-party block and to sign it:

* the public key of the previous block (used in the signature)
* the public keys part of the token symbol table (for public key interning in datalog expressions)

A third-part block request forged by a malicious user can trick the third-party authority into generating datalog trusting the wrong keypair.

Consider the following example (nominal case)

* Authority `A` emits the following token: `check if thirdparty("b") trusting ${pubkeyB}`
* The well-behaving holder then generates a third-party block request based on the token and sends it to third-party authority `B`
* Third-party `B` generates the following third-party block `thirdparty("b"); check if thirdparty("c") trusting ${pubkeyC}`
* The token holder now must obtain a third-party block from third party `C` to be able to use the token

Now, with a malicious user:

* Authority `A` emits the following token: `check if thirdparty("b") trusting ${pubkeyB}`
* The holder then attenuates the token with the following third party block `thirdparty("c")`, signed with a keypair `pubkeyD, privkeyD)` they generate
* The holder then generates a third-party block request based on this token, but alter the `ThirdPartyBlockRequest` `publicKeys` field and replace `pubkeyD` with `pubkeyC`
* Third-party `B` generates the following third-party block `thirdparty("b"); check if thirdparty("c") trusting ${pubkeyC}`
* Due to the altered symbol table, the actual meaning of the block is `thirdparty("b"); check if thirdparty("c") trusting ${pubkeyD}`
* The attacker can now use the token without obtaining a third-party block from `C`.

### Impact

Tokens with third-party blocks containing `trusted` annotations generated through a third party block request

### Severity

Low

3.0

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
High

User interaction
None

Scope
Changed

Confidentiality
None

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:L/A:N

### CVE ID

CVE-2024-42350

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


