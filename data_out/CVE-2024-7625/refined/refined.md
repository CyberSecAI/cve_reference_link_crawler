- **Root cause of vulnerability**: The archive unpacking process during migration of allocation directories does not properly remove existing files in paths within the same allocation directory. This allows a malicious actor to craft an archive that, when unpacked, writes files to paths outside of the intended allocation directory because the unpacking does not properly handle multiple archive headers targeting the same file.
- **Weaknesses/vulnerabilities present**: Improper handling of archive unpacking during allocation migration, specifically the lack of proper sanitization and removal of existing files when multiple archive headers target the same file. This allows for writing files outside the intended allocation directory.
- **Impact of exploitation**: Arbitrary file writes outside of the intended allocation directory, potentially leading to privilege escalation, data compromise, or other malicious activities.
- **Attack vectors**: The vulnerability is exploited by crafting a malicious archive that, when unpacked during an allocation migration, writes files to unintended locations.
- **Required attacker capabilities/position**: The attacker needs to have access or compromise the Nomad client agent at the source allocation before they can leverage the vulnerability.