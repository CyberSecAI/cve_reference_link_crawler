

[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
60d9902b**

authored
Nov 15, 2020
by
**[![Jason Graham's avatar](https://secure.gravatar.com/avatar/bc7f5b95d7daaa6302054e899826b5e5e44da5d18d8f91e4db9dae957e5f7c7b?s=96&d=identicon "Jason Graham")](/jgraha8)
[Jason Graham](/jgraha8)**

[Browse files](/oath-toolkit/oath-toolkit/-/tree/60d9902b5c20f27e70f8e9c816bfdc0467567e1a)

### Added support for user based placeholder values in pam\_oath usersfile string.

```

These changes introduce the the "${USER}" and "${HOME}" placeholder
values for the "usersfile" string in the pam_oath configuration
file. The placeholder values allow the user credentials file to be
stored in a file path that is relative to the user, and mimicks
similar behavior found in google-authenticator-libpam.

The motivation for these changes is to allow for non-privileged
processes to use pam_oath (e.g., for 2FA with
xscreensaver). Non-priviledged and non-suid programs are unable to use
pam_oath. These changes are a proposed alternative to a suid helper
binary as well.

The user credential file ownership is automatically adjusted if
"${USER}" and/or "${HOME}" is used. The default is the owner of the
calling process (as returned by getuid()), but if either placeholder
is used the UID of the user is obtained from
pam_modutil_getpwnam(). The ownership is changed just prior the
renaming the new modified user crediential file, while the lock is in
place.
```

parent
[04943fe1](/oath-toolkit/oath-toolkit/-/commit/04943fe17b5e33ee875ec6f03c3f00036bd69f4c)

Loading

Loading

Loading

* [Changes
  6](/oath-toolkit/oath-toolkit/-/commit/60d9902b5c20f27e70f8e9c816bfdc0467567e1a)

[Hide whitespace changes](/oath-toolkit/oath-toolkit/-/commit/60d9902b5c20f27e70f8e9c816bfdc0467567e1a?action=show&controller=projects%2Fcommit&id=60d9902b5c20f27e70f8e9c816bfdc0467567e1a&namespace_id=oath-toolkit&project_id=oath-toolkit&w=1)
[Inline](/oath-toolkit/oath-toolkit/-/commit/60d9902b5c20f27e70f8e9c816bfdc0467567e1a?view=inline)
[Side-by-side](/oath-toolkit/oath-toolkit/-/commit/60d9902b5c20f27e70f8e9c816bfdc0467567e1a?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment

