<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- templates/en/article.html
     $Id: article.html,v 1.1 2020/01/27 18:39:21 karl Exp $ -->
<HTML>
 <HEAD>
   <TITLE>Possible SEGV (null pointer dereferene) in tounicode.c - tex-live mailing list - TeX Users Group
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:tex-live%40tug.org?Subject=Re:%20Re%3A%20Possible%20SEGV%20%28null%20pointer%20dereferene%29%20in%20tounicode.c&In-Reply-To=%3CCAHw3Fwfb1H-XxuJsL7o4N2U5xHU1yJNaO_xLkEr1qVstVBhZEQ%40mail.gmail.com%3E">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="049418.html">
   <LINK REL="Next"  HREF="049415.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
      <ul>
         <li><b><a href="../">Archives for this list</a></b>.</li>

         <li><b><a href="https://tug.org/mailman/listinfo/tex-live">More information about this list</a></b>,
         or <a href="https://lists.tug.org/">all TUG lists</a>
         (or <a href="/">TUG home page</a>).</li>

<li>
   <form method=get action="//duckduckgo.com/">
     <input type="hidden" name="sites" value="tug.org/pipermail/tex-live">
     <input name=q size=20 maxlength=99 placeholder="Search list archives"
    ><input type=submit value="Search list archives">
     <small>(via&nbsp;<a href="https://duckduckgo.com/">DuckDuckGo</a>)</small>
    </form>
</li>
      </ul>

   <H1>Possible SEGV (null pointer dereferene) in tounicode.c</H1>
    <B>Gregory James DUCK</B> 
    <A HREF="mailto:tex-live%40tug.org?Subject=Re:%20Re%3A%20Possible%20SEGV%20%28null%20pointer%20dereferene%29%20in%20tounicode.c&In-Reply-To=%3CCAHw3Fwfb1H-XxuJsL7o4N2U5xHU1yJNaO_xLkEr1qVstVBhZEQ%40mail.gmail.com%3E"
       TITLE="Possible SEGV (null pointer dereferene) in tounicode.c">gjduck at gmail.com
       </A><BR>
    <I>Mon Aug 28 07:01:56 CEST 2023</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="049418.html">Upgrade failure and corrupted installation ?
</A></li>
        <LI>Next message (by thread): <A HREF="049415.html">Possible SEGV (null pointer dereferene) in tounicode.c
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49406">[ date ]</a>
              <a href="thread.html#49406">[ thread ]</a>
              <a href="subject.html#49406">[ subject ]</a>
              <a href="author.html#49406">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Thanks for promptly addressing the writet1.c issue.  I have also found
another possible SEGV (null pointer deref) in
texk/web2c/pdftexdir/tounicode.c.  The relevant code snippet is:

        glyph_unicode_entry *gu = new_glyph_unicode_entry();
        undumpcharptr(gu-&gt;name);
        ...
        result = avl_probe(glyph_unicode_tree, gu);

Under some conditions it appears that the undumpcharptr() macro can &quot;fail&quot;
in which case gu-&gt;name will be set to NULL (see the definition for
undumpcharptr).  This causes a SEGV inside avl_probe() when the comparison
function (comp_glyph_unicode_entry) calls strcmp() on the names, one of
which is NULL.

I can only reproduce this with pdflatex and the attached (corrupt)
pdflatex.fmt file, but the code appears to be part of the pdftex core.

Stack trace:

Program received signal SIGSEGV, Segmentation fault.
__strcmp_sse42 () at ../sysdeps/x86_64/multiarch/strcmp-sse4_2.S:173
...
#0  __strcmp_sse42 () at ../sysdeps/x86_64/multiarch/strcmp-sse4_2.S:173
#1  0x000055555563c0c3 in avl_probe (tree=0x5555558381c0,
item=0x555555a61210) at ../../../texk/web2c/pdftexdir/avl.c:102
#2  0x00005555555c4110 in undumptounicode () at
../../../texk/web2c/pdftexdir/tounicode.c:528
#3  loadfmtfile () at
/usr/src/texlive-bin-2022.20220321.62855-5ubuntu0.1/Work/texk/web2c/pdftexini.c:4288
#4  0x00005555555afaf5 in mainbody () at
/usr/src/texlive-bin-2022.20220321.62855-5ubuntu0.1/Work/texk/web2c/pdftexini.c:5478
#5  main (ac=&lt;optimized out&gt;, av=&lt;optimized out&gt;) at
../../../texk/web2c/lib/texmfmp.c:1175


Software version:

pdfTeX 3.141592653-2.6-1.40.24 (TeX Live 2022/Debian)
kpathsea version 6.3.4
Copyright 2022 Han The Thanh (pdfTeX) et al.


The latest dev code appears unchanged.  The problem can be reproduced (at
least for me) by putting the attached pdflatex.fmt into the current
directory then compiling something with pdflatex.

This is the last SEGV I found so far and the others appear to be duplicates.

-Greg.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://tug.org/pipermail/tex-live/attachments/20230828/afc6d4ce/attachment-0001.htm">https://tug.org/pipermail/tex-live/attachments/20230828/afc6d4ce/attachment-0001.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pdflatex.fmt
Type: application/octet-stream
Size: 6447104 bytes
Desc: not available
URL: &lt;<A HREF="https://tug.org/pipermail/tex-live/attachments/20230828/afc6d4ce/attachment-0001.obj">https://tug.org/pipermail/tex-live/attachments/20230828/afc6d4ce/attachment-0001.obj</A>&gt;
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="049418.html">Upgrade failure and corrupted installation ?
</A></li>
	<LI>Next message (by thread): <A HREF="049415.html">Possible SEGV (null pointer dereferene) in tounicode.c
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49406">[ date ]</a>
              <a href="thread.html#49406">[ thread ]</a>
              <a href="subject.html#49406">[ subject ]</a>
              <a href="author.html#49406">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://tug.org/mailman/listinfo/tex-live">More information about the tex-live
mailing list</a>.<br>
</body></html>
