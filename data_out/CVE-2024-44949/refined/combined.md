=== Content from git.kernel.org_499bd151_20250111_190128.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-17 10:06:00 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:07:22 +0100 |
| commit | [3dfd8991ad33b10c2fb027a4cfcf57579fa786c1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1)) | |
| tree | [4866a9046654da19897a424b4ad7c6ce5d31d0f3](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1) | |
| parent | [f585c5793aca1186129a7c26009cc7ed077eb0b0](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f585c5793aca1186129a7c26009cc7ed077eb0b0) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1&id2=f585c5793aca1186129a7c26009cc7ed077eb0b0)) | |
| download | [linux-3dfd8991ad33b10c2fb027a4cfcf57579fa786c1.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3dfd8991ad33b10c2fb027a4cfcf57579fa786c1.tar.gz) | |

Revert "parisc: fix a possible DMA corruption"This reverts commit dadac97f066a67334268132c1e2d0fd599fbcbec which is
commit 7ae04ba36b381bffe2471eff3a93edced843240f upstream.
It is reported to cause build failures.
Reported-by: Guenter Roeck <linux@roeck-us.net>
Link: [https://lore.kernel.org/r/436a575b-4ec0-43a2-b4e9-7eb00d9bbbeb@roeck-us.net](https://lore.kernel.org/r/436a575b-4ec0-43a2-b4e9-7eb00d9bbbeb%40roeck-us.net)
Cc: Mikulas Patocka <mpatocka@redhat.com>
Cc: Helge Deller <deller@gmx.de>
Cc: Mingli Yu <mingli.yu@windriver.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1)

| -rw-r--r-- | [arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/parisc/Kconfig?id=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/parisc/include/asm/cache.h?id=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1) | 11 | |  |  |  | | --- | --- | --- | |

2 files changed, 1 insertions, 11 deletions

| diff --git a/arch/parisc/Kconfig b/arch/parisc/Kconfigindex 9888e0b3f67518..6ac0c4b98e2813 100644--- a/[arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/Kconfig?id=f585c5793aca1186129a7c26009cc7ed077eb0b0)+++ b/[arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/Kconfig?id=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1)@@ -15,7 +15,6 @@ config PARISC select ARCH\_SPLIT\_ARG64 if !64BIT select ARCH\_SUPPORTS\_HUGETLBFS if PA20 select ARCH\_SUPPORTS\_MEMORY\_FAILURE- select ARCH\_HAS\_CACHE\_LINE\_SIZE select DMA\_OPS select RTC\_CLASS select RTC\_DRV\_GENERICdiff --git a/arch/parisc/include/asm/cache.h b/arch/parisc/include/asm/cache.hindex 99e26c686f7ffb..d53e9e27dba007 100644--- a/[arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/include/asm/cache.h?id=f585c5793aca1186129a7c26009cc7ed077eb0b0)+++ b/[arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/include/asm/cache.h?id=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1)@@ -20,16 +20,7 @@  #define SMP\_CACHE\_BYTES L1\_CACHE\_BYTES -#ifdef CONFIG\_PA20-#define ARCH\_DMA\_MINALIGN 128-#else-#define ARCH\_DMA\_MINALIGN 32-#endif-#define ARCH\_KMALLOC\_MINALIGN 16 /\* ldcw requires 16-byte alignment \*/--#define arch\_slab\_minalign() ((unsigned)dcache\_stride)-#define cache\_line\_size() dcache\_stride-#define dma\_get\_cache\_alignment cache\_line\_size+#define ARCH\_DMA\_MINALIGN L1\_CACHE\_BYTES  #define \_\_read\_mostly \_\_section(".data..read\_mostly") |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 19:00:05 +0000



=== Content from git.kernel.org_1cb6b8b7_20250111_190129.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=7ae04ba36b381bffe2471eff3a93edced843240f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7ae04ba36b381bffe2471eff3a93edced843240f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7ae04ba36b381bffe2471eff3a93edced843240f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7ae04ba36b381bffe2471eff3a93edced843240f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Mikulas Patocka <mpatocka@redhat.com> | 2024-07-27 20:22:52 +0200 |
| --- | --- | --- |
| committer | Helge Deller <deller@gmx.de> | 2024-07-29 16:19:07 +0200 |
| commit | [7ae04ba36b381bffe2471eff3a93edced843240f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7ae04ba36b381bffe2471eff3a93edced843240f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=7ae04ba36b381bffe2471eff3a93edced843240f)) | |
| tree | [21ffe22db1baa2cfa54ac2feffca011bffc94c9f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7ae04ba36b381bffe2471eff3a93edced843240f) | |
| parent | [1fd2c10acb7b35d72101a4619ee5b2cddb9efd3a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1fd2c10acb7b35d72101a4619ee5b2cddb9efd3a) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7ae04ba36b381bffe2471eff3a93edced843240f&id2=1fd2c10acb7b35d72101a4619ee5b2cddb9efd3a)) | |
| download | [linux-7ae04ba36b381bffe2471eff3a93edced843240f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-7ae04ba36b381bffe2471eff3a93edced843240f.tar.gz) | |

parisc: fix a possible DMA corruptionARCH\_DMA\_MINALIGN was defined as 16 - this is too small - it may be
possible that two unrelated 16-byte allocations share a cache line. If
one of these allocations is written using DMA and the other is written
using cached write, the value that was written with DMA may be
corrupted.
This commit changes ARCH\_DMA\_MINALIGN to be 128 on PA20 and 32 on PA1.1 -
that's the largest possible cache line size.
As different parisc microarchitectures have different cache line size, we
define arch\_slab\_minalign(), cache\_line\_size() and
dma\_get\_cache\_alignment() so that the kernel may tune slab cache
parameters dynamically, based on the detected cache line size.
Signed-off-by: Mikulas Patocka <mpatocka@redhat.com>
Cc: stable@vger.kernel.org
Signed-off-by: Helge Deller <deller@gmx.de>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7ae04ba36b381bffe2471eff3a93edced843240f)

| -rw-r--r-- | [arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/parisc/Kconfig?id=7ae04ba36b381bffe2471eff3a93edced843240f) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/parisc/include/asm/cache.h?id=7ae04ba36b381bffe2471eff3a93edced843240f) | 11 | |  |  |  | | --- | --- | --- | |

2 files changed, 11 insertions, 1 deletions

| diff --git a/arch/parisc/Kconfig b/arch/parisc/Kconfigindex 5d650e02cbf4a3..b0a2ac3ba91610 100644--- a/[arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/Kconfig?id=1fd2c10acb7b35d72101a4619ee5b2cddb9efd3a)+++ b/[arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/Kconfig?id=7ae04ba36b381bffe2471eff3a93edced843240f)@@ -20,6 +20,7 @@ config PARISC select ARCH\_SUPPORTS\_HUGETLBFS if PA20 select ARCH\_SUPPORTS\_MEMORY\_FAILURE select ARCH\_STACKWALK+ select ARCH\_HAS\_CACHE\_LINE\_SIZE select ARCH\_HAS\_DEBUG\_VM\_PGTABLE select HAVE\_RELIABLE\_STACKTRACE select DMA\_OPSdiff --git a/arch/parisc/include/asm/cache.h b/arch/parisc/include/asm/cache.hindex 2a60d7a72f1fa8..a3f0f100f21949 100644--- a/[arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/include/asm/cache.h?id=1fd2c10acb7b35d72101a4619ee5b2cddb9efd3a)+++ b/[arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/include/asm/cache.h?id=7ae04ba36b381bffe2471eff3a93edced843240f)@@ -20,7 +20,16 @@  #define SMP\_CACHE\_BYTES L1\_CACHE\_BYTES -#define ARCH\_DMA\_MINALIGN L1\_CACHE\_BYTES+#ifdef CONFIG\_PA20+#define ARCH\_DMA\_MINALIGN 128+#else+#define ARCH\_DMA\_MINALIGN 32+#endif+#define ARCH\_KMALLOC\_MINALIGN 16 /\* ldcw requires 16-byte alignment \*/++#define arch\_slab\_minalign() ((unsigned)dcache\_stride)+#define cache\_line\_size() dcache\_stride+#define dma\_get\_cache\_alignment cache\_line\_size  #define \_\_read\_mostly \_\_section(".data..read\_mostly") |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 19:00:07 +0000



=== Content from git.kernel.org_f8c16e39_20250111_190128.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=00baca74fb5879e5f9034b6156671301f500f8ee)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=00baca74fb5879e5f9034b6156671301f500f8ee)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=00baca74fb5879e5f9034b6156671301f500f8ee)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=00baca74fb5879e5f9034b6156671301f500f8ee)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Mikulas Patocka <mpatocka@redhat.com> | 2024-07-27 20:22:52 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-22 15:37:35 +0100 |
| commit | [00baca74fb5879e5f9034b6156671301f500f8ee](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=00baca74fb5879e5f9034b6156671301f500f8ee) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=00baca74fb5879e5f9034b6156671301f500f8ee)) | |
| tree | [e824bbcd30765f143aa474d726f6dc897fc882f7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=00baca74fb5879e5f9034b6156671301f500f8ee) | |
| parent | [777595da53aa11e7e2fa0332a2c4b0511086be39](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=777595da53aa11e7e2fa0332a2c4b0511086be39) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=00baca74fb5879e5f9034b6156671301f500f8ee&id2=777595da53aa11e7e2fa0332a2c4b0511086be39)) | |
| download | [linux-00baca74fb5879e5f9034b6156671301f500f8ee.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-00baca74fb5879e5f9034b6156671301f500f8ee.tar.gz) | |

parisc: fix a possible DMA corruptioncommit 7ae04ba36b381bffe2471eff3a93edced843240f upstream.
ARCH\_DMA\_MINALIGN was defined as 16 - this is too small - it may be
possible that two unrelated 16-byte allocations share a cache line. If
one of these allocations is written using DMA and the other is written
using cached write, the value that was written with DMA may be
corrupted.
This commit changes ARCH\_DMA\_MINALIGN to be 128 on PA20 and 32 on PA1.1 -
that's the largest possible cache line size.
As different parisc microarchitectures have different cache line size, we
define arch\_slab\_minalign(), cache\_line\_size() and
dma\_get\_cache\_alignment() so that the kernel may tune slab cache
parameters dynamically, based on the detected cache line size.
Signed-off-by: Mikulas Patocka <mpatocka@redhat.com>
Cc: stable@vger.kernel.org
Signed-off-by: Helge Deller <deller@gmx.de>
Signed-off-by: Bin Lan <bin.lan.cn@windriver.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=00baca74fb5879e5f9034b6156671301f500f8ee)

| -rw-r--r-- | [arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/parisc/Kconfig?id=00baca74fb5879e5f9034b6156671301f500f8ee) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/parisc/include/asm/cache.h?id=00baca74fb5879e5f9034b6156671301f500f8ee) | 11 | |  |  |  | | --- | --- | --- | |

2 files changed, 11 insertions, 1 deletions

| diff --git a/arch/parisc/Kconfig b/arch/parisc/Kconfigindex 3341d4a4219903..3a32b49d7ad0d9 100644--- a/[arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/Kconfig?id=777595da53aa11e7e2fa0332a2c4b0511086be39)+++ b/[arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/Kconfig?id=00baca74fb5879e5f9034b6156671301f500f8ee)@@ -18,6 +18,7 @@ config PARISC select ARCH\_SUPPORTS\_HUGETLBFS if PA20 select ARCH\_SUPPORTS\_MEMORY\_FAILURE select ARCH\_STACKWALK+ select ARCH\_HAS\_CACHE\_LINE\_SIZE select ARCH\_HAS\_DEBUG\_VM\_PGTABLE select HAVE\_RELIABLE\_STACKTRACE select DMA\_OPSdiff --git a/arch/parisc/include/asm/cache.h b/arch/parisc/include/asm/cache.hindex e23d06b51a2044..91e753f08eaa3d 100644--- a/[arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/include/asm/cache.h?id=777595da53aa11e7e2fa0332a2c4b0511086be39)+++ b/[arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/include/asm/cache.h?id=00baca74fb5879e5f9034b6156671301f500f8ee)@@ -20,7 +20,16 @@  #define SMP\_CACHE\_BYTES L1\_CACHE\_BYTES -#define ARCH\_DMA\_MINALIGN L1\_CACHE\_BYTES+#ifdef CONFIG\_PA20+#define ARCH\_DMA\_MINALIGN 128+#else+#define ARCH\_DMA\_MINALIGN 32+#endif+#define ARCH\_KMALLOC\_MINALIGN 16 /\* ldcw requires 16-byte alignment \*/++#define arch\_slab\_minalign() ((unsigned)dcache\_stride)+#define cache\_line\_size() dcache\_stride+#define dma\_get\_cache\_alignment cache\_line\_size  #define \_\_read\_mostly \_\_section(".data..read\_mostly") |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 18:55:14 +0000



=== Content from git.kernel.org_748be1b2_20250111_190130.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=dadac97f066a67334268132c1e2d0fd599fbcbec)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=dadac97f066a67334268132c1e2d0fd599fbcbec)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dadac97f066a67334268132c1e2d0fd599fbcbec)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dadac97f066a67334268132c1e2d0fd599fbcbec)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Mikulas Patocka <mpatocka@redhat.com> | 2024-07-27 20:22:52 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:51:11 +0100 |
| commit | [dadac97f066a67334268132c1e2d0fd599fbcbec](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dadac97f066a67334268132c1e2d0fd599fbcbec) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=dadac97f066a67334268132c1e2d0fd599fbcbec)) | |
| tree | [aba2255870791089fb384db0e29cfa8c0b11e02c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=dadac97f066a67334268132c1e2d0fd599fbcbec) | |
| parent | [487b128f07b82294bd0847c2c462dfcf1de9660a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=487b128f07b82294bd0847c2c462dfcf1de9660a) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dadac97f066a67334268132c1e2d0fd599fbcbec&id2=487b128f07b82294bd0847c2c462dfcf1de9660a)) | |
| download | [linux-dadac97f066a67334268132c1e2d0fd599fbcbec.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-dadac97f066a67334268132c1e2d0fd599fbcbec.tar.gz) | |

parisc: fix a possible DMA corruptioncommit 7ae04ba36b381bffe2471eff3a93edced843240f upstream.
ARCH\_DMA\_MINALIGN was defined as 16 - this is too small - it may be
possible that two unrelated 16-byte allocations share a cache line. If
one of these allocations is written using DMA and the other is written
using cached write, the value that was written with DMA may be
corrupted.
This commit changes ARCH\_DMA\_MINALIGN to be 128 on PA20 and 32 on PA1.1 -
that's the largest possible cache line size.
As different parisc microarchitectures have different cache line size, we
define arch\_slab\_minalign(), cache\_line\_size() and
dma\_get\_cache\_alignment() so that the kernel may tune slab cache
parameters dynamically, based on the detected cache line size.
Signed-off-by: Mikulas Patocka <mpatocka@redhat.com>
Cc: stable@vger.kernel.org
Signed-off-by: Helge Deller <deller@gmx.de>
Signed-off-by: Mingli Yu <mingli.yu@windriver.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dadac97f066a67334268132c1e2d0fd599fbcbec)

| -rw-r--r-- | [arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/parisc/Kconfig?id=dadac97f066a67334268132c1e2d0fd599fbcbec) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/parisc/include/asm/cache.h?id=dadac97f066a67334268132c1e2d0fd599fbcbec) | 11 | |  |  |  | | --- | --- | --- | |

2 files changed, 11 insertions, 1 deletions

| diff --git a/arch/parisc/Kconfig b/arch/parisc/Kconfigindex 6ac0c4b98e2813..9888e0b3f67518 100644--- a/[arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/Kconfig?id=487b128f07b82294bd0847c2c462dfcf1de9660a)+++ b/[arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/Kconfig?id=dadac97f066a67334268132c1e2d0fd599fbcbec)@@ -15,6 +15,7 @@ config PARISC select ARCH\_SPLIT\_ARG64 if !64BIT select ARCH\_SUPPORTS\_HUGETLBFS if PA20 select ARCH\_SUPPORTS\_MEMORY\_FAILURE+ select ARCH\_HAS\_CACHE\_LINE\_SIZE select DMA\_OPS select RTC\_CLASS select RTC\_DRV\_GENERICdiff --git a/arch/parisc/include/asm/cache.h b/arch/parisc/include/asm/cache.hindex d53e9e27dba007..99e26c686f7ffb 100644--- a/[arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/include/asm/cache.h?id=487b128f07b82294bd0847c2c462dfcf1de9660a)+++ b/[arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/include/asm/cache.h?id=dadac97f066a67334268132c1e2d0fd599fbcbec)@@ -20,7 +20,16 @@  #define SMP\_CACHE\_BYTES L1\_CACHE\_BYTES -#define ARCH\_DMA\_MINALIGN L1\_CACHE\_BYTES+#ifdef CONFIG\_PA20+#define ARCH\_DMA\_MINALIGN 128+#else+#define ARCH\_DMA\_MINALIGN 32+#endif+#define ARCH\_KMALLOC\_MINALIGN 16 /\* ldcw requires 16-byte alignment \*/++#define arch\_slab\_minalign() ((unsigned)dcache\_stride)+#define cache\_line\_size() dcache\_stride+#define dma\_get\_cache\_alignment cache\_line\_size  #define \_\_read\_mostly \_\_section(".data..read\_mostly") |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 19:00:07 +0000



=== Content from git.kernel.org_79900456_20250111_190129.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=642a0b7453daff0295310774016fcb56d1f5bc7f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=642a0b7453daff0295310774016fcb56d1f5bc7f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=642a0b7453daff0295310774016fcb56d1f5bc7f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=642a0b7453daff0295310774016fcb56d1f5bc7f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Mikulas Patocka <mpatocka@redhat.com> | 2024-07-27 20:22:52 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-14 13:58:57 +0200 |
| commit | [642a0b7453daff0295310774016fcb56d1f5bc7f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=642a0b7453daff0295310774016fcb56d1f5bc7f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=642a0b7453daff0295310774016fcb56d1f5bc7f)) | |
| tree | [d917d6b5b3658a449a5176ebcf2428fe07df4210](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=642a0b7453daff0295310774016fcb56d1f5bc7f) | |
| parent | [8d26093f812476f53d0d23a1d42edf6261af226c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8d26093f812476f53d0d23a1d42edf6261af226c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=642a0b7453daff0295310774016fcb56d1f5bc7f&id2=8d26093f812476f53d0d23a1d42edf6261af226c)) | |
| download | [linux-642a0b7453daff0295310774016fcb56d1f5bc7f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-642a0b7453daff0295310774016fcb56d1f5bc7f.tar.gz) | |

parisc: fix a possible DMA corruptioncommit 7ae04ba36b381bffe2471eff3a93edced843240f upstream.
ARCH\_DMA\_MINALIGN was defined as 16 - this is too small - it may be
possible that two unrelated 16-byte allocations share a cache line. If
one of these allocations is written using DMA and the other is written
using cached write, the value that was written with DMA may be
corrupted.
This commit changes ARCH\_DMA\_MINALIGN to be 128 on PA20 and 32 on PA1.1 -
that's the largest possible cache line size.
As different parisc microarchitectures have different cache line size, we
define arch\_slab\_minalign(), cache\_line\_size() and
dma\_get\_cache\_alignment() so that the kernel may tune slab cache
parameters dynamically, based on the detected cache line size.
Signed-off-by: Mikulas Patocka <mpatocka@redhat.com>
Cc: stable@vger.kernel.org
Signed-off-by: Helge Deller <deller@gmx.de>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=642a0b7453daff0295310774016fcb56d1f5bc7f)

| -rw-r--r-- | [arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/parisc/Kconfig?id=642a0b7453daff0295310774016fcb56d1f5bc7f) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/parisc/include/asm/cache.h?id=642a0b7453daff0295310774016fcb56d1f5bc7f) | 11 | |  |  |  | | --- | --- | --- | |

2 files changed, 11 insertions, 1 deletions

| diff --git a/arch/parisc/Kconfig b/arch/parisc/Kconfigindex 2834a640649704..a077e6bf9475f5 100644--- a/[arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/Kconfig?id=8d26093f812476f53d0d23a1d42edf6261af226c)+++ b/[arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/Kconfig?id=642a0b7453daff0295310774016fcb56d1f5bc7f)@@ -18,6 +18,7 @@ config PARISC select ARCH\_SUPPORTS\_HUGETLBFS if PA20 select ARCH\_SUPPORTS\_MEMORY\_FAILURE select ARCH\_STACKWALK+ select ARCH\_HAS\_CACHE\_LINE\_SIZE select ARCH\_HAS\_DEBUG\_VM\_PGTABLE select HAVE\_RELIABLE\_STACKTRACE select DMA\_OPSdiff --git a/arch/parisc/include/asm/cache.h b/arch/parisc/include/asm/cache.hindex 2a60d7a72f1fa8..a3f0f100f21949 100644--- a/[arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/include/asm/cache.h?id=8d26093f812476f53d0d23a1d42edf6261af226c)+++ b/[arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/include/asm/cache.h?id=642a0b7453daff0295310774016fcb56d1f5bc7f)@@ -20,7 +20,16 @@  #define SMP\_CACHE\_BYTES L1\_CACHE\_BYTES -#define ARCH\_DMA\_MINALIGN L1\_CACHE\_BYTES+#ifdef CONFIG\_PA20+#define ARCH\_DMA\_MINALIGN 128+#else+#define ARCH\_DMA\_MINALIGN 32+#endif+#define ARCH\_KMALLOC\_MINALIGN 16 /\* ldcw requires 16-byte alignment \*/++#define arch\_slab\_minalign() ((unsigned)dcache\_stride)+#define cache\_line\_size() dcache\_stride+#define dma\_get\_cache\_alignment cache\_line\_size  #define \_\_read\_mostly \_\_section(".data..read\_mostly") |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 19:00:06 +0000



=== Content from git.kernel.org_87b7b29c_20250111_190128.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=533de2f470baac40d3bf622fe631f15231a03c9f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=533de2f470baac40d3bf622fe631f15231a03c9f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=533de2f470baac40d3bf622fe631f15231a03c9f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=533de2f470baac40d3bf622fe631f15231a03c9f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Mikulas Patocka <mpatocka@redhat.com> | 2024-07-27 20:22:52 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-14 15:34:31 +0200 |
| commit | [533de2f470baac40d3bf622fe631f15231a03c9f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=533de2f470baac40d3bf622fe631f15231a03c9f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=533de2f470baac40d3bf622fe631f15231a03c9f)) | |
| tree | [a5abd2e9843e4e1775fe81302d4f3dba0e0c582e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=533de2f470baac40d3bf622fe631f15231a03c9f) | |
| parent | [85841423394135d9eb771be59ce65dba5faa5b41](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=85841423394135d9eb771be59ce65dba5faa5b41) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=533de2f470baac40d3bf622fe631f15231a03c9f&id2=85841423394135d9eb771be59ce65dba5faa5b41)) | |
| download | [linux-533de2f470baac40d3bf622fe631f15231a03c9f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-533de2f470baac40d3bf622fe631f15231a03c9f.tar.gz) | |

parisc: fix a possible DMA corruptioncommit 7ae04ba36b381bffe2471eff3a93edced843240f upstream.
ARCH\_DMA\_MINALIGN was defined as 16 - this is too small - it may be
possible that two unrelated 16-byte allocations share a cache line. If
one of these allocations is written using DMA and the other is written
using cached write, the value that was written with DMA may be
corrupted.
This commit changes ARCH\_DMA\_MINALIGN to be 128 on PA20 and 32 on PA1.1 -
that's the largest possible cache line size.
As different parisc microarchitectures have different cache line size, we
define arch\_slab\_minalign(), cache\_line\_size() and
dma\_get\_cache\_alignment() so that the kernel may tune slab cache
parameters dynamically, based on the detected cache line size.
Signed-off-by: Mikulas Patocka <mpatocka@redhat.com>
Cc: stable@vger.kernel.org
Signed-off-by: Helge Deller <deller@gmx.de>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=533de2f470baac40d3bf622fe631f15231a03c9f)

| -rw-r--r-- | [arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/parisc/Kconfig?id=533de2f470baac40d3bf622fe631f15231a03c9f) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/parisc/include/asm/cache.h?id=533de2f470baac40d3bf622fe631f15231a03c9f) | 11 | |  |  |  | | --- | --- | --- | |

2 files changed, 11 insertions, 1 deletions

| diff --git a/arch/parisc/Kconfig b/arch/parisc/Kconfigindex 9656e956ed1353..4ecfa08ac3e1ff 100644--- a/[arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/Kconfig?id=85841423394135d9eb771be59ce65dba5faa5b41)+++ b/[arch/parisc/Kconfig](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/Kconfig?id=533de2f470baac40d3bf622fe631f15231a03c9f)@@ -20,6 +20,7 @@ config PARISC select ARCH\_SUPPORTS\_HUGETLBFS if PA20 select ARCH\_SUPPORTS\_MEMORY\_FAILURE select ARCH\_STACKWALK+ select ARCH\_HAS\_CACHE\_LINE\_SIZE select ARCH\_HAS\_DEBUG\_VM\_PGTABLE select HAVE\_RELIABLE\_STACKTRACE select DMA\_OPSdiff --git a/arch/parisc/include/asm/cache.h b/arch/parisc/include/asm/cache.hindex 2a60d7a72f1fa8..a3f0f100f21949 100644--- a/[arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/include/asm/cache.h?id=85841423394135d9eb771be59ce65dba5faa5b41)+++ b/[arch/parisc/include/asm/cache.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/include/asm/cache.h?id=533de2f470baac40d3bf622fe631f15231a03c9f)@@ -20,7 +20,16 @@  #define SMP\_CACHE\_BYTES L1\_CACHE\_BYTES -#define ARCH\_DMA\_MINALIGN L1\_CACHE\_BYTES+#ifdef CONFIG\_PA20+#define ARCH\_DMA\_MINALIGN 128+#else+#define ARCH\_DMA\_MINALIGN 32+#endif+#define ARCH\_KMALLOC\_MINALIGN 16 /\* ldcw requires 16-byte alignment \*/++#define arch\_slab\_minalign() ((unsigned)dcache\_stride)+#define cache\_line\_size() dcache\_stride+#define dma\_get\_cache\_alignment cache\_line\_size  #define \_\_read\_mostly \_\_section(".data..read\_mostly") |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 19:00:06 +0000


