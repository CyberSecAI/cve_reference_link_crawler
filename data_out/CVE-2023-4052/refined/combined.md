=== Content from www.mozilla.org_19ba0880_20250111_053732.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-31

## Security Vulnerabilities fixed in Firefox ESR 115.1

Announced
August 1, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.1

#### [#CVE-2023-4045: Offscreen Canvas could have bypassed cross-origin restrictions](#CVE-2023-4045)

Reporter
Max Vlasov
Impact
high
##### Description

Offscreen Canvas did not properly track cross-origin tainting, which could have been used to access image data from another site in violation of same-origin policy.

##### References

* [Bug 1833876](https://bugzilla.mozilla.org/show_bug.cgi?id=1833876)

#### [#CVE-2023-4046: Incorrect value used during WASM compilation](#CVE-2023-4046)

Reporter
Alexander Guryanov
Impact
high
##### Description

In some circumstances, a stale value could have been used for a global variable in WASM JIT analysis. This resulted in incorrect compilation and a potentially exploitable crash in the content process.

##### References

* [Bug 1837686](https://bugzilla.mozilla.org/show_bug.cgi?id=1837686)

#### [#CVE-2023-4047: Potential permissions request bypass via clickjacking](#CVE-2023-4047)

Reporter
Axel Chong (@Haxatron)
Impact
high
##### Description

A bug in popup notifications delay calculation could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1839073](https://bugzilla.mozilla.org/show_bug.cgi?id=1839073)

#### [#CVE-2023-4048: Crash in DOMParser due to out-of-memory conditions](#CVE-2023-4048)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An out-of-bounds read could have led to an exploitable crash when parsing HTML with DOMParser in low memory situations.

##### References

* [Bug 1841368](https://bugzilla.mozilla.org/show_bug.cgi?id=1841368)

#### [#CVE-2023-4049: Fix potential race conditions when releasing platform objects](#CVE-2023-4049)

Reporter
Nika Layzell
Impact
high
##### Description

Race conditions in reference counting code were found through code inspection. These could have resulted in potentially exploitable use-after-free vulnerabilities.

##### References

* [Bug 1842658](https://bugzilla.mozilla.org/show_bug.cgi?id=1842658)

#### [#CVE-2023-4050: Stack buffer overflow in StorageManager](#CVE-2023-4050)

Reporter
Mark Brand
Impact
high
##### Description

In some cases, an untrusted input stream was copied to a stack buffer without checking its size. This resulted in a potentially exploitable crash which could have led to a sandbox escape.

##### References

* [Bug 1843038](https://bugzilla.mozilla.org/show_bug.cgi?id=1843038)

#### [#CVE-2023-4052: File deletion and privilege escalation through Firefox uninstaller](#CVE-2023-4052)

Reporter
ycdxsb
Impact
moderate
##### Description

The Firefox updater created a directory writable by non-privileged users. When uninstalling Firefox, any files in that directory would be recursively deleted with the permissions of the uninstalling user account. This could be combined with creation of a junction (a form of symbolic link) to allow arbitrary file deletion controlled by the non-privileged user.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1824420](https://bugzilla.mozilla.org/show_bug.cgi?id=1824420)

#### [#CVE-2023-4054: Lack of warning when opening appref-ms files](#CVE-2023-4054)

Reporter
P Umar Farooq
Impact
moderate
##### Description

When opening appref-ms files, Firefox did not warn the user that these files may contain malicious code.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1840777](https://bugzilla.mozilla.org/show_bug.cgi?id=1840777)

#### [#CVE-2023-4055: Cookie jar overflow caused unexpected cookie jar state](#CVE-2023-4055)

Reporter
Marco Squarcina
Impact
low
##### Description

When the number of cookies per domain was exceeded in `document.cookie`, the actual cookie jar sent to the host was no longer consistent with expected cookie jar state. This could have caused requests to be sent with some cookies missing.

##### References

* [Bug 1782561](https://bugzilla.mozilla.org/show_bug.cgi?id=1782561)

#### [#CVE-2023-4056: Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](#CVE-2023-4056)

Reporter
Dianna Smith, Ryan VanderMeulen, Timothy Nikkel, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115, Firefox ESR 115.0, Firefox ESR 102.13, Thunderbird 115.0, and Thunderbird 102.13. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1820587%2C1824634%2C1839235%2C1842325%2C1843847)

#### [#CVE-2023-4057: Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1](#CVE-2023-4057)

Reporter
The Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115, Firefox ESR 115.0, and Thunderbird 115.0. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1](https://bugzilla.mozilla.org/show_bug.cgi?id=1841682)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_b894cad6_20250111_053731.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1824420)
* [XML](/show_bug.cgi?ctype=xml&id=1824420)

Closed
[Bug 1824420](/show_bug.cgi?id=1824420)
(CVE-2023-4052)

Opened 2 years ago
Closed 2 years ago

# Firefox arbitrary file delete vulnerability

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox arbitrary file delete vulnerability

## Categories

### (Toolkit :: Application Update, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Application%20Update#Application%20Update)

Application Update
▾

Toolkit :: Application Update
Application update for Firefox and Thunderbird.
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Application%20Update&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Application%20Update&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Application%20Update)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

116 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| Install Update Workflow | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox-esr115 | [116+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=116%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) |
| firefox114 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix) |
| firefox115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix) |
| firefox116 | [+](/buglist.cgi?f1=cf_tracking_firefox116&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | 116+ | fixed |
| firefox-esr128 | --- | --- |
| firefox114 |  | wontfix |
| firefox115 |  | wontfix |
| firefox116 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: ycdxsb, Assigned: bytesized)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/96e4252ea3aebe64d73acae0a509f240?d=mm&size=40)  [bytesized](/user_profile?user_id=563604)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/45a81f797965c96831c99679033b7669?d=mm&size=40)  [ycdxsb](/user_profile?user_id=638369)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/df0b9360050c9ba90f9e270a904eec20?d=mm&size=40)  [cdupuis](/user_profile?user_id=760375)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

24 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1840887](/show_bug.cgi?id=1840887 "RESOLVED FIXED - Port bug 1824420 to Thunderbird")

Dependency [tree](/showdependencytree.cgi?id=1824420&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1824420)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1918473](/show_bug.cgi?id=1918473 "RESOLVED FIXED - Fix missing `await` in `BackgroundTask_install.sys.mjs` and `BackgroundTask_uninstall.sys.mjs`")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1864758](/show_bug.cgi?id=1864758 "RESOLVED FIXED - Increase stub installer timeout")

## Details

### (Keywords: csectype-priv-escalation, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?] [adv-main116+] [adv-ESR115.1+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-4052

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?] [adv-main116+] [adv-ESR115.1+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a11235440_1689 "1 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 1 obsolete file)

| [Bug 1824420 - r=nalexander!](/attachment.cgi?id=9341189)  [2 years ago](#c11)  [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-esr115+](#c19 "2 years ago") | [Details](/attachment.cgi?id=9341189&action=edit) | [Review](/attachment.cgi?id=9341189) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9345938)  [1 years ago](#c34)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   565 bytes, text/plain |  | [Details](/attachment.cgi?id=9345938&action=edit) |
| [advisory.txt](/attachment.cgi?id=9346041)  [1 years ago](#c36)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   439 bytes, text/plain |  | [Details](/attachment.cgi?id=9346041&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Yu Chendong](/user_profile?user_id=638369)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1824420#c0)• 2 years ago |
|  | |

## Firefox arbitrary file detete vuln

## Basic Info

* Software Name: Firefox for Windows
* Software Version：111.0.1
* Test OS System：Windows 21H2 (19044.1826)
* Vuln Influence：Arbitrary File Delete，Local Privilege Escalation
* CWE：CWE-1386

## Vuln Analyse

After installing Firefox on Windows, a path similar to C:\ProgramData\Mozilla-1de4eec8-1241-4177-a864-e594e8d1fb38\updates\E7CF176E110C211B will be created in the operating system. When an administrator uninstalls Firefox, the uninstall program will recursively delete all files and folders under this path.

* Problem 1：The permission of directory C:\ProgramData\Mozilla-1de4eec8-1241-4177-a864-e594e8d1fb38\updates\E7CF176E110C211B allow all user in Users group add file and directory in it.

```
C:\ProgramData\Mozilla-1de4eec8-1241-4177-a864-e594e8d1fb38\updates>icacls E7CF176E110C211B
E7CF176E110C211B BUILTIN\Users:(I)(OI)(CI)(F)
                 BUILTIN\Administrators:(I)(OI)(CI)(F)
                 NT AUTHORITY\SYSTEM:(I)(OI)(CI)(F)

```

* Problem 2：On Windows, the recursive deletion feature can be exploited using symbolic links for attacks. For example, by creating a junction link for C:\ProgramData\Mozilla-1de4eec8-1241-4177-a864-e594e8d1fb38\updates\E7CF176E110C211B\poc and other paths, arbitrary file deletion can be achieved.

## Proof Of Concept

We can finally get a system shell by trick listing here：<https://www.zerodayinitiative.com/blog/2022/3/16/abusing-arbitrary-file-deletes-to-escalate-privilege-and-other-great-tricks>.

In this part, we only proof the arbitrary file delete vuln.

1. an low privilege user attacker create a junction between C:\ProgramData\Mozilla-1de4eec8-1241-4177-a864-e594e8d1fb38\updates\E7CF176E110C211B\poc and C:\Users\admin\Desktop

   ```
   mklink /J C:\ProgramData\Mozilla-1de4eec8-1241-4177-a864-e594e8d1fb38\updates\E7CF176E110C211B\poc C:\Users\admin\Desktop

   ```
2. admin uninstall firefox
3. files in C:\Users\admin\Desktop will be deleted.

|  | [Yu Chendong](/user_profile?user_id=638369)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1824420#c1)• 2 years ago |
|  | |

Hello,

It seems that the poc video is too large. I put the link of it here：<https://drive.google.com/file/d/1W_pZDvXFJCvOXxU3_rQDsnHMCM7qMec-/view?usp=share_link>

Thanks

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824420#a1862_691597)• 2 years ago |

Component: Security → Application UpdateProduct: Firefox → Toolkit

|  | [Nick Alexander :nalexander [he/him]](/user_profile?user_id=432887) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824420#a345998_432887)• 2 years ago |

Summary: Firefox arbitrary file detete vuln → Firefox arbitrary file delete vulnerability

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1824420#c2)• 2 years ago |
|  | |

I haven't tried to reproduce this yet, but the description of the bug sounds plausible. I'll try to dedicate some time to this when I have some. Hopefully after I'm done with what I'm currently working on.

Severity: -- → S2

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1824420#c3)• 2 years ago |
|  | |

In your scenario is Firefox installed by the admin in a privileged location? In the default location we install firefox with limited file permissions, but if you install into a non-standard location we make it world readable. I don't know if that relates to the permissions we use for ProgramData though.

Flags: needinfo?(ycdxsb)Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Yu Chendong](/user_profile?user_id=638369)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1824420#c4)• 2 years ago |
|  | |

Hello,

In the proof-of-concept video, I demonstrated installing Firefox as an administrator in the default location on a Windows system. It's important to note that all users in the Users group have the ability to add files or directories in the C:\ProgramData\ directory. However, if correct permissions are not set, the default permission inheritance from the C:\ProgramData\ directory is weak.

Thanks

Flags: needinfo?(ycdxsb)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824420#a1737216_563604)• 2 years ago |

Assignee: nobody → bytesized

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1824420#c5)• 2 years ago |
|  | |

Thought I'd give a status update on the direction that I plan on going here. I was originally hoping to use `UAC::ExecCodeSegment` to execute the deletion with lower privileges. But this won't actually help if the installer was run with elevated privileges in the first place (rather than elevating with a UAC prompt). I suspect that this is probably pretty common in enterprise environments, which is sort of the worst place to have this kind of problem. So I'm scrapping that idea.

I've considered a number of other ideas, none of which I'm entirely happy with. But I think that we can pretty easily enumerate all the files that we want to delete. Which should allow us to delete them all by path, and then attempt to remove the directories containing them non-recursively. I believe that this should effectively sidestep the issue here.

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1824420#c6)• 2 years ago |
|  | |

Gah, I'm no longer so sure about that idea. The `backgroundupdate` directory contains some not very well-defined file names

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1824420#c7)• 2 years ago |
|  | |

I wrote [a document](https://docs.google.com/document/d/1IKGI5Hp2HDTr3-njDMedLNkUwm73cXurc1S5-P5cMwU/edit) of what I believe are the available solutions here. Since this is security sensitive, the document is currently restricted to my team. If you would like access, let me know. Hopefully we will have a decision on how we want to move forward here shortly.

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1824420#c8)• 2 years ago |
|  | |

Alright, I have a solution that I am going to attempt to go forward with that involves creating a separate binary that attempts to reinvoke itself as the least privileged user possible. I'm hoping to combine this approach with manually implementing a recursive deletion method that will attempt to prevent itself from being tricked into deleting files that it doesn't intend to.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1824420#c9)• 2 years ago |
|  | |

Yu Chendong: you appear to have filed this bug using our bug bounty form, but it does not have the `sec-bounty?` flag that form should have added. Did you remove that flag when you filed the bug, or is our form broken?

Flags: needinfo?(ycdxsb)

|  | [Yu Chendong](/user_profile?user_id=638369)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1824420#c10)• 2 years ago |
|  | |

Hello,

I submit this issue by a security bug form from bug bounty program site. I am not sure why there is no sec-bounty flag.

Thanks.

Flags: needinfo?(ycdxsb)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1824420#c11)• 2 years ago |
|  | |

Attached file
[Bug 1824420 - r=nalexander!](attachment.cgi?id=9341189)
— [Details](attachment.cgi?id=9341189&action=edit)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1824420#c12)• 2 years ago |
|  | |

r=nalexander

<https://hg.mozilla.org/integration/autoland/rev/b927515165f2fa42afa6d0a296891e904aef78ff>

<https://hg.mozilla.org/mozilla-central/rev/b927515165f2>

Group: firefox-core-security → core-security-releaseStatus: UNCONFIRMED → RESOLVEDClosed: 2 years ago
[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 116 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1824420#c13)• 2 years ago |
|  | |

I'm going to assume that given the severity of this bug and the risk associated, we probably don't want to attempt to backport this to ESR102 so late in its lifecycle (but please confirm that!). We probably do want to get this onto ESR115, however.

[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix)
[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=%3F)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)Flags: needinfo?(bytesized)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1824420#c14)• 2 years ago |
|  | |

It's not immediately clear how we should port this over to Thunderbird.

For the first two modified files, I can find equivalent files for TB, and it seems possible to merge those changes. For the additional files in browser, we don't seem to have them in TB, and I don't know if we need to add them.

Rob, do you understand how to handle this, should we experiment, or do we need help from bytesized?

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824420#a8291026_36541)• 2 years ago |

Blocks: [1840887](/show_bug.cgi?id=1840887 "RESOLVED FIXED - Port bug 1824420 to Thunderbird")

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1824420#c15)• 2 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #13](/show_bug.cgi?id=1824420#c13 "RESOLVED FIXED - Firefox arbitrary file delete vulnerability"))

> I'm going to assume that given the severity of this bug and the risk associated, we probably don't want to attempt to backport this to ESR102 so late in its lifecycle (but please confirm that!).

Agreed. I don't think that's necessary.

> We probably do want to get this onto ESR115, however.

Yes, I want to make sure this makes it to ESR115. I'm a little confused about the timing of this. Will this need to be marked for ESR uplift to make it into 115?

Flags: needinfo?(bytesized) → needinfo?(ryanvm)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1824420#c16)• 2 years ago |
|  | |

I've set the flags so it's on the radar for next cycle (i.e. 115.1esr shipping alongside Fx116). You can request approval now or wait a bit if you want.

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=%3F) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)
[tracking-firefox116](/buglist.cgi?f1=cf_tracking_firefox116&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox116&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [116+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=116%2B)Flags: needinfo?(ryanvm)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1824420#c17)• 2 years ago |
|  | |

I want to do some quick manual testing on the Nightly installer and then I'll request approval.

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1824420#c18)• 2 years ago |
|  | |

Comment on [attachment 9341189](/attachment.cgi?id=9341189 "Bug 1824420 - r=nalexander!") [[details]](/attachment.cgi?id=9341189&action=edit "Bug 1824420 - r=nalexander!")

[Bug 1824420](/show_bug.cgi?id=1824420 "RESOLVED FIXED - Firefox arbitrary file delete vulnerability") - r=nalexander!

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This vulnerability seems most risky for ESR users. Most enterprise users use ESR. The most common time that the installer would be run regularly is an enterprise environment. And that is also the most likely case for an attacker to be interested in a targeted Elevation of Privilege attack.
* **User impact if declined**: ESR user would be more vulnerable to an Elevation of Privilege attack from an attacker with local access.
* **Fix Landed on Version**: 116
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Only affects the installer and uninstaller. Failure of code is non-critical. The installer and uninstaller will succeed even if the new code fails.
[Attachment #9341189](/attachment.cgi?id=9341189&action=edit "Bug 1824420 - r=nalexander!") -
Flags: approval-mozilla-esr115?

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1824420#c19)• 2 years ago |
|  | |

Comment on [attachment 9341189](/attachment.cgi?id=9341189 "Bug 1824420 - r=nalexander!") [[details]](/attachment.cgi?id=9341189&action=edit "Bug 1824420 - r=nalexander!")

[Bug 1824420](/show_bug.cgi?id=1824420 "RESOLVED FIXED - Firefox arbitrary file delete vulnerability") - r=nalexander!

Approved for 115.1esr

[Attachment #9341189](/attachment.cgi?id=9341189&action=edit "Bug 1824420 - r=nalexander!") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1824420#c20)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/5ce396504863>

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Camelia Badau [:cbadau], Desktop Test Engineering](/user_profile?user_id=500622) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824420#a9297251_500622)• 2 years ago |

Flags: qe-verify+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824420#a9303749_553429)• 2 years ago |

QA Whiteboard: [qa-triaged]

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1824420#c21)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1824420&comment_id=16491653 "1 revision") |
|  | |

I'm trying to verify that this bug is fixed on 115esr and latest Firefox 116 beta but for me for every build I use all the files will be deleted from Desktop in this case. I assume I did something wrong with the privileges of the non admin user or something else but not sure.

Here are the steps I used:

1. Made a standard user that has the following permissions: Read&Execute, List folder contents, Read, Write for `ProgramData` from the admin user.
2. Installed Firefox, 115.0.2esr in this case <https://archive.mozilla.org/pub/firefox/candidates/115.0.2esr-candidates/build1/win64/en-US/Firefox%20Setup%20115.0.2esr.exe> from the admin user.
3. Switched to the standard user (Signed out of the admin user)
4. From standard user I executed in CMD the following command `mklink /J C:\ProgramData\Mozilla-1de4eec8-1241-4177-a864-e594e8d1fb38\updates\E7CF176E110C211B\poc C:\Users\admin\Desktop`. (replaced the updates file and the path to admin user)
5. Checked inside the updates folder that the poc symbolic link was made and that it points to Desktop from Admin account.
6. Opened Control Panel and uninstalled Firefox (when requested for an admin account to uninstall I provided the credential for the Admin account)
7. I checked the symbolic link and there were no more files in Desktop from admin user.
8. I switched to the admin account and I confirmed that the Desktop was clean.

Could you please help in determining if I used the correct steps here? Thanks

Flags: needinfo?(bytesized)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1824420#c22)• 2 years ago |
|  | |

Ideally the thing that we would be testing against is that the (un)installer won't delete a directory that is exclusively owned by TrustedIntaller. But the steps that you gave should work fine if you use two separate administrator users, let's call them `admin1` and `admin2`. Then make a file on the desktop as `admin2` and don't use that user's account or credentials again until step 8 where you check if the file was deleted. Anything else should be done as `admin1`.

I believe that the problem that you are having is that you are testing that the (un)installer doesn't have access to `C:\Users\admin\Desktop`, but then you are running the uninstaller with that same admin's credentials. So even after de-escalating privileges, the (un)installer probably still has access to the admin's files.

Flags: needinfo?(bytesized)

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1824420#c23)• 1 years ago |
|  | |

(In reply to Robin Steuber (they/them) [:bytesized] from [comment #22](/show_bug.cgi?id=1824420#c22 "RESOLVED FIXED - Firefox arbitrary file delete vulnerability"))

> Ideally the thing that we would be testing against is that the (un)installer won't delete a directory that is exclusively owned by TrustedIntaller. But the steps that you gave should work fine if you use two separate administrator users, let's call them `admin1` and `admin2`. Then make a file on the desktop as `admin2` and don't use that user's account or credentials again until step 8 where you check if the file was deleted. Anything else should be done as `admin1`.
>
> I believe that the problem that you are having is that you are testing that the (un)installer doesn't have access to `C:\Users\admin\Desktop`, but then you are running the uninstaller with that same admin's credentials. So even after de-escalating privileges, the (un)installer probably still has access to the admin's files.

Thanks for your reply, I did try again with two admin users as you said (called them `admin1` and `admin2`) and followed the steps from [comment 21](/show_bug.cgi?id=1824420#c21 "RESOLVED FIXED - Firefox arbitrary file delete vulnerability") but with no success.

I also tried to install Firefox, created symlink and uninstalled Firefox from `admin2`, I only accessed `admin1` to give sharing access to Desktop for `admin2` and to see if the files were deleted after uninstallation and unfortunately they were with 116.0b5. Both admin have full access control, I also made sure that I can have access to desktop of `admin1` from `admin2` via the symlink created. Not sure what I am doing wrong. Would you mind verifying this with latest Beta and 115esr?

Flags: needinfo?(bytesized)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1824420#c24)• 1 years ago |
|  | |

(In reply to Bogdan Maris, Desktop QA from [comment #23](/show_bug.cgi?id=1824420#c23 "RESOLVED FIXED - Firefox arbitrary file delete vulnerability"))

> I also made sure that I can have access to desktop of `admin1` from `admin2` via the symlink created. Not sure what I am doing wrong.

This is confusing to me and I'm suspicious that this is the reason that verifying this wasn't working. Though the link should correctly point to `admin1`'s desktop, `admin2` shouldn't actually be able to access it without elevation. No unelevated user should be able to just access another user's files. Though perhaps this could be one of those implicit elevation things that Explorer sometimes does.

> Would you mind verifying this with latest Beta and 115esr?

I just tested with Beta and ESR 115 as downloaded from [here](https://www.mozilla.org/en-US/firefox/all/). I could verify the fix in Beta, but not in ESR 115. This sort of seems expected to me since this was approved for uplift to ESR 115.1, but the newest available ESR is ESR 115.0.2.

Flags: needinfo?(bytesized)

|  | [Adrian Florinescu [:aflorinescu]](/user_profile?user_id=556562) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1824420#c25)• 1 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1824420&comment_id=16499825 "3 revisions") |
|  | |

Since Bogdan is currently on PTO I picked this verification up and the same results reported as Bogdan.

* winver 21H2 PRO version
* `admin1` - administrator account(local account)
* `admin2` - administrator account(local account)
* `user` - standard account(local account)

Tested with 117.0a1 (2023-07-16) and Beta 116.0b6 creating symlinks from `admin2` and `user` to 2 desktop folders(folder1 and folder2) on admin1 and the results is both folders get deleted on uninstall triggered from admin1. Robin, did you use local user accounts or Microsoft accounts for your verification?

Flags: needinfo?(bytesized)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1824420#c26)• 1 years ago |
|  | |

Hmm. I discovered that the way that I was creating my junctions caused them to be malformed in a way that (apparently) the new version of the installer wouldn't delete but the old version would. Now that I am creating them correctly, I can reproduce this problem. I'm not entirely sure whether this means that the vulnerability still exists or not. I'll investigate more tomorrow.

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1824420#c27)• 1 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1824420&comment_id=16501854 "1 revision") |
|  | |

Well. I have made a number of interesting discoveries.

One is [Bug 1844179](/show_bug.cgi?id=1844179 "NEW"). I'd rather leave the details in that bug so that they don't become public when/if this bug does (I'm not actually 100% sure it needs to be marked as a security bug, but I am going to assume that it does until told otherwise). But suffice to say it is related to the unexpected testing results in the past few comments.

Another is that, as things stand, this patch does not prevent following the proof of concept steps originally provided. But there are a couple of mitigating factors that are relevant here:

1. When I run the uninstaller, it doesn't run as TrustedInstaller or even SYSTEM, it runs as my login user in an elevated context. An administrator, even in an elevated context, does not have the permissions necessary to delete a directory that only has permissions granted to TrustedInstaller. I checked this to be sure.
2. The more I thought about this, the more I realized that I don't actually understand the proposed exploit as well as I thought that I did. I was thinking that you would make a directory junction from the update directory pointing to `C:\Config.Msi` (the vulnerable directory mentioned in [the original link in the bug description](https://www.zerodayinitiative.com/blog/2022/3/16/abusing-arbitrary-file-deletes-to-escalate-privilege-and-other-great-tricks)). But this doesn't actually do what we want because, in order to perform the described exploit, the attacker needs to remove the directory itself, not just its contents, in order to be able to fill it with evil without escalating privileges. I guess you could point the directory junction instead at the parent directory (`C:\`), but if you have the privileges necessary to remove `C:\Config.Msi`, you are also going to have the necessary privileges to remove large parts of `C:\Windows`, which is going to have some pretty serious consequences for performing the later stages of any exploit.

All of which is to say that I don't think that there is actually any way to use this bug to perform an escalation of privileges.

@Yu Chendong - Am I missing something here? How can a privilege escalation actually be performed here without running into the two problems I mentioned above?

If there is no escalation of privilege here, I contemplated backing this patch out, but I actually do think that it's valuable. If, for some reason, you did run the uninstaller as TrustedInstaller or SYSTEM, this should successfully drop a certain amount of those privileges and prevent deletion of some especially highly privileged things that really should not be deleted.

And, additionally, this patch has the potential to become substantially more valuable if [Bug 1844179](/show_bug.cgi?id=1844179 "NEW") or [Bug 1828503](/show_bug.cgi?id=1828503 "NEW") is fixed.

Flags: needinfo?(bytesized) → needinfo?(ycdxsb)

|  | [Yu Chendong](/user_profile?user_id=638369)  Reporter |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1824420#c28)• 1 years ago |
|  | |

Hello,

You are right, arbitrary file deletion through junction point is the original impact of this vulnerability. With the privilege of uninstaller process, attacker can delete important files (e.g. files under C:\Windows or files under C:\Users\admin) in Windows system.

Thanks

Flags: needinfo?(ycdxsb)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1824420#c29)• 1 years ago |
|  | |

(In reply to Yu Chendong from [comment #28](/show_bug.cgi?id=1824420#c28 "RESOLVED FIXED - Firefox arbitrary file delete vulnerability"))

> Hello,
>
> You are right, arbitrary file deletion through junction point is the original impact of this vulnerability. With the privilege of uninstaller process, attacker can delete important files (e.g. files under C:\Windows or files under C:\Users\admin) in Windows system.
>
> Thanks

The files in `C:\Windows` are owned by TrustedInstaller, not the Administrator group, so they are not vulnerable here.

---

Since this bug is now being used as the place to handle potential escalation of privilege, work to handle interacting with the update directory in a safer way, generally, will be done in another bug. Since the escalation of privileges is only possible if the (un)installer is run by TrustedInstaller, I'm not actually entirely sure how to test this patch, since it's not clear to me how to just run something as TrustedInstaller. But I still think it's valuable to keep the patch as it should theoretically work and, as mentioned in [Comment 27](/show_bug.cgi?id=1824420#c27 "RESOLVED FIXED - Firefox arbitrary file delete vulnerability"), it will be more valuable if other bugs get fixed.

|  | [Yu Chendong](/user_profile?user_id=638369)  Reporter |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1824420#c30)• 1 years ago |
|  | |

Yes, the trick in <https://www.zerodayinitiative.com/blog/2022/3/16/abusing-arbitrary-file-deletes-to-escalate-privilege-and-other-great-tricks> is a way to eop. As you mentioned, it not work in this issue because it only delete files under C:\Config.msi. There are also other tricks, like <https://secret.club/2020/04/23/directory-deletion-shell.html>.

|  | [Adrian Florinescu [:aflorinescu]](/user_profile?user_id=556562) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1824420#c31)• 1 years ago |
|  | |

I agree that having the original fix is better than not having it, but I'm uncertain what can be actually verified in this bug.

Flags: needinfo?(bytesized)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1824420#c32)• 1 years ago |
|  | |

I'm not sure either. I tried getting the uninstaller to run as TrustedInstaller, but didn't end up having much luck.

Flags: needinfo?(bytesized)

|  | [Adrian Florinescu [:aflorinescu]](/user_profile?user_id=556562) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1824420#c33)• 1 years ago |
|  | |

Thanks Robin! Removing the qe+ for the time being. Please reaply as need arise.

Flags: qe-verify+

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824420#a10727240_486733)• 1 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?] [adv-main116+] [adv-ESR115.1+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1824420#c34)• 1 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9345938) (obsolete)
— [Details](attachment.cgi?id=9345938&action=edit)

|  | [Yu Chendong](/user_profile?user_id=638369)  Reporter |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1824420#c35)• 1 years ago |
|  | |

Hello,

Could you please change Yu Chendong to my hacker name : ycdxsb?

Thanks

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1824420#c36)• 1 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9346041)
— [Details](attachment.cgi?id=9346041&action=edit)

[Attachment #9345938](/attachment.cgi?id=9345938&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824420#a10787851_486733)• 1 years ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824420#a11235440_1689)• 1 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Yu Chendong](/user_profile?user_id=638369)  Reporter |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1824420#c37)• 1 years ago |
| offtopic | |

| Comment hidden (offtopic) |  |
| --- | --- |

Hello,

It appears Mozilla has a bug bounty program on HackerOne. Do I just need to provide my HackerOne account to receive the bounty?

Thanks

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1824420#c38)• 1 year ago |
| offtopic | |

| Comment hidden (offtopic) |  |
| --- | --- |

I assume the above comment was a reaction to my change to the sec-bounty+ flag and that you've since been contacted by mail and figured it out. The HackerOne program is only for our websites and services; our client bounty is still run here in Bugzilla (see <https://www.mozilla.org/en-US/security/>).

Any remaining questions about bounties should be mailed to security@mozilla.org. The engineers dealing with bugs won't be able to answer and the bounty team is unlikely to see your comments in a bug once we think we're done with a bug.

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824420#a20322263_563604)• 1 year ago |

See Also: → [1864758](/show_bug.cgi?id=1864758 "RESOLVED FIXED - Increase stub installer timeout")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824420#a24673997_1689)• 1 year ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824420#a24680480_1689)• 1 year ago |

Alias: CVE-2023-4052

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824420#a37413158_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Nick Alexander :nalexander [he/him]](/user_profile?user_id=432887) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824420#a46479792_432887)• 4 months ago |

Regressions: [1918473](/show_bug.cgi?id=1918473 "RESOLVED FIXED - Fix missing `await` in `BackgroundTask_install.sys.mjs` and `BackgroundTask_uninstall.sys.mjs`")
You need to [log in](/show_bug.cgi?id=1824420&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_542934ad_20250111_053731.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-29

## Security Vulnerabilities fixed in Firefox 116

Announced
August 1, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 116

#### [#CVE-2023-4045: Offscreen Canvas could have bypassed cross-origin restrictions](#CVE-2023-4045)

Reporter
Max Vlasov
Impact
high
##### Description

Offscreen Canvas did not properly track cross-origin tainting, which could have been used to access image data from another site in violation of same-origin policy.

##### References

* [Bug 1833876](https://bugzilla.mozilla.org/show_bug.cgi?id=1833876)

#### [#CVE-2023-4046: Incorrect value used during WASM compilation](#CVE-2023-4046)

Reporter
Alexander Guryanov
Impact
high
##### Description

In some circumstances, a stale value could have been used for a global variable in WASM JIT analysis. This resulted in incorrect compilation and a potentially exploitable crash in the content process.

##### References

* [Bug 1837686](https://bugzilla.mozilla.org/show_bug.cgi?id=1837686)

#### [#CVE-2023-4047: Potential permissions request bypass via clickjacking](#CVE-2023-4047)

Reporter
Axel Chong (@Haxatron)
Impact
high
##### Description

A bug in popup notifications delay calculation could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1839073](https://bugzilla.mozilla.org/show_bug.cgi?id=1839073)

#### [#CVE-2023-4048: Crash in DOMParser due to out-of-memory conditions](#CVE-2023-4048)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An out-of-bounds read could have led to an exploitable crash when parsing HTML with DOMParser in low memory situations.

##### References

* [Bug 1841368](https://bugzilla.mozilla.org/show_bug.cgi?id=1841368)

#### [#CVE-2023-4049: Fix potential race conditions when releasing platform objects](#CVE-2023-4049)

Reporter
Nika Layzell
Impact
high
##### Description

Race conditions in reference counting code were found through code inspection. These could have resulted in potentially exploitable use-after-free vulnerabilities.

##### References

* [Bug 1842658](https://bugzilla.mozilla.org/show_bug.cgi?id=1842658)

#### [#CVE-2023-4050: Stack buffer overflow in StorageManager](#CVE-2023-4050)

Reporter
Mark Brand
Impact
high
##### Description

In some cases, an untrusted input stream was copied to a stack buffer without checking its size. This resulted in a potentially exploitable crash which could have led to a sandbox escape.

##### References

* [Bug 1843038](https://bugzilla.mozilla.org/show_bug.cgi?id=1843038)

#### [#CVE-2023-4051: Full screen notification obscured by file open dialog](#CVE-2023-4051)

Reporter
Hafiizh
Impact
moderate
##### Description

A website could have obscured the full screen notification by using the file open dialog. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1821884](https://bugzilla.mozilla.org/show_bug.cgi?id=1821884)

#### [#CVE-2023-4052: File deletion and privilege escalation through Firefox uninstaller](#CVE-2023-4052)

Reporter
ycdxsb
Impact
moderate
##### Description

The Firefox updater created a directory writable by non-privileged users. When uninstalling Firefox, any files in that directory would be recursively deleted with the permissions of the uninstalling user account. This could be combined with creation of a junction (a form of symbolic link) to allow arbitrary file deletion controlled by the non-privileged user.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1824420](https://bugzilla.mozilla.org/show_bug.cgi?id=1824420)

#### [#CVE-2023-4053: Full screen notification obscured by external program](#CVE-2023-4053)

Reporter
P Umar Farooq
Impact
moderate
##### Description

A website could have obscured the full screen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1839079](https://bugzilla.mozilla.org/show_bug.cgi?id=1839079)

#### [#CVE-2023-4054: Lack of warning when opening appref-ms files](#CVE-2023-4054)

Reporter
P Umar Farooq
Impact
moderate
##### Description

When opening appref-ms files, Firefox did not warn the user that these files may contain malicious code.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1840777](https://bugzilla.mozilla.org/show_bug.cgi?id=1840777)

#### [#CVE-2023-4055: Cookie jar overflow caused unexpected cookie jar state](#CVE-2023-4055)

Reporter
Marco Squarcina
Impact
low
##### Description

When the number of cookies per domain was exceeded in `document.cookie`, the actual cookie jar sent to the host was no longer consistent with expected cookie jar state. This could have caused requests to be sent with some cookies missing.

##### References

* [Bug 1782561](https://bugzilla.mozilla.org/show_bug.cgi?id=1782561)

#### [#CVE-2023-4056: Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](#CVE-2023-4056)

Reporter
Dianna Smith, Ryan VanderMeulen, Timothy Nikkel, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115, Firefox ESR 115.0, Firefox ESR 102.13, Thunderbird 115.0, and Thunderbird 102.13. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1820587%2C1824634%2C1839235%2C1842325%2C1843847)

#### [#CVE-2023-4057: Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1](#CVE-2023-4057)

Reporter
The Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115, Firefox ESR 115.0, and Thunderbird 115.0. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1](https://bugzilla.mozilla.org/show_bug.cgi?id=1841682)

#### [#CVE-2023-4058: Memory safety bugs fixed in Firefox 116](#CVE-2023-4058)

Reporter
Andrew McCreight and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1819160%2C1828024)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


