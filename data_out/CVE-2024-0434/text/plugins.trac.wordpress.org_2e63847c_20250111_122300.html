

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3092969%2540tour-booking-manager%252Ftrunk%26old%3D3091912%2540tour-booking-manager%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/3091912/tour-booking-manager/trunk?old=3092969&old_path=%2Ftour-booking-manager%2Ftrunk)

---

# Changes in [tour-booking-manager/trunk](/browser/tour-booking-manager/trunk?rev=3092969 "Show entry in browser") [[3091912:3092969]](/log/tour-booking-manager/trunk?rev=3092969&stop_rev=3091912 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[tour-booking-manager/trunk](/browser/tour-booking-manager/trunk?rev=3092969)
Files:

3 edited

* [admin/settings/tour/TTBM\_Settings\_place\_you\_see.php](/browser/tour-booking-manager/trunk/admin/settings/tour/TTBM_Settings_place_you_see.php?rev=3092969 "Show entry in browser")
  (modified)
  ([5 diffs](#file0 "Show differences"))
* [assets/admin/ttbm\_admin\_script.js](/browser/tour-booking-manager/trunk/assets/admin/ttbm_admin_script.js?rev=3092969 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [tour-booking-manager.php](/browser/tour-booking-manager/trunk/tour-booking-manager.php?rev=3092969 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [tour-booking-manager/trunk/admin/settings/tour/TTBM\_Settings\_place\_you\_see.php](/changeset/3092969/tour-booking-manager/trunk/admin/settings/tour/TTBM_Settings_place_you_see.php?old=3091912&old_path=tour-booking-manager%2Ftrunk%2Fadmin%2Fsettings%2Ftour%2FTTBM_Settings_place_you_see.php "Show the [3091912:3092969] differences restricted to tour-booking-manager/trunk/admin/settings/tour/TTBM_Settings_place_you_see.php")

  | [r3091912](/browser/tour-booking-manager/trunk/admin/settings/tour/TTBM_Settings_place_you_see.php?rev=3091912#L15 "Show revision 3091912 of this file in browser") | [r3092969](/browser/tour-booking-manager/trunk/admin/settings/tour/TTBM_Settings_place_you_see.php?rev=3092969#L15 "Show revision 3092969 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
  | 16 | 16 | add\_action('ttbm\_settings\_save', [$this, 'save\_place\_you\_see']); |
  | 17 |  | ~~add\_action('wp\_ajax\_ttbm\_new\_place\_save', [$this, 'ttbm\_new\_place\_save']);~~ |
  | 18 |  | ~~add\_action('wp\_ajax\_nopriv\_ttbm\_new\_place\_save', [$this, 'ttbm\_new\_place\_save']);~~ |
  | 19 | 17 | } |
  | 20 | 18 | public function add\_tab() { |
  | […](/browser/tour-booking-manager/trunk/admin/settings/tour/TTBM_Settings_place_you_see.php?rev=3091912#L65) | […](/browser/tour-booking-manager/trunk/admin/settings/tour/TTBM_Settings_place_you_see.php?rev=3092969#L63) |  |
  | 65 | 63 | <div class="ttbm\_place\_you\_see\_table"> |
  | 66 | 64 | <section> |
  | 67 |  | <label class="label"> |
  | 68 |  | <div> |
  | 69 |  | <label for=""><?php esc\_html\_e('Create new place', 'tour-booking-manager'); ?></label> |
  | 70 |  | <span><?php TTBM\_Settings::des\_p('ttbm\_place\_you\_see'); ?></span> |
  | 71 |  | </div> |
  | 72 |  | <?php MP\_Custom\_Layout::popup\_button\_xs('add\_new\_place\_you\_see\_popup', esc\_html\_\_('Create New Place', 'tour-booking-manager')); ?> |
  | 73 |  | </label> |
  |  | 65 |  |
  |  | 66 | <div> |
  |  | 67 | <label for=""><?php esc\_html\_e('Create new place', 'tour-booking-manager'); ?></label> |
  |  | 68 | <span><?php TTBM\_Settings::des\_p('ttbm\_place\_you\_see'); ?></span> |
  |  | 69 | </div> |
  |  | 70 |  |
  | 74 | 71 | </section> |
  | 75 | 72 | <?php if ($all\_places->post\_count > 0) { ?> |
  | […](/browser/tour-booking-manager/trunk/admin/settings/tour/TTBM_Settings_place_you_see.php?rev=3091912#L115) | […](/browser/tour-booking-manager/trunk/admin/settings/tour/TTBM_Settings_place_you_see.php?rev=3092969#L112) |  |
  | 115 | 112 | <?php |
  | 116 | 113 | wp\_reset\_postdata(); |
  | 117 |  | ~~$this->add\_new\_place\_you\_see\_popup();~~ |
  | 118 | 114 | } |
  | 119 | 115 | public function place\_you\_see\_item($places, $hiphop\_place = array()) { |
  | […](/browser/tour-booking-manager/trunk/admin/settings/tour/TTBM_Settings_place_you_see.php?rev=3091912#L149) | […](/browser/tour-booking-manager/trunk/admin/settings/tour/TTBM_Settings_place_you_see.php?rev=3092969#L145) |  |
  | 149 | 145 | <?php |
  | 150 | 146 | } |
  | 151 |  | public function add\_new\_place\_you\_see\_popup() { |
  | 152 |  | ?> |
  | 153 |  | <div class="mpPopup" data-popup="add\_new\_place\_you\_see\_popup"> |
  | 154 |  | <div class="popupMainArea"> |
  | 155 |  | <div class="popupHeader"> |
  | 156 |  | <h4> |
  | 157 |  | <?php esc\_html\_e('Add New Place', 'tour-booking-manager'); ?> |
  | 158 |  | <p class="\_textSuccess\_ml\_dNone ttbm\_success\_info"> |
  | 159 |  | <span class="fas fa-check-circle mR\_xs"></span> |
  | 160 |  | <?php esc\_html\_e('Place is added successfully.', 'tour-booking-manager') ?> |
  | 161 |  | </p> |
  | 162 |  | </h4> |
  | 163 |  | <span class="fas fa-times popupClose"></span> |
  | 164 |  | </div> |
  | 165 |  | <div class="popupBody ttbm\_place\_you\_see\_form\_area"> |
  | 166 |  | </div> |
  | 167 |  | <div class="popupFooter"> |
  | 168 |  | <div class="buttonGroup"> |
  | 169 |  | <button class="\_themeButton ttbm\_new\_place\_you\_see\_save" type="button"><?php esc\_html\_e('Save', 'tour-booking-manager'); ?></button> |
  | 170 |  | <button class="\_warningButton ttbm\_new\_place\_you\_see\_save\_close" type="button"><?php esc\_html\_e('Save & Close', 'tour-booking-manager'); ?></button> |
  | 171 |  | </div> |
  | 172 |  | </div> |
  | 173 |  | </div> |
  | 174 |  | </div> |
  | 175 |  | <?php |
  | 176 |  | } |
  |  | 147 |  |
  | 177 | 148 | public function load\_ttbm\_place\_you\_see\_form() { |
  | 178 | 149 | ?> |
  | […](/browser/tour-booking-manager/trunk/admin/settings/tour/TTBM_Settings_place_you_see.php?rev=3091912#L227) | […](/browser/tour-booking-manager/trunk/admin/settings/tour/TTBM_Settings_place_you_see.php?rev=3092969#L198) |  |
  | 227 | 198 | } |
  | 228 | 199 | } |
  | 229 |  | public function ttbm\_new\_place\_save() { |
  | 230 |  | if(is\_admin() && defined('DOING\_AUTOSAVE') && DOING\_AUTOSAVE) { |
  | 231 |  | $place\_name = MP\_Global\_Function::data\_sanitize($\_POST['place\_name']); |
  | 232 |  | $place\_description = MP\_Global\_Function::data\_sanitize($\_POST['place\_description']); |
  | 233 |  | $place\_image = MP\_Global\_Function::data\_sanitize($\_POST['place\_image']); |
  | 234 |  | $args = array('post\_title' => $place\_name, 'post\_content' => $place\_description, 'post\_status' => 'publish', 'post\_type' => 'ttbm\_places'); |
  | 235 |  | $query = wp\_insert\_post($args); |
  | 236 |  | if ($query) { |
  | 237 |  | set\_post\_thumbnail($query, $place\_image); |
  | 238 |  | } |
  | 239 |  | } |
  | 240 |  | die(); |
  | 241 |  | } |
  |  | 200 |  |
  | 242 | 201 | } |
  | 243 | 202 | new TTBM\_Settings\_place\_you\_see(); |
* ## [tour-booking-manager/trunk/assets/admin/ttbm\_admin\_script.js](/changeset/3092969/tour-booking-manager/trunk/assets/admin/ttbm_admin_script.js?old=3089253&old_path=tour-booking-manager%2Ftrunk%2Fassets%2Fadmin%2Fttbm_admin_script.js "Show the [3091912:3092969] differences restricted to tour-booking-manager/trunk/assets/admin/ttbm_admin_script.js")

  | [r3091912](/browser/tour-booking-manager/trunk/assets/admin/ttbm_admin_script.js?rev=3089253#L398 "Show revision 3091912 of this file in browser") | [r3092969](/browser/tour-booking-manager/trunk/assets/admin/ttbm_admin_script.js?rev=3092969#L398 "Show revision 3092969 of this file in browser") |  |
  | --- | --- | --- |
  | 398 | 398 | } |
  | 399 | 399 | }); |
  | 400 |  | ~~$(document).on('click', '.ttbm\_new\_place\_you\_see\_save,.ttbm\_new\_place\_you\_see\_save\_close', function () {~~ |
  | 401 |  | ~~ttbm\_new\_place\_save($(this));~~ |
  | 402 |  | ~~});~~ |
  | 403 |  | ~~function ttbm\_new\_place\_save($this) {~~ |
  | 404 |  | ~~let parent = $this.closest('.popupMainArea');~~ |
  | 405 |  | ~~parent.find('.ttbm\_success\_info').slideUp('fast');~~ |
  | 406 |  | ~~let place\_name = parent.find('[name="ttbm\_place\_name"]').val();~~ |
  | 407 |  | ~~let place\_description = parent.find('[name="ttbm\_place\_description"]').val();~~ |
  | 408 |  | ~~let place\_image = parent.find('[name="ttbm\_place\_image"]').val();~~ |
  | 409 |  | ~~if (!place\_name) {~~ |
  | 410 |  | ~~parent.find('[data-required="ttbm\_place\_name"]').slideDown('fast');~~ |
  | 411 |  | ~~} else {~~ |
  | 412 |  | ~~parent.find('[data-required="ttbm\_place\_name"]').slideUp('fast');~~ |
  | 413 |  | ~~}~~ |
  | 414 |  | ~~if (!place\_image) {~~ |
  | 415 |  | ~~parent.find('[data-required="ttbm\_place\_image"]').slideDown('fast');~~ |
  | 416 |  | ~~} else {~~ |
  | 417 |  | ~~parent.find('[data-required="ttbm\_place\_image"]').slideUp('fast');~~ |
  | 418 |  | ~~}~~ |
  | 419 |  | ~~if (place\_name && place\_image) {~~ |
  | 420 |  | ~~$.ajax({~~ |
  | 421 |  | ~~type: 'POST', url: mp\_ajax\_url, data: {~~ |
  | 422 |  | ~~"action": "ttbm\_new\_place\_save", "place\_name": place\_name, "place\_description": place\_description, "place\_image": place\_image~~ |
  | 423 |  | ~~}, beforeSend: function () {~~ |
  | 424 |  | ~~dLoader(parent);~~ |
  | 425 |  | ~~}, success: function () {~~ |
  | 426 |  | ~~parent.find('[name="ttbm\_place\_name"]').val('');~~ |
  | 427 |  | ~~parent.find('[name="ttbm\_place\_description"]').val('');~~ |
  | 428 |  | ~~parent.find('[name="ttbm\_place\_image"]').val('');~~ |
  | 429 |  | ~~$this.closest('.popupMainArea').find('.mp\_remove\_single\_image').trigger('click');~~ |
  | 430 |  | ~~parent.find('.ttbm\_success\_info').slideDown('fast');~~ |
  | 431 |  | ~~ttbm\_reload\_place\_you\_see();~~ |
  | 432 |  | ~~dLoaderRemove(parent);~~ |
  | 433 |  | ~~if (($this).hasClass('ttbm\_new\_place\_you\_see\_save\_close')) {~~ |
  | 434 |  | ~~$this.closest('.popupMainArea').find('.popupClose').trigger('click');~~ |
  | 435 |  | ~~}~~ |
  | 436 |  | ~~return true;~~ |
  | 437 |  | ~~}, error: function (response) {~~ |
  | 438 |  | ~~console.log(response);~~ |
  | 439 |  | ~~}~~ |
  | 440 |  | ~~});~~ |
  | 441 |  | ~~}~~ |
  | 442 |  | ~~return false;~~ |
  | 443 |  | ~~}~~ |
  | 444 | 400 | function ttbm\_reload\_place\_you\_see() { |
  | 445 | 401 | let ttbm\_id = $('[name="post\_id"]').val(); |
* ## [tour-booking-manager/trunk/tour-booking-manager.php](/changeset/3092969/tour-booking-manager/trunk/tour-booking-manager.php?old=3091912&old_path=tour-booking-manager%2Ftrunk%2Ftour-booking-manager.php "Show the [3091912:3092969] differences restricted to tour-booking-manager/trunk/tour-booking-manager.php")

  | [r3091912](/browser/tour-booking-manager/trunk/tour-booking-manager.php?rev=3091912#L4 "Show revision 3091912 of this file in browser") | [r3092969](/browser/tour-booking-manager/trunk/tour-booking-manager.php?rev=3092969#L4 "Show revision 3092969 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: http://mage-people.com |
  | 5 | 5 | \* Description: A Complete Tour and Travel Solution for WordPress by MagePeople. |
  | 6 |  | \* Version: 1.7.~~1~~ |
  |  | 6 | \* Version: 1.7.2 |
  | 7 | 7 | \* Author: MagePeople Team |
  | 8 | 8 | \* Author URI: http://www.mage-people.com/ |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3092969&old=3091912&new_path=%2Ftour-booking-manager%2Ftrunk&old_path=%2Ftour-booking-manager%2Ftrunk)
* [Zip Archive](?format=zip&new=3092969&old=3091912&new_path=%2Ftour-booking-manager%2Ftrunk&old_path=%2Ftour-booking-manager%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

