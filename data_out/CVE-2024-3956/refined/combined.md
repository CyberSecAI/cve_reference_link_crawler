=== Content from www.wordfence.com_7ac4411f_20250111_021149.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Pods – Custom Content Types and Fields <= 3.2.1 - Authenticated (Contributor+) Stored Cross-Site Scripting via Pod Form Redirect URL

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Pods – Custom Content Types and Fields <= 3.2.1 - Authenticated (Contributor+) Stored Cross-Site Scripting via Pod Form Redirect URL

5.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-3956](https://www.cve.org/CVERecord?id=CVE-2024-3956) |
| --- | --- |
| CVSS | 5.4 (Medium) |
| Publicly Published | May 9, 2024 |
| Last Updated | May 10, 2024 |
| Researcher | [wesley (wcraft)](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/wesley-jhon) |

### Description

The Pods – Custom Content Types and Fields plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the Pod Form widget in all versions up to, and including, 3.2.1 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/pods/tags/3.2.1/ui/front/form.php#L105)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3083418/pods/tags/3.1.4.1/includes/data.php)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3083418/pods/tags/3.1.4.1/ui/front/form.php)
* [pods.io](https://pods.io/2024/05/08/pods-3-2-1-1-security-release/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fpods%2Fpods-custom-content-types-and-fields-321-authenticated-contributor-stored-cross-site-scripting-via-pod-form-redirect-url&t=Pods%20%E2%80%93%20Custom%20Content%20Types%20and%20Fields%20%3C%3D%203.2.1%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20Pod%20Form%20Redirect%20URL "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fpods%2Fpods-custom-content-types-and-fields-321-authenticated-contributor-stored-cross-site-scripting-via-pod-form-redirect-url&text=Pods%20%E2%80%93%20Custom%20Content%20Types%20and%20Fields%20%3C%3D%203.2.1%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20Pod%20Form%20Redirect%20URL "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fpods%2Fpods-custom-content-types-and-fields-321-authenticated-contributor-stored-cross-site-scripting-via-pod-form-redirect-url "LinkedIn")
Email

## Vulnerability Details for Pods – Custom Content Types and Fields

#### [Pods – Custom Content Types and Fields](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/pods)

| Software Type | Plugin |
| --- | --- |
| Software Slug | pods [(view on wordpress.org)](https://wordpress.org/plugins/pods) |
| Patched? | Yes |
| Remediation | Update to version 3.2.1.1, or a newer patched version |
| Affected Version | * <= 3.2.1 |
| Patched Version | * 3.2.1.1 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_62e9a362_20250111_021147.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3083418%2Fpods%2Ftags%2F3.1.4.1%2Fui%2Ffront%2Fform.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3039473/pods/trunk/ui/front/form.php "Changeset 3039473 for pods/tags/3.1.4.1/ui/front/form.php")
* Next Change →

---

# Changeset [3083418](/changeset/3083418 "Show full changeset") for [pods/tags/3.1.4.1/ui/front/form.php](/browser/pods/tags/3.1.4.1/ui/front/form.php?rev=3083418 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
05/08/2024 03:08:48 PM
([8 months](/timeline?from=2024-05-08T15%3A08%3A48Z&precision=second "See timeline at 05/08/2024 03:08:48 PM") ago)

Author:
sc0ttkclark
Message:

Update to version 3.1.4.1 from GitHub

Location:
[pods/tags/3.1.4.1](/browser/pods/tags/3.1.4.1?rev=3083418)
Files:

1 edited
1 copied

* [.](/browser/pods/tags/3.1.4.1?rev=3083418 "Show entry in browser")
  (copied)
  *(copied from [pods/trunk](/browser/pods/trunk?rev=3061251 "Show original file (revision 3083415)"))*
* [ui/front/form.php](/browser/pods/tags/3.1.4.1/ui/front/form.php?rev=3083418 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [pods/tags/3.1.4.1/ui/front/form.php](/changeset/3083418/pods/tags/3.1.4.1/ui/front/form.php "Show the changeset 3083418 restricted to pods/tags/3.1.4.1/ui/front/form.php")

  | [r3039473](/browser/pods/trunk/ui/front/form.php?rev=3039473#L103 "Show revision 3039473 of this file in browser") | [r3083418](/browser/pods/tags/3.1.4.1/ui/front/form.php?rev=3083418#L103 "Show revision 3083418 of this file in browser") |  |
  | --- | --- | --- |
  | 103 | 103 | method="post" |
  | 104 | 104 | class="pods-submittable pods-form pods-form-front pods-form-pod-<?php echo esc\_attr( $pod\_name ); ?> pods-submittable-ajax" |
  | 105 |  | data-location="<?php echo esc\_attr( ~~$thank\_you~~ ); ?>" |
  |  | 105 | data-location="<?php echo esc\_attr( pods\_enforce\_safe\_url( $thank\_you ) ); ?>" |
  | 106 | 106 | id="pods-form-<?php echo esc\_attr( $pod\_name . '-' . $counter ); ?>" |
  | 107 | 107 | data-pods-pod-name="<?php echo esc\_attr( $pod\_name ); ?>" |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3083418)
* [Zip Archive](?format=zip&new=3083418)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_5972bfa7_20250111_021142.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3083418%2Fpods%2Ftags%2F3.1.4.1%2Fincludes%2Fdata.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3042809/pods/trunk/includes/data.php "Changeset 3042809 for pods/tags/3.1.4.1/includes/data.php")
* Next Change →

---

# Changeset [3083418](/changeset/3083418 "Show full changeset") for [pods/tags/3.1.4.1/includes/data.php](/browser/pods/tags/3.1.4.1/includes/data.php?rev=3083418 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
05/08/2024 03:08:48 PM
([8 months](/timeline?from=2024-05-08T15%3A08%3A48Z&precision=second "See timeline at 05/08/2024 03:08:48 PM") ago)

Author:
sc0ttkclark
Message:

Update to version 3.1.4.1 from GitHub

Location:
[pods/tags/3.1.4.1](/browser/pods/tags/3.1.4.1?rev=3083418)
Files:

1 edited
1 copied

* [.](/browser/pods/tags/3.1.4.1?rev=3083418 "Show entry in browser")
  (copied)
  *(copied from [pods/trunk](/browser/pods/trunk?rev=3061251 "Show original file (revision 3083415)"))*
* [includes/data.php](/browser/pods/tags/3.1.4.1/includes/data.php?rev=3083418 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [pods/tags/3.1.4.1/includes/data.php](/changeset/3083418/pods/tags/3.1.4.1/includes/data.php "Show the changeset 3083418 restricted to pods/tags/3.1.4.1/includes/data.php")

  | [r3042809](/browser/pods/trunk/includes/data.php?rev=3042809#L2999 "Show revision 3042809 of this file in browser") | [r3083418](/browser/pods/tags/3.1.4.1/includes/data.php?rev=3083418#L2999 "Show revision 3083418 of this file in browser") |  |
  | --- | --- | --- |
  | 2999 | 2999 | return $new\_list; |
  | 3000 | 3000 | } |
  |  | 3001 |  |
  |  | 3002 | /\*\* |
  |  | 3003 | \* Enforce a URL as safe and fallback to another URL if it is not safe. |
  |  | 3004 | \* |
  |  | 3005 | \* @since 3.1.4.1 |
  |  | 3006 | \* |
  |  | 3007 | \* @param string      $url          The URL to enforce as safe. |
  |  | 3008 | \* @param string|null $fallback\_url The fallback URL to use if the URL is not valid. |
  |  | 3009 | \* |
  |  | 3010 | \* @return string The safe URL or the fallback URL if that was not valid. |
  |  | 3011 | \*/ |
  |  | 3012 | function pods\_enforce\_safe\_url( string $url, ?string $fallback\_url = null ) { |
  |  | 3013 | $url = wp\_sanitize\_redirect( $url ); |
  |  | 3014 |  |
  |  | 3015 | if ( null === $fallback\_url ) { |
  |  | 3016 | $fallback\_url = pods\_current\_url(); |
  |  | 3017 | } |
  |  | 3018 |  |
  |  | 3019 | return wp\_validate\_redirect( $url, $fallback\_url ); |
  |  | 3020 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3083418)
* [Zip Archive](?format=zip&new=3083418)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_20e469ec_20250111_021137.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fpods%2Ftags%2F3.2.1%2Fui%2Ffront%2Fform.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/pods/trunk/ui/front/form.php?rev=3039467 "Revision 3039467")
* [Next Revision](/browser/pods/trunk/ui/front/form.php?rev=3083418 "Revision 3083418") →
* [Blame](/browser/pods/trunk/ui/front/form.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/pods/tags/3.2.1/ui/front/form.php)

---

# [source:](/browser?order=name "Go to repository root") [pods](/browser/pods?order=name "View pods")/[tags](/browser/pods/tags?order=name "View tags")/[3.2.1](/browser/pods/tags/3.2.1?order=name "View 3.2.1")/[ui](/browser/pods/tags/3.2.1/ui?order=name "View ui")/[front](/browser/pods/tags/3.2.1/ui/front?order=name "View front")/[form.php](/browser/pods/tags/3.2.1/ui/front/form.php?order=name "View form.php")

View diff against:

View revision:

| [Last change](/changeset/3039473/pods/trunk/ui/front/form.php "View differences") on this file was [3039473](/changeset/3039473/ "View changeset 3039473"), checked in by sc0ttkclark, [11 months ago](/timeline?from=2024-02-22T00%3A07%3A17Z&precision=second "See timeline at 02/22/2024 12:07:17 AM") |
| --- |
| Pods 3.1 and hotfix releases |
| **File size:** 6.9 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | // Don't load directly. |
| [3](#L3) | if ( ! defined( 'ABSPATH' ) ) { |
| [4](#L4) | die( '-1' ); |
| [5](#L5) | } |
| [6](#L6) |  |
| [7](#L7) | /\*\* |
| [8](#L8) | \* @var array       $fields |
| [9](#L9) | \* @var boolean     $fields\_only |
| [10](#L10) | \* @var Pods        $pod |
| [11](#L11) | \* @var array       $params |
| [12](#L12) | \* @var string      $label |
| [13](#L13) | \* @var string      $thank\_you |
| [14](#L14) | \* @var string      $output\_type |
| [15](#L15) | \* @var string|null $form\_key |
| [16](#L16) | \*/ |
| [17](#L17) |  |
| [18](#L18) | pods\_form\_enqueue\_style( 'pods-form' ); |
| [19](#L19) | pods\_form\_enqueue\_script( 'pods' ); |
| [20](#L20) |  |
| [21](#L21) | $pod\_name = $pod->pod; |
| [22](#L22) | $id       = $pod->id(); |
| [23](#L23) |  |
| [24](#L24) | // Set up fields. |
| [25](#L25) | foreach ( $fields as $k => $field ) { |
| [26](#L26) | // Make sure all required array keys exist. |
| [27](#L27) | if ( ! $field instanceof \Pods\Whatsit\Field ) { |
| [28](#L28) | $field = wp\_parse\_args( $field, [ |
| [29](#L29) | 'name'    => '', |
| [30](#L30) | 'type'    => '', |
| [31](#L31) | 'label'   => '', |
| [32](#L32) | 'help'    => '', |
| [33](#L33) | ] ); |
| [34](#L34) |  |
| [35](#L35) | $fields[ $k ] = $field; |
| [36](#L36) | } |
| [37](#L37) |  |
| [38](#L38) | if ( in\_array( $field['name'], [ 'created', 'modified' ], true ) ) { |
| [39](#L39) | unset( $fields[ $k ] ); |
| [40](#L40) | } elseif ( ! pods\_permission( $field ) ) { |
| [41](#L41) | if ( pods\_v( 'hidden', $field, false ) ) { |
| [42](#L42) | $fields[ $k ]['type'] = 'hidden'; |
| [43](#L43) | } elseif ( pods\_v( 'read\_only', $field, false ) ) { |
| [44](#L44) | $fields[ $k ]['readonly'] = true; |
| [45](#L45) | } else { |
| [46](#L46) | unset( $fields[ $k ] ); |
| [47](#L47) | } |
| [48](#L48) | } elseif ( ! pods\_has\_permissions( $field ) ) { |
| [49](#L49) | if ( pods\_v( 'hidden', $field, false ) ) { |
| [50](#L50) | $fields[ $k ]['type'] = 'hidden'; |
| [51](#L51) | } elseif ( pods\_v( 'read\_only', $field, false ) ) { |
| [52](#L52) | $fields[ $k ]['readonly'] = true; |
| [53](#L53) | } |
| [54](#L54) | } |
| [55](#L55) | } |
| [56](#L56) |  |
| [57](#L57) | $submittable\_fields = $fields; |
| [58](#L58) |  |
| [59](#L59) | foreach ( $submittable\_fields as $k => $field ) { |
| [60](#L60) | if ( ! pods\_v( 'readonly', $field, false ) ) { |
| [61](#L61) | continue; |
| [62](#L62) | } |
| [63](#L63) |  |
| [64](#L64) | unset( $submittable\_fields[ $k ] ); |
| [65](#L65) | } |
| [66](#L66) |  |
| [67](#L67) | $uri\_hash   = wp\_create\_nonce( 'pods\_uri\_' . pods\_current\_path() ); |
| [68](#L68) | $field\_hash = wp\_create\_nonce( 'pods\_fields\_' . implode( ',', array\_keys( $submittable\_fields ) ) ); |
| [69](#L69) |  |
| [70](#L70) | if ( is\_user\_logged\_in() ) { |
| [71](#L71) | $uid = 'user\_' . get\_current\_user\_id(); |
| [72](#L72) | } else { |
| [73](#L73) | $uid = pods\_session\_id(); |
| [74](#L74) | } |
| [75](#L75) |  |
| [76](#L76) | $nonce = wp\_create\_nonce( 'pods\_form\_' . $pod\_name . '\_' . $uid . '\_' . $id . '\_' . $uri\_hash . '\_' . $field\_hash ); |
| [77](#L77) |  |
| [78](#L78) | if ( isset( $\_POST['\_pods\_nonce'] ) ) { |
| [79](#L79) | try { |
| [80](#L80) | $id = $pod->api->process\_form( $\_POST, $pod, $submittable\_fields, $thank\_you ); |
| [81](#L81) | } catch ( Exception $e ) { |
| [82](#L82) | echo '<div class="pods-message pods-message-error">' . $e->getMessage() . '</div>'; |
| [83](#L83) | } |
| [84](#L84) | } |
| [85](#L85) |  |
| [86](#L86) | $field\_prefix = ''; |
| [87](#L87) |  |
| [88](#L88) | $counter = (int) pods\_static\_cache\_get( $pod->pod . '-counter', 'pods-forms' ); |
| [89](#L89) |  |
| [90](#L90) | // Shift counter by 1 so that it always starts at 1. |
| [91](#L91) | $counter ++; |
| [92](#L92) |  |
| [93](#L93) | // Enforce the counter. |
| [94](#L94) | PodsForm::$form\_counter = $counter; |
| [95](#L95) |  |
| [96](#L96) | pods\_static\_cache\_set( $pod->pod . '-counter', $counter, 'pods-forms' ); |
| [97](#L97) | ?> |
| [98](#L98) |  |
| [99](#L99) | <?php if ( ! $fields\_only ) : ?> |
| [100](#L100) | <?php $field\_prefix = 'pods\_field\_'; ?> |
| [101](#L101) | <form |
| [102](#L102) | action="" |
| [103](#L103) | method="post" |
| [104](#L104) | class="pods-submittable pods-form pods-form-front pods-form-pod-<?php echo esc\_attr( $pod\_name ); ?> pods-submittable-ajax" |
| [105](#L105) | data-location="<?php echo esc\_attr( $thank\_you ); ?>" |
| [106](#L106) | id="pods-form-<?php echo esc\_attr( $pod\_name . '-' . $counter ); ?>" |
| [107](#L107) | data-pods-pod-name="<?php echo esc\_attr( $pod\_name ); ?>" |
| [108](#L108) | data-pods-item-id="<?php echo esc\_attr( $id ); ?>" |
| [109](#L109) | data-pods-form-counter="<?php echo esc\_attr( $counter ); ?>" |
| [110](#L110) | > |
| [111](#L111) | <div class="pods-submittable-fields"> |
| [112](#L112) | <?php echo PodsForm::field( 'action', 'pods\_admin', 'hidden' ); ?> |
| [113](#L113) | <?php echo PodsForm::field( 'method', 'process\_form', 'hidden' ); ?> |
| [114](#L114) | <?php echo PodsForm::field( 'do', ( ! empty( $id ) ? 'save' : 'create' ), 'hidden' ); ?> |
| [115](#L115) | <?php echo PodsForm::field( '\_pods\_nonce', $nonce, 'hidden' ); ?> |
| [116](#L116) | <?php echo PodsForm::field( '\_pods\_pod', $pod\_name, 'hidden' ); ?> |
| [117](#L117) | <?php echo PodsForm::field( '\_pods\_id', $id, 'hidden' ); ?> |
| [118](#L118) | <?php echo PodsForm::field( '\_pods\_uri', $uri\_hash, 'hidden' ); ?> |
| [119](#L119) | <?php echo PodsForm::field( '\_pods\_form', implode( ',', array\_keys( $submittable\_fields ) ), 'hidden' ); ?> |
| [120](#L120) | <?php echo PodsForm::field( '\_pods\_form\_key', ! empty( $form\_key ) ? $form\_key : '', 'hidden' ); ?> |
| [121](#L121) | <?php echo PodsForm::field( '\_pods\_location', $\_SERVER['REQUEST\_URI'], 'hidden' ); ?> |
| [122](#L122) | <?php endif; ?> |
| [123](#L123) |  |
| [124](#L124) | <?php |
| [125](#L125) | /\*\* |
| [126](#L126) | \* Runs before fields are outputted. |
| [127](#L127) | \* |
| [128](#L128) | \* @params array $fields Fields of the form. |
| [129](#L129) | \* @params object $pod The current Pod object. |
| [130](#L130) | \* @params array $params The form's parameters. |
| [131](#L131) | \* |
| [132](#L132) | \* @since  2.3.19 |
| [133](#L133) | \*/ |
| [134](#L134) | do\_action( 'pods\_form\_pre\_fields', $fields, $pod, $params ); |
| [135](#L135) |  |
| [136](#L136) | $field\_row\_classes = 'pods-field-html-class'; |
| [137](#L137) | $heading\_tag       = 'h3'; |
| [138](#L138) |  |
| [139](#L139) | $pre\_callback = static function ( $field\_name, $id, $field, $pod ) use ( $fields, $params ) { |
| [140](#L140) | /\*\* |
| [141](#L141) | \* Runs before a field is output. |
| [142](#L142) | \* |
| [143](#L143) | \* @since 2.3.19 |
| [144](#L144) | \* |
| [145](#L145) | \* @param array  $field  The current field. |
| [146](#L146) | \* @param array  $fields All fields of the form. |
| [147](#L147) | \* @param object $pod    The current Pod object. |
| [148](#L148) | \* @param array  $params The form's parameters. |
| [149](#L149) | \*/ |
| [150](#L150) | do\_action( 'pods\_form\_pre\_field', $field, $fields, $pod, $params ); |
| [151](#L151) | }; |
| [152](#L152) |  |
| [153](#L153) | $post\_callback = static function ( $field\_name, $id, $field, $pod ) use ( $fields, $params ) { |
| [154](#L154) | /\*\* |
| [155](#L155) | \* Runs after a field is output. |
| [156](#L156) | \* |
| [157](#L157) | \* @since  2.3.19 |
| [158](#L158) | \* |
| [159](#L159) | \* @params array  $field  The current field. |
| [160](#L160) | \* @params array  $fields All fields of the form. |
| [161](#L161) | \* @params object $pod    The current Pod object. |
| [162](#L162) | \* @params array  $params The form's parameters. |
| [163](#L163) | \*/ |
| [164](#L164) | do\_action( 'pods\_form\_after\_field', $field, $fields, $pod, $params ); |
| [165](#L165) | }; |
| [166](#L166) |  |
| [167](#L167) | $template        = 'ui/forms/list-rows.php'; |
| [168](#L168) | $template\_before = ''; |
| [169](#L169) | $template\_after  = ''; |
| [170](#L170) |  |
| [171](#L171) | if ( 'div' === $output\_type ) { |
| [172](#L172) | $template = 'ui/forms/div-rows.php'; |
| [173](#L173) | } elseif ( 'p' === $output\_type ) { |
| [174](#L174) | $template = 'ui/forms/p-rows.php'; |
| [175](#L175) | } elseif ( 'table' === $output\_type ) { |
| [176](#L176) | $template        = 'ui/forms/table-rows.php'; |
| [177](#L177) | $template\_before = '<table>'; |
| [178](#L178) | $template\_after  = '</table>'; |
| [179](#L179) | } |
| [180](#L180) |  |
| [181](#L181) | echo $template\_before; |
| [182](#L182) |  |
| [183](#L183) | pods\_view( PODS\_DIR . $template, compact( array\_keys( get\_defined\_vars() ) ) ); |
| [184](#L184) |  |
| [185](#L185) | echo $template\_after; |
| [186](#L186) |  |
| [187](#L187) | /\*\* |
| [188](#L188) | \* Runs after all fields are outputted. |
| [189](#L189) | \* |
| [190](#L190) | \* @params array $fields Fields of the form |
| [191](#L191) | \* @params object $pod The current Pod object |
| [192](#L192) | \* @params array $params The form's parameters. |
| [193](#L193) | \* |
| [194](#L194) | \* @since  2.3.19 |
| [195](#L195) | \*/ |
| [196](#L196) | do\_action( 'pods\_form\_after\_fields', $fields, $pod, $params ); |
| [197](#L197) | ?> |
| [198](#L198) |  |
| [199](#L199) | <?php if ( ! $fields\_only ) : ?> |
| [200](#L200) | <p class="pods-submit"> |
| [201](#L201) | <img class="waiting" src="<?php echo esc\_url( admin\_url( '/images/wpspin\_light.gif' ) ); ?>" alt="<?php esc\_attr\_e( 'Submitting...', 'pods' ); ?>"> |
| [202](#L202) | <input type="submit" value=" <?php echo esc\_attr( $label ); ?> " class="pods-submit-button" /> |
| [203](#L203) |  |
| [204](#L204) | <?php do\_action( 'pods\_form\_after\_submit', $pod, $fields, $params ); ?> |
| [205](#L205) | </p> |
| [206](#L206) | </div> |
| [207](#L207) | </form> |
| [208](#L208) |  |
| [209](#L209) | <script type="text/javascript"> |
| [210](#L210) | if ( 'undefined' === typeof pods\_form\_init ) { |
| [211](#L211) | var pods\_form\_init = true; |
| [212](#L212) |  |
| [213](#L213) | document.addEventListener( "DOMContentLoaded", function () { |
| [214](#L214) | if ( 'undefined' !== typeof jQuery( document ).Pods ) { |
| [215](#L215) |  |
| [216](#L216) | if ( 'undefined' === typeof ajaxurl ) { |
| [217](#L217) | window.ajaxurl = '<?php echo pods\_slash( admin\_url( 'admin-ajax.php' ) ); ?>'; |
| [218](#L218) | } |
| [219](#L219) |  |
| [220](#L220) | jQuery( document ).Pods( 'validate' ); |
| [221](#L221) | jQuery( document ).Pods( 'submit' ); |
| [222](#L222) | jQuery( document ).Pods( 'dependency', true ); // Pass `true` to trigger init. |
| [223](#L223) | } |
| [224](#L224) | }, false ); |
| [225](#L225) | } |
| [226](#L226) | </script> |
| [227](#L227) | <?php endif; ?> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/pods/tags/3.2.1/ui/front/form.php?format=txt)
* [Original Format](/export/3220505/pods/tags/3.2.1/ui/front/form.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from pods.io_08d6bbfe_20250111_021148.html ===


* [Log In](https://pods.io/wp-login.php)
* [Register](https://pods.io/wp-login.php?action=register)
* Search

[Skip to content](#content "Skip to content")

[![Pods Framework](https://pods.io/files/2021/09/pods-logo-www.svg)](https://pods.io/)

[![Pods Framework](https://pods.io/files/2021/09/pods-logo-www.svg)](https://pods.io/ "Pods Framework")

Menu

* [Features](https://pods.io/features/)
* [Pro by SKCDEV](https://pods-pro.skc.dev/ "Pods Pro by SKCDEV")
* [Add-Ons](https://pods.io/plugins/)
* [Docs](https://docs.pods.io/)
  + [Videos](https://docs.pods.io/videos/)
  + [FAQs](https://docs.pods.io/faqs/)
  + [Code Snippets](https://docs.pods.io/code-snippets/)
  + [Tutorials](https://docs.pods.io/tutorials/)
  + [Field Types](https://docs.pods.io/fields/)
  + [Code Reference](https://docs.pods.io/code/)
* [Support](https://support.pods.io/)
* [About](https://pods.io/about/)
  + [Blog](https://pods.io/blog/)
  + [Meet the Team](https://pods.io/about/meet-the-team/)
  + [Join the Project](https://pods.io/about/join-the-project/)
  + [Privacy Policy](https://pods.io/privacy-policy/)
* [Donate](https://friends.pods.io/)

[![Pods Framework](https://pods.io/files/2021/09/pods-logo-www.svg)](https://pods.io/ "Pods Framework")

Menu

* [Features](https://pods.io/features/)
* [Pro by SKCDEV](https://pods-pro.skc.dev/ "Pods Pro by SKCDEV")
* [Add-Ons](https://pods.io/plugins/)
* [Docs](https://docs.pods.io/)
  + [Videos](https://docs.pods.io/videos/)
  + [FAQs](https://docs.pods.io/faqs/)
  + [Code Snippets](https://docs.pods.io/code-snippets/)
  + [Tutorials](https://docs.pods.io/tutorials/)
  + [Field Types](https://docs.pods.io/fields/)
  + [Code Reference](https://docs.pods.io/code/)
* [Support](https://support.pods.io/)
* [About](https://pods.io/about/)
  + [Blog](https://pods.io/blog/)
  + [Meet the Team](https://pods.io/about/meet-the-team/)
  + [Join the Project](https://pods.io/about/join-the-project/)
  + [Privacy Policy](https://pods.io/privacy-policy/)
* [Donate](https://friends.pods.io/)

# Blog

# Pods 3.2.1.1 Security Release

May 8, 2024 by [Scott Kingsley Clark](https://pods.io/author/sc0ttkclark/ "View all posts by Scott Kingsley Clark")

### This is a **Security focused** release

A security issue was responsibly reported and this release hardens security so that we properly enforce safe URLs for the Pods form submission confirmation page URLs.

### Security hotfixes are now available

Are you running an older version of Pods? A special release has been prepared for each major version back to Pods 2.7 as per our [Security EOL policy](https://pods.io/2024/04/10/eol-security-support-changes-for-older-pods-versions/).

* **Hotfix: Pods 2.7.31.3** – [Download ZIP from WordPress.org](https://downloads.wordpress.org/plugin/pods.2.7.31.3.zip)
* **Hotfix: Pods 2.8.23.3** – [Download ZIP from WordPress.org](https://downloads.wordpress.org/plugin/pods.2.8.23.3.zip)
* **Hotfix: Pods 2.9.19.3** – [Download ZIP from WordPress.org](https://downloads.wordpress.org/plugin/pods.2.9.19.3.zip)
* **Hotfix: Pods 3.0.10.3** – [Download ZIP from WordPress.org](https://downloads.wordpress.org/plugin/pods.3.0.10.3.zip)
* **Hotfix: Pods 3.1.4.1** – [Download ZIP from WordPress.org](https://downloads.wordpress.org/plugin/pods.3.1.4.1.zip)
* **Current: Pods 3.2.1.1** – [Download ZIP from WordPress.org](https://downloads.wordpress.org/plugin/pods.3.2.1.1.zip)

### Changelog

* Security hardening: Enforce safe URLs for Pods form submission confirmation page URLs. Props to the wesley (wcraft) / Wordfence for responsibly reporting this. ([@sc0ttkclark](https://github.com/sc0ttkclark))

Categories [Announcements](https://pods.io/category/announcements/), [Updates](https://pods.io/category/updates-2/) Tags [releases](https://pods.io/tag/releases/), [security](https://pods.io/tag/security/)
[EOL Security Support changes for older Pods versions](https://pods.io/2024/04/10/eol-security-support-changes-for-older-pods-versions/)

## Search

Search for:

## Want to contribute?

Let us know if you would like to contribute code or post to this blog – we’d love to have you be a part of the discussions and core development.

[Join the team »](https://pods.io/github/)

[Become a Friend of Pods »](https://friends.pods.io/)

## Archives

Archives
Select Month
 May 2024  (1)
 April 2024  (1)
 March 2024  (1)
 February 2024  (1)
 October 2023  (1)
 September 2023  (1)
 April 2023  (1)
 March 2023  (1)
 January 2023  (1)
 September 2022  (1)
 August 2022  (1)
 July 2022  (1)
 January 2022  (1)
 October 2021  (3)
 September 2021  (1)
 August 2021  (2)
 May 2021  (1)
 April 2021  (1)
 February 2021  (1)
 January 2021  (1)
 December 2020  (2)
 November 2020  (1)
 October 2020  (1)
 August 2020  (1)
 July 2020  (1)
 March 2020  (1)
 January 2020  (1)
 November 2019  (1)
 September 2019  (1)
 July 2019  (1)
 June 2019  (1)
 March 2019  (1)
 December 2018  (2)
 October 2018  (2)
 December 2017  (2)
 July 2017  (2)
 June 2017  (1)
 May 2017  (2)
 April 2017  (1)
 January 2017  (1)
 August 2016  (1)
 June 2016  (2)
 May 2016  (1)
 April 2016  (1)
 March 2016  (1)
 February 2016  (3)
 December 2015  (2)
 November 2015  (1)
 September 2015  (1)
 August 2015  (2)
 June 2015  (1)
 May 2015  (3)
 April 2015  (2)
 March 2015  (3)
 February 2015  (3)
 January 2015  (1)
 December 2014  (1)
 September 2014  (1)
 August 2014  (2)
 July 2014  (1)
 June 2014  (4)
 May 2014  (2)
 April 2014  (3)
 March 2014  (2)
 February 2014  (1)
 January 2014  (2)
 December 2013  (1)
 August 2013  (1)
 July 2013  (3)
 December 2012  (2)
 October 2012  (3)
 September 2012  (6)
 August 2012  (6)
 July 2012  (3)
 June 2012  (4)
 May 2012  (6)
 April 2012  (7)
 March 2012  (3)
 February 2012  (1)
 January 2012  (3)
 December 2011  (3)
 November 2011  (1)
 October 2011  (1)
 September 2011  (4)
 August 2011  (8)
 July 2011  (23)
 June 2011  (21)
 May 2011  (12)
 April 2011  (25)
 March 2011  (25)
 February 2011  (13)
 January 2011  (8)
 December 2010  (4)
 November 2010  (6)
 October 2010  (28)

## Join our Slack

[Join our Slack](https://support.pods.io/chat/) for more updates and get access to support from our fantastic community.

## Sponsored through Generous Donations by

[Gravity Forms](https://www.gravityforms.com/?utm_source=pods_footer&utm_medium=banner&utm_campaign=pods), [OptinMonster](https://optinmonster.com/?utm_source=pods_footer&utm_medium=banner&utm_campaign=pods) and our [Friends of Pods](https://friends.pods.io/friends-and-partners/)

[Site hosting provided by:](https://pods.io/nexcess/ "Site hosting provided by Nexcess")

* [Pods Home](https://pods.io)
* [About](https://pods.io/about/)
* [Blog](https://pods.io/blog/)
* [Docs](https://docs.pods.io)
* [Support](https://support.pods.io)
* [Donate](https://friends.pods.io/)

© 2008-2025 [Pods Foundation, Inc.](https://podsfoundation.org) All rights reserved.

![Cleantalk Pixel](https://moderate9-v4.cleantalk.org/pixel/27bcdd064d413d3bbfc35b472b8185c9.gif "Cleantalk Pixel")


