
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnats-io%2Fnats-server%2Fsecurity%2Fadvisories%2FGHSA-fr2g-9hjm-wr23)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnats-io%2Fnats-server%2Fsecurity%2Fadvisories%2FGHSA-fr2g-9hjm-wr23)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=nats-io%2Fnats-server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nats-io](/nats-io)
/
**[nats-server](/nats-io/nats-server)**
Public

* [Notifications](/login?return_to=%2Fnats-io%2Fnats-server) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2Fnats-io%2Fnats-server)
* [Star
   16.3k](/login?return_to=%2Fnats-io%2Fnats-server)

* [Code](/nats-io/nats-server)
* [Issues
  361](/nats-io/nats-server/issues)
* [Pull requests
  47](/nats-io/nats-server/pulls)
* [Discussions](/nats-io/nats-server/discussions)
* [Actions](/nats-io/nats-server/actions)
* [Projects
  0](/nats-io/nats-server/projects)
* [Security](/nats-io/nats-server/security)
* [Insights](/nats-io/nats-server/pulse)

Additional navigation options

* [Code](/nats-io/nats-server)
* [Issues](/nats-io/nats-server/issues)
* [Pull requests](/nats-io/nats-server/pulls)
* [Discussions](/nats-io/nats-server/discussions)
* [Actions](/nats-io/nats-server/actions)
* [Projects](/nats-io/nats-server/projects)
* [Security](/nats-io/nats-server/security)
* [Insights](/nats-io/nats-server/pulse)

# Adding accounts for just the system account adds auth bypass

High

[philpennock](/philpennock)
published
GHSA-fr2g-9hjm-wr23
Oct 18, 2023

## Package

gomod

nats-server
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

2.2.0 <= V <= 2.10.1

## Patched versions

2.10.2, 2.9.23

## Description

(This advisory is canonically <https://advisories.nats.io/CVE/secnote-2023-01.txt>)

## Background

NATS.io is a high performance open source pub-sub distributed communication technology, built for the cloud, on-premise, IoT, and edge computing.

NATS users exist within accounts, and once using accounts, the old authorization block is not applicable.

## Problem Description

Without any authorization rules in the nats-server, users can connect without authentication.

Before nats-server 2.2.0, all authentication and authorization rules for a nats-server lived in an "authorization" block, defining users. With nats-server 2.2.0 all users live inside accounts. When using the authorization block, whose syntax predates this, those users will be placed into the implicit global account, "$G". Users inside accounts go into the newer "accounts" block.

If an "accounts" block is defined, in simple deployment scenarios this is often used only to enable client access to the system account. When the only account added is the system account "$SYS", the nats-server would create an implicit user in "$G" and set it as the `no_auth_user` account, enabling the same "without authentication" logic as without any rules.

This preserved the ability to connect simply, and then add one authenticated login for system access.

But with an "authorization" block, this is wrong. Users exist in the global account, with login rules. And in simple testing, they might still connect fine without administrators seeing that authentication has been disabled.

The blind-spot on our part came from encouraging and documenting a switch to using only "accounts", instead of "authorization".

In the fixed versions, using an "authorization" block will inhibit the implicit creation of a "$G" user and setting it as the `no_auth_user` target. In unfixed versions, just creating a second account, with no users, will also inhibit this behavior.

## Affected versions

NATS Server:

* 2.2.0 up to and including 2.9.22 and 2.10.1
* Fixed with nats-io/nats-server: 2.10.2 and backported to 2.9.23

## Workarounds

In the "accounts" block, define a second non-system account, leave it empty.

```
accounts {
    SYS: {
        users: [
            { user: sysuser, password: makemeasandwich }
        ]
    }
    DUMMY: {}  # for security, before 2.10.2
}
system_account: SYS

```
## Solution

Any one of these:

1. Upgrade the NATS server to at least 2.10.2 (or 2.9.23)
2. Or define a dummy account
3. Or complete the migration of authorization entries to be inside a named account in the "accounts" block

## Credits

Problem reported by Alex Herrington.

Addressed publicly in a GitHub Discussion prior to this advisory.

### Severity

High

### CVE ID

No known CVE

### Weaknesses

[CWE-305](/advisories?query=cwe%3A305)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

