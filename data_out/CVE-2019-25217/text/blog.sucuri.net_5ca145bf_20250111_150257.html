  [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)
     [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
 [Login](https://dashboard.sucuri.net/login/)       [Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)
 Search for:  Search

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)
# Insufficient Privilege Validation in SiteGround Optimizer & Caldera Forms Pro

  [![](https://secure.gravatar.com/avatar/8612a64e0ed5b9e586b548a984073120?s=60&d=mm&r=g)](https://blog.sucuri.net/author/marc)   [Marc-Alexandre Montpas](https://blog.sucuri.net/author/marc)

* March 13, 2019
 ![Stored XSS in MyBB](https://blog.sucuri.net/wp-content/uploads/2019/03/03132019-insufficient-privilege-validation-in-siteground-optimizer-and-caldera-forms-pro_blog.jpg)

**Exploitation Level:** Very Easy / Remote

**DREAD Score:** SiteGround Optimizer – 9.4, Caldera Forms Pro – 7.4

**Vulnerability:** File Inclusion / Code Execution

**Patched Version:** SiteGround Optimizer – 5.0.13, Caldera Forms Pro – 1.7.7/1.8.2

While investigating the SiteGround Optimizer and Caldera Forms Pro plugins we have discovered a critical privilege escalation vulnerability.

It was not being abused externally and impacts over 500,000 sites. It’s urgency is defined by the associated [DREAD](https://en.wikipedia.org/wiki/DREAD_%28risk_assessment_model%29) score that looks at damage, reproducibility, exploitability, affected users, and discoverability.

A key contributor to the criticality of these vulnerabilities is that it’s exploitable by any user (it’s not restricted to privileged users – e.g., admins) and is easy to exploit remotely.

## Current State of the Vulnerability

SiteGround and Caldera have both fixed their respective vulnerabilities.

### SiteGround Optimizer

SiteGround Optimizer is a plugin intended for users of SiteGround hosting services. It helps improve improve the performance of WordPress instances by using a number of unique optimization techniques.

All customers that use this plugin in the SiteGround environment have been automatically updated. No additional action is required for these users.

If you use the plugin outside of the SiteGround environment, you will need to take manual action to update the plugin immediately to version **5.0.13**. If you are no longer using it, we recommend that you remove it.

A successful attack on the SiteGround Optimizer would allow bad actors to store backdoors on vulnerable sites.

#### **Disclosure / Response Timeline:**

* Jan 14th – Initial contact attempt;
* Jan 15th – Vendor answers;
* Jan 15th – Sucuri provides details;
* Jan 16th – A patch is live, updates applied to customer sites.

### Caldera Forms Pro

Caldera Forms Pro is a WordPress plugin used to create modern forms on a site.

If you use the Caldera Forms Pro plugin, you will need to confirm you are using version **1.7.7** (for the 1.7 branch) or **1.8.2** (for the 1.8 branch). **This vulnerability only impacts Pro versions of this plugin.**

The Caldera Forms Pro vulnerability would allow attackers to read arbitrary files such as **wp-config.php** and leak database access credentials.

#### Disclosure / Response Timeline:

* Mar 1st – Initial contact attempt;
* Mar 1st – Vendor answers;
* Mar 1st – We send them the details;
* Mar 2nd – Vendor plans update for March 5th;
* Mar 4th – Agree on ~1 week embargo before publishing the full details, leaving time for Caldera to inform its own users first;
* Mar 5th – Patch is ready to be pushed on wp.org, planned to be released on the 6th;
* Mar 7th – The patch is live on wp.org.

## Technical Details

Both plugins leverage the WordPress REST API to provide new features to their customers. Some of the API endpoints failed to restrict sensitive functionality behind authentication controls.

![SiteGround Optimizer Vulnerable Script](https://blog.sucuri.net/wp-content/uploads/2019/03/SiteGround_Unprotected_Endpoint-650x131.png)

SiteGround Optimizer’s unprotected endpoints

Endpoints registered with the **register\_rest\_route** function should use the **permission\_callback** attribute to specify a method to do all their access control routines.

The screenshot above shows that it only used the **callback** attribute.

The **switch\_php** method is responsible for critical functionality. Abusing this method would allow attackers to store malicious PHP code on the server (i.e., backdoors).

![Caldera Forms Script](https://blog.sucuri.net/wp-content/uploads/2019/03/Caldera_Forms_Unprotected_Endpoint.png)

Caldera Forms Pro unprotected endpoint

The Caldera Forms Pro plugin tried to apply privilege checks on that endpoint, however; the errors comes in the use of **permissions** attribute instead of **permission\_callback**. The issue is  that the [REST API specifications only defines the latter](https://developer.wordpress.org/rest-api/extending-the-rest-api/routes-and-endpoints/). This means it will ignore the permissions attribute, making the endpoint **publicly accessible to any visitors**.

As you may understand from the callback method’s name, this made it possible to download any internal files from the site. It may also escalate this bug to a [PHAR unserialization vulnerability](https://blog.ripstech.com/2018/new-php-exploitation-technique/) if certain *very* specific conditions are combined.

## In Conclusion

As the REST API gains in popularity among plugin developers, we believe more vulnerabilities like these will continue to surface.

If you are using vulnerable versions of these plugins, updating them should become your priority. Users of the [Sucuri Firewall](http://sucuri.net/website-firewall/stop-website-attacks-and-hacks) were protected from these issues from the very beginning.

  [![](https://secure.gravatar.com/avatar/8612a64e0ed5b9e586b548a984073120?s=120&d=mm&r=g)](https://blog.sucuri.net/author/marc)
##### [Marc-Alexandre Montpas](https://blog.sucuri.net/author/marc)

Marc-Alexandre Montpas is Sucuri’s Senior Security Analyst who joined the company in 2014. Marc’s main responsibilities include reversing security patches and scavenging vulnerabilities, old and new. His professional experience covers eight years of finding bugs in open-source software. When Marc isn’t breaking things, you might find him participating in a hacking CTF competition. Connect with him on [Twitter](https://twitter.com/marcs0h).

##### Related Tags

* [Black Hat Tactics](https://blog.sucuri.net/tag/black-hat-tactics),
* [Hacked Websites](https://blog.sucuri.net/tag/hacked-websites),
* [WordPress Plugins and Themes](https://blog.sucuri.net/tag/wordpress-plugins-and-themes),
* [Zero-Day](https://blog.sucuri.net/tag/zero-day)
##### Related Categories

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)
##### You May Also Like

 ![How to Fix “There Has Been a Critical Error on Your Website” in WordPress (8 Steps)](https://blog.sucuri.net/wp-content/uploads/2023/01/BlogPost_Feature-Image_1490x700_How-to-Fix-the-There-Has-Been-a-Critical-Error-on-Your-Website-Message-in-WordPress-2-390x183.png)

* [Web Pros](https://blog.sucuri.net/category/web-pros)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [How to Fix “There Has Been a Critical Error on This Website”](https://blog.sucuri.net/2023/01/how-to-fix-there-has-been-a-critical-error-on-your-website-in-wordpress.html)

* [![](https://secure.gravatar.com/avatar/76a8d7b99bea67221096ab356c49ebc4?s=20&d=mm&r=g)Nathan Chaddock](https://blog.sucuri.net/author/nate "View all posts by Nathan Chaddock")
* January 12, 2023
 Critical errors on any system can be extremely frustrating. But if you’ve recently encountered the “There has been a critical error on this website” message…  [Read the Post](https://blog.sucuri.net/2023/01/how-to-fix-there-has-been-a-critical-error-on-your-website-in-wordpress.html)  ![](https://blog.sucuri.net/wp-content/uploads/2017/06/06082017-EN-when-plugins-turn-against-you_blog-390x183.jpg)

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [When Your Plugins Turn Against You](https://blog.sucuri.net/2017/06/when-your-plugins-turn-against-you.html)

* [![](https://secure.gravatar.com/avatar/814d8a855f60f285a7501fd7d0b13e17?s=20&d=mm&r=g)Cesar Anjos](https://blog.sucuri.net/author/cesarsucuri-net "View all posts by Cesar Anjos")
* June 13, 2017
 Every day we face countless cases of sites getting compromised and infected by an attacker. From there, the sites can be used for various operations…  [Read the Post](https://blog.sucuri.net/2017/06/when-your-plugins-turn-against-you.html)  ![](https://blog.sucuri.net/wp-content/uploads/2017/02/02092017-EN-rest-api-vulnerability_blog-390x183.jpg)

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [RCE Attempts Against the Latest WordPress REST API Vulnerability](https://blog.sucuri.net/2017/02/rce-attempts-against-the-latest-wordpress-rest-api-vulnerability.html)

* [![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=20&d=mm&r=g)Daniel Cid](https://blog.sucuri.net/author/dcid "View all posts by Daniel Cid")
* February 9, 2017
 We are starting to see remote command execution (RCE) attempts trying to exploit the latest WordPress REST API Vulnerability. These RCE attempts started today after…  [Read the Post](https://blog.sucuri.net/2017/02/rce-attempts-against-the-latest-wordpress-rest-api-vulnerability.html)  ![Fake Browser Updates Push Ransomware and Bank Malware](https://blog.sucuri.net/wp-content/uploads/2019/02/02282019-fake-browser-updates-push-ransomware-and-bank-malware_blog-390x183.png)

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Fake Browser Updates Push Ransomware and Bank Malware](https://blog.sucuri.net/2019/02/fake-browser-updates-push-ransomware-and-bank-malware.html)

* [![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=20&d=mm&r=g)Denis Sinegubko](https://blog.sucuri.net/author/denis "View all posts by Denis Sinegubko")
* February 28, 2019
 Recently we came across a malicious campaign injecting scripts that push fake browser updates onto site visitors. This is what a typical fake update request…  [Read the Post](https://blog.sucuri.net/2019/02/fake-browser-updates-push-ransomware-and-bank-malware.html)  ![WordPress Hacked: WHat to do when your site is compromised](https://blog.sucuri.net/wp-content/uploads/2024/02/Blog-Post-Tips-to-Prevent-a-WordPress-Hack-390x183.png)

* [Security Education](https://blog.sucuri.net/category/security-education)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [WordPress User Enumeration: Risks & Mitigation Steps](https://blog.sucuri.net/2024/07/wordpress-user-enumeration.html)

* [![](https://secure.gravatar.com/avatar/a3ef43c4765fe447a305b82f38ea7bd1?s=20&d=mm&r=g)Rianna MacLeod](https://blog.sucuri.net/author/rianna "View all posts by Rianna MacLeod")
* July 3, 2024
 User enumeration is a technique used by attackers to discover valid usernames associated with a CMS or website. By exploiting certain features, bad actors can…  [Read the Post](https://blog.sucuri.net/2024/07/wordpress-user-enumeration.html)  ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og1-390x181.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Super Amazon Banners Plugin Gone Rogue](https://blog.sucuri.net/2019/03/super-amazon-banners-plugin-gone-rogue.html)

* [![](https://secure.gravatar.com/avatar/df2487806812cf3a45af64a37a1e0daf?s=20&d=mm&r=g)Krasimir Konov](https://blog.sucuri.net/author/krasimir "View all posts by Krasimir Konov")
* March 26, 2019
 During a recent investigation we found the plugin Super Amazon Banners to be serving malware/spam via the domain seoranker[.]info. We suspect that the domain expired…  [Read the Post](https://blog.sucuri.net/2019/03/super-amazon-banners-plugin-gone-rogue.html)  ![](https://blog.sucuri.net/wp-content/uploads/2016/08/08112016_hijacked-search-results_v2_blog-390x183.jpg)

* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Analyzing and Cleaning Hijacked Google SEO Spam Results](https://blog.sucuri.net/2016/08/cleaning-hijacked-google-seo-spam-results.html)

* [![](https://secure.gravatar.com/avatar/b020abf59d6245e6b2a4635063322498?s=20&d=mm&r=g)Luke Leal](https://blog.sucuri.net/author/luke "View all posts by Luke Leal")
* August 11, 2016
 Blackhat SEO spam comes in many forms, and one of the most nefarious is hijacked search results. This happens when search engines crawl and display…  [Read the Post](https://blog.sucuri.net/2016/08/cleaning-hijacked-google-seo-spam-results.html)  ![](https://blog.sucuri.net/wp-content/uploads/2016/02/02012016_Admedia-390x184.jpg)

* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Massive Admedia/Adverting iFrame Infection](https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html)

* [![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=20&d=mm&r=g)Denis Sinegubko](https://blog.sucuri.net/author/denis "View all posts by Denis Sinegubko")
* February 1, 2016
 This past weekend we registered a spike in WordPress infections where hackers injected encrypted code at the end of all legitimate .js files. The distinguishing…  [Read the Post](https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html)  ![](https://blog.sucuri.net/wp-content/uploads/2021/12/BlogPost_FeatureImage_1490x700_Log4jVulnerability-390x183.jpg)

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [Website Security](https://blog.sucuri.net/category/website-security)

## [What is the Log4j Vulnerability?](https://blog.sucuri.net/2021/12/log4j-vulnerability-the-perfect-holiday-present-that-nobody-wants.html)

* [![](https://secure.gravatar.com/avatar/fcf2c7b3195ff9058d29af3b8a49fc43?s=20&d=mm&r=g)Ben Martin](https://blog.sucuri.net/author/benmartin "View all posts by Ben Martin")
* December 14, 2021
 Editorial: This post was last updated October 17th, 2022. What is the Log4j vulnerability? Originally found on the popular game Minecraft, this critical server security…  [Read the Post](https://blog.sucuri.net/2021/12/log4j-vulnerability-the-perfect-holiday-present-that-nobody-wants.html)  ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og-servers-390x205.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Email Scraper: Mass Mail Grabber from Database](https://blog.sucuri.net/2020/02/email-scraper-mass-mail-grabber-from-database.html)

* [![](https://secure.gravatar.com/avatar/b020abf59d6245e6b2a4635063322498?s=20&d=mm&r=g)Luke Leal](https://blog.sucuri.net/author/luke "View all posts by Luke Leal")
* February 5, 2020
 One of our Remediation team analysts, Liam Smith, discovered a malicious file on a client’s compromised WordPress website that demonstrates how attackers can use rudimentary…  [Read the Post](https://blog.sucuri.net/2020/02/email-scraper-mass-mail-grabber-from-database.html)
##### Search

 Search for:  Search[![WordPress Security Guide Sidebar](https://blog.sucuri.net/wp-content/uploads/2024/02/WordPress-Security-Guide-Sidebar.jpg)](https://sucuri.net/guides/wordpress-security/)[![](https://blog.sucuri.net/wp-content/uploads/2023/04/23-sucuri-newsletter-blog-banner.png)](https://info.sucuri.net/subscribe-to-security)[![Sucuri Sidebar Malware Removal to Signup Page](https://blog.sucuri.net/wp-content/uploads/2023/08/23-sucuri-blog-sidebar-banner-need-help-cleaning-up-malware-on-your-website-get-help-now-new.png)](https://sucuri.net/website-security-platform/signup/) ![Sucuri Logo](https://sucuri.net/wp-content/uploads/2022/12/sucuri_logo_dark.svg)

Let’s Connect

        [Products](https://sucuri.net/website-security/)   [Website Firewall](https://sucuri.net/website-firewall/)   [Website Security Platform](https://sucuri.net/website-security-platform/)   [WordPress Security](https://sucuri.net/wordpress-security/)   [Website Backups](https://sucuri.net/website-backups/)   [Hack Assistance](https://sucuri.net/website-security-platform/help-now/)   [Pricing](https://sucuri.net/website-security-platform/signup)   [Solutions](https://sucuri.net/ddos-protection/)   [DDoS Protection](https://sucuri.net/ddos-protection/)   [Malware Detection](https://sucuri.net/malware-detection-scanning/)   [Malware Removal](https://sucuri.net/website-malware-removal/)   [Malware Prevention](https://sucuri.net/website-hack-protection/)   [Blacklist Removal](https://sucuri.net/website-security-platform/blocklist-removal-and-repair/)   [SEO Spam Removal](https://sucuri.net/seo-spam-removal/)  USE CASES  [Developers](https://sucuri.net/developers/)   [Ecommerce](https://sucuri.net/ecommerce-website-security/)   [Agency Plans](https://sucuri.net/custom/agency/)   [Enterprise Services](https://sucuri.net/custom/agency/)   [HTTPS/2](https://sucuri.net/http-2-rapid-reset/)   [Virtual Patching](https://sucuri.net/virtual-patching/)   [Support](https://docs.sucuri.net/)   [Knowledge Base](https://docs.sucuri.net/)   [SiteCheck](https://sitecheck.sucuri.net/)   [Guides](https://sucuri.net/guides/)   [Research Labs](https://labs.sucuri.net/)   [Report Abuse](https://abuse.sucuri.net/)   [Status Report](https://status.sucuri.net/)   [Company](https://sucuri.net/company/)   [About Sucuri](https://sucuri.net/company/)   [Contact](https://sucuri.net/company/contact-us/)   [Blog](https://blog.sucuri.net/)   [Referral](https://sucuri.net/referral/)   [Partners](https://sucuri.net/partners/)   [Testimonials](https://sucuri.net/customers/)  [Terms of Use](https://sucuri.net/terms/) [Privacy Policy](https://sucuri.net/privacy/) [Do Not Sell My Personal Information](https://sucuri.net/cookies/) [Frequently Asked Questions](https://sucuri.net/faq/)

© 2024 GoDaddy Mediatemple, Inc., d/b/a Sucuri. All rights reserved.

   [back to top](#top "Going Top")  X

Sucuri Cookie Policy
 [See our policy>>](https://sucuri.net/cookies)

Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.

 Accept Decline Manage Options