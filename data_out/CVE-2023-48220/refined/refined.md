```
{
  "vulnerability": {
    "root_cause": "The `devise_invitable` gem does not validate the invitation expiry period when using the password reset functionality, allowing users to accept invitations even after the `invite_for` period has passed.",
    "weaknesses": [
      "Improper validation of invitation token expiry during password reset."
    ],
    "impact": "An attacker can bypass the invitation expiry period, potentially gaining unauthorized access to the system by exploiting the password reset mechanism even after an invitation has expired.",
    "attack_vectors": [
      "Network-based attack, requiring an existing invitation (even expired)."
    ],
    "required_attacker_capabilities": "An attacker needs a valid (or previously valid but now expired) invitation to a user account. They must also be able to initiate a password reset for the invited user, which typically involves knowing the invited user's email address. The attacker needs access to the email account of the intended user or is able to intercept emails sent to the user to use the password reset link."
  },
  "additional_details": {
    "patched_versions": [
      "decidim 0.26.9",
      "decidim 0.27.5",
      "decidim 0.28.0",
      "devise_invitable 2.0.9"
     ],
    "affected_versions": [
       "devise_invitable >= v0.4.rc3, < 2.0.9",
       "decidim >= v0.0.1.alpha3"
    ],
    "references": [
      "https://github.com/decidim/decidim/security/advisories/GHSA-w3q8-m492-4pwp",
      "https://github.com/scambra/devise_invitable/blob/41f58970ff76fb64382a9b9ea1bd530f7c3adab2/lib/devise_invitable/models.rb#L198",
      "https://github.com/scambra/devise_invitable#model-configuration-",
      "https://github.com/decidim/decidim/blob/d2d390578050772d1bdb6d731395f1afc39dcbfc/decidim-core/config/initializers/devise.rb#L134",
      "https://github.com/scambra/devise_invitable/commit/94d859c7de0829bf63f679ae5dd3cab2b866a098",
       "https://github.com/decidim/decidim/commit/073e60e2e4224dd81815a784002ebba30f2ebb34",
      "https://github.com/decidim/decidim/commit/b12800717a689c295a9ea680a38ca9f823d2c454"
    ],
      "workarounds": "Invitations can be cancelled directly from the database by running the following command from the Rails console: `Decidim::User.invitation_not_accepted.update_all(invitation_token: nil)`",
    "cvss_v3_base_score": 5.7,
      "cvss_v3_vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:N"
  }
}
```