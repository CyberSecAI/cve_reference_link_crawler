```
{
  "vulnerability": {
    "root_cause": "The netfilter subsystem in the Linux kernel did not properly sanitize the layer 3 and layer 4 protocol numbers when creating custom connection tracking expectations.",
    "weaknesses": [
      "Improper input validation of layer 3 and 4 protocol numbers in nft_ct connection tracking expectations."
    ],
    "impact": "An attacker could potentially cause unexpected behavior in connection tracking or possibly other undefined effects by specifying invalid protocol numbers.",
    "attack_vectors": "An attacker could potentially exploit this vulnerability by crafting malicious nftables rules that include custom connection tracking expectations with invalid protocol numbers.",
    "required_capabilities": "The attacker would need the ability to create and apply nftables rules on the target system."
  },
  "fixes": [
    {
      "commit": "8059918a1377f2f1fff06af4f5a4ed3d5acd6bc4",
      "description": "The fix adds checks to ensure that the layer 3 protocol family is one of NFPROTO_IPV4, NFPROTO_IPV6, or NFPROTO_INET, and that the layer 4 protocol is one of TCP, UDP, UDPLITE, DCCP, or SCTP. Also ensures the layer 3 protocol family matches the context, and that a destination port is specified with a layer 4 protocol."
    }
  ],
  "references": [
    "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8059918a1377f2f1fff06af4f5a4ed3d5acd6bc4",
    "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html"
  ]
}
```