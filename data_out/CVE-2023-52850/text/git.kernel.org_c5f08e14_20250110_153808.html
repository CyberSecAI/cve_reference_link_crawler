

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=66b4c5f980d741f3a47e4b65eeaf2797f2d59294)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=66b4c5f980d741f3a47e4b65eeaf2797f2d59294)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=66b4c5f980d741f3a47e4b65eeaf2797f2d59294)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=66b4c5f980d741f3a47e4b65eeaf2797f2d59294)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Marek Vasut <marex@denx.de> | 2023-08-24 03:38:58 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-11-20 11:57:19 +0100 |
| commit | [66b4c5f980d741f3a47e4b65eeaf2797f2d59294](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=66b4c5f980d741f3a47e4b65eeaf2797f2d59294) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=66b4c5f980d741f3a47e4b65eeaf2797f2d59294)) | |
| tree | [052cb5cce7cb4ff1a617544f556e4f3b36b2a6f6](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=66b4c5f980d741f3a47e4b65eeaf2797f2d59294) | |
| parent | [a2e2190d994a3bd5d01b180a5c8673af53599f2d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a2e2190d994a3bd5d01b180a5c8673af53599f2d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=66b4c5f980d741f3a47e4b65eeaf2797f2d59294&id2=a2e2190d994a3bd5d01b180a5c8673af53599f2d)) | |
| download | [linux-66b4c5f980d741f3a47e4b65eeaf2797f2d59294.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-66b4c5f980d741f3a47e4b65eeaf2797f2d59294.tar.gz) | |

media: hantro: Check whether reset op is defined before use[ Upstream commit 88d4b23a629ebd34f682f770cb6c2116c851f7b8 ]
The i.MX8MM/N/P does not define the .reset op since reset of the VPU is
done by genpd. Check whether the .reset op is defined before calling it
to avoid NULL pointer dereference.
Note that the Fixes tag is set to the commit which removed the reset op
from i.MX8M Hantro G2 implementation, this is because before this commit
all the implementations did define the .reset op.
Fixes: 6971efb70ac3 ("media: hantro: Allow i.MX8MQ G1 and G2 to run independently")
Signed-off-by: Marek Vasut <marex@denx.de>
Reviewed-by: Chen-Yu Tsai <wenst@chromium.org>
Tested-by: Chen-Yu Tsai <wenst@chromium.org>
Reviewed-by: Adam Ford <aford173@gmail.com>
Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=66b4c5f980d741f3a47e4b65eeaf2797f2d59294)

| -rw-r--r-- | [drivers/media/platform/verisilicon/hantro\_drv.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/media/platform/verisilicon/hantro_drv.c?id=66b4c5f980d741f3a47e4b65eeaf2797f2d59294) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/drivers/media/platform/verisilicon/hantro\_drv.c b/drivers/media/platform/verisilicon/hantro\_drv.cindex c0a368bacf8803..7299bcdd3bfa44 100644--- a/[drivers/media/platform/verisilicon/hantro\_drv.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/media/platform/verisilicon/hantro_drv.c?id=a2e2190d994a3bd5d01b180a5c8673af53599f2d)+++ b/[drivers/media/platform/verisilicon/hantro\_drv.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/media/platform/verisilicon/hantro_drv.c?id=66b4c5f980d741f3a47e4b65eeaf2797f2d59294)@@ -125,7 +125,8 @@ void hantro\_watchdog(struct work\_struct \*work) ctx = v4l2\_m2m\_get\_curr\_priv(vpu->m2m\_dev); if (ctx) { vpu\_err("frame processing timed out!\n");- ctx->codec\_ops->reset(ctx);+ if (ctx->codec\_ops->reset)+ ctx->codec\_ops->reset(ctx); hantro\_job\_finish(vpu, ctx, VB2\_BUF\_STATE\_ERROR); } } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 15:36:45 +0000

