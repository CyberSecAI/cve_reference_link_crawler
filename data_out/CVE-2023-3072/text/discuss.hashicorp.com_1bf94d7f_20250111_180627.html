

[HashiCorp Discuss](/)

# [HCSEC-2023-20 - Nomad ACL Policies without Label are Applied to Unexpected Resources](/t/hcsec-2023-20-nomad-acl-policies-without-label-are-applied-to-unexpected-resources/56270)

[Security](/c/security/52)

[security-nomad](https://discuss.hashicorp.com/tag/security-nomad)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

July 19, 2023, 11:11pm

1

**Bulletin ID:** HCSEC-2023-20

**Affected Products / Versions:** Nomad and Nomad Enterprise 0.7 up to 1.5.6 and 1.4.10; fixed in 1.6.0, 1.5.7, and 1.4.11.

**Publication Date:** July 19, 2023

**Summary**

A vulnerability was identified in Nomad and Nomad Enterprise (“Nomad”) such an ACL policy using a block without label may be applied to unexpected resources. This vulnerability, CVE-2023-3072, affects Nomad from 0.7 up to 1.5.6 and 1.4.10 and was fixed in 1.6.0, 1.5.7, and 1.4.11.

**Background**

Nomad provides an [ACL policy system](https://developer.hashicorp.com/nomad/tutorials/access-control/access-control-policies) to enable authorization for the HTTP API. Administrators author ACL policies using HCL syntax and apply these policies to the cluster. Labels may be used to define the Nomad resources that specific policy blocks are applied to.

**Details**

Internal testing by the Nomad engineering team identified that policies that expect a label, but don’t specify one, may be applied to unexpected resources.

For example, the policy below is unexpectedly applied to a namespace called `policy`.

```
namespace {
  policy = "read"
}

```

This may lead cluster administrators to create policies that allow access to unintended resources. For namespace in particular, the Nomad documentation explicitly states that this is a supported use-case and that the policy is applied to the default namespace.

More requirements and recommendations for a secure Nomad deployment can be found in the [security model](https://developer.hashicorp.com/nomad/docs/concepts/security).

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Nomad 1.6.0, 1.5.7, and 1.4.11, or newer.

See Nomad’s [Upgrading](https://www.nomadproject.io/docs/upgrade) for general guidance on this process.

**Acknowledgement**

This issue was identified by the Nomad engineering team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2023-21 - Nomad Caller ACL Token's Secret ID is Exposed to Sentinel](https://discuss.hashicorp.com/t/hcsec-2023-21-nomad-caller-acl-tokens-secret-id-is-exposed-to-sentinel/56271)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5588 | July 19, 2023 |
| [HCSEC-2023-22 - Nomad Search API Leaks Information About CSI Plugins](https://discuss.hashicorp.com/t/hcsec-2023-22-nomad-search-api-leaks-information-about-csi-plugins/56272)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5700 | July 19, 2023 |
| [HCSEC-2024-29 - Nomad Allocations Vulnerable To Privilege Escalation Within A Namespace Using Unredacted Workload Identity Token](https://discuss.hashicorp.com/t/hcsec-2024-29-nomad-allocations-vulnerable-to-privilege-escalation-within-a-namespace-using-unredacted-workload-identity-token/72119)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 169 | December 20, 2024 |
| [HCSEC-2023-13 - Nomad Unauthenticated Client Agent HTTP Request Privilege Escalation](https://discuss.hashicorp.com/t/hcsec-2023-13-nomad-unauthenticated-client-agent-http-request-privilege-escalation/52375)  [Security](/c/security/52) | 0 | 6042 | April 5, 2023 |
| [HCSEC-2023-08 - Nomad Job Submitter Privilege Escalation Using Workload Identity](https://discuss.hashicorp.com/t/hcsec-2023-08-nomad-job-submitter-privilege-escalation-using-workload-identity/51389)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5258 | March 13, 2023 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

