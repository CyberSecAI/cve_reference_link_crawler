
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frealestate-com-au%2Fvulnerability-disclosures%2Fblob%2Fmain%2FLibreChat%2FCVE-2024-41703.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frealestate-com-au%2Fvulnerability-disclosures%2Fblob%2Fmain%2FLibreChat%2FCVE-2024-41703.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=realestate-com-au%2Fvulnerability-disclosures)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[realestate-com-au](/realestate-com-au)
/
**[vulnerability-disclosures](/realestate-com-au/vulnerability-disclosures)**
Public

* [Notifications](/login?return_to=%2Frealestate-com-au%2Fvulnerability-disclosures) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Frealestate-com-au%2Fvulnerability-disclosures)
* [Star
   0](/login?return_to=%2Frealestate-com-au%2Fvulnerability-disclosures)

* [Code](/realestate-com-au/vulnerability-disclosures)
* [Issues
  0](/realestate-com-au/vulnerability-disclosures/issues)
* [Pull requests
  0](/realestate-com-au/vulnerability-disclosures/pulls)
* [Actions](/realestate-com-au/vulnerability-disclosures/actions)
* [Security](/realestate-com-au/vulnerability-disclosures/security)
* [Insights](/realestate-com-au/vulnerability-disclosures/pulse)

Additional navigation options

* [Code](/realestate-com-au/vulnerability-disclosures)
* [Issues](/realestate-com-au/vulnerability-disclosures/issues)
* [Pull requests](/realestate-com-au/vulnerability-disclosures/pulls)
* [Actions](/realestate-com-au/vulnerability-disclosures/actions)
* [Security](/realestate-com-au/vulnerability-disclosures/security)
* [Insights](/realestate-com-au/vulnerability-disclosures/pulse)

## Files

 main
## Breadcrumbs

1. [vulnerability-disclosures](/realestate-com-au/vulnerability-disclosures/tree/main)
2. /[LibreChat](/realestate-com-au/vulnerability-disclosures/tree/main/LibreChat)
/
# CVE-2024-41703.md

Copy path Blame  Blame
## Latest commit

## History

[History](/realestate-com-au/vulnerability-disclosures/commits/main/LibreChat/CVE-2024-41703.md)75 lines (51 loc) · 4.41 KB main
## Breadcrumbs

1. [vulnerability-disclosures](/realestate-com-au/vulnerability-disclosures/tree/main)
2. /[LibreChat](/realestate-com-au/vulnerability-disclosures/tree/main/LibreChat)
/
# CVE-2024-41703.md

Top
## File metadata and controls

* Preview
* Code
* Blame

75 lines (51 loc) · 4.41 KB[Raw](https://github.com/realestate-com-au/vulnerability-disclosures/raw/refs/heads/main/LibreChat/CVE-2024-41703.md)
# CVE-2024-41703

## Executive Summary

LibreChat v0.7.4-rc1 and earlier has incorrect access control for message updates, allowing authenticated attackers to hijack other users' conversations.

Users of LibreChat should update to the latest version (issue fixed in v0.7.4).

CVSS v3.1 String: `AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N` (5.4)

## Description

Given a `conversationId` an authenticated attacker can hijack another user's conversation.

This can be achieved by sending crafted requests to the `/api/ask/<model>` endpoint using the target's `conversationId` in place of the attacker's own.

Additionally, after performing this attack the target's conversation will be shown in the attacker's history. From this point the attacker can interact with the target's conversation using the regular user interface, without the need for any further request manipulation. From the target's perspective any injected or modified messages will be shown as having been sent by themselves.

## Reproduction

* Obtain a `conversationId` from a target user (refer to Technical Details).
  + Optional: Obtain `messageId` if you want to alter a specific message.
* Intercept a request to Edit one of the attacker's own messages.
  + This can be done with a proxy like Burp or using dev tools.
* Change the following POST request parameters:
  + `text`: Change to any text you want (this is alteration of the target's message).
  + `conversationId`: The conversation ID grabbed in Step 1.
  + `parentMessageId`: Optional, to insert the message at a particular point in the convo (or at the very end).
  + `messageId`: Optional, can be used to edit a specific message or create a new one (i.e., a new GUID).
* Submit the modified Edit message request as per above.
* Observe that the target user's message has been changed.
* Look at the attacker's own chat history, the last chat should actually be a link to the target's conversation (ref. `conversationId`).
* When the attacker sends a message inside this chat, it will be reflected 1-for-1 in the target's chat, and vice-versa (also for LLM responses).
* This completes the hijacking of the conversation.

## Technical Details

### Source Code Fixes

Two key factors were identified that contributed to this vulnerability:

* Sensitive disclosure of identifiers in the API calls for shared chats (i.e., `conversationId`, `messageId`).
* Improper authorisation of message operations, specifically for LLM endpoints.

The maintainer contributed several fixes in the following PRs:

* [LibreChat PR #3600](https://github.com/danny-avila/LibreChat/pull/3600)
* [LibreChat PR #3588](https://github.com/danny-avila/LibreChat/pull/3588)
* [LibreChat PR #3543](https://github.com/danny-avila/LibreChat/pull/3543)
* [LibreChat PR #3363](https://github.com/danny-avila/LibreChat/pull/3363)

### Obtaining a Conversation ID

In order to obtain a `conversationId` you can abuse the 'Share' conversation functionality:

* Target shares one of their private conversations and makes the link available.
* Attacker navigates to the link and is able to extract the `conversationId` from the responses (from `/api/share/<SHARED_CONVO_ID>`), as well as the messageId for each message in that convo.
  + Note: The `<SHARED_CONVO_ID>` in the API URL is not the same as the `conversationId` which is the actual ID of the target's private conversation.

## Authors

[Deeno Burgan](https://au.linkedin.com/in/deenoburgan), [Will Robertson](https://au.linkedin.com/in/will-robertson-93a0273a), [David Craggs](https://au.linkedin.com/in/david-craggs-37851793), and [Neha Malik](https://au.linkedin.com/in/neha-malik-9b63ab12) (all of Application Security Team, REA Group).

The authors would also like to thank the LibreChat maintainer [Danny Avila](https://www.linkedin.com/in/danny-avila) for working with us to get this vulnerability resolved swiftly.

## References

* [Mitre - CVE-2024-41703](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2024-41703)
* [NVD - CVE-2024-41703](https://nvd.nist.gov/vuln/detail/CVE-2024-41703)
* [LibreChat Discussion](https://github.com/danny-avila/LibreChat/discussions/3315)
* [LibreChat PR #3600](https://github.com/danny-avila/LibreChat/pull/3600)
* [LibreChat PR #3588](https://github.com/danny-avila/LibreChat/pull/3588)
* [LibreChat PR #3543](https://github.com/danny-avila/LibreChat/pull/3543)
* [LibreChat PR #3363](https://github.com/danny-avila/LibreChat/pull/3363)
* [CWE-862: Missing Authorization](https://cwe.mitre.org/data/definitions/862.html)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

