=== Content from git.kernel.org_2775570f_20250111_042606.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8bf574183282d219cfa991f7df37aad491d74c11)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8bf574183282d219cfa991f7df37aad491d74c11)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8bf574183282d219cfa991f7df37aad491d74c11)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8bf574183282d219cfa991f7df37aad491d74c11)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sean Anderson <sean.anderson@linux.dev> | 2024-03-08 16:00:32 -0500 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-05-02 16:29:31 +0200 |
| commit | [8bf574183282d219cfa991f7df37aad491d74c11](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8bf574183282d219cfa991f7df37aad491d74c11) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8bf574183282d219cfa991f7df37aad491d74c11)) | |
| tree | [da9f172a1bf80b7ee729a81c06c568928da2243e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8bf574183282d219cfa991f7df37aad491d74c11) | |
| parent | [e71d5ec7c04362cdcffd51027b97f35cace4b616](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e71d5ec7c04362cdcffd51027b97f35cace4b616) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8bf574183282d219cfa991f7df37aad491d74c11&id2=e71d5ec7c04362cdcffd51027b97f35cace4b616)) | |
| download | [linux-8bf574183282d219cfa991f7df37aad491d74c11.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8bf574183282d219cfa991f7df37aad491d74c11.tar.gz) | |

dma: xilinx\_dpdma: Fix locking[ Upstream commit 244296cc3a155199a8b080d19e645d7d49081a38 ]
There are several places where either chan->lock or chan->vchan.lock was
not held. Add appropriate locking. This fixes lockdep warnings like
[ 31.077578] ------------[ cut here ]------------
[ 31.077831] WARNING: CPU: 2 PID: 40 at drivers/dma/xilinx/xilinx\_dpdma.c:834 xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.077953] Modules linked in:
[ 31.078019] CPU: 2 PID: 40 Comm: kworker/u12:1 Not tainted 6.6.20+ #98
[ 31.078102] Hardware name: xlnx,zynqmp (DT)
[ 31.078169] Workqueue: events\_unbound deferred\_probe\_work\_func
[ 31.078272] pstate: 600000c5 (nZCv daIF -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[ 31.078377] pc : xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.078473] lr : xilinx\_dpdma\_chan\_queue\_transfer+0x270/0x5e0
[ 31.078550] sp : ffffffc083bb2e10
[ 31.078590] x29: ffffffc083bb2e10 x28: 0000000000000000 x27: ffffff880165a168
[ 31.078754] x26: ffffff880164e920 x25: ffffff880164eab8 x24: ffffff880164d480
[ 31.078920] x23: ffffff880165a148 x22: ffffff880164e988 x21: 0000000000000000
[ 31.079132] x20: ffffffc082aa3000 x19: ffffff880164e880 x18: 0000000000000000
[ 31.079295] x17: 0000000000000000 x16: 0000000000000000 x15: 0000000000000000
[ 31.079453] x14: 0000000000000000 x13: ffffff8802263dc0 x12: 0000000000000001
[ 31.079613] x11: 0001ffc083bb2e34 x10: 0001ff880164e98f x9 : 0001ffc082aa3def
[ 31.079824] x8 : 0001ffc082aa3dec x7 : 0000000000000000 x6 : 0000000000000516
[ 31.079982] x5 : ffffffc7f8d43000 x4 : ffffff88003c9c40 x3 : ffffffffffffffff
[ 31.080147] x2 : ffffffc7f8d43000 x1 : 00000000000000c0 x0 : 0000000000000000
[ 31.080307] Call trace:
[ 31.080340] xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.080518] xilinx\_dpdma\_issue\_pending+0x11c/0x120
[ 31.080595] zynqmp\_disp\_layer\_update+0x180/0x3ac
[ 31.080712] zynqmp\_dpsub\_plane\_atomic\_update+0x11c/0x21c
[ 31.080825] drm\_atomic\_helper\_commit\_planes+0x20c/0x684
[ 31.080951] drm\_atomic\_helper\_commit\_tail+0x5c/0xb0
[ 31.081139] commit\_tail+0x234/0x294
[ 31.081246] drm\_atomic\_helper\_commit+0x1f8/0x210
[ 31.081363] drm\_atomic\_commit+0x100/0x140
[ 31.081477] drm\_client\_modeset\_commit\_atomic+0x318/0x384
[ 31.081634] drm\_client\_modeset\_commit\_locked+0x8c/0x24c
[ 31.081725] drm\_client\_modeset\_commit+0x34/0x5c
[ 31.081812] \_\_drm\_fb\_helper\_restore\_fbdev\_mode\_unlocked+0x104/0x168
[ 31.081899] drm\_fb\_helper\_set\_par+0x50/0x70
[ 31.081971] fbcon\_init+0x538/0xc48
[ 31.082047] visual\_init+0x16c/0x23c
[ 31.082207] do\_bind\_con\_driver.isra.0+0x2d0/0x634
[ 31.082320] do\_take\_over\_console+0x24c/0x33c
[ 31.082429] do\_fbcon\_takeover+0xbc/0x1b0
[ 31.082503] fbcon\_fb\_registered+0x2d0/0x34c
[ 31.082663] register\_framebuffer+0x27c/0x38c
[ 31.082767] \_\_drm\_fb\_helper\_initial\_config\_and\_unlock+0x5c0/0x91c
[ 31.082939] drm\_fb\_helper\_initial\_config+0x50/0x74
[ 31.083012] drm\_fbdev\_dma\_client\_hotplug+0xb8/0x108
[ 31.083115] drm\_client\_register+0xa0/0xf4
[ 31.083195] drm\_fbdev\_dma\_setup+0xb0/0x1cc
[ 31.083293] zynqmp\_dpsub\_drm\_init+0x45c/0x4e0
[ 31.083431] zynqmp\_dpsub\_probe+0x444/0x5e0
[ 31.083616] platform\_probe+0x8c/0x13c
[ 31.083713] really\_probe+0x258/0x59c
[ 31.083793] \_\_driver\_probe\_device+0xc4/0x224
[ 31.083878] driver\_probe\_device+0x70/0x1c0
[ 31.083961] \_\_device\_attach\_driver+0x108/0x1e0
[ 31.084052] bus\_for\_each\_drv+0x9c/0x100
[ 31.084125] \_\_device\_attach+0x100/0x298
[ 31.084207] device\_initial\_probe+0x14/0x20
[ 31.084292] bus\_probe\_device+0xd8/0xdc
[ 31.084368] deferred\_probe\_work\_func+0x11c/0x180
[ 31.084451] process\_one\_work+0x3ac/0x988
[ 31.084643] worker\_thread+0x398/0x694
[ 31.084752] kthread+0x1bc/0x1c0
[ 31.084848] ret\_from\_fork+0x10/0x20
[ 31.084932] irq event stamp: 64549
[ 31.084970] hardirqs last enabled at (64548): [<ffffffc081adf35c>] \_raw\_spin\_unlock\_irqrestore+0x80/0x90
[ 31.085157] hardirqs last disabled at (64549): [<ffffffc081adf010>] \_raw\_spin\_lock\_irqsave+0xc0/0xdc
[ 31.085277] softirqs last enabled at (64503): [<ffffffc08001071c>] \_\_do\_softirq+0x47c/0x500
[ 31.085390] softirqs last disabled at (64498): [<ffffffc080017134>] \_\_\_\_do\_softirq+0x10/0x1c
[ 31.085501] ---[ end trace 0000000000000000 ]---
Fixes: 7cbb0c63de3f ("dmaengine: xilinx: dpdma: Add the Xilinx DisplayPort DMA engine driver")
Signed-off-by: Sean Anderson <sean.anderson@linux.dev>
Reviewed-by: Tomi Valkeinen <tomi.valkeinen@ideasonboard.com>
Link: [https://lore.kernel.org/r/20240308210034.3634938-2-sean.anderson@linux.dev](https://lore.kernel.org/r/20240308210034.3634938-2-sean.anderson%40linux.dev)
Signed-off-by: Vinod Koul <vkoul@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8bf574183282d219cfa991f7df37aad491d74c11)

| -rw-r--r-- | [drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/dma/xilinx/xilinx_dpdma.c?id=8bf574183282d219cfa991f7df37aad491d74c11) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 10 insertions, 3 deletions

| diff --git a/drivers/dma/xilinx/xilinx\_dpdma.c b/drivers/dma/xilinx/xilinx\_dpdma.cindex 84dc5240a8074a..93938ed80fc837 100644--- a/[drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma/xilinx/xilinx_dpdma.c?id=e71d5ec7c04362cdcffd51027b97f35cace4b616)+++ b/[drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma/xilinx/xilinx_dpdma.c?id=8bf574183282d219cfa991f7df37aad491d74c11)@@ -214,7 +214,8 @@ struct xilinx\_dpdma\_tx\_desc { \* @running: true if the channel is running \* @first\_frame: flag for the first frame of stream \* @video\_group: flag if multi-channel operation is needed for video channels- \* @lock: lock to access struct xilinx\_dpdma\_chan+ \* @lock: lock to access struct xilinx\_dpdma\_chan. Must be taken before+ \* @vchan.lock, if both are to be held. \* @desc\_pool: descriptor allocation pool \* @err\_task: error IRQ bottom half handler \* @desc: References to descriptors being processed@@ -1097,12 +1098,14 @@ static void xilinx\_dpdma\_chan\_vsync\_irq(struct xilinx\_dpdma\_chan \*chan) \* Complete the active descriptor, if any, promote the pending \* descriptor to active, and queue the next transfer, if any. \*/+ spin\_lock(&chan->vchan.lock); if (chan->desc.active) vchan\_cookie\_complete(&chan->desc.active->vdesc); chan->desc.active = pending; chan->desc.pending = NULL;  xilinx\_dpdma\_chan\_queue\_transfer(chan);+ spin\_unlock(&chan->vchan.lock);  out: spin\_unlock\_irqrestore(&chan->lock, flags);@@ -1264,10 +1267,12 @@ static void xilinx\_dpdma\_issue\_pending(struct dma\_chan \*dchan) struct xilinx\_dpdma\_chan \*chan = to\_xilinx\_chan(dchan); unsigned long flags; - spin\_lock\_irqsave(&chan->vchan.lock, flags);+ spin\_lock\_irqsave(&chan->lock, flags);+ spin\_lock(&chan->vchan.lock); if (vchan\_issue\_pending(&chan->vchan)) xilinx\_dpdma\_chan\_queue\_transfer(chan);- spin\_unlock\_irqrestore(&chan->vchan.lock, flags);+ spin\_unlock(&chan->vchan.lock);+ spin\_unlock\_irqrestore(&chan->lock, flags); }  static int xilinx\_dpdma\_config(struct dma\_chan \*dchan,@@ -1495,7 +1500,9 @@ static void xilinx\_dpdma\_chan\_err\_task(struct tasklet\_struct \*t) XILINX\_DPDMA\_EINTR\_CHAN\_ERR\_MASK << chan->id);  spin\_lock\_irqsave(&chan->lock, flags);+ spin\_lock(&chan->vchan.lock); xilinx\_dpdma\_chan\_queue\_transfer(chan);+ spin\_unlock(&chan->vchan.lock); spin\_unlock\_irqrestore(&chan->lock, flags); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:24:43 +0000



=== Content from git.kernel.org_88321da8_20250111_042607.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c660be571609e03e7d5972343536a736fcb31557)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c660be571609e03e7d5972343536a736fcb31557)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c660be571609e03e7d5972343536a736fcb31557)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c660be571609e03e7d5972343536a736fcb31557)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sean Anderson <sean.anderson@linux.dev> | 2024-03-08 16:00:32 -0500 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-05-02 16:35:33 +0200 |
| commit | [c660be571609e03e7d5972343536a736fcb31557](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c660be571609e03e7d5972343536a736fcb31557) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c660be571609e03e7d5972343536a736fcb31557)) | |
| tree | [732d54ae6459d3cb9772b0b82a5d01fd5a55fc29](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c660be571609e03e7d5972343536a736fcb31557) | |
| parent | [c9b732a9f73eadc638abdcf0a6d39bc7a0c1af5f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c9b732a9f73eadc638abdcf0a6d39bc7a0c1af5f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c660be571609e03e7d5972343536a736fcb31557&id2=c9b732a9f73eadc638abdcf0a6d39bc7a0c1af5f)) | |
| download | [linux-c660be571609e03e7d5972343536a736fcb31557.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c660be571609e03e7d5972343536a736fcb31557.tar.gz) | |

dma: xilinx\_dpdma: Fix locking[ Upstream commit 244296cc3a155199a8b080d19e645d7d49081a38 ]
There are several places where either chan->lock or chan->vchan.lock was
not held. Add appropriate locking. This fixes lockdep warnings like
[ 31.077578] ------------[ cut here ]------------
[ 31.077831] WARNING: CPU: 2 PID: 40 at drivers/dma/xilinx/xilinx\_dpdma.c:834 xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.077953] Modules linked in:
[ 31.078019] CPU: 2 PID: 40 Comm: kworker/u12:1 Not tainted 6.6.20+ #98
[ 31.078102] Hardware name: xlnx,zynqmp (DT)
[ 31.078169] Workqueue: events\_unbound deferred\_probe\_work\_func
[ 31.078272] pstate: 600000c5 (nZCv daIF -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[ 31.078377] pc : xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.078473] lr : xilinx\_dpdma\_chan\_queue\_transfer+0x270/0x5e0
[ 31.078550] sp : ffffffc083bb2e10
[ 31.078590] x29: ffffffc083bb2e10 x28: 0000000000000000 x27: ffffff880165a168
[ 31.078754] x26: ffffff880164e920 x25: ffffff880164eab8 x24: ffffff880164d480
[ 31.078920] x23: ffffff880165a148 x22: ffffff880164e988 x21: 0000000000000000
[ 31.079132] x20: ffffffc082aa3000 x19: ffffff880164e880 x18: 0000000000000000
[ 31.079295] x17: 0000000000000000 x16: 0000000000000000 x15: 0000000000000000
[ 31.079453] x14: 0000000000000000 x13: ffffff8802263dc0 x12: 0000000000000001
[ 31.079613] x11: 0001ffc083bb2e34 x10: 0001ff880164e98f x9 : 0001ffc082aa3def
[ 31.079824] x8 : 0001ffc082aa3dec x7 : 0000000000000000 x6 : 0000000000000516
[ 31.079982] x5 : ffffffc7f8d43000 x4 : ffffff88003c9c40 x3 : ffffffffffffffff
[ 31.080147] x2 : ffffffc7f8d43000 x1 : 00000000000000c0 x0 : 0000000000000000
[ 31.080307] Call trace:
[ 31.080340] xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.080518] xilinx\_dpdma\_issue\_pending+0x11c/0x120
[ 31.080595] zynqmp\_disp\_layer\_update+0x180/0x3ac
[ 31.080712] zynqmp\_dpsub\_plane\_atomic\_update+0x11c/0x21c
[ 31.080825] drm\_atomic\_helper\_commit\_planes+0x20c/0x684
[ 31.080951] drm\_atomic\_helper\_commit\_tail+0x5c/0xb0
[ 31.081139] commit\_tail+0x234/0x294
[ 31.081246] drm\_atomic\_helper\_commit+0x1f8/0x210
[ 31.081363] drm\_atomic\_commit+0x100/0x140
[ 31.081477] drm\_client\_modeset\_commit\_atomic+0x318/0x384
[ 31.081634] drm\_client\_modeset\_commit\_locked+0x8c/0x24c
[ 31.081725] drm\_client\_modeset\_commit+0x34/0x5c
[ 31.081812] \_\_drm\_fb\_helper\_restore\_fbdev\_mode\_unlocked+0x104/0x168
[ 31.081899] drm\_fb\_helper\_set\_par+0x50/0x70
[ 31.081971] fbcon\_init+0x538/0xc48
[ 31.082047] visual\_init+0x16c/0x23c
[ 31.082207] do\_bind\_con\_driver.isra.0+0x2d0/0x634
[ 31.082320] do\_take\_over\_console+0x24c/0x33c
[ 31.082429] do\_fbcon\_takeover+0xbc/0x1b0
[ 31.082503] fbcon\_fb\_registered+0x2d0/0x34c
[ 31.082663] register\_framebuffer+0x27c/0x38c
[ 31.082767] \_\_drm\_fb\_helper\_initial\_config\_and\_unlock+0x5c0/0x91c
[ 31.082939] drm\_fb\_helper\_initial\_config+0x50/0x74
[ 31.083012] drm\_fbdev\_dma\_client\_hotplug+0xb8/0x108
[ 31.083115] drm\_client\_register+0xa0/0xf4
[ 31.083195] drm\_fbdev\_dma\_setup+0xb0/0x1cc
[ 31.083293] zynqmp\_dpsub\_drm\_init+0x45c/0x4e0
[ 31.083431] zynqmp\_dpsub\_probe+0x444/0x5e0
[ 31.083616] platform\_probe+0x8c/0x13c
[ 31.083713] really\_probe+0x258/0x59c
[ 31.083793] \_\_driver\_probe\_device+0xc4/0x224
[ 31.083878] driver\_probe\_device+0x70/0x1c0
[ 31.083961] \_\_device\_attach\_driver+0x108/0x1e0
[ 31.084052] bus\_for\_each\_drv+0x9c/0x100
[ 31.084125] \_\_device\_attach+0x100/0x298
[ 31.084207] device\_initial\_probe+0x14/0x20
[ 31.084292] bus\_probe\_device+0xd8/0xdc
[ 31.084368] deferred\_probe\_work\_func+0x11c/0x180
[ 31.084451] process\_one\_work+0x3ac/0x988
[ 31.084643] worker\_thread+0x398/0x694
[ 31.084752] kthread+0x1bc/0x1c0
[ 31.084848] ret\_from\_fork+0x10/0x20
[ 31.084932] irq event stamp: 64549
[ 31.084970] hardirqs last enabled at (64548): [<ffffffc081adf35c>] \_raw\_spin\_unlock\_irqrestore+0x80/0x90
[ 31.085157] hardirqs last disabled at (64549): [<ffffffc081adf010>] \_raw\_spin\_lock\_irqsave+0xc0/0xdc
[ 31.085277] softirqs last enabled at (64503): [<ffffffc08001071c>] \_\_do\_softirq+0x47c/0x500
[ 31.085390] softirqs last disabled at (64498): [<ffffffc080017134>] \_\_\_\_do\_softirq+0x10/0x1c
[ 31.085501] ---[ end trace 0000000000000000 ]---
Fixes: 7cbb0c63de3f ("dmaengine: xilinx: dpdma: Add the Xilinx DisplayPort DMA engine driver")
Signed-off-by: Sean Anderson <sean.anderson@linux.dev>
Reviewed-by: Tomi Valkeinen <tomi.valkeinen@ideasonboard.com>
Link: [https://lore.kernel.org/r/20240308210034.3634938-2-sean.anderson@linux.dev](https://lore.kernel.org/r/20240308210034.3634938-2-sean.anderson%40linux.dev)
Signed-off-by: Vinod Koul <vkoul@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c660be571609e03e7d5972343536a736fcb31557)

| -rw-r--r-- | [drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/dma/xilinx/xilinx_dpdma.c?id=c660be571609e03e7d5972343536a736fcb31557) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 10 insertions, 3 deletions

| diff --git a/drivers/dma/xilinx/xilinx\_dpdma.c b/drivers/dma/xilinx/xilinx\_dpdma.cindex b82815e64d24e8..eb0637d90342a6 100644--- a/[drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma/xilinx/xilinx_dpdma.c?id=c9b732a9f73eadc638abdcf0a6d39bc7a0c1af5f)+++ b/[drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma/xilinx/xilinx_dpdma.c?id=c660be571609e03e7d5972343536a736fcb31557)@@ -214,7 +214,8 @@ struct xilinx\_dpdma\_tx\_desc { \* @running: true if the channel is running \* @first\_frame: flag for the first frame of stream \* @video\_group: flag if multi-channel operation is needed for video channels- \* @lock: lock to access struct xilinx\_dpdma\_chan+ \* @lock: lock to access struct xilinx\_dpdma\_chan. Must be taken before+ \* @vchan.lock, if both are to be held. \* @desc\_pool: descriptor allocation pool \* @err\_task: error IRQ bottom half handler \* @desc: References to descriptors being processed@@ -1097,12 +1098,14 @@ static void xilinx\_dpdma\_chan\_vsync\_irq(struct xilinx\_dpdma\_chan \*chan) \* Complete the active descriptor, if any, promote the pending \* descriptor to active, and queue the next transfer, if any. \*/+ spin\_lock(&chan->vchan.lock); if (chan->desc.active) vchan\_cookie\_complete(&chan->desc.active->vdesc); chan->desc.active = pending; chan->desc.pending = NULL;  xilinx\_dpdma\_chan\_queue\_transfer(chan);+ spin\_unlock(&chan->vchan.lock);  out: spin\_unlock\_irqrestore(&chan->lock, flags);@@ -1264,10 +1267,12 @@ static void xilinx\_dpdma\_issue\_pending(struct dma\_chan \*dchan) struct xilinx\_dpdma\_chan \*chan = to\_xilinx\_chan(dchan); unsigned long flags; - spin\_lock\_irqsave(&chan->vchan.lock, flags);+ spin\_lock\_irqsave(&chan->lock, flags);+ spin\_lock(&chan->vchan.lock); if (vchan\_issue\_pending(&chan->vchan)) xilinx\_dpdma\_chan\_queue\_transfer(chan);- spin\_unlock\_irqrestore(&chan->vchan.lock, flags);+ spin\_unlock(&chan->vchan.lock);+ spin\_unlock\_irqrestore(&chan->lock, flags); }  static int xilinx\_dpdma\_config(struct dma\_chan \*dchan,@@ -1495,7 +1500,9 @@ static void xilinx\_dpdma\_chan\_err\_task(struct tasklet\_struct \*t) XILINX\_DPDMA\_EINTR\_CHAN\_ERR\_MASK << chan->id);  spin\_lock\_irqsave(&chan->lock, flags);+ spin\_lock(&chan->vchan.lock); xilinx\_dpdma\_chan\_queue\_transfer(chan);+ spin\_unlock(&chan->vchan.lock); spin\_unlock\_irqrestore(&chan->lock, flags); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:24:45 +0000



=== Content from git.kernel.org_5c9ab42b_20250111_042605.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=244296cc3a155199a8b080d19e645d7d49081a38)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=244296cc3a155199a8b080d19e645d7d49081a38)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=244296cc3a155199a8b080d19e645d7d49081a38)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=244296cc3a155199a8b080d19e645d7d49081a38)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sean Anderson <sean.anderson@linux.dev> | 2024-03-08 16:00:32 -0500 |
| --- | --- | --- |
| committer | Vinod Koul <vkoul@kernel.org> | 2024-04-07 17:08:05 +0530 |
| commit | [244296cc3a155199a8b080d19e645d7d49081a38](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=244296cc3a155199a8b080d19e645d7d49081a38) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=244296cc3a155199a8b080d19e645d7d49081a38)) | |
| tree | [6aac8e955a1e9d3b291f7953dd209fef405fc5b7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=244296cc3a155199a8b080d19e645d7d49081a38) | |
| parent | [d5638de827cff0fce77007e426ec0ffdedf68a44](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d5638de827cff0fce77007e426ec0ffdedf68a44) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=244296cc3a155199a8b080d19e645d7d49081a38&id2=d5638de827cff0fce77007e426ec0ffdedf68a44)) | |
| download | [linux-244296cc3a155199a8b080d19e645d7d49081a38.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-244296cc3a155199a8b080d19e645d7d49081a38.tar.gz) | |

dma: xilinx\_dpdma: Fix lockingThere are several places where either chan->lock or chan->vchan.lock was
not held. Add appropriate locking. This fixes lockdep warnings like
[ 31.077578] ------------[ cut here ]------------
[ 31.077831] WARNING: CPU: 2 PID: 40 at drivers/dma/xilinx/xilinx\_dpdma.c:834 xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.077953] Modules linked in:
[ 31.078019] CPU: 2 PID: 40 Comm: kworker/u12:1 Not tainted 6.6.20+ #98
[ 31.078102] Hardware name: xlnx,zynqmp (DT)
[ 31.078169] Workqueue: events\_unbound deferred\_probe\_work\_func
[ 31.078272] pstate: 600000c5 (nZCv daIF -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[ 31.078377] pc : xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.078473] lr : xilinx\_dpdma\_chan\_queue\_transfer+0x270/0x5e0
[ 31.078550] sp : ffffffc083bb2e10
[ 31.078590] x29: ffffffc083bb2e10 x28: 0000000000000000 x27: ffffff880165a168
[ 31.078754] x26: ffffff880164e920 x25: ffffff880164eab8 x24: ffffff880164d480
[ 31.078920] x23: ffffff880165a148 x22: ffffff880164e988 x21: 0000000000000000
[ 31.079132] x20: ffffffc082aa3000 x19: ffffff880164e880 x18: 0000000000000000
[ 31.079295] x17: 0000000000000000 x16: 0000000000000000 x15: 0000000000000000
[ 31.079453] x14: 0000000000000000 x13: ffffff8802263dc0 x12: 0000000000000001
[ 31.079613] x11: 0001ffc083bb2e34 x10: 0001ff880164e98f x9 : 0001ffc082aa3def
[ 31.079824] x8 : 0001ffc082aa3dec x7 : 0000000000000000 x6 : 0000000000000516
[ 31.079982] x5 : ffffffc7f8d43000 x4 : ffffff88003c9c40 x3 : ffffffffffffffff
[ 31.080147] x2 : ffffffc7f8d43000 x1 : 00000000000000c0 x0 : 0000000000000000
[ 31.080307] Call trace:
[ 31.080340] xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.080518] xilinx\_dpdma\_issue\_pending+0x11c/0x120
[ 31.080595] zynqmp\_disp\_layer\_update+0x180/0x3ac
[ 31.080712] zynqmp\_dpsub\_plane\_atomic\_update+0x11c/0x21c
[ 31.080825] drm\_atomic\_helper\_commit\_planes+0x20c/0x684
[ 31.080951] drm\_atomic\_helper\_commit\_tail+0x5c/0xb0
[ 31.081139] commit\_tail+0x234/0x294
[ 31.081246] drm\_atomic\_helper\_commit+0x1f8/0x210
[ 31.081363] drm\_atomic\_commit+0x100/0x140
[ 31.081477] drm\_client\_modeset\_commit\_atomic+0x318/0x384
[ 31.081634] drm\_client\_modeset\_commit\_locked+0x8c/0x24c
[ 31.081725] drm\_client\_modeset\_commit+0x34/0x5c
[ 31.081812] \_\_drm\_fb\_helper\_restore\_fbdev\_mode\_unlocked+0x104/0x168
[ 31.081899] drm\_fb\_helper\_set\_par+0x50/0x70
[ 31.081971] fbcon\_init+0x538/0xc48
[ 31.082047] visual\_init+0x16c/0x23c
[ 31.082207] do\_bind\_con\_driver.isra.0+0x2d0/0x634
[ 31.082320] do\_take\_over\_console+0x24c/0x33c
[ 31.082429] do\_fbcon\_takeover+0xbc/0x1b0
[ 31.082503] fbcon\_fb\_registered+0x2d0/0x34c
[ 31.082663] register\_framebuffer+0x27c/0x38c
[ 31.082767] \_\_drm\_fb\_helper\_initial\_config\_and\_unlock+0x5c0/0x91c
[ 31.082939] drm\_fb\_helper\_initial\_config+0x50/0x74
[ 31.083012] drm\_fbdev\_dma\_client\_hotplug+0xb8/0x108
[ 31.083115] drm\_client\_register+0xa0/0xf4
[ 31.083195] drm\_fbdev\_dma\_setup+0xb0/0x1cc
[ 31.083293] zynqmp\_dpsub\_drm\_init+0x45c/0x4e0
[ 31.083431] zynqmp\_dpsub\_probe+0x444/0x5e0
[ 31.083616] platform\_probe+0x8c/0x13c
[ 31.083713] really\_probe+0x258/0x59c
[ 31.083793] \_\_driver\_probe\_device+0xc4/0x224
[ 31.083878] driver\_probe\_device+0x70/0x1c0
[ 31.083961] \_\_device\_attach\_driver+0x108/0x1e0
[ 31.084052] bus\_for\_each\_drv+0x9c/0x100
[ 31.084125] \_\_device\_attach+0x100/0x298
[ 31.084207] device\_initial\_probe+0x14/0x20
[ 31.084292] bus\_probe\_device+0xd8/0xdc
[ 31.084368] deferred\_probe\_work\_func+0x11c/0x180
[ 31.084451] process\_one\_work+0x3ac/0x988
[ 31.084643] worker\_thread+0x398/0x694
[ 31.084752] kthread+0x1bc/0x1c0
[ 31.084848] ret\_from\_fork+0x10/0x20
[ 31.084932] irq event stamp: 64549
[ 31.084970] hardirqs last enabled at (64548): [<ffffffc081adf35c>] \_raw\_spin\_unlock\_irqrestore+0x80/0x90
[ 31.085157] hardirqs last disabled at (64549): [<ffffffc081adf010>] \_raw\_spin\_lock\_irqsave+0xc0/0xdc
[ 31.085277] softirqs last enabled at (64503): [<ffffffc08001071c>] \_\_do\_softirq+0x47c/0x500
[ 31.085390] softirqs last disabled at (64498): [<ffffffc080017134>] \_\_\_\_do\_softirq+0x10/0x1c
[ 31.085501] ---[ end trace 0000000000000000 ]---
Fixes: 7cbb0c63de3f ("dmaengine: xilinx: dpdma: Add the Xilinx DisplayPort DMA engine driver")
Signed-off-by: Sean Anderson <sean.anderson@linux.dev>
Reviewed-by: Tomi Valkeinen <tomi.valkeinen@ideasonboard.com>
Link: [https://lore.kernel.org/r/20240308210034.3634938-2-sean.anderson@linux.dev](https://lore.kernel.org/r/20240308210034.3634938-2-sean.anderson%40linux.dev)
Signed-off-by: Vinod Koul <vkoul@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=244296cc3a155199a8b080d19e645d7d49081a38)

| -rw-r--r-- | [drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/dma/xilinx/xilinx_dpdma.c?id=244296cc3a155199a8b080d19e645d7d49081a38) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 10 insertions, 3 deletions

| diff --git a/drivers/dma/xilinx/xilinx\_dpdma.c b/drivers/dma/xilinx/xilinx\_dpdma.cindex b82815e64d24e8..eb0637d90342a6 100644--- a/[drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma/xilinx/xilinx_dpdma.c?id=d5638de827cff0fce77007e426ec0ffdedf68a44)+++ b/[drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma/xilinx/xilinx_dpdma.c?id=244296cc3a155199a8b080d19e645d7d49081a38)@@ -214,7 +214,8 @@ struct xilinx\_dpdma\_tx\_desc { \* @running: true if the channel is running \* @first\_frame: flag for the first frame of stream \* @video\_group: flag if multi-channel operation is needed for video channels- \* @lock: lock to access struct xilinx\_dpdma\_chan+ \* @lock: lock to access struct xilinx\_dpdma\_chan. Must be taken before+ \* @vchan.lock, if both are to be held. \* @desc\_pool: descriptor allocation pool \* @err\_task: error IRQ bottom half handler \* @desc: References to descriptors being processed@@ -1097,12 +1098,14 @@ static void xilinx\_dpdma\_chan\_vsync\_irq(struct xilinx\_dpdma\_chan \*chan) \* Complete the active descriptor, if any, promote the pending \* descriptor to active, and queue the next transfer, if any. \*/+ spin\_lock(&chan->vchan.lock); if (chan->desc.active) vchan\_cookie\_complete(&chan->desc.active->vdesc); chan->desc.active = pending; chan->desc.pending = NULL;  xilinx\_dpdma\_chan\_queue\_transfer(chan);+ spin\_unlock(&chan->vchan.lock);  out: spin\_unlock\_irqrestore(&chan->lock, flags);@@ -1264,10 +1267,12 @@ static void xilinx\_dpdma\_issue\_pending(struct dma\_chan \*dchan) struct xilinx\_dpdma\_chan \*chan = to\_xilinx\_chan(dchan); unsigned long flags; - spin\_lock\_irqsave(&chan->vchan.lock, flags);+ spin\_lock\_irqsave(&chan->lock, flags);+ spin\_lock(&chan->vchan.lock); if (vchan\_issue\_pending(&chan->vchan)) xilinx\_dpdma\_chan\_queue\_transfer(chan);- spin\_unlock\_irqrestore(&chan->vchan.lock, flags);+ spin\_unlock(&chan->vchan.lock);+ spin\_unlock\_irqrestore(&chan->lock, flags); }  static int xilinx\_dpdma\_config(struct dma\_chan \*dchan,@@ -1495,7 +1500,9 @@ static void xilinx\_dpdma\_chan\_err\_task(struct tasklet\_struct \*t) XILINX\_DPDMA\_EINTR\_CHAN\_ERR\_MASK << chan->id);  spin\_lock\_irqsave(&chan->lock, flags);+ spin\_lock(&chan->vchan.lock); xilinx\_dpdma\_chan\_queue\_transfer(chan);+ spin\_unlock(&chan->vchan.lock); spin\_unlock\_irqrestore(&chan->lock, flags); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:24:43 +0000



=== Content from git.kernel.org_a97582b2_20250111_042605.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=0ccac964520a6f19e355652c8ca38af2a7f27076)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0ccac964520a6f19e355652c8ca38af2a7f27076)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0ccac964520a6f19e355652c8ca38af2a7f27076)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0ccac964520a6f19e355652c8ca38af2a7f27076)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sean Anderson <sean.anderson@linux.dev> | 2024-03-08 16:00:32 -0500 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-05-02 16:24:49 +0200 |
| commit | [0ccac964520a6f19e355652c8ca38af2a7f27076](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0ccac964520a6f19e355652c8ca38af2a7f27076) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=0ccac964520a6f19e355652c8ca38af2a7f27076)) | |
| tree | [3aba49fdcfcad628270c80818bac106cc4125095](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0ccac964520a6f19e355652c8ca38af2a7f27076) | |
| parent | [dd946e8e57c0f30ea6d7c21fdcac2400a3aa9383](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dd946e8e57c0f30ea6d7c21fdcac2400a3aa9383) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0ccac964520a6f19e355652c8ca38af2a7f27076&id2=dd946e8e57c0f30ea6d7c21fdcac2400a3aa9383)) | |
| download | [linux-0ccac964520a6f19e355652c8ca38af2a7f27076.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-0ccac964520a6f19e355652c8ca38af2a7f27076.tar.gz) | |

dma: xilinx\_dpdma: Fix locking[ Upstream commit 244296cc3a155199a8b080d19e645d7d49081a38 ]
There are several places where either chan->lock or chan->vchan.lock was
not held. Add appropriate locking. This fixes lockdep warnings like
[ 31.077578] ------------[ cut here ]------------
[ 31.077831] WARNING: CPU: 2 PID: 40 at drivers/dma/xilinx/xilinx\_dpdma.c:834 xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.077953] Modules linked in:
[ 31.078019] CPU: 2 PID: 40 Comm: kworker/u12:1 Not tainted 6.6.20+ #98
[ 31.078102] Hardware name: xlnx,zynqmp (DT)
[ 31.078169] Workqueue: events\_unbound deferred\_probe\_work\_func
[ 31.078272] pstate: 600000c5 (nZCv daIF -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[ 31.078377] pc : xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.078473] lr : xilinx\_dpdma\_chan\_queue\_transfer+0x270/0x5e0
[ 31.078550] sp : ffffffc083bb2e10
[ 31.078590] x29: ffffffc083bb2e10 x28: 0000000000000000 x27: ffffff880165a168
[ 31.078754] x26: ffffff880164e920 x25: ffffff880164eab8 x24: ffffff880164d480
[ 31.078920] x23: ffffff880165a148 x22: ffffff880164e988 x21: 0000000000000000
[ 31.079132] x20: ffffffc082aa3000 x19: ffffff880164e880 x18: 0000000000000000
[ 31.079295] x17: 0000000000000000 x16: 0000000000000000 x15: 0000000000000000
[ 31.079453] x14: 0000000000000000 x13: ffffff8802263dc0 x12: 0000000000000001
[ 31.079613] x11: 0001ffc083bb2e34 x10: 0001ff880164e98f x9 : 0001ffc082aa3def
[ 31.079824] x8 : 0001ffc082aa3dec x7 : 0000000000000000 x6 : 0000000000000516
[ 31.079982] x5 : ffffffc7f8d43000 x4 : ffffff88003c9c40 x3 : ffffffffffffffff
[ 31.080147] x2 : ffffffc7f8d43000 x1 : 00000000000000c0 x0 : 0000000000000000
[ 31.080307] Call trace:
[ 31.080340] xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.080518] xilinx\_dpdma\_issue\_pending+0x11c/0x120
[ 31.080595] zynqmp\_disp\_layer\_update+0x180/0x3ac
[ 31.080712] zynqmp\_dpsub\_plane\_atomic\_update+0x11c/0x21c
[ 31.080825] drm\_atomic\_helper\_commit\_planes+0x20c/0x684
[ 31.080951] drm\_atomic\_helper\_commit\_tail+0x5c/0xb0
[ 31.081139] commit\_tail+0x234/0x294
[ 31.081246] drm\_atomic\_helper\_commit+0x1f8/0x210
[ 31.081363] drm\_atomic\_commit+0x100/0x140
[ 31.081477] drm\_client\_modeset\_commit\_atomic+0x318/0x384
[ 31.081634] drm\_client\_modeset\_commit\_locked+0x8c/0x24c
[ 31.081725] drm\_client\_modeset\_commit+0x34/0x5c
[ 31.081812] \_\_drm\_fb\_helper\_restore\_fbdev\_mode\_unlocked+0x104/0x168
[ 31.081899] drm\_fb\_helper\_set\_par+0x50/0x70
[ 31.081971] fbcon\_init+0x538/0xc48
[ 31.082047] visual\_init+0x16c/0x23c
[ 31.082207] do\_bind\_con\_driver.isra.0+0x2d0/0x634
[ 31.082320] do\_take\_over\_console+0x24c/0x33c
[ 31.082429] do\_fbcon\_takeover+0xbc/0x1b0
[ 31.082503] fbcon\_fb\_registered+0x2d0/0x34c
[ 31.082663] register\_framebuffer+0x27c/0x38c
[ 31.082767] \_\_drm\_fb\_helper\_initial\_config\_and\_unlock+0x5c0/0x91c
[ 31.082939] drm\_fb\_helper\_initial\_config+0x50/0x74
[ 31.083012] drm\_fbdev\_dma\_client\_hotplug+0xb8/0x108
[ 31.083115] drm\_client\_register+0xa0/0xf4
[ 31.083195] drm\_fbdev\_dma\_setup+0xb0/0x1cc
[ 31.083293] zynqmp\_dpsub\_drm\_init+0x45c/0x4e0
[ 31.083431] zynqmp\_dpsub\_probe+0x444/0x5e0
[ 31.083616] platform\_probe+0x8c/0x13c
[ 31.083713] really\_probe+0x258/0x59c
[ 31.083793] \_\_driver\_probe\_device+0xc4/0x224
[ 31.083878] driver\_probe\_device+0x70/0x1c0
[ 31.083961] \_\_device\_attach\_driver+0x108/0x1e0
[ 31.084052] bus\_for\_each\_drv+0x9c/0x100
[ 31.084125] \_\_device\_attach+0x100/0x298
[ 31.084207] device\_initial\_probe+0x14/0x20
[ 31.084292] bus\_probe\_device+0xd8/0xdc
[ 31.084368] deferred\_probe\_work\_func+0x11c/0x180
[ 31.084451] process\_one\_work+0x3ac/0x988
[ 31.084643] worker\_thread+0x398/0x694
[ 31.084752] kthread+0x1bc/0x1c0
[ 31.084848] ret\_from\_fork+0x10/0x20
[ 31.084932] irq event stamp: 64549
[ 31.084970] hardirqs last enabled at (64548): [<ffffffc081adf35c>] \_raw\_spin\_unlock\_irqrestore+0x80/0x90
[ 31.085157] hardirqs last disabled at (64549): [<ffffffc081adf010>] \_raw\_spin\_lock\_irqsave+0xc0/0xdc
[ 31.085277] softirqs last enabled at (64503): [<ffffffc08001071c>] \_\_do\_softirq+0x47c/0x500
[ 31.085390] softirqs last disabled at (64498): [<ffffffc080017134>] \_\_\_\_do\_softirq+0x10/0x1c
[ 31.085501] ---[ end trace 0000000000000000 ]---
Fixes: 7cbb0c63de3f ("dmaengine: xilinx: dpdma: Add the Xilinx DisplayPort DMA engine driver")
Signed-off-by: Sean Anderson <sean.anderson@linux.dev>
Reviewed-by: Tomi Valkeinen <tomi.valkeinen@ideasonboard.com>
Link: [https://lore.kernel.org/r/20240308210034.3634938-2-sean.anderson@linux.dev](https://lore.kernel.org/r/20240308210034.3634938-2-sean.anderson%40linux.dev)
Signed-off-by: Vinod Koul <vkoul@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0ccac964520a6f19e355652c8ca38af2a7f27076)

| -rw-r--r-- | [drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/dma/xilinx/xilinx_dpdma.c?id=0ccac964520a6f19e355652c8ca38af2a7f27076) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 10 insertions, 3 deletions

| diff --git a/drivers/dma/xilinx/xilinx\_dpdma.c b/drivers/dma/xilinx/xilinx\_dpdma.cindex ce5c66e6897d2e..6eb68d986a7243 100644--- a/[drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma/xilinx/xilinx_dpdma.c?id=dd946e8e57c0f30ea6d7c21fdcac2400a3aa9383)+++ b/[drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma/xilinx/xilinx_dpdma.c?id=0ccac964520a6f19e355652c8ca38af2a7f27076)@@ -213,7 +213,8 @@ struct xilinx\_dpdma\_tx\_desc { \* @running: true if the channel is running \* @first\_frame: flag for the first frame of stream \* @video\_group: flag if multi-channel operation is needed for video channels- \* @lock: lock to access struct xilinx\_dpdma\_chan+ \* @lock: lock to access struct xilinx\_dpdma\_chan. Must be taken before+ \* @vchan.lock, if both are to be held. \* @desc\_pool: descriptor allocation pool \* @err\_task: error IRQ bottom half handler \* @desc: References to descriptors being processed@@ -1096,12 +1097,14 @@ static void xilinx\_dpdma\_chan\_vsync\_irq(struct xilinx\_dpdma\_chan \*chan) \* Complete the active descriptor, if any, promote the pending \* descriptor to active, and queue the next transfer, if any. \*/+ spin\_lock(&chan->vchan.lock); if (chan->desc.active) vchan\_cookie\_complete(&chan->desc.active->vdesc); chan->desc.active = pending; chan->desc.pending = NULL;  xilinx\_dpdma\_chan\_queue\_transfer(chan);+ spin\_unlock(&chan->vchan.lock);  out: spin\_unlock\_irqrestore(&chan->lock, flags);@@ -1263,10 +1266,12 @@ static void xilinx\_dpdma\_issue\_pending(struct dma\_chan \*dchan) struct xilinx\_dpdma\_chan \*chan = to\_xilinx\_chan(dchan); unsigned long flags; - spin\_lock\_irqsave(&chan->vchan.lock, flags);+ spin\_lock\_irqsave(&chan->lock, flags);+ spin\_lock(&chan->vchan.lock); if (vchan\_issue\_pending(&chan->vchan)) xilinx\_dpdma\_chan\_queue\_transfer(chan);- spin\_unlock\_irqrestore(&chan->vchan.lock, flags);+ spin\_unlock(&chan->vchan.lock);+ spin\_unlock\_irqrestore(&chan->lock, flags); }  static int xilinx\_dpdma\_config(struct dma\_chan \*dchan,@@ -1490,7 +1495,9 @@ static void xilinx\_dpdma\_chan\_err\_task(struct tasklet\_struct \*t) XILINX\_DPDMA\_EINTR\_CHAN\_ERR\_MASK << chan->id);  spin\_lock\_irqsave(&chan->lock, flags);+ spin\_lock(&chan->vchan.lock); xilinx\_dpdma\_chan\_queue\_transfer(chan);+ spin\_unlock(&chan->vchan.lock); spin\_unlock\_irqrestore(&chan->lock, flags); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:24:42 +0000



=== Content from git.kernel.org_67548693_20250111_042608.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=fcdd5bb4a8c81c64c1334d7e0aba41a8829a24de)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fcdd5bb4a8c81c64c1334d7e0aba41a8829a24de)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fcdd5bb4a8c81c64c1334d7e0aba41a8829a24de)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fcdd5bb4a8c81c64c1334d7e0aba41a8829a24de)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sean Anderson <sean.anderson@linux.dev> | 2024-03-08 16:00:32 -0500 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-05-02 16:23:45 +0200 |
| commit | [fcdd5bb4a8c81c64c1334d7e0aba41a8829a24de](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fcdd5bb4a8c81c64c1334d7e0aba41a8829a24de) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=fcdd5bb4a8c81c64c1334d7e0aba41a8829a24de)) | |
| tree | [31849f207a3a06b5e10e96175450f9ba417a55a4](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fcdd5bb4a8c81c64c1334d7e0aba41a8829a24de) | |
| parent | [5129f84bc377d525e13cfd208c347d228784b59a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5129f84bc377d525e13cfd208c347d228784b59a) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fcdd5bb4a8c81c64c1334d7e0aba41a8829a24de&id2=5129f84bc377d525e13cfd208c347d228784b59a)) | |
| download | [linux-fcdd5bb4a8c81c64c1334d7e0aba41a8829a24de.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-fcdd5bb4a8c81c64c1334d7e0aba41a8829a24de.tar.gz) | |

dma: xilinx\_dpdma: Fix locking[ Upstream commit 244296cc3a155199a8b080d19e645d7d49081a38 ]
There are several places where either chan->lock or chan->vchan.lock was
not held. Add appropriate locking. This fixes lockdep warnings like
[ 31.077578] ------------[ cut here ]------------
[ 31.077831] WARNING: CPU: 2 PID: 40 at drivers/dma/xilinx/xilinx\_dpdma.c:834 xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.077953] Modules linked in:
[ 31.078019] CPU: 2 PID: 40 Comm: kworker/u12:1 Not tainted 6.6.20+ #98
[ 31.078102] Hardware name: xlnx,zynqmp (DT)
[ 31.078169] Workqueue: events\_unbound deferred\_probe\_work\_func
[ 31.078272] pstate: 600000c5 (nZCv daIF -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[ 31.078377] pc : xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.078473] lr : xilinx\_dpdma\_chan\_queue\_transfer+0x270/0x5e0
[ 31.078550] sp : ffffffc083bb2e10
[ 31.078590] x29: ffffffc083bb2e10 x28: 0000000000000000 x27: ffffff880165a168
[ 31.078754] x26: ffffff880164e920 x25: ffffff880164eab8 x24: ffffff880164d480
[ 31.078920] x23: ffffff880165a148 x22: ffffff880164e988 x21: 0000000000000000
[ 31.079132] x20: ffffffc082aa3000 x19: ffffff880164e880 x18: 0000000000000000
[ 31.079295] x17: 0000000000000000 x16: 0000000000000000 x15: 0000000000000000
[ 31.079453] x14: 0000000000000000 x13: ffffff8802263dc0 x12: 0000000000000001
[ 31.079613] x11: 0001ffc083bb2e34 x10: 0001ff880164e98f x9 : 0001ffc082aa3def
[ 31.079824] x8 : 0001ffc082aa3dec x7 : 0000000000000000 x6 : 0000000000000516
[ 31.079982] x5 : ffffffc7f8d43000 x4 : ffffff88003c9c40 x3 : ffffffffffffffff
[ 31.080147] x2 : ffffffc7f8d43000 x1 : 00000000000000c0 x0 : 0000000000000000
[ 31.080307] Call trace:
[ 31.080340] xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.080518] xilinx\_dpdma\_issue\_pending+0x11c/0x120
[ 31.080595] zynqmp\_disp\_layer\_update+0x180/0x3ac
[ 31.080712] zynqmp\_dpsub\_plane\_atomic\_update+0x11c/0x21c
[ 31.080825] drm\_atomic\_helper\_commit\_planes+0x20c/0x684
[ 31.080951] drm\_atomic\_helper\_commit\_tail+0x5c/0xb0
[ 31.081139] commit\_tail+0x234/0x294
[ 31.081246] drm\_atomic\_helper\_commit+0x1f8/0x210
[ 31.081363] drm\_atomic\_commit+0x100/0x140
[ 31.081477] drm\_client\_modeset\_commit\_atomic+0x318/0x384
[ 31.081634] drm\_client\_modeset\_commit\_locked+0x8c/0x24c
[ 31.081725] drm\_client\_modeset\_commit+0x34/0x5c
[ 31.081812] \_\_drm\_fb\_helper\_restore\_fbdev\_mode\_unlocked+0x104/0x168
[ 31.081899] drm\_fb\_helper\_set\_par+0x50/0x70
[ 31.081971] fbcon\_init+0x538/0xc48
[ 31.082047] visual\_init+0x16c/0x23c
[ 31.082207] do\_bind\_con\_driver.isra.0+0x2d0/0x634
[ 31.082320] do\_take\_over\_console+0x24c/0x33c
[ 31.082429] do\_fbcon\_takeover+0xbc/0x1b0
[ 31.082503] fbcon\_fb\_registered+0x2d0/0x34c
[ 31.082663] register\_framebuffer+0x27c/0x38c
[ 31.082767] \_\_drm\_fb\_helper\_initial\_config\_and\_unlock+0x5c0/0x91c
[ 31.082939] drm\_fb\_helper\_initial\_config+0x50/0x74
[ 31.083012] drm\_fbdev\_dma\_client\_hotplug+0xb8/0x108
[ 31.083115] drm\_client\_register+0xa0/0xf4
[ 31.083195] drm\_fbdev\_dma\_setup+0xb0/0x1cc
[ 31.083293] zynqmp\_dpsub\_drm\_init+0x45c/0x4e0
[ 31.083431] zynqmp\_dpsub\_probe+0x444/0x5e0
[ 31.083616] platform\_probe+0x8c/0x13c
[ 31.083713] really\_probe+0x258/0x59c
[ 31.083793] \_\_driver\_probe\_device+0xc4/0x224
[ 31.083878] driver\_probe\_device+0x70/0x1c0
[ 31.083961] \_\_device\_attach\_driver+0x108/0x1e0
[ 31.084052] bus\_for\_each\_drv+0x9c/0x100
[ 31.084125] \_\_device\_attach+0x100/0x298
[ 31.084207] device\_initial\_probe+0x14/0x20
[ 31.084292] bus\_probe\_device+0xd8/0xdc
[ 31.084368] deferred\_probe\_work\_func+0x11c/0x180
[ 31.084451] process\_one\_work+0x3ac/0x988
[ 31.084643] worker\_thread+0x398/0x694
[ 31.084752] kthread+0x1bc/0x1c0
[ 31.084848] ret\_from\_fork+0x10/0x20
[ 31.084932] irq event stamp: 64549
[ 31.084970] hardirqs last enabled at (64548): [<ffffffc081adf35c>] \_raw\_spin\_unlock\_irqrestore+0x80/0x90
[ 31.085157] hardirqs last disabled at (64549): [<ffffffc081adf010>] \_raw\_spin\_lock\_irqsave+0xc0/0xdc
[ 31.085277] softirqs last enabled at (64503): [<ffffffc08001071c>] \_\_do\_softirq+0x47c/0x500
[ 31.085390] softirqs last disabled at (64498): [<ffffffc080017134>] \_\_\_\_do\_softirq+0x10/0x1c
[ 31.085501] ---[ end trace 0000000000000000 ]---
Fixes: 7cbb0c63de3f ("dmaengine: xilinx: dpdma: Add the Xilinx DisplayPort DMA engine driver")
Signed-off-by: Sean Anderson <sean.anderson@linux.dev>
Reviewed-by: Tomi Valkeinen <tomi.valkeinen@ideasonboard.com>
Link: [https://lore.kernel.org/r/20240308210034.3634938-2-sean.anderson@linux.dev](https://lore.kernel.org/r/20240308210034.3634938-2-sean.anderson%40linux.dev)
Signed-off-by: Vinod Koul <vkoul@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fcdd5bb4a8c81c64c1334d7e0aba41a8829a24de)

| -rw-r--r-- | [drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/dma/xilinx/xilinx_dpdma.c?id=fcdd5bb4a8c81c64c1334d7e0aba41a8829a24de) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 10 insertions, 3 deletions

| diff --git a/drivers/dma/xilinx/xilinx\_dpdma.c b/drivers/dma/xilinx/xilinx\_dpdma.cindex 6c709803203ad9..058c3a6ed6bbfe 100644--- a/[drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma/xilinx/xilinx_dpdma.c?id=5129f84bc377d525e13cfd208c347d228784b59a)+++ b/[drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma/xilinx/xilinx_dpdma.c?id=fcdd5bb4a8c81c64c1334d7e0aba41a8829a24de)@@ -213,7 +213,8 @@ struct xilinx\_dpdma\_tx\_desc { \* @running: true if the channel is running \* @first\_frame: flag for the first frame of stream \* @video\_group: flag if multi-channel operation is needed for video channels- \* @lock: lock to access struct xilinx\_dpdma\_chan+ \* @lock: lock to access struct xilinx\_dpdma\_chan. Must be taken before+ \* @vchan.lock, if both are to be held. \* @desc\_pool: descriptor allocation pool \* @err\_task: error IRQ bottom half handler \* @desc: References to descriptors being processed@@ -1101,12 +1102,14 @@ static void xilinx\_dpdma\_chan\_vsync\_irq(struct xilinx\_dpdma\_chan \*chan) \* Complete the active descriptor, if any, promote the pending \* descriptor to active, and queue the next transfer, if any. \*/+ spin\_lock(&chan->vchan.lock); if (chan->desc.active) vchan\_cookie\_complete(&chan->desc.active->vdesc); chan->desc.active = pending; chan->desc.pending = NULL;  xilinx\_dpdma\_chan\_queue\_transfer(chan);+ spin\_unlock(&chan->vchan.lock);  out: spin\_unlock\_irqrestore(&chan->lock, flags);@@ -1264,10 +1267,12 @@ static void xilinx\_dpdma\_issue\_pending(struct dma\_chan \*dchan) struct xilinx\_dpdma\_chan \*chan = to\_xilinx\_chan(dchan); unsigned long flags; - spin\_lock\_irqsave(&chan->vchan.lock, flags);+ spin\_lock\_irqsave(&chan->lock, flags);+ spin\_lock(&chan->vchan.lock); if (vchan\_issue\_pending(&chan->vchan)) xilinx\_dpdma\_chan\_queue\_transfer(chan);- spin\_unlock\_irqrestore(&chan->vchan.lock, flags);+ spin\_unlock(&chan->vchan.lock);+ spin\_unlock\_irqrestore(&chan->lock, flags); }  static int xilinx\_dpdma\_config(struct dma\_chan \*dchan,@@ -1491,7 +1496,9 @@ static void xilinx\_dpdma\_chan\_err\_task(struct tasklet\_struct \*t) XILINX\_DPDMA\_EINTR\_CHAN\_ERR\_MASK << chan->id);  spin\_lock\_irqsave(&chan->lock, flags);+ spin\_lock(&chan->vchan.lock); xilinx\_dpdma\_chan\_queue\_transfer(chan);+ spin\_unlock(&chan->vchan.lock); spin\_unlock\_irqrestore(&chan->lock, flags); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:24:45 +0000



=== Content from git.kernel.org_5428d0c0_20250111_042607.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8e3c94767cad5150198e4337c8b91f3bb068e14b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8e3c94767cad5150198e4337c8b91f3bb068e14b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8e3c94767cad5150198e4337c8b91f3bb068e14b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8e3c94767cad5150198e4337c8b91f3bb068e14b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sean Anderson <sean.anderson@linux.dev> | 2024-03-08 16:00:32 -0500 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-05-02 16:32:48 +0200 |
| commit | [8e3c94767cad5150198e4337c8b91f3bb068e14b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8e3c94767cad5150198e4337c8b91f3bb068e14b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8e3c94767cad5150198e4337c8b91f3bb068e14b)) | |
| tree | [a4a7fcddd92020b9661c0f486a39f7c5dc270298](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8e3c94767cad5150198e4337c8b91f3bb068e14b) | |
| parent | [758071a35d9f3ffd84ff12169d081412a2f5f098](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=758071a35d9f3ffd84ff12169d081412a2f5f098) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8e3c94767cad5150198e4337c8b91f3bb068e14b&id2=758071a35d9f3ffd84ff12169d081412a2f5f098)) | |
| download | [linux-8e3c94767cad5150198e4337c8b91f3bb068e14b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8e3c94767cad5150198e4337c8b91f3bb068e14b.tar.gz) | |

dma: xilinx\_dpdma: Fix locking[ Upstream commit 244296cc3a155199a8b080d19e645d7d49081a38 ]
There are several places where either chan->lock or chan->vchan.lock was
not held. Add appropriate locking. This fixes lockdep warnings like
[ 31.077578] ------------[ cut here ]------------
[ 31.077831] WARNING: CPU: 2 PID: 40 at drivers/dma/xilinx/xilinx\_dpdma.c:834 xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.077953] Modules linked in:
[ 31.078019] CPU: 2 PID: 40 Comm: kworker/u12:1 Not tainted 6.6.20+ #98
[ 31.078102] Hardware name: xlnx,zynqmp (DT)
[ 31.078169] Workqueue: events\_unbound deferred\_probe\_work\_func
[ 31.078272] pstate: 600000c5 (nZCv daIF -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[ 31.078377] pc : xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.078473] lr : xilinx\_dpdma\_chan\_queue\_transfer+0x270/0x5e0
[ 31.078550] sp : ffffffc083bb2e10
[ 31.078590] x29: ffffffc083bb2e10 x28: 0000000000000000 x27: ffffff880165a168
[ 31.078754] x26: ffffff880164e920 x25: ffffff880164eab8 x24: ffffff880164d480
[ 31.078920] x23: ffffff880165a148 x22: ffffff880164e988 x21: 0000000000000000
[ 31.079132] x20: ffffffc082aa3000 x19: ffffff880164e880 x18: 0000000000000000
[ 31.079295] x17: 0000000000000000 x16: 0000000000000000 x15: 0000000000000000
[ 31.079453] x14: 0000000000000000 x13: ffffff8802263dc0 x12: 0000000000000001
[ 31.079613] x11: 0001ffc083bb2e34 x10: 0001ff880164e98f x9 : 0001ffc082aa3def
[ 31.079824] x8 : 0001ffc082aa3dec x7 : 0000000000000000 x6 : 0000000000000516
[ 31.079982] x5 : ffffffc7f8d43000 x4 : ffffff88003c9c40 x3 : ffffffffffffffff
[ 31.080147] x2 : ffffffc7f8d43000 x1 : 00000000000000c0 x0 : 0000000000000000
[ 31.080307] Call trace:
[ 31.080340] xilinx\_dpdma\_chan\_queue\_transfer+0x274/0x5e0
[ 31.080518] xilinx\_dpdma\_issue\_pending+0x11c/0x120
[ 31.080595] zynqmp\_disp\_layer\_update+0x180/0x3ac
[ 31.080712] zynqmp\_dpsub\_plane\_atomic\_update+0x11c/0x21c
[ 31.080825] drm\_atomic\_helper\_commit\_planes+0x20c/0x684
[ 31.080951] drm\_atomic\_helper\_commit\_tail+0x5c/0xb0
[ 31.081139] commit\_tail+0x234/0x294
[ 31.081246] drm\_atomic\_helper\_commit+0x1f8/0x210
[ 31.081363] drm\_atomic\_commit+0x100/0x140
[ 31.081477] drm\_client\_modeset\_commit\_atomic+0x318/0x384
[ 31.081634] drm\_client\_modeset\_commit\_locked+0x8c/0x24c
[ 31.081725] drm\_client\_modeset\_commit+0x34/0x5c
[ 31.081812] \_\_drm\_fb\_helper\_restore\_fbdev\_mode\_unlocked+0x104/0x168
[ 31.081899] drm\_fb\_helper\_set\_par+0x50/0x70
[ 31.081971] fbcon\_init+0x538/0xc48
[ 31.082047] visual\_init+0x16c/0x23c
[ 31.082207] do\_bind\_con\_driver.isra.0+0x2d0/0x634
[ 31.082320] do\_take\_over\_console+0x24c/0x33c
[ 31.082429] do\_fbcon\_takeover+0xbc/0x1b0
[ 31.082503] fbcon\_fb\_registered+0x2d0/0x34c
[ 31.082663] register\_framebuffer+0x27c/0x38c
[ 31.082767] \_\_drm\_fb\_helper\_initial\_config\_and\_unlock+0x5c0/0x91c
[ 31.082939] drm\_fb\_helper\_initial\_config+0x50/0x74
[ 31.083012] drm\_fbdev\_dma\_client\_hotplug+0xb8/0x108
[ 31.083115] drm\_client\_register+0xa0/0xf4
[ 31.083195] drm\_fbdev\_dma\_setup+0xb0/0x1cc
[ 31.083293] zynqmp\_dpsub\_drm\_init+0x45c/0x4e0
[ 31.083431] zynqmp\_dpsub\_probe+0x444/0x5e0
[ 31.083616] platform\_probe+0x8c/0x13c
[ 31.083713] really\_probe+0x258/0x59c
[ 31.083793] \_\_driver\_probe\_device+0xc4/0x224
[ 31.083878] driver\_probe\_device+0x70/0x1c0
[ 31.083961] \_\_device\_attach\_driver+0x108/0x1e0
[ 31.084052] bus\_for\_each\_drv+0x9c/0x100
[ 31.084125] \_\_device\_attach+0x100/0x298
[ 31.084207] device\_initial\_probe+0x14/0x20
[ 31.084292] bus\_probe\_device+0xd8/0xdc
[ 31.084368] deferred\_probe\_work\_func+0x11c/0x180
[ 31.084451] process\_one\_work+0x3ac/0x988
[ 31.084643] worker\_thread+0x398/0x694
[ 31.084752] kthread+0x1bc/0x1c0
[ 31.084848] ret\_from\_fork+0x10/0x20
[ 31.084932] irq event stamp: 64549
[ 31.084970] hardirqs last enabled at (64548): [<ffffffc081adf35c>] \_raw\_spin\_unlock\_irqrestore+0x80/0x90
[ 31.085157] hardirqs last disabled at (64549): [<ffffffc081adf010>] \_raw\_spin\_lock\_irqsave+0xc0/0xdc
[ 31.085277] softirqs last enabled at (64503): [<ffffffc08001071c>] \_\_do\_softirq+0x47c/0x500
[ 31.085390] softirqs last disabled at (64498): [<ffffffc080017134>] \_\_\_\_do\_softirq+0x10/0x1c
[ 31.085501] ---[ end trace 0000000000000000 ]---
Fixes: 7cbb0c63de3f ("dmaengine: xilinx: dpdma: Add the Xilinx DisplayPort DMA engine driver")
Signed-off-by: Sean Anderson <sean.anderson@linux.dev>
Reviewed-by: Tomi Valkeinen <tomi.valkeinen@ideasonboard.com>
Link: [https://lore.kernel.org/r/20240308210034.3634938-2-sean.anderson@linux.dev](https://lore.kernel.org/r/20240308210034.3634938-2-sean.anderson%40linux.dev)
Signed-off-by: Vinod Koul <vkoul@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8e3c94767cad5150198e4337c8b91f3bb068e14b)

| -rw-r--r-- | [drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/dma/xilinx/xilinx_dpdma.c?id=8e3c94767cad5150198e4337c8b91f3bb068e14b) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 10 insertions, 3 deletions

| diff --git a/drivers/dma/xilinx/xilinx\_dpdma.c b/drivers/dma/xilinx/xilinx\_dpdma.cindex 84dc5240a8074a..93938ed80fc837 100644--- a/[drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma/xilinx/xilinx_dpdma.c?id=758071a35d9f3ffd84ff12169d081412a2f5f098)+++ b/[drivers/dma/xilinx/xilinx\_dpdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma/xilinx/xilinx_dpdma.c?id=8e3c94767cad5150198e4337c8b91f3bb068e14b)@@ -214,7 +214,8 @@ struct xilinx\_dpdma\_tx\_desc { \* @running: true if the channel is running \* @first\_frame: flag for the first frame of stream \* @video\_group: flag if multi-channel operation is needed for video channels- \* @lock: lock to access struct xilinx\_dpdma\_chan+ \* @lock: lock to access struct xilinx\_dpdma\_chan. Must be taken before+ \* @vchan.lock, if both are to be held. \* @desc\_pool: descriptor allocation pool \* @err\_task: error IRQ bottom half handler \* @desc: References to descriptors being processed@@ -1097,12 +1098,14 @@ static void xilinx\_dpdma\_chan\_vsync\_irq(struct xilinx\_dpdma\_chan \*chan) \* Complete the active descriptor, if any, promote the pending \* descriptor to active, and queue the next transfer, if any. \*/+ spin\_lock(&chan->vchan.lock); if (chan->desc.active) vchan\_cookie\_complete(&chan->desc.active->vdesc); chan->desc.active = pending; chan->desc.pending = NULL;  xilinx\_dpdma\_chan\_queue\_transfer(chan);+ spin\_unlock(&chan->vchan.lock);  out: spin\_unlock\_irqrestore(&chan->lock, flags);@@ -1264,10 +1267,12 @@ static void xilinx\_dpdma\_issue\_pending(struct dma\_chan \*dchan) struct xilinx\_dpdma\_chan \*chan = to\_xilinx\_chan(dchan); unsigned long flags; - spin\_lock\_irqsave(&chan->vchan.lock, flags);+ spin\_lock\_irqsave(&chan->lock, flags);+ spin\_lock(&chan->vchan.lock); if (vchan\_issue\_pending(&chan->vchan)) xilinx\_dpdma\_chan\_queue\_transfer(chan);- spin\_unlock\_irqrestore(&chan->vchan.lock, flags);+ spin\_unlock(&chan->vchan.lock);+ spin\_unlock\_irqrestore(&chan->lock, flags); }  static int xilinx\_dpdma\_config(struct dma\_chan \*dchan,@@ -1495,7 +1500,9 @@ static void xilinx\_dpdma\_chan\_err\_task(struct tasklet\_struct \*t) XILINX\_DPDMA\_EINTR\_CHAN\_ERR\_MASK << chan->id);  spin\_lock\_irqsave(&chan->lock, flags);+ spin\_lock(&chan->vchan.lock); xilinx\_dpdma\_chan\_queue\_transfer(chan);+ spin\_unlock(&chan->vchan.lock); spin\_unlock\_irqrestore(&chan->lock, flags); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:24:44 +0000



=== Content from lists.debian.org_2d5de243_20250111_042608.html ===


---

[[Date Prev](msg00016.html)][[Date Next](msg00018.html)]
[[Thread Prev](msg00016.html)][[Thread Next](msg00018.html)]
[[Date Index](maillist.html#00017)]
[[Thread Index](threads.html#00017)]

# [SECURITY] [DLA 3842-1] linux-5.10 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3842-1] linux-5.10 security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Tue, 25 Jun 2024 21:41:47 +0200
* *Message-id*: <[[]](/msgid-search/Znsdeycap_uaG_xM%40decadent.org.uk)[Znsdeycap\_uaG\_xM@decadent.org.uk](msg00017.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3842-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
June 25, 2024                                 <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux-5.10
Version        : 5.10.216-1~deb10u1
CVE ID         : CVE-2022-38096 CVE-2023-6270 CVE-2023-7042 CVE-2023-28746
                 CVE-2023-47233 CVE-2023-52429 CVE-2023-52434 CVE-2023-52435
                 CVE-2023-52447 CVE-2023-52458 CVE-2023-52482 CVE-2023-52486
                 CVE-2023-52488 CVE-2023-52489 CVE-2023-52491 CVE-2023-52492
                 CVE-2023-52493 CVE-2023-52497 CVE-2023-52498 CVE-2023-52583
                 CVE-2023-52587 CVE-2023-52594 CVE-2023-52595 CVE-2023-52597
                 CVE-2023-52598 CVE-2023-52599 CVE-2023-52600 CVE-2023-52601
                 CVE-2023-52602 CVE-2023-52603 CVE-2023-52604 CVE-2023-52606
                 CVE-2023-52607 CVE-2023-52614 CVE-2023-52615 CVE-2023-52616
                 CVE-2023-52617 CVE-2023-52618 CVE-2023-52619 CVE-2023-52620
                 CVE-2023-52622 CVE-2023-52623 CVE-2023-52627 CVE-2023-52635
                 CVE-2023-52637 CVE-2023-52642 CVE-2023-52644 CVE-2023-52650
                 CVE-2023-52656 CVE-2023-52669 CVE-2023-52670 CVE-2023-52672
                 CVE-2023-52699 CVE-2023-52880 CVE-2024-0340 CVE-2024-0565
                 CVE-2024-0607 CVE-2024-0841 CVE-2024-1151 CVE-2024-22099
                 CVE-2024-23849 CVE-2024-23850 CVE-2024-23851 CVE-2024-24857
                 CVE-2024-24858 CVE-2024-24861 CVE-2024-25739 CVE-2024-26581
                 CVE-2024-26593 CVE-2024-26600 CVE-2024-26601 CVE-2024-26602
                 CVE-2024-26606 CVE-2024-26610 CVE-2024-26614 CVE-2024-26615
                 CVE-2024-26622 CVE-2024-26625 CVE-2024-26627 CVE-2024-26635
                 CVE-2024-26636 CVE-2024-26640 CVE-2024-26641 CVE-2024-26642
                 CVE-2024-26643 CVE-2024-26644 CVE-2024-26645 CVE-2024-26651
                 CVE-2024-26654 CVE-2024-26659 CVE-2024-26663 CVE-2024-26664
                 CVE-2024-26665 CVE-2024-26671 CVE-2024-26673 CVE-2024-26675
                 CVE-2024-26679 CVE-2024-26684 CVE-2024-26685 CVE-2024-26687
                 CVE-2024-26688 CVE-2024-26689 CVE-2024-26695 CVE-2024-26696
                 CVE-2024-26697 CVE-2024-26698 CVE-2024-26702 CVE-2024-26704
                 CVE-2024-26707 CVE-2024-26712 CVE-2024-26720 CVE-2024-26722
                 CVE-2024-26727 CVE-2024-26733 CVE-2024-26735 CVE-2024-26736
                 CVE-2024-26743 CVE-2024-26744 CVE-2024-26747 CVE-2024-26748
                 CVE-2024-26749 CVE-2024-26751 CVE-2024-26752 CVE-2024-26753
                 CVE-2024-26754 CVE-2024-26763 CVE-2024-26764 CVE-2024-26766
                 CVE-2024-26771 CVE-2024-26772 CVE-2024-26773 CVE-2024-26776
                 CVE-2024-26777 CVE-2024-26778 CVE-2024-26779 CVE-2024-26781
                 CVE-2024-26782 CVE-2024-26787 CVE-2024-26788 CVE-2024-26790
                 CVE-2024-26791 CVE-2024-26793 CVE-2024-26795 CVE-2024-26801
                 CVE-2024-26804 CVE-2024-26805 CVE-2024-26808 CVE-2024-26809
                 CVE-2024-26810 CVE-2024-26812 CVE-2024-26813 CVE-2024-26814
                 CVE-2024-26816 CVE-2024-26817 CVE-2024-26820 CVE-2024-26825
                 CVE-2024-26833 CVE-2024-26835 CVE-2024-26839 CVE-2024-26840
                 CVE-2024-26843 CVE-2024-26845 CVE-2024-26846 CVE-2024-26848
                 CVE-2024-26851 CVE-2024-26852 CVE-2024-26855 CVE-2024-26857
                 CVE-2024-26859 CVE-2024-26861 CVE-2024-26862 CVE-2024-26863
                 CVE-2024-26870 CVE-2024-26872 CVE-2024-26874 CVE-2024-26875
                 CVE-2024-26877 CVE-2024-26878 CVE-2024-26880 CVE-2024-26882
                 CVE-2024-26883 CVE-2024-26884 CVE-2024-26885 CVE-2024-26889
                 CVE-2024-26891 CVE-2024-26894 CVE-2024-26895 CVE-2024-26897
                 CVE-2024-26898 CVE-2024-26901 CVE-2024-26903 CVE-2024-26906
                 CVE-2024-26907 CVE-2024-26910 CVE-2024-26917 CVE-2024-26922
                 CVE-2024-26923 CVE-2024-26924 CVE-2024-26925 CVE-2024-26926
                 CVE-2024-26931 CVE-2024-26934 CVE-2024-26935 CVE-2024-26937
                 CVE-2024-26950 CVE-2024-26951 CVE-2024-26955 CVE-2024-26956
                 CVE-2024-26957 CVE-2024-26958 CVE-2024-26960 CVE-2024-26961
                 CVE-2024-26965 CVE-2024-26966 CVE-2024-26969 CVE-2024-26970
                 CVE-2024-26973 CVE-2024-26974 CVE-2024-26976 CVE-2024-26978
                 CVE-2024-26981 CVE-2024-26984 CVE-2024-26988 CVE-2024-26993
                 CVE-2024-26994 CVE-2024-26997 CVE-2024-26999 CVE-2024-27000
                 CVE-2024-27001 CVE-2024-27004 CVE-2024-27008 CVE-2024-27013
                 CVE-2024-27020 CVE-2024-27024 CVE-2024-27025 CVE-2024-27028
                 CVE-2024-27030 CVE-2024-27038 CVE-2024-27043 CVE-2024-27044
                 CVE-2024-27045 CVE-2024-27046 CVE-2024-27047 CVE-2024-27051
                 CVE-2024-27052 CVE-2024-27053 CVE-2024-27059 CVE-2024-27065
                 CVE-2024-27073 CVE-2024-27074 CVE-2024-27075 CVE-2024-27076
                 CVE-2024-27077 CVE-2024-27078 CVE-2024-27388 CVE-2024-27395
                 CVE-2024-27396 CVE-2024-27405 CVE-2024-27410 CVE-2024-27412
                 CVE-2024-27413 CVE-2024-27414 CVE-2024-27416 CVE-2024-27417
                 CVE-2024-27419 CVE-2024-27431 CVE-2024-27436 CVE-2024-27437
                 CVE-2024-35785 CVE-2024-35789 CVE-2024-35791 CVE-2024-35796
                 CVE-2024-35805 CVE-2024-35806 CVE-2024-35807 CVE-2024-35809
                 CVE-2024-35811 CVE-2024-35813 CVE-2024-35815 CVE-2024-35819
                 CVE-2024-35821 CVE-2024-35822 CVE-2024-35823 CVE-2024-35825
                 CVE-2024-35828 CVE-2024-35829 CVE-2024-35830 CVE-2024-35833
                 CVE-2024-35835 CVE-2024-35837 CVE-2024-35845 CVE-2024-35847
                 CVE-2024-35849 CVE-2024-35852 CVE-2024-35853 CVE-2024-35854
                 CVE-2024-35855 CVE-2024-35871 CVE-2024-35877 CVE-2024-35879
                 CVE-2024-35884 CVE-2024-35886 CVE-2024-35888 CVE-2024-35893
                 CVE-2024-35895 CVE-2024-35896 CVE-2024-35897 CVE-2024-35898
                 CVE-2024-35899 CVE-2024-35900 CVE-2024-35902 CVE-2024-35905
                 CVE-2024-35910 CVE-2024-35915 CVE-2024-35922 CVE-2024-35925
                 CVE-2024-35930 CVE-2024-35933 CVE-2024-35934 CVE-2024-35935
                 CVE-2024-35936 CVE-2024-35940 CVE-2024-35944 CVE-2024-35950
                 CVE-2024-35955 CVE-2024-35958 CVE-2024-35960 CVE-2024-35962
                 CVE-2024-35967 CVE-2024-35969 CVE-2024-35973 CVE-2024-35976
                 CVE-2024-35978 CVE-2024-35982 CVE-2024-35983 CVE-2024-35984
                 CVE-2024-35988 CVE-2024-35990 CVE-2024-35996 CVE-2024-35997
                 CVE-2024-36004 CVE-2024-36005 CVE-2024-36006 CVE-2024-36007
                 CVE-2024-36008 CVE-2024-36020
Debian Bug     : 1064035

Several vulnerabilities were discovered in the Linux kernel that may
lead to a privilege escalation, denial of service or information
leaks.

For Debian 10 buster, these problems were fixed earlier in version
5.10.216-1~deb10u1.  This update also fixed a regression in kernel
documentation generation, and included many more bug fixes from stable
updates 5.10.210-5.10.216 inclusive.

For the detailed security status of linux-5.10 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux-5.10>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpvh8SL4z3oF.pgp)**

*Description:* PGP signature

---


