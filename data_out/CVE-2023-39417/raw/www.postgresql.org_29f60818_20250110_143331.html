<!doctype html>
<html lang="en">
 <head>
  <title>PostgreSQL: CVE-2023-39417: Extension script @substitutions@ within quoting allow SQL injection</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8" />
   
  <meta name="theme-color" content="#336791"/>
  <meta name="copyright" content="The PostgreSQL Global Development Group" />
  <link href="/media/css/fontawesome.css?83493b5d" rel="stylesheet">
  <link rel="stylesheet" href="/media/css/bootstrap-4.4.1.min.css">
  <link rel="shortcut icon" href="/favicon.ico" />
  
  <link rel="stylesheet" type="text/css" href="/dyncss/base.css?83493b5d">

  <script src="/media/js/theme.js?83493b5d"></script>

  
  </head>
  <body>
    <div class="container-fluid">
      <div class="row justify-content-md-center">
        <div class="col">
          <!-- Header -->
          <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand p-0" href="/">
              <img class="logo" src="/media/img/about/press/elephant.png" alt="PostgreSQL Elephant Logo">
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#pgNavbar" aria-controls="pgNavbar" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="pgNavbar">
              <ul class="navbar-nav mr-auto">
                <li class="nav-item p-2"><a href="/" title="Home">Home</a></li>
                <li class="nav-item p-2"><a href="/about/" title="About">About</a></li>
                <li class="nav-item p-2"><a href="/download/" title="Download">Download</a></li>
                <li class="nav-item p-2"><a href="/docs/" title="Documentation">Documentation</a></li>
                <li class="nav-item p-2"><a href="/community/" title="Community">Community</a></li>
                <li class="nav-item p-2"><a href="/developer/" title="Developers">Developers</a></li>
                <li class="nav-item p-2"><a href="/support/" title="Support">Support</a></li>
                <li class="nav-item p-2"><a href="/about/donate/" title="Donate">Donate</a></li>
                <li class="nav-item p-2"><a href="/account/" title="Your account">Your account</a></li>
              </ul>
              <form role="search" method="get" action="/search/">
                <div class="input-group">
                  <input id="q" name="q" type="text" size="20" maxlength="255" accesskey="s"  class="form-control" placeholder="Search for...">
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fas fa-search"></i></button>
                  </span>
                </div><!-- /input-group -->
              </form>
              <form id="form-theme" class="form-inline d-none">
                <button id="btn-theme" class="btn btn-default ml-1" type="button"></button>
              </form>
            </div>
          </nav>
        </div>
      </div>
      <div class="row justify-content-center pg-shout-box">
        <div class="col text-white text-center">November 21, 2024: <a href="/about/news/postgresql-172-166-1510-1415-1318-and-1222-released-2965/">
  PostgreSQL 17.2, 16.6, 15.10, 14.15, 13.18, and 12.22 Released!
</a>

</div>
      </div>
    </div>
    
<div class="container-fluid margin">
  <div class="row">
    <div class="col-lg-2">
      <div id="pgSideWrap">
       
       <div id="pgSideNav">
         <h2>Quick Links</h2>

         <ul>
           
           
           <li><a href="/support/">Support</a>
            
            
           
           </li>
           <li><a href="/support/versioning/">Versioning Policy</a>
            
            
           
           </li>
           <li><a href="/support/security/">Security</a>
            
            
           
           </li>
           <li><a href="/support/professional_support/">Professional Services</a>
            
            
           
           </li>
           <li><a href="/support/professional_hosting/">Hosting Solutions</a>
            
            
           
           </li>
           <li class="last-child"><a href="/account/submitbug/">Report a Bug</a>
            
            
           </li>
            
           
        </ul>

       </div>
       
      </div> <!-- pgSideWrap -->
    </div>
    <div class="col-lg-10">
      <div id="pgContentWrap">
        

<h1>CVE-2023-39417 <i class="fas fa-lock"></i></h1>
<h3>Extension script @substitutions@ within quoting allow SQL injection</h3>


<p>An <a href="https://www.postgresql.org/docs/current/extend-extensions.html">extension script</a>
is vulnerable if it uses <code>@extowner@</code>, <code>@extschema@</code>, or <code>@extschema:...@</code>
inside a quoting construct (dollar quoting, <code>''</code>, or <code>""</code>). No bundled extension
is vulnerable. Vulnerable uses do appear in a documentation example and in
non-bundled extensions. Hence, the attack prerequisite is an administrator
having installed files of a vulnerable, trusted, non-bundled extension. Subject
to that prerequisite, this enables an attacker having database-level <code>CREATE</code>
privilege to execute arbitrary code as the bootstrap superuser. PostgreSQL will
block this attack in the core server, so there's no need to modify individual
extensions.</p>
<p>The PostgreSQL project thanks Micah Gates, Valerie Woolard, Tim Carey-Smith,
and Christoph Berg for reporting this problem.</p>


<h2>Version Information</h2>

<table class="table">
  <thead>
    <tr>
      <th>Affected Version</th>
      <th>Fixed In</th>
      
      <th>Fix Published</th>
      
  </thead>
  <tbody>
    
    <tr>
      <td>
        
          15
        
      </td>
      <td>
        <a href="/docs/release/15.4">
          
            15.4
          
        </a>
      </td>
      
      <td>
        <a href="/about/news/postgresql-154-149-1312-1216-1121-and-postgresql-16-beta-3-released-2689/">
          Aug. 10, 2023
        </a>
      </td>
      
    </tr>
    
    <tr>
      <td>
        
          14
        
      </td>
      <td>
        <a href="/docs/release/14.9">
          
            14.9
          
        </a>
      </td>
      
      <td>
        <a href="/about/news/postgresql-154-149-1312-1216-1121-and-postgresql-16-beta-3-released-2689/">
          Aug. 10, 2023
        </a>
      </td>
      
    </tr>
    
    <tr>
      <td>
        
          13
        
      </td>
      <td>
        <a href="/docs/release/13.12">
          
            13.12
          
        </a>
      </td>
      
      <td>
        <a href="/about/news/postgresql-154-149-1312-1216-1121-and-postgresql-16-beta-3-released-2689/">
          Aug. 10, 2023
        </a>
      </td>
      
    </tr>
    
    <tr>
      <td>
        
          12
        
      </td>
      <td>
        <a href="/docs/release/12.16">
          
            12.16
          
        </a>
      </td>
      
      <td>
        <a href="/about/news/postgresql-154-149-1312-1216-1121-and-postgresql-16-beta-3-released-2689/">
          Aug. 10, 2023
        </a>
      </td>
      
    </tr>
    
    <tr>
      <td>
        
          11
        
      </td>
      <td>
        <a href="/docs/release/11.21">
          
            11.21
          
        </a>
      </td>
      
      <td>
        <a href="/about/news/postgresql-154-149-1312-1216-1121-and-postgresql-16-beta-3-released-2689/">
          Aug. 10, 2023
        </a>
      </td>
      
    </tr>
    
  </tbody>
</table>

<p>
  For more information about <a href="/support/versioning/">PostgreSQL versioning</a>,
  please visit the <a href="/support/versioning/">versioning page</a>.
</p>


<h2>CVSS 3.0</h2>

<table class="table">
  <tbody>
    <tr>
      <th>Overall Score</th>
      <td><strong>7.5</strong></td>
    </tr>
    <tr>
      <th>Component</th>
      <td>core server</td>
    </tr>
    <tr>
      <th>Vector</th>
      <td>
        <a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H&version=3.0" target="_blank" rel="noopener noreferer">
          AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
        </a>
      </td>
    </tr>
  </tbody>
</table>


<h2>Reporting Security Vulnerabilities</h2>

<p>
  If you wish to report a new security vulnerability in PostgreSQL, please
  send an email to
  <a href="mailto:security@postgresql.org">security@postgresql.org</a>.
</p>

<p>
  For reporting non-security bugs, please see the <a href="/account/submitbug/">Report a Bug</a> page.
</p>

      </div> <!-- pgContentWrap -->
    </div>
  </div>
</div>

    <!-- Footer -->
    <footer id="footer">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <ul>
              <li><a href="https://twitter.com/postgresql"><img src="/media/img/atpostgresql.png" alt="@postgresql"></a></li>
              <li><a href="https://git.postgresql.org/gitweb/?p=postgresql.git"><img src="/media/img/git.png" alt="Git"></a></li>
            </ul>
          </div>
        </div>
      </div>
      <!-- Copyright -->
      <div class="container">
        <a href="/about/policies/">Policies</a> |
        <a href="/about/policies/coc/">Code of Conduct</a> |
        <a href="/about/">About PostgreSQL</a> |
        <a href="/about/contact/">Contact</a><br/>
        <p>Copyright &copy; 1996-2025 The PostgreSQL Global Development Group</p>
      </div>
    </footer>
    <script src="/media/js/jquery-3.4.1.slim.min.js"></script>
    <script src="/media/js/popper-1.16.0.min.js"></script>
    <script src="/media/js/bootstrap-4.4.1.min.js"></script>
    <script src="/media/js/main.js?83493b5d"></script>

  </body>
</html>
