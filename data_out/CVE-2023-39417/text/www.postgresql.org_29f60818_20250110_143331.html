

[![PostgreSQL Elephant Logo](/media/img/about/press/elephant.png)](/)

* [Home](/ "Home")
* [About](/about/ "About")
* [Download](/download/ "Download")
* [Documentation](/docs/ "Documentation")
* [Community](/community/ "Community")
* [Developers](/developer/ "Developers")
* [Support](/support/ "Support")
* [Donate](/about/donate/ "Donate")
* [Your account](/account/ "Your account")

November 21, 2024: [PostgreSQL 17.2, 16.6, 15.10, 14.15, 13.18, and 12.22 Released!](/about/news/postgresql-172-166-1510-1415-1318-and-1222-released-2965/)

## Quick Links

* [Support](/support/)
* [Versioning Policy](/support/versioning/)
* [Security](/support/security/)
* [Professional Services](/support/professional_support/)
* [Hosting Solutions](/support/professional_hosting/)
* [Report a Bug](/account/submitbug/)

# CVE-2023-39417

### Extension script @substitutions@ within quoting allow SQL injection

An [extension script](https://www.postgresql.org/docs/current/extend-extensions.html)
is vulnerable if it uses `@extowner@`, `@extschema@`, or `@extschema:...@`
inside a quoting construct (dollar quoting, `''`, or `""`). No bundled extension
is vulnerable. Vulnerable uses do appear in a documentation example and in
non-bundled extensions. Hence, the attack prerequisite is an administrator
having installed files of a vulnerable, trusted, non-bundled extension. Subject
to that prerequisite, this enables an attacker having database-level `CREATE`
privilege to execute arbitrary code as the bootstrap superuser. PostgreSQL will
block this attack in the core server, so there's no need to modify individual
extensions.

The PostgreSQL project thanks Micah Gates, Valerie Woolard, Tim Carey-Smith,
and Christoph Berg for reporting this problem.

## Version Information

| Affected Version | Fixed In | Fix Published |
| --- | --- | --- |
| 15 | [15.4](/docs/release/15.4) | [Aug. 10, 2023](/about/news/postgresql-154-149-1312-1216-1121-and-postgresql-16-beta-3-released-2689/) |
| 14 | [14.9](/docs/release/14.9) | [Aug. 10, 2023](/about/news/postgresql-154-149-1312-1216-1121-and-postgresql-16-beta-3-released-2689/) |
| 13 | [13.12](/docs/release/13.12) | [Aug. 10, 2023](/about/news/postgresql-154-149-1312-1216-1121-and-postgresql-16-beta-3-released-2689/) |
| 12 | [12.16](/docs/release/12.16) | [Aug. 10, 2023](/about/news/postgresql-154-149-1312-1216-1121-and-postgresql-16-beta-3-released-2689/) |
| 11 | [11.21](/docs/release/11.21) | [Aug. 10, 2023](/about/news/postgresql-154-149-1312-1216-1121-and-postgresql-16-beta-3-released-2689/) |

For more information about [PostgreSQL versioning](/support/versioning/),
please visit the [versioning page](/support/versioning/).

## CVSS 3.0

| Overall Score | **7.5** |
| --- | --- |
| Component | core server |
| Vector | [AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H&version=3.0) |

## Reporting Security Vulnerabilities

If you wish to report a new security vulnerability in PostgreSQL, please
send an email to
security@postgresql.org.

For reporting non-security bugs, please see the [Report a Bug](/account/submitbug/) page.

* [![@postgresql](/media/img/atpostgresql.png)](https://twitter.com/postgresql)
* [![Git](/media/img/git.png)](https://git.postgresql.org/gitweb/?p=postgresql.git)

[Policies](/about/policies/) |
[Code of Conduct](/about/policies/coc/) |
[About PostgreSQL](/about/) |
[Contact](/about/contact/)

Copyright Â© 1996-2025 The PostgreSQL Global Development Group

