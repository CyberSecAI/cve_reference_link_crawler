

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwpglobus-translate-options%2Ftrunk%2Fincludes%2Fclass-wpglobus-translate-options.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/wpglobus-translate-options/trunk/includes/class-wpglobus-translate-options.php?rev=2633240 "Revision 2633240")
* Next Revision →
* [Blame](/browser/wpglobus-translate-options/trunk/includes/class-wpglobus-translate-options.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wpglobus-translate-options/trunk/includes/class-wpglobus-translate-options.php)

---

# [source:](/browser?order=name "Go to repository root") [wpglobus-translate-options](/browser/wpglobus-translate-options?order=name "View wpglobus-translate-options")/[trunk](/browser/wpglobus-translate-options/trunk?order=name "View trunk")/[includes](/browser/wpglobus-translate-options/trunk/includes?order=name "View includes")/[class-wpglobus-translate-options.php](/browser/wpglobus-translate-options/trunk/includes/class-wpglobus-translate-options.php?order=name "View class-wpglobus-translate-options.php")

View diff against:

View revision:

| [Last change](/changeset/2863637/wpglobus-translate-options/trunk/includes/class-wpglobus-translate-options.php "View differences") on this file was [2863637](/changeset/2863637/ "View changeset 2863637"), checked in by alexgff, [2 years ago](/timeline?from=2023-02-11T11%3A45%3A52Z&precision=second "See timeline at 02/11/2023 11:45:52 AM") |
| --- |
| Version 2.2.0 |
| **File size:** 24.8 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* File: class-wpglobus-translate-options.php |
| [4](#L4) | \* |
| [5](#L5) | \* @package WPGlobus Translate Options |
| [6](#L6) | \* @subpackage Administration |
| [7](#L7) | \* |
| [8](#L8) | \* @since 1.9.0 |
| [9](#L9) | \*/ |
| [10](#L10) |  |
| [11](#L11) | // Exit if accessed directly |
| [12](#L12) | if ( ! defined( 'ABSPATH' ) ) { |
| [13](#L13) | exit; |
| [14](#L14) | } |
| [15](#L15) |  |
| [16](#L16) | if ( ! class\_exists( 'WPGlobus\_Translate\_Options' ) ) : |
| [17](#L17) |  |
| [18](#L18) | /\*\* |
| [19](#L19) | \* Class WPGlobus\_Translate\_Options. |
| [20](#L20) | \*/ |
| [21](#L21) | class WPGlobus\_Translate\_Options { |
| [22](#L22) |  |
| [23](#L23) | /\*\* |
| [24](#L24) | \* All options page. |
| [25](#L25) | \*/ |
| [26](#L26) | const TRANSLATE\_OPTIONS\_PAGE = 'wpglobus-translate-options'; |
| [27](#L27) |  |
| [28](#L28) | /\*\* |
| [29](#L29) | \* Theme page. |
| [30](#L30) | \*/ |
| [31](#L31) | const THEME\_PAGE = 'wpglobus-translate-options-theme'; |
| [32](#L32) |  |
| [33](#L33) | /\*\* |
| [34](#L34) | \* WPGlobus Translate Options about page. |
| [35](#L35) | \*/ |
| [36](#L36) | const ABOUT\_PAGE = 'wpglobus-translate-options-about'; |
| [37](#L37) |  |
| [38](#L38) | /\*\* |
| [39](#L39) | \* WPGlobus Translate Options settings page. |
| [40](#L40) | \*/ |
| [41](#L41) | const SETTINGS\_PAGE = 'wpglobus-translate-options-settings'; |
| [42](#L42) |  |
| [43](#L43) | /\*\* |
| [44](#L44) | \* WPGlobus Translate Options new interface page. |
| [45](#L45) | \* @since 2.0.0 |
| [46](#L46) | \*/ |
| [47](#L47) | const NEW\_INTERFACE\_PAGE = 'wpglobus-to-new-interface'; |
| [48](#L48) |  |
| [49](#L49) | /\*\* |
| [50](#L50) | \* WPGlobus Translate Options options key. |
| [51](#L51) | \*/ |
| [52](#L52) | const TRANSLATE\_OPTIONS\_KEY = WPGLOBUS\_TRANSLATE\_OPTIONS\_KEY; |
| [53](#L53) |  |
| [54](#L54) | /\*\* |
| [55](#L55) | \* @var bool $\_SCRIPT\_DEBUG Internal representation of the define('SCRIPT\_DEBUG') |
| [56](#L56) | \*/ |
| [57](#L57) | protected static $\_SCRIPT\_DEBUG = false; |
| [58](#L58) |  |
| [59](#L59) | /\*\* |
| [60](#L60) | \* @var string $\_SCRIPT\_SUFFIX Whether to use minimized or full versions of JS and CSS. |
| [61](#L61) | \*/ |
| [62](#L62) | protected static $\_SCRIPT\_SUFFIX = '.min'; |
| [63](#L63) |  |
| [64](#L64) | /\*\* |
| [65](#L65) | \* @var array of plugin options. |
| [66](#L66) | \*/ |
| [67](#L67) | var $options = array(); |
| [68](#L68) |  |
| [69](#L69) | /\*\* |
| [70](#L70) | \* @var array of disabled for loading options. |
| [71](#L71) | \* @see options.txt file |
| [72](#L72) | \*/ |
| [73](#L73) | var $disabled\_options = array(); |
| [74](#L74) |  |
| [75](#L75) | /\*\* |
| [76](#L76) | \* @var array of disabled for loading masks, may be updated by user |
| [77](#L77) | \* @see masks.txt file |
| [78](#L78) | \*/ |
| [79](#L79) | var $disabled\_masks = array(); |
| [80](#L80) |  |
| [81](#L81) | /\*\* |
| [82](#L82) | \* @var array of option keys, in v.1.0.0 use $keys[0] only |
| [83](#L83) | \*/ |
| [84](#L84) | var $keys = array(); |
| [85](#L85) |  |
| [86](#L86) | /\*\* |
| [87](#L87) | \* @var string from multidimensional array assembled by + sign |
| [88](#L88) | \*/ |
| [89](#L89) | var $order = ''; |
| [90](#L90) |  |
| [91](#L91) | /\*\* |
| [92](#L92) | \* Tab ID for WPGlobus admin central page. |
| [93](#L93) | \*/ |
| [94](#L94) | protected static $central\_tab\_id = 'tab-translate-options'; |
| [95](#L95) |  |
| [96](#L96) | /\*\* |
| [97](#L97) | \* Constructor. |
| [98](#L98) | \*/ |
| [99](#L99) | function \_\_construct( $args = false ) { |
| [100](#L100) |  |
| [101](#L101) | if ( defined( 'SCRIPT\_DEBUG' ) && SCRIPT\_DEBUG ) { |
| [102](#L102) | self::$\_SCRIPT\_DEBUG  = true; |
| [103](#L103) | self::$\_SCRIPT\_SUFFIX = ''; |
| [104](#L104) | } |
| [105](#L105) |  |
| [106](#L106) | $\_opts = get\_option( self::TRANSLATE\_OPTIONS\_KEY ); |
| [107](#L107) |  |
| [108](#L108) | if ( is\_array($\_opts) ) { |
| [109](#L109) | $this->options = $\_opts; |
| [110](#L110) | unset($\_opts); |
| [111](#L111) | } else if ( empty($\_opts) || is\_string($\_opts) ) { |
| [112](#L112) | update\_option( self::TRANSLATE\_OPTIONS\_KEY, array() ); |
| [113](#L113) | $this->options = array(); |
| [114](#L114) | } |
| [115](#L115) |  |
| [116](#L116) | if ( is\_admin() ) { |
| [117](#L117) |  |
| [118](#L118) | add\_action( 'admin\_menu', array( |
| [119](#L119) | $this, |
| [120](#L120) | 'on\_admin\_menu' |
| [121](#L121) | ) ); |
| [122](#L122) |  |
| [123](#L123) | add\_action( 'admin\_print\_styles', array( |
| [124](#L124) | $this, |
| [125](#L125) | 'on\_admin\_styles' |
| [126](#L126) | ) ); |
| [127](#L127) |  |
| [128](#L128) | add\_action( 'admin\_print\_scripts', array( |
| [129](#L129) | $this, |
| [130](#L130) | 'on\_admin\_scripts' |
| [131](#L131) | ) ); |
| [132](#L132) |  |
| [133](#L133) | if ( ! empty( $args['plugin\_file'] ) ) { |
| [134](#L134) | add\_filter( 'plugin\_action\_links\_' . plugin\_basename( $args['plugin\_file'] ), array( |
| [135](#L135) | $this, |
| [136](#L136) | 'filter\_\_plugin\_action\_links' |
| [137](#L137) | ) ); |
| [138](#L138) | } |
| [139](#L139) |  |
| [140](#L140) | global $pagenow; |
| [141](#L141) | if ( 'customize.php' === $pagenow ) { |
| [142](#L142) |  |
| [143](#L143) | //if ( version\_compare( $wp\_version, '4.5.0', '<=' ) ) { |
| [144](#L144) | require\_once 'customize-options-wp44.php'; |
| [145](#L145) | WPGlobus\_TO\_Customize\_Options::controller( self::TRANSLATE\_OPTIONS\_PAGE ); |
| [146](#L146) | //} else { |
| [147](#L147) | //require\_once 'includes/customize-options-wp45.php'; |
| [148](#L148) | //} |
| [149](#L149) |  |
| [150](#L150) | } |
| [151](#L151) |  |
| [152](#L152) | } else { |
| [153](#L153) |  |
| [154](#L154) | /\*\* |
| [155](#L155) | \* @scope front. |
| [156](#L156) | \*/ |
| [157](#L157) | if ( ! empty($this->options['wpglobus\_translate\_options']) && is\_array( $this->options['wpglobus\_translate\_options'] ) ) : |
| [158](#L158) |  |
| [159](#L159) | foreach ( $this->options['wpglobus\_translate\_options'] as $option ) { |
| [160](#L160) | $keys = explode('+', $option ); |
| [161](#L161) |  |
| [162](#L162) | $this->keys[] = $keys; |
| [163](#L163) |  |
| [164](#L164) | add\_filter( 'option\_' . $keys[0], array( |
| [165](#L165) | $this, |
| [166](#L166) | 'filter\_\_translate\_option' |
| [167](#L167) | ) ); |
| [168](#L168) | } |
| [169](#L169) |  |
| [170](#L170) | endif; |
| [171](#L171) |  |
| [172](#L172) | if ( class\_exists('Cookie\_Notice') && defined('WPGLOBUS\_TRANSLATE\_OPTIONS\_COOKIE\_NOTICE') && WPGLOBUS\_TRANSLATE\_OPTIONS\_COOKIE\_NOTICE ) { |
| [173](#L173) | /\*\* |
| [174](#L174) | \* @see https://wordpress.org/plugins/cookie-notice/ |
| [175](#L175) | \*/ |
| [176](#L176) | add\_filter('cn\_cookie\_notice\_args', array($this, 'filter\_\_translate\_option') ); |
| [177](#L177) | } |
| [178](#L178) |  |
| [179](#L179) | } |
| [180](#L180) | } |
| [181](#L181) |  |
| [182](#L182) | /\*\* |
| [183](#L183) | \* Add a link to the settings page to the plugins list. |
| [184](#L184) | \* @since 1.4.1 |
| [185](#L185) | \* |
| [186](#L186) | \* @param array $links array of links for the plugins, adapted when the current plugin is found. |
| [187](#L187) | \* |
| [188](#L188) | \* @return array $links |
| [189](#L189) | \*/ |
| [190](#L190) | function filter\_\_plugin\_action\_links( $links ) { |
| [191](#L191) | $settings\_link = '<a class="" href="' . esc\_url( admin\_url( 'admin.php?page=' . self::TRANSLATE\_OPTIONS\_PAGE ) ) . '">' . esc\_html\_\_( 'Options' ) . '</a>'; |
| [192](#L192) | array\_unshift( $links, $settings\_link ); |
| [193](#L193) | return $links; |
| [194](#L194) | } |
| [195](#L195) |  |
| [196](#L196) | /\*\* |
| [197](#L197) | \* Extract strings of current language. |
| [198](#L198) | \* |
| [199](#L199) | \* @since 1.4.5 |
| [200](#L200) | \* |
| [201](#L201) | \* @param  array|string $options array or string to extract. |
| [202](#L202) | \* @return array|string |
| [203](#L203) | \*/ |
| [204](#L204) | public function \_translate( $options ) { |
| [205](#L205) |  |
| [206](#L206) | if ( is\_array($options) ) { |
| [207](#L207) |  |
| [208](#L208) | foreach( $options as $key=>$value ) { |
| [209](#L209) |  |
| [210](#L210) | if ( empty( $value ) ) { |
| [211](#L211) | continue; |
| [212](#L212) | } |
| [213](#L213) |  |
| [214](#L214) | /\*\* |
| [215](#L215) | \* exclude from translation the objects. |
| [216](#L216) | \*/ |
| [217](#L217) | if ( is\_object( $value ) ) { |
| [218](#L218) | continue; |
| [219](#L219) | } |
| [220](#L220) |  |
| [221](#L221) | if ( is\_array($value) ) { |
| [222](#L222) | $options[$key] = $this->\_translate( $value ); |
| [223](#L223) | } else { |
| [224](#L224) | if ( WPGlobus\_Core::has\_translations( $value ) ) { |
| [225](#L225) | if ( defined('WPGLOBUS\_TRANSLATE\_OPTIONS\_USE\_TEXT\_FILTER') && WPGLOBUS\_TRANSLATE\_OPTIONS\_USE\_TEXT\_FILTER ) { |
| [226](#L226) | $options[$key] = WPGlobus\_Core::text\_filter( $value, WPGlobus::Config()->language ); |
| [227](#L227) | } else { |
| [228](#L228) | $options[$key] = WPGlobus\_Core::extract\_text( $value, WPGlobus::Config()->language ); |
| [229](#L229) | } |
| [230](#L230) | } |
| [231](#L231) | } |
| [232](#L232) |  |
| [233](#L233) | /\*\* @todo for next versions with translation individual fields \*/ |
| [234](#L234) | /\* |
| [235](#L235) | if ( !empty($translating\_keys) && in\_array($key, $translating\_keys) ) { |
| [236](#L236) | $options[$key] = WPGlobus\_Core::text\_filter($value, WPGlobus::Config()->language); |
| [237](#L237) | } |
| [238](#L238) | \*/ |
| [239](#L239) |  |
| [240](#L240) | } |
| [241](#L241) |  |
| [242](#L242) | } elseif ( is\_string($options) ) { |
| [243](#L243) | if ( WPGlobus\_Core::has\_translations( $options ) ) { |
| [244](#L244) | if ( defined('WPGLOBUS\_TRANSLATE\_OPTIONS\_USE\_TEXT\_FILTER') && WPGLOBUS\_TRANSLATE\_OPTIONS\_USE\_TEXT\_FILTER ) { |
| [245](#L245) | $options = WPGlobus\_Core::text\_filter( $options, WPGlobus::Config()->language ); |
| [246](#L246) | } else { |
| [247](#L247) | $options = WPGlobus\_Core::extract\_text( $options, WPGlobus::Config()->language ); |
| [248](#L248) | } |
| [249](#L249) | } |
| [250](#L250) | } |
| [251](#L251) |  |
| [252](#L252) | return $options; |
| [253](#L253) | } |
| [254](#L254) |  |
| [255](#L255) | /\*\* |
| [256](#L256) | \* Filter the value of an option. |
| [257](#L257) | \* @see filter 'option\_' . $option in \wp-includes\option.php |
| [258](#L258) | \* |
| [259](#L259) | \* @since 1.0.0 |
| [260](#L260) | \* |
| [261](#L261) | \* @param mixed $options Value of the option. |
| [262](#L262) | \* @return mixed |
| [263](#L263) | \*/ |
| [264](#L264) | public function filter\_\_translate\_option( $options ) { |
| [265](#L265) |  |
| [266](#L266) | if ( is\_admin() || is\_object($options) ) { |
| [267](#L267) | return $options; |
| [268](#L268) | } |
| [269](#L269) |  |
| [270](#L270) | /\*\* @todo for next versions with translation individual fields \*/ |
| [271](#L271) | /\*\* |
| [272](#L272) | $translating\_keys = array(); |
| [273](#L273) |  |
| [274](#L274) | foreach( $this->keys as $opt=>$keys ) { |
| [275](#L275) |  |
| [276](#L276) | $value = $options; |
| [277](#L277) | $k = 0; |
| [278](#L278) | for( $i=1; $i < count($keys); $i++ ) { |
| [279](#L279) |  |
| [280](#L280) | if ( isset($keys[$i]) ) { |
| [281](#L281) |  |
| [282](#L282) | $value = $value[$keys[$i]]; |
| [283](#L283) | $k = $i; |
| [284](#L284) | } |
| [285](#L285) |  |
| [286](#L286) | } |
| [287](#L287) |  |
| [288](#L288) | if ( $k > 0 && ! is\_array($keys[$k]) ) { |
| [289](#L289) | $translating\_keys[] = $keys[$k]; |
| [290](#L290) | } |
| [291](#L291) |  |
| [292](#L292) | }       \*/ |
| [293](#L293) |  |
| [294](#L294) | $options = $this->\_translate( $options ); |
| [295](#L295) |  |
| [296](#L296) | return $options; |
| [297](#L297) |  |
| [298](#L298) | } |
| [299](#L299) |  |
| [300](#L300) | /\*\* |
| [301](#L301) | \* Check disabled option |
| [302](#L302) | \* |
| [303](#L303) | \* @since 1.0.0 |
| [304](#L304) | \* |
| [305](#L305) | \* @param string $option |
| [306](#L306) | \* @return boolean |
| [307](#L307) | \*/ |
| [308](#L308) | function check\_masks($option) { |
| [309](#L309) |  |
| [310](#L310) | foreach($this->disabled\_masks as $mask) { |
| [311](#L311) | if ( empty($mask) ) { |
| [312](#L312) | continue; |
| [313](#L313) | } |
| [314](#L314) | if ( 0 === strpos($option, $mask) ) { |
| [315](#L315) | return true; |
| [316](#L316) | } |
| [317](#L317) |  |
| [318](#L318) | } |
| [319](#L319) |  |
| [320](#L320) | return false; |
| [321](#L321) |  |
| [322](#L322) | } |
| [323](#L323) |  |
| [324](#L324) | /\*\* |
| [325](#L325) | \* Add hidden submenu |
| [326](#L326) | \* |
| [327](#L327) | \* @since 1.0.0 |
| [328](#L328) | \* @return void |
| [329](#L329) | \*/ |
| [330](#L330) | function on\_admin\_menu() { |
| [331](#L331) |  |
| [332](#L332) | add\_submenu\_page( |
| [333](#L333) | null, |
| [334](#L334) | '', |
| [335](#L335) | '', |
| [336](#L336) | 'administrator', |
| [337](#L337) | self::TRANSLATE\_OPTIONS\_PAGE, |
| [338](#L338) | array( |
| [339](#L339) | $this, |
| [340](#L340) | 'on\_\_translate\_options\_page' |
| [341](#L341) | ) |
| [342](#L342) | ); |
| [343](#L343) |  |
| [344](#L344) | add\_submenu\_page( |
| [345](#L345) | null, |
| [346](#L346) | '', |
| [347](#L347) | '', |
| [348](#L348) | 'administrator', |
| [349](#L349) | self::THEME\_PAGE, |
| [350](#L350) | array( |
| [351](#L351) | $this, |
| [352](#L352) | 'on\_\_translate\_options\_page' |
| [353](#L353) | ) |
| [354](#L354) | ); |
| [355](#L355) |  |
| [356](#L356) | add\_submenu\_page( |
| [357](#L357) | null, |
| [358](#L358) | '', |
| [359](#L359) | '', |
| [360](#L360) | 'administrator', |
| [361](#L361) | self::SETTINGS\_PAGE, |
| [362](#L362) | array( |
| [363](#L363) | $this, |
| [364](#L364) | 'on\_\_translate\_options\_page' |
| [365](#L365) | ) |
| [366](#L366) | ); |
| [367](#L367) |  |
| [368](#L368) | add\_submenu\_page( |
| [369](#L369) | null, |
| [370](#L370) | '', |
| [371](#L371) | '', |
| [372](#L372) | 'administrator', |
| [373](#L373) | self::ABOUT\_PAGE, |
| [374](#L374) | array( |
| [375](#L375) | $this, |
| [376](#L376) | 'on\_\_translate\_options\_page' |
| [377](#L377) | ) |
| [378](#L378) | ); |
| [379](#L379) |  |
| [380](#L380) | } |
| [381](#L381) |  |
| [382](#L382) | /\*\* |
| [383](#L383) | \* Output options page |
| [384](#L384) | \* |
| [385](#L385) | \* @since 1.0.0 |
| [386](#L386) | \* @return void |
| [387](#L387) | \*/ |
| [388](#L388) | function on\_\_translate\_options\_page() { |
| [389](#L389) |  |
| [390](#L390) | /\*\* @global string $pagenow \*/ |
| [391](#L391) | global $pagenow; |
| [392](#L392) |  |
| [393](#L393) | /\*\* @global wpdb $wpdb \*/ |
| [394](#L394) | global $wpdb; |
| [395](#L395) |  |
| [396](#L396) | /\*\* @todo These two vars are set inside a condition. Should refactor. \*/ |
| [397](#L397) | $page = ''; |
| [398](#L398) | // @since 2.2.0 |
| [399](#L399) | $option = $this->safe\_get\_option(); |
| [400](#L400) |  |
| [401](#L401) | $tab\_active = array(); |
| [402](#L402) | $tab\_active[self::TRANSLATE\_OPTIONS\_PAGE] = ''; |
| [403](#L403) | $tab\_active[self::THEME\_PAGE]                     = ''; |
| [404](#L404) | $tab\_active[self::SETTINGS\_PAGE]                  = ''; |
| [405](#L405) | $tab\_active[self::ABOUT\_PAGE]                     = ''; |
| [406](#L406) | $tab\_active[self::NEW\_INTERFACE\_PAGE]     = ''; |
| [407](#L407) |  |
| [408](#L408) | if ( $pagenow == 'admin.php' && isset($\_GET['page']) ) : |
| [409](#L409) |  |
| [410](#L410) | $page = WPGlobus\_Utils::safe\_get('page'); |
| [411](#L411) |  |
| [412](#L412) | if ( self::TRANSLATE\_OPTIONS\_PAGE === $page  ) { |
| [413](#L413) |  |
| [414](#L414) | $tab\_active[self::TRANSLATE\_OPTIONS\_PAGE] = ' nav-tab-active'; |
| [415](#L415) |  |
| [416](#L416) | } elseif ( self::SETTINGS\_PAGE === $page  ) { |
| [417](#L417) |  |
| [418](#L418) | $tab\_active[self::SETTINGS\_PAGE] = ' nav-tab-active'; |
| [419](#L419) |  |
| [420](#L420) | } elseif ( self::ABOUT\_PAGE === $page  ) { |
| [421](#L421) |  |
| [422](#L422) | $tab\_active[self::ABOUT\_PAGE] = ' nav-tab-active'; |
| [423](#L423) |  |
| [424](#L424) | } elseif ( self::THEME\_PAGE === $page  ) { |
| [425](#L425) |  |
| [426](#L426) | $tab\_active[self::THEME\_PAGE] = ' nav-tab-active'; |
| [427](#L427) |  |
| [428](#L428) | } |
| [429](#L429) |  |
| [430](#L430) | endif; |
| [431](#L431) |  |
| [432](#L432) | if ( isset( $\_POST['wpglobus\_translate\_form'] ) ) { |
| [433](#L433) |  |
| [434](#L434) | $opts = str\_replace(array("\r"), '', $\_POST['wpglobus\_translate\_options']); |
| [435](#L435) | $opts = explode( "\n", $opts ); |
| [436](#L436) |  |
| [437](#L437) | $this->options['wpglobus\_translate\_options'] = $opts; |
| [438](#L438) | update\_option(self::TRANSLATE\_OPTIONS\_KEY, $this->options); |
| [439](#L439) |  |
| [440](#L440) | } |
| [441](#L441) |  |
| [442](#L442) | if ( isset( $\_POST['wpglobus\_settings\_form'] ) ) { |
| [443](#L443) |  |
| [444](#L444) | $opts = str\_replace(array("\r"), '', $\_POST['disabled\_masks']); |
| [445](#L445) | $opts = explode( "\n", $opts ); |
| [446](#L446) |  |
| [447](#L447) | $this->options['wpglobus\_disabled\_masks'] = $opts; |
| [448](#L448) | update\_option(self::TRANSLATE\_OPTIONS\_KEY, $this->options); |
| [449](#L449) |  |
| [450](#L450) | } |
| [451](#L451) |  |
| [452](#L452) | if ( !isset($this->options['wpglobus\_disabled\_masks']) ) { |
| [453](#L453) |  |
| [454](#L454) | $filename = plugin\_dir\_path( \_\_FILE\_\_ ) . 'masks.txt'; |
| [455](#L455) | if ( file\_exists($filename) ) { |
| [456](#L456) | $data = file($filename); |
| [457](#L457) | if ( false !== $data ) { |
| [458](#L458) | $r = implode( ',', $data ); |
| [459](#L459) | $r = str\_replace(array("\r", "\n"), '', $r); |
| [460](#L460) | $this->disabled\_masks = explode(',', $r); |
| [461](#L461) | } |
| [462](#L462) | } |
| [463](#L463) |  |
| [464](#L464) | } else { |
| [465](#L465) |  |
| [466](#L466) | $this->disabled\_masks = $this->options['wpglobus\_disabled\_masks']; |
| [467](#L467) |  |
| [468](#L468) | }; |
| [469](#L469) |  |
| [470](#L470) | $\_caption = esc\_html\_\_( 'WPGlobus Translate Options', '' ) . ': v.' . WPGLOBUS\_TRANSLATE\_OPTIONS\_VERSION; |
| [471](#L471) | ?> |
| [472](#L472) | <div class="wrap"> |
| [473](#L473) | <h2><?php |
| [474](#L474) | /\*\* |
| [475](#L475) | \* @quirk |
| [476](#L476) | \* This should be H2, so that it goes above the WP admin notices |
| [477](#L477) | \*/ |
| [478](#L478) | echo $\_caption; |
| [479](#L479) | ?></h2> |
| [480](#L480) |  |
| [481](#L481) |  |
| [482](#L482) | <div class="wrap translate\_options-wrap"> |
| [483](#L483) |  |
| [484](#L484) | <h2 class="nav-tab-wrapper"> |
| [485](#L485) | <a href="admin.php?page=<?php echo self::TRANSLATE\_OPTIONS\_PAGE; ?>" class="nav-tab<?php echo $tab\_active[self::TRANSLATE\_OPTIONS\_PAGE]; ?>"> |
| [486](#L486) | <?php \_e( 'All options' ); ?> |
| [487](#L487) | </a><a href="admin.php?page=<?php echo self::THEME\_PAGE; ?>" class="nav-tab<?php echo $tab\_active[self::THEME\_PAGE]; ?>"> |
| [488](#L488) | <?php \_e( 'Theme properties' ); ?> |
| [489](#L489) | </a><a href="admin.php?page=<?php echo self::SETTINGS\_PAGE; ?>" class="nav-tab<?php echo $tab\_active[self::SETTINGS\_PAGE]; ?>"> |
| [490](#L490) | <?php \_e( 'Settings' ); ?> |
| [491](#L491) | </a><a href="admin.php?page=<?php echo self::ABOUT\_PAGE; ?>" class="nav-tab<?php echo $tab\_active[self::ABOUT\_PAGE]; ?>"> |
| [492](#L492) | <?php \_e( 'About', '' ); ?> |
| [493](#L493) | </a><a href="admin.php?page=<?php echo self::TRANSLATE\_OPTIONS\_PAGE; ?>&action=new-interface" class="nav-tab<?php echo $tab\_active[self::NEW\_INTERFACE\_PAGE]; ?>"> |
| [494](#L494) | <?php \_e( 'Switch to new interface v.2', '' ); ?> |
| [495](#L495) | </a> |
| [496](#L496) | </h2> |
| [497](#L497) |  |
| [498](#L498) | <?php |
| [499](#L499) |  |
| [500](#L500) | switch( $page ) : |
| [501](#L501) | case self::THEME\_PAGE : |
| [502](#L502) | include\_once( plugin\_dir\_path( \_\_FILE\_\_ ) . 'templates/page-theme.php' ); |
| [503](#L503) | // <!-- self::THEME\_PAGE --> |
| [504](#L504) | break; |
| [505](#L505) | case self::TRANSLATE\_OPTIONS\_PAGE :     ?> |
| [506](#L506) | <?php |
| [507](#L507) | if ( ! $option ) : |
| [508](#L508) | ?> |
| [509](#L509) | <div class="search"> |
| [510](#L510) | <?php |
| [511](#L511) | $parent\_theme    = ''; |
| [512](#L512) | $theme                   = wp\_get\_theme(); |
| [513](#L513) | $parent\_template = $theme->get('Template'); |
| [514](#L514) | if ( ! empty( $parent\_template ) ) { |
| [515](#L515) | $parent\_theme = wp\_get\_theme( get\_template() ); |
| [516](#L516) | $parent\_theme\_caption = 'Parent theme'; |
| [517](#L517) | }       ?> |
| [518](#L518) | <p>Current theme: <b><?php echo $theme->Name; ?></b></p> |
| [519](#L519) | <p>Current theme's options: <b><?php echo 'theme\_mods\_' . get\_stylesheet(); ?></b></p>  <?php |
| [520](#L520) | if ( ! empty( $parent\_theme ) ) {       ?> |
| [521](#L521) | <p>Parent theme: <b><?php echo $parent\_theme->Name; ?></b></p> |
| [522](#L522) | <p>Parent theme's options: <b><?php echo 'theme\_mods\_' . get\_template(); ?></b></p>     <?php |
| [523](#L523) | }       ?> |
| [524](#L524) | </div> |
| [525](#L525) | <?php |
| [526](#L526) | endif; |
| [527](#L527) |  |
| [528](#L528) | ?> |
| [529](#L529) | <form method="post" id="options"> <?php |
| [530](#L530) | // @since 2.2.0 |
| [531](#L531) | $search = false; |
| [532](#L532) | if ( ! empty( $\_POST['search'] ) ) { |
| [533](#L533) |  |
| [534](#L534) | $search = sanitize\_text\_field( $\_POST['search'] ); |
| [535](#L535) |  |
| [536](#L536) | if ( ! empty($search) ) { |
| [537](#L537) | $option = '[]'; |
| [538](#L538) | } |
| [539](#L539) | } |
| [540](#L540) |  |
| [541](#L541) | if ( $option ) { |
| [542](#L542) |  |
| [543](#L543) | $show\_source = false; |
| [544](#L544) | if ( isset( $\_GET['source'] ) && 'true' == $\_GET['source'] ) { |
| [545](#L545) | $show\_source = true; |
| [546](#L546) | } |
| [547](#L547) |  |
| [548](#L548) | $option\_names = array(); |
| [549](#L549) | if ( $search ) { |
| [550](#L550) |  |
| [551](#L551) | $show\_source = true; |
| [552](#L552) | $results = $wpdb->get\_results( |
| [553](#L553) | "SELECT option\_name FROM $wpdb->options WHERE option\_value LIKE '%$search%' AND option\_name NOT LIKE '\_%transient%' ORDER BY option\_name ASC" ); |
| [554](#L554) |  |
| [555](#L555) | foreach( $results as $opt\_obj ) { |
| [556](#L556) | $option\_names[] = $opt\_obj->option\_name; |
| [557](#L557) | } |
| [558](#L558) |  |
| [559](#L559) | } else { |
| [560](#L560) | $option\_names[] = $option; |
| [561](#L561) | } |
| [562](#L562) |  |
| [563](#L563) | if ( empty($option\_names) ) : ?> |
| [564](#L564) | <h4>Not found</h4> <?php |
| [565](#L565) | else : |
| [566](#L566) | foreach( $option\_names as $option ) : |
| [567](#L567) | ?> |
| [568](#L568) |  |
| [569](#L569) | <h3><a href="#" class="wpglobus-translate" title="Click to add to the translation list" data-source="<?php echo $option; ?>"><?php echo $option; ?><span></span></a></h3> |
| [570](#L570) | <?php |
| [571](#L571) | if ( $show\_source ) { ?> |
| [572](#L572) | <h4><a href="?page=<?php echo self::TRANSLATE\_OPTIONS\_PAGE . '&option=' . $option; ?>">back</a></h4>    <?php |
| [573](#L573) | $data = $wpdb->get\_var("SELECT option\_value FROM $wpdb->options WHERE option\_name='$option'"); |
| [574](#L574) | } else {        ?> |
| [575](#L575) | <h4><a href="?page=<?php echo self::TRANSLATE\_OPTIONS\_PAGE . '&option=' . $option . '&source=true'; ?>">source</a></h4> <?php |
| [576](#L576) | $data = get\_option( $option ); |
| [577](#L577) | } |
| [578](#L578) | ?> |
| [579](#L579) | <table class="" style="width:100%"> |
| [580](#L580) | <tbody><tr> |
| [581](#L581) | <td style="width:70%;"> |
| [582](#L582) | <?php |
| [583](#L583) | if ( $show\_source ) { |
| [584](#L584) |  |
| [585](#L585) | if ( $search ) { |
| [586](#L586) | $data = preg\_split( '/'.$search.'/ui', $data ); |
| [587](#L587) | $output = $data[0]; |
| [588](#L588) | } else { |
| [589](#L589) | $output = $data; |
| [590](#L590) | } |
| [591](#L591) | if ( sizeof($data) == 1 ) { ?> |
| [592](#L592) | <div class="textarea"><pre><?php echo htmlspecialchars($output); ?></pre></div> <?php |
| [593](#L593) | } else { ?> |
| [594](#L594) | <div class="textarea"> <?php |
| [595](#L595) | for( $i=0; $i < sizeof($data); $i++ ) { ?> |
| [596](#L596) | <pre style="margin-bottom:0;"><?php echo htmlspecialchars($data[$i]); ?></pre> <?php |
| [597](#L597) | if ( ! empty( $data[$i+1] ) ) { ?> |
| [598](#L598) | <span style="background-color:#0f0;"><?php echo $search; ?></span> |
| [599](#L599) | <pre style="margin-top:0;"><?php echo htmlspecialchars($data[$i+1]); ?></pre>   <?php |
| [600](#L600) | } |
| [601](#L601) | $i++; |
| [602](#L602) | }       ?> |
| [603](#L603) | </div>  <?php |
| [604](#L604) | } |
| [605](#L605) |  |
| [606](#L606) | } else { |
| [607](#L607) | if ( $data ) { |
| [608](#L608) | if ( is\_array($data) || is\_object($data) ) { |
| [609](#L609) | foreach ($data as $key=>$items) : |
| [610](#L610) | echo $this->get\_item($key, $items, $option); |
| [611](#L611) | endforeach; |
| [612](#L612) | } else { |
| [613](#L613) | echo $this->get\_item($option, $data, false); |
| [614](#L614) | } |
| [615](#L615) | } |
| [616](#L616) | } |
| [617](#L617) | ?></td> |
| [618](#L618) | <td style="vertical-align:top;width:30%;"> |
| [619](#L619) | <?php $this->get\_float\_block(); ?> |
| [620](#L620) | </td> |
| [621](#L621) | </tr> |
| [622](#L622) | </tbody> |
| [623](#L623) | </table> |
| [624](#L624) | <?php |
| [625](#L625) | endforeach; |
| [626](#L626) | endif; |
| [627](#L627) |  |
| [628](#L628) | } else { |
| [629](#L629) |  |
| [630](#L630) | $filename = plugin\_dir\_path( \_\_FILE\_\_ ) . 'options.txt'; |
| [631](#L631) |  |
| [632](#L632) | if ( file\_exists($filename) ) { |
| [633](#L633) |  |
| [634](#L634) | $data = file($filename); |
| [635](#L635) |  |
| [636](#L636) | if ( false !== $data ) { ?> |
| [637](#L637) |  |
| [638](#L638) | <div class="search">Find text in the Options table: <input id="search" size="40" name="search" value="" /> |
| [639](#L639) | <input type="submit" value="Search" /></div> <?php |
| [640](#L640) |  |
| [641](#L641) | $r = implode( ',', $data ); |
| [642](#L642) | $r = str\_replace(array("\r", "\n"), '', $r); |
| [643](#L643) |  |
| [644](#L644) | $this->disabled\_options = explode(',', $r); |
| [645](#L645) |  |
| [646](#L646) | $options = $wpdb->get\_results( "SELECT \* FROM {$wpdb->prefix}options AS opt WHERE opt.option\_name NOT LIKE '\_%transient%' ORDER BY opt.option\_name ASC" ); |
| [647](#L647) | ?> |
| [648](#L648) | <table class="" style="width:100%"> |
| [649](#L649) | <tbody><tr> |
| [650](#L650) | <td style="width:70%;"> <?php |
| [651](#L651) |  |
| [652](#L652) | echo '<ul>'; |
| [653](#L653) | foreach( $options as $option ) { |
| [654](#L654) |  |
| [655](#L655) | if ( ! in\_array( $option->option\_name, $this->disabled\_options ) ) { |
| [656](#L656) |  |
| [657](#L657) | if ( ! $this->check\_masks($option->option\_name) ) { |
| [658](#L658) | echo '<li><a href="?page=' . self::TRANSLATE\_OPTIONS\_PAGE . '&option=' . $option->option\_name . '">' . $option->option\_name . '</a></li>'; |
| [659](#L659) | } |
| [660](#L660) |  |
| [661](#L661) | } |
| [662](#L662) |  |
| [663](#L663) | } |
| [664](#L664) | echo '</ul>'; ?> |
| [665](#L665) | </td> |
| [666](#L666) | <td style="vertical-align:top;width:30%;"> |
| [667](#L667) | <?php $this->get\_float\_block(); ?> |
| [668](#L668) | </td> |
| [669](#L669) | </tr> |
| [670](#L670) | </tbody> |
| [671](#L671) | </table> <?php |
| [672](#L672) |  |
| [673](#L673) | } |
| [674](#L674) |  |
| [675](#L675) | } |
| [676](#L676) |  |
| [677](#L677) | }       // endif $option; ?> |
| [678](#L678) |  |
| [679](#L679) | </form> <!-- #options --><?php |
| [680](#L680) |  |
| [681](#L681) | break; |
| [682](#L682) |  |
| [683](#L683) | case self::SETTINGS\_PAGE : |
| [684](#L684) |  |
| [685](#L685) | $masks = implode( "\n", $this->disabled\_masks );        ?> |
| [686](#L686) |  |
| [687](#L687) | <div class="settings-page"> |
| [688](#L688) | <form method="post"> |
| [689](#L689) | <div>Disabled masks :</div> |
| [690](#L690) | <textarea name="disabled\_masks" id="disabled\_masks" cols="80" rows="30"><?php echo $masks; ?></textarea> |
| [691](#L691) | <input type="hidden" name="wpglobus\_settings\_form" value="" /> |
| [692](#L692) | <div> |
| [693](#L693) | <input type="submit" value="Save" /> |
| [694](#L694) | </div> |
| [695](#L695) | </form> |
| [696](#L696) | </div> |
| [697](#L697) |  |
| [698](#L698) | <?php |
| [699](#L699) |  |
| [700](#L700) | break; |
| [701](#L701) |  |
| [702](#L702) | case self::ABOUT\_PAGE : |
| [703](#L703) | /\*\* |
| [704](#L704) | \* @todo Store these texts in options (self-demo) |
| [705](#L705) | \*/ |
| [706](#L706) | ?> |
| [707](#L707) | <div class="about-page" style="max-width: 30em;"> |
| [708](#L708) | <?php if ( 'ru' === WPGlobus::Config()->language ) { ?> |
| [709](#L709) | <!--@formatter:off--> |
| [710](#L710) | <p> |
| [711](#L711) | При разработке плагина WPGlobus учитывался фактор быстродействия, поэтому для разбора языковых меток были использованы всего 2 фильтра для опций 'blogdescription' и 'blogname' из таблицы 'wp\_options'.</p> |
| [712](#L712) | <p> |
| [713](#L713) | При работе возникает необходимость использовать фильтры и для других опций. Плагин WPGlobus Translate Options позволяет добавить те опции, которые нужно выводить, разобрав текст по языковым меткам.</p> |
| [714](#L714) | <p> |
| [715](#L715) | Для примера можно взять тему <a href="https://wordpress.org/themes/ample/" target="\_blank">Ample</a> из репозитория. Она имеет встроенный слайдер, в настройках которого можно добавить текст для наложения на слайды. Если затем указать опцию 'ample' в разделе Options to translate, то текст будет выведен на слайдах согласно согласно выбранному языку. |
| [716](#L716) | </p> |
| [717](#L717) | <!--@formatter:on--> |
| [718](#L718) | <?php } else { ?> |
| [719](#L719) | <!--@formatter:off--> |
| [720](#L720) | <p>In the WPGlobus core plugin, we are keeping the amount of filters as low as possible, to minimize the potential performance hit. Therefore, only two WordPress options, 'blogdescription' and 'blogname' are supported by default.</p> |
| [721](#L721) | <p>Sometimes, it is necessary to allow multiple languages in other options. For instance, the slider used in the <a href="https://wordpress.org/themes/ample/" target="\_blank">Ample</a> theme stores the textual overlays in the options table. With the WPGlobus Translate Options plugin, all you need is to add 'ample' into the Options to translate, and all the slider texts will be multilingual! |
| [722](#L722) | </p> |
| [723](#L723) | <!--@formatter:on--> |
| [724](#L724) | <?php } ?> |
| [725](#L725) | </div> |
| [726](#L726) | <?php |
| [727](#L727) | break; |
| [728](#L728) | endswitch; |
| [729](#L729) | ?> |
| [730](#L730) | </div> |
| [731](#L731) |  |
| [732](#L732) | </div>                  <?php |
| [733](#L733) |  |
| [734](#L734) | } |
| [735](#L735) |  |
| [736](#L736) | /\*\* |
| [737](#L737) | \* Output float block |
| [738](#L738) | \* |
| [739](#L739) | \* @since 1.0.0 |
| [740](#L740) | \* @return void |
| [741](#L741) | \*/ |
| [742](#L742) | function get\_float\_block() { |
| [743](#L743) |  |
| [744](#L744) | $options = ''; |
| [745](#L745) | if ( !empty($this->options['wpglobus\_translate\_options']) ) { |
| [746](#L746) | $options = implode( "\n", $this->options['wpglobus\_translate\_options'] ); |
| [747](#L747) | } |
| [748](#L748) | ?> |
| [749](#L749) |  |
| [750](#L750) | <div class="float-block"> |
| [751](#L751) | <h3>Options to translate:</h3><br /> |
| [752](#L752) | <textarea cols="40" rows="20" name="wpglobus\_translate\_options" id="wpglobus\_translate\_options"><?php echo $options; ?></textarea> |
| [753](#L753) | <br /> |
| [754](#L754) | <input type="hidden" name="wpglobus\_translate\_form" value="" /> |
| [755](#L755) | <input type="submit" value="Save" /> |
| [756](#L756) | </div>          <?php |
| [757](#L757) |  |
| [758](#L758) | } |
| [759](#L759) |  |
| [760](#L760) | /\*\* |
| [761](#L761) | \* Get item |
| [762](#L762) | \* @since 1.0.0 |
| [763](#L763) | \* |
| [764](#L764) | \* @param string $key |
| [765](#L765) | \* @param string|array|object $items // TODO this is a code smell |
| [766](#L766) | \* @param string $option |
| [767](#L767) | \* @param string $chain |
| [768](#L768) | \* |
| [769](#L769) | \* @return string |
| [770](#L770) | \*/ |
| [771](#L771) | function get\_item($key, $items, $option='', $chain='') { |
| [772](#L772) |  |
| [773](#L773) | if ( false === $option ) { |
| [774](#L774) | // do nothing |
| [775](#L775) | } else { |
| [776](#L776) | if ( '' == $chain ) { |
| [777](#L777) | $this->order = '+' . $key; |
| [778](#L778) | $chain = $key; |
| [779](#L779) | } else { |
| [780](#L780) | $this->order = '+' .$chain . '+' . $key; |
| [781](#L781) | $chain .= '+' . $key; |
| [782](#L782) | } |
| [783](#L783) | } |
| [784](#L784) |  |
| [785](#L785) | $return  = '<ul>'; |
| [786](#L786) | $return .= '<li>'; |
| [787](#L787) | if ( is\_array($items) || is\_object($items) ) { |
| [788](#L788) | $return .= $this->convert($option . $this->order); |
| [789](#L789) | foreach ($items as $k=>$v) { |
| [790](#L790) | $return .= $this->get\_item($k, $v, $option, $chain); |
| [791](#L791) | } |
| [792](#L792) | } else { |
| [793](#L793) | if ( empty($items) )  { |
| [794](#L794) | $items = '<textarea readonly cols="100"></textarea>'; |
| [795](#L795) | } else { |
| [796](#L796) | $items = '<textarea readonly cols="100">' . $items . '</textarea>'; |
| [797](#L797) | } |
| [798](#L798) | if ( false === $option ) { |
| [799](#L799) | $return .= $this->convert($key) . $items; |
| [800](#L800) | } else { |
| [801](#L801) | $return .= $this->convert($option . $this->order) . $items; |
| [802](#L802) | } |
| [803](#L803) | } |
| [804](#L804) | $return .= '</li>'; |
| [805](#L805) | $return .= '</ul>'; |
| [806](#L806) |  |
| [807](#L807) | return $return; |
| [808](#L808) | } |
| [809](#L809) |  |
| [810](#L810) | /\*\* |
| [811](#L811) | \* Convert string. |
| [812](#L812) | \* @since 1.0.0 |
| [813](#L813) | \* |
| [814](#L814) | \* @param string $str |
| [815](#L815) | \* |
| [816](#L816) | \* @return string |
| [817](#L817) | \*/ |
| [818](#L818) | function convert($str) { |
| [819](#L819) | $r = ''; |
| [820](#L820) | $arr = explode('+', $str); |
| [821](#L821) | $i = 0; |
| [822](#L822) | foreach( $arr as $v ) { |
| [823](#L823) | if ( $i == 0 ) { |
| [824](#L824) | $r  = $v; |
| [825](#L825) | } else { |
| [826](#L826) | $r .= '[' . $v . ']'; |
| [827](#L827) | } |
| [828](#L828) | $i++; |
| [829](#L829) | } |
| [830](#L830) | return '<div style="vertical-align:top;">&nbsp;&nbsp;&nbsp;<strong>' . $r . '</strong></div>'; |
| [831](#L831) | } |
| [832](#L832) |  |
| [833](#L833) |  |
| [834](#L834) | /\*\* |
| [835](#L835) | \* Enqueue admin styles. |
| [836](#L836) | \* |
| [837](#L837) | \* @since 1.0.0 |
| [838](#L838) | \* @since 1.4.4 |
| [839](#L839) | \* @return void |
| [840](#L840) | \*/ |
| [841](#L841) | function on\_admin\_styles() { |
| [842](#L842) |  |
| [843](#L843) | /\*\* @global string $pagenow \*/ |
| [844](#L844) | global $pagenow; |
| [845](#L845) |  |
| [846](#L846) | if ( $pagenow == 'admin.php' |
| [847](#L847) | && isset($\_GET['page']) |
| [848](#L848) | && in\_array( $\_GET['page'], array(self::TRANSLATE\_OPTIONS\_PAGE, self::SETTINGS\_PAGE) ) ) : |
| [849](#L849) |  |
| [850](#L850) | wp\_register\_style( |
| [851](#L851) | 'wpglobus-translate-options', |
| [852](#L852) | plugin\_dir\_url( \_\_FILE\_\_ ) . 'css/wpglobus-translate-options' . self::$\_SCRIPT\_SUFFIX . ".css", |
| [853](#L853) | array(), |
| [854](#L854) | WPGLOBUS\_TRANSLATE\_OPTIONS\_VERSION, |
| [855](#L855) | 'all' |
| [856](#L856) | ); |
| [857](#L857) | wp\_enqueue\_style( 'wpglobus-translate-options' ); |
| [858](#L858) |  |
| [859](#L859) | endif; |
| [860](#L860) | } |
| [861](#L861) |  |
| [862](#L862) | /\*\* |
| [863](#L863) | \* Enqueue admin scripts. |
| [864](#L864) | \* |
| [865](#L865) | \* @since 1.0.0 |
| [866](#L866) | \* @since 1.4.4 |
| [867](#L867) | \* @return void |
| [868](#L868) | \*/ |
| [869](#L869) | function on\_admin\_scripts() { |
| [870](#L870) |  |
| [871](#L871) | /\*\* @global string $pagenow \*/ |
| [872](#L872) | global $pagenow; |
| [873](#L873) |  |
| [874](#L874) | if ( $pagenow == 'admin.php' && isset($\_GET['page']) && self::TRANSLATE\_OPTIONS\_PAGE == $\_GET['page']  ) : |
| [875](#L875) |  |
| [876](#L876) | wp\_register\_script( |
| [877](#L877) | 'wpglobus-translate-options', |
| [878](#L878) | plugin\_dir\_url( \_\_FILE\_\_ ) . 'js/wpglobus-translate-options' . self::$\_SCRIPT\_SUFFIX . ".js", |
| [879](#L879) | array( 'jquery' ), |
| [880](#L880) | WPGLOBUS\_TRANSLATE\_OPTIONS\_VERSION, |
| [881](#L881) | true |
| [882](#L882) | ); |
| [883](#L883) | wp\_enqueue\_script( 'wpglobus-translate-options' ); |
| [884](#L884) |  |
| [885](#L885) | endif; |
| [886](#L886) | } |
| [887](#L887) |  |
| [888](#L888) | /\*\* |
| [889](#L889) | \* Get value of $\_GET['option']. |
| [890](#L890) | \* |
| [891](#L891) | \* @since 2.2.0 |
| [892](#L892) | \*/ |
| [893](#L893) | protected function safe\_get\_option() { |
| [894](#L894) | $option = WPGlobus\_Utils::safe\_get('option'); |
| [895](#L895) | if ( $option === '' ) { |
| [896](#L896) | return false; |
| [897](#L897) | } |
| [898](#L898) | return $option; |
| [899](#L899) | } |
| [900](#L900) |  |
| [901](#L901) | } |
| [902](#L902) |  |
| [903](#L903) | endif; // class WPGlobus\_Translate\_Options. |
| [904](#L904) |  |
| [905](#L905) | # --- EOF |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wpglobus-translate-options/trunk/includes/class-wpglobus-translate-options.php?format=txt)
* [Original Format](/export/3220247/wpglobus-translate-options/trunk/includes/class-wpglobus-translate-options.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

