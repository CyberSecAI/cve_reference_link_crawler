=== Content from www.wordfence.com_37ab4996_20250111_094204.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# FileOrganizer <= 1.0.7 - Sensitive Information Exposure via Directory Listing

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   FileOrganizer <= 1.0.7 - Sensitive Information Exposure via Directory Listing

7.5

**Insecure Storage of Sensitive Information**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)

| CVE | [CVE-2024-5599](https://www.cve.org/CVERecord?id=CVE-2024-5599) |
| --- | --- |
| CVSS | 7.5 (High) |
| Publicly Published | June 6, 2024 |
| Last Updated | June 7, 2024 |
| Researcher | [emad](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/emad) |

### Description

The FileOrganizer – Manage WordPress and Website Files plugin for WordPress is vulnerable to Sensitive Information Exposure in all versions up to, and including, 1.0.7 via the 'fileorganizer\_ajax\_handler' function. This makes it possible for unauthenticated attackers to extract sensitive data including backups or other sensitive information if the files have been moved to the built-in Trash folder.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/fileorganizer/trunk/main/ajax.php#L85)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3098763/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ffileorganizer%2Ffileorganizer-107-sensitive-information-exposure-via-directory-listing&t=FileOrganizer%20%3C%3D%201.0.7%20-%20Sensitive%20Information%20Exposure%20via%20Directory%20Listing "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ffileorganizer%2Ffileorganizer-107-sensitive-information-exposure-via-directory-listing&text=FileOrganizer%20%3C%3D%201.0.7%20-%20Sensitive%20Information%20Exposure%20via%20Directory%20Listing "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ffileorganizer%2Ffileorganizer-107-sensitive-information-exposure-via-directory-listing "LinkedIn")
Email

## Vulnerability Details for FileOrganizer – Manage WordPress and Website Files

#### [FileOrganizer – Manage WordPress and Website Files](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/fileorganizer)

| Software Type | Plugin |
| --- | --- |
| Software Slug | fileorganizer [(view on wordpress.org)](https://wordpress.org/plugins/fileorganizer) |
| Patched? | Yes |
| Remediation | Update to version 1.0.8, or a newer patched version |
| Affected Version | * <= 1.0.7 |
| Patched Version | * 1.0.8 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_ec3d6173_20250111_094203.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3098763)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3098762 "Changeset 3098762")
* [Next Changeset](/changeset/3098764 "Changeset 3098764") →

---

# Changeset 3098763

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
06/06/2024 02:38:38 PM
([7 months](/timeline?from=2024-06-06T14%3A38%3A38Z&precision=second "See timeline at 06/06/2024 02:38:38 PM") ago)

Author:
softaculous
Message:

New version

Location:
[fileorganizer/trunk](/browser/fileorganizer/trunk?rev=3098763)
Files:

7 edited

* [fileorganizer.php](/browser/fileorganizer/trunk/fileorganizer.php?rev=3098763 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [init.php](/browser/fileorganizer/trunk/init.php?rev=3098763 "Show entry in browser")
  (modified)
  ([6 diffs](#file1 "Show differences"))
* [main/ajax.php](/browser/fileorganizer/trunk/main/ajax.php?rev=3098763 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))
* [main/fileorganizer.php](/browser/fileorganizer/trunk/main/fileorganizer.php?rev=3098763 "Show entry in browser")
  (modified)
  ([5 diffs](#file3 "Show differences"))
* [main/promo.php](/browser/fileorganizer/trunk/main/promo.php?rev=3098763 "Show entry in browser")
  (modified)
  ([2 diffs](#file4 "Show differences"))
* [main/settings.php](/browser/fileorganizer/trunk/main/settings.php?rev=3098763 "Show entry in browser")
  (modified)
  ([19 diffs](#file5 "Show differences"))
* [readme.txt](/browser/fileorganizer/trunk/readme.txt?rev=3098763 "Show entry in browser")
  (modified)
  ([2 diffs](#file6 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [fileorganizer/trunk/fileorganizer.php](/changeset/3098763/fileorganizer/trunk/fileorganizer.php "Show the changeset 3098763 restricted to fileorganizer/trunk/fileorganizer.php")

  | [r3069064](/browser/fileorganizer/trunk/fileorganizer.php?rev=3069064#L4 "Show revision 3069064 of this file in browser") | [r3098763](/browser/fileorganizer/trunk/fileorganizer.php?rev=3098763#L4 "Show revision 3098763 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Plugin URI: https://wordpress.org/plugins/fileorganizer/ |
  | 5 | 5 | Description: FileOrganizer is a plugin that helps you to manage all files in your WordPress Site. |
  | 6 |  | Version: 1.0.~~7~~ |
  |  | 6 | Version: 1.0.8 |
  | 7 | 7 | Author: Softaculous Team |
  | 8 | 8 | Author URI: https://fileorganizer.net |
* ## [fileorganizer/trunk/init.php](/changeset/3098763/fileorganizer/trunk/init.php "Show the changeset 3098763 restricted to fileorganizer/trunk/init.php")

  | [r3069064](/browser/fileorganizer/trunk/init.php?rev=3069064#L15 "Show revision 3069064 of this file in browser") | [r3098763](/browser/fileorganizer/trunk/init.php?rev=3098763#L15 "Show revision 3098763 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | define('FILEORGANIZER\_URL', plugins\_url('', FILEORGANIZER\_FILE)); |
  | 16 | 16 | define('FILEORGANIZER\_BASE\_NAME', basename(FILEORGANIZER\_DIR)); |
  | 17 |  | define('FILEORGANIZER\_VERSION', '1.0.~~7~~'); |
  |  | 17 | define('FILEORGANIZER\_VERSION', '1.0.8'); |
  | 18 | 18 | define('FILEORGANIZER\_WP\_CONTENT\_DIR', defined('WP\_CONTENT\_FOLDERNAME') ? WP\_CONTENT\_FOLDERNAME : 'wp-content'); |
  | 19 | 19 | define('FILEORGANIZER\_DEV', file\_exists(dirname(\_\_FILE\_\_).'/dev.php') ? 1 : 0); |
  | […](/browser/fileorganizer/trunk/init.php?rev=3069064#L67) | […](/browser/fileorganizer/trunk/init.php?rev=3098763#L67) |  |
  | 67 | 67 | // Looks if FileOrganizer just got updated |
  | 68 | 68 | function fileorganizer\_update\_check(){ |
  | 69 |  |  |
  |  | 69 |  |
  | 70 | 70 | $sql = array(); |
  | 71 | 71 | $current\_version = get\_option('fileorganizer\_version'); |
  | 72 | 72 | $version = (int) str\_replace('.', '', $current\_version); |
  | 73 |  |  |
  |  | 73 |  |
  | 74 | 74 | // No update required |
  | 75 | 75 | if($current\_version == FILEORGANIZER\_VERSION){ |
  | 76 | 76 | return true; |
  | 77 | 77 | } |
  | 78 |  |  |
  |  | 78 |  |
  | 79 | 79 | // Is it first run ? |
  | 80 | 80 | if(empty($current\_version)){ |
  | 81 |  |  |
  |  | 81 |  |
  | 82 | 82 | // Reinstall |
  | 83 | 83 | fileorganizer\_activation(); |
  | […](/browser/fileorganizer/trunk/init.php?rev=3069064#L85) | […](/browser/fileorganizer/trunk/init.php?rev=3098763#L85) |  |
  | 85 | 85 | // Trick the following if conditions to not run |
  | 86 | 86 | $version = (int) str\_replace('.', '', FILEORGANIZER\_VERSION); |
  | 87 |  |  |
  | 88 |  | } |
  | 89 |  |  |
  |  | 87 |  |
  |  | 88 | } |
  |  | 89 |  |
  |  | 90 | // Adding index.php to trash folder, if it already exists. |
  |  | 91 | if(version\_compare($current\_version, '1.0.7', '<=')){ |
  |  | 92 | $uploads\_dir = wp\_upload\_dir(); |
  |  | 93 | $trash\_dir = fileorganizer\_cleanpath($uploads\_dir['basedir'].'/fileorganizer/.trash'); |
  |  | 94 |  |
  |  | 95 | if(file\_exists($trash\_dir)){ |
  |  | 96 | fileorganizer\_recursive\_indexphp($trash\_dir, 8); // Adding index.php files |
  |  | 97 |  |
  |  | 98 | $randomness = wp\_generate\_password(12, false); |
  |  | 99 | $new\_dir\_name = $trash\_dir . '-' . $randomness; |
  |  | 100 |  |
  |  | 101 | rename($trash\_dir, $new\_dir\_name); |
  |  | 102 | } |
  |  | 103 | } |
  |  | 104 |  |
  | 90 | 105 | // Save the new Version |
  | 91 | 106 | update\_option('fileorganizer\_version', FILEORGANIZER\_VERSION); |
  | 92 | 107 |  |
  |  | 108 | } |
  |  | 109 |  |
  |  | 110 | // Creates index.php file recursively |
  |  | 111 | // This is needed only if user upgrades from any version below 1.0.8 |
  |  | 112 | // NOTE: So remove when not needed. |
  |  | 113 | function fileorganizer\_recursive\_indexphp($trash\_dir, $depth){ |
  |  | 114 |  |
  |  | 115 | if($depth <= 0){ |
  |  | 116 | return; |
  |  | 117 | } |
  |  | 118 |  |
  |  | 119 | if(!is\_dir($trash\_dir)){ |
  |  | 120 | return; |
  |  | 121 | } |
  |  | 122 |  |
  |  | 123 | $sub\_dirs = scandir($trash\_dir); |
  |  | 124 |  |
  |  | 125 | if(empty($sub\_dirs)){ |
  |  | 126 | return false; |
  |  | 127 | } |
  |  | 128 |  |
  |  | 129 | foreach($sub\_dirs as $file){ |
  |  | 130 | $file\_path = $trash\_dir . '/' . $file; |
  |  | 131 | if(!is\_dir($file\_path) || in\_array($file, ['..', '.'])){ |
  |  | 132 | continue; |
  |  | 133 | } |
  |  | 134 |  |
  |  | 135 | $depth--; |
  |  | 136 | fileorganizer\_recursive\_indexphp($file\_path, $depth); |
  |  | 137 | } |
  |  | 138 |  |
  |  | 139 | if(!file\_exists($trash\_dir . '/index.php')){ |
  |  | 140 | file\_put\_contents($trash\_dir . '/index.php', '<?php //Silence is golden'); |
  |  | 141 | chmod($trash\_dir . '/index.php', 0444); |
  |  | 142 | } |
  | 93 | 143 | } |
  | 94 | 144 |  |
  | […](/browser/fileorganizer/trunk/init.php?rev=3069064#L121) | […](/browser/fileorganizer/trunk/init.php?rev=3098763#L171) |  |
  | 121 | 171 | } |
  | 122 | 172 | } |
  | 123 |  |  |
  | 124 | 173 | } |
  | 125 | 174 |  |
  | […](/browser/fileorganizer/trunk/init.php?rev=3069064#L244) | […](/browser/fileorganizer/trunk/init.php?rev=3098763#L293) |  |
  | 244 | 293 |  |
  | 245 | 294 | if(is\_array($var) || is\_object($var)){ |
  |  | 295 | $var = map\_deep($var, 'wp\_unslash'); |
  | 246 | 296 | return map\_deep($var, 'sanitize\_text\_field'); |
  | 247 | 297 | } |
  | 248 | 298 |  |
  | 249 | 299 | if(is\_scalar($var)){ |
  |  | 300 | $var = wp\_unslash($var); |
  | 250 | 301 | return sanitize\_text\_field($var); |
  | 251 | 302 | } |
  | […](/browser/fileorganizer/trunk/init.php?rev=3069064#L293) | […](/browser/fileorganizer/trunk/init.php?rev=3098763#L344) |  |
  | 293 | 344 |  |
  | 294 | 345 | if(!empty($message)){ |
  | 295 |  | echo '<div class="'.~~$type.' '.$dismissible~~.' notice"> |
  | 296 |  | <p>'.~~$message~~.'</p> |
  |  | 346 | echo '<div class="'.esc\_attr($type).' '.esc\_attr($dismissible).' notice"> |
  |  | 347 | <p>'.wp\_kses\_post($message).'</p> |
  | 297 | 348 | </div>'; |
  | 298 | 349 | } |
* ## [fileorganizer/trunk/main/ajax.php](/changeset/3098763/fileorganizer/trunk/main/ajax.php "Show the changeset 3098763 restricted to fileorganizer/trunk/main/ajax.php")

  | [r3069064](/browser/fileorganizer/trunk/main/ajax.php?rev=3069064#L84 "Show revision 3069064 of this file in browser") | [r3098763](/browser/fileorganizer/trunk/main/ajax.php?rev=3098763#L84 "Show revision 3098763 of this file in browser") |  |
  | --- | --- | --- |
  | 84 | 84 | // Is trash enabled? |
  | 85 | 85 | if (!empty($fileorganizer->options['enable\_trash'])) { |
  | 86 |  |  |
  | 87 | 86 | $uploads\_dir = wp\_upload\_dir(); |
  |  | 87 |  |
  | 88 | 88 | $trash\_dir = fileorganizer\_cleanpath($uploads\_dir['basedir'].'/fileorganizer/.trash'); |
  | 89 |  |  |
  | 90 |  | if(!file\_exists($trash\_dir)){ |
  | 91 |  | mkdir($trash\_dir.'/.tmb', 0755, true); |
  |  | 89 | $trash\_glob = glob($trash\_dir . '-\*/', GLOB\_ONLYDIR); |
  |  | 90 |  |
  |  | 91 | if(!empty($trash\_glob) && !empty($trash\_glob[0])){ |
  |  | 92 | $trash\_dir = $trash\_glob[0]; |
  |  | 93 | $trash\_name = basename($trash\_dir); |
  | 92 | 94 | } |
  | 93 |  |  |
  |  | 95 |  |
  |  | 96 | if(empty($trash\_name) || !file\_exists($trash\_dir)){ |
  |  | 97 | $randomness = wp\_generate\_password(12, false); |
  |  | 98 | $trash\_dir .= '-' . $randomness; |
  |  | 99 | $trash\_name = basename($trash\_dir); |
  |  | 100 | mkdir($trash\_dir . '/.tmb', 0755, true); |
  |  | 101 | } |
  |  | 102 |  |
  |  | 103 | if(!file\_exists($trash\_dir . '/index.php')){ |
  |  | 104 | file\_put\_contents($trash\_dir . '/index.php', '<?php //Silence is golden'); |
  |  | 105 | chmod($trash\_dir . '/index.php', 0444); |
  |  | 106 | } |
  |  | 107 |  |
  | 94 | 108 | // Configure trash |
  | 95 | 109 | $config[1] = array( |
  | […](/browser/fileorganizer/trunk/main/ajax.php?rev=3069064#L97) | […](/browser/fileorganizer/trunk/main/ajax.php?rev=3098763#L111) |  |
  | 97 | 111 | 'driver' => 'Trash', |
  | 98 | 112 | 'path' => $trash\_dir, |
  | 99 |  | 'tmbURL' => $uploads\_dir['baseurl'].'/fileorganizer/~~.trash~~/.tmb/', |
  |  | 113 | 'tmbURL' => $uploads\_dir['baseurl'].'/fileorganizer/'.$trash\_name.'/.tmb/', |
  | 100 | 114 | 'winHashFix' => DIRECTORY\_SEPARATOR !== '/', |
  | 101 | 115 | 'uploadDeny' => array(''), |
  | […](/browser/fileorganizer/trunk/main/ajax.php?rev=3069064#L116) | […](/browser/fileorganizer/trunk/main/ajax.php?rev=3098763#L130) |  |
  | 116 | 130 | 'roots' => $config, |
  | 117 | 131 | 'bind' => array( |
  |  | 132 | 'mkdir' => function(&$path, &$name, $src, $elfinder, $volume){ |
  |  | 133 | global $fileorganizer; |
  |  | 134 |  |
  |  | 135 | if(empty($fileorganizer->options['enable\_trash']) || empty($name['added']) || !is\_array($name['added']) || empty($volume)){ |
  |  | 136 | return; |
  |  | 137 | } |
  |  | 138 |  |
  |  | 139 | foreach($name['added'] as $added){ |
  |  | 140 | $dir\_path = $volume->realpath($added['hash']); |
  |  | 141 |  |
  |  | 142 | if(empty($dir\_path) || strpos($dir\_path, '.trash-') === FALSE){ |
  |  | 143 | return; |
  |  | 144 | } |
  |  | 145 |  |
  |  | 146 | if(!file\_exists($dir\_path . '/index.php')){ |
  |  | 147 | file\_put\_contents($dir\_path . '/index.php', '<?php //Silence is golden'); |
  |  | 148 | chmod($dir\_path . '/index.php', 0444); |
  |  | 149 | } |
  |  | 150 | } |
  |  | 151 | }, |
  | 118 | 152 | 'upload.presave' => function(&$path, &$name, $src, $elfinder, $volume) { |
  | 119 |  |  |
  | 120 | 153 | // Check if the file is an SVG |
  | 121 | 154 | if( |
* ## [fileorganizer/trunk/main/fileorganizer.php](/changeset/3098763/fileorganizer/trunk/main/fileorganizer.php "Show the changeset 3098763 restricted to fileorganizer/trunk/main/fileorganizer.php")

  | [r2964502](/browser/fileorganizer/trunk/main/fileorganizer.php?rev=2964502#L27 "Show revision 2964502 of this file in browser") | [r3098763](/browser/fileorganizer/trunk/main/fileorganizer.php?rev=3098763#L27 "Show revision 3098763 of this file in browser") |  |
  | --- | --- | --- |
  | 27 | 27 | <td> |
  | 28 | 28 | <div class="fileorganizer-td"> |
  | 29 |  | <img src="<?php echo ~~FILEORGANIZER\_URL~~ ?>/images/logo.png" /> |
  |  | 29 | <img src="<?php echo esc\_url(FILEORGANIZER\_URL); ?>/images/logo.png" /> |
  | 30 | 30 | <h3 class="fileorganizer-heading"><?php echo esc\_html($title)?></h3> |
  | 31 | 31 | </div> |
  | […](/browser/fileorganizer/trunk/main/fileorganizer.php?rev=2964502#L38) | […](/browser/fileorganizer/trunk/main/fileorganizer.php?rev=3098763#L38) |  |
  | 38 | 38 | <td class="fileorganizer-options"> |
  | 39 | 39 | <div class="fileorganizer-td"> |
  | 40 |  | <label><?php \_e('Theme'); ?></label> |
  |  | 40 | <label><?php esc\_html\_e('Theme'); ?></label> |
  | 41 | 41 | <select id="fileorganizer-theme-switcher"> |
  | 42 |  | <option <?php  selected($theme, 'default'); ?> value=""><?php \_e('Default'); ?></option> |
  | 43 |  | <option <?php  selected($theme, 'dark'); ?>  value="dark"><?php \_e('Dark'); ?></option> |
  | 44 |  | <option <?php  selected($theme, 'material'); ?>  value="material"><?php \_e('Material'); ?></option> |
  | 45 |  | <option <?php  selected($theme, 'material-dark'); ?>  value="material-dark"><?php \_e('Material Dark'); ?></option> |
  | 46 |  | <option <?php  selected($theme, 'material-gray'); ?>  value="material-gray"><?php \_e('Material Light'); ?></option> |
  | 47 |  | <option <?php selected($theme, 'windows10'); ?>  value="windows10"><?php \_e('Windows 10'); ?></option> |
  |  | 42 | <option <?php  selected($theme, 'default'); ?> value=""><?php esc\_html\_e('Default'); ?></option> |
  |  | 43 | <option <?php  selected($theme, 'dark'); ?>  value="dark"><?php esc\_html\_e('Dark'); ?></option> |
  |  | 44 | <option <?php  selected($theme, 'material'); ?>  value="material"><?php esc\_html\_e('Material'); ?></option> |
  |  | 45 | <option <?php  selected($theme, 'material-dark'); ?>  value="material-dark"><?php esc\_html\_e('Material Dark'); ?></option> |
  |  | 46 | <option <?php  selected($theme, 'material-gray'); ?>  value="material-gray"><?php esc\_html\_e('Material Light'); ?></option> |
  |  | 47 | <option <?php selected($theme, 'windows10'); ?>  value="windows10"><?php esc\_html\_e('Windows 10'); ?></option> |
  | 48 | 48 | </select> |
  | 49 | 49 | </div> |
  | […](/browser/fileorganizer/trunk/main/fileorganizer.php?rev=2964502#L63) | […](/browser/fileorganizer/trunk/main/fileorganizer.php?rev=3098763#L63) |  |
  | 63 | 63 | echo '</div> |
  | 64 | 64 | <div class="fileorganizer\_footer\_wrap"> |
  | 65 |  | <a href="https://fileorganizer.net" target="\_blank">'.~~\_\_('FileOrganizer').'</a><span> v'.FILEORGANIZER\_VERSION~~.' You can report any bugs </span><a href="https://wordpress.org/support/plugin/fileorganizer" target="\_blank">here</a>. |
  |  | 65 | <a href="https://fileorganizer.net" target="\_blank">'.esc\_html\_\_('FileOrganizer').'</a><span> v'.esc\_html(FILEORGANIZER\_VERSION).' You can report any bugs </span><a href="https://wordpress.org/support/plugin/fileorganizer" target="\_blank">here</a>. |
  | 66 | 66 | </div>'; |
  | 67 | 67 |  |
  | […](/browser/fileorganizer/trunk/main/fileorganizer.php?rev=2964502#L85) | […](/browser/fileorganizer/trunk/main/fileorganizer.php?rev=3098763#L85) |  |
  | 85 | 85 | fileorganizer\_nonce: fileorganizer\_ajax\_nonce, |
  | 86 | 86 | }, |
  | 87 |  | defaultView: "'.(!empty($fileorganizer->options['default\_view']) ? ~~$fileorganizer->options['default\_view']~~ : 'list').'", |
  |  | 87 | defaultView: "'.(!empty($fileorganizer->options['default\_view']) ? esc\_html($fileorganizer->options['default\_view']) : 'list').'", |
  | 88 | 88 | height: 500, |
  | 89 | 89 | lang: fileorganizer\_lang, |
  | […](/browser/fileorganizer/trunk/main/fileorganizer.php?rev=2964502#L144) | […](/browser/fileorganizer/trunk/main/fileorganizer.php?rev=3098763#L144) |  |
  | 144 | 144 | <script> |
  | 145 | 145 |  |
  | 146 |  | var fileorganizer\_ajaxurl = "<?php echo ~~admin\_url( 'admin-ajax.php'~~ ); ?>"; |
  | 147 |  | var fileorganizer\_ajax\_nonce = "<?php echo ~~wp\_create\_nonce( 'fileorganizer\_ajax'~~ ); ?>"; |
  | 148 |  | var fileorganizer\_url = "<?php echo ~~FILEORGANIZER\_URL~~; ?>/manager/"; |
  | 149 |  | var fileorganizer\_lang = "<?php echo !empty($fileorganizer->options['default\_lang']) ? ~~$fileorganizer->options['default\_lang']~~ : 'en' ?>"; |
  |  | 146 | var fileorganizer\_ajaxurl = "<?php echo esc\_url(admin\_url( 'admin-ajax.php' )); ?>"; |
  |  | 147 | var fileorganizer\_ajax\_nonce = "<?php echo esc\_html(wp\_create\_nonce('fileorganizer\_ajax')); ?>"; |
  |  | 148 | var fileorganizer\_url = "<?php echo esc\_url(FILEORGANIZER\_URL); ?>/manager/"; |
  |  | 149 | var fileorganizer\_lang = "<?php echo !empty($fileorganizer->options['default\_lang']) ? esc\_html($fileorganizer->options['default\_lang']) : 'en' ?>"; |
  | 150 | 150 |  |
  | 151 | 151 | jQuery(document).ready(function() { |
* ## [fileorganizer/trunk/main/promo.php](/changeset/3098763/fileorganizer/trunk/main/promo.php "Show the changeset 3098763 restricted to fileorganizer/trunk/main/promo.php")

  | [r3010587](/browser/fileorganizer/trunk/main/promo.php?rev=3010587#L108 "Show revision 3010587 of this file in browser") | [r3098763](/browser/fileorganizer/trunk/main/promo.php?rev=3098763#L108 "Show revision 3098763 of this file in browser") |  |
  | --- | --- | --- |
  | 108 | 108 |  |
  | 109 | 109 | // Save this preference |
  | 110 |  | $.get("'.~~admin\_url('admin-ajax.php?action=fileorganizer\_hide\_promo').'&security='.wp\_create\_nonce('fileorganizer\_promo\_nonce'~~).'", data, function(response) { |
  |  | 110 | $.get("'.esc\_url(admin\_url('admin-ajax.php?action=fileorganizer\_hide\_promo')).'&security='.esc\_html(wp\_create\_nonce('fileorganizer\_promo\_nonce')).'", data, function(response) { |
  | 111 | 111 | //alert(response); |
  | 112 | 112 | }); |
  | […](/browser/fileorganizer/trunk/main/promo.php?rev=3010587#L124) | […](/browser/fileorganizer/trunk/main/promo.php?rev=3098763#L124) |  |
  | 124 | 124 | <tr> |
  | 125 | 125 | <th> |
  | 126 |  | <img src="'.~~FILEORGANIZER\_URL~~.'/images/logo.png" style="float:left; margin:10px 20px 10px 10px" width="100" /> |
  |  | 126 | <img src="'.esc\_url(FILEORGANIZER\_URL).'/images/logo.png" style="float:left; margin:10px 20px 10px 10px" width="100" /> |
  | 127 | 127 | </th> |
  | 128 | 128 | <td> |
* ## [fileorganizer/trunk/main/settings.php](/changeset/3098763/fileorganizer/trunk/main/settings.php "Show the changeset 3098763 restricted to fileorganizer/trunk/main/settings.php")

  | [r2968701](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L21 "Show revision 2968701 of this file in browser") | [r3098763](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L21 "Show revision 3098763 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | <tr> |
  | 22 | 22 | <td class="fileorganizer-td" valign="top"> |
  | 23 |  | <img src="'.~~FILEORGANIZER\_URL~~ .'/images/logo.png"> |
  | 24 |  | <h3 class="fileorganizer-heading">'.~~$title~~.'</h3> |
  |  | 23 | <img src="'.esc\_url(FILEORGANIZER\_URL) .'/images/logo.png"> |
  |  | 24 | <h3 class="fileorganizer-heading">'.esc\_html($title).'</h3> |
  | 25 | 25 | </td> |
  | 26 | 26 | <td align="right"><a target="\_blank" class="button button-primary" href="https://wordpress.org/support/view/plugin-reviews/fileorganizer">Review FileOrganizer</a></td> |
  | 27 |  | <td align="right" width="40"><a target="\_blank" href="https://twitter.com/fileorganizer"><img src="'.~~FILEORGANIZER\_URL~~.'/images/twitter.png" /></a></td> |
  | 28 |  | <td align="right" width="40"><a target="\_blank" href="https://www.facebook.com/fileorganizer/"><img src="'.~~FILEORGANIZER\_URL~~.'/images/facebook.png" /></a></td> |
  |  | 27 | <td align="right" width="40"><a target="\_blank" href="https://twitter.com/fileorganizer"><img src="'.esc\_url(FILEORGANIZER\_URL).'/images/twitter.png" /></a></td> |
  |  | 28 | <td align="right" width="40"><a target="\_blank" href="https://www.facebook.com/fileorganizer/"><img src="'.esc\_url(FILEORGANIZER\_URL).'/images/facebook.png" /></a></td> |
  | 29 | 29 | </tr> |
  | 30 | 30 | </table> |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L43) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L43) |  |
  | 43 | 43 | <div class="fileorganizer-promotion-content"> |
  | 44 | 44 | <h2 class="fileorganizer-promotion-logo"> |
  | 45 |  | <span><a target="\_blank" href="https://pagelayer.com/?from=fileorganizer-plugin"><img src="'. ~~FILEORGANIZER\_URL~~.'/images/pagelayer\_product.png" width="100%"></a></span> |
  |  | 45 | <span><a target="\_blank" href="https://pagelayer.com/?from=fileorganizer-plugin"><img src="'. esc\_url(FILEORGANIZER\_URL).'/images/pagelayer\_product.png" width="100%"></a></span> |
  | 46 | 46 | </h2> |
  | 47 | 47 | <div> |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L63) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L63) |  |
  | 63 | 63 | <div class="fileorganizer-promotion-content"> |
  | 64 | 64 | <h2 class="fileorganizer-promotion-logo"> |
  | 65 |  | <span><a target="\_blank" href="https://loginizer.com/?from=fileorganizer-plugin"><img src="'.~~FILEORGANIZER\_URL~~.'/images/loginizer\_product.png" width="100%"></a></span> |
  |  | 65 | <span><a target="\_blank" href="https://loginizer.com/?from=fileorganizer-plugin"><img src="'.esc\_url(FILEORGANIZER\_URL).'/images/loginizer\_product.png" width="100%"></a></span> |
  | 66 | 66 | </h2> |
  | 67 | 67 | <div> |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L90) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L90) |  |
  | 90 | 90 | echo ' |
  | 91 | 91 | <div style="width:45%;background:#FFF;padding:15px; margin:40px auto"> |
  | 92 |  | <b>'. \_\_('Let your followers know that you use FileOrganizer to manage your wordpress files :').'</b> |
  |  | 92 | <b>'. esc\_html\_\_('Let your followers know that you use FileOrganizer to manage your wordpress files :').'</b> |
  | 93 | 93 | <form method="get" action="https://twitter.com/intent/tweet" id="tweet" onsubmit="return dotweet(this);"> |
  | 94 |  | <textarea name="text" cols="45" row="3" style="resize:none;">'. \_\_('I easily manage my #WordPress #files using @fileorganizer').'</textarea> |
  |  | 94 | <textarea name="text" cols="45" row="3" style="resize:none;">'. esc\_html\_\_('I easily manage my #WordPress #files using @fileorganizer').'</textarea> |
  | 95 | 95 | &nbsp; &nbsp; <input type="submit" value="Tweet!" class="button button-primary" onsubmit="return false;" id="twitter-btn" style="margin-top:20px;"> |
  | 96 | 96 | </form> |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L156) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L156) |  |
  | 156 | 156 | <div class="tabs-wrapper"> |
  | 157 | 157 | <h2 class="nav-tab-wrapper fileorganizer-wrapper"> |
  | 158 |  | <a href="#fileorganizer-general" class="fileorganizer-nav-tab nav-tab nav-tab-active"><?php \_e('General'); ?></a> |
  | 159 |  | <a href="#fileorganizer-advanced" class="fileorganizer-nav-tab nav-tab"><?php \_e('Advanced'); ?></a> |
  | 160 |  | <a href="#fileorganizer-support" class="fileorganizer-nav-tab nav-tab "><?php \_e('Support'); ?></a> |
  |  | 158 | <a href="#fileorganizer-general" class="fileorganizer-nav-tab nav-tab nav-tab-active"><?php esc\_html\_e('General'); ?></a> |
  |  | 159 | <a href="#fileorganizer-advanced" class="fileorganizer-nav-tab nav-tab"><?php esc\_html\_e('Advanced'); ?></a> |
  |  | 160 | <a href="#fileorganizer-support" class="fileorganizer-nav-tab nav-tab "><?php esc\_html\_e('Support'); ?></a> |
  | 161 | 161 | </h2> |
  | 162 | 162 |  |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L165) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L165) |  |
  | 165 | 165 | <table class="form-table"> |
  | 166 | 166 | <tr> |
  | 167 |  | <th scope="row"><?php \_e('File Manager Path'); ?></th> |
  | 168 |  | <td> |
  | 169 |  | <div class="fileorganizer-form-input"> |
  | 170 |  | <input name="root\_path" type="text" class="regular-text always\_active" placeholder="<?php echo ~~fileorganizer\_cleanpath(ABSPATH~~); ?>"  value="<?php if(!empty($settings['root\_path'])){ |
  |  | 167 | <th scope="row"><?php esc\_html\_e('File Manager Path'); ?></th> |
  |  | 168 | <td> |
  |  | 169 | <div class="fileorganizer-form-input"> |
  |  | 170 | <input name="root\_path" type="text" class="regular-text always\_active" placeholder="<?php echo esc\_attr(fileorganizer\_cleanpath(ABSPATH)); ?>"  value="<?php if(!empty($settings['root\_path'])){ |
  | 171 | 171 | echo esc\_attr($settings['root\_path']); |
  | 172 | 172 | }?>"> |
  | 173 | 173 | <p class="description"> |
  | 174 |  | <?php echo ~~\_\_( 'Set file manager root path.<br> Default path is:').'<code>'.fileorganizer\_cleanpath(ABSPATH).\_\_('</code><br>Please change the path carefully. an incorrect path can cause the FileOrganizer plugin to goes down.'~~); |
  |  | 174 | <?php echo wp\_kses\_post(\_\_( 'Set file manager root path.<br> Default path is:').'<code>'.fileorganizer\_cleanpath(ABSPATH).\_\_('</code><br>Please change the path carefully. an incorrect path can cause the FileOrganizer plugin to goes down.')); |
  | 175 | 175 | ?> |
  | 176 | 176 | </p> |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L178) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L178) |  |
  | 178 | 178 | if(!defined('FILEORGANIZER\_PRO')){ |
  | 179 | 179 | echo '<p class="description"><b>'; |
  | 180 |  | \_e('Note: The free version does not allow setting a path outside your WordPress installation!'); |
  |  | 180 | esc\_html\_e('Note: The free version does not allow setting a path outside your WordPress installation!'); |
  | 181 | 181 | echo '</b></p>'; |
  | 182 | 182 | } ?> |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L188) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L188) |  |
  | 188 | 188 | ?> |
  | 189 | 189 | <tr> |
  | 190 |  | <th scope="row"><?php \_e('File Manager Path Restriction'); ?></th> |
  |  | 190 | <th scope="row"><?php esc\_html\_e('File Manager Path Restriction'); ?></th> |
  | 191 | 191 | <td> |
  | 192 | 192 | <div class="fileorganizer-form-input"> |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L199) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L199) |  |
  | 199 | 199 | <p class="description"> |
  | 200 | 200 | <?php |
  | 201 |  | \_e('Disable root path restriction.'); |
  | 202 |  | echo '<br>'.\_\_('Allow FileOrganizer to set a path outside of your WordPress installation.'); |
  |  | 201 | esc\_html\_e('Disable root path restriction.'); |
  |  | 202 | echo '<br>'.esc\_html\_\_('Allow FileOrganizer to set a path outside of your WordPress installation.'); |
  | 203 | 203 | ?> |
  | 204 | 204 | </p> |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L210) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L210) |  |
  | 210 | 210 | ?> |
  | 211 | 211 | <tr> |
  | 212 |  | <th scope="row"><?php \_e('Files View'); ?></th> |
  |  | 212 | <th scope="row"><?php esc\_html\_e('Files View'); ?></th> |
  | 213 | 213 | <td> |
  | 214 | 214 | <div class="fileorganizer-form-input"> |
  | 215 | 215 | <?php $view = empty($settings['default\_view']) ? '' : $settings['default\_view']; ?> |
  | 216 | 216 | <select name='default\_view'> |
  | 217 |  | <option <?php selected( $view , 'icons'); ?> value="icons"><?php \_e('Icons'); ?></option> |
  | 218 |  | <option <?php selected( $view , 'list'); ?> value="list"><?php \_e('List'); ?></option> |
  |  | 217 | <option <?php selected( $view , 'icons'); ?> value="icons"><?php esc\_html\_e('Icons'); ?></option> |
  |  | 218 | <option <?php selected( $view , 'list'); ?> value="list"><?php esc\_html\_e('List'); ?></option> |
  | 219 | 219 | </select> |
  | 220 |  | <p class="description"><?php \_e( "Set default folder view." ); ?></p> |
  | 221 |  | </div> |
  | 222 |  | </td> |
  | 223 |  | </tr> |
  | 224 |  | <tr> |
  | 225 |  | <th scope="row"><?php \_e('Select Language'); ?></th> |
  |  | 220 | <p class="description"><?php esc\_html\_e( "Set default folder view." ); ?></p> |
  |  | 221 | </div> |
  |  | 222 | </td> |
  |  | 223 | </tr> |
  |  | 224 | <tr> |
  |  | 225 | <th scope="row"><?php esc\_html\_e('Select Language'); ?></th> |
  | 226 | 226 | <td> |
  | 227 | 227 | <?php |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L272) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L272) |  |
  | 272 | 272 | <?php |
  | 273 | 273 | foreach( $fileman\_languages as $lang => $code ){ |
  | 274 |  | echo '<option '.(selected( $curlang , $code)).' value="'.~~$code.'">'.$lang~~.'</option>'; |
  |  | 274 | echo '<option '.(selected( $curlang , $code)).' value="'.esc\_attr($code).'">'.esc\_html($lang).'</option>'; |
  | 275 | 275 | } |
  | 276 | 276 | ?> |
  | 277 | 277 | </select> |
  | 278 |  | <p class="description"><?php \_e( "Change the FileOrganizer default language." ); ?></p> |
  | 279 |  | </div> |
  | 280 |  | </td> |
  | 281 |  | </tr> |
  | 282 |  | <tr> |
  | 283 |  | <th scope="row"><?php \_e('Hide .htaccess?'); ?></th> |
  |  | 278 | <p class="description"><?php esc\_html\_e( "Change the FileOrganizer default language." ); ?></p> |
  |  | 279 | </div> |
  |  | 280 | </td> |
  |  | 281 | </tr> |
  |  | 282 | <tr> |
  |  | 283 | <th scope="row"><?php esc\_html\_e('Hide .htaccess?'); ?></th> |
  | 284 | 284 | <td> |
  | 285 | 285 | <div class="fileorganizer-form-input"> |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L290) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L290) |  |
  | 290 | 290 | <span class="fileorganizer-slider fileorganizer-round"></span> |
  | 291 | 291 | </label> |
  | 292 |  | <p class="description"><?php \_e( "Hide .htaccess file if exists." ); ?></p> |
  | 293 |  | </div> |
  | 294 |  | </td> |
  | 295 |  | </tr> |
  | 296 |  | <tr> |
  | 297 |  | <th scope="row"><?php \_e('Enable Trash?'); ?></th> |
  |  | 292 | <p class="description"><?php esc\_html\_e( "Hide .htaccess file if exists." ); ?></p> |
  |  | 293 | </div> |
  |  | 294 | </td> |
  |  | 295 | </tr> |
  |  | 296 | <tr> |
  |  | 297 | <th scope="row"><?php esc\_html\_e('Enable Trash?'); ?></th> |
  | 298 | 298 | <td> |
  | 299 | 299 | <div class="fileorganizer-form-input"> |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L306) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L306) |  |
  | 306 | 306 | <p class="description"> |
  | 307 | 307 | <?php |
  | 308 |  | \_e( "Enable trash to temporary  store files after deletion." ); |
  | 309 |  | echo '<br>'.~~\_\_('The trash files are saved in the following path.').'<br><code>'.fileorganizer\_cleanpath(wp\_upload\_dir()['basedir'].'/fileorganizer/.trash/'~~).'</code>'; |
  |  | 308 | esc\_html\_e( "Enable trash to temporary  store files after deletion." ); |
  |  | 309 | echo '<br>'.esc\_html\_\_('The trash files are saved in the following path.').'<br><code>'.esc\_html(fileorganizer\_cleanpath(wp\_upload\_dir()['basedir'].'/fileorganizer/.trash/')).'</code>'; |
  | 310 | 310 | ?> |
  | 311 | 311 | </p> |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L327) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L327) |  |
  | 327 | 327 | <div class="fileorganizer-lock-content"> |
  | 328 | 328 | <span class="dashicons dashicons-lock fileorganizer-lock-icon"></span> |
  | 329 |  | <label class="fileorganizer-lock-text">'. \_\_("Available in Pro version!") .'</label> |
  |  | 329 | <label class="fileorganizer-lock-text">'. esc\_html\_\_("Available in Pro version!") .'</label> |
  | 330 | 330 | </div> |
  | 331 | 331 | </div>'; |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L334) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L334) |  |
  | 334 | 334 | <table class="form-table"> |
  | 335 | 335 | <tr> |
  | 336 |  | <th scope="row"><?php \_e('Allowed User Roles'); ?></th> |
  |  | 336 | <th scope="row"><?php esc\_html\_e('Allowed User Roles'); ?></th> |
  | 337 | 337 | <td> |
  | 338 | 338 | <?php $roles = !empty($settings['user\_roles']) ? $settings['user\_roles'] : ''; ?> |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L342) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L342) |  |
  | 342 | 342 | echo "checked"; |
  | 343 | 343 | }?>> |
  | 344 |  | <span class="description"><?php \_e( "Administrator" ); ?></span>&nbsp;&nbsp; |
  |  | 344 | <span class="description"><?php esc\_html\_e( "Administrator" ); ?></span>&nbsp;&nbsp; |
  | 345 | 345 | <?php } ?> |
  | 346 | 346 | <input name="user\_roles[]" type="checkbox" value="editor" <?php if(is\_array($roles) && in\_array('editor', $roles)){ |
  | 347 | 347 | echo "checked"; |
  | 348 | 348 | }?>> |
  | 349 |  | <span class="description"><?php \_e( "Editor" ); ?></span>&nbsp;&nbsp; |
  |  | 349 | <span class="description"><?php esc\_html\_e( "Editor" ); ?></span>&nbsp;&nbsp; |
  | 350 | 350 |  |
  | 351 | 351 | <input name="user\_roles[]" type="checkbox" value="author" <?php if(is\_array($roles) && in\_array('author', $roles)){ |
  | 352 | 352 | echo "checked"; |
  | 353 | 353 | }?>> |
  | 354 |  | <span class="description"><?php \_e( "Author" ); ?></span>&nbsp;&nbsp; |
  |  | 354 | <span class="description"><?php esc\_html\_e( "Author" ); ?></span>&nbsp;&nbsp; |
  | 355 | 355 |  |
  | 356 | 356 | <input name="user\_roles[]" type="checkbox" value="contributor" <?php if(is\_array($roles) && in\_array('contributor', $roles)){ |
  | 357 | 357 | echo "checked"; |
  | 358 | 358 | }?>> |
  | 359 |  | <span class="description"><?php \_e( "Contributor" ); ?></span>&nbsp;&nbsp; |
  |  | 359 | <span class="description"><?php esc\_html\_e( "Contributor" ); ?></span>&nbsp;&nbsp; |
  | 360 | 360 |  |
  | 361 | 361 | <input name="user\_roles[]" type="checkbox" value="subscriber" <?php if(is\_array($roles) && in\_array('subscriber', $roles)){ |
  | 362 | 362 | echo "checked"; |
  | 363 | 363 | }?>> |
  | 364 |  | <span class="description"><?php \_e( "Subscriber" ); ?></span>&nbsp;&nbsp; |
  |  | 364 | <span class="description"><?php esc\_html\_e( "Subscriber" ); ?></span>&nbsp;&nbsp; |
  | 365 | 365 |  |
  | 366 | 366 | <input name="user\_roles[]" type="checkbox" value="customer" <?php if(is\_array($roles) && in\_array('customer', $roles)){ |
  | 367 | 367 | echo "checked"; |
  | 368 | 368 | }?>> |
  | 369 |  | <span class="description"><?php \_e( "Customer" ); ?></span>&nbsp;&nbsp; |
  |  | 369 | <span class="description"><?php esc\_html\_e( "Customer" ); ?></span>&nbsp;&nbsp; |
  | 370 | 370 |  |
  | 371 | 371 | <input name="user\_roles[]" type="checkbox" value="shop\_manager" <?php if(is\_array($roles) && in\_array('shop\_manager', $roles)){ |
  | 372 | 372 | echo "checked"; |
  | 373 | 373 | }?>> |
  | 374 |  | <span class="description"><?php \_e( "Shop Manager" ); ?></span>&nbsp;&nbsp; |
  |  | 374 | <span class="description"><?php esc\_html\_e( "Shop Manager" ); ?></span>&nbsp;&nbsp; |
  | 375 | 375 |  |
  | 376 | 376 | <p class="description"> |
  | 377 |  | <?php echo \_\_( 'Enabling access to the FileOrganizer for User Roles'); ?> |
  |  | 377 | <?php echo esc\_html\_\_( 'Enabling access to the FileOrganizer for User Roles'); ?> |
  | 378 | 378 | </p> |
  | 379 | 379 | </div> |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L381) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L381) |  |
  | 381 | 381 | </tr> |
  | 382 | 382 | <tr> |
  | 383 |  | <th scope="row"><?php \_e('Maximum Upload Size'); ?></th> |
  |  | 383 | <th scope="row"><?php esc\_html\_e('Maximum Upload Size'); ?></th> |
  | 384 | 384 | <td> |
  | 385 | 385 | <div class="fileorganizer-form-input"> |
  | 386 | 386 | <input name="max\_upload\_size" type="number" class="regular-text always\_active" placeholder="0"  value="<?php  if(!empty($settings['max\_upload\_size'])){ |
  | 387 | 387 | echo esc\_attr($settings['max\_upload\_size']); |
  | 388 |  | }?>"> <?php \_e('MB');  ?> |
  | 389 |  | <p class="description"><?php ~~\_e~~( "Increase the maximum upload size if you are getting errors while uploading files.<br> Default: 0 means unlimited upload." ); ?></p> |
  |  | 388 | }?>"> <?php esc\_html\_e('MB');  ?> |
  |  | 389 | <p class="description"><?php echo wp\_kses\_post( "Increase the maximum upload size if you are getting errors while uploading files.<br> Default: 0 means unlimited upload." ); ?></p> |
  | 390 | 390 | </div> |
  | 391 | 391 | </td> |
  | 392 | 392 | </tr> |
  | 393 | 393 | <tr> |
  | 394 |  | <th scope="row"><?php \_e('Enable Network Volume'); ?></th> |
  |  | 394 | <th scope="row"><?php esc\_html\_e('Enable Network Volume'); ?></th> |
  | 395 | 395 | <td> |
  | 396 | 396 | <div class="fileorganizer-form-input"> |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L401) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L401) |  |
  | 401 | 401 | <span class="fileorganizer-slider fileorganizer-round"></span> |
  | 402 | 402 | </label> |
  | 403 |  | <p class="description"><?php \_e( "Enable network volume." ); ?></p> |
  |  | 403 | <p class="description"><?php esc\_html\_e( "Enable network volume." ); ?></p> |
  | 404 | 404 | </div> |
  | 405 | 405 | </td> |
  | […](/browser/fileorganizer/trunk/main/settings.php?rev=2968701#L422) | […](/browser/fileorganizer/trunk/main/settings.php?rev=3098763#L422) |  |
  | 422 | 422 | <span style="font-size:30px;font-weight:600;margin:auto;color:var(--primary)">FileOrganizer</span> |
  | 423 | 423 | </div> |
  | 424 |  | <h2><?php esc\_html\_e('You can contact the FileOrganizer Team via email. Our email address is', 'fileorganizer'); ?> <a href="mailto:support@fileorganizer.net">support@fileorganizer.net</a> <?php esc\_html\_e('or through Our Premium Support Ticket System at', 'fileorganizer'); ?> <a href="https://softaculous.deskuss.com" target="\_blank"><?php \_e('here'); ?></a></h2> |
  |  | 424 | <h2><?php esc\_html\_e('You can contact the FileOrganizer Team via email. Our email address is', 'fileorganizer'); ?> <a href="mailto:support@fileorganizer.net">support@fileorganizer.net</a> <?php esc\_html\_e('or through Our Premium Support Ticket System at', 'fileorganizer'); ?> <a href="https://softaculous.deskuss.com" target="\_blank"><?php esc\_html\_e('here'); ?></a></h2> |
  | 425 | 425 | </div> |
  | 426 | 426 | </div> |
* ## [fileorganizer/trunk/readme.txt](/changeset/3098763/fileorganizer/trunk/readme.txt "Show the changeset 3098763 restricted to fileorganizer/trunk/readme.txt")

  | [r3069064](/browser/fileorganizer/trunk/readme.txt?rev=3069064#L3 "Show revision 3069064 of this file in browser") | [r3098763](/browser/fileorganizer/trunk/readme.txt?rev=3098763#L3 "Show revision 3098763 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Tags: FileOrganizer, file manager, wordpress file manager, file explorer, upload files, File Manage, Edit Files, Delete Files, elfinder, ftp, file transfer, update, create, delete, view, edit, rename, editor, explorer, softaculous, webuzo, Control Panel, Admin |
  | 4 | 4 | Requires at least: 5.5 |
  | 5 |  | Tested up to: 6.~~4~~ |
  |  | 5 | Tested up to: 6.5 |
  | 6 | 6 | Requires PHP: 5.5 |
  | 7 |  | Stable tag: 1.0.~~7~~ |
  |  | 7 | Stable tag: 1.0.8 |
  | 8 | 8 | License: LGPL v2.1 |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/lgpl-2.1.html |
  | […](/browser/fileorganizer/trunk/readme.txt?rev=3069064#L51) | […](/browser/fileorganizer/trunk/readme.txt?rev=3098763#L51) |  |
  | 51 | 51 | == Changelog == |
  | 52 | 52 |  |
  |  | 53 | = 1.0.8 (June 06, 2024) = |
  |  | 54 | \* [Security-Fix] A Directory listing issue has been fixed. (Researcher Emad, WordFence) |
  |  | 55 |  |
  | 53 | 56 | = 1.0.7 (Apr 11, 2024) = |
  | 54 | 57 | \* [Security-Fix] An XSS vulnerability has been fixed. Please upgrade to this version as soon as possible! |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3098763)
* [Zip Archive](?format=zip&new=3098763)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_e8b40c7f_20250111_094201.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Ffileorganizer%2Ftrunk%2Fmain%2Fajax.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/fileorganizer/trunk/main/ajax.php?rev=3098763 "Revision 3098763")
* Next Revision →
* [Blame](/browser/fileorganizer/trunk/main/ajax.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/fileorganizer/trunk/main/ajax.php)

---

# [source:](/browser?order=name "Go to repository root") [fileorganizer](/browser/fileorganizer?order=name "View fileorganizer")/[trunk](/browser/fileorganizer/trunk?order=name "View trunk")/[main](/browser/fileorganizer/trunk/main?order=name "View main")/[ajax.php](/browser/fileorganizer/trunk/main/ajax.php?order=name "View ajax.php")

View diff against:

View revision:

| [Last change](/changeset/3149878/fileorganizer/trunk/main/ajax.php "View differences") on this file was [3149878](/changeset/3149878/ "View changeset 3149878"), checked in by softaculous, [4 months ago](/timeline?from=2024-09-11T08%3A25%3A35Z&precision=second "See timeline at 09/11/2024 08:25:35 AM") |
| --- |
| New version |
| **File size:** 9.8 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | \* FILEORGANIZER |
| [4](#L4) | \* https://fileorganizer.net/ |
| [5](#L5) | \* (c) FileOrganizer Team |
| [6](#L6) | \*/ |
| [7](#L7) |  |
| [8](#L8) | if(!defined('FILEORGANIZER\_VERSION')){ |
| [9](#L9) | die('Hacking Attempt!'); |
| [10](#L10) | } |
| [11](#L11) |  |
| [12](#L12) | add\_action('wp\_ajax\_fileorganizer\_file\_folder\_manager', 'fileorganizer\_ajax\_handler'); |
| [13](#L13) | function fileorganizer\_ajax\_handler(){ |
| [14](#L14) | global $fileorganizer; |
| [15](#L15) |  |
| [16](#L16) | // Check nonce |
| [17](#L17) | check\_admin\_referer( 'fileorganizer\_ajax' , 'fileorganizer\_nonce' ); |
| [18](#L18) |  |
| [19](#L19) | // Check capability |
| [20](#L20) | $capability = fileorganizer\_get\_capability(); |
| [21](#L21) |  |
| [22](#L22) | if(!current\_user\_can($capability)){ |
| [23](#L23) | return; |
| [24](#L24) | } |
| [25](#L25) |  |
| [26](#L26) | // Load saved settings |
| [27](#L27) | $url = site\_url(); |
| [28](#L28) | $path = !empty($fileorganizer->options['root\_path']) ? fileorganizer\_cleanpath($fileorganizer->options['root\_path']) : ABSPATH; |
| [29](#L29) |  |
| [30](#L30) | if(!defined('FILEORGANIZER\_PRO') || empty($fileorganizer->options['disable\_path\_restriction'])){ |
| [31](#L31) | $path = fileorganizer\_validate\_path($path) ? $path : ABSPATH; |
| [32](#L32) | } |
| [33](#L33) |  |
| [34](#L34) | if(is\_multisite()){ |
| [35](#L35) | $url = network\_home\_url(); |
| [36](#L36) | } |
| [37](#L37) |  |
| [38](#L38) | // Set restrictions |
| [39](#L39) | $restrictions = [ |
| [40](#L40) | array( |
| [41](#L41) | 'pattern' => '/.tmb/', |
| [42](#L42) | 'read' => false, |
| [43](#L43) | 'write' => false, |
| [44](#L44) | 'hidden' => true, |
| [45](#L45) | 'locked' => false, |
| [46](#L46) | ), |
| [47](#L47) | array( |
| [48](#L48) | 'pattern' => '/.quarantine/', |
| [49](#L49) | 'read' => false, |
| [50](#L50) | 'write' => false, |
| [51](#L51) | 'hidden' => true, |
| [52](#L52) | 'locked' => false, |
| [53](#L53) | ) |
| [54](#L54) | ]; |
| [55](#L55) |  |
| [56](#L56) | // Hide .htaccess? |
| [57](#L57) | if(!empty($fileorganizer->options['hide\_htaccess'])) { |
| [58](#L58) | $restrictions[] = array( |
| [59](#L59) | 'pattern' => '/.htaccess/', |
| [60](#L60) | 'read' => false, |
| [61](#L61) | 'write' => false, |
| [62](#L62) | 'hidden' => true, |
| [63](#L63) | 'locked' => false |
| [64](#L64) | ); |
| [65](#L65) | } |
| [66](#L66) |  |
| [67](#L67) | $disable\_commands = array('help', 'preference', 'hide', 'netmount'); |
| [68](#L68) |  |
| [69](#L69) | $config = array(); |
| [70](#L70) |  |
| [71](#L71) | // Configure elfinder |
| [72](#L72) | $config[0] = array( |
| [73](#L73) | 'driver' => 'LocalFileSystem', |
| [74](#L74) | 'path' => $path, |
| [75](#L75) | 'URL' => $url, |
| [76](#L76) | 'winHashFix' => DIRECTORY\_SEPARATOR !== '/', |
| [77](#L77) | 'accessControl' => 'access', |
| [78](#L78) | 'acceptedName' => 'validName', |
| [79](#L79) | 'uploadMaxSize' => 0, |
| [80](#L80) | 'disabled' => $disable\_commands, |
| [81](#L81) | 'attributes' => $restrictions |
| [82](#L82) | ); |
| [83](#L83) |  |
| [84](#L84) | // Is trash enabled? |
| [85](#L85) | if (!empty($fileorganizer->options['enable\_trash'])) { |
| [86](#L86) | $uploads\_dir = wp\_upload\_dir(); |
| [87](#L87) |  |
| [88](#L88) | $trash\_dir = fileorganizer\_cleanpath($uploads\_dir['basedir'].'/fileorganizer/.trash'); |
| [89](#L89) | $trash\_glob = glob($trash\_dir . '-\*/', GLOB\_ONLYDIR); |
| [90](#L90) |  |
| [91](#L91) | if(!empty($trash\_glob) && !empty($trash\_glob[0])){ |
| [92](#L92) | $trash\_dir = $trash\_glob[0]; |
| [93](#L93) | $trash\_name = basename($trash\_dir); |
| [94](#L94) | } |
| [95](#L95) |  |
| [96](#L96) | if(empty($trash\_name) || !file\_exists($trash\_dir)){ |
| [97](#L97) | $randomness = wp\_generate\_password(12, false); |
| [98](#L98) | $trash\_dir .= '-' . $randomness; |
| [99](#L99) | $trash\_name = basename($trash\_dir); |
| [100](#L100) | mkdir($trash\_dir . '/.tmb', 0755, true); |
| [101](#L101) | } |
| [102](#L102) |  |
| [103](#L103) | if(!file\_exists($trash\_dir . '/index.php')){ |
| [104](#L104) | file\_put\_contents($trash\_dir . '/index.php', '<?php //Silence is golden'); |
| [105](#L105) | chmod($trash\_dir . '/index.php', 0444); |
| [106](#L106) | } |
| [107](#L107) |  |
| [108](#L108) | // Configure trash |
| [109](#L109) | $config[1] = array( |
| [110](#L110) | 'id' => '1', |
| [111](#L111) | 'driver' => 'Trash', |
| [112](#L112) | 'path' => $trash\_dir, |
| [113](#L113) | 'tmbURL' => $uploads\_dir['baseurl'].'/fileorganizer/'.$trash\_name.'/.tmb/', |
| [114](#L114) | 'winHashFix' => DIRECTORY\_SEPARATOR !== '/', |
| [115](#L115) | 'uploadDeny' => array(''), |
| [116](#L116) | 'uploadAllow' => array(''), |
| [117](#L117) | 'uploadOrder' => array('deny', 'allow'), |
| [118](#L118) | 'accessControl' => 'access', |
| [119](#L119) | 'disabled' => $disable\_commands, |
| [120](#L120) | 'attributes' => $restrictions, |
| [121](#L121) | ); |
| [122](#L122) | $config[0]['trashHash'] = 't1\_Lw'; |
| [123](#L123) | } |
| [124](#L124) |  |
| [125](#L125) | $config = apply\_filters('fileorganizer\_manager\_config', $config); |
| [126](#L126) |  |
| [127](#L127) | $el\_config = array( |
| [128](#L128) | 'locale' => 'zh\_CN', |
| [129](#L129) | 'debug' => false, |
| [130](#L130) | 'roots' => $config, |
| [131](#L131) | 'bind' => array( |
| [132](#L132) | 'mkdir' => function(&$path, &$name, $src, $elfinder, $volume){ |
| [133](#L133) | global $fileorganizer; |
| [134](#L134) |  |
| [135](#L135) | if(empty($fileorganizer->options['enable\_trash']) || empty($name['added']) || !is\_array($name['added']) || empty($volume)){ |
| [136](#L136) | return; |
| [137](#L137) | } |
| [138](#L138) |  |
| [139](#L139) | foreach($name['added'] as $added){ |
| [140](#L140) | $dir\_path = $volume->realpath($added['hash']); |
| [141](#L141) |  |
| [142](#L142) | if(empty($dir\_path) || strpos($dir\_path, '.trash-') === FALSE){ |
| [143](#L143) | return; |
| [144](#L144) | } |
| [145](#L145) |  |
| [146](#L146) | if(!file\_exists($dir\_path . '/index.php')){ |
| [147](#L147) | file\_put\_contents($dir\_path . '/index.php', '<?php //Silence is golden'); |
| [148](#L148) | chmod($dir\_path . '/index.php', 0444); |
| [149](#L149) | } |
| [150](#L150) | } |
| [151](#L151) | }, |
| [152](#L152) | 'upload.presave' => function(&$path, &$name, $src, $elfinder, $volume) { |
| [153](#L153) |  |
| [154](#L154) | if( !current\_user\_can('activate\_plugins') ) { |
| [155](#L155) | $validate = wp\_check\_filetype( $name ); |
| [156](#L156) |  |
| [157](#L157) | if( $validate['type'] == false ){ |
| [158](#L158) | return array( 'error' => \_\_('File type is not allowed.', 'fileorganizer')); |
| [159](#L159) | } |
| [160](#L160) | } |
| [161](#L161) |  |
| [162](#L162) | if( !current\_user\_can('unfiltered\_html') ) { |
| [163](#L163) |  |
| [164](#L164) | $content = file\_get\_contents($src); |
| [165](#L165) |  |
| [166](#L166) | $is\_xss = ''; |
| [167](#L167) |  |
| [168](#L168) | while(true){ |
| [169](#L169) | $found = fileorganizer\_xss\_content($content); |
| [170](#L170) |  |
| [171](#L171) | if(strlen($found) > 0){ |
| [172](#L172) |  |
| [173](#L173) | // Check if the file is an SVG then allow 'svg', 'xml' tags |
| [174](#L174) | if( in\_array($found, array('svg', 'xml')) && |
| [175](#L175) | ( mime\_content\_type($src) == 'image/svg+xml' || |
| [176](#L176) | in\_array(pathinfo($name, PATHINFO\_EXTENSION), array('svg', 'svgz') ) ) |
| [177](#L177) | ){ |
| [178](#L178) | $content = str\_replace($found, '', $content); |
| [179](#L179) | continue; |
| [180](#L180) | } |
| [181](#L181) |  |
| [182](#L182) | $is\_xss = $found; |
| [183](#L183) | } |
| [184](#L184) |  |
| [185](#L185) | break; |
| [186](#L186) | } |
| [187](#L187) |  |
| [188](#L188) | // Unfiltered\_html cap needs to be checked |
| [189](#L189) | if(strlen($is\_xss) > 0 ){ |
| [190](#L190) | return array( 'error' => \_\_('Following not allowed content found ').' : -"'. $is\_xss .'" in file '.$name); |
| [191](#L191) | } |
| [192](#L192) |  |
| [193](#L193) | } |
| [194](#L194) |  |
| [195](#L195) | return true; |
| [196](#L196) | } |
| [197](#L197) |  |
| [198](#L198) | ) |
| [199](#L199) | ); |
| [200](#L200) |  |
| [201](#L201) | // Load autoloader |
| [202](#L202) | require FILEORGANIZER\_DIR.'/manager/php/autoload.php'; |
| [203](#L203) |  |
| [204](#L204) | // Load FTP driver? |
| [205](#L205) | if(defined('FILEORGANIZER\_PRO') && !empty($fileorganizer->options['enable\_ftp'])){ |
| [206](#L206) | elFinder::$netDrivers['ftp'] = 'FTP'; |
| [207](#L207) | } |
| [208](#L208) |  |
| [209](#L209) | // run elFinder |
| [210](#L210) | $connector = new elFinderConnector(new elFinder($el\_config)); |
| [211](#L211) | $connector->run(); |
| [212](#L212) | } |
| [213](#L213) |  |
| [214](#L214) | // Change fileorganizer theme |
| [215](#L215) | add\_action('wp\_ajax\_fileorganizer\_switch\_theme', 'fileorganizer\_switch\_theme'); |
| [216](#L216) | function fileorganizer\_switch\_theme(){ |
| [217](#L217) |  |
| [218](#L218) | //Check nonce |
| [219](#L219) | check\_admin\_referer( 'fileorganizer\_ajax' , 'fileorganizer\_nonce' ); |
| [220](#L220) |  |
| [221](#L221) | if(!current\_user\_can('manage\_options')){ |
| [222](#L222) | wp\_send\_json(array( 'error' => 'Permision Denide!' ), 400); |
| [223](#L223) | } |
| [224](#L224) |  |
| [225](#L225) | $theme = fileorganizer\_optpost('theme'); |
| [226](#L226) |  |
| [227](#L227) | $options = get\_option('fileorganizer\_options', array()); |
| [228](#L228) | $options['theme'] = $theme; |
| [229](#L229) | update\_option('fileorganizer\_options', $options); |
| [230](#L230) |  |
| [231](#L231) | $theme\_path = !empty($theme) ? '/themes/'.$theme : ''; |
| [232](#L232) |  |
| [233](#L233) | // Return requested theme path |
| [234](#L234) | $path = FILEORGANIZER\_URL.'/manager'.$theme\_path.'/css/theme.css'; |
| [235](#L235) |  |
| [236](#L236) | $response = array( |
| [237](#L237) | 'success' => true, |
| [238](#L238) | 'stylesheet' => $path |
| [239](#L239) | ); |
| [240](#L240) |  |
| [241](#L241) | wp\_send\_json($response, 200); |
| [242](#L242) | } |
| [243](#L243) |  |
| [244](#L244) | add\_action('wp\_ajax\_fileorganizer\_hide\_promo', 'fileorganizer\_hide\_promo'); |
| [245](#L245) | function fileorganizer\_hide\_promo(){ |
| [246](#L246) |  |
| [247](#L247) | //Check nonce |
| [248](#L248) | check\_admin\_referer( 'fileorganizer\_promo\_nonce' , 'security' ); |
| [249](#L249) |  |
| [250](#L250) | // Save value in minus |
| [251](#L251) | update\_option('fileorganizer\_promo\_time', (0 - time())); |
| [252](#L252) | die('DONE'); |
| [253](#L253) | } |
| [254](#L254) |  |
| [255](#L255) | // As per the JS specification |
| [256](#L256) | function fileorganizer\_unescapeHTML($str){ |
| [257](#L257) | $replace = [ |
| [258](#L258) | '#93' => ']', |
| [259](#L259) | '#91' => '[', |
| [260](#L260) | //'#61' => '=', |
| [261](#L261) | 'lt' => '<', |
| [262](#L262) | 'gt' => '>', |
| [263](#L263) | 'quot' => '"', |
| [264](#L264) | //'amp' => '&', |
| [265](#L265) | '#39' => '\'', |
| [266](#L266) | '#92' => '\\' |
| [267](#L267) | ]; |
| [268](#L268) |  |
| [269](#L269) | foreach($replace as $k => $v){ |
| [270](#L270) | $str = str\_replace('&'.$k.';', $v, $str); |
| [271](#L271) | } |
| [272](#L272) | return $str; |
| [273](#L273) | } |
| [274](#L274) |  |
| [275](#L275) | // Check for XSS codes in our shortcodes submitted |
| [276](#L276) | function fileorganizer\_xss\_content($data){ |
| [277](#L277) | $data = fileorganizer\_unescapeHTML($data); |
| [278](#L278) | $data = preg\_split('/\s/', $data); |
| [279](#L279) | $data = implode('', $data); |
| [280](#L280) | //echo $data; |
| [281](#L281) |  |
| [282](#L282) | // For PDF file |
| [283](#L283) | if(preg\_match('/\/JavaScript/is', $data)){ |
| [284](#L284) | return '/JavaScript'; |
| [285](#L285) | } |
| [286](#L286) |  |
| [287](#L287) | // This is also for PDF file |
| [288](#L288) | if(preg\_match('/\/JS/is', $data)){ |
| [289](#L289) | return '/JS'; |
| [290](#L290) | } |
| [291](#L291) |  |
| [292](#L292) | if(preg\_match('/["\']javascript\:/is', $data)){ |
| [293](#L293) | return 'javascript'; |
| [294](#L294) | } |
| [295](#L295) |  |
| [296](#L296) | if(preg\_match('/["\']vbscript\:/is', $data)){ |
| [297](#L297) | return 'vbscript'; |
| [298](#L298) | } |
| [299](#L299) |  |
| [300](#L300) | if(preg\_match('/\-moz\-binding\:/is', $data)){ |
| [301](#L301) | return '-moz-binding'; |
| [302](#L302) | } |
| [303](#L303) |  |
| [304](#L304) | if(preg\_match('/expression\(/is', $data)){ |
| [305](#L305) | return 'expression'; |
| [306](#L306) | } |
| [307](#L307) |  |
| [308](#L308) | if(preg\_match('/\<(iframe|frame|script|style|link|applet|embed|xml|svg|object|layer|ilayer|meta)/is', $data, $matches)){ |
| [309](#L309) | return $matches[1]; |
| [310](#L310) | } |
| [311](#L311) |  |
| [312](#L312) | // These events not start with on |
| [313](#L313) | $not\_allowed = array('click', 'dblclick', 'mousedown', 'mousemove', 'mouseout', 'mouseover', 'mouseup', 'load', 'unload', 'change', 'submit', 'reset', 'select', 'blur', 'focus', 'keydown', 'keypress', 'keyup', 'afterprint', 'beforeprint', 'beforeunload', 'error', 'hashchange', 'message', 'offline', 'online', 'pagehide', 'pageshow', 'popstate', 'resize', 'storage', 'contextmenu', 'input', 'invalid', 'search', 'mousewheel', 'wheel', 'drag', 'dragend', 'dragenter', 'dragleave', 'dragover', 'dragstart', 'drop', 'scroll', 'copy', 'cut', 'paste', 'abort', 'canplay', 'canplaythrough', 'cuechange', 'durationchange', 'emptied', 'ended', 'loadeddata', 'loadedmetadata', 'loadstart', 'pause', 'play', 'playing', 'progress', 'ratechange', 'seeked', 'seeking', 'stalled', 'suspend', 'timeupdate', 'volumechange', 'waiting', 'toggle', 'animationstart', 'animationcancel', 'animationend', 'animationiteration', 'auxclick', 'beforeinput', 'beforematch', 'beforexrselect', 'compositionend', 'compositionstart', 'compositionupdate', 'contentvisibilityautostatechange', 'focusout', 'focusin', 'fullscreenchange', 'fullscreenerror', 'gotpointercapture', 'lostpointercapture', 'mouseenter', 'mouseleave', 'pointercancel', 'pointerdown', 'pointerenter', 'pointerleave', 'pointermove', 'pointerout', 'pointerover', 'pointerrawupdate', 'pointerup', 'scrollend', 'securitypolicyviolation', 'touchcancel', 'touchend', 'touchmove', 'touchstart', 'transitioncancel', 'transitionend', 'transitionrun', 'transitionstart', 'MozMousePixelScroll', 'DOMActivate', 'afterscriptexecute', 'beforescriptexecute', 'DOMMouseScroll', 'willreveal', 'gesturechange', 'gestureend', 'gesturestart', 'mouseforcechanged', 'mouseforcedown', 'mouseforceup', 'mouseforceup'); |
| [314](#L314) |  |
| [315](#L315) | $not\_allowed = implode('|', $not\_allowed); |
| [316](#L316) |  |
| [317](#L317) | if(preg\_match('/(on|onwebkit)+('.($not\_allowed).')=/is', $data, $matches)){ |
| [318](#L318) | return $matches[1]+$matches[2]; |
| [319](#L319) | } |
| [320](#L320) |  |
| [321](#L321) | return; |
| [322](#L322) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/fileorganizer/trunk/main/ajax.php?format=txt)
* [Original Format](/export/3220643/fileorganizer/trunk/main/ajax.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


