=== Content from plugins.trac.wordpress.org_d3e5908e_20250110_154814.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3003556%2Fcontact-form-7)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2996751/contact-form-7 "Changeset 2996751 for contact-form-7")
* [Next Change](/changeset/3003558/contact-form-7 "Changeset 3003558 for contact-form-7") →

---

# Changeset [3003556](/changeset/3003556 "Show full changeset") for [contact-form-7](/browser/contact-form-7?rev=3003556 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
11/30/2023 05:25:27 AM
([14 months](/timeline?from=2023-11-30T05%3A25%3A27Z&precision=second "See timeline at 11/30/2023 05:25:27 AM") ago)

Author:
takayukister
Message:

Merge changes on GitHub [​https://github.com/takayukister/contact-form-7](https://github.com/takayukister/contact-form-7)

Location:
[contact-form-7/trunk](/browser/contact-form-7/trunk?rev=3003556)
Files:

4 edited

* [includes/formatting.php](/browser/contact-form-7/trunk/includes/formatting.php?rev=3003556 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [includes/swv/rules/file.php](/browser/contact-form-7/trunk/includes/swv/rules/file.php?rev=3003556 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [readme.txt](/browser/contact-form-7/trunk/readme.txt?rev=3003556 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [wp-contact-form-7.php](/browser/contact-form-7/trunk/wp-contact-form-7.php?rev=3003556 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [contact-form-7/trunk/includes/formatting.php](/changeset/3003556/contact-form-7/trunk/includes/formatting.php "Show the changeset 3003556 restricted to contact-form-7/trunk/includes/formatting.php")

  | [r2972540](/browser/contact-form-7/trunk/includes/formatting.php?rev=2972540#L275 "Show revision 2972540 of this file in browser") | [r3003556](/browser/contact-form-7/trunk/includes/formatting.php?rev=3003556#L275 "Show revision 3003556 of this file in browser") |  |
  | --- | --- | --- |
  | 275 | 275 | function wpcf7\_antiscript\_file\_name( $filename ) { |
  | 276 | 276 | $filename = wp\_basename( $filename ); |
  |  | 277 |  |
  |  | 278 | // Apply part of protection logic from sanitize\_file\_name(). |
  |  | 279 | $filename = str\_replace( |
  |  | 280 | array( |
  |  | 281 | '?', '[', ']', '/', '\\', '=', '<', '>', ':', ';', ',', "'", '"', |
  |  | 282 | '&', '$', '#', '\*', '(', ')', '|', '~', '`', '!', '{', '}', |
  |  | 283 | '%', '+', '’', '«', '»', '”', '“', chr( 0 ) |
  |  | 284 | ), |
  |  | 285 | '', |
  |  | 286 | $filename |
  |  | 287 | ); |
  | 277 | 288 |  |
  | 278 | 289 | $filename = preg\_replace( '/[\r\n\t -]+/', '-', $filename ); |
* ## [contact-form-7/trunk/includes/swv/rules/file.php](/changeset/3003556/contact-form-7/trunk/includes/swv/rules/file.php "Show the changeset 3003556 restricted to contact-form-7/trunk/includes/swv/rules/file.php")

  | [r2948098](/browser/contact-form-7/trunk/includes/swv/rules/file.php?rev=2948098#L26 "Show revision 2948098 of this file in browser") | [r3003556](/browser/contact-form-7/trunk/includes/swv/rules/file.php?rev=3003556#L26 "Show revision 3003556 of this file in browser") |  |
  | --- | --- | --- |
  | 26 | 26 |  |
  | 27 | 27 | foreach ( (array) $this->get\_property( 'accept' ) as $accept ) { |
  | 28 |  | if ( ~~false === strpos( $accept, '/'~~ ) ) { |
  |  | 28 | if ( preg\_match( '/^\.[a-z0-9]+$/i', $accept ) ) { |
  | 29 | 29 | $acceptable\_filetypes[] = strtolower( $accept ); |
  | 30 | 30 | } else { |
* ## [contact-form-7/trunk/readme.txt](/changeset/3003556/contact-form-7/trunk/readme.txt "Show the changeset 3003556 restricted to contact-form-7/trunk/readme.txt")

  | [r2996749](/browser/contact-form-7/trunk/readme.txt?rev=2996749#L79 "Show revision 2996749 of this file in browser") | [r3003556](/browser/contact-form-7/trunk/readme.txt?rev=3003556#L79 "Show revision 3003556 of this file in browser") |  |
  | --- | --- | --- |
  | 79 | 79 | For more information, see [Releases](https://contactform7.com/category/releases/). |
  | 80 | 80 |  |
  |  | 81 | = 5.8.4 = |
  |  | 82 |  |
  |  | 83 | [https://contactform7.com/contact-form-7-584/](https://contactform7.com/contact-form-7-584/) |
  |  | 84 |  |
  | 81 | 85 | = 5.8.3 = |
  | 82 | 86 |  |
* ## [contact-form-7/trunk/wp-contact-form-7.php](/changeset/3003556/contact-form-7/trunk/wp-contact-form-7.php "Show the changeset 3003556 restricted to contact-form-7/trunk/wp-contact-form-7.php")

  | [r2996747](/browser/contact-form-7/trunk/wp-contact-form-7.php?rev=2996747#L8 "Show revision 2996747 of this file in browser") | [r3003556](/browser/contact-form-7/trunk/wp-contact-form-7.php?rev=3003556#L8 "Show revision 3003556 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* License: GPL v2 or later |
  | 9 | 9 | \* License URI: https://www.gnu.org/licenses/gpl-2.0.html |
  | 10 |  | \* Version: 5.8.~~3~~ |
  |  | 10 | \* Version: 5.8.4 |
  | 11 | 11 | \* Requires at least: 6.2 |
  | 12 | 12 | \* Requires PHP: 7.4 |
  | 13 | 13 | \*/ |
  | 14 | 14 |  |
  | 15 |  | define( 'WPCF7\_VERSION', '5.8.~~3~~' ); |
  |  | 15 | define( 'WPCF7\_VERSION', '5.8.4' ); |
  | 16 | 16 |  |
  | 17 | 17 | define( 'WPCF7\_REQUIRED\_WP\_VERSION', '6.2' ); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3003556)
* [Zip Archive](?format=zip&new=3003556)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from contactform7.com_7f591aff_20250110_154809.html ===

[![Contact Form 7](https://contactform7.com/wp-content/themes/cf7com-2014/header.png)](https://contactform7.com/)

# [Contact Form 7](https://contactform7.com/)

[Search](#search-container)

Primary Menu
[Skip to content](#content)

* [Docs](https://contactform7.com/docs/)
* [FAQ](https://contactform7.com/faq/)
* [Support](https://contactform7.com/support/)
* [Contact](https://contactform7.com/contact/)
* [Donate](https://contactform7.com/donate/)
* [Download](https://contactform7.com/download/)

Search for:

[Releases](https://contactform7.com/category/releases/), [Security](https://contactform7.com/category/security/)
## [Contact Form 7 5.8.4](https://contactform7.com/2023/11/30/contact-form-7-584/)

[November 30, 2023](https://contactform7.com/2023/11/30/contact-form-7-584/) [Takayuki Miyoshi](https://contactform7.com/author/miyoshi/)

Contact Form 7 version 5.8.4 is now available. This minor update release addresses a medium severity security issue recently reported.

A vulnerability related to file uploading was [reported](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/contact-form-7/contact-form-7-583-authenticated-editor-arbitrary-file-upload) by Wordfence vulnerability researcher István Márton. To avoid the security risk, upgrade Contact Form 7 to 5.8.4 or later as soon as possible.

In the report it is pointed out that an add-on plugin called “Redirection for Contact Form 7” deliberately disables the safety mechanism of Contact Form 7, and, as a result, amplifies the risk of the vulnerability. Considering the maliciousness that this fact implies, and the [prominent number of vulnerabilities](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wpcf7-redirect) reported about this plugin in the past, we strongly recommend you stop using the “Redirection for Contact Form 7” ([wpcf7-redirect](https://wordpress.org/plugins/wpcf7-redirect/)) plugin.

**Requires:** WordPress 6.2 or higher

**Tested up to:** WordPress 6.4.1

**[» Download Contact Form 7 plugin from WordPress.org](https://wordpress.org/plugins/contact-form-7/)**

You can browse the full list of changes on [GitHub](https://github.com/takayukister/contact-form-7/compare/v5.8.3...v5.8.4).

### Share this:

* [Facebook](https://contactform7.com/2023/11/30/contact-form-7-584/?share=facebook "Click to share on Facebook")
* [X](https://contactform7.com/2023/11/30/contact-form-7-584/?share=x "Click to share on X")
### Like this:

Like Loading...

# Post navigation

[Previous PostContact Form 7 5.8.3](https://contactform7.com/2023/11/16/contact-form-7-583/)[Next PostForm status](https://contactform7.com/2023/12/17/form-status/)

[advertise here](https://contactform7.com/advertise/)

> [We recommend Kinsta hosting.](https://contactform7.com/2023/04/10/we-recommend-kinsta-hosting/)

# Language Switcher

* [English](https://contactform7.com/2023/11/30/contact-form-7-584/ "English")
* Español
* [日本語](https://contactform7.com/ja/2023/11/30/contact-form-7-584/ "Japanese")

# Recent Posts

* [Complete removal of Constant Contact integration](https://contactform7.com/2025/01/08/complete-removal-of-constant-contact-integration/)
* [Suggesting telephone country codes](https://contactform7.com/2024/12/06/suggesting-telephone-country-codes/)
* [Contact Form 7 6.0.1](https://contactform7.com/2024/11/27/contact-form-7-601/)
* [Contact Form 7 6.0](https://contactform7.com/2024/11/03/contact-form-7-60/)
* [Opinions on plugins, install other plugins](https://contactform7.com/2024/09/18/opinions-on-plugins-install-other-plugins/)
# Categories

* [Announcement](https://contactform7.com/category/announcement/)
* [Developer's cookbook](https://contactform7.com/category/cookbook/)
* [Opinions](https://contactform7.com/category/opinions/)
* [Releases](https://contactform7.com/category/releases/)
* [Security](https://contactform7.com/category/security/)
* [Tips](https://contactform7.com/category/tips/)
* [Troubleshooting](https://contactform7.com/category/troubleshooting/)
# About Contact Form 7

* [Trademark policy](https://contactform7.com/trademark-policy/)
* [Privacy policy](https://contactform7.com/privacy-policy/)
* [Advertise on this site](https://contactform7.com/advertise/)

## Just another contact form plugin for WordPress. Simple but flexible.

[© Rock Lobster, LLC.](https://rocklobster.in/)
[Proudly powered by WordPress](https://wordpress.org/)

%d



=== Content from www.wordfence.com_4949ab52_20250110_154815.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Contact Form 7 <= 5.8.3 - Authenticated (Editor+) Arbitrary File Upload

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Contact Form 7 <= 5.8.3 - Authenticated (Editor+) Arbitrary File Upload

6.6

**Unrestricted Upload of File with Dangerous Type**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2023-6449](https://www.cve.org/CVERecord?id=CVE-2023-6449) |
| --- | --- |
| CVSS | 6.6 (Medium) |
| Publicly Published | November 30, 2023 |
| Last Updated | December 1, 2023 |
| Researcher | [István Márton - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/lana-codes) |

### Description

The Contact Form 7 plugin for WordPress is vulnerable to arbitrary file uploads due to insufficient file type validation in the 'validate' function and insufficient blocklisting on the 'wpcf7\_antiscript\_file\_name' function in versions up to, and including, 5.8.3. This makes it possible for authenticated attackers with editor-level capabilities or above to upload arbitrary files on the affected site's server, but due to the htaccess configuration, remote code cannot be executed in most cases. By default, the file will be deleted from the server immediately. However, in some cases, other plugins may make it possible for the file to live on the server longer. This can make remote code execution possible when combined with another vulnerability, such as local file inclusion.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/contact-form-7/tags/5.8.3/includes/formatting.php#L275)
* [github.com](https://github.com/rocklobster-in/contact-form-7/compare/v5.8.3...v5.8.4)
* [contactform7.com](https://contactform7.com/2023/11/30/contact-form-7-584/)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3003556/contact-form-7)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcontact-form-7%2Fcontact-form-7-583-authenticated-editor-arbitrary-file-upload&t=Contact%20Form%207%20%3C%3D%205.8.3%20-%20Authenticated%20%28Editor%2B%29%20Arbitrary%20File%20Upload "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcontact-form-7%2Fcontact-form-7-583-authenticated-editor-arbitrary-file-upload&text=Contact%20Form%207%20%3C%3D%205.8.3%20-%20Authenticated%20%28Editor%2B%29%20Arbitrary%20File%20Upload "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcontact-form-7%2Fcontact-form-7-583-authenticated-editor-arbitrary-file-upload "LinkedIn")
Email

## Vulnerability Details for Contact Form 7

#### [Contact Form 7](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/contact-form-7)

| Software Type | Plugin |
| --- | --- |
| Software Slug | contact-form-7 [(view on wordpress.org)](https://wordpress.org/plugins/contact-form-7) |
| Patched? | Yes |
| Remediation | Update to version 5.8.4, or a newer patched version |
| Affected Version | * <= 5.8.3 |
| Patched Version | * 5.8.4 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from github.com_ab1956cd_20250110_154810.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frocklobster-in%2Fcontact-form-7%2Fcompare%2Fv5.8.3...v5.8.4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frocklobster-in%2Fcontact-form-7%2Fcompare%2Fv5.8.3...v5.8.4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcompare%2Fshow&source=header-repo&source_repo=rocklobster-in%2Fcontact-form-7)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rocklobster-in](/rocklobster-in)
/
**[contact-form-7](/rocklobster-in/contact-form-7)**
Public

* [Notifications](/login?return_to=%2Frocklobster-in%2Fcontact-form-7) You must be signed in to change notification settings
* [Fork
  147](/login?return_to=%2Frocklobster-in%2Fcontact-form-7)
* [Star
   292](/login?return_to=%2Frocklobster-in%2Fcontact-form-7)

* [Code](/rocklobster-in/contact-form-7)
* [Issues
  11](/rocklobster-in/contact-form-7/issues)
* [Pull requests
  0](/rocklobster-in/contact-form-7/pulls)
* [Actions](/rocklobster-in/contact-form-7/actions)
* [Projects
  0](/rocklobster-in/contact-form-7/projects)
* [Security](/rocklobster-in/contact-form-7/security)
* [Insights](/rocklobster-in/contact-form-7/pulse)

Additional navigation options

* [Code](/rocklobster-in/contact-form-7)
* [Issues](/rocklobster-in/contact-form-7/issues)
* [Pull requests](/rocklobster-in/contact-form-7/pulls)
* [Actions](/rocklobster-in/contact-form-7/actions)
* [Projects](/rocklobster-in/contact-form-7/projects)
* [Security](/rocklobster-in/contact-form-7/security)
* [Insights](/rocklobster-in/contact-form-7/pulse)

[Permalink](https://github.com/rocklobster-in/contact-form-7/compare/rocklobster-in%3A6bb8237...rocklobster-in%3A7bb6134)
# Comparing changes

 Choose two branches to see what’s changed or to start a new pull request.
If you need to, you can also  compare across forks
 or
[learn more about diff comparisons](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

# Open a pull request

 Create a new pull request by comparing changes across two branches. If you need to, you can also  compare across forks
.
[Learn more about diff comparisons here](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

*base repository:*
rocklobster-in/contact-form-7

Failed to load repositories. Confirm that selected base ref is valid, then try again.

 Loading

*base:*
v5.8.3

Choose a base ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/rocklobster-in/contact-form-7/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.8.4)

Could not load tags

Nothing to show

[{{ refName }}
default](/rocklobster-in/contact-form-7/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.8.4)

 Loading

...

*head repository:*
rocklobster-in/contact-form-7

Failed to load repositories. Confirm that selected head ref is valid, then try again.

 Loading

*compare:*
v5.8.4

Choose a head ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/rocklobster-in/contact-form-7/compare/v5.8.3...%7B%7B%20urlEncodedRefName%20%7D%7D)

Could not load tags

Nothing to show

[{{ refName }}
default](/rocklobster-in/contact-form-7/compare/v5.8.3...%7B%7B%20urlEncodedRefName%20%7D%7D)

 Loading

* 4

  commits
* 6

  files changed
* 1

  contributor

### Commits on Nov 28, 2023

1. [Improve file type validation](/rocklobster-in/contact-form-7/commit/1d47467f36f5f73095c0090c3fd1f579bbc08a0a)
    …

   ```
   [#1329](https://github.com/rocklobster-in/contact-form-7/issues/1329)
   ```

   [![@takayukister](https://avatars.githubusercontent.com/u/4035394?s=40&v=4)](/takayukister)

   [takayukister](/rocklobster-in/contact-form-7/commits?author=takayukister "View all commits by takayukister")
   committed
   Nov 28, 2023

   Configuration menu

   * [View commit details](/rocklobster-in/contact-form-7/commit/1d47467f36f5f73095c0090c3fd1f579bbc08a0a)
   * Copy full SHA for 1d47467
   * [Browse repository at this point](/rocklobster-in/contact-form-7/tree/1d47467f36f5f73095c0090c3fd1f579bbc08a0a)

   Copy the full SHA

    [1d47467](/rocklobster-in/contact-form-7/commit/1d47467f36f5f73095c0090c3fd1f579bbc08a0a)View commit details

   Browse the repository at this point in the history

### Commits on Nov 29, 2023

1. [Apply part of protection from sanitize\_file\_name()](/rocklobster-in/contact-form-7/commit/fafc2e37559471b86336a8fbb40d38dd0b5314fc)
    …

   ```
   [#1329](https://github.com/rocklobster-in/contact-form-7/issues/1329)
   ```

   [![@takayukister](https://avatars.githubusercontent.com/u/4035394?s=40&v=4)](/takayukister)

   [takayukister](/rocklobster-in/contact-form-7/commits?author=takayukister "View all commits by takayukister")
   committed
   Nov 29, 2023

   Configuration menu

   * [View commit details](/rocklobster-in/contact-form-7/commit/fafc2e37559471b86336a8fbb40d38dd0b5314fc)
   * Copy full SHA for fafc2e3
   * [Browse repository at this point](/rocklobster-in/contact-form-7/tree/fafc2e37559471b86336a8fbb40d38dd0b5314fc)

   Copy the full SHA

    [fafc2e3](/rocklobster-in/contact-form-7/commit/fafc2e37559471b86336a8fbb40d38dd0b5314fc)View commit details

   Browse the repository at this point in the history

### Commits on Nov 30, 2023

1. [Update node\_modules](/rocklobster-in/contact-form-7/commit/9202ac46a88d88123df5f0f9aea7d1dcc5f82152)
    …

   ```
   [#1330](https://github.com/rocklobster-in/contact-form-7/issues/1330)
   ```

   [![@takayukister](https://avatars.githubusercontent.com/u/4035394?s=40&v=4)](/takayukister)

   [takayukister](/rocklobster-in/contact-form-7/commits?author=takayukister "View all commits by takayukister")
   committed
   Nov 30, 2023

   Configuration menu

   * [View commit details](/rocklobster-in/contact-form-7/commit/9202ac46a88d88123df5f0f9aea7d1dcc5f82152)
   * Copy full SHA for 9202ac4
   * [Browse repository at this point](/rocklobster-in/contact-form-7/tree/9202ac46a88d88123df5f0f9aea7d1dcc5f82152)

   Copy the full SHA

    [9202ac4](/rocklobster-in/contact-form-7/commit/9202ac46a88d88123df5f0f9aea7d1dcc5f82152)View commit details

   Browse the repository at this point in the history
2. [Prepare for 5.8.4 release](/rocklobster-in/contact-form-7/commit/7bb6134da7917fef23cd185831574c264fe6b1f0)
    …

   ```
   [#1330](https://github.com/rocklobster-in/contact-form-7/issues/1330)
   ```

   [![@takayukister](https://avatars.githubusercontent.com/u/4035394?s=40&v=4)](/takayukister)

   [takayukister](/rocklobster-in/contact-form-7/commits?author=takayukister "View all commits by takayukister")
   committed
   Nov 30, 2023

   Configuration menu

   * [View commit details](/rocklobster-in/contact-form-7/commit/7bb6134da7917fef23cd185831574c264fe6b1f0)
   * Copy full SHA for 7bb6134
   * [Browse repository at this point](/rocklobster-in/contact-form-7/tree/7bb6134da7917fef23cd185831574c264fe6b1f0)

   Copy the full SHA

    [7bb6134](/rocklobster-in/contact-form-7/commit/7bb6134da7917fef23cd185831574c264fe6b1f0)View commit details

   Browse the repository at this point in the history

 Loading

### This comparison is taking too long to generate.

Unfortunately it looks like we can’t render this comparison for you right now. It might be too big, or there might be something weird with your repository.

You can try running this command locally to see the comparison on your machine:

`git diff v5.8.3...v5.8.4`

  Retry

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from plugins.trac.wordpress.org_f5033ff8_20250110_154813.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fcontact-form-7%2Ftags%2F5.8.3%2Fincludes%2Fformatting.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/contact-form-7/trunk/includes/formatting.php?rev=2919422 "Revision 2919422")
* [Next Revision](/browser/contact-form-7/trunk/includes/formatting.php?rev=3003556 "Revision 3003556") →
* [Blame](/browser/contact-form-7/trunk/includes/formatting.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/contact-form-7/tags/5.8.3/includes/formatting.php)

---

# [source:](/browser?order=name "Go to repository root") [contact-form-7](/browser/contact-form-7?order=name "View contact-form-7")/[tags](/browser/contact-form-7/tags?order=name "View tags")/[5.8.3](/browser/contact-form-7/tags/5.8.3?order=name "View 5.8.3")/[includes](/browser/contact-form-7/tags/5.8.3/includes?order=name "View includes")/[formatting.php](/browser/contact-form-7/tags/5.8.3/includes/formatting.php?order=name "View formatting.php")

View diff against:

View revision:

| [Last change](/changeset/2972540/contact-form-7/trunk/includes/formatting.php "View differences") on this file was [2972540](/changeset/2972540/ "View changeset 2972540"), checked in by takayukister, [16 months ago](/timeline?from=2023-09-28T08%3A55%3A42Z&precision=second "See timeline at 09/28/2023 08:55:42 AM") |
| --- |
| Merge changes on GitHub [​https://github.com/takayukister/contact-form-7](https://github.com/takayukister/contact-form-7) |
| **File size:** 12.1 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | /\*\* |
| [4](#L4) | \* Replaces double line breaks with paragraph elements. |
| [5](#L5) | \* |
| [6](#L6) | \* @param string $input The text which has to be formatted. |
| [7](#L7) | \* @param bool $br Optional. If set, this will convert all remaining |
| [8](#L8) | \*             line breaks after paragraphing. Default true. |
| [9](#L9) | \* @return string Text which has been converted into correct paragraph tags. |
| [10](#L10) | \*/ |
| [11](#L11) | function wpcf7\_autop( $input, $br = true ) { |
| [12](#L12) | $placeholders = array(); |
| [13](#L13) |  |
| [14](#L14) | // Replace non-HTML embedded elements with placeholders. |
| [15](#L15) | $input = preg\_replace\_callback( |
| [16](#L16) | '/<(math|svg).\*?<\/\1>/is', |
| [17](#L17) | static function ( $matches ) use ( &$placeholders ) { |
| [18](#L18) | $placeholder = sprintf( |
| [19](#L19) | '<%1$s id="%2$s" />', |
| [20](#L20) | WPCF7\_HTMLFormatter::placeholder\_inline, |
| [21](#L21) | sha1( $matches[0] ) |
| [22](#L22) | ); |
| [23](#L23) |  |
| [24](#L24) | list( $placeholder ) = |
| [25](#L25) | WPCF7\_HTMLFormatter::normalize\_start\_tag( $placeholder ); |
| [26](#L26) |  |
| [27](#L27) | $placeholders[$placeholder] = $matches[0]; |
| [28](#L28) |  |
| [29](#L29) | return $placeholder; |
| [30](#L30) | }, |
| [31](#L31) | $input |
| [32](#L32) | ); |
| [33](#L33) |  |
| [34](#L34) | $formatter = new WPCF7\_HTMLFormatter( array( |
| [35](#L35) | 'auto\_br' => $br, |
| [36](#L36) | ) ); |
| [37](#L37) |  |
| [38](#L38) | $chunks = $formatter->separate\_into\_chunks( $input ); |
| [39](#L39) |  |
| [40](#L40) | $output = $formatter->format( $chunks ); |
| [41](#L41) |  |
| [42](#L42) | // Restore from placeholders. |
| [43](#L43) | $output = str\_replace( |
| [44](#L44) | array\_keys( $placeholders ), |
| [45](#L45) | array\_values( $placeholders ), |
| [46](#L46) | $output |
| [47](#L47) | ); |
| [48](#L48) |  |
| [49](#L49) | return $output; |
| [50](#L50) | } |
| [51](#L51) |  |
| [52](#L52) |  |
| [53](#L53) | /\*\* |
| [54](#L54) | \* Newline preservation help function for wpcf7\_autop(). |
| [55](#L55) | \* |
| [56](#L56) | \* @deprecated 5.7 Unnecessary to use any more. |
| [57](#L57) | \* |
| [58](#L58) | \* @param array $matches preg\_replace\_callback() matches array. |
| [59](#L59) | \* @return string Text including newline placeholders. |
| [60](#L60) | \*/ |
| [61](#L61) | function wpcf7\_autop\_preserve\_newline\_callback( $matches ) { |
| [62](#L62) | return str\_replace( "\n", '<WPPreserveNewline />', $matches[0] ); |
| [63](#L63) | } |
| [64](#L64) |  |
| [65](#L65) |  |
| [66](#L66) | /\*\* |
| [67](#L67) | \* Sanitizes the query variables. |
| [68](#L68) | \* |
| [69](#L69) | \* @param string $text Query variable. |
| [70](#L70) | \* @return string Text sanitized. |
| [71](#L71) | \*/ |
| [72](#L72) | function wpcf7\_sanitize\_query\_var( $text ) { |
| [73](#L73) | $text = wp\_unslash( $text ); |
| [74](#L74) | $text = wp\_check\_invalid\_utf8( $text ); |
| [75](#L75) |  |
| [76](#L76) | if ( false !== strpos( $text, '<' ) ) { |
| [77](#L77) | $text = wp\_pre\_kses\_less\_than( $text ); |
| [78](#L78) | $text = wp\_strip\_all\_tags( $text ); |
| [79](#L79) | } |
| [80](#L80) |  |
| [81](#L81) | $text = preg\_replace( '/%[a-f0-9]{2}/i', '', $text ); |
| [82](#L82) | $text = preg\_replace( '/ +/', ' ', $text ); |
| [83](#L83) | $text = trim( $text, ' ' ); |
| [84](#L84) |  |
| [85](#L85) | return $text; |
| [86](#L86) | } |
| [87](#L87) |  |
| [88](#L88) |  |
| [89](#L89) | /\*\* |
| [90](#L90) | \* Strips quote characters surrounding the input. |
| [91](#L91) | \* |
| [92](#L92) | \* @param string $text Input text. |
| [93](#L93) | \* @return string Processed output. |
| [94](#L94) | \*/ |
| [95](#L95) | function wpcf7\_strip\_quote( $text ) { |
| [96](#L96) | $text = trim( $text ); |
| [97](#L97) |  |
| [98](#L98) | if ( preg\_match( '/^"(.\*)"$/s', $text, $matches ) ) { |
| [99](#L99) | $text = $matches[1]; |
| [100](#L100) | } elseif ( preg\_match( "/^'(.\*)'$/s", $text, $matches ) ) { |
| [101](#L101) | $text = $matches[1]; |
| [102](#L102) | } |
| [103](#L103) |  |
| [104](#L104) | return $text; |
| [105](#L105) | } |
| [106](#L106) |  |
| [107](#L107) |  |
| [108](#L108) | /\*\* |
| [109](#L109) | \* Navigates through an array, object, or scalar, and |
| [110](#L110) | \* strips quote characters surrounding the each value. |
| [111](#L111) | \* |
| [112](#L112) | \* @param mixed $input The array or string to be processed. |
| [113](#L113) | \* @return mixed Processed value. |
| [114](#L114) | \*/ |
| [115](#L115) | function wpcf7\_strip\_quote\_deep( $input ) { |
| [116](#L116) | if ( is\_string( $input ) ) { |
| [117](#L117) | return wpcf7\_strip\_quote( $input ); |
| [118](#L118) | } |
| [119](#L119) |  |
| [120](#L120) | if ( is\_array( $input ) ) { |
| [121](#L121) | $result = array(); |
| [122](#L122) |  |
| [123](#L123) | foreach ( $input as $key => $text ) { |
| [124](#L124) | $result[$key] = wpcf7\_strip\_quote\_deep( $text ); |
| [125](#L125) | } |
| [126](#L126) |  |
| [127](#L127) | return $result; |
| [128](#L128) | } |
| [129](#L129) | } |
| [130](#L130) |  |
| [131](#L131) |  |
| [132](#L132) | /\*\* |
| [133](#L133) | \* Normalizes newline characters. |
| [134](#L134) | \* |
| [135](#L135) | \* @param string $text Input text. |
| [136](#L136) | \* @param string $to Optional. The newline character that is used in the output. |
| [137](#L137) | \* @return string Normalized text. |
| [138](#L138) | \*/ |
| [139](#L139) | function wpcf7\_normalize\_newline( $text, $to = "\n" ) { |
| [140](#L140) | if ( ! is\_string( $text ) ) { |
| [141](#L141) | return $text; |
| [142](#L142) | } |
| [143](#L143) |  |
| [144](#L144) | $nls = array( "\r\n", "\r", "\n" ); |
| [145](#L145) |  |
| [146](#L146) | if ( ! in\_array( $to, $nls ) ) { |
| [147](#L147) | return $text; |
| [148](#L148) | } |
| [149](#L149) |  |
| [150](#L150) | return str\_replace( $nls, $to, $text ); |
| [151](#L151) | } |
| [152](#L152) |  |
| [153](#L153) |  |
| [154](#L154) | /\*\* |
| [155](#L155) | \* Navigates through an array, object, or scalar, and |
| [156](#L156) | \* normalizes newline characters in the each value. |
| [157](#L157) | \* |
| [158](#L158) | \* @param mixed $input The array or string to be processed. |
| [159](#L159) | \* @param string $to Optional. The newline character that is used in the output. |
| [160](#L160) | \* @return mixed Processed value. |
| [161](#L161) | \*/ |
| [162](#L162) | function wpcf7\_normalize\_newline\_deep( $input, $to = "\n" ) { |
| [163](#L163) | if ( is\_array( $input ) ) { |
| [164](#L164) | $result = array(); |
| [165](#L165) |  |
| [166](#L166) | foreach ( $input as $key => $text ) { |
| [167](#L167) | $result[$key] = wpcf7\_normalize\_newline\_deep( $text, $to ); |
| [168](#L168) | } |
| [169](#L169) |  |
| [170](#L170) | return $result; |
| [171](#L171) | } |
| [172](#L172) |  |
| [173](#L173) | return wpcf7\_normalize\_newline( $input, $to ); |
| [174](#L174) | } |
| [175](#L175) |  |
| [176](#L176) |  |
| [177](#L177) | /\*\* |
| [178](#L178) | \* Strips newline characters. |
| [179](#L179) | \* |
| [180](#L180) | \* @param string $text Input text. |
| [181](#L181) | \* @return string Processed one-line text. |
| [182](#L182) | \*/ |
| [183](#L183) | function wpcf7\_strip\_newline( $text ) { |
| [184](#L184) | $text = (string) $text; |
| [185](#L185) | $text = str\_replace( array( "\r", "\n" ), '', $text ); |
| [186](#L186) | return trim( $text ); |
| [187](#L187) | } |
| [188](#L188) |  |
| [189](#L189) |  |
| [190](#L190) | /\*\* |
| [191](#L191) | \* Canonicalizes text. |
| [192](#L192) | \* |
| [193](#L193) | \* @param string $text Input text. |
| [194](#L194) | \* @param string|array|object $args Options. |
| [195](#L195) | \* @return string Canonicalized text. |
| [196](#L196) | \*/ |
| [197](#L197) | function wpcf7\_canonicalize( $text, $args = '' ) { |
| [198](#L198) | // for back-compat |
| [199](#L199) | if ( is\_string( $args ) and '' !== $args |
| [200](#L200) | and false === strpos( $args, '=' ) ) { |
| [201](#L201) | $args = array( |
| [202](#L202) | 'strto' => $args, |
| [203](#L203) | ); |
| [204](#L204) | } |
| [205](#L205) |  |
| [206](#L206) | $args = wp\_parse\_args( $args, array( |
| [207](#L207) | 'strto' => 'lower', |
| [208](#L208) | 'strip\_separators' => false, |
| [209](#L209) | ) ); |
| [210](#L210) |  |
| [211](#L211) | static $charset = null; |
| [212](#L212) |  |
| [213](#L213) | if ( ! isset( $charset ) ) { |
| [214](#L214) | $charset = get\_option( 'blog\_charset' ); |
| [215](#L215) |  |
| [216](#L216) | $is\_utf8 = in\_array( |
| [217](#L217) | $charset, |
| [218](#L218) | array( 'utf8', 'utf-8', 'UTF8', 'UTF-8' ) |
| [219](#L219) | ); |
| [220](#L220) |  |
| [221](#L221) | if ( $is\_utf8 ) { |
| [222](#L222) | $charset = 'UTF-8'; |
| [223](#L223) | } |
| [224](#L224) | } |
| [225](#L225) |  |
| [226](#L226) | $text = html\_entity\_decode( $text, ENT\_QUOTES | ENT\_HTML5, $charset ); |
| [227](#L227) |  |
| [228](#L228) | if ( function\_exists( 'mb\_convert\_kana' ) ) { |
| [229](#L229) | $text = mb\_convert\_kana( $text, 'asKV', $charset ); |
| [230](#L230) | } |
| [231](#L231) |  |
| [232](#L232) | if ( $args['strip\_separators'] ) { |
| [233](#L233) | $text = preg\_replace( '/[\r\n\t ]+/', '', $text ); |
| [234](#L234) | } else { |
| [235](#L235) | $text = preg\_replace( '/[\r\n\t ]+/', ' ', $text ); |
| [236](#L236) | } |
| [237](#L237) |  |
| [238](#L238) | if ( 'lower' == $args['strto'] ) { |
| [239](#L239) | if ( function\_exists( 'mb\_strtolower' ) ) { |
| [240](#L240) | $text = mb\_strtolower( $text, $charset ); |
| [241](#L241) | } else { |
| [242](#L242) | $text = strtolower( $text ); |
| [243](#L243) | } |
| [244](#L244) | } elseif ( 'upper' == $args['strto'] ) { |
| [245](#L245) | if ( function\_exists( 'mb\_strtoupper' ) ) { |
| [246](#L246) | $text = mb\_strtoupper( $text, $charset ); |
| [247](#L247) | } else { |
| [248](#L248) | $text = strtoupper( $text ); |
| [249](#L249) | } |
| [250](#L250) | } |
| [251](#L251) |  |
| [252](#L252) | $text = trim( $text ); |
| [253](#L253) | return $text; |
| [254](#L254) | } |
| [255](#L255) |  |
| [256](#L256) |  |
| [257](#L257) | /\*\* |
| [258](#L258) | \* Sanitizes Contact Form 7's form unit-tag. |
| [259](#L259) | \* |
| [260](#L260) | \* @param string $tag Unit-tag. |
| [261](#L261) | \* @return string Sanitized unit-tag. |
| [262](#L262) | \*/ |
| [263](#L263) | function wpcf7\_sanitize\_unit\_tag( $tag ) { |
| [264](#L264) | $tag = preg\_replace( '/[^A-Za-z0-9\_-]/', '', $tag ); |
| [265](#L265) | return $tag; |
| [266](#L266) | } |
| [267](#L267) |  |
| [268](#L268) |  |
| [269](#L269) | /\*\* |
| [270](#L270) | \* Converts a file name to one that is not executable as a script. |
| [271](#L271) | \* |
| [272](#L272) | \* @param string $filename File name. |
| [273](#L273) | \* @return string Converted file name. |
| [274](#L274) | \*/ |
| [275](#L275) | function wpcf7\_antiscript\_file\_name( $filename ) { |
| [276](#L276) | $filename = wp\_basename( $filename ); |
| [277](#L277) |  |
| [278](#L278) | $filename = preg\_replace( '/[\r\n\t -]+/', '-', $filename ); |
| [279](#L279) | $filename = preg\_replace( '/[\pC\pZ]+/iu', '', $filename ); |
| [280](#L280) |  |
| [281](#L281) | $parts = explode( '.', $filename ); |
| [282](#L282) |  |
| [283](#L283) | if ( count( $parts ) < 2 ) { |
| [284](#L284) | return $filename; |
| [285](#L285) | } |
| [286](#L286) |  |
| [287](#L287) | $script\_pattern = '/^(php|phtml|pl|py|rb|cgi|asp|aspx)\d?$/i'; |
| [288](#L288) |  |
| [289](#L289) | $filename = array\_shift( $parts ); |
| [290](#L290) | $extension = array\_pop( $parts ); |
| [291](#L291) |  |
| [292](#L292) | foreach ( (array) $parts as $part ) { |
| [293](#L293) | if ( preg\_match( $script\_pattern, $part ) ) { |
| [294](#L294) | $filename .= '.' . $part . '\_'; |
| [295](#L295) | } else { |
| [296](#L296) | $filename .= '.' . $part; |
| [297](#L297) | } |
| [298](#L298) | } |
| [299](#L299) |  |
| [300](#L300) | if ( preg\_match( $script\_pattern, $extension ) ) { |
| [301](#L301) | $filename .= '.' . $extension . '\_.txt'; |
| [302](#L302) | } else { |
| [303](#L303) | $filename .= '.' . $extension; |
| [304](#L304) | } |
| [305](#L305) |  |
| [306](#L306) | return $filename; |
| [307](#L307) | } |
| [308](#L308) |  |
| [309](#L309) |  |
| [310](#L310) | /\*\* |
| [311](#L311) | \* Masks a password with asterisks (\*). |
| [312](#L312) | \* |
| [313](#L313) | \* @param int $right Length of right-hand unmasked text. Default 0. |
| [314](#L314) | \* @param int $left Length of left-hand unmasked text. Default 0. |
| [315](#L315) | \* @return string Text of masked password. |
| [316](#L316) | \*/ |
| [317](#L317) | function wpcf7\_mask\_password( $text, $right = 0, $left = 0 ) { |
| [318](#L318) | $length = strlen( $text ); |
| [319](#L319) |  |
| [320](#L320) | $right = absint( $right ); |
| [321](#L321) | $left = absint( $left ); |
| [322](#L322) |  |
| [323](#L323) | if ( $length < $right + $left ) { |
| [324](#L324) | $right = $left = 0; |
| [325](#L325) | } |
| [326](#L326) |  |
| [327](#L327) | if ( $length <= 48 ) { |
| [328](#L328) | $masked = str\_repeat( '\*', $length - ( $right + $left ) ); |
| [329](#L329) | } elseif ( $right + $left < 48 ) { |
| [330](#L330) | $masked = str\_repeat( '\*', 48 - ( $right + $left ) ); |
| [331](#L331) | } else { |
| [332](#L332) | $masked = '\*\*\*\*'; |
| [333](#L333) | } |
| [334](#L334) |  |
| [335](#L335) | $left\_unmasked = $left ? substr( $text, 0, $left ) : ''; |
| [336](#L336) | $right\_unmasked = $right ? substr( $text, -1 \* $right ) : ''; |
| [337](#L337) |  |
| [338](#L338) | $text = $left\_unmasked . $masked . $right\_unmasked; |
| [339](#L339) |  |
| [340](#L340) | return $text; |
| [341](#L341) | } |
| [342](#L342) |  |
| [343](#L343) |  |
| [344](#L344) | /\*\* |
| [345](#L345) | \* Returns an array of allowed HTML tags and attributes for a given context. |
| [346](#L346) | \* |
| [347](#L347) | \* @param string $context Context used to decide allowed tags and attributes. |
| [348](#L348) | \* @return array Array of allowed HTML tags and their allowed attributes. |
| [349](#L349) | \*/ |
| [350](#L350) | function wpcf7\_kses\_allowed\_html( $context = 'form' ) { |
| [351](#L351) | static $allowed\_tags = array(); |
| [352](#L352) |  |
| [353](#L353) | if ( isset( $allowed\_tags[$context] ) ) { |
| [354](#L354) | return apply\_filters( |
| [355](#L355) | 'wpcf7\_kses\_allowed\_html', |
| [356](#L356) | $allowed\_tags[$context], |
| [357](#L357) | $context |
| [358](#L358) | ); |
| [359](#L359) | } |
| [360](#L360) |  |
| [361](#L361) | $allowed\_tags[$context] = wp\_kses\_allowed\_html( 'post' ); |
| [362](#L362) |  |
| [363](#L363) | if ( 'form' === $context ) { |
| [364](#L364) | $additional\_tags\_for\_form = array( |
| [365](#L365) | 'button' => array( |
| [366](#L366) | 'disabled' => true, |
| [367](#L367) | 'name' => true, |
| [368](#L368) | 'type' => true, |
| [369](#L369) | 'value' => true, |
| [370](#L370) | ), |
| [371](#L371) | 'datalist' => array(), |
| [372](#L372) | 'fieldset' => array( |
| [373](#L373) | 'disabled' => true, |
| [374](#L374) | 'name' => true, |
| [375](#L375) | ), |
| [376](#L376) | 'input' => array( |
| [377](#L377) | 'accept' => true, |
| [378](#L378) | 'alt' => true, |
| [379](#L379) | 'capture' => true, |
| [380](#L380) | 'checked' => true, |
| [381](#L381) | 'disabled' => true, |
| [382](#L382) | 'list' => true, |
| [383](#L383) | 'max' => true, |
| [384](#L384) | 'maxlength' => true, |
| [385](#L385) | 'min' => true, |
| [386](#L386) | 'minlength' => true, |
| [387](#L387) | 'multiple' => true, |
| [388](#L388) | 'name' => true, |
| [389](#L389) | 'placeholder' => true, |
| [390](#L390) | 'readonly' => true, |
| [391](#L391) | 'size' => true, |
| [392](#L392) | 'step' => true, |
| [393](#L393) | 'type' => true, |
| [394](#L394) | 'value' => true, |
| [395](#L395) | ), |
| [396](#L396) | 'label' => array( |
| [397](#L397) | 'for' => true, |
| [398](#L398) | ), |
| [399](#L399) | 'legend' => array(), |
| [400](#L400) | 'meter' => array( |
| [401](#L401) | 'value' => true, |
| [402](#L402) | 'min' => true, |
| [403](#L403) | 'max' => true, |
| [404](#L404) | 'low' => true, |
| [405](#L405) | 'high' => true, |
| [406](#L406) | 'optimum' => true, |
| [407](#L407) | ), |
| [408](#L408) | 'optgroup' => array( |
| [409](#L409) | 'disabled' => true, |
| [410](#L410) | 'label' => true, |
| [411](#L411) | ), |
| [412](#L412) | 'option' => array( |
| [413](#L413) | 'disabled' => true, |
| [414](#L414) | 'label' => true, |
| [415](#L415) | 'selected' => true, |
| [416](#L416) | 'value' => true, |
| [417](#L417) | ), |
| [418](#L418) | 'output' => array( |
| [419](#L419) | 'for' => true, |
| [420](#L420) | 'name' => true, |
| [421](#L421) | ), |
| [422](#L422) | 'progress' => array( |
| [423](#L423) | 'max' => true, |
| [424](#L424) | 'value' => true, |
| [425](#L425) | ), |
| [426](#L426) | 'select' => array( |
| [427](#L427) | 'disabled' => true, |
| [428](#L428) | 'multiple' => true, |
| [429](#L429) | 'name' => true, |
| [430](#L430) | 'size' => true, |
| [431](#L431) | ), |
| [432](#L432) | 'textarea' => array( |
| [433](#L433) | 'cols' => true, |
| [434](#L434) | 'disabled' => true, |
| [435](#L435) | 'maxlength' => true, |
| [436](#L436) | 'minlength' => true, |
| [437](#L437) | 'name' => true, |
| [438](#L438) | 'placeholder' => true, |
| [439](#L439) | 'readonly' => true, |
| [440](#L440) | 'rows' => true, |
| [441](#L441) | 'spellcheck' => true, |
| [442](#L442) | 'wrap' => true, |
| [443](#L443) | ), |
| [444](#L444) | ); |
| [445](#L445) |  |
| [446](#L446) | $additional\_tags\_for\_form = array\_map( |
| [447](#L447) | static function ( $elm ) { |
| [448](#L448) | $global\_attributes = array( |
| [449](#L449) | 'aria-atomic' => true, |
| [450](#L450) | 'aria-checked' => true, |
| [451](#L451) | 'aria-describedby' => true, |
| [452](#L452) | 'aria-details' => true, |
| [453](#L453) | 'aria-disabled' => true, |
| [454](#L454) | 'aria-hidden' => true, |
| [455](#L455) | 'aria-invalid' => true, |
| [456](#L456) | 'aria-label' => true, |
| [457](#L457) | 'aria-labelledby' => true, |
| [458](#L458) | 'aria-live' => true, |
| [459](#L459) | 'aria-relevant' => true, |
| [460](#L460) | 'aria-required' => true, |
| [461](#L461) | 'aria-selected' => true, |
| [462](#L462) | 'class' => true, |
| [463](#L463) | 'data-\*' => true, |
| [464](#L464) | 'id' => true, |
| [465](#L465) | 'inputmode' => true, |
| [466](#L466) | 'role' => true, |
| [467](#L467) | 'style' => true, |
| [468](#L468) | 'tabindex' => true, |
| [469](#L469) | 'title' => true, |
| [470](#L470) | ); |
| [471](#L471) |  |
| [472](#L472) | return array\_merge( $global\_attributes, (array) $elm ); |
| [473](#L473) | }, |
| [474](#L474) | $additional\_tags\_for\_form |
| [475](#L475) | ); |
| [476](#L476) |  |
| [477](#L477) | $allowed\_tags[$context] = array\_merge( |
| [478](#L478) | $allowed\_tags[$context], |
| [479](#L479) | $additional\_tags\_for\_form |
| [480](#L480) | ); |
| [481](#L481) | } |
| [482](#L482) |  |
| [483](#L483) | return apply\_filters( |
| [484](#L484) | 'wpcf7\_kses\_allowed\_html', |
| [485](#L485) | $allowed\_tags[$context], |
| [486](#L486) | $context |
| [487](#L487) | ); |
| [488](#L488) | } |
| [489](#L489) |  |
| [490](#L490) |  |
| [491](#L491) | /\*\* |
| [492](#L492) | \* Sanitizes content for allowed HTML tags for the specified context. |
| [493](#L493) | \* |
| [494](#L494) | \* @param string $input Content to filter. |
| [495](#L495) | \* @param string $context Context used to decide allowed tags and attributes. |
| [496](#L496) | \* @return string Filtered text with allowed HTML tags and attributes intact. |
| [497](#L497) | \*/ |
| [498](#L498) | function wpcf7\_kses( $input, $context = 'form' ) { |
| [499](#L499) | $output = wp\_kses( |
| [500](#L500) | $input, |
| [501](#L501) | wpcf7\_kses\_allowed\_html( $context ) |
| [502](#L502) | ); |
| [503](#L503) |  |
| [504](#L504) | return $output; |
| [505](#L505) | } |
| [506](#L506) |  |
| [507](#L507) |  |
| [508](#L508) | /\*\* |
| [509](#L509) | \* Returns a formatted string of HTML attributes. |
| [510](#L510) | \* |
| [511](#L511) | \* @param array $atts Associative array of attribute name and value pairs. |
| [512](#L512) | \* @return string Formatted HTML attributes. |
| [513](#L513) | \*/ |
| [514](#L514) | function wpcf7\_format\_atts( $atts ) { |
| [515](#L515) | $atts\_filtered = array(); |
| [516](#L516) |  |
| [517](#L517) | foreach ( $atts as $name => $value ) { |
| [518](#L518) | $name = strtolower( trim( $name ) ); |
| [519](#L519) |  |
| [520](#L520) | if ( ! preg\_match( '/^[a-z\_:][a-z\_:.0-9-]\*$/', $name ) ) { |
| [521](#L521) | continue; |
| [522](#L522) | } |
| [523](#L523) |  |
| [524](#L524) | static $boolean\_attributes = array( |
| [525](#L525) | 'checked', |
| [526](#L526) | 'disabled', |
| [527](#L527) | 'inert', |
| [528](#L528) | 'multiple', |
| [529](#L529) | 'readonly', |
| [530](#L530) | 'required', |
| [531](#L531) | 'selected', |
| [532](#L532) | ); |
| [533](#L533) |  |
| [534](#L534) | if ( in\_array( $name, $boolean\_attributes ) and '' === $value ) { |
| [535](#L535) | $value = false; |
| [536](#L536) | } |
| [537](#L537) |  |
| [538](#L538) | if ( is\_numeric( $value ) ) { |
| [539](#L539) | $value = (string) $value; |
| [540](#L540) | } |
| [541](#L541) |  |
| [542](#L542) | if ( null === $value or false === $value ) { |
| [543](#L543) | unset( $atts\_filtered[$name] ); |
| [544](#L544) | } elseif ( true === $value ) { |
| [545](#L545) | $atts\_filtered[$name] = $name; // boolean attribute |
| [546](#L546) | } elseif ( is\_string( $value ) ) { |
| [547](#L547) | $atts\_filtered[$name] = trim( $value ); |
| [548](#L548) | } |
| [549](#L549) | } |
| [550](#L550) |  |
| [551](#L551) | $output = ''; |
| [552](#L552) |  |
| [553](#L553) | foreach ( $atts\_filtered as $name => $value ) { |
| [554](#L554) | $output .= sprintf( ' %1$s="%2$s"', $name, esc\_attr( $value ) ); |
| [555](#L555) | } |
| [556](#L556) |  |
| [557](#L557) | return trim( $output ); |
| [558](#L558) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/contact-form-7/tags/5.8.3/includes/formatting.php?format=txt)
* [Original Format](/export/3220311/contact-form-7/tags/5.8.3/includes/formatting.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


