- **Root cause of vulnerability**: The `ajax.php` script in the "CD Custom Fields 4 Orders" module makes insecure SQL calls that can be exploited via HTTP to perform SQL injection. Specifically, user-provided data is not properly sanitized before being used in an SQL query.
- **Weaknesses/vulnerabilities present**:
    - **SQL Injection (CWE-89)**: The module is vulnerable to SQL injection because it directly inserts user-provided input into SQL queries without proper sanitization or parameterization.
- **Impact of exploitation**:
    - **Obtain admin access:** Attackers could potentially gain administrative access to the PrestaShop installation.
    - **Remove data:** Attackers could delete data from the associated PrestaShop database.
    - **Expose sensitive data:** Attackers could copy sensitive data, such as tokens, from database tables to the front end, potentially allowing them to execute admin ajax scripts.
    - **Hijack emails:** Attackers could rewrite SMTP settings to intercept emails.
- **Attack vectors**:
    - Network-based attack: The vulnerability can be exploited through a network connection using an HTTP request.
    - Trivial HTTP call: The SQL injection can be triggered by a simple HTTP call to the vulnerable script (`ajax.php`).
- **Required attacker capabilities/position**:
    - No privileges are required to exploit the vulnerability.
    - No user interaction is required to trigger the vulnerability.
    - The attacker needs to be able to send HTTP requests to the vulnerable PrestaShop instance.