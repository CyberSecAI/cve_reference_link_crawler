

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3117664%2540wp-accessibility-helper%26old%3D3117664%2540wp-accessibility-helper)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3077262/wp-accessibility-helper "Changeset 3077262 for wp-accessibility-helper")
* [Next Change](/changeset/3117665/wp-accessibility-helper "Changeset 3117665 for wp-accessibility-helper") →

---

# Changeset [3117664](/changeset/3117664 "Show full changeset") for [wp-accessibility-helper](/browser/wp-accessibility-helper?rev=3117664 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
07/14/2024 06:14:47 AM
([6 months](/timeline?from=2024-07-14T06%3A14%3A47Z&precision=second "See timeline at 07/14/2024 06:14:47 AM") ago)

Author:
vol4ikman
Message:

fix Broken Access Control

Location:
[wp-accessibility-helper/trunk](/browser/wp-accessibility-helper/trunk?rev=3117664)
Files:

2 edited

* [admin/ajax-functions.php](/browser/wp-accessibility-helper/trunk/admin/ajax-functions.php?rev=3117664 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [wp-accessibility-helper.php](/browser/wp-accessibility-helper/trunk/wp-accessibility-helper.php?rev=3117664 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wp-accessibility-helper/trunk/admin/ajax-functions.php](/changeset/3117664/wp-accessibility-helper/trunk/admin/ajax-functions.php "Show the changeset 3117664 restricted to wp-accessibility-helper/trunk/admin/ajax-functions.php")

  | [r3051565](/browser/wp-accessibility-helper/trunk/admin/ajax-functions.php?rev=3051565#L274 "Show revision 3051565 of this file in browser") | [r3117664](/browser/wp-accessibility-helper/trunk/admin/ajax-functions.php?rev=3117664#L274 "Show revision 3117664 of this file in browser") |  |
  | --- | --- | --- |
  | 274 | 274 | $alldata  = isset( $\_POST['alldata'] ) ? array\_map( 'wah\_sanitize\_array', (array) wp\_unslash( $\_POST['alldata'] ) ) : array(); |
  | 275 | 275 |  |
  |  | 276 | if ( ! current\_user\_can( 'edit\_post', $post\_id ) ) { |
  |  | 277 | wp\_die( 'You do not have permission to edit this post.' ); |
  |  | 278 | } |
  |  | 279 |  |
  | 276 | 280 | if ( count( $alldata ) >= 5 ) { |
  | 277 | 281 | $response['status']  = 'error'; |
  | […](/browser/wp-accessibility-helper/trunk/admin/ajax-functions.php?rev=3051565#L293) | […](/browser/wp-accessibility-helper/trunk/admin/ajax-functions.php?rev=3117664#L297) |  |
  | 293 | 297 | $response = array(); |
  | 294 | 298 | $alldata  = ''; |
  |  | 299 |  |
  |  | 300 | if ( ! current\_user\_can( 'edit\_post', $post\_id ) ) { |
  |  | 301 | wp\_die( 'You do not have permission to edit this post.' ); |
  |  | 302 | } |
  |  | 303 |  |
  | 295 | 304 | update\_option( 'wah\_contrast\_variations', $alldata ); |
  | 296 | 305 | $response['status']  = 'ok'; |
* ## [wp-accessibility-helper/trunk/wp-accessibility-helper.php](/changeset/3117664/wp-accessibility-helper/trunk/wp-accessibility-helper.php "Show the changeset 3117664 restricted to wp-accessibility-helper/trunk/wp-accessibility-helper.php")

  | [r3051565](/browser/wp-accessibility-helper/trunk/wp-accessibility-helper.php?rev=3051565#L5 "Show revision 3051565 of this file in browser") | [r3117664](/browser/wp-accessibility-helper/trunk/wp-accessibility-helper.php?rev=3117664#L5 "Show revision 3117664 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | \* Description: WP Accessibility Helper sidebar |
  | 6 | 6 | \* Author: Alex Volkov |
  | 7 |  | \* Version: 0.6.2.~~8~~ |
  |  | 7 | \* Version: 0.6.2.9 |
  | 8 | 8 | \* Author URI: http://www.volkov.co.il |
  | 9 | 9 | \* License: GPL2 |
  | […](/browser/wp-accessibility-helper/trunk/wp-accessibility-helper.php?rev=3051565#L15) | […](/browser/wp-accessibility-helper/trunk/wp-accessibility-helper.php?rev=3117664#L15) |  |
  | 15 | 15 |  |
  | 16 | 16 | defined( 'ABSPATH' ) || die( 'No script kiddies please!' ); |
  | 17 |  | define( 'WAH\_VERSION', '0.6.2.~~8~~' ); |
  |  | 17 | define( 'WAH\_VERSION', '0.6.2.9' ); |
  | 18 | 18 | define( 'WAHPRO\_LINK', 'https://accessibility-helper.co.il/pro/' ); |
  | 19 | 19 |  |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3117664)
* [Zip Archive](?format=zip&new=3117664)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

