=== Content from github.com_46cff7dc_20250110_132626.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fxerces-c%2Fpull%2F54)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fxerces-c%2Fpull%2F54)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=apache%2Fxerces-c)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[apache](/apache)
/
**[xerces-c](/apache/xerces-c)**
Public

* [Notifications](/login?return_to=%2Fapache%2Fxerces-c) You must be signed in to change notification settings
* [Fork
  92](/login?return_to=%2Fapache%2Fxerces-c)
* [Star
   137](/login?return_to=%2Fapache%2Fxerces-c)

* [Code](/apache/xerces-c)
* [Pull requests
  11](/apache/xerces-c/pulls)
* [Actions](/apache/xerces-c/actions)
* [Security](/apache/xerces-c/security)
* [Insights](/apache/xerces-c/pulse)

Additional navigation options

* [Code](/apache/xerces-c)
* [Pull requests](/apache/xerces-c/pulls)
* [Actions](/apache/xerces-c/actions)
* [Security](/apache/xerces-c/security)
* [Insights](/apache/xerces-c/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fapache%2Fxerces-c%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fapache%2Fxerces-c%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# XERCESC-2188 - Use-after-free on external DTD scan #54

 Closed

[boris-kolpackov](/boris-kolpackov)
wants to merge
1
commit into
[apache:master](/apache/xerces-c/tree/master "apache/xerces-c:master")
from
[karen-arutyunov:master](/karen-arutyunov/xerces-c/tree/master "karen-arutyunov/xerces-c:master")

 Closed

# [XERCESC-2188 - Use-after-free on external DTD scan](#top) #54

[boris-kolpackov](/boris-kolpackov)
wants to merge
1
commit into
[apache:master](/apache/xerces-c/tree/master "apache/xerces-c:master")
from
[karen-arutyunov:master](/karen-arutyunov/xerces-c/tree/master "karen-arutyunov/xerces-c:master")

[Conversation
8](/apache/xerces-c/pull/54)
[Commits
1](/apache/xerces-c/pull/54/commits)
[Checks
0](/apache/xerces-c/pull/54/checks)
[Files changed](/apache/xerces-c/pull/54/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![boris-kolpackov](https://avatars.githubusercontent.com/u/31799599?s=60&v=4)](/boris-kolpackov)

Copy link

Contributor

### @boris-kolpackov **[boris-kolpackov](/boris-kolpackov)** commented [Dec 5, 2023](#issue-2026238767)

These are the instructions for observing the bug (before this commit):

```
$ git clone https://github.com/apache/xerces-c.git $ cd xerces-c
$ mkdir build
$ cd build
$ cmake -G "Unix Makefiles" -DCMAKE_BUILD_TYPE=Debug .. $ make -j8
$ cp ../samples/data/personal.xml .

$ cat <<EOF >personal.dtd
<?xml encoding="ISO-8859-1"?>
<!ENTITY % nonExistentEntity SYSTEM "non-existent.ent"> %nonExistentEntity;
EOF

$ gdb samples/StdInParse
(gdb) b IGXMLScanner.cpp:1544
(gdb) run <personal.xml
1544	            fReaderMgr.pushReader(reader, declDTD);
(gdb) p declDTD
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) n
1547	            dtdScanner.scanExtSubsetDecl(false, true);
(gdb) n
1548	        }
(gdb) s
...
(gdb) s                     # The Janitor is about to delete the above declDTD.
90	        delete fData;
(gdb) p fData
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) b ReaderMgr.cpp:1024
(gdb) n
...
(gdb) n                     # Now we about to dereference the deleted declDTD.
1024	    if (curEntity && !curEntity->isExternal())
(gdb) p curEntity
$2 = (const xercesc_4_0::XMLEntityDecl *) 0x49ac68
```

```

Sorry, something went wrong.

All reactions

[![@karen-arutyunov](https://avatars.githubusercontent.com/u/11507038?s=40&v=4)](/karen-arutyunov)

`[XERCESC-2188 - Use-after-free on external DTD scan](/apache/xerces-c/pull/54/commits/8dc07566adce05785abd79552582c3884cd95aa1 "XERCESC-2188 - Use-after-free on external DTD scan

These are the instructions for observing the bug (before this commit):

$ git clone https://github.com/apache/xerces-c.git
$ cd xerces-c
$ mkdir build
$ cd build
$ cmake -G \"Unix Makefiles\" -DCMAKE_BUILD_TYPE=Debug ..
$ make -j8
$ cp ../samples/data/personal.xml .

$ cat <<EOF >personal.dtd
<?xml encoding=\"ISO-8859-1\"?>
<!ENTITY % nonExistentEntity SYSTEM \"non-existent.ent\">
%nonExistentEntity;
EOF

$ gdb samples/StdInParse
(gdb) b IGXMLScanner.cpp:1544
(gdb) run <personal.xml
1544	            fReaderMgr.pushReader(reader, declDTD);
(gdb) p declDTD
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) n
1547	            dtdScanner.scanExtSubsetDecl(false, true);
(gdb) n
1548	        }
(gdb) s
...
(gdb) s                     # The Janitor is about to delete the above declDTD.
90	        delete fData;
(gdb) p fData
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) b ReaderMgr.cpp:1024
(gdb) n
...
(gdb) n                     # Now we about to dereference the deleted declDTD.
1024	    if (curEntity && !curEntity->isExternal())
(gdb) p curEntity
$2 = (const xercesc_4_0::XMLEntityDecl *) 0x49ac68")`
 …

`[8dc0756](/apache/xerces-c/pull/54/commits/8dc07566adce05785abd79552582c3884cd95aa1)`

```
These are the instructions for observing the bug (before this commit):

$ git clone <https://github.com/apache/xerces-c.git>
$ cd xerces-c
$ mkdir build
$ cd build
$ cmake -G "Unix Makefiles" -DCMAKE_BUILD_TYPE=Debug ..
$ make -j8
$ cp ../samples/data/personal.xml .

$ cat <<EOF >personal.dtd
<?xml encoding="ISO-8859-1"?>
<!ENTITY % nonExistentEntity SYSTEM "non-existent.ent">
%nonExistentEntity;
EOF

$ gdb samples/StdInParse
(gdb) b IGXMLScanner.cpp:1544
(gdb) run <personal.xml
1544	            fReaderMgr.pushReader(reader, declDTD);
(gdb) p declDTD
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) n
1547	            dtdScanner.scanExtSubsetDecl(false, true);
(gdb) n
1548	        }
(gdb) s
...
(gdb) s                     # The Janitor is about to delete the above declDTD.
90	        delete fData;
(gdb) p fData
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) b ReaderMgr.cpp:1024
(gdb) n
...
(gdb) n                     # Now we about to dereference the deleted declDTD.
1024	    if (curEntity && !curEntity->isExternal())
(gdb) p curEntity
$2 = (const xercesc_4_0::XMLEntityDecl *) 0x49ac68
```

[![@boris-kolpackov](https://avatars.githubusercontent.com/u/31799599?s=80&u=a53de72ba0efe9f3720f4fbb36ea6dbf7d0506c7&v=4)](/boris-kolpackov)

Copy link

Contributor

Author

### **[boris-kolpackov](/boris-kolpackov)** commented [Dec 5, 2023](#issuecomment-1840890853) • edited Loading

| This fix follows the same overall idea as [#47](https://github.com/apache/xerces-c/pull/47) with the following key differences:   1. It addresses the lifetime issue when throwing `EndOfEntityException` (mentioned in a review comment to that PR). 2. It is binary backwards-compatible so can be used for a patch release.   Besides the instructions for observing the bug under the debugger (and confirming that it is no longer observed after the fix), we've also added a direct test for `ReaderMgr` to our package of Xerces-C++ that can be used to reproduce the issues/confirm the fix: <https://github.com/build2-packaging/xerces-c/tree/3.2.5/libxerces-c/tests/reader-mgr>  So the fix is reasonably well testes and we haven't observed any regressions. We've also run our CI which covers all the major platforms/compilers (but not in C++98): [https://ci.stage.build2.org/@2177ad08-5621-4300-807f-8861b54c54c0](https://ci.stage.build2.org/%402177ad08-5621-4300-807f-8861b54c54c0)  I've also reviewed this patch and it looks good to me.  Please review and/or test and let us know if there are any issues. Note that while this commit is against the `master` branch, it can be cleanly cherry-picked to the `xerces-3.2` branch. |
| --- |

All reactions

Sorry, something went wrong.

[![@boris-kolpackov](https://avatars.githubusercontent.com/u/31799599?s=40&u=a53de72ba0efe9f3720f4fbb36ea6dbf7d0506c7&v=4)](/boris-kolpackov)
[boris-kolpackov](/boris-kolpackov)
mentioned this pull request
[Dec 5, 2023](#ref-pullrequest-1111903022)

[[XERCESC-2188] Fix potential double-free in usage of ReaderMgr::pushReader()
#47](/apache/xerces-c/pull/47)
 Closed

[![theta682](https://avatars.githubusercontent.com/u/1522049?s=60&v=4)](/theta682)

**[theta682](/theta682)**
reviewed
[Dec 6, 2023](#pullrequestreview-1766839984)

 [View reviewed changes](/apache/xerces-c/pull/54/files/8dc07566adce05785abd79552582c3884cd95aa1)

Copy link

### @theta682 **[theta682](/theta682)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Formatting: 4 spaces indents

Sorry, something went wrong.

All reactions

[src/xercesc/internal/ReaderMgr.cpp](/apache/xerces-c/pull/54/files/8dc07566adce05785abd79552582c3884cd95aa1#diff-1394980520d09c847cffeca1516e846ed6ad49a521080549613ac70eefe227c3)

|  |  | delete reader; |
| --- | --- | --- |
|  |  |  |
|  |  | if (adoptEntity) |
|  |  | delete entity; |

Copy link

### @theta682 **[theta682](/theta682)** [Dec 6, 2023](#discussion_r1416808315)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Suggested change

|  | delete entity; |
| --- | --- |
|  | delete entity; |

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @boris-kolpackov **[boris-kolpackov](/boris-kolpackov)** [Dec 6, 2023](#discussion_r1417168833)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Ok, thanks, we will fixup the final version of the commit.

Sorry, something went wrong.

All reactions

[src/xercesc/internal/ReaderMgr.cpp](/apache/xerces-c/pull/54/files/8dc07566adce05785abd79552582c3884cd95aa1#diff-1394980520d09c847cffeca1516e846ed6ad49a521080549613ac70eefe227c3)

|  |  | @@ -1020,7 +1070,9 @@ ReaderMgr::getLastExtEntity(const XMLEntityDecl\*& itsEntity) const | |
| --- | --- | --- | --- |
|  |  | // search the stack; else, keep the reader that we've got since its |
|  |  | // either an external entity reader or the main file reader. |
|  |  | // |
|  |  | const XMLEntityDecl\* curEntity = fCurEntity; |
|  |  | const XMLEntityDecl\* curEntity = |
|  |  | fCurReaderData? fCurReaderData->getEntity() : 0; |

Copy link

### @theta682 **[theta682](/theta682)** [Dec 6, 2023](#discussion_r1416808653)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Suggested change

|  | fCurReaderData? fCurReaderData->getEntity() : 0; |
| --- | --- |
|  | fCurReaderData? fCurReaderData->getEntity() : 0; |

Sorry, something went wrong.

All reactions

[src/xercesc/internal/ReaderMgr.hpp](/apache/xerces-c/pull/54/files/8dc07566adce05785abd79552582c3884cd95aa1#diff-9246a0e82a31d375ed87b4a5759c4410088d786f3c507ce8c20da662bf899802)

Comment on lines
+223
 to
+241

|  |  | // --------------------------------------------------------------------- |
| --- | --- | --- |
|  |  | // Constructors and Destructor |
|  |  | // --------------------------------------------------------------------- |
|  |  | ReaderData |
|  |  | ( XMLReader\* const reader |
|  |  | , XMLEntityDecl\* const entity |
|  |  | , const bool adoptEntity |
|  |  | ); |
|  |  |  |
|  |  | ~ReaderData(); |
|  |  |  |
|  |  | // ---------------------------------------------------------------------- |
|  |  | // Getter methods |
|  |  | // ---------------------------------------------------------------------- |
|  |  | XMLReader\* getReader() const; |
|  |  | XMLEntityDecl\* getEntity() const; |
|  |  | bool getEntityAdopted() const; |
|  |  |  |
|  |  | XMLEntityDecl\* releaseEntity(); |

Copy link

### @theta682 **[theta682](/theta682)** [Dec 6, 2023](#discussion_r1416811738)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Suggested change

|  | // --------------------------------------------------------------------- |
| --- | --- |
|  | // Constructors and Destructor |
|  | // --------------------------------------------------------------------- |
|  | ReaderData |
|  | ( XMLReader\* const reader |
|  | , XMLEntityDecl\* const entity |
|  | , const bool adoptEntity |
|  | ); |
|  |  |
|  | ~ReaderData(); |
|  |  |
|  | // ---------------------------------------------------------------------- |
|  | // Getter methods |
|  | // ---------------------------------------------------------------------- |
|  | XMLReader\* getReader() const; |
|  | XMLEntityDecl\* getEntity() const; |
|  | bool getEntityAdopted() const; |
|  |  |
|  | XMLEntityDecl\* releaseEntity(); |
|  | // --------------------------------------------------------------------- |
|  | // Constructors and Destructor |
|  | // --------------------------------------------------------------------- |
|  | ReaderData |
|  | ( XMLReader\* const reader |
|  | , XMLEntityDecl\* const entity |
|  | , const bool adoptEntity |
|  | ); |
|  |  |
|  | ~ReaderData(); |
|  |  |
|  | // ---------------------------------------------------------------------- |
|  | // Getter methods |
|  | // ---------------------------------------------------------------------- |
|  | XMLReader\* getReader() const; |
|  | XMLEntityDecl\* getEntity() const; |
|  | bool getEntityAdopted() const; |
|  |  |
|  | XMLEntityDecl\* releaseEntity(); |

Sorry, something went wrong.

All reactions

[src/xercesc/internal/ReaderMgr.hpp](/apache/xerces-c/pull/54/files/8dc07566adce05785abd79552582c3884cd95aa1#diff-9246a0e82a31d375ed87b4a5759c4410088d786f3c507ce8c20da662bf899802)

Comment on lines
+244
 to
+269

|  |  | // --------------------------------------------------------------------- |
| --- | --- | --- |
|  |  | // Unimplemented constructors and operators |
|  |  | // --------------------------------------------------------------------- |
|  |  | ReaderData(); |
|  |  | ReaderData(const ReaderData&); |
|  |  | ReaderData& operator=(const ReaderData&); |
|  |  |  |
|  |  | // --------------------------------------------------------------------- |
|  |  | // Private data members |
|  |  | // |
|  |  | // fReader |
|  |  | // This is the pointer to the reader object that must be destroyed |
|  |  | // when this object is destroyed. |
|  |  | // |
|  |  | // fEntity |
|  |  | // fEntityAdopted |
|  |  | // This is the pointer to the entity object that, if adopted, must |
|  |  | // be destroyed when this object is destroyed. |
|  |  | // |
|  |  | // Note that we need to keep up with which of the pushed readers |
|  |  | // are pushed entity values that are being spooled. This is done |
|  |  | // to avoid the problem of recursive definitions. |
|  |  | // --------------------------------------------------------------------- |
|  |  | XMLReader\* fReader; |
|  |  | XMLEntityDecl\* fEntity; |
|  |  | bool fEntityAdopted; |

Copy link

### @theta682 **[theta682](/theta682)** [Dec 6, 2023](#discussion_r1416813630)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Suggested change

|  | // --------------------------------------------------------------------- |
| --- | --- |
|  | // Unimplemented constructors and operators |
|  | // --------------------------------------------------------------------- |
|  | ReaderData(); |
|  | ReaderData(const ReaderData&); |
|  | ReaderData& operator=(const ReaderData&); |
|  |  |
|  | // --------------------------------------------------------------------- |
|  | // Private data members |
|  | // |
|  | // fReader |
|  | // This is the pointer to the reader object that must be destroyed |
|  | // when this object is destroyed. |
|  | // |
|  | // fEntity |
|  | // fEntityAdopted |
|  | // This is the pointer to the entity object that, if adopted, must |
|  | // be destroyed when this object is destroyed. |
|  | // |
|  | // Note that we need to keep up with which of the pushed readers |
|  | // are pushed entity values that are being spooled. This is done |
|  | // to avoid the problem of recursive definitions. |
|  | // --------------------------------------------------------------------- |
|  | XMLReader\* fReader; |
|  | XMLEntityDecl\* fEntity; |
|  | bool fEntityAdopted; |
|  | // --------------------------------------------------------------------- |
|  | // Unimplemented constructors and operators |
|  | // --------------------------------------------------------------------- |
|  | ReaderData(); |
|  | ReaderData(const ReaderData&); |
|  | ReaderData& operator=(const ReaderData&); |
|  |  |
|  | // --------------------------------------------------------------------- |
|  | // Private data members |
|  | // |
|  | // Reader |
|  | // This is the pointer to the reader object that must be destroyed |
|  | // when this object is destroyed. |
|  | // |
|  | // fEntity |
|  | // fEntityAdopted |
|  | // This is the pointer to the entity object that, if adopted, must |
|  | // be destroyed when this object is destroyed. |
|  | // |
|  | // Note that we need to keep up with which of the pushed readers |
|  | // are pushed entity values that are being spooled. This is done |
|  | // to avoid the problem of recursive definitions. |
|  | // --------------------------------------------------------------------- |
|  | XMLReader\* Reader; |
|  | XMLEntityDecl\* fEntity; |
|  | bool fEntityAdopted; |

Sorry, something went wrong.

All reactions

[![@boris-kolpackov](https://avatars.githubusercontent.com/u/31799599?s=80&u=a53de72ba0efe9f3720f4fbb36ea6dbf7d0506c7&v=4)](/boris-kolpackov)

Copy link

Contributor

Author

### **[boris-kolpackov](/boris-kolpackov)** commented [Dec 13, 2023](#issuecomment-1853490361)

| This PR has been merged (with whitespace issues addressed):  `master`: [b38ab79](https://github.com/apache/xerces-c/commit/b38ab79e934b9c27de191ee7af6926c7af42069d) `xerces-3.2`: [e002426](https://github.com/apache/xerces-c/commit/e0024267504188e42ace4dd9031d936786914835) |
| --- |

All reactions

Sorry, something went wrong.

[![@boris-kolpackov](https://avatars.githubusercontent.com/u/31799599?s=40&u=a53de72ba0efe9f3720f4fbb36ea6dbf7d0506c7&v=4)](/boris-kolpackov)
[boris-kolpackov](/boris-kolpackov)
closed this
[Dec 13, 2023](#event-11232898005)

[raspbian-autopush](/raspbian-autopush)
pushed a commit
to raspbian-packages/xerces-c
that referenced
this pull request
[Jan 4, 2024](#ref-commit-b06d401)
[![@karen-arutyunov](https://avatars.githubusercontent.com/u/11507038?s=40&u=b3139a77415676c0f1c5d9c7253681f774b68ea2&v=4)](/karen-arutyunov)

`[XERCESC-2188 - Use-after-free on external DTD scan (](/raspbian-packages/xerces-c/commit/b06d40107d9b0e76b4c111f90bc7b682fc832c0c "XERCESC-2188 - Use-after-free on external DTD scan (CVE-2018-1311)

These are the instructions for observing the bug (before this commit):

$ git clone https://github.com/apache/xerces-c.git
$ cd xerces-c
$ mkdir build
$ cd build
$ cmake -G \"Unix Makefiles\" -DCMAKE_BUILD_TYPE=Debug ..
$ make -j8
$ cp ../samples/data/personal.xml .

$ cat <<EOF >personal.dtd
<?xml encoding=\"ISO-8859-1\"?>
<!ENTITY % nonExistentEntity SYSTEM \"non-existent.ent\">
%nonExistentEntity;
EOF

$ gdb samples/StdInParse
(gdb) b IGXMLScanner.cpp:1544
(gdb) run <personal.xml
1544	            fReaderMgr.pushReader(reader, declDTD);
(gdb) p declDTD
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) n
1547	            dtdScanner.scanExtSubsetDecl(false, true);
(gdb) n
1548	        }
(gdb) s
...
(gdb) s                     # The Janitor is about to delete the above declDTD.
90	        delete fData;
(gdb) p fData
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) b ReaderMgr.cpp:1024
(gdb) n
...
(gdb) n                     # Now we about to dereference the deleted declDTD.
1024	    if (curEntity && !curEntity->isExternal())
(gdb) p curEntity
$2 = (const xercesc_4_0::XMLEntityDecl *) 0x49ac68

Origin: https://github.com/apache/xerces-c/commit/e0024267504188e42ace4dd9031d936786914835
Bug: https://github.com/apache/xerces-c/pull/47
Bug: https://github.com/apache/xerces-c/pull/54
Bug: https://issues.apache.org/jira/browse/XERCESC-2188
Bug-Debian: https://security-tracker.debian.org/tracker/CVE-2018-1311
Bug-Debian: https://bugs.debian.org/947431

Gbp-Pq: Name CVE-2018-1311.patch")[CVE-2018-1311](https://github.com/advisories/GHSA-7rpp-hwhj-9hv8 "CVE-2018-1311")[)](/raspbian-packages/xerces-c/commit/b06d40107d9b0e76b4c111f90bc7b682fc832c0c "XERCESC-2188 - Use-after-free on external DTD scan (CVE-2018-1311)

These are the instructions for observing the bug (before this commit):

$ git clone https://github.com/apache/xerces-c.git
$ cd xerces-c
$ mkdir build
$ cd build
$ cmake -G \"Unix Makefiles\" -DCMAKE_BUILD_TYPE=Debug ..
$ make -j8
$ cp ../samples/data/personal.xml .

$ cat <<EOF >personal.dtd
<?xml encoding=\"ISO-8859-1\"?>
<!ENTITY % nonExistentEntity SYSTEM \"non-existent.ent\">
%nonExistentEntity;
EOF

$ gdb samples/StdInParse
(gdb) b IGXMLScanner.cpp:1544
(gdb) run <personal.xml
1544	            fReaderMgr.pushReader(reader, declDTD);
(gdb) p declDTD
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) n
1547	            dtdScanner.scanExtSubsetDecl(false, true);
(gdb) n
1548	        }
(gdb) s
...
(gdb) s                     # The Janitor is about to delete the above declDTD.
90	        delete fData;
(gdb) p fData
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) b ReaderMgr.cpp:1024
(gdb) n
...
(gdb) n                     # Now we about to dereference the deleted declDTD.
1024	    if (curEntity && !curEntity->isExternal())
(gdb) p curEntity
$2 = (const xercesc_4_0::XMLEntityDecl *) 0x49ac68

Origin: https://github.com/apache/xerces-c/commit/e0024267504188e42ace4dd9031d936786914835
Bug: https://github.com/apache/xerces-c/pull/47
Bug: https://github.com/apache/xerces-c/pull/54
Bug: https://issues.apache.org/jira/browse/XERCESC-2188
Bug-Debian: https://security-tracker.debian.org/tracker/CVE-2018-1311
Bug-Debian: https://bugs.debian.org/947431

Gbp-Pq: Name CVE-2018-1311.patch")`
…

`[b06d401](/raspbian-packages/xerces-c/commit/b06d40107d9b0e76b4c111f90bc7b682fc832c0c)`

```
These are the instructions for observing the bug (before this commit):

$ git clone <https://github.com/apache/xerces-c.git>
$ cd xerces-c
$ mkdir build
$ cd build
$ cmake -G "Unix Makefiles" -DCMAKE_BUILD_TYPE=Debug ..
$ make -j8
$ cp ../samples/data/personal.xml .

$ cat <<EOF >personal.dtd
<?xml encoding="ISO-8859-1"?>
<!ENTITY % nonExistentEntity SYSTEM "non-existent.ent">
%nonExistentEntity;
EOF

$ gdb samples/StdInParse
(gdb) b IGXMLScanner.cpp:1544
(gdb) run <personal.xml
1544	            fReaderMgr.pushReader(reader, declDTD);
(gdb) p declDTD
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) n
1547	            dtdScanner.scanExtSubsetDecl(false, true);
(gdb) n
1548	        }
(gdb) s
...
(gdb) s                     # The Janitor is about to delete the above declDTD.
90	        delete fData;
(gdb) p fData
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) b ReaderMgr.cpp:1024
(gdb) n
...
(gdb) n                     # Now we about to dereference the deleted declDTD.
1024	    if (curEntity && !curEntity->isExternal())
(gdb) p curEntity
$2 = (const xercesc_4_0::XMLEntityDecl *) 0x49ac68

Origin: [apache/xerces-c@e002426](https://github.com/apache/xerces-c/commit/e0024267504188e42ace4dd9031d936786914835)
Bug: [apache/xerces-c#47](https://github.com/apache/xerces-c/pull/47)
Bug: [apache/xerces-c#54](https://github.com/apache/xerces-c/pull/54)
Bug: <https://issues.apache.org/jira/browse/XERCESC-2188>
Bug-Debian: <https://security-tracker.debian.org/tracker/CVE-2018-1311>
Bug-Debian: <https://bugs.debian.org/947431>

Gbp-Pq: Name [CVE-2018-1311](https://github.com/advisories/GHSA-7rpp-hwhj-9hv8 "CVE-2018-1311").patch
```

[raspbian-autopush](/raspbian-autopush)
pushed a commit
to raspbian-packages/xerces-c
that referenced
this pull request
[Jan 4, 2024](#ref-commit-947103e)
[![@karen-arutyunov](https://avatars.githubusercontent.com/u/11507038?s=40&u=b3139a77415676c0f1c5d9c7253681f774b68ea2&v=4)](/karen-arutyunov)

`[XERCESC-2188 - Use-after-free on external DTD scan (](/raspbian-packages/xerces-c/commit/947103e38da3ca91b6f3ae84f64ccc3a25e8d139 "XERCESC-2188 - Use-after-free on external DTD scan (CVE-2018-1311)

These are the instructions for observing the bug (before this commit):

$ git clone https://github.com/apache/xerces-c.git
$ cd xerces-c
$ mkdir build
$ cd build
$ cmake -G \"Unix Makefiles\" -DCMAKE_BUILD_TYPE=Debug ..
$ make -j8
$ cp ../samples/data/personal.xml .

$ cat <<EOF >personal.dtd
<?xml encoding=\"ISO-8859-1\"?>
<!ENTITY % nonExistentEntity SYSTEM \"non-existent.ent\">
%nonExistentEntity;
EOF

$ gdb samples/StdInParse
(gdb) b IGXMLScanner.cpp:1544
(gdb) run <personal.xml
1544	            fReaderMgr.pushReader(reader, declDTD);
(gdb) p declDTD
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) n
1547	            dtdScanner.scanExtSubsetDecl(false, true);
(gdb) n
1548	        }
(gdb) s
...
(gdb) s                     # The Janitor is about to delete the above declDTD.
90	        delete fData;
(gdb) p fData
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) b ReaderMgr.cpp:1024
(gdb) n
...
(gdb) n                     # Now we about to dereference the deleted declDTD.
1024	    if (curEntity && !curEntity->isExternal())
(gdb) p curEntity
$2 = (const xercesc_4_0::XMLEntityDecl *) 0x49ac68

Origin: https://github.com/apache/xerces-c/commit/e0024267504188e42ace4dd9031d936786914835
Bug: https://github.com/apache/xerces-c/pull/47
Bug: https://github.com/apache/xerces-c/pull/54
Bug: https://issues.apache.org/jira/browse/XERCESC-2188
Bug-Debian: https://security-tracker.debian.org/tracker/CVE-2018-1311
Bug-Debian: https://bugs.debian.org/947431

Gbp-Pq: Name CVE-2018-1311.patch")[CVE-2018-1311](https://github.com/advisories/GHSA-7rpp-hwhj-9hv8 "CVE-2018-1311")[)](/raspbian-packages/xerces-c/commit/947103e38da3ca91b6f3ae84f64ccc3a25e8d139 "XERCESC-2188 - Use-after-free on external DTD scan (CVE-2018-1311)

These are the instructions for observing the bug (before this commit):

$ git clone https://github.com/apache/xerces-c.git
$ cd xerces-c
$ mkdir build
$ cd build
$ cmake -G \"Unix Makefiles\" -DCMAKE_BUILD_TYPE=Debug ..
$ make -j8
$ cp ../samples/data/personal.xml .

$ cat <<EOF >personal.dtd
<?xml encoding=\"ISO-8859-1\"?>
<!ENTITY % nonExistentEntity SYSTEM \"non-existent.ent\">
%nonExistentEntity;
EOF

$ gdb samples/StdInParse
(gdb) b IGXMLScanner.cpp:1544
(gdb) run <personal.xml
1544	            fReaderMgr.pushReader(reader, declDTD);
(gdb) p declDTD
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) n
1547	            dtdScanner.scanExtSubsetDecl(false, true);
(gdb) n
1548	        }
(gdb) s
...
(gdb) s                     # The Janitor is about to delete the above declDTD.
90	        delete fData;
(gdb) p fData
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) b ReaderMgr.cpp:1024
(gdb) n
...
(gdb) n                     # Now we about to dereference the deleted declDTD.
1024	    if (curEntity && !curEntity->isExternal())
(gdb) p curEntity
$2 = (const xercesc_4_0::XMLEntityDecl *) 0x49ac68

Origin: https://github.com/apache/xerces-c/commit/e0024267504188e42ace4dd9031d936786914835
Bug: https://github.com/apache/xerces-c/pull/47
Bug: https://github.com/apache/xerces-c/pull/54
Bug: https://issues.apache.org/jira/browse/XERCESC-2188
Bug-Debian: https://security-tracker.debian.org/tracker/CVE-2018-1311
Bug-Debian: https://bugs.debian.org/947431

Gbp-Pq: Name CVE-2018-1311.patch")`
…

`[947103e](/raspbian-packages/xerces-c/commit/947103e38da3ca91b6f3ae84f64ccc3a25e8d139)`

```
These are the instructions for observing the bug (before this commit):

$ git clone <https://github.com/apache/xerces-c.git>
$ cd xerces-c
$ mkdir build
$ cd build
$ cmake -G "Unix Makefiles" -DCMAKE_BUILD_TYPE=Debug ..
$ make -j8
$ cp ../samples/data/personal.xml .

$ cat <<EOF >personal.dtd
<?xml encoding="ISO-8859-1"?>
<!ENTITY % nonExistentEntity SYSTEM "non-existent.ent">
%nonExistentEntity;
EOF

$ gdb samples/StdInParse
(gdb) b IGXMLScanner.cpp:1544
(gdb) run <personal.xml
1544	            fReaderMgr.pushReader(reader, declDTD);
(gdb) p declDTD
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) n
1547	            dtdScanner.scanExtSubsetDecl(false, true);
(gdb) n
1548	        }
(gdb) s
...
(gdb) s                     # The Janitor is about to delete the above declDTD.
90	        delete fData;
(gdb) p fData
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) b ReaderMgr.cpp:1024
(gdb) n
...
(gdb) n                     # Now we about to dereference the deleted declDTD.
1024	    if (curEntity && !curEntity->isExternal())
(gdb) p curEntity
$2 = (const xercesc_4_0::XMLEntityDecl *) 0x49ac68

Origin: [apache/xerces-c@e002426](https://github.com/apache/xerces-c/commit/e0024267504188e42ace4dd9031d936786914835)
Bug: [apache/xerces-c#47](https://github.com/apache/xerces-c/pull/47)
Bug: [apache/xerces-c#54](https://github.com/apache/xerces-c/pull/54)
Bug: <https://issues.apache.org/jira/browse/XERCESC-2188>
Bug-Debian: <https://security-tracker.debian.org/tracker/CVE-2018-1311>
Bug-Debian: <https://bugs.debian.org/947431>

Gbp-Pq: Name [CVE-2018-1311](https://github.com/advisories/GHSA-7rpp-hwhj-9hv8 "CVE-2018-1311").patch
```

[raspbian-autopush](/raspbian-autopush)
pushed a commit
to raspbian-packages/xerces-c
that referenced
this pull request
[Feb 15, 2024](#ref-commit-040fdd9)
[![@karen-arutyunov](https://avatars.githubusercontent.com/u/11507038?s=40&u=b3139a77415676c0f1c5d9c7253681f774b68ea2&v=4)](/karen-arutyunov)

`[XERCESC-2188 - Use-after-free on external DTD scan (](/raspbian-packages/xerces-c/commit/040fdd9ddbe164295571394c101c9ae3eb08895e "XERCESC-2188 - Use-after-free on external DTD scan (CVE-2018-1311)

These are the instructions for observing the bug (before this commit):

$ git clone https://github.com/apache/xerces-c.git
$ cd xerces-c
$ mkdir build
$ cd build
$ cmake -G \"Unix Makefiles\" -DCMAKE_BUILD_TYPE=Debug ..
$ make -j8
$ cp ../samples/data/personal.xml .

$ cat <<EOF >personal.dtd
<?xml encoding=\"ISO-8859-1\"?>
<!ENTITY % nonExistentEntity SYSTEM \"non-existent.ent\">
%nonExistentEntity;
EOF

$ gdb samples/StdInParse
(gdb) b IGXMLScanner.cpp:1544
(gdb) run <personal.xml
1544	            fReaderMgr.pushReader(reader, declDTD);
(gdb) p declDTD
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) n
1547	            dtdScanner.scanExtSubsetDecl(false, true);
(gdb) n
1548	        }
(gdb) s
...
(gdb) s                     # The Janitor is about to delete the above declDTD.
90	        delete fData;
(gdb) p fData
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) b ReaderMgr.cpp:1024
(gdb) n
...
(gdb) n                     # Now we about to dereference the deleted declDTD.
1024	    if (curEntity && !curEntity->isExternal())
(gdb) p curEntity
$2 = (const xercesc_4_0::XMLEntityDecl *) 0x49ac68

Origin: https://github.com/apache/xerces-c/commit/e0024267504188e42ace4dd9031d936786914835
Bug: https://github.com/apache/xerces-c/pull/47
Bug: https://github.com/apache/xerces-c/pull/54
Bug: https://issues.apache.org/jira/browse/XERCESC-2188
Bug-Debian: https://security-tracker.debian.org/tracker/CVE-2018-1311
Bug-Debian: https://bugs.debian.org/947431

Gbp-Pq: Name CVE-2018-1311.patch")[CVE-2018-1311](https://github.com/advisories/GHSA-7rpp-hwhj-9hv8 "CVE-2018-1311")[)](/raspbian-packages/xerces-c/commit/040fdd9ddbe164295571394c101c9ae3eb08895e "XERCESC-2188 - Use-after-free on external DTD scan (CVE-2018-1311)

These are the instructions for observing the bug (before this commit):

$ git clone https://github.com/apache/xerces-c.git
$ cd xerces-c
$ mkdir build
$ cd build
$ cmake -G \"Unix Makefiles\" -DCMAKE_BUILD_TYPE=Debug ..
$ make -j8
$ cp ../samples/data/personal.xml .

$ cat <<EOF >personal.dtd
<?xml encoding=\"ISO-8859-1\"?>
<!ENTITY % nonExistentEntity SYSTEM \"non-existent.ent\">
%nonExistentEntity;
EOF

$ gdb samples/StdInParse
(gdb) b IGXMLScanner.cpp:1544
(gdb) run <personal.xml
1544	            fReaderMgr.pushReader(reader, declDTD);
(gdb) p declDTD
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) n
1547	            dtdScanner.scanExtSubsetDecl(false, true);
(gdb) n
1548	        }
(gdb) s
...
(gdb) s                     # The Janitor is about to delete the above declDTD.
90	        delete fData;
(gdb) p fData
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) b ReaderMgr.cpp:1024
(gdb) n
...
(gdb) n                     # Now we about to dereference the deleted declDTD.
1024	    if (curEntity && !curEntity->isExternal())
(gdb) p curEntity
$2 = (const xercesc_4_0::XMLEntityDecl *) 0x49ac68

Origin: https://github.com/apache/xerces-c/commit/e0024267504188e42ace4dd9031d936786914835
Bug: https://github.com/apache/xerces-c/pull/47
Bug: https://github.com/apache/xerces-c/pull/54
Bug: https://issues.apache.org/jira/browse/XERCESC-2188
Bug-Debian: https://security-tracker.debian.org/tracker/CVE-2018-1311
Bug-Debian: https://bugs.debian.org/947431

Gbp-Pq: Name CVE-2018-1311.patch")`
…

`[040fdd9](/raspbian-packages/xerces-c/commit/040fdd9ddbe164295571394c101c9ae3eb08895e)`

```
These are the instructions for observing the bug (before this commit):

$ git clone <https://github.com/apache/xerces-c.git>
$ cd xerces-c
$ mkdir build
$ cd build
$ cmake -G "Unix Makefiles" -DCMAKE_BUILD_TYPE=Debug ..
$ make -j8
$ cp ../samples/data/personal.xml .

$ cat <<EOF >personal.dtd
<?xml encoding="ISO-8859-1"?>
<!ENTITY % nonExistentEntity SYSTEM "non-existent.ent">
%nonExistentEntity;
EOF

$ gdb samples/StdInParse
(gdb) b IGXMLScanner.cpp:1544
(gdb) run <personal.xml
1544	            fReaderMgr.pushReader(reader, declDTD);
(gdb) p declDTD
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) n
1547	            dtdScanner.scanExtSubsetDecl(false, true);
(gdb) n
1548	        }
(gdb) s
...
(gdb) s                     # The Janitor is about to delete the above declDTD.
90	        delete fData;
(gdb) p fData
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) b ReaderMgr.cpp:1024
(gdb) n
...
(gdb) n                     # Now we about to dereference the deleted declDTD.
1024	    if (curEntity && !curEntity->isExternal())
(gdb) p curEntity
$2 = (const xercesc_4_0::XMLEntityDecl *) 0x49ac68

Origin: [apache/xerces-c@e002426](https://github.com/apache/xerces-c/commit/e0024267504188e42ace4dd9031d936786914835)
Bug: [apache/xerces-c#47](https://github.com/apache/xerces-c/pull/47)
Bug: [apache/xerces-c#54](https://github.com/apache/xerces-c/pull/54)
Bug: <https://issues.apache.org/jira/browse/XERCESC-2188>
Bug-Debian: <https://security-tracker.debian.org/tracker/CVE-2018-1311>
Bug-Debian: <https://bugs.debian.org/947431>

Gbp-Pq: Name [CVE-2018-1311](https://github.com/advisories/GHSA-7rpp-hwhj-9hv8 "CVE-2018-1311").patch
```

[raspbian-autopush](/raspbian-autopush)
pushed a commit
to raspbian-packages/xerces-c
that referenced
this pull request
[May 25, 2024](#ref-commit-a3556b6)
[![@karen-arutyunov](https://avatars.githubusercontent.com/u/11507038?s=40&u=b3139a77415676c0f1c5d9c7253681f774b68ea2&v=4)](/karen-arutyunov) [![@bgermann](https://avatars.githubusercontent.com/u/9329107?s=40&v=4)](/bgermann)

`[XERCESC-2188 - Use-after-free on external DTD scan (](/raspbian-packages/xerces-c/commit/a3556b69f2c76baee7d1537dcb4847f6813f891f "XERCESC-2188 - Use-after-free on external DTD scan (CVE-2018-1311)

These are the instructions for observing the bug (before this commit):

$ git clone https://github.com/apache/xerces-c.git
$ cd xerces-c
$ mkdir build
$ cd build
$ cmake -G \"Unix Makefiles\" -DCMAKE_BUILD_TYPE=Debug ..
$ make -j8
$ cp ../samples/data/personal.xml .

$ cat <<EOF >personal.dtd
<?xml encoding=\"ISO-8859-1\"?>
<!ENTITY % nonExistentEntity SYSTEM \"non-existent.ent\">
%nonExistentEntity;
EOF

$ gdb samples/StdInParse
(gdb) b IGXMLScanner.cpp:1544
(gdb) run <personal.xml
1544	            fReaderMgr.pushReader(reader, declDTD);
(gdb) p declDTD
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) n
1547	            dtdScanner.scanExtSubsetDecl(false, true);
(gdb) n
1548	        }
(gdb) s
...
(gdb) s                     # The Janitor is about to delete the above declDTD.
90	        delete fData;
(gdb) p fData
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) b ReaderMgr.cpp:1024
(gdb) n
...
(gdb) n                     # Now we about to dereference the deleted declDTD.
1024	    if (curEntity && !curEntity->isExternal())
(gdb) p curEntity
$2 = (const xercesc_4_0::XMLEntityDecl *) 0x49ac68

Origin: https://github.com/apache/xerces-c/commit/e0024267504188e42ace4dd9031d936786914835
Bug: https://github.com/apache/xerces-c/pull/47
Bug: https://github.com/apache/xerces-c/pull/54
Bug: https://issues.apache.org/jira/browse/XERCESC-2188
Bug-Debian: https://security-tracker.debian.org/tracker/CVE-2018-1311
Bug-Debian: https://bugs.debian.org/947431

Gbp-Pq: Name CVE-2018-1311.patch")[CVE-2018-1311](https://github.com/advisories/GHSA-7rpp-hwhj-9hv8 "CVE-2018-1311")[)](/raspbian-packages/xerces-c/commit/a3556b69f2c76baee7d1537dcb4847f6813f891f "XERCESC-2188 - Use-after-free on external DTD scan (CVE-2018-1311)

These are the instructions for observing the bug (before this commit):

$ git clone https://github.com/apache/xerces-c.git
$ cd xerces-c
$ mkdir build
$ cd build
$ cmake -G \"Unix Makefiles\" -DCMAKE_BUILD_TYPE=Debug ..
$ make -j8
$ cp ../samples/data/personal.xml .

$ cat <<EOF >personal.dtd
<?xml encoding=\"ISO-8859-1\"?>
<!ENTITY % nonExistentEntity SYSTEM \"non-existent.ent\">
%nonExistentEntity;
EOF

$ gdb samples/StdInParse
(gdb) b IGXMLScanner.cpp:1544
(gdb) run <personal.xml
1544	            fReaderMgr.pushReader(reader, declDTD);
(gdb) p declDTD
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) n
1547	            dtdScanner.scanExtSubsetDecl(false, true);
(gdb) n
1548	        }
(gdb) s
...
(gdb) s                     # The Janitor is about to delete the above declDTD.
90	        delete fData;
(gdb) p fData
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) b ReaderMgr.cpp:1024
(gdb) n
...
(gdb) n                     # Now we about to dereference the deleted declDTD.
1024	    if (curEntity && !curEntity->isExternal())
(gdb) p curEntity
$2 = (const xercesc_4_0::XMLEntityDecl *) 0x49ac68

Origin: https://github.com/apache/xerces-c/commit/e0024267504188e42ace4dd9031d936786914835
Bug: https://github.com/apache/xerces-c/pull/47
Bug: https://github.com/apache/xerces-c/pull/54
Bug: https://issues.apache.org/jira/browse/XERCESC-2188
Bug-Debian: https://security-tracker.debian.org/tracker/CVE-2018-1311
Bug-Debian: https://bugs.debian.org/947431

Gbp-Pq: Name CVE-2018-1311.patch")`
…

`[a3556b6](/raspbian-packages/xerces-c/commit/a3556b69f2c76baee7d1537dcb4847f6813f891f)`

```
These are the instructions for observing the bug (before this commit):

$ git clone <https://github.com/apache/xerces-c.git>
$ cd xerces-c
$ mkdir build
$ cd build
$ cmake -G "Unix Makefiles" -DCMAKE_BUILD_TYPE=Debug ..
$ make -j8
$ cp ../samples/data/personal.xml .

$ cat <<EOF >personal.dtd
<?xml encoding="ISO-8859-1"?>
<!ENTITY % nonExistentEntity SYSTEM "non-existent.ent">
%nonExistentEntity;
EOF

$ gdb samples/StdInParse
(gdb) b IGXMLScanner.cpp:1544
(gdb) run <personal.xml
1544	            fReaderMgr.pushReader(reader, declDTD);
(gdb) p declDTD
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) n
1547	            dtdScanner.scanExtSubsetDecl(false, true);
(gdb) n
1548	        }
(gdb) s
...
(gdb) s                     # The Janitor is about to delete the above declDTD.
90	        delete fData;
(gdb) p fData
$1 = (xercesc_4_0::DTDEntityDecl *) 0x49ac68
(gdb) b ReaderMgr.cpp:1024
(gdb) n
...
(gdb) n                     # Now we about to dereference the deleted declDTD.
1024	    if (curEntity && !curEntity->isExternal())
(gdb) p curEntity
$2 = (const xercesc_4_0::XMLEntityDecl *) 0x49ac68

Origin: [apache/xerces-c@e002426](https://github.com/apache/xerces-c/commit/e0024267504188e42ace4dd9031d936786914835)
Bug: [apache/xerces-c#47](https://github.com/apache/xerces-c/pull/47)
Bug: [apache/xerces-c#54](https://github.com/apache/xerces-c/pull/54)
Bug: <https://issues.apache.org/jira/browse/XERCESC-2188>
Bug-Debian: <https://security-tracker.debian.org/tracker/CVE-2018-1311>
Bug-Debian: <https://bugs.debian.org/947431>

Gbp-Pq: Name [CVE-2018-1311](https://github.com/advisories/GHSA-7rpp-hwhj-9hv8 "CVE-2018-1311").patch
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fxerces-c%2Fpull%2F54)

Reviewers

[![@theta682](https://avatars.githubusercontent.com/u/1522049?s=40&v=4)](/theta682) [theta682](/theta682)

theta682 left review comments

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@boris-kolpackov](https://avatars.githubusercontent.com/u/31799599?s=52&v=4)](/boris-kolpackov) [![@theta682](https://avatars.githubusercontent.com/u/1522049?s=52&v=4)](/theta682) [![@karen-arutyunov](https://avatars.githubusercontent.com/u/11507038?s=52&v=4)](/karen-arutyunov)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.apache.org_1c139656_20250110_132626.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.


