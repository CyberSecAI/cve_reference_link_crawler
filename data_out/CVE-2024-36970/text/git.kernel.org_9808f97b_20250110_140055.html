

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3d913719df14c28c4d3819e7e6d150760222bda4)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3d913719df14c28c4d3819e7e6d150760222bda4)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3d913719df14c28c4d3819e7e6d150760222bda4)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3d913719df14c28c4d3819e7e6d150760222bda4)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ben Greear <greearb@candelatech.com> | 2024-04-30 16:42:12 -0700 |
| --- | --- | --- |
| committer | Johannes Berg <johannes.berg@intel.com> | 2024-05-03 09:19:16 +0200 |
| commit | [3d913719df14c28c4d3819e7e6d150760222bda4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3d913719df14c28c4d3819e7e6d150760222bda4) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3d913719df14c28c4d3819e7e6d150760222bda4)) | |
| tree | [dc08481b1ddbfbfdff5dafcf4a2af6efa2853e3b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3d913719df14c28c4d3819e7e6d150760222bda4) | |
| parent | [52afb15e9d9a021ab6eec923a087ec9f518cb713](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=52afb15e9d9a021ab6eec923a087ec9f518cb713) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3d913719df14c28c4d3819e7e6d150760222bda4&id2=52afb15e9d9a021ab6eec923a087ec9f518cb713)) | |
| download | [linux-3d913719df14c28c4d3819e7e6d150760222bda4.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3d913719df14c28c4d3819e7e6d150760222bda4.tar.gz) | |

wifi: iwlwifi: Use request\_module\_nowaitThis appears to work around a deadlock regression that came in
with the LED merge in 6.9.
The deadlock happens on my system with 24 iwlwifi radios, so maybe
it something like all worker threads are busy and some work that needs
to complete cannot complete.
Link: [https://lore.kernel.org/linux-kernel/20240411070718.GD6194@google.com/](https://lore.kernel.org/linux-kernel/20240411070718.GD6194%40google.com/)
Fixes: f5c31bcf604d ("Merge tag 'leds-next-6.9' of git://git.kernel.org/pub/scm/linux/kernel/git/lee/leds")
Signed-off-by: Ben Greear <greearb@candelatech.com>
Link: [https://msgid.link/20240430234212.2132958-1-greearb@candelatech.com](https://msgid.link/20240430234212.2132958-1-greearb%40candelatech.com)
[also remove unnecessary "load\_module" var and now-wrong comment]
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3d913719df14c28c4d3819e7e6d150760222bda4)

| -rw-r--r-- | [drivers/net/wireless/intel/iwlwifi/iwl-drv.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/intel/iwlwifi/iwl-drv.c?id=3d913719df14c28c4d3819e7e6d150760222bda4) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 9 deletions

| diff --git a/drivers/net/wireless/intel/iwlwifi/iwl-drv.c b/drivers/net/wireless/intel/iwlwifi/iwl-drv.cindex 4696d73c8971b6..1b7254569a37a5 100644--- a/[drivers/net/wireless/intel/iwlwifi/iwl-drv.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/intel/iwlwifi/iwl-drv.c?id=52afb15e9d9a021ab6eec923a087ec9f518cb713)+++ b/[drivers/net/wireless/intel/iwlwifi/iwl-drv.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/intel/iwlwifi/iwl-drv.c?id=3d913719df14c28c4d3819e7e6d150760222bda4)@@ -1484,7 +1484,6 @@ static void iwl\_req\_fw\_callback(const struct firmware \*ucode\_raw, void \*context) size\_t trigger\_tlv\_sz[FW\_DBG\_TRIGGER\_MAX]; u32 api\_ver; int i;- bool load\_module = false; bool usniffer\_images = false; bool failure = true; @@ -1732,19 +1731,12 @@ static void iwl\_req\_fw\_callback(const struct firmware \*ucode\_raw, void \*context) goto out\_unbind; } } else {- load\_module = true;+ request\_module\_nowait("%s", op->name); } mutex\_unlock(&iwlwifi\_opmode\_table\_mtx);  complete(&drv->request\_firmware\_complete); - /\*- \* Load the module last so we don't block anything- \* else from proceeding if the module fails to load- \* or hangs loading.- \*/- if (load\_module)- request\_module("%s", op->name); failure = false; goto free; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:59:32 +0000

