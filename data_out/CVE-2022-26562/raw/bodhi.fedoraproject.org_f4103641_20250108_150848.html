




<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="management of Fedora Project updates" />
    <meta name="author" content="Luke Macken" />
    <meta name="author" content="Ralph Bean" />
    <meta name="author" content="Randy Barlow" />

    <!-- Only allow websockets connections to fedoraproject.org. -->
    <meta http-equiv="Content-Security-Policy" content="connect-src https://*.fedoraproject.org/ wss://hub.fedoraproject.org:9939/">

    <link rel="shortcut icon" href="https://bodhi.fedoraproject.org/static/v8.3.0/ico/favicon.ico">

    <base href="https://bodhi.fedoraproject.org/"/>
    <title>
      
  FEDORA-EPEL-2023-342b96903b
&mdash;
security update for zarafa
&mdash; Fedora Updates System

    </title>

    

    <link href="https://bodhi.fedoraproject.org/static/v8.3.0/vendor/fedora-bootstrap/fedora-bootstrap.min.css" rel="stylesheet" />
    <link href="https://bodhi.fedoraproject.org/static/v8.3.0/fonts/open-sans.css" rel="stylesheet" />
    <link href="https://bodhi.fedoraproject.org/static/v8.3.0/fonts/hack.css" rel="stylesheet" />
    <link href="https://bodhi.fedoraproject.org/static/v8.3.0/fonts/font-awesome.css" rel="stylesheet" />
    <link href="https://bodhi.fedoraproject.org/static/v8.3.0/vendor/jquery-typeahead/jquery.typeahead.min.css" rel="stylesheet" />
    <link href="https://bodhi.fedoraproject.org/static/v8.3.0/css/site.css" rel="stylesheet" />
    
<link rel="alternate" type="application/atom+xml" title="New Comments on FEDORA-EPEL-2023-342b96903b" href="https://bodhi.fedoraproject.org/rss/comments/?updates=FEDORA-EPEL-2023-342b96903b"/>
<link href="https://bodhi.fedoraproject.org/static/v8.3.0/vendor/messenger/css/messenger.css" rel="stylesheet" />
<link href="https://bodhi.fedoraproject.org/static/v8.3.0/vendor/messenger/css/messenger-theme-flat.css" rel="stylesheet" />


  </head>

  <body>
    <div class="masthead py-2">
      <div class="container px-0">
        <nav class="navbar navbar-expand-md pt-0 pb-0">
          <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#bodhi-navbar" aria-controls="bodhi-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <a class="navbar-brand" href="https://bodhi.fedoraproject.org/">
                <img src="https://bodhi.fedoraproject.org/static/v8.3.0/img/bodhi-logo.png" alt="Fedora Update System" height="40">
            </a>

            <div id="bodhi-navbar" class="navbar-collapse collapse">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item fw-bold">
                        <a class="nav-link" href="https://bodhi.fedoraproject.org/releases/">
                            Releases
                        </a>
                    </li>
                    <li class="nav-item fw-bold">
                        <a class="nav-link active" aria-current="page" href="https://bodhi.fedoraproject.org/updates/?releases=__current__&releases=__pending__">
                            Updates
                        </a>
                    </li>
                    <li class="nav-item fw-bold">
                        <a class="nav-link" href="https://bodhi.fedoraproject.org/overrides/?expired=False">
                            Overrides
                        </a>
                    </li>

                    <form id="bodhi-searchbar" name="bodhi-searchbar" class="mx-2">
                        <div class="typeahead__container">
                            <div class="typeahead__field">
                                <div class="typeahead__query">
                                    <input class="bodhi-searchbar-input" name="bodhi-searchbar-input" placeholder="Search..." autocomplete="off">
                                </div>
                            </div>
                        </div>
                    </form>


                    <li class="nav-item ms-3">
                        <a class="btn btn-primary" href="https://bodhi.fedoraproject.org/login?came_from=https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2023-342b96903b">Login</a>
                    </li>
                </ul>
            </div>
          </div>
        </nav>
      </div>
    </div>
    <div class="bodycontent pb-3">
        










<div class="subheader pt-3">
<div class="container">
<div class="row">
  <div class="col-md-12">
  <div class="row">
    <div class="col-md-auto order-md-last text-end mb-1 mb-md-0">
              <span class="badge bg-success">
                  
  <span class="fw-bold">stable</span>

              </span>
    </div>
    <div class="col-md">
      <row class="align-items-center no-gutters">
            <div class="d-flex align-items-center">
              <div class="h3 text-center flex-shrink-0 me-1">
                  <span data-toggle='tooltip' title='This is a security update'><i class='fa fa-fw fa-shield'></i></span>
              </div>
              <div class="flex-grow-1 ms-0">
                    <h3 class="fw-bold">
                      zarafa-7.1.14-6.el7
                    </h3>
                    FEDORA-EPEL-2023-342b96903b created by <a href="https://bodhi.fedoraproject.org/users/robert"> robert</a>
                    <span title="2023-04-29 22:27:09.055784+00:00 UTC"> a year ago </span>
                    for <a href="https://bodhi.fedoraproject.org/releases/EPEL-7">Fedora EPEL 7
                    </a>
              </div>
            </div>
      </row>
    </div>
  </div>
  </div>
</div>
<ul class="nav nav-tabs pt-2" role="tablist" id="updateTabList">
  <li class="nav-item" role="presentation">
    <button class="nav-link active" id="details-tab" data-bs-toggle="tab" data-bs-target="#details-tab-pane" type="button" role="tab" aria-selected="true">Details</button>
  </li>

  <li class="nav-item" role="presentation">
    <button class="nav-link" id="builds-tab" data-bs-toggle="tab" data-bs-target="#builds-tab-pane" type="button" role="tab">Builds <span class="badge text-bg-secondary">1</span></button>
  </li>

  <li class="nav-item" role="presentation">
    <button class="nav-link" id="bugs-tab" data-bs-toggle="tab" data-bs-target="#bugs-tab-pane" type="button" role="tab">Bugs <span class="badge text-bg-secondary">1</span></button>
  </li>


  <li class="nav-item" role="presentation">
    <button class="nav-link" id="automatedtests-tab" data-bs-toggle="tab" data-bs-target="#automatedtests-tab-pane" type="button" role="tab">
      Automated Tests
      <span style="display:none" class='badge text-bg-success'>
        <span class='fa fa-check-circle'></span>
        <span id="automatedtests-success"></span>
      </span>
      <span style="display:none" class='badge text-bg-info'>
        <span class='fa fa-info-circle'></span>
        <span id="automatedtests-info"></span>
      </span>
      <span style="display:none" class='badge text-bg-warning'>
        <span class='fa fa-exclamation-circle'></span>
        <span id="automatedtests-warning"></span>
      </span>
      <span style="display:none" class='badge text-bg-danger'>
        <span class='fa fa-minus-circle'></span>
        <span id="automatedtests-danger"></span>
      </span>
      <span id="automatedtests-progress" class="badge text-bg-secondary"></span>
    </button>
  </li>

</ul>
</div>
</div>
<div class="container pt-4">
  <!-- Tab panes -->
  <div class="tab-content" id="updateTabContent">
    <div class="tab-pane show active" id="details-tab-pane" role="tabpanel" aria-labelledby="details-tab" tabindex="0">
      <div class="row">
        <div class="col-md-9">

          <div class="markdown"><ul>
<li>Backported patch from Debian to fix CVE-2022-26562 (#2192126)</li>
</ul></div>



          <div class="pt-2 mt-4 border-top">
            <!--<h4>Comments <span class="badge text-bg-secondary">5</span>
              <small><a href="https://bodhi.fedoraproject.org/rss/comments/?updates=FEDORA-EPEL-2023-342b96903b">
                  <span class="fa fa-rss"></span>
              </a></small>
            </h4>-->
            <div id="comments">
              <div id="comment-3006213">
                
<div class="row">
        <div class="col-12 text-muted font-size-09">
          <div class="d-flex p-2 align-items-top">
            <i class="fa fa-info-circle pt-2"></i>
            <div class="fw-bold"><p>This update has been submitted for testing by robert. </p></div>
            <a href="updates/FEDORA-EPEL-2023-342b96903b#comment-3006213" class="notblue pt-1 ms-auto text-nowrap" data-bs-toggle="tooltip" title="2023-04-29 22:27:10 (UTC)">
              a year ago
            </a>
          </div>
        </div>
</div>

              </div>
              <div id="comment-3006214">
                
<div class="row">
        <div class="col-12 text-muted font-size-09">
          <div class="d-flex p-2 align-items-top">
            <i class="fa fa-info-circle pt-2"></i>
            <div class="fw-bold"><p>This update's test gating status has been changed to 'ignored'.</p></div>
            <a href="updates/FEDORA-EPEL-2023-342b96903b#comment-3006214" class="notblue pt-1 ms-auto text-nowrap" data-bs-toggle="tooltip" title="2023-04-29 22:27:10 (UTC)">
              a year ago
            </a>
          </div>
        </div>
</div>

              </div>
              <div id="comment-3006226">
                
<div class="row">
        <div class="col-12 text-muted font-size-09">
          <div class="d-flex p-2 align-items-top">
            <i class="fa fa-info-circle pt-2"></i>
            <div class="fw-bold"><p>This update has been pushed to testing.</p></div>
            <a href="updates/FEDORA-EPEL-2023-342b96903b#comment-3006226" class="notblue pt-1 ms-auto text-nowrap" data-bs-toggle="tooltip" title="2023-04-30 00:19:43 (UTC)">
              a year ago
            </a>
          </div>
        </div>
</div>

              </div>
              <div id="comment-3014486">
                
<div class="row">
        <div class="col-12 text-muted font-size-09">
          <div class="d-flex p-2 align-items-top">
            <i class="fa fa-info-circle pt-2"></i>
            <div class="fw-bold"><p>This update has been submitted for stable by bodhi. </p></div>
            <a href="updates/FEDORA-EPEL-2023-342b96903b#comment-3014486" class="notblue pt-1 ms-auto text-nowrap" data-bs-toggle="tooltip" title="2023-05-07 00:22:19 (UTC)">
              a year ago
            </a>
          </div>
        </div>
</div>

              </div>
              <div id="comment-3015063">
                
<div class="row">
        <div class="col-12 text-muted font-size-09">
          <div class="d-flex p-2 align-items-top">
            <i class="fa fa-info-circle pt-2"></i>
            <div class="fw-bold"><p>This update has been pushed to stable.</p></div>
            <a href="updates/FEDORA-EPEL-2023-342b96903b#comment-3015063" class="notblue pt-1 ms-auto text-nowrap" data-bs-toggle="tooltip" title="2023-05-08 00:48:52 (UTC)">
              a year ago
            </a>
          </div>
        </div>
</div>

              </div>
            </div>
          </div>
          <hr/>
          <div class="alert alert-secondary bg-light mt-5 mb-3 text-center text-muted">
            <p>
              Please <a href="https://bodhi.fedoraproject.org/login?came_from=https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2023-342b96903b">login</a> to add feedback.
            </p>
          </div>
        </div>
        <div class="col-md-3 font-size-09">
            <div>

              <div class="h5 d-flex align-items-center fw-bold border-bottom">
                  <div class="py-2 text-uppercase font-size-09">Metadata</div>
              </div>

              <div class="pb-1">
                  <div class="row">
                    <div class="col fw-bold text-muted">Type</div>
                    <div class="col-auto fw-bold">
                        <span data-toggle='tooltip' title='This is a security update'><i class='fa fa-fw fa-shield'></i></span> security
                    </div>
                  </div>
              </div>

              <div class="pb-1">
                  <div class="row">
                    <div class="col fw-bold text-muted">Severity</div>
                    <div class="col-auto fw-bold">
                        medium
                    </div>
                  </div>
              </div>

              <div class="pb-1">
                  <div class="row">
                    <div class="col fw-bold text-muted">Karma</div>
                    <div class="col-auto fw-bold text-center">
                        
  
  <span class="text-muted">
    <span class="min-width-3 d-inline-block d-md-block d-xl-inline-block text-center">
      <i class="fa fa-thumbs-up text-muted pe-1 pe-md-0 pe-xl-1"></i>
    </span>
      0
  </span>

                    </div>
                  </div>
              </div>

              <div class="pb-1">
                  <div class="row">
                    <div class="col fw-bold text-muted">Signed</div>
                    <div class="col-auto fw-bold">
                        <span class="fa fa-check text-success" aria-hidden="true" data-bs-toggle="tooltip" data-bs-placement="top" title="Update signed"></span>
                    </div>
                  </div>
              </div>

              <div class="pb-1">
                  <div class="row">
                    <div class="col fw-bold text-muted">Content Type</div>
                    <div class="col-auto fw-bold">
                        RPM
                    </div>
                  </div>
              </div>
            </div>
              <div class="mt-3">
                  <div class="h5 d-flex align-items-center fw-bold border-bottom">
                      <div class="py-2 text-uppercase font-size-09">
                          Test Gating
                      </div>
                    </div>
                <div class="pb-1">
                  <div id="test_status_badge">
                    <a class="gating-summary notblue" href="#">ignored</a>
                    <i class="spinner fa fa-spinner fa-spin fa-fw"></i>
                  </div>
                </div>
              </div>

              <div class="mt-3"><!-- Autopush settings div open -->
                  <div class="h5 d-flex align-items-center fw-bold border-bottom">
                      <span class="py-2 text-uppercase font-size-09">Autopush Settings</span>
                      <span class="ms-auto " data-bs-toggle='tooltip' title='These are the thresholds that apply to the autokarma and autotime functions, if enabled'><i class="fa fa-question-circle text-primary" aria-hidden="true"></i></span>
                  </div>

                  <div class="pb-1">
                    <div class="row">
                      <div class="col fw-bold text-muted">Unstable by Karma</div>
                      <div class="col-auto fw-bold">
                          <span class="text-muted fw-bold" data-bs-toggle='tooltip' title='The update will be marked as unstable when karma reaches -3 '>
                            <i class="fa fa-thumbs-down pe-1"></i>-3
                          </span>
                      </div>
                    </div>
                  </div>

                  <div class="pb-1">
                    <div class="row">
                      <div class="col fw-bold text-muted">Stable by Karma</div>
                      <div class="col-auto fw-bold">
                          <span class="text-muted fw-bold" data-bs-toggle='tooltip' title='The update will be automatically pushed to stable when karma reaches 3'>
                            <i class="fa fa-thumbs-up pe-1"></i>3
                          </span>
                      </div>
                    </div>
                  </div>

                  <div class="pb-1">
                    <div class="row">
                      <div class="col fw-bold text-muted">Stable by Time</div>
                      <div class="col-auto fw-bold">
                        <span class="text-muted fw-bold" data-bs-toggle='tooltip'
                        title='The update will be automatically pushed to stable after being in testing for 7 days'>
                          7 days
                        </span>
                      </div>
                    </div>
                  </div>
              </div><!-- Autopush settings div close -->


              <div class="mt-3"><!-- Dates div open -->
                  <div class="h5 d-flex align-items-center fw-bold border-bottom">
                      <div class="py-2 text-uppercase font-size-09">Dates</div>
                  </div>
                    <div class="row">
                      <div class="col fw-bold text-muted">submitted</div>
                      <div class="col-auto fw-bold">
                            <span class="text-muted fw-bold" data-bs-toggle='tooltip' title='2023-04-29 22:27:09 (UTC)'>
                                a year ago
                            </span>
                      </div>
                    </div>

                    <div class="row">
                      <div class="col fw-bold text-muted">in testing</div>
                        <div class="col-auto fw-bold">
                          <span class="text-muted fw-bold" data-bs-toggle='tooltip' title='2023-04-30 00:19:37 (UTC)'>
                            a year ago
                          </span>
                        </div>
                      </div>

                    <div class="row">
                      <div class="col fw-bold text-muted">in stable</div>
                        <div class="col-auto fw-bold">
                          <span class="text-muted fw-bold" data-bs-toggle='tooltip' title='2023-05-08 00:48:45 (UTC)'>
                            a year ago
                          </span>
                        </div>
                      </div>



                    <div class="row">
                      <div class="col fw-bold text-muted">approved</div>
                        <div class="col-auto fw-bold">
                          <span data-bs-toggle='tooltip' title='2023-05-07 00:22:18 (UTC)' class="text-muted fw-bold">
                              a year ago
                          </span>
                        </div>
                      </div>
              </div>
              <div class="mt-3">
                  <div class="h5 d-flex align-items-center fw-bold border-bottom">
                      <div class="py-2 text-uppercase font-size-09">Builds</div>
                       <span class="badge text-bg-secondary badge-pill ms-1">1</span>
                  </div>

              
              <div class="pb-1">
                  <div class="row">
                    <div class="col text-muted text-truncate" data-bs-toggle="tooltip" title="zarafa-7.1.14-6.el7"><a href="https://koji.fedoraproject.org/koji/search?terms=zarafa-7.1.14-6.el7&amp;type=build&amp;match=exact" target="_blank">
                        zarafa-7.1.14-6.el7</a></div>
                  </div>
              </div>
              </div><!-- Dates div close -->
        </div>
      </div>
    </div>

    <div class="tab-pane" id="bugs-tab-pane" role="tabpanel" aria-labelledby="bugs-tab" tabindex="0">
      <div class="list-group my-3">
        <div class="list-group-item">
          <div class="row align-self-center">
            <div class="col fw-bold"><a target='_blank' href='https://bugzilla.redhat.com/show_bug.cgi?id=2192126' class='notblue'>BZ#2192126</a> CVE-2022-26562: zarafa: Missing account validation in ECPAMAuthenticateUser()</div>
            <div class="col-auto ps-3 fw-bold">
  
  <span class="text-muted">
      <i class="fa fa-thumbs-down text-muted pe-1 pe-md-0 pe-xl-1"></i>
      0
  </span>
</div>
            <div class="col-auto ps-3 fw-bold">
  
  <span class="text-muted">
      <i class="fa fa-thumbs-up text-muted pe-1 pe-md-0 pe-xl-1"></i>
      0
  </span>
</div>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-pane justify-content-center" id="builds-tab-pane" role="tabpanel" aria-labelledby="builds-tab" tabindex="0">
      <div class="col-lg-9 list-group list-group-flush">
        <div class="list-group-item">
          <div class="d-flex flex-row justify-content-between align-items-center">
            <div class="flex-shrink-0 flex-grow-0">
              <span class="fa fa-key text-muted me-2" aria-hidden="true" data-bs-toggle="tooltip" data-placement="top" title="Build signed"></span>
            </div>
            <div class="flex-grow-1">
              
              <a href="https://koji.fedoraproject.org/koji/search?terms=zarafa-7.1.14-6.el7&amp;type=build&amp;match=exact" target="_blank">zarafa-7.1.14-6.el7</a>
            </div>
            <div class="flex-shrink-0">
              <a href='https://bodhi.fedoraproject.org/rss/updates/?packages=zarafa'>
                <span class="fa fa-rss ms-1" data-bs-toggle="tooltip" data-placement="top" title="RSS feed for new Bodhi updates containing zarafa"></span>
              </a>
              <a href='https://bodhi.fedoraproject.org/updates/?packages=zarafa'>
                <span class="fa fa-list ms-1" data-bs-toggle="tooltip" data-placement="top" title="Show other Bodhi updates for zarafa"></span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-pane" id="automatedtests-tab-pane" role="tabpanel" aria-labelledby="automatedtests-tab" tabindex="0">
      <div id="resultsdb">
        <h3>Automated Test Results</h3>
        <div id="gating-summary-tab">
          <a class="gating-summary notblue">ignored</a>
          <i class="fa spinner fa-spinner fa-spin fa-fw"></i>
        </div>
      </div>
    </div>

  </div>
</div> <!-- end container -->


<div class="modal fade" id="trigger_tests" tabindex="-1" role="dialog" aria-labelledby="waiveModalLabel" aria-hidden="true">
  <form>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="waiveModalLabel">Trigger Tests</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body">
          <div class="row">
            <div class="col-sm-offset-2 col-sm-10">
              <p>Confirm request to re-trigger tests.</p>
            </div>
          </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" aria-label="Cancel">Cancel</button>
        <button type="submit" class="btn btn-primary">Trigger new test run</button>
      </div>
    </div>
  </div>
  </form>
</div>




    </div> <!-- /bodycontent -->

    <div class="footer py-5">
      <div class="container">
        
        <p class="text-light text-center">
          Copyright &copy; 2007-2025 Red Hat, Inc. and
          <a href="https://github.com/fedora-infra/bodhi/graphs/contributors" class="text-white-50">
          others</a>.
        </p>
        <p class="text-light text-center">
          Running
          <strong>bodhi-server 8.3.0</strong> on
          <strong>bodhi-web-176-hkzmp</strong>.
        </p>
        <p class="text-light text-center">
          <a href="https://github.com/fedora-infra/bodhi" class="text-white-50">
          bodhi</a> is Free Software.
          Please <a href="https://github.com/fedora-infra/bodhi/issues" class="text-white-50">
          file issues</a>
          if you have any problems. Read the <a href="https://bodhi.readthedocs.io/en/8.3.0/" class="text-white-50">documentation</a>.
        </p>
        <p class="text-light text-center">
            <span>&bull;</span> <a href="https://bodhi.fedoraproject.org/composes/" class="text-white-50">Composes</a>
            <span>&bull;</span> <a href="https://fedoraproject.org/wiki/Legal:Main" class="text-white-50">Legal</a>
            <span>&bull;</span> <a href="https://fedoraproject.org/wiki/Legal:PrivacyPolicy" class="text-white-50">Privacy policy</a>
            <span>&bull;</span>
        </p>
      </div>
    </div>

    <!-- Alert Modal -->
    <div class="modal fade" id="alertModal" tabindex="-1" role="dialog" aria-labelledby="alertModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
      <div class="modal-dialog" role="document">
	<div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="alertModalLabel">Internal Server Error!</h5>
          </div>
          <div class="modal-body" id="alertModalDescription">
	     The server encountered an internal error
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <script>
      var settings = {
          bz_products: ["Fedora","Fedora EPEL","Fedora Modules"],
          bz_server_rest: "https://bugzilla.redhat.com/rest/"
      };
    </script>
    

    <script src="https://bodhi.fedoraproject.org/static/v8.3.0/vendor/jquery/jquery-3.6.0.min.js"></script>
    <script>
      $('#alertModal').on('hidden.bs.modal', function (e) {
          document.location.href = document.baseURI;
      })
    </script>
    <script src="https://bodhi.fedoraproject.org/static/v8.3.0/vendor/fedora-bootstrap/fedora-bootstrap.min.js"></script>
    <script src="https://bodhi.fedoraproject.org/static/v8.3.0/js/site.js"></script>
    <script src="https://bodhi.fedoraproject.org/static/v8.3.0/vendor/jquery-typeahead/jquery.typeahead.min.js"></script>
    <script src="https://bodhi.fedoraproject.org/static/v8.3.0/js/search.js"></script>
    
<script src="https://bodhi.fedoraproject.org/static/v8.3.0/vendor/messenger/js/messenger.min.js"></script>
<script src="https://bodhi.fedoraproject.org/static/v8.3.0/vendor/messenger/js/messenger-theme-flat.js"></script>
<script src="https://bodhi.fedoraproject.org/static/v8.3.0/js/forms.js"></script>
<script src="https://bodhi.fedoraproject.org/static/v8.3.0/js/comment_form.js"></script>
<script src="https://bodhi.fedoraproject.org/static/v8.3.0/vendor/moment/moment.min.js"></script>
<script>
  $(document).ready(function() {
    // Initialize popovers
    const popoverTriggerList = document.querySelectorAll('[data-bs-toggle="popover"]')
    const popoverList = [...popoverTriggerList].map(popoverTriggerEl => new bootstrap.Popover(popoverTriggerEl))
    const tabTrigger = new bootstrap.Tab($('#automatedtests-tab'))

    $('.gating-summary').click(function(e){
      e.preventDefault();
      tabTrigger.show();
    });

    // Some handy lookups that map resultsdb states to bootstrap CSS classes.
    var classes = {
      PASSED: 'success',
      INFO: 'info',
      FAILED: 'danger',
      NEEDS_INSPECTION: 'warning',
      ABORTED: 'warning',
      CRASHED: 'warning',
      ABSENT: 'danger',
      QUEUED: 'info',
      RUNNING: 'info',
    }
    var icons = {
      PASSED: 'check-circle',
      INFO: 'info-circle',
      FAILED: 'minus-circle',
      NEEDS_INSPECTION: 'exclamation-circle',
      ABORTED: 'trash',
      CRASHED: 'fire', // no joke.
      ABSENT: 'question-circle',
      QUEUED: 'hourglass-start',
      RUNNING: 'hourglass-half'
    }

    var update = 'FEDORA-EPEL-2023-342b96903b';
    var builds = ["zarafa-7.1.14-6.el7"];

    // These are the required tests (from greenwave)
    var requirements = [];
    // These are the known waivers of failed testcases (key - waiver id, value - waiver)
    var waivers = {};
    // These are waived test failures (key - subject, value - hash: key - testcase##scenario, value - waiver id)
    var waived = {};
    // show the Greenwave decision
    var greenwave_api_url = 'https://greenwave.fedoraproject.org/api/v1.0';
    var missing_tests = {};
    var invalid_gating_repos = [];
    var missing_gating_repos = [];
    var failed_fetch_gating_repos = [];
    var test_reqs_counter = 0;
    var unsatisfied_reqs_counter = 0;
    var remoteerror_reqs_counter = 0;
    var missing_reqs_counter = 0;
    var running_reqs_counter = 0;
    var greenwave_errors = 0;

    // handle Greenwave decision
    var handle_unsatisfied_requirements = function(data) {
        $.each(data['unsatisfied_requirements'], function(i, requirement) {
            unsatisfied_reqs_counter++;
            if (requirement.type == 'test-result-missing') {
                if (requirement.result_id) {
                    running_reqs_counter++;
                }
                else {
                    missing_reqs_counter++;
                    if (missing_tests[requirement.subject_identifier] === undefined)
                        missing_tests[requirement.subject_identifier] = [];
                    missing_tests[requirement.subject_identifier].push(requirement);
                }
            }
            if (requirement.type.match('gating-yaml')) {
                remoteerror_reqs_counter++;
                // these aren't 'test results' exactly
                test_reqs_counter--;
                if (requirement.type == 'invalid-gating-yaml')
                    invalid_gating_repos.push(requirement.subject_identifier);
                if (requirement.type == 'missing-gating-yaml')
                    missing_gating_repos.push(requirement.subject_identifier);
                if (requirement.type == 'failed-fetch-gating-yaml')
                    failed_fetch_gating_repos.push(requirement.subject_identifier);
            }
            if ($.inArray(requirement.testcase, requirements) == -1) {
                requirements.push(requirement.testcase);
            }
            $('#failed_requirements').append('<li class="list-group-item">' + requirement.testcase + '</li>');

            // there is at least one unsatisfied requirement, so show the button to be able to waive.
            $('#waive').removeAttr('hidden');
        });
    };

    var generate_requirements_summary = function() {
        if (missing_reqs_counter > 0) {
          label_class = classes['ABSENT'];
          icon_class = icons['ABSENT'];
        } else if (running_reqs_counter > 0) {
          label_class = classes['RUNNING'];
          icon_class = icons['RUNNING'];
        } else if (unsatisfied_reqs_counter > 0) {
          label_class = classes['FAILED'];
          icon_class = icons['FAILED'];
        } else {
          label_class = classes['PASSED'];
          icon_class = icons['PASSED'];
        }
        var summary = [];
        failed_reqs_counter = unsatisfied_reqs_counter - missing_reqs_counter - running_reqs_counter - remoteerror_reqs_counter;
        if (test_reqs_counter == 0) {
            summary = ['no tests are required'];
        } else {
            if (failed_reqs_counter > 0) {
                summary.push(failed_reqs_counter + ' of ' + test_reqs_counter + ' required tests failed');
            }
            if (running_reqs_counter > 0) {
                summary.push(running_reqs_counter + ' of ' + test_reqs_counter + ' required tests running');
            }
            if (missing_reqs_counter > 0) {
                summary.push(missing_reqs_counter + ' of ' + test_reqs_counter + ' required test results missing');
            }
            if (remoteerror_reqs_counter > 0) {
                summary.push(remoteerror_reqs_counter + ' errors handling remote rules');
            }
            if (summary.length == 0) {
                summary = ['All required tests passed'];
            }
        }
        summary = summary.join(', ')

        var html = '<span class="badge text-bg-' + label_class + '">' +
          '<span class="fa fa-' + icon_class + '">' +
          '</span></span> ';
        html += '<a class="gating-summary notblue" href="#">' + summary;
        html += '</a>';
        if (Object.keys(waived).length != 0) {
            var seensubjects = [];
            // Create urls to waiverdb with waivers for this update
            $.each(Object.keys(waived), function(i, subject) {
                if (!seensubjects.includes(subject)) {
                    seensubjects.push(subject);
                    var url = 'https://waiverdb.fedoraproject.org/api/v1.0';
                    url += '/waivers'
                    url += '?subject_identifier=' + subject;
                    html += '<a class="notblue" target="_blank" href=' + url + '>';
                    html += '<span data-toggle="tooltip" data-placement="top" ' +
                    'title="Some test failures or missing tests were waived." ' +
                    'class="fa fa-asterisk">' +
                    '</span>';
                    html += '</a>';
                }
            });
        }
        $('#test_status_badge').html(html);
        $('#gating-summary-tab').html(html);
        $('.gating-summary').click(function(e){
          e.preventDefault();
          tabTrigger.show();
        });
    };

    var get_greenwave_information = function(request, after_success) {
        request.verbose = true;
        $.ajax({
            url: greenwave_api_url + '/decision',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(request),
            success: function(data) {
                $.each(data.waivers, function(i, waiver) {
                  if (!(waiver.id in waivers)) { waivers[waiver.id] = waiver; }
                });
                handle_unsatisfied_requirements(data);
                $.each(data['satisfied_requirements'], function(i, requirement) {
                    if ($.inArray(requirement.testcase, requirements) == -1) {
                        requirements.push(requirement.testcase);
                    }
                    // stash data about waived failures
                    if (requirement.type == "test-result-failed-waived") {
                        if (!(requirement.subject_identifier in waived)) {
                            waived[requirement.subject_identifier] = {};
                        }
                        var key = [requirement.testcase, requirement.scenario].join('##');
                        waived[requirement.subject_identifier][key] = requirement.waiver_id;
                    }
                });
                test_reqs_counter += data['unsatisfied_requirements'].length;
                test_reqs_counter += data['satisfied_requirements'].length;
                handle_results(data.results, request.subject);
                after_success();
            },
            error: function (jqxhr, status, error) {
               greenwave_errors = 1;
               finish();
            },
        });
    };

    var make_row = function(subject, scenario, outcome, testcase, note, arch, time, url) {
      var icon = '<span data-bs-toggle="tooltip" data-placement="top" ' +
        'title="' + outcome + '" ' +
        'class="fa fa-' + icons[outcome] + ' text-' + classes[outcome] + '">'+
        '</span>';

      var flavor;
      var machine;
      if (scenario.includes("fedora.updates-")) {
        // this gets a correct flavor from an openQA scenario, e.g.
        // 'kde' from 'fedora.updates-kde.x86_64.64bit'
        flavor = scenario.split(".")[1].slice(8);
        // this gets the 'machine', which distinguishes between e.g.
        // BIOS and UEFI tests
        machine = scenario.split(".")[3];
      }

      var required = '';
      var key = [testcase, scenario].join('##');
      if (subject in waived && key in waived[subject]) {
        var w = waivers[waived[subject][key]];
        var reason = 'Waived by @' + w.username + ": '" + w.comment.replace("'", "&#39;") + "'";
        required = '<span style="white-space:pre-line;" data-bs-toggle="tooltip" data-placement="top" ' +
          'title="' + reason + '" ' +
          'class="fa fa-thumbs-up">' +
          '</span>';
      } else if ($.inArray(testcase, requirements) != -1) {
        required = '<span data-bs-toggle="tooltip" data-placement="top" ' +
          'title="' + testcase + ' is a required test" ' +
          'class="fa fa-asterisk">' +
          '</span>';
      }

      // for openQA tests, 'machine' tells us everything 'arch' does,
      // so we don't need both
      if (machine != undefined) {
        testcase = testcase + "&nbsp;<span class='badge text-bg-secondary'>"
          + machine + "</label>";
      } else if (arch != undefined) {
        testcase = testcase + "&nbsp;<span class='badge text-bg-secondary'>"
          + arch + "</label>";
      }

      if (flavor) {
        testcase = testcase + "&nbsp;<span class='badge text-bg-secondary'>"
          + flavor + "</label>";
      }

      var age = '';
      if (time != undefined) {
        // The ' Z' tells moment.js to interpret the time as UTC
        // https://github.com/fedora-infra/bodhi/issues/217
        var age = moment(time + ' Z').fromNow();
      }
      if (note == null){
        note = '';
      }
      html = '<tr class="row-automatedtests table-' + classes[outcome];
      if (outcome == 'ABSENT') {
          html += ' absent-automatedtest"';
      } else {
          html += '" style="cursor: pointer;" data-href="' + url + '"';
      }
      html += '>' +
        '<td>' + required + '</td>' +
        '<td>' + icon + '</td>' +
        '<td class="nowrap">' + testcase + '</td>' +
        '<td class="stretch-table-column text-xs-right">' + note + '</td>' +
        '<td class="nowrap">' + age + '</td>' +
        '</tr>';
      return html;
    };

    var handle_results = function(results, subjects) {
      var build_results = {}
      $.each(subjects, function(i, subject) {
        build_results[subject.item] = [];
      });

      // First, prune duplicate results.  For instance, some depcheck runs
      // happen multiple times on an update.  We only (imho) want to display
      // the latest ones for each arch.  So, prune like this:
      var latest = {};
      $.each(results, function(i, result) {
        var testcase = result.testcase.name;
        var scenario = 'no_scenario';
        if (result.data.scenario) {
            scenario = result.data.scenario[0];
        }
        // note: these are actually single-item arrays, though this doesn't
        // seem to break anything
        var arch = result.data.arch;
        var item = result.data.item;
        var submit_time = new Date(result.submit_time);

        var key = [item, testcase, arch, scenario].join('##');
        var last_submit_time = latest[key];
        if (last_submit_time === undefined || last_submit_time < submit_time) {
          latest[key] = submit_time;

          if (item in build_results) {
            build_results[item].push(result);
          } else {
            build_results[item] = [result];
          }
        }
      });

      $.each(build_results, function(buildname, results) {
        $("#resultsdb").append("<h4 class='pt-1'>" + buildname + "</h4>")

        // no results reported
        if (!(buildname in missing_tests) && results.length === 0) {
          $("#resultsdb").append("<p>No results reported for this build.</p>");
          return;
        }

        var table = $("<table class='table table-hover'><tbody></tbody></table>").appendTo("#resultsdb");

        // show missing tests and remote rule yaml problems first
        if (buildname in missing_tests) {
          $.each(missing_tests[buildname], function(i, result) {
            // note the data structure is a bit different for
            // test-result-missing than the other cases we handle at
            // the end, so getting scenario and subject is a bit
            // different. why? ask greenwave
            var scenario = 'no_scenario';
            if (result.scenario) {
                scenario = result.scenario;
            }
            table.append(make_row(
              result.item[0],
              scenario,
              'ABSENT',
              result.testcase,
              '',
              '',
              ''
            ));
          });
        }
        $.each(invalid_gating_repos, function (i, repo) {
          table.append(make_row(
            'Remote policy errors',
            'no_scenario',
            'FAILED',
            repo,
            'remote policy gating.yaml parsing failed',
            '',
            ''
          ));
        });
        $.each(missing_gating_repos, function (i, repo) {
          table.append(make_row(
            'Remote policy errors',
            'no_scenario',
            'FAILED',
            repo,
            'remote policy gating.yaml missing',
            '',
            ''
          ));
        });
        $.each(failed_fetch_gating_repos, function (i, repo) {
          table.append(make_row(
            'Remote policy errors',
            'no_scenario',
            'FAILED',
            repo,
            'remote policy gating.yaml retrieval failed',
            '',
            ''
          ));
        });

        $.each(results, function(i, result) {
          var scenario = 'no_scenario';
          if (result.data.scenario) {
              scenario = result.data.scenario[0];
          }

          table.append(make_row(
              result.data.item[0],
              scenario,
              result.outcome,
              result.testcase.name,
              result.note,
              // note: this is a single-item array
              result.data.arch,
              result.submit_time,
              result.ref_url
          ));
        });
      });
    };

    var update = function() {
      // add the count of tests to the automated tests tab
      $.each(['success', 'info', 'warning', 'danger'], function(i, counter) {
        var count = $('.row-automatedtests.table-' + counter).length;
        if (count > 0) {
          $("#automatedtests-" + counter).text(count).parent().show();
        }
      });

      // Make each cell clickable and awesome except the missing tests
      $('#resultsdb tr').not('.absent-automatedtest').off().click(function(event, row) {
        window.open($(this).attr('data-href'));
      });

      // And, re-do tooltips for newly created spans.
      $('#resultsdb span').tooltip();
    }

    var finish = function() {
      $("#tab-automatedtests .fa-spinner").remove();
      $('#resultsdb .spinner').remove();
      $('#test_status_badge .spinner').remove();
    }


    var request_results = function(url) {
      $.ajax(url, {
        beforeSend: function(xhr) {
          activeResultsAjaxCalls++;
        },
        dataType: 'jsonp',
        cache: false,
        success: receive_resultsdb,
      });
    };

    $("#tab-automatedtests").append(" <span class='fa fa-spinner fa-spin'></span>");

    var request_batches = [{"product_version": "fedora-epel-7", "decision_context": ["bodhi_update_push_stable"], "subject": [{"item": "zarafa-7.1.14-6.el7", "type": "koji_build"}, {"item": "FEDORA-EPEL-2023-342b96903b", "type": "bodhi_update"}], "verbose": true}];
    var current_batch = 0;
    var progress = $('#automatedtests-progress');
    var fetch_next_batch = function() {
      update()

      if (current_batch >= request_batches.length) {
        if (!greenwave_errors) { generate_requirements_summary(); }
        progress.remove()
        finish();
        return;
      }

      var percent = Math.floor(current_batch * 100 / request_batches.length)
      progress.text(percent + '%')

      var request = request_batches[current_batch]
      ++current_batch;

      get_greenwave_information(request, fetch_next_batch);
    };
    fetch_next_batch();
  });
</script>

<script>
$(document).ready(function() {
    var messenger = Messenger({theme: 'flat'});
    var update_id = 'FEDORA-EPEL-2023-342b96903b';
    $("#edit").attr('href',
        'https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2023-342b96903b/edit');

    $.each(['testing', 'stable', 'unpush', 'revoke'], function(i, action) {
      $("#updatebuttons #" + action).click(function() {
          if (action == 'unpush') {
              var r = confirm('Are you sure you want to unpush this update?');
              if (r === false) { return; }
          }
          $("#updatebuttons a").addClass('disabled');
          var url = 'https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2023-342b96903b/request';
          $.ajax({
              url: url,
              data: {
                request: action,
                csrf_token: "59b597fff776295d3ad20c4b3c4f92afaee6b396",
              },
              method: 'POST',
              dataType: 'json',
              success: function(response) {
                // Just reload the page if all went well..
                location.reload();
              },
              error: function(response) {
                $("#updatebuttons a").removeClass('disabled');
                $.each(response.responseJSON.errors, function(i, error) {
                    msg = messenger.post({
                      message: error.description,
                      type: "error",
                      hideAfter: false,
                      showCloseButton: true,
                    });
                });
              },
          });
      });
    });


    // handle for triggering of tests.
    $("#trigger_tests").submit(function(evt) {
      evt.preventDefault();
      var url = 'https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2023-342b96903b/trigger-tests';
      var $this = $(this);
      $.ajax({
        url: url,
        data: {
          csrf_token: "59b597fff776295d3ad20c4b3c4f92afaee6b396",
        },
        method: 'POST',
        dataType: 'json',
        success: function(response) {
          // Just reload the page to refresh the test gating status.
          location.reload();
        },
        error: function(response) {
          $this.modal('hide');
          $.each(response.responseJSON.errors, function(i, error) {
              msg = messenger.post({
                message: error.description,
                type: "error",
                hideAfter: false,
                showCloseButton: true,
              });
          });
        },
      });
    });
});
</script>

<script>
$(document).ready(function(){
    var button = document.getElementById('copybutton')

    if (button == null) {
        return;
    }

    button.addEventListener('click', function(event) {
        if (document.selection) { 
            document.selection.empty();
            var range = document.body.createTextRange();
            range.moveToElementText(document.getElementById('commandtext'));
            range.select().createTextRange();
            try {
                document.execCommand('copy');
            } catch (err) {
                console.log('Oops, unable to copy');
            }
        } else if (window.getSelection) {
            if (window.getSelection().empty) {  // Chrome
                window.getSelection().empty();
            } else if (window.getSelection().removeAllRanges) {  // Firefox
                window.getSelection().removeAllRanges();
            }
            var range = document.createRange();
            range.selectNode(document.getElementById('commandtext'));
            window.getSelection().addRange(range);
            try {
                document.execCommand('copy');
            } catch (err) {
                console.log('Oops, unable to copy');
            }
        }
    });
});
</script>

    
  </body>
</html>
