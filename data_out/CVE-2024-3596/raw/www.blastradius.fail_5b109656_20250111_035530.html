<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>BLAST RADIUS</title>
    <link rel="icon" type="image/x-icon" href="/img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css">

    <!-- Custom Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="fontawesome/css/all.min.css" type="text/css">

    <!-- Plugin CSS -->
    <link rel="stylesheet" href="css/animate.min.css" type="text/css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/main.css" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Mathjax Support -->
    <script type="text/javascript" async
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
</head>


<body id="page-top">
    <nav id="mainNav" class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand page-scroll" href="/#page-top">
                <img src="/img/Blast-RADIUS/Blast-RADIUS_1_transparent_reduced_width.png"\>
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    
                    <a class="page-scroll" href="#abstract">overview</a>
                </li>
                <li>
                    <a class="page-scroll" href="#paper">Paper</a>
                </li>
                <li>
                    
                    <a class="page-scroll" href="#mitigation">Mitigation</a>
                </li>
                <li>
                    <a class="page-scroll" href="#questions">FAQ</a>
                </li>
                <li>
                    <a class="page-scroll" href="#contact">Research Team</a>
                </li>
                <li>
                    
                    <a href="/attack-details">Attack Details</a>
                </li>
                <li>
                    
                    <a href="/coverage.html">Coverage</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container-fluid -->
</nav>

    
<section id="abstract" class="bg-darkxs">
    <div class="container">
        <div class="row">
            <div class="col-md-12 text-center">
              <h1>
                <img src="/img/Blast-RADIUS/Blast-RADIUS_1_transparent_reduced_width.png"/>
              </h1>
              <hr>
              <p>Blast-RADIUS is a vulnerability that affects the RADIUS protocol. 
RADIUS is a very common protocol used for authentication,
authorization, and accounting (AAA) for networked devices on
enterprise and telecommunication networks.</p>

<h3 id="what-can-the-attacker-do">What can the attacker do?</h3>

<p>The Blast-RADIUS attack allows a man-in-the-middle attacker between
the RADIUS client and server to forge a valid protocol accept message
in response to a failed authentication request.  This forgery could
give the attacker access to network devices and services without the
attacker guessing or brute forcing passwords or shared secrets.  The
attacker does not learn user credentials.</p>

<h3 id="who-is-affected">Who is affected?</h3>

<p>Blast-RADIUS is a protocol vulnerability, and thus affects all
RADIUS implementations using non-EAP authentication methods over UDP.</p>

<p>System administrators of networks using RADIUS should check with
vendors for a patch against this vulnerability, and follow best
practices for RADIUS configuration as discussed below.  There is
nothing that end users can do on their own to protect against this
attack.</p>

<p>RADIUS is used in a wide variety of applications, including in
enterprise networks to authenticate access to switches and other
routing infrastructure, for VPN access, by ISPs for DSL and FTTH
(Fiber to the Home), in 802.1X and Wi-Fi authentication, 2G and 3G
cellular roaming and 5G DNN (Data Network Name) authentication, mobile
Wi-Fi offload with SIM card-based authentication, private APN
authentication, to authenticate access to critical infrastructure, and
in the Eduroam and OpenRoaming wifi consortia.</p>

<h3 id="what-is-the-vulnerability">What is the vulnerability?</h3>

<p>The RADIUS protocol predates modern cryptographic guarantees and is
typically unencrypted and unauthenticated.  However, the protocol does
attempt to authenticate server responses using an ad hoc construction
based on the MD5 hash function and a fixed shared secret between a
client and server.</p>

<p>Our attack combines a novel protocol vulnerability with an MD5
chosen-prefix collision attack and several new speed and space
improvements.  The attacker injects a malicious attribute into a
request that causes a collision between the authentication information
in the valid server response and the attacker’s desired forgery.
This allows the attacker to turn a reject into an accept, and
add arbitrary protocol attributes.</p>

              <a href="/attack-details" class="btn btn-primary btn-xl page-scroll">in-depth attack description</a>
            </div>
        </div>
    </div>
</section>

    <aside class="bg-bright" id="paper">
    <div class="container">
        <div class="call-to-action">
          <h2>Paper</h2>
	  <hr class="primary">
            <p>
                <b>
                    <a href="pdf/radius.pdf">RADIUS&#47;UDP considered harmful</a>
                </b>
                <br>
                    Sharon Goldberg, Miro Haller, Nadia Heninger, Mike Milano, Dan Shumow, Marc Stevens, and Adam Suhl.
                <br>
                <i>To appear at USENIX Security 2024.</i>
            </p>
        </div>
    </div>
</aside>

    
<section id="mitigation" class="bg-darkxs">
    <div class="container">
        <div class="row">
            <div class="col-md-12 text-center">
                <h2 class="section-heading">Mitigation</h2>
                <hr class="primary">
                <p>Network administrators and vendors should follow the guidance given in this <a href="https://www.inkbridgenetworks.com/blastradius">white paper</a> authored by Alan DeKok of FreeRADIUS.</p>

<p>Our recommended short-term mitigation for implementers and vendors is to mandate that clients and servers always send and require <code class="language-plaintext highlighter-rouge">Message-Authenticator</code> attributes for <em>all</em> requests and responses. For <code class="language-plaintext highlighter-rouge">Access-Accept</code> or <code class="language-plaintext highlighter-rouge">Access-Reject</code> responses, the <code class="language-plaintext highlighter-rouge">Message-Authenticator</code> should be included as the <em>first</em> attribute. Patches implementing this mitigation have been implemented by all RADIUS implementations that we are aware of.  This guidance is being put into an upcoming <a href="https://datatracker.ietf.org/doc/draft-ietf-radext-deprecating-radius/">RADIUS RFC</a>.</p>

<p>The long-term mitigation is to use RADIUS inside of an encrypted and authenticated channel that offers modern cryptographic security guarantees. The IETF has begun work to standardize <a href="https://datatracker.ietf.org/doc/draft-ietf-radext-radiusdtls-bis/">RADIUS over (D)TLS</a>.</p>

            </div>
        </div>
    </div>
</section>

    <section id="questions" class="bg-bright">
    <div class="container">
        <div class="row">
            <div class="col-md-12 text-center">
                <h2 class="section-heading">Q &amp; A</h2>
                <hr class="primary">
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="panel-group">
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#what-do">
                            What should I do about this issue?
                        </h4>
                    </div>
                    <div id="what-do" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>If you are an end user, there is nothing that you can or should do.</p>

<p>If you are a system administrator, then consider the following questions:</p>

<ol>
  <li>
    <p>Is all RADIUS traffic accounting, and only accounting?  Our attack does not seem to be practical in that setting.  You should still upgrade everything, but you can take your time.</p>
  </li>
  <li>
    <p>Are all Access-Request packets sent over RADIUS/TLS (RadSec)?  The TLS should protect against our attack.  You should still upgrade everything, but you can take your time.</p>
  </li>
  <li>
    <p>Are your RADIUS servers only doing EAP authentication, and no other kinds of authentication?  Our attack does not seem to be practical in that setting.  You should still upgrade everything, but you can take your time.</p>
  </li>
  <li>
    <p>Are the RADIUS servers only handling local requests?  That is, no RADIUS servers in your network are doing proxying?  Upgrade your RADIUS servers first.  All server vendors have deployed a mitigation that includes a Message-Authenticator attribute as the first attribute of every response, which we believe mitigates our attack. You should still upgrade your NAS equipment/RADIUS clients, but this is less critical than updating servers immediately.</p>
  </li>
  <li>
    <p>For everyone else, you should upgrade your RADIUS servers immediately, then upgrade clients/NAS equipment where possible, and set the configuration flags on both sides to require Message-Authenticator attributes.  The specific configuration is vendor-specific and you will need to consult your RADIUS vendor.</p>
  </li>
</ol>

<p>You can find other FAQs on the upgrade process <a href="https://www.inkbridgenetworks.com/blastradius/faq">here</a>.</p>

                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#vuln-id">
                            What is the CVE number?
                        </h4>
                    </div>
                    <div id="vuln-id" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>CERT/CC coordinated our disclosure and has assigned <a href="https://www.cve.org/CVERecord?id=CVE-2024-3596">CVE-2024-3596</a> and <a href="https://kb.cert.org/vuls/id/456537">VU#456537</a> to this vulnerability.</p>

                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#pocs">
                            Is attack code available?
                        </h4>
                    </div>
                    <div id="pocs" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>A script with an example collision is available <a href="/example.py">here</a>.
The <code class="language-plaintext highlighter-rouge">--verbose</code> option allows the printing of unshortened values.
The script goes through the attack step by step:</p>
<ol>
  <li>The Access-Request sent by the RADIUS client, from which the adversary learns the Request Authenticator and IDs.</li>
  <li>The MITM uses these values from the Access-Request to predict Accept and Reject prefixes and then computes the collision gibberish that it computes for these prefixes.</li>
  <li>The MITM assembles the Access-Request with that Reject gibberish appended, that is sent to the RADIUS server.</li>
  <li>The Access-Reject sent back by the server contains the Response Authenticator.</li>
  <li>The MITM puts this value to assemble the Access-Accept.</li>
  <li>We show both the Access-Accept and Access-Reject both produce the same Response Authenticator.</li>
</ol>

<p>We are not publishing end-to-end attack code.  Our improvements to the
MD5 chosen-prefix collision attack are available in the <a href="https://github.com/cr-marcstevens/hashclash/pull/37">hashclash
GitHub
repository</a>.</p>

<p>If you are a vendor or system administrator who wishes to test for this vulnerability, a
RADIUS server implementation is vulnerable if it does not require a
Message-Authenticator attribute in every client request.  A RADIUS
client is vulnerable if it does not require a Message-Authenticator
attribute from every server response.  See <a href="https://www.inkbridgenetworks.com/blastradius">Alan DeKok’s white
paper</a>
for more information.</p>

                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#hashclash-improvements">
                            Hasn't MD5 been broken for 20 years?  How is this attack new?
                        </h4>
                    </div>
                    <div id="hashclash-improvements" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>Our attack is more complex than simply applying an old MD5 collision attack.</p>

<p>While an MD5 hash collision was first demonstrated in 2004, it was not
thought to be possible to exploit this in the context of the RADIUS
protocol.  Our attack identifies a protocol vulnerability in the way
RADIUS uses MD5 that allows the attacker to inject a malicious
protocol attribute that produces a hash collision between the
server-generated Response Authenticator and the attacker’s desired
forged response packet.</p>

<p>In addition, because our attack is online, the attacker needs to be
able to compute a so-called chosen-prefix MD5 collision attack in minutes
or seconds.  The previous best reported chosen-prefix collision attack
times took hours, and produced collisions that were not compatible with the RADIUS
protocol.</p>

<p>We introduce several improvements in speed, space, and scaling for the
existing MD5 attacks to demonstrate that these collisions can be
computed in at most minutes and can fit within RADIUS protocol
attributes.</p>

                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#practicality">
                            Is your attack practical?
                        </h4>
                    </div>
                    <div id="practicality" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>Yes and no.  In the proof-of-concept attacks described in our paper,
it took us 3 to 6 minutes to compute the MD5 chosen-prefix hash collision
required for the attack.  This is longer than the 30- to 60-second
timeouts that are commonly used in practice for RADIUS.</p>

<p>However, every step of the collision algorithm parallelizes well and
is amenable to hardware optimization, so we expect a well-resourced
attacker could obtain running times that are tens or hundreds of times faster
by implementing the attack on GPUs, FPGAs, or hardware.</p>

<p>Our reported running times are from optimizing some 15 year old code
and running it on a bunch of 7 to 10 year old CPUs, because this is
what we have access to.  We did not think that spending further
engineering effort to make MD5 collisions faster was a good use of
time when MD5 should have been abolished 20 years ago.</p>

                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#threat-model">
                            What is the threat model for this attack? Who can run it?
                        </h4>
                    </div>
                    <div id="threat-model" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>Our attack requires the adversary to have network access to act as a man-in-the-middle attacker on the connection between the victim device’s RADIUS client and RADIUS server.  When there are proxies, the attack can occur between any hop.
Our attacker will need to be able to act as a full network man-in-the-middle who can read, intercept, block, and modify inbound and outbound network packets.</p>

<p>Such access to RADIUS traffic may happen through different mechanisms. Although sending RADIUS/UDP over the open internet is discouraged, this is still known to <a href="https://www.ietf.org/archive/id/draft-ietf-radext-deprecating-radius-01.html">happen</a> <a href="https://www.rfc-editor.org/rfc/rfc6614">in practice</a>. For internal network traffic, the attacker might initially compromise part of an enterprise network; such compromises appear frequently in <a href="https://www.404media.co/cyber-official-speaks-out-reveals-mobile-network-attacks-in-u-s/">news reports</a> and <a href="https://www.cisa.gov/sites/default/files/2023-01/ar-16-20173.pdf">security advisories</a>.  Even if RADIUS traffic is confined to a protected part of an internal network, configuration or routing mistakes might unintentionally expose this traffic. An attacker with partial network access may be able to <a href="https://www.leviathansecurity.com/blog/tunnelvision">exploit DHCP or other mechanisms to cause victim devices to send traffic outside of a dedicated VPN</a>.</p>

<p>Our adversary does not know the shared secret between the RADIUS client and server.</p>


                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#vlan">
                            Our RADIUS traffic is in a separate VLAN; are we secure against this attack?
                        </h4>
                    </div>
                    <div id="vlan" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>A current best practice for RADIUS/UDP traffic is to expose it only to a restricted-access management VLAN within an organization.  While this reduces the attack surface and is certainly preferable to exposing UDP traffic to a broader network or the open internet, there may still be vulnerabilities in case of a network misconfiguration or attacker compromise of this portion of the network.</p>

<p>This approach is also at odds with the US Executive Branch Office of Management and Budget’s <a href="https://www.whitehouse.gov/wp-content/uploads/2022/01/M-22-09.pdf">2022 memo</a>, which envisions moving to systems that do not rely on network separation for security: “A key tenet of a zero trust architecture is that no network is implicitly considered trusted”.</p>

                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#whos-affected">
                            Who is affected by these vulnerabilities?
                        </h4>
                    </div>
                    <div id="whos-affected" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>Nearly all RADIUS/UDP implementations are vulnerable to our protocol attack when using non-EAP authentication methods.  RADIUS is used by many organizations to control access to a wide variety of network devices and services.  Our attack requires man-in-the-middle network access; organizations should evaluate their own network security threat model.</p>

<p>RADIUS implementers, vendors, and system administrators should follow <a href="https://datatracker.ietf.org/doc/draft-ietf-radext-deprecating-radius/">best practices</a> and <a href="https://www.inkbridgenetworks.com/blastradius">the guidance in this document</a>.  Our attack does not compromise end user credentials, and there is nothing that end users can do to protect against this attack.</p>

<p>EAP authentication methods are protected against our attack because <a href="https://datatracker.ietf.org/doc/html/rfc2869">RFC 2869</a> mandates that a <code class="language-plaintext highlighter-rouge">Message-Authenticator</code> attribute must be present, and this attribute is an HMAC-MD5 over the entire packet that we cannot forge. A theoretical protocol vulnerability appears to exist, but may not be practically exploitable.  RADIUS Accounting also appears to be affected by a theoretical protocol vulnerability that seems to be difficult to exploit in practice.</p>


                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#impact">
                            What is the impact of your attacks?
                        </h4>
                    </div>
                    <div id="impact" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>An adversary exploiting our attack can escalate privileges from partial network access to being able to log into any device that uses RADIUS for authentication, or to assign itself arbitrary network privileges.</p>

<p>RADIUS is used for remote access for diverse use cases including network routers and switches, industrial control systems, VPNs, ISPs using DSL or FTTH, Linux Pluggable Authentication Modules, 2G and 3G cellular roaming and 5G DNN authentication, and mobile Wi-Fi offload with SIM card-based authentication.</p>

                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#detect-compromise">
                            Can I detect whether this attack was run on my network?
                        </h4>
                    </div>
                    <div id="detect-compromise" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>Yes, but you need log files of <code class="language-plaintext highlighter-rouge">Access-Rejects</code> on the RADIUS server and <code class="language-plaintext highlighter-rouge">Access-Accepts</code> on the RADIUS client.</p>

<p>If you have detailed log files on the RADIUS client that log the values of all attributes, you could look for suspicious <code class="language-plaintext highlighter-rouge">Proxy-State</code> attributes. If there are <code class="language-plaintext highlighter-rouge">Access-Accept</code> packets with <code class="language-plaintext highlighter-rouge">Proxy-State</code> attributes consisting of random bytes, then this might be a sign of an attack.  End clients should not receive packets with <code class="language-plaintext highlighter-rouge">Proxy-State</code> attributes.</p>

<p>To confirm an attack, you need would need to find the corresponding <code class="language-plaintext highlighter-rouge">Access-Reject</code> (or any other type) response packet in the RADIUS server logs, and verify that the server’s response differs from the response received by the client, and that both contain valid <code class="language-plaintext highlighter-rouge">Response Authenticator</code> values for the request ID and <code class="language-plaintext highlighter-rouge">Request Authenticator</code>.</p>

<!-- should we publish code to check this? -->

<p>If both of these packets produce the same MD5 hash in the <code class="language-plaintext highlighter-rouge">Response Authenticator</code>, this issue was exploited in your system.</p>

                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#how-mitigate">
                            How can we mitigate this attack in our system?
                        </h4>
                    </div>
                    <div id="how-mitigate" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>We recommend reading the <a href="https://www.inkbridgenetworks.com/blastradius">detailed guide for implementors</a> published by Alan DeKok, the maintainer of FreeRADIUS.</p>

<p>Patches including the short-term mitigation described in the <a href="#mitigation">mitigation section</a> will be available from major RADIUS implementations in coordinated release with this work; downstream vendors and network operators should check for and apply these patches.  Where an option exists to require a <code class="language-plaintext highlighter-rouge">Message-Authenticator</code> attribute on all packets, this option should be enabled.</p>

<p>Implementers, vendors, and admins should follow the guidance in this <a href="https://datatracker.ietf.org/doc/draft-ietf-radext-deprecating-radius/">IETF draft to deprecate insecure practices in RADIUS</a> to mitigate numerous other attacks; we expect future versions to mandate <code class="language-plaintext highlighter-rouge">Message-Authenticator</code> attributes in more settings.</p>

<p>The long-term mitigation for our attack is to use RADIUS inside of a modern cryptographically protected transport like TLS 1.3.  The IETF RADEXT working group has existing <a href="https://datatracker.ietf.org/doc/draft-ietf-radext-radiusdtls-bis/00/">drafts in progress outlining RADIUS/(D)TLS</a>.</p>

                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#backward-compatibility">
                            Are your recommended mitigations backward compatible?
                        </h4>
                    </div>
                    <div id="backward-compatibility" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>It depends.</p>

<p>Including a <code class="language-plaintext highlighter-rouge">Message-Authenticator</code> attribute in every packet is backward compatible.  Unfortunately, requiring the presence of a <code class="language-plaintext highlighter-rouge">Message-Authenticator</code> attribute in requests and responses may not be backward compatible with old client or server implementations that do not have the option to include them.</p>

<p>Our long-term mitigation of moving to RADIUS/TLS requires clients and servers that support TLS, as well as new configuration (like PKI) on the part of network operators.  TLS may not be supported at all on older hardware.</p>

                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#bad-mitigations">
                            I have a different idea for a mitigation that I think works better.
                        </h4>
                    </div>
                    <div id="bad-mitigations" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>A number of tempting, commonly suggested countermeasures do not sufficiently mitigate the vulnerability.</p>

<h3 id="decreasing-timeouts">Decreasing Timeouts</h3>

<p>It is tempting to hope that simply setting a shorter client timeout would mitigate our attack.  We believe this should not be done: it decreases usability and does not protect against our attack.</p>

<p>Our MD5 collisions were computed after applying some optimizations to a 15-year-old proof-of-concept codebase, which we are running on CPUs mostly dating from seven to ten years ago, because these are the resources we have access to.  An adversary with a budget for professional engineering would be able to decrease the computational cost of the collision by a factor of tens to hundreds.</p>

<p>The most common timeout in practice is 30 seconds, and 60 seconds is commonly recommended when multifactor authentication is involved, since shorter timeouts could be problematic for real users.</p>

<h3 id="using-tacacs-or-diameter">Using TACACS+ or Diameter</h3>

<p>RADIUS is not the only protocol to suffer from the types of security issues that we outline.  TACACS+ is a popular (TCP-based) administrator login protocol for switches that also does not meet modern cryptographic security standards.  <a href="https://www.rfc-editor.org/info/rfc8907">RFC 8907</a> was published in September 2020, and explicitly mandates that TACACS+ be used with a secure transport.
However, much like RADIUS, TACACS+ is still most commonly used over insecure transports.</p>

<p>Diameter (<a href="https://www.rfc-editor.org/info/rfc6733">RFC 6733</a>) was initially designed as a successor to RADIUS, although it never replaced RADIUS for many common use cases.  It is used in 3G+ networks, and is generally only supported in large NAS equipment used by bigger ISPs and telecommunications providers; consumer or enterprise-grade equipment typically only supports RADIUS.<br />
Although Diameter was intended to replace RADIUS, the protocol itself offers no security when used over TCP.  As a result, RFC 6733 suggests that Diameter messages should be secured using TLS or DTLS; 5G has replaced Diameter with signaling over HTTP/2. The US government <a href="https://www.404media.co/cyber-official-speaks-out-reveals-mobile-network-attacks-in-u-s/">has described exploits</a> against Diameter targeting mobile users.</p>

<h3 id="random-shared-secrets">Random shared secrets</h3>

<p>Organizations can protect against dictionary attacks on the shared secret by picking random shared secrets of sufficient length, as the runtime of such an attack grows exponentially with the entropy of the secret. For example, <a href="https://datatracker.ietf.org/doc/draft-ietf-radext-deprecating-radius/00/">this work-in-progress IETF draft</a> recommends shared secrets with at least 96 bits of entropy, so an offline dictionary attack would involve on the order of \(2^{96}\) MD5 compressions. However, as our attack does not try to brute force the shared secret, choosing a strong shared secret does not affect the runtime of our attack.</p>

<h3 id="using-multi-factor-authentication-mfa">Using Multi-Factor Authentication (MFA)</h3>

<p>Using MFA or 2FA is not a mitigation either. Our attack largely bypasses the user authentication mechanism, and forges the accept response from the server’s reject.  MFA may be supported through multiple mechanisms within the RADIUS protocol, including authentication protocols like PAP that are vulnerable by default to our attack.</p>

<h3 id="rejecting-proxy-states">Rejecting Proxy-States</h3>

<p>Our forged Access-Accept packets contain <code class="language-plaintext highlighter-rouge">Proxy-State</code> attributes that the client is not expecting. However, having the client discard packets with unexpected <code class="language-plaintext highlighter-rouge">Proxy-States</code> does not mitigate the vulnerability.  First, such a mitigation would only apply to a NAS; the <code class="language-plaintext highlighter-rouge">Proxy-State</code> attribute is actually used by RADIUS server proxies and thus difficult to remove without breaking functionality.</p>

<p>Even if NAS clients rejected unexpected <code class="language-plaintext highlighter-rouge">Proxy-State</code> attributes, it would be possible to craft colliding packets where the <code class="language-plaintext highlighter-rouge">Access-Accept</code> has the collision gibberish in a different attribute such as <code class="language-plaintext highlighter-rouge">Vendor-Specific</code> or <code class="language-plaintext highlighter-rouge">Reply-Message</code> that is likely to be accepted; the client does not need to support or attempt to interpret the garbage attribute to be vulnerable.</p>

<p>The colliding <code class="language-plaintext highlighter-rouge">Access-Reject</code> packet would still use <code class="language-plaintext highlighter-rouge">Proxy-State</code> attributes, as the server is guaranteed to include <code class="language-plaintext highlighter-rouge">Proxy-State</code> attributes unchanged in an <code class="language-plaintext highlighter-rouge">Access-Reject</code>.
For simplicity our implementation uses <code class="language-plaintext highlighter-rouge">Proxy-States</code> in both colliding packets, as no RADIUS client we tested complained about the unexpected <code class="language-plaintext highlighter-rouge">Proxy-State</code>.</p>

<h3 id="replacing-md5">Replacing MD5</h3>

<p>It is tempting to think that simply replacing MD5 in the <code class="language-plaintext highlighter-rouge">Response Authenticator</code> with a secure hash function like SHA-2 or SHA-3 might be a short-term mitigation against our attacks.  However, since the RADIUS protocol does not provide for any cryptographic agility, such a change would be incompatible with all existing implementations, and thus be equivalent to requiring a new protocol.  Given the other security and privacy concerns with the rest of RADIUS, it would be better at that point to redesign the entire protocol or transport.</p>

                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#eap-tls">
                            Is using RADIUS with EAP-TLS the same as RADIUS/TLS?  Is EAP-TLS vulnerable?
                        </h4>
                    </div>
                    <div id="eap-tls" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>EAP-TLS is not the same as RADIUS/TLS. EAP-TLS uses a TLS handshake to carry out certificate-based authentication, but does not use TLS to encrypt the RADIUS access request and response packets, which are still transmitted over UDP in the clear. This is different from RADIUS/TLS, which transmits all RADIUS packets inside of an encrypted TLS session.</p>

<p>In more detail, when EAP (Extensible Authentication Protocol) is used for authentication within RADIUS, the client NAS sends a RADIUS <code class="language-plaintext highlighter-rouge">Access-Request</code> packet to the RADIUS server that contains a RADIUS attribute called <code class="language-plaintext highlighter-rouge">EAP-Message</code>.  For RADIUS/UDP, this <code class="language-plaintext highlighter-rouge">Access-Request</code> is sent in the clear via UDP.  The authenticating peer and server then authenticate using the requested EAP method: for EAP-TLS, they use certificates to complete a TLS handshake.  After the end of the EAP authentication process, the server completes the RADIUS conversation by sending a RADIUS <code class="language-plaintext highlighter-rouge">Access-Accept</code> or <code class="language-plaintext highlighter-rouge">Access-Reject</code> packet; for RADIUS/UDP this packet is again sent in the clear over UDP.</p>

<p>Our attack targets RADIUS access requests and responses.  However, EAP-TLS does not appear to be practically exploitable by our attack because all packets containing <code class="language-plaintext highlighter-rouge">EAP-Message</code> attributes must contain a MD5-HMAC <code class="language-plaintext highlighter-rouge">Message-Authenticator</code> attribute that we cannot forge.  However, a theoretical protocol attack may still be possible against RADIUS even when clients make an EAP-TLS (or other EAP) authentication request.  The details and the impact of such an attack would be implementation-dependent and we have not found a practically exploitable implementation.</p>

<p>A more detailed explanation is in Section 5.6 of <a href="/pdf/radius.pdf">our paper</a>.</p>

                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#further-improvements">
                            How can your attack time be further reduced?
                        </h4>
                    </div>
                    <div id="further-improvements" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>We reduced the online running time for our MD5 chosen-prefix attack from hours down to minutes. However, this should be interpreted as a generous upper bound for the true cost of such collisions, because of the limits on our computational resources. Newer CPUs than the seven to ten year old machines we have access to would likely provide minutes of improvement, as would optimizing cache locality.</p>

<p>Access to more and faster GPUs for the chosen-prefix attack would reduce the time for the birthday stage and/or reduce the number of near-collision blocks, reducing time for the near-collision stage.</p>

<p>Reimplementing hashclash in hardware, for example on FPGAs (Field Programmable Gate Arrays) or ASICs (Application-Specific Integrated Circuits) would likely improve the running time by a factor of ten to a hundred.</p>

<p>It would be eminently feasible to run this attack on cloud resources.  Amazon EC2 lists the on-demand price of a <code class="language-plaintext highlighter-rouge">c7a.48xlarge</code> instance with 192 vCPUs at $9.85/hour, and the price of a <code class="language-plaintext highlighter-rouge">g6.48xlarge</code> instance with 192 vCPUs and 8 NVIDIA L4 GPUs at $13.35/hour.  It would cost around $50/hour to exceed our computing capacity, and in principle one could scale to many more machines.</p>

                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#scanning">
                            How many RADIUS deployments are vulnerable to this attack?
                        </h4>
                    </div>
                    <div id="scanning" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>Unfortunately, we are not able to use network scanning to provide a representative picture of RADIUS deployments.  Many RADIUS servers will be on internal networks.  Even for external-facing servers, RADIUS hosts are identified by IP address and servers only accept packets from allowed addresses.  The RADIUS RFC specifies that servers should drop requests for hosts that they have not been pre-configured to have a shared secret with.  Our scanning host  would not be whitelisted by properly configured servers, so an internet-wide scan would thus only turn up misconfigured servers. Additionally, since it is a UDP-based protocol with no handshake before a login request, we cannot do TCP SYN scanning and would need to scan using a well-formed UDP <code class="language-plaintext highlighter-rouge">Access-Request</code>, which would appear as an attack to network administrators.</p>

<p>This does not affect the adversary in our attack model, who intercepts traffic between a legitimate client and server.</p>

<p>However, since this vulnerability is in the protocol, nearly all RADIUS/UDP implementations are vulnerable to our attack <strong>when using non-EAP authentication methods</strong>.</p>

                        </div>
                    </div>
                </div>
                
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary text-left" data-toggle="collapse" data-target="#logo">
                            Do you have a logo for your attack?
                        </h4>
                    </div>
                    <div id="logo" class="panel-collapse collapse">
                        <div class="panel-body bg-darkxs">
                            <p>Of course! Various versions with transparent, white, and black background are available <a href="/img/Blast-RADIUS.zip">here</a>.</p>

                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </div> 
</section>

    <section id="contact" class="bg-darkxs">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 col-lg-offset-3">
                <h2 class="section-heading">Research Team</h2>
                <hr class="primary">
                <div class"col-lg-offset-3">
                 <p class="text-left">
                    This research was conducted by 
                    <ul>
                        <li>
                            <a href="https://www.bu.edu/cs/profiles/sharon-goldberg/">Sharon Goldberg</a> (Boston University and Cloudflare),
                        </li>
                        <li>
                            <a href="https://mirohaller.com">Miro Haller</a> (University of California, San Diego),
                        </li>
                        <li>
                            <a href="https://cseweb.ucsd.edu/~nadiah/">Nadia Heninger</a> (University of California, San Diego),
                        </li>
                        <li>
                            <!--<a href="">Mike Milano</a>-->Mike Milano (BastionZero),
                        </li>
                        <li>
                            <a href="https://www.microsoft.com/en-us/research/people/danshu/">Dan Shumow</a> (Microsoft Research),
                        </li>
                        <li>
                            <a href="https://marc-stevens.nl/research/">Marc Stevens</a> (Centrum Wiskunde & Informatica), and
                        </li>
                        <li>
                            <a href="https://cseweb.ucsd.edu/~asuhl/">Adam Suhl</a> (University of California, San Diego)
                        </li>
                    </ul>
                </p>
                <p>
                    You can email us at <a href="mailto:blast.radius.attack@gmail.com">blast.radius.attack@gmail.com</a>
                </p>
            </div>
        </div>
    </div>
</section>

    <!-- jQuery -->
<script src="js/jquery.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="js/bootstrap.min.js"></script>

<!-- Plugin JavaScript -->
<script src="js/jquery.easing.min.js"></script>
<script src="js/jquery.fittext.js"></script>
<script src="js/wow.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="js/creative.js"></script>

</body>

<footer>
    <div class="footer-content bg-med">
        <p>
            Last updated on Jul 26, 2024
        </p>
    </div>
</footer>


</html>
