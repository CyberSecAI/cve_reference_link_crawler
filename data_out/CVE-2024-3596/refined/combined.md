=== Content from www.openwall.com_c4ae00df_20250111_035524.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <047e2b26-5287-4c32-aac8-224292b1b284@oracle.com>
Date: Tue, 9 Jul 2024 13:03:28 -0700
From: Alan Coopersmith <alan.coopersmith@...cle.com>
To: oss-security@...ts.openwall.com
Subject: CVE-2024-3596: RADIUS/UDP vulnerable to improved MD5 collision attack

<https://kb.cert.org/vuls/id/456537> discloses the new Blast-RADIUS attack:

> Overview
> --------
> A vulnerability in the RADIUS protocol allows an attacker allows an
> attacker to forge an authentication response in cases where a
> Message-Authenticator attribute is not required or enforced. This
> vulnerability results from a cryptographically insecure integrity
> check when validating authentication responses from a RADIUS server.
>
> Description
> -----------
> RADIUS is a popular lightweight authentication protocol used for
> networking devices specified in IETF 2058 as early as 1997 (obsoleted
> by RFC 2138 and then RFC 2865. There have been several other IETF
> standards (RADIUS/TCP, RADIUS/TLS and RADIUS/DTLS) that cover and
> enhance various parts of the specification for the use of RADIUS in
> authentication. RADIUS is widely used to authenticate both users and
> devices and widely supported by networking devices, from basic network
> switches to more complex VPN solutions. Recently, RADIUS has also been
> adopted in much of the cloud services that provide tiered, role-based
> access-control to resources. As a client-server protocol, RADIUS uses
> a Request-Response model to verify authentication requests and further
> provide any role-based access using Groups. RADIUS can also be proxied
> to support multi-tenant roaming access services.
>
> A vulnerability in the verification of RADIUS Response from a RADIUS
> server has been disclosed by a team of researchers from UC San Diego
> and their partners. An attacker, with access to the network where the
> RADIUS protocol is being transmitted, can spoof a UDP-based RADIUS
> Response packet to modify any valid Response (Access-Accept,
> Access-Reject, or Access-Challenge) to any other response, with almost
> any content, completely under the attackers control. This allows the
> attacker to transform a Reject into an Accept without knowledge of the
> shared secret between the RADIUS client and server. The attack is
> possible due to a basic flaw in the RADIUS protocol specification that
> uses a MD5 hash to verify the response, along with the fact that part
> of the hashed text is predictable allowing for a chosen-prefix
> collision. The attack, demonstrated by UCSD team, takes advantage of
> the chosen-prefix collision of the MD5 message in a novel way. The
> widespread use of RADIUS and its adoption into the cloud allows for
> such attacks to pose a reasonable threat to the authentication
> verification process that relies on RADIUS.
>
> RADIUS servers that only perform Extensible Authentication Protocol
> (EAP), as specified in RFC 3579, are unaffected by this attack. The
> EAP authentication messages require the Message-Authenticator
> attribute, which will prevent these attacks from succeeding. The use
> of TLS (or DTLS) encryption can also prevent such attacks from
> succeeding. However, RADIUS over TCP itself can still be susceptible
> to this attack, with more advanced man-in-the-middle scenarios, to
> successfully attack the TCP connection.
>
> Finally as explained by Alan Dekok, developer of FreeRadius open
> source software -
>
>     The key to the attack is that in many cases, Access-Request
>     packets have no authentication or integrity checks. An attacker
>     can then perform a chosen prefix attack, which allows modifying
>     the Access-Request in order to replace a valid response with one
>     chosen by the attacker. Even though the response is authenticated
>     and integrity checked, the chosen prefix vulnerability allows the
>     attacker to modify the response packet, almost at will.
>
> Impact
> ------
> An attacker with access to the network where RADIUS Access-Request is
> transported can craft a response to the RADIUS server irrespective of
> the type of response (Access-Accept, Access-Reject, Access-Challenge,
> or Protocol-Error) to modify the response to any of the valid
> responses. This can allow an attacker to change the Reject response to
> an Accept or vice versa. The attack can also potentially intercept an
> Access-Challenge, typically used in Multi-Factor Authentication (MFA),
> and modify it to an Access-Accept, thus bypassing the MFA used within
> RADIUS. Due to the flexible, proxied nature of the RADIUS protocol,
> any server in the chain of proxied RADIUS servers can be targeted to
> succeed in the attack.
>
> Solution
> --------
> RADIUS-compliant software and hardware manufacturers should adopt the
> recommendations from the
> <https://networkradius.com/assets/pdf/radius_and_md5_collisions.pdf>
> document to mitigate the risk of the RADIUS protocol limitations
> identified in this attack. Manufacturers who bundle the open-source
> RADIUS implementations, such as FreeRadius, should update to the
> latest available software for both clients and servers and, at a
> minimum, require the use of the Message-Authenticator for RADIUS
> authentication.
>
> Network operators who rely on the RADIUS-based protocol for device
> and/or user authentication should update their software and
> configuration to a secure form of the protocol for both clients and
> servers. This can be done by enforcing TLS or DTLS encryption to
> secure the communications between the RADIUS client and server. Where
> possible, network isolation and secure VPN tunnel communications
> should be enforced for the RADIUS protocol to restrict access to these
> network resources from untrusted sources.

<https://blog.cloudflare.com/radius-udp-vulnerable-md5-attack/> provides
additional detail, including:

> The IETF is an important venue for standardizing network protocols
> like RADIUS. The IETF’s radext working group is currently considering
> an initiative to deprecate RADIUS/UDP and create a “standards track”
> specification of RADIUS over TLS or DTLS, that should help accelerate
> the deployment of RADIUS/TLS in the field. We hope that our work will
> accelerate the community’s ongoing efforts to secure RADIUS and reduce
> its reliance on MD5.

<https://www.blastradius.fail/> has further details from the researchers.

<https://www.freeradius.org/security/> provides a lengthy response from the
FreeRADIUS maintainers.

--
         -Alan Coopersmith-                 alan.coopersmith@...cle.com
          Oracle Solaris Engineering - <https://blogs.oracle.com/solaris>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security.netapp.com_42ae4bca_20250111_035528.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2024-3596 RADIUS Protocol Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20240822-0001)

## CVE-2024-3596 RADIUS Protocol Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20240822-0001 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20240822-0001 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20240822-0001 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20240822-0001 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20240822-0001
**Version:**
2.0

**Last updated:**
11/22/2024

**Status:**
Interim.

**CVEs:** CVE-2024-3596

Overview
#### Summary

The RADIUS protocol is susceptible to man-in-the-middle forgery attacks. This vulnerability is known as Blast-RADIUS.

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

Brocade Fabric Operating System Firmware:

Affected when configured to use RADIUS with PAP or CHAP.

Brocade SAN Navigator (SANnav):

Affected when configured to use RADIUS with PAP or CHAP.

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2024-3596](https://nvd.nist.gov/vuln/detail/CVE-2024-3596) | 9.0 (CRITICAL) | CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://www.blastradius.fail/>

Affected Products
#### Affected Products

* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)

#### Products Not Affected

* AFF BIOS - A1K/A70/A90
* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A1K/A70/A90
* AFF Baseboard Management Controller (BMC) - A700s
* AFF LOADER- A1K/A70/A90
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Cloud Volumes ONTAP Mediator
* Data Infrastructure Insights Acquisition Unit (formerly Cloud Insights Acquisition Unit)
* Data Infrastructure Insights Storage Workload Security Agent (formerly Cloud Insights Storage Workload Security Agent)
* Data Infrastructure Insights Telegraf Agent (formerly Cloud Insights Telegraf Agent)
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp DataOps Toolkit
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 10
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG5812/SG5860
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* StorageGRID Baseboard Management Controller (BMC) SG5812/SG5860
* System Manager 9.x
* Terraform Provider for ONTAP
* Workload Factory for VMware

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **Brocade Fabric Operating System Firmware** | Configure and use PEAP-MSCHAPv2 when using RADIUS 9. |

#### Workarounds

Use alternative protocols - LDAP for SAN Navigator (SANnav) or PEAP-MSCHAPv2 when using RADIUS in Fabric Operating System Firmware.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20240822-0001>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20240822 | Initial Public Release |
| 2.0 | 20241122 | Brocade Fabric Operating System Firmware added to Software Versions and Fixes |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from datatracker.ietf.org_ab02f5e3_20250111_035525.html ===


[Skip to main content](#content)
[![IETF Logo](https://static.ietf.org/dt/12.32.0/ietf/images/ietf-logo-nor-white.svg)
![IETF Logo](https://static.ietf.org/dt/12.32.0/ietf/images/ietf-logo-nor.svg)
Datatracker](/)

* Groups
  + By area/parent
  + [Apps & Realtime](/wg/#ART)
  + [General](/wg/#GEN)
  + [Internet](/wg/#INT)
  + [Ops & Management](/wg/#OPS)
  + [Routing](/wg/#RTG)
  + [Security](/wg/#SEC)
  + [Web and Internet Transport](/wg/#WIT)
  + [IAB](/program/)
  + [IRTF](/rg/)
  + [IETF LLC](/adm/)
  + [RFC Editor](/rfcedtyp/)
  + [Other](/group/)
    - [Active AGs](/ag/)
    - [Active Areas](/area/)
    - [Active Directorates](/dir/)
    - [Active IAB Workshops](/iabworkshop/)
    - [Active Programs](/program/)
    - [Active RAGs](/rag/)
    - [Active Teams](/team/)
  + ---
  + New work
  + [Chartering groups](/group/chartering/)
  + [BOFs](/wg/bofs/)
  + [BOF Requests](/doc/bof-requests)
  + ---
  + Other groups
  + [Concluded groups](/group/concluded/)
  + [Non-WG lists](/list/nonwg)
* Documents
  + [Search](/doc/search)
  + [Recent I-Ds](/doc/recent)
  + [I-D submission](/submit/)
  + [IESG dashboard](/doc/ad)
  + ---
  + RFC streams
  + [IAB](/stream/iab/)
  + [IRTF](/stream/irtf/)
  + [ISE](/stream/ise/)
  + [Editorial](/stream/editorial/)
  + ---
  + Subseries
  + [STD](/doc/std)
    [BCP](/doc/bcp)
    [FYI](/doc/fyi)
* Meetings
  + [Agenda](/meeting/agenda)
  + [Materials](/meeting/materials)
  + [Floor plan](/meeting/floor-plan)
  + [Registration](https://www.ietf.org/how/meetings/register/)
  + [Important dates](/meeting/important-dates/)
  + [Request a session](/secr/sreq/)
  + [Session requests](/meeting/requests)
  + ---
  + Upcoming meetings
  + [Upcoming meetings](/meeting/upcoming)
  + ---
  + Past meetings
  + [Past meetings](/meeting/past)
  + [Meeting proceedings](https://www.ietf.org/how/meetings/past/)
* Other
  + [IPR disclosures](/ipr/)
  + [Liaison statements](/liaison/)
  + [IESG agenda](/iesg/agenda/)
  + [NomComs](/nomcom/)
  + [Downref registry](/doc/downref)
  + [Statistics](/stats/)
    - [I-Ds/RFCs](/stats/document/)
    - [Meetings](/stats/meeting/)
  + [API Help](/api/)
  + [Release notes](/release/)
  + [System status](https://status.ietf.org)
  + ---
  + [Report a bug](https://github.com/ietf-tools/datatracker/issues/new/choose)
* User
  + [Sign in](/accounts/login/?next=/doc/draft-ietf-radext-deprecating-radius/)
  + [Password reset](/accounts/reset/)
  + [Preferences](/accounts/settings/)
  + [New account](/accounts/create/)

[Report a bug](https://github.com/ietf-tools/datatracker/issues/new/choose)
[Sign in](/accounts/login/?next=/doc/draft-ietf-radext-deprecating-radius/)

**Javascript disabled?** Like other modern websites, the IETF Datatracker relies on Javascript.
Please enable Javascript for full functionality.

# Deprecating Insecure Practices in RADIUS draft-ietf-radext-deprecating-radius-05

* [Status](/doc/draft-ietf-radext-deprecating-radius/)
* IESG evaluation record
* [IESG writeups](/doc/draft-ietf-radext-deprecating-radius/writeup/)
* [Email expansions](/doc/draft-ietf-radext-deprecating-radius/email/)
* [History](/doc/draft-ietf-radext-deprecating-radius/history/)

Versions:

* [00](/doc/draft-ietf-radext-deprecating-radius/00/)
* [01](/doc/draft-ietf-radext-deprecating-radius/01/)
* [02](/doc/draft-ietf-radext-deprecating-radius/02/)
* [03](/doc/draft-ietf-radext-deprecating-radius/03/)
* [04](/doc/draft-ietf-radext-deprecating-radius/04/)
* [05](/doc/draft-ietf-radext-deprecating-radius/05/)

| Document | Type |  | Active Internet-Draft ([radext WG](/wg/radext/about/)) |
| --- | --- | --- | --- |
|  | Author |  | [Alan DeKok](/person/aland%40freeradius.org "Datatracker profile of Alan DeKok") |
|  | Last updated |  | 2024-11-26 |
|  | Replaces |  | [draft-dekok-radext-deprecating-radius](/doc/draft-dekok-radext-deprecating-radius/ "Deprecating Insecure Practices in RADIUS") |
|  | RFC stream |  | Internet Engineering Task Force (IETF) |
|  | Intended RFC status |  | (None) |
|  | Formats |  | [txt](https://www.ietf.org/archive/id/draft-ietf-radext-deprecating-radius-05.txt) [html](https://www.ietf.org/archive/id/draft-ietf-radext-deprecating-radius-05.html) [xml](https://www.ietf.org/archive/id/draft-ietf-radext-deprecating-radius-05.xml) [htmlized](/doc/html/draft-ietf-radext-deprecating-radius-05) [bibtex](/doc/draft-ietf-radext-deprecating-radius/05/bibtex/) [bibxml](/doc/bibxml3/draft-ietf-radext-deprecating-radius-05.xml) |
|  | Additional resources |  | [Mailing list discussion](https://mailarchive.ietf.org/arch/browse/radext/?q=draft-ietf-radext-deprecating-radius) |
| Stream | [WG state](/doc/help/state/draft-stream-ietf/) |  | WG Document |
| --- | --- | --- | --- |
|  | Associated WG milestone |  | Jan 2024 Deprecating Insecure Uses of RADIUS to IESG |
|  | Document shepherd |  | (None) |
| IESG | [IESG state](/doc/help/state/draft-iesg/) |  | I-D Exists |
| --- | --- | --- | --- |
|  | Consensus boilerplate |  | Unknown |
|  | Telechat date |  | (None) |
|  | Responsible AD |  | (None) |
|  | Send notices to |  | (None) |

Email authors
Email WG
[IPR](/ipr/search/?submit=draft&id=draft-ietf-radext-deprecating-radius)
[References](/doc/draft-ietf-radext-deprecating-radius/references/)
[Referenced by](/doc/draft-ietf-radext-deprecating-radius/referencedby/)
[Nits](https://author-tools.ietf.org/api/idnits?url=https://www.ietf.org/archive/id/draft-ietf-radext-deprecating-radius-05.txt)
[Search email archive](https://mailarchive.ietf.org/arch/search/?q=%22draft-ietf-radext-deprecating-radius%22)

draft-ietf-radext-deprecating-radius-05

```
RADEXT Working Group                                            A. DeKok
Internet-Draft                                        InkBridge Networks
Updates: 2865, 2866, 5176, 7585 (if approved)           26 November 2024
Intended status: Standards Track
Expires: 30 May 2025

                Deprecating Insecure Practices in RADIUS
                draft-ietf-radext-deprecating-radius-05

Abstract

   RADIUS crypto-agility was first mandated as future work by RFC 6421.
   The outcome of that work was the publication of RADIUS over TLS (RFC
   6614) and RADIUS over DTLS (RFC 7360) as experimental documents.
   Those transport protocols have been in wide-spread use for many years
   in a wide range of networks.  They have proven their utility as
   replacements for the previous UDP (RFC 2865) and TCP (RFC 6613)
   transports.  With that knowledge, the continued use of insecure
   transports for RADIUS has serious and negative implications for
   privacy and security.

   The recent publication of the "BlastRADIUS" exploit has also shown
   that RADIUS security needs to be updated.  It is no longer acceptable
   for RADIUS to rely on MD5 for security.  It is no longer acceptable
   to send device or location information in clear text across the wider
   Internet.  This document therefore deprecates many insecure practices
   in RADIUS, and mandates support for secure TLS-based transport
   layers.  We also discuss related security issues with RADIUS, and
   give recommendations for practices which increase both security and
   privacy.

About This Document

   This note is to be removed before publishing as an RFC.

   Status information for this document may be found at
   https://datatracker.ietf.org/doc/draft-ietf-radext-deprecating-
   radius/.

   Discussion of this document takes place on the RADEXT Working Group
   mailing list (mailto:radext@ietf.org), which is archived at
   https://mailarchive.ietf.org/arch/browse/radext/.  Subscribe at
   https://www.ietf.org/mailman/listinfo/radext/.

   Source for this draft and an issue tracker can be found at
   https://github.com/freeradius/deprecating-radius.git.

DeKok                      Expires 30 May 2025                  [Page 1]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 30 May 2025.

Copyright Notice

   Copyright (c) 2024 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   4
     1.1.  RADIUS over the Internet  . . . . . . . . . . . . . . . .   6
     1.2.  Simply using IPsec or TLS is not enough . . . . . . . . .   8
     1.3.  Overview  . . . . . . . . . . . . . . . . . . . . . . . .   9
       1.3.1.  A Comment on Specifications . . . . . . . . . . . . .  10
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .  11
   3.  Overview of issues with RADIUS  . . . . . . . . . . . . . . .  12
     3.1.  The BlastRADIUS Vulnerability . . . . . . . . . . . . . .  12
     3.2.  Information is sent in Clear Text . . . . . . . . . . . .  13
     3.3.  MD5 has been broken . . . . . . . . . . . . . . . . . . .  15
     3.4.  Cracking RADIUS shared secrets is not hard  . . . . . . .  15
     3.5.  Tunnel-Password and CoA-Request packets . . . . . . . . .  17
     3.6.  TLS-based EAP methods, RADIUS/TLS, and IPsec  . . . . . .  18
     3.7.  Other Issues  . . . . . . . . . . . . . . . . . . . . . .  19
   4.  All short Shared Secrets have been compromised  . . . . . . .  20

DeKok                      Expires 30 May 2025                  [Page 2]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   5.  The BlastRADIUS Attack  . . . . . . . . . . . . . . . . . . .  20
     5.1.  Root Cause of the Attack  . . . . . . . . . . . . . . . .  23
     5.2.  Interaction with DTLS and TLS . . . . . . . . . . . . . .  24
     5.3.  Changes to RADIUS . . . . . . . . . . . . . . . . . . . .  25
       5.3.1.  New Configuration Flags . . . . . . . . . . . . . . .  26
       5.3.2.  Clients and Access-Request  . . . . . . . . . . . . .  27
       5.3.3.  Servers and Access-Request  . . . . . . . . . . . . .  28
       5.3.4.  Updated Servers and Legacy Clients  . . . . . . . . .  30
       5.3.5.  Further Explanation and Comments  . . . . . . . . . .  31
       5.3.6.  Server Responses to Access-Request  . . . . . . . . .  32
       5.3.7.  Clients Receiving Responses . . . . . . . . . . . . .  34
       5.3.8.  Status-Server . . . . . . . . . . . . . . . . . . . .  35
     5.4.  Related Issues  . . . . . . . . . . . . . . . . . . . . .  36
       5.4.1.  Documentation and Logging . . . . . . . . . . . . . .  36
       5.4.2.  Alternative Solutions . . . . . . . . . . . . . . . .  36
       5.4.3.  Non-Mitigations . . . . . . . . . . . . . . . . . . .  37
       5.4.4.  Network Operators . . . . . . . . . . . . . . . . . .  38
     5.5.  Limitations of the Mitigations  . . . . . . . . . . . . .  39
       5.5.1.  Vulnerable Systems  . . . . . . . . . . . . . . . . .  40
       5.5.2.  Unaffected Systems  . . . . . . . . . . . . . . . . .  40
       5.5.3.  The Weakest Link  . . . . . . . . . . . . . . . . . .  41
     5.6.  Note on Proxy-State . . . . . . . . . . . . . . . . . . .  42
     5.7.  Intrusion Detection Systems . . . . . . . . . . . . . . .  43
   6.  Deprecating Insecure Transports . . . . . . . . . . . . . . .  44
     6.1.  Deprecating RADIUS/UDP and RADIUS/TCP . . . . . . . . . .  44
     6.2.  Mandating Secure transports . . . . . . . . . . . . . . .  45
     6.3.  Crypto-Agility  . . . . . . . . . . . . . . . . . . . . .  45
   7.  Migration Path and Recommendations  . . . . . . . . . . . . .  47
     7.1.  Shared Secrets  . . . . . . . . . . . . . . . . . . . . .  47
     7.2.  Message-Authenticator . . . . . . . . . . . . . . . . . .  48
     7.3.  Recommending TLS-PSK  . . . . . . . . . . . . . . . . . .  49
     7.4.  Guidelines for Administrators . . . . . . . . . . . . . .  50
   8.  Increasing the Security of RADIUS . . . . . . . . . . . . . .  51
     8.1.  Minimizing Personal Identifiable Information  . . . . . .  52
       8.1.1.  Chargeable-User-Identity  . . . . . . . . . . . . . .  52
     8.2.  User-Password Visibility  . . . . . . . . . . . . . . . .  56
     8.3.  Delaying Access-Rejects . . . . . . . . . . . . . . . . .  57
     8.4.  Use Constant Time Comparisons . . . . . . . . . . . . . .  57
     8.5.  Minimize the use of Proxies . . . . . . . . . . . . . . .  58
       8.5.1.  There is no RADIUS Routing Protocol . . . . . . . . .  58
       8.5.2.  Dynamic Discovery and Filtering . . . . . . . . . . .  60
     8.6.  Do Not Use MS-CHAP  . . . . . . . . . . . . . . . . . . .  61
     8.7.  Password Visibility and Storage . . . . . . . . . . . . .  63
       8.7.1.  PAP Security Analysis . . . . . . . . . . . . . . . .  64
       8.7.2.  CHAP and MS-CHAP Password Storage . . . . . . . . . .  65
       8.7.3.  On-the-wire User-Password versus CHAP-Password  . . .  66
       8.7.4.  PAP vs CHAP Conclusions . . . . . . . . . . . . . . .  67
     8.8.  Use EAP Where Possible  . . . . . . . . . . . . . . . . .  68

DeKok                      Expires 30 May 2025                  [Page 3]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

     8.9.  Eliminating Proxies . . . . . . . . . . . . . . . . . . .  68
     8.10. Accounting Is Imperfect . . . . . . . . . . . . . . . . .  69
       8.10.1.  Incorrect Accounting Data  . . . . . . . . . . . . .  70
     8.11. Unknown Attributes  . . . . . . . . . . . . . . . . . . .  71
   9.  Practical Suggestions . . . . . . . . . . . . . . . . . . . .  72
   10. Privacy Considerations  . . . . . . . . . . . . . . . . . . .  74
   11. Security Considerations . . . . . . . . . . . . . . . . . . .  74
     11.1.  Historical Considerations  . . . . . . . . . . . . . . .  75
     11.2.  Practical Implications . . . . . . . . . . . . . . . . .  75
   12. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  75
   13. Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  75
   14. Changelog . . . . . . . . . . . . . . . . . . . . . . . . . .  76
   15. References  . . . . . . . . . . . . . . . . . . . . . . . . .  76
     15.1.  Normative References . . . . . . . . . . . . . . . . . .  76
     15.2.  Informative References . . . . . . . . . . . . . . . . .  77
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  83

1.  Introduction

   The RADIUS protocol [RFC2865] was first standardized in 1997, though
   its roots go back much earlier to 1993.  The protocol uses MD5
   [RFC1321] to authenticate some packets types, and to obfuscate
   certain attributes such as User-Password.  As originally designed,
   Access-Request packets were entirely unauthenticated, and could be
   trivially spoofed ([RFC2869], Section 7.1 and [RFC3579],
   Section 4.3.2).

   The insecurity of MD5 has been known for a long time.  It was first
   noted in relation to RADIUS in 1996 on the IETF RADIUS working group
   mailing list [MD5-1996], which also discussed using an HMAC construct
   to increase security.  While it was common knowledge at the time, the
   earliest record of concerns about Access-Request packets spoofing was
   on the RADIUS working group mailing list [DATTACK] in 1998.  There
   was substantial further discussions about the lack of integrity
   checks on the list over the next few years.  The outcome of that
   process was the definition of Message-Authenticator as an optional
   HMAC-based attribute in [RFC2869], Section 5.14.

   Unfortunately, the use of Message-Authenticator was made optional.
   This lack of integrity checks for Access-Request packets was deemed
   acceptable for some situations in [RFC2869], Section 7.1:

      Access-Request packets with a User-Password establish the identity
      of both the user and the NAS sending the Access-Request, because
      of the way the shared secret between NAS and RADIUS server is
      used.

DeKok                      Expires 30 May 2025                  [Page 4]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   That conclusion now appears to be incorrect.  The text continues with
   an acknowledgment that:

      Access-Request packets with CHAP-Password or EAP-Message do not
      have a User-Password attribute, so the Message-Authenticator
      attribute should be used in access-request packets that do not
      have a User- Password, in order to establish the identity of the
      NAS sending the request.

   This text was non-normative due to the lowercase 'should'.  It
   appears that no implementation followed even this limited suggestion.

   The packet forgery issue was further discussed in 2004 in [RFC3579],
   Section 4, and again in 2007 in [RFC5080], Section 2.2.2.  That
   document suggested that implementations require the use of Message-
   Authenticator in order to prevent forgery:

      However, Access-Request packets not containing a Message-
      Authenticator attribute ...  may be trivially forged.  To avoid
      this issue, server implementations may be configured to require
      the presence of a Message-Authenticator attribute in Access-
      Request packets.  Requests not containing a Message-Authenticator
      attribute MAY then be silently discarded.

   To our knowledge, only one RADIUS server implemented even this
   limited suggestion.  At the time of publication of [RFC5080], there
   was no consensus to require the use of Message-Authenticator in all
   Access-Request packets.  If this recommendation had instead been made
   mandatory, then the recent BlastRADIUS attack [BLAST] would largely
   have been prevented.

   The state of MD5 security was again discussed in [RFC6151], which
   states in Section 2:

      MD5 is no longer acceptable where collision resistance is required
      such as digital signatures.

   That statement led to RADIUS security being reviewed in [RFC6421],
   Section 3.  The outcome of that review was the text in the remainder
   of [RFC6421], which created crypto-agility requirements for RADIUS.
   The main outcome of those requirements was not any change to RADIUS,
   but instead the definition of RADIUS/TLS in [RFC6614], and RADIUS/
   DTLS in [RFC7360].  The other outcome was a consensus that adding
   crypto-agility to RADIUS was likely not a good idea, and that
   standardizing RADIUS over TLS instead was a significantly better path
   forward.

DeKok                      Expires 30 May 2025                  [Page 5]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   While the RADIUS/TLS work is ongoing at the time of this writing,
   there are still a large number of sites using RADIUS/UDP.  Those
   sites need to be supported and secured until they can migrate to TLS,
   while at the same time maintaining backwards compatibility.

   To summarize, [RFC6151] is over a decade old as of the time of this
   writing.  [RFC5080] is almost two decades old.  The knowledge that
   Access-Request packets lack integrity checks is almost three decades
   old.  Over that entire span of time, there has been no mandate to
   increase the security of Access-Request packets.  This document
   provides that mandate.

   It is no longer acceptable for RADIUS to rely on MD5 for security.
   It is no longer acceptable to send device or location information in
   clear text across the wider Internet.  This document therefore
   deprecates all insecure uses of RADIUS, and mandates the use of
   secure TLS-based transport layers.  We also discuss related security
   issues with RADIUS, and give many recommendations for practices which
   increase security and privacy.

1.1.  RADIUS over the Internet

   As the insecurity of MD5 has been well known for decades, RADIUS
   traffic over the Internet was historically secured with IPsec as
   described in [RFC3579], Section 4.2:

      To address the security vulnerabilities of RADIUS/EAP,
      implementations of this specification SHOULD support IPsec
      (RFC2401) along with IKE (RFC2409) for key management.  IPsec ESP
      (RFC2406) with non-null transform SHOULD be supported, and IPsec
      ESP with a non-null encryption transform and authentication
      support SHOULD be used to provide per-packet confidentiality,
      authentication, integrity and replay protection.  IKE SHOULD be
      used for key management.

   The use of IPsec allowed RADIUS to be sent privately, and securely,
   across the Internet.  However, experience showed that TLS was in many
   ways simpler for implementations and deployment than IPsec.  While
   IPsec required operating system support, TLS was an application-space
   library.  This difference, coupled with the wide-spread adoption of
   TLS for HTTPS, ensures that it was often easier for applications to
   use TLS than IPsec.

DeKok                      Expires 30 May 2025                  [Page 6]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   RADIUS/TLS [RFC6614] and RADIUS/DTLS [RFC7360] were then defined in
   order to meet the crypto-agility requirements of [RFC6421].  RADIUS/
   TLS has been in wide-spread use for about a decade, including eduroam
   [EDUROAM] [RFC7593], and more recently OpenRoaming [OPENROAMING] and
   [I-D.tomas-openroaming].  RADIUS/DTLS has seen less use across the
   public Internet, but it still has multiple implementations.

   However, RADIUS/UDP is still widely used, even though it depends on
   MD5 and "ad hoc" constructions for security.  The recent
   "BlastRADIUS" attack shows just how inadequate this dependency is.
   The BlastRADIUS attack is discussed in more detail below, in
   Section 5.

   Even if we ignore the BlastRADIUS attack, problems with MD5 mean that
   a hobbyist attacker who can view RADIUS/UDP traffic can brute-force
   test all possible RADIUS shared secrets of eight characters in not
   much more than an hour.  An more resourceful attacker (e.g. a nation-
   state) can check all much longer shared secrets with only modest
   expenditures.  See Section 3.4 below for a longer discussion of this
   topic.

   Determining the shared secret will also result in compromise of all
   passwords carried in the User-Password attribute.  Even using CHAP-
   Password offers minimal protection, as the cost of cracking the
   underlying password is similar to the cost of cracking the shared
   secret.  MS-CHAP ([RFC2433] and MS-CHAPv2 [RFC2759]) are
   significantly worse in security than PAP, as they can be completely
   broken with minimal resources, which Section 8.6 describes in more
   detail.

   The use of Message-Authenticator does not change the cost of
   attacking the shared secret.  The Message-Authenticator attribute is
   a later addition to RADIUS, and does does not replace the original
   MD5-based packet signatures.  While that attribute therefore offers a
   stronger protection, it does not change the cost of attacking the
   shared secret.  Moving to a stronger packet signatures (e.g.
   [RFC6218]) would still not fully address the issues with RADIUS, as
   the protocol still has privacy issues unrelated to the the security
   of packet authenticators.

   That is, most attributes in RADIUS are sent in clear-text, and only a
   few attributes such as User-Password and Tunnel-Password have their
   contents hidden.  Even the hidden attributes rely on "ad hoc"
   obfuscation methods using MD5, which have not been successfully
   attacked, but are not proven to be secure.  Peoples locations can
   (and has) been accurately determined, and people have been tracked
   using location data sent insecurely across the Internet
   (Section 3.2).

DeKok                      Expires 30 May 2025                  [Page 7]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   The implications for security and individual safety are large, and
   negative.

   These issues are only partly mitigated when the data carried within
   RADIUS use their own methods for increased security and privacy.  For
   example, some authentication methods such EAP-TLS, EAP-TTLS, etc.
   allow for User-Name privacy and for more secure transport of
   passwords via the use of TLS.  Some privacy can be gained through MAC
   address randomization, which can also limit device information
   identification to a particular manufacturer, instead of to a unique
   device.

   However, these methods are not always used, or are not always
   available.  Even if these methods were used ubiquitously, they do not
   protect all of the information which is publicly available over
   RADIUS/UDP or RADIUS/TCP transports.  And even when TLS-based EAP
   methods are used, implementations have historically often skipped
   certificate validation, leading to password compromise ([SPOOFING]).
   In many cases, users were not even aware that the server certificate
   was incorrect or spoofed, which meant that there was no way for the
   user to detect that anything was wrong.  Their passwords were simply
   handed to a spoofed server, with little possibility for the user to
   take any action to stop it.

1.2.  Simply using IPsec or TLS is not enough

   The use of a secure transport such as IPsec or TLS ensures complete
   privacy and security for all RADIUS traffic.  An observer of
   encrypted traffic is limited to knowing rough activity levels of a
   client or server.  That is, an observer can tell if there are a few
   users on a NAS, or many users on a NAS.  All other information is
   hidden from all observers.  Even with those limitations, it is not
   enough to say "use IPsec" and then move on to other issues.  There
   are many issues which can only be addressed via an informed approach.

   For example, it is possible for an attacker to record the session
   traffic, and later crack the TLS session key or IPsec parameters.
   This attack could comprise all traffic sent over that connection,
   including EAP session keys.  If the cryptographic methods provide
   forward secrecy ([RFC7525], Section 6.3), then breaking one session
   provides no information about other sessions.  As such, it is
   RECOMMENDED that all cryptographic methods used to secure RADIUS
   conversations provide forward secrecy.  While forward secrecy will
   not protect individual sessions from attack, it will prevent attack
   on one session from being leveraged to attack other, unrelated,
   sessions.

DeKok                      Expires 30 May 2025                  [Page 8]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   AAA servers SHOULD minimize the impact of such attacks by using a
   total throughput or time based limit before replacing the session
   keys.  The session keys can be replaced though a process of either
   re-keying the existing connection, or by opening a new connection and
   deprecating the use of the original connection.  Note that if the
   original connection if closed before a new connection is open, it can
   cause spurious errors in a proxy environment.

   The final attack possible in a AAA system is where one party in a AAA
   conversation is compromised or run by a malicious party.  This attack
   is made more likely by the extensive use of RADIUS proxy forwarding
   chains.  In that situation, every RADIUS proxy has full visibility
   into, and control over, the traffic it transports.  The solution here
   is to minimize the number of proxies involved, such as by using
   Dynamic Peer Discovery, as defined in [RFC7585].

   There are many security issues in addition to simply adding a secure
   transport.  The rest of this document addresses those issues in
   detail.

1.3.  Overview

   The rest of this document begins a summary of issues with RADIUS,
   including showing just how trivial it is to crack RADIUS/UDP
   security.  We then mandate the use of secure transport, and describe
   what that requirement means in practice.  We give recommendations on
   how current systems can be migrated to using TLS.  We give
   suggestions for increasing the security of existing RADIUS
   transports, including a discussion of the authentication protocols
   carried within RADIUS.  We conclude with security and privacy
   considerations.

   As IPsec has been discussed previously in the context of RADIUS, we
   do not discuss it more here, except to say it is an acceptable
   solution for securing RADIUS traffic.  As the bulk of the current
   efforts are focused on TLS, this document likewise focuses on TLS.
   We note that all of the issues raised here about the RADIUS protocol
   also apply to IPsec transport.  That is, when the application is not
   in charge of protocol security, the application is vulnerable to
   transport misconfigurations or attacks.

DeKok                      Expires 30 May 2025                  [Page 9]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

1.3.1.  A Comment on Specifications

   While this document tries to be comprehensive, it is necessarily
   imperfect.  There may be issues which should have been included here,
   but which were missed due to oversight or accident.  Any reader
   should be aware that there are good practices which are perhaps not
   documented in a specification, and bad behaviors which are likewise
   not forbidden.  For example, documents such as [RFC5080] were written
   to both correct errors in earlier documents, and to address harmful
   behaviors which had been seen in practice.

   These harmful behaviors can have a large impact both on security and
   on interoperability, even if they are not expressly forbidden in a
   specification.

   There is a regrettable belief that a particular practice is "allowed"
   by a specification, simply because the specification does not forbid
   that practice.  This belief is wrong.  That is, a behavior which is
   not even mentioned in the specification cannot honestly be said to be
   "permitted" or "allowed" by that specification.  The most charitable
   description would be that these behaviors are undefined, or at best,
   they are not forbidden.

   By their very nature, documents include a small number of permitted,
   required, and/or forbidden behaviors.  There are a much larger set of
   behaviors which are undefined.  That is, behaviors which are neither
   permitted nor forbidden.  Those behaviors may be good or bad,
   independent of what any specification says.

   Outside of published specifications, there is also a large set of
   common practices and behaviors which have grown organically over
   time, but which have not been written into a specification.  These
   practices have been found to be valuable by implementers and
   administrators.  Deviations from these practices generally result in
   instabilities and incompatibilities between systems.  As a result,
   implementers should exercise caution when creating new behaviors
   which have not previously been seen in the industry.  Such behaviors
   are likely to cause problems, where there would have been no problems
   if common practices had instead been followed.

   It is RECOMMENDED that implementations and administrators follow
   widely accepted practices which have been proven to work and to be
   secure, even if those practices are not written down in a public
   specification.  Implementers SHOULD NOT create features which depend
   on undefined behavior; such features are very likely to be wrong.

DeKok                      Expires 30 May 2025                 [Page 10]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

   *  RADIUS

      The Remote Authentication Dial-In User Service protocol, as
      defined in [RFC2865], [RFC2866], and [RFC5176] among others.

   *  RADIUS/UDP

      RADIUS over the User Datagram Protocol as define above.

   *  RADIUS/TCP

      RADIUS over the Transport Control Protocol [RFC6613]

   *  RADIUS/TLS

      RADIUS over the Transport Layer Security protocol [RFC6614]

   *  RADIUS/DTLS

      RADIUS over the Datagram Transport Layer Security protocol
      [RFC7360]

   *  TLS

      the Transport Layer Security protocol.  Generally when we refer to
      TLS in this document, we are referring to RADIUS/TLS and/or
      RADIUS/DTLS.

   *  NAS

      Network Access Server, which is a RADIUS client.

   In order to continue the terminology of [RFC2865], we describe the
   Request Authenticator, Response Authenticator, and Message-
   Authenticator as "signing" the packets.  This terminology is not
   consistent with modern cryptographic terms, but using other
   terminology could be misleading.  The reader is assured that no
   modern cryptographic methods are used with RADIUS/UDP.

DeKok                      Expires 30 May 2025                 [Page 11]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

3.  Overview of issues with RADIUS

   There are a large number of issues with RADIUS.  The most serious is
   the BlastRADIUS vulnerability, which means that subject to some
   limitations, attackers can leverage MD5 known-prefix collisions to
   cause any user to be authenticated, and then be given any
   authorization.  Multi-factor Authentication (MFA) systems can be
   bypassed, and the RADIUS server will in many cases not even be aware
   that an unauthorized user is on the network.

   Another issue is that RADIUS sends most information "in the clear",
   with obvious privacy implications.  Even if packets use Message-
   Authenticator for integrity checks, it is still possible for the
   average hobbyist who observes RADIUS traffic to perform brute-force
   attacks to crack even seemingly complex shared secrets.

   There is no way to fix the RADIUS protocol to address all of these
   issues.  The short-term fix is to require the use of Message-
   Authenticator for packet integrity checks.  The long-term solution is
   to wrap the protocol in a secure transport, such as TLS or IPsec.

   We address each of these issues in detail below.

3.1.  The BlastRADIUS Vulnerability

   The BlastRADIUS vulnerability is discussed in detail in [BLAST], and
   we only give a short summary here.  We refer the reader to the
   original paper for a more complete description of the issue.

   For the following description, we assume that we have texts "A", "B",
   "S".  Following the use in [RFC2865], "+" denotes concatenation.  The
   vulnerability then relies on the following property of MD5:

      If MD5(A) == MD5(B), then MD5(A + S) == MD5(B + S)

   If an attacker is given text "A", and can find text "B" which has the
   same MD5 hash, then the attacker can perform a chosen prefix attack.
   Even if the attacker does not know text "S", if given M5(A + S), then
   the attacker can trivially calculate MD5(B + S): it has the same
   value.

   In RADIUS, the Response Authenticator field [RFC2865], Section 3 is
   calculated via precisely this vulnerable construct:

      Response Authenticator = MD5(packet + secret)

DeKok                      Expires 30 May 2025                 [Page 12]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   The attacker can observe or predict a packet (e.g.  Access-Reject),
   which is signed with a shared secret unknown to the attacker.  The
   attacker can then find an Access-Accept with the same MD5 hash as the
   Access-Reject, and replace the Access-Reject with the Access-Accept
   using the Response Authenticator from the Access-Reject.

   The client receives the packet, calculates MD5(Access-Accept +
   secret), verifies that the Response Authenticator is correct, and
   proceeds to follow the attackers instructions: give the user access,
   along with some authorization.

   This process is the basic concept behind the BlastRADIUS
   vulnerability.  We note that this attack does not expose the contents
   of the User-Password attribute.  Instead, it bypasses all server-side
   authentication, and simply fools the client into accepting a forged
   response.

   While this issue requires that an attacker be "on path" and be able
   to intercept and modify packets, the meaning of "on path" is often
   "the entire Internet".  As such, this attack alone is sufficient
   reason to deprecate all uses of RADIUS/UDP and RADIUS/TCP.

3.2.  Information is sent in Clear Text

   With the exception of a few attributes such as User-Password, all
   RADIUS traffic is sent "in the clear" when using UDP or TCP
   transports.  Even when TLS is used, all RADIUS traffic (including
   User-Password) is visible to proxies.  The resulting data exposure
   has a large number of privacy issues.  We refer to [RFC6973], and
   specifically to Section 5 of that document for detailed discussion,
   and to [RFC6973], Section 6 for recommendations on threat
   mitigations.

   More discussion of location privacy is given in [RFC6280], which
   defines an "Architecture for Location and Location Privacy in
   Internet Applications".  However, that work was too late to have any
   practical impact on the design of the RADIUS protocol, as [RFC5580]
   had already been published.

DeKok                      Expires 30 May 2025                 [Page 13]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   The effect is that any observer of non-TLS RADIUS traffic is able to
   obtain a substantial amount of personal identifiable information
   (PII) about users.  The observer can tell who is logging in to the
   network, what devices they are using, where they are logging in from,
   and their approximate location (usually city).  With location-based
   attributes as defined in [RFC5580], a user's location may be
   determined to within 15 or so meters outdoors, and with "meter-level
   accuracy indoors" [WIFILOC].  An observer can also use RADIUS
   accounting packets to determine how long a user is online, and to
   track a summary of their total traffic (upload and download totals).

   When RADIUS/UDP is used across the public Internet, common Wi-Fi
   configurations allow the location of individuals to be tracked in
   real-time (usually 10 minute intervals), to within 15 meters.  The
   user devices can be identified, and also tracked.  Passwords can
   often be compromised by a resourceful attacker, or for MS-CHAP, by a
   hobbyist with a laptop.  Even when the packets do not contain any
   [RFC5580] location information for the user, the packets usually
   contain the MAC address of the Wi-Fi access point.  The MAC address
   and physical location of these devices are publicly available, and
   there are multiple services selling databases of this information.

   These issues are not theoretical.  Recently [BRIGGS] noted that:

      Overall, I think the above three examples are just the tip of the
      proverbial iceberg of SS7 and Diameter based location and
      monitoring exploits that have been used successfully against
      targeted people in the USA.

   [BRIGGS] continues with a statement that there have been:

      ... numerous other exploits based on SS7 and Diameter that go
      beyond location tracking.  Some of these involve issues like (1)
      the monitoring of voice and text messages, (2) the delivery of
      spyware to targeted devices, and (3) the influencing of U.S.
      voters by overseas countries using text messages.

   While these comments apply to Diameter [RFC6733], the same location
   tracking and monitoring is also possible with RADIUS.  There is every
   reason to believe that similar attacks on RADIUS have occurred, but
   are simply less publicized than similar attacks on Diameter.

   The use of clear-text protocols across insecure networks is no longer
   acceptable.  Using clear-text protocols in networks which are
   believed to be secure is not a significantly better solution.  The
   correct solution is to use secure protocols, to minimize the amount
   of private data which is being sent, and to minimize the number of
   third parties who can see any traffic.

DeKok                      Expires 30 May 2025                 [Page 14]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

3.3.  MD5 has been broken

   Attacks on MD5 are summarized in part in [RFC6151].  The BlastRADIUS
   work substantially improved the speed of finding MD5 collisions, and
   those improvements are publicly available at [HASHCLASH].

   While there have not been many other new attacks in the decade since
   [RFC6151] was published, that does not mean that further attacks do
   not exist.  It is more likely that no one is looking for new attacks.

3.4.  Cracking RADIUS shared secrets is not hard

   The cost of cracking a a shared secret can only go down over time as
   computation becomes cheaper.  The issue is made worse because of the
   way MD5 is used to authenticate RADIUS packets.  The attacker does
   not have to calculate the hash over the entire packet, as the hash
   prefix can be calculated once, and then cached.  The attacker can
   then begin the attack with that hash prefix, and brute-force only the
   shared secret portion.

   At the time of writing this document, an "off the shelf" commodity
   computer can calculate at least 100M MD5 hashes per second.  If we
   limit shared secrets to upper/lowercase letters, numbers, and a few
   "special" characters, we have 64 possible characters for shared
   secrets.  Which means that for 8-character secrets, there are 2^48
   possible combinations.

   The result is that using consumer-grade machine, it takes
   approximately 32 days to brute-force the entire 8 octet / 64
   character space for shared secrets.  The problem is even worse when
   graphical processing units (GPUs) are used.  A high-end GPU is
   capable of performing more than 64 billion hashes per second.  At
   that rate, the entire 8 character space described above can be
   searched in approximately 90 minutes.

   This is an attack which is feasible today for a hobbyist.  Increasing
   the size of the character set raises the cost of cracking, but not
   enough to be secure.  Increasing the character set to 93 characters
   means that the hobbyist using a GPU could search the entire 8
   character space in about a day.

   Increasing the length of the shared secret has a larger impact on the
   cost of cracking.  For secrets ten characters long, the search space
   is approximately 2^60.  One GPU can search a 64-character space in
   about six months.  A 93 character space (2^65 complexity) would take
   approximately 24 years.

DeKok                      Expires 30 May 2025                 [Page 15]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   This brute-force attack is also trivially parallelizable.  Nation-
   states have sufficient resources to deploy hundreds to thousands of
   systems dedicated to these attacks.  That realization means that a
   "time to crack" of 24 years is simply expensive, but does not take
   much "wall clock" time.  A thousand commodity CPUs are enough to
   reduce the crack time from 24 years to a little over a week.

   Whether the above numbers are precise or only approximate is
   immaterial.  These attacks will only get better over time.  The cost
   to crack shared secrets will only go down over time.

   If the shared secret is long, then "cracking" the secret is
   expensive.  It is cheaper to perform the BlastRADIUS attack at a cost
   of approximately 2^53 per packet, and less than $100 in purchased CPU
   time.  While cracking the shared secret would break all RADIUS
   packets using that secret, forging one packet is often enough to give
   the attacker administrator access to a NAS, where the shared secret
   is visible in the administration interface.  The conclusion, then, is
   that increasing the security of the shared secret offers minimal
   protection when the Access-Request packets are unsigned.

   Even if the shared secrets were enough to secure all RADIUS packets,
   administrators do not always derive shared secrets from secure
   sources of random numbers.  The "time to crack" numbers given above
   are the absolute best case, assuming administrators follow best
   practices for creating secure shared secrets.  For shared secrets
   created manually by a person, the search space is orders of magnitude
   smaller than the best case outlined above.  Rather than brute-forcing
   all possible shared secrets, an attacker can create a local
   dictionary which contains common or expected values for the shared
   secret.  Where the shared secret used by an administrator is in the
   dictionary, the cost of the attack can drop by multiple orders of
   magnitude.

   Implementers and administrators SHOULD assume that a hobbyist
   attacker with modest resource can crack most shared secrets created
   by people in minutes, if not seconds.

   Despite the ease of attacking MD5, it is still a common practice for
   some "cloud" and other RADIUS providers to send RADIUS/UDP packets
   over the Internet "in the clear".  It is also common practice for
   administrators to use "short" shared secrets, and to use shared
   secrets created by a person, or secrets derived from a limited
   character set.  Theses practice are easy to implement and follow, but
   they are highly insecure and MUST NOT be used.

   Further requirements in shared secrets are given below in
   Section 7.1.

DeKok                      Expires 30 May 2025                 [Page 16]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

3.5.  Tunnel-Password and CoA-Request packets

   There are a number of security problems with the use Tunnel-Password
   attribute in CoA-Request and Disconnect-Request packets.  A full
   explanation requires a review of the relevant specifications.

   [RFC5176] Section 2.3 describes how to calculate the Request
   Authenticator field for these packets:

   Request Authenticator

      In Request packets, the Authenticator value is a 16-octet MD5
      [RFC1321] checksum, called the Request Authenticator.  The
      Request Authenticator is calculated the same way as for an
      Accounting-Request, specified in [RFC2866].

   Where [RFC2866] Section 3 says:

      The NAS and RADIUS accounting server share a secret.  The Request
      Authenticator field in Accounting-Request packets contains a one-
      way MD5 hash calculated over a stream of octets consisting of the
      Code + Identifier + Length + 16 zero octets + request attributes +
      shared secret (where + indicates concatenation).  The 16 octet MD5
      hash value is stored in the Authenticator field of the
      Accounting-Request packet.

   Taken together, these definitions mean that for CoA-Request packets,
   all attribute obfuscation is calculated with the Reply Authenticator
   being all zeroes.  In contrast for Access-Request packets, the
   Request Authenticator is mandated to be 16 octets of random data.
   This difference reduces the security of the obfuscation.

   For Tunnel-Password, [RFC5176] Section 3.6 allows it to appear in
   CoA-Request packets:

     ...
     Change-of-Authorization Messages

     Request   ACK      NAK   #   Attribute
     ...
     0+        0        0    69   Tunnel-Password (Note 5)
     ...
     (Note 5) When included within a CoA-Request, these attributes
     represent an authorization change request.  Where tunnel attributes
     are included within a successful CoA-Request, all existing tunnel
     attributes are removed and replaced by the new attribute(s).

DeKok                      Expires 30 May 2025                 [Page 17]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   However, [RFC2868] Section 3.5 says that Tunnel-Password is encrypted
   with the Request Authenticator:

      Call the shared secret S, the pseudo-random 128-bit Request
      Authenticator (from the corresponding Access-Request packet) R,

   The assumption that the Request Authenticator is random data is true
   for Access-Request packets.  That assumption is not true for CoA-
   Request packets.

   That is, when the Tunnel-Password attribute is used in CoA-Request
   packets, the only source of randomness in the obfuscation is the
   salt, as defined in [RFC2868] Section 3.5;

    Salt
      The Salt field is two octets in length and is used to ensure the
      uniqueness of the encryption key used to encrypt each instance of
      the Tunnel-Password attribute occurring in a given Access-Accept
      packet.  The most significant bit (leftmost) of the Salt field
      MUST be set (1).  The contents of each Salt field in a given
      Access-Accept packet MUST be unique.

   This chain of unfortunate definitions means that there is only 15
   bits of entropy in the Tunnel-Password obfuscation (plus the secret).
   It is not known if this limitation makes it sufficiently easy for an
   attacker to determine the contents of the Tunnel-Password, as the
   obfuscated value still depends on the shared secret.  However, such
   limited entropy cannot be a good thing, and it is one more reason to
   deprecate RADIUS/UDP and RADIUS/TCP.

   Due to the above issues, implementations and new specifications
   SHOULD NOT use obfuscated attributes in CoA-Request or Disconnect-
   Request packets.

3.6.  TLS-based EAP methods, RADIUS/TLS, and IPsec

   The above analysis as to security and privacy issues focuses on
   RADIUS/UDP and RADIUS/TCP.  These issues are partly mitigated through
   the use secure transports, but it is still possible for information
   to "leak".

DeKok                      Expires 30 May 2025                 [Page 18]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   When TLS-based EAP methods such as TTLS or PEAP are used, they still
   transport passwords inside of the TLS tunnel.  It is possible for an
   authentication server to terminate the TLS tunnel, and then proxy the
   inner data over RADIUS/UDP.  The design of both TTLS and PEAP make
   this process fairly trivial.  The inner data for TTLS is in Diameter
   AVP format, which can be trivially transformed to RADIUS attributes.
   The inner data for PEAP is commonly EAP-MSCHAPv2, which can also be
   trivially transformed to bare EAP, or to MS-CHAPv2.

   Similar issues apply to RADIUS/TLS and IPsec.  A proxy receiving
   packets over IPsec terminates the secure tunnel, but then might
   forward the packets over an insecure transport protocol.  While this
   process could arguably be seen as a misconfiguration issue, it is
   never the less possible due to the design of the RADIUS protocol.
   The design of RADIUS security is that it is "hop by hop", and there
   is no way for one "hop" to know anything about, or to control, the
   security of another "hop".

   The only solution to either issue would be to create a new protocol
   which is secure by design.  Unfortunately that path is not possible,
   and we are left with the recommendations contained in this document.

3.7.  Other Issues

   There are many other issues with RADIUS which are unrelated to
   security or privacy.  As of the time of writing this document, those
   issues are being collated in [ISSUES].  The bulk of the problems
   noted in that Wiki are operational considerations, along with
   inconsistencies in the previous RADIUS specifications.

   As the focus of this document is security, it does not address
   problems with the RADIUS protocol in general.  For example, there are
   known problems with the RADIUS state machine.  There are common
   practices which are secure but which are operationally expensive.
   RADIUS accounting is known to be inaccurate and often inconsistent.

   Some of the issues noted in the above Wiki could potentially have
   security impact.  For example, if a RADIUS server is not implemented
   correctly, an attacker can perform a resource exhaustion attack on
   it, and effectively take it offline.  Proxies are subject to Denial
   of Service attacks even from trusted clients, because those clients
   originate packets at the request of untrusted and unknown users.
   Rate limiting for RADIUS requests is a poorly tested or documented
   process, and largely relies on mutual trust of administrators.

DeKok                      Expires 30 May 2025                 [Page 19]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   We hope that the above issues are addressed in a future document.
   This document focuses on security issues related to transport
   protocols and authentication protocols, which will have to be
   sufficient for now.

4.  All short Shared Secrets have been compromised

   Unless RADIUS packets are sent over a secure network (IPsec, TLS,
   etc.), administrators SHOULD assume that any shared secret of 8
   characters or less has been compromised as soon as it is used.
   Administrators SHOULD assume that any shared secret of 10 characters
   or less has been compromised by an attacker with significant
   resources.  Administrators SHOULD also assume that any private
   information (such as User-Password) which depends on such shared
   secrets has also been compromised.

   To be perfectly clear: if a User-Password, or CHAP-Password, or MS-
   CHAP password has been sent over the Internet via RADIUS/UDP or
   RADIUS/TCP in the last decade, you should assume that the underlying
   password has been compromised.

5.  The BlastRADIUS Attack

   This section gives some more detail on the attack, so that the reader
   can be informed as to why this document makes particular
   recommendations.

   An "on path" attacker can inject one or more Proxy-State attributes
   with special contents into an Access-Request packet.  The Proxy-State
   attribute itself will not trigger any overflow or “out of bounds”
   issue with the RADIUS client or server.  Instead, the contents of the
   attributes will allow the attacker to create an MD5 known-prefix
   collision when the server calculates the Response Authenticator.  In
   effect, the attacker uses the RADIUS server, and its knowledge of the
   shared secret, to unknowingly authenticate packets which it has not
   created.

   The behavior of the Proxy-State attribute is extremely useful to this
   attack.  The attribute is defined in [RFC2865], Section 5.33 as an
   opaque token which is sent by a RADIUS proxy, and is echoed back by
   RADIUS servers.  That is, the contents of the attribute are never
   examined or interpreted by the RADIUS server.  Even better, testing
   shows that all RADIUS clients will simply ignore any unexpected
   Proxy-State attributes which they receive.  Finally, implementations
   generally add Proxy-State to the end of response packets, which
   simplifies the attack.

DeKok                      Expires 30 May 2025                 [Page 20]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   This attribute is therefore ideally suited to an attackers purpose of
   injecting arbitrary data into packets, without that data affecting
   client or server behavior.  The reasons for this behavior are
   outlined below in Section 5.6.  While those reasons ended up being
   transient, the impact of those decisions has impacted RADIUS for
   decades.

   While it is possible to use other attributes to achieve the same
   effect, the use of Proxy-State is simple, and is sufficient to
   trigger the issue.  For example, it is theoretically possible to use
   the User-Name attribute for this attack, if it is echoed back in an
   Access-Accept, or even as part of the the contents of a Reply-Message
   in an Access-Accept.  There is no much benefit in further researching
   that attack, as the mitigations for attacks using Proxy-State will
   also protect clients and servers from a similar attacks which use
   other attributes.

   The injected data and resulting MD5 collision allows the attacker to
   modify the packet contents almost at will, and the client will still
   accept the modified packet as being authentic.  The attack allows
   nearly arbitrary attributes to be added to the response.  Those
   attributes are simply part of the MD5 collision calculation, and do
   not substantially impact the cost of that calculation.

   We reiterate that since the RADIUS server can be convinced to
   authenticate packets using a prefix chosen by the attacker, there is
   no need for the attacker to know the shared secret.  This attack
   succeeds no matter how secure the shared secret is, the only
   mitigation is to use Message-Authenticator or TLS.

   The attack is implemented via the following steps, which are numbered
   the same as in the original paper.

   1.  The attacker requests network access from the RADIUS client
       (NAS).  This action triggers the NAS to send an Access-Request
       packet to the RADIUS server.

   2.  The Access-Request is observed to obtain its contents, including
       the Request Authenticator field.  The attacker prevents this
       packet from reaching the server until the MD5 collision data has
       been calculated..  The NAS will retransmit the packet one or more
       times after a delay, giving the attacker time to calculate the
       chosen prefix.

DeKok                      Expires 30 May 2025                 [Page 21]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   3.  Some external resources are used to calculate an MD5 collision
       using the Request Authenticator, and the expected contents of an
       Access-Reject.  As Access-Reject packets are typically empty (or
       can be observed), the expected packet contents are known in their
       entirety.

   4.  Once an MD5 collision is found, the resulting data is placed into
       one or more Proxy-State attributes in the previously seen Access-
       Request.  The attacker then sends this modified Access-Request to
       the RADIUS server.

   5.  The RADIUS server responds with an Access-Reject, and includes
       the Proxy-State attributes from the modified Access-Request
       packets.  The packet contains the malicious Proxy-State(s), along
       with a Response Authenticator which depends on both those
       malicious attributes, and the shared secret.

   6.  The attacker discards the original Access-Reject, and uses the
       chosen prefix data in the Proxy-State(s) to create a different
       (i.e. modified) response, such as an Access-Accept.  Other
       authorization attributes such as VLAN assignment can also be add,
       modified, or deleted.  This modified packet is sent to the NAS.

   7.  The NAS receives the modified Access-Accept, verifies that the
       Response Authenticator is correct, and gives the user access,
       along with the attackers desired authorization.

   The result of this attack is a near-complete compromise of the RADIUS
   protocol.  The attacker can cause any user to be authenticated.  The
   attacker can give almost any authorization to any user.

   While the above description uses Access-Reject responses, we
   reiterate that the root cause of the vulnerability is in the Access-
   Request packets.  The attack will therefore succeed even if the
   server responds with Access-Accept, Access-Challenge, or Protocol-
   Error [RFC7930].  The vulnerability in Access-Challenge allows MFA to
   be bypassed, as the attacker simply replaces the Access-Challenge
   with an Access-Accept.

   In addition to forging an Access-Accept for a user who has no
   credentials, the attacker can control the traffic of known and
   authenticated users.  Many modern Broadband Network Gateways (BNG)s,
   Wireless LAN Controllers (WLCs), and Broadband Remote Access Servers
   (BRAS) support configuring a dynamic HTTP redirect using Vendor
   Specific Attributes (VSA)s.  These VSAs are not protected by the
   shared secret, and could be injected into an Access-Accept in order
   to redirect a users traffic.  The attacker could then set up a
   malicious website to launch Zero-Day/Zero-Click attacks, driving

DeKok                      Expires 30 May 2025                 [Page 22]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   subscribers to the website using an HTTP redirect.  This issue is
   compounded by the fact that many devices perform automatic HotSpot
   1.0 style walled garden discovery.  The act of simply connecting to
   their home WiFi connect could be enough to compromise a subscriber's
   equipment.

   The following subsections define mitigations which can be used to
   protect clients and servers from this attack when using RADIUS/UDP or
   RADIUS/TCP.  However, we reiterate here, and in the rest of this
   document that the only long-term solution is to deprecate insecure
   transports entirely.  In the long term, implementers SHOULD remove
   all uses of RADIUS/UDP and RADIUS/TCP from their products.
   Administrators SHOULD stop using RADIUS/UDP and RADIUS/TCP.

5.1.  Root Cause of the Attack

   Independent of any cryptographic vulnerability, there are a number of
   factors which led to this vulnerability being exploited.

   A major factor is the continued use of MD5 for security, instead of
   mandating the use of an HMAC with Message-Authenticator.  This change
   could have been made in [RFC2869] in the year 2000.  A reason for not
   mandating Message-Authenticator was the issue of backwards
   compatibility.  Unfortunately, issues which are not fixed only grow
   larger over time.  The issue of backwards compatibility is
   significantly worse now than it was in the year 2000.  History shows
   that a better approach is to fix issues immediately when they come
   up.

   Another factor is the principle of "be conservative in what you do,
   be liberal in what you accept from others", often known as Postel's
   law, after John Postel.  Looking at the Proxy-State attribute, it is
   intended for proxy to server signaling, and offers no other value for
   RADIUS clients.  A NAS does not send Proxy-State in an Access-
   Request, and should not receive Proxy-State in an Access-Accept.

   Reception of Proxy-State in an Access-Accept response is therefore a
   failure of signaling in the RADIUS protocol, and likely indicates a
   serious failure of configuration, implementation, or as seen in this
   case, an active attack.  If all clients had discarded responses which
   contained unexpected Proxy-State attributes, then this attack could
   have been prevented.

   With the benefit of experience, this specification errs on the side
   of security, while still allowing for backwards compatibility.  It is
   not acceptable to maintain insecure practices simply because a small
   number of implementations or organizations find it difficult to
   upgrade.  Insecure implementations or practices have a concrete cost

DeKok                      Expires 30 May 2025                 [Page 23]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   not only to the insecure organizations, but also to other
   organizations via secondary effects.  When insecure organizations
   demand that others follow insecure practices continue due to
   perceived local costs, they are effectively offloading their costs
   onto everyone else.  This practice both decreases security, and
   increases costs.

   The solution here is to fix the protocol, and to mandate that
   everyone change to secure practices.  Implementations and/or
   organizations which do not update their systems will either be
   insecure, or will be incompatible with secure practices.

5.2.  Interaction with DTLS and TLS

   The new behaviors described in this section apply only when UDP or
   TCP transport is used.  Implementations MUST NOT use the mitigations
   outlined in this section when DTLS or TLS transport is used, as those
   transport protocols are not vulnerable to the BlastRADIUS attack.

   However, clients and servers SHOULD include Message-Authenticator in
   Access-Request packets, and in responses to those Access-Requests,
   even then those packets are sent over TLS or DTLS transports.  While
   the attribute serves no security purpose, we recommend including
   Message-Authenticator because of the behavior of some
   implementations.  Some RADIUS proxies are known to automatically
   include Message-Authenticator in forwarded packets when the attribute
   is seen in the packet received from the client.

   That is, such an implementation may receive packets over TLS
   transport, and then forward (or return) them over insecure transports
   such as UDP.  If such an implementation receives a packet over TLS
   which contains Message-Authenticator, it will add the Message-
   Authenticator attribute to the packet which is sent over UDP.
   Including Message-Authenticator in packets sent over insecure
   transports is important for increasing RADIUS securiry.

   It is therefore useful for systems to always include Message-
   Authenticator in Access-Request packets, even when TLS is used.
   While this practice does not increase the security of a particular
   TLS connection, it will increase the security of the larger RADIUS
   system.

DeKok                      Expires 30 May 2025                 [Page 24]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   The long term solution to the BlastRADIUS attack is to stop using
   insecure transport protocols, and switch to secure ones such as TLS.
   We recognize that switching to TLS ransport may require a significant
   amount of effort.  There is a substantial amount of work to perform
   in updating implementations, performing interoperability tests,
   changing APIs, changing user interfaces, and updating documentation.
   This effort cannot realistically be done in a short time frame.

   There is therefore a need for a short-term action which can be
   implemented by RADIUS clients and servers which is both simple to do,
   and which is known to be safe.  The recommendations in this section
   are known to protect implementations from the attack; to be simple to
   implement; and also to allow easy upgrade without breaking existing
   deployments.

5.3.  Changes to RADIUS

   There are a number of changes required to both clients and servers in
   order for all possible attack vectors to be closed.  Implementing
   only some of these mitigations means that an attacker could bypass
   the partial mitigations, and therefore still perform the attack.

   This section outlines the mitigation methods which protect RADIUS/UDP
   and RADIUS/TCP systems from this attack, along with the motivation
   for those methods.

   We note that unless otherwise noted, the discussion here applies only
   to Access-Request packets, and to responses to Access-Request (i.e.
   Access-Accept, Access-Reject, Access-Challenge, and Protocol-Error
   packets).  All behavior involving other types of request and response
   packets MUST remain unchanged.

   The mitigation methods outlined here allow systems to both protect
   themselves from the attack, while not breaking existing networks.
   There is no global “flag day” required for these changes.  Systems
   which implement these recommendations are fully compatible with
   legacy RADIUS implementations, and can help protect those legacy
   implementations.  However, when these mitigations are not
   implemented, systems are still vulnerable to the attack.

   Note that in some network architectures, the attack can be mitigated
   simply by upgrading the RADIUS server, so that it sends Message-
   Authenticator as the first attribute in all responses to Access-
   Request packets.  However, the goal of this specification is to fix
   all architectures supported by RADIUS systems, rather than a limited
   subset.  We therefore mandate new behavior for all RADIUS clients and
   servers, while acknowledging that some organizations may choose to
   not deploy all of the new functionality.  For overall network

DeKok                      Expires 30 May 2025                 [Page 25]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   security and good practice, we still recommend that all RADIUS
   clients and servers be upgraded to use the new software which
   contains the mitigations, and also be configured with the highest
   level of security.

5.3.1.  New Configuration Flags

   We define new configuration flags for clients and servers.  The
   behavior and meaning of these flags will be discussed below.
   Introducing these flags before discussing their meaning makes the
   subsequent discussion simpler and easier to understand.

   The goal of these flags is to secure the RADIUS protocol without
   preventing client and server communication between legacy and
   uopgraded systems.  These flags instead allow a gradual migration
   process from legacy RADIUS, to fully secure RADIUS with all of the
   mitigations in place.

   We mandate the following new configuration flags for RADIUS
   implementations when using UDP or TCP transport.  These flags MUST be
   ignored when DTLS or TLS transport is used.

      Clients MUST have a per-server boolean configuration flag, which
      we call “require Message-Authenticator”.  The default value for
      this flag MUST be “false” in order to maintain compatibility with
      legacy servers.

      Servers MUST have a per-client boolean configuration flag, which
      we call “require Message-Authenticator”.  The default value for
      this flag MUST be “false” in order to maintain compatibility with
      legacy clients.

      Servers MUST have a per-client boolean configuration flag, which
      we call “limit Proxy-State”.  The default value for this flag MUST
      be “false” in order to maintain compatibility with legacy clients.

   It is RECOMMENDED that implementations support both a global setting,
   and per-client or per-server setting for the above flags.  For
   example, an implementation could support a global setting which is
   over-ridden by a more specific per-client or per-server setting.  The
   global setting could also be used if there was no more specific
   setting defined.

   The combination of global and more narrow configuration allows
   administrators to upgrade systems gradually, without requiring a
   "flag day" when everything changes on a global basis.

DeKok                      Expires 30 May 2025                 [Page 26]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

5.3.2.  Clients and Access-Request

   We mandate the following new behavior for RADIUS clients:

      Clients MUST add Message-Authenticator to all Access-Request
      packets.

   This behavior MUST NOT be configurable.  Disabling it would open the
   system up to attack, and would prevent the other mitigation methods
   from working.  The root cause of the attack is that Access-Request
   packets lack integrity checks, so the most important fix is to add
   integrity checks to those packets.

   The Message-Authenticator SHOULD be the first attribute in all
   Access-Request packets.  That is, it should be placed immediately
   after the packet header.  Implementations MAY place the Message-
   Authenticator elsewhere in an Access-Request packet.

   From a cryptographic point of view, the location of Message-
   Authenticator does not matter for Access-Request packets, it just
   needs to exist somewhere in the packet.  However, as discussed below
   for responses to Access-Request (Access-Accept, etc.), the location
   of Message-Authenticator does matter.  It is better to have
   consistent and clear messaging for addressing this attack, instead of
   having different recommendations for different kinds of packets.

   All RADIUS servers will validate the Message-Authenticator attribute
   correctly when that attribute is received in a packet.  We are not
   aware of any RADIUS servers which will reject or discard Access-
   Request packets if they unexpectedly contain a Message-Authenticator
   attribute.

   This behavior has been enabled in the FreeRADIUS server for over a
   decade, and there have been no reports of interoperability problems.
   It is therefore safe for all clients to immediately implement this
   requirement.

   However, many existing RADIUS clients do not send Message-
   Authenticator.  It also may be difficult to upgrade some client
   equipment, as the relevant vendor may have gone out of business, or
   may have marked equipment as “end of life” and thus unsupported.  It
   is therefore necessary to both work with such systems by not breaking
   existing RADIUS deployments, while at the same time protecting them
   as much as practically possible.

DeKok                      Expires 30 May 2025                 [Page 27]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

5.3.3.  Servers and Access-Request

   We mandate the following new behavior for RADIUS servers:

      When receiving an Access-Request, servers MUST consult the value
      of the "require Message-Authenticator" flag prior to accepting the
      packet for processing.  This flag MUST NOT be consulted for other
      types of request packets.

      If "require Message-Authenticator" flag is set to “false”, RADIUS
      servers MUST follow legacy behavior for validating and enforcing
      the existence of Message-Authenticator in Access-Request packets.
      For example, enforcing the requirement that all packets containing
      EAP-Message also contain a Message-Authenticator attributes, but
      otherwise accepting and validating the Message-Authenticator
      attribute if it is present, while taking no action if the
      attribute is missing.

      If "require Message-Authenticator" flag is set to "false", RADIUS
      servers MUST also check the value of the "limit Proxy-State" flag
      and either accept or discard the packet, based on the checks
      discussed in []{#limit-proxy-state}, below.

      If "require Message-Authenticator" flag is set to “true”, the
      server MUST examine the Access-Request packets for the existence
      of the Message-Authenticator attributes.  Access-Request packets
      which do not contain Message-Authenticator MUST be silently
      discarded.  The server MUST then validate the contents of the
      Message-Authenticator and discard packets which fail this
      validation ([RFC2869], Section 5.14).

      Servers MUST NOT discard a packet based on the location of the
      Message-Authenticator attribute.  We extend [RFC2865], Section 5
      to state that RADIUS clients and servers MUST NOT discard packets
      based on the order or location of any attribute.  If the Message-
      Authenticator passes validation, then the packet is authenticatic
      and it has not been modified.  he location of Message-
      Authenticator within the packet does not matter for authenticated
      packets.

   The default value for the "require Message-Authenticator" is “false”
   because many RADIUS clients do not send the Message-Authenticator
   attribute in all Access-Request packets.  Defaulting to a value of
   "true" would mean that the RADIUS server would be unable to accept
   packets from many legacy RADIUS clients, and existing networks would
   break.

DeKok                      Expires 30 May 2025                 [Page 28]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   We note that if this flag is “false”, the server can be vulnerable to
   the attack, even if the client has been updated to always send
   Message-Authenticator in all Access-Requests.  An attacker could
   simply strip the Message-Authenticator from the Access-Request, and
   proceed with the attack as if client had not been updated.  The
   server then does not see Message-Authenticator in the Access-Request,
   and accepts the modified packet for processing.

   When the "require Message-Authenticator" flag is set to "true", the
   server is protected from the BlastRADIUS attack.  Any packet which
   has been modified by the attacker to remove Message-Authenticator
   will be discarded by the server.  Any packet containing Message-
   Authenticator will be validated using the HMAC-MD5 construct, which
   is not vulnerable to this attack.

   While servers must validate the contents of Message-Authenticator, we
   reiterate that they MUST NOT check the location of that attribute.
   There is no different meaning in RADIUS if Message-Authenticator is
   the first, second, or last attribute in a packet.  Servers MUST
   accept a RADIUS packet as valid if it passes authentication checks,
   no matter where Message-Authenticator is located in the packet.

   Unfortunately, there is no way for clients and servers to negotiate
   protocol-layer features in RADIUS/UDP or RADIUS/TCP.  An
   implementation cannot determine if packets are discarded due to an
   attack, or if they are discarded due to a mismatched configuration
   between client and server.  Implementations SHOULD therefore log the
   fact that the packet was discarded (with rate limits) in order to
   inform the administrator that either an attack is underway, or that
   there is a configuration mismatch between client and server.

   As a special case for debugging purposes, instead of discarding the
   packet, servers MAY instead send a Protocol-Error or Access-Reject
   response packet.  This packet MUST contain a Message-Authenticator
   attribute as the first attribute in the packet, otherwise an attacker
   could turn this response into an Access-Accept.  The response MUST
   also contain an Error-Cause attribute with value 510 (Missing
   Message-Authenticator).  The server MUST not send this response by
   default, as it this could cause the server to respond to forged
   Access-Request packets.

   The purpose of this Protocol-Error packet is to allow administrators
   to signal misconfigurations between client and server.  It is
   intended to only be used temporarily when new client to server
   connections are being configured, and MUST be disabled permanently
   once the connection is verified to work.

DeKok                      Expires 30 May 2025                 [Page 29]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   This behavior SHOULD only be enabled when specifically configured by
   an administrator.  It MUST also be rate-limited, as there is no need
   to signal this error on every packet received by the server.  It
   SHOULD be automatically disabled when the server receives an Access-
   Request from a client which contains Message-Authenticator.
   Implementations MAY instead automate this process, by sending a few
   such responses when packets from a client are first seen, and then
   not sending responses thereafter.

   As RADIUS clients are upgraded over time, RADIUS server
   implementations SHOULD enable the “require Message-Authenticator”
   flag by default.

   We note that "Section 7.2 of [BLAST] has the following comment about
   the FreeRADIUS server, which has had this configuration option for
   clients since 2008:

      If support for these old clients is not required, enabling this
      option would make our attacks infeasible.

   The next question is how to protect systems when legacy clients do
   not send Message-Authenticator.

5.3.4.  Updated Servers and Legacy Clients

   We mandate the following new behavior for RADIUS servers:

      When receiving an Access-Request which passes the above checks the
      "require Message-Authenticator" flag is set to "false", servers
      MUST then consult the value of the "limit Proxy-State" flag for
      the client.

      If the "limit Proxy-State flag is set to "false", RADIUS servers
      MUST follow legacy behavior for validating and enforcing the
      existence of Message-Authenticator in Access-Request packets.  For
      example, enforcing the requirement that all packets containing
      EAP-Message also contain a Message-Authenticator attributes, but
      otherwise accepting and validating the Message-Authenticator
      attribute if it is present, while taking no action if the
      attribute is missing.  This behavior is the same as mandated by
      the previous section.

      If the "limit Proxy-State" flag is set to "true", RADIUS servers
      MUST require that all Access-Request packets which contain a
      Proxy-State attribute also contain a Message-Authenticator
      attribute.  Access-Request packets which contain Proxy-State but
      no Message-Authenticator MUST be silently discarded.

DeKok                      Expires 30 May 2025                 [Page 30]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

      If the packet does contain a Message-Authenticator. servers MUST
      validate its contents, and discard packets which fail this
      validation ([RFC2869], Section 5.14).

   This flag is motivated by the realization that most NASes (i.e. not
   proxies) will never send Proxy-State in an Access-Request packet.  If
   a server sees Proxy-State in a packet from a NAS, it is a strong
   signal that an attackert is attempting the BlastRADIUS attack.  The
   BlastRADIUS attack depends on the construction and behavior of Proxy-
   State, and the attack is essentially impossible without using Proxy-
   State in an Access-Request.

   It is therefore safe to add a configuration flag which checks for
   Proxy-State, because well-behaving NASes will never send it.  The
   only time the server will see a Proxy-State from a NAS is when the
   attack is taking place.

   The behavior of this flag is not to simply discard Access-Request
   packets which contain an "unexpected" Proxy-State.  Instead, the
   behavior is to require such packets to be authenticated.  If a packet
   is authenticated via the existence of Message-Authenticator with
   validated contents, then the existence (or not) of Proxy-State does
   not matter; the packet should be accepted and processed by the
   server.

   On the other hand, if the packet cannot be authenticated via the use
   of Message-Authenticator, then the existence of an unexpected Proxy-
   State is suspicious, and the packet should be discarded.

   As with the previous section, servers SHOULD log a message when
   packets are discarded due to this flag.  Servers MAY also send an
   error response, subject to the caveats and considerations described
   in the previous section for those responses.

5.3.5.  Further Explanation and Comments

   The "require Message-Authenticator" flag is needed in order to secure
   the RADIUS protocol.  Once all Access-Request packets are required to
   contain a valid Message-Authenticator, the BlastRADIUS attack is
   impossible.

   However, it may not be possible to upgrade all RADIUS clients.  Some
   products may no longer be supported, or some vendors have gone out of
   business.  Even if upgrades are available, the upgrade process may
   impact production networks, which has a cost.  There is therefore a
   need for RADIUS servers to protect themselves from to thte
   BlastRADIUS attack, while at the same time being compatible with
   legacy RADIUS client implementations.

DeKok                      Expires 30 May 2025                 [Page 31]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   Enabled the "limit Proxy-State" flag allows legacy (i.e. non-
   upgraded) clients to be used without substantially compromising on
   security.  While it is theoretically possible to perform the
   BlastRADIUS attack via attributes other than Proxy-State, no such
   exploits are known at this time.  Any such exploit would require that
   the server receive fields under the attackers control (e.g.  User-
   Name), and echo them back in a response.  Such attacks are only
   possible when the server is configured to echo back attacker-
   controlled data, which is not the default behavior for most servers.

   As a result, these two flags allow the maximum amount of security
   while having the minimum distruption to operational networks.  For
   the remaining attack vectors, is is RECOMMENDED that servers which
   echo back user-supplied data in responses do so only when the
   "require Message-Authenticator" flag is set to "true".  If such user-
   supplied data is echoed back in responses when the "require Message-
   Authenticator" flag is set "false", then the BlastRADIUS attack is
   theoretically still possible, even though no exploit is currently
   available.

   The two configuration flags on the server will protect the server
   even if clients have not been upgraded or been configured to be
   secure.  The server configuration flags will not protect clients
   (NASes or proxies) from servers which have not been upgraded or been
   configured to be secure.  More behavior changes to servers and
   clients are required.

5.3.6.  Server Responses to Access-Request

   We mandate the following behavior for servers when sending responses
   to Access-Request packets:

      Servers MUST add Message-Authenticator as the first attribute in
      all responses to Access-Request packets.  That is, all Access-
      Accept, Access-Reject, Access-Challenge, and Protocol-Error
      packets.  The attribute MUST be the first one in the packet,
      immediately after the 20 octet packet header.

   Adding Message-Authenticator as the first attribute means that for
   the purposes of MD5 known prefix attacks, the unknown suffix begins
   with the Message-Authenticator, and continues for the remainder of
   the packet.  The attacker is therefore unable to leverage the attack
   using a known prefix, and the vulnerability is mitigated.

   The client will validate the Response Authenticator ([RFC2865],
   Section 3) before accepting response, and the attacker is unable to
   modify the response due to the location of the Message-Authenticator.
   This behavior therefore protects one client to server hop, even if

DeKok                      Expires 30 May 2025                 [Page 32]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   the server does not require Message-Authenticator in Access-Request
   packets, and even if the client does not examine or validate the
   contents of the Message-Authenticator.

   When the Message-Authenticator is the last attribute in a packet (as
   was historically common in many implementations), the attacker can
   treat the Message-Authenticator as an unknown suffix, as with the
   shared secret.  The attacker can then calculate the prefix as before,
   and have the RADIUS server authenticate the packet which contains the
   prefix.

   The analysis is similar if the Message-Authenticator is in the middle
   of the packet, with attributes existing both before an after the
   Message-Authenticator.  Attributes before the Message-Authenticator
   can be modified, discarded, or added, while attributes after the
   Message-Authenticator need to remain in the packet.  We direct the
   reader to Section 7.2 of [BLAST] for a more complete description of
   these issues.

   As a result, adding a Message-Authenticator anywhere other than as
   the first one will only mitigate the attack if the client implements
   the "require Message-Authenticator" flag, and has set that flag to
   "true".  Since there is no feature negotiation in RADIUS, the server
   has no way of knowing the clients configuration, and therefore needs
   to behave as if the client has the most insecure configuration.

   The location of the Message-Authenticator attribute is therefore
   critical to protect legacy clients which do not check for its
   existence or validate its contents.  Many legacy clients do not send
   Message-Authenticator in Access-Request packets, and therefore are
   highly likely to not validate it in responses to those Access-
   Requests.  Upgrading all of these clients may be difficult, or in
   some cases impossible.  It is therefore important to have mitigation
   factors which protect those systems.

   We note that Message-Authenticator has been defined for almost
   twenty-five (25) years, since [RFC2869].  All standards-compliant
   clients will validate Message-Authenticator; or if they do not
   validate it, should ignore it.  Since the publication of the original
   BlastRADIUS notification, it has become clear that some
   implementations do not behave as expected.  That is, they discard
   packets which contain an unexpected Message-Authenticator attribute,
   even though that behavior is entirely unreasonable, and is not
   required by any existing standard.

DeKok                      Expires 30 May 2025                 [Page 33]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   There is very little to be done for such systems.  The behavior
   mandated by this specification causes problems for such systems.  The
   only way for RADIUS servers to be compatible with those systems is to
   never send Message-Authenticator in responses.  However, doing so
   would open up significanly more systems to the BlastRADIUS attack.

   In the end, the only safe solution is to declare that systems which
   discard packets containing Message-Authenticator are not compliant
   with the RADIUS specifications.  We do not decrease the security of
   the RADIUS protocol in order to allow the continued existence of
   insecure and non-compliant implementations.  In order to prevent such
   issues from happening in the future, we now define mandated behavior
   for unknown attributes in Section 8.11, below.  In short, there is no
   reason for implementations to discard response packets, simply
   because they do not recognize an attribute contained therein.

   As it is difficult to upgrade both clients and servers
   simultaneously, we also need a method to protect clients when the
   server has not been updated.  That is, clients cannot depend on the
   Message-Authenticator existing in response packets.  Clients need to
   take additional steps to protect themselves, independent of any
   server updates.

5.3.7.  Clients Receiving Responses

   We mandate the following new behavior for RADIUS clients:

      When receiving any response to an Access-Request packet (Access-
      Accept, Access-Challenge, Access-Reject, or Protocol-Error),
      clients MUST consult the value of the "require Message
      authenticator" flag prior to accepting the packet for processing.
      This flag MUST NOT be consulted for responses to other types of
      request packets.

      If "require Message-Authenticator" flag is set to “false”, RADIUS
      clients MUST follow legacy behavior for validating and enforcing
      the existence of Message-Authenticator in response packets.  For
      example, enforcing the requirement that all packets containing
      EAP-Message also contain a Message-Authenticator attributes, but
      otherwise accepting and validating the Message-Authenticator
      attribute if it is present, while taking no action if the
      attribute is missing.

DeKok                      Expires 30 May 2025                 [Page 34]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

      If "require Message-Authenticator" flag is set to “true”, the
      client MUST examine the response packets for the existence of the
      Message-Authenticator attributes.  Response packets which do not
      contain Message-Authenticator MUST be silently discarded.  This
      check MUST be done before the Response Authenticator or Message-
      Authenticator has been verified.  No further processing of
      discarded packets should take place.

      The client MUST validate the contents of the Message-Authenticator
      and discard packets which fail this validation ([RFC2869],
      Section 5.14).

      Clients MUST NOT discard a packet based on the location of the
      Message-Authenticator attribute.  We extend [RFC2865], Section 5
      to state that RADIUS clients and servers MUST NOT discard packets
      based on the order or location of any attribute.  If the Message-
      Authenticator passes validation, then the packet is authenticatic
      and it has not been modified.  he location of Message-
      Authenticator within the packet does not matter for authenticated
      packets.

   When the response is discarded, the client MUST behave as if no
   response was received.  That is, any existing retransmission timers
   MUST NOT be modified as a result of receiving a packet which is
   silently discarded.

   Unfortunately, the client cannot determine if a packet was discarded
   due to an active attack, or if it was discarded due to a mismatched
   configuration between client and server (e.g. mis-matched shared
   secret).  The client SHOULD log the fact that the packet was
   discarded (with rate limits) in order to inform the administrator
   that either an attack is underway, or that there is a configuration
   mismatch between client and server.

   The above sections have now followed a complete path from client, to
   server, and back again.  If each client to server hop is secured via
   the above methods, then by construction, the RADIUS protocol is no
   longer vulnerable to the BlastRADIUS attack.

5.3.8.  Status-Server

   While the attack works only for Access-Request packets, Access-Accept
   or Access-Reject can also be sent in response to Status-Server
   packets ([RFC5997]).  In order to simplify client implementations, we
   mandate the following new behaviuor with respect to Status-Server:

DeKok                      Expires 30 May 2025                 [Page 35]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

      Servers MUST follow the above recommendations relating to Message-
      Authenticator when sending Access-Accept or Access-Reject packets,
      even if the original request was Status-Server.

   This requirement ensures that clients can examine responses
   independent of any requests.  That is, a client can perform a simple
   verification pass of response packets prior to doing any more complex
   correlation of responses to request.

   We note that [RFC5997], Section 3 states:

      .. all Status-Server packets MUST include a Message-Authenticator
      attribute.  Failure to do so would mean that the packets could be
      trivially spoofed.

   As a result, compliant implementations of [RFC5997] do not need to
   change their behavior with respect to sending or receiving Status-
   Server packets: they are already protected against the BlastRADIUS
   attack.

5.4.  Related Issues

   This section contains discussions of issues related to the
   BlastRADIUS vulnerability which do not involve changes to the RADIUS
   protocol.  It also explains why some solutions which may seem
   appealing are instead inadequate or inappropriate.

5.4.1.  Documentation and Logging

   It is RECOMMENDED that RADIUS server implementations document the
   behavior of these flags in detail, including how they help protect
   against this attack.  We believe that an informed administrator is
   more likely to engage in secure practices.

   Similarly, when either of the above flags cause a packet to be
   discarded, the RADIUS server SHOULD log a descriptive message
   (subject to rate limiting) about the problematic packet.  This log is
   extremely valuable to administrators who wish to determine if
   anything is going wrong, and what to do about it.

5.4.2.  Alternative Solutions

   An alternative configuration flag with a similar effect to the “limit
   Proxy-State” flag could be one called “this client is a NAS, and will
   never send Proxy-State”.  The intention for such a flag would be to
   clearly separate RADIUS proxies (which always send Proxy-State), from
   NASes (which will never send Proxy-State).  When the flag is set for
   a client, the server could then discard Access-Request packets which

DeKok                      Expires 30 May 2025                 [Page 36]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   contain Proxy-State.  Alternatively, the server could also discard
   Proxy-State from all responses sent to that client.

   Such a flag, however, depends on network topology, and fails to
   correct the underlying lack of packet authenticity and integrity.
   The flag may also work for one NAS, but it is likely to be incorrect
   if the NAS is replaced by a proxy.  Where there are multiple
   different pieces of NAS equipment behind a NAT gateway, the flag is
   also likely to be correct for some packets, and incorrect for others.

   Setting configuration flags by the desired outcome is preferable to
   setting flags which attempt to control network topology.

5.4.3.  Non-Mitigations

   It may be tempting to come up with other "ad hoc" solutions to this
   vulnerability.  Such solutions are NOT RECOMMENDED, as they are
   likely to either break existing RADIUS deployments, or else they will
   not prevent the attack.  The mitigations described in this document
   not only prevent the attack, they do so without affecting normal
   RADIUS operation.  There is therefore no reason to use any other
   methods.

   Other attempted mitigation factors are discussed in the "BlastRADIUS"
   document.  For example, "BlastRADIUS" Section 7.4 explains why
   decreasing timeouts simply increases the cost of the attack without
   preventing it.  Decreasing timeouts also can negatively affect normal
   traffic.

   [BLAST] Section 7.7 explains why validating Proxy-State, or looking
   for unexpected Proxy-State does not protect from the attack.  The
   attacker can likely just change the nature of the attack, and bypass
   those checks.

   There is no reason to implement “ad hoc” solutions when a solution
   exists which has passed reviews by both the BlastRADIUS
   cryptographers, and by the RADIUS working group.  There is every
   reason to believe that cryptographic operations designed by experts
   and subject to rigorous peer review are better than random guesses
   made by programmers lacking relevant cryptographic and RADIUS
   experience.

DeKok                      Expires 30 May 2025                 [Page 37]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   Similarly, switching away from RADIUS to another protocol will not
   protect from the attack, as there is no other protocol which can
   replace RADIUS.  No other protocol is supported by medium to low-end
   networking devices for end-user authentication, authorization, and
   accounting.  Outside of situations where Diameter is used, the choice
   for nearly every use-case which controls network access is limited to
   one protocol: RADIUS.

   Despite this reality, some "security" sites have recommended
   "securing" the network by switching to "alternative" protocols.  Such
   recommendations are incorrect and inappropriate.

   Diameter [RFC6733] is the closest protocol in functionality to
   RADIUS, but the Diameter use-case is applicable to large-scale
   telecommunications and internet service providers (ISPs).  Support
   for Diameter is not available in equipment available to consumers or
   enterprises.  As such, replacing RADIUS with Diameter is not an
   option.

   Other proposals for protocols to replace RADIUS are even less
   effective.  TACACS+ [RFC8907] has some overlap with RADIUS for
   administrator login to network devices, but it cannot be used outside
   of that limited scope.  TACACS+ does not support 802.1X, end-user
   authentication, or end-user accounting.  It is therefore impossible
   for an ISP or enterprise to replace RADIUS with TACACS+.

   Kerberos [RFC4120] is also not a option.  It is most generally used
   to authenticate applications, when the underlying system already has
   network access.  Kerberos also does not support 802.1X, and does not
   support accounting.

   The situation is much the same with any proposal to replace RADIUS
   with IPsec.  While IPsec does authenticates devices prior to bringing
   up the VPN, those devices must already have network access.  IPsec
   also requires that the end-user traffic be transported over the IPsec
   connection, where RADIUS does not transport any end-user traffic.

   In conclusion, recommendations to use alternate protocols are, at
   best, misguided.  We do not recommend following "security" advice
   which is based on a fundamental misunderstanding of networking
   protocols.

5.4.4.  Network Operators

   The most important outcome of this attack for network operators is
   that where possible, all RADIUS traffic should use TLS transport
   between client and server.

DeKok                      Expires 30 May 2025                 [Page 38]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   Methods other than IPsec to mitigate the attack are less secure, they
   still fail at adding privacy, and are therefore less useful.  We
   recognize that not all networking equipment supports TLS transport,
   so we therefore give additional recommendations here which operators
   can follow to help mitigate the attack.

   All networking equipment should be physically secure.  There is no
   reason to have critical portions of networking infrastructure
   physically accessibly to the public.  Where networking equipment must
   be in public areas (e.g. access points), that equipment SHOULD NOT
   have any security role in the network.  Instead, any network security
   validation or enforcement SHOULD be done by separate equipment which
   is in a physically secure location.

   It is RECOMMENDED that all RADIUS traffic be sent over a management
   VLAN.  This recommendation should be followed even if TLS transport
   is used.  There is no reason to mix user traffic and management
   traffic on the same network.

   Using a management network for RADIUS traffic will generally prevent
   anyone other than trusted administrators from performing this attack.
   We say “generally”, because security is limited by the least secure
   part of the network.  If a network device has some unrelated
   vulnerability, then an attacker could exploit that vulnerability to
   gain access to the management network.  The attacker would then be
   free to exploit this issue.

   Only the use of TLS will prevent such attacks from being chained
   together.

   Similarly, there are few reasons to use RADIUS/TCP.  Any system which
   supports RADIUS/TCP likely also supports TLS, and that should be used
   instead.

   Finally, any RADIUS/UDP or RADIUS/TCP traffic MUST NOT be sent over
   public networks such the Internet.  This issue is discussed in more
   detail later in this document.

5.5.  Limitations of the Mitigations

   The above mitigations have some limitations.  The design of the
   mitigations had to allow for backwards compatibility with legacy
   RADIUS systems, while still allowing for (but not requiring) whole-
   sale network upgrades.  There is a trade-off to be made between
   perfectly secure networks which are unusable, and networks which are
   usable but somewhat insecure.  The mitigations outlined here create
   as much security as possible, while still not breaking existing
   networks.

DeKok                      Expires 30 May 2025                 [Page 39]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   The result is that there are situations where a network is
   functional, but insecure.  This section outlines those limitations.

5.5.1.  Vulnerable Systems

   A RADIUS server is vulnerable to the attack if it does not require
   that all received Access-Request packets contain a Message-
   Authenticator attribute.  This vulnerability exists for many common
   uses of Access-Request, including packets containing PAP, CHAP, MS-
   CHAP, or packets containing “Service-Type = Authorize-Only”.  The
   vulnerability is also transitive.  If any one RADIUS server in a
   proxy chain is vulnerable, then the attack can succeed, and the
   attacker can gain unauthenticated and/or unauthorized access.

   Simply having the Message-Authenticator attribute present in Access-
   Request packets is not sufficient.  In order to be protected, a
   server must require that the attribute is present, and discard
   packets where it is missing.  Similarly, the client must also require
   that the attribute is present, and discard packets where it is
   missing.

   The attack is fully mitigated only when both sides of the RADIUS
   conversation are updated and configured correctly.

5.5.2.  Unaffected Systems

   There are a number of systems which are not vulnerable to this
   attack.  The most important ones are systems which only perform EAP
   authentication, such as with 802.1X / WPA Enterprise.  The EAP over
   RADIUS protocol is defined in [RFC3579], Section 3.3 which states
   explicitly:

      If any packet type contains an EAP-Message attribute it MUST also
      contain a Message-Authenticator.

   This requirement reiterates that of [RFC2869], Section 5.13, which
   defines EAP-Message and Message-Authenticator, but which does not get
   into details about EAP.

   This requirement is enforced by all known RADIUS servers.  As a
   result, when roaming federations such as eduroam use RADIUS/UDP, it
   is not possible for the attack to succeed.

   Other roaming groups such as OpenRoaming require the use of TLS, and
   are not vulnerable.  Other roaming providers generally use VPNs to
   connect disparate systems, and are also not vulnerable.

DeKok                      Expires 30 May 2025                 [Page 40]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   802.1X / WPA enterprise systems have an additional layer of
   protection, due to the use of the master session keys (MSK) which are
   derived from the EAP authentication method.  These keys are normally
   carried in an Access-Accept, in the MS-MPPE-Recv-Key and MS-MPPE-
   Send-Key attributes, and are used to secure the link between the NAS
   and the supplicant.  The contents of the attributes are obfuscated
   via the same method used for Tunnel-Password, and are not visible to
   an "on-path" attacker.

   While an attacker can perhaps force an Access-Accept in some
   situations, or strip the Message-Authenticator from packets, it is
   not currently possible for an attacker to see, modify, or create the
   correct MSK for the EAP session.  As a result, when 802.1X / WPA
   enterprise is used, even a successful attack on the Access-Accept
   packet would likely not result in the attacker obtaining network
   access.

5.5.3.  The Weakest Link

   RADIUS security is done on a “hop by hop” basis, which means that an
   attacker can take advantage of the weakest link in a proxy chain in
   order to attack other systems which have fully implemented the above
   mitigations.  If the packets are passed through one or more proxies,
   then any one vulnerable proxy will still allow the attack to take
   place.

   If proxies are used, then the weakest link in the proxy chain limits
   the security of the entire chain.  That is, it does not matter if one
   hop implements RADIUS/TLS, if another hop implements RADIUS/UDP
   without sending or requiring Message-Authenticator.

   Even worse, proxies have full control over packet contents.  A
   malicious proxy can change a reject into an accept, and can add or
   delete any authorization attributes it desires.  While proxies are
   generally part of a trusted network, there is every benefit in
   limiting the number of participants in the RADIUS conversation.

   Proxy chains SHOULD therefore be avoided where possible, and
   [RFC7585] dynamic discovery should be used where possible.  RADIUS
   clients and servers SHOULD also be configured with static IP
   addresses, and with static routes.  This static configuration also
   protects the systems from DHCP related attacks where an attacker
   spoofs DHCP to cause clients or servers to route packets through the
   a system of the attackers choice.

DeKok                      Expires 30 May 2025                 [Page 41]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

5.6.  Note on Proxy-State

   As the BlastRADIUS paper points out in Appendix A:

      The presence of this attribute makes the protocol vulnerability
      much simpler to exploit than it would have been otherwise.

   To see why Proxy-State has this particular design, we go back to the
   original discussion in May 1995 [MAY-1995]

      The RADIUS proxy may place any state information (subject to the
      length limitations of a RADIUS attribute) that it will need to
      transform a reply from its server into a reply to its client.
      This is typically the original authenticator, identifier, IP
      address and UDP port number of the proxy's RADIUS client.

   There appear to be few, if any, RADIUS servers which implemented this
   suggestion.  In part because later discussions note:

      This works only if the NAS is prepared to accept replies from a
      proxy server for a request issued to a different server.

   This stateless proxy design has a number of additional issues, most
   notably violating the [RFC3539] "end-to-end" principle.  It therefore
   negatively impacts the stability of a RADIUS proxy system.

   This definition for Proxy-State later changed in [RFC2865],
   Section 5.33 to

      Usage of the Proxy-State Attribute is implementation dependent.  A
      description of its function is outside the scope of this
      specification.

   In practice, the utility of Proxy-State is limited to detecting proxy
   loops.  Proxies can count the number of Proxy-State attributes in
   received packets, and if the total is more than some number, then a
   proxy loop is likely.  We offer no advice on what to do if a proxy
   loop is detected, as RADIUS has no ability to signal protocol-layer
   errors.

   It is likely that a "hop count" attribute would likely have been
   simpler to implement, but even in 1996, it was likely difficult to
   change the behavior of proxies due to multiple implementations.

DeKok                      Expires 30 May 2025                 [Page 42]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

5.7.  Intrusion Detection Systems

   Intrusion detection systems can be updated to detect and/or warn
   about the attack with the following rules.  In the interests of
   brevity and generality, the rules are written as plain text.

   1.  Access-Request does not contain a Message-Authenticator
       attribute.

       Action: Warn the administrator that the system is vulnerable, and
       should be upgraded.

   2.  Access-Accept, Access-Reject, or Access-Challenge does not
       contain a Message-Authenticator attribute.

       Action: Warn the administrator that the system is vulnerable, and
       should be upgraded.

   3.  Access-Accept, Access-Reject, or Access-Challenge contains a
       Message-Authenticator attribute, but it is not the first
       attribute in the packet.

       Action: Warn the administrator that the system may be vulnerable,
       and should be upgraded.

   4.  Access-Request packet received by a RADIUS server contains Proxy-
       State, when the RADIUS client is a NAS.

       Action: Alert that an attack is likely taking place.

       Note that the check should be for packets received by the RADIUS
       server, and not for packets sent by the NAS.  The attack involves
       packets being modified after they are sent by the NAS, and before
       they are received by the RADIUS server.

   5.  Access-Accept, Access-Reject, or Access-Challenge sent by a
       RADIUS server contain Proxy-State, when the RADIUS client is a
       NAS.

       Action: Alert that an attack is likely taking place.

       Note that the check should be for packets sent by the RADIUS
       server, and not for packets received by the NAS.  The attacker
       can modify packets to "hide" Proxy-State in another attribute,
       such as Vendor-Specific.

   6.  Any RADIUS traffic is sent over UDP or TCP transport, without
       IPsec or TLS.

DeKok                      Expires 30 May 2025                 [Page 43]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

       Action: Warn that the system uses deprecated transport protocols,
       and should be upgraded.

   7.  Any RADIUS traffic is sent external to the organization over UDP
       or TCP transport, without IPsec or TLS.

       Action: Warn that this is an insecure configuration, and can
       expose users private data, identities, passwords, locations, etc.
       to unknown attackers.

   These rules should assist administrators with ongoing security and
   monitoring.

6.  Deprecating Insecure Transports

   The solution to an insecure protocol which uses thirty year-old
   cryptography is to deprecate the use insecure cryptography, and to
   mandate modern cryptographic transport.

6.1.  Deprecating RADIUS/UDP and RADIUS/TCP

   RADIUS/UDP and RADIUS/TCP MUST NOT be used outside of secure
   networks.  A secure network is one which is believed to be safe from
   eavesdroppers, attackers, etc.  For example, if IPsec is used between
   two systems, then those systems may use RADIUS/UDP or RADIUS/TCP over
   the IPsec connection.

   However, administrators should not assume that such uses are always
   secure.  An attacker who breaks into a critical system could use that
   access to view RADIUS traffic, and thus be able to attack it.
   Similarly, a network misconfiguration could result in the RADIUS
   traffic being sent over an insecure network.

   Neither the RADIUS client nor the RADIUS server would be aware of any
   network misconfiguration (e.g. such as could happen with IPsec).
   Neither the RADIUS client nor the RADIUS server would be aware of any
   attacker snooping on RADIUS/UDP or RADIUS/TCP traffic.

   In contrast, when TLS is used, the RADIUS endpoints are aware of all
   security issues, and can enforce any necessary security policies.

   Any use of RADIUS/UDP and RADIUS/TCP is therefore NOT RECOMMENDED,
   even when the underlying network is believed to be secure.

DeKok                      Expires 30 May 2025                 [Page 44]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

6.2.  Mandating Secure transports

   All systems which send RADIUS packets outside of secure networks MUST
   use either IPsec, RADIUS/TLS, or RADIUS/DTLS.  For operational and
   security reasons, it is RECOMMENDED to use RADIUS/TLS or RADIUS/DTLS
   instead of IPsec.

   Unlike (D)TLS, use of IPsec means that applications are generally
   unaware of transport-layer security.  Any problem with IPsec such as
   configuration issues, negotiation or re-keying problems are typically
   presented to the RADIUS servers as 100% packet loss.  These issues
   may occur at any time, independent of any changes to a RADIUS
   application using that transport.  Further, network misconfigurations
   which remove all security are completely transparent to the RADIUS
   application: packets can be sent over an insecure link, and the
   RADIUS server is unaware of the failure of the security layer.

   In contrast, (D)TLS gives the RADIUS application completely knowledge
   and control over transport-layer security.  The failure cases around
   (D)TLS are therefore often clearer, easier to diagnose and faster to
   resolve than failures in IPsec.  For example, a failed TLS connection
   may return a "connection refused" error to the application, or any
   one of many TLS errors indicating which exact part of the TLS
   conversion failed during negotiation.

6.3.  Crypto-Agility

   The crypto-agility requirements of [RFC6421] are addressed in
   [RFC6614] Appendix C, and in Section 10.1 of [RFC7360].  For clarity,
   we repeat the text of [RFC7360] here, with some minor modifications
   to update references, without changing the content.

   Section 4.2 of [RFC6421] makes a number of recommendations about
   security properties of new RADIUS proposals.  All of those
   recommendations are satisfied by using TLS or DTLS as the transport
   layer.

   Section 4.3 of [RFC6421] makes a number of recommendations about
   backwards compatibility with RADIUS.  [RFC7360] Section 3 addresses
   these concerns in detail.

   Section 4.4 of [RFC6421] recommends that change control be ceded to
   the IETF, and that interoperability is possible.  Both requirements
   are satisfied.

DeKok                      Expires 30 May 2025                 [Page 45]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   Section 4.5 of [RFC6421] requires that the new security methods apply
   to all packet types.  This requirement is satisfied by allowing TLS
   and DTLS to be used for all RADIUS traffic.  In addition, [RFC7360]
   Section 3, addresses concerns about documenting the transition from
   legacy RADIUS to crypto-agile RADIUS.

   Section 4.6 of [RFC6421] requires automated key management.  This
   requirement is satisfied by using TLS or DTLS key management.

   We can now finalize the work began in [RFC6421].  This document
   updates [RFC2865] to state that any new RADIUS specification MUST NOT
   introduce new "ad hoc" cryptographic primitives to authenticate
   packets as was done with the Request / Response Authenticator, or to
   obfuscate attributes as was done with User-Password and Tunnel-
   Password.  We allow legacy RADIUS-specific cryptographic methods
   existing as of the publication of this document to be used for
   historical compatibility.  However, all new cryptographic work which
   is specific to the RADIUS protocol is forbidden.

   We recognize that RADIUS/UDP will still be in use for many years, and
   that new standards may require some modicum of privacy.  As the
   BlastRADIUS attack shows, RADIUS/UDP security is inadequate.  The
   solution is not to fix RADIUS/UDP.  The solution is to deprecate it
   entirely.

   All new security and privacy requirements in RADIUS MUST be provided
   by a secure transport layer such as TLS or IPsec.  As noted above,
   simply using IPsec is not always enough, as the use (or not) of IPsec
   is unknown to the RADIUS application.

   The restriction forbidding new cryptographic work in RADIUS does not
   apply to the data being transported in RADIUS attributes.  For
   example, a new authentication method could use new cryptographic
   methods, and would be permitted to be transported in RADIUS.  This
   authentication method could be a new EAP method, or any other data
   which is opaque to the RADIUS transport.  In those cases, RADIUS
   serves as a transport layer for the authentication method.  The
   authentication data is treated as opaque data for the purposes of
   Access-Request, Access-Challenge, etc. packets.  There would be no
   need for the RADIUS protocol to define any new cryptographic methods
   in order to transport this data.

   Similarly, new specifications MAY define new attributes which use the
   obfuscation methods for User-Password as defined in [RFC2865]
   Section 5.2, or for Tunnel-Password as defined in [RFC2868]
   Section 3.5.  However, due to the issues noted above in Section 3.5,
   the Tunnel-Password obfuscation method MUST NOT be used for packets
   other than Access-Request, Access-Challenge, and Access-Accept.  If

DeKok                      Expires 30 May 2025                 [Page 46]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   the attribute needs to be send in another type of packet, then the
   protocol design is likely wrong, and needs to be revisited.  It is
   again a difficult choice to forbid certain uses of the Tunnel-
   Password obfuscation method, but we believe that doing so is
   preferable to allowing sensitive data to be obfuscated with less
   security than the original design intent.

7.  Migration Path and Recommendations

   We recognize that it is difficult to upgrade legacy devices with new
   cryptographic protocols and user interfaces.  The problem is made
   worse because of the volume of RADIUS devices which are in use.  The
   exact number is unknown, and can only be approximated.  Our best
   guess is that at the time of this writing there are millions of
   devices supporting RADIUS/UDP in daily use.  It takes significant
   time and effort to correct the deficiencies of all of them.

   We therefore need to define a migration path to using secure
   transports.  In the following sections, we give a number of migration
   steps which could each be done independently.  We recommend increased
   entropy for shared secrets.  We also mandate the use of Message-
   Authenticator in all Access-Request packets for RADIUS/UDP and
   RADIUS/TCP.  Finally, where [RFC6614] Section 2.3 makes support for
   TLS-PSK optional, we suggest that RADIUS/TLS and RADIUS/DTLS
   implementations SHOULD support TLS-PSK.

7.1.  Shared Secrets

   [RFC2865] Section 3 says:

      It is preferred that the secret be at least 16 octets.  This is to
      ensure a sufficiently large range for the secret to provide
      protection against exhaustive search attacks.  The secret MUST NOT
      be empty (length 0) since this would allow packets to be trivially
      forged.

   This recommendation is no longer adequate, so we strengthen it here.

   RADIUS implementations MUST support shared secrets of at least 32
   octets, and SHOULD support shared secrets of 64 octets.
   Implementations MUST warn administrators that the shared secret is
   insecure if it is 12 octets or less in length.

   Administrators SHOULD use shared secrets of at least 24 octets,
   generated using a source of secure random numbers.  Any other
   practice is likely to lead to compromise of the shared secret, user
   information, and possibly of the entire network.

DeKok                      Expires 30 May 2025                 [Page 47]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   Creating secure shared secrets is not difficult.  The following
   figure outlines four separate ways to create shared secrets.

       openssl rand -base64 16

       dd if=/dev/urandom bs=1 count=16 | base64

       dd if=/dev/urandom bs=1 count=16 | base32

       dd if=/dev/urandom bs=1 count=16 |
           (hexdump -ve '/1 "%02x"' && echo)

   Only one of the above commands should be run, as they are
   functionally equivalent.  Each command reads 128 bits (16 octets) of
   random data from a secure source, and encodes it as printable /
   readable ASCII.  This form of PSK will be accepted by any
   implementation which supports at least 32 octets for PSKs.  Larger
   PSKs can be generated by changing the "16" number in the command to a
   larger value.  The above derivation assumes that the random source
   returns one bit of entropy for every bit of randomness which is
   returned.  Sources failing that assumption are NOT RECOMMENDED.

   Given the simplicity of creating strong secrets, there is no excuse
   for using weak shared secrets with RADIUS.  The management overhead
   of dealing with complex secrets is less than the management overhead
   of dealing with compromised networks.

   Over all, the security analysis of shared secrets is similar to that
   for TLS-PSK.  It is therefore RECOMMENDED that implementers manage
   shared secrets with same the practices which are recommended for TLS-
   PSK, as defined in [RFC8446] Section E.7 and [RFC9257] Section 4.

   On a practical node, RADIUS implementers SHOULD provide tools for
   administrators to help them create and manage secure shared secrets.
   The cost to do so is minimal for an implementer.  Providing such
   tools can further enable and motivate administrators to use secure
   practices.

7.2.  Message-Authenticator

   The Message-Authenticator attribute was defined in [RFC3579]
   Section 3.2.  The "Note 1" paragraph at the bottom of [RFC3579]
   Section 3.2 required that Message-Authenticator be added to Access-
   Request packets when the EAP-Message as present, and suggested that
   it should be present in a few other situations.  The BlastRADIUS
   attack has shown that these recommendations are inadequate.

DeKok                      Expires 30 May 2025                 [Page 48]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   While the text in Section 5 goes into detail about the mitigations,
   we summarize them here.  Please see the previous section for a longer
   and more detailed explanation of the flags and their behavior.

      RADIUS clients MUST include the Message-Authenticator in all
      Access-Request packets when UDP or TCP transport is used.

      RADIUS clients and servers MUST have a boolean flag which we call
      "require Message-Authenticator".

      When set to "true", implementations receiving Access-Request,
      Access-Accept, Access-Challenge, Access-Reject, and Protocol-Error
      packets which do not contain Message-Authenticator MUST silently
      discard those packets.

      Servers MUST have a boolean flag which we call "limit Proxy-
      State".

      This flag MUST be examined when the "require Message-
      Authenticator" flag is set to "false".

      When set to "true", servers receiving an Access-Request packet
      which contains Proxy-State but no Message-Authenticator MUST
      discard that packet.

   In contrast, when TLS-based transports are used, the Message-
   Authenticator attribute serves no purpose, and could be omitted, even
   when the Access-Request packet contains an EAP-Message attribute.
   However, implementations SHOULD include it, even if it servers no
   immediate purpose.  As noted earlier, including Message-Authenticator
   can increase the security of legacy proxies which do not implement
   the BlastRADIUS mitigations.

   Servers receiving Access-Request packets over TLS-based transports
   SHOULD NOT silently discard a packet if it is missing a Message-
   Authenticator attribute.  However, if the Message-Authenticator
   attribute is present, it still MUST be validated as discussed in
   [RFC7360].

7.3.  Recommending TLS-PSK

   Given the insecurity of RADIUS/UDP, the absolute minimum acceptable
   security is to use strong shared secrets.  However, administrator
   overhead for TLS-PSK is not substantially higher than for shared
   secrets, and TLS-PSK offers significantly increased security and
   privacy.

DeKok                      Expires 30 May 2025                 [Page 49]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   It is therefore RECOMMENDED that implementations support TLS-PSK.  In
   some cases TLS-PSK is preferable to certificates.  It may be
   difficult for RADIUS clients to upgrade all of their interfaces to
   support the use of certificates, and TLS-PSK more closely mirrors the
   historical use of shared secrets, with similar operational
   considerations.

   Additional implementation and operational considerations for TLS-PSK
   are given in [I-D.ietf-radext-tls-psk].

7.4.  Guidelines for Administrators

   The above text provides guidelines for implementors.  We also need to
   provide guidelines for administrators as to how, and when, to
   configure the above flags.  The guidelines provided in this section
   are suggestions only.  Administrators are free to take other actions
   as they see fit.

   However, the guidelines provided here are known to provide minimal
   outages while upgrading complex systems.  As such, it is RECOMMENDED
   that administrators follow the steps outlined here, in order, so that
   RADIUS systems can be upgraded with minimal impact to operational
   networks.

   1.  Administrators SHOULD upgrade servers before upgrading clients.
       There are many fewer clients than servers, and upgrading servers
       can protect clients which are not upgraded.

   2.  Administrators SHOULD configure servers to set "limit Proxy-
       State" to "true" for all clients which are NASes.  i.e. clients
       which are not proxies.

   3.  Administrators of servers which proxy packets SHOULD verify that
       all "next hop" proxies have been upgraded, and that they return
       Message-Authenticator in all responses to Access-Request packets.

   4.  Once step (4) has been validated, administrators SHOULD configure
       their proxy so that the outgoing client confituration, sets the
       "require Message-Authenticator" flag to "true".

   5.  Administrators of servers which receive proxied packets (i.e.
       packets not from a NAS) SHOULD configure the server to set the
       the "require Message-Authenticator" flag to "true" for each
       client which is an upgraded proxy.

   Once the above five steps are followed, the network should be secure,
   and any client upgrade and configuration can be done over time.

DeKok                      Expires 30 May 2025                 [Page 50]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   For client upgrades, administrators can proceed with the following
   steps:

   1.  Administrators SHOULD upgrade clients individually, i.e. one at a
       time.  Upgrading multiple clients at the same time is NOT
       RECOMMENDED.

   2.  Once a client has been upgraded, administrators SHOULD verify
       that it sends Message-Authenticator in all Access-Request
       packets.

   3.  Once step (7) has been validated, administrators SHOULD configure
       each server receiving packets from that client to set the
       "require Message-Authenticator" flag to "true" for that client.

   4.  If a server has been updated, administrators SHOULD verify that
       it sends Message-Authenticator as the first attribute in all
       responses to Access-Request packets.

   5.  Once step (9) has been validated, administrators SHOULD configure
       each client receiving packets from that server to set the
       "require Message-Authenticator" flag to "true" for that server.

   Once all of the above steps are followed for all clients and servers,
   the network is secure from the BlastRADIUS attack.

8.  Increasing the Security of RADIUS

   While we still permit the use of UDP and TCP transports in secure
   environments, there are opportunities for increasing the security of
   RADIUS when those transport protocols are used.  The amount of
   personal identifiable information (PII) sent in packets should be
   minimized.  Information about the size, structure, and nature of the
   visited network should be omitted or anonymized.  The choice of
   authentication method also has security and privacy impacts.

   The recommendations here for increasing the security of RADIUS
   transports also applies when TLS is used.  TLS transports protect the
   RADIUS packets from observation by from third-parties.  However, TLS
   does not hide the content of RADIUS packets from intermediate
   proxies, such as ones uses in a roaming environment.  As such, the
   best approach to minimizing the information sent to proxies is to
   minimize the number of proxies which see the RADIUS traffic, and to
   minimize the amount of PII which is sent.

   Implementers and administrators need to be aware of all of these
   issues, and then make the best choice for their local network which
   balances their requirements on privacy, security, and cost.  Any

DeKok                      Expires 30 May 2025                 [Page 51]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   security approach based on a simple "checklist" of "good / bad"
   practices is likely to result in decreased security as compared to an
   end-to-end approach which is based on understanding the issues
   involved.

8.1.  Minimizing Personal Identifiable Information

   One approach to increasing RADIUS privacy is to minimize the amount
   of PII which is sent in packets.  Implementers of RADIUS products and
   administrators of RADIUS systems SHOULD ensure that only the minimum
   necessary PII is sent in RADIUS.

   Where possible, identities should be anonymized (e.g.  [RFC7542]
   Section 2.4).  The use of anonymized identities means that the the
   Chargeable-User-Identifier [RFC4372] should also be used.  Further
   discussion on this topic is below.

   Device information SHOULD be either omitted, or randomized.  e.g.
   MAC address randomization could be used on end-user devices.  The
   details behind this recommendation are the subject of ongoing
   research and development.  As such, we do not offer more specific
   recommendations here.

   Information about the visited network SHOULD be replaced or
   anonymized before packets are proxied outside of the local
   organization.  The attribute Operator-NAS-Identifier [RFC8559] can be
   used to anonymize information about NASes in the local network.

   Location information ([RFC5580] SHOULD either be omitted, or else it
   SHOULD be limited to the broadest possible information, such as
   country code.  For example, [I-D.tomas-openroaming] says:

      All OpenRoaming ANPs MUST support signaling of location
      information

   This location information is required to include at the minimum the
   country code.  We suggest the country code SHOULD also be the maximum
   amount of location information which is sent over third-party
   networks.

8.1.1.  Chargeable-User-Identity

   Where the Chargeable-User-Identity (CUI) [RFC4372] is used, it SHOULD
   be unique per session.  This practice will help to maximize user
   privacy, as it will be more difficult to track users across multiple
   sessions.  Due to additional constraints which we will discuss below,
   we cannot require that the CUI change for every session.

DeKok                      Expires 30 May 2025                 [Page 52]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   What we can do is to require that the home server MUST provide a
   unique CUI for each combination of user and visited network.  That
   is, if the same user visits multiple networks, the home server MUST
   provide different CUIs to each visited network for that user.  The
   CUI MAY be the same across multiple sessions for that user on one
   particular network.  The CUI MAY be the same for multiple devices
   used by that user on one particular network.

   We note that the MAC address is likely the same across multiple user
   sessions on one network.  Therefore changing the CUI offers little
   additional benefit, as the user can still be tracked by the
   unchanging MAC address.  Never the less, we believe that having a
   unique CUI per session can be useful, because there is ongoing work
   on increasing user privacy by allowing more MAC address
   randomization.  If we were to recommend that the CUI remain constant
   across multiple sessions, that would in turn negate much of the
   effort being put into MAC address randomization.

   One reason to have a constant CUI value for a user (or user devices)
   on one network is that network access providers may need to enforce
   limits on simultaneous logins.  Network providers may also need to
   correlate user behavior across multiple sessions in order to track
   and prevent abuse.  Both of these requirements are impossible if the
   CUI changes for every user session.

   The result is that there is a trade-off between user privacy and the
   needs of the local network.  While perfect user privacy is an
   admirable goal, perfect user privacy may also allow anonymous users
   to abuse the visited network.  The network would then likely simply
   refuse to provide network access.  Users may therefore have to accept
   some limitations on privacy, in order to obtain network access.

   Although the CUI contents are not directly related to security, we
   still give recommendations for creating and managing of the CUI.  We
   believe that these recommendations will help implementers satisfy the
   preceding requirements, while not imposing undue burden on the
   implementations.

   In general, the simplest way to track CUIs long term is to associate
   the CUI to user identity in some kind of cache or database.  This
   association could be created at the tail end of the authentication
   process, and before any accounting packets were received.  This
   association should generally be discarded after a period of time if
   no accounting packets are received.  If accounting packets are
   received, the CUI to user association should then be tracked along
   with the normal accounting data.

DeKok                      Expires 30 May 2025                 [Page 53]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   The above method for tracking CUI works no matter how the CUI is
   generated.  If the CUI can be unique per session, or it could be tied
   to a particular user identity across a long period of time.  The same
   CUI could also be associated with multiple devices.

   Where the CUI is not unique for each session, the only minor issue is
   the cost of the above method is that the association is stored on a
   per-session basis when there is no need for that to be done.  Storing
   the CUI per session means that is it possible to arbitrarily change
   how the CUI is calculated, with no impact on anything else in the
   system.  Designs such as this which decouple unrelated architectural
   elements are generally worth the minor extra cost.

   For creating the CUI, that process should be done in a way which is
   scalable and efficient.  For a unique CUI per user, implementers
   SHOULD create a value which is unique both to the user, and to the
   visited network.  There is no reason to use the same CUI for multiple
   visited networks, as that would enable the tracking of a user across
   multiple networks.

   Before suggesting a method for creating the CUI, we note that
   [RFC4372] Section 2.1 defines the CUI as being of data type 'string'
   ([RFC8044] Section 3.5).  [RFC4372] Section 2.1 further suggests that
   the value of the CUI is interpreted as an opaque token, similar to
   the Class attribute ([RFC2865] Section 5.25).  Some organizations
   create CUI values which use the Network Access Identifier (NAI)
   format as defined in [RFC7542].  This format can allow the home
   network to be identified to the visited network, where the User-Name
   does not contain a realm.  Such formats SHOULD NOT be used unless all
   parties involved have agreed to this behavior.

   The CUI SHOULD be created via a construct similar to what is given
   below, where "+" indicates concatenation:

   CUI = HASH(Visited Network Data + User Identifier + Key)

   This construct has the following functional parameters.

      HASH

         A cryptographic hash function.  It is RECOMMENDED to use an
         HMAC instead of a hash function.

      Visited Network Data

         Data which identifies the visited network.

DeKok                      Expires 30 May 2025                 [Page 54]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

         This data could be the Operator-Name attribute ([RFC5580]
         Section 4.1).

      User Identifier

         The site-local user identifier.  For tunneled EAP methods such
         as PEAP or TTLS, this could be the user identity which is sent
         inside of the TLS tunnel.

      Key

         A secret known only to the local network.  The key is generally
         a large random string.  It is used to help prevent dictionary
         attacks on the CUI.

   Where the CUI needs to be constant across multiple user sessions or
   devices, the key can be a static value.  It is generated once by the
   home network, and then stored for use in further CUI derivations.

   Where the CUI needs to be unique per session, the above derivation
   SHOULD still be used, except that the "key" value will instead be a
   random number which is different for each session.  Using such a
   design again decouples the CUI creation from any requirement that it
   is unique per session, or constant per user.  That decision can be
   changed at any time, and the only piece which needs to be updated is
   the derivation of the "key" field.  In contrast, if the CUI is
   generated completely randomly per session, then it may be difficult
   for a system to later change that behavior to allow the CUI to be
   constant for a particular user.

   If an NAI format is desired, the hash output can be converted to
   printable text, truncated if necessary to meet length limitations,
   and then an "@" character and a realm appended to it.  The resulting
   text string is then in NAI form.

   We note that the above recommendation is not invertible.  That is,
   given a particular CUI, it is not possible to determine which visited
   network or user identifier was used to create it.  If it is necessary
   to use the CUI to look up a user, the home network needs to store the
   full set of CUI values which a user has been assigned.

   If this tracking is too complex for a network, it is possible to
   create the CUI via an invertible encryption process as follows:

   CUI = ENCRYPT(Key + Visited Network Data + User Identifier)

   This construct has the following functional parameters.

DeKok                      Expires 30 May 2025                 [Page 55]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

      ENCRYPT

         A cryptographically secure encryption function.

      Key

         The encryption key.  Note that the same key must not be used
         for more both hashing and encryption.

      Visited Network Data

         Data which identifies the visited network.

         This data could be the Operator-Name attribute ([RFC5580]
         Section 4.1).

      User Identifier

         The site-local user identifier.  For tunneled EAP methods such
         as PEAP or TTLS, this could be the user identity which is sent
         inside of the TLS tunnel.

   However, it is RECOMMENDED that HMAC based methods are used instead
   of methods based on reversible encryption.

   The intent is for CUI to leak as little information as possible, and
   ideally be different for every session.  However, business
   agreements, legal requirements, etc. may mandate different behavior.
   The intention of this section is not to mandate complete CUI privacy,
   but instead to clarify the trade-offs between CUI privacy and
   business realities.

8.2.  User-Password Visibility

   The design of RADIUS means that when proxies receive Access-Request
   packets, the clear-text contents of the User-Password attribute are
   visible to the proxy.  Despite various claims to the contrary, the
   User-Password attribute is never sent "in the clear" over the
   network.  Instead, the password is protected by TLS (RADIUS/TLS) or
   via the obfuscation methods defined in [RFC2865], Section 5.2.
   However, the nature of RADIUS means that each proxy must first undo
   the password obfuscation of [RFC2865], and then re-do it when sending
   the outbound packet.  As such, the proxy has the clear-text password
   visible to it, and stored in its application memory.

   It is therefore possible for every intermediate proxy to snoop and
   record all User-Name and User-Password values which they see.  This
   exposure is most problematic when the proxies are administered by an

DeKok                      Expires 30 May 2025                 [Page 56]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   organization other than the one which operates the home server.  Even
   when all of the proxies are operated by the same organization, the
   temporary existence of clear-text passwords on multiple machines is a
   security risk.

   It is therefore NOT RECOMMENDED for organizations to send the User-
   Password attribute in packets which are sent outside of the
   organization.  If RADIUS proxying is necessary, another
   authentication method which provides for end-to-end security of user
   information SHOULD be used, such as EAP-TLS, TTLS, or PEAP.

   Client and server implementations SHOULD use secure programming
   techniques to wipe passwords and other sensitive data from memory
   when they are no longer needed.

   Organizations MAY still use User-Password attributes within their own
   systems, for reasons which we will explain below in Section 8.7.

8.3.  Delaying Access-Rejects

   Anyone can cause a NAS to send Access-Request packets at will, simply
   by attempting to requesting network access, or login permissions from
   the NAS.  If this login process is not rate-limited, it can be abused
   by an attacker to perform dictionary attacks.

   In order to prevent these brute-force attacks, servers which
   originate Access-Reject packets MUST enforce a minimum delay between
   reception of the Access-Request, and transmission of a corresponding
   Access-Reject.  This delay SHOULD be configurable.  Experience shows
   that values between one (1) second and ten (10) seconds work well in
   practice.

   Systems which simply proxy Access-Reject packets MUST NOT add any
   artificial delays to those packets.  Doing so would result in delays
   accumulating across a chain of proxies.

   Servers SHOULD also add a small random jitter to the delay for a
   particular packet, in order to better protect themselves from timing
   attacks.

8.4.  Use Constant Time Comparisons

   Both clients and servers SHOULD use constant-time operations to
   compare received versus calculated values which depend on secret
   information.  If comparison operations are stopped as soon as a
   difference is seen, an attacker could using timing attacks to
   determine the correct underlying values, even without seeing them.  A
   constant-time operation instead compares the entire value,

DeKok                      Expires 30 May 2025                 [Page 57]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   accumulating the result along the way.  Only when the entire value
   has been examined does the comparison return a "match" or "no-match"
   result.

   Constant-time operations SHOULD be used for the Request Authenticator
   and Response Authenticator fields.  Constant time comparisons SHOULD
   be used for attributes which directly contain secret values (e.g.
   User-Password), or are derived from secret values (e.g.  CHAP-
   Password, and Message-Authenticator).

8.5.  Minimize the use of Proxies

   The design of RADIUS means that even when RADIUS/TLS is used, every
   intermediate proxy has access to all of the information in each
   packet.  The only way to secure the network from such observers is to
   minimize the use of proxies.

   Where it is still necessary to use intermediate proxies such as with
   eduroam [EDUROAM] and OpenRoaming [OPENROAMING], it is RECOMMENDED to
   use EAP methods instead of bare PAP, CHAP, or MS-CHAP.  If passwords
   are used, they can be can be protected from being seen by proxies via
   TLS-based EAP methods such as EAP-TTLS or PEAP.  Passwords can also
   be omitted entirely from being sent over the network, as with EAP-TLS
   [RFC9190] or EAP-pwd [RFC5931].

   In many cases, however, the existence of proxies is to either due
   contractual obligations, or to a need to solve "N by M" connection
   problems.  A centralized proxy system can often simplify overall
   network management and maintenance.

8.5.1.  There is no RADIUS Routing Protocol

   While [RFC7585] allows for a client to connect directly to a server,
   that configuration is not always used.  Historically, RADIUS systems
   implemented realm [RFC7542] roaming, where multiple visited networks
   were connected to multiple home via chains of intermediate proxies
   [RFC2194].  As there is no RADIUS routing protocol to control realm
   forwarding through these proxies, there is therefore no way to
   automatically determine which realms are routable, or how best to
   route packets for known realms.

   The outcome of this limitation is that all such realm routing rules
   are largely configured statically, manually, and individually on
   multiple systems.  This process can be automated within one
   administrative system, but it is open to mistakes or abuse in multi-
   system networks.

DeKok                      Expires 30 May 2025                 [Page 58]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   In RADIUS, each proxy which sees traffic is completely trusted.  It
   can modify, filter, or record any packets which transit the proxy.
   This ability means that a proxy can engage in a large number of
   negative behaviors.  For example, a proxy could forge Access-Request
   packets for realms which it knows about, and potentially perform
   dictionary attacks on home networks.  A proxy could also alter or
   invent data in Accounting-Request packets, in order to defraud a home
   server of revenue.  A proxy could also observe Accounting-Request
   traffic, and use the obtained information to forge Disconnect-Request
   packets.

   Proxies can also inject traffic for realms which do not normally
   transit the proxy.  Without a routing protocol, there is no way for a
   home server to automatically control which set of realms is allowed
   to be sent from a particular client.  There is also no general way
   for a proxy to signal that a particular Access-Request or Accounting-
   Request is non-routable: it must be either rejected or discarded.

   Visited sites also have no control over proxies past the ones that
   they have relationships with.  Subsequent proxies are completely
   unknown, and unknowable to the visited network.  Despite these
   systems being completely unknown, they are completely trusted due to
   limitations in the RADIUS protocol.

   That is, there is no fine-grained way for a visited or home network
   to limit which intermediary systems see traffic for their realms, or
   what traffic can be seen by those systems.  While these filtering
   rules can be manually documented as seen in [FILTER], this process is
   error-prone, and fragile.

   Administrators should be aware of the above issues: fraud, forgery,
   and filtering are all possible in a "trusted" RADIUS ecosystem.

   Historically, these issues do not appear to have been widely
   exploited.  The most common defense against these attacks is to limit
   RADIUS relationships to entities which share a contractual
   relationship.  This relationship can be direct between clients,
   servers, and proxies.  This relationship can also be indirect, as
   when multiple organizations are members of a shared consortium such
   as eduroam.

   Implementations therefore SHOULD provide methods by which routing
   information can be tied to particular clients and to particular home
   servers.  Implementations SHOULD allow packets to be filtered by some
   combination of realm and client or home server.  Administrators
   SHOULD take advantage of these filters to double-check that received
   traffic is coming from the expected sources, and contains the
   expected realms.

DeKok                      Expires 30 May 2025                 [Page 59]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

8.5.2.  Dynamic Discovery and Filtering

   When [RFC7585] dynamic discovery is used, intermediate proxy hops are
   avoided.  There are a number of possible attacks here, though
   [RFC7585], Section 5 largely limits its discussion to rate limiting
   of connections.

   A client which supports dynamic discovery of home servers still has
   to perform filtering on NAI realms before doing any lookups.  When no
   filtering takes place, an attacker can cause a RADIUS client to do
   DNS lookups for arbitrary domains, and then cause it to connect to
   arbitrary servers.  As there is no RADIUS routing protocol, there is
   no general way for a client to determine which realms are part of a
   particular organization, and are thus permitted for dynamic DNS
   lookups.

   Organizations relying on dynamic discovery SHOULD have some way of
   automatically sharing which realms are valid, and which are not.
   There are a number of possibilities here, and choosing the best one
   is up to each individual organization.

   Clients supporting dynamic discovery SHOULD require that servers use
   certificates from a private Certification Authority (CA).  Clients
   MUST NOT automatically accept server certificates rooted from public
   CAs (e.g. as is done for web servers).  Instead, clients MUST be
   configurable to use only a limited set of CAs.  The default list of
   accepted CAs SHOULD be empty.

   Similarly, servers SHOULD require that clients use certificates from
   a private Certification Authority (CA).  Servers MUST NOT accept
   client certificates rooted from a public CA.

   Servers which accept connections from dynamic discover are
   necessarily open to the Internet.  Administrators SHOULD limit the
   source IP of allowed connections.  Server SHOULD filter received
   packets by NAI, and close connections when the NAIs in incoming
   packets do not match the NAI(s) that the server expects.  This
   mismatch indicates either a misconfigured or malicious client.

   Both clients and servers can send any data inside of a TLS tunnel.
   Implementations SHOULD take care to treat the data inside of a TLS
   tunnel as a potential source of attacks.

   Where multiple realms resolve to the same destination IP address,
   implementations MAY send packets for multiple realms across a
   connection to that IP address.  Clients SHOULD use SNI to indicate
   which realm they are connecting to.  Servers SHOULD present a
   certificate for the requested realm, instead of using a shared or

DeKok                      Expires 30 May 2025                 [Page 60]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   "hosting" certificate which is owned by the hosting provider, and is
   used by multiple realms.  Such certificate sharing decreases
   security, and increases operational costs.

   Where systems do not have a pre-defined list of allowed realms,
   implementations MUST support negative caching.  That is, if the
   lookup for a particular realm fails, or a connection to that realm
   fails, then the implementation needs to cache that negative result
   for a period of time.  This cache needs to be examined prior to any
   new lookup or connection being made.  If there is an entry in the
   negative cache, then the server MUST skip the lookup or connection
   attempt, and instead return an immediate error.  This negative cache
   time SHOULD be configurable.

   Other attacks are possible.  If there are implementation bugs in a
   clients TLS library, an attacker could use dynamic discovery to cause
   the client to connect to a malicious server, and then use the server
   to attack the client.  A malicious server could also slow down its
   TCP connection to engage client resources for extended periods of
   time.  This process could even be done even before any TLS
   credentials are exchanged.

   In general, [RFC7585] dynamic discovery is substantially different
   from normal application protocols which use TLS.  There is
   substantial attack surface added by an unknown, and unauthenticated
   user who can cause a RADIUS client to connect to arbitrary systems
   under an attacker control.  Dynamic discovery should be used with
   care, and only with substantial amounts of filtering on the NAI
   realms which are allowed, and only with stringent limits on the
   number of lookups, connection attempts, open connections, etc.

8.6.  Do Not Use MS-CHAP

   MS-CHAP (v1 in [RFC2433] and v2 in [RFC2759]) have major design
   flaws, and should not be used outside of a secure tunnel such as PEAP
   or TTLS.  As MS-CHAPv1 is less commonly used, the discussion in this
   section will focus on MS-CHAPv2, but the same analysis applies to MS-
   CHAPv1.

   MS-CHAP has been broken since 2004, as seen in [ASLEAP].  While the
   attack there mentions LEAP, the same attack applies to MS-CHAP.  This
   information was apparently insufficiently clear in the [ASLEAP]
   attack, as most implementations still support MS-CHAP, and no
   previous standard has deprecated it.

   The attack relies on a vulnerability in the protocol design in
   [RFC2759], Section 8.4.  In that section, the response to the MS-CHAP
   challenge is calculated via three DES operations, which are based on

DeKok                      Expires 30 May 2025                 [Page 61]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   the 16-octet NT-Hash form of the password.  However, the DES
   operation requires 7 octet keys, so the 16-octet NT-Hash cannot be
   divided evenly into the 21 octets of keys required for the DES
   operation.

   The solution in [RFC2759] Section 8.4 is to use the first 7 octets of
   the NT-Hash for the first DES key, the next 7 octets for the second
   DES key, leaving only 2 octets for the final DES key.  The final DES
   key is padded with zeros.  This construction means that an attacker
   who can observe the MS-CHAP2 exchange only needs to perform 2^16 DES
   operations in order to determine the final 2 octets of the original
   NT-Hash.

   If the attacker has a database which correlates known passwords to
   NT-Hashes, then those two octets can be used as an index into that
   database, which returns a subset of candidate hashes.  Those hashes
   are then checked via brute-force operations to see if they match the
   original MS-CHAPv2 data.

   This process lowers the complexity of cracking MS-CHAP by nearly five
   orders of magnitude as compared to a brute-force attack.  The attack
   has been demonstrated using databases which contain tens to hundreds
   of millions of passwords.  On a consumer-grade machine, the time
   required for such an attack to succeed is on the order of tens of
   milliseconds.

   While this attack does require a database of known passwords, such
   databases are easy to find online, or to create locally from
   generator functions.  Passwords created manually by people are
   notoriously predictable, and are highly likely to be found in a
   database of known passwords.  In the extreme case of strong
   passwords, they will not be found in the database, and the attacker
   is still required to perform a brute-force dictionary search.

   The result is that MS-CHAP has significantly lower security than PAP.
   When the MS-CHAP data is not protected by TLS, it is visible to
   everyone who can observe the RADIUS traffic.  Attackers who can see
   the MS-CHAP traffic can therefore obtain the underlying NT-Hash with
   essentially zero effort, as compared to cracking the RADIUS shared
   secret.  In contrast, the User-Password attribute is obfuscated with
   data derived from the Request Authenticator and the shared secret,
   and that method has not yet been successfully attacked.

DeKok                      Expires 30 May 2025                 [Page 62]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   Implementers and administrators MUST therefore treat MS-CHAP and MS-
   CHAPv2 as being equivalent in security to sending passwords in the
   clear, without any encryption or obfuscation.  That is, the User-
   Password attribute with the [RFC2865], Section 5.2 obfuscation is
   substantially more secure than MS-CHAP.  MS-CHAP offers little
   benefit over PAP, and has many drawbacks as discussed here, and in
   the next section.

   As MS-CHAP can be trivially broken by an observer, this document
   therefore mandates that MS-CHAP or MS-CHAPv2 authentication data
   carried in RADIUS MUST NOT be sent in situations where the that data
   is visible to an observer.  MS-CHAP or MS-CHAPv2 authentication data
   MUST NOT be sent over RADIUS/UDP or RADIUS/TCP.

   As MS-CHAP offers no practical benefits over PAP and has many
   downsides, MS-CHAP authentication SHOULD NOT be used even when the
   transport protocol is secure, as with IPsec or RADIUS over TLS.

   Existing RADIUS client implementations SHOULD deprecate the use of
   MS-CHAPv1 and MS-CHAPv2.  Clients SHOULD forbid new configurations
   from enabling MS-CHAP authentication.  New RADIUS clients MUST NOT
   implement the attributes used for MS-CHAPv1 and MS-CHAPv2
   authentication (MS-CHAP-Challenge and MS-CHAP-Response).

8.7.  Password Visibility and Storage

   An attacker may choose to ignore the wire protocol entirely, and
   bypass all of the issues described earlier in this document.  An
   attacker could instead focus on the database which holds user
   credentials such as account names and passwords.  At the time of this
   writing, databases such as [PWNED] claim to have records of over
   twelve billion user accounts which have been compromised.  User
   databases are therefore highly sought-after targets.

   The attack discussed in this section is dependent on vulnerabilities
   with the credential database, and does not assume an attacker can see
   or modify RADIUS traffic.  As a result, issues raised here apply
   equally well when TTLS, PEAP, or RADIUS/TLS are used.  The success of
   the attack depends only on how the credentials are stored in the
   database.  Since the choice of authentication method affects the way
   credentials are stored in the database, the security of that
   dependency needs to be discussed and explained.

DeKok                      Expires 30 May 2025                 [Page 63]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   Some organizations may desire to increase the security of their
   network by avoiding PAP, and using CHAP or MS-CHAP, instead.  These
   attempts are misguided.  If simple password-based methods must be
   used, in almost all situations, the security of the network as a
   whole is increased by using PAP in preference to CHAP or MS-CHAP.
   The reason is found through a straightforward risk analysis, which we
   explain in more detail below.

8.7.1.  PAP Security Analysis

   When PAP is used, the RADIUS server sees a clear-text password from
   the user, and compares that password to credentials which have been
   stored in a user database.  The credentials stored in the database
   can be salted and/or hashed in a form which is commonly referred to
   as being in "crypt"ed form.  The RADIUS server takes the users clear-
   text password, performs the same "crypt" transformation, and then
   compares the two "crypt"ed passwords.

   Any compromise the RADIUS server will result in that clear-text
   password leaking.  However, in most cases, the clear-text password is
   available only in the memory of the RADIUS server application (i.e.
   not "on the wire"), and then only for a short period of time.  An
   attacker who desires to obtain passwords for all users would have to
   wait for all users to log in, which can take a substantial amount of
   time.  During that time, an administrator may discover the breach,
   and resolve the issue.

   When PAP is used, the credentials in the database are stored securely
   "at rest", presuming that the administrator only stores "crypt"ed
   credentials.  Any compromise of the database results in the
   disclosure of minimal information to the attacker.  That is, an
   attacker cannot easily obtain the clear-text passwords from the
   compromised database.

   The result is that the user passwords are visible in clear-text only
   for a short time, and then only on the RADIUS server.  The security
   of this system is not as good as seen with EAP-pwd [RFC5931] for
   example, but it is not terrible.

DeKok                      Expires 30 May 2025                 [Page 64]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   While the obfuscation method used for the User-Password attribute has
   not been shown to be insecure, it has not been proven to be secure.
   The obfuscation method depends on calculating MD5(secret + Request
   Authenticator), which has a few helpful properties for an attacker.
   The cost of brute-forcing short secrets is not large, Section 3.4
   discusses that cost in detail.  Even for longer secrets which are
   humanly generated, the MD5 state for hashing the secret can be pre-
   calculated and stored on disk.  This process is relatively
   inexpensive, even for billions of possible shared secrets.  The
   Request Authenticator can then be added to each pre-calculated state
   via brute-force, and compared to the obfuscated User-Password data.

   The MD5 digest is 16 octets long, and many passwords are shorter than
   that.  This difference means that the final octets of the digest are
   placed into the User-Password attribute without modification.  The
   result is that a brute-force attack does not need to decode the User-
   Password and see if the decoded password "looks reasonable".
   Instead, the attacker simply needs to compare the final octets of the
   calculated digest with the final octets of the User-Password
   attribute.  The result is an extremely high probability signal that
   the guessed secret is correct.

   The only protection from this attack is to ensure that the secret is
   long, and derived from a cryptographically strong pseudo-random
   number generator.  Section 7.1 discusses these issues in more detail.

8.7.2.  CHAP and MS-CHAP Password Storage

   In contrast with PAP, when CHAP or MS-CHAP is used, those methods do
   not expose a clear-text password to the RADIUS server, but instead a
   hashed transformation of it.  That hash output is in theory secure
   even if an attacker can observe it.  While CHAP is still believed to
   be secure, MS-CHAP is not secure, as we saw earlier in Section 8.6.
   For the purposes of this section, we will focus on the construct of
   "hashed passwords", and will ignore any attacks specific to MS-CHAP.
   We will also note that EAP-MD5 [RFC3748], Section 5.4 is essentially
   CHAP, and has the same security analysis.

   The hash transformations for CHAP and MS-CHAP depend on a random
   challenge.  The intent was to increase security, but their
   construction makes strong requirements on the form in which user
   credentials are stored.

   The process for performing CHAP and MS-CHAP is inverted from the
   process for PAP.  Using similar terminology as above for illustrative
   purposes, the "hash"ed passwords are carried in the CHAP method, and
   are sent to the server.  The server must obtain the clear-text (or NT
   hashed) password from the database, and then perform the "hash"

DeKok                      Expires 30 May 2025                 [Page 65]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   operation on the password from the database.  The two "hash"ed
   passwords are then compared as was done with PAP.  This inverted
   process decreases system security substantially.

   When CHAP or MS-CHAP are used, all of credentials are stored as
   clear-text (or clear-text equivalent) in the database, all of the
   time.  Even if the database contents are encrypted, the decryption
   keys are necessarily accessible to the application which reads that
   database.  Any compromise of the application means that the entire
   database can be immediately read and exfiltrated as a whole.  The
   attacker then has complete access to all user identities, and all
   associated clear-text passwords.

   It should go without saying that having an attacker obtain all clear-
   text passwords is more of an issue than having the same attacker
   obtain "crypt"ed passwords.  Similarly, it is more secure for a
   RADIUS server to have access to some clear-text passwords, some of
   the time, rather than having access to all of the clear-text
   passwords, all of the time.

8.7.3.  On-the-wire User-Password versus CHAP-Password

   There is one more security myth which should be put to rest about PAP
   versus CHAP.  There is a common belief that CHAP is more secure,
   because passwords are sent "in the clear" via the User-Password
   attribute.  This belief is false.

   The User-Password attribute is obfuscated when it is sent in an
   Access-Request packet, using keyed MD5 and the shared secret, as
   defined in [RFC2865], Section 5.2.  At the time of this writing, no
   attack better than brute force has been found which allows an
   attacker to reverse this obfuscation.

   There have been claims that it is preferable to use CHAP-Password as
   it does not "send the password in clear-text".  This preference is
   based on a misunderstanding of how CHAP-Password and User-Password
   attributes are calculated.

   The CHAP-Password attribute depends on the hash of a visible Request
   Authenticator (or CHAP-Challenge) and the users password.  The
   obfuscated User-Password depends on the same Request Authenticator,
   and on the RADIUS shared secret.  For an attacker, the difference
   between the two calculations is minimal.  They can both be attacked
   with similar amounts of effort, as they use similar constructs.  As a
   result, any security analysis which makes the claim that "User-
   Password insecure because it uses MD5" ignores the fact that the
   CHAP-Password attribute is constructed through substantially the same
   method.

DeKok                      Expires 30 May 2025                 [Page 66]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   An attacker who can observe the CHAP-Password and CHAP-Challenge can
   also perform an off-line dictionary attack on the observed values.
   The complexity of cracking CHAP-Password is similar to that noted
   above for cracking RADIUS packets, which was discussed above in
   Section 3.4.  The difference between the two attacks is that the
   shared secrets are more likely to be secure than passwords for an
   end-user.

   An attacker who can crack one users password can gain network access
   as that user, or even administrator access to network devices.  In
   contrast, an attacker who can crack the shared secret can gain
   network access as any user, and perform any authorization.  The
   result is that it is more valuable to crack shared secrets, even if
   the underlying attack process is essentially the same.

8.7.4.  PAP vs CHAP Conclusions

   A careful security analysis shows that for all of PAP, CHAP, and MS-
   CHAP, the RADIUS server must at some point have access to the clear-
   text version of the password.  As a result, there is minimal
   difference in risk exposure between the different authentication
   methods if a RADIUS server is compromised.

   However, when PAP is used, the user credentials can be stored
   securely "at rest" in a database, while such secure storage is
   impossible with CHAP and MS-CHAP.  There is therefore a substantial
   difference in risk exposure between the different authentication
   methods, with PAP offering substantially higher security due to its
   ability to secure passwords at rest via the "crypt" construct
   mentioned above.

   In contrast, CHAP is highly insecure, as any database compromise
   results in the immediate exposure of the clear-text passwords for all
   users.  The security of MS-CHAP is best described as near zero,
   independent of any database compromise.  This makes MS-CHAP the worst
   of all possible choices.

   This security difference is shown not just in the [PWNED] database,
   but also in attacks on RADIUS systems [EXPLOIT], where attackers
   identified a vulnerable RADIUS system, and then:

      utilized SQL commands to dump the credentials [T1555], which
      contained both clear-text and hashed passwords for user and
      administrative accounts.

   The attack proceeded to leverage those passwords to gain more
   permissions:

DeKok                      Expires 30 May 2025                 [Page 67]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

      Having gained credentials from the RADIUS server, PRC state-
      sponsored cyber actors used those credentials with custom
      automated scripts to authenticate to a router via Secure Shell
      (SSH), execute router commands, and save the output.

   This attack is only possible when systems store clear-text passwords.

   The result is that when the system as a whole is taken into account,
   the risk of password compromise is substantially less with PAP than
   with CHAP or MS-CHAP.  It is therefore RECOMMENDED that
   administrators use PAP in preference to CHAP or MS-CHAP.  It is also
   RECOMMENDED that administrators store passwords "at rest" in a secure
   form (salted, hashed), as with the "crypt" format discussed above.

   That being said, other authentication methods such as EAP-TLS
   [RFC9190] and EAP-pwd [RFC5931] do not expose clear-text passwords to
   the RADIUS server or any intermediate proxy.  Thor methods therefore
   lower the risk of password exposure even more than using PAP.  It is
   RECOMMENDED that administrators avoid password-based authentication
   methods where at all possible.

8.8.  Use EAP Where Possible

   If more complex authentication methods are needed, there are a number
   of EAP methods which can be used.  These methods variously allow for
   the use of certificates (EAP-TLS), or passwords (EAP-TTLS [RFC5281],
   PEAP [I-D.josefsson-pppext-eap-tls-eap])) and EAP-pwd [RFC5931].

   We also note that the TLS-based EAP methods which transport passwords
   also hide the passwords from intermediate RADIUS proxies, which also
   increases security.

   Finally, password-based EAP methods still send PAP / CHAP / MS-CHAP
   inside of the TLS tunnel.  As such, the security of a home server
   which checks those passwords is subject to the analysis above about
   PAP versus CHAP, along with the issues of storing passwords in a
   database.

8.9.  Eliminating Proxies

   The best way to avoid malicious proxies is to eliminate proxies
   entirely.  The use of dynamic peer discovery ([RFC7585]) means that
   the number of intermediate proxies is minimized.

DeKok                      Expires 30 May 2025                 [Page 68]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   However, the server on the visited network still acts as a proxy
   between the NAS and the home network.  As a result, all of the above
   analysis still applies when [RFC7585] peer discovery is used.  There
   is an intermediate system which may have access to passwords or PII.
   The only solution is using end-to-end security for AAA, which would
   involve a completely new protocol.

8.10.  Accounting Is Imperfect

   The use of RADIUS/UDP for accounting means that accounting is
   inherently unreliable.  Unreliable accounting means that different
   entities in the network can have different views of accounting
   traffic.  These differences can have multiple impacts, including
   incorrect views of who is on the network, to disagreements about
   financial obligations.  These issues are discussed in substantial
   detail in [RFC2975], and we do not repeat those discussions here.  We
   do, however, summarize a few key issues.  Sites which use accounting
   SHOULD be aware of the issues raised in [RFC2975], and the
   limitations of the suggested solutions.

   Using a reliable transport such as RADIUS/TLS makes it more likely
   that accounting packets are delivered, and that acknowledgments to
   those packets are received.  Reducing the number of proxies means
   that there are fewer disparate systems which need to have their
   accounting data reconciled.  Using non-volatile storage for
   accounting packets means that a system can reboot with minimal loss
   of accounting data.  Using interim accounting updates means that
   transient network issues or data losses can be corrected by later
   updates.

   As RADIUS does not provide for end-to-end signaling or transport,
   using RADIUS/TLS provides for reliable transport only when the client
   originating the accounting traffic is connected directly to the
   server which records it.  If there are instead one or more proxies
   involved, the proxies increase overall unreliability.

   Systems which perform accounting are also subject to significant
   operational loads.  Wheres authentication and authorization may use
   multiple packets, those packets are sent at session start, and then
   never again.  In contrast, accounting packets can be sent for the
   lifetime of a session, which may be hours or even days.  There is a
   large cost to receiving, processing, and storing volumes of
   accounting data.

DeKok                      Expires 30 May 2025                 [Page 69]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   However, even with all of the above concerns addressed, accounting is
   still imperfect.  The obvious way to increase the accuracy of
   accounting data is to increase the rate at which interim updates are
   sent, but doing so also increases the load on the servers which
   process the accounting data.  At some point, the trade-off of cost
   versus benefit becomes negative.

   There is no perfect solution here.  Instead, there are simply a
   variety of imperfect trade-offs.

8.10.1.  Incorrect Accounting Data

   Even if all accounting packets were delivered and stored without
   error, there is no guarantee that the contents of those packets are
   in any way reasonable.  The Wireless Broadband Alliance RADIUS
   Accounting Assurance [WBA] group has been investigating these issues.
   While the results are not yet public, a presentation was made at IETF
   118 in the RADEXT working group [RADEXT118].

   The data presented indicated that the WBA saw just about every
   possible counter attribute in RADIUS accounting packets as containing
   data which was blatantly wrong or contradictory.  One example is
   extremely short sessions which have impossibly large amounts of data
   being downloaded.  Other accounting packets allege that large amounts
   of data were downloaded via octet counters, while at the same time
   claiming negligible packet counters, leading to absurdly large packet
   sizes.

   The only conclusion from this analysis is that RADIUS clients act as
   if it is better to produce incorrect accounting data rather than to
   produce no data at all.  This failure to follow reasonable practices
   is expensive.  In effect, vendors have offset their costs to produce
   quality data onto their customers, who have to take difficult and
   uncertain steps in order to sanitize or verify the confusing data
   which vendors provide in accounting packets.

   It should go without saying that accounting systems need to produce
   correct data.  However, [RFC2865] makes no requirement that the
   accounting data transported in RADIUS is correct, or is even vaguely
   realistic.  We therefore state here that systems which produce
   accounting data MUST generate correct, accurate, and reasonably
   precise data.  Vendors of networking equipment SHOULD test their
   systems to verify that the data they produce is accurate.

DeKok                      Expires 30 May 2025                 [Page 70]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

8.11.  Unknown Attributes

   One outcome of the BlastRADIUS mitigations was the discovery that
   some implementations discarded packets which contained an attribute
   that they did not recognize.  While this behavior is not explicitly
   permitted by previous specifications, we must admit that it is not
   explicitly forbidden, either.  This document corrects that failure.

   Unknown attributes are defined to be attributes which are well-
   formed, but which are not recognized by the implementation.
   Processing of unknown attributes is discussed in [RFC2866],
   Section 5:

      A RADIUS server MAY ignore Attributes with an unknown Type.

      A RADIUS client MAY ignore Attributes with an unknown Type.

   We note this recommendation is to "ignore" these attributes, and not
   to discard the encapsulating packet.  Instead of ignoring unknown
   attributes, some implementations instead to discard packets which
   contain an unknown attribute.  This behavior is incorrect, and leads
   to interoperability issues and network problems.

   With limited exceptions, implementations MUST NOT discard packets if
   they receive attributes with an unknown Type.  We update [RFC2865] to
   require that implementations MUST ignore Attributes with an unknown
   Type.  Those attributes MUST be treated in the same manner as an
   "Invalid Attribute" which is defined in [RFC6929], Section 2.8.

   The only exception to the above rule is CoA-Request and Disconnect-
   Request packets, as discussed in [RFC8559], Section 4.3.2.

   This behavior is secure, so long as implementations follow some
   additional guidance for Access-Accept packets.  This guidance follows
   logically from existing text in [RFC2865], Section 4.4 for similar
   situations with Access-Challenge:

      If the NAS does not support challenge/response, it MUST treat an
      Access-Challenge as though it had received an Access-Reject
      instead.

   And also for Service-Type in [RFC2865], Section 5.6:

      A NAS is not required to implement all of these service types, and
      MUST treat unknown or unsupported Service-Types as though an
      Access-Reject had been received instead.

DeKok                      Expires 30 May 2025                 [Page 71]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   A client is not required to implement all possible authorizations
   which can be sent in an Access-Accept.  We therefore extend the above
   scenarios to packets which contain unknown Types.  A client SHOULD
   treat Access-Accepts with no known or supported authorizations as
   though an Access-Reject had been received instead.

   This requirement for unknown Types is already met by most, if not
   all, RADIUS implementations.  That is, experience has shown that
   discarding packets for arbitrary reasons causes problems.  Existing
   implementations have largely chosen to follow reasonable practices,
   and the recommendation here simply documents that wide-spread
   practice.

9.  Practical Suggestions

   In the interest of simplifying the above explanations, this section
   provides a short-form checklist of recommendations.  Following this
   checklist does not guarantee that RADIUS systems are secure from all
   possible attacks.  However, systems which do not follow this
   checklist are likely to be vulnerable to known attacks, and are
   therefore less secure than they could be.

      -  Do not use RADIUS/UDP or RADIUS/TCP across the wider Internet

      Exposing user identifiers, device identifiers, and locations is a
      privacy and security issue.

      -  Avoid RADIUS/UDP or RADIUS/TCP in other networks, too.

      It can take time to upgrade equipment, but the long-term goal is
      to entirely deprecate RADIUS/UDP.

      -  Implement the BlastRADIUS mitigations

      Both Implementers and administrators should implement the
      mitigations in order to secure Access-Request packets.

      -  Use strong shared secrets

      Shared secrets should be generated from a cryptographically strong
      pseudo-random number generator.  They should contain at least 128
      bits of entropy.  Each RADIUS client should have a unique shared
      secret.

      -  Minimize the use of RADIUS proxies.

      More proxies means more systems which could be compromised, and
      more systems which can see private or secret data.

DeKok                      Expires 30 May 2025                 [Page 72]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

      -  Do not proxy from secure to insecure transports

      If user information (credentials or identities) is received over a
      secure transport (IPsec, RADIUS/TLS, TLS-based EAP method), then
      proxying the protected data over RADIUS/UDP or RADIUS/TCP degrades
      security and privacy.

      -  Prefer EAP authentication methods to non-EAP methods.

      EAP authentication methods are better at hiding user credentials
      from observers.

      -  For EAP, use anonymous outer identifiers

      There are few reasons to use individual identities for EAP.
      Identifying the realm is usually enough.

      [RFC7542] Section 2.4 recommends that "@realm" is preferable to
      "anonymous@realm", which is in turn preferable to "user@realm".

      -  Prefer using PAP over CHAP or MS-CHAP.

      PAP allows for credentials to be stored securely "at rest" in a
      user database.  CHAP and MS-CHAP do not.

      -  Do not use MS-CHAP outside of TLS-based EAP methods.

      MS-CHAP can be cracked with minimal effort.  This information has
      been known for two decades.

      -  Store passwords in "crypt"ed form

      Where is is necessary to store passwords, use systems such as
      PBKDF2 ([RFC8018].

      -  Regularly update to the latest cryptographic methods.

      TLS 1.0 with RC4 was acceptable at one point in time.  It is no
      longer acceptable.  Similarly, the current cryptographic methods
      will at some point will be deprecated, and replaced by updated
      methods.  Upgrading to recent cryptographic methods should be a
      normal part of operating a RADIUS server.

      -  Regularly deprecate older cryptographic methods.

DeKok                      Expires 30 May 2025                 [Page 73]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

      Administrators should actively deprecate the use of older
      cryptographic methods.  If no system is using older methods, then
      those methods should be disabled or removed entirely.  Leaving old
      methods enabled makes the server more vulnerable to attacks.

      -  Send the minimum amount of information which is needed,.

      Where proxying is used, it is a common practice is to simply
      forward all of the information from a NAS to other RADIUS servers.
      Instead, the proxy closest to the NAS should filter out any
      attributes or data which are not needed by the "next hop" proxies,
      or by the home server.

10.  Privacy Considerations

   The primary focus of this document is addressing privacy and security
   considerations for RADIUS.

   Deprecating insecure transport for RADIUS, and requiring secure
   transport means that personally identifying information is no longer
   sent "in the clear".  As noted earlier in this document, such
   information can include MAC addresses, user identifiers, and user
   locations.

   In addition, this document suggests ways to increase privacy by
   minimizing the use and exchange of PII.

11.  Security Considerations

   The primary focus of this document is addressing privacy and security
   considerations for RADIUS.

   Deprecating insecure transports for RADIUS, and requiring secure
   transports, means that many historical security issues with the
   RADIUS protocol are mitigated.

   We reiterate the discussion above that any security analysis must be
   done on the system as a whole.  It is not reasonable to put an
   expensive lock on the front door of a house while leaving the window
   next to it open, and then somehow declare the house to be "secure".
   Any approach to security based on a simple checklist is at best
   naive, and more truthfully is deeply misleading.  At worst, such
   practices will decrease security by causing people to follow false
   security practices, and to ignore real security practices.

DeKok                      Expires 30 May 2025                 [Page 74]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   Implementers and administrators need to be aware of the issues raised
   in this document.  They can then make the best choice for their local
   network which balances their requirements on privacy, security, and
   cost.  Only informed choices will lead to the best security.

11.1.  Historical Considerations

   The BlastRADIUS vulnerability is the result of RADIUS security being
   a low priority for decades.  Even the recommendation of [RFC5080],
   Section 2.2.2 that all clients add Message-Authenticator to all
   Access-Request packets was ignored by nearly all implementers.  If
   that recommendation had been followed, then the BlastRADIUS
   vulnerability notification would have been little more than "please
   remember to set the require Message-Authenticator flag on all RADIUS
   servers."

   For MS-CHAP, it has not previously been deprecated for similar
   reasons, even though it has been proven to be insecure for decades.
   This continued use of MS-CHAP has likely resulted in the leaking of
   many users clear-text passwords.

11.2.  Practical Implications

   This document either deprecates or forbids methods and behaviors
   which have been common practice for decades.  While insecure
   practices have been viewed as tolerable, they are no longer
   acceptable.

12.  IANA Considerations

   IANA is instructed to update the RADIUS Types registry, and the
   "Values for RADIUS Attribute 101, Error-Cause Attribute" sub-registry
   with the following addition:

   Value,Description,Reference
   510,Missing Message-Authenticator,[THIS-DOCUMENT]

13.  Acknowledgements

   Thanks to the many reviewers and commenters for raising topics to
   discuss, and for providing insight into the issues related to
   increasing the security of RADIUS.  In no particular order, thanks to
   Margaret Cullen, Alexander Clouter, and Josh Howlett.

   Many thanks to Nadia Heninger and the rest of the BlastRADIUS team,
   along with Heikki Vatiainen, for extensive discussions and feedback
   about the issue.

DeKok                      Expires 30 May 2025                 [Page 75]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

14.  Changelog

   *  01 - added more discussion of IPsec, and move TLS-PSK to its own
      document,

   *  02 - Added text on Increasing the Security of Insecure Transports

   *  03 - add text on CUI.  Add notes on PAP vs CHAP security

   *  04 - add text on security of MS-CHAP.  Rearrange and reword many
      sections for clarity.

   *  05 - Rework title to deprecating "insecure practices".
      Clarifications based on WG feedback.

   *  00 - adoption by WG.

   *  01 - review from Bernard Aboba.  Added discussion on accounting,
      clarified and re-arranged text.  Added discussion of server
      behavior for missing Message-Authenticator

   *  02 - BlastRADIUS updates.

   *  03 - add delay Access-Reject, constant-time comparison, no routing
      protocol.  Updated the text significantly and made it more
      consistent with the BlastRADIUS recommendations.  Add "updates"
      other RFCs.

   *  04 - updates with review from Fabian Mauchle

   *  05 - merge in spelling fixes from Andrew Wood.  Update and rewrite
      BlastRADIUS mitigations to make them clearer.  Add section
      describing processes administrators can use to upgrade their
      networks.

15.  References

15.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

   [RFC2865]  Rigney, C., Willens, S., Rubens, A., and W. Simpson,
              "Remote Authentication Dial In User Service (RADIUS)",
              RFC 2865, DOI 10.17487/RFC2865, June 2000,
              <https://www.rfc-editor.org/rfc/rfc2865>.

DeKok                      Expires 30 May 2025                 [Page 76]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   [RFC6421]  Nelson, D., Ed., "Crypto-Agility Requirements for Remote
              Authentication Dial-In User Service (RADIUS)", RFC 6421,
              DOI 10.17487/RFC6421, November 2011,
              <https://www.rfc-editor.org/rfc/rfc6421>.

   [RFC8044]  DeKok, A., "Data Types in RADIUS", RFC 8044,
              DOI 10.17487/RFC8044, January 2017,
              <https://www.rfc-editor.org/rfc/rfc8044>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

15.2.  Informative References

   [ASLEAP]   Wright, J., "asleap - recovers weak LEAP and PPTP
              passwords", n.d., <https://github.com/joswr1ght/asleap>.

   [BLAST]    Goldberg, S , et al, "RADIUS/UDP Considered Harmful",
              n.d., <https://www.blastradius.fail/pdf/radius.pdf>.

   [BRIGGS]   Briggs, K., "Comments on the FCC’s Public Notice DA 24-308
              on SS7 and Diameter Vulnerabilities", n.d.,
              <https://www.fcc.gov/ecfs/document/10427582404839/1>.

   [DATTACK]  DeKok, A., "CHAP and Shared Secret", n.d.,
              <https://www.ietf.org/ietf-ftp/ietf-mail-archive/
              radius/1998-11.mail>.

   [EDUROAM]  eduroam, "eduroam", n.d., <https://eduroam.org>.

   [EXPLOIT]  Agency, A. C. D., "People’s Republic of China State-
              Sponsored Cyber Actors Exploit Network Providers and
              Devices", n.d., <https://www.cisa.gov/news-events/
              cybersecurity-advisories/aa22-158a>.

   [FILTER]   Committee, J. I. S., "Filtering of Invalid Realms", n.d.,
              <https://community.jisc.ac.uk/library/janet-services-
              documentation/filtering-invalid-realms>.

   [HASHCLASH]
              Stevens, M., "Project HashClash - MD5 & SHA-1
              cryptanalytic toolbox", n.d.,
              <https://github.com/cr-marcstevens/hashclash>.

   [I-D.ietf-radext-tls-psk]
              DeKok, A., "Operational Considerations for RADIUS and TLS-
              PSK", Work in Progress, Internet-Draft, draft-ietf-radext-

DeKok                      Expires 30 May 2025                 [Page 77]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

              tls-psk-11, 17 October 2024,
              <https://datatracker.ietf.org/doc/html/draft-ietf-radext-
              tls-psk-11>.

   [I-D.josefsson-pppext-eap-tls-eap]
              Palekar, A., Josefsson, S., Simon, D., and G. Zorn,
              "Protected EAP Protocol (PEAP) Version 2", Work in
              Progress, Internet-Draft, draft-josefsson-pppext-eap-tls-
              eap-10, 21 October 2004,
              <https://datatracker.ietf.org/doc/html/draft-josefsson-
              pppext-eap-tls-eap-10>.

   [I-D.tomas-openroaming]
              Tomas, B., Grayson, M., Canpolat, N., Cockrell, B. A., and
              S. Gundavelli, "WBA OpenRoaming Wireless Federation", Work
              in Progress, Internet-Draft, draft-tomas-openroaming-03,
              25 July 2024, <https://datatracker.ietf.org/doc/html/
              draft-tomas-openroaming-03>.

   [ISSUES]   RADEXT, "Issues and Fixes 2", n.d.,
              <https://github.com/radext-wg/issues-and-fixes-2/wiki>.

   [MAY-1995] O'Dell, M., "Proxy-State radius extension to support
              stateless proxies", n.d.,
              <http://ftp.cerias.purdue.edu/pub/doc/network/radius/
              archive/ietf-radius.9506>.

   [MD5-1996] group, I. R. W., "MD5 Key recovery attack", n.d.,
              <https://www.ietf.org/ietf-ftp/ietf-mail-archive/
              radius/1998-02>.

   [OPENROAMING]
              Alliance, W. B., "OpenRoaming: One global Wi-Fi network",
              n.d., <https://wballiance.com/openroaming/>.

   [PWNED]    Hunt, T., "Have I been Pwned", n.d.,
              <https://haveibeenpwned.com/>.

   [RADEXT118]
              Alliance, W. B., "RADIUS Accounting Assurance at IETF
              118", n.d., <https://youtu.be/wwmYSItcQt0?t=3953>.

   [RFC1321]  Rivest, R., "The MD5 Message-Digest Algorithm", RFC 1321,
              DOI 10.17487/RFC1321, April 1992,
              <https://www.rfc-editor.org/rfc/rfc1321>.

DeKok                      Expires 30 May 2025                 [Page 78]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   [RFC2194]  Aboba, B., Lu, J., Alsop, J., Ding, J., and W. Wang,
              "Review of Roaming Implementations", RFC 2194,
              DOI 10.17487/RFC2194, September 1997,
              <https://www.rfc-editor.org/rfc/rfc2194>.

   [RFC2433]  Zorn, G. and S. Cobb, "Microsoft PPP CHAP Extensions",
              RFC 2433, DOI 10.17487/RFC2433, October 1998,
              <https://www.rfc-editor.org/rfc/rfc2433>.

   [RFC2759]  Zorn, G., "Microsoft PPP CHAP Extensions, Version 2",
              RFC 2759, DOI 10.17487/RFC2759, January 2000,
              <https://www.rfc-editor.org/rfc/rfc2759>.

   [RFC2866]  Rigney, C., "RADIUS Accounting", RFC 2866,
              DOI 10.17487/RFC2866, June 2000,
              <https://www.rfc-editor.org/rfc/rfc2866>.

   [RFC2868]  Zorn, G., Leifer, D., Rubens, A., Shriver, J., Holdrege,
              M., and I. Goyret, "RADIUS Attributes for Tunnel Protocol
              Support", RFC 2868, DOI 10.17487/RFC2868, June 2000,
              <https://www.rfc-editor.org/rfc/rfc2868>.

   [RFC2869]  Rigney, C., Willats, W., and P. Calhoun, "RADIUS
              Extensions", RFC 2869, DOI 10.17487/RFC2869, June 2000,
              <https://www.rfc-editor.org/rfc/rfc2869>.

   [RFC2975]  Aboba, B., Arkko, J., and D. Harrington, "Introduction to
              Accounting Management", RFC 2975, DOI 10.17487/RFC2975,
              October 2000, <https://www.rfc-editor.org/rfc/rfc2975>.

   [RFC3539]  Aboba, B. and J. Wood, "Authentication, Authorization and
              Accounting (AAA) Transport Profile", RFC 3539,
              DOI 10.17487/RFC3539, June 2003,
              <https://www.rfc-editor.org/rfc/rfc3539>.

   [RFC3579]  Aboba, B. and P. Calhoun, "RADIUS (Remote Authentication
              Dial In User Service) Support For Extensible
              Authentication Protocol (EAP)", RFC 3579,
              DOI 10.17487/RFC3579, September 2003,
              <https://www.rfc-editor.org/rfc/rfc3579>.

   [RFC3748]  Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.
              Levkowetz, Ed., "Extensible Authentication Protocol
              (EAP)", RFC 3748, DOI 10.17487/RFC3748, June 2004,
              <https://www.rfc-editor.org/rfc/rfc3748>.

DeKok                      Expires 30 May 2025                 [Page 79]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   [RFC4120]  Neuman, C., Yu, T., Hartman, S., and K. Raeburn, "The
              Kerberos Network Authentication Service (V5)", RFC 4120,
              DOI 10.17487/RFC4120, July 2005,
              <https://www.rfc-editor.org/rfc/rfc4120>.

   [RFC4372]  Adrangi, F., Lior, A., Korhonen, J., and J. Loughney,
              "Chargeable User Identity", RFC 4372,
              DOI 10.17487/RFC4372, January 2006,
              <https://www.rfc-editor.org/rfc/rfc4372>.

   [RFC5080]  Nelson, D. and A. DeKok, "Common Remote Authentication
              Dial In User Service (RADIUS) Implementation Issues and
              Suggested Fixes", RFC 5080, DOI 10.17487/RFC5080, December
              2007, <https://www.rfc-editor.org/rfc/rfc5080>.

   [RFC5176]  Chiba, M., Dommety, G., Eklund, M., Mitton, D., and B.
              Aboba, "Dynamic Authorization Extensions to Remote
              Authentication Dial In User Service (RADIUS)", RFC 5176,
              DOI 10.17487/RFC5176, January 2008,
              <https://www.rfc-editor.org/rfc/rfc5176>.

   [RFC5281]  Funk, P. and S. Blake-Wilson, "Extensible Authentication
              Protocol Tunneled Transport Layer Security Authenticated
              Protocol Version 0 (EAP-TTLSv0)", RFC 5281,
              DOI 10.17487/RFC5281, August 2008,
              <https://www.rfc-editor.org/rfc/rfc5281>.

   [RFC5580]  Tschofenig, H., Ed., Adrangi, F., Jones, M., Lior, A., and
              B. Aboba, "Carrying Location Objects in RADIUS and
              Diameter", RFC 5580, DOI 10.17487/RFC5580, August 2009,
              <https://www.rfc-editor.org/rfc/rfc5580>.

   [RFC5931]  Harkins, D. and G. Zorn, "Extensible Authentication
              Protocol (EAP) Authentication Using Only a Password",
              RFC 5931, DOI 10.17487/RFC5931, August 2010,
              <https://www.rfc-editor.org/rfc/rfc5931>.

   [RFC5997]  DeKok, A., "Use of Status-Server Packets in the Remote
              Authentication Dial In User Service (RADIUS) Protocol",
              RFC 5997, DOI 10.17487/RFC5997, August 2010,
              <https://www.rfc-editor.org/rfc/rfc5997>.

   [RFC6151]  Turner, S. and L. Chen, "Updated Security Considerations
              for the MD5 Message-Digest and the HMAC-MD5 Algorithms",
              RFC 6151, DOI 10.17487/RFC6151, March 2011,
              <https://www.rfc-editor.org/rfc/rfc6151>.

DeKok                      Expires 30 May 2025                 [Page 80]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   [RFC6218]  Zorn, G., Zhang, T., Walker, J., and J. Salowey, "Cisco
              Vendor-Specific RADIUS Attributes for the Delivery of
              Keying Material", RFC 6218, DOI 10.17487/RFC6218, April
              2011, <https://www.rfc-editor.org/rfc/rfc6218>.

   [RFC6280]  Barnes, R., Lepinski, M., Cooper, A., Morris, J.,
              Tschofenig, H., and H. Schulzrinne, "An Architecture for
              Location and Location Privacy in Internet Applications",
              BCP 160, RFC 6280, DOI 10.17487/RFC6280, July 2011,
              <https://www.rfc-editor.org/rfc/rfc6280>.

   [RFC6613]  DeKok, A., "RADIUS over TCP", RFC 6613,
              DOI 10.17487/RFC6613, May 2012,
              <https://www.rfc-editor.org/rfc/rfc6613>.

   [RFC6614]  Winter, S., McCauley, M., Venaas, S., and K. Wierenga,
              "Transport Layer Security (TLS) Encryption for RADIUS",
              RFC 6614, DOI 10.17487/RFC6614, May 2012,
              <https://www.rfc-editor.org/rfc/rfc6614>.

   [RFC6733]  Fajardo, V., Ed., Arkko, J., Loughney, J., and G. Zorn,
              Ed., "Diameter Base Protocol", RFC 6733,
              DOI 10.17487/RFC6733, October 2012,
              <https://www.rfc-editor.org/rfc/rfc6733>.

   [RFC6929]  DeKok, A. and A. Lior, "Remote Authentication Dial In User
              Service (RADIUS) Protocol Extensions", RFC 6929,
              DOI 10.17487/RFC6929, April 2013,
              <https://www.rfc-editor.org/rfc/rfc6929>.

   [RFC6973]  Cooper, A., Tschofenig, H., Aboba, B., Peterson, J.,
              Morris, J., Hansen, M., and R. Smith, "Privacy
              Considerations for Internet Protocols", RFC 6973,
              DOI 10.17487/RFC6973, July 2013,
              <https://www.rfc-editor.org/rfc/rfc6973>.

   [RFC7360]  DeKok, A., "Datagram Transport Layer Security (DTLS) as a
              Transport Layer for RADIUS", RFC 7360,
              DOI 10.17487/RFC7360, September 2014,
              <https://www.rfc-editor.org/rfc/rfc7360>.

   [RFC7525]  Sheffer, Y., Holz, R., and P. Saint-Andre,
              "Recommendations for Secure Use of Transport Layer
              Security (TLS) and Datagram Transport Layer Security
              (DTLS)", RFC 7525, DOI 10.17487/RFC7525, May 2015,
              <https://www.rfc-editor.org/rfc/rfc7525>.

DeKok                      Expires 30 May 2025                 [Page 81]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   [RFC7542]  DeKok, A., "The Network Access Identifier", RFC 7542,
              DOI 10.17487/RFC7542, May 2015,
              <https://www.rfc-editor.org/rfc/rfc7542>.

   [RFC7585]  Winter, S. and M. McCauley, "Dynamic Peer Discovery for
              RADIUS/TLS and RADIUS/DTLS Based on the Network Access
              Identifier (NAI)", RFC 7585, DOI 10.17487/RFC7585, October
              2015, <https://www.rfc-editor.org/rfc/rfc7585>.

   [RFC7593]  Wierenga, K., Winter, S., and T. Wolniewicz, "The eduroam
              Architecture for Network Roaming", RFC 7593,
              DOI 10.17487/RFC7593, September 2015,
              <https://www.rfc-editor.org/rfc/rfc7593>.

   [RFC7930]  Hartman, S., "Larger Packets for RADIUS over TCP",
              RFC 7930, DOI 10.17487/RFC7930, August 2016,
              <https://www.rfc-editor.org/rfc/rfc7930>.

   [RFC8018]  Moriarty, K., Ed., Kaliski, B., and A. Rusch, "PKCS #5:
              Password-Based Cryptography Specification Version 2.1",
              RFC 8018, DOI 10.17487/RFC8018, January 2017,
              <https://www.rfc-editor.org/rfc/rfc8018>.

   [RFC8446]  Rescorla, E., "The Transport Layer Security (TLS) Protocol
              Version 1.3", RFC 8446, DOI 10.17487/RFC8446, August 2018,
              <https://www.rfc-editor.org/rfc/rfc8446>.

   [RFC8559]  DeKok, A. and J. Korhonen, "Dynamic Authorization Proxying
              in the Remote Authentication Dial-In User Service (RADIUS)
              Protocol", RFC 8559, DOI 10.17487/RFC8559, April 2019,
              <https://www.rfc-editor.org/rfc/rfc8559>.

   [RFC8907]  Dahm, T., Ota, A., Medway Gash, D.C., Carrel, D., and L.
              Grant, "The Terminal Access Controller Access-Control
              System Plus (TACACS+) Protocol", RFC 8907,
              DOI 10.17487/RFC8907, September 2020,
              <https://www.rfc-editor.org/rfc/rfc8907>.

   [RFC9190]  Preuß Mattsson, J. and M. Sethi, "EAP-TLS 1.3: Using the
              Extensible Authentication Protocol with TLS 1.3",
              RFC 9190, DOI 10.17487/RFC9190, February 2022,
              <https://www.rfc-editor.org/rfc/rfc9190>.

   [RFC9257]  Housley, R., Hoyland, J., Sethi, M., and C. A. Wood,
              "Guidance for External Pre-Shared Key (PSK) Usage in TLS",
              RFC 9257, DOI 10.17487/RFC9257, July 2022,
              <https://www.rfc-editor.org/rfc/rfc9257>.

DeKok                      Expires 30 May 2025                 [Page 82]
Internet-Draft         Deprecating Insecure RADIUS         November 2024

   [SPOOFING] Cudbard-Bell, A., "Wi-Fi Spoofing for Fun and Profit",
              n.d., <https://networkradius.com/articles/2021/08/04/wifi-
              spoofing.html>.

   [WBA]      Alliance, W. B., "RADIUS Accounting Assurance", n.d.,
              <https://wballiance.com/radius-accounting-assurance/>.

   [WIFILOC]  Alliance, W.-F., "Accurate indoor location with Wi-Fi
              connectivity", n.d.,
              <https://www.wi-fi.org/discover-wi-fi/wi-fi-location>.

Author's Address

   Alan DeKok
   InkBridge Networks
   Email: aland@inkbridgenetworks.com

DeKok                      Expires 30 May 2025                 [Page 83]

```

[IETF](https://www.ietf.org/)
[IESG](https://www.ietf.org/iesg/)
[IAB](https://www.iab.org/)
[IRTF](https://www.irtf.org/)
[IETF LLC](https://www.ietf.org/llc/)
[IETF Trust](https://trustee.ietf.org/)
[RFC Editor](https://www.rfc-editor.org/)
[IANA](https://www.iana.org/)
[Privacy Statement](https://www.ietf.org/privacy-statement/)
[About IETF Datatracker](/release/about)
[Version 12.32.0
(release - 2c04f36)](https://github.com/ietf-tools/datatracker/releases/tag/12.32.0)

[System Status](https://status.ietf.org)

Report a bug:
[GitHub](https://github.com/ietf-tools/datatracker/issues/new/choose)
Email

![](//analytics.ietf.org/piwik.php?idsite=7)



=== Content from networkradius.com_5e9262f9_20250111_035527.html ===


InkBridge Networks - A new name for Network RADIUS

[![InkBridge Networks](/web/image/website/1/logo/InkBridge%20Networks?unique=aa4f9cc)](/)

* Services
  + [Consulting](https://networkradius.com/consulting/overview/)
  + [Training](https://networkradius.com/consulting/training/)
* [Support](/support)
* Industries
  + [Overview](/industries/overview)
  + [ISPs/Telcos](/industries/isps-and-telcos)
  + [Universities](/industries/universities)
  + [Enterprises](/industries/enterprise)
  + [OEM](/industries/oem)
* BlastRADIUS
  + [BlastRADIUS](/blastradius)
  + [BlastRADIUS Information Sessions](/blastradius-information-sessions)
* Resources
  + [Blog](/blog)
  + [FAQs](/faqs)
* [Contact Us](/contactus)
* [About Us](/about-us)

* +1 555-555-5556

[![InkBridge Networks](/web/image/website/1/logo/InkBridge%20Networks?unique=aa4f9cc)](/)

+ Services
  - [Consulting](https://networkradius.com/consulting/overview/)
  - [Training](https://networkradius.com/consulting/training/)
+ [Support](/support)
+ Industries
  - [Overview](/industries/overview)
  - [ISPs/Telcos](/industries/isps-and-telcos)
  - [Universities](/industries/universities)
  - [Enterprises](/industries/enterprise)
  - [OEM](/industries/oem)
+ BlastRADIUS
  - [BlastRADIUS](/blastradius)
  - [BlastRADIUS Information Sessions](/blastradius-information-sessions)
+ Resources
  - [Blog](/blog)
  - [FAQs](/faqs)
+ [Contact Us](/contactus)
+ [About Us](/about-us)

* +1 555-555-5556

# BlastRADIUS Resource Hub

Upgrade the World

## We fixed BlastRADIUS

All RADIUS vendors have used our [vendor guide](/web/content/2557?unique=47be02c8aed46c53b0765db185320249ad873d95) to upgrade their products. These changes will be added to the RADIUS standards, and mandated as new behavior for all RADIUS implementations.

For everyone else who has questions about the issue, we have a [FAQ.](/blastradius/faq)

We have developed a comprehensive set of documentation and verification tools which help ISPs, Telcos, and enterprises  to protect themselves from the BlastRADIUS vulnerability.

Use our tools to upgrade your systems quickly, efficiently, and with minimal risk.

[**Buy BlastRADIUS Test Tools**](https://inkbridgenetworks.myshopify.com/)

![](/web/image/2329-02398b39/two_hands_holding_gift%20-%20blue%20.webp)

### Free Resources

* Our [BlastRADIUS FAQ](/blastradius/faq)
* The cryptographic paper describing the attack can be found at
  <http://blastradius.fail>
* Our
  [IETF document for updating RADIUS standards](https://datatracker.ietf.org/doc/draft-ietf-radext-deprecating-radius/) to deprecate insecure practices.
* If you are a RADIUS product vendor, download our [vendor guide](/web/content/2557?unique=47be02c8aed46c53b0765db185320249ad873d95).    All vendors have used this guide to update their products.
* The [first section of our step-by-step upgrade guide](/web/content/2582?unique=367013f1b12fab0e275ce3cae0a8cb8b59b5867c&download=true) is available for download without any registration.

## Our BlastRADIUS product suite

### BlastRADIUS upgrade guide and worksheet

This document and accompanying Excel spreadsheet explains exactly which steps to take, and in what order.  Even better, it explains
*why* to take these steps, and
*how* to verify that the systems are working correctly at each step. It is **vendor neutral**, and will help you upgrade  RADIUS clients and servers from any vendor.

Don't create "ad hoc" local solutions based on an incomplete understanding of the issue. Instead, follow the guide created by the experts who solved the issue.

It is provided as a "zip" download.

[BUY NOW
![](/web/image/859-87224cc1/green-arrow.svg)](https://inkbridgenetworks.myshopify.com/products/blastradius-upgrade-documentation)

![](/web/image/2343-06de1ef5/close_up_checklist%20-%20blue%20-%20900x600.webp)

![](/web/image/2580-2c85a6a9/metal_toolbox-blue%20-%20900x600.webp)

### BlastRADIUS Verification tool

[Use this to verify that systems have been upgraded by](/web/image/2628-ef16f165/analyze.webp) analyzing packet captures, or by testing RADIUS servers directly.  It includes the above BlastRADIUS Upgrade Guide and worksheet.
This software runs on Windows, OSX, or Linux.

[BUY NOW![](/web/image/859-87224cc1/green-arrow.svg)](https://inkbridgenetworks.myshopify.com/products/blastradius-documentation-and-test-tool)

### Verification tool with support

In addition to the verification tool and worksheets, we will also provide 3 months of Q&A support for questions about the vulnerability and using the tools.  Some limitations apply.

[LEARN MORE
![](/web/image/859-87224cc1/green-arrow.svg)](https://inkbridgenetworks.myshopify.com/products/blastradius-documentation-test-tool-and-emergency-support)

![](/web/image/2347-88190fd9/man_holding_toolbox-blue%20-%20900x600.webp)

![](/web/image/2344-177faa6d/smiling_customer_support_man_2-%20blue%20-%20900x600.webp)

### BlastRADIUS Suite with review

We will provide 6 months of support for the tools and documentation, along with some engineering time  to review documents, perform training, etc.  Some limitations apply.

[LEARN MORE
![](/web/image/859-87224cc1/green-arrow.svg)](https://inkbridgenetworks.myshopify.com/products/blastradius-documentation-test-tool-and-enhanced-support)

#### We won’t fill your inbox with self-serving marketing fluff

Our newsletter serves up best practices, how-to guides, and answers to common questions we encounter in the networking community.

SIGN UP
Thanks

#####

[Industries](/industries/overview)

[Services](https://networkradius.com/consulting/overview/)

[Support](/support)

[About Us](/about-us)

[Blog](/blog)

[Careers](/careers)

[Contact Us](/contactus)

[Press & Media](/press-and-media-2)

100 Centrepointe Dr, Suite 200

Ottawa, ON K2G 6B1

Canada

TEL +1 (613) 454-5037

FAX +1 (613) 800-0322

info@inkbridgenetworks.com

[![InkBridge Networks Twitter Account](/web/image/1434-ca6308f3/twitter-x-hover-final1.svg)](https://x.com/InkbridgeNtwrks)[![Mancala Network Youtube Account](/web/image/1212-cf8ea679/youtube.svg)](https://www.youtube.com/%40MancalaNetworks-dm5ub)[![Linkedin page](/web/image/2610-d77e10ac/linkedin.svg)](https://www.linkedin.com/company/inkbridge-networks/)

[Privacy Policy](/privacy-policy) |
[Terms of Service](/terms-and-conditions)

© 2024 InkBridge Networks

Powered by
[![Odoo](/web/static/img/odoo_logo_tiny.png)](http://www.odoo.com?utm_source=db&utm_medium=website)
-
Create a [free website](http://www.odoo.com/app/website?utm_source=db&utm_medium=website)



=== Content from www.blastradius.fail_5b109656_20250111_035530.html ===


Toggle navigation

[![](/img/Blast-RADIUS/Blast-RADIUS_1_transparent_reduced_width.png)](/#page-top)

* [overview](#abstract)
* [Paper](#paper)
* [Mitigation](#mitigation)
* [FAQ](#questions)
* [Research Team](#contact)
* [Attack Details](/attack-details)
* [Coverage](/coverage.html)

#

---

Blast-RADIUS is a vulnerability that affects the RADIUS protocol.
RADIUS is a very common protocol used for authentication,
authorization, and accounting (AAA) for networked devices on
enterprise and telecommunication networks.

### What can the attacker do?

The Blast-RADIUS attack allows a man-in-the-middle attacker between
the RADIUS client and server to forge a valid protocol accept message
in response to a failed authentication request. This forgery could
give the attacker access to network devices and services without the
attacker guessing or brute forcing passwords or shared secrets. The
attacker does not learn user credentials.

### Who is affected?

Blast-RADIUS is a protocol vulnerability, and thus affects all
RADIUS implementations using non-EAP authentication methods over UDP.

System administrators of networks using RADIUS should check with
vendors for a patch against this vulnerability, and follow best
practices for RADIUS configuration as discussed below. There is
nothing that end users can do on their own to protect against this
attack.

RADIUS is used in a wide variety of applications, including in
enterprise networks to authenticate access to switches and other
routing infrastructure, for VPN access, by ISPs for DSL and FTTH
(Fiber to the Home), in 802.1X and Wi-Fi authentication, 2G and 3G
cellular roaming and 5G DNN (Data Network Name) authentication, mobile
Wi-Fi offload with SIM card-based authentication, private APN
authentication, to authenticate access to critical infrastructure, and
in the Eduroam and OpenRoaming wifi consortia.

### What is the vulnerability?

The RADIUS protocol predates modern cryptographic guarantees and is
typically unencrypted and unauthenticated. However, the protocol does
attempt to authenticate server responses using an ad hoc construction
based on the MD5 hash function and a fixed shared secret between a
client and server.

Our attack combines a novel protocol vulnerability with an MD5
chosen-prefix collision attack and several new speed and space
improvements. The attacker injects a malicious attribute into a
request that causes a collision between the authentication information
in the valid server response and the attacker’s desired forgery.
This allows the attacker to turn a reject into an accept, and
add arbitrary protocol attributes.

[in-depth attack description](/attack-details)

## Paper

---

**[RADIUS/UDP considered harmful](pdf/radius.pdf)**

Sharon Goldberg, Miro Haller, Nadia Heninger, Mike Milano, Dan Shumow, Marc Stevens, and Adam Suhl.

*To appear at USENIX Security 2024.*

## Mitigation

---

Network administrators and vendors should follow the guidance given in this [white paper](https://www.inkbridgenetworks.com/blastradius) authored by Alan DeKok of FreeRADIUS.

Our recommended short-term mitigation for implementers and vendors is to mandate that clients and servers always send and require `Message-Authenticator` attributes for *all* requests and responses. For `Access-Accept` or `Access-Reject` responses, the `Message-Authenticator` should be included as the *first* attribute. Patches implementing this mitigation have been implemented by all RADIUS implementations that we are aware of. This guidance is being put into an upcoming [RADIUS RFC](https://datatracker.ietf.org/doc/draft-ietf-radext-deprecating-radius/).

The long-term mitigation is to use RADIUS inside of an encrypted and authenticated channel that offers modern cryptographic security guarantees. The IETF has begun work to standardize [RADIUS over (D)TLS](https://datatracker.ietf.org/doc/draft-ietf-radext-radiusdtls-bis/).

## Q & A

---

#### What should I do about this issue?

If you are an end user, there is nothing that you can or should do.

If you are a system administrator, then consider the following questions:

1. Is all RADIUS traffic accounting, and only accounting? Our attack does not seem to be practical in that setting. You should still upgrade everything, but you can take your time.
2. Are all Access-Request packets sent over RADIUS/TLS (RadSec)? The TLS should protect against our attack. You should still upgrade everything, but you can take your time.
3. Are your RADIUS servers only doing EAP authentication, and no other kinds of authentication? Our attack does not seem to be practical in that setting. You should still upgrade everything, but you can take your time.
4. Are the RADIUS servers only handling local requests? That is, no RADIUS servers in your network are doing proxying? Upgrade your RADIUS servers first. All server vendors have deployed a mitigation that includes a Message-Authenticator attribute as the first attribute of every response, which we believe mitigates our attack. You should still upgrade your NAS equipment/RADIUS clients, but this is less critical than updating servers immediately.
5. For everyone else, you should upgrade your RADIUS servers immediately, then upgrade clients/NAS equipment where possible, and set the configuration flags on both sides to require Message-Authenticator attributes. The specific configuration is vendor-specific and you will need to consult your RADIUS vendor.

You can find other FAQs on the upgrade process [here](https://www.inkbridgenetworks.com/blastradius/faq).

#### What is the CVE number?

CERT/CC coordinated our disclosure and has assigned [CVE-2024-3596](https://www.cve.org/CVERecord?id=CVE-2024-3596) and [VU#456537](https://kb.cert.org/vuls/id/456537) to this vulnerability.

#### Is attack code available?

A script with an example collision is available [here](/example.py).
The `--verbose` option allows the printing of unshortened values.
The script goes through the attack step by step:

1. The Access-Request sent by the RADIUS client, from which the adversary learns the Request Authenticator and IDs.
2. The MITM uses these values from the Access-Request to predict Accept and Reject prefixes and then computes the collision gibberish that it computes for these prefixes.
3. The MITM assembles the Access-Request with that Reject gibberish appended, that is sent to the RADIUS server.
4. The Access-Reject sent back by the server contains the Response Authenticator.
5. The MITM puts this value to assemble the Access-Accept.
6. We show both the Access-Accept and Access-Reject both produce the same Response Authenticator.

We are not publishing end-to-end attack code. Our improvements to the
MD5 chosen-prefix collision attack are available in the [hashclash
GitHub
repository](https://github.com/cr-marcstevens/hashclash/pull/37).

If you are a vendor or system administrator who wishes to test for this vulnerability, a
RADIUS server implementation is vulnerable if it does not require a
Message-Authenticator attribute in every client request. A RADIUS
client is vulnerable if it does not require a Message-Authenticator
attribute from every server response. See [Alan DeKok’s white
paper](https://www.inkbridgenetworks.com/blastradius)
for more information.

#### Hasn't MD5 been broken for 20 years? How is this attack new?

Our attack is more complex than simply applying an old MD5 collision attack.

While an MD5 hash collision was first demonstrated in 2004, it was not
thought to be possible to exploit this in the context of the RADIUS
protocol. Our attack identifies a protocol vulnerability in the way
RADIUS uses MD5 that allows the attacker to inject a malicious
protocol attribute that produces a hash collision between the
server-generated Response Authenticator and the attacker’s desired
forged response packet.

In addition, because our attack is online, the attacker needs to be
able to compute a so-called chosen-prefix MD5 collision attack in minutes
or seconds. The previous best reported chosen-prefix collision attack
times took hours, and produced collisions that were not compatible with the RADIUS
protocol.

We introduce several improvements in speed, space, and scaling for the
existing MD5 attacks to demonstrate that these collisions can be
computed in at most minutes and can fit within RADIUS protocol
attributes.

#### Is your attack practical?

Yes and no. In the proof-of-concept attacks described in our paper,
it took us 3 to 6 minutes to compute the MD5 chosen-prefix hash collision
required for the attack. This is longer than the 30- to 60-second
timeouts that are commonly used in practice for RADIUS.

However, every step of the collision algorithm parallelizes well and
is amenable to hardware optimization, so we expect a well-resourced
attacker could obtain running times that are tens or hundreds of times faster
by implementing the attack on GPUs, FPGAs, or hardware.

Our reported running times are from optimizing some 15 year old code
and running it on a bunch of 7 to 10 year old CPUs, because this is
what we have access to. We did not think that spending further
engineering effort to make MD5 collisions faster was a good use of
time when MD5 should have been abolished 20 years ago.

#### What is the threat model for this attack? Who can run it?

Our attack requires the adversary to have network access to act as a man-in-the-middle attacker on the connection between the victim device’s RADIUS client and RADIUS server. When there are proxies, the attack can occur between any hop.
Our attacker will need to be able to act as a full network man-in-the-middle who can read, intercept, block, and modify inbound and outbound network packets.

Such access to RADIUS traffic may happen through different mechanisms. Although sending RADIUS/UDP over the open internet is discouraged, this is still known to [happen](https://www.ietf.org/archive/id/draft-ietf-radext-deprecating-radius-01.html) [in practice](https://www.rfc-editor.org/rfc/rfc6614). For internal network traffic, the attacker might initially compromise part of an enterprise network; such compromises appear frequently in [news reports](https://www.404media.co/cyber-official-speaks-out-reveals-mobile-network-attacks-in-u-s/) and [security advisories](https://www.cisa.gov/sites/default/files/2023-01/ar-16-20173.pdf). Even if RADIUS traffic is confined to a protected part of an internal network, configuration or routing mistakes might unintentionally expose this traffic. An attacker with partial network access may be able to [exploit DHCP or other mechanisms to cause victim devices to send traffic outside of a dedicated VPN](https://www.leviathansecurity.com/blog/tunnelvision).

Our adversary does not know the shared secret between the RADIUS client and server.

#### Our RADIUS traffic is in a separate VLAN; are we secure against this attack?

A current best practice for RADIUS/UDP traffic is to expose it only to a restricted-access management VLAN within an organization. While this reduces the attack surface and is certainly preferable to exposing UDP traffic to a broader network or the open internet, there may still be vulnerabilities in case of a network misconfiguration or attacker compromise of this portion of the network.

This approach is also at odds with the US Executive Branch Office of Management and Budget’s [2022 memo](https://www.whitehouse.gov/wp-content/uploads/2022/01/M-22-09.pdf), which envisions moving to systems that do not rely on network separation for security: “A key tenet of a zero trust architecture is that no network is implicitly considered trusted”.

#### Who is affected by these vulnerabilities?

Nearly all RADIUS/UDP implementations are vulnerable to our protocol attack when using non-EAP authentication methods. RADIUS is used by many organizations to control access to a wide variety of network devices and services. Our attack requires man-in-the-middle network access; organizations should evaluate their own network security threat model.

RADIUS implementers, vendors, and system administrators should follow [best practices](https://datatracker.ietf.org/doc/draft-ietf-radext-deprecating-radius/) and [the guidance in this document](https://www.inkbridgenetworks.com/blastradius). Our attack does not compromise end user credentials, and there is nothing that end users can do to protect against this attack.

EAP authentication methods are protected against our attack because [RFC 2869](https://datatracker.ietf.org/doc/html/rfc2869) mandates that a `Message-Authenticator` attribute must be present, and this attribute is an HMAC-MD5 over the entire packet that we cannot forge. A theoretical protocol vulnerability appears to exist, but may not be practically exploitable. RADIUS Accounting also appears to be affected by a theoretical protocol vulnerability that seems to be difficult to exploit in practice.

#### What is the impact of your attacks?

An adversary exploiting our attack can escalate privileges from partial network access to being able to log into any device that uses RADIUS for authentication, or to assign itself arbitrary network privileges.

RADIUS is used for remote access for diverse use cases including network routers and switches, industrial control systems, VPNs, ISPs using DSL or FTTH, Linux Pluggable Authentication Modules, 2G and 3G cellular roaming and 5G DNN authentication, and mobile Wi-Fi offload with SIM card-based authentication.

#### Can I detect whether this attack was run on my network?

Yes, but you need log files of `Access-Rejects` on the RADIUS server and `Access-Accepts` on the RADIUS client.

If you have detailed log files on the RADIUS client that log the values of all attributes, you could look for suspicious `Proxy-State` attributes. If there are `Access-Accept` packets with `Proxy-State` attributes consisting of random bytes, then this might be a sign of an attack. End clients should not receive packets with `Proxy-State` attributes.

To confirm an attack, you need would need to find the corresponding `Access-Reject` (or any other type) response packet in the RADIUS server logs, and verify that the server’s response differs from the response received by the client, and that both contain valid `Response Authenticator` values for the request ID and `Request Authenticator`.

If both of these packets produce the same MD5 hash in the `Response Authenticator`, this issue was exploited in your system.

#### How can we mitigate this attack in our system?

We recommend reading the [detailed guide for implementors](https://www.inkbridgenetworks.com/blastradius) published by Alan DeKok, the maintainer of FreeRADIUS.

Patches including the short-term mitigation described in the [mitigation section](#mitigation) will be available from major RADIUS implementations in coordinated release with this work; downstream vendors and network operators should check for and apply these patches. Where an option exists to require a `Message-Authenticator` attribute on all packets, this option should be enabled.

Implementers, vendors, and admins should follow the guidance in this [IETF draft to deprecate insecure practices in RADIUS](https://datatracker.ietf.org/doc/draft-ietf-radext-deprecating-radius/) to mitigate numerous other attacks; we expect future versions to mandate `Message-Authenticator` attributes in more settings.

The long-term mitigation for our attack is to use RADIUS inside of a modern cryptographically protected transport like TLS 1.3. The IETF RADEXT working group has existing [drafts in progress outlining RADIUS/(D)TLS](https://datatracker.ietf.org/doc/draft-ietf-radext-radiusdtls-bis/00/).

#### Are your recommended mitigations backward compatible?

It depends.

Including a `Message-Authenticator` attribute in every packet is backward compatible. Unfortunately, requiring the presence of a `Message-Authenticator` attribute in requests and responses may not be backward compatible with old client or server implementations that do not have the option to include them.

Our long-term mitigation of moving to RADIUS/TLS requires clients and servers that support TLS, as well as new configuration (like PKI) on the part of network operators. TLS may not be supported at all on older hardware.

#### I have a different idea for a mitigation that I think works better.

A number of tempting, commonly suggested countermeasures do not sufficiently mitigate the vulnerability.

### Decreasing Timeouts

It is tempting to hope that simply setting a shorter client timeout would mitigate our attack. We believe this should not be done: it decreases usability and does not protect against our attack.

Our MD5 collisions were computed after applying some optimizations to a 15-year-old proof-of-concept codebase, which we are running on CPUs mostly dating from seven to ten years ago, because these are the resources we have access to. An adversary with a budget for professional engineering would be able to decrease the computational cost of the collision by a factor of tens to hundreds.

The most common timeout in practice is 30 seconds, and 60 seconds is commonly recommended when multifactor authentication is involved, since shorter timeouts could be problematic for real users.

### Using TACACS+ or Diameter

RADIUS is not the only protocol to suffer from the types of security issues that we outline. TACACS+ is a popular (TCP-based) administrator login protocol for switches that also does not meet modern cryptographic security standards. [RFC 8907](https://www.rfc-editor.org/info/rfc8907) was published in September 2020, and explicitly mandates that TACACS+ be used with a secure transport.
However, much like RADIUS, TACACS+ is still most commonly used over insecure transports.

Diameter ([RFC 6733](https://www.rfc-editor.org/info/rfc6733)) was initially designed as a successor to RADIUS, although it never replaced RADIUS for many common use cases. It is used in 3G+ networks, and is generally only supported in large NAS equipment used by bigger ISPs and telecommunications providers; consumer or enterprise-grade equipment typically only supports RADIUS.

### Random shared secrets

Organizations can protect against dictionary attacks on the shared secret by picking random shared secrets of sufficient length, as the runtime of such an attack grows exponentially with the entropy of the secret. For example, [this work-in-progress IETF draft](https://datatracker.ietf.org/doc/draft-ietf-radext-deprecating-radius/00/) recommends shared secrets with at least 96 bits of entropy, so an offline dictionary attack would involve on the order of \(2^{96}\) MD5 compressions. However, as our attack does not try to brute force the shared secret, choosing a strong shared secret does not affect the runtime of our attack.

### Using Multi-Factor Authentication (MFA)

Using MFA or 2FA is not a mitigation either. Our attack largely bypasses the user authentication mechanism, and forges the accept response from the server’s reject. MFA may be supported through multiple mechanisms within the RADIUS protocol, including authentication protocols like PAP that are vulnerable by default to our attack.

### Rejecting Proxy-States

Our forged Access-Accept packets contain `Proxy-State` attributes that the client is not expecting. However, having the client discard packets with unexpected `Proxy-States` does not mitigate the vulnerability. First, such a mitigation would only apply to a NAS; the `Proxy-State` attribute is actually used by RADIUS server proxies and thus difficult to remove without breaking functionality.

Even if NAS clients rejected unexpected `Proxy-State` attributes, it would be possible to craft colliding packets where the `Access-Accept` has the collision gibberish in a different attribute such as `Vendor-Specific` or `Reply-Message` that is likely to be accepted; the client does not need to support or attempt to interpret the garbage attribute to be vulnerable.

The colliding `Access-Reject` packet would still use `Proxy-State` attributes, as the server is guaranteed to include `Proxy-State` attributes unchanged in an `Access-Reject`.
For simplicity our implementation uses `Proxy-States` in both colliding packets, as no RADIUS client we tested complained about the unexpected `Proxy-State`.

### Replacing MD5

It is tempting to think that simply replacing MD5 in the `Response Authenticator` with a secure hash function like SHA-2 or SHA-3 might be a short-term mitigation against our attacks. However, since the RADIUS protocol does not provide for any cryptographic agility, such a change would be incompatible with all existing implementations, and thus be equivalent to requiring a new protocol. Given the other security and privacy concerns with the rest of RADIUS, it would be better at that point to redesign the entire protocol or transport.

#### Is using RADIUS with EAP-TLS the same as RADIUS/TLS? Is EAP-TLS vulnerable?

EAP-TLS is not the same as RADIUS/TLS. EAP-TLS uses a TLS handshake to carry out certificate-based authentication, but does not use TLS to encrypt the RADIUS access request and response packets, which are still transmitted over UDP in the clear. This is different from RADIUS/TLS, which transmits all RADIUS packets inside of an encrypted TLS session.

In more detail, when EAP (Extensible Authentication Protocol) is used for authentication within RADIUS, the client NAS sends a RADIUS `Access-Request` packet to the RADIUS server that contains a RADIUS attribute called `EAP-Message`. For RADIUS/UDP, this `Access-Request` is sent in the clear via UDP. The authenticating peer and server then authenticate using the requested EAP method: for EAP-TLS, they use certificates to complete a TLS handshake. After the end of the EAP authentication process, the server completes the RADIUS conversation by sending a RADIUS `Access-Accept` or `Access-Reject` packet; for RADIUS/UDP this packet is again sent in the clear over UDP.

Our attack targets RADIUS access requests and responses. However, EAP-TLS does not appear to be practically exploitable by our attack because all packets containing `EAP-Message` attributes must contain a MD5-HMAC `Message-Authenticator` attribute that we cannot forge. However, a theoretical protocol attack may still be possible against RADIUS even when clients make an EAP-TLS (or other EAP) authentication request. The details and the impact of such an attack would be implementation-dependent and we have not found a practically exploitable implementation.

A more detailed explanation is in Section 5.6 of [our paper](/pdf/radius.pdf).

#### How can your attack time be further reduced?

We reduced the online running time for our MD5 chosen-prefix attack from hours down to minutes. However, this should be interpreted as a generous upper bound for the true cost of such collisions, because of the limits on our computational resources. Newer CPUs than the seven to ten year old machines we have access to would likely provide minutes of improvement, as would optimizing cache locality.

Access to more and faster GPUs for the chosen-prefix attack would reduce the time for the birthday stage and/or reduce the number of near-collision blocks, reducing time for the near-collision stage.

Reimplementing hashclash in hardware, for example on FPGAs (Field Programmable Gate Arrays) or ASICs (Application-Specific Integrated Circuits) would likely improve the running time by a factor of ten to a hundred.

It would be eminently feasible to run this attack on cloud resources. Amazon EC2 lists the on-demand price of a `c7a.48xlarge` instance with 192 vCPUs at $9.85/hour, and the price of a `g6.48xlarge` instance with 192 vCPUs and 8 NVIDIA L4 GPUs at $13.35/hour. It would cost around $50/hour to exceed our computing capacity, and in principle one could scale to many more machines.

#### How many RADIUS deployments are vulnerable to this attack?

Unfortunately, we are not able to use network scanning to provide a representative picture of RADIUS deployments. Many RADIUS servers will be on internal networks. Even for external-facing servers, RADIUS hosts are identified by IP address and servers only accept packets from allowed addresses. The RADIUS RFC specifies that servers should drop requests for hosts that they have not been pre-configured to have a shared secret with. Our scanning host would not be whitelisted by properly configured servers, so an internet-wide scan would thus only turn up misconfigured servers. Additionally, since it is a UDP-based protocol with no handshake before a login request, we cannot do TCP SYN scanning and would need to scan using a well-formed UDP `Access-Request`, which would appear as an attack to network administrators.

This does not affect the adversary in our attack model, who intercepts traffic between a legitimate client and server.

However, since this vulnerability is in the protocol, nearly all RADIUS/UDP implementations are vulnerable to our attack **when using non-EAP authentication methods**.

#### Do you have a logo for your attack?

Of course! Various versions with transparent, white, and black background are available [here](/img/Blast-RADIUS.zip).

## Research Team

---

This research was conducted by

* [Sharon Goldberg](https://www.bu.edu/cs/profiles/sharon-goldberg/) (Boston University and Cloudflare),
* [Miro Haller](https://mirohaller.com) (University of California, San Diego),
* [Nadia Heninger](https://cseweb.ucsd.edu/~nadiah/) (University of California, San Diego),
* Mike Milano (BastionZero),
* [Dan Shumow](https://www.microsoft.com/en-us/research/people/danshu/) (Microsoft Research),
* [Marc Stevens](https://marc-stevens.nl/research/) (Centrum Wiskunde & Informatica), and
* [Adam Suhl](https://cseweb.ucsd.edu/~asuhl/) (University of California, San Diego)

You can email us at blast.radius.attack@gmail.com



=== Content from today.ucsd.edu_a8385e7c_20250111_035530.html ===


[Skip to main content](#content "Skip to main content")

Menu

* [UC San Diego](https://www.ucsd.edu/ "UC San Diego")

[![UC San Diego - Today](/build/assets/img/global-nav/ucsd-today-logo.svg)](/)

[Subscribe](/newsletter/#subscribe)

![Magnifying glass icon](/build/assets/img/global-nav/search-icon.svg)

* [Research](https://today.ucsd.edu/research "Research")
* [People](https://today.ucsd.edu/people "People")
* [Campus & Community](https://today.ucsd.edu/campus-and-community "Research")
* [Arts & Culture](https://today.ucsd.edu/arts-and-culture "Research")
* [Voices](https://today.ucsd.edu/voices "Research")

# Computer Scientists Discover Vulnerabilities in a Popular Security Protocol

## Story by:

* [Katie E. Ismael](https://today.ucsd.edu/archives/author/Katie_E._Ismael)
  -
  kismael@ucsd.edu

## Published Date

August 20, 2024

## Story by:

* [Katie E. Ismael](https://today.ucsd.edu/archives/author/Katie_E._Ismael)
  -
  kismael@ucsd.edu

## Share This:

* [![Twitter](/build/assets/img/social/twitter-share.svg)](http://twitter.com/share?text=Computer Scientists Discover Vulnerabilities in a Popular Security Protocol&url=https://today.ucsd.edu/story/computer-scientists-discover-vulnerabilities-in-a-popular-security-protocol)
* [![Facebook](/build/assets/img/social/facebook-share.svg)](http://www.facebook.com/sharer.php?u=https://today.ucsd.edu/story/computer-scientists-discover-vulnerabilities-in-a-popular-security-protocol)
* [![LinkedIn](/build/assets/img/social/linkedin-share.svg)](https://www.linkedin.com/sharing/share-offsite/?url=https://today.ucsd.edu/story/computer-scientists-discover-vulnerabilities-in-a-popular-security-protocol)
* ![Email](/build/assets/img/social/email-share.svg)

## Article Content

A widely used security protocol that dates back to the days of dial-up Internet has vulnerabilities that could expose large numbers of networked devices to an attack and allow an attacker to gain control of traffic on an organization's network.

A research team led by University of California San Diego computer scientists investigated the Remote Authentication Dial-In User Service (RADIUS) protocol and found a vulnerability they call [Blast-RADIUS](https://www.blastradius.fail/coverage.html) that has been present for decades. RADIUS, designed in 1991, allows networked devices such as routers, switches or mobile roaming gear to use a remote server to validate login or other credentials.

This is a common set-up in enterprise and telecommunications networks because it allows credentials to be centrally managed. As a result, RADIUS is a critical part of modern telecommunications and enterprise networks; in large enterprises, it may control access to tens of thousands of switches.

Authors of the paper [“RADIUS/UDP Considered Harmful”](https://www.blastradius.fail/pdf/radius.pdf) include researchers from Cloudfare, Centrum Wiskunde & Informatica, BastiionZero and Microsoft Research. It was presented last week at the USENIX Security 2024 conference.

“This is among the largest and most complex vulnerability disclosure processes that we have been involved in, “ said Nadia Heninger, a professor in the Jacobs School of Engineering Department of Computer Science and Engineering. “Given how widely this protocol is used, it is surprising that it has received almost no formal security analysis in the academic cryptography and security communities.”

Heninger notes the large gap that existed between those who deploy these protocols and those who study them.

The researchers discovered the ability for a “man in the middle” to attack communication between a RADIUS client (or the victim’s networked device) and RADIUS server to forge a valid protocol accept message in response to a fake login or authentication request. This could give an attacker administrative access to networked devices and services without requiring an attacker to guess or “brute force” passwords.

The root of this vulnerability stems from the fact RADIUS was developed before proper cryptographic protocol design was well understood, the authors say. It uses an authentication check based on an ad hoc and insecure construction based on the MD5 hash function, which has been known to be broken for two decades.

![Blast RADIUS logo ]()

Computer scientists have found a vulnerability they call [Blast-RADIUS](https://www.blastradius.fail/#abstract) that has been present for decades.

![RADIUS attack flow]()

The Blast-RADIUS attack flow. More than 90 vendors have been involved in a coordinated disclosure and issued security bulletins.

However, the RADIUS protocol was not updated when MD5 was broken in 2004, the authors note. Before their work, the maintainers of the protocol standards defining RADIUS thought that the MD5-based construction used in RADIUS was still secure.

Vendors have released patches that implement the authors’ recommended short-term mitigation for this vulnerability. System administrators should check for patches for protocols they use with RADIUS and apply the updated configuration options suggested by their vendors

The authors have disclosed their findings (security advisories CVE-2024-3596 and [VU#456537](https://kb.cert.org/vuls/id/456537)) and more than 90 vendors have been involved in a coordinated disclosure and issued security bulletins.

The research team includes Heninger, Miro Haller and Adam Suhl of UC San DIego; Sharon Goldberg of Cloudfare; Mike Milano of BastionZero; Dan Shumow of Microsoft Research; and Marc Stevens of Centrum Wiskunde & Informatica.

## Share This:

* [![Twitter](/build/assets/img/social/twitter-share.svg)](http://twitter.com/share?text=Computer Scientists Discover Vulnerabilities in a Popular Security Protocol&url=https://today.ucsd.edu/story/computer-scientists-discover-vulnerabilities-in-a-popular-security-protocol)
* [![Facebook](/build/assets/img/social/facebook-share.svg)](http://www.facebook.com/sharer.php?u=https://today.ucsd.edu/story/computer-scientists-discover-vulnerabilities-in-a-popular-security-protocol)
* [![LinkedIn](/build/assets/img/social/linkedin-share.svg)](https://www.linkedin.com/sharing/share-offsite/?url=https://today.ucsd.edu/story/computer-scientists-discover-vulnerabilities-in-a-popular-security-protocol)
* ![Email](/build/assets/img/social/email-share.svg)

## You May Also Like

### [Solving Engineering Challenges to Make Fusion a Viable Clean Energy Source](https://today.ucsd.edu/story/nuclear-fusion-could-one-day-be-a-viable-clean-energy-source-but-big-engineering-challenges-stand-in-the-way)

[Technology & Engineering](https://today.ucsd.edu/research/technology-and-engineering)

[Solving Engineering Challenges to Make Fusion a Viable Clean Energy Source
![Solving Engineering Challenges to Make Fusion a Viable Clean Energy Source]()](https://today.ucsd.edu/story/nuclear-fusion-could-one-day-be-a-viable-clean-energy-source-but-big-engineering-challenges-stand-in-the-way)

[### UC San Diego Health First to Offer Novel Gene Therapy for Hemophilia B](https://today.ucsd.edu/story/uc-san-diego-health-first-to-offer-novel-gene-therapy-for-hemophilia-b)
[Health & Behavior](https://today.ucsd.edu/research/health-and-behavior)

[Concept photo of DNA double helix
![UC San Diego Health First to Offer Novel Gene Therapy for Hemophilia B]()](https://today.ucsd.edu/story/uc-san-diego-health-first-to-offer-novel-gene-therapy-for-hemophilia-b)

[### Uncovering Clues to a Natural Gene-Editing Technique](https://today.ucsd.edu/story/uncovering-natural-gene-editing-technique)
[Science & Environment](https://today.ucsd.edu/research/science-and-environment)

[Uncovering Clues to a Natural Gene-Editing Technique
![Uncovering Clues to a Natural Gene-Editing Technique]()](https://today.ucsd.edu/story/uncovering-natural-gene-editing-technique)

[### Scientists Uncover Key Step in How Diazotrophs “Fix” Nitrogen](https://today.ucsd.edu/story/how-diazotrophs-fix-nitrogen)
[Science & Environment](https://today.ucsd.edu/research/science-and-environment)

[rows of turmeric crops growing
![Scientists Uncover Key Step in How Diazotrophs “Fix” Nitrogen]()](https://today.ucsd.edu/story/how-diazotrophs-fix-nitrogen)

[### UC San Diego Health First to Offer Novel Gene Therapy for Hemophilia B](https://today.ucsd.edu/story/uc-san-diego-health-first-to-offer-novel-gene-therapy-for-hemophilia-b)
[Health & Behavior](https://today.ucsd.edu/research/health-and-behavior)

[Concept photo of DNA double helix
![UC San Diego Health First to Offer Novel Gene Therapy for Hemophilia B]()](https://today.ucsd.edu/story/uc-san-diego-health-first-to-offer-novel-gene-therapy-for-hemophilia-b)

[### Uncovering Clues to a Natural Gene-Editing Technique](https://today.ucsd.edu/story/uncovering-natural-gene-editing-technique)
[Science & Environment](https://today.ucsd.edu/research/science-and-environment)

[Uncovering Clues to a Natural Gene-Editing Technique
![Uncovering Clues to a Natural Gene-Editing Technique]()](https://today.ucsd.edu/story/uncovering-natural-gene-editing-technique)

[### Scientists Uncover Key Step in How Diazotrophs “Fix” Nitrogen](https://today.ucsd.edu/story/how-diazotrophs-fix-nitrogen)
[Science & Environment](https://today.ucsd.edu/research/science-and-environment)

[rows of turmeric crops growing
![Scientists Uncover Key Step in How Diazotrophs “Fix” Nitrogen]()](https://today.ucsd.edu/story/how-diazotrophs-fix-nitrogen)

### [Solving Engineering Challenges to Make Fusion a Viable Clean Energy Source](https://today.ucsd.edu/story/nuclear-fusion-could-one-day-be-a-viable-clean-energy-source-but-big-engineering-challenges-stand-in-the-way)

[Technology & Engineering](https://today.ucsd.edu/research/technology-and-engineering)

[Solving Engineering Challenges to Make Fusion a Viable Clean Energy Source
![Solving Engineering Challenges to Make Fusion a Viable Clean Energy Source]()](https://today.ucsd.edu/story/nuclear-fusion-could-one-day-be-a-viable-clean-energy-source-but-big-engineering-challenges-stand-in-the-way)

## Stay in the Know

Keep up with all the latest from UC San Diego. Subscribe
to the newsletter today.

Email

Please provide a valid email address.

Subscribe

Subscription Notification
Close Confirmation

## Thank you!

You have been successfully subscribed to the UC San Diego Today
Newsletter.

## Contact Information

[![UC San Diego Homepage](/build/assets/img/global-nav/ucsd-logo-small.svg)](https://ucsd.edu)

9500 Gilman Drive, La Jolla, CA 92093-0021
(858) 534-2230

## Site Directory

* [Media Resources & Contacts](/media-contacts "Media Contacts")
* [Newsletter](/newsletter "Newsletter")
* [Emergency Status](http://www.ucsd.edu/emergency/ "Emergency Status")
* [Disability Resources](http://disabilities.ucsd.edu/ "Disability Resources")
* [Principles of Community](http://www.ucsd.edu/explore/about/principles.html "Principles of Community")
* [Equity, Diversity and Inclusion](http://diversity.ucsd.edu/index.html "Equity, Diversity and Inclusion")
* [University Communications](https://univcomms.ucsd.edu/ "University Communications")
* [Key Issues](https://keyissues.ucsd.edu/ "Key Issues")

## Follow Us on Social Media

* [![Facebook](/build/assets/img/social/facebook.svg)](https://facebook.com/ucsandiego)
* [![Twitter](/build/assets/img/social/twitter.svg)](https://twitter.com/ucsandiego)
* [![Youtube](/build/assets/img/social/youtube.svg)](https://youtube.com/ucsandiego)
* [![Instagram](/build/assets/img/social/instagram.svg)](https://instagram.com/ucsandiego)
* [![LinkedIn](/build/assets/img/social/linkedin.svg)](https://www.linkedin.com/company/university-of-california-at-san-diego/)
* [![Tiktok](/build/assets/img/social/tiktok.svg)](https://www.tiktok.com/%40ucsandiego)

Divisions & Schools

* [Arts and Humanities](https://artsandhumanities.ucsd.edu/)
* [Biological Sciences](http://biology.ucsd.edu/)
* [Division of Extended Studies](https://extendedstudies.ucsd.edu/)
* [Division of Graduate Education and Postdoctoral Affairs](https://grad.ucsd.edu/)
* [Division of Undergraduate Education](https://undergrad.ucsd.edu/)
* [Halicioğlu Data Science Institute](https://datascience.ucsd.edu/)
* [Jacobs School of Engineering](https://jacobsschool.ucsd.edu/)
* [Physical Sciences](https://physicalsciences.ucsd.edu/)
* [Rady School of Management](https://rady.ucsd.edu/)
* [School of Global Policy & Strategy](https://gps.ucsd.edu/)
* [School of Medicine](https://medschool.ucsd.edu/)
* [Scripps Institution of Oceanography](https://scripps.ucsd.edu/)
* [Skaggs School of Pharmacy](https://pharmacy.ucsd.edu/)
* [Social Sciences](http://socialsciences.ucsd.edu/)
* [Wertheim School of Public Health](https://hwsph.ucsd.edu/)

©
2021
Regents of the University of California. All rights reserved.
[Terms of Use](https://ucsd.edu/about/terms-of-use.html "Terms of Use")
|
[Accessibility](https://accessibility.ucsd.edu/report-a-concern/index.html "Accessibility")
|
[Privacy](https://ucsd.edu/about/privacy.html "Privacy")
|
[Feedback](https://univcomms.ucsd.edu/about/contact/index.html "Feedback")

Category navigation with
Social links
![X icon](/build//assets/img/global-nav/close-x.svg)

* ## [Research Right pointing chevron](/research)

  Research
  ![Right pointing chevron](/build/assets/img/global-nav/right-arrow-yellow.svg)
  ![Right pointing chevron](/build/assets/img/global-nav/right-arrow-yellow.svg)
  + [The Arts](https://today.ucsd.edu/research/the-arts)
  + [Business & Economics](https://today.ucsd.edu/research/business-and-economics)
  + [Health & Behavior](https://today.ucsd.edu/research/health-and-behavior)
  + [Humanities](https://today.ucsd.edu/research/humanities)
  + [Politics & Society](https://today.ucsd.edu/research/politics-and-society)
  + [Science & Environment](https://today.ucsd.edu/research/science-and-environment)
  + [Technology & Engineering](https://today.ucsd.edu/research/technology-and-engineering)[All
  Research](/research)
  Collapse Research navigation
* ## [People Right pointing chevron](/people)

  People
  ![Right pointing chevron](/build/assets/img/global-nav/right-arrow-yellow.svg)
  ![Right pointing chevron](/build/assets/img/global-nav/right-arrow-yellow.svg)
  Back
  + [Awards & Accolades](https://today.ucsd.edu/people/awards-and-accolades)
  + [In Memoriam](https://today.ucsd.edu/people/in-memoriam)
  + [Milestones](https://today.ucsd.edu/people/milestones)
  + [Profiles](https://today.ucsd.edu/people/profiles)[All
  People](/people)
  Collapse People navigation
* ## [Campus & Community Right pointing chevron](/campus-and-community)

  Campus & Community
  ![Right pointing chevron](/build/assets/img/global-nav/right-arrow-yellow.svg)

  ![Right pointing chevron](/build/assets/img/global-nav/right-arrow-yellow.svg)
  Back
  + [At Work](https://today.ucsd.edu/campus-and-community/at-work)
  + [Athletics](https://today.ucsd.edu/campus-and-community/athletics)
  + [Campus News](https://today.ucsd.edu/campus-and-community/campus-news)
  + [Giving](https://today.ucsd.edu/campus-and-community/giving)
  + [Student Life](https://today.ucsd.edu/campus-and-community/student-life)[All
  Campus & Community](/campus-and-community)
  Collapse Campus & Community navigation
* ## [Arts & Culture Right pointing chevron](/arts-and-culture)

  Arts & Culture
  ![Right pointing chevron](/build/assets/img/global-nav/right-arrow-yellow.svg)

  ![Right pointing chevron](/build/assets/img/global-nav/right-arrow-yellow.svg)
  Back
  + [Books & Culture](https://today.ucsd.edu/arts-and-culture/books-and-culture)
  + [Events & Happenings](https://today.ucsd.edu/arts-and-culture/events-and-happenings)
  + [Visual & Performing Arts](https://today.ucsd.edu/arts-and-culture/visual-and-performing-arts)[All
  Arts & Culture](/arts-and-culture)
  Collapse Arts & Culture navigation
* ## [Voices Right pointing chevron](/voices)

  Voices
  ![Right pointing chevron](/build/assets/img/global-nav/right-arrow-yellow.svg)

  ![Right pointing chevron](/build/assets/img/global-nav/right-arrow-yellow.svg)
  Back
  + [Insights & Experts](https://today.ucsd.edu/voices/insights-and-experts)
  + [Opinion](https://today.ucsd.edu/voices/opinion)
  + [Q&A](https://today.ucsd.edu/voices/qa)[All
  Voices](/voices)
  Collapse Voices navigation
* ## [Visual Storytelling Right pointing chevron](/visual-storytelling)

  [Visual Storytelling
  ![Right pointing chevron](/build/assets/img/global-nav/right-arrow-yellow.svg)](/visual-storytelling)

## For Media:

* [Media Resources & Contacts
  ![Right pointing chevron](/build//assets/img/global-nav/right-arrow-yellow.svg)](/media-contacts)

## Publications:

* [UC San Diego Today Newsletter
  ![Right pointing chevron](/build//assets/img/global-nav/right-arrow-yellow.svg)](/newsletter)
* [UC San Diego Magazine
  ![Right pointing chevron](/build//assets/img/global-nav/right-arrow-yellow.svg)](/areas/magazine)
* [Discoveries Magazine
  ![Right pointing chevron](/build//assets/img/global-nav/right-arrow-yellow.svg)](/areas/discoveries-magazine)

## Follow Us:

* [![Facebook](/build/assets/img/social/facebook.svg)](https://facebook.com/ucsandiego)
* [![Twitter](/build/assets/img/social/twitter.svg)](https://twitter.com/ucsandiego)
* [![Youtube](/build/assets/img/social/youtube.svg)](https://youtube.com/ucsandiego)
* [![Instagram](/build/assets/img/social/instagram.svg)](https://instagram.com/ucsandiego)
* [![LinkedIn](/build/assets/img/social/linkedin.svg)](https://www.linkedin.com/company/university-of-california-at-san-diego/)
* [![Tiktok](/build/assets/img/social/tiktok.svg)](https://www.tiktok.com/%40ucsandiego)

[![UC San Diego Homepage](/build//assets/img/global-nav/ucsd-logo-small.svg)](https://ucsd.edu "UC San Diego Homepage")

![X icon](/build//assets/img/global-nav/close-x.svg)

Close
![X icon](/build/assets/img/global-nav/close-x.svg)

Search UC San Diego Today

![Search](/build/assets/img/global-nav/grey-search-icon-mobile.svg)

Search



=== Content from datatracker.ietf.org_3d953457_20250111_035526.html ===


* Light
* Dark
* Auto

[RFC 2865

Draft Standard](/doc/rfc2865/)

|  | Title |  | Remote Authentication Dial In User Service (RADIUS) |
| --- | --- | --- | --- |
| Document | Document type |  | RFC - Draft Standard  June 2000  [View errata](https://www.rfc-editor.org/errata_search.php?rfc=2865 "Click to view errata.") [Report errata](https://www.rfc-editor.org/errata.php#reportnew "Click to report an error in the document.") [IPR](/ipr/search/?submit=draft&id=rfc2865 "Click to view IPR declarations.") Updated by [RFC 8044](/doc/html/rfc8044 "Data Types in RADIUS"), [RFC 2868](/doc/html/rfc2868 "RADIUS Attributes for Tunnel Protocol Support"), [RFC 3575](/doc/html/rfc3575 "IANA Considerations for RADIUS (Remote Authentication Dial In User Service)"), [RFC 5080](/doc/html/rfc5080 "Common Remote Authentication Dial In User Service (RADIUS) Implementation Issues and Suggested Fixes"), [RFC 6929](/doc/html/rfc6929 "Remote Authentication Dial In User Service (RADIUS) Protocol Extensions") Obsoletes [RFC 2138](/doc/html/rfc2138 "Remote Authentication Dial In User Service (RADIUS)") Was [draft-ietf-radius-radius-v2](/doc/draft-ietf-radius-radius-v2/05/) ([radius WG](/wg/radius/about/)) |
| --- | --- | --- | --- |
|  | Select version |  | * [05](/doc/html/draft-ietf-radius-radius-v2-05) * [RFC 2865](/doc/html/rfc2865) |
|  | Compare versions |  | RFC 2865  draft-ietf-radius-radius-v2-05  draft-ietf-radius-radius-v2-04  draft-ietf-radius-radius-v2-03  draft-ietf-radius-radius-v2-02  draft-ietf-radius-radius-v2-01  draft-ietf-radius-radius-v2-00   RFC 2865  draft-ietf-radius-radius-v2-05  draft-ietf-radius-radius-v2-04  draft-ietf-radius-radius-v2-03  draft-ietf-radius-radius-v2-02  draft-ietf-radius-radius-v2-01  draft-ietf-radius-radius-v2-00   Side-by-side  Inline |
|  | Authors |  | [Allan Rubens](/person/acr%40del.com "Datatracker profile of Allan Rubens") , [Carl Rigney](/person/cdr%40livingston.com "Datatracker profile of Carl Rigney") , [Steve Willens](/person/steve%40livingston.com "Datatracker profile of Steve Willens") , [William A. Simpson](/person/wsimpson%40umich.edu "Datatracker profile of William A. Simpson")   Email authors |
|  | RFC stream |  | IETF Logo IETF Logo |
|  | Other formats |  | [txt](https://www.rfc-editor.org/rfc/rfc2865.txt) [html](https://www.rfc-editor.org/rfc/rfc2865.html) [pdf](https://www.rfc-editor.org/rfc/pdfrfc/rfc2865.txt.pdf) [w/errata](https://www.rfc-editor.org/rfc/inline-errata/rfc2865.html) [bibtex](/doc/rfc2865/bibtex/) |
|  | Additional resources |  | Mailing list discussion |
|  |  |  | [Report a bug](https://github.com/ietf-tools/datatracker/issues/new/choose) |

```
Network Working Group                                          C. Rigney
Request for Comments: 2865                                    S. Willens
Obsoletes: [2138](/doc/html/rfc2138)                                               Livingston
Category: Standards Track                                      A. Rubens
                                                                   Merit
                                                              W. Simpson
                                                              Daydreamer
                                                               June 2000

          Remote Authentication Dial In User Service (RADIUS)

Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2000).  All Rights Reserved.

IESG Note:

   This protocol is widely implemented and used.  Experience has shown
   that it can suffer degraded performance and lost data when used in
   large scale systems, in part because it does not include provisions
   for congestion control.  Readers of this document may find it
   beneficial to track the progress of the IETF's AAA working group,
   which may develop a successor protocol that better addresses the
   scaling and congestion control issues.

Abstract

   This document describes a protocol for carrying authentication,
   authorization, and configuration information between a Network Access
   Server which desires to authenticate its links and a shared
   Authentication Server.

Implementation Note

   This memo documents the RADIUS protocol.  The early deployment of
   RADIUS was done using UDP port number 1645, which conflicts with the
   "datametrics" service.  The officially assigned port number for
   RADIUS is 1812.

Rigney, et al.              Standards Track                     [Page 1]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

Table of Contents

   [1](#section-1).     Introduction ..........................................    [3](#page-3)
      [1.1](#section-1.1)       Specification of Requirements ...................    [4](#page-4)
      [1.2](#section-1.2)       Terminology .....................................    [5](#page-5)
   [2](#section-2).     Operation .............................................    [5](#page-5)
      [2.1](#section-2.1)       Challenge/Response ..............................    [7](#page-7)
      [2.2](#section-2.2)       Interoperation with PAP and CHAP ................    [8](#page-8)
      [2.3](#section-2.3)       Proxy ...........................................    [8](#page-8)
      [2.4](#section-2.4)       Why UDP? ........................................   [11](#page-11)
      [2.5](#section-2.5)       Retransmission Hints ............................   [12](#page-12)
      [2.6](#section-2.6)       Keep-Alives Considered Harmful ..................   [13](#page-13)
   [3](#section-3).     Packet Format .........................................   [13](#page-13)
   [4](#section-4).     Packet Types ..........................................   [17](#page-17)
      [4.1](#section-4.1)       Access-Request ..................................   [17](#page-17)
      [4.2](#section-4.2)       Access-Accept ...................................   [18](#page-18)
      [4.3](#section-4.3)       Access-Reject ...................................   [20](#page-20)
      [4.4](#section-4.4)       Access-Challenge ................................   [21](#page-21)
   [5](#section-5).     Attributes ............................................   [22](#page-22)
      [5.1](#section-5.1)       User-Name .......................................   [26](#page-26)
      [5.2](#section-5.2)       User-Password ...................................   [27](#page-27)
      [5.3](#section-5.3)       CHAP-Password ...................................   [28](#page-28)
      [5.4](#section-5.4)       NAS-IP-Address ..................................   [29](#page-29)
      [5.5](#section-5.5)       NAS-Port ........................................   [30](#page-30)
      [5.6](#section-5.6)       Service-Type ....................................   [31](#page-31)
      [5.7](#section-5.7)       Framed-Protocol .................................   [33](#page-33)
      [5.8](#section-5.8)       Framed-IP-Address ...............................   [34](#page-34)
      [5.9](#section-5.9)       Framed-IP-Netmask ...............................   [34](#page-34)
      [5.10](#section-5.10)      Framed-Routing ..................................   [35](#page-35)
      [5.11](#section-5.11)      Filter-Id .......................................   [36](#page-36)
      [5.12](#section-5.12)      Framed-MTU ......................................   [37](#page-37)
      [5.13](#section-5.13)      Framed-Compression ..............................   [37](#page-37)
      [5.14](#section-5.14)      Login-IP-Host ...................................   [38](#page-38)
      [5.15](#section-5.15)      Login-Service ...................................   [39](#page-39)
      [5.16](#section-5.16)      Login-TCP-Port ..................................   [40](#page-40)
      [5.17](#section-5.17)      (unassigned) ....................................   [41](#page-41)
      [5.18](#section-5.18)      Reply-Message ...................................   [41](#page-41)
      [5.19](#section-5.19)      Callback-Number .................................   [42](#page-42)
      [5.20](#section-5.20)      Callback-Id .....................................   [42](#page-42)
      [5.21](#section-5.21)      (unassigned) ....................................   [43](#page-43)
      [5.22](#section-5.22)      Framed-Route ....................................   [43](#page-43)
      [5.23](#section-5.23)      Framed-IPX-Network ..............................   [44](#page-44)
      [5.24](#section-5.24)      State ...........................................   [45](#page-45)
      [5.25](#section-5.25)      Class ...........................................   [46](#page-46)
      [5.26](#section-5.26)      Vendor-Specific .................................   [47](#page-47)
      [5.27](#section-5.27)      Session-Timeout .................................   [48](#page-48)
      [5.28](#section-5.28)      Idle-Timeout ....................................   [49](#page-49)
      [5.29](#section-5.29)      Termination-Action ..............................   [49](#page-49)

Rigney, et al.              Standards Track                     [Page 2]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

      [5.30](#section-5.30)      Called-Station-Id ...............................   [50](#page-50)
      [5.31](#section-5.31)      Calling-Station-Id ..............................   [51](#page-51)
      [5.32](#section-5.32)      NAS-Identifier ..................................   [52](#page-52)
      [5.33](#section-5.33)      Proxy-State .....................................   [53](#page-53)
      [5.34](#section-5.34)      Login-LAT-Service ...............................   [54](#page-54)
      [5.35](#section-5.35)      Login-LAT-Node ..................................   [55](#page-55)
      [5.36](#section-5.36)      Login-LAT-Group .................................   [56](#page-56)
      [5.37](#section-5.37)      Framed-AppleTalk-Link ...........................   [57](#page-57)
      [5.38](#section-5.38)      Framed-AppleTalk-Network ........................   [58](#page-58)
      [5.39](#section-5.39)      Framed-AppleTalk-Zone ...........................   [58](#page-58)
      [5.40](#section-5.40)      CHAP-Challenge ..................................   [59](#page-59)
      [5.41](#section-5.41)      NAS-Port-Type ...................................   [60](#page-60)
      [5.42](#section-5.42)      Port-Limit ......................................   [61](#page-61)
      [5.43](#section-5.43)      Login-LAT-Port ..................................   [62](#page-62)
      [5.44](#section-5.44)      Table of Attributes .............................   [63](#page-63)
   [6](#section-6).     IANA Considerations ...................................   [64](#page-64)
      [6.1](#section-6.1)       Definition of Terms .............................   [64](#page-64)
      [6.2](#section-6.2)       Recommended Registration Policies ...............   [65](#page-65)
   [7](#section-7).     Examples ..............................................   [66](#page-66)
      [7.1](#section-7.1)       User Telnet to Specified Host ...................   [66](#page-66)
      [7.2](#section-7.2)       Framed User Authenticating with CHAP ............   [67](#page-67)
      [7.3](#section-7.3)       User with Challenge-Response card ...............   [68](#page-68)
   [8](#section-8).     Security Considerations ...............................   [71](#page-71)
   [9](#section-9).     Change Log ............................................   [71](#page-71)
   [10](#section-10).    References ............................................   [73](#page-73)
   [11](#section-11).    Acknowledgements ......................................   [74](#page-74)
   [12](#section-12).    Chair's Address .......................................   [74](#page-74)
   [13](#section-13).    Authors' Addresses ....................................   [75](#page-75)
   [14](#section-14).    Full Copyright Statement ..............................   [76](#page-76)

[1](#section-1).  Introduction

   This document obsoletes [RFC 2138](/doc/html/rfc2138) [[1](#ref-1 "\"Remote Authentication Dial In User Service (RADIUS)\"")].  A summary of the changes
   between this document and [RFC 2138](/doc/html/rfc2138) is available in the "Change Log"
   appendix.

   Managing dispersed serial line and modem pools for large numbers of
   users can create the need for significant administrative support.
   Since modem pools are by definition a link to the outside world, they
   require careful attention to security, authorization and accounting.
   This can be best achieved by managing a single "database" of users,
   which allows for authentication (verifying user name and password) as
   well as configuration information detailing the type of service to
   deliver to the user (for example, SLIP, PPP, telnet, rlogin).

Rigney, et al.              Standards Track                     [Page 3]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Key features of RADIUS are:

   Client/Server Model

      A Network Access Server (NAS) operates as a client of RADIUS.  The
      client is responsible for passing user information to designated
      RADIUS servers, and then acting on the response which is returned.

      RADIUS servers are responsible for receiving user connection
      requests, authenticating the user, and then returning all
      configuration information necessary for the client to deliver
      service to the user.

      A RADIUS server can act as a proxy client to other RADIUS servers
      or other kinds of authentication servers.

   Network Security

      Transactions between the client and RADIUS server are
      authenticated through the use of a shared secret, which is never
      sent over the network.  In addition, any user passwords are sent
      encrypted between the client and RADIUS server, to eliminate the
      possibility that someone snooping on an unsecure network could
      determine a user's password.

   Flexible Authentication Mechanisms

      The RADIUS server can support a variety of methods to authenticate
      a user.  When it is provided with the user name and original
      password given by the user, it can support PPP PAP or CHAP, UNIX
      login, and other authentication mechanisms.

   Extensible Protocol

      All transactions are comprised of variable length Attribute-
      Length-Value 3-tuples.  New attribute values can be added without
      disturbing existing implementations of the protocol.

[1.1](#section-1.1).  Specification of Requirements

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [BCP 14](/doc/html/bcp14) [[2](#ref-2 "\"Key words for use in RFCs to Indicate Requirement Levels\"")].  These key
   words mean the same thing whether capitalized or not.

   An implementation is not compliant if it fails to satisfy one or more
   of the must or must not requirements for the protocols it implements.
   An implementation that satisfies all the must, must not, should and

Rigney, et al.              Standards Track                     [Page 4]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   should not requirements for its protocols is said to be
   "unconditionally compliant"; one that satisfies all the must and must
   not requirements but not all the should or should not requirements
   for its protocols is said to be "conditionally compliant".

   A NAS that does not implement a given service MUST NOT implement the
   RADIUS attributes for that service.  For example, a NAS that is
   unable to offer ARAP service MUST NOT implement the RADIUS attributes
   for ARAP.  A NAS MUST treat a RADIUS access-accept authorizing an
   unavailable service as an access-reject instead.

[1.2](#section-1.2).  Terminology

   This document frequently uses the following terms:

   service   The NAS provides a service to the dial-in user, such as PPP
             or Telnet.

   session   Each service provided by the NAS to a dial-in user
             constitutes a session, with the beginning of the session
             defined as the point where service is first provided and
             the end of the session defined as the point where service
             is ended.  A user may have multiple sessions in parallel or
             series if the NAS supports that.

   silently discard
             This means the implementation discards the packet without
             further processing.  The implementation SHOULD provide the
             capability of logging the error, including the contents of
             the silently discarded packet, and SHOULD record the event
             in a statistics counter.

[2](#section-2).  Operation

   When a client is configured to use RADIUS, any user of the client
   presents authentication information to the client.  This might be
   with a customizable login prompt, where the user is expected to enter
   their username and password.  Alternatively, the user might use a
   link framing protocol such as the Point-to-Point Protocol (PPP),
   which has authentication packets which carry this information.

   Once the client has obtained such information, it may choose to
   authenticate using RADIUS.  To do so, the client creates an "Access-
   Request" containing such Attributes as the user's name, the user's
   password, the ID of the client and the Port ID which the user is
   accessing.  When a password is present, it is hidden using a method
   based on the RSA Message Digest Algorithm MD5 [[3](#ref-3 "\"The MD5 Message-Digest Algorithm\"")].

Rigney, et al.              Standards Track                     [Page 5]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   The Access-Request is submitted to the RADIUS server via the network.
   If no response is returned within a length of time, the request is
   re-sent a number of times.  The client can also forward requests to
   an alternate server or servers in the event that the primary server
   is down or unreachable.  An alternate server can be used either after
   a number of tries to the primary server fail, or in a round-robin
   fashion.  Retry and fallback algorithms are the topic of current
   research and are not specified in detail in this document.

   Once the RADIUS server receives the request, it validates the sending
   client.  A request from a client for which the RADIUS server does not
   have a shared secret MUST be silently discarded.  If the client is
   valid, the RADIUS server consults a database of users to find the
   user whose name matches the request.  The user entry in the database
   contains a list of requirements which must be met to allow access for
   the user.  This always includes verification of the password, but can
   also specify the client(s) or port(s) to which the user is allowed
   access.

   The RADIUS server MAY make requests of other servers in order to
   satisfy the request, in which case it acts as a client.

   If any Proxy-State attributes were present in the Access-Request,
   they MUST be copied unmodified and in order into the response packet.
   Other Attributes can be placed before, after, or even between the
   Proxy-State attributes.

   If any condition is not met, the RADIUS server sends an "Access-
   Reject" response indicating that this user request is invalid.  If
   desired, the server MAY include a text message in the Access-Reject
   which MAY be displayed by the client to the user.  No other
   Attributes (except Proxy-State) are permitted in an Access-Reject.

   If all conditions are met and the RADIUS server wishes to issue a
   challenge to which the user must respond, the RADIUS server sends an
   "Access-Challenge" response.  It MAY include a text message to be
   displayed by the client to the user prompting for a response to the
   challenge, and MAY include a State attribute.

   If the client receives an Access-Challenge and supports
   challenge/response it MAY display the text message, if any, to the
   user, and then prompt the user for a response.  The client then re-
   submits its original Access-Request with a new request ID, with the
   User-Password Attribute replaced by the response (encrypted), and
   including the State Attribute from the Access-Challenge, if any.
   Only 0 or 1 instances of the State Attribute SHOULD be

Rigney, et al.              Standards Track                     [Page 6]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   present in a request.  The server can respond to this new Access-
   Request with either an Access-Accept, an Access-Reject, or another
   Access-Challenge.

   If all conditions are met, the list of configuration values for the
   user are placed into an "Access-Accept" response.  These values
   include the type of service (for example: SLIP, PPP, Login User) and
   all necessary values to deliver the desired service.  For SLIP and
   PPP, this may include values such as IP address, subnet mask, MTU,
   desired compression, and desired packet filter identifiers.  For
   character mode users, this may include values such as desired
   protocol and host.

[2.1](#section-2.1).  Challenge/Response

   In challenge/response authentication, the user is given an
   unpredictable number and challenged to encrypt it and give back the
   result. Authorized users are equipped with special devices such as
   smart cards or software that facilitate calculation of the correct
   response with ease. Unauthorized users, lacking the appropriate
   device or software and lacking knowledge of the secret key necessary
   to emulate such a device or software, can only guess at the response.

   The Access-Challenge packet typically contains a Reply-Message
   including a challenge to be displayed to the user, such as a numeric
   value unlikely ever to be repeated. Typically this is obtained from
   an external server that knows what type of authenticator is in the
   possession of the authorized user and can therefore choose a random
   or non-repeating pseudorandom number of an appropriate radix and
   length.

   The user then enters the challenge into his device (or software) and
   it calculates a response, which the user enters into the client which
   forwards it to the RADIUS server via a second Access-Request.  If the
   response matches the expected response the RADIUS server replies with
   an Access-Accept, otherwise an Access-Reject.

   Example: The NAS sends an Access-Request packet to the RADIUS Server
   with NAS-Identifier, NAS-Port, User-Name, User-Password (which may
   just be a fixed string like "challenge" or ignored).  The server
   sends back an Access-Challenge packet with State and a Reply-Message
   along the lines of "Challenge 12345678, enter your response at the
   prompt" which the NAS displays.  The NAS prompts for the response and
   sends a NEW Access-Request to the server (with a new ID) with NAS-
   Identifier, NAS-Port, User-Name, User-Password (the response just
   entered by the user, encrypted), and the same State Attribute that

Rigney, et al.              Standards Track                     [Page 7]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   came with the Access-Challenge.  The server then sends back either an
   Access-Accept or Access-Reject based on whether the response matches
   the required value, or it can even send another Access-Challenge.

[2.2](#section-2.2).  Interoperation with PAP and CHAP

   For PAP, the NAS takes the PAP ID and password and sends them in an
   Access-Request packet as the User-Name and User-Password. The NAS MAY
   include the Attributes Service-Type = Framed-User and Framed-Protocol
   = PPP as a hint to the RADIUS server that PPP service is expected.

   For CHAP, the NAS generates a random challenge (preferably 16 octets)
   and sends it to the user, who returns a CHAP response along with a
   CHAP ID and CHAP username.  The NAS then sends an Access-Request
   packet to the RADIUS server with the CHAP username as the User-Name
   and with the CHAP ID and CHAP response as the CHAP-Password
   (Attribute 3).  The random challenge can either be included in the
   CHAP-Challenge attribute or, if it is 16 octets long, it can be
   placed in the Request Authenticator field of the Access-Request
   packet.  The NAS MAY include the Attributes Service-Type = Framed-
   User and Framed-Protocol = PPP as a hint to the RADIUS server that
   PPP service is expected.

   The RADIUS server looks up a password based on the User-Name,
   encrypts the challenge using MD5 on the CHAP ID octet, that password,
   and the CHAP challenge (from the CHAP-Challenge attribute if present,
   otherwise from the Request Authenticator), and compares that result
   to the CHAP-Password.  If they match, the server sends back an
   Access-Accept, otherwise it sends back an Access-Reject.

   If the RADIUS server is unable to perform the requested
   authentication it MUST return an Access-Reject.  For example, CHAP
   requires that the user's password be available in cleartext to the
   server so that it can encrypt the CHAP challenge and compare that to
   the CHAP response.  If the password is not available in cleartext to
   the RADIUS server then the server MUST send an Access-Reject to the
   client.

[2.3](#section-2.3).  Proxy

   With proxy RADIUS, one RADIUS server receives an authentication (or
   accounting) request from a RADIUS client (such as a NAS), forwards
   the request to a remote RADIUS server, receives the reply from the
   remote server, and sends that reply to the client, possibly with
   changes to reflect local administrative policy.  A common use for
   proxy RADIUS is roaming.  Roaming permits two or more administrative
   entities to allow each other's users to dial in to either entity's
   network for service.

Rigney, et al.              Standards Track                     [Page 8]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   The NAS sends its RADIUS access-request to the "forwarding server"
   which forwards it to the "remote server".  The remote server sends a
   response (Access-Accept, Access-Reject, or Access-Challenge) back to
   the forwarding server, which sends it back to the NAS.  The User-Name
   attribute MAY contain a Network Access Identifier [[8](#ref-8 "\"The Network Access Identifier\"")] for RADIUS
   Proxy operations.  The choice of which server receives the forwarded
   request SHOULD be based on the authentication "realm". The
   authentication realm MAY be the realm part of a Network Access
   Identifier (a "named realm").  Alternatively, the choice of which
   server receives the forwarded request MAY be based on whatever other
   criteria the forwarding server is configured to use, such as Called-
   Station-Id (a "numbered realm").

   A RADIUS server can function as both a forwarding server and a remote
   server, serving as a forwarding server for some realms and a remote
   server for other realms.  One forwarding server can act as a
   forwarder for any number of remote servers.  A remote server can have
   any number of servers forwarding to it and can provide authentication
   for any number of realms.  One forwarding server can forward to
   another forwarding server to create a chain of proxies, although care
   must be taken to avoid introducing loops.

   The following scenario illustrates a proxy RADIUS communication
   between a NAS and the forwarding and remote RADIUS servers:

   1. A NAS sends its access-request to the forwarding server.

   2. The forwarding server forwards the access-request to the remote
      server.

   3. The remote server sends an access-accept, access-reject or
      access-challenge back to the forwarding server.  For this example,
      an access-accept is sent.

   4. The forwarding server sends the access-accept to the NAS.

   The forwarding server MUST treat any Proxy-State attributes already
   in the packet as opaque data.  Its operation MUST NOT depend on the
   content of Proxy-State attributes added by previous servers.

   If there are any Proxy-State attributes in the request received from
   the client, the forwarding server MUST include those Proxy-State
   attributes in its reply to the client.  The forwarding server MAY
   include the Proxy-State attributes in the access-request when it
   forwards the request, or MAY omit them in the forwarded request.  If
   the forwarding server omits the Proxy-State attributes in the
   forwarded access-request, it MUST attach them to the response before
   sending it to the client.

Rigney, et al.              Standards Track                     [Page 9]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   We now examine each step in more detail.

   1. A NAS sends its access-request to the forwarding server.  The
      forwarding server decrypts the User-Password, if present, using
      the shared secret it knows for the NAS.  If a CHAP-Password
      attribute is present in the packet and no CHAP-Challenge attribute
      is present, the forwarding server MUST leave the Request-
      Authenticator untouched or copy it to a CHAP-Challenge attribute.

   '' The forwarding server MAY add one Proxy-State attribute to the
      packet.  (It MUST NOT add more than one.)  If it adds a Proxy-
      State, the Proxy-State MUST appear after any other Proxy-States in
      the packet.  The forwarding server MUST NOT modify any other
      Proxy-States that were in the packet (it may choose not to forward
      them, but it MUST NOT change their contents).  The forwarding
      server MUST NOT change the order of any attributes of the same
      type, including Proxy-State.

   2. The forwarding server encrypts the User-Password, if present,
      using the secret it shares with the remote server, sets the
      Identifier as needed, and forwards the access-request to the
      remote server.

   3. The remote server (if the final destination) verifies the user
      using User-Password, CHAP-Password, or such method as future
      extensions may dictate, and returns an access-accept, access-
      reject or access-challenge back to the forwarding server.  For
      this example, an access-accept is sent.  The remote server MUST
      copy all Proxy-State attributes (and only the Proxy-State
      attributes) in order from the access-request to the response
      packet, without modifying them.

   4. The forwarding server verifies the Response Authenticator using
      the secret it shares with the remote server, and silently discards
      the packet if it fails verification.  If the packet passes
      verification, the forwarding server removes the last Proxy-State
      (if it attached one), signs the Response Authenticator using the
      secret it shares with the NAS, restores the Identifier to match
      the one in the original request by the NAS, and sends the access-
      accept to the NAS.

   A forwarding server MAY need to modify attributes to enforce local
   policy.  Such policy is outside the scope of this document, with the
   following restrictions.  A forwarding server MUST not modify existing
   Proxy-State, State, or Class attributes present in the packet.

Rigney, et al.              Standards Track                    [Page 10]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Implementers of forwarding servers should consider carefully which
   values it is willing to accept for Service-Type.  Careful
   consideration must be given to the effects of passing along Service-
   Types of NAS-Prompt or Administrative in a proxied Access-Accept, and
   implementers may wish to provide mechanisms to block those or other
   service types, or other attributes.  Such mechanisms are outside the
   scope of this document.

[2.4](#section-2.4).  Why UDP?

   A frequently asked question is why RADIUS uses UDP instead of TCP as
   a transport protocol.  UDP was chosen for strictly technical reasons.

   There are a number of issues which must be understood.  RADIUS is a
   transaction based protocol which has several interesting
   characteristics:

   1. If the request to a primary Authentication server fails, a
      secondary server must be queried.

      To meet this requirement, a copy of the request must be kept above
      the transport layer to allow for alternate transmission.  This
      means that retransmission timers are still required.

   2. The timing requirements of this particular protocol are
      significantly different than TCP provides.

      At one extreme, RADIUS does not require a "responsive" detection
      of lost data.  The user is willing to wait several seconds for the
      authentication to complete.  The generally aggressive TCP
      retransmission (based on average round trip time) is not required,
      nor is the acknowledgement overhead of TCP.

      At the other extreme, the user is not willing to wait several
      minutes for authentication.  Therefore the reliable delivery of
      TCP data two minutes later is not useful.  The faster use of an
      alternate server allows the user to gain access before giving up.

   3. The stateless nature of this protocol simplifies the use of UDP.

      Clients and servers come and go.  Systems are rebooted, or are
      power cycled independently.  Generally this does not cause a
      problem and with creative timeouts and detection of lost TCP
      connections, code can be written to handle anomalous events.  UDP
      however completely eliminates any of this special handling.  Each
      client and server can open their UDP transport just once and leave
      it open through all types of failure events on the network.

Rigney, et al.              Standards Track                    [Page 11]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   4. UDP simplifies the server implementation.

      In the earliest implementations of RADIUS, the server was single
      threaded.  This means that a single request was received,
      processed, and returned.  This was found to be unmanageable in
      environments where the back-end security mechanism took real time
      (1 or more seconds).  The server request queue would fill and in
      environments where hundreds of people were being authenticated
      every minute, the request turn-around time increased to longer
      than users were willing to wait (this was especially severe when a
      specific lookup in a database or over DNS took 30 or more
      seconds).  The obvious solution was to make the server multi-
      threaded.  Achieving this was simple with UDP.  Separate processes
      were spawned to serve each request and these processes could
      respond directly to the client NAS with a simple UDP packet to the
      original transport of the client.

   It's not all a panacea.  As noted, using UDP requires one thing which
   is built into TCP: with UDP we must artificially manage
   retransmission timers to the same server, although they don't require
   the same attention to timing provided by TCP.  This one penalty is a
   small price to pay for the advantages of UDP in this protocol.

   Without TCP we would still probably be using tin cans connected by
   string.  But for this particular protocol, UDP is a better choice.

[2.5](#section-2.5).  Retransmission Hints

   If the RADIUS server and alternate RADIUS server share the same
   shared secret, it is OK to retransmit the packet to the alternate
   RADIUS server with the same ID and Request Authenticator, because the
   content of the attributes haven't changed.  If you want to use a new
   Request Authenticator when sending to the alternate server, you may.

   If you change the contents of the User-Password attribute (or any
   other attribute), you need a new Request Authenticator and therefore
   a new ID.

   If the NAS is retransmitting a RADIUS request to the same server as
   before, and the attributes haven't changed, you MUST use the same
   Request Authenticator, ID, and source port.  If any attributes have
   changed, you MUST use a new Request Authenticator and ID.

   A NAS MAY use the same ID across all servers, or MAY keep track of
   IDs separately for each server, it is up to the implementer.  If a
   NAS needs more than 256 IDs for outstanding requests, it MAY use

Rigney, et al.              Standards Track                    [Page 12]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   additional source ports to send requests from, and keep track of IDs
   for each source port.  This allows up to 16 million or so outstanding
   requests at one time to a single server.

[2.6](#section-2.6).  Keep-Alives Considered Harmful

   Some implementers have adopted the practice of sending test RADIUS
   requests to see if a server is alive.  This practice is strongly
   discouraged, since it adds to load and harms scalability without
   providing any additional useful information.  Since a RADIUS request
   is contained in a single datagram, in the time it would take you to
   send a ping you could just send the RADIUS request, and getting a
   reply tells you that the RADIUS server is up.  If you do not have a
   RADIUS request to send, it does not matter if the server is up or
   not, because you are not using it.

   If you want to monitor your RADIUS server, use SNMP.  That's what
   SNMP is for.

[3](#section-3).  Packet Format

   Exactly one RADIUS packet is encapsulated in the UDP Data field [[4](#ref-4 "\"User Datagram Protocol\"")],
   where the UDP Destination Port field indicates 1812 (decimal).

   When a reply is generated, the source and destination ports are
   reversed.

   This memo documents the RADIUS protocol.  The early deployment of
   RADIUS was done using UDP port number 1645, which conflicts with the
   "datametrics" service.  The officially assigned port number for
   RADIUS is 1812.

Rigney, et al.              Standards Track                    [Page 13]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   A summary of the RADIUS data format is shown below.  The fields are
   transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Code      |  Identifier   |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                         Authenticator                         |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Attributes ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-

   Code

      The Code field is one octet, and identifies the type of RADIUS
      packet.  When a packet is received with an invalid Code field, it
      is silently discarded.

      RADIUS Codes (decimal) are assigned as follows:

        1       Access-Request
        2       Access-Accept
        3       Access-Reject
        4       Accounting-Request
        5       Accounting-Response
       11       Access-Challenge
       12       Status-Server (experimental)
       13       Status-Client (experimental)
      255       Reserved

   Codes 4 and 5 are covered in the RADIUS Accounting document [[5](#ref-5 "\"RADIUS Accounting\"")].
   Codes 12 and 13 are reserved for possible use, but are not further
   mentioned here.

   Identifier

      The Identifier field is one octet, and aids in matching requests
      and replies.  The RADIUS server can detect a duplicate request if
      it has the same client source IP address and source UDP port and
      Identifier within a short span of time.

Rigney, et al.              Standards Track                    [Page 14]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Length

      The Length field is two octets.  It indicates the length of the
      packet including the Code, Identifier, Length, Authenticator and
      Attribute fields.  Octets outside the range of the Length field
      MUST be treated as padding and ignored on reception.  If the
      packet is shorter than the Length field indicates, it MUST be
      silently discarded.  The minimum length is 20 and maximum length
      is 4096.

   Authenticator

      The Authenticator field is sixteen (16) octets.  The most
      significant octet is transmitted first.  This value is used to
      authenticate the reply from the RADIUS server, and is used in the
      password hiding algorithm.

      Request Authenticator

         In Access-Request Packets, the Authenticator value is a 16
         octet random number, called the Request Authenticator.  The
         value SHOULD be unpredictable and unique over the lifetime of a
         secret (the password shared between the client and the RADIUS
         server), since repetition of a request value in conjunction
         with the same secret would permit an attacker to reply with a
         previously intercepted response.  Since it is expected that the
         same secret MAY be used to authenticate with servers in
         disparate geographic regions, the Request Authenticator field
         SHOULD exhibit global and temporal uniqueness.

         The Request Authenticator value in an Access-Request packet
         SHOULD also be unpredictable, lest an attacker trick a server
         into responding to a predicted future request, and then use the
         response to masquerade as that server to a future Access-
         Request.

         Although protocols such as RADIUS are incapable of protecting
         against theft of an authenticated session via realtime active
         wiretapping attacks, generation of unique unpredictable
         requests can protect against a wide range of active attacks
         against authentication.

         The NAS and RADIUS server share a secret.  That shared secret
         followed by the Request Authenticator is put through a one-way
         MD5 hash to create a 16 octet digest value which is xored with
         the password entered by the user, and the xored result placed

Rigney, et al.              Standards Track                    [Page 15]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

         in the User-Password attribute in the Access-Request packet.
         See the entry for User-Password in the section on Attributes
         for a more detailed description.

      Response Authenticator

         The value of the Authenticator field in Access-Accept, Access-
         Reject, and Access-Challenge packets is called the Response
         Authenticator, and contains a one-way MD5 hash calculated over
         a stream of octets consisting of: the RADIUS packet, beginning
         with the Code field, including the Identifier, the Length, the
         Request Authenticator field from the Access-Request packet, and
         the response Attributes, followed by the shared secret.  That
         is, ResponseAuth =
         MD5(Code+ID+Length+RequestAuth+Attributes+Secret) where +
         denotes concatenation.

   Administrative Note

      The secret (password shared between the client and the RADIUS
      server) SHOULD be at least as large and unguessable as a well-
      chosen password.  It is preferred that the secret be at least 16
      octets.  This is to ensure a sufficiently large range for the
      secret to provide protection against exhaustive search attacks.
      The secret MUST NOT be empty (length 0) since this would allow
      packets to be trivially forged.

      A RADIUS server MUST use the source IP address of the RADIUS UDP
      packet to decide which shared secret to use, so that RADIUS
      requests can be proxied.

      When using a forwarding proxy, the proxy must be able to alter the
      packet as it passes through in each direction - when the proxy
      forwards the request, the proxy MAY add a Proxy-State Attribute,
      and when the proxy forwards a response, it MUST remove its Proxy-
      State Attribute if it added one.  Proxy-State is always added or
      removed after any other Proxy-States, but no other assumptions
      regarding its location within the list of attributes can be made.
      Since Access-Accept and Access-Reject replies are authenticated on
      the entire packet contents, the stripping of the Proxy-State
      attribute invalidates the signature in the packet - so the proxy
      has to re-sign it.

      Further details of RADIUS proxy implementation are outside the
      scope of this document.

Rigney, et al.              Standards Track                    [Page 16]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[4](#section-4).  Packet Types

   The RADIUS Packet type is determined by the Code field in the first
   octet of the Packet.

[4.1](#section-4.1).  Access-Request

   Description

      Access-Request packets are sent to a RADIUS server, and convey
      information used to determine whether a user is allowed access to
      a specific NAS, and any special services requested for that user.
      An implementation wishing to authenticate a user MUST transmit a
      RADIUS packet with the Code field set to 1 (Access-Request).

      Upon receipt of an Access-Request from a valid client, an
      appropriate reply MUST be transmitted.

      An Access-Request SHOULD contain a User-Name attribute.  It MUST
      contain either a NAS-IP-Address attribute or a NAS-Identifier
      attribute (or both).

      An Access-Request MUST contain either a User-Password or a CHAP-
      Password or a State.  An Access-Request MUST NOT contain both a
      User-Password and a CHAP-Password.  If future extensions allow
      other kinds of authentication information to be conveyed, the
      attribute for that can be used in an Access-Request instead of
      User-Password or CHAP-Password.

      An Access-Request SHOULD contain a NAS-Port or NAS-Port-Type
      attribute or both unless the type of access being requested does
      not involve a port or the NAS does not distinguish among its
      ports.

      An Access-Request MAY contain additional attributes as a hint to
      the server, but the server is not required to honor the hint.

      When a User-Password is present, it is hidden using a method based
      on the RSA Message Digest Algorithm MD5 [[3](#ref-3 "\"The MD5 Message-Digest Algorithm\"")].

Rigney, et al.              Standards Track                    [Page 17]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   A summary of the Access-Request packet format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Code      |  Identifier   |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                     Request Authenticator                     |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Attributes ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-

   Code

      1 for Access-Request.

   Identifier

      The Identifier field MUST be changed whenever the content of the
      Attributes field changes, and whenever a valid reply has been
      received for a previous request.  For retransmissions, the
      Identifier MUST remain unchanged.

   Request Authenticator

      The Request Authenticator value MUST be changed each time a new
      Identifier is used.

   Attributes

      The Attribute field is variable in length, and contains the list
      of Attributes that are required for the type of service, as well
      as any desired optional Attributes.

[4.2](#section-4.2).  Access-Accept

   Description

      Access-Accept packets are sent by the RADIUS server, and provide
      specific configuration information necessary to begin delivery of
      service to the user.  If all Attribute values received in an
      Access-Request are acceptable then the RADIUS implementation MUST
      transmit a packet with the Code field set to 2 (Access-Accept).

Rigney, et al.              Standards Track                    [Page 18]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

      On reception of an Access-Accept, the Identifier field is matched
      with a pending Access-Request.  The Response Authenticator field
      MUST contain the correct response for the pending Access-Request.
      Invalid packets are silently discarded.

   A summary of the Access-Accept packet format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Code      |  Identifier   |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                     Response Authenticator                    |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Attributes ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-

   Code

      2 for Access-Accept.

   Identifier

      The Identifier field is a copy of the Identifier field of the
      Access-Request which caused this Access-Accept.

   Response Authenticator

      The Response Authenticator value is calculated from the Access-
      Request value, as described earlier.

   Attributes

      The Attribute field is variable in length, and contains a list of
      zero or more Attributes.

Rigney, et al.              Standards Track                    [Page 19]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[4.3](#section-4.3).  Access-Reject

   Description

      If any value of the received Attributes is not acceptable, then
      the RADIUS server MUST transmit a packet with the Code field set
      to 3 (Access-Reject).  It MAY include one or more Reply-Message
      Attributes with a text message which the NAS MAY display to the
      user.

   A summary of the Access-Reject packet format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Code      |  Identifier   |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                     Response Authenticator                    |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Attributes ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-

   Code

      3 for Access-Reject.

   Identifier

      The Identifier field is a copy of the Identifier field of the
      Access-Request which caused this Access-Reject.

   Response Authenticator

      The Response Authenticator value is calculated from the Access-
      Request value, as described earlier.

   Attributes

      The Attribute field is variable in length, and contains a list of
      zero or more Attributes.

Rigney, et al.              Standards Track                    [Page 20]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[4.4](#section-4.4).  Access-Challenge

   Description

      If the RADIUS server desires to send the user a challenge
      requiring a response, then the RADIUS server MUST respond to the
      Access-Request by transmitting a packet with the Code field set to
      11 (Access-Challenge).

      The Attributes field MAY have one or more Reply-Message
      Attributes, and MAY have a single State Attribute, or none.
      Vendor-Specific, Idle-Timeout, Session-Timeout and Proxy-State
      attributes MAY also be included.  No other Attributes defined in
      this document are permitted in an Access-Challenge.

      On receipt of an Access-Challenge, the Identifier field is matched
      with a pending Access-Request.  Additionally, the Response
      Authenticator field MUST contain the correct response for the
      pending Access-Request.  Invalid packets are silently discarded.

      If the NAS does not support challenge/response, it MUST treat an
      Access-Challenge as though it had received an Access-Reject
      instead.

      If the NAS supports challenge/response, receipt of a valid
      Access-Challenge indicates that a new Access-Request SHOULD be
      sent.  The NAS MAY display the text message, if any, to the user,
      and then prompt the user for a response.  It then sends its
      original Access-Request with a new request ID and Request
      Authenticator, with the User-Password Attribute replaced by the
      user's response (encrypted), and including the State Attribute
      from the Access-Challenge, if any.  Only 0 or 1 instances of the
      State Attribute can be present in an Access-Request.

      A NAS which supports PAP MAY forward the Reply-Message to the
      dialing client and accept a PAP response which it can use as
      though the user had entered the response.  If the NAS cannot do
      so, it MUST treat the Access-Challenge as though it had received
      an Access-Reject instead.

Rigney, et al.              Standards Track                    [Page 21]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   A summary of the Access-Challenge packet format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Code      |  Identifier   |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                     Response Authenticator                    |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Attributes ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-

   Code

      11 for Access-Challenge.

   Identifier

      The Identifier field is a copy of the Identifier field of the
      Access-Request which caused this Access-Challenge.

   Response Authenticator

      The Response Authenticator value is calculated from the Access-
      Request value, as described earlier.

   Attributes

      The Attributes field is variable in length, and contains a list of
      zero or more Attributes.

[5](#section-5).  Attributes

   RADIUS Attributes carry the specific authentication, authorization,
   information and configuration details for the request and reply.

   The end of the list of Attributes is indicated by the Length of the
   RADIUS packet.

   Some Attributes MAY be included more than once.  The effect of this
   is Attribute specific, and is specified in each Attribute
   description.  A summary table is provided at the end of the
   "Attributes" section.

Rigney, et al.              Standards Track                    [Page 22]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   If multiple Attributes with the same Type are present, the order of
   Attributes with the same Type MUST be preserved by any proxies.  The
   order of Attributes of different Types is not required to be
   preserved.  A RADIUS server or client MUST NOT have any dependencies
   on the order of attributes of different types.  A RADIUS server or
   client MUST NOT require attributes of the same type to be contiguous.

   Where an Attribute's description limits which kinds of packet it can
   be contained in, this applies only to the packet types defined in
   this document, namely Access-Request, Access-Accept, Access-Reject
   and Access-Challenge (Codes 1, 2, 3, and 11).  Other documents
   defining other packet types may also use Attributes described here.
   To determine which Attributes are allowed in Accounting-Request and
   Accounting-Response packets (Codes 4 and 5) refer to the RADIUS
   Accounting document [[5](#ref-5 "\"RADIUS Accounting\"")].

   Likewise where packet types defined here state that only certain
   Attributes are permissible in them, future memos defining new
   Attributes should indicate which packet types the new Attributes may
   be present in.

   A summary of the Attribute format is shown below.  The fields are
   transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  Value ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      The Type field is one octet.  Up-to-date values of the RADIUS Type
      field are specified in the most recent "Assigned Numbers" RFC [[6](#ref-6 "\"Assigned Numbers\"")].
      Values 192-223 are reserved for experimental use, values 224-240
      are reserved for implementation-specific use, and values 241-255
      are reserved and should not be used.

      A RADIUS server MAY ignore Attributes with an unknown Type.

      A RADIUS client MAY ignore Attributes with an unknown Type.

Rigney, et al.              Standards Track                    [Page 23]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

      This specification concerns the following values:

          1      User-Name
          2      User-Password
          3      CHAP-Password
          4      NAS-IP-Address
          5      NAS-Port
          6      Service-Type
          7      Framed-Protocol
          8      Framed-IP-Address
          9      Framed-IP-Netmask
         10      Framed-Routing
         11      Filter-Id
         12      Framed-MTU
         13      Framed-Compression
         14      Login-IP-Host
         15      Login-Service
         16      Login-TCP-Port
         17      (unassigned)
         18      Reply-Message
         19      Callback-Number
         20      Callback-Id
         21      (unassigned)
         22      Framed-Route
         23      Framed-IPX-Network
         24      State
         25      Class
         26      Vendor-Specific
         27      Session-Timeout
         28      Idle-Timeout
         29      Termination-Action
         30      Called-Station-Id
         31      Calling-Station-Id
         32      NAS-Identifier
         33      Proxy-State
         34      Login-LAT-Service
         35      Login-LAT-Node
         36      Login-LAT-Group
         37      Framed-AppleTalk-Link
         38      Framed-AppleTalk-Network
         39      Framed-AppleTalk-Zone
         40-59   (reserved for accounting)
         60      CHAP-Challenge
         61      NAS-Port-Type
         62      Port-Limit
         63      Login-LAT-Port

Rigney, et al.              Standards Track                    [Page 24]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Length

      The Length field is one octet, and indicates the length of this
      Attribute including the Type, Length and Value fields.  If an
      Attribute is received in an Access-Request but with an invalid
      Length, an Access-Reject SHOULD be transmitted.  If an Attribute
      is received in an Access-Accept, Access-Reject or Access-Challenge
      packet with an invalid length, the packet MUST either be treated
      as an Access-Reject or else silently discarded.

   Value

      The Value field is zero or more octets and contains information
      specific to the Attribute.  The format and length of the Value
      field is determined by the Type and Length fields.

      Note that none of the types in RADIUS terminate with a NUL (hex
      00).  In particular, types "text" and "string" in RADIUS do not
      terminate with a NUL (hex 00).  The Attribute has a length field
      and does not use a terminator.  Text contains UTF-8 encoded 10646
      [[7](#ref-7 "\"UTF-8, a transformation format of ISO 10646\"")] characters and String contains 8-bit binary data.  Servers and
      servers and clients MUST be able to deal with embedded nulls.
      RADIUS implementers using C are cautioned not to use strcpy() when
      handling strings.

      The format of the value field is one of five data types.  Note
      that type "text" is a subset of type "string".

      text      1-253 octets containing UTF-8 encoded 10646 [[7](#ref-7 "\"UTF-8, a transformation format of ISO 10646\"")]
                characters.  Text of length zero (0) MUST NOT be sent;
                omit the entire attribute instead.

      string    1-253 octets containing binary data (values 0 through
                255 decimal, inclusive).  Strings of length zero (0)
                MUST NOT be sent; omit the entire attribute instead.

      address   32 bit value, most significant octet first.

      integer   32 bit unsigned value, most significant octet first.

      time      32 bit unsigned value, most significant octet first --
                seconds since 00:00:00 UTC, January 1, 1970.  The
                standard Attributes do not use this data type but it is
                presented here for possible use in future attributes.

Rigney, et al.              Standards Track                    [Page 25]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[5.1](#section-5.1).  User-Name

   Description

      This Attribute indicates the name of the user to be authenticated.
      It MUST be sent in Access-Request packets if available.

      It MAY be sent in an Access-Accept packet, in which case the
      client SHOULD use the name returned in the Access-Accept packet in
      all Accounting-Request packets for this session.  If the Access-
      Accept includes Service-Type = Rlogin and the User-Name attribute,
      a NAS MAY use the returned User-Name when performing the Rlogin
      function.

   A summary of the User-Name Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      1 for User-Name.

   Length

      >= 3

   String

      The String field is one or more octets.  The NAS may limit the
      maximum length of the User-Name but the ability to handle at least
      63 octets is recommended.

      The format of the username MAY be one of several forms:

      text      Consisting only of UTF-8 encoded 10646 [[7](#ref-7 "\"UTF-8, a transformation format of ISO 10646\"")] characters.

      network access identifier
                A Network Access Identifier as described in [RFC 2486](/doc/html/rfc2486)
                [[8](#ref-8 "\"The Network Access Identifier\"")].

      distinguished name
                A name in ASN.1 form used in Public Key authentication
                systems.

Rigney, et al.              Standards Track                    [Page 26]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[5.2](#section-5.2).  User-Password

   Description

      This Attribute indicates the password of the user to be
      authenticated, or the user's input following an Access-Challenge.
      It is only used in Access-Request packets.

      On transmission, the password is hidden.  The password is first
      padded at the end with nulls to a multiple of 16 octets.  A one-
      way MD5 hash is calculated over a stream of octets consisting of
      the shared secret followed by the Request Authenticator.  This
      value is XORed with the first 16 octet segment of the password and
      placed in the first 16 octets of the String field of the User-
      Password Attribute.

      If the password is longer than 16 characters, a second one-way MD5
      hash is calculated over a stream of octets consisting of the
      shared secret followed by the result of the first xor.  That hash
      is XORed with the second 16 octet segment of the password and
      placed in the second 16 octets of the String field of the User-
      Password Attribute.

      If necessary, this operation is repeated, with each xor result
      being used along with the shared secret to generate the next hash
      to xor the next segment of the password, to no more than 128
      characters.

      The method is taken from the book "Network Security" by Kaufman,
      Perlman and Speciner [[9](#ref-9 "\"Network Security: Private Communications in a Public World\"")] pages 109-110.  A more precise
      explanation of the method follows:

      Call the shared secret S and the pseudo-random 128-bit Request
      Authenticator RA.  Break the password into 16-octet chunks p1, p2,
      etc.  with the last one padded at the end with nulls to a 16-octet
      boundary.  Call the ciphertext blocks c(1), c(2), etc.  We'll need
      intermediate values b1, b2, etc.

         b1 = MD5(S + RA)       c(1) = p1 xor b1
         b2 = MD5(S + c(1))     c(2) = p2 xor b2
                .                       .
                .                       .
                .                       .
         bi = MD5(S + c(i-1))   c(i) = pi xor bi

      The String will contain c(1)+c(2)+...+c(i) where + denotes
      concatenation.

Rigney, et al.              Standards Track                    [Page 27]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

      On receipt, the process is reversed to yield the original
      password.

   A summary of the User-Password Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      2 for User-Password.

   Length

      At least 18 and no larger than 130.

   String

      The String field is between 16 and 128 octets long, inclusive.

[5.3](#section-5.3).  CHAP-Password

   Description

      This Attribute indicates the response value provided by a PPP
      Challenge-Handshake Authentication Protocol (CHAP) user in
      response to the challenge.  It is only used in Access-Request
      packets.

      The CHAP challenge value is found in the CHAP-Challenge Attribute
      (60) if present in the packet, otherwise in the Request
      Authenticator field.

   A summary of the CHAP-Password Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  CHAP Ident   |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

Rigney, et al.              Standards Track                    [Page 28]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Type

      3 for CHAP-Password.

   Length

      19

   CHAP Ident

      This field is one octet, and contains the CHAP Identifier from the
      user's CHAP Response.

   String

      The String field is 16 octets, and contains the CHAP Response from
      the user.

[5.4](#section-5.4).  NAS-IP-Address

   Description

      This Attribute indicates the identifying IP Address of the NAS
      which is requesting authentication of the user, and SHOULD be
      unique to the NAS within the scope of the RADIUS server. NAS-IP-
      Address is only used in Access-Request packets.  Either NAS-IP-
      Address or NAS-Identifier MUST be present in an Access-Request
      packet.

      Note that NAS-IP-Address MUST NOT be used to select the shared
      secret used to authenticate the request.  The source IP address of
      the Access-Request packet MUST be used to select the shared
      secret.

   A summary of the NAS-IP-Address Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |            Address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
            Address (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      4 for NAS-IP-Address.

Rigney, et al.              Standards Track                    [Page 29]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Length

      6

   Address

      The Address field is four octets.

[5.5](#section-5.5).  NAS-Port

   Description

      This Attribute indicates the physical port number of the NAS which
      is authenticating the user.  It is only used in Access-Request
      packets.  Note that this is using "port" in its sense of a
      physical connection on the NAS, not in the sense of a TCP or UDP
      port number.  Either NAS-Port or NAS-Port-Type (61) or both SHOULD
      be present in an Access-Request packet, if the NAS differentiates
      among its ports.

   A summary of the NAS-Port Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      5 for NAS-Port.

   Length

      6

   Value

      The Value field is four octets.

Rigney, et al.              Standards Track                    [Page 30]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[5.6](#section-5.6).  Service-Type

   Description

      This Attribute indicates the type of service the user has
      requested, or the type of service to be provided.  It MAY be used
      in both Access-Request and Access-Accept packets.  A NAS is not
      required to implement all of these service types, and MUST treat
      unknown or unsupported Service-Types as though an Access-Reject
      had been received instead.

   A summary of the Service-Type Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      6 for Service-Type.

   Length

      6

   Value

      The Value field is four octets.

       1      Login
       2      Framed
       3      Callback Login
       4      Callback Framed
       5      Outbound
       6      Administrative
       7      NAS Prompt
       8      Authenticate Only
       9      Callback NAS Prompt
      10      Call Check
      11      Callback Administrative

Rigney, et al.              Standards Track                    [Page 31]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

      The service types are defined as follows when used in an Access-
      Accept.  When used in an Access-Request, they MAY be considered to
      be a hint to the RADIUS server that the NAS has reason to believe
      the user would prefer the kind of service indicated, but the
      server is not required to honor the hint.

      Login               The user should be connected to a host.

      Framed              A Framed Protocol should be started for the
                          User, such as PPP or SLIP.

      Callback Login      The user should be disconnected and called
                          back, then connected to a host.

      Callback Framed     The user should be disconnected and called
                          back, then a Framed Protocol should be started
                          for the User, such as PPP or SLIP.

      Outbound            The user should be granted access to outgoing
                          devices.

      Administrative      The user should be granted access to the
                          administrative interface to the NAS from which
                          privileged commands can be executed.

      NAS Prompt          The user should be provided a command prompt
                          on the NAS from which non-privileged commands
                          can be executed.

      Authenticate Only   Only Authentication is requested, and no
                          authorization information needs to be returned
                          in the Access-Accept (typically used by proxy
                          servers rather than the NAS itself).

      Callback NAS Prompt The user should be disconnected and called
                          back, then provided a command prompt on the
                          NAS from which non-privileged commands can be
                          executed.

      Call Check          Used by the NAS in an Access-Request packet to
                          indicate that a call is being received and
                          that the RADIUS server should send back an
                          Access-Accept to answer the call, or an
                          Access-Reject to not accept the call,
                          typically based on the Called-Station-Id or
                          Calling-Station-Id attributes.  It is

Rigney, et al.              Standards Track                    [Page 32]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

                          recommended that such Access-Requests use the
                          value of Calling-Station-Id as the value of
                          the User-Name.

      Callback Administrative
                          The user should be disconnected and called
                          back, then granted access to the
                          administrative interface to the NAS from which
                          privileged commands can be executed.

[5.7](#section-5.7).  Framed-Protocol

   Description

      This Attribute indicates the framing to be used for framed access.
      It MAY be used in both Access-Request and Access-Accept packets.

   A summary of the Framed-Protocol Attribute format is shown below.
   The fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      7 for Framed-Protocol.

   Length

      6

   Value

      The Value field is four octets.

      1      PPP
      2      SLIP
      3      AppleTalk Remote Access Protocol (ARAP)
      4      Gandalf proprietary SingleLink/MultiLink protocol
      5      Xylogics proprietary IPX/SLIP
      6      X.75 Synchronous

Rigney, et al.              Standards Track                    [Page 33]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[5.8](#section-5.8).  Framed-IP-Address

   Description

      This Attribute indicates the address to be configured for the
      user.  It MAY be used in Access-Accept packets.  It MAY be used in
      an Access-Request packet as a hint by the NAS to the server that
      it would prefer that address, but the server is not required to
      honor the hint.

   A summary of the Framed-IP-Address Attribute format is shown below.
   The fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |            Address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
            Address (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      8 for Framed-IP-Address.

   Length

      6

   Address

      The Address field is four octets.  The value 0xFFFFFFFF indicates
      that the NAS Should allow the user to select an address (e.g.
      Negotiated).  The value 0xFFFFFFFE indicates that the NAS should
      select an address for the user (e.g. Assigned from a pool of
      addresses kept by the NAS).  Other valid values indicate that the
      NAS should use that value as the user's IP address.

[5.9](#section-5.9).  Framed-IP-Netmask

   Description

      This Attribute indicates the IP netmask to be configured for the
      user when the user is a router to a network.  It MAY be used in
      Access-Accept packets.  It MAY be used in an Access-Request packet
      as a hint by the NAS to the server that it would prefer that
      netmask, but the server is not required to honor the hint.

Rigney, et al.              Standards Track                    [Page 34]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   A summary of the Framed-IP-Netmask Attribute format is shown below.
   The fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |            Address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
            Address (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      9 for Framed-IP-Netmask.

   Length

      6

   Address

      The Address field is four octets specifying the IP netmask of the
      user.

[5.10](#section-5.10).  Framed-Routing

   Description

      This Attribute indicates the routing method for the user, when the
      user is a router to a network.  It is only used in Access-Accept
      packets.

   A summary of the Framed-Routing Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      10 for Framed-Routing.

Rigney, et al.              Standards Track                    [Page 35]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Length

      6

   Value

      The Value field is four octets.

       0      None
       1      Send routing packets
       2      Listen for routing packets
       3      Send and Listen

[5.11](#section-5.11).  Filter-Id

   Description

      This Attribute indicates the name of the filter list for this
      user.  Zero or more Filter-Id attributes MAY be sent in an
      Access-Accept packet.

      Identifying a filter list by name allows the filter to be used on
      different NASes without regard to filter-list implementation
      details.

   A summary of the Filter-Id Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  Text ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      11 for Filter-Id.

   Length

      >= 3

   Text

      The Text field is one or more octets, and its contents are
      implementation dependent.  It is intended to be human readable and
      MUST NOT affect operation of the protocol.  It is recommended that
      the message contain UTF-8 encoded 10646 [[7](#ref-7 "\"UTF-8, a transformation format of ISO 10646\"")] characters.

Rigney, et al.              Standards Track                    [Page 36]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[5.12](#section-5.12).  Framed-MTU

   Description

      This Attribute indicates the Maximum Transmission Unit to be
      configured for the user, when it is not negotiated by some other
      means (such as PPP).  It MAY be used in Access-Accept packets.  It
      MAY be used in an Access-Request packet as a hint by the NAS to
      the server that it would prefer that value, but the server is not
      required to honor the hint.

   A summary of the Framed-MTU Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      12 for Framed-MTU.

   Length

      6

   Value

      The Value field is four octets.  Despite the size of the field,
      values range from 64 to 65535.

[5.13](#section-5.13).  Framed-Compression

   Description

      This Attribute indicates a compression protocol to be used for the
      link.  It MAY be used in Access-Accept packets.  It MAY be used in
      an Access-Request packet as a hint to the server that the NAS
      would prefer to use that compression, but the server is not
      required to honor the hint.

      More than one compression protocol Attribute MAY be sent.  It is
      the responsibility of the NAS to apply the proper compression
      protocol to appropriate link traffic.

Rigney, et al.              Standards Track                    [Page 37]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   A summary of the Framed-Compression Attribute format is shown below.
   The fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      13 for Framed-Compression.

   Length

      6

   Value

      The Value field is four octets.

       0      None
       1      VJ TCP/IP header compression [[10](#ref-10 "\"Compressing TCP/IP headers for low-speed serial links\"")]
       2      IPX header compression
       3      Stac-LZS compression

[5.14](#section-5.14).  Login-IP-Host

   Description

      This Attribute indicates the system with which to connect the user,
      when the Login-Service Attribute is included.  It MAY be used in
      Access-Accept packets.  It MAY be used in an Access-Request packet as
      a hint to the server that the NAS would prefer to use that host, but
      the server is not required to honor the hint.

   A summary of the Login-IP-Host Attribute format is shown below.  The
   fields are transmitted from left to right.

Rigney, et al.              Standards Track                    [Page 38]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |            Address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
            Address (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      14 for Login-IP-Host.

   Length

      6

   Address

      The Address field is four octets.  The value 0xFFFFFFFF indicates
      that the NAS SHOULD allow the user to select an address.  The
      value 0 indicates that the NAS SHOULD select a host to connect the
      user to.  Other values indicate the address the NAS SHOULD connect
      the user to.

[5.15](#section-5.15).  Login-Service

   Description

      This Attribute indicates the service to use to connect the user to
      the login host.  It is only used in Access-Accept packets.

   A summary of the Login-Service Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      15 for Login-Service.

Rigney, et al.              Standards Track                    [Page 39]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Length

      6

   Value

      The Value field is four octets.

       0   Telnet
       1   Rlogin
       2   TCP Clear
       3   PortMaster (proprietary)
       4   LAT
       5   X25-PAD
       6   X25-T3POS
       8   TCP Clear Quiet (suppresses any NAS-generated connect string)

[5.16](#section-5.16).  Login-TCP-Port

   Description

      This Attribute indicates the TCP port with which the user is to be
      connected, when the Login-Service Attribute is also present.  It
      is only used in Access-Accept packets.

   A summary of the Login-TCP-Port Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      16 for Login-TCP-Port.

   Length

      6

   Value

      The Value field is four octets.  Despite the size of the field,
      values range from 0 to 65535.

Rigney, et al.              Standards Track                    [Page 40]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[5.17](#section-5.17).  (unassigned)

   Description

      ATTRIBUTE TYPE 17 HAS NOT BEEN ASSIGNED.

[5.18](#section-5.18).  Reply-Message

   Description

      This Attribute indicates text which MAY be displayed to the user.

      When used in an Access-Accept, it is the success message.

      When used in an Access-Reject, it is the failure message.  It MAY
      indicate a dialog message to prompt the user before another
      Access-Request attempt.

      When used in an Access-Challenge, it MAY indicate a dialog message
      to prompt the user for a response.

      Multiple Reply-Message's MAY be included and if any are displayed,
      they MUST be displayed in the same order as they appear in the
      packet.

   A summary of the Reply-Message Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  Text ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      18 for Reply-Message.

   Length

      >= 3

   Text

      The Text field is one or more octets, and its contents are
      implementation dependent.  It is intended to be human readable,
      and MUST NOT affect operation of the protocol.  It is recommended
      that the message contain UTF-8 encoded 10646 [[7](#ref-7 "\"UTF-8, a transformation format of ISO 10646\"")] characters.

Rigney, et al.              Standards Track                    [Page 41]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[5.19](#section-5.19).  Callback-Number

   Description

      This Attribute indicates a dialing string to be used for callback.
      It MAY be used in Access-Accept packets.  It MAY be used in an
      Access-Request packet as a hint to the server that a Callback
      service is desired, but the server is not required to honor the
      hint.

   A summary of the Callback-Number Attribute format is shown below.
   The fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      19 for Callback-Number.

   Length

      >= 3

   String

      The String field is one or more octets.  The actual format of the
      information is site or application specific, and a robust
      implementation SHOULD support the field as undistinguished octets.

      The codification of the range of allowed usage of this field is
      outside the scope of this specification.

[5.20](#section-5.20).  Callback-Id

   Description

      This Attribute indicates the name of a place to be called, to be
      interpreted by the NAS.  It MAY be used in Access-Accept packets.

Rigney, et al.              Standards Track                    [Page 42]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   A summary of the Callback-Id Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      20 for Callback-Id.

   Length

      >= 3

   String

      The String field is one or more octets.  The actual format of the
      information is site or application specific, and a robust
      implementation SHOULD support the field as undistinguished octets.

      The codification of the range of allowed usage of this field is
      outside the scope of this specification.

[5.21](#section-5.21).  (unassigned)

   Description

      ATTRIBUTE TYPE 21 HAS NOT BEEN ASSIGNED.

[5.22](#section-5.22).  Framed-Route

   Description

      This Attribute provides routing information to be configured for
      the user on the NAS.  It is used in the Access-Accept packet and
      can appear multiple times.

   A summary of the Framed-Route Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  Text ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

Rigney, et al.              Standards Track                    [Page 43]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Type

      22 for Framed-Route.

   Length

      >= 3

   Text

      The Text field is one or more octets, and its contents are
      implementation dependent.  It is intended to be human readable and
      MUST NOT affect operation of the protocol.  It is recommended that
      the message contain UTF-8 encoded 10646 [[7](#ref-7 "\"UTF-8, a transformation format of ISO 10646\"")] characters.

      For IP routes, it SHOULD contain a destination prefix in dotted
      quad form optionally followed by a slash and a decimal length
      specifier stating how many high order bits of the prefix to use.
      That is followed by a space, a gateway address in dotted quad
      form, a space, and one or more metrics separated by spaces.  For
      example, "192.168.1.0/24 192.168.1.1 1 2 -1 3 400". The length
      specifier may be omitted, in which case it defaults to 8 bits for
      class A prefixes, 16 bits for class B prefixes, and 24 bits for
      class C prefixes.  For example, "192.168.1.0 192.168.1.1 1".

      Whenever the gateway address is specified as "0.0.0.0" the IP
      address of the user SHOULD be used as the gateway address.

[5.23](#section-5.23).  Framed-IPX-Network

   Description

      This Attribute indicates the IPX Network number to be configured
      for the user.  It is used in Access-Accept packets.

   A summary of the Framed-IPX-Network Attribute format is shown below.
   The fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Rigney, et al.              Standards Track                    [Page 44]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Type

      23 for Framed-IPX-Network.

   Length

      6

   Value

      The Value field is four octets.  The value 0xFFFFFFFE indicates
      that the NAS should select an IPX network for the user (e.g.
      assigned from a pool of one or more IPX networks kept by the NAS).
      Other values should be used as the IPX network for the link to the
      user.

[5.24](#section-5.24).  State

   Description

      This Attribute is available to be sent by the server to the client
      in an Access-Challenge and MUST be sent unmodified from the client
      to the server in the new Access-Request reply to that challenge,
      if any.

      This Attribute is available to be sent by the server to the client
      in an Access-Accept that also includes a Termination-Action
      Attribute with the value of RADIUS-Request.  If the NAS performs
      the Termination-Action by sending a new Access-Request upon
      termination of the current session, it MUST include the State
      attribute unchanged in that Access-Request.

      In either usage, the client MUST NOT interpret the attribute
      locally.  A packet must have only zero or one State Attribute.
      Usage of the State Attribute is implementation dependent.

   A summary of the State Attribute format is shown below.  The fields
   are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      24 for State.

Rigney, et al.              Standards Track                    [Page 45]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Length

      >= 3

   String

      The String field is one or more octets.  The actual format of the
      information is site or application specific, and a robust
      implementation SHOULD support the field as undistinguished octets.

      The codification of the range of allowed usage of this field is
      outside the scope of this specification.

[5.25](#section-5.25).  Class

   Description

      This Attribute is available to be sent by the server to the client
      in an Access-Accept and SHOULD be sent unmodified by the client to
      the accounting server as part of the Accounting-Request packet if
      accounting is supported.  The client MUST NOT interpret the
      attribute locally.

   A summary of the Class Attribute format is shown below.  The fields
   are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      25 for Class.

   Length

      >= 3

   String

      The String field is one or more octets.  The actual format of the
      information is site or application specific, and a robust
      implementation SHOULD support the field as undistinguished octets.

      The codification of the range of allowed usage of this field is
      outside the scope of this specification.

Rigney, et al.              Standards Track                    [Page 46]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[5.26](#section-5.26).  Vendor-Specific

   Description

      This Attribute is available to allow vendors to support their own
      extended Attributes not suitable for general usage.  It MUST not
      affect the operation of the RADIUS protocol.

      Servers not equipped to interpret the vendor-specific information
      sent by a client MUST ignore it (although it may be reported).
      Clients which do not receive desired vendor-specific information
      SHOULD make an attempt to operate without it, although they may do
      so (and report they are doing so) in a degraded mode.

   A summary of the Vendor-Specific Attribute format is shown below.
   The fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |  Length       |            Vendor-Id
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        Vendor-Id (cont)           |  String...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      26 for Vendor-Specific.

   Length

      >= 7

   Vendor-Id

      The high-order octet is 0 and the low-order 3 octets are the SMI
      Network Management Private Enterprise Code of the Vendor in
      network byte order, as defined in the "Assigned Numbers" RFC [[6](#ref-6 "\"Assigned Numbers\"")].

   String

      The String field is one or more octets.  The actual format of the
      information is site or application specific, and a robust
      implementation SHOULD support the field as undistinguished octets.

      The codification of the range of allowed usage of this field is
      outside the scope of this specification.

Rigney, et al.              Standards Track                    [Page 47]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

      It SHOULD be encoded as a sequence of vendor type / vendor length
      / value fields, as follows.  The Attribute-Specific field is
      dependent on the vendor's definition of that attribute.  An
      example encoding of the Vendor-Specific attribute using this
      method follows:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |  Length       |            Vendor-Id
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
           Vendor-Id (cont)           | Vendor type   | Vendor length |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    Attribute-Specific...
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

      Multiple subattributes MAY be encoded within a single Vendor-
      Specific attribute, although they do not have to be.

[5.27](#section-5.27).  Session-Timeout

   Description

      This Attribute sets the maximum number of seconds of service to be
      provided to the user before termination of the session or prompt.
      This Attribute is available to be sent by the server to the client
      in an Access-Accept or Access-Challenge.

   A summary of the Session-Timeout Attribute format is shown below.
   The fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      27 for Session-Timeout.

   Length

      6

Rigney, et al.              Standards Track                    [Page 48]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Value

      The field is 4 octets, containing a 32-bit unsigned integer with
      the maximum number of seconds this user should be allowed to
      remain connected by the NAS.

[5.28](#section-5.28).  Idle-Timeout

   Description

      This Attribute sets the maximum number of consecutive seconds of
      idle connection allowed to the user before termination of the
      session or prompt.  This Attribute is available to be sent by the
      server to the client in an Access-Accept or Access-Challenge.

   A summary of the Idle-Timeout Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      28 for Idle-Timeout.

   Length

      6

   Value

      The field is 4 octets, containing a 32-bit unsigned integer with
      the maximum number of consecutive seconds of idle time this user
      should be permitted before being disconnected by the NAS.

[5.29](#section-5.29).  Termination-Action

   Description

      This Attribute indicates what action the NAS should take when the
      specified service is completed.  It is only used in Access-Accept
      packets.

Rigney, et al.              Standards Track                    [Page 49]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   A summary of the Termination-Action Attribute format is shown below.
   The fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      29 for Termination-Action.

   Length

      6

   Value

      The Value field is four octets.

       0      Default
       1      RADIUS-Request

      If the Value is set to RADIUS-Request, upon termination of the
      specified service the NAS MAY send a new Access-Request to the
      RADIUS server, including the State attribute if any.

[5.30](#section-5.30).  Called-Station-Id

   Description

      This Attribute allows the NAS to send in the Access-Request packet
      the phone number that the user called, using Dialed Number
      Identification (DNIS) or similar technology.  Note that this may
      be different from the phone number the call comes in on.  It is
      only used in Access-Request packets.

   A summary of the Called-Station-Id Attribute format is shown below.
   The fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

Rigney, et al.              Standards Track                    [Page 50]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Type

      30 for Called-Station-Id.

   Length

      >= 3

   String

      The String field is one or more octets, containing the phone
      number that the user's call came in on.

      The actual format of the information is site or application
      specific.  UTF-8 encoded 10646 [[7](#ref-7 "\"UTF-8, a transformation format of ISO 10646\"")] characters are recommended, but
      a robust implementation SHOULD support the field as
      undistinguished octets.

      The codification of the range of allowed usage of this field is
      outside the scope of this specification.

[5.31](#section-5.31).  Calling-Station-Id

   Description

      This Attribute allows the NAS to send in the Access-Request packet
      the phone number that the call came from, using Automatic Number
      Identification (ANI) or similar technology.  It is only used in
      Access-Request packets.

   A summary of the Calling-Station-Id Attribute format is shown below.
   The fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      31 for Calling-Station-Id.

   Length

      >= 3

Rigney, et al.              Standards Track                    [Page 51]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   String

      The String field is one or more octets, containing the phone
      number that the user placed the call from.

      The actual format of the information is site or application
      specific.  UTF-8 encoded 10646 [[7](#ref-7 "\"UTF-8, a transformation format of ISO 10646\"")] characters are recommended, but
      a robust implementation SHOULD support the field as
      undistinguished octets.

      The codification of the range of allowed usage of this field is
      outside the scope of this specification.

[5.32](#section-5.32).  NAS-Identifier

   Description

      This Attribute contains a string identifying the NAS originating
      the Access-Request.  It is only used in Access-Request packets.
      Either NAS-IP-Address or NAS-Identifier MUST be present in an
      Access-Request packet.

      Note that NAS-Identifier MUST NOT be used to select the shared
      secret used to authenticate the request.  The source IP address of
      the Access-Request packet MUST be used to select the shared
      secret.

   A summary of the NAS-Identifier Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      32 for NAS-Identifier.

   Length

      >= 3

Rigney, et al.              Standards Track                    [Page 52]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   String

      The String field is one or more octets, and should be unique to
      the NAS within the scope of the RADIUS server.  For example, a
      fully qualified domain name would be suitable as a NAS-Identifier.

      The actual format of the information is site or application
      specific, and a robust implementation SHOULD support the field as
      undistinguished octets.

      The codification of the range of allowed usage of this field is
      outside the scope of this specification.

[5.33](#section-5.33).  Proxy-State

   Description

      This Attribute is available to be sent by a proxy server to
      another server when forwarding an Access-Request and MUST be
      returned unmodified in the Access-Accept, Access-Reject or
      Access-Challenge.  When the proxy server receives the response to
      its request, it MUST remove its own Proxy-State (the last Proxy-
      State in the packet) before forwarding the response to the NAS.

      If a Proxy-State Attribute is added to a packet when forwarding
      the packet, the Proxy-State Attribute MUST be added after any
      existing Proxy-State attributes.

      The content of any Proxy-State other than the one added by the
      current server should be treated as opaque octets and MUST NOT
      affect operation of the protocol.

      Usage of the Proxy-State Attribute is implementation dependent.  A
      description of its function is outside the scope of this
      specification.

   A summary of the Proxy-State Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      33 for Proxy-State.

Rigney, et al.              Standards Track                    [Page 53]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Length

      >= 3

   String

      The String field is one or more octets.  The actual format of the
      information is site or application specific, and a robust
      implementation SHOULD support the field as undistinguished octets.

      The codification of the range of allowed usage of this field is
      outside the scope of this specification.

[5.34](#section-5.34).  Login-LAT-Service

   Description

      This Attribute indicates the system with which the user is to be
      connected by LAT.  It MAY be used in Access-Accept packets, but
      only when LAT is specified as the Login-Service.  It MAY be used
      in an Access-Request packet as a hint to the server, but the
      server is not required to honor the hint.

      Administrators use the service attribute when dealing with
      clustered systems, such as a VAX or Alpha cluster. In such an
      environment several different time sharing hosts share the same
      resources (disks, printers, etc.), and administrators often
      configure each to offer access (service) to each of the shared
      resources. In this case, each host in the cluster advertises its
      services through LAT broadcasts.

      Sophisticated users often know which service providers (machines)
      are faster and tend to use a node name when initiating a LAT
      connection.  Alternately, some administrators want particular
      users to use certain machines as a primitive form of load
      balancing (although LAT knows how to do load balancing itself).

   A summary of the Login-LAT-Service Attribute format is shown below.
   The fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

Rigney, et al.              Standards Track                    [Page 54]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Type

      34 for Login-LAT-Service.

   Length

      >= 3

   String

      The String field is one or more octets, and contains the identity
      of the LAT service to use.  The LAT Architecture allows this
      string to contain $ (dollar), - (hyphen), . (period), _
      (underscore), numerics, upper and lower case alphabetics, and the
      ISO Latin-1 character set extension [[11](#ref-11)].  All LAT string
      comparisons are case insensitive.

[5.35](#section-5.35).  Login-LAT-Node

   Description

      This Attribute indicates the Node with which the user is to be
      automatically connected by LAT.  It MAY be used in Access-Accept
      packets, but only when LAT is specified as the Login-Service.  It
      MAY be used in an Access-Request packet as a hint to the server,
      but the server is not required to honor the hint.

   A summary of the Login-LAT-Node Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      35 for Login-LAT-Node.

   Length

      >= 3

Rigney, et al.              Standards Track                    [Page 55]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   String

      The String field is one or more octets, and contains the identity
      of the LAT Node to connect the user to.  The LAT Architecture
      allows this string to contain $ (dollar), - (hyphen), . (period),
      _ (underscore), numerics, upper and lower case alphabetics, and
      the ISO Latin-1 character set extension.  All LAT string
      comparisons are case insensitive.

[5.36](#section-5.36).  Login-LAT-Group

   Description

      This Attribute contains a string identifying the LAT group codes
      which this user is authorized to use.  It MAY be used in Access-
      Accept packets, but only when LAT is specified as the Login-
      Service.  It MAY be used in an Access-Request packet as a hint to
      the server, but the server is not required to honor the hint.

      LAT supports 256 different group codes, which LAT uses as a form
      of access rights.  LAT encodes the group codes as a 256 bit
      bitmap.

      Administrators can assign one or more of the group code bits at
      the LAT service provider; it will only accept LAT connections that
      have these group codes set in the bit map. The administrators
      assign a bitmap of authorized group codes to each user; LAT gets
      these from the operating system, and uses these in its requests to
      the service providers.

   A summary of the Login-LAT-Group Attribute format is shown below.
   The fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      36 for Login-LAT-Group.

   Length

      34

Rigney, et al.              Standards Track                    [Page 56]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   String

      The String field is a 32 octet bit map, most significant octet
      first.  A robust implementation SHOULD support the field as
      undistinguished octets.

      The codification of the range of allowed usage of this field is
      outside the scope of this specification.

[5.37](#section-5.37).  Framed-AppleTalk-Link

   Description

      This Attribute indicates the AppleTalk network number which should
      be used for the serial link to the user, which is another
      AppleTalk router.  It is only used in Access-Accept packets.  It
      is never used when the user is not another router.

   A summary of the Framed-AppleTalk-Link Attribute format is shown
   below.  The fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      37 for Framed-AppleTalk-Link.

   Length

      6

   Value

      The Value field is four octets.  Despite the size of the field,
      values range from 0 to 65535.  The special value of 0 indicates
      that this is an unnumbered serial link.  A value of 1-65535 means
      that the serial line between the NAS and the user should be
      assigned that value as an AppleTalk network number.

Rigney, et al.              Standards Track                    [Page 57]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[5.38](#section-5.38).  Framed-AppleTalk-Network

   Description

      This Attribute indicates the AppleTalk Network number which the
      NAS should probe to allocate an AppleTalk node for the user.  It
      is only used in Access-Accept packets.  It is never used when the
      user is another router.  Multiple instances of this Attribute
      indicate that the NAS may probe using any of the network numbers
      specified.

   A summary of the Framed-AppleTalk-Network Attribute format is shown
   below.  The fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      38 for Framed-AppleTalk-Network.

   Length

      6

   Value

      The Value field is four octets.  Despite the size of the field,
      values range from 0 to 65535.  The special value 0 indicates that
      the NAS should assign a network for the user, using its default
      cable range.  A value between 1 and 65535 (inclusive) indicates
      the AppleTalk Network the NAS should probe to find an address for
      the user.

[5.39](#section-5.39).  Framed-AppleTalk-Zone

   Description

      This Attribute indicates the AppleTalk Default Zone to be used for
      this user.  It is only used in Access-Accept packets.  Multiple
      instances of this attribute in the same packet are not allowed.

Rigney, et al.              Standards Track                    [Page 58]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   A summary of the Framed-AppleTalk-Zone Attribute format is shown
   below.  The fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      39 for Framed-AppleTalk-Zone.

   Length

      >= 3

   String

      The name of the Default AppleTalk Zone to be used for this user.
      A robust implementation SHOULD support the field as
      undistinguished octets.

      The codification of the range of allowed usage of this field is
      outside the scope of this specification.

[5.40](#section-5.40).  CHAP-Challenge

   Description

      This Attribute contains the CHAP Challenge sent by the NAS to a
      PPP Challenge-Handshake Authentication Protocol (CHAP) user.  It
      is only used in Access-Request packets.

      If the CHAP challenge value is 16 octets long it MAY be placed in
      the Request Authenticator field instead of using this attribute.

   A summary of the CHAP-Challenge Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |    String...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

Rigney, et al.              Standards Track                    [Page 59]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Type

      60 for CHAP-Challenge.

   Length

      >= 7

   String

      The String field contains the CHAP Challenge.

[5.41](#section-5.41).  NAS-Port-Type

   Description

      This Attribute indicates the type of the physical port of the NAS
      which is authenticating the user.  It can be used instead of or in
      addition to the NAS-Port (5) attribute.  It is only used in
      Access-Request packets.  Either NAS-Port (5) or NAS-Port-Type or
      both SHOULD be present in an Access-Request packet, if the NAS
      differentiates among its ports.

   A summary of the NAS-Port-Type Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      61 for NAS-Port-Type.

   Length

      6

   Value

      The Value field is four octets.  "Virtual" refers to a connection
      to the NAS via some transport protocol, instead of through a
      physical port.  For example, if a user telnetted into a NAS to

Rigney, et al.              Standards Track                    [Page 60]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

      authenticate himself as an Outbound-User, the Access-Request might
      include NAS-Port-Type = Virtual as a hint to the RADIUS server
      that the user was not on a physical port.

      0       Async
      1       Sync
      2       ISDN Sync
      3       ISDN Async V.120
      4       ISDN Async V.110
      5       Virtual
      6       PIAFS
      7       HDLC Clear Channel
      8       X.25
      9       X.75
      10      G.3 Fax
      11      SDSL - Symmetric DSL
      12      ADSL-CAP - Asymmetric DSL, Carrierless Amplitude Phase
              Modulation
      13      ADSL-DMT - Asymmetric DSL, Discrete Multi-Tone
      14      IDSL - ISDN Digital Subscriber Line
      15      Ethernet
      16      xDSL - Digital Subscriber Line of unknown type
      17      Cable
      18      Wireless - Other
      19      Wireless - IEEE 802.11

      PIAFS is a form of wireless ISDN commonly used in Japan, and
      stands for PHS (Personal Handyphone System) Internet Access Forum
      Standard (PIAFS).

[5.42](#section-5.42).  Port-Limit

   Description

      This Attribute sets the maximum number of ports to be provided to
      the user by the NAS.  This Attribute MAY be sent by the server to
      the client in an Access-Accept packet.  It is intended for use in
      conjunction with Multilink PPP [[12](#ref-12 "\"The PPP Multilink Protocol (MP)\"")] or similar uses.  It MAY also
      be sent by the NAS to the server as a hint that that many ports
      are desired for use, but the server is not required to honor the
      hint.

   A summary of the Port-Limit Attribute format is shown below.  The
   fields are transmitted from left to right.

Rigney, et al.              Standards Track                    [Page 61]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Value
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              Value (cont)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type

      62 for Port-Limit.

   Length

      6

   Value

      The field is 4 octets, containing a 32-bit unsigned integer with
      the maximum number of ports this user should be allowed to connect
      to on the NAS.

[5.43](#section-5.43).  Login-LAT-Port

   Description

      This Attribute indicates the Port with which the user is to be
      connected by LAT.  It MAY be used in Access-Accept packets, but
      only when LAT is specified as the Login-Service.  It MAY be used
      in an Access-Request packet as a hint to the server, but the
      server is not required to honor the hint.

   A summary of the Login-LAT-Port Attribute format is shown below.  The
   fields are transmitted from left to right.

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
   |     Type      |    Length     |  String ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   Type

      63 for Login-LAT-Port.

   Length

      >= 3

Rigney, et al.              Standards Track                    [Page 62]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   String

      The String field is one or more octets, and contains the identity
      of the LAT port to use.  The LAT Architecture allows this string
      to contain $ (dollar), - (hyphen), . (period), _ (underscore),
      numerics, upper and lower case alphabetics, and the ISO Latin-1
      character set extension.  All LAT string comparisons are case
      insensitive.

[5.44](#section-5.44).  Table of Attributes

   The following table provides a guide to which attributes may be found
   in which kinds of packets, and in what quantity.

   Request   Accept   Reject   Challenge   #    Attribute
   0-1       0-1      0        0            1   User-Name
   0-1       0        0        0            2   User-Password [Note 1]
   0-1       0        0        0            3   CHAP-Password [Note 1]
   0-1       0        0        0            4   NAS-IP-Address [Note 2]
   0-1       0        0        0            5   NAS-Port
   0-1       0-1      0        0            6   Service-Type
   0-1       0-1      0        0            7   Framed-Protocol
   0-1       0-1      0        0            8   Framed-IP-Address
   0-1       0-1      0        0            9   Framed-IP-Netmask
   0         0-1      0        0           10   Framed-Routing
   0         0+       0        0           11   Filter-Id
   0-1       0-1      0        0           12   Framed-MTU
   0+        0+       0        0           13   Framed-Compression
   0+        0+       0        0           14   Login-IP-Host
   0         0-1      0        0           15   Login-Service
   0         0-1      0        0           16   Login-TCP-Port
   0         0+       0+       0+          18   Reply-Message
   0-1       0-1      0        0           19   Callback-Number
   0         0-1      0        0           20   Callback-Id
   0         0+       0        0           22   Framed-Route
   0         0-1      0        0           23   Framed-IPX-Network
   0-1       0-1      0        0-1         24   State [Note 1]
   0         0+       0        0           25   Class
   0+        0+       0        0+          26   Vendor-Specific
   0         0-1      0        0-1         27   Session-Timeout
   0         0-1      0        0-1         28   Idle-Timeout
   0         0-1      0        0           29   Termination-Action
   0-1       0        0        0           30   Called-Station-Id
   0-1       0        0        0           31   Calling-Station-Id
   0-1       0        0        0           32   NAS-Identifier [Note 2]
   0+        0+       0+       0+          33   Proxy-State
   0-1       0-1      0        0           34   Login-LAT-Service
   0-1       0-1      0        0           35   Login-LAT-Node

Rigney, et al.              Standards Track                    [Page 63]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   0-1       0-1      0        0           36   Login-LAT-Group
   0         0-1      0        0           37   Framed-AppleTalk-Link
   0         0+       0        0           38   Framed-AppleTalk-Network
   0         0-1      0        0           39   Framed-AppleTalk-Zone
   0-1       0        0        0           60   CHAP-Challenge
   0-1       0        0        0           61   NAS-Port-Type
   0-1       0-1      0        0           62   Port-Limit
   0-1       0-1      0        0           63   Login-LAT-Port
   Request   Accept   Reject   Challenge   #    Attribute

   [Note 1] An Access-Request MUST contain either a User-Password or a
   CHAP-Password or State.  An Access-Request MUST NOT contain both a
   User-Password and a CHAP-Password.  If future extensions allow other
   kinds of authentication information to be conveyed, the attribute for
   that can be used in an Access-Request instead of User-Password or
   CHAP-Password.

   [Note 2] An Access-Request MUST contain either a NAS-IP-Address or a
   NAS-Identifier (or both).

   The following table defines the meaning of the above table entries.

[0](#section-0)     This attribute MUST NOT be present in packet.
0+    Zero or more instances of this attribute MAY be present in packet.
0-1   Zero or one instance of this attribute MAY be present in packet.
[1](#section-1)     Exactly one instance of this attribute MUST be present in packet.

[6](#section-6).  IANA Considerations

   This section provides guidance to the Internet Assigned Numbers
   Authority (IANA) regarding registration of values related to the
   RADIUS protocol, in accordance with [BCP 26](/doc/html/bcp26) [[13](#ref-13)].

   There are three name spaces in RADIUS that require registration:
   Packet Type Codes, Attribute Types, and Attribute Values (for certain
   Attributes).

   RADIUS is not intended as a general-purpose Network Access Server
   (NAS) management protocol, and allocations should not be made for
   purposes unrelated to Authentication, Authorization or Accounting.

[6.1](#section-6.1).  Definition of Terms

   The following terms are used here with the meanings defined in
   [BCP 26](/doc/html/bcp26): "name space", "assigned value", "registration".

Rigney, et al.              Standards Track                    [Page 64]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   The following policies are used here with the meanings defined in
   [BCP 26](/doc/html/bcp26): "Private Use", "First Come First Served", "Expert Review",
   "Specification Required", "IETF Consensus", "Standards Action".

[6.2](#section-6.2).  Recommended Registration Policies

   For registration requests where a Designated Expert should be
   consulted, the IESG Area Director for Operations should appoint the
   Designated Expert.

   For registration requests requiring Expert Review, the ietf-radius
   mailing list should be consulted.

   Packet Type Codes have a range from 1 to 254, of which 1-5,11-13 have
   been allocated.  Because a new Packet Type has considerable impact on
   interoperability, a new Packet Type Code requires Standards Action,
   and should be allocated starting at 14.

   Attribute Types have a range from 1 to 255, and are the scarcest
   resource in RADIUS, thus must be allocated with care.  Attributes
   1-53,55,60-88,90-91 have been allocated, with 17 and 21 available for
   re-use.  Attributes 17, 21, 54, 56-59, 89, 92-191 may be allocated
   following Expert Review, with Specification Required.  Release of
   blocks of Attribute Types (more than 3 at a time for a given purpose)
   should require IETF Consensus.  It is recommended that attributes 17
   and 21 be used only after all others are exhausted.

   Note that RADIUS defines a mechanism for Vendor-Specific extensions
   (Attribute 26) and the use of that should be encouraged instead of
   allocation of global attribute types, for functions specific only to
   one vendor's implementation of RADIUS, where no interoperability is
   deemed useful.

   As stated in the "Attributes" section above:

      "[Attribute Type] Values 192-223 are reserved for experimental
      use, values 224-240 are reserved for implementation-specific use,
      and values 241-255 are reserved and should not be used."

   Therefore Attribute values 192-240 are considered Private Use, and
   values 241-255 require Standards Action.

   Certain attributes (for example, NAS-Port-Type) in RADIUS define a
   list of values to correspond with various meanings.  There can be 4
   billion (2^32) values for each attribute. Adding additional values to
   the list can be done on a First Come, First Served basis by the IANA.

Rigney, et al.              Standards Track                    [Page 65]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[7](#section-7).  Examples

   A few examples are presented to illustrate the flow of packets and
   use of typical attributes.  These examples are not intended to be
   exhaustive, many others are possible.  Hexadecimal dumps of the
   example packets are given in network byte order, using the shared
   secret "xyzzy5461".

[7.1](#section-7.1).  User Telnet to Specified Host

   The NAS at 192.168.1.16 sends an Access-Request UDP packet to the
   RADIUS Server for a user named nemo logging in on port 3 with
   password "arctangent".

   The Request Authenticator is a 16 octet random number generated by
   the NAS.

   The User-Password is 16 octets of password padded at end with nulls,
   XORed with MD5(shared secret|Request Authenticator).

      01 00 00 38 0f 40 3f 94 73 97 80 57 bd 83 d5 cb
      98 f4 22 7a 01 06 6e 65 6d 6f 02 12 0d be 70 8d
      93 d4 13 ce 31 96 e4 3f 78 2a 0a ee 04 06 c0 a8
      01 10 05 06 00 00 00 03

       1 Code = Access-Request (1)
       1 ID = 0
       2 Length = 56
      16 Request Authenticator

      Attributes:
       6  User-Name = "nemo"
      18  User-Password
       6  NAS-IP-Address = 192.168.1.16
       6  NAS-Port = 3

   The RADIUS server authenticates nemo, and sends an Access-Accept UDP
   packet to the NAS telling it to telnet nemo to host 192.168.1.3.

   The Response Authenticator is a 16-octet MD5 checksum of the code
   (2), id (0), Length (38), the Request Authenticator from above, the
   attributes in this reply, and the shared secret.

Rigney, et al.              Standards Track                    [Page 66]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

      02 00 00 26 86 fe 22 0e 76 24 ba 2a 10 05 f6 bf
      9b 55 e0 b2 06 06 00 00 00 01 0f 06 00 00 00 00
      0e 06 c0 a8 01 03

       1 Code = Access-Accept (2)
       1 ID = 0 (same as in Access-Request)
       2 Length = 38
      16 Response Authenticator

      Attributes:
       6  Service-Type (6) = Login (1)
       6  Login-Service (15) = Telnet (0)
       6  Login-IP-Host (14) = 192.168.1.3

[7.2](#section-7.2).  Framed User Authenticating with CHAP

   The NAS at 192.168.1.16 sends an Access-Request UDP packet to the
   RADIUS Server for a user named flopsy logging in on port 20 with PPP,
   authenticating using CHAP.  The NAS sends along the Service-Type and
   Framed-Protocol attributes as a hint to the RADIUS server that this
   user is looking for PPP, although the NAS is not required to do so.

   The Request Authenticator is a 16 octet random number generated by
   the NAS, and is also used as the CHAP Challenge.

   The CHAP-Password consists of a 1 octet CHAP ID, in this case 22,
   followed by the 16 octet CHAP response.

      01 01 00 47 2a ee 86 f0 8d 0d 55 96 9c a5 97 8e
      0d 33 67 a2 01 08 66 6c 6f 70 73 79 03 13 16 e9
      75 57 c3 16 18 58 95 f2 93 ff 63 44 07 72 75 04
      06 c0 a8 01 10 05 06 00 00 00 14 06 06 00 00 00
      02 07 06 00 00 00 01

       1 Code = 1     (Access-Request)
       1 ID = 1
       2 Length = 71
      16 Request Authenticator

      Attributes:
       8  User-Name (1) = "flopsy"
      19  CHAP-Password (3)
       6  NAS-IP-Address (4) = 192.168.1.16
       6  NAS-Port (5) = 20
       6  Service-Type (6) = Framed (2)
       6  Framed-Protocol (7) = PPP (1)

Rigney, et al.              Standards Track                    [Page 67]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   The RADIUS server authenticates flopsy, and sends an Access-Accept
   UDP packet to the NAS telling it to start PPP service and assign an
   address for the user out of its dynamic address pool.

   The Response Authenticator is a 16-octet MD5 checksum of the code
   (2), id (1), Length (56), the Request Authenticator from above, the
   attributes in this reply, and the shared secret.

      02 01 00 38 15 ef bc 7d ab 26 cf a3 dc 34 d9 c0
      3c 86 01 a4 06 06 00 00 00 02 07 06 00 00 00 01
      08 06 ff ff ff fe 0a 06 00 00 00 02 0d 06 00 00
      00 01 0c 06 00 00 05 dc

       1 Code = Access-Accept (2)
       1 ID = 1 (same as in Access-Request)
       2 Length = 56
      16 Response Authenticator

      Attributes:
       6  Service-Type (6) = Framed (2)
       6  Framed-Protocol (7) = PPP (1)
       6  Framed-IP-Address (8) = 255.255.255.254
       6  Framed-Routing (10) = None (0)
       6  Framed-Compression (13) = VJ TCP/IP Header Compression (1)
       6  Framed-MTU (12) = 1500

[7.3](#section-7.3).  User with Challenge-Response card

   The NAS at 192.168.1.16 sends an Access-Request UDP packet to the
   RADIUS Server for a user named mopsy logging in on port 7.  The user
   enters the dummy password "challenge" in this example.  The challenge
   and response generated by the smart card for this example are
   "32769430" and "99101462".

   The Request Authenticator is a 16 octet random number generated by
   the NAS.

   The User-Password is 16 octets of password, in this case "challenge",
   padded at the end with nulls, XORed with MD5(shared secret|Request
   Authenticator).

      01 02 00 39 f3 a4 7a 1f 6a 6d 76 71 0b 94 7a b9
      30 41 a0 39 01 07 6d 6f 70 73 79 02 12 33 65 75
      73 77 82 89 b5 70 88 5e 15 08 48 25 c5 04 06 c0
      a8 01 10 05 06 00 00 00 07

Rigney, et al.              Standards Track                    [Page 68]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

       1 Code = Access-Request (1)
       1 ID = 2
       2 Length = 57
      16 Request Authenticator

      Attributes:
       7 User-Name (1) = "mopsy"
      18 User-Password (2)
       6  NAS-IP-Address (4) = 192.168.1.16
       6  NAS-Port (5) = 7

   The RADIUS server decides to challenge mopsy, sending back a
   challenge string and looking for a response.  The RADIUS server
   therefore and sends an Access-Challenge UDP packet to the NAS.

   The Response Authenticator is a 16-octet MD5 checksum of the code
   (11), id (2), length (78), the Request Authenticator from above, the
   attributes in this reply, and the shared secret.

   The Reply-Message is "Challenge 32769430.  Enter response at prompt."

   The State is a magic cookie to be returned along with user's
   response; in this example 8 octets of data (33 32 37 36 39 34 33 30
   in hex).

      0b 02 00 4e 36 f3 c8 76 4a e8 c7 11 57 40 3c 0c
      71 ff 9c 45 12 30 43 68 61 6c 6c 65 6e 67 65 20
      33 32 37 36 39 34 33 30 2e 20 20 45 6e 74 65 72
      20 72 65 73 70 6f 6e 73 65 20 61 74 20 70 72 6f
      6d 70 74 2e 18 0a 33 32 37 36 39 34 33 30

       1 Code = Access-Challenge (11)
       1 ID = 2 (same as in Access-Request)
       2 Length = 78
      16 Response Authenticator

      Attributes:
      48  Reply-Message (18)
      10  State (24)

   The user enters his response, and the NAS send a new Access-Request
   with that response, and includes the State Attribute.

   The Request Authenticator is a new 16 octet random number.

   The User-Password is 16 octets of the user's response, in this case
   "99101462", padded at the end with nulls, XORed with MD5(shared
   secret|Request Authenticator).

Rigney, et al.              Standards Track                    [Page 69]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   The state is the magic cookie from the Access-Challenge packet,
   unchanged.

      01 03 00 43 b1 22 55 6d 42 8a 13 d0 d6 25 38 07
      c4 57 ec f0 01 07 6d 6f 70 73 79 02 12 69 2c 1f
      20 5f c0 81 b9 19 b9 51 95 f5 61 a5 81 04 06 c0
      a8 01 10 05 06 00 00 00 07 18 10 33 32 37 36 39
      34 33 30

       1 Code = Access-Request (1)
       1 ID = 3 (Note that this changes.)
       2 Length = 67
      16 Request Authenticator

      Attributes:
       7  User-Name = "mopsy"
      18  User-Password
       6  NAS-IP-Address (4) = 192.168.1.16
       6  NAS-Port (5) = 7
      10  State (24)

   The Response was incorrect (for the sake of example), so the RADIUS
   server tells the NAS to reject the login attempt.

   The Response Authenticator is a 16 octet MD5 checksum of the code
   (3), id (3), length(20), the Request Authenticator from above, the
   attributes in this reply (in this case, none), and the shared secret.

      03 03 00 14 a4 2f 4f ca 45 91 6c 4e 09 c8 34 0f
      9e 74 6a a0

       1 Code = Access-Reject (3)
       1 ID = 3 (same as in Access-Request)
       2 Length = 20
      16 Response Authenticator

      Attributes:
         (none, although a Reply-Message could be sent)

Rigney, et al.              Standards Track                    [Page 70]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[8](#section-8).  Security Considerations

   Security issues are the primary topic of this document.

   In practice, within or associated with each RADIUS server, there is a
   database which associates "user" names with authentication
   information ("secrets").  It is not anticipated that a particular
   named user would be authenticated by multiple methods.  This would
   make the user vulnerable to attacks which negotiate the least secure
   method from among a set.  Instead, for each named user there should
   be an indication of exactly one method used to authenticate that user
   name.  If a user needs to make use of different authentication
   methods under different circumstances, then distinct user names
   SHOULD be employed, each of which identifies exactly one
   authentication method.

   Passwords and other secrets should be stored at the respective ends
   such that access to them is as limited as possible.  Ideally, the
   secrets should only be accessible to the process requiring access in
   order to perform the authentication.

   The secrets should be distributed with a mechanism that limits the
   number of entities that handle (and thus gain knowledge of) the
   secret.  Ideally, no unauthorized person should ever gain knowledge
   of the secrets.  It is possible to achieve this with SNMP Security
   Protocols [[14](#ref-14 "\"SNMP Security Protocols\"")], but such a mechanism is outside the scope of this
   specification.

   Other distribution methods are currently undergoing research and
   experimentation.  The SNMP Security document [[14](#ref-14 "\"SNMP Security Protocols\"")] also has an
   excellent overview of threats to network protocols.

   The User-Password hiding mechanism described in [Section 5.2](#section-5.2) has not
   been subjected to significant amounts of cryptanalysis in the
   published literature.  Some in the IETF community are concerned that
   this method might not provide sufficient confidentiality protection
   [[15](#ref-15 "\"The Status of MD5 After a Recent Attack\"")] to passwords transmitted using RADIUS.  Users should evaluate
   their threat environment and consider whether additional security
   mechanisms should be employed.

[9](#section-9).  Change Log

   The following changes have been made from [RFC 2138](/doc/html/rfc2138):

   Strings should use UTF-8 instead of US-ASCII and should be handled as
   8-bit data.

   Integers and dates are now defined as 32 bit unsigned values.

Rigney, et al.              Standards Track                    [Page 71]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   Updated list of attributes that can be included in Access-Challenge
   to be consistent with the table of attributes.

   User-Name mentions Network Access Identifiers.

   User-Name may now be sent in Access-Accept for use with accounting
   and Rlogin.

   Values added for Service-Type, Login-Service, Framed-Protocol,
   Framed-Compression, and NAS-Port-Type.

   NAS-Port can now use all 32 bits.

   Examples now include hexadecimal displays of the packets.

   Source UDP port must be used in conjunction with the Request
   Identifier when identifying duplicates.

   Multiple subattributes may be allowed in a Vendor-Specific attribute.

   An Access-Request is now required to contain either a NAS-IP-Address
   or NAS-Identifier (or may contain both).

   Added notes under "Operations" with more information on proxy,
   retransmissions, and keep-alives.

   If multiple Attributes with the same Type are present, the order of
   Attributes with the same Type MUST be preserved by any proxies.

   Clarified Proxy-State.

   Clarified that Attributes must not depend on position within the
   packet, as long as Attributes of the same type are kept in order.

   Added IANA Considerations section.

   Updated section on "Proxy" under "Operations".

   Framed-MTU can now be sent in Access-Request as a hint.

   Updated Security Considerations.

   Text strings identified as a subset of string, to clarify use of
   UTF-8.

Rigney, et al.              Standards Track                    [Page 72]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[10](#section-10).  References

   [1]   Rigney, C., Rubens, A., Simpson, W. and S. Willens, "Remote
         Authentication Dial In User Service (RADIUS)", [RFC 2138](/doc/html/rfc2138), April
         1997.

   [2]   Bradner, S., "Key words for use in RFCs to Indicate Requirement
         Levels", [BCP 14](/doc/html/bcp14), [RFC 2119](/doc/html/rfc2119), March, 1997.

   [3]   Rivest, R. and S. Dusse, "The MD5 Message-Digest Algorithm",
         [RFC 1321](/doc/html/rfc1321), April 1992.

   [4]   Postel, J., "User Datagram Protocol", STD 6, [RFC 768](/doc/html/rfc768), August
         1980.

   [5]   Rigney, C., "RADIUS Accounting", [RFC 2866](/doc/html/rfc2866), June 2000.

   [6]   Reynolds, J. and J. Postel, "Assigned Numbers", STD 2, [RFC](/doc/html/rfc1700)
         [1700](/doc/html/rfc1700), October 1994.

   [7]   Yergeau, F., "UTF-8, a transformation format of ISO 10646", [RFC](/doc/html/rfc2279)
         [2279](/doc/html/rfc2279), January 1998.

   [8]   Aboba, B. and M. Beadles, "The Network Access Identifier", [RFC](/doc/html/rfc2486)
         [2486](/doc/html/rfc2486), January 1999.

   [9]   Kaufman, C., Perlman, R., and Speciner, M., "Network Security:
         Private Communications in a Public World", Prentice Hall, March
         1995, ISBN 0-13-061466-1.

   [10]  Jacobson, V., "Compressing TCP/IP headers for low-speed serial
         links", [RFC 1144](/doc/html/rfc1144), February 1990.

   [11]  ISO 8859. International Standard -- Information Processing --
         8-bit Single-Byte Coded Graphic Character Sets -- Part 1: Latin
         Alphabet No. 1, ISO 8859-1:1987.

   [12]  Sklower, K., Lloyd, B., McGregor, G., Carr, D. and T.
         Coradetti, "The PPP Multilink Protocol (MP)", [RFC 1990](/doc/html/rfc1990), August
         1996.

   [13]  Alvestrand, H. and T. Narten, "Guidelines for Writing an IANA
         Considerations Section in RFCs", [BCP 26](/doc/html/bcp26), [RFC 2434](/doc/html/rfc2434), October
         1998.

   [14]  Galvin, J., McCloghrie, K. and J. Davin, "SNMP Security
         Protocols", [RFC 1352](/doc/html/rfc1352), July 1992.

Rigney, et al.              Standards Track                    [Page 73]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

   [15]  Dobbertin, H., "The Status of MD5 After a Recent Attack",
         CryptoBytes Vol.2 No.2, Summer 1996.

[11](#section-11).  Acknowledgements

   RADIUS was originally developed by Steve Willens of Livingston
   Enterprises for their PortMaster series of Network Access Servers.

[12](#section-12).  Chair's Address

   The working group can be contacted via the current chair:

   Carl Rigney
   Livingston Enterprises
   4464 Willow Road
   Pleasanton, California  94588

   Phone: +1 925 737 2100
   EMail: cdr@telemancy.com

Rigney, et al.              Standards Track                    [Page 74]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[13](#section-13).  Authors' Addresses

   Questions about this memo can also be directed to:

   Carl Rigney
   Livingston Enterprises
   4464 Willow Road
   Pleasanton, California  94588

   Phone: +1 925 737 2100
   EMail: cdr@telemancy.com

   Allan C. Rubens
   Merit Network, Inc.
   4251 Plymouth Road
   Ann Arbor, Michigan  48105-2785

   EMail: acr@merit.edu

   William Allen Simpson
   Daydreamer
   Computer Systems Consulting Services
   1384 Fontaine
   Madison Heights, Michigan  48071

   EMail: wsimpson@greendragon.com

   Steve Willens
   Livingston Enterprises
   4464 Willow Road
   Pleasanton, California  94588

   EMail: steve@livingston.com

Rigney, et al.              Standards Track                    [Page 75]
```

---

```

[RFC 2865](/doc/html/rfc2865)                         RADIUS                        June 2000

[14](#section-14).  Full Copyright Statement

   Copyright (C) The Internet Society (2000).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.

Rigney, et al.              Standards Track                    [Page 76]

```

[Datatracker](/doc/rfc2865/)

RFC 2865

RFC
- Draft Standard

* Info
* Contents
* Prefs

| Document | Document type |  | RFC - Draft Standard  June 2000  [View errata](https://www.rfc-editor.org/errata_search.php?rfc=2865 "Click to view errata.") [Report errata](https://www.rfc-editor.org/errata.php#reportnew "Click to report an error in the document.") [IPR](/ipr/search/?submit=draft&id=rfc2865 "Click to view IPR declarations.") Updated by [RFC 8044](/doc/html/rfc8044 "Data Types in RADIUS"), [RFC 2868](/doc/html/rfc2868 "RADIUS Attributes for Tunnel Protocol Support"), [RFC 3575](/doc/html/rfc3575 "IANA Considerations for RADIUS (Remote Authentication Dial In User Service)"), [RFC 5080](/doc/html/rfc5080 "Common Remote Authentication Dial In User Service (RADIUS) Implementation Issues and Suggested Fixes"), [RFC 6929](/doc/html/rfc6929 "Remote Authentication Dial In User Service (RADIUS) Protocol Extensions") Obsoletes [RFC 2138](/doc/html/rfc2138 "Remote Authentication Dial In User Service (RADIUS)") Was [draft-ietf-radius-radius-v2](/doc/draft-ietf-radius-radius-v2/05/) ([radius WG](/wg/radius/about/)) |
| --- | --- | --- | --- |
|  | Select version |  | * [05](/doc/html/draft-ietf-radius-radius-v2-05) * [RFC 2865](/doc/html/rfc2865) |
|  | Compare versions |  | RFC 2865  draft-ietf-radius-radius-v2-05  draft-ietf-radius-radius-v2-04  draft-ietf-radius-radius-v2-03  draft-ietf-radius-radius-v2-02  draft-ietf-radius-radius-v2-01  draft-ietf-radius-radius-v2-00   RFC 2865  draft-ietf-radius-radius-v2-05  draft-ietf-radius-radius-v2-04  draft-ietf-radius-radius-v2-03  draft-ietf-radius-radius-v2-02  draft-ietf-radius-radius-v2-01  draft-ietf-radius-radius-v2-00   Side-by-side  Inline |
|  | Authors |  | [Allan Rubens](/person/acr%40del.com "Datatracker profile of Allan Rubens") , [Carl Rigney](/person/cdr%40livingston.com "Datatracker profile of Carl Rigney") , [Steve Willens](/person/steve%40livingston.com "Datatracker profile of Steve Willens") , [William A. Simpson](/person/wsimpson%40umich.edu "Datatracker profile of William A. Simpson")   Email authors |
|  | RFC stream |  | IETF Logo IETF Logo |
|  | Other formats |  | [txt](https://www.rfc-editor.org/rfc/rfc2865.txt) [html](https://www.rfc-editor.org/rfc/rfc2865.html) [pdf](https://www.rfc-editor.org/rfc/pdfrfc/rfc2865.txt.pdf) [w/errata](https://www.rfc-editor.org/rfc/inline-errata/rfc2865.html) [bibtex](/doc/rfc2865/bibtex/) |
|  | Additional resources |  | Mailing list discussion |

[Report a datatracker bug](https://github.com/ietf-tools/datatracker/issues/new/choose)

Show sidebar by default

Yes

No

Tab to show by default

Info

Contents

HTMLization configuration

HTMLize the plaintext

Plaintextify the HTML

Maximum font size

Page dependencies

Inline

Reference

Citation links

 Go to reference section

Go to linked document

![](//analytics.ietf.org/piwik.php?idsite=7)


