

[Skip To Content](#main)

[Fireblocks](https://www.fireblocks.com)

Menu

* Platform
  + Back
    #### Platform

    ### Products

    - #### Treasury Management

      Manage and secure your digital asset treasury and trading operations.
    - #### Wallets as a Service

      Create secure MPC wallets at scale | Embedded Wallets and Direct Custody Wallets
    - #### Tokenization

      Securely mint, custody, and transfer tokenized assets and manage smart contracts.
    - #### Payments

      Suite of tools to accept, orchestrate, and settle digital asset payments.
  + ### Platform

    - #### Governance and Policy Engine

      Automate permissions, transaction rules, and approvals
    - #### Security

      Multi-layer key management, certifications, policies.
    - #### Staking

      Stake tokens and manage rewards across blockchains.
    - #### Compliance

      Automate detection and removal of high-risk transactions.
    - #### Fireblocks Network

      Simplify transfers and trading with trusted counterparties.
    - #### Off-Exchange

      Eliminate exchange counterparty risk
    - #### Flexible Deployment

      Cloud, Hybrid, On-Prem
    - #### DeFi

      Create and manage wallets for end users at scale.
    - #### Web3

      Automate permissions, transaction rules, and approvals.
    - #### Automation

      Eliminate manual operations in minutes[All Support and Integrations](/integrations/exchanges)
* Solutions
  + Back
    #### Solutions

    ### SOLUTIONS

    - #### Trading Firms
    - #### Fintechs and Exchanges
    - #### Financial Institutions
    - #### Web3 Companies
    - #### Blockchain Payments
    - #### Startups
  + ### ECOSYSTEM

    - #### Partners
    - #### Professional Services
    - #### Support
* Resources
  + Back
    #### Resources

    ###

    - #### SPARK
    - #### Blogs
    - #### Webinars
    - #### Customer Stories
    - #### White Papers and Guides
    - #### Fireblocks Academy
    - #### ETH Savings Calculator
  + ###
* [Developers](https://www.fireblocks.com/developers/)
* Company
  + Back
    #### Company

    ###

    - #### About Fireblocks
    - #### Executive Team
    - #### Culture
    - #### Careers
  + ###
* [Pricing](https://www.fireblocks.com/pricing/)
* [Login](https://console.fireblocks.io/)
* [Try in Sandbox](https://www.fireblocks.com/developer-sandbox-sign-up/)
* [Request Demo](https://www.fireblocks.com/#request-demo/)

![](/wp-content/themes/studio-simpatico/public/img/orange-blur.svg)
![](/wp-content/themes/studio-simpatico/public/img/blue-blur.svg)

August 9, 2023

[Knowledge Base](https://www.fireblocks.com/category/knowledge-base/)

# GG18 and GG20 Paillier Key Vulnerability [CVE-2023-33241]: Technical Report

[![Marketing Headshot](https://www.fireblocks.com/wp-content/uploads/2024/05/FB-user-profile.jpg)

Daniel Evans

Marketing](https://www.fireblocks.com/author/daniel-evans)

9 min. read
![](https://www.fireblocks.com/wp-content/uploads/2023/08/Fireblocks-BitForge-Tech-GG-Blog_2x-1024x572.jpg)

This newfound vulnerability allows an attacker to extract a full private key from any wallet using the GG18 and GG20 protocols. More than 10 wallets and libraries have been found vulnerable, including Binance custody.

## Executive Summary

Fireblocks’ research team has discovered a vulnerability in the specification of two popular multi-party computation (MPC) protocols: [GG18](https://eprint.iacr.org/2019/114) and [GG20](https://eprint.iacr.org/2020/540). These protocols are considered pioneering for the MPC wallet industry and have been widely adopted by companies in the space. The vulnerability was found at the pseudocode level, and **all vendors implementing the protocol should be considered vulnerable**. The vulnerability can be exploited **to exfiltrate the key.**

The vulnerability originates with parties not checking to see if the attacker’s Paillier modulus, denoted N, has small factors or that it is a biprime. If exploited, the vulnerability allows a threat actor interacting with the signatories in the MPC protocol to steal their secret shards and ultimately obtain the master secret key. The severity of the vulnerability depends on the implementation parameters, so different parameter choices give rise to different attacks with varying degrees of effort/resources required to extract the full key. **Some implementations are vulnerable to key extraction in 16 signatures**, while others could require as many as 1 billion signatures.

The exploit was validated on major open source implementations and a working POC was built on one of the open libraries.

We ran a responsible disclosure process with more than 10 wallet providers, blockchains and libraries in parallel and actively looked for impacted products, but given the popularity of the protocols we assume additional products might be impacted.

## Vulnerability Risk Profile

The vulnerability is a full private key extraction vulnerability allowing the attacker to steal all funds that are kept in the crypto wallet. The main source of the vulnerability is that the signatories’ Paillier public keys are not checked for small prime factors, where a prime of size, sayß, 2\*\*20 is considered small.

Since the severity of the vulnerability depends on the implementation parameters, different parameter choices give rise to different attacks with varying degrees of effort/resources required to extract the full key. Namely, the distinguishing parameter choices are as follows:

**1.** Beta Parameter in MTA ~ q^5 (where q is the size of the elliptic curve)

**2.** Beta Parameter in MTA ~ N (where N is the Paillier public key of the compromised party

*a. N is not checked for small factors at all (not even 3,5,7,..)*
*b. N is checked manually for smallish factors (< 2\*\*12)*

***Case 1.*** By using maliciously-crafted messages, the attacker obtains leakage of the private key shards of the parties by interacting with the signatories in the first round of the MPC protocol. To obtain the full private key, it is sufficient to iterate the attack **sixteen** times.

A specific sub-scenario of Case1 was identified in the [Apache Milagro](https://github.com/apache/incubator-milagro-MPC) library which had an extremely low beta parameter (256 bits) allowing an attacker to extract the key without crafting any malicious messages and simply recovering the key from the transcript of the signature ceremony.

***Case 2.*** In this case, the attacker actively controls one of the signatories (so it also needs to “know” the corresponding secret shard) and interacts with the signatories for the entire MPC protocol. By using maliciously-crafted messages, the attacker obtains leakage of the private key shards whenever the signature generation process terminates successfully. The total number of signature-generation attempts depends on the number of parties and the malicious Paillier modulus N. For two parties, the number of (failed) signatures ranges from 200K (for case 2.a) to 1B (for case 2.b).

## Recommended mitigation for clients

Since GG18/20 is a widely used MPC protocol and the vulnerability affects all users of the protocol it’s important to understand what parameters are being used and act accordingly. If you are using an open source library please make sure that it was upgraded. Some of the commonly used libraries for GG18/20 are no longer actively maintained and using them can be risky.

To fix the issue, we recommend using a key-generation process that can detect maliciously formed Paillier modulus using a suitable ZK proof.

## A short introduction to MPC and GG 18/20 protocol

Multi-party computation (MPC)offers an innovative way for several parties to collaboratively generate a shared public key and jointly sign transactions, thereby eliminating the risk of a single point of failure. Specifically, within a MPC-enabled wallet, an attacker must breach a sufficient number of parties possessing a *key share*. This contrasts with the traditional non-threshold paradigm, where compromising a single party suffices to gain control of the wallet.

The Elliptic Curve Digital Signature Algorithm (ECDSA) is the preferred signature scheme within the blockchain space. Even though ECDSA is a traditional non-threshold signature scheme, it can be transformed into a threshold variant through MPC.

GG18, along with the follow-up GG20, are among the most widely-used MPC protocols for threshold-ECDS. Both protocols make extensive use of advanced cryptographic techniques like homomorphic (Paillier) encryption and zero-knowledge proofs. At a high level, the parties in the protocol perform calculations and exchange messages in a predetermined way, and the protocol uses zero-knowledge proofs to validate that no party deviates from the protocol instructions.

## Technical Attack Description

The attack differs depending on the beta parameter, so in this section we will be talking about two separate attacks.

Our first attack (case 1) exfiltrates the key in 16-bit chunks at a time and 16 signatures suffice to recover the key in full, regardless of the number of parties.

Our second attack (case 2) exfiltrates the key also 16 bits at a time but the success probability of the attacker (i.e. the probability that the attack will result in leakage) is somewhat small, and thus the attack needs to be iterated many times (as many as 1B in certain cases) in order to recover the key in full. Furthermore, our second attack deteriorates with the number of parties, so recovering the key in full when a single party is compromised against two honest parties is twice as expensive, in terms of the number of required signatures to extract the key, compared to a single honest party.

Both of our attacks target the so-called Multiplication-to-Addition phase which proceeds as follows (this phase of the protocol is executed between each pair of parties; for simplicity we only assume two parties, A and B).

**1.** A sends Enc(k) to B encrypted under A’s own Paillier pk N, where k is a random value.

*A also sends a zero-knowledge proof (ZKP) that k is not-too-big a value*

**2.** B sends Enc(k\*x + \beta) to A by homomorphically evaluating the above, where \beta is a random value and x is B’s ECDSA private share.

*B also sends a ZKP that calculates the above correctly.*

**3.** A outputs \alpha = k\*x + \beta % N by decrypting the above and B outputs \beta

**Prep for both attacks.** Party is malicious in both attacks and A picks a Paillier modulus composed of 16 small primes p1, … p16 of bit-length 16, and a single big prime q (to match the expected length of N). A sets N = p1p2…p16\*q

Then, for both attacks,

**1.** A will choose a malicious k = N/pi (this choice is malicious because k is almost as big as N which the ZKP is supposed to detect)

*The value of k is updated after each successful attack (k= N/p1, N/p2, N/p3…)*

**2.** A cheats in the ZKP to pass the malicious k as benign.

*We omit the details of the above which can be found in the technical research paper.*

**Case 1.**

As soon as A obtains \alpha, it deduces x % pi = (\alpha – [\alpha % N/pi])/ (N/pi)

After 16 signature attempts in total, A recovers the x’s in full from all parties using Chinese Remainder Theorem (CRT).

**Case 2.**

The previous leakage is no longer relevant because the value of \alpha is implicitly reduced modulo N on B’s side, and, because beta is as big as N, \alpha perfectly hides x. To obtain leakage on x, compromised party A does the following: it guesses that x \mod pi = y (at random) and reassigns \alpha = \alpha – y \* N/pi % N, and proceeds as the protocol prescribes until the end.

If the signature is valid at the end of the execution, then the guess was correct and A proceeds to the next attack. If the signature is invalid there is no leakage (it may be that x \mod pi = y and yet the signature is invalid because of other random choices in the attack).

After 16 successful leakages for each of the honest parties, A recovers the secret in full using the Chinese remainder theorem.

*On the expected number of signatures to extract the key.* We note that there is a tradeoff between the number of signatures, the number of honest, non-compromised, parties, and the size of the primes. For instance, in the presence of a single non-compromised party, when choosing the smallest possible primes {3,5,..,} our attack extracts the key with probability 2\*\*(-40) after 200K signatures, or with probability 0.5 after approx 1M signatures.

For bigger primes, e.g. choosing p1, p2, … t be roughly 2\*\*12, our attack extracts the key with probability 0.15 after 2B signatures (cf. research document).

### Responsible Disclosure

We found and validated the vulnerability by May 5th, 2023 and started identifying affected parties. Thus initiating a multi company 90-day responsible disclosure process with more than 10 vendors and library publishers.

On August 9th, 2023 we published our findings publicly and attached a CVE for this issue: CVE-2023-33241.

### Affected Open Source Libraries

* <https://github.com/bnb-chain/tss-lib>
* <https://github.com/Safeheron/multi-party-ecdsa-cpp> – prior to [patch](https://github.com/Safeheron/multi-party-ecdsa-cpp/commit/f99c4e87cec7434c296f4891562b55dec0d26877) (validated by library maintainers)
* <https://github.com/ZenGo-X/multi-party-ecdsa> – the GG protocols in the library are not actively maintained and not patched
* <https://github.com/apache/incubator-milagro-MPC> – prior to patch (validated by library maintainers)
* <https://github.com/BitGo/BitGoJS/tree/master/modules/sdk-core/src/bitgo/utils/tss/ecdsa>

**POC:** <https://github.com/fireblocks-labs/safeheron-gg20-exploit-poc>

**CVE Link:** <https://www.cve.org/CVERecord?id=CVE-2023-33241>

**Academic paper:** <https://github.com/fireblocks-labs/mpc-ecdsa-attacks-23>

#### Share This Article

* [![](https://www.fireblocks.com/wp-content/themes/studio-simpatico/public/img/twitter.svg)
  Share on Twitter](https://twitter.com/intent/tweet?url=https%3A%2F%2Fwww.fireblocks.com%2Fblog%2Fgg18-and-gg20-paillier-key-vulnerability-technical-report%2F)
* [![](https://www.fireblocks.com/wp-content/themes/studio-simpatico/public/img/linkedin.svg)
  Share on LinkedIn](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.fireblocks.com%2Fblog%2Fgg18-and-gg20-paillier-key-vulnerability-technical-report%2F)
* [![](https://www.fireblocks.com/wp-content/themes/studio-simpatico/public/img/facebook.svg)
  Share on Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.fireblocks.com%2Fblog%2Fgg18-and-gg20-paillier-key-vulnerability-technical-report%2F)

#### Table of Contents

[Executive Summary](#h-executive-summary)[Vulnerability Risk Profile](#h-vulnerability-risk-profile)[Recommended mitigation for clients](#h-recommended-mitigation-for-clients)[A short introduction to MPC and GG 18/20 protocol](#h-a-short-introduction-to-mpc-and-gg-18-20-protocol)[Technical Attack Description](#h-technical-attack-description)[Responsible Disclosure](#h-responsible-disclosure)[Affected Open Source Libraries](#h-affected-open-source-libraries)
#### Ready to get started?

Join the largest institutional players running their businesses with Fireblocks.

[Request Demo](/request-demo)

#### About Us

Fireblocks is an easy-to-use platform to create new blockchain based products, and manage day-to-day digital asset operations. Exchanges, banks, PSPs, lending desks, custodians, trading desks, and hedge funds can securely scale their digital asset operations through the Fireblocks Network and MPC-based Wallet Infrastructure. Fireblocks serves thousands of organizations in the financial, payments, and web3 space, has secured the transfer of over $6 trillion in digital assets and has a unique insurance policy that covers assets in storage & transit. Find out why CISOs and Ops Teams love Fireblocks at www.Fireblocks.com.

#### Topics

* Security

Get Started

* [Request Demo](https://www.fireblocks.com/request-demo)
* [Start Developing](https://www.fireblocks.com/developer-sandbox-sign-up/)

Close

###### Ready for a deeper dive?

# Get a Fireblocks Platform Demo

Find out how Fireblocks helps your digital asset business to grow fast and stay secure.

![g2 & 4.5/5 stars](https://www.fireblocks.com/wp-content/uploads/2024/10/g2-stars-1.svg)

[![Fireblocks](https://www.fireblocks.com/wp-content/themes/studio-simpatico/svgs/logo.svg)](https://www.fireblocks.com)

Fireblocks is an enterprise-grade platform delivering a secure infrastructure for moving, storing, and issuing digital assets. Fireblocks enables exchanges, custodians, banks, trading desks, and hedge funds to securely scale digital asset operations through patent-pending SGX & MPC technology.

[[email protected]](/cdn-cgi/l/email-protection#e1888f878ea187889384838d8e828a92cf828e8c)

* [Twitter](https://twitter.com/FireblocksHQ)
* [LinkedIn](https://www.linkedin.com/company/fireblocks)
* [Facebook](https://www.facebook.com/pg/FireblocksHQ)

* Platform
  + [Treasury Management](https://www.fireblocks.com/platforms/treasury-management/)
  + [Wallet as a Service](https://www.fireblocks.com/platforms/wallet-as-a-service/)
  + [Tokenization](https://www.fireblocks.com/platforms/tokenization/)
  + [Payments](https://www.fireblocks.com/platforms/payments/)
  + [Governance & Policy Engine](https://www.fireblocks.com/platforms/governance-and-policy-engine/)
  + [Off Exchange](https://www.fireblocks.com/platforms/off-exchange/)
  + [Security](https://www.fireblocks.com/platforms/security/)
  + [Staking](https://www.fireblocks.com/platforms/staking/)
  + [Web3](https://www.fireblocks.com/platforms/web3/)
  + [Fireblocks Network](https://www.fireblocks.com/platforms/fireblocks-network/)
  + [Flexible Deployment](https://www.fireblocks.com/platforms/flexible-deployment/)
  + [Compliance](https://www.fireblocks.com/platforms/compliance/)
  + [DeFi](https://www.fireblocks.com/platforms/defi)
  + [Automation](https://www.fireblocks.com/platforms/automation/)
  + [Integrations](https://www.fireblocks.com/integrations/)
  + [How Fireblocks Compares](https://www.fireblocks.com/compare/)
* Solutions
  + [Trading Firms](https://www.fireblocks.com/use-case/trading-firms/)
  + [Fintechs and Exchanges](https://www.fireblocks.com/use-case/fintechs-and-exchanges/)
  + [Financial Institutions](https://www.fireblocks.com/use-case/financial-institutions/)
  + [Web3 Companies](https://www.fireblocks.com/use-case/web3-companies/)
  + [Blockchain Payments](https://www.fireblocks.com/use-case/blockchain-payments/)
  + [Startups](https://www.fireblocks.com/startups/)
* Ecosystem
  + [Partners](https://www.fireblocks.com/partners/)
  + [Professional Services](https://www.fireblocks.com/professional-services/)
  + [Support](https://www.fireblocks.com/global-platinum-support/)
* Company
  + [About](https://www.fireblocks.com/about/)
  + [Custody & Risk Principles](https://www.fireblocks.com/principles/)
  + [Executive Team](https://www.fireblocks.com/team/)
  + [Culture](https://www.fireblocks.com/careers/)
  + [Modern Slavery Statement](https://www.fireblocks.com/modern-slavery-statement/)
  + [Careers](https://www.fireblocks.com/careers/current-openings/)
* [Developers](https://developers.fireblocks.com)
* Blog & Resources
  + [SPARK](https://www.fireblocks.com/spark/)
  + [Blog](https://www.fireblocks.com/blog/)
  + [Webinars](https://www.fireblocks.com/webinars/)
  + [Customer Stories](https://www.fireblocks.com/customers/)
  + [White Papers and Guides](https://www.fireblocks.com/resources/)
  + [Fireblocks Academy](https://www.fireblocks.com/academy/)
  + [ETH Savings Calculator](https://www.fireblocks.com/eth-fees-calculator/)
  + [Glossary](https://www.fireblocks.com/glossary/)
  + [Secure Multi-Party Computation Framework](https://www.fireblocks.com/secure-multi-party-computation-framework/)
  + [Crypto Treasury Management 101](https://www.fireblocks.com/crypto-treasury-management-101/)
  + [Digital Asset Custody 101](https://www.fireblocks.com/digital-asset-custody/)
  + [Institutional DeFi 101](https://www.fireblocks.com/institutional-defi/)
  + [MPC 101](https://www.fireblocks.com/what-is-mpc/)
* [Pricing](https://www.fireblocks.com/pricing/)
* [Request Demo](https://www.fireblocks.com/request-demo/)
* [Bug Bounty](https://hackerone.com/fireblocks_mpc)
* [Login](https://console.fireblocks.io/)

Fireblocks © 2025 All Rights Reserved. Fireblocks LLC NMLS Registration Number: 2066055

[Privacy Policy](https://www.fireblocks.com/privacy-policy/)[Cookie Policy](https://www.fireblocks.com/fireblocks-cookie-policy/)Manage Cookies[Terms of Use](https://www.fireblocks.com/terms-of-use/)[Fireblocks LLC State Licenses](https://www.fireblocks.com/state-licenses/)
![](https://www.fireblocks.com/wp-content/uploads/2025/01/FB-Footer-Badges-Jan-2025.svg)

