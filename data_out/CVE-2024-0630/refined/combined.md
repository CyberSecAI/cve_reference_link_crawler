=== Content from plugins.trac.wordpress.org_96a06c42_20250111_074035.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3026269%2Fwp-rss-aggregator)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3001026/wp-rss-aggregator "Changeset 3001026 for wp-rss-aggregator")
* [Next Change](/changeset/3026270/wp-rss-aggregator "Changeset 3026270 for wp-rss-aggregator") →

---

# Changeset [3026269](/changeset/3026269 "Show full changeset") for [wp-rss-aggregator](/browser/wp-rss-aggregator?rev=3026269 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
01/24/2024 12:54:48 PM
([12 months](/timeline?from=2024-01-24T12%3A54%3A48Z&precision=second "See timeline at 01/24/2024 12:54:48 PM") ago)

Author:
Mekku
Message:

Trunk v4.23.5

Location:
[wp-rss-aggregator/trunk](/browser/wp-rss-aggregator/trunk?rev=3026269)
Files:

10 edited

* [CHANGELOG.md](/browser/wp-rss-aggregator/trunk/CHANGELOG.md?rev=3026269 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [includes/admin-display.php](/browser/wp-rss-aggregator/trunk/includes/admin-display.php?rev=3026269 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [includes/admin-metaboxes.php](/browser/wp-rss-aggregator/trunk/includes/admin-metaboxes.php?rev=3026269 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [includes/feed-importing.php](/browser/wp-rss-aggregator/trunk/includes/feed-importing.php?rev=3026269 "Show entry in browser")
  (modified)
  ([4 diffs](#file3 "Show differences"))
* [includes/libraries/EDD\_licensing/EDD\_SL\_Plugin\_Updater.php](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=3026269 "Show entry in browser")
  (modified)
  ([13 diffs](#file4 "Show differences"))
* [includes/misc-functions.php](/browser/wp-rss-aggregator/trunk/includes/misc-functions.php?rev=3026269 "Show entry in browser")
  (modified)
  ([4 diffs](#file5 "Show differences"))
* [readme.txt](/browser/wp-rss-aggregator/trunk/readme.txt?rev=3026269 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [src/Modules/FeedTemplatesModule.php](/browser/wp-rss-aggregator/trunk/src/Modules/FeedTemplatesModule.php?rev=3026269 "Show entry in browser")
  (modified)
  ([1 diff](#file7 "Show differences"))
* [vendor/composer/installed.php](/browser/wp-rss-aggregator/trunk/vendor/composer/installed.php?rev=3026269 "Show entry in browser")
  (modified)
  ([2 diffs](#file8 "Show differences"))
* [wp-rss-aggregator.php](/browser/wp-rss-aggregator/trunk/wp-rss-aggregator.php?rev=3026269 "Show entry in browser")
  (modified)
  ([2 diffs](#file9 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wp-rss-aggregator/trunk/CHANGELOG.md](/changeset/3026269/wp-rss-aggregator/trunk/CHANGELOG.md "Show the changeset 3026269 restricted to wp-rss-aggregator/trunk/CHANGELOG.md")

  | [r2998119](/browser/wp-rss-aggregator/trunk/CHANGELOG.md?rev=2998119#L5 "Show revision 2998119 of this file in browser") | [r3026269](/browser/wp-rss-aggregator/trunk/CHANGELOG.md?rev=3026269#L5 "Show revision 3026269 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | and this project adheres to [Semantic Versioning](http://semver.org/). |
  | 6 | 6 |  |
  |  | 7 | ## [4.23.5] - 2024-01-24 |
  |  | 8 | ### Fixed |
  |  | 9 | \* Error messages no longer reveal information about potentially inaccessible resources. (CVE-2024-0628) |
  |  | 10 | \* JavaScript code in feed item URLs is now properly sanitized and escaped. (CVE-2024-0630) |
  |  | 11 | \* Word trimming did not work correctly when posts had leading whitespace. |
  |  | 12 | \* The Templates page did not load properly on some websites. |
  |  | 13 |  |
  | 7 | 14 | ## [4.23.4] - 2023-11-18 |
  | 8 | 15 | ### Added |
  | 9 | 16 | \* Black Friday offer links. |
  |  | 17 |  |
  |  | 18 | ### Changed |
  | 10 | 19 | \* Updated the "More Features" page. |
  | 11 | 20 |  |
* ## [wp-rss-aggregator/trunk/includes/admin-display.php](/changeset/3026269/wp-rss-aggregator/trunk/includes/admin-display.php "Show the changeset 3026269 restricted to wp-rss-aggregator/trunk/includes/admin-display.php")

  | [r2998119](/browser/wp-rss-aggregator/trunk/includes/admin-display.php?rev=2998119#L317 "Show revision 2998119 of this file in browser") | [r3026269](/browser/wp-rss-aggregator/trunk/includes/admin-display.php?rev=3026269#L317 "Show revision 3026269 of this file in browser") |  |
  | --- | --- | --- |
  | 317 | 317 | printf( |
  | 318 | 318 | '<a href="%s">%s</a>', |
  | 319 |  | esc\_attr(~~$url~~), |
  |  | 319 | esc\_attr(esc\_url($url)), |
  | 320 | 320 | esc\_html($url) |
  | 321 | 321 | ); |
* ## [wp-rss-aggregator/trunk/includes/admin-metaboxes.php](/changeset/3026269/wp-rss-aggregator/trunk/includes/admin-metaboxes.php "Show the changeset 3026269 restricted to wp-rss-aggregator/trunk/includes/admin-metaboxes.php")

  | [r2659298](/browser/wp-rss-aggregator/trunk/includes/admin-metaboxes.php?rev=2659298#L505 "Show revision 2659298 of this file in browser") | [r3026269](/browser/wp-rss-aggregator/trunk/includes/admin-metaboxes.php?rev=3026269#L505 "Show revision 3026269 of this file in browser") |  |
  | --- | --- | --- |
  | 505 | 505 | if (is\_wp\_error($feed)) { |
  | 506 | 506 | // Log the error |
  | 507 |  | ~~wprss\_log\_obj('Failed to preview feed.', $feed->get\_error\_message(), null, WPRSS\_LOG\_LEVEL\_INFO);~~ |
  | 508 | 507 | printf( |
  | 509 | 508 | '<span class="invalid-feed-url">%s</span>', |
  | 510 |  | \_\_('~~<strong>Invalid feed URL</strong> - Double check the feed source URL setting above~~.', 'wprss') |
  |  | 509 | \_\_('The URL is invalid or is not a URL to an RSS feed.', 'wprss') |
  | 511 | 510 | ); |
  | 512 | 511 |  |
* ## [wp-rss-aggregator/trunk/includes/feed-importing.php](/changeset/3026269/wp-rss-aggregator/trunk/includes/feed-importing.php "Show the changeset 3026269 restricted to wp-rss-aggregator/trunk/includes/feed-importing.php")

  | [r2759206](/browser/wp-rss-aggregator/trunk/includes/feed-importing.php?rev=2759206#L271 "Show revision 2759206 of this file in browser") | [r3026269](/browser/wp-rss-aggregator/trunk/includes/feed-importing.php?rev=3026269#L271 "Show revision 3026269 of this file in browser") |  |
  | --- | --- | --- |
  | 271 | 271 |  |
  | 272 | 272 | if (is\_wp\_error($feed)) { |
  | 273 |  | wpra\_get\_logger($source)->error('Failed to fetch the ~~feed from {0}. Error:~~ {1}', [ |
  |  | 273 | wpra\_get\_logger($source)->error('Failed to fetch the RSS feed. {1}', [ |
  | 274 | 274 | $feed\_url, |
  | 275 |  | ~~$feed->get\_error\_message(~~) |
  |  | 275 | wprss\_rewrite\_feed\_error($feed->get\_error\_message()) |
  | 276 | 276 | ]); |
  | 277 | 277 |  |
  | […](/browser/wp-rss-aggregator/trunk/includes/feed-importing.php?rev=2759206#L424) | […](/browser/wp-rss-aggregator/trunk/includes/feed-importing.php?rev=3026269#L424) |  |
  | 424 | 424 | $msg = sprintf( |
  | 425 | 425 | \_\_('Failed to fetch the RSS feed. Error: %s', 'wprss'), |
  | 426 |  | ~~$feed->error(~~) |
  |  | 426 | wprss\_rewrite\_feed\_error($feed->error()) |
  | 427 | 427 | ); |
  | 428 | 428 | update\_post\_meta($source, 'wprss\_error\_last\_import', $msg); |
  | […](/browser/wp-rss-aggregator/trunk/includes/feed-importing.php?rev=2759206#L447) | […](/browser/wp-rss-aggregator/trunk/includes/feed-importing.php?rev=3026269#L447) |  |
  | 447 | 447 | $permalink = trim( $permalink ); |
  | 448 | 448 | $permalink = htmlspecialchars\_decode($permalink); |
  |  | 449 | $permalink = sanitize\_url($permalink); |
  | 449 | 450 | $permalink = apply\_filters( 'wprss\_normalize\_permalink', $permalink, $item, $feed\_ID); |
  | 450 | 451 | // Return the normalized permalink |
  | […](/browser/wp-rss-aggregator/trunk/includes/feed-importing.php?rev=2759206#L1191) | […](/browser/wp-rss-aggregator/trunk/includes/feed-importing.php?rev=3026269#L1192) |  |
  | 1191 | 1192 | return $parsed; |
  | 1192 | 1193 | } |
  |  | 1194 |  |
  |  | 1195 | function wprss\_rewrite\_feed\_error(string $error) |
  |  | 1196 | { |
  |  | 1197 | if (str\_contains($error, 'invalid XML')) { |
  |  | 1198 | return \_\_('The feed is not a valid XML document', 'wprss'); |
  |  | 1199 | } |
  |  | 1200 |  |
  |  | 1201 | return \_\_('The URL is not valid RSS feed URL', 'wprss'); |
  |  | 1202 | } |
* ## [wp-rss-aggregator/trunk/includes/libraries/EDD\_licensing/EDD\_SL\_Plugin\_Updater.php](/changeset/3026269/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php "Show the changeset 3026269 restricted to wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php")

  | [r2088423](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=2088423#L1 "Show revision 2088423 of this file in browser") | [r3026269](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=3026269#L1 "Show revision 3026269 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 | 2 |  |
  | 3 |  | ~~// uncomment this line for testing~~ |
  | 4 |  | ~~//set\_site\_transient( 'update\_plugins', null );~~ |
  | 5 |  |  |
  | 6 | 3 | // Exit if accessed directly |
  | 7 |  | if ( ! defined( 'ABSPATH' ) ) exit; |
  |  | 4 | if ( ! defined( 'ABSPATH' ) ) { |
  |  | 5 | exit; |
  |  | 6 | } |
  | 8 | 7 |  |
  | 9 | 8 | /\*\* |
  | 10 | 9 | \* Allows plugins to use their own update API. |
  | 11 | 10 | \* |
  | 12 |  | \* @author ~~Pippin Williamson~~ |
  | 13 |  | \* @version 1.~~6.3~~ |
  |  | 11 | \* @author Easy Digital Downloads |
  |  | 12 | \* @version 1.9.2 |
  | 14 | 13 | \*/ |
  | 15 | 14 | class EDD\_SL\_Plugin\_Updater { |
  | 16 |  | private $api\_url   = ''; |
  | 17 |  | private $api\_data  = array(); |
  | 18 |  | private $name      = ''; |
  | 19 |  | private $slug      = ''; |
  | 20 |  | private $version   = ''; |
  |  | 15 |  |
  |  | 16 | private $api\_url              = ''; |
  |  | 17 | private $api\_data             = array(); |
  |  | 18 | private $plugin\_file          = ''; |
  |  | 19 | private $name                 = ''; |
  |  | 20 | private $slug                 = ''; |
  |  | 21 | private $version              = ''; |
  |  | 22 | private $wp\_override          = false; |
  |  | 23 | private $beta                 = false; |
  |  | 24 | private $failed\_request\_cache\_key; |
  | 21 | 25 |  |
  | 22 | 26 | /\*\* |
  | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=2088423#L34) | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=3026269#L38) |  |
  | 34 | 38 | global $edd\_plugin\_data; |
  | 35 | 39 |  |
  | 36 |  | $this->api\_url  = trailingslashit( $\_api\_url ); |
  | 37 |  | $this->api\_data = $\_api\_data; |
  | 38 |  | $this->name     = plugin\_basename( $\_plugin\_file ); |
  | 39 |  | $this->slug     = basename( $\_plugin\_file, '.php' ); |
  | 40 |  | $this->version  = $\_api\_data['version']; |
  |  | 40 | $this->api\_url                  = trailingslashit( $\_api\_url ); |
  |  | 41 | $this->api\_data                 = $\_api\_data; |
  |  | 42 | $this->plugin\_file              = $\_plugin\_file; |
  |  | 43 | $this->name                     = plugin\_basename( $\_plugin\_file ); |
  |  | 44 | $this->slug                     = basename( $\_plugin\_file, '.php' ); |
  |  | 45 | $this->version                  = $\_api\_data['version']; |
  |  | 46 | $this->wp\_override              = isset( $\_api\_data['wp\_override'] ) ? (bool) $\_api\_data['wp\_override'] : false; |
  |  | 47 | $this->beta                     = ! empty( $this->api\_data['beta'] ) ? true : false; |
  |  | 48 | $this->failed\_request\_cache\_key = 'edd\_sl\_failed\_http\_' . md5( $this->api\_url ); |
  | 41 | 49 |  |
  | 42 | 50 | $edd\_plugin\_data[ $this->slug ] = $this->api\_data; |
  |  | 51 |  |
  |  | 52 | /\*\* |
  |  | 53 | \* Fires after the $edd\_plugin\_data is setup. |
  |  | 54 | \* |
  |  | 55 | \* @since x.x.x |
  |  | 56 | \* |
  |  | 57 | \* @param array $edd\_plugin\_data Array of EDD SL plugin data. |
  |  | 58 | \*/ |
  |  | 59 | do\_action( 'post\_edd\_sl\_plugin\_updater\_setup', $edd\_plugin\_data ); |
  | 43 | 60 |  |
  | 44 | 61 | // Set up hooks. |
  | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=2088423#L58) | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=3026269#L75) |  |
  | 58 | 75 | add\_filter( 'pre\_set\_site\_transient\_update\_plugins', array( $this, 'check\_update' ) ); |
  | 59 | 76 | add\_filter( 'plugins\_api', array( $this, 'plugins\_api\_filter' ), 10, 3 ); |
  | 60 |  | remove\_action( 'after\_plugin\_row\_' . $this->name, 'wp\_plugin\_update\_row', 10, 2 ); |
  | 61 |  | add\_action( 'after\_plugin\_row\_' . $this->name, array( $this, 'show\_update\_notification' ), 10, 2 ); |
  |  | 77 | add\_action( 'after\_plugin\_row', array( $this, 'show\_update\_notification' ), 10, 2 ); |
  | 62 | 78 | add\_action( 'admin\_init', array( $this, 'show\_changelog' ) ); |
  | 63 | 79 |  |
  | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=2088423#L81) | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=3026269#L97) |  |
  | 81 | 97 | global $pagenow; |
  | 82 | 98 |  |
  | 83 |  | if( ! is\_object( $\_transient\_data ) ) { |
  | 84 |  | $\_transient\_data = new stdClass; |
  | 85 |  | } |
  | 86 |  |  |
  | 87 |  | if~~( 'plugins.php' == $pagenow && is\_multisite()~~ ) { |
  |  | 99 | if ( ! is\_object( $\_transient\_data ) ) { |
  |  | 100 | $\_transient\_data = new stdClass(); |
  |  | 101 | } |
  |  | 102 |  |
  |  | 103 | if ( ! empty( $\_transient\_data->response ) && ! empty( $\_transient\_data->response[ $this->name ] ) && false === $this->wp\_override ) { |
  | 88 | 104 | return $\_transient\_data; |
  | 89 | 105 | } |
  | 90 | 106 |  |
  | 91 |  | if ( empty( $\_transient\_data->response ) || empty( $\_transient\_data->response[ $this->name ] ) ) { |
  | 92 |  |  |
  | 93 |  | $version\_info = $this->api\_request( 'plugin\_latest\_version', array( 'slug' => $this->slug ) ); |
  | 94 |  |  |
  | 95 |  | if ( false !== $version\_info && is\_object( $version\_info ) && isset( $version\_info->new\_version ) ) { |
  | 96 |  |  |
  | 97 |  | if( version\_compare( $this->version, $version\_info->new\_version, '<' ) ) { |
  | 98 |  |  |
  | 99 |  | $\_transient\_data->response[ $this->name ] = $version\_info; |
  | 100 |  |  |
  | 101 |  | } |
  | 102 |  |  |
  | 103 |  | $\_transient\_data->last\_checked = time(); |
  | 104 |  | $\_transient\_data->checked[ $this->name ] = $this->version; |
  | 105 |  |  |
  |  | 107 | $current = $this->get\_repo\_api\_data(); |
  |  | 108 | if ( false !== $current && is\_object( $current ) && isset( $current->new\_version ) ) { |
  |  | 109 | if ( version\_compare( $this->version, $current->new\_version, '<' ) ) { |
  |  | 110 | $\_transient\_data->response[ $this->name ] = $current; |
  |  | 111 | } else { |
  |  | 112 | // Populating the no\_update information is required to support auto-updates in WordPress 5.5. |
  |  | 113 | $\_transient\_data->no\_update[ $this->name ] = $current; |
  | 106 | 114 | } |
  | 107 |  |  |
  | 108 |  | } |
  |  | 115 | } |
  |  | 116 | $\_transient\_data->last\_checked           = time(); |
  |  | 117 | $\_transient\_data->checked[ $this->name ] = $this->version; |
  | 109 | 118 |  |
  | 110 | 119 | return $\_transient\_data; |
  | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=2088423#L112) | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=3026269#L121) |  |
  | 112 | 121 |  |
  | 113 | 122 | /\*\* |
  | 114 |  | \* show update nofication row -- needed for multisite subsites, because WP won't tell you otherwise! |
  |  | 123 | \* Get repo API data from store. |
  |  | 124 | \* Save to cache. |
  |  | 125 | \* |
  |  | 126 | \* @return \stdClass |
  |  | 127 | \*/ |
  |  | 128 | public function get\_repo\_api\_data() { |
  |  | 129 | $version\_info = $this->get\_cached\_version\_info(); |
  |  | 130 |  |
  |  | 131 | if ( false === $version\_info ) { |
  |  | 132 | $version\_info = $this->api\_request( |
  |  | 133 | 'plugin\_latest\_version', |
  |  | 134 | array( |
  |  | 135 | 'slug' => $this->slug, |
  |  | 136 | 'beta' => $this->beta, |
  |  | 137 | ) |
  |  | 138 | ); |
  |  | 139 | if ( ! $version\_info ) { |
  |  | 140 | return false; |
  |  | 141 | } |
  |  | 142 |  |
  |  | 143 | // This is required for your plugin to support auto-updates in WordPress 5.5. |
  |  | 144 | $version\_info->plugin = $this->name; |
  |  | 145 | $version\_info->id     = $this->name; |
  |  | 146 | $version\_info->tested = $this->get\_tested\_version( $version\_info ); |
  |  | 147 |  |
  |  | 148 | $this->set\_version\_info\_cache( $version\_info ); |
  |  | 149 | } |
  |  | 150 |  |
  |  | 151 | return $version\_info; |
  |  | 152 | } |
  |  | 153 |  |
  |  | 154 | /\*\* |
  |  | 155 | \* Gets the plugin's tested version. |
  |  | 156 | \* |
  |  | 157 | \* @since 1.9.2 |
  |  | 158 | \* @param object $version\_info |
  |  | 159 | \* @return null|string |
  |  | 160 | \*/ |
  |  | 161 | private function get\_tested\_version( $version\_info ) { |
  |  | 162 |  |
  |  | 163 | // There is no tested version. |
  |  | 164 | if ( empty( $version\_info->tested ) ) { |
  |  | 165 | return null; |
  |  | 166 | } |
  |  | 167 |  |
  |  | 168 | // Strip off extra version data so the result is x.y or x.y.z. |
  |  | 169 | list( $current\_wp\_version ) = explode( '-', get\_bloginfo( 'version' ) ); |
  |  | 170 |  |
  |  | 171 | // The tested version is greater than or equal to the current WP version, no need to do anything. |
  |  | 172 | if ( version\_compare( $version\_info->tested, $current\_wp\_version, '>=' ) ) { |
  |  | 173 | return $version\_info->tested; |
  |  | 174 | } |
  |  | 175 | $current\_version\_parts = explode( '.', $current\_wp\_version ); |
  |  | 176 | $tested\_parts          = explode( '.', $version\_info->tested ); |
  |  | 177 |  |
  |  | 178 | // The current WordPress version is x.y.z, so update the tested version to match it. |
  |  | 179 | if ( isset( $current\_version\_parts[2] ) && $current\_version\_parts[0] === $tested\_parts[0] && $current\_version\_parts[1] === $tested\_parts[1] ) { |
  |  | 180 | $tested\_parts[2] = $current\_version\_parts[2]; |
  |  | 181 | } |
  |  | 182 |  |
  |  | 183 | return implode( '.', $tested\_parts ); |
  |  | 184 | } |
  |  | 185 |  |
  |  | 186 | /\*\* |
  |  | 187 | \* Show the update notification on multisite subsites. |
  | 115 | 188 | \* |
  | 116 | 189 | \* @param string  $file |
  | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=2088423#L119) | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=3026269#L192) |  |
  | 119 | 192 | public function show\_update\_notification( $file, $plugin ) { |
  | 120 | 193 |  |
  | 121 |  | ~~if( ! current\_user\_can( 'update\_plugins' ) ) {~~ |
  | 122 |  | ~~return;~~ |
  | 123 |  | ~~}~~ |
  | 124 |  |  |
  | 125 |  | if( ! is\_multisite() ) { |
  | 126 |  | ~~return;~~ |
  | 127 |  | ~~}~~ |
  | 128 |  |  |
  | 129 |  | ~~if ( $this->name != $file ) {~~ |
  | 130 |  | return; |
  | 131 |  | ~~}~~ |
  | 132 |  |  |
  | 133 |  | ~~// Remove our filter on the site transient~~ |
  | 134 |  | remove\_filter( 'pre\_set\_site\_transient\_update\_plugins', array( $this, 'check\_update' ), 10 ); |
  | 135 |  |  |
  |  | 194 | // Return early if in the network admin, or if this is not a multisite install. |
  |  | 195 | if ( is\_network\_admin() || ! is\_multisite() ) { |
  |  | 196 | return; |
  |  | 197 | } |
  |  | 198 |  |
  |  | 199 | // Allow single site admins to see that an update is available. |
  |  | 200 | if ( ! current\_user\_can( 'activate\_plugins' ) ) { |
  |  | 201 | return; |
  |  | 202 | } |
  |  | 203 |  |
  |  | 204 | if ( $this->name !== $file ) { |
  |  | 205 | return; |
  |  | 206 | } |
  |  | 207 |  |
  |  | 208 | // Do not print any message if update does not exist. |
  | 136 | 209 | $update\_cache = get\_site\_transient( 'update\_plugins' ); |
  | 137 | 210 |  |
  | 138 |  | $update\_cache = is\_object( $update\_cache ) ? $update\_cache : new stdClass(); |
  | 139 |  |  |
  | 140 |  | if ( empty( $update\_cache->response ) || empty( $update\_cache->response[ $this->name ] ) ) { |
  | 141 |  |  |
  | 142 |  | $cache\_key    = md5( 'edd\_plugin\_' . sanitize\_key( $this->name ) . '\_version\_info' ); |
  | 143 |  | $version\_info = get\_transient( $cache\_key ); |
  | 144 |  |  |
  | 145 |  | if( false === $version\_info ) { |
  | 146 |  |  |
  | 147 |  | $version\_info = $this->api\_request( 'plugin\_latest\_version', array( 'slug' => $this->slug ) ); |
  | 148 |  |  |
  | 149 |  | set\_transient( $cache\_key, $version\_info, 3600 ); |
  |  | 211 | if ( ! isset( $update\_cache->response[ $this->name ] ) ) { |
  |  | 212 | if ( ! is\_object( $update\_cache ) ) { |
  |  | 213 | $update\_cache = new stdClass(); |
  | 150 | 214 | } |
  | 151 |  |  |
  | 152 |  | if( ! is\_object( $version\_info ) ) { |
  | 153 |  | return; |
  | 154 |  | } |
  | 155 |  |  |
  | 156 |  | if( version\_compare( $this->version, $version\_info->new\_version, '<' ) ) { |
  | 157 |  |  |
  | 158 |  | $update\_cache->response[ $this->name ] = $version\_info; |
  | 159 |  |  |
  | 160 |  | } |
  | 161 |  |  |
  | 162 |  | $update\_cache->last\_checked = time(); |
  | 163 |  | $update\_cache->checked[ $this->name ] = $this->version; |
  | 164 |  |  |
  | 165 |  | set\_site\_transient( 'update\_plugins', $update\_cache ); |
  | 166 |  |  |
  |  | 215 | $update\_cache->response[ $this->name ] = $this->get\_repo\_api\_data(); |
  |  | 216 | } |
  |  | 217 |  |
  |  | 218 | // Return early if this plugin isn't in the transient->response or if the site is running the current or newer version of the plugin. |
  |  | 219 | if ( empty( $update\_cache->response[ $this->name ] ) || version\_compare( $this->version, $update\_cache->response[ $this->name ]->new\_version, '>=' ) ) { |
  |  | 220 | return; |
  |  | 221 | } |
  |  | 222 |  |
  |  | 223 | printf( |
  |  | 224 | '<tr class="plugin-update-tr %3$s" id="%1$s-update" data-slug="%1$s" data-plugin="%2$s">', |
  |  | 225 | $this->slug, |
  |  | 226 | $file, |
  |  | 227 | in\_array( $this->name, $this->get\_active\_plugins(), true ) ? 'active' : 'inactive' |
  |  | 228 | ); |
  |  | 229 |  |
  |  | 230 | echo '<td colspan="3" class="plugin-update colspanchange">'; |
  |  | 231 | echo '<div class="update-message notice inline notice-warning notice-alt"><p>'; |
  |  | 232 |  |
  |  | 233 | $changelog\_link = ''; |
  |  | 234 | if ( ! empty( $update\_cache->response[ $this->name ]->sections->changelog ) ) { |
  |  | 235 | $changelog\_link = add\_query\_arg( |
  |  | 236 | array( |
  |  | 237 | 'edd\_sl\_action' => 'view\_plugin\_changelog', |
  |  | 238 | 'plugin'        => urlencode( $this->name ), |
  |  | 239 | 'slug'          => urlencode( $this->slug ), |
  |  | 240 | 'TB\_iframe'     => 'true', |
  |  | 241 | 'width'         => 77, |
  |  | 242 | 'height'        => 911, |
  |  | 243 | ), |
  |  | 244 | self\_admin\_url( 'index.php' ) |
  |  | 245 | ); |
  |  | 246 | } |
  |  | 247 | $update\_link = add\_query\_arg( |
  |  | 248 | array( |
  |  | 249 | 'action' => 'upgrade-plugin', |
  |  | 250 | 'plugin' => urlencode( $this->name ), |
  |  | 251 | ), |
  |  | 252 | self\_admin\_url( 'update.php' ) |
  |  | 253 | ); |
  |  | 254 |  |
  |  | 255 | printf( |
  |  | 256 | /\* translators: the plugin name. \*/ |
  |  | 257 | esc\_html\_\_( 'There is a new version of %1$s available.', 'easy-digital-downloads' ), |
  |  | 258 | esc\_html( $plugin['Name'] ) |
  |  | 259 | ); |
  |  | 260 |  |
  |  | 261 | if ( ! current\_user\_can( 'update\_plugins' ) ) { |
  |  | 262 | echo ' '; |
  |  | 263 | esc\_html\_e( 'Contact your network administrator to install the update.', 'easy-digital-downloads' ); |
  |  | 264 | } elseif ( empty( $update\_cache->response[ $this->name ]->package ) && ! empty( $changelog\_link ) ) { |
  |  | 265 | echo ' '; |
  |  | 266 | printf( |
  |  | 267 | /\* translators: 1. opening anchor tag, do not translate 2. the new plugin version 3. closing anchor tag, do not translate. \*/ |
  |  | 268 | \_\_( '%1$sView version %2$s details%3$s.', 'easy-digital-downloads' ), |
  |  | 269 | '<a target="\_blank" class="thickbox open-plugin-details-modal" href="' . esc\_url( $changelog\_link ) . '">', |
  |  | 270 | esc\_html( $update\_cache->response[ $this->name ]->new\_version ), |
  |  | 271 | '</a>' |
  |  | 272 | ); |
  |  | 273 | } elseif ( ! empty( $changelog\_link ) ) { |
  |  | 274 | echo ' '; |
  |  | 275 | printf( |
  |  | 276 | \_\_( '%1$sView version %2$s details%3$s or %4$supdate now%5$s.', 'easy-digital-downloads' ), |
  |  | 277 | '<a target="\_blank" class="thickbox open-plugin-details-modal" href="' . esc\_url( $changelog\_link ) . '">', |
  |  | 278 | esc\_html( $update\_cache->response[ $this->name ]->new\_version ), |
  |  | 279 | '</a>', |
  |  | 280 | '<a target="\_blank" class="update-link" href="' . esc\_url( wp\_nonce\_url( $update\_link, 'upgrade-plugin\_' . $file ) ) . '">', |
  |  | 281 | '</a>' |
  |  | 282 | ); |
  | 167 | 283 | } else { |
  | 168 |  |  |
  | 169 |  | $version\_info = $update\_cache->response[ $this->name ]; |
  | 170 |  |  |
  | 171 |  | } |
  | 172 |  |  |
  | 173 |  | // Restore our filter |
  | 174 |  | add\_filter( 'pre\_set\_site\_transient\_update\_plugins', array( $this, 'check\_update' ) ); |
  | 175 |  |  |
  | 176 |  | if ( ! empty( $update\_cache->response[ $this->name ] ) && version\_compare( $this->version, $version\_info->new\_version, '<' ) ) { |
  | 177 |  |  |
  | 178 |  | // build a plugin list row, with update notification |
  | 179 |  | $wp\_list\_table = \_get\_list\_table( 'WP\_Plugins\_List\_Table' ); |
  | 180 |  | echo '<tr class="plugin-update-tr"><td colspan="' . $wp\_list\_table->get\_column\_count() . '" class="plugin-update colspanchange"><div class="update-message">'; |
  | 181 |  |  |
  | 182 |  | $changelog\_link = self\_admin\_url( 'index.php?edd\_sl\_action=view\_plugin\_changelog&plugin=' . $this->name . '&slug=' . $this->slug . '&TB\_iframe=true&width=772&height=911' ); |
  | 183 |  |  |
  | 184 |  | if ( empty( $version\_info->download\_link ) ) { |
  | 185 |  | printf( |
  | 186 |  | \_\_( 'There is a new version of %1$s available. %2$sView version %3$s details%4$s.', 'easy-digital-downloads' ), |
  | 187 |  | esc\_html( $version\_info->name ), |
  | 188 |  | '<a target="\_blank" class="thickbox" href="' . esc\_url( $changelog\_link ) . '">', |
  | 189 |  | esc\_html( $version\_info->new\_version ), |
  | 190 |  | '</a>' |
  | 191 |  | ); |
  | 192 |  | } else { |
  | 193 |  | printf( |
  | 194 |  | \_\_( 'There is a new version of %1$s available. %2$sView version %3$s details%4$s or %5$supdate now%6$s.', 'easy-digital-downloads' ), |
  | 195 |  | esc\_html( $version\_info->name ), |
  | 196 |  | '<a target="\_blank" class="thickbox" href="' . esc\_url( $changelog\_link ) . '">', |
  | 197 |  | esc\_html( $version\_info->new\_version ), |
  | 198 |  | '</a>', |
  | 199 |  | '<a href="' . esc\_url( wp\_nonce\_url( self\_admin\_url( 'update.php?action=upgrade-plugin&plugin=' ) . $this->name, 'upgrade-plugin\_' . $this->name ) ) .'">', |
  | 200 |  | '</a>' |
  | 201 |  | ); |
  | 202 |  | } |
  | 203 |  |  |
  | 204 |  | do\_action( "in\_plugin\_update\_message-{$file}", $plugin, $version\_info ); |
  | 205 |  |  |
  | 206 |  | echo '</div></td></tr>'; |
  | 207 |  | } |
  | 208 |  | } |
  | 209 |  |  |
  |  | 284 | printf( |
  |  | 285 | ' %1$s%2$s%3$s', |
  |  | 286 | '<a target="\_blank" class="update-link" href="' . esc\_url( wp\_nonce\_url( $update\_link, 'upgrade-plugin\_' . $file ) ) . '">', |
  |  | 287 | esc\_html\_\_( 'Update now.', 'easy-digital-downloads' ), |
  |  | 288 | '</a>' |
  |  | 289 | ); |
  |  | 290 | } |
  |  | 291 |  |
  |  | 292 | do\_action( "in\_plugin\_update\_message-{$file}", $plugin, $plugin ); |
  |  | 293 |  |
  |  | 294 | echo '</p></div></td></tr>'; |
  |  | 295 | } |
  |  | 296 |  |
  |  | 297 | /\*\* |
  |  | 298 | \* Gets the plugins active in a multisite network. |
  |  | 299 | \* |
  |  | 300 | \* @return array |
  |  | 301 | \*/ |
  |  | 302 | private function get\_active\_plugins() { |
  |  | 303 | $active\_plugins         = (array) get\_option( 'active\_plugins' ); |
  |  | 304 | $active\_network\_plugins = (array) get\_site\_option( 'active\_sitewide\_plugins' ); |
  |  | 305 |  |
  |  | 306 | return array\_merge( $active\_plugins, array\_keys( $active\_network\_plugins ) ); |
  |  | 307 | } |
  | 210 | 308 |  |
  | 211 | 309 | /\*\* |
  | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=2088423#L221) | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=3026269#L319) |  |
  | 221 | 319 | public function plugins\_api\_filter( $\_data, $\_action = '', $\_args = null ) { |
  | 222 | 320 |  |
  | 223 |  |  |
  | 224 |  | if ( $\_action != 'plugin\_information' ) { |
  |  | 321 | if ( 'plugin\_information' !== $\_action ) { |
  | 225 | 322 |  |
  | 226 | 323 | return $\_data; |
  | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=2088423#L228) | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=3026269#L325) |  |
  | 228 | 325 | } |
  | 229 | 326 |  |
  | 230 |  | if ( ! isset( $\_args->slug ) || ( $\_args->slug != $this->slug ) ) { |
  |  | 327 | if ( ! isset( $\_args->slug ) || ( $\_args->slug !== $this->slug ) ) { |
  | 231 | 328 |  |
  | 232 | 329 | return $\_data; |
  | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=2088423#L238) | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=3026269#L335) |  |
  | 238 | 335 | 'is\_ssl' => is\_ssl(), |
  | 239 | 336 | 'fields' => array( |
  | 240 |  | 'banners' => false, // These will be supported soon hopefully |
  | 241 |  | 'reviews' => false |
  | 242 |  | ) |
  |  | 337 | 'banners' => array(), |
  |  | 338 | 'reviews' => false, |
  |  | 339 | 'icons'   => array(), |
  |  | 340 | ), |
  | 243 | 341 | ); |
  | 244 | 342 |  |
  | 245 |  | $api\_response = $this->api\_request( 'plugin\_information', $to\_send ); |
  | 246 |  |  |
  | 247 |  | if ( false !== $api\_response ) { |
  | 248 |  | $\_data = $api\_response; |
  |  | 343 | // Get the transient where we store the api request for this plugin for 24 hours |
  |  | 344 | $edd\_api\_request\_transient = $this->get\_cached\_version\_info(); |
  |  | 345 |  |
  |  | 346 | //If we have no transient-saved value, run the API, set a fresh transient with the API value, and return that value too right now. |
  |  | 347 | if ( empty( $edd\_api\_request\_transient ) ) { |
  |  | 348 |  |
  |  | 349 | $api\_response = $this->api\_request( 'plugin\_information', $to\_send ); |
  |  | 350 |  |
  |  | 351 | // Expires in 3 hours |
  |  | 352 | $this->set\_version\_info\_cache( $api\_response ); |
  |  | 353 |  |
  |  | 354 | if ( false !== $api\_response ) { |
  |  | 355 | $\_data = $api\_response; |
  |  | 356 | } |
  |  | 357 | } else { |
  |  | 358 | $\_data = $edd\_api\_request\_transient; |
  |  | 359 | } |
  |  | 360 |  |
  |  | 361 | // Convert sections into an associative array, since we're getting an object, but Core expects an array. |
  |  | 362 | if ( isset( $\_data->sections ) && ! is\_array( $\_data->sections ) ) { |
  |  | 363 | $\_data->sections = $this->convert\_object\_to\_array( $\_data->sections ); |
  |  | 364 | } |
  |  | 365 |  |
  |  | 366 | // Convert banners into an associative array, since we're getting an object, but Core expects an array. |
  |  | 367 | if ( isset( $\_data->banners ) && ! is\_array( $\_data->banners ) ) { |
  |  | 368 | $\_data->banners = $this->convert\_object\_to\_array( $\_data->banners ); |
  |  | 369 | } |
  |  | 370 |  |
  |  | 371 | // Convert icons into an associative array, since we're getting an object, but Core expects an array. |
  |  | 372 | if ( isset( $\_data->icons ) && ! is\_array( $\_data->icons ) ) { |
  |  | 373 | $\_data->icons = $this->convert\_object\_to\_array( $\_data->icons ); |
  |  | 374 | } |
  |  | 375 |  |
  |  | 376 | // Convert contributors into an associative array, since we're getting an object, but Core expects an array. |
  |  | 377 | if ( isset( $\_data->contributors ) && ! is\_array( $\_data->contributors ) ) { |
  |  | 378 | $\_data->contributors = $this->convert\_object\_to\_array( $\_data->contributors ); |
  |  | 379 | } |
  |  | 380 |  |
  |  | 381 | if ( ! isset( $\_data->plugin ) ) { |
  |  | 382 | $\_data->plugin = $this->name; |
  | 249 | 383 | } |
  | 250 | 384 |  |
  | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=2088423#L252) | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=3026269#L386) |  |
  | 252 | 386 | } |
  | 253 | 387 |  |
  |  | 388 | /\*\* |
  |  | 389 | \* Convert some objects to arrays when injecting data into the update API |
  |  | 390 | \* |
  |  | 391 | \* Some data like sections, banners, and icons are expected to be an associative array, however due to the JSON |
  |  | 392 | \* decoding, they are objects. This method allows us to pass in the object and return an associative array. |
  |  | 393 | \* |
  |  | 394 | \* @since 3.6.5 |
  |  | 395 | \* |
  |  | 396 | \* @param stdClass $data |
  |  | 397 | \* |
  |  | 398 | \* @return array |
  |  | 399 | \*/ |
  |  | 400 | private function convert\_object\_to\_array( $data ) { |
  |  | 401 | if ( ! is\_array( $data ) && ! is\_object( $data ) ) { |
  |  | 402 | return array(); |
  |  | 403 | } |
  |  | 404 | $new\_data = array(); |
  |  | 405 | foreach ( $data as $key => $value ) { |
  |  | 406 | $new\_data[ $key ] = is\_object( $value ) ? $this->convert\_object\_to\_array( $value ) : $value; |
  |  | 407 | } |
  |  | 408 |  |
  |  | 409 | return $new\_data; |
  |  | 410 | } |
  | 254 | 411 |  |
  | 255 | 412 | /\*\* |
  | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=2088423#L261) | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=3026269#L418) |  |
  | 261 | 418 | \*/ |
  | 262 | 419 | public function http\_request\_args( $args, $url ) { |
  | 263 |  | // If it is an https request and we are performing a package download, disable ssl verification |
  |  | 420 |  |
  | 264 | 421 | if ( strpos( $url, 'https://' ) !== false && strpos( $url, 'edd\_action=package\_download' ) ) { |
  | 265 |  | $args['sslverify'] = ~~false~~; |
  |  | 422 | $args['sslverify'] = $this->verify\_ssl(); |
  | 266 | 423 | } |
  | 267 | 424 | return $args; |
  |  | 425 |  |
  | 268 | 426 | } |
  | 269 | 427 |  |
  | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=2088423#L277) | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=3026269#L435) |  |
  | 277 | 435 | \* @param string  $\_action The requested action. |
  | 278 | 436 | \* @param array   $\_data   Parameters for the API action. |
  | 279 |  | \* @return false|object |
  |  | 437 | \* @return false|object|void |
  | 280 | 438 | \*/ |
  | 281 | 439 | private function api\_request( $\_action, $\_data ) { |
  | 282 |  |  |
  | 283 |  | ~~global $wp\_version;~~ |
  | 284 |  |  |
  | 285 | 440 | $data = array\_merge( $this->api\_data, $\_data ); |
  | 286 | 441 |  |
  | 287 |  | if ( $data['slug'] != $this->slug ) { |
  | 288 |  | return; |
  | 289 |  | } |
  | 290 |  |  |
  | 291 |  | if( $this->api\_url == home\_url() ) { |
  | 292 |  | return false; // Don't allow a plugin to ping itself |
  | 293 |  | } |
  | 294 |  |  |
  |  | 442 | if ( $data['slug'] !== $this->slug ) { |
  |  | 443 | return; |
  |  | 444 | } |
  |  | 445 |  |
  |  | 446 | // Don't allow a plugin to ping itself |
  |  | 447 | if ( trailingslashit( home\_url() ) === $this->api\_url ) { |
  |  | 448 | return false; |
  |  | 449 | } |
  |  | 450 |  |
  |  | 451 | if ( $this->request\_recently\_failed() ) { |
  |  | 452 | return false; |
  |  | 453 | } |
  |  | 454 |  |
  |  | 455 | return $this->get\_version\_from\_remote(); |
  |  | 456 | } |
  |  | 457 |  |
  |  | 458 | /\*\* |
  |  | 459 | \* Determines if a request has recently failed. |
  |  | 460 | \* |
  |  | 461 | \* @since 1.9.1 |
  |  | 462 | \* |
  |  | 463 | \* @return bool |
  |  | 464 | \*/ |
  |  | 465 | private function request\_recently\_failed() { |
  |  | 466 | $failed\_request\_details = get\_option( $this->failed\_request\_cache\_key ); |
  |  | 467 |  |
  |  | 468 | // Request has never failed. |
  |  | 469 | if ( empty( $failed\_request\_details ) || ! is\_numeric( $failed\_request\_details ) ) { |
  |  | 470 | return false; |
  |  | 471 | } |
  |  | 472 |  |
  |  | 473 | /\* |
  |  | 474 | \* Request previously failed, but the timeout has expired. |
  |  | 475 | \* This means we're allowed to try again. |
  |  | 476 | \*/ |
  |  | 477 | if ( time() > $failed\_request\_details ) { |
  |  | 478 | delete\_option( $this->failed\_request\_cache\_key ); |
  |  | 479 |  |
  |  | 480 | return false; |
  |  | 481 | } |
  |  | 482 |  |
  |  | 483 | return true; |
  |  | 484 | } |
  |  | 485 |  |
  |  | 486 | /\*\* |
  |  | 487 | \* Logs a failed HTTP request for this API URL. |
  |  | 488 | \* We set a timestamp for 1 hour from now. This prevents future API requests from being |
  |  | 489 | \* made to this domain for 1 hour. Once the timestamp is in the past, API requests |
  |  | 490 | \* will be allowed again. This way if the site is down for some reason we don't bombard |
  |  | 491 | \* it with failed API requests. |
  |  | 492 | \* |
  |  | 493 | \* @see EDD\_SL\_Plugin\_Updater::request\_recently\_failed |
  |  | 494 | \* |
  |  | 495 | \* @since 1.9.1 |
  |  | 496 | \*/ |
  |  | 497 | private function log\_failed\_request() { |
  |  | 498 | update\_option( $this->failed\_request\_cache\_key, strtotime( '+1 hour' ) ); |
  |  | 499 | } |
  |  | 500 |  |
  |  | 501 | /\*\* |
  |  | 502 | \* If available, show the changelog for sites in a multisite install. |
  |  | 503 | \*/ |
  |  | 504 | public function show\_changelog() { |
  |  | 505 |  |
  |  | 506 | if ( empty( $\_REQUEST['edd\_sl\_action'] ) || 'view\_plugin\_changelog' !== $\_REQUEST['edd\_sl\_action'] ) { |
  |  | 507 | return; |
  |  | 508 | } |
  |  | 509 |  |
  |  | 510 | if ( empty( $\_REQUEST['plugin'] ) ) { |
  |  | 511 | return; |
  |  | 512 | } |
  |  | 513 |  |
  |  | 514 | if ( empty( $\_REQUEST['slug'] ) || $this->slug !== $\_REQUEST['slug'] ) { |
  |  | 515 | return; |
  |  | 516 | } |
  |  | 517 |  |
  |  | 518 | if ( ! current\_user\_can( 'update\_plugins' ) ) { |
  |  | 519 | wp\_die( esc\_html\_\_( 'You do not have permission to install plugin updates', 'easy-digital-downloads' ), esc\_html\_\_( 'Error', 'easy-digital-downloads' ), array( 'response' => 403 ) ); |
  |  | 520 | } |
  |  | 521 |  |
  |  | 522 | $version\_info = $this->get\_repo\_api\_data(); |
  |  | 523 | if ( isset( $version\_info->sections ) ) { |
  |  | 524 | $sections = $this->convert\_object\_to\_array( $version\_info->sections ); |
  |  | 525 | if ( ! empty( $sections['changelog'] ) ) { |
  |  | 526 | echo '<div style="background:#fff;padding:10px;">' . wp\_kses\_post( $sections['changelog'] ) . '</div>'; |
  |  | 527 | } |
  |  | 528 | } |
  |  | 529 |  |
  |  | 530 | exit; |
  |  | 531 | } |
  |  | 532 |  |
  |  | 533 | /\*\* |
  |  | 534 | \* Gets the current version information from the remote site. |
  |  | 535 | \* |
  |  | 536 | \* @return array|false |
  |  | 537 | \*/ |
  |  | 538 | private function get\_version\_from\_remote() { |
  | 295 | 539 | $api\_params = array( |
  | 296 |  | 'edd\_action' => 'get\_version', |
  | 297 |  | 'license'    => ! empty( $data['license'] ) ? $data['license'] : '', |
  | 298 |  | 'item\_name'  => isset( $data['item\_name'] ) ? $data['item\_name'] : false, |
  | 299 |  | 'item\_id'    => isset( $data['item\_id'] ) ? $data['item\_id'] : false, |
  | 300 |  | 'slug'       => $data['slug'], |
  | 301 |  | 'author'     => $data['author'], |
  | 302 |  | 'url'        => home\_url() |
  |  | 540 | 'edd\_action'  => 'get\_version', |
  |  | 541 | 'license'     => ! empty( $this->api\_data['license'] ) ? $this->api\_data['license'] : '', |
  |  | 542 | 'item\_name'   => isset( $this->api\_data['item\_name'] ) ? $this->api\_data['item\_name'] : false, |
  |  | 543 | 'item\_id'     => isset( $this->api\_data['item\_id'] ) ? $this->api\_data['item\_id'] : false, |
  |  | 544 | 'version'     => isset( $this->api\_data['version'] ) ? $this->api\_data['version'] : false, |
  |  | 545 | 'slug'        => $this->slug, |
  |  | 546 | 'author'      => $this->api\_data['author'], |
  |  | 547 | 'url'         => home\_url(), |
  |  | 548 | 'beta'        => $this->beta, |
  |  | 549 | 'php\_version' => phpversion(), |
  |  | 550 | 'wp\_version'  => get\_bloginfo( 'version' ), |
  | 303 | 551 | ); |
  | 304 | 552 |  |
  | 305 |  | $request = wp\_remote\_post( $this->api\_url, array( 'timeout' => 15, 'sslverify' => false, 'body' => $api\_params ) ); |
  | 306 |  |  |
  | 307 |  | if ( ! is\_wp\_error( $request ) ) { |
  | 308 |  | $request = json\_decode( wp\_remote\_retrieve\_body( $request ) ); |
  | 309 |  | } |
  |  | 553 | /\*\* |
  |  | 554 | \* Filters the parameters sent in the API request. |
  |  | 555 | \* |
  |  | 556 | \* @param array  $api\_params        The array of data sent in the request. |
  |  | 557 | \* @param array  $this->api\_data    The array of data set up in the class constructor. |
  |  | 558 | \* @param string $this->plugin\_file The full path and filename of the file. |
  |  | 559 | \*/ |
  |  | 560 | $api\_params = apply\_filters( 'edd\_sl\_plugin\_updater\_api\_params', $api\_params, $this->api\_data, $this->plugin\_file ); |
  |  | 561 |  |
  |  | 562 | $request = wp\_remote\_post( |
  |  | 563 | $this->api\_url, |
  |  | 564 | array( |
  |  | 565 | 'timeout'   => 15, |
  |  | 566 | 'sslverify' => $this->verify\_ssl(), |
  |  | 567 | 'body'      => $api\_params, |
  |  | 568 | ) |
  |  | 569 | ); |
  |  | 570 |  |
  |  | 571 | if ( is\_wp\_error( $request ) || ( 200 !== wp\_remote\_retrieve\_response\_code( $request ) ) ) { |
  |  | 572 | $this->log\_failed\_request(); |
  |  | 573 |  |
  |  | 574 | return false; |
  |  | 575 | } |
  |  | 576 |  |
  |  | 577 | $request = json\_decode( wp\_remote\_retrieve\_body( $request ) ); |
  | 310 | 578 |  |
  | 311 | 579 | if ( $request && isset( $request->sections ) ) { |
  | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=2088423#L315) | […](/browser/wp-rss-aggregator/trunk/includes/libraries/EDD_licensing/EDD_SL_Plugin_Updater.php?rev=3026269#L583) |  |
  | 315 | 583 | } |
  | 316 | 584 |  |
  |  | 585 | if ( $request && isset( $request->banners ) ) { |
  |  | 586 | $request->banners = maybe\_unserialize( $request->banners ); |
  |  | 587 | } |
  |  | 588 |  |
  |  | 589 | if ( $request && isset( $request->icons ) ) { |
  |  | 590 | $request->icons = maybe\_unserialize( $request->icons ); |
  |  | 591 | } |
  |  | 592 |  |
  |  | 593 | if ( ! empty( $request->sections ) ) { |
  |  | 594 | foreach ( $request->sections as $key => $section ) { |
  |  | 595 | $request->$key = (array) $section; |
  |  | 596 | } |
  |  | 597 | } |
  |  | 598 |  |
  | 317 | 599 | return $request; |
  | 318 | 600 | } |
  | 319 | 601 |  |
  | 320 |  | public function show\_changelog() { |
  | 321 |  |  |
  | 322 |  | global $edd\_plugin\_data; |
  | 323 |  |  |
  | 324 |  | if( empty( $\_REQUEST['edd\_sl\_action'] ) || 'view\_plugin\_changelog' != $\_REQUEST['edd\_sl\_action'] ) { |
  | 325 |  | return; |
  | 326 |  | } |
  | 327 |  |  |
  | 328 |  | if( empty( $\_REQUEST['plugin'] ) ) { |
  | 329 |  | return; |
  | 330 |  | } |
  | 331 |  |  |
  | 332 |  | if( empty( $\_REQUEST['slug'] ) ) { |
  | 333 |  | return; |
  | 334 |  | } |
  | 335 |  |  |
  | 336 |  | if( ! current\_user\_can( 'update\_plugins' ) ) { |
  | 337 |  | wp\_die( \_\_( 'You do not have permission to install plugin updates', 'easy-digital-downloads' ), \_\_( 'Error', 'easy-digital-downloads' ), array( 'response' => 403 ) ); |
  | 338 |  | } |
  | 339 |  |  |
  | 340 |  | $data         = $edd\_plugin\_data[ $\_REQUEST['slug'] ]; |
  | 341 |  | $cache\_key    = md5( 'edd\_plugin\_' . sanitize\_key( $\_REQUEST['plugin'] ) . '\_version\_info' ); |
  | 342 |  | $version\_info = get\_transient( $cache\_key ); |
  | 343 |  |  |
  | 344 |  | if( false === $version\_info ) { |
  | 345 |  |  |
  | 346 |  | $api\_params = array( |
  | 347 |  | 'edd\_action' => 'get\_version', |
  | 348 |  | 'item\_name'  => isset( $data['item\_name'] ) ? $data['item\_name'] : false, |
  | 349 |  | 'item\_id'    => isset( $data['item\_id'] ) ? $data['item\_id'] : false, |
  | 350 |  | 'slug'       => $\_REQUEST['slug'], |
  | 351 |  | 'author'     => $data['author'], |
  | 352 |  | 'url'        => home\_url() |
  | 353 |  | ); |
  | 354 |  |  |
  | 355 |  | $request = wp\_remote\_post( $this->api\_url, array( 'timeout' => 15, 'sslverify' => false, 'body' => $api\_params ) ); |
  | 356 |  |  |
  | 357 |  | if ( ! is\_wp\_error( $request ) ) { |
  | 358 |  | $version\_info = json\_decode( wp\_remote\_retrieve\_body( $request ) ); |
  | 359 |  | } |
  | 360 |  |  |
  | 361 |  | if ( ! empty( $version\_info ) && isset( $version\_info->sections ) ) { |
  | 362 |  | $version\_info->sections = maybe\_unserialize( $version\_info->sections ); |
  | 363 |  | } else { |
  | 364 |  | $version\_info = false; |
  | 365 |  | } |
  | 366 |  |  |
  | 367 |  | set\_transient( $cache\_key, $version\_info, 3600 ); |
  | 368 |  |  |
  | 369 |  | } |
  | 370 |  |  |
  | 371 |  | if( ! empty( $version\_info ) && isset( $version\_info->sections['changelog'] ) ) { |
  | 372 |  | echo '<div style="background:#fff;padding:10px;">' . $version\_info->sections['changelog'] . '</div>'; |
  | 373 |  | } |
  | 374 |  |  |
  | 375 |  | exit; |
  |  | 602 | /\*\* |
  |  | 603 | \* Get the version info from the cache, if it exists. |
  |  | 604 | \* |
  |  | 605 | \* @param string $cache\_key |
  |  | 606 | \* @return object |
  |  | 607 | \*/ |
  |  | 608 | public function get\_cached\_version\_info( $cache\_key = '' ) { |
  |  | 609 |  |
  |  | 610 | if ( empty( $cache\_key ) ) { |
  |  | 611 | $cache\_key = $this->get\_cache\_key(); |
  |  | 612 | } |
  |  | 613 |  |
  |  | 614 | $cache = get\_option( $cache\_key ); |
  |  | 615 |  |
  |  | 616 | // Cache is expired |
  |  | 617 | if ( empty( $cache['timeout'] ) || time() > $cache['timeout'] ) { |
  |  | 618 | return false; |
  |  | 619 | } |
  |  | 620 |  |
  |  | 621 | // We need to turn the icons into an array, thanks to WP Core forcing these into an object at some point. |
  |  | 622 | $cache['value'] = json\_decode( $cache['value'] ); |
  |  | 623 | if ( ! empty( $cache['value']->icons ) ) { |
  |  | 624 | $cache['value']->icons = (array) $cache['value']->icons; |
  |  | 625 | } |
  |  | 626 |  |
  |  | 627 | return $cache['value']; |
  |  | 628 |  |
  |  | 629 | } |
  |  | 630 |  |
  |  | 631 | /\*\* |
  |  | 632 | \* Adds the plugin version information to the database. |
  |  | 633 | \* |
  |  | 634 | \* @param string $value |
  |  | 635 | \* @param string $cache\_key |
  |  | 636 | \*/ |
  |  | 637 | public function set\_version\_info\_cache( $value = '', $cache\_key = '' ) { |
  |  | 638 |  |
  |  | 639 | if ( empty( $cache\_key ) ) { |
  |  | 640 | $cache\_key = $this->get\_cache\_key(); |
  |  | 641 | } |
  |  | 642 |  |
  |  | 643 | $data = array( |
  |  | 644 | 'timeout' => strtotime( '+3 hours', time() ), |
  |  | 645 | 'value'   => wp\_json\_encode( $value ), |
  |  | 646 | ); |
  |  | 647 |  |
  |  | 648 | update\_option( $cache\_key, $data, 'no' ); |
  |  | 649 |  |
  |  | 650 | // Delete the duplicate option |
  |  | 651 | delete\_option( 'edd\_api\_request\_' . md5( serialize( $this->slug . $this->api\_data['license'] . $this->beta ) ) ); |
  |  | 652 | } |
  |  | 653 |  |
  |  | 654 | /\*\* |
  |  | 655 | \* Returns if the SSL of the store should be verified. |
  |  | 656 | \* |
  |  | 657 | \* @since  1.6.13 |
  |  | 658 | \* @return bool |
  |  | 659 | \*/ |
  |  | 660 | private function verify\_ssl() { |
  |  | 661 | return (bool) apply\_filters( 'edd\_sl\_api\_request\_verify\_ssl', true, $this ); |
  |  | 662 | } |
  |  | 663 |  |
  |  | 664 | /\*\* |
  |  | 665 | \* Gets the unique key (option name) for a plugin. |
  |  | 666 | \* |
  |  | 667 | \* @since 1.9.0 |
  |  | 668 | \* @return string |
  |  | 669 | \*/ |
  |  | 670 | private function get\_cache\_key() { |
  |  | 671 | $string = $this->slug . $this->api\_data['license'] . $this->beta; |
  |  | 672 |  |
  |  | 673 | return 'edd\_sl\_' . md5( serialize( $string ) ); |
  | 376 | 674 | } |
  | 377 | 675 |  |
* ## [wp-rss-aggregator/trunk/includes/misc-functions.php](/changeset/3026269/wp-rss-aggregator/trunk/includes/misc-functions.php "Show the changeset 3026269 restricted to wp-rss-aggregator/trunk/includes/misc-functions.php")

  | [r2489429](/browser/wp-rss-aggregator/trunk/includes/misc-functions.php?rev=2489429#L213 "Show revision 2489429 of this file in browser") | [r3026269](/browser/wp-rss-aggregator/trunk/includes/misc-functions.php?rev=3026269#L213 "Show revision 3026269 of this file in browser") |  |
  | --- | --- | --- |
  | 213 | 213 | \*  2. Add apropriate tag type to each group |
  | 214 | 214 | \*/ |
  | 215 |  | foreach ( $pieces as $~~\_idx => $\_~~piece ) { |
  |  | 215 | foreach ( $pieces as $idx => $piece ) { |
  | 216 | 216 | // Get the data |
  | 217 |  | $tag\_piece = $~~\_~~piece[0]; |
  | 218 |  | $text\_piece = $~~\_~~piece[2]; |
  | 219 |  | $tag\_name = $~~\_~~piece[1][0]; |
  |  | 217 | $tag\_piece = $piece[0]; |
  |  | 218 | $text\_piece = $piece[2]; |
  |  | 219 | $tag\_name = $piece[1][0]; |
  | 220 | 220 | // Compile all plain text together |
  | 221 | 221 | $plain\_text .= $text\_piece[0]; |
  | 222 | 222 | // Check the tag and assign the proper tag type |
  | 223 | 223 | $tag = $tag\_piece[0]; |
  | 224 |  | $pieces[ $~~\_~~idx ][1][2] = |
  |  | 224 | $pieces[ $idx ][1][2] = |
  | 225 | 225 | ( substr( $tag, 0, 2 ) === '</' ) ? |
  | 226 | 226 | $tag\_type['closing'] : |
  | […](/browser/wp-rss-aggregator/trunk/includes/misc-functions.php?rev=2489429#L248) | […](/browser/wp-rss-aggregator/trunk/includes/misc-functions.php?rev=3026269#L248) |  |
  | 248 | 248 |  |
  | 249 | 249 | // Iterate the groups once more |
  | 250 |  | foreach ( $pieces as $~~\_idx => $\_~~piece ) { |
  |  | 250 | foreach ( $pieces as $idx => $piece ) { |
  | 251 | 251 | // Tag and tagname |
  | 252 |  | $\_tag\_piece = $~~\_~~piece[0]; |
  | 253 |  | $\_tag\_name\_piece = $~~\_~~piece[1]; |
  |  | 252 | $\_tag\_piece = $piece[0]; |
  |  | 253 | $\_tag\_name\_piece = $piece[1]; |
  | 254 | 254 | // Name of the tag |
  | 255 | 255 | $\_tag\_name = strtolower( $\_tag\_name\_piece[0] ); |
  | […](/browser/wp-rss-aggregator/trunk/includes/misc-functions.php?rev=2489429#L313) | […](/browser/wp-rss-aggregator/trunk/includes/misc-functions.php?rev=3026269#L313) |  |
  | 313 | 313 | } |
  | 314 | 314 | $original\_text = $text; |
  |  | 315 | $text = ltrim($text); |
  |  | 316 | $prefix = substr($original\_text, 0, strlen($original\_text) - strlen($text)); |
  |  | 317 |  |
  | 315 | 318 | /\* translators: If your word count is based on single characters (East Asian characters), |
  | 316 | 319 | enter 'characters'. Otherwise, enter 'words'. Do not translate into your own language. \*/ |
  | […](/browser/wp-rss-aggregator/trunk/includes/misc-functions.php?rev=2489429#L331) | […](/browser/wp-rss-aggregator/trunk/includes/misc-functions.php?rev=3026269#L334) |  |
  | 331 | 334 | $text = implode( $sep, $words\_array ); |
  | 332 | 335 | } |
  |  | 336 |  |
  |  | 337 | $text = $prefix . $text; |
  | 333 | 338 | /\*\* |
  | 334 | 339 | \* Filter the text content after words have been trimmed. |
* ## [wp-rss-aggregator/trunk/readme.txt](/changeset/3026269/wp-rss-aggregator/trunk/readme.txt "Show the changeset 3026269 restricted to wp-rss-aggregator/trunk/readme.txt")

  | [r3001026](/browser/wp-rss-aggregator/trunk/readme.txt?rev=3001026#L256 "Show revision 3001026 of this file in browser") | [r3026269](/browser/wp-rss-aggregator/trunk/readme.txt?rev=3026269#L256 "Show revision 3026269 of this file in browser") |  |
  | --- | --- | --- |
  | 256 | 256 | == Changelog == |
  | 257 | 257 |  |
  |  | 258 | = 4.23.5 (2024-01-24) = |
  |  | 259 | \*\*Fixed\*\* |
  |  | 260 | - Error messages no longer reveal information about potentially inaccessible resources. (CVE-2024-0628) |
  |  | 261 | - JavaScript code in feed item URLs is now properly sanitized and escaped. (CVE-2024-0630) |
  |  | 262 | - Word trimming did not work correctly when posts had leading whitespace. |
  |  | 263 | - The Templates page did not load properly on some websites. |
  |  | 264 |  |
  | 258 | 265 | = 4.23.4 (2023-11-18) = |
  | 259 | 266 | \*\*Added\*\* |
* ## [wp-rss-aggregator/trunk/src/Modules/FeedTemplatesModule.php](/changeset/3026269/wp-rss-aggregator/trunk/src/Modules/FeedTemplatesModule.php "Show the changeset 3026269 restricted to wp-rss-aggregator/trunk/src/Modules/FeedTemplatesModule.php")

  | [r2489429](/browser/wp-rss-aggregator/trunk/src/Modules/FeedTemplatesModule.php?rev=2489429#L619 "Show revision 2489429 of this file in browser") | [r3026269](/browser/wp-rss-aggregator/trunk/src/Modules/FeedTemplatesModule.php?rev=3026269#L619 "Show revision 3026269 of this file in browser") |  |
  | --- | --- | --- |
  | 619 | 619 | \*/ |
  | 620 | 620 | 'wpra/feeds/templates/admin/states/global' => function (ContainerInterface $c) { |
  | 621 |  | $url = (isset($\_SERVER['HTTPS']) && $\_SERVER['HTTPS'] === 'on' ? "https" : "http") . "://$\_SERVER[HTTP\_HOST]"; |
  |  | 621 | $siteUrl = rtrim(site\_url(), '/'); |
  |  | 622 | $templatesUrl = menu\_page\_url('wpra\_feed\_templates', false); |
  | 622 | 623 | return [ |
  | 623 | 624 | 'admin\_base\_url' => admin\_url(), |
  | 624 |  | 'templates\_url\_base' => str\_replace($~~url, '', menu\_page\_url('wpra\_feed\_templates', false)~~), |
  |  | 625 | 'templates\_url\_base' => str\_replace($siteUrl, '', $templatesUrl), |
  | 625 | 626 | 'is\_existing\_user' => !wprss\_is\_new\_user(), |
  | 626 | 627 | 'nonce' => wp\_create\_nonce('wp\_rest'), |
* ## [wp-rss-aggregator/trunk/vendor/composer/installed.php](/changeset/3026269/wp-rss-aggregator/trunk/vendor/composer/installed.php "Show the changeset 3026269 restricted to wp-rss-aggregator/trunk/vendor/composer/installed.php")

  | [r2998119](/browser/wp-rss-aggregator/trunk/vendor/composer/installed.php?rev=2998119#L4 "Show revision 2998119 of this file in browser") | [r3026269](/browser/wp-rss-aggregator/trunk/vendor/composer/installed.php?rev=3026269#L4 "Show revision 3026269 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | 'pretty\_version' => 'dev-develop', |
  | 5 | 5 | 'version' => 'dev-develop', |
  | 6 |  | 'reference' => '~~0a46f86095f2aa29696e1d3fbc3ac00ae538cc84~~', |
  |  | 6 | 'reference' => 'dc4a2dac6c483d11d074b9eacf9373b1d02038f9', |
  | 7 | 7 | 'type' => 'wordpress-plugin', |
  | 8 | 8 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
  | […](/browser/wp-rss-aggregator/trunk/vendor/composer/installed.php?rev=2998119#L341) | […](/browser/wp-rss-aggregator/trunk/vendor/composer/installed.php?rev=3026269#L341) |  |
  | 341 | 341 | 'pretty\_version' => 'dev-develop', |
  | 342 | 342 | 'version' => 'dev-develop', |
  | 343 |  | 'reference' => '~~0a46f86095f2aa29696e1d3fbc3ac00ae538cc84~~', |
  |  | 343 | 'reference' => 'dc4a2dac6c483d11d074b9eacf9373b1d02038f9', |
  | 344 | 344 | 'type' => 'wordpress-plugin', |
  | 345 | 345 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
* ## [wp-rss-aggregator/trunk/wp-rss-aggregator.php](/changeset/3026269/wp-rss-aggregator/trunk/wp-rss-aggregator.php "Show the changeset 3026269 restricted to wp-rss-aggregator/trunk/wp-rss-aggregator.php")

  | [r2998119](/browser/wp-rss-aggregator/trunk/wp-rss-aggregator.php?rev=2998119#L5 "Show revision 2998119 of this file in browser") | [r3026269](/browser/wp-rss-aggregator/trunk/wp-rss-aggregator.php?rev=3026269#L5 "Show revision 3026269 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | \* Plugin URI: https://www.wprssaggregator.com/#utm\_source=wpadmin&utm\_medium=plugin&utm\_campaign=wpraplugin |
  | 6 | 6 | \* Description: Imports and aggregates multiple RSS Feeds. |
  | 7 |  | \* Version: 4.23.~~4~~ |
  |  | 7 | \* Version: 4.23.5 |
  | 8 | 8 | \* Author: RebelCode |
  | 9 | 9 | \* Author URI: https://www.wprssaggregator.com |
  | […](/browser/wp-rss-aggregator/trunk/wp-rss-aggregator.php?rev=2998119#L79) | […](/browser/wp-rss-aggregator/trunk/wp-rss-aggregator.php?rev=3026269#L79) |  |
  | 79 | 79 | // Set the version number of the plugin. |
  | 80 | 80 | if( !defined( 'WPRSS\_VERSION' ) ) |
  | 81 |  | define( 'WPRSS\_VERSION', '4.23.~~4~~' ); |
  |  | 81 | define( 'WPRSS\_VERSION', '4.23.5' ); |
  | 82 | 82 |  |
  | 83 | 83 | if( !defined( 'WPRSS\_WP\_MIN\_VERSION' ) ) |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3026269)
* [Zip Archive](?format=zip&new=3026269)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_ad69a3b8_20250111_074036.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# WP RSS Aggregator <= 4.23.4 - Authenticated (Admin+) Stored Cross-Site Scripting via RSS Feed Source

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   WP RSS Aggregator <= 4.23.4 - Authenticated (Admin+) Stored Cross-Site Scripting via RSS Feed Source

4.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-0630](https://www.cve.org/CVERecord?id=CVE-2024-0630) |
| --- | --- |
| CVSS | 4.4 (Medium) |
| Publicly Published | January 25, 2024 |
| Last Updated | February 5, 2024 |
| Researcher | [Colin Xu](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/colin-xu) |

### Description

The WP RSS Aggregator plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the RSS feed source in all versions up to, and including, 4.23.4 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with administrator-level access, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page. This only affects multi-site installations and installations where unfiltered\_html has been disabled.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3026269/wp-rss-aggregator)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-rss-aggregator%2Fwp-rss-aggregator-4234-authenticated-admin-stored-cross-site-scripting-via-rss-feed-source&t=WP%20RSS%20Aggregator%20%3C%3D%204.23.4%20-%20Authenticated%20%28Admin%2B%29%20Stored%20Cross-Site%20Scripting%20via%20RSS%20Feed%20Source "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-rss-aggregator%2Fwp-rss-aggregator-4234-authenticated-admin-stored-cross-site-scripting-via-rss-feed-source&text=WP%20RSS%20Aggregator%20%3C%3D%204.23.4%20-%20Authenticated%20%28Admin%2B%29%20Stored%20Cross-Site%20Scripting%20via%20RSS%20Feed%20Source "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-rss-aggregator%2Fwp-rss-aggregator-4234-authenticated-admin-stored-cross-site-scripting-via-rss-feed-source "LinkedIn")
Email

## Vulnerability Details for RSS Aggregator – RSS Import, News Feeds, Feed to Post, and Autoblogging

#### [RSS Aggregator – RSS Import, News Feeds, Feed to Post, and Autoblogging](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wp-rss-aggregator)

| Software Type | Plugin |
| --- | --- |
| Software Slug | wp-rss-aggregator [(view on wordpress.org)](https://wordpress.org/plugins/wp-rss-aggregator) |
| Patched? | Yes |
| Remediation | Update to version 4.23.5, or a newer patched version |
| Affected Version | * <= 4.23.4 |
| Patched Version | * 4.23.5 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


