=== Content from huntr.com_a72b7611_20250111_153505.html ===


* [![logo](/horizontal-logo-wh.svg)](/)
* [Bounties](/bounties)
* [Partners](/partners)
* Community
* Info
[SUBMIT REPORT](/bounties/disclose)

Supported by [Protect AI](https://protectai.com/) and leading the way to [MLSecOps](https://mlsecops.com) and greater AI security.

© 2024

[Privacy Policy](/privacy)[Terms of Service](/terms)[Code of Conduct](/code-of-conduct)Cookie Preferences[Contact Us](/contact-us)

=== Content from github.com_e5dd751c_20250111_153504.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzenml-io%2Fzenml%2Fcommit%2F00e934f33a243a554f5f65b80eefd5ea5117367b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzenml-io%2Fzenml%2Fcommit%2F00e934f33a243a554f5f65b80eefd5ea5117367b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=zenml-io%2Fzenml)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[zenml-io](/zenml-io)
/
**[zenml](/zenml-io/zenml)**
Public

* [Notifications](/login?return_to=%2Fzenml-io%2Fzenml) You must be signed in to change notification settings
* [Fork
  465](/login?return_to=%2Fzenml-io%2Fzenml)
* [Star
   4.3k](/login?return_to=%2Fzenml-io%2Fzenml)

* [Code](/zenml-io/zenml)
* [Issues
  22](/zenml-io/zenml/issues)
* [Pull requests
  15](/zenml-io/zenml/pulls)
* [Actions](/zenml-io/zenml/actions)
* [Projects
  0](/zenml-io/zenml/projects)
* [Security](/zenml-io/zenml/security)
* [Insights](/zenml-io/zenml/pulse)

Additional navigation options

* [Code](/zenml-io/zenml)
* [Issues](/zenml-io/zenml/issues)
* [Pull requests](/zenml-io/zenml/pulls)
* [Actions](/zenml-io/zenml/actions)
* [Projects](/zenml-io/zenml/projects)
* [Security](/zenml-io/zenml/security)
* [Insights](/zenml-io/zenml/pulse)

## Commit

[Permalink](/zenml-io/zenml/commit/00e934f33a243a554f5f65b80eefd5ea5117367b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Improve Artifact Store isolation ([#2490](https://github.com/zenml-io/zenml/pull/2490))

[Browse files](/zenml-io/zenml/tree/00e934f33a243a554f5f65b80eefd5ea5117367b)
Browse the repository at this point in the history

```
* dir traversal issue

* Auto-update of Starter template

* Auto-update of NLP template

* reroute artifacts and logs via AS

* reroute materializers via AS

* simplify to one deco

* fix materializer tests

* allow local download

* Auto-update of E2E template

* fix test issues

* rework based on comments

* fix bugs

* lint

* Candidate ([#2493](https://github.com/zenml-io/zenml/pull/2493))

Co-authored-by: Stefan Nica <stefan@zenml.io>

* darglint

---------

Co-authored-by: GitHub Actions <actions@github.com>
Co-authored-by: Stefan Nica <stefan@zenml.io>
```

* Loading branch information

[![@avishniakov](https://avatars.githubusercontent.com/u/31008759?s=40&v=4)](/avishniakov) [![@actions-user](https://avatars.githubusercontent.com/u/65916846?s=40&v=4)](/actions-user) [![@stefannica](https://avatars.githubusercontent.com/u/3963946?s=40&v=4)](/stefannica)

3 people

authored
Mar 5, 2024

1 parent
[683e943](/zenml-io/zenml/commit/683e94355f13d86a163e090c63e770642b233288)

commit 00e934f

 Show file tree

 Hide file tree

Showing
**17 changed files**
with
**279 additions**
and
**113 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/zenml

  + artifact\_stores

    - src/zenml/artifact\_stores/base\_artifact\_store.py
      [base\_artifact\_store.py](#diff-861cd1293ca60bfca9095dac707cf1dc7977fcb22383a896d7427161c1398c69)
  + artifacts

    - src/zenml/artifacts/utils.py
      [utils.py](#diff-ecbc0bc4155f2b1a7acfd3b08c375850ae0929eea0c2ce26d830e75638d456ad)
  + logging

    - src/zenml/logging/step\_logging.py
      [step\_logging.py](#diff-0b6c3abf658759ba24299a6eed57fccede61f4fe6ea507026969c815164048e8)
  + materializers

    - src/zenml/materializers/base\_materializer.py
      [base\_materializer.py](#diff-17e154aea30fa79001291dbf0e77ce66d3fca3886a29a6df1375ec27615f4545)
    - src/zenml/materializers/built\_in\_materializer.py
      [built\_in\_materializer.py](#diff-7a481214291a1d4ceae9c874b3904d92f5e16a7371ab9d1a2b1df75f19f7973b)
    - src/zenml/materializers/cloudpickle\_materializer.py
      [cloudpickle\_materializer.py](#diff-7e53660662f8ff8f845ee85f5e6845d7c8509cf3d61250f2f6b64704f29d998c)
    - src/zenml/materializers/numpy\_materializer.py
      [numpy\_materializer.py](#diff-2853d5dc4ccae5343f72d2c4016d0f1fe4e965547bffd924f01d222f8eaccf94)
    - src/zenml/materializers/pandas\_materializer.py
      [pandas\_materializer.py](#diff-44dcbf73d9e24d2d858d9e1a2f3cdf305de697459cbcb3781cc7e559e9702f6b)
    - src/zenml/materializers/service\_materializer.py
      [service\_materializer.py](#diff-094144e38b4b5a6d717583d60eede711131a41e4bd0d23af2877752999cf7a14)
    - src/zenml/materializers/structured\_string\_materializer.py
      [structured\_string\_materializer.py](#diff-9fe73b33a40e15da3b6a261bfa6c54941d1a7da04652a75811193f8ec6845f82)
  + orchestrators

    - src/zenml/orchestrators/output\_utils.py
      [output\_utils.py](#diff-f3b214d076fd24cccaceab50277d005d1e8ebd2acb92bfa38e18e223aa72efb7)
* tests

  + integration/functional/artifacts

    - tests/integration/functional/artifacts/test\_base\_artifact\_store.py
      [test\_base\_artifact\_store.py](#diff-039cb7b5815424a6c2240f4106e45c380ca3002f59b59606a7d340b08c06d8dc)
    - tests/integration/functional/artifacts/test\_utils.py
      [test\_utils.py](#diff-2b9a6177b24ef8a8902737773eeab4cb5445b197aae101ab21341e6aac3fbd55)
  + unit

    - artifacts

      * tests/unit/artifacts/test\_utils.py
        [test\_utils.py](#diff-179fa006044495ed14407052445d62fb5725dc378c41ac610a770c0f9db397d4)
    - materializers

      * tests/unit/materializers/test\_built\_in\_materializer.py
        [test\_built\_in\_materializer.py](#diff-09c1ff95b6fac46635e8751fb52cb46f8b9a48ee885322178103c178e85d11e3)
      * tests/unit/materializers/test\_cloudpickle\_materializer.py
        [test\_cloudpickle\_materializer.py](#diff-d699a0960e30b36765a5d15d797cc381dc86f6b5b34d2081488c519d6c36f844)
    - tests/unit/test\_general.py
      [test\_general.py](#diff-07897eb5205692b37e20ecea2e069c099dc8c2f89c709c891447f36be9778c2a)

## There are no files selected for viewing

167 changes: 113 additions & 54 deletions

167
[src/zenml/artifact\_stores/base\_artifact\_store.py](#diff-861cd1293ca60bfca9095dac707cf1dc7977fcb22383a896d7427161c1398c69 "src/zenml/artifact_stores/base_artifact_store.py")

Show comments

[View file](/zenml-io/zenml/blob/00e934f33a243a554f5f65b80eefd5ea5117367b/src/zenml/artifact_stores/base_artifact_store.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,8 +13,10 @@ |
|  |  | # permissions and limitations under the License. |
|  |  | """The base interface to extend the ZenML artifact store.""" |
|  |  |  |
|  |  | import inspect |
|  |  | import textwrap |
|  |  | from abc import abstractmethod |
|  |  | from pathlib import Path |
|  |  | from typing import ( |
|  |  | Any, |
|  |  | Callable, |
| Expand Down  Expand Up | | @@ -44,50 +46,93 @@ |
|  |  | PathType = Union[bytes, str] |
|  |  |  |
|  |  |  |
|  |  | def \_sanitize\_potential\_path(potential\_path: Any) -> Any: |
|  |  | """Sanitizes the input if it is a path. |
|  |  | class \_sanitize\_paths: |
|  |  | """Sanitizes path inputs before calling the original function. |
|  |  |  |
|  |  | If the input is a \*\*remote\*\* path, this function replaces backslash path |
|  |  | separators by forward slashes. |
|  |  | Extra decoration layer is needed to pass in fixed artifact store root |
|  |  | path for static methods that are called on filesystems directly. |
|  |  |  |
|  |  | Args: |
|  |  | potential\_path: Value that potentially refers to a (remote) path. |
|  |  | func: The function to decorate. |
|  |  | fixed\_root\_path: The fixed artifact store root path. |
|  |  | is\_static: Whether the function is static or not. |
|  |  |  |
|  |  | Returns: |
|  |  | The original input or a sanitized version of it in case of a remote |
|  |  | path. |
|  |  | Function that calls the input function with sanitized path inputs. |
|  |  | """ |
|  |  | if isinstance(potential\_path, bytes): |
|  |  | path = fileio.convert\_to\_str(potential\_path) |
|  |  | elif isinstance(potential\_path, str): |
|  |  | path = potential\_path |
|  |  | else: |
|  |  | # Neither string nor bytes, this is not a path |
|  |  | return potential\_path |
|  |  |  |
|  |  | if io\_utils.is\_remote(path): |
|  |  | # If we have a remote path, replace windows path separators with |
|  |  | # slashes |
|  |  | import ntpath |
|  |  | import posixpath |
|  |  | def \_\_init\_\_(self, func: Callable[..., Any], fixed\_root\_path: str) -> None: |
|  |  | """Initializes the decorator. |
|  |  |  |
|  |  | path = path.replace(ntpath.sep, posixpath.sep) |
|  |  | Args: |
|  |  | func: The function to decorate. |
|  |  | fixed\_root\_path: The fixed artifact store root path. |
|  |  | """ |
|  |  | self.func = func |
|  |  | self.fixed\_root\_path = fixed\_root\_path |
|  |  |  |
|  |  | return path |
|  |  | self.path\_args: List[int] = [] |
|  |  | self.path\_kwargs: List[str] = [] |
|  |  | for i, param in enumerate( |
|  |  | inspect.signature(self.func).parameters.values() |
|  |  | ): |
|  |  | if param.annotation == PathType: |
|  |  | self.path\_kwargs.append(param.name) |
|  |  | if param.default == inspect.Parameter.empty: |
|  |  | self.path\_args.append(i) |
|  |  |  |
|  |  | def \_validate\_path(self, path: str) -> None: |
|  |  | """Validates a path. |
|  |  |  |
|  |  | def \_sanitize\_paths(\_func: Callable[..., Any]) -> Callable[..., Any]: |
|  |  | """Sanitizes path inputs before calling the original function. |
|  |  | Args: |
|  |  | path: The path to validate. |
|  |  |  |
|  |  | Args: |
|  |  | \_func: The function for which to sanitize the inputs. |
|  |  | Raises: |
|  |  | FileNotFoundError: If the path is outside of the artifact store |
|  |  | bounds. |
|  |  | """ |
|  |  | if not path.startswith(self.fixed\_root\_path): |
|  |  | raise FileNotFoundError( |
|  |  | f"File `{path}` is outside of " |
|  |  | f"artifact store bounds `{self.fixed\_root\_path}`" |
|  |  | ) |
|  |  |  |
|  |  | Returns: |
|  |  | Function that calls the input function with sanitized path inputs. |
|  |  | """ |
|  |  | def \_sanitize\_potential\_path(self, potential\_path: Any) -> Any: |
|  |  | """Sanitizes the input if it is a path. |
|  |  |  |
|  |  | If the input is a \*\*remote\*\* path, this function replaces backslash path |
|  |  | separators by forward slashes. |
|  |  |  |
|  |  | def inner\_function(\*args: Any, \*\*kwargs: Any) -> Any: |
|  |  | """Inner function. |
|  |  | Args: |
|  |  | potential\_path: Value that potentially refers to a (remote) path. |
|  |  |  |
|  |  | Returns: |
|  |  | The original input or a sanitized version of it in case of a remote |
|  |  | path. |
|  |  | """ |
|  |  | if isinstance(potential\_path, bytes): |
|  |  | path = fileio.convert\_to\_str(potential\_path) |
|  |  | elif isinstance(potential\_path, str): |
|  |  | path = potential\_path |
|  |  | else: |
|  |  | # Neither string nor bytes, this is not a path |
|  |  | return potential\_path |
|  |  |  |
|  |  | if io\_utils.is\_remote(path): |
|  |  | # If we have a remote path, replace windows path separators with |
|  |  | # slashes |
|  |  | import ntpath |
|  |  | import posixpath |
|  |  |  |
|  |  | path = path.replace(ntpath.sep, posixpath.sep) |
|  |  | self.\_validate\_path(path) |
|  |  | else: |
|  |  | self.\_validate\_path(str(Path(path).absolute().resolve())) |
|  |  |  |
|  |  | return path |
|  |  |  |
|  |  | def \_\_call\_\_(self, \*args: Any, \*\*kwargs: Any) -> Any: |
|  |  | """Decorator function that sanitizes paths before calling the original function. |
|  |  |  |
|  |  | Args: |
|  |  | \*args: Positional args. |
| Expand All | | @@ -96,15 +141,28 @@ def inner\_function(\*args: Any, \*\*kwargs: Any) -> Any: |
|  |  | Returns: |
|  |  | Output of the input function called with sanitized paths. |
|  |  | """ |
|  |  | args = tuple(\_sanitize\_potential\_path(arg) for arg in args) |
|  |  | # verify if `self` is part of the args |
|  |  | has\_self = bool(args and isinstance(args[0], BaseArtifactStore)) |
|  |  |  |
|  |  | # sanitize inputs for relevant args and kwargs, keep rest unchanged |
|  |  | args = tuple( |
|  |  | self.\_sanitize\_potential\_path( |
|  |  | arg, |
|  |  | ) |
|  |  | if i + has\_self in self.path\_args |
|  |  | else arg |
|  |  | for i, arg in enumerate(args) |
|  |  | ) |
|  |  | kwargs = { |
|  |  | key: \_sanitize\_potential\_path(value) |
|  |  | key: self.\_sanitize\_potential\_path( |
|  |  | value, |
|  |  | ) |
|  |  | if key in self.path\_kwargs |
|  |  | else value |
|  |  | for key, value in kwargs.items() |
|  |  | } |
|  |  |  |
|  |  | return \_func(\*args, \*\*kwargs) |
|  |  |  |
|  |  | return inner\_function |
|  |  | return self.func(\*args, \*\*kwargs) |
|  |  |  |
|  |  |  |
|  |  | class BaseArtifactStoreConfig(StackComponentConfig): |
| Expand Down  Expand Up | | @@ -323,6 +381,7 @@ def stat(self, path: PathType) -> Any: |
|  |  | The stat descriptor. |
|  |  | """ |
|  |  |  |
|  |  | @abstractmethod |
|  |  | def size(self, path: PathType) -> Optional[int]: |
|  |  | """Get the size of a file in bytes. |
|  |  |  |
| Expand Down  Expand Up | | @@ -376,30 +435,30 @@ def \_register(self) -> None: |
|  |  | from zenml.io.filesystem\_registry import default\_filesystem\_registry |
|  |  | from zenml.io.local\_filesystem import LocalFilesystem |
|  |  |  |
|  |  | overloads: Dict[str, Any] = { |
|  |  | "SUPPORTED\_SCHEMES": self.config.SUPPORTED\_SCHEMES, |
|  |  | } |
|  |  | for abc\_method in inspect.getmembers(BaseArtifactStore): |
|  |  | if getattr(abc\_method[1], "\_\_isabstractmethod\_\_", False): |
|  |  | sanitized\_method = \_sanitize\_paths( |
|  |  | getattr(self, abc\_method[0]), self.path |
|  |  | ) |
|  |  | # prepare overloads for filesystem methods |
|  |  | overloads[abc\_method[0]] = staticmethod(sanitized\_method) |
|  |  |  |
|  |  | # decorate artifact store methods |
|  |  | setattr( |
|  |  | self, |
|  |  | abc\_method[0], |
|  |  | sanitized\_method, |
|  |  | ) |
|  |  |  |
|  |  | # Local filesystem is always registered, no point in doing it again. |
|  |  | if isinstance(self, LocalFilesystem): |
|  |  | return |
|  |  |  |
|  |  | filesystem\_class = type( |
|  |  | self.\_\_class\_\_.\_\_name\_\_, |
|  |  | (BaseFilesystem,), |
|  |  | { |
|  |  | "SUPPORTED\_SCHEMES": self.config.SUPPORTED\_SCHEMES, |
|  |  | "open": staticmethod(\_sanitize\_paths(self.open)), |
|  |  | "copyfile": staticmethod(\_sanitize\_paths(self.copyfile)), |
|  |  | "exists": staticmethod(\_sanitize\_paths(self.exists)), |
|  |  | "glob": staticmethod(\_sanitize\_paths(self.glob)), |
|  |  | "isdir": staticmethod(\_sanitize\_paths(self.isdir)), |
|  |  | "listdir": staticmethod(\_sanitize\_paths(self.listdir)), |
|  |  | "makedirs": staticmethod(\_sanitize\_paths(self.makedirs)), |
|  |  | "mkdir": staticmethod(\_sanitize\_paths(self.mkdir)), |
|  |  | "remove": staticmethod(\_sanitize\_paths(self.remove)), |
|  |  | "rename": staticmethod(\_sanitize\_paths(self.rename)), |
|  |  | "rmtree": staticmethod(\_sanitize\_paths(self.rmtree)), |
|  |  | "size": staticmethod(\_sanitize\_paths(self.size)), |
|  |  | "stat": staticmethod(\_sanitize\_paths(self.stat)), |
|  |  | "walk": staticmethod(\_sanitize\_paths(self.walk)), |
|  |  | }, |
|  |  | self.\_\_class\_\_.\_\_name\_\_, (BaseFilesystem,), overloads |
|  |  | ) |
|  |  |  |
|  |  | default\_filesystem\_registry.register(filesystem\_class) |
| Expand Down | |  |

10 changes: 7 additions & 3 deletions

10
[src/zenml/artifacts/utils.py](#diff-ecbc0bc4155f2b1a7acfd3b08c375850ae0929eea0c2ce26d830e75638d456ad "src/zenml/artifacts/utils.py")

Show comments

[View file](/zenml-io/zenml/blob/00e934f33a243a554f5f65b80eefd5ea5117367b/src/zenml/artifacts/utils.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -152,7 +152,7 @@ def save\_artifact( |
|  |  | if not uri.startswith(artifact\_store.path): |
|  |  | uri = os.path.join(artifact\_store.path, uri) |
|  |  |  |
|  |  | if manual\_save and fileio.exists(uri): |
|  |  | if manual\_save and artifact\_store.exists(uri): |
|  |  | # This check is only necessary for manual saves as we already check |
|  |  | # it when creating the directory for step output artifacts |
|  |  | other\_artifacts = client.list\_artifact\_versions(uri=uri, size=1) |
| Expand All | | @@ -162,7 +162,7 @@ def save\_artifact( |
|  |  | f"{uri} because the URI is already used by artifact " |
|  |  | f"{other\_artifact.name} (version {other\_artifact.version})." |
|  |  | ) |
|  |  | fileio.makedirs(uri) |
|  |  | artifact\_store.makedirs(uri) |
|  |  |  |
|  |  | # Find and initialize the right materializer class |
|  |  | if isinstance(materializer, type): |
| Expand Down  Expand Up | | @@ -752,6 +752,7 @@ def \_load\_file\_from\_artifact\_store( |
|  |  | Raises: |
|  |  | DoesNotExistException: If the file does not exist in the artifact store. |
|  |  | NotImplementedError: If the artifact store cannot open the file. |
|  |  | IOError: If the artifact store rejects the request. |
|  |  | """ |
|  |  | try: |
|  |  | with artifact\_store.open(uri, mode) as text\_file: |
| Expand All | | @@ -761,6 +762,8 @@ def \_load\_file\_from\_artifact\_store( |
|  |  | f"File '{uri}' does not exist in artifact store " |
|  |  | f"'{artifact\_store.name}'." |
|  |  | ) |
|  |  | except IOError as e: |
|  |  | raise e |
|  |  | except Exception as e: |
|  |  | logger.exception(e) |
|  |  | link = "https://docs.zenml.io/stacks-and-components/component-guide/artifact-stores/custom#enabling-artifact-visualizations-with-custom-artifact-stores" |
| Expand Down  Expand Up | | @@ -819,7 +822,8 @@ def load\_model\_from\_metadata(model\_uri: str) -> Any: |
|  |  | The ML model object loaded into memory. |
|  |  | """ |
|  |  | # Load the model from its metadata |
|  |  | with fileio.open( |
|  |  | artifact\_store = Client().active\_stack.artifact\_store |
|  |  | with artifact\_store.open( |
|  |  | os.path.join(model\_uri, MODEL\_METADATA\_YAML\_FILE\_NAME), "r" |
|  |  | ) as f: |
|  |  | metadata = read\_yaml(f.name) |
| Expand Down | |  |

14 changes: 8 additions & 6 deletions

14
[src/zenml/logging/step\_logging.py](#diff-0b6c3abf658759ba24299a6eed57fccede61f4fe6ea507026969c815164048e8 "src/zenml/logging/step_logging.py")

Show comments

[View file](/zenml-io/zenml/blob/00e934f33a243a554f5f65b80eefd5ea5117367b/src/zenml/logging/step_logging.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,7 +23,7 @@ |
|  |  | from uuid import uuid4 |
|  |  |  |
|  |  | from zenml.artifact\_stores import BaseArtifactStore |
|  |  | from zenml.io import fileio |
|  |  | from zenml.client import Client |
|  |  | from zenml.logger import get\_logger |
|  |  | from zenml.logging import ( |
|  |  | STEP\_LOGS\_STORAGE\_INTERVAL\_SECONDS, |
| Expand Down  Expand Up | | @@ -64,6 +64,7 @@ def prepare\_logs\_uri( |
|  |  | Returns: |
|  |  | The URI of the logs file. |
|  |  | """ |
|  |  | artifact\_store = Client().active\_stack.artifact\_store |
|  |  | if log\_key is None: |
|  |  | log\_key = str(uuid4()) |
|  |  |  |
| Expand All | | @@ -74,16 +75,16 @@ def prepare\_logs\_uri( |
|  |  | ) |
|  |  |  |
|  |  | # Create the dir |
|  |  | if not fileio.exists(logs\_base\_uri): |
|  |  | fileio.makedirs(logs\_base\_uri) |
|  |  | if not artifact\_store.exists(logs\_base\_uri): |
|  |  | artifact\_store.makedirs(logs\_base\_uri) |
|  |  |  |
|  |  | # Delete the file if it already exists |
|  |  | logs\_uri = os.path.join(logs\_base\_uri, f"{log\_key}.log") |
|  |  | if fileio.exists(logs\_uri): |
|  |  | if artifact\_store.exists(logs\_uri): |
|  |  | logger.warning( |
|  |  | f"Logs file {logs\_uri} already exists! Removing old log file..." |
|  |  | ) |
|  |  | fileio.remove(logs\_uri) |
|  |  | artifact\_store.remove(logs\_uri) |
|  |  | return logs\_uri |
|  |  |  |
|  |  |  |
| Expand Down  Expand Up | | @@ -135,12 +136,13 @@ def write(self, text: str) -> None: |
|  |  |  |
|  |  | def save\_to\_file(self) -> None: |
|  |  | """Method to save the buffer to the given URI.""" |
|  |  | artifact\_store = Client().active\_stack.artifact\_store |
|  |  | if not self.disabled: |
|  |  | try: |
|  |  | self.disabled = True |
|  |  |  |
|  |  | if self.buffer: |
|  |  | with fileio.open(self.logs\_uri, "a") as file: |
|  |  | with artifact\_store.open(self.logs\_uri, "a") as file: |
|  |  | for message in self.buffer: |
|  |  | file.write( |
|  |  | remove\_ansi\_escape\_codes(message) + "\n" |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[src/zenml/materializers/base\_materializer.py](#diff-17e154aea30fa79001291dbf0e77ce66d3fca3886a29a6df1375ec27615f4545 "src/zenml/materializers/base_materializer.py")

Show comments

[View file](/zenml-io/zenml/blob/00e934f33a243a554f5f65b80eefd5ea5117367b/src/zenml/materializers/base_materializer.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -156,8 +156,9 @@ def save\_visualizations(self, data: Any) -> Dict[str, VisualizationType]: |
|  |  |  |
|  |  | Example: |
|  |  | ``` |
|  |  | artifact\_store = Client().active\_stack.artifact\_store |
|  |  | visualization\_uri = os.path.join(self.uri, "visualization.html") |
|  |  | with fileio.open(visualization\_uri, "w") as f: |
|  |  | with artifact\_store.open(visualization\_uri, "w") as f: |
|  |  | f.write("<html><body>data</body></html>") |
|  |  |  |
|  |  | visualization\_uri\_2 = os.path.join(self.uri, "visualization.png") |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `00e934f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzenml-io%2Fzenml%2Fcommit%2F00e934f33a243a554f5f65b80eefd5ea5117367b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


