
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F65390)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F65390)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=golang%2Fgo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[golang](/golang)
/
**[go](/golang/go)**
Public

* [Notifications](/login?return_to=%2Fgolang%2Fgo) You must be signed in to change notification settings
* [Fork
  17.8k](/login?return_to=%2Fgolang%2Fgo)
* [Star
   125k](/login?return_to=%2Fgolang%2Fgo)

* [Code](/golang/go)
* [Issues
  5k+](/golang/go/issues)
* [Pull requests
  508](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects
  4](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

Additional navigation options

* [Code](/golang/go)
* [Issues](/golang/go/issues)
* [Pull requests](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgolang%2Fgo%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgolang%2Fgo%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# crypto/x509: Verify panics on certificates with an unknown public key algorithm [CVE-2024-24783] #65390

Closed

[neild](/neild) opened this issue
Jan 30, 2024
· 5 comments

Closed

# [crypto/x509: Verify panics on certificates with an unknown public key algorithm [CVE-2024-24783]](#top) #65390

[neild](/neild) opened this issue
Jan 30, 2024
· 5 comments

Assignees
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&v=4)](/neild)

Labels
[NeedsFix](/golang/go/labels/NeedsFix)
The path to resolution is known, but the work has not been done.
[release-blocker](/golang/go/labels/release-blocker)
[Security](/golang/go/labels/Security)

Milestone
[Go1.23](/golang/go/milestone/212 "Go1.23")

## Comments

[![@neild](https://avatars.githubusercontent.com/u/52544?s=80&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)

Copy link

Contributor

### **[neild](/neild)** commented [Jan 30, 2024](#issue-2108904282) • edited by mknyszek Loading

| Verifying a certificate chain which contains a certificate with an unknown public key algorithm will cause Certificate.Verify to panic.  This affects all crypto/tls clients, and servers that set Config.ClientAuth to VerifyClientCertIfGiven or RequireAndVerifyClientCert. The default behavior is for TLS servers to not verify client certificates.  Thanks to John Howard (Google) for reporting this issue. This is [CVE-2024-24783](https://github.com/advisories/GHSA-3q2c-pvp5-3cqp "CVE-2024-24783").  /cc @golang/security and @golang/release |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)
[neild](/neild)
added
[Security](/golang/go/labels/Security)
[release-blocker](/golang/go/labels/release-blocker)
labels
[Jan 30, 2024](#event-11648283086)

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)
[neild](/neild)
added this to the [Go1.22](/golang/go/milestone/298) milestone
[Jan 30, 2024](#event-11648283107)

[![@github-project-automation](https://avatars.githubusercontent.com/in/235829?s=40&v=4)](/apps/github-project-automation)
[github-project-automation](/apps/github-project-automation)
bot
added this to [Release Blockers](/orgs/golang/projects/16)
[Jan 30, 2024](#event-14871411758)

[![@neild](https://avatars.githubusercontent.com/u/52544?s=80&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)

Copy link

Contributor

Author

### **[neild](/neild)** commented [Jan 30, 2024](#issuecomment-1918007928)

| [@gopherbot](https://github.com/gopherbot) please open backport issues for this security fix. |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)
[gopherbot](/gopherbot)
mentioned this issue
[Jan 30, 2024](#ref-issue-2108905181)

[security: fix CVE-2024-24783 [1.20 backport]
#65391](/golang/go/issues/65391)

Closed

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Jan 30, 2024](#issuecomment-1918008310)

| Backport issue(s) opened: [#65391](https://github.com/golang/go/issues/65391) (for 1.20), [#65392](https://github.com/golang/go/issues/65392) (for 1.21).  Remember to create the cherry-pick CL(s) as soon as the patch is submitted to master, according to <https://go.dev/wiki/MinorReleases>. |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)
[gopherbot](/gopherbot)
mentioned this issue
[Jan 30, 2024](#ref-issue-2108905193)

[security: fix CVE-2024-24783 [1.21 backport]
#65392](/golang/go/issues/65392)

Closed

[![@mknyszek](https://avatars.githubusercontent.com/u/1248668?s=40&u=43d1280f5d30cfd450e4b47693153b22a86ec893&v=4)](/mknyszek)
[mknyszek](/mknyszek)
added
the
[NeedsFix](/golang/go/labels/NeedsFix)
The path to resolution is known, but the work has not been done.
label
[Jan 31, 2024](#event-11659265326)

[![@mknyszek](https://avatars.githubusercontent.com/u/1248668?s=40&u=43d1280f5d30cfd450e4b47693153b22a86ec893&v=4)](/mknyszek)
[mknyszek](/mknyszek)
modified the milestones:
[Go1.22](/golang/go/milestone/298),
[Go1.23](/golang/go/milestone/212)
[Feb 2, 2024](#event-11687599572)

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)
[neild](/neild)
self-assigned this
[Feb 21, 2024](#event-11868737694)

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)
[neild](/neild)
mentioned this issue
[Feb 21, 2024](#ref-issue-2145504549)

[security: fix CVE-2024-24783 [1.22 backport]
#65831](/golang/go/issues/65831)

Closed

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Mar 5, 2024](#issuecomment-1979103646)

| Change <https://go.dev/cl/569235> mentions this issue: `[release-branch.go1.22] crypto/x509: make sure pub key is non-nil before interface conversion` |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Mar 5, 2024](#issuecomment-1979103753)

| Change <https://go.dev/cl/569238> mentions this issue: `[release-branch.go1.21] crypto/x509: make sure pub key is non-nil before interface conversion` |
| --- |

All reactions

Sorry, something went wrong.

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Mar 5, 2024](#ref-commit-337b8e9)
[![@rolandshoemaker](https://avatars.githubusercontent.com/u/5080674?s=40&u=c9a1ba53e27929b8d12ab031c053f540a9693db3&v=4)](/rolandshoemaker) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&v=4)](/gopherbot)

`[[release-branch.go1.22] crypto/x509: make sure pub key is non-nil bef…](/golang/go/commit/337b8e9cbfa749d9d5c899e0dc358e2208d5e54f "[release-branch.go1.22] crypto/x509: make sure pub key is non-nil before interface conversion

alreadyInChain assumes all keys fit a interface which contains the
Equal method (which they do), but this ignores that certificates may
have a nil key when PublicKeyAlgorithm is UnknownPublicKeyAlgorithm. In
this case alreadyInChain panics.

Check that the key is non-nil as part of considerCandidate (we are never
going to build a chain containing UnknownPublicKeyAlgorithm anyway).

For #65390
Fixes #65831
Fixes CVE-2024-24783

Change-Id: Ibdccc0a487e3368b6812be35daad2512220243f3
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2137282
Reviewed-by: Damien Neil <dneil@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2174343
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-on: https://go-review.googlesource.com/c/go/+/569235
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>
Reviewed-by: Carlos Amedee <carlos@golang.org>")`
…

`[337b8e9](/golang/go/commit/337b8e9cbfa749d9d5c899e0dc358e2208d5e54f)`

```
…ore interface conversion

alreadyInChain assumes all keys fit a interface which contains the
Equal method (which they do), but this ignores that certificates may
have a nil key when PublicKeyAlgorithm is UnknownPublicKeyAlgorithm. In
this case alreadyInChain panics.

Check that the key is non-nil as part of considerCandidate (we are never
going to build a chain containing UnknownPublicKeyAlgorithm anyway).

For [#65390](https://github.com/golang/go/issues/65390)
Fixes [#65831](https://github.com/golang/go/issues/65831)
Fixes [CVE-2024-24783](https://github.com/advisories/GHSA-3q2c-pvp5-3cqp "CVE-2024-24783")

Change-Id: Ibdccc0a487e3368b6812be35daad2512220243f3
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2137282](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2137282)
Reviewed-by: Damien Neil <dneil@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2174343](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2174343)
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-on: [https://go-review.googlesource.com/c/go/+/569235](https://go-review.googlesource.com/c/go/%2B/569235)
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>
Reviewed-by: Carlos Amedee <carlos@golang.org>
```

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Mar 5, 2024](#ref-commit-be5b52b)
[![@rolandshoemaker](https://avatars.githubusercontent.com/u/5080674?s=40&u=c9a1ba53e27929b8d12ab031c053f540a9693db3&v=4)](/rolandshoemaker) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&v=4)](/gopherbot)

`[[release-branch.go1.21] crypto/x509: make sure pub key is non-nil bef…](/golang/go/commit/be5b52bea674190ef7de272664be6c7ae93ec5a0 "[release-branch.go1.21] crypto/x509: make sure pub key is non-nil before interface conversion

alreadyInChain assumes all keys fit a interface which contains the
Equal method (which they do), but this ignores that certificates may
have a nil key when PublicKeyAlgorithm is UnknownPublicKeyAlgorithm. In
this case alreadyInChain panics.

Check that the key is non-nil as part of considerCandidate (we are never
going to build a chain containing UnknownPublicKeyAlgorithm anyway).

For #65390
Fixes #65392
Fixes CVE-2024-24783

Change-Id: Ibdccc0a487e3368b6812be35daad2512220243f3
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2137282
Reviewed-by: Damien Neil <dneil@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2173774
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: https://go-review.googlesource.com/c/go/+/569238
Auto-Submit: Michael Knyszek <mknyszek@google.com>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Carlos Amedee <carlos@golang.org>")`
…

`[be5b52b](/golang/go/commit/be5b52bea674190ef7de272664be6c7ae93ec5a0)`

```
…ore interface conversion

alreadyInChain assumes all keys fit a interface which contains the
Equal method (which they do), but this ignores that certificates may
have a nil key when PublicKeyAlgorithm is UnknownPublicKeyAlgorithm. In
this case alreadyInChain panics.

Check that the key is non-nil as part of considerCandidate (we are never
going to build a chain containing UnknownPublicKeyAlgorithm anyway).

For [#65390](https://github.com/golang/go/issues/65390)
Fixes [#65392](https://github.com/golang/go/issues/65392)
Fixes [CVE-2024-24783](https://github.com/advisories/GHSA-3q2c-pvp5-3cqp "CVE-2024-24783")

Change-Id: Ibdccc0a487e3368b6812be35daad2512220243f3
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2137282](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2137282)
Reviewed-by: Damien Neil <dneil@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2173774](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2173774)
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: [https://go-review.googlesource.com/c/go/+/569238](https://go-review.googlesource.com/c/go/%2B/569238)
Auto-Submit: Michael Knyszek <mknyszek@google.com>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Carlos Amedee <carlos@golang.org>
```

[![@mknyszek](https://avatars.githubusercontent.com/u/1248668?s=40&u=43d1280f5d30cfd450e4b47693153b22a86ec893&v=4)](/mknyszek)
[mknyszek](/mknyszek)
changed the title
~~security: fix CVE-2024-24783~~
crypto/x509: Verify panics on certificates with an unknown public key algorithm [CVE-2024-24783]
[Mar 5, 2024](#event-12017733261)

[bradfitz](/bradfitz)
pushed a commit
to tailscale/go
that referenced
this issue
[Mar 5, 2024](#ref-commit-4da1f86)
[![@rolandshoemaker](https://avatars.githubusercontent.com/u/5080674?s=40&u=c9a1ba53e27929b8d12ab031c053f540a9693db3&v=4)](/rolandshoemaker) [![@bradfitz](https://avatars.githubusercontent.com/u/2621?s=40&v=4)](/bradfitz)

`[[release-branch.go1.22] crypto/x509: make sure pub key is non-nil bef…](/tailscale/go/commit/4da1f86d94fe1236701fd2dd07be5a170cde7312 "[release-branch.go1.22] crypto/x509: make sure pub key is non-nil before interface conversion

alreadyInChain assumes all keys fit a interface which contains the
Equal method (which they do), but this ignores that certificates may
have a nil key when PublicKeyAlgorithm is UnknownPublicKeyAlgorithm. In
this case alreadyInChain panics.

Check that the key is non-nil as part of considerCandidate (we are never
going to build a chain containing UnknownPublicKeyAlgorithm anyway).

For #65390
Fixes #65831
Fixes CVE-2024-24783

Change-Id: Ibdccc0a487e3368b6812be35daad2512220243f3
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2137282
Reviewed-by: Damien Neil <dneil@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2174343
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-on: https://go-review.googlesource.com/c/go/+/569235
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>
Reviewed-by: Carlos Amedee <carlos@golang.org>")`
…

`[4da1f86](/tailscale/go/commit/4da1f86d94fe1236701fd2dd07be5a170cde7312)`

```
…ore interface conversion

alreadyInChain assumes all keys fit a interface which contains the
Equal method (which they do), but this ignores that certificates may
have a nil key when PublicKeyAlgorithm is UnknownPublicKeyAlgorithm. In
this case alreadyInChain panics.

Check that the key is non-nil as part of considerCandidate (we are never
going to build a chain containing UnknownPublicKeyAlgorithm anyway).

For [golang#65390](https://github.com/golang/go/issues/65390)
Fixes [golang#65831](https://github.com/golang/go/issues/65831)
Fixes [CVE-2024-24783](https://github.com/advisories/GHSA-3q2c-pvp5-3cqp "CVE-2024-24783")

Change-Id: Ibdccc0a487e3368b6812be35daad2512220243f3
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2137282](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2137282)
Reviewed-by: Damien Neil <dneil@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2174343](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2174343)
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-on: [https://go-review.googlesource.com/c/go/+/569235](https://go-review.googlesource.com/c/go/%2B/569235)
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>
Reviewed-by: Carlos Amedee <carlos@golang.org>
```

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Mar 5, 2024](#issuecomment-1979358985)

| Change <https://go.dev/cl/569339> mentions this issue: `crypto/x509: make sure pub key is non-nil before interface conversion` |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)
[gopherbot](/gopherbot)
closed this as [completed](/golang/go/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
`[afb1050](/golang/go/commit/afb105056dc62b3f2f569341a9fff080023ee812)`
[Mar 5, 2024](#event-12018090609)

[![@github-project-automation](https://avatars.githubusercontent.com/in/235829?s=40&v=4)](/apps/github-project-automation)
[github-project-automation](/apps/github-project-automation)
bot
moved this to **Done**
in [Release Blockers](/orgs/golang/projects/16)
[Mar 5, 2024](#event-15065807898)

[romaindoumenc](/romaindoumenc)
pushed a commit
to TroutSoftware/go
that referenced
this issue
[Mar 6, 2024](#ref-commit-b66cd86)
[![@rolandshoemaker](https://avatars.githubusercontent.com/u/5080674?s=40&u=c9a1ba53e27929b8d12ab031c053f540a9693db3&v=4)](/rolandshoemaker) [![@romaindoumenc](https://avatars.githubusercontent.com/u/4268844?s=40&v=4)](/romaindoumenc)

`[[release-branch.go1.22] crypto/x509: make sure pub key is non-nil bef…](/TroutSoftware/go/commit/b66cd869a63de9994acd62c6cfde5511cf2c2bf2 "[release-branch.go1.22] crypto/x509: make sure pub key is non-nil before interface conversion

alreadyInChain assumes all keys fit a interface which contains the
Equal method (which they do), but this ignores that certificates may
have a nil key when PublicKeyAlgorithm is UnknownPublicKeyAlgorithm. In
this case alreadyInChain panics.

Check that the key is non-nil as part of considerCandidate (we are never
going to build a chain containing UnknownPublicKeyAlgorithm anyway).

For #65390
Fixes #65831
Fixes CVE-2024-24783

Change-Id: Ibdccc0a487e3368b6812be35daad2512220243f3
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2137282
Reviewed-by: Damien Neil <dneil@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2174343
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-on: https://go-review.googlesource.com/c/go/+/569235
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>
Reviewed-by: Carlos Amedee <carlos@golang.org>")`
…

`[b66cd86](/TroutSoftware/go/commit/b66cd869a63de9994acd62c6cfde5511cf2c2bf2)`

```
…ore interface conversion

alreadyInChain assumes all keys fit a interface which contains the
Equal method (which they do), but this ignores that certificates may
have a nil key when PublicKeyAlgorithm is UnknownPublicKeyAlgorithm. In
this case alreadyInChain panics.

Check that the key is non-nil as part of considerCandidate (we are never
going to build a chain containing UnknownPublicKeyAlgorithm anyway).

For [golang#65390](https://github.com/golang/go/issues/65390)
Fixes [golang#65831](https://github.com/golang/go/issues/65831)
Fixes [CVE-2024-24783](https://github.com/advisories/GHSA-3q2c-pvp5-3cqp "CVE-2024-24783")

Change-Id: Ibdccc0a487e3368b6812be35daad2512220243f3
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2137282](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2137282)
Reviewed-by: Damien Neil <dneil@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2174343](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2174343)
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-on: [https://go-review.googlesource.com/c/go/+/569235](https://go-review.googlesource.com/c/go/%2B/569235)
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>
Reviewed-by: Carlos Amedee <carlos@golang.org>
```

[![@rolandshoemaker](https://avatars.githubusercontent.com/u/5080674?s=40&v=4)](/rolandshoemaker)
[rolandshoemaker](/rolandshoemaker)
mentioned this issue
[Mar 8, 2024](#ref-issue-2174393859)

[crypto/x509: Certificate.isValid should reject certificates with UnknownPublicKeyAlgorithm
#66167](/golang/go/issues/66167)

Open

[![@arisazimli](https://avatars.githubusercontent.com/u/106261386?s=40&v=4)](/arisazimli)
[arisazimli](/arisazimli)
mentioned this issue
[Aug 26, 2024](#ref-issue-2486565898)

[Title4
endpointlabs/WebGoat#12](/endpointlabs/WebGoat/issues/12)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F65390)

Assignees

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&v=4)](/neild) [neild](/neild)

Labels

[NeedsFix](/golang/go/labels/NeedsFix)
The path to resolution is known, but the work has not been done.
[release-blocker](/golang/go/labels/release-blocker)
[Security](/golang/go/labels/Security)

Projects

[Release Blockers](/orgs/golang/projects/16)

Status: Done

 +1 more

Milestone

 [**Go1.23**](/golang/go/milestone/212 "Go1.23")

Development

No branches or pull requests

3 participants

[![@neild](https://avatars.githubusercontent.com/u/52544?s=52&v=4)](/neild) [![@mknyszek](https://avatars.githubusercontent.com/u/1248668?s=52&v=4)](/mknyszek) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=52&v=4)](/gopherbot)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

