Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2022-1442

**Root Cause of Vulnerability:** Improper access control in the `get_all_data` function within the `~/core/forms/action.php` file of the Metform WordPress plugin.

**Weaknesses/Vulnerabilities Present:**
*   **Missing Authorization:** The `get_all_data` function, responsible for retrieving form data including sensitive API keys and secrets, lacked proper authorization checks. This allowed unauthenticated users to access this function.
*   **Sensitive Information Disclosure:** The vulnerable function directly exposed sensitive information, including API keys and secrets for third-party integrations (e.g., PayPal, Stripe, Mailchimp, HubSpot, HelpScout, reCAPTCHA, etc.), without any authentication.

**Impact of Exploitation:**
*   **Unauthorized Access to API Keys:** Attackers could gain access to sensitive API keys and secrets for various third-party services integrated with the vulnerable WordPress plugin.
*   **Account Compromise:** With the leaked API credentials, attackers could potentially compromise accounts on third-party services.
*   **Data Breach:** The leaked API keys and credentials could be used to extract data from third-party services.
*   **Financial Loss:** If payment gateway API keys like Paypal or Stripe are compromised, attackers could potentially make fraudulent transactions.

**Attack Vectors:**
*   **Network Access:** The vulnerability can be exploited remotely over the network
*   **Unauthenticated Access:** The attack does not require any form of authentication.

**Required Attacker Capabilities/Position:**
*   **Basic Network Access:** The attacker only requires network access to the vulnerable WordPress site.
*   **No Authentication Required:** The attacker does not need a valid user account on the WordPress site.

**Technical Details:**

1.  The vulnerability lies in the `get_all_data` function in `/wp-content/plugins/metform/core/forms/action.php`.
2.  The vulnerable endpoint is `/wp-json/metform/v1/forms/get/{form_id_here}`.
3.  An attacker can first use `/wp-json/metform/v1/forms/templates/0` to enumerate form IDs.
4.  Then use `/wp-json/metform/v1/forms/get/{form_id_here}` to fetch form data which includes the sensitive data.
5.  The vulnerable code block is in the `get_all_data` function which previously lacked any permission/role check.

```php
	public function get_all_data($post_id) {
		$post = get_post($post_id);
        ...
		return $all_settings;
	}
```

**Patch:**
The fix implemented in version 2.1.4 added a capability check to the vulnerable `get_all_data` function:
```php
	public function get_all_data($post_id) {
        if(!current_user_can('manage_options')) {
            return;
        }
		$post = get_post($post_id);
        ...
		return $all_settings;
	}
```
This ensures that only users with the `manage_options` capability (typically administrators) can access the sensitive form data.

**Additional Notes:**
*   The vulnerability was discovered by Muhammad Zeeshan (Xib3rR4dAr).
*   The plugin has over 100,000 active installations.
*   The vulnerability is rated as high severity with a CVSS score of 7.5.
*   The exploit is publicly available.
*   The vulnerability was fixed in version 2.1.4.