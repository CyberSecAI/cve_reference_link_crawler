```
{
  "vulnerability": {
    "root_cause": "The Microsoft Windows Print Spooler service does not properly restrict access to functionality that allows users to add printers and related drivers. Specifically, the RpcAddPrinterDriverEx() function and RpcAsyncAddPrinterDriver function can be called by any authenticated user to install a printer driver on a system. This allows specifying a driver file located on a remote server, leading to the Print Spooler service (spoolsv.exe) executing arbitrary code in a DLL with SYSTEM privileges.",
    "weaknesses": [
      "Inadequate access control",
       "Unrestricted use of RpcAddPrinterDriverEx() and RpcAsyncAddPrinterDriver functions",
      "Ability to specify remote driver file locations"
    ],
    "impact": "Remote and local privilege escalation resulting in arbitrary code execution with SYSTEM privileges.",
    "attack_vectors": [
      "Remote: Sending a request to add a printer via RpcAddPrinterDriverEx() over SMB or RpcAsyncAddPrinterDriver() over RPC.",
      "Local: Utilizing the Print Spooler functionality to install a malicious printer driver."
     ],
    "required_attacker_capabilities": "An authenticated user account, remote access to the target system via SMB or RPC. For local exploitation no user with privileges are required"
  },
  "additional_details": {
    "PrintNightmare_name": "The vulnerability is also known as PrintNightmare.",
    "CVE_overlap": "The original CVE-2021-1675 was addressed by the June 2021 security update, but a similar vulnerability CVE-2021-34527 was later discovered and addressed by a separate update. Public exploits may refer to CVE-2021-1675 when exploiting CVE-2021-34527.",
    "Point_and_Print_risk": "Systems with Point and Print's `NoWarningNoElevationOnInstall` set to a non-`0` value are considered vulnerable by design, even after applying the patch.",
     "Mitigation_registry_values": "Machines are still vulnerable if the following registry values are present and set:\n\nRestrictDriverInstallationToAdministrators    REG_DWORD    0x0\nNoWarningNoElevationOnInstall    REG_DWORD    0x1"
  }
}
```