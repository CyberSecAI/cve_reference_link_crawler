Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT357101)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T357101
# CVE-2024-34502: Special:MergeLexemes makes edits on GET requests without edit tokensClosed, Resolved[Public](/policy/explain/PHID-TASK-imdcaotocas3abohrrw6/view/)SecurityActions

* [Edit Task](/maniphest/task/edit/357101/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/357101/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-imdcaotocas3abohrrw6/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-imdcaotocas3abohrrw6/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-imdcaotocas3abohrrw6/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-imdcaotocas3abohrrw6/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-imdcaotocas3abohrrw6/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-imdcaotocas3abohrrw6/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-imdcaotocas3abohrrw6/)
* [Protect as security issue](/wmf/escalate-task/357101/)
* [Award Token](/token/give/PHID-TASK-imdcaotocas3abohrrw6/)
* [Flag For Later](/flag/edit/PHID-TASK-imdcaotocas3abohrrw6/)

Assigned To

|  | [Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) |
| --- | --- |

Authored By

|  | [Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) |
| --- | --- |
| Feb 9 2024, 10:02 AM2024-02-09 10:02:28 (UTC+0) |

Tags

* [Security-Team](/tag/security-team/) [(Watching)](/project/board/1179/)
* [Security](/tag/security/)
* [Wikidata](/tag/wikidata/) [(incoming)](/project/board/71/)
* [Wikidata Lexicographical data](/tag/wikidata_lexicographical_data/) [(incoming)](/project/board/2292/)
* [Wikidata Dev Team (Wikidata.org Slice)](/project/view/6751/) [(Done)](/project/board/6751/)
* [SecTeam-Processed](/tag/secteam-processed/) [(Completed)](/project/board/5180/)
* [Vuln-CSRF](/tag/vuln-csrf/) [(Tracked)](/project/board/907/)
* [MW-1.42-notes (1.42.0-wmf.23; 2024-03-19)](/project/view/7012/)
Referenced Files

|  | [F42387848: 0001-SECURITY-Check-edit-token-in-Special-MergeLexemes.patch](/F42387848) |
| --- | --- |
| Mar 4 2024, 10:20 AM2024-03-04 10:20:25 (UTC+0) |

|  | [F41826173: 0001-SECURITY-Check-edit-token-in-Special-MergeLexemes.patch](/F41826173) |
| --- | --- |
| Feb 9 2024, 11:00 AM2024-02-09 11:00:15 (UTC+0) |

Subscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [gerritbot](/p/gerritbot/) |
| --- | --- |

|  | [• jnuche](/p/jnuche/) |
| --- | --- |

|  | [Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) |
| --- | --- |

|  | [Lydia\_Pintscher](/p/Lydia_Pintscher/) |
| --- | --- |

|  | [mmartorana](/p/mmartorana/) |
| --- | --- |

|  | [Mstyles](/p/Mstyles/) |
| --- | --- |

|  | [sbassett](/p/sbassett/) |
| --- | --- |

# Description

Loading Special:MergeLexemes?from-id=L12345&to-id=L12346 will (attempt to) merge L12345 into L12346, even if the request was not a POST request, and even if it doesn’t contain an edit token.

Special:MergeItems and Special:RedirectEntity don’t have this problem, by the way – the TokenCheckInteractor checks both that the request has a valid token and that it was POSTed. (Though I don’t think it checks whether the token was in the POST body or in the request URL. I’m not sure if that’s a problem.) Special:MergeLexemes should use this interactor as well (and add the necessary hidden input to the form, of course).

# Details

Risk Rating Low Author Affiliation Wikimedia Deutschland

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [Clean up edit token check in SpecialMergeLexemes](https://gerrit.wikimedia.org/r/c/1017092) | [mediawiki/extensions/WikibaseLexeme](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/WikibaseLexeme) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/WikibaseLexeme/%2B/master) | +56 -14 |
|  | [SECURITY: Check edit token in Special:MergeLexemes](https://gerrit.wikimedia.org/r/c/1016877) | [mediawiki/extensions/WikibaseLexeme](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/WikibaseLexeme) | [REL1\_39](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/WikibaseLexeme/%2B/REL1_39) | +13 -0 |
|  | [SECURITY: Check edit token in Special:MergeLexemes](https://gerrit.wikimedia.org/r/c/1016876) | [mediawiki/extensions/WikibaseLexeme](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/WikibaseLexeme) | [REL1\_40](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/WikibaseLexeme/%2B/REL1_40) | +13 -0 |
|  | [SECURITY: Check edit token in Special:MergeLexemes](https://gerrit.wikimedia.org/r/c/1016872) | [mediawiki/extensions/WikibaseLexeme](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/WikibaseLexeme) | [REL1\_41](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/WikibaseLexeme/%2B/REL1_41) | +13 -0 |
|  | [SECURITY: Check edit token in Special:MergeLexemes](https://gerrit.wikimedia.org/r/c/1013359) | [mediawiki/extensions/WikibaseLexeme](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/WikibaseLexeme) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/WikibaseLexeme/%2B/master) | +13 -0 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T357101)
# Related Objects

* Mentions

Mentioned In [T353904: Write and send supplementary release announcement for extensions and skins with security patches (1.39.7/1.40.3/1.41.1)](/T353904) Mentioned Here [T353904: Write and send supplementary release announcement for extensions and skins with security patches (1.39.7/1.40.3/1.41.1)](/T353904)
[T356764: Merging lexemes is only partially rate limited and protected by AbuseFilter](/T356764)
### Event Timeline

[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) created this task.[Feb 9 2024, 10:02 AM2024-02-09 10:02:28 (UTC+0)](#9528106)Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  · [View Herald Transcript](/herald/transcript/5771920/)[Feb 9 2024, 10:02 AM2024-02-09 10:02:30 (UTC+0)](#9528117)

[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) added projects: [Wikidata](/tag/wikidata/), [Wikidata Lexicographical data](/tag/wikidata_lexicographical_data/).[Feb 9 2024, 10:03 AM2024-02-09 10:03:01 (UTC+0)](#9528118)Comment Actions

I really hope we can fix this in a way that doesn’t edit conflict with [T356764](/T356764), because I wouldn’t like to fix this task in public.

[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) added a project: [Wikidata Dev Team (Wikidata.org Slice)](/project/view/6751/).Edited · [Feb 9 2024, 11:00 AM2024-02-09 11:00:15 (UTC+0)](#9528452)Comment Actions

Okay, I think this should work:

0001-SECURITY-Check-edit-token-in-Special-MergeLexemes.patch2 KB[Download](https://phab.wmfusercontent.org/file/download/etuc3titip2m4dklevkk/PHID-FILE-7uxu7xdywcjpttatx3ms/0001-SECURITY-Check-edit-token-in-Special-MergeLexemes.patch)

```
diff --git a/src/MediaWiki/Specials/SpecialMergeLexemes.php b/src/MediaWiki/Specials/SpecialMergeLexemes.php
index dca2111390..71de16fd34 100644
--- a/src/MediaWiki/Specials/SpecialMergeLexemes.php
+++ b/src/MediaWiki/Specials/SpecialMergeLexemes.php
@@ -168,6 +168,18 @@ private function anonymousEditWarning(): string {
 	private function mergeLexemes( $serializedSourceId, $serializedTargetId ): void {
 		$sourceId = $this->getLexemeId( $serializedSourceId );
 		$targetId = $this->getLexemeId( $serializedTargetId );
+		// TODO inject interactor+localizer and move this check down a bit once this is public
+		// phpcs:disable MediaWiki.Classes.FullQualifiedClassName.Found
+		try {
+			\Wikibase\Repo\WikibaseRepo::getTokenCheckInteractor()
+				->checkRequestToken( $this->getContext(), 'wpEditToken' );
+		} catch ( \Wikibase\Repo\Interactors\TokenCheckException $e ) {
+			$message = \Wikibase\Repo\WikibaseRepo::getExceptionLocalizer()
+				->getExceptionMessage( $e );
+			$this->showErrorHTML( $message->parse() );
+			return;
+		}
+		// phpcs:enable

 		if ( !$sourceId ) {
 			$this->showInvalidLexemeIdError( $serializedSourceId );
 			return;
 		}
 		if ( !$targetId ) {
 			$this->showInvalidLexemeIdError( $serializedTargetId );
 			return;
 		}

 		try {
 			$this->mergeInteractor->mergeLexemes(
```

The mergeLexemes() call at the end there will probably be touched soon, so I put the check a bit higher up to (hopefully) avoid merge conflicts.

[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) moved this task from [In Task Breakdown](/project/board/6751/) to [Ready for Peer Review](/project/board/6751/) on the [Wikidata Dev Team (Wikidata.org Slice)](/project/view/6751/) board.[Feb 9 2024, 11:00 AM2024-02-09 11:00:29 (UTC+0)](#9528455)[sbassett](/p/sbassett/) changed the task status from Open to In Progress.[Feb 12 2024, 5:31 PM2024-02-12 17:31:03 (UTC+0)](#9534832)[sbassett](/p/sbassett/) triaged this task as Medium priority.[sbassett](/p/sbassett/) moved this task from [Incoming](/project/board/1179/) to [In Progress](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[sbassett](/p/sbassett/) added projects: [SecTeam-Processed](/tag/secteam-processed/), [Vuln-CSRF](/tag/vuln-csrf/).[sbassett](/p/sbassett/) added subscribers: [mmartorana](/p/mmartorana/), [sbassett](/p/sbassett/).Comment Actions

[@mmartorana](/p/mmartorana/) to review.

[mmartorana](/p/mmartorana/) added a comment.[Feb 12 2024, 6:53 PM2024-02-12 18:53:20 (UTC+0)](#9535064)Comment Actions

Hey [@sbassett](/p/sbassett/) thanks for the triaging. Upon reviewing the provided code, there don't seem to be any apparent security concerns.

[sbassett](/p/sbassett/) moved this task from [In Progress](/project/board/1179/) to [Security Patch To Deploy](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Feb 12 2024, 8:34 PM2024-02-12 20:34:25 (UTC+0)](#9535431)[Mstyles](/p/Mstyles/) subscribed.[Feb 12 2024, 10:40 PM2024-02-12 22:40:26 (UTC+0)](#9535973)Comment Actions
> In [T357101#9528452](/T357101#9528452), [@Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) wrote:
>
> Okay, I think this should work:
>
> 0001-SECURITY-Check-edit-token-in-Special-MergeLexemes.patch2 KB[Download](https://phab.wmfusercontent.org/file/download/etuc3titip2m4dklevkk/PHID-FILE-7uxu7xdywcjpttatx3ms/0001-SECURITY-Check-edit-token-in-Special-MergeLexemes.patch)
>
> ```
> diff --git a/src/MediaWiki/Specials/SpecialMergeLexemes.php b/src/MediaWiki/Specials/SpecialMergeLexemes.php
> index dca2111390..71de16fd34 100644
> --- a/src/MediaWiki/Specials/SpecialMergeLexemes.php
> +++ b/src/MediaWiki/Specials/SpecialMergeLexemes.php
> @@ -168,6 +168,18 @@ private function anonymousEditWarning(): string {
>  	private function mergeLexemes( $serializedSourceId, $serializedTargetId ): void {
>  		$sourceId = $this->getLexemeId( $serializedSourceId );
>  		$targetId = $this->getLexemeId( $serializedTargetId );
> +		// TODO inject interactor+localizer and move this check down a bit once this is public
> +		// phpcs:disable MediaWiki.Classes.FullQualifiedClassName.Found
> +		try {
> +			\Wikibase\Repo\WikibaseRepo::getTokenCheckInteractor()
> +				->checkRequestToken( $this->getContext(), 'wpEditToken' );
> +		} catch ( \Wikibase\Repo\Interactors\TokenCheckException $e ) {
> +			$message = \Wikibase\Repo\WikibaseRepo::getExceptionLocalizer()
> +				->getExceptionMessage( $e );
> +			$this->showErrorHTML( $message->parse() );
> +			return;
> +		}
> +		// phpcs:enable
>
>  		if ( !$sourceId ) {
>  			$this->showInvalidLexemeIdError( $serializedSourceId );
>  			return;
>  		}
>  		if ( !$targetId ) {
>  			$this->showInvalidLexemeIdError( $serializedTargetId );
>  			return;
>  		}
>
>  		try {
>  			$this->mergeInteractor->mergeLexemes(
> ```
>
> The mergeLexemes() call at the end there will probably be touched soon, so I put the check a bit higher up to (hopefully) avoid merge conflicts.

thank you for the patch [@Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/), [it's been deployed](https://sal.toolforge.org/log/e2R5n40BxE1_1c7soLST)

[Mstyles](/p/Mstyles/) mentioned this in [T353904: Write and send supplementary release announcement for extensions and skins with security patches (1.39.7/1.40.3/1.41.1)](/T353904).[Feb 12 2024, 10:45 PM2024-02-12 22:45:00 (UTC+0)](#9535995)[Mstyles](/p/Mstyles/) moved this task from [Security Patch To Deploy](/project/board/1179/) to [Watching](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[ArthurTaylor](/p/ArthurTaylor/) moved this task from [Ready for Peer Review](/project/board/6751/) to [Ready for Tech Verification](/project/board/6751/) on the [Wikidata Dev Team (Wikidata.org Slice)](/project/view/6751/) board.[Feb 13 2024, 7:26 AM2024-02-13 07:26:12 (UTC+0)](#9536697)

[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) changed the task status from In Progress to Stalled.[Feb 13 2024, 1:48 PM2024-02-13 13:48:03 (UTC+0)](#9537753)[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) moved this task from [Ready for Tech Verification](/project/board/6751/) to [Parent Task](/project/board/6751/) on the [Wikidata Dev Team (Wikidata.org Slice)](/project/view/6751/) board.Comment Actions

Seems to work (tested at [https://test.wikidata.org/wiki/Special:MergeLexemes?from-id=L2843&to-id=L338](https://test.wikidata.org/wiki/Special%3AMergeLexemes?from-id=L2843&to-id=L338)), thanks!

Moving back to Parent Tasks on our board – I think this is now just stalled until the next security release publishes the patch, at which point we’ll want to clean it up a bit more with a follow-up change on the master branch. (On the release branches, IMHO it’s enough to keep the patch as it is.)

[sbassett](/p/sbassett/) added a comment.[Feb 13 2024, 4:16 PM2024-02-13 16:16:56 (UTC+0)](#9538621)Comment Actions
> In [T357101#9537753](/T357101#9537753), [@Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) wrote:
>
> Moving back to Parent Tasks on our board – I think this is now just stalled until the next security release publishes the patch, at which point we’ll want to clean it up a bit more with a follow-up change on the master branch. (On the release branches, IMHO it’s enough to keep the patch as it is.)

Yes, it should go out with the next supplemental release ([T353904](/T353904)), due out by the end of March 2024. And since ext:WikibaseLexeme isn't [bundled](https://www.mediawiki.org/wiki/Bundled_extensions_and_skins), it could theoretically be made public, and the patch backported, sooner. Which is handy if there are concerns about future conflicts, etc.

[• jnuche](/p/jnuche/) raised the priority of this task from Medium to Unbreak Now!.Edited · [Mar 4 2024, 9:53 AM2024-03-04 09:53:17 (UTC+0)](#9595168)[• jnuche](/p/jnuche/) added a parent task: [T354439: 1.42.0-wmf.21 deployment blockers](/T354439).[• jnuche](/p/jnuche/) subscribed.Comment Actions

Hi there, patch 01-T357101.patch is currently failing to apply. We will need a rebased version ~~at the current release dir /srv/patches/1.42.0-wmf.20/extensions/WikibaseLexeme in the deployment server~~. Otherwise the upcoming 1.42.0-wmf.21 will be blocked.

EDIT: Sry, the rebased patch should of course go in a new dir for 1.42.0-wmf.21 will all other patches copied over. I can take care of that once a new patch is available

[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) claimed this task.[Mar 4 2024, 10:13 AM2024-03-04 10:13:15 (UTC+0)](#9595245)[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) moved this task from [Parent Task](/project/board/6751/) to [In Development](/project/board/6751/) on the [Wikidata Dev Team (Wikidata.org Slice)](/project/view/6751/) board.

[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) added a comment.[Mar 4 2024, 10:20 AM2024-03-04 10:20:25 (UTC+0)](#9595257)Comment Actions

Rebased version:

0001-SECURITY-Check-edit-token-in-Special-MergeLexemes.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/6pfj7mq2d2ilhnqjm4xa/PHID-FILE-fvicyss2rzaiguuy7e5l/0001-SECURITY-Check-edit-token-in-Special-MergeLexemes.patch)

But I don’t understand why you need this in the wmf.20 dir when it’s only conflicting against the upcoming wmf.21 branch?

[• jnuche](/p/jnuche/) added a comment.[Mar 4 2024, 10:42 AM2024-03-04 10:42:40 (UTC+0)](#9595329)Comment Actions
> But I don’t understand why you need this in the wmf.20 dir when it’s only conflicting against the upcoming wmf.21 branch?

[@Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) Sorry for the confusion. Please see my updated comment.

Thanks for the rebased patch, I'll add it to the deployment server.

[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) removed [Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) as the assignee of this task.[Mar 4 2024, 10:43 AM2024-03-04 10:43:32 (UTC+0)](#9595330)[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) moved this task from [In Development](/project/board/6751/) to [Parent Task](/project/board/6751/) on the [Wikidata Dev Team (Wikidata.org Slice)](/project/view/6751/) board.Comment Actions

Alright!

[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) lowered the priority of this task from Unbreak Now! to Medium.[Mar 4 2024, 10:43 AM2024-03-04 10:43:50 (UTC+0)](#9595333)[• jnuche](/p/jnuche/) removed a parent task: [T354439: 1.42.0-wmf.21 deployment blockers](/T354439).[Mar 5 2024, 8:31 AM2024-03-05 08:31:38 (UTC+0)](#9599419)[Mstyles](/p/Mstyles/) added a subscriber: [gerritbot](/p/gerritbot/).[Mar 22 2024, 6:42 PM2024-03-22 18:42:31 (UTC+0)](#9655113)Comment Actions

pushing [the rebased patch](https://phabricator.wikimedia.org/T357101#9595257) to gerrit for the supplemental release: [https://gerrit.wikimedia.org/r/c/mediawiki/extensions/WikibaseLexeme/+/1013359](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/WikibaseLexeme/%2B/1013359)

[gerritbot](/p/gerritbot/) added a comment.[Mar 23 2024, 12:20 PM2024-03-23 12:20:31 (UTC+0)](#9655874)Comment Actions

Change #1013359 **merged** by jenkins-bot:

[mediawiki/extensions/WikibaseLexeme@master] SECURITY: Check edit token in Special:MergeLexemes

<https://gerrit.wikimedia.org/r/1013359>

[Jdforrester-WMF](/p/Jdforrester-WMF/) added a project: [MW-1.42-notes (1.42.0-wmf.23; 2024-03-19)](/project/view/7012/).[Mar 25 2024, 12:12 PM2024-03-25 12:12:59 (UTC+0)](#9657383)[Lydia\_Pintscher](/p/Lydia_Pintscher/) subscribed.[Apr 2 2024, 9:08 AM2024-04-02 09:08:35 (UTC+0)](#9679104)[gerritbot](/p/gerritbot/) added a comment.[Apr 4 2024, 11:52 AM2024-04-04 11:52:55 (UTC+0)](#9688149)Comment Actions

Change #1016872 had a related patch set uploaded (by Lucas Werkmeister (WMDE); author: Lucas Werkmeister (WMDE)):

[mediawiki/extensions/WikibaseLexeme@REL1\_41] SECURITY: Check edit token in Special:MergeLexemes

<https://gerrit.wikimedia.org/r/1016872>

[gerritbot](/p/gerritbot/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Apr 4 2024, 11:52 AM2024-04-04 11:52:58 (UTC+0)](#9688150)[gerritbot](/p/gerritbot/) added a comment.[Apr 4 2024, 1:08 PM2024-04-04 13:08:03 (UTC+0)](#9688447)Comment Actions

Change #1016872 **merged** by jenkins-bot:

[mediawiki/extensions/WikibaseLexeme@REL1\_41] SECURITY: Check edit token in Special:MergeLexemes

<https://gerrit.wikimedia.org/r/1016872>

[gerritbot](/p/gerritbot/) added a comment.[Apr 4 2024, 1:15 PM2024-04-04 13:15:57 (UTC+0)](#9688465)Comment Actions

Change #1016876 had a related patch set uploaded (by Lucas Werkmeister (WMDE); author: Lucas Werkmeister (WMDE)):

[mediawiki/extensions/WikibaseLexeme@REL1\_40] SECURITY: Check edit token in Special:MergeLexemes

<https://gerrit.wikimedia.org/r/1016876>

[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) changed the task status from Stalled to Open.[Apr 4 2024, 1:17 PM2024-04-04 13:17:04 (UTC+0)](#9688467)Comment Actions

No longer stalled; I’m backporting the fix to release branches now, and we can also clean up the code.

[gerritbot](/p/gerritbot/) added a comment.[Apr 4 2024, 1:39 PM2024-04-04 13:39:08 (UTC+0)](#9688536)Comment Actions

Change #1016876 **merged** by jenkins-bot:

[mediawiki/extensions/WikibaseLexeme@REL1\_40] SECURITY: Check edit token in Special:MergeLexemes

<https://gerrit.wikimedia.org/r/1016876>

[gerritbot](/p/gerritbot/) added a comment.[Apr 4 2024, 1:40 PM2024-04-04 13:40:25 (UTC+0)](#9688559)Comment Actions

Change #1016877 had a related patch set uploaded (by Lucas Werkmeister (WMDE); author: Lucas Werkmeister (WMDE)):

[mediawiki/extensions/WikibaseLexeme@REL1\_39] SECURITY: Check edit token in Special:MergeLexemes

<https://gerrit.wikimedia.org/r/1016877>

[gerritbot](/p/gerritbot/) added a comment.[Apr 4 2024, 2:05 PM2024-04-04 14:05:33 (UTC+0)](#9688676)Comment Actions

Change #1016877 **merged** by Lucas Werkmeister (WMDE):

[mediawiki/extensions/WikibaseLexeme@REL1\_39] SECURITY: Check edit token in Special:MergeLexemes

<https://gerrit.wikimedia.org/r/1016877>

[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) claimed this task.[Apr 4 2024, 2:31 PM2024-04-04 14:31:41 (UTC+0)](#9688812)[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) moved this task from [Parent Task](/project/board/6751/) to [In Development](/project/board/6751/) on the [Wikidata Dev Team (Wikidata.org Slice)](/project/view/6751/) board.[gerritbot](/p/gerritbot/) added a comment.[Apr 4 2024, 2:50 PM2024-04-04 14:50:24 (UTC+0)](#9688951)Comment Actions

Change #1017092 had a related patch set uploaded (by Lucas Werkmeister (WMDE); author: Lucas Werkmeister (WMDE)):

[mediawiki/extensions/WikibaseLexeme@master] Clean up edit token check in SpecialMergeLexemes

<https://gerrit.wikimedia.org/r/1017092>

[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) removed [Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) as the assignee of this task.[Apr 4 2024, 2:55 PM2024-04-04 14:55:10 (UTC+0)](#9688978)[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) moved this task from [In Development](/project/board/6751/) to [Ready for Peer Review](/project/board/6751/) on the [Wikidata Dev Team (Wikidata.org Slice)](/project/view/6751/) board.[ArthurTaylor](/p/ArthurTaylor/) moved this task from [Ready for Peer Review](/project/board/6751/) to [In Peer Review](/project/board/6751/) on the [Wikidata Dev Team (Wikidata.org Slice)](/project/view/6751/) board.[Apr 5 2024, 7:01 AM2024-04-05 07:01:33 (UTC+0)](#9691696)[ArthurTaylor](/p/ArthurTaylor/) moved this task from [In Peer Review](/project/board/6751/) to [Ready for Tech Verification](/project/board/6751/) on the [Wikidata Dev Team (Wikidata.org Slice)](/project/view/6751/) board.[Apr 5 2024, 7:11 AM2024-04-05 07:11:44 (UTC+0)](#9691712)[gerritbot](/p/gerritbot/) added a comment.[Apr 5 2024, 7:28 AM2024-04-05 07:28:33 (UTC+0)](#9691731)Comment Actions

Change #1017092 **merged** by jenkins-bot:

[mediawiki/extensions/WikibaseLexeme@master] Clean up edit token check in SpecialMergeLexemes

<https://gerrit.wikimedia.org/r/1017092>

[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) closed this task as Resolved.[Apr 5 2024, 9:30 AM2024-04-05 09:30:07 (UTC+0)](#9692044)[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) claimed this task.[Lucas\_Werkmeister\_WMDE](/p/Lucas_Werkmeister_WMDE/) moved this task from [Ready for Tech Verification](/project/board/6751/) to [Done](/project/board/6751/) on the [Wikidata Dev Team (Wikidata.org Slice)](/project/view/6751/) board.Comment Actions

I think this is done; can someone™ make the task public? :)

[sbassett](/p/sbassett/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-y5oriqb24ujkncg/)" to "Public (No Login Required)".[Apr 5 2024, 4:46 PM2024-04-05 16:46:56 (UTC+0)](#9693330)[sbassett](/p/sbassett/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-7nvbadyfu2yxane/)" to "All Users".[sbassett](/p/sbassett/) changed Risk Rating from N/A to Low.[sbassett](/p/sbassett/) removed a project: [Patch-For-Review](/tag/patch-for-review/).[Mstyles](/p/Mstyles/) renamed this task from Special:MergeLexemes makes edits on GET requests without edit tokens to CVE-2024-34502: Special:MergeLexemes makes edits on GET requests without edit tokens.[May 6 2024, 9:02 AM2024-05-06 09:02:09 (UTC+0)](#9773811)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)