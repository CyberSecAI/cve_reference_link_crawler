[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4e3e74af9d00&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40adurands82%2Ffluent-bit-dos-vulnerability-cve-2024-23722-4e3e74af9d00&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40adurands82%2Ffluent-bit-dos-vulnerability-cve-2024-23722-4e3e74af9d00&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Fluent Bit DoS Vulnerability — [CVE-2024–23722](https://github.com/alexcote1/CVE-2024-23722-poc/tree/main)

[![Aiden Durand](https://miro.medium.com/v2/da:true/resize:fill:88:88/0*dBGI845pJkaJLh41)](/%40adurands82?source=post_page---byline--4e3e74af9d00--------------------------------)

[Aiden Durand](/%40adurands82?source=post_page---byline--4e3e74af9d00--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F72aeab25c673&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40adurands82%2Ffluent-bit-dos-vulnerability-cve-2024-23722-4e3e74af9d00&user=Aiden+Durand&userId=72aeab25c673&source=post_page-72aeab25c673--byline--4e3e74af9d00---------------------post_header-----------)

2 min read·Mar 25, 2024

--

Listen

Share

In fluent-bit versions 2.1.8 through 2.2.1 HTTP requests are not properly verified before being processed. If an HTTP request is made without a ‘=’ being present in the body, the application is unable to parse the request, and creates an array full of null pointers. This causes a null pointer dereference later when the application attempts to load the parsed data, leading to an application crash. An attacker can use this vulnerability to cause a DoS on any Fluent Bit server that is configured to receive HTTP requests. As fluent-bit is a log router crashing the server can prevent logs from being delivered to the appropriate locations and create a visibility gap that attackers can further exploit. We were unable to find any RCE vulnerabilities stemming from this issue. A CVE, CVE-2024–23722, was created for this vulnerability.

A POC for the vulnerability can be found here: <https://github.com/alexcote1/CVE-2024-23722-poc>

Below is a screenshot of exploitation. In the top terminal the Fluent Bit server is running. In the bottom terminal a HTTP request with no ‘=’ in the body is sent to the server. The server crashes and a stack trace is printed to the top terminal.

![]()

The vulnerable line of code is found in [fluent-bit/plugins/in\_http/http\_prot.c](https://github.com/fluent/fluent-bit/blob/b814a5f84c12f2f74f7b0678208eb74a0b15da71/plugins/in_http/http_prot.c#L440). On line 440 the server tries to “jump” to the first equal sign in the body. No checks are performed to see if an equals sign even exists.

![]()

This leads to the “keys” array being empty, causing a null deference on line 457 when a function is called on it. This causes the server to crash.

![]()

Fluent-bit should not be exposed publicly, and any instances you have should be updated to at least version 2.2.2 to resolve this issue.

Credit to Alexander Cote for discovering this vulnerability and Aiden Durand for helping with investigation and triage.

[Cybersecurity](/tag/cybersecurity?source=post_page-----4e3e74af9d00--------------------------------)[Fluentbit](/tag/fluentbit?source=post_page-----4e3e74af9d00--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----4e3e74af9d00--------------------------------)

--

--

[![Aiden Durand](https://miro.medium.com/v2/resize:fill:96:96/0*dBGI845pJkaJLh41)](/%40adurands82?source=post_page---post_author_info--4e3e74af9d00--------------------------------)[![Aiden Durand](https://miro.medium.com/v2/resize:fill:128:128/0*dBGI845pJkaJLh41)](/%40adurands82?source=post_page---post_author_info--4e3e74af9d00--------------------------------)Follow[## Written by Aiden Durand](/%40adurands82?source=post_page---post_author_info--4e3e74af9d00--------------------------------)0 Followers·[0 Following](/%40adurands82/following?source=post_page---post_author_info--4e3e74af9d00--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----4e3e74af9d00--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----4e3e74af9d00--------------------------------)[About](/about?autoplay=1&source=post_page-----4e3e74af9d00--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----4e3e74af9d00--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----4e3e74af9d00--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----4e3e74af9d00--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4e3e74af9d00--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4e3e74af9d00--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----4e3e74af9d00--------------------------------)[Teams](/business?source=post_page-----4e3e74af9d00--------------------------------)

