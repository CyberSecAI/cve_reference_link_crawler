
[![tigera-logoWhite](data:image/svg+xml... "tigera-logoWhite")![tigera-logoWhite](/app/uploads/elementor/thumbs/tigera-logoWhite-pgs10u1azwwqta709onlhpgchcu467kpsetcdizd0s.png "tigera-logoWhite")](/)

* [Project Calico](/project-calico/)
* Products
  + [![](https://www.tigera.io/app/uploads/2021/06/icon-calico-os.svg)](https://www.tigera.io/tigera-products/calico/)
  + [![](https://www.tigera.io/app/uploads/2021/06/icon-calico-cloud.svg)](https://www.tigera.io/tigera-products/calico-cloud/)
  + [![](https://www.tigera.io/app/uploads/2021/06/icon-calico-enterprise.svg)Calico Enterprise Zero trust security for Kubernetes](https://www.tigera.io/tigera-products/calico-enterprise/)
  + [![](https://www.tigera.io/app/uploads/2021/06/icon-compare.svg)Compare Products](https://www.tigera.io/tigera-products/compare-products/)
  + [![](https://www.tigera.io/app/uploads/2021/06/icon-pricing.svg)Pricing](https://www.tigera.io/tigera-products/calico-cloud-pricing/)
  + [![](https://www.tigera.io/app/uploads/2021/06/icon-why.svg)Why Calico](https://www.tigera.io/tigera-products/why-calico/)
* Solutions
  + Use Cases
    - [![](https://www.tigera.io/app/uploads/2023/04/icon-kubernetes-security.svg)Kubernetes Security](/tigera-products/kubernetes-security/)
      * [Egress Gateway](/tigera-products/egress-gateway/)
      * [Universal Firewall Integration](/features/firewall-integration/)
      * [Cluster Mesh](https://www.tigera.io/tigera-products/cluster-mesh/)
      * [Workload Access Controls](/tigera-products/zero-trust-workload-security/)
      * [Microsegmentation](/features/microsegmentation/)
      * [Security Policy Management](/features/policy-lifecycle-management/)
      * [Observability & Troubleshooting](/tigera-products/observability-and-troubleshooting/)
      * [Multi-Cloud Security](/tigera-products/multi-cloud-security/)
      * [High-Availability Kubernetes](/tigera-products/kubernetes-high-availability/)
    - [![](https://www.tigera.io/app/uploads/2022/02/0Aicon-container-security.svg)Container Security](/tigera-products/container-security/)
      * [Vulnerability Management](/tigera-products/vulnerability-management/)
      * [Configuration Security](/features/configuration-security/)
      * [Runtime Threat Defense](/features/runtime-threat-defense/)
      * [Workload Access Controls](/tigera-products/zero-trust-workload-security/)
      * [Security Policy Management](/features/policy-lifecycle-management/)
      * [Observability & Troubleshooting](/tigera-products/observability-and-troubleshooting/)
      * [Compliance](/features/compliance-and-audit/)
  + Environments
    - [![](https://www.tigera.io/app/uploads/2021/06/icon-aws.svg)AWS EKS](/partners/aws/)
    - [![](https://www.tigera.io/app/uploads/2021/06/icon-azure.svg)Azure AKS](/partners/microsoft/)
    - [![](https://www.tigera.io/app/uploads/2021/06/icon-google.svg)Google GKE](/partners/google/)
    - [![](https://www.tigera.io/app/uploads/2021/06/icon-redhat.svg)Red Hat OpenShift](/partners/redhat/)
    - [![](https://www.tigera.io/app/uploads/2022/05/icon-SUSE-rancher.svg)SUSE Rancher](/partners/rancher/)
    - [![](https://www.tigera.io/app/uploads/2021/06/icon-fortinet.svg)Fortinet](/partners/fortinet/)
    - [![](https://www.tigera.io/app/uploads/2021/06/icon-mirantis.svg)Mirantis](/partners/mirantis/)
* Learn
  + Developer Center
    - [Documentation](https://docs.tigera.io/)
    - [Interactive Training](https://www.tigera.io/interactive-training/)
    - [Product Tutorials](https://www.tigera.io/tutorials/)
    - [Certification](https://www.tigera.io/lp/calico-certification/)
    - [Resources](https://www.tigera.io/resources/)
    - [Blog](https://www.tigera.io/blog/)
  + [![Interactive Training](data:image/svg+xml...)![Interactive Training](https://www.tigera.io/app/uploads/2024/09/learn-menu-banner-img.png)Interactive TrainingNEWUse case-driven video lessons, accompanied by a staged demo environment, to help you leverage Calico for container security and networking.Learn More >](https://www.tigera.io/interactive-training/)
  + Guides
    - [Security](https://www.tigera.io/learn/guides/kubernetes-security/)
      * [Container Security](https://www.tigera.io/learn/guides/container-security-best-practices/)
      * [Kubernetes Security](https://www.tigera.io/learn/guides/kubernetes-security/)
      * [LLM Security](https://www.tigera.io/learn/guides/llm-security/)
      * [CNAPP](https://www.tigera.io/learn/guides/cnapp/)
      * [Service Mesh](https://www.tigera.io/learn/guides/devsecops/service-mesh/)
      * [Microservices Security](https://www.tigera.io/learn/guides/microservices-security/)
      * [Zero Trust](https://www.tigera.io/learn/guides/zero-trust/)
      * [Cloud-Native Security](https://www.tigera.io/learn/guides/cloud-native-security/)
  + Guides
    - [Observability](https://www.tigera.io/learn/guides/kubernetes-monitoring/)
      * [Kubernetes Monitoring](https://www.tigera.io/learn/guides/kubernetes-monitoring/)
      * [Prometheus Monitoring](https://www.tigera.io/learn/guides/prometheus-monitoring/)
    - [Networking](https://www.tigera.io/learn/guides/kubernetes-networking/)
      * [Kubernetes Networking](https://www.tigera.io/learn/guides/kubernetes-networking/)
      * [Cillium vs Calico](https://www.tigera.io/learn/guides/cilium-vs-calico/)
      * [eBPF](https://www.tigera.io/learn/guides/ebpf/)
* Support
  + [Customer Success](https://www.tigera.io/customer-success/)
  + [Support Portal](http://tigera.force.com/community/s/login/)
  + [Tigera Help Center](https://www.tigera.io/calico-support/)
  + [Security Bulletins](https://www.tigera.io/security-bulletins/)
  + [Report Security Issue](/vulnerability-disclosure/)
* Company
  + [About](https://www.tigera.io/about/)
  + [Customers](https://www.tigera.io/customer-stories/)
  + [Partners](https://www.tigera.io/partners/)
  + [Events](https://www.tigera.io/events/)
  + [CalicoCon 2024](https://www.tigera.io/lp/calicocon-2024/)
  + [Newsroom](https://www.tigera.io/media/)
  + [Careers](https://www.tigera.io/careers/)
  + [Contact](https://www.tigera.io/contact/)

* + [Contact](https://www.tigera.io/contact/)
  + [Login](http://www.calicocloud.io/)
  + [Try Now](https://www.calicocloud.io/login)

# Security Bulletins

Calico Enterprise & Calico OS are vulnerable to pod route hijacking

[Return to List](https://www.tigera.io/security-bulletins/)

| Description | Severity | Notes |
| --- | --- | --- |
| Calico Enterprise & Calico OS are vulnerable to pod route hijacking Reference: TTA-2022-001  Date published: June 27, 2022 (Updated) | Medium | N/A |

### Description

Customers running Calico Enterprise and Calico OS are vulnerable to route hijacking with the floating IP feature. Due to insufficient validation, a privileged attacker is able to set a floating IP annotation to a pod even if the feature is not enabled. This allows the attacker to intercept and reroute traffic to their compromised pod.

CVE-2022-28224 has been assigned to this vulnerability.

### Severity

MEDIUM

CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:N/A:H

The validation on using floating IP can be bypassed by annotating the pod directly after pod creation. The routing will be reverted when the annotated pod is destroyed or the annotation is removed. This vulnerability requires the Kubernetes RBAC permission of [“patch”, “pods”], [“patch”, “pods/status”] or [“update”, “pods/status”] to annotate pods.

With sufficient permission, an attacker can set annotation to a target pod using the following command:

```
kubectl annotate pod/<pod-name> cni.projectcalico.org/floatingIPs="[\"<target-ip>\"]"
```

Where <pod-name> is the victim pod the attacker wants to affect and <target-ip> is the attacker controlled destination to forward the traffic to.

### Affected Releases

* Calico Enterprise v3.12 and below
* Calico OS v3.22 and below

### Indicators of Impact/Compromise

Review running pods and identify if floatingIP annotations are present. Floating IP is disabled by default.

To check if floating IP is enabled, refer to the calico-config ConfigMap. In the “cni\_network\_config” section, within the “feature\_control” plugin, review if “floating\_ips” is set to “true”.

An example of a ConfigMap with floating IP being enabled:

```
 cni_network_config: |-
    {
      "name": "k8s-pod-network",
      "cniVersion": "0.3.0",
      "plugins": [
        {
          "type": "calico",
          "log_level": "info",
          "datastore_type": "kubernetes",
          "nodename": "__KUBERNETES_NODE_NAME__",
          "mtu": __CNI_MTU__,
          "ipam": {
              "type": "calico-ipam"
          },
          "policy": {
              "type": "k8s"
          },
          "kubernetes": {
              "kubeconfig": "__KUBECONFIG_FILEPATH__"
          },
          "feature_control": {
              "floating_ips": true
          }
        },
        {
          "type": "portmap",
          "snat": true,
          "capabilities": {"portMappings": true}
        }
      ]
    }

```

If floating IP is disabled, review all running pods to check if an annotation was set with the following command:

```
kubectl get pods -A -oyaml | grep "floatingIPs"
```

An truncated example of a pod manifest with the affected annotation:

```
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      cni.projectcalico.org/containerID: 3902b5aff88e589211fbf017a28a293e58c27cc8bd8b5a4f52c788bd3f004561
      cni.projectcalico.org/floatingIPs: 8.8.8.8
      cni.projectcalico.org/podIP: 192.168.94.2/32
      cni.projectcalico.org/podIPs: 192.168.94.2/32
    creationTimestamp: "2022-06-13T20:31:21Z"
    generateName: test-app-1-
    labels:
      app: test-app-1
      controller-revision-hash: 5f65c4857b
      pod-template-generation: "1"
    name: test-pod-7wzxl
    namespace: test-ns

```

If a floating IP annotation is found, an investigation should be done to determine the impact of the compromise.

### Workaround / Remediation

Review Kubernetes RBAC and review access to [“patch”, “pods”], [“patch”, “pods/status”] and [“update”, “pods/status”]

### Fixed Software

* Calico Enterprise
  + V3.13.0 and above
  + v3.12.1
  + v3.11.4
* Calico OS
  + V3.22.2 and above
  + v3.21.5
  + v.3.20.5

### Acknowledgment

We would like to acknowledge Aloys Augustin from Cisco for reporting this issue. We would also like to acknowledge Yuval Avrahami for the additional analysis.

[Return to List](https://www.tigera.io/security-bulletins/)

* PROJECT CALICO
  + [What is Project Calico?](https://www.tigera.io/project-calico/)
  + [Docs](https://docs.tigera.io/calico/)
  + [Community](https://www.tigera.io/project-calico/community/)
  + [GitHub](https://github.com/projectcalico/calico)
* PRODUCTS
  + [Calico Open Source](https://www.tigera.io/tigera-products/calico/)
  + [Calico Cloud](https://www.tigera.io/tigera-products/calico-cloud/)
  + [Calico Enterprise](https://www.tigera.io/tigera-products/calico-enterprise/)
  + [Compare Products](https://www.tigera.io/tigera-products/compare-products/)
  + [Pricing](https://www.tigera.io/tigera-products/calico-cloud-pricing/)
  + [Why Calico?](https://www.tigera.io/tigera-products/why-calico/)
* SOLUTIONS
  + [Kubernetes Security](/tigera-products/kubernetes-security/)
  + [Container Security](/tigera-products/container-security/)
  + [Cluster Mesh](https://www.tigera.io/tigera-products/cluster-mesh/)
  + [Multi-Cloud Security](/tigera-products/multi-cloud-security/)
  + [High-Availability for Kubernetes](/tigera-products/kubernetes-high-availability/)
  + [Egress Gateway](/tigera-products/egress-gateway/)
  + [Environments](https://www.tigera.io/partners/)
* LEARN
  + [Documentation](https://docs.tigera.io/)
  + [Interactive Training](https://www.tigera.io/interactive-training/)
  + [Product Tutorials](https://www.tigera.io/tutorials/)
  + [Resources](https://www.tigera.io/resources/)
  + [Certification](https://www.tigera.io/lp/calico-certification/)
  + [Blog](https://www.tigera.io/blog/)
  + [Guides](https://www.tigera.io/learn/guides/kubernetes-security/)
* SUPPORT
  + [Customer Success](https://www.tigera.io/customer-success/)
  + [Support Portal](http://tigera.force.com/community/s/login/)
  + [Tigera Help Center](https://www.tigera.io/calico-support/)
  + [Security Bulletins](https://www.tigera.io/security-bulletins/)
  + [Report Security Issue](https://www.tigera.io/vulnerability-disclosure/)
* COMPANY
  + [About](https://www.tigera.io/about/)
  + [Customers](https://www.tigera.io/customer-stories/)
  + [Partners](https://www.tigera.io/partners/)
  + [Events](https://www.tigera.io/events/)
  + [CalicoCon 2024](https://www.tigera.io/lp/calicocon-2024/)
  + [Newsroom](https://www.tigera.io/media/)
  + [Careers](https://www.tigera.io/careers/)
  + [Contact](https://www.tigera.io/contact/)

[![tigera-logoWhite](data:image/svg+xml... " tigera-logoWhite")![tigera-logoWhite](/app/uploads/elementor/thumbs/tigera-logoWhite-pex43dmbi9rv5py4nuwhpkbh5bury9emp21calqze4.png " tigera-logoWhite")](/)

Copyright ©

 Tigera, Inc. All rights reserved.

* Privacy Center
* Do Not Sell Or Share My Personal Information
* [Legal](/legal/)

[Linkedin](https://www.linkedin.com/company/tigera/)
[Twitter](https://twitter.com/tigeraio)
[Youtube](https://www.youtube.com/channel/UC8uN3yhpeBeerGNwDiQbcgw/)
[Slack](https://calicousers.slack.com/)
[Github](https://github.com/tigera)
[Discourse](https://discuss.projectcalico.tigera.io/)

global-styles ->
eae-peel-css -> https://www.tigera.io/app/plugins/addon-elements-for-elementor-page-builder/assets/lib/peel/peel.css
search-filter-plugin-styles -> https://www.tigera.io/app/plugins/search-filter-pro/public/assets/css/search-filter.min.css
hello-elementor-header-footer -> https://www.tigera.io/app/themes/hello-elementor/header-footer.min.css
fancybox-css -> https://cdn.jsdelivr.net/npm/@fancyapps/[[email protected]](/cdn-cgi/l/email-protection)/dist/fancybox.css
elementor-icons -> https://www.tigera.io/app/plugins/elementor/assets/lib/eicons/css/elementor-icons.min.css
elementor-frontend -> https://www.tigera.io/app/plugins/elementor/assets/css/frontend.min.css
font-awesome-5-all -> https://www.tigera.io/app/plugins/elementor/assets/lib/font-awesome/css/all.min.css
font-awesome-4-shim -> https://www.tigera.io/app/plugins/elementor/assets/lib/font-awesome/css/v4-shims.min.css
widget-text-editor -> https://www.tigera.io/app/plugins/elementor/assets/css/widget-text-editor.min.css
hello-elementor-child-style -> https://www.tigera.io/app/themes/tigera2021/style.css
tigera-2021-theme -> https://www.tigera.io/app/themes/tigera2021/dist/css/tigera.css
webstick-css -> https://www.tigera.io/app/themes/tigera2021/dist/css/webstick.css
default-css -> https://www.tigera.io/app/themes/tigera2021/dist/css/default.css
ecs-styles -> https://www.tigera.io/app/plugins/ele-custom-skin/assets/css/ecs-style.css
core-block-supports-duotone ->

