=== Content from git.kernel.org_fe8c74ea_20250111_202659.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e9730744bf3af04cda23799029342aa3cddbc454)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e9730744bf3af04cda23799029342aa3cddbc454)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e9730744bf3af04cda23799029342aa3cddbc454)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e9730744bf3af04cda23799029342aa3cddbc454)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Daniel Thompson <daniel.thompson@linaro.org> | 2024-04-24 15:03:34 +0100 |
| --- | --- | --- |
| committer | Daniel Thompson <daniel.thompson@linaro.org> | 2024-04-26 17:13:30 +0100 |
| commit | [e9730744bf3af04cda23799029342aa3cddbc454](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e9730744bf3af04cda23799029342aa3cddbc454) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e9730744bf3af04cda23799029342aa3cddbc454)) | |
| tree | [650d4771e8609e0359b8aaa3f530657de6c19cc7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e9730744bf3af04cda23799029342aa3cddbc454) | |
| parent | [5b6d8ef6f056d8130168746c5459d7a3fb494859](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5b6d8ef6f056d8130168746c5459d7a3fb494859) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e9730744bf3af04cda23799029342aa3cddbc454&id2=5b6d8ef6f056d8130168746c5459d7a3fb494859)) | |
| download | [linux-e9730744bf3af04cda23799029342aa3cddbc454.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e9730744bf3af04cda23799029342aa3cddbc454.tar.gz) | |

kdb: Fix buffer overflow during tab-completeCurrently, when the user attempts symbol completion with the Tab key, kdb
will use strncpy() to insert the completed symbol into the command buffer.
Unfortunately it passes the size of the source buffer rather than the
destination to strncpy() with predictably horrible results. Most obviously
if the command buffer is already full but cp, the cursor position, is in
the middle of the buffer, then we will write past the end of the supplied
buffer.
Fix this by replacing the dubious strncpy() calls with memmove()/memcpy()
calls plus explicit boundary checks to make sure we have enough space
before we start moving characters around.
Reported-by: Justin Stitt <justinstitt@google.com>
Closes: https://lore.kernel.org/all/CAFhGd8qESuuifuHsNjFPR-Va3P80bxrw+LqvC8deA8GziUJLpw@mail.gmail.com/
Cc: stable@vger.kernel.org
Reviewed-by: Douglas Anderson <dianders@chromium.org>
Reviewed-by: Justin Stitt <justinstitt@google.com>
Tested-by: Justin Stitt <justinstitt@google.com>
Link: [https://lore.kernel.org/r/20240424-kgdb\_read\_refactor-v3-1-f236dbe9828d@linaro.org](https://lore.kernel.org/r/20240424-kgdb_read_refactor-v3-1-f236dbe9828d%40linaro.org)
Signed-off-by: Daniel Thompson <daniel.thompson@linaro.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e9730744bf3af04cda23799029342aa3cddbc454)

| -rw-r--r-- | [kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/kernel/debug/kdb/kdb_io.c?id=e9730744bf3af04cda23799029342aa3cddbc454) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 8 deletions

| diff --git a/kernel/debug/kdb/kdb\_io.c b/kernel/debug/kdb/kdb\_io.cindex 9443bc63c5a245..06dfbccb103368 100644--- a/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=5b6d8ef6f056d8130168746c5459d7a3fb494859)+++ b/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=e9730744bf3af04cda23799029342aa3cddbc454)@@ -367,14 +367,19 @@ poll\_again: kdb\_printf(kdb\_prompt\_str); kdb\_printf("%s", buffer); } else if (tab != 2 && count > 0) {- len\_tmp = strlen(p\_tmp);- strncpy(p\_tmp+len\_tmp, cp, lastchar-cp+1);- len\_tmp = strlen(p\_tmp);- strncpy(cp, p\_tmp+len, len\_tmp-len + 1);- len = len\_tmp - len;- kdb\_printf("%s", cp);- cp += len;- lastchar += len;+ /\* How many new characters do we want from tmpbuffer? \*/+ len\_tmp = strlen(p\_tmp) - len;+ if (lastchar + len\_tmp >= bufend)+ len\_tmp = bufend - lastchar;++ if (len\_tmp) {+ /\* + 1 ensures the '\0' is memmove'd \*/+ memmove(cp+len\_tmp, cp, (lastchar-cp) + 1);+ memcpy(cp, p\_tmp+len, len\_tmp);+ kdb\_printf("%s", cp);+ cp += len\_tmp;+ lastchar += len\_tmp;+ } } kdb\_nextline = 1; /\* reset output line number \*/ break; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 20:25:36 +0000



=== Content from git.kernel.org_d8a68539_20250111_202657.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=33d9c814652b971461d1e30bead6792851c209e7)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=33d9c814652b971461d1e30bead6792851c209e7)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=33d9c814652b971461d1e30bead6792851c209e7)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=33d9c814652b971461d1e30bead6792851c209e7)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Daniel Thompson <daniel.thompson@linaro.org> | 2024-04-24 15:03:34 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-16 13:41:39 +0200 |
| commit | [33d9c814652b971461d1e30bead6792851c209e7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=33d9c814652b971461d1e30bead6792851c209e7) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=33d9c814652b971461d1e30bead6792851c209e7)) | |
| tree | [8e9f15e2a892e9864f6763275c3426c8da2da516](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=33d9c814652b971461d1e30bead6792851c209e7) | |
| parent | [6da1ffc4bc569404d5da18c9151d771d2dff4cef](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6da1ffc4bc569404d5da18c9151d771d2dff4cef) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=33d9c814652b971461d1e30bead6792851c209e7&id2=6da1ffc4bc569404d5da18c9151d771d2dff4cef)) | |
| download | [linux-33d9c814652b971461d1e30bead6792851c209e7.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-33d9c814652b971461d1e30bead6792851c209e7.tar.gz) | |

kdb: Fix buffer overflow during tab-completecommit e9730744bf3af04cda23799029342aa3cddbc454 upstream.
Currently, when the user attempts symbol completion with the Tab key, kdb
will use strncpy() to insert the completed symbol into the command buffer.
Unfortunately it passes the size of the source buffer rather than the
destination to strncpy() with predictably horrible results. Most obviously
if the command buffer is already full but cp, the cursor position, is in
the middle of the buffer, then we will write past the end of the supplied
buffer.
Fix this by replacing the dubious strncpy() calls with memmove()/memcpy()
calls plus explicit boundary checks to make sure we have enough space
before we start moving characters around.
Reported-by: Justin Stitt <justinstitt@google.com>
Closes: https://lore.kernel.org/all/CAFhGd8qESuuifuHsNjFPR-Va3P80bxrw+LqvC8deA8GziUJLpw@mail.gmail.com/
Cc: stable@vger.kernel.org
Reviewed-by: Douglas Anderson <dianders@chromium.org>
Reviewed-by: Justin Stitt <justinstitt@google.com>
Tested-by: Justin Stitt <justinstitt@google.com>
Link: [https://lore.kernel.org/r/20240424-kgdb\_read\_refactor-v3-1-f236dbe9828d@linaro.org](https://lore.kernel.org/r/20240424-kgdb_read_refactor-v3-1-f236dbe9828d%40linaro.org)
Signed-off-by: Daniel Thompson <daniel.thompson@linaro.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=33d9c814652b971461d1e30bead6792851c209e7)

| -rw-r--r-- | [kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/kernel/debug/kdb/kdb_io.c?id=33d9c814652b971461d1e30bead6792851c209e7) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 8 deletions

| diff --git a/kernel/debug/kdb/kdb\_io.c b/kernel/debug/kdb/kdb\_io.cindex 67d3c48a152222..e5159e2b455f64 100644--- a/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=6da1ffc4bc569404d5da18c9151d771d2dff4cef)+++ b/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=33d9c814652b971461d1e30bead6792851c209e7)@@ -353,14 +353,19 @@ poll\_again: kdb\_printf(kdb\_prompt\_str); kdb\_printf("%s", buffer); } else if (tab != 2 && count > 0) {- len\_tmp = strlen(p\_tmp);- strncpy(p\_tmp+len\_tmp, cp, lastchar-cp+1);- len\_tmp = strlen(p\_tmp);- strncpy(cp, p\_tmp+len, len\_tmp-len + 1);- len = len\_tmp - len;- kdb\_printf("%s", cp);- cp += len;- lastchar += len;+ /\* How many new characters do we want from tmpbuffer? \*/+ len\_tmp = strlen(p\_tmp) - len;+ if (lastchar + len\_tmp >= bufend)+ len\_tmp = bufend - lastchar;++ if (len\_tmp) {+ /\* + 1 ensures the '\0' is memmove'd \*/+ memmove(cp+len\_tmp, cp, (lastchar-cp) + 1);+ memcpy(cp, p\_tmp+len, len\_tmp);+ kdb\_printf("%s", cp);+ cp += len\_tmp;+ lastchar += len\_tmp;+ } } kdb\_nextline = 1; /\* reset output line number \*/ break; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 20:25:34 +0000



=== Content from git.kernel.org_a4d1f8b3_20250111_202659.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f636a40834d22e5e3fc748f060211879c056cd33)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f636a40834d22e5e3fc748f060211879c056cd33)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f636a40834d22e5e3fc748f060211879c056cd33)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f636a40834d22e5e3fc748f060211879c056cd33)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Daniel Thompson <daniel.thompson@linaro.org> | 2024-04-24 15:03:34 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-16 13:39:59 +0200 |
| commit | [f636a40834d22e5e3fc748f060211879c056cd33](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f636a40834d22e5e3fc748f060211879c056cd33) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f636a40834d22e5e3fc748f060211879c056cd33)) | |
| tree | [9489936bd00ba919a640e29c2c4c453e21bebb74](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f636a40834d22e5e3fc748f060211879c056cd33) | |
| parent | [3f531c4cb789d2d464a16532e69700b0007f1c2a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3f531c4cb789d2d464a16532e69700b0007f1c2a) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f636a40834d22e5e3fc748f060211879c056cd33&id2=3f531c4cb789d2d464a16532e69700b0007f1c2a)) | |
| download | [linux-f636a40834d22e5e3fc748f060211879c056cd33.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f636a40834d22e5e3fc748f060211879c056cd33.tar.gz) | |

kdb: Fix buffer overflow during tab-completecommit e9730744bf3af04cda23799029342aa3cddbc454 upstream.
Currently, when the user attempts symbol completion with the Tab key, kdb
will use strncpy() to insert the completed symbol into the command buffer.
Unfortunately it passes the size of the source buffer rather than the
destination to strncpy() with predictably horrible results. Most obviously
if the command buffer is already full but cp, the cursor position, is in
the middle of the buffer, then we will write past the end of the supplied
buffer.
Fix this by replacing the dubious strncpy() calls with memmove()/memcpy()
calls plus explicit boundary checks to make sure we have enough space
before we start moving characters around.
Reported-by: Justin Stitt <justinstitt@google.com>
Closes: https://lore.kernel.org/all/CAFhGd8qESuuifuHsNjFPR-Va3P80bxrw+LqvC8deA8GziUJLpw@mail.gmail.com/
Cc: stable@vger.kernel.org
Reviewed-by: Douglas Anderson <dianders@chromium.org>
Reviewed-by: Justin Stitt <justinstitt@google.com>
Tested-by: Justin Stitt <justinstitt@google.com>
Link: [https://lore.kernel.org/r/20240424-kgdb\_read\_refactor-v3-1-f236dbe9828d@linaro.org](https://lore.kernel.org/r/20240424-kgdb_read_refactor-v3-1-f236dbe9828d%40linaro.org)
Signed-off-by: Daniel Thompson <daniel.thompson@linaro.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f636a40834d22e5e3fc748f060211879c056cd33)

| -rw-r--r-- | [kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/kernel/debug/kdb/kdb_io.c?id=f636a40834d22e5e3fc748f060211879c056cd33) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 8 deletions

| diff --git a/kernel/debug/kdb/kdb\_io.c b/kernel/debug/kdb/kdb\_io.cindex 6735ac36b7187e..dcc7e13e98b389 100644--- a/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=3f531c4cb789d2d464a16532e69700b0007f1c2a)+++ b/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=f636a40834d22e5e3fc748f060211879c056cd33)@@ -354,14 +354,19 @@ poll\_again: kdb\_printf(kdb\_prompt\_str); kdb\_printf("%s", buffer); } else if (tab != 2 && count > 0) {- len\_tmp = strlen(p\_tmp);- strncpy(p\_tmp+len\_tmp, cp, lastchar-cp+1);- len\_tmp = strlen(p\_tmp);- strncpy(cp, p\_tmp+len, len\_tmp-len + 1);- len = len\_tmp - len;- kdb\_printf("%s", cp);- cp += len;- lastchar += len;+ /\* How many new characters do we want from tmpbuffer? \*/+ len\_tmp = strlen(p\_tmp) - len;+ if (lastchar + len\_tmp >= bufend)+ len\_tmp = bufend - lastchar;++ if (len\_tmp) {+ /\* + 1 ensures the '\0' is memmove'd \*/+ memmove(cp+len\_tmp, cp, (lastchar-cp) + 1);+ memcpy(cp, p\_tmp+len, len\_tmp);+ kdb\_printf("%s", cp);+ cp += len\_tmp;+ lastchar += len\_tmp;+ } } kdb\_nextline = 1; /\* reset output line number \*/ break; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 20:25:36 +0000



=== Content from git.kernel.org_5dae08f0_20250111_202656.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=107e825cc448b7834b31e8b1b3cf0f57426d46d5)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=107e825cc448b7834b31e8b1b3cf0f57426d46d5)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=107e825cc448b7834b31e8b1b3cf0f57426d46d5)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=107e825cc448b7834b31e8b1b3cf0f57426d46d5)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Daniel Thompson <daniel.thompson@linaro.org> | 2024-04-24 15:03:34 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-16 13:47:43 +0200 |
| commit | [107e825cc448b7834b31e8b1b3cf0f57426d46d5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=107e825cc448b7834b31e8b1b3cf0f57426d46d5) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=107e825cc448b7834b31e8b1b3cf0f57426d46d5)) | |
| tree | [e089c1a9fcb277f92e9b0a7baa630f7ec3d4d687](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=107e825cc448b7834b31e8b1b3cf0f57426d46d5) | |
| parent | [4c09df40028475a3e7c9938a4e3c7167e85bd0b9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4c09df40028475a3e7c9938a4e3c7167e85bd0b9) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=107e825cc448b7834b31e8b1b3cf0f57426d46d5&id2=4c09df40028475a3e7c9938a4e3c7167e85bd0b9)) | |
| download | [linux-107e825cc448b7834b31e8b1b3cf0f57426d46d5.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-107e825cc448b7834b31e8b1b3cf0f57426d46d5.tar.gz) | |

kdb: Fix buffer overflow during tab-completecommit e9730744bf3af04cda23799029342aa3cddbc454 upstream.
Currently, when the user attempts symbol completion with the Tab key, kdb
will use strncpy() to insert the completed symbol into the command buffer.
Unfortunately it passes the size of the source buffer rather than the
destination to strncpy() with predictably horrible results. Most obviously
if the command buffer is already full but cp, the cursor position, is in
the middle of the buffer, then we will write past the end of the supplied
buffer.
Fix this by replacing the dubious strncpy() calls with memmove()/memcpy()
calls plus explicit boundary checks to make sure we have enough space
before we start moving characters around.
Reported-by: Justin Stitt <justinstitt@google.com>
Closes: https://lore.kernel.org/all/CAFhGd8qESuuifuHsNjFPR-Va3P80bxrw+LqvC8deA8GziUJLpw@mail.gmail.com/
Cc: stable@vger.kernel.org
Reviewed-by: Douglas Anderson <dianders@chromium.org>
Reviewed-by: Justin Stitt <justinstitt@google.com>
Tested-by: Justin Stitt <justinstitt@google.com>
Link: [https://lore.kernel.org/r/20240424-kgdb\_read\_refactor-v3-1-f236dbe9828d@linaro.org](https://lore.kernel.org/r/20240424-kgdb_read_refactor-v3-1-f236dbe9828d%40linaro.org)
Signed-off-by: Daniel Thompson <daniel.thompson@linaro.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=107e825cc448b7834b31e8b1b3cf0f57426d46d5)

| -rw-r--r-- | [kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/kernel/debug/kdb/kdb_io.c?id=107e825cc448b7834b31e8b1b3cf0f57426d46d5) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 8 deletions

| diff --git a/kernel/debug/kdb/kdb\_io.c b/kernel/debug/kdb/kdb\_io.cindex 9443bc63c5a245..06dfbccb103368 100644--- a/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=4c09df40028475a3e7c9938a4e3c7167e85bd0b9)+++ b/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=107e825cc448b7834b31e8b1b3cf0f57426d46d5)@@ -367,14 +367,19 @@ poll\_again: kdb\_printf(kdb\_prompt\_str); kdb\_printf("%s", buffer); } else if (tab != 2 && count > 0) {- len\_tmp = strlen(p\_tmp);- strncpy(p\_tmp+len\_tmp, cp, lastchar-cp+1);- len\_tmp = strlen(p\_tmp);- strncpy(cp, p\_tmp+len, len\_tmp-len + 1);- len = len\_tmp - len;- kdb\_printf("%s", cp);- cp += len;- lastchar += len;+ /\* How many new characters do we want from tmpbuffer? \*/+ len\_tmp = strlen(p\_tmp) - len;+ if (lastchar + len\_tmp >= bufend)+ len\_tmp = bufend - lastchar;++ if (len\_tmp) {+ /\* + 1 ensures the '\0' is memmove'd \*/+ memmove(cp+len\_tmp, cp, (lastchar-cp) + 1);+ memcpy(cp, p\_tmp+len, len\_tmp);+ kdb\_printf("%s", cp);+ cp += len\_tmp;+ lastchar += len\_tmp;+ } } kdb\_nextline = 1; /\* reset output line number \*/ break; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 20:25:34 +0000



=== Content from git.kernel.org_c52bce5a_20250111_202700.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f694da720dcf795dc3eb97bf76d220213f76aaa7)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f694da720dcf795dc3eb97bf76d220213f76aaa7)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f694da720dcf795dc3eb97bf76d220213f76aaa7)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f694da720dcf795dc3eb97bf76d220213f76aaa7)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Daniel Thompson <daniel.thompson@linaro.org> | 2024-04-24 15:03:34 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-16 13:51:09 +0200 |
| commit | [f694da720dcf795dc3eb97bf76d220213f76aaa7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f694da720dcf795dc3eb97bf76d220213f76aaa7) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f694da720dcf795dc3eb97bf76d220213f76aaa7)) | |
| tree | [de15c6d3222a5271ead73a3cd0bc6db718c3f04b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f694da720dcf795dc3eb97bf76d220213f76aaa7) | |
| parent | [06ef5e5afd7006812e89284d28281ad82e9a0061](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=06ef5e5afd7006812e89284d28281ad82e9a0061) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f694da720dcf795dc3eb97bf76d220213f76aaa7&id2=06ef5e5afd7006812e89284d28281ad82e9a0061)) | |
| download | [linux-f694da720dcf795dc3eb97bf76d220213f76aaa7.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f694da720dcf795dc3eb97bf76d220213f76aaa7.tar.gz) | |

kdb: Fix buffer overflow during tab-completecommit e9730744bf3af04cda23799029342aa3cddbc454 upstream.
Currently, when the user attempts symbol completion with the Tab key, kdb
will use strncpy() to insert the completed symbol into the command buffer.
Unfortunately it passes the size of the source buffer rather than the
destination to strncpy() with predictably horrible results. Most obviously
if the command buffer is already full but cp, the cursor position, is in
the middle of the buffer, then we will write past the end of the supplied
buffer.
Fix this by replacing the dubious strncpy() calls with memmove()/memcpy()
calls plus explicit boundary checks to make sure we have enough space
before we start moving characters around.
Reported-by: Justin Stitt <justinstitt@google.com>
Closes: https://lore.kernel.org/all/CAFhGd8qESuuifuHsNjFPR-Va3P80bxrw+LqvC8deA8GziUJLpw@mail.gmail.com/
Cc: stable@vger.kernel.org
Reviewed-by: Douglas Anderson <dianders@chromium.org>
Reviewed-by: Justin Stitt <justinstitt@google.com>
Tested-by: Justin Stitt <justinstitt@google.com>
Link: [https://lore.kernel.org/r/20240424-kgdb\_read\_refactor-v3-1-f236dbe9828d@linaro.org](https://lore.kernel.org/r/20240424-kgdb_read_refactor-v3-1-f236dbe9828d%40linaro.org)
Signed-off-by: Daniel Thompson <daniel.thompson@linaro.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f694da720dcf795dc3eb97bf76d220213f76aaa7)

| -rw-r--r-- | [kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/kernel/debug/kdb/kdb_io.c?id=f694da720dcf795dc3eb97bf76d220213f76aaa7) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 8 deletions

| diff --git a/kernel/debug/kdb/kdb\_io.c b/kernel/debug/kdb/kdb\_io.cindex 9443bc63c5a245..06dfbccb103368 100644--- a/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=06ef5e5afd7006812e89284d28281ad82e9a0061)+++ b/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=f694da720dcf795dc3eb97bf76d220213f76aaa7)@@ -367,14 +367,19 @@ poll\_again: kdb\_printf(kdb\_prompt\_str); kdb\_printf("%s", buffer); } else if (tab != 2 && count > 0) {- len\_tmp = strlen(p\_tmp);- strncpy(p\_tmp+len\_tmp, cp, lastchar-cp+1);- len\_tmp = strlen(p\_tmp);- strncpy(cp, p\_tmp+len, len\_tmp-len + 1);- len = len\_tmp - len;- kdb\_printf("%s", cp);- cp += len;- lastchar += len;+ /\* How many new characters do we want from tmpbuffer? \*/+ len\_tmp = strlen(p\_tmp) - len;+ if (lastchar + len\_tmp >= bufend)+ len\_tmp = bufend - lastchar;++ if (len\_tmp) {+ /\* + 1 ensures the '\0' is memmove'd \*/+ memmove(cp+len\_tmp, cp, (lastchar-cp) + 1);+ memcpy(cp, p\_tmp+len, len\_tmp);+ kdb\_printf("%s", cp);+ cp += len\_tmp;+ lastchar += len\_tmp;+ } } kdb\_nextline = 1; /\* reset output line number \*/ break; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 20:25:37 +0000



=== Content from git.kernel.org_3da97a7e_20250111_202700.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=fb824a99e148ff272a53d71d84122728b5f00992)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fb824a99e148ff272a53d71d84122728b5f00992)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fb824a99e148ff272a53d71d84122728b5f00992)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fb824a99e148ff272a53d71d84122728b5f00992)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Daniel Thompson <daniel.thompson@linaro.org> | 2024-04-24 15:03:34 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-16 13:23:45 +0200 |
| commit | [fb824a99e148ff272a53d71d84122728b5f00992](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fb824a99e148ff272a53d71d84122728b5f00992) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=fb824a99e148ff272a53d71d84122728b5f00992)) | |
| tree | [58d1675c9a01029e59ab897d0de31cde0067f8c4](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fb824a99e148ff272a53d71d84122728b5f00992) | |
| parent | [180b2e4c1ba4f6e3e4c52d6664cb019f6eac02f8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=180b2e4c1ba4f6e3e4c52d6664cb019f6eac02f8) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fb824a99e148ff272a53d71d84122728b5f00992&id2=180b2e4c1ba4f6e3e4c52d6664cb019f6eac02f8)) | |
| download | [linux-fb824a99e148ff272a53d71d84122728b5f00992.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-fb824a99e148ff272a53d71d84122728b5f00992.tar.gz) | |

kdb: Fix buffer overflow during tab-completecommit e9730744bf3af04cda23799029342aa3cddbc454 upstream.
Currently, when the user attempts symbol completion with the Tab key, kdb
will use strncpy() to insert the completed symbol into the command buffer.
Unfortunately it passes the size of the source buffer rather than the
destination to strncpy() with predictably horrible results. Most obviously
if the command buffer is already full but cp, the cursor position, is in
the middle of the buffer, then we will write past the end of the supplied
buffer.
Fix this by replacing the dubious strncpy() calls with memmove()/memcpy()
calls plus explicit boundary checks to make sure we have enough space
before we start moving characters around.
Reported-by: Justin Stitt <justinstitt@google.com>
Closes: https://lore.kernel.org/all/CAFhGd8qESuuifuHsNjFPR-Va3P80bxrw+LqvC8deA8GziUJLpw@mail.gmail.com/
Cc: stable@vger.kernel.org
Reviewed-by: Douglas Anderson <dianders@chromium.org>
Reviewed-by: Justin Stitt <justinstitt@google.com>
Tested-by: Justin Stitt <justinstitt@google.com>
Link: [https://lore.kernel.org/r/20240424-kgdb\_read\_refactor-v3-1-f236dbe9828d@linaro.org](https://lore.kernel.org/r/20240424-kgdb_read_refactor-v3-1-f236dbe9828d%40linaro.org)
Signed-off-by: Daniel Thompson <daniel.thompson@linaro.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fb824a99e148ff272a53d71d84122728b5f00992)

| -rw-r--r-- | [kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/kernel/debug/kdb/kdb_io.c?id=fb824a99e148ff272a53d71d84122728b5f00992) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 8 deletions

| diff --git a/kernel/debug/kdb/kdb\_io.c b/kernel/debug/kdb/kdb\_io.cindex b45576ca3b0da6..e7d1a7462edd9b 100644--- a/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=180b2e4c1ba4f6e3e4c52d6664cb019f6eac02f8)+++ b/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=fb824a99e148ff272a53d71d84122728b5f00992)@@ -364,14 +364,19 @@ poll\_again: kdb\_printf(kdb\_prompt\_str); kdb\_printf("%s", buffer); } else if (tab != 2 && count > 0) {- len\_tmp = strlen(p\_tmp);- strncpy(p\_tmp+len\_tmp, cp, lastchar-cp+1);- len\_tmp = strlen(p\_tmp);- strncpy(cp, p\_tmp+len, len\_tmp-len + 1);- len = len\_tmp - len;- kdb\_printf("%s", cp);- cp += len;- lastchar += len;+ /\* How many new characters do we want from tmpbuffer? \*/+ len\_tmp = strlen(p\_tmp) - len;+ if (lastchar + len\_tmp >= bufend)+ len\_tmp = bufend - lastchar;++ if (len\_tmp) {+ /\* + 1 ensures the '\0' is memmove'd \*/+ memmove(cp+len\_tmp, cp, (lastchar-cp) + 1);+ memcpy(cp, p\_tmp+len, len\_tmp);+ kdb\_printf("%s", cp);+ cp += len\_tmp;+ lastchar += len\_tmp;+ } } kdb\_nextline = 1; /\* reset output line number \*/ break; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 20:25:37 +0000



=== Content from git.kernel.org_adfdd0fd_20250111_202658.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ddd2972d8e2dee3b33e8121669d55def59f0be8a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ddd2972d8e2dee3b33e8121669d55def59f0be8a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ddd2972d8e2dee3b33e8121669d55def59f0be8a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ddd2972d8e2dee3b33e8121669d55def59f0be8a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Daniel Thompson <daniel.thompson@linaro.org> | 2024-04-24 15:03:34 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-16 13:28:51 +0200 |
| commit | [ddd2972d8e2dee3b33e8121669d55def59f0be8a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ddd2972d8e2dee3b33e8121669d55def59f0be8a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ddd2972d8e2dee3b33e8121669d55def59f0be8a)) | |
| tree | [7f5a0b54d1dc01c518b823e0611c7ccb571d8384](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ddd2972d8e2dee3b33e8121669d55def59f0be8a) | |
| parent | [2098b237ba17783899f041400e340529957e51c4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2098b237ba17783899f041400e340529957e51c4) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ddd2972d8e2dee3b33e8121669d55def59f0be8a&id2=2098b237ba17783899f041400e340529957e51c4)) | |
| download | [linux-ddd2972d8e2dee3b33e8121669d55def59f0be8a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ddd2972d8e2dee3b33e8121669d55def59f0be8a.tar.gz) | |

kdb: Fix buffer overflow during tab-completecommit e9730744bf3af04cda23799029342aa3cddbc454 upstream.
Currently, when the user attempts symbol completion with the Tab key, kdb
will use strncpy() to insert the completed symbol into the command buffer.
Unfortunately it passes the size of the source buffer rather than the
destination to strncpy() with predictably horrible results. Most obviously
if the command buffer is already full but cp, the cursor position, is in
the middle of the buffer, then we will write past the end of the supplied
buffer.
Fix this by replacing the dubious strncpy() calls with memmove()/memcpy()
calls plus explicit boundary checks to make sure we have enough space
before we start moving characters around.
Reported-by: Justin Stitt <justinstitt@google.com>
Closes: https://lore.kernel.org/all/CAFhGd8qESuuifuHsNjFPR-Va3P80bxrw+LqvC8deA8GziUJLpw@mail.gmail.com/
Cc: stable@vger.kernel.org
Reviewed-by: Douglas Anderson <dianders@chromium.org>
Reviewed-by: Justin Stitt <justinstitt@google.com>
Tested-by: Justin Stitt <justinstitt@google.com>
Link: [https://lore.kernel.org/r/20240424-kgdb\_read\_refactor-v3-1-f236dbe9828d@linaro.org](https://lore.kernel.org/r/20240424-kgdb_read_refactor-v3-1-f236dbe9828d%40linaro.org)
Signed-off-by: Daniel Thompson <daniel.thompson@linaro.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ddd2972d8e2dee3b33e8121669d55def59f0be8a)

| -rw-r--r-- | [kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/kernel/debug/kdb/kdb_io.c?id=ddd2972d8e2dee3b33e8121669d55def59f0be8a) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 8 deletions

| diff --git a/kernel/debug/kdb/kdb\_io.c b/kernel/debug/kdb/kdb\_io.cindex 46821793637a15..7daa5f4ed507fd 100644--- a/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=2098b237ba17783899f041400e340529957e51c4)+++ b/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=ddd2972d8e2dee3b33e8121669d55def59f0be8a)@@ -364,14 +364,19 @@ poll\_again: kdb\_printf(kdb\_prompt\_str); kdb\_printf("%s", buffer); } else if (tab != 2 && count > 0) {- len\_tmp = strlen(p\_tmp);- strncpy(p\_tmp+len\_tmp, cp, lastchar-cp+1);- len\_tmp = strlen(p\_tmp);- strncpy(cp, p\_tmp+len, len\_tmp-len + 1);- len = len\_tmp - len;- kdb\_printf("%s", cp);- cp += len;- lastchar += len;+ /\* How many new characters do we want from tmpbuffer? \*/+ len\_tmp = strlen(p\_tmp) - len;+ if (lastchar + len\_tmp >= bufend)+ len\_tmp = bufend - lastchar;++ if (len\_tmp) {+ /\* + 1 ensures the '\0' is memmove'd \*/+ memmove(cp+len\_tmp, cp, (lastchar-cp) + 1);+ memcpy(cp, p\_tmp+len, len\_tmp);+ kdb\_printf("%s", cp);+ cp += len\_tmp;+ lastchar += len\_tmp;+ } } kdb\_nextline = 1; /\* reset output line number \*/ break; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 20:25:35 +0000



=== Content from git.kernel.org_0dc3e6e3_20250111_202657.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=cfdc2fa4db57503bc6d3817240547c8ddc55fa96)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cfdc2fa4db57503bc6d3817240547c8ddc55fa96)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cfdc2fa4db57503bc6d3817240547c8ddc55fa96)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cfdc2fa4db57503bc6d3817240547c8ddc55fa96)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Daniel Thompson <daniel.thompson@linaro.org> | 2024-04-24 15:03:34 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-16 13:32:35 +0200 |
| commit | [cfdc2fa4db57503bc6d3817240547c8ddc55fa96](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cfdc2fa4db57503bc6d3817240547c8ddc55fa96) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=cfdc2fa4db57503bc6d3817240547c8ddc55fa96)) | |
| tree | [657d7cd03afe9826b288ed51e410b86070b2382f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cfdc2fa4db57503bc6d3817240547c8ddc55fa96) | |
| parent | [b487b48efd0c0a3709b4c73e990eede73320667f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b487b48efd0c0a3709b4c73e990eede73320667f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cfdc2fa4db57503bc6d3817240547c8ddc55fa96&id2=b487b48efd0c0a3709b4c73e990eede73320667f)) | |
| download | [linux-cfdc2fa4db57503bc6d3817240547c8ddc55fa96.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-cfdc2fa4db57503bc6d3817240547c8ddc55fa96.tar.gz) | |

kdb: Fix buffer overflow during tab-completecommit e9730744bf3af04cda23799029342aa3cddbc454 upstream.
Currently, when the user attempts symbol completion with the Tab key, kdb
will use strncpy() to insert the completed symbol into the command buffer.
Unfortunately it passes the size of the source buffer rather than the
destination to strncpy() with predictably horrible results. Most obviously
if the command buffer is already full but cp, the cursor position, is in
the middle of the buffer, then we will write past the end of the supplied
buffer.
Fix this by replacing the dubious strncpy() calls with memmove()/memcpy()
calls plus explicit boundary checks to make sure we have enough space
before we start moving characters around.
Reported-by: Justin Stitt <justinstitt@google.com>
Closes: https://lore.kernel.org/all/CAFhGd8qESuuifuHsNjFPR-Va3P80bxrw+LqvC8deA8GziUJLpw@mail.gmail.com/
Cc: stable@vger.kernel.org
Reviewed-by: Douglas Anderson <dianders@chromium.org>
Reviewed-by: Justin Stitt <justinstitt@google.com>
Tested-by: Justin Stitt <justinstitt@google.com>
Link: [https://lore.kernel.org/r/20240424-kgdb\_read\_refactor-v3-1-f236dbe9828d@linaro.org](https://lore.kernel.org/r/20240424-kgdb_read_refactor-v3-1-f236dbe9828d%40linaro.org)
Signed-off-by: Daniel Thompson <daniel.thompson@linaro.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cfdc2fa4db57503bc6d3817240547c8ddc55fa96)

| -rw-r--r-- | [kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/kernel/debug/kdb/kdb_io.c?id=cfdc2fa4db57503bc6d3817240547c8ddc55fa96) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 8 deletions

| diff --git a/kernel/debug/kdb/kdb\_io.c b/kernel/debug/kdb/kdb\_io.cindex 6735ac36b7187e..dcc7e13e98b389 100644--- a/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=b487b48efd0c0a3709b4c73e990eede73320667f)+++ b/[kernel/debug/kdb/kdb\_io.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/debug/kdb/kdb_io.c?id=cfdc2fa4db57503bc6d3817240547c8ddc55fa96)@@ -354,14 +354,19 @@ poll\_again: kdb\_printf(kdb\_prompt\_str); kdb\_printf("%s", buffer); } else if (tab != 2 && count > 0) {- len\_tmp = strlen(p\_tmp);- strncpy(p\_tmp+len\_tmp, cp, lastchar-cp+1);- len\_tmp = strlen(p\_tmp);- strncpy(cp, p\_tmp+len, len\_tmp-len + 1);- len = len\_tmp - len;- kdb\_printf("%s", cp);- cp += len;- lastchar += len;+ /\* How many new characters do we want from tmpbuffer? \*/+ len\_tmp = strlen(p\_tmp) - len;+ if (lastchar + len\_tmp >= bufend)+ len\_tmp = bufend - lastchar;++ if (len\_tmp) {+ /\* + 1 ensures the '\0' is memmove'd \*/+ memmove(cp+len\_tmp, cp, (lastchar-cp) + 1);+ memcpy(cp, p\_tmp+len, len\_tmp);+ kdb\_printf("%s", cp);+ cp += len\_tmp;+ lastchar += len\_tmp;+ } } kdb\_nextline = 1; /\* reset output line number \*/ break; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 20:25:35 +0000


