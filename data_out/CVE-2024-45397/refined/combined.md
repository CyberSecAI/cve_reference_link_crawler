=== Content from h2o.examp1e.net_a5a90168_20250111_072053.html ===

# [H2O](index.html)

the optimized HTTP/1.x, HTTP/2, HTTP/3 server

×

Powered by [Oktavia](https://github.com/shibukawa/oktavia)

| [Top](index.html) | [Install](install.html) | [Configure](configure.html) | [FAQ](faq.html) | [Blog](http://blog.kazuhooku.com/search/label/H2O) | [Source](http://github.com/h2o/h2o/) |
| --- | --- | --- | --- | --- | --- |

## [Configure](configure.html) > HTTP/3

[HTTP/3](https://tools.ietf.org/html/rfc9114) uses [QUIC](https://tools.ietf.org/html/rfc9000) as the transport protocol.
A [`listen`](configure/base_directives.html#listen) directive with a `type` attribute set to `quic` instructs the standalone server to bind to a UDP port on which QUIC packets will be sent and received.
The binding must have an [`ssl`](configure/base_directives.html#listen-ssl) attribute, as QUIC uses TLS/1.3 as the handshake protocol.

The example below setups a server that listens to both TCP port 443 and UDP port 443 using the same certificate and private key.

First `listen` directive binds the server to TCP port 443 with specified credentials, marking that directive as an [YAML alias](configure/syntax_and_structure.html#yaml_alias) called `&listen_ssl`.
Then, it reuses ([YAML merge](configure/syntax_and_structure.html#yaml_merge)) the first listen directive, adding `type: quic` to create a UDP port 443 binding for accepting QUIC connections.

Example. Serving HTTP/1,2 and 3 on port 443
```
listen: &listen_ssl
  port: 443
  ssl:
    certificate-file: /path/to-ssl-certificate-file
    key-file: /path/to/ssl-key-file
listen:
  <<: *listen_ssl
  type: quic

```
#### Fine-tuning QUIC Behavior

To fine tune the behavior of QUIC, the `quic` attribute should be used in place of the `type` attribute specifying `quic`.
The `quic` attribute accepts following parameters.

amp-limit
Amount of data that can be sent to the client before the client address is validated; see [section 8.1 of RFC 9000](https://www.rfc-editor.org/rfc/rfc9000.html#name-address-validation). Default is 3.
handshake-timeout-rtt-multiplier
Handshake timeout in the unit of round-trip time. Default is 400.
max-initial-handshake-packets
Maximum number of Initial packets to be sent before the handshake is deemed to have failed. Default is 1,000.
max-streams-bidi
Maximum number of client-initated bi-directional streams. This parameter controls the HTTP request concurrency of a HTTP/3 connection. Default is 100.
max-udp-payload-size
See [Section 18.2 of RFC 9000](https://www.rfc-editor.org/rfc/rfc9000.html#name-transport-parameter-definit). Default is 1,472.
qpack-encoder-table-capacity
Size of the QPACK encoder table. Default is 4,096.
retry
A boolean flag (`OFF` or `ON`) indicating if a Retry packet should be used for validating the client address. Use of Retry packets mitigate denial-of-service attacks at the cost of incurring one additional round-trip for processing the handshake.
sndbuf, rcvbuf
Size of send and receive buffers, in the unit of bytes. Unlike the TCP counterparts that are per-connection, these buffers are associated to the listening port and applies to all the connections bound to that port.

The example below reuses a previous binding but sets the `retry` parameter to `ON`.

Example. HTTP/3 endpoint using Retry packets
```
listen:
  <<: *listen_ssl
  quic:
    retry: ON

```

Also, properties such as [congestion controller](configure/base_directives.html#listen-cc) and [initial congestion window](configure/base_directives.html#listen-initcwnd) can be tuned using the top-level attribute of `listen`.

#### HTTP/3 Directives

Aside from QUIC-level properties, configuration directives listed below are provided for tuning HTTP/3 behavior.

* [`http3-graceful-shutdown-timeout`](configure/http3_directives.html#http3-graceful-shutdown-timeout)
* [`http3-gso`](configure/http3_directives.html#http3-gso)
* [`http3-idle-timeout`](configure/http3_directives.html#http3-idle-timeout)
* [`http3-input-window-size`](configure/http3_directives.html#http3-input-window-size)

### [`"http3-graceful-shutdown-timeout"`](configure/http3_directives.html#http3-graceful-shutdown-timeout)

Description:

Maximum duration to retain HTTP/3 connections in half-closed state, in seconds.

When a graceful shutdown of h2o is initiated, h2o at first sends a GOAWAY frame indicating the clients that it is initiating shutdown, then after one second, starts rejecting new HTTP requests (a.k.a. half-closed state).

This directive controls how long h2o should wait for the peer to close the QUIC connection in this half-closed state, before exitting.

If set to zero, this timeout is disabled.
h2o will not shut down until all QUIC connections are closed by the clients or times out.

[Level](configure/syntax_and_structure.html#config_levels):
global
Default:
````
http3-graceful-shutdown-timeout: 0
````

### [`"http3-gso"`](configure/http3_directives.html#http3-gso)

Description:

If Generic Segmentation Offload should be used when sending QUIC packets.

[Level](configure/syntax_and_structure.html#config_levels):
global
Default:
````
http3-gso: ON
````

### [`"http3-idle-timeout"`](configure/http3_directives.html#http3-idle-timeout)

Description:

Idle timeout in the unit of seconds.

Unlike idle timeout of HTTP/1 and HTTP/2, this value should be small because it is faster to re-establish a new connection using 0-RTT than migrating to a different port due to NAT rebinding.

[Level](configure/syntax_and_structure.html#config_levels):
global
Default:
````
http3-idle-timeout: 30
````

### [`"http3-input-window-size"`](configure/http3_directives.html#http3-input-window-size)

Description:

Default window size for HTTP request body.

See [`http2-input-window-size`](configure/http2_directives.html#http2-input-window-size).

[Level](configure/syntax_and_structure.html#config_levels):
global
Default:
````
http3-input-window-size: 16777216
````

Copyright © 2015-2023 [DeNA Co., Ltd.](http://dena.com/intl/) et al.



=== Content from github.com_b734d678_20250111_072047.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fh2o%2Fh2o%2Fsecurity%2Fadvisories%2FGHSA-jf2c-xjcp-wg4c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fh2o%2Fh2o%2Fsecurity%2Fadvisories%2FGHSA-jf2c-xjcp-wg4c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=h2o%2Fh2o)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[h2o](/h2o)
/
**[h2o](/h2o/h2o)**
Public

* [Notifications](/login?return_to=%2Fh2o%2Fh2o) You must be signed in to change notification settings
* [Fork
  849](/login?return_to=%2Fh2o%2Fh2o)
* [Star
   11k](/login?return_to=%2Fh2o%2Fh2o)

* [Code](/h2o/h2o)
* [Issues
  584](/h2o/h2o/issues)
* [Pull requests
  107](/h2o/h2o/pulls)
* [Actions](/h2o/h2o/actions)
* [Wiki](/h2o/h2o/wiki)
* [Security](/h2o/h2o/security)
* [Insights](/h2o/h2o/pulse)

Additional navigation options

* [Code](/h2o/h2o)
* [Issues](/h2o/h2o/issues)
* [Pull requests](/h2o/h2o/pulls)
* [Actions](/h2o/h2o/actions)
* [Wiki](/h2o/h2o/wiki)
* [Security](/h2o/h2o/security)
* [Insights](/h2o/h2o/pulse)

# bypassing address-based access control with 0-RTT

Moderate

[kazuho](/kazuho)
published
GHSA-jf2c-xjcp-wg4c
Oct 11, 2024

## Package

h2o
(C)

## Affected versions

commits up to 2702483

## Patched versions

commit 15ed15a and above

## Description

### Impact

When an HTTP request using TLS/1.3 early data on top of TCP Fast Open or QUIC 0-RTT packets is received and [the IP-address-based access control](https://h2o.examp1e.net/configure/access_control.html) is used, the access control does not detect and prohibit HTTP requests conveyed by packets with a spoofed source address.

This behavior allows attackers on the network to execute HTTP requests from addresses that are otherwise rejected by the address-based access control.

### Patches

The vulnerability has been addressed in commit [15ed15a](https://github.com/h2o/h2o/commit/15ed15a2efb83a77bb4baaa5a119e639c2f6898a). Users should upgrade to commit [95e8e17](https://github.com/h2o/h2o/commit/95e8e178275acebb3a57d32a914723617fbe1724) or above.

### Workarounds

As an alternative to patching h2o, users may disable the use of TCP FastOpen and QUIC to mitigate the issue.

To disable TCP Fast Open, consult the documentation of the operating system. To disable QUIC, remove or comment out the [`listen` directives using the `quic` type or attribute](https://h2o.examp1e.net/configure/http3_directives.html).

### Acknowledgment

We thank Michael Wedl ([@MWedl](https://github.com/MWedl)) for reporting the vulnerability.

### Severity

Moderate

5.9

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N

### CVE ID

CVE-2024-45397

### Weaknesses

No CWEs

### Credits

* [![@MWedl](https://avatars.githubusercontent.com/u/29510012?s=40&v=4)](/MWedl)
  [MWedl](/MWedl)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_fc396275_20250111_072046.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fh2o%2Fh2o%2Fcommit%2F15ed15a2efb83a77bb4baaa5a119e639c2f6898a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fh2o%2Fh2o%2Fcommit%2F15ed15a2efb83a77bb4baaa5a119e639c2f6898a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=h2o%2Fh2o)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[h2o](/h2o)
/
**[h2o](/h2o/h2o)**
Public

* [Notifications](/login?return_to=%2Fh2o%2Fh2o) You must be signed in to change notification settings
* [Fork
  849](/login?return_to=%2Fh2o%2Fh2o)
* [Star
   11k](/login?return_to=%2Fh2o%2Fh2o)

* [Code](/h2o/h2o)
* [Issues
  584](/h2o/h2o/issues)
* [Pull requests
  107](/h2o/h2o/pulls)
* [Actions](/h2o/h2o/actions)
* [Wiki](/h2o/h2o/wiki)
* [Security](/h2o/h2o/security)
* [Insights](/h2o/h2o/pulse)

Additional navigation options

* [Code](/h2o/h2o)
* [Issues](/h2o/h2o/issues)
* [Pull requests](/h2o/h2o/pulls)
* [Actions](/h2o/h2o/actions)
* [Wiki](/h2o/h2o/wiki)
* [Security](/h2o/h2o/security)
* [Insights](/h2o/h2o/pulse)

## Commit

[Permalink](/h2o/h2o/commit/15ed15a2efb83a77bb4baaa5a119e639c2f6898a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge commit from fork

[Browse files](/h2o/h2o/tree/15ed15a2efb83a77bb4baaa5a119e639c2f6898a)
Browse the repository at this point in the history

```
return 425 in `addr` if early-data header is set
```

* Loading branch information

[![@kazuho](https://avatars.githubusercontent.com/u/41567?s=40&v=4)](/kazuho)

[kazuho](/h2o/h2o/commits?author=kazuho "View all commits by kazuho")
authored
Oct 11, 2024

2 parents
[2702483](/h2o/h2o/commit/270248347b3c0c40f2c3138e7ec3248408d04899)
+
[3855168](/h2o/h2o/commit/3855168876a5f656462923a1abc4dee884bf3a72)

commit 15ed15a

Showing
**1 changed file**
with
**11 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

14 changes: 11 additions & 3 deletions

14
[share/h2o/mruby/acl.rb](#diff-d24d44468417ee3bbd84da2a77a9ff888f41036eca98fea9a66e94fec280fea9 "share/h2o/mruby/acl.rb")

Show comments

[View file](/h2o/h2o/blob/15ed15a2efb83a77bb4baaa5a119e639c2f6898a/share/h2o/mruby/acl.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -41,6 +41,9 @@ def acl(&block) |
|  |  |  |
|  |  | class ACLHandler |
|  |  |  |
|  |  | class TooEarlyError < StandardError |
|  |  | end |
|  |  |  |
|  |  | class ConditionalHandler |
|  |  | def initialize(handler, cond) |
|  |  | @handler = handler |
| Expand All | | @@ -63,9 +66,13 @@ def initialize(&block) |
|  |  | end |
|  |  |  |
|  |  | def call(env) |
|  |  | @acl.each {|ac| |
|  |  | return ac.call(env) if ac.satisfy?(env) |
|  |  | } |
|  |  | begin |
|  |  | @acl.each {|ac| |
|  |  | return ac.call(env) if ac.satisfy?(env) |
|  |  | } |
|  |  | rescue TooEarlyError => e |
|  |  | return [425, {}, []] |
|  |  | end |
|  |  | return [399, {}, []] |
|  |  | end |
|  |  |  |
| Expand Down  Expand Up | | @@ -96,6 +103,7 @@ def initialize(env) |
|  |  | end |
|  |  |  |
|  |  | def addr(forwarded=true) |
|  |  | raise TooEarlyError if @env['HTTP\_EARLY\_DATA'] |
|  |  | addr = @env['REMOTE\_ADDR'] |
|  |  | if forwarded && (xff = @env['HTTP\_X\_FORWARDED\_FOR']) |
|  |  | xaddr = xff.split(",")[0] |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `15ed15a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fh2o%2Fh2o%2Fcommit%2F15ed15a2efb83a77bb4baaa5a119e639c2f6898a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


