Based on the provided information, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**
- Insufficient access control during the password reset process.

**Weaknesses/vulnerabilities present:**
-  Users with access restrictions (e.g., expired accounts) could still reset their passwords if the password reset feature is enabled.

**Impact of exploitation:**
- Attackers can bypass access restrictions by resetting the password for restricted user accounts, leading to unauthorized access.

**Attack vectors:**
- Exploitation requires the password reset feature to be enabled in SFTPGo.
- An attacker would need to initiate a password reset process.

**Required attacker capabilities/position:**
- The attacker must have knowledge of a restricted user's account and their username to initiate a password reset process and gain access using the reset.
- The attacker must have the ability to receive the reset code via the configured email address for that restricted user.

**Additional Notes:**
- This vulnerability affects SFTPGo versions prior to v2.6.1.
- The vulnerability is identified as CVE-2024-37897
- The official fix was implemented in version 2.6.1.
- The advisory mentions two workarounds: disabling the password reset feature or setting blank email addresses for restricted users.
- The vulnerability is classified as "Moderate" severity.
- The identified weakness is that even restricted users were allowed to reset their password and log in.

The provided commit diffs show that the fix involved invalidating the user's token after a password change to prevent using the old token with the new password.