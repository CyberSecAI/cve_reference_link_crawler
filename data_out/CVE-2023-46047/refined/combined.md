=== Content from seclists.org_d22a5830_20250111_001333.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](63)
[By Date](date.html#64)
[![Next](/images/right-icon-16x16.png)](65)

[![Previous](/images/left-icon-16x16.png)](63)
[By Thread](index.html#64)
[![Next](/images/right-icon-16x16.png)](65)

![](/shared/images/nst-icons.svg#search)

# null pointer deference in Sane via a crafted config file

---

*From*: Meng Ruijie <ruijie\_meng () u nus edu>

*Date*: Sat, 20 Jan 2024 04:11:57 +0000

---

```
[Vulnerability description]
A null pointer deference occurred in Sane v.1.2.1 via a crafted config file to the sanei_configure_attach() function.

[VulnerabilityType Other]
null pointer deference

[Vendor of Product]
sane

[Affected Product Code Base]
sane - 1.2.1

[Reference]
<https://gitlab.com/sane-project/backends/-/issues/708>

[CVE Reference]
The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2023-46047 to this
vulnerability.
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](63)
[By Date](date.html#64)
[![Next](/images/right-icon-16x16.png)](65)

[![Previous](/images/left-icon-16x16.png)](63)
[By Thread](index.html#64)
[![Next](/images/right-icon-16x16.png)](65)

### Current thread:

* **null pointer deference in Sane via a crafted config file** *Meng Ruijie (Jan 26)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from gitlab.com_bfcd6613_20250111_001334.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Possible SEGV (null pointer deref) in sanei\_configure\_attach()

There appears to be a possible NULL pointer dereference in the the `sanei_configure_attach()` function [here](https://gitlab.com/sane-project/backends/-/blob/3c20a989cfec676fde7f64381f5d15dc6e30586a/sanei/sanei_config.c#L297):

```
      lp = sanei_config_get_string (lp, &token);
      if (strncmp (token, "option", 6) == 0)
```

The `sanei_config_get_string()` function can return `token=NULL` (see [here](https://gitlab.com/sane-project/backends/-/blob/3c20a989cfec676fde7f64381f5d15dc6e30586a/sanei/sanei_config.c#L202)), but this is not checked before the call to `strncmp()`.

Stack:

```
Thread 1 "scanimage" received signal SIGSEGV, Segmentation fault.
__strncmp_sse42 () at ../sysdeps/x86_64/multiarch/strcmp-sse4_2.S:227
#0  __strncmp_sse42 () at ../sysdeps/x86_64/multiarch/strcmp-sse4_2.S:227
#1  0x00007ffff77173fa in sanei_configure_attach (config_file=config_file@entry=0x7ffff7723a1f "xerox_mfp.conf", config=config@entry=0x7fffffffb590, attach=attach@entry=0x7ffff77140f0 <list_conf_devices>, data=data@entry=0x0)
    at ../sanei/sanei_config.c:298
#2  0x00007ffff7720a5b in sane_xerox_mfp_get_devices (device_list=0x7fffffffb5f0, local=<optimized out>) at /build/sane-backends-FM1saq/sane-backends-1.2.1/backend/xerox_mfp.c:1110
#3  0x00007ffff7fac063 in sane_dll_get_devices (device_list=0x7fffffffb718, local_only=0) at /home/gjd/RRFuzz/debug/sane-backends-1.2.1/backend/dll.c:1098
#4  0x00007ffff7fa6e06 in sane_get_devices (dl=0x7fffffffb718, local=0) at /home/gjd/RRFuzz/debug/sane-backends-1.2.1/backend/dll-s.c:21
#5  0x0000555555558f81 in main (argc=<optimized out>, argv=0x7fffffffdfe8) at /usr/src/sane-backends-1.2.1-1/frontend/scanimage.c:2418
```

PoC:

[xerox\_mfp.conf](/-/project/429008/uploads/b3aee24facfa9b57efdadd80201d9948/xerox_mfp.conf)

To reproduce, run `scanimage` with this file in the same directory.

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


