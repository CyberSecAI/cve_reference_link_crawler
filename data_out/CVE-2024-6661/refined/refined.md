Based on the provided content, here's the breakdown of the vulnerability:

**CVE ID:** CVE-2024-6661

**Root Cause of Vulnerability:**
*   The vulnerability is due to insufficient input sanitization and output escaping in the 'Discount Text' field of the ParityPress plugin.

**Weaknesses/Vulnerabilities Present:**
*   **Stored Cross-Site Scripting (XSS):** The plugin fails to properly sanitize user-supplied input in the "discount_text" field, allowing an attacker to inject malicious JavaScript code that is then stored in the database.

**Impact of Exploitation:**
*   **Arbitrary Script Execution:** Successful exploitation enables an attacker to inject malicious web scripts that will execute in the browsers of users who access pages containing the injected content. This can lead to various impacts including:
    *   Session hijacking
    *   Data theft
    *   Redirection to malicious sites
    *   Defacement

**Attack Vectors:**
*   **Plugin Setting Manipulation:** An authenticated attacker with administrator-level permissions (or higher) can modify the 'Discount Text' field through the plugin settings to include malicious JavaScript code.

**Required Attacker Capabilities/Position:**
*   **Authentication:** The attacker needs to be an authenticated user with administrator-level access (or higher) to the WordPress site.
*   **Access to Plugin Settings:** The attacker needs to access the settings page for the ParityPress plugin to modify the vulnerable field.
* **Specific configurations**: The vulnerability is more easily exploitable on multi-site installations and installations where unfiltered_html has been disabled.

**Additional details from the provided content:**

*   The vulnerable code is located in the `Activator.php` file, specifically the 'discount_text' field (line 22).
*   The vulnerable versions of the plugin are all versions up to and including 1.0.0.
*   The vulnerability was patched in version 1.0.1.
* The plugin uses a third party service (ip-api.com) to determine user's country.