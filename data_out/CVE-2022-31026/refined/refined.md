The provided content relates to CVE-2022-31026.

**Root cause of vulnerability:**
- The vulnerability arises from improper handling of the `auth_data_len` field in the MySQL handshake packet. A malicious server could send a crafted authentication packet where `auth_data_len` indicates a length greater than 8 bytes.  The client then calculates `remaining_auth_data_len` and copies data based on this length without checking if the length is valid. This can lead to reading up to 12 bytes from an uninitialized variable in stack memory.

**Weaknesses/vulnerabilities present:**
- Use of an uninitialized variable.
- Insufficient validation of the `auth_data_len` field from the server, leading to out-of-bounds read from stack.

**Impact of exploitation:**
- A malicious server can cause the client to read up to 12 bytes of uninitialized stack memory and send that data back to the server.
- This information leak could potentially expose sensitive data, such as parts of the stack, to a malicious server.

**Attack vectors:**
- The attacker controls a malicious server.
- The client connects to this malicious server.

**Required attacker capabilities/position:**
- The attacker needs to be in a position to act as a MySQL server.
- The attacker needs the ability to craft a malicious handshake packet, especially the authentication data length.

**Additional details:**
- The fix involves adding a check to ensure that the authentication data length is what is expected, which is exactly 21 bytes if the secure connection capability is enabled.
- The vulnerability is present in versions <= 2.1.0 of the `trilogy` gem.
- The patched version is 2.1.1.
- The vulnerability is classified as low severity.
- The code change introduces a check `if (SCRAMBLE_LEN + 1 != auth_data_len)` to ensure the authentication data length is correct.