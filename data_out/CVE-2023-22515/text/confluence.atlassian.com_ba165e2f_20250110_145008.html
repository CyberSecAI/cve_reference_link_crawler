
![](/staticassets/4.7.2/dist/common/images/media-viewer-image-icon.svg)
##

![]()

[![](/staticassets/4.7.2/dist/common/images/header-atlassian-logo.svg)](https://support.atlassian.com/)

* Products
* Resources

* [Search](https://support.atlassian.com/search-results/)
* [Log in](https://id.atlassian.com/login?continue=https://confluence.atlassian.com/login.action?os_destination=/kb/faq-for-cve-2023-22515-1295682188.html)
* ![]()
  + [View account](https://my.atlassian.com/)
  + [View requests](https://support.atlassian.com/servicedesk/customer/user/requests)
  + [Log out](/logout.action?os_destination=https://id.atlassian.com/logout?continue=/kb/faq-for-cve-2023-22515-1295682188.html)
* ...

## Products

* [### Jira Software

  Project and issue tracking](https://support.atlassian.com/jira-software-cloud)
* [### Jira Service Management

  Service management and customer support](https://support.atlassian.com/jira-service-management-cloud)
* [### Jira Work Management

  Manage any business project](https://support.atlassian.com/jira-work-management)
* [### Confluence

  Document collaboration](https://support.atlassian.com/confluence-cloud)
* [### Bitbucket

  Git code management](https://support.atlassian.com/bitbucket-cloud)

[See all](https://support.atlassian.com/products/)

## Resources

* [### Documentation

  Usage and admin help](https://confluence.atlassian.com)
* [### Community

  Answers, support, and inspiration](https://community.atlassian.com)
* [### System Status

  Cloud services health](http://status.atlassian.com)
* [### Suggestions and bugs

  Feature suggestions and bug reports](https://jira.atlassian.com)
* [### Marketplace

  Product apps](https://marketplace.atlassian.com)
* [### Billing and licensing

  Frequently asked questions](https://www.atlassian.com/licensing/purchase-licensing)

* [Log out](/logout.action?os_destination=https://id.atlassian.com/logout?continue=/kb/faq-for-cve-2023-22515-1295682188.html)
* [Log in to account](https://id.atlassian.com/login?continue=https://confluence.atlassian.com/login.action?os_destination=/kb/faq-for-cve-2023-22515-1295682188.html)
* [Contact support](https://support.atlassian.com/contact/)
* [Training & Certification](https://www.atlassian.com/university)
* [Cloud Migration Center](https://www.atlassian.com/cloud-migration)
* [GDPR guides](https://confluence.atlassian.com/gdpr)
* [Enterprise services](https://www.atlassian.com/enterprise/services)
* [Atlassian partners](https://www.atlassian.com/partners)
* [Developers](https://developer.atlassian.com/)
* [User groups](http://aug.atlassian.com/)
* [Automation for Jira](https://confluence.atlassian.com/automation/)
* [Atlassian.com](http://www.atlassian.com/)

* #### Page
* [View in Confluence](/login.action?os_destination=%2Fpages%2Fviewpage.action%3FpageId%3D1295682188)
* [Edit Page](/login.action?os_destination=https%3A%2F%2Fconfluence.atlassian.com%2Fpages%2Feditpage.action%3FpageId%3D1295682188%26atl_token%3D81b25f6152e7636677765cc622cf7d9fa3c57aa9)
* #### Viewport
* [Manage Viewport](/login.action?os_destination=%2Fspaces%2Fscroll-viewport%2Fconfig.action%3Fkey%3DKB)
* #### Confluence
* [Dashboard](/login.action?os_destination=%2Fdashboard.action)
* [Space Directory](/login.action?os_destination=%2Fspacedirectory%2Fview.action)
* [People Directory](/login.action?os_destination=%2Fpeopledirectory.action)

[Atlassian Knowledge Base](/display/KB/Atlassian%2BKnowledge%2BBase)

Documentation

Unable to load

* [Atlassian Support](https://support.atlassian.com/ "Atlassian Support")
* [Documentation](/ "Documentation")
* [Atlassian Knowledge Base](/display/KB/Atlassian%2BKnowledge%2BBase "Atlassian Knowledge Base")
* [FAQ for CVE-2023-22515](/kb/faq-for-cve-2023-22515-1295682188.html "FAQ for CVE-2023-22515")

# FAQ for CVE-2023-22515

#### Atlassian Knowledge Base

* [Application Links Troubleshooting Guide](/kb/application-links-troubleshooting-guide-718668765.html)
* [Database Troubleshooting and How-to Guides](/kb/database-troubleshooting-and-how-to-guides-744326149.html)
* [Best practices for performance troubleshooting tools](/kb/best-practices-for-performance-troubleshooting-tools-652444218.html)
* [SSL/TLS Troubleshooting](/kb/ssl-tls-troubleshooting-755140932.html)
* [Cross Product Knowledge](/kb/cross-product-knowledge-756942140.html)
* [Proxying Atlassian Server applications](/kb/proxying-atlassian-server-applications-753894340.html)
* [Atlassian Account Troubleshooting](/kb/atlassian-account-troubleshooting-1040621762.html)
* [Mapping Web Resources to Code](/kb/mapping-web-resources-to-code-658735691.html)
* [Subscribe to Proactive Announcements](/kb/subscribe-to-proactive-announcements-277250853.html)
* [How to capture HTTP traffic using Wireshark, Fiddler, or tcpdump](/kb/how-to-capture-http-traffic-using-wireshark-fiddler-or-tcpdump-779164332.html)
* [Cross Site Request Forgery (CSRF) protection changes in Atlassian REST](/kb/cross-site-request-forgery-csrf-protection-changes-in-atlassian-rest-779294918.html)
* [Purchased Add-ons feature is unavailable](/kb/purchased-add-ons-feature-is-unavailable-794199681.html)
* [Single Sign-on Integration with Atlassian products](/kb/single-sign-on-integration-with-atlassian-products-794495126.html)
* [Troubleshooting Services](/kb/troubleshooting-services-794203719.html)
* [Test disk access speed for a Java application](/kb/test-disk-access-speed-for-a-java-application-818577561.html)
* [User Management Troubleshooting and How-To Guides](/kb/user-management-troubleshooting-and-how-to-guides-820119238.html)
* [Atlassian login issues](/kb/atlassian-login-issues-833991866.html)
* [JQL with OR results in error.](/kb/jql-with-or-results-in-error-838417201.html)
* [How to set the timezone for the Java environment](/kb/how-to-set-the-timezone-for-the-java-environment-841187402.html)
* [Websudo is disabled after migration from JIRA cloud to JIRA server](/kb/websudo-is-disabled-after-migration-from-jira-cloud-to-jira-server-845939463.html)
* [Health Check: Lucene index files location](/kb/health-check-lucene-index-files-location-873918046.html)
* [Health Check: Thread Limit](/kb/health-check-thread-limit-858578685.html)
* [Editor Window is Small After Upgrading where as the preview is Normal window size](/kb/editor-window-is-small-after-upgrading-where-as-the-preview-is-normal-window-size-883397198.html)
* [Basic authentication fails for outgoing proxy in Java 8u111](/kb/basic-authentication-fails-for-outgoing-proxy-in-java-8u111-909643110.html)
* [All Atlassian knowledge base articles](/kb/all-atlassian-knowledge-base-articles-915144849.html)
* [Creating A Jira Administrator That Does Not Count Towards License](/kb/creating-a-jira-administrator-that-does-not-count-towards-license-938020264.html)
* [Users are unable to log in to JIRA (LDAP: error code 49, data 52e)](/kb/users-are-unable-to-log-in-to-jira-ldap-error-code-49-data-52e-946611857.html)
* [User unable to login into Crowd after Crowd was upgraded](/kb/user-unable-to-login-into-crowd-after-crowd-was-upgraded-953137351.html)
* [How to use the Performance Data Collector](/kb/how-to-use-the-performance-data-collector-957980877.html)
* [Ports used by Atlassian Applications](/kb/ports-used-by-atlassian-applications-960136309.html)
* [How to define Xmx based on GC logs](/kb/how-to-define-xmx-based-on-gc-logs-960142303.html)
* [How to log in to my Atlassian cloud site for the first time](/kb/how-to-log-in-to-my-atlassian-cloud-site-for-the-first-time-964975882.html)
* [How to block access to a specific URL at Tomcat](/kb/how-to-block-access-to-a-specific-url-at-tomcat-966668691.html)
* [User-installed apps health check fails in Data Center when configuring CDN](/kb/user-installed-apps-health-check-fails-in-data-center-when-configuring-cdn-969524956.html)
* [HTTP2 health check fails in Data Center when configuring CDN](/kb/http2-health-check-fails-in-data-center-when-configuring-cdn-969524971.html)
* [How to configure Apache for caching and HTTP/2](/kb/how-to-configure-apache-for-caching-and-http-2-972332210.html)
* [How to Unsubscribe from Jira Server or Confluence Server apps on TestFlight (Server and Data Center)](/kb/how-to-unsubscribe-from-jira-server-or-confluence-server-apps-on-testflight-server-and-data-center-993920732.html)
* [Unable to synchronize with Active Directory due to SSL requirement (Server and Data Center)](/kb/unable-to-synchronize-with-active-directory-due-to-ssl-requirement-server-and-data-center-994317232.html)
* [Jira Align - Jira Connector pages do not load completely](/kb/jira-align-jira-connector-pages-do-not-load-completely-1013858289.html)
* [Jira Align - Work In Process by Value Stream is missing work items](/kb/jira-align-work-in-process-by-value-stream-is-missing-work-items-1019398001.html)
* [JVM is not reachable with jstat and jstack](/kb/jvm-is-not-reachable-with-jstat-and-jstack-1031281491.html)
* [Data pipeline troubleshooting](/kb/data-pipeline-troubleshooting-1044790964.html)
* [Using JDK 11 to develop apps with the Atlassian SDK is not yet supported](/kb/using-jdk-11-to-develop-apps-with-the-atlassian-sdk-is-not-yet-supported-1055687492.html)
* [How to download Atlassian Marketplace apps through the command line](/kb/how-to-download-atlassian-marketplace-apps-through-the-command-line-1072483349.html)
* [How to manage named contacts for Atlassian Premier Support (on-premises)](/kb/how-to-manage-named-contacts-for-atlassian-premier-support-on-premises-1081351321.html)
* [Bidirectional characters warning in Atlassian products](/kb/bidirectional-characters-warning-in-atlassian-products-1086419461.html)
* [FAQ for CVE-2021-42574](/kb/faq-for-cve-2021-42574-1093014910.html)
* [Jira is logging multiple cache flushes in the application logs (Server and Data Center)](/kb/jira-is-logging-multiple-cache-flushes-in-the-application-logs-server-and-data-center-1097172094.html)
* [FAQ for CVE-2021-44228, CVE-2021-45046 and CVE-2021-45105](/kb/faq-for-cve-2021-44228-cve-2021-45046-and-cve-2021-45105-1103069406.html)
* [On-Prem Upgrade Information (March 2022)](/kb/on-prem-upgrade-information-march-2022-1115664074.html)
* [FAQ for CVE-2022-22965](/kb/faq-for-cve-2022-22965-1115149136.html)
* [FAQ for CVE-2022-0540](/kb/faq-for-cve-2022-0540-1123193843.html)
* [Troubleshooting Configure Fields in Jira Server and Data Center](/kb/troubleshooting-configure-fields-in-jira-server-and-data-center-1129692155.html)
* [FAQ for CVE-2022-26134](/kb/faq-for-cve-2022-26134-1139441859.html)
* [How to disable custom Configure Fields in Create Issue screen in Jira Server and Data Center](/kb/how-to-disable-custom-configure-fields-in-create-issue-screen-in-jira-server-and-data-center-1141968365.html)
* [FAQ for CVE-2022-26135](/kb/faq-for-cve-2022-26135-1142439167.html)
* [FAQ for CVE-2022-26138](/kb/faq-for-cve-2022-26138-1141988423.html)
* [FAQ for CVE-2022-26136 / CVE-2022-26137](/kb/faq-for-cve-2022-26136-cve-2022-26137-1141988432.html)
* [FAQ for CVE-2022-36804](/kb/faq-for-cve-2022-36804-1157481722.html)
* [Atlassian Authentication App](/kb/atlassian-authentication-app-1167828121.html)
* [FAQ for CVE-2022-43782](/kb/faq-for-cve-2022-43782-1182925811.html)
* [Allowlist URL's for Jira-Slack integration](/kb/allowlist-url-s-for-jira-slack-integration-1167843322.html)
* [FAQ for CVE-2023-22501](/kb/faq-for-cve-2023-22501-1189797488.html)
* [Cannot start Jira over another node via pbrun command (Server and Data Center)](/kb/cannot-start-jira-over-another-node-via-pbrun-command-server-and-data-center-1252333617.html)
* [Attachment health check shows warning message when a custom attachment page is used in Jira Server and Data Center](/kb/attachment-health-check-shows-warning-message-when-a-custom-attachment-page-is-used-in-jira-server-and-data-center-1255455236.html)
* [FAQ for CVE-2019-13990](/kb/faq-for-cve-2019-13990-1282249125.html)
* [FAQ for CVE-2022-1471](/kb/faq-for-cve-2022-1471-1295810798.html)
* [FAQ for CVE-2023-22515](/kb/faq-for-cve-2023-22515-1295682188.html)
* [FAQ for CVE-2023-22518](/kb/faq-for-cve-2023-22518-1311474094.html)
* [FAQ for CVE-2023-46604](/kb/faq-for-cve-2023-46604-1318881301.html)
* [FAQ for CVE-2023-22523](/kb/faq-for-cve-2023-22523-1318391335.html)
* [FAQ for CVE-2023-22522](/kb/faq-for-cve-2023-22522-1319248951.html)
* [FAQ for CVE-2023-22524](/kb/faq-for-cve-2023-22524-1319248987.html)
* [FAQ for CVE-2023-22527](/kb/faq-for-cve-2023-22527-1332810917.html)
* [Using a temporary license before upgrading to Cloud or Data Center](/kb/using-a-temporary-license-before-upgrading-to-cloud-or-data-center-1354596537.html)
* [Guide for Atlassian Premier Support Named Contacts: On-Premises Product Support Essentials](/kb/guide-for-atlassian-premier-support-named-contacts-on-premises-product-support-essentials-1402668439.html)
* [What data should be provided to Atlassian on support tickets for an effective initial troubleshooting](/kb/what-data-should-be-provided-to-atlassian-on-support-tickets-for-an-effective-initial-troubleshooting-1455890621.html)

#### On this page

#### Related content

* No related content found

#### Still need help?

The Atlassian Community is here for you.

[Ask the community](https://community.atlassian.com/t5/custom/page/page-id/create-post-step-1?add-tags=Atlassian+Support)

# General Information

A critical severity authentication vulnerability was discovered in Confluence Server and Data Center ([CVE-2023-22515](https://confluence.atlassian.com/security/cve-2023-22515-privilege-escalation-vulnerability-in-confluence-data-center-and-server-1295682276.html)).

This page contains frequently asked questions and answers about this vulnerability. The Atlassian Security Team will update this page as new information becomes available.

## Is my Confluence instance affected?

The Confluence Data Center and Server versions listed below are affected by this vulnerability. Publicly accessible Confluence Data Center and Server versions as listed below are at critical risk and require immediate attention. Customers using these versions should [upgrade your instance](https://confluence.atlassian.com/doc/upgrading-confluence-4578.html "https://confluence.atlassian.com/doc/upgrading-confluence-4578.html") as soon as possible.

**Versions prior to 8.0 are not affected by this vulnerability.**

| Product | Affected Versions |
| --- | --- |
| Confluence Data Center and Confluence Server | * 8.0.0 * 8.0.1 * 8.0.2 * 8.0.3 * 8.1.0 * 8.1.3 * 8.1.4 * 8.2.0 * 8.2.1 * 8.2.2 * 8.2.3 * 8.3.0 * 8.3.1 * 8.3.2 * 8.4.0 * 8.4.1 * 8.4.2 * 8.5.0 * 8.5.1 |

Atlassian recommends that you upgrade each of your affected installations to one of the listed fixed versions (or any later version) below.

| Product | Fixed Versions |
| --- | --- |
| Confluence Data Center and Confluence Server | * 8.3.3 or later * 8.4.3 or later * 8.5.2 or later |

## Are Cloud instances affected?

If your Confluence site is accessed via an [atlassian.net](http://atlassian.net/) domain, it is hosted by Atlassian and is not vulnerable to this issue.

## Why am I being redirected to setup/finishsetup.action or seeing 403/404 errors after I’ve applied the mitigation steps?

The mitigation actions noted in the Advisory are not a replacement for upgrading your instance; you must upgrade as soon as possible. The mitigation steps will block an attacker's ability to create an administrator account in Confluence, however, it won’t prevent an attacker from continuously trying to exploit the instance which may result in a [Denial of Service attack](https://en.wikipedia.org/wiki/Denial-of-service_attack). Once the upgrade is complete, you will no longer receive the **HTTP Status** errors or redirects to /setup/finishsetup.action.

## Does upgrading to a fixed version completely solve the issue?

No. If an instance has already been compromised, upgrading will not remove the compromise.

As well as upgrading, customers can follow "Can we determine if Confluence has already been compromised?", which is available in this FAQ, to check for indicators of compromise. If any evidence is found, you should assume that your instance has been compromised and evaluate the risk of flow-on effects.

## I am running an affected version of Confluence. How can I mitigate the threat until I upgrade?

If you are unable to upgrade Confluence, as an interim measure we recommend restricting external network access to the affected instance.

Additionally, you can mitigate known attack vectors for this vulnerability by blocking access to the `/setup/*` endpoints on Confluence instances. This is possible at the network layer or by making the following changes to Confluence configuration files.

1. On each node, modify `/<confluence-install-dir>/confluence/WEB-INF/web.xml`  and add the following block of code (just *before* the `</web-app>` tag at the end of the file):

```
<security-constraint>
     <web-resource-collection>
       <url-pattern>/setup/*</url-pattern>
	   <http-method-omission>*</http-method-omission>
	</web-resource-collection>
   <auth-constraint />
</security-constraint>
```

2. Restart Confluence.

The mitigation prevents any Confluence administrators from triggering Confluence setup actions, this includes setting up Confluence from scratch or migrating to and from Data Center. If these actions are required you will need to remove these lines from the web.xml file. Please re-add these lines if you are not running a fixed version of Confluence.

## My instance isn't exposed to the Internet. Is an upgrade still recommended?

Yes! While ensuring instances are not exposed to the public internet greatly reduces the attack surface, we strongly recommend applying the latest version security patch.

## My instance is NOT connected to the internet, what should I do? Am I safe?

If the Confluence instance cannot be accessed from the general internet, the risk of an exploit/attack originating from there is reduced.

Due to the critical nature of this vulnerability and the variety of ways in which instances can be accessed, please work with local network/security team(s) to determine if mitigation is needed. However, out of an abundance of caution, the guidance on the Confluence Security Advisory page for [CVE-2023-22515](/security/cve-2023-22515-broken-access-control-vulnerability-in-confluence-data-center-and-server-1295682276.html) still applies.

## Can we determine if Confluence has already been compromised?

Per our security advisory [CVE-2023-22515](/security/cve-2023-22515-broken-access-control-vulnerability-in-confluence-data-center-and-server-1295682276.html), the following are indicators of a potential compromise:

* unexpected members in the `confluence-administrators` group
* unexpected newly created user accounts
* requests to `/setup/*.action` in network access logs
* presence of `/setup/setupadministrator.action` in an exception message in `atlassian-confluence-security.log` in the Confluence home directory

Expand for an example of the above exception message

```
2027-01-01 07:50:38,312 ERROR [http-nio-8090-exec-8 url: /confluence/setup/setupadministrator.action] [atlassian.confluence.user.DefaultUserAccessor] createGroup com.atlassian.crowd.exception.embedded.InvalidGroupException: com.atlassian.crowd.exception.InvalidGroupException: Group already exists
 -- url: /confluence/setup/setupadministrator.action | userName: anonymous | action: setupadministrator | traceId: 43994e68d74b2b4b
com.atlassian.user.impl.EntityValidationException: com.atlassian.crowd.exception.embedded.InvalidGroupException: com.atlassian.crowd.exception.InvalidGroupException: Group already exists
	at com.atlassian.crowd.embedded.atlassianuser.EmbeddedCrowdGroupManager.createGroup(EmbeddedCrowdGroupManager.java:146)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	...
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:220)
	at com.sun.proxy.$Proxy165.addGroup(Unknown Source)
	at com.atlassian.crowd.embedded.atlassianuser.EmbeddedCrowdGroupManager.createGroup(EmbeddedCrowdGroupManager.java:144)
	... 490 more
Caused by: com.atlassian.crowd.exception.InvalidGroupException: Group already exists
	at com.atlassian.crowd.manager.application.ApplicationServiceGeneric.addGroup(ApplicationServiceGeneric.java:719)
	at com.atlassian.crowd.embedded.core.CrowdServiceImpl.addGroup(CrowdServiceImpl.java:421)
	... 507 more
```

Please work with your local security team or a specialist security forensics firm for further investigation, and [contact Atlassian Support](https://support.atlassian.com/contact/) for additional assistance.

## My instance has been compromised, what should I do?

We strongly recommend involving your local security team for further investigation. If it is determined that your Confluence Server/DC instance has been compromised, our advice is to immediately shut down and disconnect the server from the network/Internet. Also, you may want to immediately shut down any other systems which potentially share a user base or have common username/password combinations with the compromised system.

Before doing anything else you will need to work with your local security team to identify the scope of the breach and your recovery options. If your Confluence instances have been compromised by [CVE-2023-22515](https://confluence.atlassian.com/security/cve-2023-22515-broken-access-control-vulnerability-in-confluence-data-center-and-server-1295682276.html), threat attackers hold full administrative access and can perform any number of unfettered actions including - but not limited to - exfiltration of content and system credentials, and installation of malicious plugins.

If you believe your Confluence instance was compromised, [contact Atlassian Support](https://support.atlassian.com/contact/) as Atlassian assistance is required to recover and protect your instance. Please include web server access logs (with the IP address of the attacker) in the data that is provided for further investigation.

## Are other Atlassian products affected by this vulnerability?

No, they are not affected by [CVE-2023-22515](/security/cve-2023-22515-broken-access-control-vulnerability-in-confluence-data-center-and-server-1295682276.html). No action is required for other products.

Last modified on Oct 31, 2023

Was this helpful?

Yes
No
 It wasn't accurate

 It wasn't clear

 It wasn't relevant

Provide feedback about this article

#### Related content

* No related content found

Powered by [Confluence](http://www.atlassian.com/) and [Scroll Viewport](https://www.k15t.com/go/scroll-viewport).

[Atlassian](https://www.atlassian.com/)

* [Notice at Collection](https://www.atlassian.com/legal/privacy-policy#additional-disclosures-for-ca-residents)
* [Privacy Policy](https://www.atlassian.com/legal/privacy-policy)
* [Terms of Use](https://www.atlassian.com/legal/customer-agreement)
* [Security](https://www.atlassian.com/trust/security)
* ©  Atlassian

