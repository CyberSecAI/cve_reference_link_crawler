

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1850158)
* [XML](/show_bug.cgi?ctype=xml&id=1850158)

Closed
[Bug 1850158](/show_bug.cgi?id=1850158)
(CVE-2024-26283)

Opened 1 year ago
Closed 1 year ago

# Address bar spoofing using firefox://open-url in Firefox iOS

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Address bar spoofing using firefox://open-url in Firefox iOS

## Categories

### (Firefox for iOS :: General, defect)

[Product:](/describecomponents.cgi?product=Firefox%20for%20iOS)

Firefox for iOS
▾

Firefox for iOS
Firefox for iOS is the Firefox mobile experience developed for the iOS platform.
[See Open Bugs in This Product](/buglist.cgi?product=Firefox%20for%20iOS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox%20for%20iOS)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox%20for%20iOS&component=General#General)

General
▾

Firefox for iOS :: General
For bugs that don't fit into other components.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox%20for%20iOS&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| fxios | [123](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=123) | --- |

|  | Tracking | Status |
| --- | --- | --- |
| fxios | 123 |  |

## People

### (Reporter: sdna.muneaki.nishimura, Assigned: lmarceau)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/7fb2b1922d97306f98551a6d1db2768a?d=mm&size=40)  [lmarceau](/user_profile?user_id=694570)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/7e8b2996acb6304c9b7b7000f408632a?d=mm&size=40)  [sdna.muneaki.nishimura](/user_profile?user_id=507051)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/481f85b35d45ebad6d41f98cae68ccbf?d=mm&size=40)  [jeevans](/user_profile?user_id=654438)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

### ( [URL](https://csrf.jp/2023/fxios-url-spoof.php "https://csrf.jp/2023/fxios-url-spoof.php") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2024-26281](/show_bug.cgi?id=1868005 "RESOLVED FIXED - iOS Firefox QR Code Scanner allows to run firefox URI with javascript URI for related exploit"), [1870384](/show_bug.cgi?id=1870384 "RESOLVED DUPLICATE - firefox URI for iOS Firefox allows to load file URI")

Dependency [tree](/showdependencytree.cgi?id=1850158&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1850158)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1868002](/show_bug.cgi?id=1868002 "RESOLVED DUPLICATE - Firefox URI can run javascript URI on iOS Firefox"), [1870384](/show_bug.cgi?id=1870384 "RESOLVED DUPLICATE - firefox URI for iOS Firefox allows to load file URI")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[csrf.jp/2023/fxios-url-spoof.php](https://csrf.jp/2023/fxios-url-spoof.php "https://csrf.jp/2023/fxios-url-spoof.php")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2024-1563](/show_bug.cgi?id=1863831 "RESOLVED FIXED - Full UXSS via opening Firefox Focus externally after silent background navigation"), [CVE-2024-26281](/show_bug.cgi?id=1868005 "RESOLVED FIXED - iOS Firefox QR Code Scanner allows to run firefox URI with javascript URI for related exploit"), [1868002](/show_bug.cgi?id=1868002 "RESOLVED DUPLICATE - Firefox URI can run javascript URI on iOS Firefox"), [1870308](/show_bug.cgi?id=1870308 "RESOLVED FIXED - iOS Firefox can open file: URLs through QR Code Scanning")

[github.com/mozilla-mobile/firefox-ios...](https://github.com/mozilla-mobile/firefox-ios/pull/17827 "https://github.com/mozilla-mobile/firefox-ios/pull/17827")

[mozilla-hub.atlassian.net/browse/FXIO...](https://mozilla-hub.atlassian.net/browse/FXIOS-7331 "https://mozilla-hub.atlassian.net/browse/FXIOS-7331")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-26283

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a12450091_1689 "1 year ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty-hof |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [address-bar-spoofing-using-open-url.gif](/attachment.cgi?id=9350291)  [1 year ago](#c0)  [Muneaki Nishimura](/user_profile?user_id=507051)   759.76 KB, image/gif |  | [Details](/attachment.cgi?id=9350291&action=edit) |
| --- | --- | --- |
| [testcase](/attachment.cgi?id=9351919)  [1 year ago](#c5)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   272 bytes, text/html |  | [Details](/attachment.cgi?id=9351919&action=edit) |
| [GitHub Pull Request](/attachment.cgi?id=9369700)  [1 year ago](#c12)  [lmarceau](/user_profile?user_id=694570)   56 bytes, text/x-github-pull-request |  | [Details](/attachment.cgi?id=9369700&action=edit) | [Review](/attachment.cgi?id=9369700) |
| [advisory.txt](/attachment.cgi?id=9381065)  [11 months ago](#c18)  [lmarceau](/user_profile?user_id=694570)   231 bytes, text/plain |  | [Details](/attachment.cgi?id=9381065&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Muneaki Nishimura](/user_profile?user_id=507051)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1850158#c0)• 1 year ago |
|  | |

Attached image
[address-bar-spoofing-using-open-url.gif](attachment.cgi?id=9350291)
— [Details](attachment.cgi?id=9350291&action=edit)

Firefox iOS supports a custom URL scheme called "firefox://open-url" for opening specified URL by Firefox from other apps. Normally, Firefox prohibits opening URLs with javascript: scheme, but when using "open-url", it becomes possible to open them. Additionally, if the URL contains "://" immediately after the URL scheme, the address bar of Firefox iOS shows only the rest of the URL.

These two behaviors make spoofing the address bar.

As an example, consider the following URL:

When the following URL is opened in iOS Safari:

firefox://open-url?url=javascript://google.com%2Fsearch?q=foo%26source=%2F%250adocument.body.innerHTML='%253ch1%2520style=color:red%253eHacked!'

the JavaScript code specified through the URL is executed in Firefox, so the text "Hacked!" is displayed on the screen. And then, the address bar shows "google.com/search?q=foo...".

A reproduction URL is below. Open the page in Safari on an iOS device, and tap the link on the page.

<https://csrf.jp/2023/fxios-url-spoof.php>

Flags: sec-bounty?

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a2112_691597)• 1 year ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralProduct: Firefox → Firefox for iOS

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1850158#c1)• 1 year ago |
|  | |

Didn't we previously fix a bug to limit external URLs to a defined whitelist of acceptable ones? `javascript` should definitely not be on that list.

And any scheme-hiding code should be strictly limited to http/https. Anything else needs to show the scheme and could be a spoofing problem all on its own.

I assume if launching this from Firefox itself was possible Muneaki would have mentioned that, but I'll call this sec-moderate in case it is possible. If this is really only possible when Firefox isn't even the user's preferred browser (in which case it's likely not even installed) then we could downgrade it to sec-low. The external app might not be a browser like Safari though, it could be a social app that opens links in browsers.

Flags: needinfo?(lmarceau)Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a953795_694570)• 1 year ago |

Flags: needinfo?(lmarceau)

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1850158#c2)• 1 year ago |
|  | |

Tracking progress on this issue with <https://mozilla-hub.atlassian.net/browse/FXIOS-7331>

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1850158#c3)• 1 year ago |
|  | |

Note that `firefox://open-url` will open Firefox even if the browser is not set as default. It will open the app if the app is installed, but will open the URL in Safari if the OS cannot find the Firefox app I believe.

The JavaScript scheme handling that you mention :dveditz I believe is done when a new navigation action is handled by a webview. That code is [here](https://github.com/mozilla-mobile/firefox-ios/blob/efb9f3bb642d2d9fee5a20f133ce0f0505fb3cd4/Client/Frontend/Browser/BrowserViewController/BrowserViewController%2BWebViewDelegates.swift#L399-L403) and we made sure apparently to stop supporting javascript scheme since bugzilla [1588928](https://bugzilla.mozilla.org/show_bug.cgi?id=1588928). So it seems the [`decisionHandler`](https://developer.apple.com/documentation/webkit/wknavigationdelegate/1455643-webview?language=objc) doesn't get called in this case when we navigate from `firefox://open-url` with a Javascript URL. Unless I am missing something, this is an oversight since the webkit delegate methods aren't called in this particular case (and so we open javascript URLs when we shouldn't take that action).

On the UX perspective, I wonder what should happen, should we just block that navigation and stay on the tab we were before this happen (for example, homepage)?

I also wonder if there are other schemes that could be taken advantage of with those same steps?

|  | [Muneaki Nishimura](/user_profile?user_id=507051)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1850158#c4)• 1 year ago |
|  | |

As you commented above, firefox://open-url is available regardless of whether Firefox is the default browser or not.

Originally, I demonstrated the attack by opening the malicious link in Safari, but the same attack can be achieved by opening the URL sent to the built-in SMS or email application. Also, even if Firefox is the default browser, "ftp:" scheme URL link is opened in the pre-installed Safari. Recently, "ftp:" is no longer opened in Safari, but in a slightly earlier version, it's possible to initiate the attack chain by launching Safari from Firefox through a "ftp:" link.

Similar to firefox://open-url, Google Chrome also supports "googlechrome:" and "googlechromes:"" URL schemes that can open the specified URL in Chrome. If an invalid URL is passed to this URL, Chrome seems to stay on the previous page or home screen.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1850158#c5)• 1 year ago |
|  | |

Attached file
[testcase](attachment.cgi?id=9351919)
— [Details](attachment.cgi?id=9351919&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1850158#c6)• 1 year ago |
|  | |

(In reply to lmarceau from [comment #3](/show_bug.cgi?id=1850158#c3 "VERIFIED FIXED - Address bar spoofing using firefox://open-url in Firefox iOS"))

> The JavaScript scheme handling that you mention :dveditz I believe is done when a new navigation action is handled by a webview. That code is [here](https://github.com/mozilla-mobile/firefox-ios/blob/efb9f3bb642d2d9fee5a20f133ce0f0505fb3cd4/Client/Frontend/Browser/BrowserViewController/BrowserViewController%2BWebViewDelegates.swift#L399-L403) and we made sure apparently to stop supporting javascript scheme

There are a whole bunch of `func webView()` defined in that file; when do the various ones get used? Is that function called by webkit when we navigate? I don't see "open-url" defined around there so I'm guessing there is a *different* place called when the OS hands us a URL from outside the app than when webkit is letting us handle or veto navigations from content that we're already handling in the app. Unfortunately I don't know Swift or the iOS SDK so I'm stumbling around a bit here, but it looks like the Router stuff is related

<https://github.com/mozilla-mobile/firefox-ios/blob/fc66a2023be3cbd9ac240de2e45af7e661ccf31a/Client/Coordinators/Router/DeeplinkInput.swift#L13>

<https://github.com/mozilla-mobile/firefox-ios/blob/main/Client/Coordinators/Router/RouteBuilder.swift#L53>

I'm a bit stumped there because "search" is too common to search for. Is that our function or part of the webview API? Is "search" the same function as would be called when you type into the address bar? That would be problematic because there's nothing passed in letting it know this particular search came from OUTSIDE the app vs. a user typing it in which we can trust more not to be malicious. If "search" is a webkit function then we've got to strip "javascript:" URLs (and a lot more bad stuff potentially) before we call it. If it's ours then that's likely where we want to limit scheme usage.

> On the UX perspective, I wonder what should happen, should we just block that navigation and stay on the tab we were before this happen (for example, homepage)?

If this URL is coming from some external app then most likely we don't even have focus. Does the OS raise us to the top when it hands us a URL, or do we do that ourselves? Ideally if we get "bad input" from outside we could just ignore it and do nothing. That is, stay on the page we were on (or the Homepage if we were closed?). But If the user clicks on a link in some app and then the OS raises up Firefox, the user is going to wonder what happened to the thing they clicked on. We might need to put up a message saying it was an invalid URL ("Could not open javascript://blah blah" -- but be careful rendering that so we don't introduce an XSS bug).

> I also wonder if there are other schemes that could be taken advantage of with those same steps?

I'm sure there are, or if not now someone will invent them later. That's why I keep stressing we need to implement an allow-list of schemes we're willing to handle from external sources. Which means the decision needs to be made at some point where we know the difference between external input, a user-typed address, and a web navigation.

http: and https: are safe. data: is potentially spoofy, but otherwise safe. Do other apps need to have us open local file links (like, some other app downloads a PDF and we register as the PDF handler or something like that)? If so we might need to include "file:" on the "Good" list. That might be about all we should accept.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1850158#c7)• 1 year ago |
|  | |

The severity field is not set for this bug.

:jeevans, could you have a look please?

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#workflow.2Fno_severity.py).

Flags: needinfo?(jeevans)

|  | [Muneaki Nishimura](/user_profile?user_id=507051)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1850158#c8)• 1 year ago |
|  | |

It seems this bug has not been progressed for two months since it was reported. Is there anything I can help with? Also, as far as I looked at security bugs I reported, e.g., [Bug 1861405](/show_bug.cgi?id=1861405 "VERIFIED FIXED - Privilege escalation in Firefox for iOS through <a [referrerpolicy]> in ReaderMode") or [Bug 1861420](/show_bug.cgi?id=1861420 "VERIFIED FIXED - HTML injection in %READER-BYLINE% of ReaderMode of Firefox for iOS"), bugs in iOS are not handled by anybody. For example, should I create an issue on GitHub as well for the reference to the Bugzilla?

Flags: needinfo?(lmarceau)Flags: needinfo?(dveditz)

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1850158#c9)• 1 year ago |
|  | |

Hello Muneaki, you're right there hasn't been any progress on those. The team has limited capacity, and although this isn't a good reason not to be working on those, this is the only one I can give. I will bring this up the chain, so we can find time as a team to fix those tickets, as some in here are at least sec-moderate which means important to give them a higher priority. As for GitHub, it's preferable not to open security tickets over there as it's public. Thank you for your understanding, and thank you for having the security of Firefox for iOS at heart!

Flags: needinfo?(lmarceau)Flags: needinfo?(jeevans)Flags: needinfo?(dveditz)

|  | [Muneaki Nishimura](/user_profile?user_id=507051)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1850158#c10)• 1 year ago |
|  | |

The cause of this bug seems to be that URL scheme given from outside is not checked in the following source code.

<https://github.com/mozilla-mobile/firefox-ios/blob/main/Client/Coordinators/Router/RouteBuilder.swift#L54>

For example, it looks like this can be prevented by changing this line as follows.

```
return .search(url: ["http", "https"].contains(urlQuery?.scheme?.lowercased()) ? urlQuery : nil, isPrivate: isPrivate)

```

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1850158#c11)• 1 year ago |
|  | |

Thanks Muneaki, you're right we should check the scheme when opening links from deeplinking sources. I'll take a look into improving this area, this is a great suggestion thank you!

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a6911461_694570)• 1 year ago |

See Also: → [CVE-2024-1563](/show_bug.cgi?id=1863831 "RESOLVED FIXED - Full UXSS via opening Firefox Focus externally after silent background navigation")

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a8981830_694570)• 1 year ago |

See Also: → [CVE-2024-26281](/show_bug.cgi?id=1868005 "RESOLVED FIXED - iOS Firefox QR Code Scanner allows to run firefox URI with javascript URI for related exploit")

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a8989349_694570)• 1 year ago |

See Also: → [1868002](/show_bug.cgi?id=1868002 "RESOLVED DUPLICATE - Firefox URI can run javascript URI on iOS Firefox")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a9526572_1689)• 1 year ago |

Blocks: [CVE-2024-26281](/show_bug.cgi?id=1868005 "RESOLVED FIXED - iOS Firefox QR Code Scanner allows to run firefox URI with javascript URI for related exploit")

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1850158#c12)• 1 year ago |
|  | |

Attached file
[GitHub Pull Request](attachment.cgi?id=9369700)
— [Details](attachment.cgi?id=9369700&action=edit)

Assignee: nobody → lmarceau

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a10129567_1689)• 1 year ago |

Blocks: [1870384](/show_bug.cgi?id=1870384 "RESOLVED DUPLICATE - firefox URI for iOS Firefox allows to load file URI")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a10130180_1689)• 1 year ago |

Blocks: [1870308](/show_bug.cgi?id=1870308 "RESOLVED FIXED - iOS Firefox can open file: URLs through QR Code Scanning")See Also: → [1870308](/show_bug.cgi?id=1870308 "RESOLVED FIXED - iOS Firefox can open file: URLs through QR Code Scanning")

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a12010788_694570)• 1 year ago |

Group: mobile-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 1 year agoResolution: --- → FIXEDSee Also: → <https://github.com/mozilla-mobile/firefox-ios/pull/17827>

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a12011100_694570)• 1 year ago |

Duplicate of this bug: [1868002](/show_bug.cgi?id=1868002 "RESOLVED DUPLICATE - Firefox URI can run javascript URI on iOS Firefox")

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a12011209_694570)• 1 year ago |

Duplicate of this bug: [1868003](/show_bug.cgi?id=1868003 "UNCONFIRMED")

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a12025246_694570)• 1 year ago |

Duplicate of this bug: [1870384](/show_bug.cgi?id=1870384 "RESOLVED DUPLICATE - firefox URI for iOS Firefox allows to load file URI")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a12065768_1689)• 1 year ago |

No longer blocks: [1870308](/show_bug.cgi?id=1870308 "RESOLVED FIXED - iOS Firefox can open file: URLs through QR Code Scanning")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a12071902_1689)• 1 year ago |

See Also: → <https://mozilla-hub.atlassian.net/browse/FXIOS-7331>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a12450091_1689)• 1 year ago |

Flags: sec-bounty? → sec-bounty+

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a12450952_694570)• 1 year ago |

[tracking-fxios](/buglist.cgi?f1=cf_tracking_fxios&o1=isnotempty):
--- → [123](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=123)

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1850158#c16)• 11 months ago |
|  | |

Verified as fixed on v123 (38400) with iPhone 15 Pro (17.1.2).

Please note that I did the following steps:

* Opened Firefox and added to the background.
* Opened Safari and accessed `https://csrf.jp/2023/fxios-url-spoof.php`.
* Tap on the `Tap here` button from the above link.
* Open in Firefox? Prompt is displayed
* Tap on Open
* Firefox is in the foreground (resumed) but no webpage or anything related to `"google.com/search?q=foo...".` opened/displayed and there is no `Hacked!` text displayed.
* Here is a video text. [Video](https://drive.google.com/file/d/1F98AP5JFMnB2GlxLBnDtSE4vROM5v0qU/view?usp=sharing)

Muneaki Nishimura if you can please confirm that this is the behavior we want to see I would appreciate it.

Status: RESOLVED → VERIFIEDFlags: needinfo?(sdna.muneaki.nishimura)

|  | [Muneaki Nishimura](/user_profile?user_id=507051)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1850158#c17)• 11 months ago |
|  | |

Thanks for your confirmation. The behavior described above is as expected. I have also confirmed that it is fixed in the master branch.

Flags: needinfo?(sdna.muneaki.nishimura)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a15042257_578488)• 11 months ago |

Alias: CVE-2024-26283

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1850158#c18)• 11 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9381065)
— [Details](attachment.cgi?id=9381065&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a16858169_1689)• 10 months ago |

No longer duplicate of this bug: [1868003](/show_bug.cgi?id=1868003 "UNCONFIRMED")

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a24109807_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1850158#a40179232_1689)• 1 month ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1850158&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Muneaki Nishimura](/user_profile?user_id=507051)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

