- **Root cause of vulnerability**: The `create_private_key` function in `liburvpn.so` constructs a command using `snprintf` and executes it with `system()`. The serial number (`sn`) of the device, received from the `/Device_Auth` API, is used to construct the output path for the openssl command, without proper sanitization, leading to command injection.
- **Weaknesses/vulnerabilities present**: OS Command Injection (CWE-77), specifically in the `create_private_key` function of `liburvpn.so`. The `sn` parameter is not validated and directly used in the command execution, allowing attacker to inject arbitrary commands through the `sn` parameter of the /Device_Auth API.
- **Impact of exploitation**: Successful exploitation allows arbitrary OS command execution on the MilesightVPN server. This could lead to a complete compromise of the server, allowing the attacker to gain access to sensitive data, disrupt services, or launch further attacks on the network.
- **Attack vectors**: The attack vector is a specially crafted network request to the `/Device_Auth` API of the MilesightVPN server. The attacker sends a POST request with a malicious `sn` parameter.
- **Required attacker capabilities/position**: The attacker needs to be able to send requests to the `/Device_Auth` API and know a valid authorization code, which can be obtained using TALOS-2023-1702.