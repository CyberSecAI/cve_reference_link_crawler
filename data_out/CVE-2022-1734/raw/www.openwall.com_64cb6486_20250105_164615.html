<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - Re: Linux kernel: UAF, null-ptr-deref and double-free
 vulnerabilities in nfcmrvl module</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://hashsuite.openwall.net">
Hash Suite - Windows password security audit tool. GUI, reports in PDF.</a>

</TABLE>
</TABLE>

<a href="../../../2022/06/08/10">[&lt;prev]</a> <a href="2">[next&gt;]</a> <a href="../../../2022/06/05/4">[&lt;thread-prev]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;2e6e5ea6.5c563.181465dd210.Coremail.duoming&#64;zju.edu.cn&gt;
Date: Thu, 9 Jun 2022 10:49:22 +0800 (GMT+08:00)
From: duoming&#64;....edu.cn
To: oss-security&#64;...ts.openwall.com
Cc: solar&#64;...nwall.com
Subject: Re: Linux kernel: UAF, null-ptr-deref and double-free
 vulnerabilities in nfcmrvl module

Hello,

The cve-2022-1734 was assigned to this problem. 

&gt; Hello there,
&gt; 
&gt; There are double-free, use-after-free(write,read), null-ptr-deref vulnerabilities
&gt; in drivers/nfc/nfcmrvl of linux that allow attacker to crash linux kernel by simulating
&gt; nfc device from user-space.
&gt; 
&gt; =*=*=*=*=*=*=*=*=  Bug Details  =*=*=*=*=*=*=*=*=
&gt; 
&gt; There are destructive operations such as nfcmrvl_fw_dnld_abort and
&gt; gpio_free in nfcmrvl_nci_unregister_dev. The resources such as firmware,
&gt; gpio and so on could be destructed while the upper layer functions such as
&gt; nfcmrvl_fw_dnld_start and nfcmrvl_nci_recv_frame is executing, which leads
&gt; to double-free, use-after-free and null-ptr-deref bugs.
&gt; 
&gt; There are three situations that could lead to double-free bugs.
&gt; 
&gt; The first situation is shown below:
&gt; 
&gt;    (Thread 1)                 |      (Thread 2)
&gt; nfcmrvl_fw_dnld_start         |
&gt;  ...                          |  nfcmrvl_nci_unregister_dev
&gt;  release_firmware()           |   nfcmrvl_fw_dnld_abort
&gt;   kfree(fw) //(1)             |    fw_dnld_over
&gt;                               |     release_firmware
&gt;   ...                         |      kfree(fw) //(2)
&gt;                               |     ...
&gt; 
&gt; The second situation is shown below:
&gt; 
&gt;    (Thread 1)                 |      (Thread 2)
&gt; nfcmrvl_fw_dnld_start         |
&gt;  ...                          |
&gt;  mod_timer                    |
&gt;  (wait a time)                |
&gt;  fw_dnld_timeout              |  nfcmrvl_nci_unregister_dev
&gt;    fw_dnld_over               |   nfcmrvl_fw_dnld_abort
&gt;     release_firmware          |    fw_dnld_over
&gt;      kfree(fw) //(1)          |     release_firmware
&gt;      ...                      |      kfree(fw) //(2)
&gt; 
&gt; The third situation is shown below:
&gt; 
&gt;        (Thread 1)               |       (Thread 2)
&gt; nfcmrvl_nci_recv_frame          |
&gt;  if(..-&gt;fw_download_in_progress)|
&gt;   nfcmrvl_fw_dnld_recv_frame    |
&gt;    queue_work                   |
&gt;                                 |
&gt; fw_dnld_rx_work                 | nfcmrvl_nci_unregister_dev
&gt;  fw_dnld_over                   |  nfcmrvl_fw_dnld_abort
&gt;   release_firmware              |   fw_dnld_over
&gt;    kfree(fw) //(1)              |    release_firmware
&gt;                                 |     kfree(fw) //(2)
&gt; 
&gt; The firmware struct is deallocated in position (1) and deallocated
&gt; in position (2) again.
&gt; 
&gt; What's more, there are also use-after-free and null-ptr-deref bugs
&gt; in nfcmrvl_fw_dnld_start. 
&gt; 
&gt; One of the use-after-free bugs about firmware is shown below:
&gt; 
&gt;    (Use Thread)               |      (Free Thread )
&gt; nfcmrvl_fw_dnld_start         |
&gt;                               |  nfcmrvl_nci_unregister_dev
&gt;                               |   nfcmrvl_fw_dnld_abort
&gt;   ...                         |    fw_dnld_over
&gt;                               |     release_firmware
&gt;                               |      kfree(fw) //(1)
&gt;   priv-&gt;fw_dnld.fw-&gt;data;//(2)|     ...
&gt; 
&gt; One of the use-after-free bugs about gpio is shown below:
&gt; 
&gt;    (Use Thread)               |      (Free Thread )
&gt; nfcmrvl_fw_dnld_start         |
&gt;                               |  nfcmrvl_nci_unregister_dev
&gt;   ...                         |   ...
&gt;                               |   gpio_free //(1)   
&gt;   nfcmrvl_chip_reset          |     ...
&gt;    gpio_set_value //(2)       |
&gt; 
&gt; One of the null-ptr-deref bugs about firmware is shown below:
&gt; 
&gt;    (Use Thread)               |      (Free Thread )
&gt; nfcmrvl_fw_dnld_start         |
&gt;                               |  nfcmrvl_nci_unregister_dev
&gt;                               |   nfcmrvl_fw_dnld_abort
&gt;   ...                         |    fw_dnld_over
&gt;                               |     priv-&gt;fw_dnld.fw = NULL;//(1) 
&gt;                               |     
&gt;   priv-&gt;fw_dnld.fw-&gt;data;//(2)|     ...
&gt; 
&gt; If we deallocate firmware struct, gpio or set null to the members of priv-&gt;fw_dnld
&gt; in position(1), then, we dereference firmware, gpio or the members of priv-&gt;fw_dnld
&gt; in position(2), the UAF or NPD bugs will happen.
&gt; 
&gt; =*=*=*=*=*=*=*=*=  Bug Effects  =*=*=*=*=*=*=*=*=
&gt; 
&gt; We can successfully trigger the vulnerabilities to crash the linux kernel.
&gt; 
&gt; (1) One of the backtraces caused by use-after-free(write) bug is shown below.
&gt; 
&gt; [  138.280382] BUG: KASAN: use-after-free in _request_firmware+0x52/0x690
&gt; [  138.280382] Write of size 8 at addr ffff88800c114850 by task download/11174
&gt; [  138.280382] Call Trace:
&gt; [  138.280382]  &lt;TASK&gt;
&gt; [  138.280382]  dump_stack_lvl+0x57/0x7d
&gt; [  138.280382]  print_report.cold+0x5e/0x5db
&gt; [  138.280382]  ? _request_firmware+0x52/0x690
&gt; [  138.280382]  kasan_report+0xbe/0x1c0
&gt; [  138.280382]  ? _request_firmware+0x52/0x690
&gt; [  138.280382]  _request_firmware+0x52/0x690
&gt; [  138.280382]  request_firmware+0x2d/0x50
&gt; [  138.280382]  nfcmrvl_fw_dnld_start+0x7a/0xb0
&gt; [  138.280382]  nfc_fw_download+0x92/0xe0
&gt; [  138.280382]  nfc_genl_fw_download+0x10b/0x170
&gt; [  138.280382]  ? nfc_genl_enable_se+0xa0/0xa0
&gt; [  138.280382]  ? __kasan_slab_alloc+0x2c/0x80
&gt; [  138.280382]  ? __nla_parse+0x22/0x30
&gt; [  138.280382]  ? genl_family_rcv_msg_attrs_parse.constprop.0+0xd3/0x130
&gt; [  138.280382]  genl_family_rcv_msg_doit+0x17a/0x200
&gt; [  138.280382]  ? genl_family_rcv_msg_attrs_parse.constprop.0+0x130/0x130
&gt; [  138.280382]  ? mutex_lock_io_nested+0xb63/0xbd0
&gt; [  138.280382]  ? security_capable+0x48/0x60
&gt; [  138.280382]  genl_rcv_msg+0x18d/0x2c0
&gt; [  138.280382]  ? genl_get_cmd+0x1b0/0x1b0
&gt; [  138.280382]  ? rcu_read_lock_sched_held+0xd/0x70
&gt; [  138.280382]  ? nfc_genl_enable_se+0xa0/0xa0
&gt; [  138.280382]  ? rcu_read_lock_sched_held+0xd/0x70
&gt; [  138.280382]  ? lock_acquire+0xce/0x410
&gt; [  138.280382]  netlink_rcv_skb+0xc4/0x1f0
&gt; [  138.280382]  ? genl_get_cmd+0x1b0/0x1b0
&gt; [  138.280382]  ? netlink_ack+0x4d0/0x4d0
&gt; [  138.280382]  ? netlink_deliver_tap+0xf7/0x5a0
&gt; [  138.280382]  genl_rcv+0x1f/0x30
&gt; [  138.280382]  netlink_unicast+0x2d8/0x420
&gt; [  138.280382]  ? netlink_attachskb+0x430/0x430
&gt; [  138.280382]  netlink_sendmsg+0x3a9/0x6e0
&gt; [  138.280382]  ? netlink_unicast+0x420/0x420
&gt; [  138.280382]  ? netlink_unicast+0x420/0x420
&gt; [  138.280382]  sock_sendmsg+0x91/0xa0
&gt; [  138.280382]  __sys_sendto+0x168/0x200
&gt; [  138.280382]  ? __ia32_sys_getpeername+0x40/0x40
&gt; [  138.280382]  ? preempt_count_sub+0xf/0xb0
&gt; [  138.280382]  ? fd_install+0xfb/0x340
&gt; [  138.280382]  ? __sys_socket+0xf0/0x160
&gt; [  138.280382]  ? __x64_sys_clock_nanosleep+0x195/0x220
&gt; [  138.280382]  ? compat_sock_ioctl+0x410/0x410
&gt; [  138.280382]  __x64_sys_sendto+0x6f/0x80
&gt; [  138.280382]  do_syscall_64+0x3b/0x90
&gt; [  138.280382]  entry_SYSCALL_64_after_hwframe+0x44/0xae
&gt; [  138.280382] RIP: 0033:0x7ff12ac0602c
&gt; [  138.280382] Code: 0a f8 ff ff 44 8b 4c 24 2c 4c 8b 44 24 20 89 c5 44 8b 54 2b
&gt; [  138.280382] RSP: 002b:00007ff12aa1ee00 EFLAGS: 00000293 ORIG_RAX: 0000000000c
&gt; [  138.280382] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007ff12ac0602c
&gt; [  138.280382] RDX: 000000000000002c RSI: 000055eab88030b0 RDI: 0000000000000000
&gt; [  138.280382] RBP: 0000000000000000 R08: 00007ff12aa1ee7c R09: 000000000000000c
&gt; [  138.280382] R10: 0000000000000000 R11: 0000000000000293 R12: 00007ffca74ba00e
&gt; [  138.280382] R13: 00007ffca74ba00f R14: 00007ff12aa1efc0 R15: 00007ff12aa1f700
&gt; 
&gt; (2) One of the backtraces caused by use-after-free(read) bug is shown below.
&gt; 
&gt; [   65.835462] BUG: KASAN: use-after-free in nci_fw_download+0x26/0x60
&gt; [   65.840236] Read of size 8 at addr ffff88800c2f5008 by task download/160
&gt; [   65.845755] Call Trace:
&gt; [   65.845755]  &lt;TASK&gt;
&gt; [   65.845755]  dump_stack_lvl+0x57/0x7d
&gt; [   65.845755]  print_report.cold+0x5e/0x5db
&gt; [   65.845755]  ? nci_fw_download+0x26/0x60
&gt; [   65.845755]  kasan_report+0xbe/0x1c0
&gt; [   65.856061]  ? nfc_driver_failure+0x90/0xa0
&gt; [   65.856235]  ? nci_fw_download+0x26/0x60
&gt; [   65.856235]  nci_fw_download+0x26/0x60
&gt; [   65.856235]  nfc_fw_download+0x99/0xe0
&gt; [   65.856235]  nfc_genl_fw_download+0x10b/0x170
&gt; [   65.861189]  ? nfc_genl_enable_se+0xa0/0xa0
&gt; [   65.861189]  ? __kasan_slab_alloc+0x2c/0x80
&gt; [   65.861189]  ? __nla_parse+0x22/0x30
&gt; [   65.865988]  ? genl_family_rcv_msg_attrs_parse.constprop.0+0xd3/0x130
&gt; [   65.865988]  genl_family_rcv_msg_doit+0x17a/0x200
&gt; [   65.865988]  ? genl_family_rcv_msg_attrs_parse.constprop.0+0x130/0x130
&gt; [   65.870892]  ? asm_spurious_interrupt+0x3/0x30
&gt; [   65.870892]  ? security_capable+0x48/0x60
&gt; [   65.870892]  genl_rcv_msg+0x18d/0x2c0
&gt; [   65.870892]  ? genl_get_cmd+0x1b0/0x1b0
&gt; [   65.870892]  ? rcu_read_lock_sched_held+0xd/0x70
&gt; [   65.875946]  ? nfc_genl_enable_se+0xa0/0xa0
&gt; [   65.875946]  ? rcu_read_lock_sched_held+0xd/0x70
&gt; [   65.875946]  ? lock_acquire+0xce/0x410
&gt; [   65.875946]  netlink_rcv_skb+0xc4/0x1f0
&gt; [   65.880842]  ? genl_get_cmd+0x1b0/0x1b0
&gt; [   65.881778]  ? netlink_ack+0x4d0/0x4d0
&gt; [   65.881778]  ? netlink_deliver_tap+0xf7/0x5a0
&gt; [   65.881778]  genl_rcv+0x1f/0x30
&gt; [   65.881778]  netlink_unicast+0x2d8/0x420
&gt; [   65.885734]  ? netlink_attachskb+0x430/0x430
&gt; [   65.887472]  netlink_sendmsg+0x3a9/0x6e0
&gt; [   65.887472]  ? netlink_unicast+0x420/0x420
&gt; [   65.887472]  ? netlink_unicast+0x420/0x420
&gt; [   65.887472]  sock_sendmsg+0x91/0xa0
&gt; [   65.891949]  __sys_sendto+0x168/0x200
&gt; [   65.893134]  ? __ia32_sys_getpeername+0x40/0x40
&gt; [   65.893134]  ? lockdep_hardirqs_on_prepare+0xe/0x220
&gt; [   65.893134]  ? __schedule+0x5c5/0x1180
&gt; [   65.893134]  ? io_schedule_timeout+0xb0/0xb0
&gt; [   65.897936]  ? clockevents_program_event+0xd3/0x130
&gt; [   65.897936]  ? hrtimer_interrupt+0x332/0x350
&gt; [   65.897936]  __x64_sys_sendto+0x6f/0x80
&gt; [   65.897936]  do_syscall_64+0x3b/0x90
&gt; [   65.897936]  entry_SYSCALL_64_after_hwframe+0x44/0xae
&gt; [   65.902930] RIP: 0033:0x7f96173ec02c
&gt; [   65.902930] Code: 0a f8 ff ff 44 8b 4c 24 2c 4c 8b 44 24 20 89 c5 44 8b 54 24 28 48 8b 54 24 18 b8 2c 00 00 00 48 8b 74 24 10 8b 7c 24 08 0f 05 &lt;48&gt; 3d 00 fb
&gt; [   65.908959] RSP: 002b:00007f9617204df0 EFLAGS: 00000293 ORIG_RAX: 000000000000002c
&gt; [   65.908959] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007f96173ec02c
&gt; [   65.908959] RDX: 0000000000000034 RSI: 0000556fa2a030b0 RDI: 0000000000000003
&gt; [   65.908959] RBP: 0000000000000000 R08: 00007f9617204e6c R09: 000000000000000c
&gt; [   65.915542] R10: 0000000000000000 R11: 0000000000000293 R12: 00007ffde78477ee
&gt; [   65.916990] R13: 00007ffde78477ef R14: 00007f9617204fc0 R15: 00007f9617205700
&gt; 
&gt; (3) One of the backtraces caused by double-free bug is shown below.
&gt; 
&gt; [  122.640457] BUG: KASAN: double-free or invalid-free in fw_dnld_over+0x28/0xf0
&gt; [  122.640457] Call Trace:
&gt; [  122.640457]  &lt;TASK&gt;
&gt; [  122.640457]  dump_stack_lvl+0x57/0x7d
&gt; [  122.640457]  print_report.cold+0x5e/0x5db
&gt; [  122.640457]  ? fw_dnld_over+0x28/0xf0
&gt; [  122.640457]  ? fw_dnld_over+0x28/0xf0
&gt; [  1re22.640457]  kasan_report_invalid_free+0x90/0x180
&gt; [  122.640457]  ? refcount_warn_saturate+0x40/0x110
&gt; [  122.640457]  ? fw_dnld_over+0x28/0xf0
&gt; [  122.640457]  __kasan_slab_free+0x152/0x170
&gt; [  122.640457]  ? fw_dnld_over+0x28/0xf0
&gt; [  122.640457]  kfree+0xb0/0x330
&gt; [  122.640457]  fw_dnld_over+0x28/0xf0
&gt; [  122.640457]  nfcmrvl_nci_unregister_dev+0x61/0x70
&gt; [  122.640457]  nci_uart_tty_close+0x87/0xd0
&gt; [  122.640457]  tty_ldisc_kill+0x3e/0x80
&gt; [  122.640457]  tty_ldisc_hangup+0x1b2/0x2c0
&gt; [  122.640457]  __tty_hangup.part.0+0x316/0x520
&gt; [  122.640457]  tty_release+0x200/0x670
&gt; [  122.640457]  __fput+0x110/0x410
&gt; [  122.640457]  ? _raw_spin_unlock_irq+0x1f/0x40
&gt; [  122.640457]  task_work_run+0x86/0xd0
&gt; [  122.640457]  exit_to_user_mode_prepare+0x1aa/0x1b0
&gt; [  122.640457]  syscall_exit_to_user_mode+0x19/0x50
&gt; [  122.640457]  do_syscall_64+0x48/0x90
&gt; [  122.640457]  entry_SYSCALL_64_after_hwframe+0x44/0xae
&gt; [  122.640457] RIP: 0033:0x7f68433f6beb
&gt; [  122.640457] Code: 0f 05 48 3d 00 f0 ff ff 77 45 c3 0f 1f 40 00 48 83 ec 18 84
&gt; [  122.640457] RSP: 002b:00007f684320fee0 EFLAGS: 00000293 ORIG_RAX: 00000000003
&gt; [  122.640457] RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f68433f6beb
&gt; [  122.640457] RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000003
&gt; [  122.640457] RBP: 00007f684320ff00 R08: 0000000000000000 R09: 00007f6843210700
&gt; [  122.640457] R10: 0000000000000000 R11: 0000000000000293 R12: 00007ffd5d6f9fde
&gt; [  122.640457] R13: 00007ffd5d6f9fdf R14: 00007f684320ffc0 R15: 00007f6843210700
&gt; 
&gt; (4) One of the backtraces caused by null-ptr-deref bug is shown below.
&gt; 
&gt; [   80.495478] BUG: KASAN: null-ptr-deref in nfcmrvl_fw_dnld_start.cold+0x19/0x276
&gt; [   80.498745] Read of size 8 at addr 0000000000000008 by task download/161
&gt; [   80.502308] Call Trace:
&gt; [   80.502308]  &lt;TASK&gt;
&gt; [   80.502308]  dump_stack_lvl+0x57/0x7d
&gt; [   80.502308]  kasan_report+0xbe/0x1c0
&gt; [   80.502308]  ? nfcmrvl_fw_dnld_start.cold+0x19/0x276
&gt; [   80.502308]  nfcmrvl_fw_dnld_start.cold+0x19/0x276
&gt; [   80.508210]  ? nfc_fw_download+0x79/0xe0
&gt; [   80.508210]  nfc_fw_download+0x99/0xe0
&gt; [   80.508210]  nfc_genl_fw_download+0x10b/0x170
&gt; [   80.508210]  ? nfc_genl_enable_se+0xa0/0xa0
&gt; [   80.508210]  ? __kasan_slab_alloc+0x2c/0x80
&gt; [   80.508210]  ? __nla_parse+0x22/0x30
&gt; [   80.508210]  ? genl_family_rcv_msg_attrs_parse.constprop.0+0xd3/0x130
&gt; [   80.508210]  genl_family_rcv_msg_doit+0x17a/0x200
&gt; [   80.508210]  ? genl_family_rcv_msg_attrs_parse.constprop.0+0x130/0x130
&gt; [   80.513085]  ? mutex_lock_io_nested+0xb43/0xbd0
&gt; [   80.513085]  ? security_capable+0x48/0x60
&gt; [   80.513085]  genl_rcv_msg+0x18d/0x2c0
&gt; [   80.513085]  ? genl_get_cmd+0x1b0/0x1b0
&gt; [   80.513085]  ? rcu_read_lock_sched_held+0xd/0x70
&gt; [   80.513085]  ? nfc_genl_enable_se+0xa0/0xa0
&gt; [   80.513085]  ? rcu_read_lock_sched_held+0xd/0x70
&gt; [   80.513085]  ? lock_acquire+0xce/0x410
&gt; [   80.513085]  netlink_rcv_skb+0xc4/0x1f0
&gt; [   80.513085]  ? genl_get_cmd+0x1b0/0x1b0
&gt; [   80.518420]  ? netlink_ack+0x4d0/0x4d0
&gt; [   80.518420]  ? netlink_deliver_tap+0xf7/0x5a0
&gt; [   80.518420]  genl_rcv+0x1f/0x30
&gt; [   80.518420]  netlink_unicast+0x2d8/0x420
&gt; [   80.518420]  ? netlink_attachskb+0x430/0x430
&gt; [   80.518420]  netlink_sendmsg+0x3a9/0x6e0
&gt; [   80.518420]  ? netlink_unicast+0x420/0x420
&gt; [   80.518420]  ? netlink_unicast+0x420/0x420
&gt; [   80.518420]  sock_sendmsg+0x91/0xa0
&gt; [   80.518420]  __sys_sendto+0x168/0x200
&gt; [   80.523005]  ? __ia32_sys_getpeername+0x40/0x40
&gt; [   80.523005]  ? preempt_count_sub+0xf/0xb0
&gt; [   80.523005]  ? fd_install+0xfb/0x340
&gt; [   80.523005]  ? __sys_socket+0xf0/0x160
&gt; [   80.523005]  ? compat_sock_ioctl+0x410/0x410
&gt; [   80.523005]  __x64_sys_sendto+0x6f/0x80
&gt; [   80.523005]  do_syscall_64+0x3b/0x90
&gt; [   80.523005]  entry_SYSCALL_64_after_hwframe+0x44/0xae
&gt; [   80.523005] RIP: 0033:0x7f30f54f402c
&gt; [   80.523005] Code: 0a f8 ff ff 44 8b 4c 24 2c 4c 8b 44 24 20 89 c5 44 8b 54 24 28 48 8b 54 24 18 b8 2b
&gt; [   80.528021] RSP: 002b:00007f30f530cdf0 EFLAGS: 00000293 ORIG_RAX: 000000000000002c
&gt; [   80.528021] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007f30f54f402c
&gt; [   80.528021] RDX: 0000000000000034 RSI: 00005571766030b0 RDI: 0000000000000005
&gt; [   80.533650] RBP: 0000000000000000 R08: 00007f30f530ce6c R09: 000000000000000c
&gt; [   80.533650] R10: 0000000000000000 R11: 0000000000000293 R12: 00007ffd9c6c6cee
&gt; [   80.533650] R13: 00007ffd9c6c6cef R14: 00007f30f530cfc0 R15: 00007f30f530d700
&gt; 
&gt; =*=*=*=*=*=*=*=*=  Bug Fix  =*=*=*=*=*=*=*=*=
&gt; 
&gt; The patch that have been applied to mainline Linux kernel is shown below.
&gt; <a href="https://github.com/torvalds/linux/commit/d270453a0d9ec10bb8a802a142fb1b3601a83098" rel="nofollow">https://github.com/torvalds/linux/commit/d270453a0d9ec10bb8a802a142fb1b3601a83098</a>
&gt; 
&gt; =*=*=*=*=*=*=*=*=  Timeline  =*=*=*=*=*=*=*=*=
&gt; 
&gt; 2022-05-01: commit d270453a0d9e accepted to mainline kernel
&gt; 2022-06-05: send an email to secalert&#64;...hat.com in order to request CVE number
&gt; 
&gt; =*=*=*=*=*=*=*=*=  Credit  =*=*=*=*=*=*=*=*=
&gt; 
&gt; Duoming Zhou &lt;duoming&#64;....edu.cn&gt;

Best Regards,
Duoming Zhou
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
