
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fally-petitt%2FCVE-2024-27630)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fally-petitt%2FCVE-2024-27630)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=ally-petitt%2FCVE-2024-27630)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ally-petitt](/ally-petitt)
/
**[CVE-2024-27630](/ally-petitt/CVE-2024-27630)**
Public

* [Notifications](/login?return_to=%2Fally-petitt%2FCVE-2024-27630) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fally-petitt%2FCVE-2024-27630)
* [Star
   1](/login?return_to=%2Fally-petitt%2FCVE-2024-27630)

CVE-2024–27630 Reference

[1
star](/ally-petitt/CVE-2024-27630/stargazers) [0
forks](/ally-petitt/CVE-2024-27630/forks) [Branches](/ally-petitt/CVE-2024-27630/branches) [Tags](/ally-petitt/CVE-2024-27630/tags) [Activity](/ally-petitt/CVE-2024-27630/activity)
 [Star](/login?return_to=%2Fally-petitt%2FCVE-2024-27630)

 [Notifications](/login?return_to=%2Fally-petitt%2FCVE-2024-27630) You must be signed in to change notification settings

* [Code](/ally-petitt/CVE-2024-27630)
* [Issues
  0](/ally-petitt/CVE-2024-27630/issues)
* [Pull requests
  0](/ally-petitt/CVE-2024-27630/pulls)
* [Actions](/ally-petitt/CVE-2024-27630/actions)
* [Projects
  0](/ally-petitt/CVE-2024-27630/projects)
* [Security](/ally-petitt/CVE-2024-27630/security)
* [Insights](/ally-petitt/CVE-2024-27630/pulse)

Additional navigation options

* [Code](/ally-petitt/CVE-2024-27630)
* [Issues](/ally-petitt/CVE-2024-27630/issues)
* [Pull requests](/ally-petitt/CVE-2024-27630/pulls)
* [Actions](/ally-petitt/CVE-2024-27630/actions)
* [Projects](/ally-petitt/CVE-2024-27630/projects)
* [Security](/ally-petitt/CVE-2024-27630/security)
* [Insights](/ally-petitt/CVE-2024-27630/pulse)

# ally-petitt/CVE-2024-27630

    main[Branches](/ally-petitt/CVE-2024-27630/branches)[Tags](/ally-petitt/CVE-2024-27630/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[2 Commits](/ally-petitt/CVE-2024-27630/commits/main/) | | |
| [README.md](/ally-petitt/CVE-2024-27630/blob/main/README.md "README.md") | | [README.md](/ally-petitt/CVE-2024-27630/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2024–27630 Vulnerability Details

## Overview

In Savane v3.12 and prior, a lack of validation on the `file_id` parameter when deleting a file from `/bugs/index.php` leads to an Insecure Direct Object Reference (IDOR) vulnerability that can cause an authenticated administrator of a group with a bug tracker to arbitrarily delete file attachments of any bug tracker, leading to a lack of availability of these files. Since the file IDs increment with each new upload, it is possible to create a script that iteratively deletes all file attachments on the server by `file_id`.

**CWE Classification:** CWE-639: Authorization Bypass Through User-Controlled Key

**Reported By:** Ally Petitt

**Affected Product**: Savane

**Affected Versions**: 3.12 and prior

## Technical Details

The function responsible for deleting file attachments on bug trackers is `trackers_data_delete_file()`, which is defined in the code block below.

*frontend/php/include/trackers/data.php:2417*

```
function trackers_data_delete_file ($group_id, $item_id, $file_id)
{
  global $sys_trackers_attachments_dir;
  # Make sure the attachment belongs to the group.
  $res = db_execute ("
    SELECT bug_id from " . ARTIFACT . " WHERE bug_id = ? AND group_id = ?",
    [$item_id, $group_id]
  );
  if (db_numrows ($res) <= 0)
    {
      # TRANSLATORS: the argument is item id (a number).
      $msg = sprintf (
        _("Item #%s doesn't belong to project"), $item_id
      );
      fb ($msg, 1);
      return;
    }

  $result = false;
  # Delete the attachment.
  if (unlink ("$sys_trackers_attachments_dir/$file_id"))
    $result = db_execute ("
      DELETE FROM trackers_file WHERE item_id = ?  AND file_id = ?",
      [$item_id, $file_id]
    );

```

The function begins with a SQL query to verify that the group that the bug ID specified in `item_id` is in the group that the attacker is a part of, known as the `$group_id`. The function fails to check whether the `file_id` is part of the group as well, meaning that as long as the `item_id` cooresponds to a valid bug in the attacker's group, the attacker can modify the `file_id` to point to any file within the upload directory `/var/lib/savane/trackers_attachments`.

Additionally, this function is only reachable for bug tracker admins.

*frontend/php/bugs/index.php:586*

```
  case 'delete_file':
    # Remove an attached file.
    if ($is_trackeradmin)
      {
        trackers_data_delete_file($group_id, $item_id, $item_file_id);

         # Unset previous settings and return to the item.
         $depends_search = $reassign_change_project_search = $add_cc
           = $input_file = $changed = $vfl = $details = null;
         include '../include/trackers_run/mod.php';
      }
    else
      exit_permission_denied ();
    break;

```

## Validation Steps

These steps demonstrate deleting one file that is unauthorized, however, note that an attacker could automate the deletion of all files by their ID since they are predictable.

1. Have an account that is an admin of a group with a bugtracker (attacker account).
2. With a separate user account (victim), upload a file attachment in a bug report to a group that the attacker is not an admin of. A sample of the subsequent upload directory is as follows where the file `40231` was uploaded by the victim:

```
root@60ae93fe131f:/var/lib/savane/trackers_attachments# ls
40226  40227  40230  40231

```

3. Visit the homepage of the group that the attacker is an admin of. Then, visit Bugs > Browse and note a valid Item ID on the leftmost column of the table. This ID will be used in the next step.
4. As the attacker, make a get request to the path /bugs/index.php?func=delete\_file&item\_id=<ATTACKER\_ITEM\_ID>&item\_file\_id=<FILE\_ID\_TO\_DELETE>.

   In my case, this looks like <http://172.17.0.2:7890/bugs/index.php?func=delete_file&item_id=50697&item_file_id=40231>.
5. Verify that the victim’s file (from a group the attacker doesn’t have privileges on) has been deleted. For example:

```
root@60ae93fe131f:/var/lib/savane/trackers_attachments# ls
40226  40227  40230

```

## Mitigation

Upgrade to Savane version 3.13 or higher. The patch can be found [here](https://git.savannah.nongnu.org/cgit/administration/savane.git/commit/?h=i18n&id=39180aea8f38425035b4d1e73819b58007ac6e83).

## About

CVE-2024–27630 Reference

### Resources

[Readme](#readme-ov-file)

[Activity](/ally-petitt/CVE-2024-27630/activity)
### Stars

[**1**
star](/ally-petitt/CVE-2024-27630/stargazers)
### Watchers

[**1**
watching](/ally-petitt/CVE-2024-27630/watchers)
### Forks

[**0**
forks](/ally-petitt/CVE-2024-27630/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fally-petitt%2FCVE-2024-27630&report=ally-petitt+%28user%29)

## [Releases](/ally-petitt/CVE-2024-27630/releases)

No releases published

## [Packages 0](/users/ally-petitt/packages?repo_name=CVE-2024-27630)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

