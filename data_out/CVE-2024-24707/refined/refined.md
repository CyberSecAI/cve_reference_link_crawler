Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The Cwicly WordPress plugin allows users with "edit\_posts" capability (Contributor role and above) to insert PHP code snippets within code blocks using the Gutenberg editor.
*   The plugin uses PHP's `eval()` function to execute these code snippets, which is a dangerous practice and opens the door to RCE.
*   A sanitization bypass exists when creating new posts that contain a Cwicly code block. This bypass is due to a logic error in how the plugin handles new posts compared to existing ones. Specifically, the `$current_blocks` variable is not initialized correctly in the new post code branch, causing sanitization to be skipped.
*  Although WordPress's `kses` filters prevent the direct injection of PHP code via post content creation, the vulnerability is exposed through the WordPress REST API's "Rendered Blocks" endpoint. This endpoint allows rendering of blocks with user-controlled attributes without proper sanitization, bypassing the `kses` filters.

**Weaknesses/Vulnerabilities:**

*   **Remote Code Execution (RCE):** The primary vulnerability is the ability to execute arbitrary PHP code on the server.
*   **Insecure Use of `eval()`:** The use of PHP's `eval()` function with user-supplied input is inherently dangerous.
*   **Sanitization Bypass:** The logic error when processing new posts allows attackers to inject malicious code through the Cwicly code block.
*   **REST API Vulnerability:** The "Rendered Blocks" endpoint bypasses sanitization and allows rendering of blocks with user-supplied attributes, facilitating RCE.
*   **Insufficient Permission Checks**: The `get_item_permissions_check` method in the REST API allows contributors or higher to render any block type, including the code block with unsanitized attributes using the 'edit_posts' capability

**Impact of Exploitation:**

*   **Complete Site Takeover:** An attacker can execute arbitrary system commands, potentially leading to full control of the WordPress site and server.
*   **Malware Injection:** Attackers can inject malware, create backdoors, deface the website, or steal sensitive information.
*   **Data Breach:** Compromised servers may lead to exposure of sensitive data.

**Attack Vectors:**

*   **Crafted REST API Request:** The primary attack vector is through a crafted request to the WordPress REST API's "Rendered Blocks" endpoint, injecting malicious PHP code into the `attributes` parameter for the `cwicly/code` block.
*   **Malicious code block in New Post**: A user with the `edit_posts` capability can create a new post with a malicious code block, bypassing the plugin's sanitation due to the error on the `$current_blocks` variable.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** The attacker must have an account on the WordPress site with at least the "Contributor" role (or equivalent capability to "edit\_posts"), or be able to steal a contributor's session cookie.
*   **Access to REST API:** The attacker needs to be able to send requests to the WordPress REST API.
*   **Knowledge of Vulnerability:** The attacker needs to understand the vulnerability details, including how to inject malicious PHP code through the Cwicly code block using the REST API.

**Additional Information**
*   The vulnerability was discovered and reported by Snicco.
*   Cwicly version 1.4.0.3 patches the issue.

This detailed analysis provides a comprehensive understanding of the RCE vulnerability in the Cwicly plugin.