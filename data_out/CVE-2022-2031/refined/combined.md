=== Content from security.gentoo.org_d0636a05_20250108_134251.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Samba: Multiple Vulnerabilities — GLSA **202309-06**

Multiple vulnerabilities have been discovered in Samba, the worst of which could result in root remote code execution.

### Affected packages

| Package | **net-fs/samba** on all architectures |
| --- | --- |
| Affected versions | < **4.18.4** |
| Unaffected versions | >= **4.18.4** |

### Background

Samba is a suite of SMB and CIFS client/server programs.

### Description

Multiple vulnerabilities have been discovered in Samba. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Samba users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-fs/samba-4.18.4"

```
### References

* [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)
* [CVE-2016-2124](https://nvd.nist.gov/vuln/detail/CVE-2016-2124)
* [CVE-2020-17049](https://nvd.nist.gov/vuln/detail/CVE-2020-17049)
* [CVE-2020-25717](https://nvd.nist.gov/vuln/detail/CVE-2020-25717)
* [CVE-2020-25718](https://nvd.nist.gov/vuln/detail/CVE-2020-25718)
* [CVE-2020-25719](https://nvd.nist.gov/vuln/detail/CVE-2020-25719)
* [CVE-2020-25721](https://nvd.nist.gov/vuln/detail/CVE-2020-25721)
* [CVE-2020-25722](https://nvd.nist.gov/vuln/detail/CVE-2020-25722)
* [CVE-2021-3670](https://nvd.nist.gov/vuln/detail/CVE-2021-3670)
* [CVE-2021-3738](https://nvd.nist.gov/vuln/detail/CVE-2021-3738)
* [CVE-2021-20251](https://nvd.nist.gov/vuln/detail/CVE-2021-20251)
* [CVE-2021-20316](https://nvd.nist.gov/vuln/detail/CVE-2021-20316)
* [CVE-2021-23192](https://nvd.nist.gov/vuln/detail/CVE-2021-23192)
* [CVE-2021-44141](https://nvd.nist.gov/vuln/detail/CVE-2021-44141)
* [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)
* [CVE-2022-0336](https://nvd.nist.gov/vuln/detail/CVE-2022-0336)
* [CVE-2022-1615](https://nvd.nist.gov/vuln/detail/CVE-2022-1615)
* [CVE-2022-2031](https://nvd.nist.gov/vuln/detail/CVE-2022-2031)
* [CVE-2022-3437](https://nvd.nist.gov/vuln/detail/CVE-2022-3437)
* [CVE-2022-3592](https://nvd.nist.gov/vuln/detail/CVE-2022-3592)
* [CVE-2022-32742](https://nvd.nist.gov/vuln/detail/CVE-2022-32742)
* [CVE-2022-32743](https://nvd.nist.gov/vuln/detail/CVE-2022-32743)
* [CVE-2022-32744](https://nvd.nist.gov/vuln/detail/CVE-2022-32744)
* [CVE-2022-32745](https://nvd.nist.gov/vuln/detail/CVE-2022-32745)
* [CVE-2022-32746](https://nvd.nist.gov/vuln/detail/CVE-2022-32746)
* [CVE-2022-37966](https://nvd.nist.gov/vuln/detail/CVE-2022-37966)
* [CVE-2022-37967](https://nvd.nist.gov/vuln/detail/CVE-2022-37967)
* [CVE-2022-38023](https://nvd.nist.gov/vuln/detail/CVE-2022-38023)
* [CVE-2022-42898](https://nvd.nist.gov/vuln/detail/CVE-2022-42898)
* [CVE-2022-45141](https://nvd.nist.gov/vuln/detail/CVE-2022-45141)
* [CVE-2023-0225](https://nvd.nist.gov/vuln/detail/CVE-2023-0225)
* [CVE-2023-0614](https://nvd.nist.gov/vuln/detail/CVE-2023-0614)
* [CVE-2023-0922](https://nvd.nist.gov/vuln/detail/CVE-2023-0922)

**Release date**

September 17, 2023

**Latest revision**

September 17, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [820566](https://bugs.gentoo.org/show_bug.cgi?id=820566)
* [821688](https://bugs.gentoo.org/show_bug.cgi?id=821688)
* [830983](https://bugs.gentoo.org/show_bug.cgi?id=830983)
* [832433](https://bugs.gentoo.org/show_bug.cgi?id=832433)
* [861512](https://bugs.gentoo.org/show_bug.cgi?id=861512)
* [866225](https://bugs.gentoo.org/show_bug.cgi?id=866225)
* [869122](https://bugs.gentoo.org/show_bug.cgi?id=869122)
* [878273](https://bugs.gentoo.org/show_bug.cgi?id=878273)
* [880437](https://bugs.gentoo.org/show_bug.cgi?id=880437)
* [886153](https://bugs.gentoo.org/show_bug.cgi?id=886153)
* [903621](https://bugs.gentoo.org/show_bug.cgi?id=903621)
* [905320](https://bugs.gentoo.org/show_bug.cgi?id=905320)
* [910334](https://bugs.gentoo.org/show_bug.cgi?id=910334)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.samba.org_b372a10a_20250108_134252.html ===

## CVE-2022-2031.html:

```

===========================================================
== Subject:     Samba AD users can bypass certain restrictions
==              associated with changing passwords.
==
== CVE ID#:     CVE-2022-2031
==
== Versions:    All versions of Samba prior to 4.16.4
==
== Summary:     The KDC and the kpasswd service share a single account
==              and set of keys, allowing them to decrypt each other's
==              tickets. A user who has been requested to change their
==              password can exploit this to obtain and use tickets to
==              other services.
===========================================================

===========
Description
===========

The KDC and the kpasswd service share a single account and set of
keys. In certain cases, this makes the two services susceptible to
confusion.

When a user's password has expired, that user is requested to change
their password. Until doing so, the user is restricted to only
acquiring tickets to kpasswd.

However, a vulnerability meant that the kpasswd's principal, when
canonicalized, was set to that of the TGS (Ticket-Granting Service),
thus yielding TGTs from ordinary kpasswd requests. These TGTs could be
used to perform an Elevation of Privilege attack by obtaining service
tickets and using services in the forest. This vulnerability existed
in versions of Samba built with Heimdal Kerberos.

A separate vulnerability in Samba versions below 4.16, and in Samba
built with MIT Kerberos, led the KDC to accept kpasswd tickets as if
they were TGTs, with the same overall outcome.

On the reverse side of the issue, password changes could be effected
by presenting TGTs as if they were kpasswd tickets. TGTs having
potentially longer lifetimes than kpasswd tickets, the value of a
stolen cache containing a TGT was hence increased to an attacker, with
the possibility of indefinite control over an account by means of a
password change.

Finally, kpasswd service tickets would be accepted for changes to
one's own password, contrary to the requirement that tickets be
acquired with an initial KDC request in such cases.

As part of the mitigations, the lifetime of kpasswd tickets has been
restricted to a maximum of two minutes. The KDC will not longer accept
TGTs with two minutes or less left to live, to make sure it does not
accept kpasswd tickets.

==================
Patch Availability
==================

Patches addressing these issues have been posted to:

    https://www.samba.org/samba/security/

Additionally, Samba 4.16.4, 4.15.9, and 4.14.14 have been issued
as security releases to correct the defect. Samba administrators are
advised to upgrade to these releases or apply the patch as soon
as possible.

==================
CVSSv3 calculation
==================

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N (5.4)

==========
Workaround
==========

kpasswd is not a critical protocol for the AD DC in most installations, it can
be disabled by setting "kpasswd port = 0" in the smb.conf.

=======
Credits
=======

Originally reported by Luke Howard.

Patches provided by Joseph Sutton and Andreas Schneider of the Samba
team.

==========================================================
== Our Code, Our Bugs, Our Responsibility.
== The Samba Team
==========================================================

```


