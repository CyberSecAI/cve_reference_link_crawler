- **Root cause of vulnerability**: Improper neutralization of SQL parameters in the AfterMail module for PrestaShop. Specifically, the module fails to sanitize user-supplied input used in SQL queries.
- **Weaknesses/vulnerabilities present**: Multiple SQL injection vulnerabilities are present in the module. The module is vulnerable in the `aftermailajax.php` file via the `id_customer`, `id_conf`, `id_product`, or `token` parameters, and in `aftermailpresta.php` via the `id_product` parameter in hooks `DisplayRightColumnProduct` and `DisplayProductButtons`.
- **Impact of exploitation**: Successful exploitation allows remote attackers to execute arbitrary SQL commands. This can lead to:
    - Obtaining admin access
    - Removing data from the associated PrestaShop
    - Copying/pasting data from sensitive tables to the front-end, exposing tokens and unlocking admin's AJAX scripts
    - Rewriting SMTP settings to hijack emails
- **Attack vectors**: The attack vectors are through HTTP requests. The `aftermailajax.php` endpoint can be exploited using the `id_customer`, `id_conf`, `id_product`, or `token` GET parameters. The `aftermailpresta.php` endpoint can be exploited using the `id_product` GET parameter, specifically in the `DisplayRightColumnProduct` and `DisplayProductButtons` hooks.
- **Required attacker capabilities/position**: Attackers can be remote and require no privileges or user interaction. The attack complexity is low.