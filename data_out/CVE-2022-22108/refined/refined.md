Based on the provided information, here's a breakdown of CVE-2022-22108:

**Root Cause of Vulnerability:**

*   **Missing Authorization:** The vulnerability stems from a lack of proper authorization checks in Daybyday CRM. Specifically, low-privileged users (employee type) were able to access and view information they were not authorized to see, such as the absences of all users, including administrators.

**Weaknesses/Vulnerabilities Present:**

*   **Insufficient Access Control:** The primary weakness is that the application does not properly enforce access controls, allowing users to bypass intended restrictions.
*   **Direct Object Reference:**  The vulnerability is directly exploited by accessing the `/users/calendar-users` endpoint without proper authorization checks. This means the application was relying on the lack of knowledge of the path, rather than access control.

**Impact of Exploitation:**

*   **Confidentiality Breach:** An attacker with a low-privilege account can view sensitive information about all users' absences within the system, which includes administrator accounts.

**Attack Vectors:**

*   **Network-based:** The attack is carried out by sending HTTP requests to the web application's server.
*   **URL Manipulation:** Attackers can directly access the unauthorized page by appending `/users/calendar-users` to the application URL.

**Required Attacker Capabilities/Position:**

*   **Low-Privilege Account:** The attacker only needs a basic "employee" type user account to exploit this vulnerability.
*   **Network Access:** The attacker needs to be able to send HTTP requests to the vulnerable application.

**Technical Details:**
* The vulnerability exists in Daybyday CRM versions 2.0.0 through 2.2.0, specifically within the `bottelet/flarepoint` package.
* The fix involves updating to version 2.2.1 in the "bottelet/flarepoint" package.
* The vulnerability is present in the PHP codebase of the application.
* A proof of concept involves a user logging in with a low privileged account, and then simply adding the `/users/calendar-users` endpoint to the URL.

**Additional Information:**

*   The vulnerability is categorized under CWE-862 (Missing Authorization).
*   CVSS v3.1 score is 4.3, with a Network attack vector, Low attack complexity and Low privileges required. Confidentiality impact is low, while Integrity and Availability impact are none.
* CVSS v2 score is 4.0, with a network attack vector, Low attack complexity and single authentication. Confidentiality impact is partial, while Integrity and Availability impact are none.
*   The provided GitHub commit [fe842ea5ede237443f1f45a99aeb839133115d8b](https://github.com/Bottelet/DaybydayCRM/commit/fe842ea5ede237443f1f45a99aeb839133115d8b) shows the implemented fix for the vulnerability. It adds a check (`if (!auth()->user()->can('absence-view'))`) in the `calendarUsers` function in `app/Http/Controllers/UsersController.php` to verify user authorization before displaying the user absence information.
*   The patch also changes the authorization logic in `app/Models/User.php` and `resources/views/users/form.blade.php` to prevent unauthorized role and password changes.