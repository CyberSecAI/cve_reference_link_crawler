=== Content from raw.githubusercontent.com_ca1c3a4e_20250111_085602.html ===
== Changelog ==
= 1.9.5 - 19-03-2024 =
\* Tweak - Minor fixes.
= 1.9.4.4 - 15-01-2023 =
\* Support - Support for theme dashboard enhancement.
= 1.9.4.3 - 04-12-2023 =
\* Fix - Ornate Decor slug.
= 1.9.4.2 - 04-12-2023 =
\* Fix - Ornate Decor config name.
= 1.9.4.1 - 03-12-2023 =
\* Support – Support for Ornate Decor.
\* Tweak - Update WordPress tested upto version to 6.4.
= 1.9.4 - 23-08-2023 =
\* Fix – Import fail message issue.
= 1.9.3 - 18-08-2023 =
\* Support – Support for YITH Wishlist default settings when importing demo.
\* Tweak - Replace deprecated function get\_page\_by\_title with WP\_Query.
= 1.9.2.2 - 16-08-2023 =
\* Support – Support for Kirana.
\* Tweak - Update WordPress tested upto version to 6.3.
= 1.9.2.1 - 03-04-2023 =
\* Fix – Support for Blissful.
= 1.9.2 - 03-04-2023 =
\* Support – Support for Blissful.
= 1.9.1 - 15-02-2023 =
\* Update - Stable tag.
= 1.9.0 - 15-02-2023 =
\* Tweak – Update review notice message.
\* Tweak - Updated WordPress tested upto version to 6.1.
\* Tweak – Update popup information message.
= 1.8.9 - 14-12-2022 =
\* Support – Support for Vastra.
= 1.8.8.2 - 07-11-2022 =
\* Fix – Support for Gizmo.
= 1.8.8.1 - 07-11-2022 =
\* Update – Stable tag.
= 1.8.8 - 07-11-2022 =
\* Support – Support for Gizmo.
= 1.8.7 - 10-10-2022 =
\* Update – Stable tag.
= 1.8.6 - 10-10-2022 =
\* Remove - Support for eStory Pro.
= 1.8.5 - 19-09-2022 =
\* Fix - Compatibility with Masteriyo Pro.
= 1.8.4 - 31-08-2022 =
\* Support - MagazineX theme.
= 1.8.3 - 14-07-2022 =
\* Support - Libreria theme.
= 1.8.2 - 01-07-2022 =
\* Support - eStory theme.
= 1.8.1 - 01-07-2022 =
- Fix - Masteriyo page duplication.
- Update – Header field Tested up to.
= 1.8.0 - 08-03-2022 =
\* Support - Skincare theme.
\* Remove - Support for Luza theme.
= 1.7.9 - 16-02-2022 =
\* Tweak - Update static demo content url.
= 1.7.8 - 10-02-2022 =
\* Support - Luza theme.
= 1.7.7 - 12-01-2022 =
\* Support - BlockArt Blocks plugin.
\* Support - Online Education theme.
\* Fix - PHP warning while importing widget.
= 1.7.6.1 - 31-12-2021 =
\* Tweak - Update stable tag.
= 1.7.6 - 30-12-2021 =
\* Tweak - Update resources URL.
= 1.7.5 - 25-10-2021 =
\* Tweak - Use of escaping and sanitization functions.
= 1.7.4 - 19-10-2021 =
\* Enhancement - Compatibility with latest Masteriyo LMS plugin.
= 1.7.3 - 08-10-2021 =
\* Tweak - Support eLearning theme.
\* Tweak - Disable Masteriyo setup wizard.
\* Tweak - Setup Masteriyo pages properly after demo import.
= 1.7.2 - 25-06-2021 =
\* Fix - Value (Legacy) of Parallax Type option from SiteOrigin plugin changing after demo import.
= 1.7.1 - 18-01-2021 =
\* Remove - Admin notice for `Plugin Review`.
= 1.7.0 - 11-01-2021 =
\* Tweak - Set FontAwesome 4 Shim feature to be enabled automatically on successful theme demo import.
= 1.6.9 - 7-01-2021 =
\* Tweak - Require `Companion Addons for Elementor` plugin to import certain demos according to the demo config set
= 1.6.8 - 23-11-2020 =
\* Fix - WooCommerce default pages not set properly after the theme demo import
\* Fix - Elementor default kit introduced from version 3.0.0 not applied after the theme demo import
= 1.6.7 - 15-09-2020 =
\* Tweak - Utilize `wp.i18n` for translation of strings for `wp.updates.l10n` deprecated since WordPress 5.5
= 1.6.6 - 06-08-2020 =
\* Introduce - Demo Importer Status page
\* Tweak - Added compatibility with WordPress v5.5
\* Remove - `Reset wizard` feature to reset the site to fresh WordPress install.
= 1.6.5 - 23-07-2020 =
\* Fix - Demo not importing completely in certain conditions.
= 1.6.4 - 04-06-2020 =
\* Fix - `WooCommerce Setup Wizard` disabled when the plugin is active.
\* Fix - `Live Preview` button link on successful demo import message in WordPress multisite install.
\* Tweak - Add admin notice for `Plugin Review`.
\* Tweak - Add admin notice for `Plugin Deactivate` if demo is already imported in their site.
\* Tweak - Add refresh demo lists feature.
\* Tweak - Add feature to restrict demo import process for specific demos to fix unwanted issues for unsupported demos.
\* Deprecate - `Upgrade to Pro` admin notice.
= 1.6.3 - 18-02-2020 =
\* Enhancement - Secure reset button with nonce check.
= 1.6.2 - 15-02-2020 =
\* Fix - Unauthenticated user vulnerability. Thanks webarxsecurity team
= 1.6.1 - 12-11-2019 =
\* Tweak - Add admin notice for `Upgrade To Pro`.
= 1.6.0 - 10-09-2019 =
\* Tweak - Support for Zakra Premium version demo import.
= 1.5.9 - 22-07-2019 =
\* Tweak - Display all available theme demos on main demo import page.
= 1.5.8 - 20-06-2019 =
\* Tweak - Update demo import message.
= 1.5.7 - 06-03-2019 =
\* Fix - Demo preview overlay not importing specific demo.
= 1.5.6 - 15-02-2019 =
\* Fetaure - Install plugins and import demo on a single click.
\* Tweak - Remove the more details on demo preview hover.
\* Dev - Improve Coding standard with husky compatibility.
= 1.5.5 - 05-11-2018 =
\* Feature - Add support for elementor schemes.
= 1.5.4 - 02-11-2018 =
\* Change Modular to Zakra
= 1.5.3 - 30-10-2018 =
\* Support - Modular theme.
= 1.5.2 - 25-09-2018 =
\* Fix - Custom CSS migration on demo import.
\* Fix - Live Preview button when demo is successfully imported in demo preview page.
= 1.5.1 - 24-08-2018 =
\* Support - Cenote Pro theme.
= 1.5.0 - 21-08-2018 =
\* Feature - Fetches the demo config from GitHub repo.
\* Feature - Category and pagebuilder routes for views.
\* Fetaure - Install and activate plugins on a single click.
\* Fix - Slashes to be stripped from imported comments.
\* Fix - Importing export files with multiline term meta data.
\* Fix - Deprecation notices including `wp\_get\_http()` and `screen\_icon()`.
\* Tweak - Demo preview is supported via iframe.
\* Tweak - Different device preview is possible for a demo.
\* Tweak - Only store single demo package files in upload directory.
\* Dev - Improve PHP7 compatibility.
\* Deprecated - Upload process for the demo packages.
\* Deprecated - Filter hooks `themegrill\_demo\_importer\_config` and `themegrill\_demo\_importer\_packages`.
= 1.4.3 - 23-04-2018 =
\* Support - Cenote theme.
= 1.4.2 - 25-12-2017 =
\* Fix - Disable WooCommerce setup wizard for demo import.
\* Fix - Styling issue caused by missing `theme-id-container` container.
= 1.4.1 - 08-12-2017 =
\* Feature - Compatiable with Elementor page builder.
\* Fix - Styling issue caused by missing `theme-id-container` container.
= 1.4.0 - 20-07-2017 =
\* Feature - Plugin installer and activator mechinism.
\* Fix - Call to undefined function `preg\_filter()`.
\* Dev - Improved file structure.
\* Dev - Introduced `tg\_demo\_installer\_enabled()`.
\* Dev - Introduced `tg\_demo\_installer\_preview()`.
\* Dev - Introduced `tg\_demo\_preview\_screenshot\_url()`.
= 1.3.4 - 03-07-2017 =
\* Feature - Support RTL for Importer.
\* Feature - Reset wizard for clean up.
\* Fixed - Undefined queue job update action.
\* Fixed - Use of `wp-heading-inline` core class.
\* Tweak - Use of defined constant for demo packs.
\* Tweak - Uninstall data with a defined constant.
\* Tweak - Fallback screenshot for flash demo preview.
= 1.3.3 =
\* Tweak - Support demo import for suffice theme.
= 1.3.2 =
\* Tweak - Load screenshots for pro theme demos.
= 1.3.1 =
\* Tweak - Load screenshot from theme instead of plugin for themes with single demo.
= 1.3.0 =
\* Tweak - Support data update for nested siteorigin layoutbuilder.
\* Fix - Import button not working on firefox.
= 1.2.0 =
\* Tweak - Load scripts perfecly on demo importer appearance page.
\* Tweak - Set transient for redirecting to demo importer page after install or update.
\* Tweak - Introduced filter hook `themegrill\_demo\_importer\_installer` to control demo view.
= 1.1.0 =
\* Feature - Backbone views interface for demos and previews
\* Feature - Added download button for the preview not installed
\* Feature - Robust quick search view to change in demo interface
\* Feature - Detailed information in popup to showcase plugins, events, etc
\* Refactor - Replace old way to import demo with new `wp.updates` methods
\* Fix - Menu classes to hide admin menu if no JS using css class `hide-if-no-js`
\* Fix - Remove the old demo pack if found and to update the new demo packs
= 1.0.0 =
\* Initial Public Release


=== Content from www.webarxsecurity.com_edf75cc7_20250111_085605.html ===


[Skip to main content](#main)
[![](https://patchstack.com/wp-content/uploads/2021/11/logo.svg)](/)

JavaScript is disabled in your browser. Please enable JavaScript for a better experience.

* [Pricing](/pricing/)
* Solutions
  + [WordPress security](https://patchstack.com/wordpress-security/)
  + [Enterprise API](https://patchstack.com/for-hosts/)
  + [Managed VDP](https://patchstack.com/for-plugins/)
  + [Bug Bounty](https://patchstack.com/bug-bounty/)
  + [Plugin auditing](https://patchstack.com/auditing/)
  + [Vulnerability database](https://patchstack.com/database/)
* [Login](https://app.patchstack.com/login)

* ![]()

  + ![]()

    - ![]()

[Start trial](https://app.patchstack.com/register)

# Critical Issue In ThemeGrill Demo Importer

[Security advisories](https://patchstack.com/category/security-advisories/)
[Themegrill demo importer](https://patchstack.com/tag/themegrill-demo-importer/)
Published 16 February 2020Updated 12 July 2023![](https://secure.gravatar.com/avatar/7f009046884a335084f86ff1a1acadce?s=200&d=mm&r=g)[Dave Jong](https://patchstack.com/author/davetheawesome/)CTO at PatchstackTable of Contents

The [ThemeGrill Demo Importer](https://wordpress.org/plugins/themegrill-demo-importer/) plugin has 200,000+ active installations and can be used to import ThemeGrill official themes demo content, widgets, and theme settings with just one click.

Update (18th of February):
The installs count has dropped to 100K+. It indicates that many people have started to uninstall the plugin based on the statistics provided by the WordPress plugin repository. Here’s the Google Cache showing 200K+ installs on the [15th of February.](https://webcache.googleusercontent.com/search?q=cache:kTHL3xHA_oUJ:https://wordpress.org/plugins/themegrill-demo-importer/+&cd=1&hl=en&ct=clnk&gl=ee)

![](https://www.webarxsecurity.com/wp-content/uploads/2020/02/Screenshot-2020-02-18-at-17.06.45-1024x610.png)

In versions 1.3.4 and above and versions 1.6.1 and below, there is a vulnerability that allows any unauthenticated user to wipe the entire database to its default state after which they are automatically logged in as an administrator.

![themegrill demo importer](https://ps.w.org/themegrill-demo-importer/assets/banner-772x250.png?rev=1928438)

The prerequisite is that there must be a theme installed and activated that was published by ThemeGrill. In order to be automatically logged in as an administrator, there must be a user called “admin” in the database. Regardless of this condition, the database will still be wiped to its default state.

Based on the SVN commit history, this issue has existed in the code for roughly 3 years, since version 1.3.4.

## Technical details

Once the plugin detects that a ThemeGrill theme is installed and activated, it loads the file */includes/class-demo-importer.php* which hooks *reset\_wizard\_actions* into *admin\_init* on line 44.

The admin\_init hook runs not only in the admin environment but also on calls to /wp-admin/admin-ajax.php which does not require a user to be authenticated.

The function *reset\_wizard\_actions* looks a bit like the following (irrelevant code removed):

```
	public function reset_wizard_actions() {
		global $wpdb, $current_user;

		if ( ! empty( $_GET['do_reset_wordpress'] ) ) {

			///

			if ( 'admin' != $current_user->user_login ) {
				$user = get_user_by( 'login', 'admin' );
			}

			if ( empty( $user->user_level ) || $user->user_level < 10 ) {
				$user = $current_user;
			}

			// Drop tables.
			$drop_tables = $wpdb->get_col( sprintf( "SHOW TABLES LIKE '%s%%'", str_replace( '_', '\_', $wpdb->prefix ) ) );
			foreach ( $drop_tables as $table ) {
				$wpdb->query( "DROP TABLE IF EXISTS $table" );
			}

			// Installs the site.
			$result = wp_install( $blogname, $user->user_login, $user->user_email, $blog_public );

			// Updates the user password with a old one.
			$wpdb->update(
				$wpdb->users,
				array(
					'user_pass'           => $user->user_pass,
					'user_activation_key' => '',
				),
				array( 'ID' => $result['user_id'] )
			);

			// Set up the Password change nag.
			$default_password_nag = get_user_option( 'default_password_nag', $result['user_id'] );
			if ( $default_password_nag ) {
				update_user_option( $result['user_id'], 'default_password_nag', false, true );
			}

			///

			// Update the cookies.
			wp_clear_auth_cookie();
			wp_set_auth_cookie( $result['user_id'] );

			// Redirect to demo importer page to display reset success notice.
			wp_safe_redirect( admin_url( 'themes.php?page=demo-importer&browse=all&reset=true' ) );
			exit();
		}
	}
```

Here we see that there is no authentication check and only the *do\_reset\_wordpress* parameter needs to be present in the URL on any “admin” based page of WordPress, including /wp-admin/admin-ajax.php.

If we are currently not logged in, it will retrieve the “admin” user object from WordPress and then drop all WordPress tables that start with the defined WordPress database prefix.

Once all tables have been dropped, it will populate the database with the default settings and data after which it will set the password of the “admin” user to its previously known password.

However, this does not matter since we are automatically logged in as “admin” near the end of the function. If the “admin” user does not exist in the database then the users’ table will remain empty and you will not be automatically logged in as any user.

## The Patch

The patch can be found [here](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2245070%40themegrill-demo-importer%2Ftrunk&old=2190304%40themegrill-demo-importer%2Ftrunk&sfp_email=&sfph_mail=) which shows that they added a *current\_user\_can( ‘manage\_options’ )* check to the reset\_wizard\_actions method.

![](https://i.imgur.com/0PregDu.png)

This is a serious vulnerability and can cause a significant amount of damage. Since it requires no suspicious-looking payload just like our [previous finding in InfiniteWP](https://www.webarxsecurity.com/vulnerability-infinitewp-client-wp-time-capsule/), it is not expected for any firewall to block this by default, and a special rule needs to be created to block this vulnerability.

## Timeline

**06-02-2020** – Discovery of the issue and released a patch to all Patchstack customers.
**06-02-2020** – Reported the issue to the developer of the plugin.
**11-02-2020** – Second attempt to reach out to the developer.
**14-02-2020** – Received email from the developer, resent the issue to them.
**16-02-2020** – The developer published a new version that fixes the issue.

### Indicators of compromise

Plugin changelogs are often monitored by the attackers to detect security bug fixes and to compare different versions to see what was fixed. This allows the attackers to act before the users have updated the plugin. This is why updating the plugins as fast as possible is very important.

We have been closely monitoring the ThemeGrill Demo Importer vulnerability and have seen this vulnerability being exploited since the release of the patch.

**Patchstack (formerly WebARX) has blocked over 16,000 attacks against this vulnerability since the 16th of February.**

**List of IP addresses currently exploiting this vulnerability with 100 or more attacks blocked.**
149.202.75.164
192.169.159.241
209.251.53.192
107.180.225.158
62.76.187.179
185.45.72.159
31.207.33.10
198.12.156.154
163.44.207.54
142.44.151.107
68.183.204.202
51.68.124.88
188.166.16.17
168.63.19.216
46.105.92.10
103.221.222.179
104.238.99.130
175.139.199.53
68.183.76.157
45.32.104.33
2001:41d0:d:34a4::
46.101.174.128
2607:5300:61:bd9::107
159.65.65.204
84.238.108.177
188.166.176.184
165.227.48.147
2a03:b0c0:2:d0::11f0:6001
2404:f080:1101:316:163:44:207:54
50.63.162.9
46.105.99.163
2001:e68:586e:6900:21e:67ff:fe8c:191f

Found this useful? Share on

* ![](https://patchstack.com/wp-content/uploads/2024/06/twitter-x-line.svg)
* ![](https://patchstack.com/wp-content/uploads/2024/03/facebook-fill.svg)
* ![](https://patchstack.com/wp-content/uploads/2024/03/linkedin-fill.svg)

Protect your websites against WordPress vulnerabilities[Get started](/pricing/)
### Monthly security advice

Get the latest WordPress security intelligence delivered to your inbox.**NEW**: Get started with 5 bite-sized security lessons.
Email SignupEmailSubscribe
### The latest in Security advisories

[See all](https://patchstack.com/category/security-advisories/)[![](https://patchstack.com/wp-content/uploads/2025/01/Critical-Vulnerability-Patched-in-GiveWP-Plugin-main.png)10 January, 2025
#### Critical Vulnerability Patched in GiveWP Plugin

Zeroday bounties
zeroday
givewp
Critical Vulnerability
php object injection](https://patchstack.com/articles/critical-vulnerability-patched-in-givewp-plugin/)[![](https://patchstack.com/wp-content/uploads/2025/01/Critical-Vulnerabilities-Found-in-Fancy-Product-Designer-Plugin-main.png)8 January, 2025
#### Critical Vulnerabilities Found in Fancy Product Designer Plugin

Critical Vulnerability
arbitrary file upload
SQL Injection
ENVATO](https://patchstack.com/articles/critical-vulnerabilities-found-in-fancy-product-designer-plugin/)[![](https://patchstack.com/wp-content/uploads/2024/12/Multiple-Critical-Vulnerabilities-Patched-in-WPLMS-and-VibeBP-Plugins-main.png)23 December, 2024
#### Multiple Critical Vulnerabilities Patched in WPLMS and VibeBP Plugins

ENVATO
Critical Vulnerability
privilege escalation
arbitrary file upload
theme
SQL Injection](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wplms-and-vibebp-plugins/)

### Website security

[Pricing](https://patchstack.com/pricing/)[For WordPress](https://patchstack.com/wordpress-security/)[For WooCommerce](https://patchstack.com/woocommerce-security)[For agencies](https://patchstack.com/for-agencies/)[API for hosts](https://patchstack.com/for-hosts/)[Documentation](https://docs.patchstack.com/)[Log in](https://app.patchstack.com/login)
### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)[Log in](https://vdp.patchstack.com/vdp/login)[Active programs](https://patchstack.com/database/vdp/)[Security auditing](https://patchstack.com/auditing/)
### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)[Log in](https://vdp.patchstack.com/researchers/login)[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)[Learn](https://patchstack.com/academy)[Discord](https://discord.gg/rkE8yxtNmS)
### Resources

[Vulnerability database](https://patchstack.com/database/)[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024/)[Vulnerability statistics](https://patchstack.com/database/statistics/wordpress)[Case studies](https://patchstack.com/category/case-studies/)[Articles](https://patchstack.com/articles/)
### Patchstack

[About](https://patchstack.com/about/)[Careers](https://patchstack.com/about/#careers)[Merch store](https://store.patchstack.com)[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)
### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)[Facebook](https://www.facebook.com/patchstackapp)[X](https://twitter.com/patchstackapp)[![Patchstack logo](https://patchstack.com/wp-content/uploads/2024/01/logo-opt-300x32.webp)](/)© 2025 Patchstack[DPA](https://patchstack.com/data-processing-agreement-dpa/)[Privacy Policy](https://patchstack.com/privacy-policy/)[Terms & Conditions](https://patchstack.com/terms-and-conditions/)![Co-funded by EU logo](https://patchstack.com/wp-content/uploads/2024/01/EIC-logo-CoFundedBy-opt.webp)
[![](https://patchstack.com/wp-content/uploads/2021/01/logo.png)](/)
### Website security

[Pricing](https://patchstack.com/pricing/)[For WordPress](https://patchstack.com/wordpress-security/)[For WooCommerce](https://patchstack.com/woocommerce-security)[For agencies](https://patchstack.com/for-agencies/)[API for hosts](https://patchstack.com/for-hosts/)[Documentation](https://docs.patchstack.com/)[Log in](https://app.patchstack.com/login)
### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)[Log in](https://vdp.patchstack.com/vdp/login)[Active programs](https://patchstack.com/database/vdp/)[Security auditing](https://patchstack.com/auditing/)
### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)[Log in](https://vdp.patchstack.com/researchers/login)[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)[Learn](https://patchstack.com/academy)[Discord](https://discord.gg/rkE8yxtNmS)
### Resources

[Vulnerability database](https://patchstack.com/database/)[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024/)[Vulnerability statistics](https://patchstack.com/database/statistics/wordpress)[Case studies](https://patchstack.com/category/case-studies/)[Articles](https://patchstack.com/articles/)
### Patchstack

[About](https://patchstack.com/about/)[Careers](https://patchstack.com/about/#careers)[Merch store](https://store.patchstack.com)[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)
### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)[Facebook](https://www.facebook.com/patchstackapp)[X](https://twitter.com/patchstackapp)© 2025 Patchstack[DPA](https://patchstack.com/data-processing-agreement-dpa/)[Privacy Policy](https://patchstack.com/privacy-policy/)[Terms & Conditions](https://patchstack.com/terms-and-conditions/)

Looks like your browser is blocking our support chat widget. Turn off adblockers and reload the page.Reload page

xml version="1.0"?closechevron-downchainbarsangle-rightangle-upxml version="1.0"?crossmenu



=== Content from www.openwall.com_bfb045a4_20250111_085603.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2020/02/14/6) [[next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20200219090304.675dab3d@computer>
Date: Wed, 19 Feb 2020 09:03:04 +0100
From: Hanno Böck <hanno@...eck.de>
To: oss-security@...ts.openwall.com
Subject: Wordpress themegrill-demo-importer: database reset/auth bypass,
 incomplete fix due to CSRF

A severe vulnerability in a wordpress plugin called ThemeGrill Demo
Importer was discovered by the company WebARX:
<https://www.webarxsecurity.com/critical-issue-in-themegrill-demo-importer/>

The vulnerability is as follows:
The plugin adds a hook to wordpress that can be reached with the
ajax-interface (admin-ajax.php) and that has a functionality to reset
the wordpress database which will be triggered if the GET variable
do_reset_wordpress is set.

The problem: This had no authentication whatsoever.

PoC:
curl <https://example.org/wp-admin/admin-ajax.php?do_reset_wordpress01>
--data 'action=heartbeat' -i

This can obviously delete all existing posts and other data. If there
exists a user called "admin" (i.e. the name of the user is admin, not
just a user with an admin role) then after triggering that function the
attacking user will be logged in as the admin, so in that case he can
use that to e.g. install a plugin and gain code execution. For further
details read the WebARX post.

This is already being actively exploitet, I observed several vulnerable
installations that were empty yesterday (i.e. only showing the standard
"Hello World" post of a new wordpress installation).

Incomplete Fix / CSRF
=====================

As a fix for this the developers of the plugin added a check if one is
logged in as a user with sufficient permission in version 1.6.2.
This is not a full fix, because there is no protection from Cross Site
Request Forgery. This means the functionality can no longer be
triggered by an unauthenticated user, but one can lure the admin of an
affected site to a site triggering a POST request executing that
function.

PoC code:
<form id="f1"
action="<https://example.org/wp-admin/admin-ajax.php?do_reset_wordpress=1>"
method="POST"> <input type=hidden name=action value="heartbeat">
</form>
<script>
document.getElementById("f1").submit();
</script>

I had reported this to the developers of the plugin on Monday, but
given that this is almost entirely obvious looking at the fix I was
likely not the only one who has noticed. WebARX also told me they
noticed this and had already told Themegrill about it.

There's now an update 1.6.3 that adds a nonce check. I have
not reviewed that change in detail. Patches:
<https://github.com/themegrill/themegrill-demo-importer/commit/b350a29628fb40522468a576e98e45abbc4de0c7>
<https://github.com/themegrill/themegrill-demo-importer/commit/564d8496d1f0d10f6aab4798eeec7ddefc81bdd2>

From the functionality this plugin provides I believe it's only useful
during development and testing of themes. Therefore even if the
vulnerability is now hopefully fixed it is probably a good idea to
remove it from production installations when it's no longer needed.

Summary on affected versions:
1.3.4 to 1.6.1: vulnerable to original/severe variant
1.6.2: Insufficient fix, attack with CSRF possible
1.6.3: hopefully fixed

--
Hanno Böck
<https://hboeck.de/>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.wordfence.com_826568b3_20250111_085606.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# ThemeGrill Demo Importer 1.3.4 - 1.6.1 - Authorization Bypass to Site Reset

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   ThemeGrill Demo Importer 1.3.4 - 1.6.1 - Authorization Bypass to Site Reset

9.9

**Missing Authorization**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

| CVE | [CVE-2020-36837](https://www.cve.org/CVERecord?id=CVE-2020-36837) |
| --- | --- |
| CVSS | 9.9 (Critical) |
| Publicly Published | February 16, 2020 |
| Last Updated | October 16, 2024 |
| Researcher | [Dave Jong - Patchstack](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/dave-jong) |

### Description

The ThemeGrill Demo Importer plugin for WordPress is vulnerable to authentication bypass due to a missing capability check on the reset\_wizard\_actions function in versions 1.3.4 through 1.6.1. This makes it possible for authenticated attackers to reset the WordPress database. After which, if there is a user named 'admin', the attacker will become automatically logged in as an administrator.

Wordfence blocked **69,732 attacks** targeting this vulnerability in the past 24 hours.

#### References

* [www.webarxsecurity.com](https://www.webarxsecurity.com/critical-issue-in-themegrill-demo-importer/)
* [www.openwall.com](https://www.openwall.com/lists/oss-security/2020/02/19/1)
* [raw.githubusercontent.com](https://raw.githubusercontent.com/themegrill/themegrill-demo-importer/master/CHANGELOG.txt)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fthemegrill-demo-importer%2Fthemegrill-demo-importer-134-161-authorization-bypass-to-site-reset&t=ThemeGrill%20Demo%20Importer%201.3.4%20-%201.6.1%20-%20Authorization%20Bypass%20to%20Site%20Reset "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fthemegrill-demo-importer%2Fthemegrill-demo-importer-134-161-authorization-bypass-to-site-reset&text=ThemeGrill%20Demo%20Importer%201.3.4%20-%201.6.1%20-%20Authorization%20Bypass%20to%20Site%20Reset "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fthemegrill-demo-importer%2Fthemegrill-demo-importer-134-161-authorization-bypass-to-site-reset "LinkedIn")
Email

## Vulnerability Details for ThemeGrill Demo Importer

#### [ThemeGrill Demo Importer](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/themegrill-demo-importer)

| Software Type | Plugin |
| --- | --- |
| Software Slug | themegrill-demo-importer [(view on wordpress.org)](https://wordpress.org/plugins/themegrill-demo-importer) |
| Patched? | Yes |
| Remediation | Update to version 1.6.2, or a newer patched version |
| Affected Version | * 1.3.4 - 1.6.1 |
| Patched Version | * 1.6.2 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


