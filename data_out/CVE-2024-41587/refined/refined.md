- **Root cause of vulnerability**: Insufficient input sanitization in multiple areas of the web UI and OS command injection due to improper validation
- **Weaknesses/vulnerabilities present**:
    - Stored Cross-Site Scripting (XSS) vulnerabilities in the custom greeting message and router name configurations due to lack of input sanitization
    - Reflected XSS vulnerabilities in multiple parts of the Web UI
    - Stack-based buffer overflows in the Web UI due to missing length checks when processing query string parameters
    - OS command injection vulnerability in the "recvCmd" binary due to insufficient validation of commands sent by the guest OS
    - Heap-based buffer overflows due to byte sign-extension in the ft_payloads_dns function.
    - Missing bounds checks when handling CGI form parameters, leading to buffer overflows and controlled writes into global variables
    - Use of a static string to seed the PRNG in OpenSSL for TLS.

-   **Impact of exploitation**:
    - Full system compromise via OS command injection, potentially allowing for VM escape
    - Remote code execution (RCE) and denial of service (DoS) due to buffer overflows
    - Stored and reflected XSS can lead to credential theft and other malicious activities
    - Denial of service (DoS) conditions, potentially requiring manual restart of devices.
    - Information disclosure and man-in-the-middle (MiTM) attacks due to weak TLS implementation
    - Espionage, data exfiltration, ransomware and denial-of-service attacks
    - Use of compromised routers for botnet activities or C2 servers

- **Attack vectors**:
    - Sending crafted HTTP requests to vulnerable CGI pages, exploiting buffer overflows, XSS and OS command injection vulnerabilities
    - Exploiting the lack of sanitization for user-controlled data to inject malicious code
    - Sending specially crafted commands to the "recvCmd" binary, potentially gaining OS level access.
    - Exploiting the virtual serial interface between the host OS and guest OS

- **Required attacker capabilities/position**:
    - Network access to the vulnerable DrayTek router's web interface, which is frequently exposed to the internet.
    - For some vulnerabilities, valid admin credentials may be required.
    - For exploiting OS command injection, an attacker must be able to compromise the guest OS.