=== Content from github.com_0e340bee_20250111_070536.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fleethomason%2Ftinyxml2%2Fissues%2F996)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fleethomason%2Ftinyxml2%2Fissues%2F996)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=leethomason%2Ftinyxml2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[leethomason](/leethomason)
/
**[tinyxml2](/leethomason/tinyxml2)**
Public

* [Notifications](/login?return_to=%2Fleethomason%2Ftinyxml2) You must be signed in to change notification settings
* [Fork
  1.9k](/login?return_to=%2Fleethomason%2Ftinyxml2)
* [Star
   5.2k](/login?return_to=%2Fleethomason%2Ftinyxml2)

* [Code](/leethomason/tinyxml2)
* [Issues
  112](/leethomason/tinyxml2/issues)
* [Pull requests
  3](/leethomason/tinyxml2/pulls)
* [Actions](/leethomason/tinyxml2/actions)
* [Projects
  0](/leethomason/tinyxml2/projects)
* [Wiki](/leethomason/tinyxml2/wiki)
* [Security](/leethomason/tinyxml2/security)
* [Insights](/leethomason/tinyxml2/pulse)

Additional navigation options

* [Code](/leethomason/tinyxml2)
* [Issues](/leethomason/tinyxml2/issues)
* [Pull requests](/leethomason/tinyxml2/pulls)
* [Actions](/leethomason/tinyxml2/actions)
* [Projects](/leethomason/tinyxml2/projects)
* [Wiki](/leethomason/tinyxml2/wiki)
* [Security](/leethomason/tinyxml2/security)
* [Insights](/leethomason/tinyxml2/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fleethomason%2Ftinyxml2%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fleethomason%2Ftinyxml2%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Reachable assertion 'mult <= UINT\_MAX / 16' failed in tinyxml2::XMLUtil::GetCharacterRef #996

Open

[4n0nym4u5](/4n0nym4u5) opened this issue
Aug 30, 2024
· 6 comments

Open

# [Reachable assertion 'mult <= UINT\_MAX / 16' failed in tinyxml2::XMLUtil::GetCharacterRef](#top) #996

[4n0nym4u5](/4n0nym4u5) opened this issue
Aug 30, 2024
· 6 comments

## Comments

[![@4n0nym4u5](https://avatars.githubusercontent.com/u/38467329?s=80&u=dfb7713cccd132d97e9c34b1f05f77b9d6875492&v=4)](/4n0nym4u5)

Copy link

### **[4n0nym4u5](/4n0nym4u5)** commented [Aug 30, 2024](#issue-2496621006)

| Description The latest version of tinyxml2 was discovered to contain a reachable assertion `mult <= UINT_MAX / 16' failed` vulnerability in tinyxml2.cpp:519 tinyxml2::XMLUtil::GetCharacterRef() when parsing a specially crafted XML file. This vulnerability leads to a Denial of Service (DoS). ASAN Log ``` Summary: CRASH detected in __pthread_kill_implementation leading to SIGABRT (si_signo=6) / SI_TKILL (si_code=-6) Command line: ./build/xmltest @@ Testcase: crashes/id:000010,sig:06,src:000233,time:248906,execs:802366,op:MOpt_core_havoc,rep:8 Crash bucket: 1e78e3a2bcd1f47b81667ed5ef2d283f  Crashing thread backtrace: #0  0x00007ffff789eb1c in __pthread_kill_implementation (/lib/x86_64-linux-gnu/libc.so.6)                        at ./nptl/pthread_kill.c:44  #1  0x00007ffff789eb1c in __pthread_kill_internal (/lib/x86_64-linux-gnu/libc.so.6)                        at ./nptl/pthread_kill.c:78  #2  0x00007ffff789eb1c in __GI___pthread_kill (/lib/x86_64-linux-gnu/libc.so.6)                        at ./nptl/pthread_kill.c:89  #3  0x00007ffff784526e in __GI_raise (/lib/x86_64-linux-gnu/libc.so.6)                        at ../sysdeps/posix/raise.c:26  #4  0x00007ffff78288ff in __GI_abort (/lib/x86_64-linux-gnu/libc.so.6)                        at ./stdlib/abort.c:79  #5  0x00007ffff782881b in __assert_fail_base (/lib/x86_64-linux-gnu/libc.so.6)                        at ./assert/assert.c:94  #6  0x00007ffff783b507 in __assert_fail (/lib/x86_64-linux-gnu/libc.so.6)                        at ./assert/assert.c:103  #7  0x00007ffff7f9950e in tinyxml2::XMLUtil::GetCharacterRef (/home/user/fuzzing_targets/tinyxml2/build/libtinyxml2.so.10)                        470: const tinyxml2::XMLUtil::GetCharacterRef(p = (const char *)0x55555579e910 "&#xha07", '0' <repeats 30 times>, "1;E>0he20000\354\310<</", '0' <repeats 47 times>, "-->\n<m:mstyle s<!criptlevel=\00400", value = (char *)0x7ffffffe01aa "", length = (int *)0x7ffffffe01a4) {                        |||:                        |||: /* Local reference: unsigned long ucs = 1; */                        |||: /* Local reference: const unsigned int digitScaled = 0; */                        |||: /* Local reference: unsigned int mult = 268435456; */                        517:                 TIXMLASSERT( ucs <= ULONG_MAX - digitScaled );                        518:                 ucs += digitScaled;                        519:                 TIXMLASSERT( mult <= UINT_MAX / 16 );                        |||:                        ---: }                        at ../tinyxml2.cpp:519  #8  0x00007ffff7f98878 in tinyxml2::StrPair::GetStr (/home/user/fuzzing_targets/tinyxml2/build/libtinyxml2.so.10)                        281: const tinyxml2::StrPair::GetStr(this = (class tinyxml2::StrPair *)0x55555579fa30) {                        |||:                        |||: /* Local reference: char [10] buf = "\000\000\000\000\000\000\000\000\000"; */                        |||: /* Local reference: const int buflen = 10; */                        |||: /* Local reference: int len = 0; */                        |||: /* Local reference: const char * adjusted = 0x0; */                        |||: /* Local reference: const char * p = 0x55555579e910 "&#xha07", '0' <repeats 30 times>, "1;E>0he20000\354\310<</", '0' <repeats 47 times>, "-->\n<m:mstyle s<!criptlevel=\00400"; */                        325:                         char buf[buflen] = { 0 };                        326:                         int len = 0;                        327:                         const char* adjusted = const_cast<char*>( XMLUtil::GetCharacterRef( p, buf, &len ) );                        |||:                        ---: }                        at ../tinyxml2.cpp:327  #9  0x00007ffff7fa1fb9 in tinyxml2::XMLAttribute::Value (/home/user/fuzzing_targets/tinyxml2/build/libtinyxml2.so.10)                        1445: const tinyxml2::XMLAttribute::Value(this = (const class tinyxml2::XMLAttribute *)0x55555579fa10) {                        1446: {                        1447:     return _value.GetStr();                        ||||:                        ----: }                        at ../tinyxml2.cpp:1447  #10 0x00007ffff7fa3331 in tinyxml2::XMLElement::Attribute (/home/user/fuzzing_targets/tinyxml2/build/libtinyxml2.so.10)                        1635: const tinyxml2::XMLElement::Attribute(this = (const class tinyxml2::XMLElement *)0x55555579eab0, name = (const char *)0x55555579e995 "style", value = (const char *)0x0) {                        ||||:                        ||||: /* Local reference: const class tinyxml2::XMLAttribute * a = 0x55555579fa10; */                        ||||: /* Local reference: const char * value = 0x0; */                        1640:     }                        1641:     if ( !value || XMLUtil::StringEqual( a->Value(), value )) {                        1642:         return a->Value();                        ||||:                        ----: }                        at ../tinyxml2.cpp:1642  #11 0x00007ffff7fa5ba8 in tinyxml2::XMLElement::ParseAttributes (/home/user/fuzzing_targets/tinyxml2/build/libtinyxml2.so.10)                        1967: char tinyxml2::XMLElement::ParseAttributes(this = (class tinyxml2::XMLElement *)0x55555579eab0, p = (char *)0x55555579e9ac "", curLineNumPtr = (int *)0x55555579d350) {                        ||||:                        ||||: /* Local reference: class tinyxml2::XMLAttribute * attrib = 0x55555579fa60; */                        ||||: /* Local reference: char * p = 0x55555579e9ac ""; */                        ||||: /* Local reference: int * curLineNumPtr = 0x55555579d350; */                        1986:                         1987:             p = attrib->ParseDeep( p, _document->ProcessEntities(), curLineNumPtr );                        1988:             if ( !p || Attribute( attrib->Name() ) ) {                        ||||:                        ----: }                        at ../tinyxml2.cpp:1988  #12 0x00007ffff7fa6973 in tinyxml2::XMLElement::ParseDeep (/home/user/fuzzing_targets/tinyxml2/build/libtinyxml2.so.10)                        2083: char tinyxml2::XMLElement::ParseDeep(this = (class tinyxml2::XMLElement *)0x55555579eab0, p = (char *)0x55555579e8ba " style", parentEndTag = (class tinyxml2::StrPair *)0x7ffffffe0400, curLineNumPtr = (int *)0x55555579d350) {                        ||||:                        ||||: /* Local reference: char * p = 0x55555579e8ba " style"; */                        ||||: /* Local reference: int * curLineNumPtr = 0x55555579d350; */                        2099:     }                        2100:                         2101:     p = ParseAttributes( p, curLineNumPtr );                        ||||:                        ----: }                        at ../tinyxml2.cpp:2101  #13 0x00007ffff7f9ebb2 in tinyxml2::XMLNode::ParseDeep (/home/user/fuzzing_targets/tinyxml2/build/libtinyxml2.so.10)                        1080: char tinyxml2::XMLNode::ParseDeep(this = (class tinyxml2::XMLNode *)0x55555579ea38, p = (char *)0x55555579e8b6 "m:mi style", parentEndTag = (class tinyxml2::StrPair *)0x7ffffffe05c0, curLineNumPtr = (int *)0x55555579d350) {                        ||||:                        ||||: /* Local reference: class tinyxml2::StrPair endTag = {_flags = 0, _start = 0x0, _end = 0x0}; */                        ||||: /* Local reference: class tinyxml2::XMLNode * node = 0x55555579eab0; */                        ||||: /* Local reference: char * p = 0x55555579e8b6 "m:mi style"; */                        ||||: /* Local reference: int * curLineNumPtr = 0x55555579d350; */                        1115:                         1116:         StrPair endTag;                        1117:         p = node->ParseDeep( p, &endTag, curLineNumPtr );                        ||||:                        ----: }                        at ../tinyxml2.cpp:1117  #14 0x00007ffff7fa6a89 in tinyxml2::XMLElement::ParseDeep (/home/user/fuzzing_targets/tinyxml2/build/libtinyxml2.so.10)                        2083: char tinyxml2::XMLElement::ParseDeep(this = (class tinyxml2::XMLElement *)0x55555579ea38, p = (char *)0x55555579e848 "\n<!--00000-''000\0270-00000-\322>\n<\217\301<i\302\374\033m:mi></m:mst\211le>0AM00000(0000O00\377\377he30\377\2000\017", '0' <repeats 12 times>, "9000000000\2150400--> <m:mi style", parentEndTag = (class tinyxml2::StrPair *)0x7ffffffe05c0, curLineNumPtr = (int *)0x55555579d350) {                        ||||:                        ||||: /* Local reference: char * p = 0x55555579e848 "\n<!--00000-''000\0270-00000-\322>\n<\217\301<i\302\374\033m:mi></m:mst\211le>0AM00000(0000O00\377\377he30\377\2000\017", '0' <repeats 12 times>, "9000000000\2150400--> <m:m... */                        ||||: /* Local reference: class tinyxml2::StrPair * parentEndTag = 0x7ffffffe05c0; */                        ||||: /* Local reference: int * curLineNumPtr = 0x55555579d350; */                        2104:     }                        2105:                         2106:     p = XMLNode::ParseDeep( p, parentEndTag, curLineNumPtr );                        ||||:                        ----: }                        at ../tinyxml2.cpp:2106  #15 0x00007ffff7f9ebb2 in tinyxml2::XMLNode::ParseDeep (/home/user/fuzzing_targets/tinyxml2/build/libtinyxml2.so.10)                        1080: char tinyxml2::XMLNode::ParseDeep(this = (class tinyxml2::XMLNode *)0x55555579e9c0, p = (char *)0x55555579e843 "body>\n<!--00000-''000\0270-00000-\322>\n<\217\301<i\302\374\033m:mi></m:mst\211le>0AM00000(0000O00\377\377he30\377\2000\017", '0' <repeats 12 times>, "9000000000\2150400--> <m:mi style", parentEndTag = (class tinyxml2::StrPair *)0x7ffffffe0780, curLineNumPtr = (int *)0x55555579d350) {                        ||||:                        ||||: /* Local reference: class tinyxml2::StrPair endTag = {_flags = 0, _start = 0x0, _end = 0x0}; */                        ||||: /* Local reference: class tinyxml2::XMLNode * node = 0x55555579ea38; */                        ||||: /* Local reference: char * p = 0x55555579e843 "body>\n<!--00000-''000\0270-00000-\322>\n<\217\301<i\302\374\033m:mi></m:mst\211le>0AM00000(0000O00\377\377he30\377\2000\017", '0' <repeats 12 times>, "9000000000\2150400-->... */                        ||||: /* Local reference: int * curLineNumPtr = 0x55555579d350; */                        1115:                         1116:         StrPair endTag;                        1117:         p = node->ParseDeep( p, &endTag, curLineNumPtr );                        ||||:                        ----: }                        at ../tinyxml2.cpp:1117  #16 0x00007ffff7fa6a89 in tinyxml2::XMLElement::ParseDeep (/home/user/fuzzing_targets/tinyxml2/build/libtinyxml2.so.10)                        2083: char tinyxml2::XMLElement::ParseDeep(this = (class tinyxml2::XMLElement *)0x55555579e9c0, p = (char *)0x55555579e842 "<body>\n<!--00000-''000\0270-00000-\322>\n<\217\301<i\302\374\033m:mi></m:mst\211le>0AM00000(0000O00\377\377he30\377\2000\017", '0' <repeats 12 times>, "9000000000\2150400--> <m:mi style", parentEndTag = (class tinyxml2::StrPair *)0x7ffffffe0780, curLineNumPtr = (int *)0x55555579d350) {                        ||||:                        ||||: /* Local reference: char * p = 0x55555579e842 "<body>\n<!--00000-''000\0270-00000-\322>\n<\217\301<i\302\374\033m:mi></m:mst\211le>0AM00000(0000O00\377\377he30\377\2000\017", '0' <repeats 12 times>, "9000000000\2150400--... */                        ||||: /* Local reference: class tinyxml2::StrPair * parentEndTag = 0x7ffffffe0780; */                        ||||: /* Local reference: int * curLineNumPtr = 0x55555579d350; */                        2104:     }                        2105:                         2106:     p = XMLNode::ParseDeep( p, parentEndTag, curLineNumPtr );                        ||||:                        ----: }                        at ../tinyxml2.cpp:2106  #17 0x00007ffff7f9ebb2 in tinyxml2::XMLNode::ParseDeep (/home/user/fuzzing_targets/tinyxml2/build/libtinyxml2.so.10)                        1080: char tinyxml2::XMLNode::ParseDeep(this = (class tinyxml2::XMLNode *)0x55555579d2b0, p = (char *)0x55555579e821 "html xml0000000000mlnsm", parentEndTag = (class tinyxml2::StrPair *)0x0, curLineNumPtr = (int *)0x55555579d350) {                        ||||:                        ||||: /* Local reference: class tinyxml2::StrPair endTag = {_flags = 0, _start = 0x0, _end = 0x0}; */                        ||||: /* Local reference: class tinyxml2::XMLNode * node = 0x55555579e9c0; */                        ||||: /* Local reference: char * p = 0x55555579e821 "html xml0000000000mlnsm"; */                        ||||: /* Local reference: int * curLineNumPtr = 0x55555579d350; */                        1115:                         1116:         StrPair endTag;                        1117:         p = node->ParseDeep( p, &endTag, curLineNumPtr );                        ||||:                        ----: }                        at ../tinyxml2.cpp:1117  #18 0x00007ffff7fa9725 in tinyxml2::XMLDocument::Parse (/home/user/fuzzing_targets/tinyxml2/build/libtinyxml2.so.10)                        2558: void tinyxml2::XMLDocument::Parse(this = (class tinyxml2::XMLDocument *)0x55555579d2b0) {                        ||||:                        ||||: /* Local reference: char * p = 0x55555579e820 "<html xml0000000000mlnsm"; */                        2569:         return;                        2570:     }                        2571:     ParseDeep(p, 0, &_parseCurLineNum );                        ||||:                        ----: }                        at ../tinyxml2.cpp:2571  #19 0x00007ffff7fa950d in tinyxml2::XMLDocument::LoadFile (/home/user/fuzzing_targets/tinyxml2/build/libtinyxml2.so.10)                        2371: enum tinyxml2::XMLDocument::LoadFile(this = (class tinyxml2::XMLDocument *)0x55555579d2b0, fp = (FILE *)0x55555579d630) {                        ||||:                        ||||: /* Local reference: const size_t size = 396; */                        2418:     _charBuffer[size] = 0;                        2419:                         2420:     Parse();                        ||||:                        ----: }                        at ../tinyxml2.cpp:2420  #20 0x00007ffff7fa8f83 in tinyxml2::XMLDocument::LoadFile (/home/user/fuzzing_targets/tinyxml2/build/libtinyxml2.so.10)                        2352: enum tinyxml2::XMLDocument::LoadFile(this = (class tinyxml2::XMLDocument *)0x55555579d2b0, filename = (const char *)0x7fffffffe149 "crashes/id:000010,sig:06,src:000233,time:248906,execs:802366,op:MOpt_core_havoc,rep:8") {                        ||||:                        ||||: /* Local reference: FILE * fp = 0x55555579d630; */                        2364:         return _errorID;                        2365:     }                        2366:     LoadFile( fp );                        ||||:                        ----: }                        at ../tinyxml2.cpp:2366  #21 0x000055555555c01f in main (/home/user/fuzzing_targets/tinyxml2/build/xmltest)                        300: int main(argc = (int)2, argv = (const char **)0x7fffffffdd98) {                        |||:                        |||: /* Local reference: class tinyxml2::XMLDocument * doc = 0x55555579d2b0; */                        |||: /* Local reference: clock_t startTime = 2552; */                        |||: /* Local reference: const char ** argv = 0x7fffffffdd98; */                        317:         XMLDocument* doc = new XMLDocument();                        318:         clock_t startTime = clock();                        319:         doc->LoadFile( argv[1] );                        |||:                        ---: }                        at ../xmltest.cpp:319  Crash context: Execution stopped here ==> 0x00007ffff789eb1c: mov    r14d,eax  Register info:     rax - 0x0000000000000000 (0)     rbx - 0x000000000011f159 (1175897)     rcx - 0x00007ffff789eb1c (140737346399004)     rdx - 0x0000000000000006 (6)     rsi - 0x000000000011f159 (1175897)     rdi - 0x000000000011f159 (1175897)     rbp - 0x00007ffffffdff70 (0x7ffffffdff70)     rsp - 0x00007ffffffdff30 (0x7ffffffdff30)      r8 - 0x000055555578b010 (93824994553872)      r9 - 0x0000000000000007 (7)     r10 - 0x0000000000000008 (8)     r11 - 0x0000000000000246 (582)     r12 - 0x0000000000000006 (6)     r13 - 0x00007ffff7fb301b (140737353822235)     r14 - 0x0000000000000016 (22)     r15 - 0x00007ffff7fb333a (140737353823034)     rip - 0x00007ffff789eb1c (0x7ffff789eb1c <__GI___pthread_kill+284>)  eflags - 0x00000246 ([ PF ZF IF ])      cs - 0x00000033 (51)      ss - 0x0000002b (43)      ds - 0x00000000 (0)      es - 0x00000000 (0)      fs - 0x00000000 (0)      gs - 0x00000000 (0) fs_base - 0x00007ffff7f3f7c0 (140737353349056) gs_base - 0x0000000000000000 (0) ``` Proof-of-Concept Files [poc](https://github.com/4n0nym4u5/CVE/raw/main/tinyxml2_poc/reachable_assertion_mult/poc) Reproduction ``` git clone https://github.com/leethomason/tinyxml2 cd tinyxml2 CC=clang CXX=clang++ meson setup build CC=clang CXX=clang++ sudo ninja -C build install ./build/xmltest poc ``` Results ``` ➜  tinyxml2 git:(master) ✗ ./build/xmltest tinyxml2_poc/reachable_assertion_mult/poc  xmltest: ../tinyxml2.cpp:519: static const char *tinyxml2::XMLUtil::GetCharacterRef(const char *, char *, int *): Assertion `mult <= UINT_MAX / 16' failed. [1]    1176938 IOT instruction  ./build/xmltest tinyxml2_poc/reachable_assertion_mult/poc ``` Environment ``` Linux Mint 22 Wilma  Ubuntu clang version 18.1.3 (1ubuntu1) gcc (Ubuntu 13.2.0-23ubuntu4) 13.2.0  ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=80&u=54a9fd1cfc2b1abb34a487f17e07eb8a03cecdae&v=4)](/carnil)

Copy link

### **[carnil](/carnil)** commented [Oct 28, 2024](#issuecomment-2442626245)

| This got associated with [CVE-2024-50614](https://github.com/advisories/GHSA-xpm9-95h9-q996 "CVE-2024-50614") |
| --- |

All reactions

Sorry, something went wrong.

[![@dodjiseketeli](https://avatars.githubusercontent.com/u/12494807?s=80&v=4)](/dodjiseketeli)

Copy link

### **[dodjiseketeli](/dodjiseketeli)** commented [Oct 30, 2024](#issuecomment-2447184852)

| It seems this issue cannot be reproduced with tinyxml2 version 6.0.0, does it? |
| --- |

All reactions

Sorry, something went wrong.

[![@4n0nym4u5](https://avatars.githubusercontent.com/u/38467329?s=80&u=dfb7713cccd132d97e9c34b1f05f77b9d6875492&v=4)](/4n0nym4u5)

Copy link

Author

### **[4n0nym4u5](/4n0nym4u5)** commented [Oct 30, 2024](#issuecomment-2447515806)

| It seems this issue cannot be reproduced with tinyxml2 version 6.0.0, does it?  I just tested it and 6.0.0 isnt affected by this issue. |
| --- |

All reactions

Sorry, something went wrong.

[![@dodjiseketeli](https://avatars.githubusercontent.com/u/12494807?s=80&v=4)](/dodjiseketeli)

Copy link

### **[dodjiseketeli](/dodjiseketeli)** commented [Oct 30, 2024](#issuecomment-2447586959)

| It seems this issue cannot be reproduced with tinyxml2 version 6.0.0, does it?  I just tested it and 6.0.0 isnt affected by this issue.  Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@plx211](https://avatars.githubusercontent.com/u/10956278?s=80&v=4)](/plx211)

Copy link

### **[plx211](/plx211)** commented [Oct 31, 2024](#issuecomment-2450297700)

| I've analyzed this a little :)  The assertion is caused by parsing very long entities (`&#...;`). `GetCharacterRef` trying parsing everything from `#` to `;`, so for PoC file, its trying parse:  ``` &#x13Z>?000000000000?> <!00000000;  ```  What triggers assertion (but only in debug build) to prevent int overflow (in my opinion).  If you want to minimise the risk of this UB, you can set `processEntities` to `false` in `XMLDocument` constructor, which disables parsing `&#...;`. But remember that this is a workaround; it should be fixed in tinyxml (maybe limiting parsing to 8 characters is a good idea). |
| --- |

All reactions

Sorry, something went wrong.

[![@obernin](https://avatars.githubusercontent.com/u/5502607?s=80&v=4)](/obernin)

Copy link

### **[obernin](/obernin)** commented [Nov 11, 2024](#issuecomment-2468226466)

| Hi,  If the assertion is only triggered in debug mode, what happens when the code is compiled and running in non-debug mode ? Presumably the assertion is not triggered, but does the error condition detected by the assertion in debug mode not cause a different error in non-debug mode ? And what is the impact of that error (crash, malfunction, etc ...) ?  If the crash is avoided in non debug mode, it seems that this could be a mitigation for the CVE, no ? |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fleethomason%2Ftinyxml2%2Fissues%2F996)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

5 participants

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=52&v=4)](/carnil) [![@obernin](https://avatars.githubusercontent.com/u/5502607?s=52&v=4)](/obernin) [![@plx211](https://avatars.githubusercontent.com/u/10956278?s=52&v=4)](/plx211) [![@dodjiseketeli](https://avatars.githubusercontent.com/u/12494807?s=52&v=4)](/dodjiseketeli) [![@4n0nym4u5](https://avatars.githubusercontent.com/u/38467329?s=52&v=4)](/4n0nym4u5)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


