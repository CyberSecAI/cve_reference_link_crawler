The provided content relates to CVE-2022-2229.

**Root Cause:**
The vulnerability stems from the GraphQL operation `getCiConfigData` which loads all CI variables of a project, including custom ones, in the background, without proper authorization checks.

**Weaknesses/Vulnerabilities:**
- Inadequate authorization in `Resolvers::Ci::ConfigResolver`.
- Ability to access masked CI variables through GraphQL without appropriate permissions.
-  GraphQL operation `getCiConfigData` loads all CI variables of the project, including custom ones, in the background.

**Impact of Exploitation:**
- Unauthorized access to CI variables, including sensitive masked variables of Gitlab projects.

**Attack Vectors:**
-  Exploiting the GraphQL API using a crafted query.
-  Leveraging the `getCiConfigData` operation to reveal CI variables.

**Required Attacker Capabilities/Position:**
- An attacker needs to be an external user, a regular user or a guest to a project, depending on the project's visibility settings.
- The attacker needs to be able to use the GraphQL API.
- The attacker needs to have the project's path and be able to construct the correct query.