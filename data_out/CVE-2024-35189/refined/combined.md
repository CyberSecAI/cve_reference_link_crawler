=== Content from cloud.google.com_2077c942_20250110_203718.html ===


[![Google Cloud](https://www.gstatic.com/devrel-devsite/prod/vda41147226ae308b24384f785d31d739107d2716272d99cd11c490ff3892954d/cloud/images/cloud-logo.svg)](/)

[Documentation](https://cloud.google.com/docs)

[Technology areas](https://cloud.google.com/docs/tech-area-overviews)

close

* [AI and ML](https://cloud.google.com/docs/ai-ml)
* [Application development](https://cloud.google.com/docs/application-development)
* [Application hosting](https://cloud.google.com/docs/application-hosting)
* [Compute](https://cloud.google.com/docs/compute-area)
* [Data analytics and pipelines](https://cloud.google.com/docs/data)
* [Databases](https://cloud.google.com/docs/databases)
* [Distributed, hybrid, and multicloud](https://cloud.google.com/docs/dhm-cloud)
* [Generative AI](https://cloud.google.com/docs/generative-ai)
* [Industry solutions](https://cloud.google.com/docs/industry)
* [Networking](https://cloud.google.com/docs/networking)
* [Observability and monitoring](https://cloud.google.com/docs/observability)
* [Security](https://cloud.google.com/docs/security)
* [Storage](https://cloud.google.com/docs/storage)

[Cross-product tools](https://cloud.google.com/docs/cross-product-overviews)

close

* [Access and resources management](https://cloud.google.com/docs/access-resources)
* [Costs and usage management](https://cloud.google.com/docs/costs-usage)
* [Google Cloud SDK, languages, frameworks, and tools](https://cloud.google.com/docs/devtools)
* [Infrastructure as code](https://cloud.google.com/docs/iac)
* [Migration](https://cloud.google.com/docs/migration)

[Related sites](https://cloud.google.com/)

close

* [Google Cloud Home](https://cloud.google.com/)
* [Free Trial and Free Tier](https://cloud.google.com/free)
* [Architecture Center](https://cloud.google.com/architecture)
* [Blog](https://cloud.google.com/blog)
* [Contact Sales](https://cloud.google.com/contact)
* [Google Cloud Developer Center](https://cloud.google.com/developers)
* [Google Developer Center](https://developers.google.com/)
* [Google Cloud Marketplace](https://console.cloud.google.com/marketplace)
* [Google Cloud Marketplace Documentation](https://cloud.google.com/marketplace/docs)
* [Google Cloud Skills Boost](https://www.cloudskillsboost.google/paths)
* [Google Cloud Solution Center](https://cloud.google.com/solutions)
* [Google Cloud Support](https://cloud.google.com/support-hub)
* [Google Cloud Tech Youtube Channel](https://www.youtube.com/%40googlecloudtech)

`/`

* English
* Deutsch
* Español – América Latina
* Français
* Indonesia
* Italiano
* Português – Brasil
* 中文 – 简体
* 日本語
* 한국어

Sign in

* [IAM](https://cloud.google.com/iam)

[Guides](https://cloud.google.com/iam/docs/overview)

[Reference](https://cloud.google.com/iam/docs/apis)

[Samples](https://cloud.google.com/iam/docs/samples)

[Resources](https://cloud.google.com/iam/docs/resources)

[Contact Us](https://cloud.google.com/contact)
[Start free](//console.cloud.google.com/freetrial)

[![Google Cloud](https://www.gstatic.com/devrel-devsite/prod/vda41147226ae308b24384f785d31d739107d2716272d99cd11c490ff3892954d/cloud/images/cloud-logo.svg)](/)

* [Documentation](/docs)
  + [Guides](/iam/docs/overview)
  + [Reference](/iam/docs/apis)
  + [Samples](/iam/docs/samples)
  + [Resources](/iam/docs/resources)
* [Technology areas](/docs/tech-area-overviews)
  + More
* [Cross-product tools](/docs/cross-product-overviews)
  + More
* [Related sites](/)
  + More
* [Console](//console.cloud.google.com/)
* [Contact Us](/contact)
* [Start free](//console.cloud.google.com/freetrial)

* Discover
* [Product overview](/iam/docs/overview)
* Get started
* [Grant roles in the Google Cloud console](/iam/docs/grant-role-console)
* [Grant roles using client libraries](/iam/docs/write-policy-client-libraries)
* [IAM and your security architecture](/iam/docs/iam-security-architecture)
* [Identity management for Google Cloud](/iam/docs/google-identities)
* Configure identities for users
* [Identities for users](/iam/docs/user-identities)
* [Create and manage Google groups in the Google Cloud console](/iam/docs/groups-in-cloud-console)
* [Best practices for using Google groups](/iam/docs/groups-best-practices)
* Federate identities for users
  + [Workforce identity federation](/iam/docs/workforce-identity-federation)
  + Configure Workforce Identity Federation
    - [Microsoft Entra ID](/iam/docs/workforce-sign-in-microsoft-entra-id)
    - [Okta](/iam/docs/workforce-sign-in-okta)
    - [Other OIDC or SAML 2.0](/iam/docs/configuring-workforce-identity-federation)
    - [Access BigQuery data in Power BI with Microsoft Entra](/iam/docs/workforce-sign-in-power-bi)
  + [Obtain short-lived credentials for Workforce Identity Federation](/iam/docs/workforce-obtaining-short-lived-credentials)
  + [Manage workforce identity pools and providers](/iam/docs/manage-workforce-identity-pools-providers)
  + [Delete Workforce Identity Federation users and their data](/iam/docs/workforce-delete-user-data)
  + [Set up user access to console (federated)](/iam/docs/workforce-console-sso)
  + Integrate OAuth applications
    - [OAuth application integration overview](/iam/docs/workforce-oauth-app)
    - [Manage OAuth applications](/iam/docs/workforce-manage-oauth-app)
* Configure identities for workloads
* [Identities for workloads](/iam/docs/workload-identities)
* Create and manage service accounts
  + About service accounts
    - [Service accounts](/iam/docs/service-account-overview)
    - [Service account credentials](/iam/docs/service-account-creds)
    - [Service account impersonation](/iam/docs/service-account-impersonation)
    - [Service account types](/iam/docs/service-account-types)
    - [Roles for service account authentication](/iam/docs/service-account-permissions)
  + [Create and grant roles to service agents](/iam/docs/create-service-agents)
  + [Create service accounts](/iam/docs/service-accounts-create)
  + Manage service accounts
    - [List and edit service accounts](/iam/docs/service-accounts-list-edit)
    - [Disable and enable service accounts](/iam/docs/service-accounts-disable-enable)
    - [Delete and undelete service accounts](/iam/docs/service-accounts-delete-undelete)
    - [Manage tags for service accounts](/iam/docs/service-accounts-tags)
  + [Attach service accounts to resources](/iam/docs/attach-service-accounts)
  + [Use custom organization policies for service accounts and keys](/iam/docs/service-accounts-custom-constraints)
  + Service account best practices
    - [Best practices for using service accounts](/iam/docs/best-practices-service-accounts)
    - [Best practices for using service accounts in deployment pipelines](/iam/docs/best-practices-for-using-service-accounts-in-deployment-pipelines)
* Create managed workload identities
  + [About managed workload identities](/iam/docs/managed-workload-identity)
  + [Create managed workload identities](/iam/docs/create-managed-workload-identities)
* Federate identities for external workloads
  + [Workload Identity Federation](/iam/docs/workload-identity-federation)
  + Configure Workload Identity Federation
    - [AWS or Azure](/iam/docs/workload-identity-federation-with-other-clouds)
    - [Active Directory](/iam/docs/workload-identity-federation-with-active-directory)
    - [Deployment pipelines](/iam/docs/workload-identity-federation-with-deployment-pipelines)
    - [Kubernetes](/iam/docs/workload-identity-federation-with-kubernetes)
    - [Workloads with X.509 certificates](/iam/docs/workload-identity-federation-with-x509-certificates)
    - [Other identity providers](/iam/docs/workload-identity-federation-with-other-providers)
  + [Manage workload identity pools and providers](/iam/docs/manage-workload-identity-pools-providers)
  + [Best practices for using Workload Identity Federation](/iam/docs/best-practices-for-using-workload-identity-federation)
  + [Let customers access their Google Cloud resources from your product or service](/iam/docs/use-workload-identity-federation-to-let-customers-access-their-cloud-resources)
  + [Download credential configuration and grant access](/iam/docs/workload-download-cred-and-grant-access)
  + [Integrate Cloud Run and Workload Identity Federation](/iam/docs/tutorial-cloud-run-workload-id-federation)
* Create and manage service account keys
  + [Migrate from service account keys](/iam/docs/migrate-from-service-account-keys)
  + [Service account key rotation](/iam/docs/key-rotation)
  + [Create and delete service account keys](/iam/docs/keys-create-delete)
  + [List and get service account keys](/iam/docs/keys-list-get)
  + [Upload a public key](/iam/docs/keys-upload)
  + [Disable and enable service account keys](/iam/docs/keys-disable-enable)
  + [Best practices for managing service account keys](/iam/docs/best-practices-for-managing-service-account-keys)
* [Built-in identities for resources](/iam/docs/built-in-resource-identities)
* Control access to resources
* About IAM access controls
  + [Roles and permissions](/iam/docs/roles-overview)
  + [Policy types](/iam/docs/policy-types)
  + [Allow policies](/iam/docs/policies)
  + [Allow policy inheritance](/iam/docs/resource-hierarchy-access-control)
  + [Deny policies](/iam/docs/deny-overview)
  + [Principal access boundary policies](/iam/docs/principal-access-boundary-policies)
  + [Access change propagation](/iam/docs/access-change-propagation)
  + [IAM conditions](/iam/docs/conditions-overview)
* Choose roles to grant
  + [Choose predefined roles](/iam/docs/choose-predefined-roles)
  + [View grantable roles](/iam/docs/viewing-grantable-roles)
  + Roles for specific job functions
    - [Billing-related job functions](/iam/docs/job-functions/billing)
    - [Networking-related job functions](/iam/docs/job-functions/networking)
    - [Auditing-related job functions](/iam/docs/job-functions/auditing)
  + Create and manage custom roles
    - [Create and manage custom roles](/iam/docs/creating-custom-roles)
    - [Use Deployment Manager to maintain custom roles](/iam/docs/maintain-custom-roles-deployment-manager)
* Grant access
  + [Manage access to projects, folders, and organizations](/iam/docs/granting-changing-revoking-access)
  + [Manage access to service accounts](/iam/docs/manage-access-service-accounts)
  + [Manage access to other resources](/iam/docs/manage-access-other-resources)
  + [Test allow policy changes](/iam/docs/test-policy-changes)
* Grant access conditionally
  + [Manage conditional role bindings](/iam/docs/managing-conditional-role-bindings)
  + [Configure temporary access](/iam/docs/configuring-temporary-access)
  + [Configure resource-based access](/iam/docs/configuring-resource-based-access)
  + [Tags and conditional access](/iam/docs/tags-access-control)
  + [Set limits on granting roles](/iam/docs/setting-limits-on-granting-roles)
  + [Lint conditions in allow policies](/iam/docs/linting-policies)
* [Deny access](/iam/docs/deny-access)
* Restrict the resources that a principal can access
  + [Create and apply principal access boundary policies](/iam/docs/principal-access-boundary-policies-create)
  + [View principal access boundary policies](/iam/docs/principal-access-boundary-policies-view)
  + [Edit principal access boundary policies](/iam/docs/principal-access-boundary-policies-edit)
  + [Remove principal access boundary policies](/iam/docs/principal-access-boundary-policies-remove)
* Temporary elevated access
  + [Temporary elevated access overview](/iam/docs/temporary-elevated-access)
  + Control temporary elevated access with PAM
    - [PAM overview](/iam/docs/pam-overview)
    - [Permissions and setup](/iam/docs/pam-permissions-and-setup)
    - [Create entitlements](/iam/docs/pam-create-entitlements)
    - [View, update, and delete entitlements](/iam/docs/pam-view-update-delete-entitlements)
    - [View grants](/iam/docs/pam-view-grants)
    - [Revoke grants](/iam/docs/pam-revoke-grants)
    - [Audit entitlement and grant events](/iam/docs/pam-audit-entitlement-events)
  + [Request temporary elevated access with PAM](/iam/docs/pam-request-temporary-elevated-access)
  + [Approve or deny grants with PAM](/iam/docs/pam-approve-deny-grants)
  + [Create short-lived credentials for a service account](/iam/docs/create-short-lived-credentials-direct)
  + [Create short-lived credentials for multiple service accounts](/iam/docs/create-short-lived-credentials-delegated)
  + [Restrict a credential's Cloud Storage permissions](/iam/docs/downscoping-short-lived-credentials)
  + [Migrate to the Service Account Credentials API](/iam/docs/migrating-to-credentials-api)
* [Test permissions for custom user interfaces](/iam/docs/testing-permissions)
* [Use custom organization policies for allow policies](/iam/docs/org-policy-custom-constraints)
* [Use IAM to help prevent exfiltration from data pipelines](/solutions/help-secure-the-pipeline-from-your-data-lake-to-your-data-warehouse)
* Optimize your IAM configuration
* [Use IAM securely](/iam/docs/using-iam-securely)
* [Optimize IAM policies by using Policy Intelligence tools](/iam/docs/policy-intelligence-tools)
* [Help secure IAM using VPC Service Controls](/iam/docs/secure-iam-vpc-sc)
* Monitor
* Audit logging
  + [IAM API audit logging](/iam/docs/audit-logging)
  + [Service Account Credentials API audit logging](/iam/docs/audit-logging/audit-logging-iamcreds)
  + [Privileged Access Manager audit logging](/iam/docs/audit-logging/audit-logging-pam)
  + [Security Token Service API audit logging](/iam/docs/audit-logging/audit-logging-sts)
  + [Example logs for service accounts](/iam/docs/audit-logging/examples-service-accounts)
  + [Example logs for Workforce Identity Federation](/iam/docs/audit-logging/examples-workforce-identity)
  + [Example logs for Workforce OAuth application integration](/iam/docs/audit-logging/examples-oauth-clients)
  + [Example logs for Workload Identity Federation](/iam/docs/audit-logging/examples-workload-identity)
* [Analyze access to resources](/iam/docs/analyze-access)
* Monitor service account usage
  + [Tools to understand service account usage](/iam/docs/service-account-usage-tools)
  + [Monitor usage patterns for service accounts and keys](/iam/docs/service-account-monitoring)
* [Review allow policy history](/iam/docs/review-iam-policy-history)
* Troubleshoot
* [Troubleshoot allow and deny policies](/iam/docs/troubleshoot-policies)
* [Troubleshoot organization policy errors for service accounts](/iam/docs/troubleshoot-org-policies)
* [Troubleshoot "withcond" in policies and role bindings](/iam/docs/troubleshooting-withcond)
* [Troubleshoot Workforce Identity Federation](/iam/docs/troubleshooting-workforce-identity-federation)
* [Troubleshoot Workload Identity Federation](/iam/docs/troubleshooting-workload-identity-federation)
* Samples
* [All Identity and Access Management code samples](/iam/docs/samples)
* [Code samples for all products](/docs/samples)

* [AI and ML](/docs/ai-ml)
* [Application development](/docs/application-development)
* [Application hosting](/docs/application-hosting)
* [Compute](/docs/compute-area)
* [Data analytics and pipelines](/docs/data)
* [Databases](/docs/databases)
* [Distributed, hybrid, and multicloud](/docs/dhm-cloud)
* [Generative AI](/docs/generative-ai)
* [Industry solutions](/docs/industry)
* [Networking](/docs/networking)
* [Observability and monitoring](/docs/observability)
* [Security](/docs/security)
* [Storage](/docs/storage)

* [Access and resources management](/docs/access-resources)
* [Costs and usage management](/docs/costs-usage)
* [Google Cloud SDK, languages, frameworks, and tools](/docs/devtools)
* [Infrastructure as code](/docs/iac)
* [Migration](/docs/migration)

* [Google Cloud Home](/)
* [Free Trial and Free Tier](/free)
* [Architecture Center](/architecture)
* [Blog](https://cloud.google.com/blog)
* [Contact Sales](/contact)
* [Google Cloud Developer Center](/developers)
* [Google Developer Center](https://developers.google.com/)
* [Google Cloud Marketplace](https://console.cloud.google.com/marketplace)
* [Google Cloud Marketplace Documentation](/marketplace/docs)
* [Google Cloud Skills Boost](https://www.cloudskillsboost.google/paths)
* [Google Cloud Solution Center](/solutions)
* [Google Cloud Support](/support-hub)
* [Google Cloud Tech Youtube Channel](https://www.youtube.com/%40googlecloudtech)

* [Home](https://cloud.google.com/)
* [IAM](https://cloud.google.com/iam)
* [Documentation](https://cloud.google.com/iam/docs)
* [Guides](https://cloud.google.com/iam/docs/overview)

Send feedback

# Service account key rotation

Stay organized with collections

Save and categorize content based on your preferences.

[Service account keys](/iam/docs/service-account-creds#key-types) are private keys that let you
authenticate as a service account.
Key rotation is the process of replacing your existing keys with new keys and
then invalidating the replaced keys. We recommend that you routinely
rotate all keys that you manage, including your service account keys.

Rotating service account keys can help reduce the risk posed by leaked or stolen
keys. If a key is leaked, it might take bad actors days or weeks to discover the
key. If you regularly rotate your service account keys, there's a higher chance
that the leaked keys will be invalid by the time a bad actor gets them.

Having an established process for rotating service account keys also helps you
act quickly if you suspect that a service account key has been compromised.

**Note:**
Service account keys are a security risk if not managed correctly. You should
[choose a more secure alternative to service account keys](/docs/authentication#auth-decision-tree)
whenever possible. If you must authenticate with a service account key, you are responsible for the
security of the private key and for other operations described by
[Best practices for managing service account keys](/iam/docs/best-practices-for-managing-service-account-keys).
If you are prevented from creating a service account key, service account key creation might
be disabled for your organization. For more information, see
[Managing secure-by-default organization resources](/resource-manager/docs/secure-by-default-organizations).
## How often to rotate keys

We recommend rotating your keys at least every 90 days to reduce
the risk posed by leaked keys.

If you believe that a service account key has been compromised, we recommend
that you rotate it immediately.

## Key rotation process

To rotate service account keys, do the following:

1. Identify the service account keys that need to be rotated.
2. Create new keys for the same service accounts.
3. Replace the existing keys with the new keys across all applications.
4. Disable the replaced keys and monitor the applications to confirm that they
   work as expected.
5. Delete the service account keys that were replaced.

You can complete these steps by using a centralized secret management service,
or by using a custom notification system.

### Centralized secret management service

Many centralized secret management services, like [HashiCorp Vault](https://www.vaultproject.io), provide automatic secret rotation. You can use these services
to store and rotate your service account keys.

We don't recommend using Google Cloud's Secret Manager to store
and rotate service account keys. This is because, to access
Secret Manager secrets, your application needs an identity that
Google Cloud can recognize. If your application already has an identity
that Google Cloud can recognize, then your application can use that
identity to authenticate to Google Cloud instead of using a service
account key.

The same concept applies for other cloud-based secret management services, like
Azure KeyVault and AWS Secret Manager. If an application already has an identity
that these cloud providers can recognize, your application would be able to use
that identity to authenticate to Google Cloud instead of using a service
account key.

### Custom notification system

Another approach to service account key rotation is to create a system that
sends notifications when keys need to be rotated. For example, you could create
a system that sends alerts when it detects keys that were created more than
90 days ago.

First, you need to identify the keys that need to be rotated. To identify these
keys, we recommend using Cloud Asset Inventory to search for all service account
keys that were created before a certain time.

For example, the following command lists all service account keys that were
created before `2023-03-10 00:00:00 UTC` in the organization with the ID
`123456789012`:

```

gcloud asset search-all-resources \
    --scope="organizations/123456789012" \
    --query="createTime < 2023-03-10" \
    --asset-types="iam.googleapis.com/ServiceAccountKey" \
    --order-by="createTime"

```

To learn more about searching resources in Cloud Asset Inventory, see [Searching
resources](/asset-inventory/docs/searching-resources).
After identifying the keys that need to be rotated, you can send out
notifications to the appropriate teams.

When someone is notified to rotate a key, they should do the following:

1. [Create a new key](/iam/docs/keys-create-delete#creating) for the same service account.
2. Replace the existing key with the new key across all applications.
3. [Disable the key](/iam/docs/keys-disable-enable#disabling) that they replaced and monitor the
   applications to confirm that they work as expected.
4. After they confirm that the applications are working as expected, [delete the
   replaced key](/iam/docs/keys-create-delete#deleting).

## Expiring service account keys

We don't recommend using expiring service account keys for key rotation. This is
because expiring keys can cause outages if they aren't rotated properly. For
more information about the use cases for expiring service account keys, see
[expiry times for user-managed keys](/iam/docs/service-account-creds#key-expiry).

## What's next

* Use Cloud Asset Inventory to [search for resources](/asset-inventory/docs/searching-resources),
  including service account keys, by creation time.
* [Create](/iam/docs/keys-create-delete#creating), [disable](/iam/docs/keys-disable-enable#disabling), and [delete](/iam/docs/keys-create-delete#deleting) service
  account keys.

Send feedback

Except as otherwise noted, the content of this page is licensed under the [Creative Commons Attribution 4.0 License](https://creativecommons.org/licenses/by/4.0/), and code samples are licensed under the [Apache 2.0 License](https://www.apache.org/licenses/LICENSE-2.0). For details, see the [Google Developers Site Policies](https://developers.google.com/site-policies). Java is a registered trademark of Oracle and/or its affiliates.

Last updated 2025-01-09 UTC.

Need to tell us more?

[[["Easy to understand","easyToUnderstand","thumb-up"],["Solved my problem","solvedMyProblem","thumb-up"],["Other","otherUp","thumb-up"]],[["Hard to understand","hardToUnderstand","thumb-down"],["Incorrect information or sample code","incorrectInformationOrSampleCode","thumb-down"],["Missing the information/samples I need","missingTheInformationSamplesINeed","thumb-down"],["Other","otherDown","thumb-down"]],["Last updated 2025-01-09 UTC."],[],[]]

* ### Why Google

  + [Choosing Google Cloud](/why-google-cloud/)
  + [Trust and security](/trust-center/)
  + [Modern Infrastructure Cloud](/solutions/modern-infrastructure/)
  + [Multicloud](/multicloud/)
  + [Global infrastructure](/infrastructure/)
  + [Customers and case studies](/customers/)
  + [Analyst reports](/analyst-reports/)
  + [Whitepapers](/whitepapers/)
  + [Blog](//cloud.google.com/blog/)
* ### Products and pricing

  + [Google Cloud pricing](/pricing/)
  + [Google Workspace pricing](//workspace.google.com/pricing.html)
  + [See all products](/products/)
* ### Solutions

  + [Infrastructure modernization](/solutions/infrastructure-modernization/)
  + [Databases](/solutions/databases/)
  + [Application modernization](/solutions/application-modernization/)
  + [Smart analytics](/solutions/smart-analytics/)
  + [Artificial Intelligence](/solutions/ai/)
  + [Security](/solutions/security/)
  + [Productivity & work transformation](https://workspace.google.com/enterprise/)
  + [Industry solutions](/solutions/#industry-solutions)
  + [DevOps solutions](/solutions/devops/)
  + [Small business solutions](/solutions/#section-14)
  + [See all solutions](/solutions/)
* ### Resources

  + [Google Cloud Affiliate Program](/affiliate-program/)
  + [Google Cloud documentation](/docs/)
  + [Google Cloud quickstarts](/docs/get-started/)
  + [Google Cloud Marketplace](/marketplace/)
  + [Learn about cloud computing](/discover/)
  + [Support](/support-hub/)
  + [Code samples](/docs/samples)
  + [Cloud Architecture Center](/architecture/)
  + [Training](/learn/training/)
  + [Certifications](/learn/certification/)
  + [Google for Developers](//developers.google.com)
  + [Google Cloud for Startups](/startup/)
  + [System status](//status.cloud.google.com)
  + [Release Notes](/release-notes)
* ### Engage

  + [Contact sales](/contact/)
  + [Find a Partner](//cloud.google.com/find-a-partner)
  + [Become a Partner](/partners/become-a-partner/)
  + [Events](/events/)
  + [Podcasts](/podcasts/)
  + [Developer Center](/developers/)
  + [Press Corner](https://www.googlecloudpresscorner.com/)
  + [Google Cloud on YouTube](//www.youtube.com/googlecloud)
  + [Google Cloud Tech on YouTube](//www.youtube.com/googlecloudplatform)
  + [Follow on X](//x.com/googlecloud)
  + [Join User Research](//userresearch.google.com/?reserved=1&utm_source=website&Q_Language=en&utm_medium=own_srch&utm_campaign=CloudWebFooter&utm_term=0&utm_content=0&productTag=clou&campaignDate=jul19&pType=devel&referral_code=jk212693)
  + [We're hiring. Join Google Cloud!](//careers.google.com/cloud)
  + [Google Cloud Community](https://www.googlecloudcommunity.com/)

* [About Google](//about.google/)
* [Privacy](//policies.google.com/privacy)
* [Site terms](//www.google.com/intl/en/policies/terms/regional.html)
* [Google Cloud terms](/product-terms/)
* Manage cookies
* [Our third decade of climate action: join us](/sustainability)
* Sign up for the Google Cloud newsletter
  [Subscribe](/newsletter/)

* English
* Deutsch
* Español – América Latina
* Français
* Indonesia
* Italiano
* Português – Brasil
* 中文 – 简体
* 日本語
* 한국어



=== Content from github.com_a24776ce_20250110_203719.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethyca%2Ffides%2Fsecurity%2Fadvisories%2FGHSA-rcvg-jj3g-rj7c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethyca%2Ffides%2Fsecurity%2Fadvisories%2FGHSA-rcvg-jj3g-rj7c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=ethyca%2Ffides)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ethyca](/ethyca)
/
**[fides](/ethyca/fides)**
Public

* [Notifications](/login?return_to=%2Fethyca%2Ffides) You must be signed in to change notification settings
* [Fork
  73](/login?return_to=%2Fethyca%2Ffides)
* [Star
   382](/login?return_to=%2Fethyca%2Ffides)

* [Code](/ethyca/fides)
* [Issues
  215](/ethyca/fides/issues)
* [Pull requests
  56](/ethyca/fides/pulls)
* [Actions](/ethyca/fides/actions)
* [Projects
  0](/ethyca/fides/projects)
* [Security](/ethyca/fides/security)
* [Insights](/ethyca/fides/pulse)

Additional navigation options

* [Code](/ethyca/fides)
* [Issues](/ethyca/fides/issues)
* [Pull requests](/ethyca/fides/pulls)
* [Actions](/ethyca/fides/actions)
* [Projects](/ethyca/fides/projects)
* [Security](/ethyca/fides/security)
* [Insights](/ethyca/fides/pulse)

# Information Disclosure Vulnerability of BigQuery Secrets in Connection Configuration Endpoints

Moderate

[daveqnet](/daveqnet)
published
GHSA-rcvg-jj3g-rj7c
May 30, 2024

## Package

pip

ethyca-fides
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

< 2.37.0

## Patched versions

2.37.0

## Description

The Fides webserver has a number of endpoints that retrieve `ConnectionConfiguration` records and their associated `secrets` which *can* contain sensitive data (e.g. passwords, private keys, etc.). These `secrets` are stored encrypted at rest (in the application database), and the associated endpoints are not meant to expose that sensitive data in plaintext to API clients, as it could be compromising.

Fides's developers have available to them a Pydantic field-attribute (`sensitive`) that they can annotate as `True` to indicate that a given secret field should not be exposed via the API. The application has an internal function that uses `sensitive` annotations to mask the sensitive fields with a `"**********"` placeholder value.

This vulnerability is due to a bug in that function, which prevented `sensitive` API model fields that were *nested* below the root-level of a `secrets` object from being masked appropriately. Only the `BigQuery` connection configuration secrets meets these criteria: the secrets schema has a nested sensitive `keyfile_creds.private_key` property that is exposed in plaintext via the APIs.

Connection types other than `BigQuery` with sensitive fields at the root-level that are not nested are properly masked with the placeholder and are not affected by this vulnerability.

### Impact

The Google Cloud secrets used for a Fides BigQuery integration may be retrieved in plaintext by any authenticated Admin UI user, except those with the Approver role. Any API users authorized to access the following endpoints may also retrieve the key in plaintext.

Endpoints impacted:

* `GET /api/v1/connections`
* `PATCH /api/v1/connections`
* `GET /api/v1/connection/{connection_key}`
* `PATCH /api/v1/system/{system_key}/connection`
* `GET /api/v1/system/{system_key}`
* `GET /api/v1/system/{system_key}/connection`

Connection config secret schemas impacted:

* `BigQuerySchema`

### Patches

The vulnerability has been patched in Fides version `2.37.0`. Users are advised to upgrade to this version or later to secure their systems against this threat.

Users are also advised to rotate any Google Cloud secrets used for BigQuery integrations in their Fides deployments: <https://cloud.google.com/iam/docs/key-rotation>

### Workarounds

There are no workarounds.

### Proof of concept

Multiple endpoints are impacted, but this PoC will use `GET /api/v1/system/{system_key}` as an example.

1. Using the Admin UI, navigate to `/add-systems`. Add and save a new system `bq_poc`.
2. In the integrations tab of the new system, configure and save a BigQuery integration with secrets.
3. Log in as a different user with any role except Approver and navigate to the `/systems` page.
4. Open the network section of your browser's developer tools.
5. Click on the `bq_poc` system's meatball menu and then click edit.
6. In the network section of browser dev tools you will observe a HTTP GET <http://localhost:8080/api/v1/system/bq_poc/> request. In the body of the JSON response the integration secrets values entered in Step 2 are exposed in plaintext i.e.

```
{
  "secrets": {
    "keyfile_creds": {
      "type": "value",
      "project_id": "value",
      "private_key_id": "value",
      "private_key": "value",
      "client_email": "value",
      "client_id": "value",
      "auth_uri": "value",
      "token_uri": "value",
      "auth_provider_x509_cert_url": "value",
      "client_x509_cert_url": "value"
    }
  }
}
```

### Severity

Moderate

6.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

### CVE ID

CVE-2024-35189

### Weaknesses

[CWE-201](/advisories?query=cwe%3A201)

### Credits

* [![@adamsachs](https://avatars.githubusercontent.com/u/9750285?s=40&v=4)](/adamsachs)
  [adamsachs](/adamsachs)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


