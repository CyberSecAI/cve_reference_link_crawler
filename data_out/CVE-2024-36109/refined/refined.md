Based on the provided content, here's the breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from the way the CoCalc platform handles Markdown rendering. Specifically, it was allowing `<script>` tags to be included within Markdown content and be executed when the content was published. This occurred because the sanitization logic, which attempted to whitelist MathJax script tags, was not working correctly.

**Weaknesses/Vulnerabilities:**
- **Cross-Site Scripting (XSS):** The primary vulnerability is a stored XSS vulnerability. By injecting arbitrary JavaScript code via `<script>` tags within Markdown, an attacker can execute malicious scripts in the context of other users' browsers when they view the rendered content.
- **Inadequate Input Sanitization:** The sanitization logic was flawed, specifically when handling script tags, including those intended for MathJax.

**Impact of Exploitation:**
- **Arbitrary JavaScript Execution:** Successful exploitation allows an attacker to execute arbitrary JavaScript code within a user's browser.
- **Data Theft/Manipulation:** Attackers could potentially steal sensitive information (session cookies, local storage data), manipulate data, deface the website, or redirect users to malicious sites.
- **Account Compromise:** Attackers may be able to take over user accounts by stealing their session cookies.

**Attack Vectors:**
- **Markdown Injection:** The attack vector is the injection of malicious `<script>` tags within Markdown files.
- **Public Content Exposure:** The provided PoC link shows the rendered content being publicly accessible via the share feature. Thus, anyone accessing a published file containing the malicious script would be impacted.

**Required Attacker Capabilities/Position:**
- **CoCalc User Account:** An attacker would need a CoCalc user account to create or modify a Markdown file.
- **Ability to Publish Content:** The attacker needs the ability to publish or share content so that other users can access it.
- **Low Privilege Required**: The advisory mentions low privileges are required to perform this attack.
- **User Interaction**:  User interaction is required for the exploit to occur, i.e. another user needs to view the markdown content with the injected script.

**Additional Details:**
- The fix removes the whitelisting of all script tags, including those for MathJax.
- The fix is in commit `419862a9c9879c7eac5e8fa91633dd998a9fa10d`
- The advisory notes this change may cause user frustration because of the loss of math rendering functionality, but this was seen as the correct security approach.

The content provides a good explanation of the vulnerability, its impact, and how it was fixed.