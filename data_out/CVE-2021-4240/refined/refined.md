The provided content relates to a commit that addresses a security vulnerability, specifically the use of a predictable algorithm in a random number generator (CWE-1241).

**Root cause of vulnerability:**
The application was using `mt_rand()` to generate password reset hashes. `mt_rand()` is known to be cryptographically weak and predictable, which makes the password reset functionality vulnerable.

**Weaknesses/vulnerabilities present:**
- Use of predictable algorithm for generating password reset hashes

**Impact of exploitation:**
An attacker could potentially predict the password reset hashes, allowing them to gain unauthorized access to user accounts by resetting passwords.

**Attack vectors:**
- Attacker would need to observe or infer the output of the `mt_rand()` function to predict future values.
- This could potentially be achieved by repeatedly requesting password reset tokens.

**Required attacker capabilities/position:**
- The attacker would need to have the ability to initiate password reset requests for targeted accounts.
- The attacker also needs knowledge and means of analyzing the output of the vulnerable random number generator.

**Technical Details:**
- The commit replaces `mt_rand()` with `random_bytes()` to generate a cryptographically secure random string for password reset tokens.
- The password reset hash field was changed from a `char(40)` to a `varchar(64)` to accommodate the longer output of the SHA256 hash used with `random_bytes()`.
- The commit also adds dummy call to `password_verify` to prevent timing attacks