=== Content from github.com_0870ec05_20250110_140312.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F447a521aae0f82f791b8116a14a20e276df739be)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F447a521aae0f82f791b8116a14a20e276df739be)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  76](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/447a521aae0f82f791b8116a14a20e276df739be)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Proper escaping of Custom Field name for display

[Browse files](/mantisbt/mantisbt/tree/447a521aae0f82f791b8116a14a20e276df739be)
Browse the repository at this point in the history

```
Fixes XSS vulnerability on
- bug_change_status_page.php (resolving and closing issues)
- view_all_bug_page.php & print_all_bug_page.php (when the custom field
  is selected as a column for display/print)

Fixes #34432, [CVE-2024-34081](https://github.com/advisories/GHSA-wgx7-jp56-65mq "CVE-2024-34081")
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
May 12, 2024

1 parent
[809a4e1](/mantisbt/mantisbt/commit/809a4e1d8ac67aaf74eb5caf3a65317dff122715)

commit 447a521

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**7 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* bug\_change\_status\_page.php
  [bug\_change\_status\_page.php](#diff-c995eaffebee24e324f5025981ae4bd5b22bec01a2155d7c098479d0bcc4e4ae)
* core

  + core/print\_api.php
    [print\_api.php](#diff-d2c13814a8c0ddd76cc70bf4fb7cee120b2692f9be3280532d93823cc6d2dd88)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[bug\_change\_status\_page.php](#diff-c995eaffebee24e324f5025981ae4bd5b22bec01a2155d7c098479d0bcc4e4ae "bug_change_status_page.php")

Show comments

[View file](/mantisbt/mantisbt/blob/447a521aae0f82f791b8116a14a20e276df739be/bug_change_status_page.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -303,7 +303,7 @@ |
|  |  | <tr> |
|  |  | <th class="category"> |
|  |  | <?php if( $t\_require && $t\_has\_write\_access ) {?><span class="required">\*</span><?php } ?> |
|  |  | <?php echo lang\_get\_defaulted( $t\_def['name'] ) ?> |
|  |  | <?php echo string\_attribute( lang\_get\_defaulted( $t\_def['name'] ) ) ?> |
|  |  | </th> |
|  |  | <td> |
|  |  | <?php |
| Expand Down | |  |

7 changes: 6 additions & 1 deletion

7
[core/print\_api.php](#diff-d2c13814a8c0ddd76cc70bf4fb7cee120b2692f9be3280532d93823cc6d2dd88 "core/print_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/447a521aae0f82f791b8116a14a20e276df739be/core/print_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1344,7 +1344,12 @@ function print\_view\_bug\_sort\_link( $p\_string, $p\_sort\_field, $p\_sort, $p\_dir, $p |
|  |  | $t\_sort\_field = rawurlencode( $p\_sort\_field ); |
|  |  | $t\_print\_parameter = ( $p\_columns\_target == COLUMNS\_TARGET\_PRINT\_PAGE ) ? '&print=1' : ''; |
|  |  | $t\_filter\_parameter = filter\_is\_temporary( $g\_filter ) ? filter\_get\_temporary\_key\_param( $g\_filter ) . '&' : ''; |
|  |  | print\_link( 'view\_all\_set.php?' . $t\_filter\_parameter . 'sort\_add=' . $t\_sort\_field . '&dir\_add=' . $p\_dir . '&type=' . FILTER\_ACTION\_PARSE\_ADD . $t\_print\_parameter, $p\_string ); |
|  |  | $t\_url = 'view\_all\_set.php?' . $t\_filter\_parameter |
|  |  | . 'sort\_add=' . $t\_sort\_field |
|  |  | . '&dir\_add=' . $p\_dir |
|  |  | . '&type=' . FILTER\_ACTION\_PARSE\_ADD |
|  |  | . $t\_print\_parameter; |
|  |  | print\_link( $t\_url, string\_attribute( $p\_string ) ); |
|  |  | break; |
|  |  | default: |
|  |  | echo $p\_string; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `447a521`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F447a521aae0f82f791b8116a14a20e276df739be) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from mantisbt.org_c6cc7df4_20250110_140313.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D34432)
[Signup for a new account](/bugs/signup_page.php)

#### View Issue Details

[Wiki](wiki.php?id=34432)[Related Changesets](#changesets)[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0034432 | mantisbt | security | public | 2024-05-04 10:44 | 2024-05-12 15:39 |
|  | | | | | |
|
| Reporter | [unboundeduniverse](https://mantisbt.org/bugs/view_user_page.php?id=80928) | Assigned To | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) |  | |
| Priority | normal | Severity | major | Reproducibility | always |
| Status | closed | Resolution | fixed |  | |
| Product Version | 2.26.1 |  | | | |
| Target Version | 2.26.2 | Fixed in Version | 2.26.2 |  | |
|  | | | | | |
|
| Summary | 0034432: CVE-2024-34081: Unsanitised custom field names printed | | | | |
| Description | Improper escaping of a custom field's name allows an attacker to inject HTML and, if CSP settings permit, achieve execution of arbitrary JavaScript when:   * resolving or closing issues (bug\_change\_status\_page.php) belonging to a project linking said custom field * viewing issues (view\_all\_bug\_page.php) when the custom field is displayed as a column * printing issues (print\_all\_bug\_page.php) when the custom field is displayed as a column   <https://github.com/mantisbt/mantisbt/security/advisories/GHSA-wgx7-jp56-65mq> | | | | |
| Steps To Reproduce | Create a custom field with some html in its name. Create an issue with this custom field. View the issue (view.php). In the status list, choose resolved or closed and click on the "Change Status To:" button. The html in the custom field name is rendered (bug\_change\_status\_page.php) | | | | |
| Additional Information | To fix:  bug\_change\_status\_page.php line 306:  ``` <?php echo lang_get_defaulted( $t_def['name'] ) ?> ```  change to:  ``` <?php echo string_attribute( lang_get_defaulted( $t_def['name'] ) ) ?> ```  similar to [0027304](/bugs/view.php?id=27304 "[closed] CVE-2020-25830: HTML Injection in bug_actiongroup_page.php") | | | | |
| Tags | No tags attached. | | | | |
|  | | | | | |
|

#### Relationships

[Relationship Graph](bug_relationship_graph.php?bug_id=34432&graph=relation)[Dependency Graph](bug_relationship_graph.php?bug_id=34432&graph=dependency)

| related to | [0027304](view.php?id=27304) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | CVE-2020-25830: HTML Injection in bug\_actiongroup\_page.php |
| --- | --- | --- | --- | --- |
| related to | [0034441](view.php?id=34441) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | Excel error when opening exported issues with custom field with special characters |
| related to | [0034442](view.php?id=34442) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | Wrong display of some column titles on "View Issues" page |

#### Activities

| [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)   [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)  2024-05-04 13:49  developer    [~0068884](view.php?id=34432#c68884 "Direct link to note")  Last edited: 2024-05-04 14:33 | I started some tests with such kind of custom fields. "View Issues" and "Print Reports" pages are also affected. |
| --- | --- |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-05-06 06:20  developer    [~0068896](view.php?id=34432#c68896 "Direct link to note") | [@unboundeduniverse](https://mantisbt.org/bugs/view_user_page.php?id=80928) Thanks for the report.   * Please confirm that your Github username is <https://github.com/unboundeduniverse> and if not tell us what it is. * Would you like to be credited for the finding ? If so, please tell us how.   [@atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111) Where do you stand on this issue ? Is your testing completed ? Are you working on a patch or should I do it ?  For now I have opened Advisory [GHSA-wgx7-jp56-65mq](https://github.com/mantisbt/mantisbt/security/advisories/GHSA-wgx7-jp56-65mq) and requested a CVE ID. |
|  | |
| [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)   [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)  2024-05-06 11:12  developer    [~0068904](view.php?id=34432#c68904 "Direct link to note")  Last edited: 2024-05-06 11:17 | [@dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) my testing is completed.  I had also a short look at the code, and found that we don't use only `string_attribute` for custom field names, but also `string_display line`. This should be harmonized to use always `string_attribute` as we don't want valid html tags to be interpreted. e. g. with standard settings of `$g_html_valid_tags_single_line`, `<i>custom field name` will be italic on "View Issue Details" and some other pages. We can treat this as a separate issue, or fix it as part of this issue.  Please create a temporary private fork for the security advisory you created. After that, I could start working on a patch and create a PR.  If you want to have a very quick fix to get out 2.26.2 ASAP in combination with other security related fixes, it would be better if you start working on it. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-05-06 12:17  developer    [~0068905](view.php?id=34432#c68905 "Direct link to note") | OK I will create the private fork.  I also don't mind patching the security issue so we can release a hotfix ASAP if you have no time. I was just asking first, to avoid both of us making the same changes simultaneously.  Just making sure I have not missed anything you may have found in your tests, here is what I have identified:   * [bug\_change\_status\_page.php](https://github.com/mantisbt/mantisbt/blob/60f1bf1d49d8b8a43ef6009ad2de9fa97fcb0cf3/bug_change_status_page.php#L306) * [view\_all\_bug\_page.php & print\_all\_bug\_page.php](https://github.com/mantisbt/mantisbt/blob/60f1bf1d49d8b8a43ef6009ad2de9fa97fcb0cf3/core/print_api.php#L1347)   we don't use only string\_attribute for custom field names, but also string\_display line. This should be harmonized to use always string\_attribute as we don't want valid html tags to be interpreted.  Right.  ``` $ git grep "string_display_line.*def.*name" bug_report_page.php:655:                                        <?php echo string_display_line( lang_get_defaulted( $t_def['name'] ) ) ?> bug_report_page.php:657:                        <?php } else { echo string_display_line( lang_get_defaulted( $t_def['name'] ) ); } ?> bug_update_page.php:718:                echo '<span>', string_display_line( lang_get_defaulted( $t_def['name'] ) ), '</span>'; bug_view_inc.php:653:           echo '<th class="bug-custom-field category">', string_display_line( lang_get_defaulted( $t_def['name'] ) ), '</th>'; core/filter_form_api.php:2085:                          $t_field_name = string_display_line( lang_get_defaulted( column_get_custom_field_name( $t_sort ) ) ); core/filter_form_api.php:2119:                  $t_field_name = string_display_line( lang_get_defaulted( column_get_custom_field_name( $t_column ) ) ); core/filter_form_api.php:2831:                          $t_header = $get_field_header( 'custom_field_' . $t_cfdef['id'] . '_filter', string_display_line( lang_get_defaulted( $t_cfdef['name'] ) ) ); print_all_bug_page_word.php:396:                <?php echo string_display_line( sprintf( lang_get( 'label' ), lang_get_defaulted( $t_def['name'] ) ) ) ?> ```  Any others ? |
|  | |
| [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)   [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)  2024-05-06 12:44  developer    [~0068906](view.php?id=34432#c68906 "Direct link to note") | Concerning  view\_all\_bug\_page.php & print\_all\_bug\_page.php  Wouldn't it be better to fix it on a lower level where the values are finally printed? I thought about a change in `print_link` Something like attached i34432.patch   [i34432.patch](file_download.php?file_id=12602&type=bug) (1,990 bytes)    ``` From b7abf7a490019cbf6767eb79145a5fa2a4c1a138 Mon Sep 17 00:00:00 2001 From: Roland Becker <roland@atrol.de> Date: Mon, 6 May 2024 17:36:50 +0200 Subject: [PATCH] Sanitize custom field names before printing  Fixes #34432 ---  bug_change_status_page.php | 2 +-  core/print_api.php         | 9 +++++----  2 files changed, 6 insertions(+), 5 deletions(-)  diff --git a/bug_change_status_page.php b/bug_change_status_page.php index 427850389..a771f2d6c 100644 --- a/bug_change_status_page.php +++ b/bug_change_status_page.php @@ -303,7 +303,7 @@ layout_page_begin();  	<tr>  		<th class="category">  			<?php if( $t_require && $t_has_write_access ) {?><span class="required">*</span><?php } ?> -			<?php echo lang_get_defaulted( $t_def['name'] ) ?> +			<?php echo string_attribute( lang_get_defaulted( $t_def['name'] ) ) ?>  		</th>  		<td>  <?php diff --git a/core/print_api.php b/core/print_api.php index c52bc3bf8..d7ec8947b 100644 --- a/core/print_api.php +++ b/core/print_api.php @@ -1492,17 +1492,18 @@ function print_bracket_link_prepared( $p_link ) {   * @return void   */  function print_link( $p_link, $p_url_text, $p_new_window = false, $p_class = '' ) { +	$t_url_text = string_attribute( $p_url_text );  	if( is_blank( $p_link ) ) { -		echo $p_url_text; +		echo $t_url_text;  	} else {  		$t_link = htmlspecialchars( $p_link );  		if( $p_new_window === true ) { -			echo '<a class="new-window ' . $p_class . '" href="' . $t_link . '" target="_blank">' . $p_url_text . '</a>'; +			echo '<a class="new-window ' . $p_class . '" href="' . $t_link . '" target="_blank">' . $t_url_text . '</a>';  		} else {  			if( $p_class !== '' ) { -				echo '<a class="' . $p_class . '" href="' . $t_link . '">' . $p_url_text . '</a>'; +				echo '<a class="' . $p_class . '" href="' . $t_link . '">' . $t_url_text . '</a>';  			} else { -				echo '<a href="' . $t_link . '">' . $p_url_text . '</a>'; +				echo '<a href="' . $t_link . '">' . $t_url_text . '</a>';  			}  		}  	} --  2.39.1.windows.1   ```   [i34432.patch](file_download.php?file_id=12602&type=bug) (1,990 bytes) |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-05-06 13:00  developer    [~0068907](view.php?id=34432#c68907 "Direct link to note") | Wouldn't it be better to fix it on a lower level where the values are finally printed?  You're probably right.  I was concerned about those usages where print\_link() is already given an escaped string, in which case we would get double encoding, e.g. `&amp;lt;script&amp;gt;` instead of `&lt;script&gt;` for `<script>`.  But there are only 11 occurrences of print\_link() calls so it should be quick to find and fix them if needed. |
|  | |
| [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)   [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)  2024-05-06 13:17  developer    [~0068908](view.php?id=34432#c68908 "Direct link to note") | I also don't mind patching the security issue so we can release a hotfix ASAP if you have no time.  Would be good if you could patch. I am on travel starting tomorrow very early in the morning. If needed, I could review / test not earlier than Wednesday evening. |
|  | |
| [unboundeduniverse](https://mantisbt.org/bugs/view_user_page.php?id=80928)   [unboundeduniverse](https://mantisbt.org/bugs/view_user_page.php?id=80928)  2024-05-06 14:57  reporter    [~0068909](view.php?id=34432#c68909 "Direct link to note") | Yes that is my Github username. No need for credit. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-05-06 17:50  developer    [~0068910](view.php?id=34432#c68910 "Direct link to note") | Thanks for the feedback [@unboundeduniverse](https://mantisbt.org/bugs/view_user_page.php?id=80928). I have added you to the draft Advisory, so you can access the private repository with the fix. |
|  | |
| [unboundeduniverse](https://mantisbt.org/bugs/view_user_page.php?id=80928)   [unboundeduniverse](https://mantisbt.org/bugs/view_user_page.php?id=80928)  2024-05-07 10:33  reporter    [~0068917](view.php?id=34432#c68917 "Direct link to note") | Just to add a bit of info: if the custom field is set to be required on update then it will appear for all status options when changing status, not just resolved and closed. This doesn't change the fix - it looks ok. |
|  | |
| [unboundeduniverse](https://mantisbt.org/bugs/view_user_page.php?id=80928)   [unboundeduniverse](https://mantisbt.org/bugs/view_user_page.php?id=80928)  2024-05-10 07:15  reporter    [~0068923](view.php?id=34432#c68923 "Direct link to note") | They also should be sanitised in the excel export. Name a custom field as Custom <Field 1 Do an excel export which includes it in the columns. Excel can't open the file because of errors.  excel\_api.php line 102: return '<Cell><Data ss:Type="String">' . $p\_column\_title . '</Data></Cell>';  change it to: return excel\_prepare\_string( $p\_column\_title ); |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2024-05-10 08:39  developer    [~0068924](view.php?id=34432#c68924 "Direct link to note")  Last edited: 2024-05-12 07:00 | Right, good point. I didn't bother testing Excel export as I was focused on HTML injection which is not applicable in this context. Will fix.  Follow-up in [0034441](/bugs/view.php?id=34441 "[closed] Excel error when opening exported issues with custom field with special characters") |
|  | |

#### Related Changesets

| MantisBT: master-2.26 447a521a  2024-05-06 13:04  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=27070) [Diff](https://github.com/mantisbt/mantisbt/commit/447a521aae0f82f791b8116a14a20e276df739be) | Proper escaping of Custom Field name for display | | Affected Issues[0034432](/bugs/view.php?id=34432 "[closed] CVE-2024-34081: Unsanitised custom field names printed"), [0034442](/bugs/view.php?id=34442 "[closed] Wrong display of some column titles on \"View Issues\" page") |
| --- | --- | --- | --- |
| mod - bug\_change\_status\_page.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/447a521aae0f82f791b8116a14a20e276df739be) [File](https://github.com/mantisbt/mantisbt/blob/447a521aae0f82f791b8116a14a20e276df739be/bug_change_status_page.php) |
| mod - core/print\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/447a521aae0f82f791b8116a14a20e276df739be) [File](https://github.com/mantisbt/mantisbt/blob/447a521aae0f82f791b8116a14a20e276df739be/core/print_api.php) |

**Powered by [MantisBT 2.28.0-dev-master-a94bae75d](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1691 seconds



=== Content from github.com_0876c7d5_20250110_140312.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fsecurity%2Fadvisories%2FGHSA-wgx7-jp56-65mq)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fsecurity%2Fadvisories%2FGHSA-wgx7-jp56-65mq)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  76](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

# Cross-site scripting in Custom Field name

Moderate

[dregad](/dregad)
published
GHSA-wgx7-jp56-65mq
May 12, 2024

## Package

composer

mantisbt
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

< 2.26.2

## Patched versions

2.26.2

## Description

Improper escaping of a custom field's name allows an attacker to inject HTML and, if CSP settings permit, achieve execution of arbitrary JavaScript when:

* resolving or closing issues (bug\_change\_status\_page.php) belonging to a project linking said custom field
* viewing issues (view\_all\_bug\_page.php) when the custom field is displayed as a column
* printing issues (print\_all\_bug\_page.php) when the custom field is displayed as a column

### Impact

Cross-site scripting (XSS).

### Patches

[447a521](https://github.com/mantisbt/mantisbt/commit/447a521aae0f82f791b8116a14a20e276df739be)

### Workarounds

Ensure Custom Field Names do not contain HTML tags.

### References

* <https://mantisbt.org/bugs/view.php?id=34432>
* This is related to [CVE-2020-25830](https://github.com/advisories/GHSA-2pm7-q8pc-xhvq "CVE-2020-25830") (same root cause, different affected pages)

### Severity

Moderate

6.6

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
High

User interaction
None

Scope
Changed

Confidentiality
Low

Integrity
Low

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:L

### CVE ID

CVE-2024-34081

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### Credits

* [![@atrol](https://avatars.githubusercontent.com/u/319317?s=40&v=4)](/atrol)
  [atrol](/atrol)
  Analyst
* [![@unboundeduniverse](https://avatars.githubusercontent.com/u/104565877?s=40&v=4)](/unboundeduniverse)
  [unboundeduniverse](/unboundeduniverse)
  Reporter
* [![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)
  [dregad](/dregad)
  Remediation developer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


