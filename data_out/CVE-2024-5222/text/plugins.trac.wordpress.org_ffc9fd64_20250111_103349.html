

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fresponsive-add-ons%2Ftags%2F3.0.4%2Fincludes%2Fclass-responsive-add-ons.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/responsive-add-ons/trunk/includes/class-responsive-add-ons.php?rev=3051604 "Revision 3051604")
* [Next Revision](/browser/responsive-add-ons/trunk/includes/class-responsive-add-ons.php?rev=3087552 "Revision 3087552") →
* [Blame](/browser/responsive-add-ons/trunk/includes/class-responsive-add-ons.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/responsive-add-ons/tags/3.0.4/includes/class-responsive-add-ons.php)

---

# [source:](/browser?order=name "Go to repository root") [responsive-add-ons](/browser/responsive-add-ons?order=name "View responsive-add-ons")/[tags](/browser/responsive-add-ons/tags?order=name "View tags")/[3.0.4](/browser/responsive-add-ons/tags/3.0.4?order=name "View 3.0.4")/[includes](/browser/responsive-add-ons/tags/3.0.4/includes?order=name "View includes")/[class-responsive-add-ons.php](/browser/responsive-add-ons/tags/3.0.4/includes/class-responsive-add-ons.php?order=name "View class-responsive-add-ons.php")

View diff against:

View revision:

| [Last change](/changeset/3078750/responsive-add-ons/trunk/includes/class-responsive-add-ons.php "View differences") on this file was [3078750](/changeset/3078750/ "View changeset 3078750"), checked in by cyberchimps, [9 months ago](/timeline?from=2024-04-29T13%3A34%3A36Z&precision=second "See timeline at 04/29/2024 01:34:36 PM") |
| --- |
| compatible-with-api-plans |
| **File size:** 105.3 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Responsive Addons setup |
| [4](#L4) | \* |
| [5](#L5) | \* @package Responsive\_Addons |
| [6](#L6) | \* @since   1.0.0 |
| [7](#L7) | \*/ |
| [8](#L8) |  |
| [9](#L9) | defined( 'ABSPATH' ) || exit; |
| [10](#L10) |  |
| [11](#L11) | /\*\* |
| [12](#L12) | \* Main Responsive\_Add\_Ons Class. |
| [13](#L13) | \* |
| [14](#L14) | \* @class Responsive\_Add\_Ons |
| [15](#L15) | \*/ |
| [16](#L16) | class Responsive\_Add\_Ons { |
| [17](#L17) |  |
| [18](#L18) | /\*\* |
| [19](#L19) | \* Options |
| [20](#L20) | \* |
| [21](#L21) | \* @since 1.0.0 |
| [22](#L22) | \* @var   array Options |
| [23](#L23) | \*/ |
| [24](#L24) | public $options; |
| [25](#L25) |  |
| [26](#L26) | /\*\* |
| [27](#L27) | \* Options |
| [28](#L28) | \* |
| [29](#L29) | \* @since 1.0.0 |
| [30](#L30) | \* @var   array Plugin Options |
| [31](#L31) | \*/ |
| [32](#L32) | public $plugin\_options; |
| [33](#L33) |  |
| [34](#L34) | /\*\* |
| [35](#L35) | \* API Url |
| [36](#L36) | \* |
| [37](#L37) | \* @since 2.0.0 |
| [38](#L38) | \* @var   string API Url |
| [39](#L39) | \*/ |
| [40](#L40) | public static $api\_url; |
| [41](#L41) |  |
| [42](#L42) | /\*\* |
| [43](#L43) | \* RST Blocks API Url |
| [44](#L44) | \* |
| [45](#L45) | \* @since 2.9.1 |
| [46](#L46) | \* @var   string API Url |
| [47](#L47) | \*/ |
| [48](#L48) | public static $rst\_blocks\_api\_url; |
| [49](#L49) |  |
| [50](#L50) | /\*\* |
| [51](#L51) | \* Favorite Sites |
| [52](#L52) | \* |
| [53](#L53) | \* @since 2.8.6 |
| [54](#L54) | \* @var   array Favorite Sites |
| [55](#L55) | \*/ |
| [56](#L56) |  |
| [57](#L57) | public static $new\_favorites; |
| [58](#L58) |  |
| [59](#L59) | /\*\* |
| [60](#L60) | \* The cyberchimps app auth instance. |
| [61](#L61) | \* |
| [62](#L62) | \* @var Responsive\_Add\_Ons\_App\_Auth |
| [63](#L63) | \*/ |
| [64](#L64) | public $cc\_app\_auth; |
| [65](#L65) |  |
| [66](#L66) | /\*\* |
| [67](#L67) | \* Custom Font CSS. |
| [68](#L68) | \* |
| [69](#L69) | \* @since 3.0.2 |
| [70](#L70) | \* @var string $font\_css |
| [71](#L71) | \*/ |
| [72](#L72) | protected $font\_css = ''; |
| [73](#L73) |  |
| [74](#L74) | /\*\* |
| [75](#L75) | \* Constructor. |
| [76](#L76) | \* |
| [77](#L77) | \* @since 1.0.0 |
| [78](#L78) | \*/ |
| [79](#L79) | public function \_\_construct() { |
| [80](#L80) |  |
| [81](#L81) | add\_action( 'admin\_init', array( $this, 'admin\_init' ) ); |
| [82](#L82) | add\_action( 'admin\_notices', array( $this, 'add\_theme\_installation\_notice' ), 1 ); |
| [83](#L83) | add\_action( 'admin\_notices', array( $this, 'admin\_notices\_product\_welcome\_banner' ), 1 ); |
| [84](#L84) | add\_action( 'wp\_head', array( $this, 'responsive\_head' ) ); |
| [85](#L85) | add\_action( 'plugins\_loaded', array( $this, 'responsive\_addons\_translations' ) ); |
| [86](#L86) | $plugin = plugin\_basename( \_\_FILE\_\_ ); |
| [87](#L87) | add\_filter( "plugin\_action\_links\_$plugin", array( $this, 'plugin\_settings\_link' ) ); |
| [88](#L88) |  |
| [89](#L89) | $settings = self::raddons\_get\_white\_label\_settings(); |
| [90](#L90) | if ( ! function\_exists( 'is\_plugin\_active' ) ) { |
| [91](#L91) | include\_once ABSPATH . 'wp-admin/includes/plugin.php'; |
| [92](#L92) | } |
| [93](#L93) | if ( ! is\_plugin\_active( 'responsive-addons-pro/responsive-addons-pro.php' ) ) { |
| [94](#L94) | $this->load\_responsive\_addons\_nav\_walkers(); |
| [95](#L95) | } |
| [96](#L96) | $this->load\_responsive\_customizer\_settings(); |
| [97](#L97) |  |
| [98](#L98) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/custom-fonts/class-responsive-add-ons-custom-fonts-taxonomy.php'; |
| [99](#L99) |  |
| [100](#L100) | // Responsive Ready Site Importer Menu. |
| [101](#L101) | add\_action( 'admin\_enqueue\_scripts', array( $this, 'responsive\_ready\_sites\_admin\_enqueue\_scripts' ) ); |
| [102](#L102) |  |
| [103](#L103) | add\_action( 'admin\_enqueue\_scripts', array( $this, 'responsive\_ready\_sites\_admin\_enqueue\_styles' ) ); |
| [104](#L104) |  |
| [105](#L105) | add\_action( 'admin\_enqueue\_scripts', array( $this, 'responsive\_addons\_admin\_enqueue\_getting\_started\_scripts\_styles' ) ); |
| [106](#L106) |  |
| [107](#L107) | add\_action( 'elementor/editor/footer', array( $this, 'responsive\_ready\_sites\_insert\_templates' ) ); |
| [108](#L108) |  |
| [109](#L109) | add\_action( 'elementor/editor/footer', array( $this, 'responsive\_ready\_sites\_register\_widget\_scripts' ), 99 ); |
| [110](#L110) |  |
| [111](#L111) | add\_action( 'elementor/editor/before\_enqueue\_scripts', array( $this, 'responsive\_ready\_sites\_elementor\_styles' ) ); |
| [112](#L112) |  |
| [113](#L113) | add\_action( 'elementor/preview/enqueue\_styles', array( $this, 'responsive\_ready\_sites\_elementor\_styles' ) ); |
| [114](#L114) |  |
| [115](#L115) | if ( ! is\_plugin\_active( 'responsive-addons-pro/responsive-addons-pro.php' ) ) { |
| [116](#L116) | add\_action( 'admin\_enqueue\_scripts', array( $this, 'responsive\_addons\_enqueue\_custom\_fonts' ) ); |
| [117](#L117) |  |
| [118](#L118) | add\_action( 'admin\_menu', array( $this, 'responsive\_addons\_register\_custom\_fonts\_menu' ), 101 ); |
| [119](#L119) |  |
| [120](#L120) | add\_action( 'admin\_head', array( $this, 'responsive\_addons\_custom\_fonts\_menu\_highlight' ) ); |
| [121](#L121) |  |
| [122](#L122) | add\_filter( 'manage\_edit-' . Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::$register\_taxonomy\_slug . '\_columns', array( $this, 'responsive\_addons\_manage\_columns' ) ); |
| [123](#L123) |  |
| [124](#L124) | add\_action( Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::$register\_taxonomy\_slug . '\_add\_form\_fields', array( $this, 'responsive\_addons\_add\_new\_taxonomy\_data' ) ); |
| [125](#L125) |  |
| [126](#L126) | add\_action( Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::$register\_taxonomy\_slug . '\_edit\_form\_fields', array( $this, 'responsive\_addons\_edit\_taxonomy\_data' ) ); |
| [127](#L127) |  |
| [128](#L128) | add\_action( 'edited\_' . Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::$register\_taxonomy\_slug, array( $this, 'responsive\_addons\_save\_metadata' ) ); |
| [129](#L129) | add\_action( 'create\_' . Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::$register\_taxonomy\_slug, array( $this, 'responsive\_addons\_save\_metadata' ) ); |
| [130](#L130) |  |
| [131](#L131) | add\_filter( 'upload\_mimes', array( $this, 'responsive\_addons\_add\_fonts\_to\_allowed\_mimes' ) ); |
| [132](#L132) | add\_filter( 'wp\_check\_filetype\_and\_ext', array( $this, 'responsive\_addons\_update\_mime\_types' ), 10, 3 ); |
| [133](#L133) |  |
| [134](#L134) | add\_action( 'responsive\_render\_fonts', array( $this, 'responsive\_addons\_render\_fonts' ) ); |
| [135](#L135) | add\_action( 'responsive\_customizer\_font\_list', array( $this, 'responsive\_addons\_add\_customizer\_font\_list' ) ); |
| [136](#L136) | add\_action( 'wp\_head', array( $this, 'responsive\_addons\_add\_style' ) ); |
| [137](#L137) | } |
| [138](#L138) |  |
| [139](#L139) | if ( is\_admin() ) { |
| [140](#L140) | if ( ! is\_plugin\_active( 'responsive-addons-pro/responsive-addons-pro.php' ) ) { |
| [141](#L141) | add\_action( 'enqueue\_block\_assets', array( $this, 'responsive\_addons\_add\_style' ) ); |
| [142](#L142) | } |
| [143](#L143) | add\_action( 'wp\_ajax\_responsive-ready-sites-activate-theme', array( $this, 'activate\_theme' ) ); |
| [144](#L144) | add\_action( 'wp\_ajax\_responsive-ready-sites-required-plugins', array( $this, 'required\_plugin' ) ); |
| [145](#L145) | add\_action( 'wp\_ajax\_responsive-ready-sites-install-required-pro-plugins', array( $this, 'install\_pro\_plugin' ) ); |
| [146](#L146) | add\_action( 'wp\_ajax\_responsive-ready-sites-required-plugin-activate', array( $this, 'required\_plugin\_activate' ) ); |
| [147](#L147) | add\_action( 'wp\_ajax\_responsive-ready-sites-remote-request', array( $this, 'remote\_request' ) ); |
| [148](#L148) | add\_action( 'wp\_ajax\_responsive-ready-sites-elementor\_page\_import\_process', array( $this, 'elementor\_page\_import\_process' ) ); |
| [149](#L149) | add\_action( 'wp\_ajax\_responsive-ready-sites-set-reset-data', array( $this, 'set\_reset\_data' ) ); |
| [150](#L150) | add\_action( 'wp\_ajax\_responsive-ready-sites-backup-settings', array( $this, 'backup\_settings' ) ); |
| [151](#L151) | add\_action( 'wp\_ajax\_responsive-is-theme-active', array( $this, 'check\_responsive\_theme\_active' ) ); |
| [152](#L152) | add\_action( 'wp\_ajax\_get-responsive', array( $this, 'get\_responsive\_theme' ) ); |
| [153](#L153) | add\_action( 'wp\_ajax\_responsive-sites-create-template', array( $this, 'create\_elementor\_template' ) ); |
| [154](#L154) | add\_action( 'wp\_ajax\_nopriv\_responsive\_ready\_sites\_welcome\_banner\_dismiss\_notice', array( $this, 'responsive\_ready\_sites\_welcome\_banner\_dismiss\_notice' ) ); |
| [155](#L155) | add\_action( 'wp\_ajax\_responsive\_ready\_sites\_welcome\_banner\_dismiss\_notice', array( $this, 'responsive\_ready\_sites\_welcome\_banner\_dismiss\_notice' ) ); |
| [156](#L156) |  |
| [157](#L157) | // Dismiss admin notice. |
| [158](#L158) | add\_action( 'wp\_ajax\_responsive-notice-dismiss', array( $this, 'dismiss\_notice' ) ); |
| [159](#L159) | // Check if Responsive Addons pro plugin is active. |
| [160](#L160) | add\_action( 'wp\_ajax\_check-responsive-add-ons-pro-installed', array( $this, 'is\_responsive\_pro\_is\_installed' ) ); |
| [161](#L161) |  |
| [162](#L162) | // Check if Responsive Addons pro license is active. |
| [163](#L163) | add\_action( 'wp\_ajax\_check-responsive-add-ons-pro-license-active', array( $this, 'is\_responsive\_pro\_license\_is\_active' ) ); |
| [164](#L164) |  |
| [165](#L165) | // Update first time activation. |
| [166](#L166) | add\_action( 'wp\_ajax\_update-first-time-activation', array( $this, 'update\_first\_time\_activation\_variable' ) ); |
| [167](#L167) |  |
| [168](#L168) | add\_action( 'wp\_ajax\_responsive-sites-favorite', array( $this, 'add\_to\_favorite' ) ); |
| [169](#L169) | add\_action( 'wp\_ajax\_responsive-favorite-site-details', array( $this, 'get\_favorite\_template\_site\_details' ) ); |
| [170](#L170) | add\_action( 'wp\_ajax\_responsive-update\_all\_sites\_fav\_status', array( $this, 'update\_all\_sites\_fav\_status' ) ); |
| [171](#L171) | add\_action( 'wp\_ajax\_responsive-ready-sites-add-subscriber-to-moosend', array( $this, 'ready\_sites\_add\_subscriber\_to\_moosend' ) ); |
| [172](#L172) | add\_filter( 'wp\_prepare\_themes\_for\_js', \_\_CLASS\_\_ . '::responsive\_theme\_white\_label\_update\_branding' ); |
| [173](#L173) | add\_filter( 'update\_right\_now\_text', array( $this, 'admin\_dashboard\_page' ) ); |
| [174](#L174) | add\_filter( 'gettext', array( $this, 'theme\_gettext' ), 20, 3 ); |
| [175](#L175) |  |
| [176](#L176) | if ( ! empty( $settings['theme\_icon\_url'] ) ) { |
| [177](#L177) | add\_filter( 'responsive\_admin\_menu\_icon', array( $this, 'update\_admin\_brand\_logo' ) ); |
| [178](#L178) | add\_filter( 'responsive\_admin\_menu\_footer\_icon', array( $this, 'update\_admin\_brand\_logo' ) ); |
| [179](#L179) | } |
| [180](#L180) |  |
| [181](#L181) | add\_action( 'responsive\_addons\_getting\_started\_settings\_tab', array( $this, 'responsive\_addons\_getting\_started\_settings\_tab' ) ); |
| [182](#L182) | add\_action( 'responsive\_addons\_getting\_started\_settings\_tab\_content', array( $this, 'responsive\_addons\_getting\_started\_settings\_tab\_content' ) ); |
| [183](#L183) | add\_action( 'responsive\_add\_ons\_white\_label\_section', array( $this, 'responsive\_add\_ons\_white\_label\_section' ) ); |
| [184](#L184) | add\_action( 'wp\_ajax\_responsive-pro-white-label-settings', array( $this, 'responsive\_pro\_white\_label\_settings' ) ); |
| [185](#L185) | add\_action( 'wp\_ajax\_responsive-pro-enable-megamenu', array( $this, 'responsive\_pro\_enable\_megamenu' ) ); |
| [186](#L186) | add\_action( 'wp\_ajax\_responsive-pro-enable-woocommerce', array( $this, 'responsive\_pro\_enable\_woocommerce' ) ); |
| [187](#L187) |  |
| [188](#L188) | // Get current installation import permissions. |
| [189](#L189) | add\_action( 'wp\_ajax\_responsive-ready-sites-get-import-capabilities', array( $this, 'responsive\_addons\_get\_user\_import\_capabilities' ) ); |
| [190](#L190) | add\_action( 'updated\_option', array( $this, 'responsive\_addons\_updated\_option' ), 10, 3 ); |
| [191](#L191) | } |
| [192](#L192) |  |
| [193](#L193) | if ( ! empty( $settings['theme\_name'] ) ) { |
| [194](#L194) | add\_filter( 'responsive\_theme\_footer\_theme\_text', array( $this, 'white\_label\_theme\_powered\_by\_text' ) ); |
| [195](#L195) | } |
| [196](#L196) | if ( ! empty( $settings['plugin\_website\_uri'] ) ) { |
| [197](#L197) | add\_filter( 'responsive\_theme\_footer\_link', array( $this, 'white\_label\_theme\_powered\_by\_link' ) ); |
| [198](#L198) | } |
| [199](#L199) |  |
| [200](#L200) | // Responsive Addons Menu. |
| [201](#L201) | add\_action( 'admin\_menu', array( $this, 'responsive\_add\_ons\_admin\_menu' ) ); |
| [202](#L202) | add\_action( 'responsive\_register\_admin\_menu', array( $this, 'rst\_register\_admin\_menu' ), 11 ); |
| [203](#L203) |  |
| [204](#L204) | // Remove all admin notices from specific pages. |
| [205](#L205) | add\_action( 'admin\_init', array( $this, 'responsive\_add\_ons\_on\_admin\_init' ) ); |
| [206](#L206) |  |
| [207](#L207) | $this->options        = get\_option( 'responsive\_theme\_options' ); |
| [208](#L208) | $this->plugin\_options = get\_option( 'responsive\_addons\_options' ); |
| [209](#L209) |  |
| [210](#L210) | $this->load\_responsive\_sites\_importer(); |
| [211](#L211) | $this->load\_responsive\_addons\_cc\_app\_auth(); |
| [212](#L212) |  |
| [213](#L213) | add\_action( 'responsive\_addons\_importer\_page', array( $this, 'menu\_callback' ) ); |
| [214](#L214) |  |
| [215](#L215) | // Add rating links to the Responsive Addons Admin Page. |
| [216](#L216) | add\_filter( 'admin\_footer\_text', array( $this, 'responsive\_addons\_admin\_rate\_us' ) ); |
| [217](#L217) |  |
| [218](#L218) | add\_filter( 'plugin\_action\_links\_responsive-add-ons/responsive-add-ons.php', array( $this, 'responsive\_add\_view\_library\_btn')); |
| [219](#L219) |  |
| [220](#L220) | add\_action( 'init', array( $this, 'app\_output\_buffer' ) ); |
| [221](#L221) |  |
| [222](#L222) | add\_action( 'responsive\_theme\_setting\_item', array( $this, 'responsive\_theme\_app\_connection\_setting\_item' ) ); |
| [223](#L223) |  |
| [224](#L224) | add\_action( 'responsive\_add\_ons\_app\_connection\_setting', array( $this, 'responsive\_add\_ons\_app\_connection\_setting\_content' ) ); |
| [225](#L225) | if ( ! function\_exists( 'responsive\_pro\_css' ) ) { |
| [226](#L226) | add\_action( 'wp\_enqueue\_scripts', array( $this, 'responsive\_pro\_css' ) ); |
| [227](#L227) | } |
| [228](#L228) |  |
| [229](#L229) | if ( 'on' === get\_option( 'rpro\_woocommerce\_enable' ) ) { |
| [230](#L230) | add\_action( 'after\_setup\_theme', array( $this, 'load\_woocommerce' ) ); |
| [231](#L231) | } |
| [232](#L232) |  |
| [233](#L233) | self::set\_api\_url(); |
| [234](#L234) | self::set\_rst\_blocks\_api\_url(); |
| [235](#L235) | } |
| [236](#L236) |  |
| [237](#L237) | /\*\* |
| [238](#L238) | \* Updates the variable defined for first time activation. |
| [239](#L239) | \*/ |
| [240](#L240) | public function update\_first\_time\_activation\_variable() { |
| [241](#L241) | update\_option( 'ra\_first\_time\_activation', false ); |
| [242](#L242) | } |
| [243](#L243) |  |
| [244](#L244) | /\*\* |
| [245](#L245) | \* Loads Responsive Nav Walkers. |
| [246](#L246) | \*/ |
| [247](#L247) | public function load\_responsive\_addons\_nav\_walkers() { |
| [248](#L248) | if ( ! class\_exists( 'Responsive\_Addons\_Custom\_Nav\_Walker' ) ) { |
| [249](#L249) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . '/includes/megamenu/class-responsive-addons-nav-walker.php'; |
| [250](#L250) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . '/includes/megamenu/class-responsive-addons-custom-nav-walker.php'; |
| [251](#L251) | } |
| [252](#L252) | } |
| [253](#L253) |  |
| [254](#L254) | /\*\* |
| [255](#L255) | \* Loads Responsive Woocommerce Customizer Settings. |
| [256](#L256) | \*/ |
| [257](#L257) | public function load\_responsive\_customizer\_settings() { |
| [258](#L258) |  |
| [259](#L259) | /\*\* |
| [260](#L260) | \* Responsive Addons Pro Customizer Controls. |
| [261](#L261) | \*/ |
| [262](#L262) | require plugin\_dir\_path( \_\_FILE\_\_ ) . 'customizer/class-responsive-addons-pro-customizer-controls.php'; |
| [263](#L263) |  |
| [264](#L264) | if ( 'on' === get\_option( 'rpro\_woocommerce\_enable' ) ) { |
| [265](#L265) | /\*\* |
| [266](#L266) | \* The class responsible for loading the Woocommerce Typography options |
| [267](#L267) | \*/ |
| [268](#L268) | if ( ! class\_exists( 'Responsive\_Addons\_Woocommerce\_Typography' ) ) { |
| [269](#L269) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/compatibility/woocommerce/customizer/settings/class-responsive-addons-woocommerce-typography.php'; |
| [270](#L270) | } |
| [271](#L271) |  |
| [272](#L272) | /\*\* |
| [273](#L273) | \* The class responsible for loading the Shop Pagination options |
| [274](#L274) | \*/ |
| [275](#L275) | if ( ! class\_exists( 'Responsive\_Addons\_Woocommerce\_Shop\_Pagination' ) ) { |
| [276](#L276) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/compatibility/woocommerce/customizer/settings/class-responsive-addons-woocommerce-shop-pagination.php'; |
| [277](#L277) | } |
| [278](#L278) |  |
| [279](#L279) | /\*\* |
| [280](#L280) | \* The class responsible for loading the Breadcrumb and Toolbar disable options |
| [281](#L281) | \*/ |
| [282](#L282) | if ( ! class\_exists( 'Responsive\_Addons\_Woocommerce\_Product\_Catalog' ) ) { |
| [283](#L283) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/compatibility/woocommerce/customizer/settings/class-responsive-addons-woocommerce-product-catalog.php'; |
| [284](#L284) | } |
| [285](#L285) |  |
| [286](#L286) | /\*\* |
| [287](#L287) | \* The class responsible for loading the Header Cart Icon options |
| [288](#L288) | \*/ |
| [289](#L289) | if ( ! class\_exists( 'Responsive\_Addons\_Woocommerce\_Cart' ) ) { |
| [290](#L290) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/compatibility/woocommerce/customizer/settings/class-responsive-addons-woocommerce-cart.php'; |
| [291](#L291) | } |
| [292](#L292) |  |
| [293](#L293) | /\*\* |
| [294](#L294) | \* The class responsible for loading the Woocommerce Typography options |
| [295](#L295) | \*/ |
| [296](#L296) | if ( ! class\_exists( 'Responsive\_Addons\_Woocommerce\_Single\_Product' ) ) { |
| [297](#L297) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/compatibility/woocommerce/customizer/settings/class-responsive-addons-woocommerce-single-product.php'; |
| [298](#L298) | } |
| [299](#L299) | } |
| [300](#L300) |  |
| [301](#L301) | /\*\* |
| [302](#L302) | \* The class responsible for loading the Custom Styles |
| [303](#L303) | \*/ |
| [304](#L304) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/customizer/custom-styles.php'; |
| [305](#L305) |  |
| [306](#L306) | /\*\* |
| [307](#L307) | \* The class responsible for loading the footer customizer options |
| [308](#L308) | \*/ |
| [309](#L309) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/compatibility/woocommerce/customizer/customizer.php'; |
| [310](#L310) |  |
| [311](#L311) | /\*\* |
| [312](#L312) | \* The class responsible for loading the helper functions for Customizer |
| [313](#L313) | \*/ |
| [314](#L314) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/customizer/helper.php'; |
| [315](#L315) | } |
| [316](#L316) |  |
| [317](#L317) | /\*\* |
| [318](#L318) | \* Admin notice - install responsive theme |
| [319](#L319) | \*/ |
| [320](#L320) | public function add\_theme\_installation\_notice() { |
| [321](#L321) |  |
| [322](#L322) | $theme = wp\_get\_theme(); |
| [323](#L323) | global $pagenow; |
| [324](#L324) |  |
| [325](#L325) | if ( 'index.php' !== $pagenow || 'Responsive' === $theme->name || 'Responsive' === $theme->parent\_theme || $this->is\_activation\_theme\_notice\_expired() || is\_plugin\_active( 'responsive-addons-pro/responsive-addons-pro.php' ) ) { |
| [326](#L326) | return; |
| [327](#L327) | } |
| [328](#L328) |  |
| [329](#L329) | $class = 'responsive-notice notice notice-error'; |
| [330](#L330) |  |
| [331](#L331) | $theme\_status = 'responsive-sites-theme-' . $this->get\_theme\_status(); |
| [332](#L332) |  |
| [333](#L333) | $image\_path = RESPONSIVE\_ADDONS\_URI . 'admin/images/responsive-starter-templates-thumbnail.jpg'; |
| [334](#L334) | ?> |
| [335](#L335) | <div id="responsive-theme-activation" class="<?php echo esc\_attr( $class ); ?>"> |
| [336](#L336) | <div class="responsive-addons-message-inner"> |
| [337](#L337) | <div class="responsive-addons-message-icon"> |
| [338](#L338) | <div class=""> |
| [339](#L339) | <img src="<?php echo esc\_attr( $image\_path ); ?>" alt="Responsive Starter Templates"> |
| [340](#L340) | </div> |
| [341](#L341) | </div> |
| [342](#L342) | <div class="responsive-addons-message-content"> |
| [343](#L343) | <p><?php echo esc\_html( 'Responsive theme needs to be active to use the Responsive Starter Templates plugin.' ); ?> </p> |
| [344](#L344) | <p class="responsive-addons-message-actions"> |
| [345](#L345) | <a href="#" class="<?php echo esc\_attr( $theme\_status ); ?> button button-primary" data-theme-slug="responsive">Install & Activate Now</a> |
| [346](#L346) | </p> |
| [347](#L347) | </div> |
| [348](#L348) | </div> |
| [349](#L349) | </div> |
| [350](#L350) | <?php |
| [351](#L351) | } |
| [352](#L352) |  |
| [353](#L353) | /\*\* |
| [354](#L354) | \* Dashboard Welcome Banner. |
| [355](#L355) | \*/ |
| [356](#L356) | public function admin\_notices\_product\_welcome\_banner() { |
| [357](#L357) | global $pagenow; |
| [358](#L358) | if ( ( 'index.php' === $pagenow ) && ! get\_transient( 'responsive\_ready\_sites\_welcome\_banner\_dismissed\_notice' ) ) { |
| [359](#L359) | $image\_path\_underline = RESPONSIVE\_ADDONS\_URI . 'admin/images/underline.png'; |
| [360](#L360) | $image\_path\_close     = RESPONSIVE\_ADDONS\_URI . 'admin/images/close\_icon.png'; |
| [361](#L361) | if ( !is\_plugin\_active( 'responsive-addons-pro/responsive-addons-pro.php' )){ |
| [362](#L362) | ?> |
| [363](#L363) | <div id="responsive-welcome\_banner-section" class="responsive-notice notice"> |
| [364](#L364) | <div class="reponsive-welcome\_banner-welcome-section"> |
| [365](#L365) | <div class="reponsive-welcome\_banner-welcome-section-content"> |
| [366](#L366) | <h1 class="reponsive-welcome\_banner-welcome-section-text"><?php echo esc\_html\_\_( 'Welcome To Responsive Starter Templates', 'responsive-addons' ); ?></h1> |
| [367](#L367) | <img src="<?php echo esc\_attr( $image\_path\_underline ); ?>" alt="underline" class="underline\_image"> |
| [368](#L368) | <p class="reponsive-welcome\_banner-welcome-section-tag"><?php echo esc\_html\_\_( 'Create professionally designed pixel-perfect websites in minutes.' ); ?></p> |
| [369](#L369) | <a class="responsive-welcome\_banner-explore-button" href="<?php echo esc\_url( admin\_url( 'admin.php?page=responsive\_add\_ons' ) ); ?>"><?php echo esc\_html\_\_( 'Explore Templates', 'responsive-addons' ); ?></a> |
| [370](#L370) | </div> |
| [371](#L371) | <a class="responsive-welcome\_banner-close-icon" id="rst\_welcome\_banner\_close\_icon" href="#"> |
| [372](#L372) | <img src="<?php echo esc\_attr( $image\_path\_close ); ?>" alt="close"> |
| [373](#L373) | </a> |
| [374](#L374) | </div> |
| [375](#L375) | <div class="responsive-welcome\_banner-features-section"> |
| [376](#L376) | <div class="responsive-welcome\_banner-features"> |
| [377](#L377) | <h4>Features</h4> |
| [378](#L378) | <div class="responsive-welcome\_banner-feature-rows-section"> |
| [379](#L379) | <div class="responsive-welcome\_banner-features-row"> |
| [380](#L380) | <div class="feature-row"> |
| [381](#L381) | <span class="dashicons dashicons-saved"></span> |
| [382](#L382) | <p class="feature-row-text"><?php echo esc\_html\_\_( 'Loads Blazing Fast', 'responsive-addons' ); ?></p> |
| [383](#L383) | </div> |
| [384](#L384) | <div class="feature-row"> |
| [385](#L385) | <span class="dashicons dashicons-saved"></span> |
| [386](#L386) | <p class="feature-row-text"><?php echo esc\_html\_\_( 'Customizable Settings', 'responsive-addons' ); ?></p> |
| [387](#L387) | </div> |
| [388](#L388) | </div> |
| [389](#L389) | <div class="responsive-welcome\_banner-features-row"> |
| [390](#L390) | <div class="feature-row"> |
| [391](#L391) | <span class="dashicons dashicons-saved"></span> |
| [392](#L392) | <p class="feature-row-text"><?php echo esc\_html\_\_( 'Pre-designed pages', 'responsive-addons' ); ?></p> |
| [393](#L393) | </div> |
| [394](#L394) | <div class="feature-row"> |
| [395](#L395) | <span class="dashicons dashicons-saved"></span> |
| [396](#L396) | <p class="feature-row-text"><?php echo esc\_html\_\_( 'Contact Form', 'responsive-addons' ); ?></p> |
| [397](#L397) | </div> |
| [398](#L398) | </div> |
| [399](#L399) | <div class="responsive-welcome\_banner-features-row"> |
| [400](#L400) | <div class="feature-row"> |
| [401](#L401) | <span class="dashicons dashicons-saved"></span> |
| [402](#L402) | <p class="feature-row-text"><?php echo esc\_html\_\_( 'In-time Support', 'responsive-addons' ); ?></p> |
| [403](#L403) | </div> |
| [404](#L404) | <div class="feature-row"> |
| [405](#L405) | <span class="dashicons dashicons-saved"></span> |
| [406](#L406) | <p class="feature-row-text"><?php echo esc\_html\_\_( '1- Click Import', 'responsive-addons' ); ?></p> |
| [407](#L407) | </div> |
| [408](#L408) | </div> |
| [409](#L409) | </div> |
| [410](#L410) | </div> |
| [411](#L411) | <a href="<?php echo esc\_url( 'https://cyberchimps.com/pricing/?utm\_source=RST\_plugin&utm\_medium=intro\_banner&utm\_campaign=free-to-pro' ); ?>" target="\_blank" class="responsive-welcome\_banner-upgrade-button"> |
| [412](#L412) | <p class="upgrade-button-text"><?php echo esc\_html\_\_( 'Upgrade To Pro', 'responsive-addons' ); ?> </p> |
| [413](#L413) | <span class="dashicons dashicons-arrow-right-alt"></span> |
| [414](#L414) | </a> |
| [415](#L415) | </div> |
| [416](#L416) | <div class="responsive-welcome\_banner-images\_collection"> |
| [417](#L417) | <div class="rst\_welcomeBanner\_image1"></div> |
| [418](#L418) | <div class="rst\_welcomeBanner\_image2"></div> |
| [419](#L419) | <div class="rst\_welcomeBanner\_image3"></div> |
| [420](#L420) | </div> |
| [421](#L421) | </div> |
| [422](#L422) | <?php |
| [423](#L423) | } |
| [424](#L424) | } |
| [425](#L425) | } |
| [426](#L426) |  |
| [427](#L427) | /\*\* |
| [428](#L428) | \* Dismiss Dashboard Welcome Banner. |
| [429](#L429) | \*/ |
| [430](#L430) | public function responsive\_ready\_sites\_welcome\_banner\_dismiss\_notice() { |
| [431](#L431) | check\_ajax\_referer( 'responsive-addons', '\_ajax\_nonce' ); |
| [432](#L432) | if ( isset( $\_POST['action'] ) && 'responsive\_ready\_sites\_welcome\_banner\_dismiss\_notice' === $\_POST['action'] ) { |
| [433](#L433) | set\_transient( 'responsive\_ready\_sites\_welcome\_banner\_dismissed\_notice', true, 10 \* YEAR\_IN\_SECONDS ); |
| [434](#L434) | wp\_send\_json\_success(); |
| [435](#L435) | } else { |
| [436](#L436) | wp\_send\_json\_error(); |
| [437](#L437) | } |
| [438](#L438) | wp\_die(); |
| [439](#L439) | } |
| [440](#L440) |  |
| [441](#L441) | /\*\* |
| [442](#L442) | \* Is notice expired? |
| [443](#L443) | \* |
| [444](#L444) | \* @since 2.0.3 |
| [445](#L445) | \* |
| [446](#L446) | \* @return boolean |
| [447](#L447) | \*/ |
| [448](#L448) | public static function is\_activation\_theme\_notice\_expired() { |
| [449](#L449) |  |
| [450](#L450) | // Check the user meta status if current notice is dismissed. |
| [451](#L451) | $meta\_status = get\_user\_meta( get\_current\_user\_id(), 'responsive-theme-activation', true ); |
| [452](#L452) |  |
| [453](#L453) | if ( empty( $meta\_status ) ) { |
| [454](#L454) | return false; |
| [455](#L455) | } |
| [456](#L456) |  |
| [457](#L457) | return true; |
| [458](#L458) | } |
| [459](#L459) |  |
| [460](#L460) | /\*\* |
| [461](#L461) | \* Dismiss Notice. |
| [462](#L462) | \* |
| [463](#L463) | \* @since 2.0.3 |
| [464](#L464) | \* @return void |
| [465](#L465) | \*/ |
| [466](#L466) | public function dismiss\_notice() { |
| [467](#L467) | check\_ajax\_referer( 'responsive-addons', '\_ajax\_nonce' ); |
| [468](#L468) |  |
| [469](#L469) | if ( ! current\_user\_can( 'install\_plugins' ) ) { |
| [470](#L470) | wp\_send\_json\_error( \_\_( 'You are not allowed to activate the Theme', 'responsive-addons' ) ); |
| [471](#L471) | } |
| [472](#L472) |  |
| [473](#L473) | $notice\_id = ( isset( $\_POST['notice\_id'] ) ) ? sanitize\_key( $\_POST['notice\_id'] ) : ''; |
| [474](#L474) |  |
| [475](#L475) | // check for Valid input. |
| [476](#L476) | if ( ! empty( $notice\_id ) ) { |
| [477](#L477) | update\_user\_meta( get\_current\_user\_id(), $notice\_id, 'notice-dismissed' ); |
| [478](#L478) | wp\_send\_json\_success(); |
| [479](#L479) | } |
| [480](#L480) |  |
| [481](#L481) | wp\_send\_json\_error(); |
| [482](#L482) | } |
| [483](#L483) |  |
| [484](#L484) | /\*\* |
| [485](#L485) | \* Activate theme |
| [486](#L486) | \* |
| [487](#L487) | \* @since 2.0.3 |
| [488](#L488) | \* @return void |
| [489](#L489) | \*/ |
| [490](#L490) | public function activate\_theme() { |
| [491](#L491) |  |
| [492](#L492) | check\_ajax\_referer( 'responsive-addons', '\_ajax\_nonce' ); |
| [493](#L493) |  |
| [494](#L494) | if ( ! current\_user\_can( 'switch\_themes' ) ) { |
| [495](#L495) | wp\_send\_json\_error( \_\_( 'You are not allowed to activate the Theme', 'responsive-addons' ) ); |
| [496](#L496) | } |
| [497](#L497) |  |
| [498](#L498) | switch\_theme( 'responsive' ); |
| [499](#L499) |  |
| [500](#L500) | wp\_send\_json\_success( |
| [501](#L501) | array( |
| [502](#L502) | 'success' => true, |
| [503](#L503) | 'message' => \_\_( 'Theme Activated', 'responsive-addons' ), |
| [504](#L504) | ) |
| [505](#L505) | ); |
| [506](#L506) | } |
| [507](#L507) |  |
| [508](#L508) | /\*\* |
| [509](#L509) | \* Get theme install, active or inactive status. |
| [510](#L510) | \* |
| [511](#L511) | \* @since 1.3.2 |
| [512](#L512) | \* |
| [513](#L513) | \* @return string Theme status |
| [514](#L514) | \*/ |
| [515](#L515) | public function get\_theme\_status() { |
| [516](#L516) |  |
| [517](#L517) | $theme = wp\_get\_theme(); |
| [518](#L518) |  |
| [519](#L519) | // Theme installed and activate. |
| [520](#L520) | if ( 'Responsive' === $theme->name || 'Responsive' === $theme->parent\_theme ) { |
| [521](#L521) | return 'installed-and-active'; |
| [522](#L522) | } |
| [523](#L523) |  |
| [524](#L524) | // Theme installed but not activate. |
| [525](#L525) | foreach ( (array) wp\_get\_themes() as $theme\_dir => $theme ) { |
| [526](#L526) | if ( 'Responsive' === $theme->name || 'Responsive' === $theme->parent\_theme ) { |
| [527](#L527) | return 'installed-but-inactive'; |
| [528](#L528) | } |
| [529](#L529) | } |
| [530](#L530) |  |
| [531](#L531) | return 'not-installed'; |
| [532](#L532) | } |
| [533](#L533) |  |
| [534](#L534) | /\*\* |
| [535](#L535) | \* Stuff to do when you activate |
| [536](#L536) | \*/ |
| [537](#L537) | public static function activate() { |
| [538](#L538) | } |
| [539](#L539) |  |
| [540](#L540) | /\*\* |
| [541](#L541) | \* Clean up after Deactivation |
| [542](#L542) | \*/ |
| [543](#L543) | public static function deactivate() { |
| [544](#L544) | } |
| [545](#L545) |  |
| [546](#L546) | /\*\* |
| [547](#L547) | \* Setter for $api\_url |
| [548](#L548) | \* |
| [549](#L549) | \* @since  1.0.0 |
| [550](#L550) | \*/ |
| [551](#L551) | public static function set\_api\_url() { |
| [552](#L552) | self::$api\_url = apply\_filters( 'responsive\_ready\_sites\_api\_url', 'https://ccreadysites.cyberchimps.com/wp-json/wp/v2/' ); |
| [553](#L553) | } |
| [554](#L554) |  |
| [555](#L555) | /\*\* |
| [556](#L556) | \* Setter for rst blocks $rst\_blocks\_api\_url |
| [557](#L557) | \* |
| [558](#L558) | \* @since  2.9.1 |
| [559](#L559) | \*/ |
| [560](#L560) | public static function set\_rst\_blocks\_api\_url() { |
| [561](#L561) | self::$rst\_blocks\_api\_url = apply\_filters( 'rst\_blocks\_api\_url', 'https://ccreadysites.cyberchimps.com/ccblocks/wp-json/wp/v2/' ); |
| [562](#L562) | } |
| [563](#L563) |  |
| [564](#L564) | /\*\* |
| [565](#L565) | \* Hook into WP admin\_init |
| [566](#L566) | \* Responsive 1.x settings |
| [567](#L567) | \* |
| [568](#L568) | \* @param array $options Options. |
| [569](#L569) | \*/ |
| [570](#L570) | public function admin\_init( $options ) { |
| [571](#L571) | $this->init\_settings(); |
| [572](#L572) | } |
| [573](#L573) |  |
| [574](#L574) | /\*\* |
| [575](#L575) | \* Create plugin translations |
| [576](#L576) | \*/ |
| [577](#L577) | public function responsive\_addons\_translations() { |
| [578](#L578) | // Load the text domain for translations. |
| [579](#L579) | load\_plugin\_textdomain( 'responsive-addons', false, basename( dirname( \_\_FILE\_\_ ) ) . '/languages' ); |
| [580](#L580) | } |
| [581](#L581) |  |
| [582](#L582) | /\*\* |
| [583](#L583) | \* Settings |
| [584](#L584) | \*/ |
| [585](#L585) | public function init\_settings() { |
| [586](#L586) | register\_setting( |
| [587](#L587) | 'responsive\_addons', |
| [588](#L588) | 'responsive\_addons\_options', |
| [589](#L589) | array( $this, 'responsive\_addons\_sanitize' ) |
| [590](#L590) | ); |
| [591](#L591) |  |
| [592](#L592) | } |
| [593](#L593) |  |
| [594](#L594) | /\*\* |
| [595](#L595) | \* Test to see if the current theme is Responsive |
| [596](#L596) | \* |
| [597](#L597) | \* @return bool |
| [598](#L598) | \*/ |
| [599](#L599) | public static function is\_responsive() { |
| [600](#L600) | $theme = wp\_get\_theme(); |
| [601](#L601) |  |
| [602](#L602) | if ( 'Responsive' === $theme->Name || 'responsive' === $theme->Template || 'Responsive Pro' === $theme->Name || 'responsivepro' === $theme->Template ) { |
| [603](#L603) | return true; |
| [604](#L604) | } else { |
| [605](#L605) | return false; |
| [606](#L606) | } |
| [607](#L607) | } |
| [608](#L608) |  |
| [609](#L609) | /\*\* |
| [610](#L610) | \* Add to wp head |
| [611](#L611) | \*/ |
| [612](#L612) | public function responsive\_head() { |
| [613](#L613) |  |
| [614](#L614) | // Test if using Responsive theme. If yes load from responsive options else load from plugin options. |
| [615](#L615) | $responsive\_options = ( $this->is\_responsive() ) ? $this->options : $this->plugin\_options; |
| [616](#L616) |  |
| [617](#L617) | if ( ! empty( $responsive\_options['google\_site\_verification'] ) ) { |
| [618](#L618) | echo '<meta name="google-site-verification" content="' . esc\_attr( $responsive\_options['google\_site\_verification'] ) . '" />' . "\n"; |
| [619](#L619) | } |
| [620](#L620) |  |
| [621](#L621) | if ( ! empty( $responsive\_options['bing\_site\_verification'] ) ) { |
| [622](#L622) | echo '<meta name="msvalidate.01" content="' . esc\_attr( $responsive\_options['bing\_site\_verification'] ) . '" />' . "\n"; |
| [623](#L623) | } |
| [624](#L624) |  |
| [625](#L625) | if ( ! empty( $responsive\_options['yahoo\_site\_verification'] ) ) { |
| [626](#L626) | echo '<meta name="y\_key" content="' . esc\_attr( $responsive\_options['yahoo\_site\_verification'] ) . '" />' . "\n"; |
| [627](#L627) | } |
| [628](#L628) |  |
| [629](#L629) | if ( ! empty( $responsive\_options['site\_statistics\_tracker'] ) ) { |
| [630](#L630) | echo wp\_kses\_post( $responsive\_options['site\_statistics\_tracker'] ); |
| [631](#L631) | } |
| [632](#L632) | } |
| [633](#L633) |  |
| [634](#L634) | /\*\* |
| [635](#L635) | \* Responsive Addons Sanitize |
| [636](#L636) | \* |
| [637](#L637) | \* @since 2.0.3 |
| [638](#L638) | \* |
| [639](#L639) | \* @param string $input Input. |
| [640](#L640) | \* |
| [641](#L641) | \* @return string |
| [642](#L642) | \*/ |
| [643](#L643) | public function responsive\_addons\_sanitize( $input ) { |
| [644](#L644) |  |
| [645](#L645) | $output = array(); |
| [646](#L646) |  |
| [647](#L647) | foreach ( $input as $key => $test ) { |
| [648](#L648) | switch ( $key ) { |
| [649](#L649) | case 'google\_site\_verification': |
| [650](#L650) | $output[ $key ] = wp\_filter\_post\_kses( $test ); |
| [651](#L651) | break; |
| [652](#L652) | case 'yahoo\_site\_verification': |
| [653](#L653) | $output[ $key ] = wp\_filter\_post\_kses( $test ); |
| [654](#L654) | break; |
| [655](#L655) | case 'bing\_site\_verification': |
| [656](#L656) | $output[ $key ] = wp\_filter\_post\_kses( $test ); |
| [657](#L657) | break; |
| [658](#L658) | case 'site\_statistics\_tracker': |
| [659](#L659) | $output[ $key ] = wp\_kses\_stripslashes( $test ); |
| [660](#L660) | break; |
| [661](#L661) |  |
| [662](#L662) | } |
| [663](#L663) | } |
| [664](#L664) |  |
| [665](#L665) | return $output; |
| [666](#L666) | } |
| [667](#L667) |  |
| [668](#L668) | /\*\* |
| [669](#L669) | \* Add settings link to plugin activate page |
| [670](#L670) | \* |
| [671](#L671) | \* @param array $links Links. |
| [672](#L672) | \* |
| [673](#L673) | \* @return mixed |
| [674](#L674) | \*/ |
| [675](#L675) | public function plugin\_settings\_link( $links ) { |
| [676](#L676) | $settings\_link = '<a href="themes.php?page=responsive-add-ons">' . \_\_( 'Settings', 'responsive-addons' ) . '</a>'; |
| [677](#L677) | array\_unshift( $links, $settings\_link ); |
| [678](#L678) |  |
| [679](#L679) | return $links; |
| [680](#L680) | } |
| [681](#L681) |  |
| [682](#L682) | /\*\* |
| [683](#L683) | \* Menu callback |
| [684](#L684) | \* |
| [685](#L685) | \* @since 2.0.0 |
| [686](#L686) | \*/ |
| [687](#L687) | public function menu\_callback() { |
| [688](#L688) | ?> |
| [689](#L689) | <div class="responsive-sites-menu-page-wrapper"> |
| [690](#L690) | <?php require\_once RESPONSIVE\_ADDONS\_DIR . 'admin/partials/responsive-ready-sites-admin-display.php'; ?> |
| [691](#L691) | </div> |
| [692](#L692) | <?php |
| [693](#L693) | } |
| [694](#L694) |  |
| [695](#L695) | /\*\* |
| [696](#L696) | \* Load Responsive Ready Sites Importer |
| [697](#L697) | \* |
| [698](#L698) | \* @since 2.0.0 |
| [699](#L699) | \*/ |
| [700](#L700) | public function load\_responsive\_sites\_importer() { |
| [701](#L701) | require\_once RESPONSIVE\_ADDONS\_DIR . 'includes/importers/class-responsive-ready-sites-importer.php'; |
| [702](#L702) | } |
| [703](#L703) |  |
| [704](#L704) | /\*\* |
| [705](#L705) | \* Load Responsive Addons Cyberchimps App Auth |
| [706](#L706) | \* |
| [707](#L707) | \* @since 2.9.2 |
| [708](#L708) | \*/ |
| [709](#L709) | public function load\_responsive\_addons\_cc\_app\_auth() { |
| [710](#L710) | require\_once RESPONSIVE\_ADDONS\_DIR . 'includes/class-responsive-add-ons-app-auth.php'; |
| [711](#L711) | $this->cc\_app\_auth      = new Responsive\_Add\_Ons\_App\_Auth(); |
| [712](#L712) |  |
| [713](#L713) | require\_once RESPONSIVE\_ADDONS\_DIR . 'includes/settings/class-responsive-add-ons-api.php'; |
| [714](#L714) | $respaddons\_api = new Responsive\_Add\_Ons\_Api(); |
| [715](#L715) | } |
| [716](#L716) |  |
| [717](#L717) | /\*\* |
| [718](#L718) | \* Include Admin JS |
| [719](#L719) | \* |
| [720](#L720) | \* @param string $hook Hook. |
| [721](#L721) | \* |
| [722](#L722) | \* @since 2.0.0 |
| [723](#L723) | \*/ |
| [724](#L724) | public function responsive\_ready\_sites\_admin\_enqueue\_scripts( $hook = '' ) { |
| [725](#L725) |  |
| [726](#L726) | wp\_enqueue\_script( 'install-responsive-theme', RESPONSIVE\_ADDONS\_URI . 'admin/js/install-responsive-theme.js', array( 'jquery', 'updates' ), RESPONSIVE\_ADDONS\_VER, true ); |
| [727](#L727) | wp\_enqueue\_style( 'install-responsive-theme', RESPONSIVE\_ADDONS\_URI . 'admin/css/install-responsive-theme.css', null, RESPONSIVE\_ADDONS\_VER, 'all' ); |
| [728](#L728) | $data = apply\_filters( |
| [729](#L729) | 'responsive\_sites\_install\_theme\_localize\_vars', |
| [730](#L730) | array( |
| [731](#L731) | 'installed'   => \_\_( 'Installed! Activating..', 'responsive-addons' ), |
| [732](#L732) | 'activating'  => \_\_( 'Activating..', 'responsive-addons' ), |
| [733](#L733) | 'activated'   => \_\_( 'Activated! Reloading..', 'responsive-addons' ), |
| [734](#L734) | 'installing'  => \_\_( 'Installing..', 'responsive-addons' ), |
| [735](#L735) | 'ajaxurl'     => esc\_url( admin\_url( 'admin-ajax.php' ) ), |
| [736](#L736) | '\_ajax\_nonce' => wp\_create\_nonce( 'responsive-addons' ), |
| [737](#L737) | ) |
| [738](#L738) | ); |
| [739](#L739) | wp\_localize\_script( 'install-responsive-theme', 'ResponsiveInstallThemeVars', $data ); |
| [740](#L740) | $settings   = get\_option( 'rpro\_elementor\_settings' ); |
| [741](#L741) | $theme\_name = ! empty( $settings['theme\_name'] ) ? strtolower( $settings['theme\_name'] ) : 'responsive'; |
| [742](#L742) |  |
| [743](#L743) | // Check if white labeled theme name has white space. If found, replace white space with hypen. |
| [744](#L744) | $theme\_name = str\_replace( ' ', '-', $theme\_name ); |
| [745](#L745) | $theme\_name = str\_replace( '/', '-', $theme\_name ); |
| [746](#L746) | $characters\_to\_remove = array( "'", "\\", '?', '|', '\*' ); // Add any other characters want to remove. |
| [747](#L747) | $theme\_name = str\_replace( $characters\_to\_remove, '', $theme\_name ); |
| [748](#L748) | $pro\_plugin\_active\_status = is\_plugin\_active( 'responsive-addons-pro/responsive-addons-pro.php' ) ? true : false; |
| [749](#L749) |  |
| [750](#L750) | if ( ( 'toplevel\_page\_responsive\_add\_ons' === $hook || $theme\_name . '\_page\_responsive\_add\_ons' === $hook ) && empty( $\_GET['action'] ) ) { |
| [751](#L751) |  |
| [752](#L752) | wp\_enqueue\_script( 'responsive-ready-sites-admin-js', RESPONSIVE\_ADDONS\_URI . 'admin/js/responsive-ready-sites-admin.js', array( 'jquery', 'wp-util', 'updates', 'jquery-ui-autocomplete', 'canvas-confetti' ), RESPONSIVE\_ADDONS\_VER, true ); |
| [753](#L753) | wp\_enqueue\_script('canvas-confetti', "https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js", array(), RESPONSIVE\_ADDONS\_VER, true); |
| [754](#L754) |  |
| [755](#L755) | $data = apply\_filters( |
| [756](#L756) | 'responsive\_sites\_localize\_vars', |
| [757](#L757) | array( |
| [758](#L758) | 'debug'                           => ((defined('WP\_DEBUG') && WP\_DEBUG) || isset($\_GET['debug'])) ? true : false, //phpcs:ignore |
| [759](#L759) | 'ajaxurl'                         => esc\_url( admin\_url( 'admin-ajax.php' ) ), |
| [760](#L760) | 'siteURL'                         => site\_url(), |
| [761](#L761) | '\_ajax\_nonce'                     => wp\_create\_nonce( 'responsive-addons' ), |
| [762](#L762) | 'XMLReaderDisabled'               => ! class\_exists( 'XMLReader' ) ? true : false, |
| [763](#L763) | 'required\_plugins'                => array(), |
| [764](#L764) | 'ApiURL'                          => self::$api\_url, |
| [765](#L765) | /\* translators: %s is a template name \*/ |
| [766](#L766) | 'importSingleTemplateButtonTitle' => \_\_( 'Import "%s" Template', 'responsive-addons' ), |
| [767](#L767) | 'default\_page\_builder\_sites'      => $this->get\_sites\_by\_page\_builder(), |
| [768](#L768) | 'strings'                         => array( |
| [769](#L769) | 'syncCompleteMessage'  => $this->get\_sync\_complete\_message(), |
| [770](#L770) | /\* translators: %s is a template name \*/ |
| [771](#L771) | 'importSingleTemplate' => \_\_( 'Import "%s" Template', 'responsive-addons' ), |
| [772](#L772) | ), |
| [773](#L773) | 'dismiss'                         => \_\_( 'Dismiss this notice.', 'responsive-addons' ), |
| [774](#L774) | 'syncTemplatesLibraryStart'       => '<span class="message">' . esc\_html\_\_( 'Syncing Responsive Starter Templates in the background. The process can take anywhere between 2 to 3 minutes. We will notify you once done.', 'responsive-addons' ) . '</span>', |
| [775](#L775) | 'activated\_first\_time'            => get\_option( 'ra\_first\_time\_activation' ), |
| [776](#L776) | 'hasAppAuth'                      => $this->cc\_app\_auth->has\_auth(), |
| [777](#L777) | 'isResponsiveProActive'           => $pro\_plugin\_active\_status, |
| [778](#L778) | ) |
| [779](#L779) | ); |
| [780](#L780) |  |
| [781](#L781) | wp\_localize\_script( 'responsive-ready-sites-admin-js', 'responsiveSitesAdmin', $data ); |
| [782](#L782) |  |
| [783](#L783) | wp\_enqueue\_script( |
| [784](#L784) | 'responsive-add-ons-getting-started-jsfile', |
| [785](#L785) | RESPONSIVE\_ADDONS\_URI . 'admin/js/responsive-add-ons-getting-started.js', |
| [786](#L786) | array( 'jquery' ), |
| [787](#L787) | RESPONSIVE\_ADDONS\_VER, |
| [788](#L788) | true |
| [789](#L789) | ); |
| [790](#L790) |  |
| [791](#L791) | $data = array( |
| [792](#L792) | 'ajaxurl'    => admin\_url( 'admin-ajax.php' ), |
| [793](#L793) | 'ccAppURL'    => CC\_APP\_URL, |
| [794](#L794) | '\_ajax\_nonce' => wp\_create\_nonce( 'responsive-addons' ), |
| [795](#L795) | ); |
| [796](#L796) |  |
| [797](#L797) | wp\_localize\_script( 'responsive-add-ons-getting-started-jsfile', 'responsiveAddonsGettingStarted', $data ); |
| [798](#L798) | } |
| [799](#L799) | } |
| [800](#L800) |  |
| [801](#L801) | /\*\* |
| [802](#L802) | \* Get Sync Complete Message |
| [803](#L803) | \* |
| [804](#L804) | \* @since 2.0.0 |
| [805](#L805) | \* @param  boolean $echo Echo the message. |
| [806](#L806) | \* @return mixed |
| [807](#L807) | \*/ |
| [808](#L808) | public function get\_sync\_complete\_message( $echo = false ) { |
| [809](#L809) |  |
| [810](#L810) | $message = \_\_( 'Responsive Templates data refreshed!', 'responsive-addons' ); |
| [811](#L811) | if ( $echo ) { |
| [812](#L812) | echo esc\_html( $message ); |
| [813](#L813) | } else { |
| [814](#L814) | return esc\_html( $message ); |
| [815](#L815) | } |
| [816](#L816) | } |
| [817](#L817) |  |
| [818](#L818) | /\*\* |
| [819](#L819) | \* Include Admin css |
| [820](#L820) | \* |
| [821](#L821) | \* @since 2.0.0 |
| [822](#L822) | \* @param string $hook Hook. |
| [823](#L823) | \*/ |
| [824](#L824) | public function responsive\_ready\_sites\_admin\_enqueue\_styles( $hook = '' ) { |
| [825](#L825) | $settings   = get\_option( 'rpro\_elementor\_settings' ); |
| [826](#L826) | $theme\_name = ! empty( $settings['theme\_name'] ) ? strtolower( $settings['theme\_name'] ) : 'responsive'; |
| [827](#L827) | // Check if white labeled theme name has white space. If found, replace white space with hypen. |
| [828](#L828) | $theme\_name = str\_replace( ' ', '-', $theme\_name ); |
| [829](#L829) | $theme\_name = str\_replace( '/', '-', $theme\_name ); |
| [830](#L830) | $characters\_to\_remove = array( "'", "\\", '?', '|', '\*' ); // Add any other characters want to remove. |
| [831](#L831) | $theme\_name = str\_replace( $characters\_to\_remove, '', $theme\_name ); |
| [832](#L832) |  |
| [833](#L833) | if ( 'toplevel\_page\_responsive\_add\_ons' === $hook || $theme\_name . '\_page\_responsive\_add\_ons\_go\_pro' === $hook || $theme\_name . '\_page\_responsive\_add\_ons' === $hook ) { |
| [834](#L834) | // Responsive Ready Sites admin styles. |
| [835](#L835) | wp\_register\_style( 'responsive-ready-sites-admin', RESPONSIVE\_ADDONS\_URI . 'admin/css/responsive-ready-sites-admin.css', false, RESPONSIVE\_ADDONS\_VER ); |
| [836](#L836) | wp\_enqueue\_style( 'responsive-ready-sites-admin' ); |
| [837](#L837) | } |
| [838](#L838) | } |
| [839](#L839) |  |
| [840](#L840) | /\*\* |
| [841](#L841) | \* Include Elementor Templates. |
| [842](#L842) | \* |
| [843](#L843) | \* @since 2.7.3 |
| [844](#L844) | \*/ |
| [845](#L845) | public function responsive\_ready\_sites\_insert\_templates() { |
| [846](#L846) | ob\_start(); |
| [847](#L847) | require\_once RESPONSIVE\_ADDONS\_DIR . 'admin/partials/responsive-elementor-templates.php'; |
| [848](#L848) | ob\_end\_flush(); |
| [849](#L849) | } |
| [850](#L850) |  |
| [851](#L851) | /\*\* |
| [852](#L852) | \* Include Elementor Admin JS. |
| [853](#L853) | \* |
| [854](#L854) | \* @since 2.7.3 |
| [855](#L855) | \*/ |
| [856](#L856) | public function responsive\_ready\_sites\_register\_widget\_scripts() { |
| [857](#L857) | wp\_enqueue\_script( 'responsive-elementor-admin', RESPONSIVE\_ADDONS\_URI . 'admin/js/responsive-elementor-admin.js', array( 'jquery', 'wp-util', 'updates', 'jquery-ui-autocomplete', 'masonry', 'imagesloaded' ), RESPONSIVE\_ADDONS\_VER, true ); |
| [858](#L858) |  |
| [859](#L859) | wp\_add\_inline\_script( 'responsive-elementor-admin', sprintf( 'var pagenow = "%s";', 'Responsive Starter Templates' ), 'after' ); |
| [860](#L860) | $license\_status           = $this->responsive\_pro\_license\_is\_active() ? true : false; |
| [861](#L861) | $pro\_plugin\_active\_status = is\_plugin\_active( 'responsive-addons-pro/responsive-addons-pro.php' ) ? true : false; |
| [862](#L862) | $cc\_app\_auth              = $this->cc\_app\_auth->has\_auth() ? true : false; |
| [863](#L863) | $settings                 = get\_option( 'reads\_app\_settings' ); |
| [864](#L864) | $user\_plan                = $settings['account']['plan']; |
| [865](#L865) |  |
| [866](#L866) | $pro\_purchase\_url = 'https://cyberchimps.com/responsive-go-pro/?utm\_source=free-to-pro&utm\_medium=responsive-add-ons&utm\_campaign=responsive-pro&utm\_content=preview-ready-site'; |
| [867](#L867) |  |
| [868](#L868) | /\* translators: %s are link. \*/ |
| [869](#L869) | $license\_msg = sprintf( \_\_( 'This is a Pro Template available with Responsive Pro. You can purchase it from <a href="%s" target="\_blank">here</a>.', 'responsive-addons' ), esc\_url( $pro\_purchase\_url ) ); |
| [870](#L870) | /\* translators: %s are link. \*/ |
| [871](#L871) | $license\_block\_msg = sprintf( \_\_( 'This is a Pro Block available with Responsive Pro. You can purchase it from <a href="%s" target="\_blank">here</a>.', 'responsive-addons' ), esc\_url( $pro\_purchase\_url ) ); |
| [872](#L872) |  |
| [873](#L873) | $data = apply\_filters( |
| [874](#L874) | 'responsive\_sites\_render\_localize\_vars', |
| [875](#L875) | array( |
| [876](#L876) | 'plugin\_name'                 => 'Responsive Starter Templates', |
| [877](#L877) | 'version'                     => RESPONSIVE\_ADDONS\_VER, |
| [878](#L878) | 'default\_page\_builder'        => 'elementor', |
| [879](#L879) | 'license\_status'              => $license\_status, |
| [880](#L880) | 'proActivated'                => $pro\_plugin\_active\_status, |
| [881](#L881) | 'ccAppAuth'                   => $cc\_app\_auth, |
| [882](#L882) | 'addonsPlan'                  => $user\_plan, |
| [883](#L883) | 'ajaxurl'                     => esc\_url( admin\_url( 'admin-ajax.php' ) ), |
| [884](#L884) | 'default\_page\_builder\_sites'  => $this->get\_sites\_by\_elementor(), |
| [885](#L885) | 'default\_page\_builder\_blocks' => $this->get\_rst\_blocks\_by\_elementor(), |
| [886](#L886) | 'ApiURL'                      => self::$api\_url, |
| [887](#L887) | '\_ajax\_nonce'                 => wp\_create\_nonce( 'responsive-addons' ), |
| [888](#L888) | 'isPro'                       => defined( 'RESPONSIVE\_ADDONS\_PRO\_VERSION' ) ? true : false, |
| [889](#L889) | 'license\_msg'                 => $license\_msg, |
| [890](#L890) | 'license\_block\_msg'           => $license\_block\_msg, |
| [891](#L891) | 'dismiss\_text'                => esc\_html\_\_( 'Dismiss', 'responsive-addons' ), |
| [892](#L892) | 'noPlugins'                   => \_\_( 'No Plugins Required' ), |
| [893](#L893) | 'syncCompleteMessage'         => \_\_( 'Template library refreshed!', 'responsive-addons' ), |
| [894](#L894) | 'getProText'                  => \_\_( 'Upgrade to Pro!', 'responsive-addons' ), |
| [895](#L895) | 'getProURL'                   => esc\_url( 'https://cyberchimps.com/responsive-go-pro/?utm\_source=free-to-pro&utm\_medium=responsive-add-ons&utm\_campaign=responsive-pro&utm\_content=preview-ready-site' ), |
| [896](#L896) | 'getREAURL'                   => esc\_url( 'https://cyberchimps.com/elementor-widgets/docs/how-to-install-activate-the-responsive-elementor-addons/' ), |
| [897](#L897) | 'siteURL'                     => site\_url(), |
| [898](#L898) | 'template'                    => esc\_html\_\_( 'Template', 'responsive-addons' ), |
| [899](#L899) | 'install\_plugin\_text'         => esc\_html\_\_( 'Install Required Plugins', 'responsive-addons' ), |
| [900](#L900) | 'isREAActivated'              => $this->is\_rea\_activated(), |
| [901](#L901) | 'blockSiteURL'                => self::$rst\_blocks\_api\_url, |
| [902](#L902) | 'blockCategories'             => $this->block\_categories(), |
| [903](#L903) | 'rstHasBlocksCount'           => $this->rst\_add\_blocks\_data(), |
| [904](#L904) | ) |
| [905](#L905) | ); |
| [906](#L906) |  |
| [907](#L907) | wp\_localize\_script( 'responsive-elementor-admin', 'responsiveElementorSites', $data ); |
| [908](#L908) |  |
| [909](#L909) | wp\_enqueue\_script( |
| [910](#L910) | 'responsive-add-ons-getting-started-jsfile', |
| [911](#L911) | RESPONSIVE\_ADDONS\_URI . 'admin/js/responsive-add-ons-getting-started.js', |
| [912](#L912) | array( 'jquery' ), |
| [913](#L913) | RESPONSIVE\_ADDONS\_VER, |
| [914](#L914) | true |
| [915](#L915) | ); |
| [916](#L916) |  |
| [917](#L917) | $data = array( |
| [918](#L918) | 'ajaxurl'    => admin\_url( 'admin-ajax.php' ), |
| [919](#L919) | 'ccAppURL'    => CC\_APP\_URL, |
| [920](#L920) | '\_ajax\_nonce' => wp\_create\_nonce( 'responsive-addons' ), |
| [921](#L921) | ); |
| [922](#L922) |  |
| [923](#L923) | wp\_localize\_script( 'responsive-add-ons-getting-started-jsfile', 'responsiveAddonsGettingStarted', $data ); |
| [924](#L924) |  |
| [925](#L925) | } |
| [926](#L926) |  |
| [927](#L927) | /\*\* |
| [928](#L928) | \* RST Block Categories. |
| [929](#L929) | \* |
| [930](#L930) | \* @since 2.9.1 |
| [931](#L931) | \*/ |
| [932](#L932) | public function block\_categories() { |
| [933](#L933) | return array( |
| [934](#L934) | \_\_( 'About', 'responsive-addons' ), |
| [935](#L935) | \_\_( 'Team', 'responsive-addons' ), |
| [936](#L936) | \_\_( 'Testimonial', 'responsive-addons' ), |
| [937](#L937) | \_\_( 'Hero', 'responsive-addons' ), |
| [938](#L938) | \_\_( 'Call to Action', 'responsive-addons' ), |
| [939](#L939) | ); |
| [940](#L940) | } |
| [941](#L941) |  |
| [942](#L942) | /\*\* |
| [943](#L943) | \* Check if REA is activated. |
| [944](#L944) | \* |
| [945](#L945) | \* @since 2.7.3 |
| [946](#L946) | \*/ |
| [947](#L947) | public function is\_rea\_activated() { |
| [948](#L948) | $rea\_slug = 'responsive-elementor-addons/responsive-elementor-addons.php'; |
| [949](#L949) | if ( is\_plugin\_active( $rea\_slug ) ) { |
| [950](#L950) | return true; |
| [951](#L951) | } else { |
| [952](#L952) | return false; |
| [953](#L953) | } |
| [954](#L954) | } |
| [955](#L955) |  |
| [956](#L956) | /\*\* |
| [957](#L957) | \* Get API params |
| [958](#L958) | \* |
| [959](#L959) | \* @since 2.7.3 |
| [960](#L960) | \* @return array |
| [961](#L961) | \*/ |
| [962](#L962) | public function responsive\_sites\_get\_api\_params() { |
| [963](#L963) | return apply\_filters( |
| [964](#L964) | 'responsive\_sites\_api\_params', |
| [965](#L965) | array( |
| [966](#L966) | 'purchase\_key'    => '', |
| [967](#L967) | 'site\_url'        => get\_site\_url(), |
| [968](#L968) | 'per-page'        => 20, |
| [969](#L969) | 'template\_status' => '', |
| [970](#L970) | 'version'         => RESPONSIVE\_ADDONS\_VER, |
| [971](#L971) | ) |
| [972](#L972) | ); |
| [973](#L973) | } |
| [974](#L974) |  |
| [975](#L975) | /\*\* |
| [976](#L976) | \* Get Elementor Sites |
| [977](#L977) | \* |
| [978](#L978) | \* @since 2.7.3 |
| [979](#L979) | \* |
| [980](#L980) | \* @return array page builder sites. |
| [981](#L981) | \*/ |
| [982](#L982) | public function get\_sites\_by\_elementor() { |
| [983](#L983) | $sites\_and\_pages = $this->get\_all\_sites(); |
| [984](#L984) | $elementor\_sites = array(); |
| [985](#L985) | if ( ! empty( $sites\_and\_pages ) ) { |
| [986](#L986) | $page\_builder\_keys = wp\_list\_pluck( $sites\_and\_pages, 'page\_builder' ); |
| [987](#L987) | foreach ( $page\_builder\_keys as $site\_id => $page\_builder ) { |
| [988](#L988) | if ( 'elementor' === $page\_builder ) { |
| [989](#L989) | $elementor\_sites[ $site\_id ] = $sites\_and\_pages[ $site\_id ]; |
| [990](#L990) | } |
| [991](#L991) | } |
| [992](#L992) | } |
| [993](#L993) |  |
| [994](#L994) | return $elementor\_sites; |
| [995](#L995) | } |
| [996](#L996) |  |
| [997](#L997) | /\*\* |
| [998](#L998) | \* Get Elementor Based RST Blocks. |
| [999](#L999) | \* |
| [1000](#L1000) | \* @since 2.9.1 |
| [1001](#L1001) | \* |
| [1002](#L1002) | \* @return array page builder rst blocks. |
| [1003](#L1003) | \*/ |
| [1004](#L1004) | public function get\_rst\_blocks\_by\_elementor() { |
| [1005](#L1005) | $blocks\_and\_pages = $this->get\_all\_rst\_blocks(); |
| [1006](#L1006) | $elementor\_sites  = array(); |
| [1007](#L1007) | if ( ! empty( $blocks\_and\_pages ) ) { |
| [1008](#L1008) | $page\_builder\_keys = wp\_list\_pluck( $blocks\_and\_pages, 'page\_builder' ); |
| [1009](#L1009) | foreach ( $page\_builder\_keys as $site\_id => $page\_builder ) { |
| [1010](#L1010) | if ( 'elementor' === $page\_builder ) { |
| [1011](#L1011) | $elementor\_sites[ $site\_id ] = $blocks\_and\_pages[ $site\_id ]; |
| [1012](#L1012) | } |
| [1013](#L1013) | } |
| [1014](#L1014) | } |
| [1015](#L1015) |  |
| [1016](#L1016) | return $elementor\_sites; |
| [1017](#L1017) | } |
| [1018](#L1018) |  |
| [1019](#L1019) | /\*\* |
| [1020](#L1020) | \* Elementor Templates Request |
| [1021](#L1021) | \* |
| [1022](#L1022) | \* @since 2.7.3 |
| [1023](#L1023) | \*/ |
| [1024](#L1024) | public function remote\_request() { |
| [1025](#L1025) |  |
| [1026](#L1026) | // Verify Nonce. |
| [1027](#L1027) | check\_ajax\_referer( 'responsive-addons', '\_ajax\_nonce' ); |
| [1028](#L1028) |  |
| [1029](#L1029) | if ( ! current\_user\_can( 'edit\_posts' ) ) { |
| [1030](#L1030) | wp\_send\_json\_error( \_\_( 'You are not allowed to perform this action', 'responsive-addons' ) ); |
| [1031](#L1031) | } |
| [1032](#L1032) |  |
| [1033](#L1033) | $api\_url = isset( $\_POST['url'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['url'] ) ) : ''; |
| [1034](#L1034) |  |
| [1035](#L1035) | $api\_url = add\_query\_arg( $this->responsive\_sites\_get\_api\_params(), $api\_url ); |
| [1036](#L1036) |  |
| [1037](#L1037) | $response = wp\_remote\_get( $api\_url ); |
| [1038](#L1038) |  |
| [1039](#L1039) | if ( is\_wp\_error( $response ) ) { |
| [1040](#L1040) | wp\_send\_json\_error( wp\_remote\_retrieve\_body( $response ) ); |
| [1041](#L1041) | } |
| [1042](#L1042) |  |
| [1043](#L1043) | $body = wp\_remote\_retrieve\_body( $response ); |
| [1044](#L1044) | $data = json\_decode( $body, true ); |
| [1045](#L1045) |  |
| [1046](#L1046) | wp\_send\_json\_success( $data ); |
| [1047](#L1047) | } |
| [1048](#L1048) |  |
| [1049](#L1049) | /\*\* |
| [1050](#L1050) | \* Elementor Batch Process via AJAX |
| [1051](#L1051) | \* |
| [1052](#L1052) | \* @since 2.7.3 |
| [1053](#L1053) | \*/ |
| [1054](#L1054) | public function elementor\_page\_import\_process() { |
| [1055](#L1055) |  |
| [1056](#L1056) | // Verify Nonce. |
| [1057](#L1057) | check\_ajax\_referer( 'responsive-addons', '\_ajax\_nonce' ); |
| [1058](#L1058) |  |
| [1059](#L1059) | if ( ! current\_user\_can( 'edit\_posts' ) ) { |
| [1060](#L1060) | wp\_send\_json\_error( \_\_( 'You are not allowed to perform this action', 'responsive-addons' ) ); |
| [1061](#L1061) | } |
| [1062](#L1062) |  |
| [1063](#L1063) | $api\_url = isset( $\_POST['url'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['url'] ) ) : ''; |
| [1064](#L1064) |  |
| [1065](#L1065) | $response = wp\_remote\_get( $api\_url ); |
| [1066](#L1066) |  |
| [1067](#L1067) | if ( is\_wp\_error( $response ) ) { |
| [1068](#L1068) | wp\_send\_json\_error( wp\_remote\_retrieve\_body( $response ) ); |
| [1069](#L1069) | } |
| [1070](#L1070) |  |
| [1071](#L1071) | $body = wp\_remote\_retrieve\_body( $response ); |
| [1072](#L1072) |  |
| [1073](#L1073) | $data = json\_decode( $body, true ); |
| [1074](#L1074) |  |
| [1075](#L1075) | if ( ! isset( $data['post-meta']['\_elementor\_data'] ) ) { |
| [1076](#L1076) | wp\_send\_json\_error( \_\_( 'Invalid Post Meta', 'responsive-addons' ) ); |
| [1077](#L1077) | } |
| [1078](#L1078) |  |
| [1079](#L1079) | $meta    = json\_decode( $data['post-meta']['\_elementor\_data'], true ); |
| [1080](#L1080) |  |
| [1081](#L1081) | $meta    = json\_decode( $meta, true ); |
| [1082](#L1082) |  |
| [1083](#L1083) | $post\_id = isset( $\_POST['id'] ) ? absint( $\_POST['id'] ) : ''; |
| [1084](#L1084) |  |
| [1085](#L1085) | if ( empty( $post\_id ) || empty( $meta ) ) { |
| [1086](#L1086) | wp\_send\_json\_error( \_\_( 'Invalid Post ID or Elementor Meta', 'responsive-addons' ) ); |
| [1087](#L1087) | } |
| [1088](#L1088) |  |
| [1089](#L1089) | $import      = new \Elementor\TemplateLibrary\Responsive\_Ready\_Sites\_Batch\_Processing\_Elementor(); |
| [1090](#L1090) | $import\_data = $import->responsive\_import\_post\_meta( $post\_id, $meta ); |
| [1091](#L1091) |  |
| [1092](#L1092) | wp\_send\_json\_success( $import\_data ); |
| [1093](#L1093) | } |
| [1094](#L1094) |  |
| [1095](#L1095) | /\*\* |
| [1096](#L1096) | \* Import Post Meta |
| [1097](#L1097) | \* |
| [1098](#L1098) | \* @since 2.7.3 |
| [1099](#L1099) | \* |
| [1100](#L1100) | \* @param  integer $post\_id  Post ID. |
| [1101](#L1101) | \* @param  array   $metadata  Post meta. |
| [1102](#L1102) | \* @return void |
| [1103](#L1103) | \*/ |
| [1104](#L1104) | public function import\_template\_meta( $post\_id, $metadata ) { |
| [1105](#L1105) |  |
| [1106](#L1106) | $metadata = (array) $metadata; |
| [1107](#L1107) |  |
| [1108](#L1108) | foreach ( $metadata as $meta\_key => $meta\_value ) { |
| [1109](#L1109) |  |
| [1110](#L1110) | if ( $meta\_value ) { |
| [1111](#L1111) |  |
| [1112](#L1112) | if ( '\_elementor\_data' === $meta\_key ) { |
| [1113](#L1113) |  |
| [1114](#L1114) | $raw\_data = json\_decode( $meta\_value, true ); |
| [1115](#L1115) | $raw\_data = json\_decode( $raw\_data, true ); |
| [1116](#L1116) |  |
| [1117](#L1117) | if ( is\_array( $raw\_data ) ) { |
| [1118](#L1118) | $raw\_data = wp\_slash( wp\_json\_encode( $raw\_data ) ); |
| [1119](#L1119) | } else { |
| [1120](#L1120) | $raw\_data = wp\_slash( $raw\_data ); |
| [1121](#L1121) | } |
| [1122](#L1122) | } else { |
| [1123](#L1123) |  |
| [1124](#L1124) | if ( is\_serialized( $meta\_value, true ) ) { |
| [1125](#L1125) | $raw\_data = maybe\_unserialize( stripslashes( $meta\_value ) ); |
| [1126](#L1126) | } elseif ( is\_array( $meta\_value ) ) { |
| [1127](#L1127) | $raw\_data = json\_decode( stripslashes( $meta\_value ), true ); |
| [1128](#L1128) | } else { |
| [1129](#L1129) | $raw\_data = $meta\_value; |
| [1130](#L1130) | } |
| [1131](#L1131) | } |
| [1132](#L1132) |  |
| [1133](#L1133) | update\_post\_meta( $post\_id, $meta\_key, $raw\_data ); |
| [1134](#L1134) | } |
| [1135](#L1135) | } |
| [1136](#L1136) | } |
| [1137](#L1137) |  |
| [1138](#L1138) | /\*\* |
| [1139](#L1139) | \* Include Elementor Admin CSS. |
| [1140](#L1140) | \* |
| [1141](#L1141) | \* @since 2.7.3 |
| [1142](#L1142) | \*/ |
| [1143](#L1143) | public function responsive\_ready\_sites\_elementor\_styles() { |
| [1144](#L1144) | wp\_enqueue\_style( 'responsive-elementor-admin', RESPONSIVE\_ADDONS\_URI . 'admin/css/responsive-elementor-admin.css', RESPONSIVE\_ADDONS\_VER, true ); |
| [1145](#L1145) | } |
| [1146](#L1146) |  |
| [1147](#L1147) | /\*\* |
| [1148](#L1148) | \* Backup existing settings. |
| [1149](#L1149) | \*/ |
| [1150](#L1150) | public function backup\_settings() { |
| [1151](#L1151) | check\_ajax\_referer( 'responsive-addons', '\_ajax\_nonce' ); |
| [1152](#L1152) |  |
| [1153](#L1153) | if ( ! current\_user\_can( 'install\_plugins' ) ) { |
| [1154](#L1154) | wp\_send\_json\_error( \_\_( 'User does not have permission!', 'responsive-addons' ) ); |
| [1155](#L1155) | } |
| [1156](#L1156) |  |
| [1157](#L1157) | $file\_name    = 'responsive-ready-sites-backup-' . date( 'd-M-Y-h-i-s' ) . '.json'; |
| [1158](#L1158) | $old\_settings = get\_option( 'responsive\_theme\_options', array() ); |
| [1159](#L1159) |  |
| [1160](#L1160) | $upload\_dir  = Responsive\_Ready\_Sites\_Importer\_Log::get\_instance()->log\_dir(); |
| [1161](#L1161) | $upload\_path = trailingslashit( $upload\_dir['path'] ); |
| [1162](#L1162) | $log\_file    = $upload\_path . $file\_name; |
| [1163](#L1163) | $file\_system = Responsive\_Ready\_Sites\_Importer\_Log::get\_instance()->get\_filesystem(); |
| [1164](#L1164) |  |
| [1165](#L1165) | // If file Write fails. |
| [1166](#L1166) | if ( false === $file\_system->put\_contents( $log\_file, wp\_json\_encode( $old\_settings ), FS\_CHMOD\_FILE ) ) { |
| [1167](#L1167) | update\_option( 'responsive\_ready\_sites\_' . $file\_name, $old\_settings ); |
| [1168](#L1168) | } |
| [1169](#L1169) |  |
| [1170](#L1170) | wp\_send\_json\_success(); |
| [1171](#L1171) | } |
| [1172](#L1172) |  |
| [1173](#L1173) | /\*\* |
| [1174](#L1174) | \* Get Active site data |
| [1175](#L1175) | \*/ |
| [1176](#L1176) | public function get\_active\_site\_data() { |
| [1177](#L1177) | $current\_active\_site = get\_option( 'responsive\_current\_active\_site' ); |
| [1178](#L1178) | return $current\_active\_site; |
| [1179](#L1179) | } |
| [1180](#L1180) |  |
| [1181](#L1181) | /\*\* |
| [1182](#L1182) | \* Set reset data |
| [1183](#L1183) | \*/ |
| [1184](#L1184) | public function set\_reset\_data() { |
| [1185](#L1185) | check\_ajax\_referer( 'responsive-addons', '\_ajax\_nonce' ); |
| [1186](#L1186) | if ( ! current\_user\_can( 'install\_plugins' ) ) { |
| [1187](#L1187) | return; |
| [1188](#L1188) | } |
| [1189](#L1189) |  |
| [1190](#L1190) | global $wpdb; |
| [1191](#L1191) |  |
| [1192](#L1192) | $post\_ids = $wpdb->get\_col( "SELECT post\_id FROM {$wpdb->postmeta} WHERE meta\_key='\_responsive\_ready\_sites\_imported\_post'" ); |
| [1193](#L1193) | $form\_ids = $wpdb->get\_col( "SELECT post\_id FROM {$wpdb->postmeta} WHERE meta\_key='\_responsive\_ready\_sites\_imported\_wp\_forms'" ); |
| [1194](#L1194) | $term\_ids = $wpdb->get\_col( "SELECT term\_id FROM {$wpdb->termmeta} WHERE meta\_key='\_responsive\_ready\_sites\_imported\_term'" ); |
| [1195](#L1195) |  |
| [1196](#L1196) | wp\_send\_json\_success( |
| [1197](#L1197) | array( |
| [1198](#L1198) | 'reset\_posts'    => $post\_ids, |
| [1199](#L1199) | 'reset\_wp\_forms' => $form\_ids, |
| [1200](#L1200) | 'reset\_terms'    => $term\_ids, |
| [1201](#L1201) | ) |
| [1202](#L1202) | ); |
| [1203](#L1203) | } |
| [1204](#L1204) |  |
| [1205](#L1205) | /\*\* |
| [1206](#L1206) | \* Required Plugin |
| [1207](#L1207) | \* |
| [1208](#L1208) | \* @since 1.0.0 |
| [1209](#L1209) | \* @return void |
| [1210](#L1210) | \*/ |
| [1211](#L1211) | public function required\_plugin() { |
| [1212](#L1212) |  |
| [1213](#L1213) | // Verify Nonce. |
| [1214](#L1214) | check\_ajax\_referer( 'responsive-addons', '\_ajax\_nonce' ); |
| [1215](#L1215) |  |
| [1216](#L1216) | $response = array( |
| [1217](#L1217) | 'active'       => array(), |
| [1218](#L1218) | 'inactive'     => array(), |
| [1219](#L1219) | 'notinstalled' => array(), |
| [1220](#L1220) | 'proplugins'   => array(), |
| [1221](#L1221) | ); |
| [1222](#L1222) |  |
| [1223](#L1223) | if ( ! current\_user\_can( 'install\_plugins' ) ) { |
| [1224](#L1224) | wp\_send\_json\_error( $response ); |
| [1225](#L1225) | } |
| [1226](#L1226) |  |
| [1227](#L1227) | $required\_plugins\_count = ( isset( $\_POST['required\_plugins'] ) ) ? count( $\_POST['required\_plugins'] ) : array(); |
| [1228](#L1228) | $required\_pro\_plugins = ( isset( $\_POST['required\_pro\_plugins'] ) ) ? $\_POST['required\_pro\_plugins'] : array(); |
| [1229](#L1229) |  |
| [1230](#L1230) | if ( $required\_plugins\_count > 0 ) { |
| [1231](#L1231) |  |
| [1232](#L1232) | for ( $i = 0; $i < $required\_plugins\_count; $i++ ) { |
| [1233](#L1233) | $name = isset( $\_POST['required\_plugins'][ $i ]['name'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['required\_plugins'][ $i ]['name'] ) ) : ''; |
| [1234](#L1234) | $slug = isset( $\_POST['required\_plugins'][ $i ]['slug'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['required\_plugins'][ $i ]['slug'] ) ) : ''; |
| [1235](#L1235) | $init = isset( $\_POST['required\_plugins'][ $i ]['init'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['required\_plugins'][ $i ]['init'] ) ) : ''; |
| [1236](#L1236) |  |
| [1237](#L1237) | $plugin = array( |
| [1238](#L1238) | 'name' => $name, |
| [1239](#L1239) | 'slug' => $slug, |
| [1240](#L1240) | 'init' => $init, |
| [1241](#L1241) | ); |
| [1242](#L1242) |  |
| [1243](#L1243) | if ( file\_exists( WP\_PLUGIN\_DIR . '/' . $init ) && is\_plugin\_inactive( $init ) ) { |
| [1244](#L1244) |  |
| [1245](#L1245) | $response['inactive'][] = $plugin; |
| [1246](#L1246) |  |
| [1247](#L1247) | } elseif ( ! file\_exists( WP\_PLUGIN\_DIR . '/' . $init ) ) { |
| [1248](#L1248) |  |
| [1249](#L1249) | $response['notinstalled'][] = $plugin; |
| [1250](#L1250) |  |
| [1251](#L1251) | } else { |
| [1252](#L1252) | $response['active'][] = $plugin; |
| [1253](#L1253) | } |
| [1254](#L1254) | } |
| [1255](#L1255) | } |
| [1256](#L1256) |  |
| [1257](#L1257) | if ( is\_array( $required\_pro\_plugins ) && count( $required\_pro\_plugins ) > 0 ) { |
| [1258](#L1258) | foreach ( $required\_pro\_plugins as $key => $plugin ) { |
| [1259](#L1259) | $response['proplugins'][] = $plugin; |
| [1260](#L1260) | } |
| [1261](#L1261) | } |
| [1262](#L1262) |  |
| [1263](#L1263) | // Send response. |
| [1264](#L1264) | wp\_send\_json\_success( |
| [1265](#L1265) | array( |
| [1266](#L1266) | 'required\_plugins' => $response, |
| [1267](#L1267) | ) |
| [1268](#L1268) | ); |
| [1269](#L1269) | } |
| [1270](#L1270) |  |
| [1271](#L1271) | /\*\* |
| [1272](#L1272) | \* Install Pro plugins. |
| [1273](#L1273) | \* |
| [1274](#L1274) | \* @since     1.0.0 |
| [1275](#L1275) | \*/ |
| [1276](#L1276) | public function install\_pro\_plugin() { |
| [1277](#L1277) | check\_ajax\_referer( 'responsive-addons', '\_ajax\_nonce' ); |
| [1278](#L1278) |  |
| [1279](#L1279) | if ( ! current\_user\_can( 'install\_plugins' ) ) { |
| [1280](#L1280) | wp\_send\_json\_error( |
| [1281](#L1281) | array( |
| [1282](#L1282) | 'success' => false, |
| [1283](#L1283) | 'message' => \_\_( 'Error: You don\'t have the required permissions to install plugins.', 'responsive-addons' ), |
| [1284](#L1284) | ) |
| [1285](#L1285) | ); |
| [1286](#L1286) | } |
| [1287](#L1287) |  |
| [1288](#L1288) | $pro\_plugins    = ( isset( $\_POST['pro\_plugin'] ) ) ? wp\_unslash( $\_POST['pro\_plugin'] ) : array(); |
| [1289](#L1289) |  |
| [1290](#L1290) | foreach ( $pro\_plugins as $plugin ) { |
| [1291](#L1291) | $plugin\_slug = $plugin['slug']; |
| [1292](#L1292) | $plugin\_init = $plugin['init']; |
| [1293](#L1293) | if ( self::is\_plugin\_installed( $plugin\_init ) ) { |
| [1294](#L1294) | if ( ! is\_plugin\_active( $plugin\_init ) ) { |
| [1295](#L1295) | if ( 'responsive-elementor-addons' === $plugin\_slug ) { |
| [1296](#L1296) | $activate = activate\_plugin( $plugin\_init, '', false, false ); |
| [1297](#L1297) | } else { |
| [1298](#L1298) | $activate = activate\_plugin( $plugin\_init, '', false, true ); |
| [1299](#L1299) | } |
| [1300](#L1300) | } |
| [1301](#L1301) | } else { |
| [1302](#L1302) | if ( 'responsive-elementor-addons' === $plugin\_slug ) { |
| [1303](#L1303) | $plugin\_zip = 'https://cyberchimps.com/wp-content/downloads\_cc/' . $plugin\_slug . '.zip'; |
| [1304](#L1304) | $installed  = self::install\_plugin( $plugin\_zip ); |
| [1305](#L1305) | if ( $installed ) { |
| [1306](#L1306) | if ( ! function\_exists( 'activate\_plugin' ) ) { |
| [1307](#L1307) | require\_once ABSPATH . 'wp-admin/includes/plugin.php'; |
| [1308](#L1308) | } |
| [1309](#L1309) | $activate = activate\_plugin( $plugin\_init, '', false, false ); |
| [1310](#L1310) | } |
| [1311](#L1311) | } |
| [1312](#L1312) | } |
| [1313](#L1313) | } |
| [1314](#L1314) | wp\_send\_json\_success( |
| [1315](#L1315) | array( |
| [1316](#L1316) | 'pro\_plugins\_install' => true, |
| [1317](#L1317) | ) |
| [1318](#L1318) | ); |
| [1319](#L1319) | } |
| [1320](#L1320) |  |
| [1321](#L1321) | /\*\* |
| [1322](#L1322) | \* Check is plugin is installed. |
| [1323](#L1323) | \* |
| [1324](#L1324) | \* @param (String) $plugin\_init Plugin Init. |
| [1325](#L1325) | \* @since     1.0.0 |
| [1326](#L1326) | \*/ |
| [1327](#L1327) | public function is\_plugin\_installed( $plugin\_init ) { |
| [1328](#L1328) | if ( ! function\_exists( 'get\_plugins' ) ) { |
| [1329](#L1329) | require\_once ABSPATH . 'wp-admin/includes/plugin.php'; |
| [1330](#L1330) | } |
| [1331](#L1331) | $all\_plugins = get\_plugins(); |
| [1332](#L1332) |  |
| [1333](#L1333) | if ( ! empty( $all\_plugins[ $plugin\_init ] ) ) { |
| [1334](#L1334) | return true; |
| [1335](#L1335) | } else { |
| [1336](#L1336) | return false; |
| [1337](#L1337) | } |
| [1338](#L1338) | } |
| [1339](#L1339) |  |
| [1340](#L1340) | /\*\* |
| [1341](#L1341) | \* Install Plugin. |
| [1342](#L1342) | \* |
| [1343](#L1343) | \* @param (String) $plugin\_zip Plugin zip. |
| [1344](#L1344) | \* @since     1.0.0 |
| [1345](#L1345) | \*/ |
| [1346](#L1346) | public function install\_plugin( $plugin\_zip ) { |
| [1347](#L1347) | include\_once ABSPATH . 'wp-admin/includes/class-wp-upgrader.php'; |
| [1348](#L1348) | wp\_cache\_flush(); |
| [1349](#L1349) |  |
| [1350](#L1350) | $upgrader  = new Plugin\_Upgrader(); |
| [1351](#L1351) | $installed = $upgrader->install( $plugin\_zip ); |
| [1352](#L1352) |  |
| [1353](#L1353) | return $installed; |
| [1354](#L1354) | } |
| [1355](#L1355) |  |
| [1356](#L1356) | /\*\* |
| [1357](#L1357) | \* Required Plugin Activate |
| [1358](#L1358) | \* |
| [1359](#L1359) | \* @since 1.0.0 |
| [1360](#L1360) | \*/ |
| [1361](#L1361) | public function required\_plugin\_activate() { |
| [1362](#L1362) |  |
| [1363](#L1363) | check\_ajax\_referer( 'responsive-addons', '\_ajax\_nonce' ); |
| [1364](#L1364) |  |
| [1365](#L1365) | if ( ! current\_user\_can( 'activate\_plugins' ) ) { |
| [1366](#L1366) | wp\_send\_json\_error( |
| [1367](#L1367) | array( |
| [1368](#L1368) | 'success' => false, |
| [1369](#L1369) | 'message' => \_\_( 'Error: You don\'t have the required permissions to install plugins.', 'responsive-addons' ), |
| [1370](#L1370) | ) |
| [1371](#L1371) | ); |
| [1372](#L1372) | } |
| [1373](#L1373) |  |
| [1374](#L1374) | if ( ! isset( $\_POST['init'] ) || empty( $\_POST['init'] ) ) { |
| [1375](#L1375) | wp\_send\_json\_error( |
| [1376](#L1376) | array( |
| [1377](#L1377) | 'success' => false, |
| [1378](#L1378) | 'message' => \_\_( 'Plugins data is missing.', 'responsive-addons' ), |
| [1379](#L1379) | ) |
| [1380](#L1380) | ); |
| [1381](#L1381) | } |
| [1382](#L1382) |  |
| [1383](#L1383) | $data        = array(); |
| [1384](#L1384) | $plugin\_init = ( isset( $\_POST['init'] ) ) ? wp\_kses\_post( wp\_unslash( $\_POST['init'] ) ) : ''; |
| [1385](#L1385) | if(strpos($plugin\_init,'give') !== false){ |
| [1386](#L1386) | $silent = false; |
| [1387](#L1387) | } |
| [1388](#L1388) | else{ |
| [1389](#L1389) | $silent = true; |
| [1390](#L1390) | } |
| [1391](#L1391) | $activate = activate\_plugin( $plugin\_init, '', false, $silent ); |
| [1392](#L1392) |  |
| [1393](#L1393) | if ( is\_wp\_error( $activate ) ) { |
| [1394](#L1394) | wp\_send\_json\_error( |
| [1395](#L1395) | array( |
| [1396](#L1396) | 'success' => false, |
| [1397](#L1397) | 'message' => $activate->get\_error\_message(), |
| [1398](#L1398) | ) |
| [1399](#L1399) | ); |
| [1400](#L1400) | } |
| [1401](#L1401) |  |
| [1402](#L1402) | wp\_send\_json\_success( |
| [1403](#L1403) | array( |
| [1404](#L1404) | 'success' => true, |
| [1405](#L1405) | 'message' => \_\_( 'Plugin Activated', 'responsive-addons' ), |
| [1406](#L1406) | ) |
| [1407](#L1407) | ); |
| [1408](#L1408) |  |
| [1409](#L1409) | } |
| [1410](#L1410) |  |
| [1411](#L1411) | /\*\* |
| [1412](#L1412) | \* Check if Responsive Addons Pro is installed. |
| [1413](#L1413) | \*/ |
| [1414](#L1414) | public function is\_responsive\_pro\_is\_installed() { |
| [1415](#L1415) | $responsive\_pro\_slug = 'responsive-addons-pro/responsive-addons-pro.php'; |
| [1416](#L1416) | if ( ! function\_exists( 'get\_plugins' ) ) { |
| [1417](#L1417) | require\_once ABSPATH . 'wp-admin/includes/plugin.php'; |
| [1418](#L1418) | } |
| [1419](#L1419) | $all\_plugins = get\_plugins(); |
| [1420](#L1420) |  |
| [1421](#L1421) | if ( ! empty( $all\_plugins[ $responsive\_pro\_slug ] ) ) { |
| [1422](#L1422) | wp\_send\_json\_success(); |
| [1423](#L1423) | } else { |
| [1424](#L1424) | wp\_send\_json\_error(); |
| [1425](#L1425) | } |
| [1426](#L1426) | } |
| [1427](#L1427) |  |
| [1428](#L1428) | /\*\* |
| [1429](#L1429) | \* Check if Responsive Addons Pro is installed. |
| [1430](#L1430) | \*/ |
| [1431](#L1431) | public function responsive\_pro\_is\_installed() { |
| [1432](#L1432) | $responsive\_pro\_slug = 'responsive-addons-pro/responsive-addons-pro.php'; |
| [1433](#L1433) | if ( ! function\_exists( 'get\_plugins' ) ) { |
| [1434](#L1434) | require\_once ABSPATH . 'wp-admin/includes/plugin.php'; |
| [1435](#L1435) | } |
| [1436](#L1436) | $all\_plugins = get\_plugins(); |
| [1437](#L1437) |  |
| [1438](#L1438) | if ( ! empty( $all\_plugins[ $responsive\_pro\_slug ] ) ) { |
| [1439](#L1439) | return true; |
| [1440](#L1440) | } else { |
| [1441](#L1441) | return false; |
| [1442](#L1442) | } |
| [1443](#L1443) | } |
| [1444](#L1444) |  |
| [1445](#L1445) | /\*\* |
| [1446](#L1446) | \* Check if Responsive Addons Pro License is Active. |
| [1447](#L1447) | \*/ |
| [1448](#L1448) | public function is\_responsive\_pro\_license\_is\_active() { |
| [1449](#L1449) | global $wcam\_lib\_responsive\_pro; |
| [1450](#L1450) | if ( is\_null( $wcam\_lib\_responsive\_pro ) ) { |
| [1451](#L1451) | wp\_send\_json\_error(); |
| [1452](#L1452) | } |
| [1453](#L1453) | $license\_status = $wcam\_lib\_responsive\_pro->license\_key\_status(); |
| [1454](#L1454) |  |
| [1455](#L1455) | if ( ! empty( $license\_status['data']['activated'] ) && $license\_status['data']['activated'] ) { |
| [1456](#L1456) | wp\_send\_json\_success(); |
| [1457](#L1457) | } else { |
| [1458](#L1458) | wp\_send\_json\_error(); |
| [1459](#L1459) | } |
| [1460](#L1460) | } |
| [1461](#L1461) |  |
| [1462](#L1462) | /\*\* |
| [1463](#L1463) | \* Check if Responsive Addons Pro License is Active. |
| [1464](#L1464) | \*/ |
| [1465](#L1465) | public function responsive\_pro\_license\_is\_active() { |
| [1466](#L1466) | global $wcam\_lib\_responsive\_pro; |
| [1467](#L1467) | if ( is\_null( $wcam\_lib\_responsive\_pro ) ) { |
| [1468](#L1468) | return false; |
| [1469](#L1469) | } |
| [1470](#L1470) | $license\_status = $wcam\_lib\_responsive\_pro->license\_key\_status(); |
| [1471](#L1471) |  |
| [1472](#L1472) | if ( ! empty( $license\_status['data']['activated'] ) && $license\_status['data']['activated'] ) { |
| [1473](#L1473) | return true; |
| [1474](#L1474) | } else { |
| [1475](#L1475) | return false; |
| [1476](#L1476) | } |
| [1477](#L1477) | } |
| [1478](#L1478) |  |
| [1479](#L1479) | /\*\* |
| [1480](#L1480) | \* Adding the theme menu page |
| [1481](#L1481) | \*/ |
| [1482](#L1482) | public function responsive\_addons\_admin\_page() { |
| [1483](#L1483) |  |
| [1484](#L1484) | if ( $this->is\_responsive() ) { |
| [1485](#L1485) | $menu\_title = 'Responsive Templates'; |
| [1486](#L1486) | } else { |
| [1487](#L1487) | $menu\_title = 'Responsive Starter Templates'; |
| [1488](#L1488) | } |
| [1489](#L1489) |  |
| [1490](#L1490) | add\_theme\_page( |
| [1491](#L1491) | 'Responsive Website Templates', |
| [1492](#L1492) | $menu\_title, |
| [1493](#L1493) | 'administrator', |
| [1494](#L1494) | 'responsive-add-ons', |
| [1495](#L1495) | array( $this, 'responsive\_add\_ons' ) |
| [1496](#L1496) | ); |
| [1497](#L1497) | } |
| [1498](#L1498) |  |
| [1499](#L1499) | /\*\* |
| [1500](#L1500) | \* Responsive Addons Admin Page |
| [1501](#L1501) | \*/ |
| [1502](#L1502) | public function responsive\_add\_ons\_templates() { |
| [1503](#L1503) |  |
| [1504](#L1504) | if ( $this->is\_responsive\_addons\_pro\_is\_active() && ! $this->responsive\_pro\_license\_is\_active() ) { |
| [1505](#L1505) | $theme = wp\_get\_theme(); |
| [1506](#L1506) | if ( 'Responsive' === $theme->get( 'Name' ) && version\_compare( $theme->get( 'Version' ), '4.8.8', '>=' ) ) { |
| [1507](#L1507) | wp\_redirect( admin\_url( 'themes.php?page=responsive#settings' ) ); |
| [1508](#L1508) | } else { |
| [1509](#L1509) | wp\_redirect( admin\_url( '/options-general.php?page=wc\_am\_client\_responsive\_addons\_pro\_dashboard' ) ); |
| [1510](#L1510) | } |
| [1511](#L1511) | exit(); |
| [1512](#L1512) | } |
| [1513](#L1513) | ?> |
| [1514](#L1514) | <div class="wrap"> |
| [1515](#L1515) | <?php |
| [1516](#L1516) | $this->init\_nav\_menu( 'general' ); |
| [1517](#L1517) | do\_action( 'responsive\_addons\_importer\_page' ); |
| [1518](#L1518) | ?> |
| [1519](#L1519) | </div> |
| [1520](#L1520) |  |
| [1521](#L1521) | <?php |
| [1522](#L1522) | } |
| [1523](#L1523) | /\*\* |
| [1524](#L1524) | \* Init Nav Menu |
| [1525](#L1525) | \* |
| [1526](#L1526) | \* @param mixed $action Action name. |
| [1527](#L1527) | \* @since 2.5.0 |
| [1528](#L1528) | \*/ |
| [1529](#L1529) | public function init\_nav\_menu( $action = '' ) { |
| [1530](#L1530) |  |
| [1531](#L1531) | if ( '' !== $action ) { |
| [1532](#L1532) | $this->render\_tab\_menu( $action ); |
| [1533](#L1533) | } |
| [1534](#L1534) | } |
| [1535](#L1535) |  |
| [1536](#L1536) | /\*\* |
| [1537](#L1537) | \* Render tab menu |
| [1538](#L1538) | \* |
| [1539](#L1539) | \* @param mixed $action Action name. |
| [1540](#L1540) | \* @since 2.5.0 |
| [1541](#L1541) | \*/ |
| [1542](#L1542) | public function render\_tab\_menu( $action = '' ) { |
| [1543](#L1543) | ?> |
| [1544](#L1544) | <div id="responsive-sites-menu-page"> |
| [1545](#L1545) | <?php $this->render( $action ); ?> |
| [1546](#L1546) | </div> |
| [1547](#L1547) | <?php |
| [1548](#L1548) | } |
| [1549](#L1549) |  |
| [1550](#L1550) | /\*\* |
| [1551](#L1551) | \* Prints HTML content for tabs |
| [1552](#L1552) | \* |
| [1553](#L1553) | \* @param mixed $action Action name. |
| [1554](#L1554) | \* @since 2.5.0 |
| [1555](#L1555) | \*/ |
| [1556](#L1556) | public function render( $action ) { |
| [1557](#L1557) | ?> |
| [1558](#L1558) | <div class="nav-tab-wrapper"> |
| [1559](#L1559) | <div class="logo"> |
| [1560](#L1560) | <div class="responsive-sites-logo-wrap"> |
| [1561](#L1561) | <img src="<?php echo esc\_url( RESPONSIVE\_ADDONS\_URI . 'admin/images/svgs/responsive-starter-templates-thumbnail.svg' ); ?>"> |
| [1562](#L1562) | </div> |
| [1563](#L1563) | </div> |
| [1564](#L1564) | <div id="responsive-sites-filters" class="hide-on-mobile"> |
| [1565](#L1565) | <?php $this->site\_filters(); ?> |
| [1566](#L1566) | </div> |
| [1567](#L1567) | <div class="form"> |
| [1568](#L1568) | <div class="rst-my-favourite"> |
| [1569](#L1569) | <div id="rst-my-favorite-btn" class="rst-my-favourite-tooltip"> |
| [1570](#L1570) | <svg xmlns="http://www.w3.org/2000/svg" width="25" height="26" viewBox="0 0 25 26" fill="none"> |
| [1571](#L1571) | <path d="M12.5002 22.7396L10.9897 21.3646C5.62516 16.5 2.0835 13.2812 2.0835 9.35417C2.0835 6.13542 4.60433 3.625 7.81266 3.625C9.62516 3.625 11.3647 4.46875 12.5002 5.79167C13.6356 4.46875 15.3752 3.625 17.1877 3.625C20.396 3.625 22.9168 6.13542 22.9168 9.35417C22.9168 13.2812 19.3752 16.5 14.0106 21.3646L12.5002 22.7396Z" fill="#9CA3AF"/> |
| [1572](#L1572) | </svg> |
| [1573](#L1573) | <span class="tooltip-text"><?php esc\_html\_e( 'Favourites', 'responsive-add-ons' ); ?></span> |
| [1574](#L1574) | </div> |
| [1575](#L1575) | </div> |
| [1576](#L1576) | <div class="sync-ready-sites-templates-wrap header-actions"> |
| [1577](#L1577) | <div class="filters-slug"> |
| [1578](#L1578) | <a title="<?php esc\_html\_e( 'Sync Responsive Starter Templates', 'responsive-add-ons' ); ?>" href="#" class="responsive-ready-sites-sync-templates-button"> |
| [1579](#L1579) | <span class="dashicons dashicons-update-alt"></span> |
| [1580](#L1580) | </a> |
| [1581](#L1581) | </div> |
| [1582](#L1582) | </div> |
| [1583](#L1583) | <span class="page-builder-icon"> |
| [1584](#L1584) | <div class="selected-page-builder"> |
| [1585](#L1585) | <?php |
| [1586](#L1586) | $page\_builder = array( |
| [1587](#L1587) | 'name' => 'Elementor', |
| [1588](#L1588) | 'slug' => 'elementor', |
| [1589](#L1589) | ); |
| [1590](#L1590) | if ( $page\_builder ) { |
| [1591](#L1591) | ?> |
| [1592](#L1592) | <span class="page-builder-title"><img src="<?php echo esc\_url( RESPONSIVE\_ADDONS\_URI . 'admin/images/svgs/'.esc\_html( $page\_builder['slug'] ).'.svg' ); ?>"><span><?php echo esc\_html( $page\_builder['name'] ); ?></span></span> |
| [1593](#L1593) | <span class="dashicons dashicons-arrow-down"></span> |
| [1594](#L1594) | <?php } ?> |
| [1595](#L1595) | </div> |
| [1596](#L1596) | <ul class="page-builders"> |
| [1597](#L1597) | <?php |
| [1598](#L1598) | $default\_page\_builder = 'elementor'; |
| [1599](#L1599) | $page\_builders        = $this->get\_default\_page\_builders(); |
| [1600](#L1600) | foreach ( $page\_builders as $key => $page\_builder ) { |
| [1601](#L1601) | $class = ''; |
| [1602](#L1602) | if ( $default\_page\_builder === $page\_builder['slug'] ) { |
| [1603](#L1603) | $class = 'active'; |
| [1604](#L1604) | } |
| [1605](#L1605) | ?> |
| [1606](#L1606) | <li data-page-builder="<?php echo esc\_html( $page\_builder['slug'] ); ?>" class="<?php echo esc\_html( $class ); ?>"> |
| [1607](#L1607) | <img src="<?php echo esc\_url( RESPONSIVE\_ADDONS\_URI . 'admin/images/svgs/'.esc\_html( $page\_builder['slug'] ).'.svg' ); ?>"> |
| [1608](#L1608) | <div class="title"><?php echo esc\_html( $page\_builder['name'] ); ?></div> |
| [1609](#L1609) | </li> |
| [1610](#L1610) | <?php |
| [1611](#L1611) | } |
| [1612](#L1612) | ?> |
| [1613](#L1613) | </ul> |
| [1614](#L1614) | <form id="responsive-sites-welcome-form-inline" enctype="multipart/form-data" method="post" style="display: none;"> |
| [1615](#L1615) | <div class="fields"> |
| [1616](#L1616) | <input type="hidden" name="page\_builder" class="page-builder-input" required="required" /> |
| [1617](#L1617) | </div> |
| [1618](#L1618) | <input type="hidden" name="message" value="saved" /> |
| [1619](#L1619) | <?php wp\_nonce\_field( 'responsive-sites-welcome-screen', 'responsive-sites-page-builder' ); ?> |
| [1620](#L1620) | </form> |
| [1621](#L1621) | </span> |
| [1622](#L1622) | <div class="guided-overlay step-one" id="step-one"> |
| [1623](#L1623) | <p class="guide-text">Select your desired page builder.</p> |
| [1624](#L1624) | <div class="guided-overlay-buttons"> |
| [1625](#L1625) | <button class="skip-tour" id="skip-tour">Skip tour</button> |
| [1626](#L1626) | <button id="step-one-next">Next</button> |
| [1627](#L1627) | </div> |
| [1628](#L1628) | </div> |
| [1629](#L1629) | <div class="rst-admin-overlay"> |
| [1630](#L1630) | <img id="rst-admin-overlay" class="rst-admin-overlay-icon" src="<?php echo esc\_url( RESPONSIVE\_ADDONS\_URI . 'admin/images/svgs/admin-overlay-help.svg' ); ?>"> |
| [1631](#L1631) | </div> |
| [1632](#L1632) | <div> |
| [1633](#L1633) | <?php $this->responsive\_sites\_admin\_overlay(); ?> |
| [1634](#L1634) | </div> |
| [1635](#L1635) | </div> |
| [1636](#L1636) | </div><!-- .nav-tab-wrapper --> |
| [1637](#L1637) | <div id="responsive-sites-filters" class="hide-on-desktop"> |
| [1638](#L1638) | <?php $this->site\_filters(); ?> |
| [1639](#L1639) | </div> |
| [1640](#L1640) | <?php |
| [1641](#L1641) | } |
| [1642](#L1642) |  |
| [1643](#L1643) | /\*\* |
| [1644](#L1644) | \* Site Filters |
| [1645](#L1645) | \* |
| [1646](#L1646) | \* @since 2.5.0 |
| [1647](#L1647) | \* |
| [1648](#L1648) | \* @return void |
| [1649](#L1649) | \*/ |
| [1650](#L1650) | public function site\_filters() { |
| [1651](#L1651) | ?> |
| [1652](#L1652) | <div class="wp-filter hide-if-no-js"> |
| [1653](#L1653) | <div class="section-left"> |
| [1654](#L1654) | <div class="search-form"> |
| [1655](#L1655) | <div id="responsive-sites\_\_type-filter" class="dropdown-check-list" tabindex="100"> |
| [1656](#L1656) | <span class="responsive-sites\_\_type-filter-anchor" data-slug=""><?php esc\_html\_e( 'All', 'responsive-addons' ); ?></span> |
| [1657](#L1657) | <ul class="responsive-sites\_\_type-filter-items"> |
| [1658](#L1658) | <li class="responsive-sites\_\_filter-wrap-checkbox first-wrap" data-slug="all"> |
| [1659](#L1659) | <label> |
| [1660](#L1660) | <input id="radio-all" type="radio" name="responsive-sites-radio" class="checkbox active" value="" checked /><?php esc\_html\_e( 'All', 'responsive-addons' ); ?> |
| [1661](#L1661) | </label> |
| [1662](#L1662) | </li> |
| [1663](#L1663) | <li class="responsive-sites\_\_filter-wrap-checkbox" data-slug="free"> |
| [1664](#L1664) | <label> |
| [1665](#L1665) | <input id="radio-free" type="radio" name="responsive-sites-radio" class="checkbox" value="free" /><?php esc\_html\_e( 'Free', 'responsive-addons' ); ?> |
| [1666](#L1666) | </label> |
| [1667](#L1667) | </li> |
| [1668](#L1668) | <li class="responsive-sites\_\_filter-wrap-checkbox" data-slug="premium"> |
| [1669](#L1669) | <label> |
| [1670](#L1670) | <input id="radio-premium" type="radio" name="responsive-sites-radio" class="checkbox" value="premium" /><?php esc\_html\_e( 'Premium', 'responsive-addons' ); ?> |
| [1671](#L1671) | </label> |
| [1672](#L1672) | </li> |
| [1673](#L1673) | </ul> |
| [1674](#L1674) | </div> |
| [1675](#L1675) | <div class="guided-overlay step-two" id="step-two"> |
| [1676](#L1676) | <p class="guide-text">Choose the category and type of the template from the dropdown.</p> |
| [1677](#L1677) | <div class="guided-overlay-buttons"> |
| [1678](#L1678) | <button class="skip-tour"id="skip-tour-two">Skip tour</button> |
| [1679](#L1679) | <button id="step-two-previous">Previous</button> |
| [1680](#L1680) | <button id="step-two-next">Next</button> |
| [1681](#L1681) | </div> |
| [1682](#L1682) | </div> |
| [1683](#L1683) | <input autocomplete="off" placeholder="<?php esc\_html\_e( 'Search...', 'responsive-addons' ); ?>" type="search" aria-describedby="live-search-desc" id="wp-filter-search-input" class="wp-filter-search"> |
| [1684](#L1684) | <span class="responsive-icon-search search-icon"></span> |
| [1685](#L1685) | <div class="responsive-sites-autocomplete-result"></div> |
| [1686](#L1686) | </div> |
| [1687](#L1687) | </div> |
| [1688](#L1688) | </div> |
| [1689](#L1689) | <?php |
| [1690](#L1690) | } |
| [1691](#L1691) |  |
| [1692](#L1692) |  |
| [1693](#L1693) | /\*\* |
| [1694](#L1694) | \* Get Default Page Builders |
| [1695](#L1695) | \* |
| [1696](#L1696) | \* @since 2.5.0 |
| [1697](#L1697) | \* @return array |
| [1698](#L1698) | \*/ |
| [1699](#L1699) | public function get\_default\_page\_builders() { |
| [1700](#L1700) | return array( |
| [1701](#L1701) | array( |
| [1702](#L1702) | 'id'   => 1, |
| [1703](#L1703) | 'slug' => 'all', |
| [1704](#L1704) | 'name' => 'All', |
| [1705](#L1705) | ), |
| [1706](#L1706) | array( |
| [1707](#L1707) | 'id'   => 2, |
| [1708](#L1708) | 'slug' => 'elementor', |
| [1709](#L1709) | 'name' => 'Elementor', |
| [1710](#L1710) | ), |
| [1711](#L1711) | array( |
| [1712](#L1712) | 'id'   => 3, |
| [1713](#L1713) | 'slug' => 'gutenberg', |
| [1714](#L1714) | 'name' => 'Gutenberg', |
| [1715](#L1715) | ), |
| [1716](#L1716) | ); |
| [1717](#L1717) | } |
| [1718](#L1718) |  |
| [1719](#L1719) | /\*\* |
| [1720](#L1720) | \* Check if Responsive Addons Pro is installed. |
| [1721](#L1721) | \*/ |
| [1722](#L1722) | public function is\_responsive\_addons\_pro\_is\_active() { |
| [1723](#L1723) | $responsive\_pro\_slug = 'responsive-addons-pro/responsive-addons-pro.php'; |
| [1724](#L1724) | if ( ! function\_exists( 'get\_plugins' ) ) { |
| [1725](#L1725) | require\_once ABSPATH . 'wp-admin/includes/plugin.php'; |
| [1726](#L1726) | } |
| [1727](#L1727) |  |
| [1728](#L1728) | if ( is\_plugin\_active( $responsive\_pro\_slug ) ) { |
| [1729](#L1729) | return true; |
| [1730](#L1730) | } else { |
| [1731](#L1731) | return false; |
| [1732](#L1732) | } |
| [1733](#L1733) | } |
| [1734](#L1734) |  |
| [1735](#L1735) | /\*\* |
| [1736](#L1736) | \* Add rating links to the Responsive Addons Admin Page |
| [1737](#L1737) | \* |
| [1738](#L1738) | \* @param string $footer\_text The existing footer text. |
| [1739](#L1739) | \* |
| [1740](#L1740) | \* @return string |
| [1741](#L1741) | \* @since 2.0.6 |
| [1742](#L1742) | \* @global string $typenow |
| [1743](#L1743) | \*/ |
| [1744](#L1744) | public function responsive\_addons\_admin\_rate\_us( $footer\_text ) { |
| [1745](#L1745) | $page        = isset( $\_GET['page'] ) ? sanitize\_key( $\_GET['page'] ) : ''; |
| [1746](#L1746) | $show\_footer = array( 'responsive-add-ons' ); |
| [1747](#L1747) |  |
| [1748](#L1748) | if ( in\_array( $page, $show\_footer ) ) { |
| [1749](#L1749) | $rate\_text ='<div class="rst-branding-footer"> |
| [1750](#L1750) | <div class="rst-branding-footer-text"> |
| [1751](#L1751) | If you like <strong>Responsive Starter Templates</strong>, please leave us a "<a href="https://wordpress.org/support/view/plugin-reviews/responsive-add-ons?filter=5#postform" target="\_blank" class="responsive-rating-link" style="text-decoration:none;" data-rated="' . esc\_attr\_\_( 'Thanks :)', 'responsive-addons' ) . '">&#9733;&#9733;&#9733;&#9733;&#9733;</a>" rating. Thank you! |
| [1752](#L1752) | </div> |
| [1753](#L1753) | <img class="rst-footer-branding-img" src="'. esc\_url( RESPONSIVE\_ADDONS\_URI . "admin/images/responsive-addons-footer-thumbnail.png" ).'"> |
| [1754](#L1754) | </div>'; |
| [1755](#L1755) |  |
| [1756](#L1756) | return $rate\_text; |
| [1757](#L1757) | } else { |
| [1758](#L1758) | return $footer\_text; |
| [1759](#L1759) | } |
| [1760](#L1760) | } |
| [1761](#L1761) |  |
| [1762](#L1762) | /\*\* |
| [1763](#L1763) | \* Output buffer |
| [1764](#L1764) | \*/ |
| [1765](#L1765) | public function app\_output\_buffer() { |
| [1766](#L1766) | ob\_start(); |
| [1767](#L1767) | } |
| [1768](#L1768) |  |
| [1769](#L1769) | /\*\* |
| [1770](#L1770) | \* Check if Responsive theme or Child theme of Responsive is Active |
| [1771](#L1771) | \* |
| [1772](#L1772) | \* @since 2.1.1 |
| [1773](#L1773) | \*/ |
| [1774](#L1774) | public function check\_responsive\_theme\_active() { |
| [1775](#L1775) |  |
| [1776](#L1776) | check\_ajax\_referer( 'responsive-addons', '\_ajax\_nonce' ); |
| [1777](#L1777) |  |
| [1778](#L1778) | if ( ! current\_user\_can( 'switch\_themes' ) ) { |
| [1779](#L1779) | wp\_send\_json\_error( \_\_( 'User does not have permission!', 'responsive-addons' ) ); |
| [1780](#L1780) | } |
| [1781](#L1781) |  |
| [1782](#L1782) | $current\_theme = wp\_get\_theme(); |
| [1783](#L1783) | if ( ( 'Responsive' === $current\_theme->get( 'Name' ) ) || ( is\_child\_theme() && 'Responsive' === $current\_theme->parent()->get( 'Name' ) ) ) { |
| [1784](#L1784) | wp\_send\_json\_success( |
| [1785](#L1785) | array( 'success' => true ) |
| [1786](#L1786) | ); |
| [1787](#L1787) | } else { |
| [1788](#L1788) | wp\_send\_json\_error( |
| [1789](#L1789) | array( 'success' => false ) |
| [1790](#L1790) | ); |
| [1791](#L1791) | } |
| [1792](#L1792) | } |
| [1793](#L1793) |  |
| [1794](#L1794) | /\*\* |
| [1795](#L1795) | \* Create Elementor Template. |
| [1796](#L1796) | \* |
| [1797](#L1797) | \* @since  2.9.1 |
| [1798](#L1798) | \*/ |
| [1799](#L1799) | public function create\_elementor\_template() { |
| [1800](#L1800) |  |
| [1801](#L1801) | // Verify Nonce. |
| [1802](#L1802) | check\_ajax\_referer( 'responsive-addons', '\_ajax\_nonce' ); |
| [1803](#L1803) |  |
| [1804](#L1804) | if ( ! current\_user\_can( 'customize' ) ) { |
| [1805](#L1805) | wp\_send\_json\_error( \_\_( 'You are not allowed to perform this action', 'responsive-addons' ) ); |
| [1806](#L1806) | } |
| [1807](#L1807) |  |
| [1808](#L1808) | $id   = isset( $\_POST['id'] ) ? absint( $\_POST['id'] ) : ''; |
| [1809](#L1809) | $type = isset( $\_POST['type'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['type'] ) ) : ''; |
| [1810](#L1810) | $url  = self::$rst\_blocks\_api\_url . 'pages/' . $id; |
| [1811](#L1811) |  |
| [1812](#L1812) | $api\_url = add\_query\_arg( |
| [1813](#L1813) | array( |
| [1814](#L1814) | 'site\_url' => site\_url(), |
| [1815](#L1815) | 'version'  => RESPONSIVE\_ADDONS\_VER, |
| [1816](#L1816) | ), |
| [1817](#L1817) | $url |
| [1818](#L1818) | ); |
| [1819](#L1819) |  |
| [1820](#L1820) | $response = wp\_remote\_get( $api\_url ); |
| [1821](#L1821) |  |
| [1822](#L1822) | if ( is\_wp\_error( $response ) || 200 !== $response['response']['code'] ) { |
| [1823](#L1823) | wp\_send\_json\_error( wp\_remote\_retrieve\_body( $response ) ); |
| [1824](#L1824) | } |
| [1825](#L1825) |  |
| [1826](#L1826) | $body = wp\_remote\_retrieve\_body( $response ); |
| [1827](#L1827) | $data = json\_decode( $body, true ); |
| [1828](#L1828) |  |
| [1829](#L1829) | if ( empty( $data ) ) { |
| [1830](#L1830) | wp\_send\_json\_error( 'Empty page data.' ); |
| [1831](#L1831) | } |
| [1832](#L1832) |  |
| [1833](#L1833) | $content = isset( $data['content']['rendered'] ) ? $data['content']['rendered'] : ''; |
| [1834](#L1834) |  |
| [1835](#L1835) | $page\_id = isset( $data['id'] ) ? sanitize\_text\_field( $data['id'] ) : ''; |
| [1836](#L1836) |  |
| [1837](#L1837) | $title          = ''; |
| [1838](#L1838) | $rendered\_title = isset( $data['title']['rendered'] ) ? sanitize\_text\_field( $data['title']['rendered'] ) : ''; |
| [1839](#L1839) | if ( isset( $rendered\_title ) ) { |
| [1840](#L1840) | $title = ( isset( $\_POST['title'] ) && '' !== $\_POST['title'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['title'] ) ) . ' - ' . $rendered\_title : $rendered\_title; |
| [1841](#L1841) | } |
| [1842](#L1842) |  |
| [1843](#L1843) | $excerpt = isset( $data['excerpt']['rendered'] ) ? sanitize\_text\_field( $data['excerpt']['rendered'] ) : ''; |
| [1844](#L1844) |  |
| [1845](#L1845) | $post\_args = array( |
| [1846](#L1846) | 'post\_type'    => 'elementor\_library', |
| [1847](#L1847) | 'post\_status'  => 'publish', |
| [1848](#L1848) | 'post\_title'   => $title, |
| [1849](#L1849) | 'post\_content' => $content, |
| [1850](#L1850) | 'post\_excerpt' => $excerpt, |
| [1851](#L1851) | ); |
| [1852](#L1852) |  |
| [1853](#L1853) | $new\_page\_id = wp\_insert\_post( $post\_args ); |
| [1854](#L1854) | update\_post\_meta( $new\_page\_id, '\_responsive\_sites\_enable\_for\_batch', true ); |
| [1855](#L1855) | $post\_meta = isset( $data['post-meta'] ) ? $data['post-meta'] : array(); |
| [1856](#L1856) |  |
| [1857](#L1857) | if ( ! empty( $post\_meta ) ) { |
| [1858](#L1858) | $this->import\_template\_meta( $new\_page\_id, $post\_meta ); |
| [1859](#L1859) | } |
| [1860](#L1860) |  |
| [1861](#L1861) | $term\_value = ( 'pages' === $type ) ? 'page' : 'container'; |
| [1862](#L1862) | update\_post\_meta( $new\_page\_id, '\_elementor\_template\_type', $term\_value ); |
| [1863](#L1863) | wp\_set\_object\_terms( $new\_page\_id, $term\_value, 'elementor\_library\_type' ); |
| [1864](#L1864) |  |
| [1865](#L1865) | update\_post\_meta( $new\_page\_id, '\_wp\_page\_template', 'elementor\_header\_footer' ); |
| [1866](#L1866) |  |
| [1867](#L1867) | do\_action( 'responsive\_sites\_process\_single', $new\_page\_id ); |
| [1868](#L1868) |  |
| [1869](#L1869) | wp\_send\_json\_success( |
| [1870](#L1870) | array( |
| [1871](#L1871) | 'remove-page-id' => $page\_id, |
| [1872](#L1872) | 'id'             => $new\_page\_id, |
| [1873](#L1873) | 'link'           => get\_permalink( $new\_page\_id ), |
| [1874](#L1874) | ) |
| [1875](#L1875) | ); |
| [1876](#L1876) | } |
| [1877](#L1877) |  |
| [1878](#L1878) | /\*\* |
| [1879](#L1879) | \* Check if Responsive theme or Child theme of Responsive is Active |
| [1880](#L1880) | \* |
| [1881](#L1881) | \* @since 2.1.1 |
| [1882](#L1882) | \*/ |
| [1883](#L1883) | public function get\_responsive\_theme() { |
| [1884](#L1884) |  |
| [1885](#L1885) | if ( ! current\_user\_can( 'install\_themes' ) ) { |
| [1886](#L1886) | wp\_die( esc\_html\_\_( 'Sorry, you are not allowed to install themes on this site.' ) ); |
| [1887](#L1887) | } |
| [1888](#L1888) |  |
| [1889](#L1889) | include\_once ABSPATH . 'wp-admin/includes/class-wp-upgrader.php'; // For themes\_api(). |
| [1890](#L1890) |  |
| [1891](#L1891) | $theme = 'responsive'; |
| [1892](#L1892) |  |
| [1893](#L1893) | $api = themes\_api( |
| [1894](#L1894) | 'theme\_information', |
| [1895](#L1895) | array( |
| [1896](#L1896) | 'slug' => $theme, |
| [1897](#L1897) | ) |
| [1898](#L1898) | ); // Save on a bit of bandwidth. |
| [1899](#L1899) |  |
| [1900](#L1900) | if ( is\_wp\_error( $api ) ) { |
| [1901](#L1901) | wp\_die( esc\_html( $api ) ); |
| [1902](#L1902) | } |
| [1903](#L1903) |  |
| [1904](#L1904) | /\* translators: %s: Theme name and version. \*/ |
| [1905](#L1905) | $upgrader = new Theme\_Upgrader( new Theme\_Installer\_Skin() ); |
| [1906](#L1906) | $res      = $upgrader->install( $api->download\_link ); |
| [1907](#L1907) | switch\_theme( 'responsive' ); |
| [1908](#L1908) | if ( $res ) { |
| [1909](#L1909) | wp\_send\_json\_success(); |
| [1910](#L1910) | } else { |
| [1911](#L1911) | wp\_send\_json\_error(); |
| [1912](#L1912) | } |
| [1913](#L1913) | } |
| [1914](#L1914) |  |
| [1915](#L1915) | /\*\* |
| [1916](#L1916) | \* Register the menu for the plugin. |
| [1917](#L1917) | \* |
| [1918](#L1918) | \* @since 2.2.8 |
| [1919](#L1919) | \*/ |
| [1920](#L1920) | public function responsive\_add\_ons\_admin\_menu() { |
| [1921](#L1921) | $theme = wp\_get\_theme(); |
| [1922](#L1922) |  |
| [1923](#L1923) | if ( ( ( 'Responsive' !== $theme->name && 'Responsive' !== $theme->parent\_theme ) ) && is\_plugin\_inactive( 'responsive-block-editor-addons/responsive-block-editor-addons.php' ) && is\_plugin\_inactive( 'responsive-elementor-addons/responsive-elementor-addons.php' ) ) { |
| [1924](#L1924) | add\_menu\_page( 'Responsive', 'Responsive', 'manage\_options', 'responsive\_add\_ons', array( $this, 'responsive\_add\_ons\_templates' ), esc\_url( RESPONSIVE\_ADDONS\_DIR\_URL ) . 'admin/images/responsive-add-ons-menu-icon.png', 59 ); |
| [1925](#L1925) | add\_submenu\_page( |
| [1926](#L1926) | 'responsive\_add\_ons', |
| [1927](#L1927) | \_\_( 'Templates', 'responsive-elementor-addons' ), |
| [1928](#L1928) | \_\_( 'Templates', 'responsive-elementor-addons' ), |
| [1929](#L1929) | 'manage\_options', |
| [1930](#L1930) | 'responsive\_add\_ons', |
| [1931](#L1931) | array( $this, 'responsive\_add\_ons\_templates' ), |
| [1932](#L1932) | ); |
| [1933](#L1933) | } |
| [1934](#L1934) |  |
| [1935](#L1935) | if ( ( 'Responsive' === $theme->name || 'Responsive' === $theme->parent\_theme ) && version\_compare( RESPONSIVE\_THEME\_VERSION, '4.9.7.1', '<=' ) ) { |
| [1936](#L1936) |  |
| [1937](#L1937) | add\_menu\_page( |
| [1938](#L1938) | \_\_( 'Responsive Starter Templates', 'responsive-addons' ), |
| [1939](#L1939) | \_\_( 'Responsive', 'responsive-addons' ), |
| [1940](#L1940) | 'manage\_options', |
| [1941](#L1941) | 'responsive\_add\_ons', |
| [1942](#L1942) | array( $this, 'responsive\_add\_ons\_templates' ), |
| [1943](#L1943) | RESPONSIVE\_ADDONS\_URI . '/admin/images/responsive-add-ons-menu-icon.png', |
| [1944](#L1944) | 59.5 |
| [1945](#L1945) | ); |
| [1946](#L1946) |  |
| [1947](#L1947) | add\_submenu\_page( |
| [1948](#L1948) | 'responsive\_add\_ons', |
| [1949](#L1949) | 'Responsive Starter Templates', |
| [1950](#L1950) | \_\_( 'Responsive Templates', 'responsive-addons' ), |
| [1951](#L1951) | 'manage\_options', |
| [1952](#L1952) | 'responsive\_add\_ons', |
| [1953](#L1953) | array( $this, 'responsive\_add\_ons\_templates' ), |
| [1954](#L1954) | 20 |
| [1955](#L1955) | ); |
| [1956](#L1956) | } |
| [1957](#L1957) | } |
| [1958](#L1958) |  |
| [1959](#L1959) | /\*\* |
| [1960](#L1960) | \* Go to Responsive Pro support. |
| [1961](#L1961) | \* |
| [1962](#L1962) | \* Fired by `admin\_init` action. |
| [1963](#L1963) | \* |
| [1964](#L1964) | \* @since 2.2.8 |
| [1965](#L1965) | \* @access public |
| [1966](#L1966) | \*/ |
| [1967](#L1967) | public function responsive\_add\_ons\_community\_support() { |
| [1968](#L1968) | if ( empty( $\_GET['page'] ) ) { |
| [1969](#L1969) | return; |
| [1970](#L1970) | } |
| [1971](#L1971) | wp\_redirect( 'https://www.facebook.com/groups/responsive.theme' ); |
| [1972](#L1972) | die; |
| [1973](#L1973) | } |
| [1974](#L1974) |  |
| [1975](#L1975) | /\*\* |
| [1976](#L1976) | \* Free vs Pro features list. |
| [1977](#L1977) | \* |
| [1978](#L1978) | \* @since 2.2.8 |
| [1979](#L1979) | \* @access public |
| [1980](#L1980) | \*/ |
| [1981](#L1981) | public function responsive\_add\_ons\_go\_pro() { |
| [1982](#L1982) | require\_once RESPONSIVE\_ADDONS\_DIR . 'admin/templates/free-vs-pro.php'; |
| [1983](#L1983) | } |
| [1984](#L1984) |  |
| [1985](#L1985) | /\*\* |
| [1986](#L1986) | \* On admin init. |
| [1987](#L1987) | \* |
| [1988](#L1988) | \* Preform actions on WordPress admin initialization. |
| [1989](#L1989) | \* |
| [1990](#L1990) | \* Fired by `admin\_init` action. |
| [1991](#L1991) | \* |
| [1992](#L1992) | \* @since 2.2.8 |
| [1993](#L1993) | \* @access public |
| [1994](#L1994) | \*/ |
| [1995](#L1995) | public function responsive\_add\_ons\_on\_admin\_init() { |
| [1996](#L1996) |  |
| [1997](#L1997) | $this->responsive\_add\_ons\_remove\_all\_admin\_notices(); |
| [1998](#L1998) | } |
| [1999](#L1999) |  |
| [2000](#L2000) | /\*\* |
| [2001](#L2001) | \* Removes all the admin notices. |
| [2002](#L2002) | \* |
| [2003](#L2003) | \* @since 2.2.8 |
| [2004](#L2004) | \* @access private |
| [2005](#L2005) | \*/ |
| [2006](#L2006) | private function responsive\_add\_ons\_remove\_all\_admin\_notices() { |
| [2007](#L2007) | $responsive\_add\_ons\_pages = array( |
| [2008](#L2008) | 'responsive\_add\_ons', |
| [2009](#L2009) | 'responsive-add-ons', |
| [2010](#L2010) | 'responsive\_addons\_pro\_system\_info', |
| [2011](#L2011) | ); |
| [2012](#L2012) |  |
| [2013](#L2013) | if ( empty( $\_GET['page'] ) || ! in\_array( $\_GET['page'], $responsive\_add\_ons\_pages, true ) ) { |
| [2014](#L2014) | return; |
| [2015](#L2015) | } |
| [2016](#L2016) |  |
| [2017](#L2017) | remove\_all\_actions( 'admin\_notices' ); |
| [2018](#L2018) | } |
| [2019](#L2019) |  |
| [2020](#L2020) | /\*\* |
| [2021](#L2021) | \* Get all sites |
| [2022](#L2022) | \* |
| [2023](#L2023) | \* @since 2.5.0 |
| [2024](#L2024) | \* @return array All sites. |
| [2025](#L2025) | \*/ |
| [2026](#L2026) | public function get\_all\_sites() { |
| [2027](#L2027) | $sites\_and\_pages = array(); |
| [2028](#L2028) |  |
| [2029](#L2029) | $total\_requests = (int) get\_site\_option( 'responsive-ready-sites-requests', 0 ); |
| [2030](#L2030) |  |
| [2031](#L2031) | $favorite\_settings = get\_option( 'responsive-sites-favorites', array() ); |
| [2032](#L2032) |  |
| [2033](#L2033) | for ( $page = 1; $page <= $total\_requests; $page++ ) { |
| [2034](#L2034) | $current\_page\_data = get\_site\_option( 'responsive-ready-sites-and-pages-page-' . $page, array() ); |
| [2035](#L2035) | if ( ! empty( $current\_page\_data ) ) { |
| [2036](#L2036) | foreach ( $current\_page\_data as $page\_id => $page\_data ) { |
| [2037](#L2037) | if (in\_array($page\_data['id'], $favorite\_settings)) { |
| [2038](#L2038) | // If it exists in the favorites array, add favorite status |
| [2039](#L2039) | $page\_data['favorite\_status'] = "active"; |
| [2040](#L2040) | } |
| [2041](#L2041) | $sites\_and\_pages[] = $page\_data; |
| [2042](#L2042) | } |
| [2043](#L2043) | } |
| [2044](#L2044) | } |
| [2045](#L2045) | return $sites\_and\_pages; |
| [2046](#L2046) | } |
| [2047](#L2047) |  |
| [2048](#L2048) | /\*\* |
| [2049](#L2049) | \* Get all RST Blocks |
| [2050](#L2050) | \* |
| [2051](#L2051) | \* @since 2.9.1 |
| [2052](#L2052) | \* @return array All RST Blocks. |
| [2053](#L2053) | \*/ |
| [2054](#L2054) | public function get\_all\_rst\_blocks() { |
| [2055](#L2055) | $blocks = array(); |
| [2056](#L2056) |  |
| [2057](#L2057) | $total\_requests = (int) get\_site\_option( 'rst-blocks-requests', 0 ); |
| [2058](#L2058) |  |
| [2059](#L2059) | for ( $page = 1; $page <= $total\_requests; $page++ ) { |
| [2060](#L2060) | $current\_page\_data = get\_site\_option( 'rst-blocks-page-' . $page, array() ); |
| [2061](#L2061) | if ( ! empty( $current\_page\_data ) ) { |
| [2062](#L2062) | foreach ( $current\_page\_data as $page\_id => $page\_data ) { |
| [2063](#L2063) | $blocks[] = $page\_data; |
| [2064](#L2064) | } |
| [2065](#L2065) | } |
| [2066](#L2066) | } |
| [2067](#L2067) | return $blocks; |
| [2068](#L2068) | } |
| [2069](#L2069) |  |
| [2070](#L2070) | /\*\* |
| [2071](#L2071) | \* Get Page Builder Sites |
| [2072](#L2072) | \* |
| [2073](#L2073) | \* @since 2.5.0 |
| [2074](#L2074) | \* |
| [2075](#L2075) | \* @return array page builder sites. |
| [2076](#L2076) | \*/ |
| [2077](#L2077) | public function get\_sites\_by\_page\_builder() { |
| [2078](#L2078) | $sites\_and\_pages            = $this->get\_all\_sites(); |
| [2079](#L2079) | $current\_page\_builder\_sites = array(); |
| [2080](#L2080) | if ( ! empty( $sites\_and\_pages ) ) { |
| [2081](#L2081) | foreach ( $sites\_and\_pages as $site\_id => $site\_details ) { |
| [2082](#L2082) | $current\_page\_builder\_sites[] = $site\_details; |
| [2083](#L2083) | } |
| [2084](#L2084) | } |
| [2085](#L2085) |  |
| [2086](#L2086) | return $current\_page\_builder\_sites; |
| [2087](#L2087) | } |
| [2088](#L2088) |  |
| [2089](#L2089) | public function get\_favorite\_template\_site\_details( ) { |
| [2090](#L2090) | $favorite\_sites             = array(); |
| [2091](#L2091) |  |
| [2092](#L2092) | $current\_page\_builder\_sites = $this->get\_sites\_by\_page\_builder(); |
| [2093](#L2093) |  |
| [2094](#L2094) | $favorite\_settings = get\_option( 'responsive-sites-favorites', array() ); |
| [2095](#L2095) |  |
| [2096](#L2096) | if ( ! empty( $favorite\_settings ) && ! empty( $current\_page\_builder\_sites )) { |
| [2097](#L2097) | foreach ($current\_page\_builder\_sites as $site) { |
| [2098](#L2098) | if (in\_array($site['id'], $favorite\_settings)) { |
| [2099](#L2099) | // If it exists in the favorites array, add favorite status |
| [2100](#L2100) | $favorite\_sites[] = $site; |
| [2101](#L2101) | } |
| [2102](#L2102) | } |
| [2103](#L2103) | } |
| [2104](#L2104) |  |
| [2105](#L2105) | wp\_send\_json\_success( $favorite\_sites ) ; |
| [2106](#L2106) | } |
| [2107](#L2107) |  |
| [2108](#L2108) | /\*\* |
| [2109](#L2109) | \* Get Total Requests |
| [2110](#L2110) | \* |
| [2111](#L2111) | \* @since 2.5.0 |
| [2112](#L2112) | \* @return integer |
| [2113](#L2113) | \*/ |
| [2114](#L2114) | public function get\_total\_requests() { |
| [2115](#L2115) |  |
| [2116](#L2116) | $api\_args = array( |
| [2117](#L2117) | 'timeout' => 60, |
| [2118](#L2118) | ); |
| [2119](#L2119) |  |
| [2120](#L2120) | $api\_url = self::$api\_url . 'get-ready-sites-requests-count/?per\_page=15'; |
| [2121](#L2121) |  |
| [2122](#L2122) | $response = wp\_remote\_get( $api\_url, $api\_args ); |
| [2123](#L2123) |  |
| [2124](#L2124) | if ( ! is\_wp\_error( $response ) || wp\_remote\_retrieve\_response\_code( $response ) === 200 ) { |
| [2125](#L2125) |  |
| [2126](#L2126) | $total\_requests = json\_decode( wp\_remote\_retrieve\_body( $response ), true ); |
| [2127](#L2127) |  |
| [2128](#L2128) | if ( isset( $total\_requests ) ) { |
| [2129](#L2129) |  |
| [2130](#L2130) | update\_site\_option( 'responsive-ready-sites-requests', $total\_requests ); |
| [2131](#L2131) |  |
| [2132](#L2132) | return $total\_requests; |
| [2133](#L2133) | } |
| [2134](#L2134) | } |
| [2135](#L2135) |  |
| [2136](#L2136) | $this->get\_total\_requests(); |
| [2137](#L2137) | } |
| [2138](#L2138) |  |
| [2139](#L2139) | /\*\* |
| [2140](#L2140) | \* Add settings link |
| [2141](#L2141) | \* |
| [2142](#L2142) | \* @param array $links holds plugin links. |
| [2143](#L2143) | \*/ |
| [2144](#L2144) | public function responsive\_add\_view\_library\_btn($links){ |
| [2145](#L2145) | $settings\_link = '<a href="' . admin\_url( 'admin.php?page=responsive\_add\_ons' ) . '">' . \_\_( 'View Library', 'responsive-addons' ) . '</a>'; |
| [2146](#L2146) | array\_unshift( $links, $settings\_link ); |
| [2147](#L2147) | return $links; |
| [2148](#L2148) | } |
| [2149](#L2149) |  |
| [2150](#L2150) | public function responsive\_sites\_admin\_overlay(){ |
| [2151](#L2151) | ?> |
| [2152](#L2152) | <div style="display: none;" class="responsive-sites-overlay-reveal"> |
| [2153](#L2153) | <div class="responsive-sites-overlay-container"> |
| [2154](#L2154) | <button id="close-admin-overlay" title="close"> |
| [2155](#L2155) | <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"> |
| [2156](#L2156) | <path d="M17.9401 7.752L13.6921 12L17.9401 16.248L16.2481 17.94L12.0001 13.704L7.76406 17.94L6.06006 16.236L10.2961 12L6.06006 7.764L7.76406 6.06L12.0001 10.296L16.2481 6.06L17.9401 7.752Z" fill="#9CA3AF"/> |
| [2157](#L2157) | </svg> |
| [2158](#L2158) | </button> |
| [2159](#L2159) | <div class="responsive-sites-go-pro"> |
| [2160](#L2160) | <h3 class="responsive-sites-overlay-heading"><?php esc\_html\_e('Go Pro', 'responsive-addons') ?></h3> |
| [2161](#L2161) | <p class="responsive-sites-overlay-content"><?php esc\_html\_e('Get access to all the pro templates and unlock more theme customizer settings using Responsive Pro.', 'responsive-addons') ?></p> |
| [2162](#L2162) | <a href="https://cyberchimps.com/responsive-go-pro/?utm\_source=RST\_plugin&utm\_medium=intro\_screen\_slidein\_btn&utm\_campaign=free-to-pro&utm\_term=Go\_Pro\_btn" target="\_blank" class="button button-primary responsive-sites-go-pro-btn"><?php esc\_html\_e('Go Pro', 'responsive-addons') ?></a> |
| [2163](#L2163) | </div> |
| [2164](#L2164) | <div class="responsive-sites-help-center"> |
| [2165](#L2165) | <h3 class="responsive-sites-overlay-heading"><?php esc\_html\_e('Help Center', 'responsive-addons') ?></h3> |
| [2166](#L2166) | <p class="responsive-sites-overlay-content"><?php esc\_html\_e('Read the documentation to find answers to your questions.', 'responsive-addons') ?></p> |
| [2167](#L2167) | <a href="https://cyberchimps.com/docs-category/responsive-starter-templates-plugin/" target="\_blank" class="responsive-sites-help-center-btn"><?php esc\_html\_e('Learn More', 'responsive-addons') ?></a> |
| [2168](#L2168) | </div> |
| [2169](#L2169) | <div class="responsive-sites-video-guides"> |
| [2170](#L2170) | <h3 class="responsive-sites-overlay-heading"><?php esc\_html\_e('Video Guides', 'responsive-addons') ?></h3> |
| [2171](#L2171) | <p class="responsive-sites-overlay-content"><?php esc\_html\_e('Browse through these video tutorials to learn more about how the plugin functions.', 'responsive-addons') ?></p> |
| [2172](#L2172) | <a href="https://www.youtube.com/playlist?list=PLXTwxw3ZJwPSpE3RYanAdYgnDptbSvjXl" target="\_blank" class="responsive-sites-video-guides-btn"><?php esc\_html\_e('Watch Now', 'responsive-addons') ?></a> |
| [2173](#L2173) | </div> |
| [2174](#L2174) | <div class="responsive-sites-community-support"> |
| [2175](#L2175) | <h3 class="responsive-sites-overlay-heading"><?php esc\_html\_e('Community Support', 'responsive-addons') ?></h3> |
| [2176](#L2176) | <p class="responsive-sites-overlay-content"><?php esc\_html\_e('Find help to the commonly asked questions in our exclusive Community on Facebook.', 'responsive-addons') ?></p> |
| [2177](#L2177) | <a href="https://www.facebook.com/groups/responsive.theme/" target="\_blank" class="responsive-sites-community-support-btn"><?php esc\_html\_e('Find Help', 'responsive-addons') ?></a> |
| [2178](#L2178) | </div> |
| [2179](#L2179) | <div class="responsive-sites-rate-us"> |
| [2180](#L2180) | <h3 class="responsive-sites-overlay-heading"><?php esc\_html\_e('Rate Us', 'responsive-addons') ?></h3> |
| [2181](#L2181) | <p class="responsive-sites-rate-us-stars"> |
| [2182](#L2182) | <?php |
| [2183](#L2183) | for( $i=0; $i <5; $i++ ) { |
| [2184](#L2184) | ?> |
| [2185](#L2185) | <img src="<?php echo esc\_url( RESPONSIVE\_ADDONS\_URI . 'admin/images/svgs/star-rating.svg' ); ?>"> |
| [2186](#L2186) | <?php |
| [2187](#L2187) | } |
| [2188](#L2188) | ?> |
| [2189](#L2189) | </p> |
| [2190](#L2190) | <p class="responsive-sites-overlay-content"><?php esc\_html\_e('Lorem ipsum dolor sit amet consectetur. Consequat risus in facilisis ut ut sagittis.', 'responsive-addons') ?></p> |
| [2191](#L2191) | <a href="https://wordpress.org/support/plugin/responsive-add-ons/reviews/" target="\_blank" class="responsive-sites-rate-us-btn"><?php esc\_html\_e('Submit Review', 'responsive-addons') ?></a> |
| [2192](#L2192) | </div> |
| [2193](#L2193) | </div> |
| [2194](#L2194) | </div> |
| [2195](#L2195) | <?php |
| [2196](#L2196) | } |
| [2197](#L2197) |  |
| [2198](#L2198) | /\*\* |
| [2199](#L2199) | \* Add/Remove Favorite. |
| [2200](#L2200) | \* |
| [2201](#L2201) | \* @since  2.8.6 |
| [2202](#L2202) | \*/ |
| [2203](#L2203) | public function add\_to\_favorite() { |
| [2204](#L2204) |  |
| [2205](#L2205) | if ( ! current\_user\_can( 'manage\_options' ) ) { |
| [2206](#L2206) | wp\_send\_json\_error( 'You are not allowed to perform this action', 'responsive-addons' ); |
| [2207](#L2207) | } |
| [2208](#L2208) | // Verify Nonce. |
| [2209](#L2209) | check\_ajax\_referer( 'responsive-addons', '\_ajax\_nonce' ); |
| [2210](#L2210) |  |
| [2211](#L2211) | $site\_id       = isset( $\_POST['site\_id'] ) ? sanitize\_key( $\_POST['site\_id'] ) : ''; |
| [2212](#L2212) |  |
| [2213](#L2213) | if ( empty( $site\_id ) ) { |
| [2214](#L2214) | wp\_send\_json\_error(); |
| [2215](#L2215) | } |
| [2216](#L2216) |  |
| [2217](#L2217) | $favorite\_settings = get\_option( 'responsive-sites-favorites', array() ); |
| [2218](#L2218) |  |
| [2219](#L2219) | if ( false !== $favorite\_settings && is\_array( $favorite\_settings ) ) { |
| [2220](#L2220) | self::$new\_favorites = $favorite\_settings; |
| [2221](#L2221) | } |
| [2222](#L2222) |  |
| [2223](#L2223) | $is\_favorite = isset( $\_POST['is\_favorite'] ) ? sanitize\_key( $\_POST['is\_favorite'] ) : ''; |
| [2224](#L2224) |  |
| [2225](#L2225) | if ( 'false' === $is\_favorite ) { |
| [2226](#L2226) | if ( in\_array( $site\_id, self::$new\_favorites, true ) ) { |
| [2227](#L2227) | $key = array\_search( $site\_id, self::$new\_favorites, true ); |
| [2228](#L2228) | unset( self::$new\_favorites[ $key ] ); |
| [2229](#L2229) | } |
| [2230](#L2230) | } else { |
| [2231](#L2231) | if ( ! in\_array( $site\_id, self::$new\_favorites, true ) ) { |
| [2232](#L2232) | array\_push( self::$new\_favorites, $site\_id ); |
| [2233](#L2233) | } |
| [2234](#L2234) | } |
| [2235](#L2235) |  |
| [2236](#L2236) | update\_option( 'responsive-sites-favorites', self::$new\_favorites, 'no' ); |
| [2237](#L2237) |  |
| [2238](#L2238) | wp\_send\_json\_success( self::$new\_favorites ); |
| [2239](#L2239) |  |
| [2240](#L2240) | } |
| [2241](#L2241) |  |
| [2242](#L2242) | public function update\_all\_sites\_fav\_status() { |
| [2243](#L2243) |  |
| [2244](#L2244) | check\_ajax\_referer('responsive-addons', '\_ajax\_nonce'); |
| [2245](#L2245) |  |
| [2246](#L2246) | wp\_send\_json\_success( $this->get\_all\_sites() ); |
| [2247](#L2247) | } |
| [2248](#L2248) |  |
| [2249](#L2249) | /\*\* |
| [2250](#L2250) | \* Add user to Moosend. |
| [2251](#L2251) | \* |
| [2252](#L2252) | \* @since  2.9.0 |
| [2253](#L2253) | \*/ |
| [2254](#L2254) | public function ready\_sites\_add\_subscriber\_to\_moosend() { |
| [2255](#L2255) | if ( ! current\_user\_can( 'manage\_options' ) ) { |
| [2256](#L2256) | wp\_send\_json\_error( 'You are not allowed to perform this action', 'responsive-addons' ); |
| [2257](#L2257) | } |
| [2258](#L2258) | // Verify Nonce. |
| [2259](#L2259) | check\_ajax\_referer( 'responsive-addons', '\_ajax\_nonce' ); |
| [2260](#L2260) | $ready\_site\_subscribe\_checkbox = sanitize\_key( $\_POST['ready\_sites\_subscripiton\_checkbox'] ); |
| [2261](#L2261) | $user\_email = $\_POST['user\_email']; |
| [2262](#L2262) |  |
| [2263](#L2263) | if ( $ready\_site\_subscribe\_checkbox && filter\_var($user\_email, FILTER\_VALIDATE\_EMAIL) ) { // Add Email in moosend. |
| [2264](#L2264) |  |
| [2265](#L2265) | $request\_uri             = 'https://api.moosend.com/v3/subscribers/0aef6ee1-1d89-4fec-9b5d-55bdcb97b136/subscribe.json?apikey=baa844a9-093b-4281-ba03-958661505919'; |
| [2266](#L2266) | $wp\_args['Email']        = $user\_email; |
| [2267](#L2267) | $request                 = wp\_remote\_post($request\_uri, array('body' => $wp\_args)); |
| [2268](#L2268) | if (is\_wp\_error($request) || '200' != wp\_remote\_retrieve\_response\_code($request)) { |
| [2269](#L2269) | // error. |
| [2270](#L2270) | } |
| [2271](#L2271) | $events = json\_decode(wp\_remote\_retrieve\_body($request)); |
| [2272](#L2272) | } |
| [2273](#L2273) | } |
| [2274](#L2274) |  |
| [2275](#L2275) | /\*\* |
| [2276](#L2276) | \* If RST Blocks Empty, then Insert Data. |
| [2277](#L2277) | \* |
| [2278](#L2278) | \* @since 1.9.1 |
| [2279](#L2279) | \*/ |
| [2280](#L2280) | public function rst\_add\_blocks\_data() { |
| [2281](#L2281) | return get\_site\_option( 'rst-blocks-page-1' ); |
| [2282](#L2282) | } |
| [2283](#L2283) |  |
| [2284](#L2284) | /\*\* |
| [2285](#L2285) | \* RST Register Admin Menu. |
| [2286](#L2286) | \* |
| [2287](#L2287) | \* @param string $slug parent slug of submenu. |
| [2288](#L2288) | \* @since 2.9.3 |
| [2289](#L2289) | \*/ |
| [2290](#L2290) | public function rst\_register\_admin\_menu( $slug ) { |
| [2291](#L2291) | add\_submenu\_page( |
| [2292](#L2292) | $slug, |
| [2293](#L2293) | \_\_( 'Templates', 'responsive-elementor-addons' ), |
| [2294](#L2294) | \_\_( 'Templates', 'responsive-elementor-addons' ), |
| [2295](#L2295) | 'manage\_options', |
| [2296](#L2296) | 'responsive\_add\_ons', |
| [2297](#L2297) | array( $this, 'responsive\_add\_ons\_templates' ), |
| [2298](#L2298) | ); |
| [2299](#L2299) | } |
| [2300](#L2300) |  |
| [2301](#L2301) | /\*\* |
| [2302](#L2302) | \* Adding stylesheet of responsive pro plugin using handle of responsive theme stylesheet. |
| [2303](#L2303) | \*/ |
| [2304](#L2304) | public function responsive\_pro\_css() { |
| [2305](#L2305) | $suffix = ( defined( 'SCRIPT\_DEBUG' ) && SCRIPT\_DEBUG ) ? '' : '.min'; |
| [2306](#L2306) | wp\_enqueue\_style( 'responsive-pro-style', plugin\_dir\_url( \_\_FILE\_\_ ) . "css/style{$suffix}.css", array( 'responsive-style' ), RESPONSIVE\_ADDONS\_VER ); |
| [2307](#L2307) | } |
| [2308](#L2308) |  |
| [2309](#L2309) | /\*\* |
| [2310](#L2310) | \* Load woocommerce files. |
| [2311](#L2311) | \*/ |
| [2312](#L2312) | public function load\_woocommerce() { |
| [2313](#L2313) | if ( ! class\_exists( 'Responsive\_Addons\_Woocommerce\_Ext' ) ) { |
| [2314](#L2314) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/compatibility/woocommerce/customizer/class-responsive-addons-woocommerce-ext.php'; |
| [2315](#L2315) | } |
| [2316](#L2316) | } |
| [2317](#L2317) |  |
| [2318](#L2318) | /\*\* |
| [2319](#L2319) | \* Get plugin settings. |
| [2320](#L2320) | \* |
| [2321](#L2321) | \* @since 2.9.2 |
| [2322](#L2322) | \* @return array |
| [2323](#L2323) | \*/ |
| [2324](#L2324) | public static function raddons\_get\_white\_label\_settings() { |
| [2325](#L2325) | $default\_settings = array( |
| [2326](#L2326) | 'plugin\_name'          => '', |
| [2327](#L2327) | 'plugin\_short\_name'    => '', |
| [2328](#L2328) | 'plugin\_desc'          => '', |
| [2329](#L2329) | 'plugin\_author'        => '', |
| [2330](#L2330) | 'plugin\_uri'           => '', |
| [2331](#L2331) | 'admin\_label'          => '', |
| [2332](#L2332) | 'support\_link'         => '', |
| [2333](#L2333) | 'hide\_support'         => 'off', |
| [2334](#L2334) | 'hide\_wl\_settings'     => 'off', |
| [2335](#L2335) | 'theme\_name'           => '', |
| [2336](#L2336) | 'theme\_desc'           => '', |
| [2337](#L2337) | 'theme\_screenshot\_url' => '', |
| [2338](#L2338) | 'theme\_icon\_url'       => '', |
| [2339](#L2339) | ); |
| [2340](#L2340) |  |
| [2341](#L2341) | $settings = get\_option( 'rpro\_elementor\_settings' ); |
| [2342](#L2342) |  |
| [2343](#L2343) | if ( ! is\_array( $settings ) || empty( $settings ) ) { |
| [2344](#L2344) | $settings = $default\_settings; |
| [2345](#L2345) | } |
| [2346](#L2346) |  |
| [2347](#L2347) | if ( is\_array( $settings ) && ! empty( $settings ) ) { |
| [2348](#L2348) | $settings = array\_merge( $default\_settings, $settings ); |
| [2349](#L2349) | } |
| [2350](#L2350) |  |
| [2351](#L2351) | return apply\_filters( 'rpro\_elements\_admin\_settings', $settings ); |
| [2352](#L2352) | } |
| [2353](#L2353) |  |
| [2354](#L2354) | /\*\* |
| [2355](#L2355) | \* Set the White Label branding data to theme. |
| [2356](#L2356) | \* |
| [2357](#L2357) | \* @param array $all\_themes Contains Theme Attributes. |
| [2358](#L2358) | \* @since 2.9.2 |
| [2359](#L2359) | \* @return array |
| [2360](#L2360) | \*/ |
| [2361](#L2361) | public static function responsive\_theme\_white\_label\_update\_branding( $all\_themes ) { |
| [2362](#L2362) |  |
| [2363](#L2363) | $settings = self::raddons\_get\_white\_label\_settings(); |
| [2364](#L2364) |  |
| [2365](#L2365) | $theme\_slug = 'responsive'; |
| [2366](#L2366) | // Check if the theme exists. |
| [2367](#L2367) | if ( isset( $all\_themes[ $theme\_slug ] ) ) { |
| [2368](#L2368) |  |
| [2369](#L2369) | // Update theme details. |
| [2370](#L2370) | if ( ! empty( $settings['theme\_name'] ) ) { |
| [2371](#L2371) |  |
| [2372](#L2372) | $all\_themes['responsive']['name'] = $settings['theme\_name']; |
| [2373](#L2373) |  |
| [2374](#L2374) | foreach ( $all\_themes as $key => $theme ) { |
| [2375](#L2375) | if ( isset( $theme['parent'] ) && 'Responsive' === $theme['parent'] ) { |
| [2376](#L2376) | $all\_themes[ $key ]['parent'] = $settings['theme\_name']; |
| [2377](#L2377) | } |
| [2378](#L2378) | } |
| [2379](#L2379) | } |
| [2380](#L2380) |  |
| [2381](#L2381) | $all\_themes['responsive']['description'] = ! empty( $settings['theme\_desc'] ) ? $settings['theme\_desc'] : $all\_themes['responsive']['description']; |
| [2382](#L2382) |  |
| [2383](#L2383) | if ( ! empty( $settings['plugin\_author'] ) ) { |
| [2384](#L2384) | $all\_themes['responsive']['author']       = $settings['plugin\_author']; |
| [2385](#L2385) | $author\_url                               = ( ! empty( $settings['plugin\_website\_uri'] ) ? $settings['plugin\_website\_uri'] : '#' ); |
| [2386](#L2386) | $all\_themes['responsive']['authorAndUri'] = '<a href="' . esc\_url( $author\_url ) . '">' . $all\_themes['responsive']['author'] . '</a>'; |
| [2387](#L2387) | } |
| [2388](#L2388) | $all\_themes['responsive']['screenshot'] = ! empty( $settings['theme\_screenshot\_url'] ) ? array( $settings['theme\_screenshot\_url'] ) : $all\_themes['responsive']['screenshot']; |
| [2389](#L2389) |  |
| [2390](#L2390) | } |
| [2391](#L2391) |  |
| [2392](#L2392) | return $all\_themes; |
| [2393](#L2393) | } |
| [2394](#L2394) |  |
| [2395](#L2395) | /\*\* |
| [2396](#L2396) | \* White labels the theme on the dashboard 'At a Glance' metabox |
| [2397](#L2397) | \* |
| [2398](#L2398) | \* @param mixed $content Content. |
| [2399](#L2399) | \* @return array |
| [2400](#L2400) | \*/ |
| [2401](#L2401) | public function admin\_dashboard\_page( $content ) { |
| [2402](#L2402) | $settings = self::raddons\_get\_white\_label\_settings(); |
| [2403](#L2403) | if ( is\_admin() && 'Responsive' === wp\_get\_theme() && ! empty( $settings['theme\_name'] ) ) { |
| [2404](#L2404) | return sprintf( $content, get\_bloginfo( 'version', 'display' ), '<a href="themes.php">' . $settings['theme\_name'] . '</a>' ); |
| [2405](#L2405) | } |
| [2406](#L2406) | return $content; |
| [2407](#L2407) | } |
| [2408](#L2408) |  |
| [2409](#L2409) | /\*\* |
| [2410](#L2410) | \* White labels the theme using the gettext filter |
| [2411](#L2411) | \* to cover areas that we can't access like the Customizer. |
| [2412](#L2412) | \* |
| [2413](#L2413) | \* @param string $text  Translated text. |
| [2414](#L2414) | \* @param string $original         Text to translate. |
| [2415](#L2415) | \* @param string $domain       Text domain. Unique identifier for retrieving translated strings. |
| [2416](#L2416) | \* @return string |
| [2417](#L2417) | \*/ |
| [2418](#L2418) | public function theme\_gettext( $text, $original, $domain ) { |
| [2419](#L2419) | $settings = self::raddons\_get\_white\_label\_settings(); |
| [2420](#L2420) | if ( ! empty( $settings['theme\_name'] ) ) { |
| [2421](#L2421) | if ( 'Responsive' === $original && 'responsive' === $domain ) { |
| [2422](#L2422) | $text = $settings['theme\_name']; |
| [2423](#L2423) | } |
| [2424](#L2424) | } |
| [2425](#L2425) | return $text; |
| [2426](#L2426) | } |
| [2427](#L2427) |  |
| [2428](#L2428) | /\*\* |
| [2429](#L2429) | \* Get whitelabelled icon for admin dashboard. |
| [2430](#L2430) | \* |
| [2431](#L2431) | \* @since 2.9.2 |
| [2432](#L2432) | \* @param string $logo Default icon. |
| [2433](#L2433) | \* @return string URL for updated whitelabelled icon. |
| [2434](#L2434) | \*/ |
| [2435](#L2435) | public function update\_admin\_brand\_logo( $logo ) { |
| [2436](#L2436) |  |
| [2437](#L2437) | $settings = self::raddons\_get\_white\_label\_settings(); |
| [2438](#L2438) |  |
| [2439](#L2439) | $logo = $settings['theme\_icon\_url']; |
| [2440](#L2440) |  |
| [2441](#L2441) | return esc\_url( $logo ); |
| [2442](#L2442) | } |
| [2443](#L2443) |  |
| [2444](#L2444) | /\*\* |
| [2445](#L2445) | \* Renders the Settings tab. |
| [2446](#L2446) | \* |
| [2447](#L2447) | \* @since 2.9.3 |
| [2448](#L2448) | \* @access public |
| [2449](#L2449) | \*/ |
| [2450](#L2450) | public function responsive\_addons\_getting\_started\_settings\_tab() { |
| [2451](#L2451) | if ( ! $this->is\_responsive\_addons\_pro\_is\_active() ) { |
| [2452](#L2452) | echo wp\_kses\_post( '<div class="responsive-theme-tab responsive-theme-raddons-settings-tab" data-tab="raddons-settings"><p class="responsive-theme-tab-name">Settings</p></div>' ); |
| [2453](#L2453) | } |
| [2454](#L2454) | } |
| [2455](#L2455) |  |
| [2456](#L2456) | /\*\* |
| [2457](#L2457) | \* Renders the Settings tab Content. |
| [2458](#L2458) | \* |
| [2459](#L2459) | \* @since 2.9.3 |
| [2460](#L2460) | \* @access public |
| [2461](#L2461) | \*/ |
| [2462](#L2462) | public function responsive\_addons\_getting\_started\_settings\_tab\_content() { |
| [2463](#L2463) | if ( ! $this->is\_responsive\_addons\_pro\_is\_active() ) { |
| [2464](#L2464) | ?> |
| [2465](#L2465) | <div class="responsive-theme-settings-content responsive-theme-tab-content" id="responsive\_raddons-settings"> |
| [2466](#L2466) | <?php require\_once RESPONSIVE\_ADDONS\_DIR . '/admin/partials/getting-started/responsive-getting-started.php'; ?> |
| [2467](#L2467) | </div> |
| [2468](#L2468) | <?php |
| [2469](#L2469) | } |
| [2470](#L2470) | } |
| [2471](#L2471) |  |
| [2472](#L2472) | /\*\* |
| [2473](#L2473) | \* Enqueue js file responsible to handle events on getting started page. |
| [2474](#L2474) | \* |
| [2475](#L2475) | \* @since 2.9.3 |
| [2476](#L2476) | \* @access public |
| [2477](#L2477) | \*/ |
| [2478](#L2478) | public function responsive\_addons\_admin\_enqueue\_getting\_started\_scripts\_styles() { |
| [2479](#L2479) |  |
| [2480](#L2480) | if ( isset( $\_GET['page'] ) && 'responsive' === $\_GET['page'] ) { // phpcs:ignore WordPress.Security.NonceVerification.Recommended |
| [2481](#L2481) | wp\_enqueue\_script( |
| [2482](#L2482) | 'responsive-add-ons-getting-started-jsfile', |
| [2483](#L2483) | RESPONSIVE\_ADDONS\_URI . 'admin/js/responsive-add-ons-getting-started.js', |
| [2484](#L2484) | array( 'jquery' ), |
| [2485](#L2485) | RESPONSIVE\_ADDONS\_VER, |
| [2486](#L2486) | true |
| [2487](#L2487) | ); |
| [2488](#L2488) |  |
| [2489](#L2489) | $data = array( |
| [2490](#L2490) | 'ajaxurl'    => admin\_url( 'admin-ajax.php' ), |
| [2491](#L2491) | 'ccAppURL'    => CC\_APP\_URL, |
| [2492](#L2492) | '\_ajax\_nonce' => wp\_create\_nonce( 'responsive-addons' ), |
| [2493](#L2493) | ); |
| [2494](#L2494) |  |
| [2495](#L2495) | wp\_localize\_script( 'responsive-add-ons-getting-started-jsfile', 'responsiveAddonsGettingStarted', $data ); |
| [2496](#L2496) |  |
| [2497](#L2497) | // Responsive Getting Started admin styles. |
| [2498](#L2498) | wp\_register\_style( 'responsive-add-ons-getting-started-csfile', RESPONSIVE\_ADDONS\_URI . 'admin/css/responsive-add-ons-getting-started.css', false, RESPONSIVE\_ADDONS\_VER ); |
| [2499](#L2499) | wp\_enqueue\_style( 'responsive-add-ons-getting-started-csfile' ); |
| [2500](#L2500) | } |
| [2501](#L2501) | } |
| [2502](#L2502) |  |
| [2503](#L2503) | /\*\* |
| [2504](#L2504) | \* Adds API Connection Tab inside themes settings tab. |
| [2505](#L2505) | \*/ |
| [2506](#L2506) | public function responsive\_theme\_app\_connection\_setting\_item() { |
| [2507](#L2507) | echo wp\_kses\_post(' |
| [2508](#L2508) | <div tabindex="3" class="responsive-theme-setting-item d-flex" id="responsive-setting-item-app-connection-tab" role="button"> |
| [2509](#L2509) | <span class="responsive-theme-setting-item-icon dashicons dashicons-admin-users responsive-theme-setting-active-tab"></span> |
| [2510](#L2510) | <p class="responsive-theme-setting-item-title responsive-theme-setting-active-tab">Connect Account</p> |
| [2511](#L2511) | </div> |
| [2512](#L2512) | '); |
| [2513](#L2513) | } |
| [2514](#L2514) |  |
| [2515](#L2515) | /\*\* |
| [2516](#L2516) | \* Render App Connection Settings tab content. |
| [2517](#L2517) | \*/ |
| [2518](#L2518) | public function responsive\_add\_ons\_app\_connection\_setting\_content() { |
| [2519](#L2519) | require\_once RESPONSIVE\_ADDONS\_DIR . 'admin/partials/getting-started/responsive-app-connection-setting.php'; |
| [2520](#L2520) | } |
| [2521](#L2521) |  |
| [2522](#L2522) | /\*\* |
| [2523](#L2523) | \* Save White Label Settings. |
| [2524](#L2524) | \* |
| [2525](#L2525) | \* @since 2.9.3 |
| [2526](#L2526) | \* @access public |
| [2527](#L2527) | \*/ |
| [2528](#L2528) | public function responsive\_pro\_white\_label\_settings() { |
| [2529](#L2529) |  |
| [2530](#L2530) | check\_ajax\_referer( 'white\_label\_settings', '\_nonce' ); |
| [2531](#L2531) |  |
| [2532](#L2532) | $settings = self::raddons\_get\_white\_label\_settings(); |
| [2533](#L2533) |  |
| [2534](#L2534) | $settings['plugin\_author']        = isset( $\_POST['authorName'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['authorName'] ) ) : ''; |
| [2535](#L2535) | $settings['plugin\_name']          = isset( $\_POST['pluginName'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['pluginName'] ) ) : ''; |
| [2536](#L2536) | $settings['plugin\_desc']          = isset( $\_POST['pluginDesc'] ) ? sanitize\_textarea\_field( wp\_unslash( $\_POST['pluginDesc'] ) ) : ''; |
| [2537](#L2537) | $settings['plugin\_uri']           = isset( $\_POST['pluginURL'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['pluginURL'] ) ) : ''; |
| [2538](#L2538) | $settings['plugin\_website\_uri']   = isset( $\_POST['websiteURL'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['websiteURL'] ) ) : ''; |
| [2539](#L2539) | $settings['hide\_wl\_settings']     = isset( $\_POST['hideSettings'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['hideSettings'] ) ) : ''; |
| [2540](#L2540) | $settings['theme\_name']           = isset( $\_POST['themeName'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['themeName'] ) ) : ''; |
| [2541](#L2541) | $settings['theme\_desc']           = isset( $\_POST['themeDesc'] ) ? sanitize\_textarea\_field( wp\_unslash( $\_POST['themeDesc'] ) ) : ''; |
| [2542](#L2542) | $settings['theme\_screenshot\_url'] = isset( $\_POST['themeScreenshotURL'] ) ? sanitize\_textarea\_field( wp\_unslash( $\_POST['themeScreenshotURL'] ) ) : ''; |
| [2543](#L2543) | $settings['theme\_icon\_url']       = isset( $\_POST['themeIconURL'] ) ? sanitize\_textarea\_field( wp\_unslash( $\_POST['themeIconURL'] ) ) : ''; |
| [2544](#L2544) |  |
| [2545](#L2545) | update\_option( 'rpro\_elementor\_settings', $settings ); |
| [2546](#L2546) |  |
| [2547](#L2547) | wp\_send\_json\_success( array( 'msg' => 'Settings Saved' ) ); |
| [2548](#L2548) | } |
| [2549](#L2549) |  |
| [2550](#L2550) | /\*\* |
| [2551](#L2551) | \* Get whitelabelled website url for footer. |
| [2552](#L2552) | \* |
| [2553](#L2553) | \* @since 3.0.0 |
| [2554](#L2554) | \* @param string $link Default url. |
| [2555](#L2555) | \* @return string URL for updated whitelabelled icon. |
| [2556](#L2556) | \*/ |
| [2557](#L2557) | public function white\_label\_theme\_powered\_by\_link( $link ) { |
| [2558](#L2558) | $settings = self::raddons\_get\_white\_label\_settings(); |
| [2559](#L2559) | $link     = $settings['plugin\_website\_uri']; |
| [2560](#L2560) | return esc\_url( $link ); |
| [2561](#L2561) | } |
| [2562](#L2562) |  |
| [2563](#L2563) | /\*\* |
| [2564](#L2564) | \* Get whitelabelled theme name for footer. |
| [2565](#L2565) | \* |
| [2566](#L2566) | \* @since 3.0.0 |
| [2567](#L2567) | \* @param string $text Default text. |
| [2568](#L2568) | \* @return string text for updated whitelabelled theme name. |
| [2569](#L2569) | \*/ |
| [2570](#L2570) | public function white\_label\_theme\_powered\_by\_text( $text ) { |
| [2571](#L2571) | $settings = self::raddons\_get\_white\_label\_settings(); |
| [2572](#L2572) | $text     = $settings['theme\_name']; |
| [2573](#L2573) | return $text; |
| [2574](#L2574) | } |
| [2575](#L2575) |  |
| [2576](#L2576) | /\*\* |
| [2577](#L2577) | \* Enable/Disables the MegaMenu Feature on switch toggle. |
| [2578](#L2578) | \* |
| [2579](#L2579) | \* @since 3.0.0 |
| [2580](#L2580) | \* @access public |
| [2581](#L2581) | \*/ |
| [2582](#L2582) | public function responsive\_pro\_enable\_megamenu() { |
| [2583](#L2583) |  |
| [2584](#L2584) | check\_ajax\_referer( 'rpro\_toggle\_megamenu', '\_nonce' ); |
| [2585](#L2585) |  |
| [2586](#L2586) | $value = isset( $\_POST['value'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['value'] ) ) : ''; |
| [2587](#L2587) |  |
| [2588](#L2588) | update\_option( 'rpo\_megamenu\_enable', $value ); |
| [2589](#L2589) |  |
| [2590](#L2590) | wp\_send\_json\_success(); |
| [2591](#L2591) | } |
| [2592](#L2592) |  |
| [2593](#L2593) | /\*\* |
| [2594](#L2594) | \* Enable/Disables the Woocommerce customizer settings on switch toggle. |
| [2595](#L2595) | \* |
| [2596](#L2596) | \* @since 3.0.0 |
| [2597](#L2597) | \* @access public |
| [2598](#L2598) | \*/ |
| [2599](#L2599) | public function responsive\_pro\_enable\_woocommerce() { |
| [2600](#L2600) |  |
| [2601](#L2601) | check\_ajax\_referer( 'rpro\_toggle\_woocommerce', '\_nonce' ); |
| [2602](#L2602) |  |
| [2603](#L2603) | $value = isset( $\_POST['value'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['value'] ) ) : ''; |
| [2604](#L2604) |  |
| [2605](#L2605) | update\_option( 'rpro\_woocommerce\_enable', $value ); |
| [2606](#L2606) |  |
| [2607](#L2607) | wp\_send\_json\_success(); |
| [2608](#L2608) | } |
| [2609](#L2609) |  |
| [2610](#L2610) | /\*\* |
| [2611](#L2611) | \* Enqueue Custom Fonts. |
| [2612](#L2612) | \* |
| [2613](#L2613) | \* @since 3.0.2 |
| [2614](#L2614) | \* @access public |
| [2615](#L2615) | \*/ |
| [2616](#L2616) | public function responsive\_addons\_enqueue\_custom\_fonts() { |
| [2617](#L2617) | wp\_enqueue\_script( 'responsive-add-ons-custom-fonts-js', RESPONSIVE\_ADDONS\_URI . 'includes/custom-fonts/assets/js/responsive-add-ons-custom-fonts.js', array(), RESPONSIVE\_ADDONS\_VER, true ); |
| [2618](#L2618) | wp\_enqueue\_style( 'responsive-add-ons-custom-fonts-css', RESPONSIVE\_ADDONS\_URI . 'includes/custom-fonts/assets/css/responsive-add-ons-custom-fonts.css', array(), RESPONSIVE\_ADDONS\_VER ); |
| [2619](#L2619) | } |
| [2620](#L2620) |  |
| [2621](#L2621) | /\*\* |
| [2622](#L2622) | \* Register custom font menu. |
| [2623](#L2623) | \* |
| [2624](#L2624) | \* @since 3.0.2 |
| [2625](#L2625) | \*/ |
| [2626](#L2626) | public function responsive\_addons\_register\_custom\_fonts\_menu() { |
| [2627](#L2627) |  |
| [2628](#L2628) | $title = apply\_filters( 'responsive\_custom\_fonts\_menu\_title', \_\_( 'Custom Fonts', 'responsive-addons' ) ); |
| [2629](#L2629) | add\_submenu\_page( |
| [2630](#L2630) | 'themes.php', |
| [2631](#L2631) | $title, |
| [2632](#L2632) | $title, |
| [2633](#L2633) | Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::$capability, |
| [2634](#L2634) | 'edit-tags.php?taxonomy=' . Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::$register\_taxonomy\_slug |
| [2635](#L2635) | ); |
| [2636](#L2636) |  |
| [2637](#L2637) | } |
| [2638](#L2638) |  |
| [2639](#L2639) | /\*\* |
| [2640](#L2640) | \* Highlight custom font menu. |
| [2641](#L2641) | \* |
| [2642](#L2642) | \* @since 3.0.2 |
| [2643](#L2643) | \*/ |
| [2644](#L2644) | public function responsive\_addons\_custom\_fonts\_menu\_highlight() { |
| [2645](#L2645) | global $parent\_file, $submenu\_file; |
| [2646](#L2646) |  |
| [2647](#L2647) | if ( 'edit-tags.php?taxonomy=' . Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::$register\_taxonomy\_slug === $submenu\_file ) { |
| [2648](#L2648) | $parent\_file = 'themes.php'; // phpcs:ignore WordPress.WP.GlobalVariablesOverride.Prohibited |
| [2649](#L2649) | } |
| [2650](#L2650) | if ( get\_current\_screen()->id != 'edit-' . Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::$register\_taxonomy\_slug ) { |
| [2651](#L2651) | return; |
| [2652](#L2652) | } |
| [2653](#L2653) |  |
| [2654](#L2654) | ?> |
| [2655](#L2655) | <style>#addtag div.form-field.term-slug-wrap, #edittag tr.form-field.term-slug-wrap { display: none; } |
| [2656](#L2656) | #addtag div.form-field.term-description-wrap, #edittag tr.form-field.term-description-wrap { display: none; }</style><script>jQuery( document ).ready( function( $ ) { |
| [2657](#L2657) | var $wrapper = $( '#addtag, #edittag' ); |
| [2658](#L2658) | $wrapper.find( 'tr.form-field.term-name-wrap p, div.form-field.term-name-wrap > p' ).text( '<?php esc\_html\_e( 'The name of the font as it appears in the customizer options.', 'responsive-addons' ); ?>' ); |
| [2659](#L2659) | } );</script> |
| [2660](#L2660) | <?php |
| [2661](#L2661) | } |
| [2662](#L2662) |  |
| [2663](#L2663) | /\*\* |
| [2664](#L2664) | \* Manage Columns |
| [2665](#L2665) | \* |
| [2666](#L2666) | \* @since 3.0.2 |
| [2667](#L2667) | \* @param array $columns default columns. |
| [2668](#L2668) | \* @return array $columns updated columns. |
| [2669](#L2669) | \*/ |
| [2670](#L2670) | public function responsive\_addons\_manage\_columns( $columns ) { |
| [2671](#L2671) |  |
| [2672](#L2672) | $screen = get\_current\_screen(); |
| [2673](#L2673) | // If current screen is add new custom fonts screen. |
| [2674](#L2674) | if ( isset( $screen->base ) && 'edit-tags' == $screen->base ) { |
| [2675](#L2675) |  |
| [2676](#L2676) | $old\_columns = $columns; |
| [2677](#L2677) | $columns     = array( |
| [2678](#L2678) | 'cb'   => $old\_columns['cb'], |
| [2679](#L2679) | 'name' => $old\_columns['name'], |
| [2680](#L2680) | ); |
| [2681](#L2681) |  |
| [2682](#L2682) | } |
| [2683](#L2683) | return $columns; |
| [2684](#L2684) | } |
| [2685](#L2685) |  |
| [2686](#L2686) | /\*\* |
| [2687](#L2687) | \* Add new Taxonomy data |
| [2688](#L2688) | \* |
| [2689](#L2689) | \* @since 3.0.2 |
| [2690](#L2690) | \*/ |
| [2691](#L2691) | public function responsive\_addons\_add\_new\_taxonomy\_data() { |
| [2692](#L2692) | $this->responsive\_addons\_font\_file\_new\_field( 'font\_woff\_2', \_\_( 'Upload Font', 'responsive-addons' ), \_\_( 'Allowed Font types are .woff2, .woff, .ttf, .eot, .svg, .otf', 'responsive-addons' ) ); |
| [2693](#L2693) |  |
| [2694](#L2694) | $this->responsive\_addons\_select\_new\_field( |
| [2695](#L2695) | 'font-display', |
| [2696](#L2696) | \_\_( 'Font Display', 'responsive-addons' ), |
| [2697](#L2697) | \_\_( 'Select font-display property for this font', 'responsive-addons' ), |
| [2698](#L2698) | array( |
| [2699](#L2699) | 'auto'     => 'auto', |
| [2700](#L2700) | 'block'    => 'block', |
| [2701](#L2701) | 'swap'     => 'swap', |
| [2702](#L2702) | 'fallback' => 'fallback', |
| [2703](#L2703) | 'optional' => 'optional', |
| [2704](#L2704) | ) |
| [2705](#L2705) | ); |
| [2706](#L2706) | } |
| [2707](#L2707) |  |
| [2708](#L2708) | /\*\* |
| [2709](#L2709) | \* Edit Taxonomy data |
| [2710](#L2710) | \* |
| [2711](#L2711) | \* @since 3.0.2 |
| [2712](#L2712) | \* @param object $term taxonomy terms. |
| [2713](#L2713) | \*/ |
| [2714](#L2714) | public function responsive\_addons\_edit\_taxonomy\_data( $term ) { |
| [2715](#L2715) |  |
| [2716](#L2716) | $data = Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::get\_font\_links( $term->term\_id ); |
| [2717](#L2717) | $this->responsive\_addons\_font\_file\_edit\_field( 'font\_woff\_2', \_\_( 'Upload Font', 'responsive-addons' ), $data['font\_woff\_2'], \_\_( 'Allowed Font types are .woff2, .woff, .ttf, .eot, .svg, .otf', 'responsive-addons' ) ); |
| [2718](#L2718) |  |
| [2719](#L2719) | $this->responsive\_addons\_select\_edit\_field( |
| [2720](#L2720) | 'font-display', |
| [2721](#L2721) | \_\_( 'Font Display', 'responsive-addons' ), |
| [2722](#L2722) | $data['font-display'], |
| [2723](#L2723) | \_\_( 'Select font-display property for this font', 'responsive-addons' ), |
| [2724](#L2724) | array( |
| [2725](#L2725) | 'auto'     => 'Auto', |
| [2726](#L2726) | 'block'    => 'Block', |
| [2727](#L2727) | 'swap'     => 'Swap', |
| [2728](#L2728) | 'fallback' => 'Fallback', |
| [2729](#L2729) | 'optional' => 'Optional', |
| [2730](#L2730) | ) |
| [2731](#L2731) | ); |
| [2732](#L2732) | } |
| [2733](#L2733) |  |
| [2734](#L2734) | /\*\* |
| [2735](#L2735) | \* Save Taxonomy meta data value |
| [2736](#L2736) | \* |
| [2737](#L2737) | \* @since 3.0.2 |
| [2738](#L2738) | \* @param int $term\_id current term id. |
| [2739](#L2739) | \*/ |
| [2740](#L2740) | public function responsive\_addons\_save\_metadata( $term\_id ) { |
| [2741](#L2741) |  |
| [2742](#L2742) | if ( ! current\_user\_can( 'manage\_options' ) ) { |
| [2743](#L2743) | return; |
| [2744](#L2744) | } |
| [2745](#L2745) |  |
| [2746](#L2746) | if ( isset( $\_POST[ Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::$register\_taxonomy\_slug ] ) ) {// phpcs:ignore WordPress.Security.NonceVerification.Missing |
| [2747](#L2747) | $value = array\_map( 'esc\_attr', $\_POST[ Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::$register\_taxonomy\_slug ] ); // phpcs:ignore WordPress.Security.NonceVerification.Missing |
| [2748](#L2748) | Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::update\_font\_links( $value, $term\_id ); |
| [2749](#L2749) | } |
| [2750](#L2750) | } |
| [2751](#L2751) |  |
| [2752](#L2752) | /\*\* |
| [2753](#L2753) | \* Allowed mime types and file extensions |
| [2754](#L2754) | \* |
| [2755](#L2755) | \* @since 3.0.2 |
| [2756](#L2756) | \* @param array $mimes Current array of mime types. |
| [2757](#L2757) | \* @return array $mimes Updated array of mime types. |
| [2758](#L2758) | \*/ |
| [2759](#L2759) | public function responsive\_addons\_add\_fonts\_to\_allowed\_mimes( $mimes ) { |
| [2760](#L2760) | $mimes['woff']  = 'application/x-font-woff'; |
| [2761](#L2761) | $mimes['woff2'] = 'application/x-font-woff2'; |
| [2762](#L2762) | $mimes['ttf']   = 'application/x-font-ttf'; |
| [2763](#L2763) | $mimes['svg']   = 'image/svg+xml'; |
| [2764](#L2764) | $mimes['eot']   = 'application/vnd.ms-fontobject'; |
| [2765](#L2765) | $mimes['otf']   = 'font/otf'; |
| [2766](#L2766) |  |
| [2767](#L2767) | return $mimes; |
| [2768](#L2768) | } |
| [2769](#L2769) |  |
| [2770](#L2770) | /\*\* |
| [2771](#L2771) | \* Correct the mome types and extension for the font types. |
| [2772](#L2772) | \* |
| [2773](#L2773) | \* @param array  $defaults File data array containing 'ext', 'type', and |
| [2774](#L2774) | \*                                          'proper\_filename' keys. |
| [2775](#L2775) | \* @param string $file                      Full path to the file. |
| [2776](#L2776) | \* @param string $filename                  The name of the file (may differ from $file due to |
| [2777](#L2777) | \*                                          $file being in a tmp directory). |
| [2778](#L2778) | \* @return Array File data array containing 'ext', 'type', and |
| [2779](#L2779) | \*/ |
| [2780](#L2780) | public function responsive\_addons\_update\_mime\_types( $defaults, $file, $filename ) { |
| [2781](#L2781) | if ( 'ttf' === pathinfo( $filename, PATHINFO\_EXTENSION ) ) { |
| [2782](#L2782) | $defaults['type'] = 'application/x-font-ttf'; |
| [2783](#L2783) | $defaults['ext']  = 'ttf'; |
| [2784](#L2784) | } |
| [2785](#L2785) |  |
| [2786](#L2786) | if ( 'otf' === pathinfo( $filename, PATHINFO\_EXTENSION ) ) { |
| [2787](#L2787) | $defaults['type'] = 'application/x-font-otf'; |
| [2788](#L2788) | $defaults['ext']  = 'otf'; |
| [2789](#L2789) | } |
| [2790](#L2790) |  |
| [2791](#L2791) | return $defaults; |
| [2792](#L2792) | } |
| [2793](#L2793) |  |
| [2794](#L2794) | /\*\* |
| [2795](#L2795) | \* Enqueue Render Fonts |
| [2796](#L2796) | \* |
| [2797](#L2797) | \* @since 3.0.2 |
| [2798](#L2798) | \* @param array $load\_fonts fonts. |
| [2799](#L2799) | \*/ |
| [2800](#L2800) | public function responsive\_addons\_render\_fonts( $load\_fonts ) { |
| [2801](#L2801) |  |
| [2802](#L2802) | $fonts = Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::get\_fonts(); |
| [2803](#L2803) |  |
| [2804](#L2804) | foreach ( $load\_fonts  as $load\_font\_name => $load\_font ) { |
| [2805](#L2805) | if ( array\_key\_exists( $load\_font\_name, $fonts ) ) { |
| [2806](#L2806) | unset( $load\_fonts[ $load\_font\_name ] ); |
| [2807](#L2807) | } |
| [2808](#L2808) | } |
| [2809](#L2809) | return $load\_fonts; |
| [2810](#L2810) | } |
| [2811](#L2811) |  |
| [2812](#L2812) | /\*\* |
| [2813](#L2813) | \* Add Custom Font list into customizer. |
| [2814](#L2814) | \* |
| [2815](#L2815) | \* @since  3.0.2 |
| [2816](#L2816) | \* @param string $value selected font family. |
| [2817](#L2817) | \*/ |
| [2818](#L2818) | public function responsive\_addons\_add\_customizer\_font\_list( $value ) { |
| [2819](#L2819) |  |
| [2820](#L2820) | $fonts = Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::get\_fonts(); |
| [2821](#L2821) |  |
| [2822](#L2822) | echo '<optgroup label="' . esc\_attr( 'Custom Fonts' ) . '">'; |
| [2823](#L2823) |  |
| [2824](#L2824) | foreach ( $fonts as $font => $links ) { |
| [2825](#L2825) | echo '<option value="' . esc\_attr( $font ) . '" ' . selected( $font, $value, false ) . '>' . esc\_attr( $font ) . '</option>'; |
| [2826](#L2826) | } |
| [2827](#L2827) | } |
| [2828](#L2828) |  |
| [2829](#L2829) | /\*\* |
| [2830](#L2830) | \* Enqueue Scripts |
| [2831](#L2831) | \* |
| [2832](#L2832) | \* @since 3.0.2 |
| [2833](#L2833) | \*/ |
| [2834](#L2834) | public function responsive\_addons\_add\_style() { |
| [2835](#L2835) | $fonts = Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::get\_fonts(); |
| [2836](#L2836) | if ( ! empty( $fonts ) ) { |
| [2837](#L2837) | foreach ( $fonts  as $load\_font\_name => $load\_font ) { |
| [2838](#L2838) | $this->render\_font\_css( $load\_font\_name ); |
| [2839](#L2839) | } |
| [2840](#L2840) | ?> |
| [2841](#L2841) | <style type="text/css"> |
| [2842](#L2842) | <?php echo wp\_strip\_all\_tags( $this->font\_css ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?> |
| [2843](#L2843) | </style> |
| [2844](#L2844) | <?php |
| [2845](#L2845) | } |
| [2846](#L2846) | } |
| [2847](#L2847) |  |
| [2848](#L2848) | /\*\* |
| [2849](#L2849) | \* Create css for font-face |
| [2850](#L2850) | \* |
| [2851](#L2851) | \* @since 3.0.2 |
| [2852](#L2852) | \* @param array $font selected font from custom font list. |
| [2853](#L2853) | \*/ |
| [2854](#L2854) | private function render\_font\_css( $font ) { |
| [2855](#L2855) | $fonts = Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::get\_links\_by\_name( $font ); |
| [2856](#L2856) |  |
| [2857](#L2857) | foreach ( $fonts as $font => $links ) : |
| [2858](#L2858) | $css  = '@font-face { font-family:' . esc\_attr( $font ) . ';'; |
| [2859](#L2859) | $css .= 'src:'; |
| [2860](#L2860) | $arr  = array(); |
| [2861](#L2861) | if ( $links['font\_woff\_2'] ) { |
| [2862](#L2862) | $arr[] = 'url(' . esc\_url( $links['font\_woff\_2'] ) . ") format('woff2')"; |
| [2863](#L2863) | } |
| [2864](#L2864) | if ( $links['font\_woff'] ) { |
| [2865](#L2865) | $arr[] = 'url(' . esc\_url( $links['font\_woff'] ) . ") format('woff')"; |
| [2866](#L2866) | } |
| [2867](#L2867) | if ( $links['font\_ttf'] ) { |
| [2868](#L2868) | $arr[] = 'url(' . esc\_url( $links['font\_ttf'] ) . ") format('truetype')"; |
| [2869](#L2869) | } |
| [2870](#L2870) | if ( $links['font\_otf'] ) { |
| [2871](#L2871) | $arr[] = 'url(' . esc\_url( $links['font\_otf'] ) . ") format('opentype')"; |
| [2872](#L2872) | } |
| [2873](#L2873) | if ( $links['font\_svg'] ) { |
| [2874](#L2874) | $arr[] = 'url(' . esc\_url( $links['font\_svg'] ) . '#' . esc\_attr( strtolower( str\_replace( ' ', '\_', $font ) ) ) . ") format('svg')"; |
| [2875](#L2875) | } |
| [2876](#L2876) | $css .= join( ', ', $arr ); |
| [2877](#L2877) | $css .= ';'; |
| [2878](#L2878) | $css .= 'font-display: ' . esc\_attr( $links['font-display'] ) . ';'; |
| [2879](#L2879) | $css .= '}'; |
| [2880](#L2880) | endforeach; |
| [2881](#L2881) |  |
| [2882](#L2882) | $this->font\_css .= $css; |
| [2883](#L2883) | } |
| [2884](#L2884) |  |
| [2885](#L2885) | /\*\* |
| [2886](#L2886) | \* Add Taxonomy data field |
| [2887](#L2887) | \* |
| [2888](#L2888) | \* @since 3.0.2 |
| [2889](#L2889) | \* @param int    $id current term id. |
| [2890](#L2890) | \* @param string $title font type title. |
| [2891](#L2891) | \* @param string $description title font type description. |
| [2892](#L2892) | \* @param string $value title font type meta values. |
| [2893](#L2893) | \*/ |
| [2894](#L2894) | protected function responsive\_addons\_font\_file\_new\_field( $id, $title, $description, $value = '' ) { |
| [2895](#L2895) | ?> |
| [2896](#L2896) | <div class="responsive-custom-fonts-file-wrap form-field term-<?php echo esc\_attr( $id ); ?>-wrap" > |
| [2897](#L2897) |  |
| [2898](#L2898) | <label for="font-<?php echo esc\_attr( $id ); ?>"><?php echo esc\_html( $title ); ?></label> |
| [2899](#L2899) | <input type="text" id="font-<?php echo esc\_attr( $id ); ?>" class="responsive-custom-fonts-link <?php echo esc\_attr( $id ); ?>" name="<?php echo esc\_attr( Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::$register\_taxonomy\_slug ); ?>[<?php echo esc\_attr( $id ); ?>]" value="<?php echo esc\_attr( $value ); ?>" /> |
| [2900](#L2900) | <a href="#" class="responsive-custom-fonts-upload button" data-upload-type="<?php echo esc\_attr( $id ); ?>"> |
| [2901](#L2901) | <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-upload" viewBox="0 0 16 16"> |
| [2902](#L2902) | <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/> |
| [2903](#L2903) | <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/> |
| [2904](#L2904) | </svg> |
| [2905](#L2905) | </a> |
| [2906](#L2906) | <p><?php echo esc\_html( $description ); ?></p> |
| [2907](#L2907) | </div> |
| [2908](#L2908) | <?php |
| [2909](#L2909) | } |
| [2910](#L2910) |  |
| [2911](#L2911) | /\*\* |
| [2912](#L2912) | \* Render select field for the new font screen. |
| [2913](#L2913) | \* |
| [2914](#L2914) | \* @param String $id Field ID. |
| [2915](#L2915) | \* @param String $title Field Title. |
| [2916](#L2916) | \* @param String $description Field Description. |
| [2917](#L2917) | \* @param Array  $select\_fields Select fields as Array. |
| [2918](#L2918) | \* @return void |
| [2919](#L2919) | \*/ |
| [2920](#L2920) | protected function responsive\_addons\_select\_new\_field( $id, $title, $description, $select\_fields ) { |
| [2921](#L2921) | ?> |
| [2922](#L2922) | <div class="responsive-custom-fonts-file-wrap form-field term-<?php echo esc\_attr( $id ); ?>-wrap" > |
| [2923](#L2923) | <label for="font-<?php echo esc\_attr( $id ); ?>"><?php echo esc\_html( $title ); ?></label> |
| [2924](#L2924) | <select type="select" id="font-<?php echo esc\_attr( $id ); ?>" class="responsive-custom-font-select-field <?php echo esc\_attr( $id ); ?>" name="<?php echo esc\_attr( Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::$register\_taxonomy\_slug ); ?>[<?php echo esc\_attr( $id ); ?>]" /> |
| [2925](#L2925) | <?php |
| [2926](#L2926) | foreach ( $select\_fields as $key => $value ) { |
| [2927](#L2927) | ?> |
| [2928](#L2928) | <option value="<?php echo esc\_attr( $key ); ?>"><?php echo esc\_html( $value ); ?></option>; |
| [2929](#L2929) | <?php } ?> |
| [2930](#L2930) | </select> |
| [2931](#L2931) | </div> |
| [2932](#L2932) | <?php |
| [2933](#L2933) | } |
| [2934](#L2934) |  |
| [2935](#L2935) | /\*\* |
| [2936](#L2936) | \* Add Taxonomy data field |
| [2937](#L2937) | \* |
| [2938](#L2938) | \* @since 3.0.2 |
| [2939](#L2939) | \* @param int    $id current term id. |
| [2940](#L2940) | \* @param string $title font type title. |
| [2941](#L2941) | \* @param string $value title font type meta values. |
| [2942](#L2942) | \* @param string $description title font type description. |
| [2943](#L2943) | \*/ |
| [2944](#L2944) | protected function responsive\_addons\_font\_file\_edit\_field( $id, $title, $value, $description ) { |
| [2945](#L2945) | ?> |
| [2946](#L2946) | <tr class="responsive-custom-fonts-file-wrap form-field term-<?php echo esc\_attr( $id ); ?>-wrap "> |
| [2947](#L2947) | <th scope="row"> |
| [2948](#L2948) | <label for="metadata-<?php echo esc\_attr( $id ); ?>"> |
| [2949](#L2949) | <?php echo esc\_html( $title ); ?> |
| [2950](#L2950) | </label> |
| [2951](#L2951) | </th> |
| [2952](#L2952) | <td> |
| [2953](#L2953) | <input id="metadata-<?php echo esc\_attr( $id ); ?>" type="text" class="responsive-custom-fonts-link <?php echo esc\_attr( $id ); ?>" name="<?php echo esc\_attr( Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::$register\_taxonomy\_slug ); ?>[<?php echo esc\_attr( $id ); ?>]" value="<?php echo esc\_attr( $value ); ?>" /> |
| [2954](#L2954) | <a href="#" class="responsive-custom-fonts-upload button" data-upload-type="<?php echo esc\_attr( $id ); ?>"> |
| [2955](#L2955) | <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-upload" viewBox="0 0 16 16"> |
| [2956](#L2956) | <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/> |
| [2957](#L2957) | <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/> |
| [2958](#L2958) | </svg> |
| [2959](#L2959) | </a> |
| [2960](#L2960) | <p><?php echo esc\_html( $description ); ?></p> |
| [2961](#L2961) | </td> |
| [2962](#L2962) | </tr> |
| [2963](#L2963) | <?php |
| [2964](#L2964) | } |
| [2965](#L2965) |  |
| [2966](#L2966) | /\*\* |
| [2967](#L2967) | \* Render select field for the edit font screen. |
| [2968](#L2968) | \* |
| [2969](#L2969) | \* @param String $id Field ID. |
| [2970](#L2970) | \* @param String $title Field Title. |
| [2971](#L2971) | \* @param String $saved\_val Field Value. |
| [2972](#L2972) | \* @param String $description Field Description. |
| [2973](#L2973) | \* @param Array  $select\_fields Select fields as Array. |
| [2974](#L2974) | \* @return void |
| [2975](#L2975) | \*/ |
| [2976](#L2976) | private function responsive\_addons\_select\_edit\_field( $id, $title, $saved\_val, $description, $select\_fields ) { |
| [2977](#L2977) | ?> |
| [2978](#L2978) | <tr class="responsive-custom-fonts-file-wrap form-field term-<?php echo esc\_attr( $id ); ?>-wrap "> |
| [2979](#L2979) | <th scope="row"> |
| [2980](#L2980) | <label for="metadata-<?php echo esc\_attr( $id ); ?>"> |
| [2981](#L2981) | <?php echo esc\_html( $title ); ?> |
| [2982](#L2982) | </label> |
| [2983](#L2983) | </th> |
| [2984](#L2984) | <td> |
| [2985](#L2985) | <select type="select" id="font-<?php echo esc\_attr( $id ); ?>" class="responsive-custom-font-select-field <?php echo esc\_attr( $id ); ?>" name="<?php echo esc\_attr( Responsive\_Add\_Ons\_Custom\_Fonts\_Taxonomy::$register\_taxonomy\_slug ); ?>[<?php echo esc\_attr( $id ); ?>]" /> |
| [2986](#L2986) | <?php |
| [2987](#L2987) | foreach ( $select\_fields as $key => $value ) { |
| [2988](#L2988) | ?> |
| [2989](#L2989) | <option value="<?php echo esc\_attr( $key ); ?>" <?php selected( $key, $saved\_val ); ?>><?php echo esc\_html( $value ); ?></option>; |
| [2990](#L2990) | <?php } ?> |
| [2991](#L2991) | </select> |
| [2992](#L2992) | <p><?php echo esc\_html( $description ); ?></p> |
| [2993](#L2993) | </td> |
| [2994](#L2994) | </tr> |
| [2995](#L2995) | <?php |
| [2996](#L2996) | } |
| [2997](#L2997) |  |
| [2998](#L2998) | /\*\* |
| [2999](#L2999) | \* Get current installation import capabilities |
| [3000](#L3000) | \* |
| [3001](#L3001) | \* @since 3.0.3 |
| [3002](#L3002) | \*/ |
| [3003](#L3003) | public function responsive\_addons\_get\_user\_import\_capabilities() { |
| [3004](#L3004) |  |
| [3005](#L3005) | check\_ajax\_referer( 'responsive-addons', '\_ajax\_nonce' ); |
| [3006](#L3006) |  |
| [3007](#L3007) | if ( ! current\_user\_can( 'manage\_options' ) ) { |
| [3008](#L3008) | wp\_send\_json\_error( \_\_( 'You are not allowed to perform this action', 'responsive-addons' ) ); |
| [3009](#L3009) | } |
| [3010](#L3010) |  |
| [3011](#L3011) | require\_once RESPONSIVE\_ADDONS\_DIR . 'includes/settings/class-responsive-add-ons-settings.php'; |
| [3012](#L3012) | $settings   = new Responsive\_Add\_Ons\_Settings(); |
| [3013](#L3013) |  |
| [3014](#L3014) | global $wcam\_lib\_responsive\_addons; |
| [3015](#L3015) |  |
| [3016](#L3016) | $api\_key    = $settings->get( 'api', 'token' ); |
| [3017](#L3017) | $product\_id = $settings->get( 'account', 'product\_id' ); |
| [3018](#L3018) |  |
| [3019](#L3019) | if ( empty( $api\_key ) || '' === $api\_key || empty( $product\_id ) || '' === $product\_id ) { |
| [3020](#L3020) | wp\_send\_json\_error( |
| [3021](#L3021) | array( |
| [3022](#L3022) | 'message' => 'Please check your connection with Cyberchimps Responsive Domain', |
| [3023](#L3023) | 'error'   => true, |
| [3024](#L3024) | ), |
| [3025](#L3025) | ); |
| [3026](#L3026) | } |
| [3027](#L3027) |  |
| [3028](#L3028) | $args = array( |
| [3029](#L3029) | 'api\_key' => $api\_key, |
| [3030](#L3030) | ); |
| [3031](#L3031) |  |
| [3032](#L3032) | update\_option( $wcam\_lib\_responsive\_addons->wc\_am\_product\_id, $product\_id ); |
| [3033](#L3033) | update\_option( |
| [3034](#L3034) | $wcam\_lib\_responsive\_addons->data\_key, |
| [3035](#L3035) | array( |
| [3036](#L3036) | $wcam\_lib\_responsive\_addons->data\_key . '\_api\_key' => $api\_key, |
| [3037](#L3037) | ), |
| [3038](#L3038) | ); |
| [3039](#L3039) |  |
| [3040](#L3040) | $activate\_args = $wcam\_lib\_responsive\_addons->activate( $args, $product\_id ); |
| [3041](#L3041) | $status\_args   = $wcam\_lib\_responsive\_addons->status( $args, $product\_id ); |
| [3042](#L3042) |  |
| [3043](#L3043) | $response = $this->cc\_app\_auth->post( |
| [3044](#L3044) | 'plugin/importcaps', |
| [3045](#L3045) | wp\_json\_encode( |
| [3046](#L3046) | array( |
| [3047](#L3047) | 'id'                  => $settings->get\_user\_id(), |
| [3048](#L3048) | 'platform'            => 'wordpress', |
| [3049](#L3049) | 'demo\_type'           => $\_POST['demo\_type'], |
| [3050](#L3050) | 'status\_args'         => $status\_args, |
| [3051](#L3051) | 'activate\_args'       => $activate\_args, |
| [3052](#L3052) | 'wc\_am\_activated\_key' => $wcam\_lib\_responsive\_addons->data, |
| [3053](#L3053) | ) |
| [3054](#L3054) | ) |
| [3055](#L3055) | ); |
| [3056](#L3056) | $response\_code = wp\_remote\_retrieve\_response\_code( $response ); |
| [3057](#L3057) | if ( 200 !== $response\_code ) { |
| [3058](#L3058) | wp\_send\_json\_error( |
| [3059](#L3059) | array( |
| [3060](#L3060) | 'message' => 'Cannot made request with Cyberchimps Responsive Domain. Some data is missing.', |
| [3061](#L3061) | 'error'   => true, |
| [3062](#L3062) | ), |
| [3063](#L3063) | ); |
| [3064](#L3064) | } |
| [3065](#L3065) | $response\_body = json\_decode( wp\_remote\_retrieve\_body( $response ) ); |
| [3066](#L3066) | if ( ! $response\_body->allow\_import ) { |
| [3067](#L3067) | wp\_send\_json\_error( |
| [3068](#L3068) | array( |
| [3069](#L3069) | 'message' => 'Please check your connection with Cyberchimps Responsive Domain', |
| [3070](#L3070) | 'error'   => true, |
| [3071](#L3071) | ), |
| [3072](#L3072) | ); |
| [3073](#L3073) | } |
| [3074](#L3074) | if ( isset( $response\_body->update\_options ) ) { |
| [3075](#L3075) | if ( 'success' === $response\_body->update\_options ) { |
| [3076](#L3076) | update\_option( $wcam\_lib\_responsive\_addons->wc\_am\_activated\_key, $response\_body->activated\_key ); |
| [3077](#L3077) | update\_option( $wcam\_lib\_responsive\_addons->wc\_am\_deactivate\_checkbox\_key, $response\_body->deactivate\_checkbox\_key ); |
| [3078](#L3078) | } else if ( 'fail\_1' === $response\_body->update\_options ) { |
| [3079](#L3079) | if ( isset( $wcam\_lib\_responsive\_addons->data[ $wcam\_lib\_responsive\_addons->wc\_am\_activated\_key ] ) ) { |
| [3080](#L3080) | update\_option( $wcam\_lib\_responsive\_addons->data[ $wcam\_lib\_responsive\_addons->wc\_am\_activated\_key ], $response\_body->activated\_key ); |
| [3081](#L3081) | } |
| [3082](#L3082) | } else if ( 'fail\_2' === $response\_body->update\_options ) { |
| [3083](#L3083) | if ( isset( $wcam\_lib\_responsive\_addons->data[ $wcam\_lib\_responsive\_addons->wc\_am\_activated\_key ] ) ) { |
| [3084](#L3084) | update\_option( $wcam\_lib\_responsive\_addons->data[ $wcam\_lib\_responsive\_addons->wc\_am\_activated\_key ], $response\_body->activated\_key ); |
| [3085](#L3085) | } |
| [3086](#L3086) | } |
| [3087](#L3087) | } |
| [3088](#L3088) |  |
| [3089](#L3089) | if ( isset( $response\_body->connection\_status ) ) { |
| [3090](#L3090) | wp\_send\_json\_success( |
| [3091](#L3091) | array( |
| [3092](#L3092) | 'connection\_status' => $response\_body->connection\_status, |
| [3093](#L3093) | 'error'             => false, |
| [3094](#L3094) | ), |
| [3095](#L3095) | ); |
| [3096](#L3096) | } else { |
| [3097](#L3097) | wp\_send\_json\_success( |
| [3098](#L3098) | array( |
| [3099](#L3099) | 'activate\_results' => $response\_body->activate\_results, |
| [3100](#L3100) | 'message'          => $response\_body->message, |
| [3101](#L3101) | ) |
| [3102](#L3102) | ); |
| [3103](#L3103) | } |
| [3104](#L3104) | } |
| [3105](#L3105) |  |
| [3106](#L3106) | public function responsive\_addons\_updated\_option( $option\_name, $old\_value, $value ) { |
| [3107](#L3107) |  |
| [3108](#L3108) | if ( 'reads\_app\_settings' === $option\_name ) { |
| [3109](#L3109) | global $wcam\_lib\_responsive\_addons; |
| [3110](#L3110) | $wcam\_lib\_responsive\_addons->license\_key\_deactivation(); |
| [3111](#L3111) | } |
| [3112](#L3112) | } |
| [3113](#L3113) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/responsive-add-ons/tags/3.0.4/includes/class-responsive-add-ons.php?format=txt)
* [Original Format](/export/3220658/responsive-add-ons/tags/3.0.4/includes/class-responsive-add-ons.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

