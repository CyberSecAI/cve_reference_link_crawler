=== Content from seclists.org_c345f0a2_20250108_113846.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](1)
[By Date](date.html#2)
[![Next](/images/right-icon-16x16.png)](3)

[![Previous](/images/left-icon-16x16.png)](1)
[By Thread](index.html#2)
[![Next](/images/right-icon-16x16.png)](3)

![](/shared/images/nst-icons.svg#search)

# KL-001-2021-009: CyberArk Credential Provider Race Condition And Authorization Bypass

---

*From*: KoreLogic Disclosures via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Wed, 1 Sep 2021 13:21:41 -0500

---

```
KL-001-2021-009: CyberArk Credential Provider Race Condition And Authorization Bypass

Title: CyberArk Credential Provider Race Condition And Authorization Bypass
Advisory ID: KL-001-2021-009
Publication Date: 2021.09.01
Publication URL: <https://korelogic.com/Resources/Advisories/KL-001-2021-009.txt>

1. Vulnerability Details

     Affected Vendor: CyberArk
     Affected Product: Application Access Manager/Credential Provider
     Affected Version: Prior to 12.1
     Platform: Linux/Windows/zOS
     CWE Classification: CWE-326: Inadequate Encryption Strength,
                         CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race
Condition'),
                         CWE-923: Improper Restriction of Communication Channel to Intended Endpoints
     CVE ID: CVE-2021-31797

2. Vulnerability Description

     CyberArk's Credential Provider loopback communications on TCP
     port 18923 are encrypted with key material that has extremely
     low entropy. In all currently-known use cases, the effective
     key space is less than 2^16. For an attacker who understands the
     key derivation scheme and encryption mechanics, knowledge of the
     source port and access to the payloads of a given client-server
     exchange are sufficient to reduce effective key space to one. In
     cases where the source port is not known, the encrypted payloads
     will be unable to withstand a brute force attack.

     Additionally, the user identification mechanism used
     by CyberArk's Credential Provider is vulnerable to a race
     condition where an unauthorized/unprivileged user can submit
     one or more encrypted query requests. If the race is won,
     the attacker will be able to retrieve sensitive information
     including passwords and password metadata.

3. Technical Description

     Based on analysis and observations, the key derivation process
     for CyberArk's Credential Provider loopback communications on
     TCP port 18923 can be summarized as follows:

       - start a SHA1 hash (Hash1)
       - update Hash1 with the decimal representation of the source port
       - update Hash1 with an undocumented, hard-coded byte sequence
       - finalize Hash1
       - construct encryption key using Hash1[0:16]

     Capturing loopback communications (e.g., with a sniffer)
     requires elevated privilege. Thus, the risk associated with
     this attack vector can be partially mitigated through basic
     system hardening.

     However, access to loopback communications is not the only
     method by which the Credential Provider can be attacked. An
     unprivileged user can simply open a connection, submit an
     encrypted request, and if the conditions are right, the
     Credential Provider may be "tricked" into generating a valid
     response.

     Below, a summary of two distinct races is given. Each race
     consists of two query requests: one made by an authorized user
     (u_auth) and the other made by an unauthorized/unprivileged user
     (u_unauth). Observe (see details provided below) that only the
     authorized query is satisfied in the first race, while both
     queries are satisfied in the second race. By piggybacking on a
     lock file created during u_auth's request, the user controlling
     u_unauth's account is able to retrieve information s/he is
     not authorized to view/possess. Clearly, this is a security
     breach. Factors that make this attack possible include:

       - The key material generated for these communications is
       weak. The effective key space is less than 2^16 because
       the key is derived from the TCP source port used to make
       the request and an undocumented, hard-coded byte sequence
       embedded in the key derivation code (henceforth referred to
       as Suffix1).

       - The user identification mechanism used by the Credential
       Provider is vulnerable to a race condition where a shared,
       ephemeral lock file exists in a common folder from the
       time that the client makes its request to the time that the
       Credential Provider's response is received/processed. The
       window of time in which this file persists affords an
       unauthorized user the opportunity to submit one or more
       distinct requests that subsequently induce the provider
       to reuse the yet-to-be-removed lock file. At that point,
       pending requests (piggyback requests) will be deemed to have
       originated from the same user as the first request (original
       request), and if that user is authorized to make each request,
       then each will be satisfied by the Credential Provider so
       long as the lock file persists. An attacker who understands
       how this mechanism works, can simply wait for a lock file
       to come into existence (or predict its existence based
       on process table monitoring and TCP port allocation). Once
       detected (or predicted), a piggyback request can be submitted
       provided that it originates from the "same" source port as
       the original request.

       - Requests originating from loopback addresses other than
       127.0.0.1 (e.g., 127.0.0.{2,3,4}, etc.) are honored by the
       Credential Provider. This makes it possible for an attacker
       to make a piggyback request from the "same" source port
       as the original request. Without the SO_REUSEPORT socket
       option and cooperating processes, each source address/port
       tuple must be unique on a given system. In other words,
       two non-cooperating processes can't simultaneously bind to
       the same source address/port (e.g., 127.0.0.1:10000). One or
       the other will be rejected by the operating system. However,
       since 127.0.0.1:10000 and 127.0.0.2:10000 are distinct tuples,
       they are viewed as distinct endpoints (by the operating
       system) and are therefore allowed to coexist. The Credential
       Provider, upon receiving a request from either endpoint,
       ignores (or discards) the source address, and incorrectly
       associates that communication as having originated from the
       "same" port (i.e., port 10000 per the example at hand).

       - Note that if the Credential Provider is unable to
       communicate with the Vault, it will continue to answer cached
       queries. If log records are world readable, they can reveal
       past queries that were both legitimate and successful. If
       the provider is configured to maintain a cache, those query
       results are likely still resident in the cache. Thus, an
       attacker may use knowledge of cache behavior and available
       log records to construct piggyback requests that are likely
       to be satisfied when the race is won.

     Below, a sanitized excerpt of the authorization policy
     recovered from the Credential Provider's local cache
     (appprovider_cache.dat) on [NAME REDACTED] is shown. Observe
     that u_auth is listed as an authorized user. The scope of this
     authorization is not fully known. Through testing, it was
     determined that u_auth is authorized to make password queries
     from at least two distinct safes (AIM_SAFE1 and AIM_SAFE2).

       --- policy ---
       <?xml version="1.0" encoding="UTF-8"?>
       <AppMetaData>
         <AIM>
           <AuthMechanism Type="AppID" />
             <AuthReq LastID="142">
               <IPAuth>
                 <IPReqData ReqVal="10.10.1.11" ID="11" />
                 <IPReqData ReqVal="10.10.1.12" ID="12" />
                 ...
                 <IPReqData ReqVal="10.10.1.140" ID="140" />
               </IPAuth>
               <OSUserAuth>
                 ...
                 <OSUserReqData ReqVal="u_auth" ID="6" />
                 ...
               </OSUserAuth>
             </AuthReq>
           <ExtendedApplicationRestrictions isEnable="True" />
         </AIM>
       </AppMetaData>
       --- policy ---

     Below, the result of an authorized query made by u_auth to
     retrieve app_123's password located in the AIM_SAFE1 safe
     is shown. Note that the CyberArk "clipasswordsdk" utility
     transparently encrypts the request and decrypts the response.

       $ clipasswordsdk GetPassword -p AppDescs.AppID=APP_ID -p Query="Address=enco;TokenID=APP123Pass;Env=env1" -o
Password
       --- output ---
       [PASSWORD REDACTED]
       --- output ---

     Below, the result of two unauthorized queries made by u_unauth
     are shown. These queries attempt to retrieve app_456's password
     located in the AIM_SAFE2 safe. Note that these responses
     are essentially what an observer could capture if sniffing
     the loopback interface. Also note that the Elements field
     contains encrypted query results. Once decrypted (as shown
     farther below), it is evident that the first response contains
     an error message indicating that the query failed. Hence,
     that race was lost. However, the second response clearly
     contains valid data. Hence, that race was won. This implies
     that no single race is a sure bet. Rather, factors such as
     current system load, number of processors, processor speed,
     etc. will influence the outcome of any given race. Note that
     an unconstrained user may be able to influence system load
     sufficiently to consistently win the race.

       --- RESPONSE_1_BEGIN [TCP_PORT=44222] ---
       <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
       <Message>
         <Header>
           <ProtocolVersion>995000</ProtocolVersion>
           <ProtocolInfo>3</ProtocolInfo>
         </Header>

<Elements>9232456D7707CEBCC280184CB311F0871521DBFF0546A5E858974FE9E4AC8B4260FB4C579ACFB603905D1CFD1CA8EF76CD9AC32AE6C7CD6EC85FA57BD3E035514EEB72E767FBEA3FF2F4FA45D6F3D7E34B0DDACF9E2A3443E43C24D84544534A65046A6A4CCBED7CF6C72733F7B05CFD2F805E51B277100E1A9D42DA8D759EE6DE43F0D26ED41750EE428F82481CC96C8A3177C09F8A882138C294A4ADBDC270DE55128ABDCFCD6A5451A692DF4AE4035CB8D23C38176E78669903C680C89C14B00798568718FECAA1B7143ABAEEE612CE394DA4B7BD550338DB319BE607EED7F57EBCA05AA52CFAC03B02A4EC49F8F6B9E60375C32CEAA963017F590E3FBBAF4652664FC79AB355CB23EF50581A76FFC207731975FAF04CAAFD32F10B508E16660F0BCF6A55FDF3C2322110FBA425CFD06530B373B493957EF76E62100788D9FF1954BD12CBDD9D4E0393D3F6F411BD28AC788A55D6291BCDC439D895AA24E3A307A479EF420524AA3131C137F2EB9F</Elements>
       </Message>
       --- RESPONSE_1_END [TCP_PORT=44222] ---

       --- RESPONSE_2_BEGIN [TCP_PORT=44228] ---
       <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
       <Message>
         <Header>
           <ProtocolVersion>995000</ProtocolVersion>
           <ProtocolInfo>3</ProtocolInfo>
         </Header>

<Elements>3681C9C1467C74EC3FFB7982B5E2639602D87E70D4E00EDCD6A65AFAF2093077B7CA27126C26A6F23DAEFB90287E9CDF99C20ED9F1835BC849855F8B7CFA437F72C8EF57EA077FA14DA625FAE93C0AAA0883FC130DA386E03622C80439A2F35F6508D08218E8ABE0D2000A2944908D13B5AE20854C4D8DCF30E790E25D6C4642BE52C6BA494FDDAB5A422C644C1D4A4688A9E9450F681BFD0949AB1A3358A355DFA797F2D416A9B1C2EF4C960A2A0B4C2F6F278B0B705D29F3DC3CFC9DA79B43B341D1AD8C45F602796CF627D5721DE7278B984E59CA5B5364A62CEFFAF0EDB9E7E33DCE349781AD0934DDD58E0A27EE669879D4641170C74FF237AD69C2F2C74263F48433213952F3E436EAFA65A69E12833EE189416F5F29A7A420D284180ED3C37D58DBE06600E4F3E01FF13C8AC98A101396E2FB0C382CF2C44C5E9487A31BE8665C2C6CC03F8982E719928537F2446068A849397A7132245F5521C990CA037C9C88C707F661CDD688AC9C45CC23A4B508EEE5E858E47E1C0BC31843BE43522F80DD29F0D6CD4233622D1F95A563C5425DEC73DBD47655525DCA19BBE64C177F8A0462D073FE99F135F2C056108D1F3D7B91CF055681DE5FBB12ABC92C08F872FACCE86C703B2F5CBFD49DB85DFBB484AB4C9308E804053F96D73E2DFD79D1EC55AE26358F4C02D33D0719300627B336B4FF99C294E0A713B6D33381DAB0241448A409E8346AA35F8352E1B0851BC1338EA6863E49DDB98B8CAB8EBB566C257F079BA16B6C28C4F1BA590B61B8F301E941867D3162231016DAA0C738C64C7B4DF355A8C8FCB08B866B81D9C23B9CAB626FFE53601D114D04E370D085B97473E8EE56DE4B7083D645C7E11CC51EF8BEA72A424BFD7FE3DCB6DF2EB58D95D907347627E450E83DD8CFEDA1F438953BFFAF52BEE65A3980F50DED183D6AFA6F0CD1C4B4F28A0FC16540055B76E063015D13100BE3492B9B32C02F45819506B39247CF4CA65CF04BE4BCDCF38EB4E3F44696299AFF93177E9F3E0B8ABD14BF51C35E3493B604173E83B6C00E85B580639A57B961A340881738D925068817F15E5FA565C95B8E913E200F82E21AA51C23C751AD75C3CE32C50B3BCF7B10C680A7CBA7356D2A8027D138AC6B0294AD760F1C71BA7DA8F53B997E60B185998A72693C3A88C43817648D285BFAFCC9F26CD3C37B96862BCED33EB48E536EDA29DBB1E0D7EC5680478BD99361D2C04B5F9E079EE8DC0D2CD76362507C8C13759156D450F1EE283171D3A5D9C8C3B9D284D3BF3B7729529E0FACC3424B27C1A62392B9A127AAF98982318459F20B5A1C60B9DB4AAA1F9AD0F2EEE373E46DC0231FF106</Elements>
       </Message>
       --- RESPONSE_2_END [TCP_PORT=44228] ---

       --- DECRYPTED_ELEMENTS_RESPONSE_1_BEGIN [TCP_PORT=44222] ---
       <Elements>
         <Element>
           <ElementType>ErrorResponse</ElementType>
           <ResponseBase>
             <ResponseId>1</ResponseId>
             <ErrorResponse>
               <ErrorCode>-1</ErrorCode>
               <ErrorMsg>APPAP087E Application authentication failure</ErrorMsg>
             </ErrorResponse>
           </ResponseBase>
         </Element>
       </Elements>
       --- DECRYPTED_ELEMENTS_RESPONSE_1_END [TCP_PORT=44222] ---

       --- DECRYPTED_ELEMENTS_RESPONSE_2_BEGIN [TCP_PORT=44228] ---
       <Elements>
         <Element>
           <ElementType>PasswordResponse</ElementType>
           <ResponseBase>
             <ResponseId>1</ResponseId>
             <PasswordResponse>
               <Password>REDACTED</Password>
               <Flags>0</Flags>
               <AlterPassword></AlterPassword>
               <PassProps>
                 <Address>appprodapplication</Address>
                 <ApplicationName>APP</ApplicationName>
                 <ClassType>Class H</ClassType>
                 <CreationMethod>PVWA</CreationMethod>
                 <Description>SR0118365</Description>
                 <DeviceType>Operating System</DeviceType>
                 <Env>all-prod</Env>
                 <PolicyID>H_SRV_GENERIC_Q_XXX_APC</PolicyID>
                 <RegSCI>ISCI</RegSCI>
                 <TokenID>APPPassword</TokenID>
                 <UserName>app_456</UserName>
               </PassProps>
               <PasswordChangeInProcess>false</PasswordChangeInProcess>
             </PasswordResponse>
           </ResponseBase>
         </Element>
       </Elements>
       --- DECRYPTED_ELEMENTS_RESPONSE_2_END [TCP_PORT=44228] ---

     Below, the relevant log entries generated for queries made
     during the first race are shown. Note how all timestamps
     are identical. Note also that the reason the race was lost is
     revealed by the first record in APPConsole.log. Essentially, the
     authorized query (first entry in APPAudit.log) was satisfied
     and its associated lock file (/tmp/AIM44222) was removed
     before the unauthorized query (second entry in APPAudit.log)
     could be processed by the Credential Provider. And since the
     lock file was removed, the provider had no means to look up
     the process ID of the requesting process.

       --- APPAudit.log ---
       [DATE | 18:09:08] |  ::  | APPAU001I Provider Prov_[REDACTED] has successfully fetched password
[safe=AIM_SAFE1,folder=Root,name=[REDACTED]] with query [Address=enco;TokenID=APP123Pass;Env=env1] for application
[APP_ID]. Fetch reason: []
       [DATE | 18:09:08] |  ::  | APPAU002E Provider Prov_[REDACTED] has failed to fetch password with query
[Address=appprodapplication;Env=all-prod;TokenID=APPPassword] for application [APP_ID]. Fetch reason: []. Failure
reason: [APPAP087E Application authentication failure]
       --- APPAudit.log ---

       --- APPConsole.log ---
       [DATE | 18:09:08] |  ::  | APPAP087E Application authentication failure for Application APP_ID (CASCU086E Failed
to find application process id. (Error: The lock file (/tmp/AIM44222) couldn't be opened, Error code: 2).)
       [DATE | 18:09:08] |  ::  | APPAP002E Provider Prov_[REDACTED] has failed to fetch password with query
[Address=appprodapplication;Env=all-prod;TokenID=APPPassword] for application [APP_ID]. Fetch reason: []. Failure
reason: [APPAP087E Application authentication failure]
       --- APPConsole.log ---

     Below, the relevant log entries generated for queries made
     during the second race are shown. Note how all timestamps are
     identical. The authorized query corresponds to the first entry
     in APPAudit.log, and the unauthorized query corresponds to the
     second entry. Note how two distinct safes were queried. This
     suggests that safes not normally accessed/queried by a given
     Credential Provider may be targeted by an attacker from
     a different system. Clients should be cautioned that the
     contents of any given safe should be confined to a single
     security domain.

       --- APPAudit.log ---
       [DATE | 18:09:13] |  ::  | APPAU001I Provider Prov_[REDACTED] has successfully fetched password
[safe=AIM_SAFE1,folder=Root,name=[REDACTED]] with query [Address=enco;TokenID=APP123Pass;Env=env1] for application
[APP_ID]. Fetch reason: []
       [DATE | 18:09:13] |  ::  | APPAU001I Provider Prov_[REDACTED] has successfully fetched password
[safe=AIM_SAFE2,folder=Root,name=[REDACTED]] with query [Address=appprodapplication;Env=all-prod;TokenID=APPPassword]
for application [APP_ID]. Fetch reason: []
       --- APPAudit.log ---

4. Mitigation and Remediation Recommendation

     The vendor has released an updated version (v12.1) which
     remediates the described vulnerability. Release notes are
     available at:

<https://docs.cyberark.com/Product-Doc/OnlineHelp/PAS/Latest/en/Content/Release%20Notes/RN-WhatsNew12-1-CPs.htm?tocpath=Get%20Started%7CWhat%E2%80%99s%20New%7CRelease%20Notes%7C_____4>

5. Credit

     This vulnerability was discovered by Klayton Monroe of
     KoreLogic, Inc.

6. Disclosure Timeline

     2020.11.04 - KoreLogic submits vulnerability details to
                  CyberArk.
     2020.11.05 - CyberArk acknowledges receipt and the intention
                  to investigate.
     2020.11.16 - KoreLogic and CyberArk meet to discuss the
                  details of this and other reported
                  vulnerabilities. Both parties agree that the
                  remediation timeline will extend significantly
                  longer than the standard 45 business days specified
                  in the KoreLogic Public Disclosure Policy.
     2021.01.14 - 45 business days have elapsed since the
                  vulnerability was reported to CyberArk.
     2021.01.21 - KoreLogic and CyberArk meet to discuss proposed
                  remediation efforts for this and other reported
                  vulnerabilities.
     2021.03.24 - 90 business days have elapsed since the
                  vulnerability was reported to CyberArk.
     2021.04.22 - CyberArk notifies KoreLogic that the reported
                  vulnerability will be mitigated in a version
                  scheduled for release in late May, 2021.
     2021.05.10 - 120 business days have elapsed since the
                  vulnerability was reported to CyberArk.
     2021.05.10 - CyberArk provides KoreLogic with the CVE for this
                  vulnerability. Vendor requests KoreLogic delay
                  public disclosure until the end of June, 2021.
     2021.06.08 - KoreLogic and CyberArk meet to discuss the details
                  of the product release and revisit timeline for
                  public disclosure. CyberArk informs KoreLogic that
                  the Linux/Windows version of the Credential
                  Provider will be released at the end of June, 2021.
                  A Credential Provider for the zOS platform will be
                  released at the end of July, 2021. KoreLogic agrees
                  to delay public disclosure of this and other
                  reported vulnerabilities until 2021.08.15.
     2021.06.23 - CyberArk releases Credential Provider v12.1 for
                  Linux/Windows platforms.
     2021.08.05 - 180 business days have elapsed since the
                  vulnerability was reported to CyberArk.
     2021.08.10 - CyberArk informs KoreLogic that the zOS Credential
                  Provider update has been released to their
                  customers. Requests that KoreLogic forgo
                  publication of the Proof of Concept code as an
                  unforseen issue prevents some customers from
                  updating in the near term.
     2021.08.27 - KoreLogic suggests delaying the release of the
                  Proof of Concept until a to-be-determined future
                  date.
     2021.08.30 - CyberArk tenders 2022.01.01 release date for the
                  Proof of Concept.
     2021.09.01 - KoreLogic public disclosure.

7. Proof of Concept

     At the vendor's request, KoreLogic has agreed to delay
     publication of the Proof of Concept while customers continue
     to deploy the updated versions of the product.

The contents of this advisory are copyright(c) 2021
KoreLogic, Inc. and are licensed under a Creative Commons
Attribution Share-Alike 4.0 (United States) License:
<http://creativecommons.org/licenses/by-sa/4.0/>

KoreLogic, Inc. is a founder-owned and operated company with a
proven track record of providing security services to entities
ranging from Fortune 500 to small and mid-sized companies. We
are a highly skilled team of senior security consultants doing
by-hand security assessments for the most important networks in
the U.S. and around the world. We are also developers of various
tools and resources aimed at helping the security community.
<https://www.korelogic.com/about-korelogic.html>

Our public vulnerability disclosure policy is available at:
<https://korelogic.com/KoreLogic-Public-Vulnerability-Disclosure-Policy.v2.3.txt>

```

**Attachment:
[signature.asc](att-2/signature_asc.bin)**

*Description:* OpenPGP digital signature

```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](1)
[By Date](date.html#2)
[![Next](/images/right-icon-16x16.png)](3)

[![Previous](/images/left-icon-16x16.png)](1)
[By Thread](index.html#2)
[![Next](/images/right-icon-16x16.png)](3)

### Current thread:

* **KL-001-2021-009: CyberArk Credential Provider Race Condition And Authorization Bypass** *KoreLogic Disclosures via Fulldisclosure (Sep 01)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_85b9e363_20250108_113845.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.cyberark.com_d6375c27_20250108_113848.html ===


* [Developer](https://developer.cyberark.com/)
* [Events](https://www.cyberark.com/events/)
* [Marketplace](https://community.cyberark.com/marketplace/s/)
* [Partners](https://cyberark.com/partners/)
* [Careers](https://www.cyberark.com/careers/)

* [![](https://cihost.uberflip.com/cyberArk/favicon-update/assets/cyberark-logo.svg)](https://www.cyberark.com/)
* Why CyberArk

  + - [Identity Security Leader](https://www.cyberark.com/why-cyberark/)

      Security-forward identity and access management.

      [Why CyberArk](https://www.cyberark.com/why-cyberark/)
  + - [CyberArk Labs](https://labs.cyberark.com)

      The industry’s top talent proactively researching attacks and trends to keep you ahead.
    - [Blogs](https://www.cyberark.com/resources/all-blog-posts)

      Insights to help you move fearlessly forward in a digital world.
    - [Careers](https://careers.cyberark.com)

      Join a passionate team that is humbled to be a trusted advisor to the world's top companies.
* Platform

  + - [![cora thumbnail](https://www.cyberark.com/wp-content/uploads/2024/05/cora-ai-nav.png)CyberArk CORA AI™](https://www.cyberark.com/products/cora-ai/)

      CyberArk CORA AI™ is your central hub of identity security-focused artificial intelligence capabilities.

      [Learn More](https://www.cyberark.com/products/cora-ai/)
    - [Identity Security Platform](https://www.cyberark.com/products/)

      Put security first without putting productivity second.

      [Explore Platform](https://www.cyberark.com/products/)
  + - * + [Access Management](https://www.cyberark.com/products/access-management/)
        + [Workforce Access](https://www.cyberark.com/products/workforce-identity/)
          - [Single Sign-On](https://www.cyberark.com/products/single-sign-on/)
          - [Multi-Factor Authentication](https://www.cyberark.com/products/adaptive-multi-factor-authentication/)
          - [Workforce Password Management](https://www.cyberark.com/products/workforce-password-management/)
          - [Secure Web Sessions](https://www.cyberark.com/products/secure-web-sessions/)
          - [Secure Browser](https://www.cyberark.com/products/secure-browser/)
        + [Customer Access](https://www.cyberark.com/products/customer-identity/)
          - [B2B Identity](https://www.cyberark.com/products/b2b-identity/)
      * + [Identity Governance and Administration](https://www.cyberark.com/products/identity-management/)
        + [Identity Compliance](https://www.cyberark.com/products/identity-compliance/)
        + [Lifecycle Management](https://www.cyberark.com/products/lifecycle-management/)
        + [Identity Flows](https://www.cyberark.com/products/identity-flows/)
    - * + [Privileged Access](https://www.cyberark.com/products/privileged-access/)
        + [Privileged Access Management](https://www.cyberark.com/products/privileged-access-manager/)
        + [Vendor Privileged Access](https://www.cyberark.com/products/vendor-privileged-access-manager/)
      * + [Secrets Management](https://www.cyberark.com/products/secrets-management/)
        + [Multi-Cloud Secrets](https://www.cyberark.com/products/multi-cloud-secrets/)
        + [Secrets Hub](https://www.cyberark.com/products/secrets-hub/)
        + [Credential Providers](https://www.cyberark.com/products/credential-providers/)
      * + [Venafi Machine Identity Management](https://venafi.com/)
    - * + [Endpoint Privilege Security](https://www.cyberark.com/products/endpoint-privilege-security/)
        + [Endpoint Privilege Management](https://www.cyberark.com/products/endpoint-privilege-manager/)
        + [Secure Desktop](https://www.cyberark.com/products/secure-desktop/)
      * + [Secure Cloud Access](https://www.cyberark.com/products/secure-cloud-access/)
* Solutions

  + - [![cora thumbnail](https://www.cyberark.com/wp-content/uploads/2024/05/cora-ai-nav.png)CyberArk CORA AI™](https://www.cyberark.com/products/cora-ai/)

      CyberArk CORA AI™ is your central hub of identity security-focused artificial intelligence capabilities.

      [Learn More](https://www.cyberark.com/products/cora-ai/)
    - [Identity Security Offerings](https://www.cyberark.com/solutions/)

      Find the right CyberArk identity security solution for your organization.

      [Explore Solutions](https://www.cyberark.com/solutions/)
  + - * + Workforce
        + [Secure Your Workforce](https://www.cyberark.com/solutions/secure-your-workforce/)
        + [Secure High-Risk Users](https://www.cyberark.com/solutions/secure-high-risk-users/)
        + [Secure Your Desktops and Servers](https://www.cyberark.com/solutions/secure-your-desktops-and-servers/)
        + [Secure External Access](https://www.cyberark.com/solutions/secure-external-access/)
      * + IT
        + [Secure IT Administrators](https://www.cyberark.com/solutions/secure-it-admin-access/)
        + [Secure Cloud Operations Teams](https://www.cyberark.com/solutions/secure-cloud-operations/)
        + [Secure Your Desktops and Servers](https://www.cyberark.com/solutions/secure-your-desktops-and-servers/)
        + [Secure External Access](https://www.cyberark.com/solutions/secure-external-access/)
    - * + Developer
        + [Secure Developers](https://www.cyberark.com/solutions/secure-developers/)
        + [Secure Your Desktops and Servers](https://www.cyberark.com/solutions/secure-your-desktops-and-servers/)
      * + Machines
        + [Secure Cloud Workload Identities​](https://www.cyberark.com/solutions/secure-cloud-workload-identities/)
        + [Secure Secrets for Hybrid IT​](https://www.cyberark.com/solutions/secure-secrets-for-hybrid-it/)
        + [Secure Certificate Management and PKI](https://www.cyberark.com/solutions/secure-certificate-management-and-pki/)
    - * + Industries
        + [Automotive](https://www.cyberark.com/solutions/automotive/)
        + [Banking](https://www.cyberark.com/solutions/banking/)
        + [Critical Infrastructure](https://www.cyberark.com/solutions/critical-infrastructure/)
        + [Financial Services](https://www.cyberark.com/solutions/financial-services/)
        + [Government](https://www.cyberark.com/solutions/government/)
        + [Healthcare](https://www.cyberark.com/solutions/healthcare/)
        + [Insurance](https://www.cyberark.com/solutions/insurance/)
        + [Manufacturing](https://www.cyberark.com/solutions/manufacturing/)
* Services &
  Support
  + - [How Can We Help?](https://www.cyberark.com/services-support/)

      Expert guidance from strategy to implementation.

      [Services & Support](https://www.cyberark.com/services-support/)
  + - * Customer Success
      * [Customer Stories](https://www.cyberark.com/customer-stories/)
      * [CyberArk Blueprint](https://www.cyberark.com/blueprint/)
      * [Success Plans](https://www.cyberark.com/success-plans/)
    - * Learning
      * [Education Resources](https://www.cyberark.com/services-support/)
      * [Certification](https://www.cyberark.com/services-support/certification/)
      * [Training](https://www.cyberark.com/services-support/training/)
    - * Services
      * [Design & Deployment Services](https://www.cyberark.com/services-support/design-deployment/)
      * [Red Team Services](https://www.cyberark.com/services-support/red-team-services/)
      * [Remediation Services](https://www.cyberark.com/services-support/remediation/)
      * [Strategic Consulting Services](https://www.cyberark.com/services-support/strategic-consulting/)
    - * Support
      * [Product Documentation](https://docs.cyberark.com/)
      * [Technical Community](https://cyberark-customers.force.com/s/)
      * [Technical Support](https://www.cyberark.com/services-support/technical-support/)
* Company

  + - [Company](https://www.cyberark.com/company/)

      Our mission is to secure the world against cyber threats so together we can move fearlessly forward.

      [Learn About CyberArk](https://www.cyberark.com/company/)
  + - * About Us
      * [Leadership](https://www.cyberark.com/company/leadership/)
      * [Investor Relations](https://investors.cyberark.com/home/default.aspx)
      * [Environmental, Social and Governance](https://www.cyberark.com/company/esg/)
      * [Trust Center](https://www.cyberark.com/trust/)
      * [Life at CyberArk](https://www.cyberark.com/company/culture/)
      * [Careers](https://www.cyberark.com/careers/)
    - * Highlights
      * [Newsroom](https://www.cyberark.com/company/newsroom/)
      * [Events](https://www.cyberark.com/events/)
      * [Blog](https://www.cyberark.com/resources/all-blog-posts)
      * [Podcasts](https://www.cyberark.com/podcasts/)
      * [Customer Stories](https://www.cyberark.com/customer-stories/)
      * [CyberArk Labs](https://labs.cyberark.com/)
* Demos & Trials

  + - [Demos & Trials](https://www.cyberark.com/try-buy/)

      Get started with one of our 30-day trials.

      [Start a Trial](https://www.cyberark.com/try-buy/)
  + - [How to Buy](https://www.cyberark.com/how-to-buy/)

      Evaluate, purchase and renew CyberArk Identity Security solutions.
    - [Contact Us](https://www.cyberark.com/contact/)

      How can we help you move fearlessly forward?
    - [Identity Security Subscriptions](https://www.cyberark.com/identity-security-subscriptions/)

      Learn more about our subscription offerings.
* [Request a Demo](https://www.cyberark.com/request-demo/)
* [Blog](https://www.cyberark.com/resources/blog)
* [Partners](https://www.cyberark.com/partners/)
* [Marketplace](https://community.cyberark.com/marketplace/s/)
* [Careers](https://www.cyberark.com/careers/)
* Menu Item
  ![](https://www.cyberark.com/wp-content/uploads/2020/12/Icons-Globe@2x.png)
  + [Deutsch](https://www.cyberark.com/de)
  + [Français](https://www.cyberark.com/fr)
  + [Italiano](https://www.cyberark.com/it)
  + [Español](https://www.cyberark.com/es)
  + [日本語](https://www.cyberark.com/ja)
  + [简体中文](https://www.cyberark.com/zh-hans)
  + [繁體中文](https://www.cyberark.com/zh-hant)
  + [한국어](https://www.cyberark.com/ko/)

English – CyberArk Software Inc
## Up Your Security I.Q. by Checking Out Our Collection of Curated Resources.

![loading](https://content.cdntwrk.com/img/hubs/ajax-loader-white-2x.gif?v=19a554b579c4)

[English – CyberArk Software Inc](https://www.cyberark.com/resources "English – CyberArk Software Inc")

* Products & Services
  + Products & Services
  + [Cloud Security](https://www.cyberark.com/resources/cloud-security)
  + [Customer Access](https://www.cyberark.com/resources/customer-access)
  + [Endpoint Privilege Security](https://www.cyberark.com/resources/endpoint-privilege-security)
  + [Identity Management](https://www.cyberark.com/resources/identity-management)
  + [Privileged Access Management](https://www.cyberark.com/resources/privileged-access-management)
  + [Secrets Management](https://www.cyberark.com/resources/secrets-management)
  + [Services & Support​](https://www.cyberark.com/resources/services-support)
  + [Shared Services](https://www.cyberark.com/resources/shared-services)
  + [Workforce Access](https://www.cyberark.com/resources/workforce-access)
* Topics
  + Topics
  + [Access Management](https://www.cyberark.com/resources/access-management)
  + [Best Practices](https://www.cyberark.com/resources/best-practices)
  + [DevSecOps](https://www.cyberark.com/resources/devsecops)
  + [Endpoint Security](https://www.cyberark.com/resources/endpoint-security)
  + [Hybrid and Multi-Cloud Security](https://www.cyberark.com/resources/hybrid-and-multi-cloud-security)
  + [Identity Security](https://www.cyberark.com/resources/identity-security)
  + [IT Security Audit and Compliance](https://www.cyberark.com/resources/it-security-audit-and-compliance)
  + [Least Privilege](https://www.cyberark.com/resources/least-privilege)
  + [Partners](https://www.cyberark.com/resources/partners)
  + [Ransomware Protection](https://www.cyberark.com/resources/ransomware-protection)
  + [Remote Access](https://www.cyberark.com/resources/remote-access)
  + [Robotic Process Automation](https://www.cyberark.com/resources/robotic-process-automation)
  + [Threat Research​](https://www.cyberark.com/resources/threat-research)
  + [Zero Trust](https://www.cyberark.com/resources/zero-trust)
* Industry
  + Industry
  + [Federal](https://www.cyberark.com/resources/federal)
  + [Financial Services](https://www.cyberark.com/resources/financial-services)
  + [Healthcare​](https://www.cyberark.com/resources/healthcare)
  + [Higher Education](https://www.cyberark.com/resources/higher-education)
  + [Insurance](https://www.cyberark.com/resources/insurance)
  + [Manufacturing](https://www.cyberark.com/resources/manufacturing)
* Content Type
  + Content Type
  + [Analyst Reports](https://www.cyberark.com/resources/analyst-reports)
  + [Blog Articles](https://www.cyberark.com/resources/all-blog-posts)
  + [Customer Stories](https://www.cyberark.com/customer-stories/)
  + [eBooks​](https://www.cyberark.com/resources/ebooks)
  + [Executive Insights](https://www.cyberark.com/resources/executive-insights)
  + [Infographics​](https://www.cyberark.com/resources/infographics)
  + [Podcasts](https://www.cyberark.com/podcasts/)
  + [Product Announcements](https://www.cyberark.com/resources/product-announcements)
  + [Product Datasheets​](https://www.cyberark.com/resources/product-datasheets)
  + [Solution Briefs​](https://www.cyberark.com/resources/solution-briefs)
  + [Tools & Blueprints](https://www.cyberark.com/resources/tools-blueprints)
  + [Webinars](https://www.cyberark.com/resources/webinars)
  + [Videos](https://www.cyberark.com/resources/videos)
  + [Whitepapers​](https://www.cyberark.com/resources/white-papers)

×

# The CyberArk Blog

* Share this Stream
* [Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.cyberark.com%2Fresources%2Fblog)
* [Twitter](https://twitter.com/share?text=Check%20out%20The%20CyberArk%20Blog%20from%20English%20%E2%80%93%20CyberArk%20Software%20Inc%27s%20Hub%21&url=https%3A%2F%2Fwww.cyberark.com%2Fresources%2Fblog&via=CyberArk)
* [Email](/cdn-cgi/l/email-protection#330c404651595650470e675b56160103704a515641724158160103715f5c541601035b52401601035156565d160103405b52415657160103445a475b1601034a5c4616010355415c5e160103765d545f5a405b160103167601160b03160a00160103704a515641724158160103605c5547445241561601037a5d50160104401601037b465115525e4308515c574a0e705b5650581601035c4647160103675b56160103704a515641724158160103715f5c5416010355415c5e160103765d545f5a405b160103167601160b03160a00160103704a515641724158160103605c5547445241561601037a5d50160104401601037b46511601021603721603725b474743401600721601751601754444441d504a5156415241581d505c5e1601754156405c4641505640160175515f5c54)
* [LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.cyberark.com%2Fresources%2Fblog&title=The%20CyberArk%20Blog&summary=Check%20out%20The%20CyberArk%20Blog%20from%20English%20%E2%80%93%20CyberArk%20Software%20Inc%27s%20Hub%21%3A%20https%3A%2F%2Fwww.cyberark.com%2Fresources%2Fblog)

* ![A White Hat’s 2024 Reflections: Cybersecurity Insights and Lessons](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F12%2F2024-cybersecurity-reflections.jpg&size=1&version=1735635320&sig=591a1ceb51e2e3dc4580b90325fb2cbd&default=hubs%2Ftilebg-blogs.jpg)
  ### A White Hat’s 2024 Reflections: Cybersecurity Insights and Lessons

  #### xml encoding="UTF-8" As 2024 comes to a close, today, I’m reflecting on some of the key events and trends that shaped my offensive security research this year. From publishing my first book to writing regular blogs on...

  [Read Blog](https://www.cyberark.com/resources/blog/a-white-hats-2024-reflections-cybersecurity-insights-and-lessons)
* CyberArk Named a Leader in the 2024 Gartner® Magic Quadrant™ for Privileged Access Management – again.

  [View the Report](https://www.cyberark.com/resources/analyst-reports/2024-magic-quadrant-report-for-pam)
* ![CIO POV: Beware of Deepfakes Infiltrating the Enterprise](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F12%2Fdeepfakes-infiltrating-enterprise-1-e1734975400455.png&size=1&version=1735572692&sig=37d90b8945c9f93fe4193e1e0c565cbf&default=hubs%2Ftilebg-blogs.jpg)
  ### CIO POV: Beware of Deepfakes Infiltrating the Enterprise

  #### xml encoding="UTF-8" Many years ago, the philosopher Phaedrus said, “Things are not always what they seem; the first appearance deceives many; the intelligence of a few perceives what has been carefully hidden.” He...

  [Read Blog](https://www.cyberark.com/resources/blog/cio-pov-beware-of-deepfakes-infiltrating-the-enterprise)
* ![Cloud Security Audits Explained: Challenges and Solutions](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F12%2Fcloud-security-audits.jpg&size=1&version=1735572692&sig=d3e1b5bc92001e1ec870d9db3cb4d583&default=hubs%2Ftilebg-blogs.jpg)
  ### Cloud Security Audits Explained: Challenges and Solutions

  #### xml encoding="UTF-8" The cloud has enabled faster, more reliable and more scalable software delivery for organizations. Alongside these improvements come greater complexity and security considerations, all of which...

  [Read Blog](https://www.cyberark.com/resources/blog/cloud-security-audits-explained-challenges-and-solutions)
* ![Discover Every Identity to Manage Cybersecurity Risk Effectively](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F12%2Fdiscovery-identity-cybersecurity-risk.jpg&size=1&version=1734980148&sig=f65b4f1a6ea5e7aca40049739bd934d9&default=hubs%2Ftilebg-blogs.jpg)
  ### Discover Every Identity to Manage Cybersecurity Risk Effectively

  #### xml encoding="UTF-8" Next time you’re outside on a clear night, look up at the stars and start counting. Chances are you’ll lose track, skip over some or completely forget where you started—there are just so many. Now...

  [Read Blog](https://www.cyberark.com/resources/blog/discover-every-identity-to-manage-cybersecurity-risk-effectively)
* ![Cybersecurity in 2025: Converging Identities, Private AIs and Autonomous APTs](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F12%2Fcybersecurity-2025.jpg&size=1&version=1734710345&sig=051cf7ffc34f2fbfc9625f87a5ab29c7&default=hubs%2Ftilebg-blogs.jpg)
  ### Cybersecurity in 2025: Converging Identities, Private AIs and Autonomous APTs

  #### xml encoding="UTF-8" 2024 has proved historic for technology and cybersecurity—and we still have some distance from the finish line. We’ve witnessed everything from advancements in artificial intelligence (AI) and...

  [Read Blog](https://www.cyberark.com/resources/blog/cybersecurity-in-2025-converging-identities-private-ais-and-autonomous-apts)
* ![How CISOs Can Sharpen Their Board Pitch for IAM Buy-In](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F12%2Fciso-iam-buy-in-project.png&size=1&version=1734545690&sig=06ee7a109b2242972e9eabfc152183a3&default=hubs%2Ftilebg-blogs.jpg)
  ### How CISOs Can Sharpen Their Board Pitch for IAM Buy-In

  #### xml encoding="UTF-8" In a time when 94% of companies have experienced an identity-related breach, many CISOs feel the urgency to strengthen identity and access management (IAM) across their organizations. In fact, a...

  [Read Blog](https://www.cyberark.com/resources/blog/how-cisos-can-sharpen-their-board-pitch-for-iam-buy-in)
* ![Challenging the Access Management Status Quo](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F12%2Faccess-management-mq-challenger.png&size=1&version=1734111553&sig=44ab4afcd1b227689161f4ebeea03948&default=hubs%2Ftilebg-blogs.jpg)
  ### Challenging the Access Management Status Quo

  #### xml encoding="UTF-8" Once upon a time, workers sat in offices, only used corporate desktops and crossed a single authentication checkpoint to access company resources kept snugly behind a protective barrier. The world...

  [Read Blog](https://www.cyberark.com/resources/blog/challenging-the-access-management-status-quo)
* ![Logins Are Cheap. Peace of Mind Is Priceless.](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F12%2Flogins-access-workforce.jpg&size=1&version=1733927717&sig=6ef523d815caecf5786a1b8b87ca63ec&default=hubs%2Ftilebg-blogs.jpg)
  ### Logins Are Cheap. Peace of Mind Is Priceless.

  #### xml encoding="UTF-8" Why We Need Identity Security That Moves with Our Workforce Imagine a typical morning at an enterprise: employees, remote workers, contractors and partners log in, browsing and accessing apps and...

  [Read Blog](https://www.cyberark.com/resources/blog/logins-are-cheap-peace-of-mind-is-priceless)
* ![Securing Remote Access: Best Practices for Third-Party Risk Management](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F11%2Fsecure-remote-access.jpg&size=1&version=1733236423&sig=6bb986ac3d87ef056a5f149c3f752909&default=hubs%2Ftilebg-blogs.jpg)
  ### Securing Remote Access: Best Practices for Third-Party Risk Management

  #### xml encoding="UTF-8" Remote Access: A Longstanding Necessity The physical location of users has become less and less important in conducting business, with the drawback that it creates new, persistent threats to...

  [Read Blog](https://www.cyberark.com/resources/blog/securing-remote-access-best-practices-for-third-party-risk-management)
* ![How New CyberArk and Wiz Integrations Enhance Multi-Cloud Security](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F11%2Fcyberark-wiz-integrations-v1.png&size=1&version=1732207860&sig=a94f8097ebcd3fdf56f661479b5249c7&default=hubs%2Ftilebg-blogs.jpg)
  ### How New CyberArk and Wiz Integrations Enhance Multi-Cloud Security

  #### xml encoding="UTF-8" The adoption of cloud technology has transformed how organizations develop, deploy and oversee internal and customer-facing applications. Cloud workloads and services create efficiencies and...

  [Read Blog](https://www.cyberark.com/resources/blog/how-new-cyberark-and-wiz-integrations-enhance-multi-cloud-security)
* ![CIO POV: How Modern CIOs Wear (at Least) Seven Different Hats](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F11%2Fmodern-cios-business-technolgy.jpg&size=1&version=1734981031&sig=f6b27620d8bcfcf2373a9adf9a51c03b&default=hubs%2Ftilebg-blogs.jpg)
  ### CIO POV: How Modern CIOs Wear (at Least) Seven Different Hats

  #### xml encoding="UTF-8" When the title of chief information officer (CIO) first emerged in the early 1980s, it was very different from what it is today. Technology evolution, emerging threats and new realities have...

  [Read Blog](https://www.cyberark.com/resources/blog/how-modern-cios-wear-at-least-seven-different-hats)
* ![Why Identity Security is Your Best Companion for Uncharted Compliance Challenges](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F11%2Fidentity-security-compliance.png&size=1&version=1733983245&sig=d4febe8cf1307046fb17b259ab9bcea4&default=hubs%2Ftilebg-blogs.jpg)
  ### Why Identity Security is Your Best Companion for Uncharted Compliance Challenges

  #### xml encoding="UTF-8" In today’s rapidly evolving global regulatory landscape, new technologies, environments and threats are heightening cybersecurity and data privacy concerns. In the last year, governing bodies have...

  [Read Blog](https://www.cyberark.com/resources/blog/why-identity-security-is-your-best-companion-for-uncharted-compliance-challenges)
* ![Building Trust in Digital Retail: How Identity Security Protects E-Commerce](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fidentity-security-ecommerce-trust.png&size=1&version=1731504321&sig=28850e87d21440e34681a0f67288d385&default=hubs%2Ftilebg-blogs.jpg)
  ### Building Trust in Digital Retail: How Identity Security Protects E-Commerce

  #### xml encoding="UTF-8" As retailers prepare for a season of high-demand online shopping, the risks of cyberthreats continue to grow, much like the need for increased security in a bustling mall on busy shopping days. In...

  [Read Blog](https://www.cyberark.com/resources/blog/building-trust-in-digital-retail-how-identity-security-protects-e-commerce-2)
* ![How to Protect Your IoT and OT Devices from Cyberthreats](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fiot-ot-devices-cyberthreats.png&size=1&version=1731084474&sig=8bc7891a70855c06c9cc827289f0d3e5&default=hubs%2Ftilebg-blogs.jpg)
  ### How to Protect Your IoT and OT Devices from Cyberthreats

  #### xml encoding="UTF-8" The rise of the Internet of Things (IoT) and Operational Technology (OT) devices is reshaping industries, accelerating innovation and driving new efficiencies. However, as organizations...

  [Read Blog](https://www.cyberark.com/resources/blog/how-to-protect-your-iot-and-ot-devices-from-cyberthreats)
* ![CIO POV: Building Trust in Cyberspace](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F10%2Ftrust-cyberspace-1.png&size=1&version=1734980583&sig=767f2aea75a00dfc3bd120987b5a4c18&default=hubs%2Ftilebg-blogs.jpg)
  ### CIO POV: Building Trust in Cyberspace

  #### xml encoding="UTF-8" Trust lies at the heart of every relationship, transaction and encounter. Yet in cyberspace—where we work, live, learn and play—trust can become elusive. Since the dawn of the Internet nearly 50...

  [Read Blog](https://www.cyberark.com/resources/blog/cio-pov-building-trust-in-cyberspace)
* ![Intelligent Privilege Controls™: A Quick Guide to Secure Every Identity](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fintelligent-privilege-controls-identities.jpg&size=1&version=1729782024&sig=19191ef0706d92e46521d8bcd46c6e67&default=hubs%2Ftilebg-blogs.jpg)
  ### Intelligent Privilege Controls™: A Quick Guide to Secure Every Identity

  #### xml encoding="UTF-8" Security used to be simpler. Employees, servers and applications were on site. IT admins were the only privileged identities you had to secure, and a strong security perimeter helped to keep all...

  [Read Blog](https://www.cyberark.com/resources/blog/intelligent-privilege-controls-a-quick-guide-to-secure-every-identity)
* ![Who’s Responsible for Your Security?](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fsecurity-responsibility-v1.jpg&size=1&version=1729703238&sig=9530fc9654cfb4ca3a9e952f17850668&default=hubs%2Ftilebg-blogs.jpg)
  ### Who’s Responsible for Your Security?

  #### xml encoding="UTF-8" Antivirus, malware protection, email security, EDR, XDR, next-generation firewalls, AI-enabled analytics – the list of protective controls and vendors appears to go on forever. Each day, bad...

  [Read Blog](https://www.cyberark.com/resources/blog/whos-responsible-for-your-security)
* ![Six Key Measures for Upholding Election Security and Integrity](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F09%2Felection-security.jpg&size=1&version=1728998238&sig=703be0e1b85db8bdd08c936a57b8ad9d&default=hubs%2Ftilebg-blogs.jpg)
  ### Six Key Measures for Upholding Election Security and Integrity

  #### xml encoding="UTF-8" Decision 2024 – the ultimate election year – is in full swing, with more than 60 countries holding national elections this cycle. In the United States, where presidential candidates are polling...

  [Read Blog](https://www.cyberark.com/resources/blog/six-key-measures-for-upholding-election-security-and-integrity)
* ![A New Era of Machine Identity Security: Welcome Venafi to CyberArk](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F09%2Fcyberark-venafi-machine-identities.jpg&size=1&version=1730302456&sig=93d0520c47ec52092fe9b323dcab4525&default=hubs%2Ftilebg-blogs.jpg)
  ### A New Era of Machine Identity Security: Welcome Venafi to CyberArk

  #### xml encoding="UTF-8" We are thrilled to announce that we have completed the acquisition of Venafi, a recognized leader in machine identity management. This strategic move aligns with our commitment to not just...

  [Read Blog](https://www.cyberark.com/resources/blog/a-new-era-of-machine-identity-security-welcome-venafi-to-cyberark)
* ![Critical Access Controls: Ensuring Database Security](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F09%2Fdatabase-security-critical-access-controls.jpg&size=1&version=1727898197&sig=bdecb0868d0d34ee7f487ed581dbba8f&default=hubs%2Ftilebg-blogs.jpg)
  ### Critical Access Controls: Ensuring Database Security

  #### xml encoding="UTF-8" Securing database access has become a critical concern for organizations globally. Your organization’s data is its most valuable asset, encompassing everything about your business, partners,...

  [Read Blog](https://www.cyberark.com/resources/blog/critical-access-controls-ensuring-database-security)
* ![loading](https://content.cdntwrk.com/img/hubs/ajax-loader-grey-2x.gif?v=acc9f6ab6ffb)
  Loading More...

Load More

© CyberArk Software Inc

×
Streams

* Products & Services
  + [Cloud Security](https://www.cyberark.com/resources/cloud-security)
  + [Customer Access](https://www.cyberark.com/resources/customer-access)
  + [Endpoint Privilege Security](https://www.cyberark.com/resources/endpoint-privilege-security)
  + [Identity Management](https://www.cyberark.com/resources/identity-management)
  + [Privileged Access Management](https://www.cyberark.com/resources/privileged-access-management)
  + [Secrets Management](https://www.cyberark.com/resources/secrets-management)
  + [Services & Support​](https://www.cyberark.com/resources/services-support)
  + [Shared Services](https://www.cyberark.com/resources/shared-services)
  + [Workforce Access](https://www.cyberark.com/resources/workforce-access)
* Topics
  + [Access Management](https://www.cyberark.com/resources/access-management)
  + [Best Practices](https://www.cyberark.com/resources/best-practices)
  + [DevSecOps](https://www.cyberark.com/resources/devsecops)
  + [Endpoint Security](https://www.cyberark.com/resources/endpoint-security)
  + [Hybrid and Multi-Cloud Security](https://www.cyberark.com/resources/hybrid-and-multi-cloud-security)
  + [Identity Security](https://www.cyberark.com/resources/identity-security)
  + [IT Security Audit and Compliance](https://www.cyberark.com/resources/it-security-audit-and-compliance)
  + [Least Privilege](https://www.cyberark.com/resources/least-privilege)
  + [Partners](https://www.cyberark.com/resources/partners)
  + [Ransomware Protection](https://www.cyberark.com/resources/ransomware-protection)
  + [Remote Access](https://www.cyberark.com/resources/remote-access)
  + [Robotic Process Automation](https://www.cyberark.com/resources/robotic-process-automation)
  + [Threat Research​](https://www.cyberark.com/resources/threat-research)
  + [Zero Trust](https://www.cyberark.com/resources/zero-trust)
* Industry
  + [Federal](https://www.cyberark.com/resources/federal)
  + [Financial Services](https://www.cyberark.com/resources/financial-services)
  + [Healthcare​](https://www.cyberark.com/resources/healthcare)
  + [Higher Education](https://www.cyberark.com/resources/higher-education)
  + [Insurance](https://www.cyberark.com/resources/insurance)
  + [Manufacturing](https://www.cyberark.com/resources/manufacturing)
* Content Type
  + [Analyst Reports](https://www.cyberark.com/resources/analyst-reports)
  + [Blog Articles](https://www.cyberark.com/resources/all-blog-posts)
  + [Customer Stories](https://www.cyberark.com/customer-stories/)
  + [eBooks​](https://www.cyberark.com/resources/ebooks)
  + [Executive Insights](https://www.cyberark.com/resources/executive-insights)
  + [Infographics​](https://www.cyberark.com/resources/infographics)
  + [Podcasts](https://www.cyberark.com/podcasts/)
  + [Product Announcements](https://www.cyberark.com/resources/product-announcements)
  + [Product Datasheets​](https://www.cyberark.com/resources/product-datasheets)
  + [Solution Briefs​](https://www.cyberark.com/resources/solution-briefs)
  + [Tools & Blueprints](https://www.cyberark.com/resources/tools-blueprints)
  + [Webinars](https://www.cyberark.com/resources/webinars)
  + [Videos](https://www.cyberark.com/resources/videos)
  + [Whitepapers​](https://www.cyberark.com/resources/white-papers)

![loading](https://content.cdntwrk.com/img/hubs/ajax-loader-white-2x.gif?v=19a554b579c4)

* Share this Hub
* [Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.cyberark.com%2Fresources)
* [Twitter](https://twitter.com/share?text=Check%20out%20what%27s%20happening%20at%20CyberArk%21&url=https%3A%2F%2Fwww.cyberark.com%2Fresources&via=CyberArk)
* [Email](/cdn-cgi/l/email-protection#08377b7d6a626d6b7c354d666f64617b602d3a382d4d3a2d30382d313b2d3a384b716a6d7a497a632d3a385b676e7c7f697a6d2d3a3841666b2d3a3f7b2d3a38407d6a2d3a3860697b2d3a386a6d6d662d3a387b60697a6d6c2d3a387f617c602d3a3871677d2e696578336a676c71354b606d6b632d3a38677d7c2d3a387f60697c2d3a3f7b2d3a38606978786d6661666f2d3a38697c2d3a384b716a6d7a497a632d3a392d38492d3849607c7c787b2d3b492d3a4e2d3a4e7f7f7f266b716a6d7a697a63266b67652d3a4e7a6d7b677d7a6b6d7b)
* [LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.cyberark.com%2Fresources&title=English%20%E2%80%93%20CyberArk%20Software%20Inc%27s&summary=Check%20out%20what%27s%20happening%20at%20CyberArk%21)

×

* #### STAY IN TOUCH

  Keep up to date on security best practices, events and webinars.

  [Tell Me How](https://lp.cyberark.com/Stay-in-touch.html)

* Support
* [Contact Support](https://www.cyberark.com/services-support/technical-support-contact/)
* [Training & Certification](https://www.cyberark.com/services-support/training/)
* [Technical Support](https://www.cyberark.com/services-support/technical-support/)
* [EPM SaaS Register / Login](https://www.cyberark.com/products/endpoint-privilege-manager/login/)
* [Product Security](https://www.cyberark.com/product-security/)

* Resources
* [Resource Center](https://www.cyberark.com/resources)
* [Events](https://www.cyberark.com/events/)
* [Blogs](https://www.cyberark.com/resources/all-blog-posts)
* [CIO Connection](https://www.cyberark.com/cio-connection/)
* [CyberArk Blueprint](https://www.cyberark.com/blueprint/)
* [Scan Your Network](https://www.cyberark.com/discovery-audit/)
* [Marketplace![external icon](https://www.cyberark.com/wp-content/uploads/2021/01/External-darkblue.svg)](https://community.cyberark.com/marketplace/s/)

* Partners
* [Partner Network](https://www.cyberark.com/partners/partner-network/)
* [Partner Community![external link](https://www.cyberark.com/wp-content/uploads/2021/01/External-darkblue.svg)](https://community.cyberark.com/partners/s/login/)
* [Partner Finder](https://www.cyberark.com/partner-finder/)
* [Become a Partner](https://www.cyberark.com/partners/become-a-partner/)
* [Alliance Partner](https://www.cyberark.com/partners/alliance-partners/)

* Company
* [Investor Relations ![external link](https://www.cyberark.com/wp-content/uploads/2021/01/External-darkblue.svg)](https://investors.cyberark.com/home/default.aspx)
* [Leadership](https://www.cyberark.com/company/leadership/)
* [Board of Directors](https://www.cyberark.com/company/leadership/#directors)
* [Newsroom](https://www.cyberark.com/company/newsroom/)
* [Office Locations](https://www.cyberark.com/company/office-locations/)
* [Environmental, Social and Governance](https://www.cyberark.com/company/esg/)
* [Trust Center](https://www.cyberark.com/trust/)
* [Careers – We’re Hiring!](https://careers.cyberark.com/)

![CyberArk Logo](https://cihost.uberflip.com/cyberArk/favicon-update/assets/cyberark-logo.svg)

Copyright ©  CyberArk Software Ltd.
All rights reserved.

* [*Linkedin*](https://www.linkedin.com/company/cyber-ark-software)
* [*Blog*](https://www.cyberark.com/resources/blog)
* [*Youtube*](https://www.youtube.com/user/cyberarksoftware)

* [Terms and Conditions](https://www.cyberark.com/terms-conditions/)
* [Privacy Policy](https://www.cyberark.com/privacy-notice/)



=== Content from korelogic.com_54b44917_20250108_113847.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
KL-001-2021-009: CyberArk Credential Provider Race Condition And Authorization Bypass
Title: CyberArk Credential Provider Race Condition And Authorization Bypass
Advisory ID: KL-001-2021-009
Publication Date: 2021.09.01
Publication URL: https://korelogic.com/Resources/Advisories/KL-001-2021-009.txt
1. Vulnerability Details
Affected Vendor: CyberArk
Affected Product: Application Access Manager/Credential Provider
Affected Version: Prior to 12.1
Platform: Linux/Windows/zOS
CWE Classification: CWE-326: Inadequate Encryption Strength,
CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition'),
CWE-923: Improper Restriction of Communication Channel to Intended Endpoints
CVE ID: CVE-2021-31797
2. Vulnerability Description
CyberArk's Credential Provider loopback communications on TCP
port 18923 are encrypted with key material that has extremely
low entropy. In all currently-known use cases, the effective
key space is less than 2^16. For an attacker who understands the
key derivation scheme and encryption mechanics, knowledge of the
source port and access to the payloads of a given client-server
exchange are sufficient to reduce effective key space to one. In
cases where the source port is not known, the encrypted payloads
will be unable to withstand a brute force attack.
Additionally, the user identification mechanism used
by CyberArk's Credential Provider is vulnerable to a race
condition where an unauthorized/unprivileged user can submit
one or more encrypted query requests. If the race is won,
the attacker will be able to retrieve sensitive information
including passwords and password metadata.
3. Technical Description
Based on analysis and observations, the key derivation process
for CyberArk's Credential Provider loopback communications on
TCP port 18923 can be summarized as follows:
- start a SHA1 hash (Hash1)
- update Hash1 with the decimal representation of the source port
- update Hash1 with an undocumented, hard-coded byte sequence
- finalize Hash1
- construct encryption key using Hash1[0:16]
Capturing loopback communications (e.g., with a sniffer)
requires elevated privilege. Thus, the risk associated with
this attack vector can be partially mitigated through basic
system hardening.
However, access to loopback communications is not the only
method by which the Credential Provider can be attacked. An
unprivileged user can simply open a connection, submit an
encrypted request, and if the conditions are right, the
Credential Provider may be "tricked" into generating a valid
response.
Below, a summary of two distinct races is given. Each race
consists of two query requests: one made by an authorized user
(u\_auth) and the other made by an unauthorized/unprivileged user
(u\_unauth). Observe (see details provided below) that only the
authorized query is satisfied in the first race, while both
queries are satisfied in the second race. By piggybacking on a
lock file created during u\_auth's request, the user controlling
u\_unauth's account is able to retrieve information s/he is
not authorized to view/possess. Clearly, this is a security
breach. Factors that make this attack possible include:
- The key material generated for these communications is
weak. The effective key space is less than 2^16 because
the key is derived from the TCP source port used to make
the request and an undocumented, hard-coded byte sequence
embedded in the key derivation code (henceforth referred to
as Suffix1).
- The user identification mechanism used by the Credential
Provider is vulnerable to a race condition where a shared,
ephemeral lock file exists in a common folder from the
time that the client makes its request to the time that the
Credential Provider's response is received/processed. The
window of time in which this file persists affords an
unauthorized user the opportunity to submit one or more
distinct requests that subsequently induce the provider
to reuse the yet-to-be-removed lock file. At that point,
pending requests (piggyback requests) will be deemed to have
originated from the same user as the first request (original
request), and if that user is authorized to make each request,
then each will be satisfied by the Credential Provider so
long as the lock file persists. An attacker who understands
how this mechanism works, can simply wait for a lock file
to come into existence (or predict its existence based
on process table monitoring and TCP port allocation). Once
detected (or predicted), a piggyback request can be submitted
provided that it originates from the "same" source port as
the original request.
- Requests originating from loopback addresses other than
127.0.0.1 (e.g., 127.0.0.{2,3,4}, etc.) are honored by the
Credential Provider. This makes it possible for an attacker
to make a piggyback request from the "same" source port
as the original request. Without the SO\_REUSEPORT socket
option and cooperating processes, each source address/port
tuple must be unique on a given system. In other words,
two non-cooperating processes can't simultaneously bind to
the same source address/port (e.g., 127.0.0.1:10000). One or
the other will be rejected by the operating system. However,
since 127.0.0.1:10000 and 127.0.0.2:10000 are distinct tuples,
they are viewed as distinct endpoints (by the operating
system) and are therefore allowed to coexist. The Credential
Provider, upon receiving a request from either endpoint,
ignores (or discards) the source address, and incorrectly
associates that communication as having originated from the
"same" port (i.e., port 10000 per the example at hand).
- Note that if the Credential Provider is unable to
communicate with the Vault, it will continue to answer cached
queries. If log records are world readable, they can reveal
past queries that were both legitimate and successful. If
the provider is configured to maintain a cache, those query
results are likely still resident in the cache. Thus, an
attacker may use knowledge of cache behavior and available
log records to construct piggyback requests that are likely
to be satisfied when the race is won.
Below, a sanitized excerpt of the authorization policy
recovered from the Credential Provider's local cache
(appprovider\_cache.dat) on [NAME REDACTED] is shown. Observe
that u\_auth is listed as an authorized user. The scope of this
authorization is not fully known. Through testing, it was
determined that u\_auth is authorized to make password queries
from at least two distinct safes (AIM\_SAFE1 and AIM\_SAFE2).
--- policy ---
xml version="1.0" encoding="UTF-8"?

...

...

...

--- policy ---
Below, the result of an authorized query made by u\_auth to
retrieve app\_123's password located in the AIM\_SAFE1 safe
is shown. Note that the CyberArk "clipasswordsdk" utility
transparently encrypts the request and decrypts the response.
$ clipasswordsdk GetPassword -p AppDescs.AppID=APP\_ID -p Query="Address=enco;TokenID=APP123Pass;Env=env1" -o Password
--- output ---
[PASSWORD REDACTED]
--- output ---
Below, the result of two unauthorized queries made by u\_unauth
are shown. These queries attempt to retrieve app\_456's password
located in the AIM\_SAFE2 safe. Note that these responses
are essentially what an observer could capture if sniffing
the loopback interface. Also note that the Elements field
contains encrypted query results. Once decrypted (as shown
farther below), it is evident that the first response contains
an error message indicating that the query failed. Hence,
that race was lost. However, the second response clearly
contains valid data. Hence, that race was won. This implies
that no single race is a sure bet. Rather, factors such as
current system load, number of processors, processor speed,
etc. will influence the outcome of any given race. Note that
an unconstrained user may be able to influence system load
sufficiently to consistently win the race.
--- RESPONSE\_1\_BEGIN [TCP\_PORT=44222] ---
xml version="1.0" encoding="UTF-8" standalone="no" ?
995000
3

9232456D7707CEBCC280184CB311F0871521DBFF0546A5E858974FE9E4AC8B4260FB4C579ACFB603905D1CFD1CA8EF76CD9AC32AE6C7CD6EC85FA57BD3E035514EEB72E767FBEA3FF2F4FA45D6F3D7E34B0DDACF9E2A3443E43C24D84544534A65046A6A4CCBED7CF6C72733F7B05CFD2F805E51B277100E1A9D42DA8D759EE6DE43F0D26ED41750EE428F82481CC96C8A3177C09F8A882138C294A4ADBDC270DE55128ABDCFCD6A5451A692DF4AE4035CB8D23C38176E78669903C680C89C14B00798568718FECAA1B7143ABAEEE612CE394DA4B7BD550338DB319BE607EED7F57EBCA05AA52CFAC03B02A4EC49F8F6B9E60375C32CEAA963017F590E3FBBAF4652664FC79AB355CB23EF50581A76FFC207731975FAF04CAAFD32F10B508E16660F0BCF6A55FDF3C2322110FBA425CFD06530B373B493957EF76E62100788D9FF1954BD12CBDD9D4E0393D3F6F411BD28AC788A55D6291BCDC439D895AA24E3A307A479EF420524AA3131C137F2EB9F

--- RESPONSE\_1\_END [TCP\_PORT=44222] ---
--- RESPONSE\_2\_BEGIN [TCP\_PORT=44228] ---
xml version="1.0" encoding="UTF-8" standalone="no" ?
995000
3

3681C9C1467C74EC3FFB7982B5E2639602D87E70D4E00EDCD6A65AFAF2093077B7CA27126C26A6F23DAEFB90287E9CDF99C20ED9F1835BC849855F8B7CFA437F72C8EF57EA077FA14DA625FAE93C0AAA0883FC130DA386E03622C80439A2F35F6508D08218E8ABE0D2000A2944908D13B5AE20854C4D8DCF30E790E25D6C4642BE52C6BA494FDDAB5A422C644C1D4A4688A9E9450F681BFD0949AB1A3358A355DFA797F2D416A9B1C2EF4C960A2A0B4C2F6F278B0B705D29F3DC3CFC9DA79B43B341D1AD8C45F602796CF627D5721DE7278B984E59CA5B5364A62CEFFAF0EDB9E7E33DCE349781AD0934DDD58E0A27EE669879D4641170C74FF237AD69C2F2C74263F48433213952F3E436EAFA65A69E12833EE189416F5F29A7A420D284180ED3C37D58DBE06600E4F3E01FF13C8AC98A101396E2FB0C382CF2C44C5E9487A31BE8665C2C6CC03F8982E719928537F2446068A849397A7132245F5521C990CA037C9C88C707F661CDD688AC9C45CC23A4B508EEE5E858E47E1C0BC31843BE43522F80DD29F0D6CD4233622D1F95A563C5425DEC73DBD47655525DCA19BBE64C177F8A0462D073FE99F135F2C056108D1F3D7B91CF055681DE5FBB12ABC92C08F872FACCE86C703B2F5CBFD49DB85DFBB484AB4C9308E804053F96D73E2DFD79D1EC55AE26358F4C02D33D0719300627B336B4FF99C294E0A713B6D33381DAB0241448A409E8346AA35F8352E1B0851BC1338EA6863E49DDB98B8CAB8EBB566C257F079BA16B6C28C4F1BA590B61B8F301E941867D3162231016DAA0C738C64C7B4DF355A8C8FCB08B866B81D9C23B9CAB626FFE53601D114D04E370D085B97473E8EE56DE4B7083D645C7E11CC51EF8BEA72A424BFD7FE3DCB6DF2EB58D95D907347627E450E83DD8CFEDA1F438953BFFAF52BEE65A3980F50DED183D6AFA6F0CD1C4B4F28A0FC16540055B76E063015D13100BE3492B9B32C02F45819506B39247CF4CA65CF04BE4BCDCF38EB4E3F44696299AFF93177E9F3E0B8ABD14BF51C35E3493B604173E83B6C00E85B580639A57B961A340881738D925068817F15E5FA565C95B8E913E200F82E21AA51C23C751AD75C3CE32C50B3BCF7B10C680A7CBA7356D2A8027D138AC6B0294AD760F1C71BA7DA8F53B997E60B185998A72693C3A88C43817648D285BFAFCC9F26CD3C37B96862BCED33EB48E536EDA29DBB1E0D7EC5680478BD99361D2C04B5F9E079EE8DC0D2CD76362507C8C13759156D450F1EE283171D3A5D9C8C3B9D284D3BF3B7729529E0FACC3424B27C1A62392B9A127AAF98982318459F20B5A1C60B9DB4AAA1F9AD0F2EEE373E46DC0231FF106

--- RESPONSE\_2\_END [TCP\_PORT=44228] ---
--- DECRYPTED\_ELEMENTS\_RESPONSE\_1\_BEGIN [TCP\_PORT=44222] ---
ErrorResponse
1
-1
APPAP087E Application authentication failure

--- DECRYPTED\_ELEMENTS\_RESPONSE\_1\_END [TCP\_PORT=44222] ---
--- DECRYPTED\_ELEMENTS\_RESPONSE\_2\_BEGIN [TCP\_PORT=44228] ---
PasswordResponse
1
REDACTED
0

appprodapplication
APP
Class H
PVWA
SR0118365
Operating System
all-prod
H\_SRV\_GENERIC\_Q\_XXX\_APC
ISCI
APPPassword
app\_456

false

--- DECRYPTED\_ELEMENTS\_RESPONSE\_2\_END [TCP\_PORT=44228] ---
Below, the relevant log entries generated for queries made
during the first race are shown. Note how all timestamps
are identical. Note also that the reason the race was lost is
revealed by the first record in APPConsole.log. Essentially, the
authorized query (first entry in APPAudit.log) was satisfied
and its associated lock file (/tmp/AIM44222) was removed
before the unauthorized query (second entry in APPAudit.log)
could be processed by the Credential Provider. And since the
lock file was removed, the provider had no means to look up
the process ID of the requesting process.
--- APPAudit.log ---
[DATE | 18:09:08] | :: | APPAU001I Provider Prov\_[REDACTED] has successfully fetched password [safe=AIM\_SAFE1,folder=Root,name=[REDACTED]] with query [Address=enco;TokenID=APP123Pass;Env=env1] for application [APP\_ID]. Fetch reason: []
[DATE | 18:09:08] | :: | APPAU002E Provider Prov\_[REDACTED] has failed to fetch password with query [Address=appprodapplication;Env=all-prod;TokenID=APPPassword] for application [APP\_ID]. Fetch reason: []. Failure reason: [APPAP087E Application authentication failure]
--- APPAudit.log ---
--- APPConsole.log ---
[DATE | 18:09:08] | :: | APPAP087E Application authentication failure for Application APP\_ID (CASCU086E Failed to find application process id. (Error: The lock file (/tmp/AIM44222) couldn't be opened, Error code: 2).)
[DATE | 18:09:08] | :: | APPAP002E Provider Prov\_[REDACTED] has failed to fetch password with query [Address=appprodapplication;Env=all-prod;TokenID=APPPassword] for application [APP\_ID]. Fetch reason: []. Failure reason: [APPAP087E Application authentication failure]
--- APPConsole.log ---
Below, the relevant log entries generated for queries made
during the second race are shown. Note how all timestamps are
identical. The authorized query corresponds to the first entry
in APPAudit.log, and the unauthorized query corresponds to the
second entry. Note how two distinct safes were queried. This
suggests that safes not normally accessed/queried by a given
Credential Provider may be targeted by an attacker from
a different system. Clients should be cautioned that the
contents of any given safe should be confined to a single
security domain.
--- APPAudit.log ---
[DATE | 18:09:13] | :: | APPAU001I Provider Prov\_[REDACTED] has successfully fetched password [safe=AIM\_SAFE1,folder=Root,name=[REDACTED]] with query [Address=enco;TokenID=APP123Pass;Env=env1] for application [APP\_ID]. Fetch reason: []
[DATE | 18:09:13] | :: | APPAU001I Provider Prov\_[REDACTED] has successfully fetched password [safe=AIM\_SAFE2,folder=Root,name=[REDACTED]] with query [Address=appprodapplication;Env=all-prod;TokenID=APPPassword] for application [APP\_ID]. Fetch reason: []
--- APPAudit.log ---
4. Mitigation and Remediation Recommendation
The vendor has released an updated version (v12.1) which
remediates the described vulnerability. Release notes are
available at:
https://docs.cyberark.com/Product-Doc/OnlineHelp/PAS/Latest/en/Content/Release%20Notes/RN-WhatsNew12-1-CPs.htm?tocpath=Get%20Started%7CWhat%E2%80%99s%20New%7CRelease%20Notes%7C\_\_\_\_\_4
5. Credit
This vulnerability was discovered by Klayton Monroe of
KoreLogic, Inc.
6. Disclosure Timeline
2020.11.04 - KoreLogic submits vulnerability details to
CyberArk.
2020.11.05 - CyberArk acknowledges receipt and the intention
to investigate.
2020.11.16 - KoreLogic and CyberArk meet to discuss the
details of this and other reported
vulnerabilities. Both parties agree that the
remediation timeline will extend significantly
longer than the standard 45 business days specified
in the KoreLogic Public Disclosure Policy.
2021.01.14 - 45 business days have elapsed since the
vulnerability was reported to CyberArk.
2021.01.21 - KoreLogic and CyberArk meet to discuss proposed
remediation efforts for this and other reported
vulnerabilities.
2021.03.24 - 90 business days have elapsed since the
vulnerability was reported to CyberArk.
2021.04.22 - CyberArk notifies KoreLogic that the reported
vulnerability will be mitigated in a version
scheduled for release in late May, 2021.
2021.05.10 - 120 business days have elapsed since the
vulnerability was reported to CyberArk.
2021.05.10 - CyberArk provides KoreLogic with the CVE for this
vulnerability. Vendor requests KoreLogic delay
public disclosure until the end of June, 2021.
2021.06.08 - KoreLogic and CyberArk meet to discuss the details
of the product release and revisit timeline for
public disclosure. CyberArk informs KoreLogic that
the Linux/Windows version of the Credential
Provider will be released at the end of June, 2021.
A Credential Provider for the zOS platform will be
released at the end of July, 2021. KoreLogic agrees
to delay public disclosure of this and other
reported vulnerabilities until 2021.08.15.
2021.06.23 - CyberArk releases Credential Provider v12.1 for
Linux/Windows platforms.
2021.08.05 - 180 business days have elapsed since the
vulnerability was reported to CyberArk.
2021.08.10 - CyberArk informs KoreLogic that the zOS Credential
Provider update has been released to their
customers. Requests that KoreLogic forgo
publication of the Proof of Concept code as an
unforseen issue prevents some customers from
updating in the near term.
2021.08.27 - KoreLogic suggests delaying the release of the
Proof of Concept until a to-be-determined future
date.
2021.08.30 - CyberArk tenders 2022.01.01 release date for the
Proof of Concept.
2021.09.01 - KoreLogic public disclosure.
7. Proof of Concept
At the vendor's request, KoreLogic has agreed to delay
publication of the Proof of Concept while customers continue
to deploy the updated versions of the product.
The contents of this advisory are copyright(c) 2021
KoreLogic, Inc. and are licensed under a Creative Commons
Attribution Share-Alike 4.0 (United States) License:
http://creativecommons.org/licenses/by-sa/4.0/
KoreLogic, Inc. is a founder-owned and operated company with a
proven track record of providing security services to entities
ranging from Fortune 500 to small and mid-sized companies. We
are a highly skilled team of senior security consultants doing
by-hand security assessments for the most important networks in
the U.S. and around the world. We are also developers of various
tools and resources aimed at helping the security community.
https://www.korelogic.com/about-korelogic.html
Our public vulnerability disclosure policy is available at:
https://korelogic.com/KoreLogic-Public-Vulnerability-Disclosure-Policy.v2.3.txt
-----BEGIN PGP SIGNATURE-----
iQJOBAEBCAA4FiEETtzSIGy8wE6Vn0geUk0uR1lFz/MFAmEvuNEaHGRpc2Nsb3N1
cmVzQGtvcmVsb2dpYy5jb20ACgkQUk0uR1lFz/N9YQ/+Lul27/fuoQB4DYzIRyXn
3XqVVA0wjXSjSt64eYHuOjw5eoUcoboyc0vGDKmu6r6niTPVt5LqPQkncMXYoN2r
JW8f+3+bREkOie3Y+M+VZwOlgphCEyDB1sATTzrzxnRQU/0nZOfD25mzNj3DQesx
zyyeyjAEqcfYYj0djaTs4NIn66gx0mj3CG7k4KPr4omZHvUR2qrJrwFlrTKGMhOc
nsBt7gEp7YxnUb8HbLgR1AM5XJKM7Mz0Lc3D5d3U0yUG6ZZELe/JetpXQbFUJpnz
jG1kAmkjbfu4mfO+3IUGWMInDkp36IyV4aWr1AxBOhWBk0GcA9CMS8pDrrYahoYH
l4DC+vYHaAeviEDlwbR32LwXsX802lGI6rYmyg6+p0iQZIXTwwtA82m4OAnswrCj
tNQPtFKB0YJUe9P32UfztfDH706T9IEozpHe9kgWxbINrxYS7lq/4fxMsS+mfRCR
zYPfGOMOKnoS8W5p+4KFRx4CG0P22ooCp0ofiiKrAlsHfyijJUZWomv0xtfQic98
7670jTOt2yyeDycCnhj1RZukaisZeJeQT0w5PuctC+gAwffGv+o5TWqOeqnACnA3
fhj8+H2MfnKsU8lRUNouhgw4sG68qZpnJpTzLPUwDFCdGrm3/jZK6JXQG/0f7QGi
xaOtX7CJGuOBVwjaVaDzdJU=
=/c+h
-----END PGP SIGNATURE-----

