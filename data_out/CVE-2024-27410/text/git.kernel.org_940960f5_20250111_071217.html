

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=99eb2159680af8786104dac80528acd5acd45980)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=99eb2159680af8786104dac80528acd5acd45980)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=99eb2159680af8786104dac80528acd5acd45980)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=99eb2159680af8786104dac80528acd5acd45980)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Johannes Berg <johannes.berg@intel.com> | 2024-02-14 20:08:35 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-03-06 14:37:49 +0000 |
| commit | [99eb2159680af8786104dac80528acd5acd45980](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=99eb2159680af8786104dac80528acd5acd45980) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=99eb2159680af8786104dac80528acd5acd45980)) | |
| tree | [ef04cbbad1917c289537c92e10902ce205c3597e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=99eb2159680af8786104dac80528acd5acd45980) | |
| parent | [e668b92a3a01429923fd5ca13e99642aab47de69](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e668b92a3a01429923fd5ca13e99642aab47de69) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=99eb2159680af8786104dac80528acd5acd45980&id2=e668b92a3a01429923fd5ca13e99642aab47de69)) | |
| download | [linux-99eb2159680af8786104dac80528acd5acd45980.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-99eb2159680af8786104dac80528acd5acd45980.tar.gz) | |

wifi: nl80211: reject iftype change with mesh ID changecommit f78c1375339a291cba492a70eaf12ec501d28a8e upstream.
It's currently possible to change the mesh ID when the
interface isn't yet in mesh mode, at the same time as
changing it into mesh mode. This leads to an overwrite
of data in the wdev->u union for the interface type it
currently has, causing cfg80211\_change\_iface() to do
wrong things when switching.
We could probably allow setting an interface to mesh
while setting the mesh ID at the same time by doing a
different order of operations here, but realistically
there's no userspace that's going to do this, so just
disallow changes in iftype when setting mesh ID.
Cc: stable@vger.kernel.org
Fixes: 29cbe68c516a ("cfg80211/mac80211: add mesh join/leave commands")
Reported-by: syzbot+dd4779978217b1973180@syzkaller.appspotmail.com
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=99eb2159680af8786104dac80528acd5acd45980)

| -rw-r--r-- | [net/wireless/nl80211.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/wireless/nl80211.c?id=99eb2159680af8786104dac80528acd5acd45980) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 0 deletions

| diff --git a/net/wireless/nl80211.c b/net/wireless/nl80211.cindex 279f4977e2eede..933591f9704b8c 100644--- a/[net/wireless/nl80211.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/wireless/nl80211.c?id=e668b92a3a01429923fd5ca13e99642aab47de69)+++ b/[net/wireless/nl80211.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/wireless/nl80211.c?id=99eb2159680af8786104dac80528acd5acd45980)@@ -3772,6 +3772,8 @@ static int nl80211\_set\_interface(struct sk\_buff \*skb, struct genl\_info \*info)  if (ntype != NL80211\_IFTYPE\_MESH\_POINT) return -EINVAL;+ if (otype != NL80211\_IFTYPE\_MESH\_POINT)+ return -EINVAL; if (netif\_running(dev)) return -EBUSY; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 07:10:54 +0000

