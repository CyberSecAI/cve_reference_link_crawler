
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdbt-labs%2Fdbt-core%2Fcommit%2F87ac4deb00cc9fe334706e42a365903a1d581624)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdbt-labs%2Fdbt-core%2Fcommit%2F87ac4deb00cc9fe334706e42a365903a1d581624)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=dbt-labs%2Fdbt-core)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dbt-labs](/dbt-labs)
/
**[dbt-core](/dbt-labs/dbt-core)**
Public

* [Notifications](/login?return_to=%2Fdbt-labs%2Fdbt-core) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2Fdbt-labs%2Fdbt-core)
* [Star
   10.2k](/login?return_to=%2Fdbt-labs%2Fdbt-core)

* [Code](/dbt-labs/dbt-core)
* [Issues
  526](/dbt-labs/dbt-core/issues)
* [Pull requests
  102](/dbt-labs/dbt-core/pulls)
* [Discussions](/dbt-labs/dbt-core/discussions)
* [Actions](/dbt-labs/dbt-core/actions)
* [Wiki](/dbt-labs/dbt-core/wiki)
* [Security](/dbt-labs/dbt-core/security)
* [Insights](/dbt-labs/dbt-core/pulse)

Additional navigation options

* [Code](/dbt-labs/dbt-core)
* [Issues](/dbt-labs/dbt-core/issues)
* [Pull requests](/dbt-labs/dbt-core/pulls)
* [Discussions](/dbt-labs/dbt-core/discussions)
* [Actions](/dbt-labs/dbt-core/actions)
* [Wiki](/dbt-labs/dbt-core/wiki)
* [Security](/dbt-labs/dbt-core/security)
* [Insights](/dbt-labs/dbt-core/pulse)

## Commit

[Permalink](/dbt-labs/dbt-core/commit/87ac4deb00cc9fe334706e42a365903a1d581624)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[Backport] deprecate materialization overrides from imported packages ([…](https://github.com/dbt-labs/dbt-core/pull/9998)

[Browse files](/dbt-labs/dbt-core/tree/87ac4deb00cc9fe334706e42a365903a1d581624)
Browse the repository at this point in the history

```
[…#9998](https://github.com/dbt-labs/dbt-core/pull/9998))
```

* Loading branch information

[![@MichelleArk](https://avatars.githubusercontent.com/u/9407260?s=40&v=4)](/MichelleArk)

[MichelleArk](/dbt-labs/dbt-core/commits?author=MichelleArk "View all commits by MichelleArk")
authored
Apr 29, 2024

1 parent
[6a54a4c](/dbt-labs/dbt-core/commit/6a54a4c04ba669517f18f2f9d3e6aea1656cba37)

commit 87ac4de

 Show file tree

 Hide file tree

Showing
**38 changed files**
with
**1,779 additions**
and
**1,557 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .changes/unreleased

  + .changes/unreleased/Features-20231218-195854.yaml
    [Features-20231218-195854.yaml](#diff-4a35df33f9c4a8b9c142efef6820f3527e0cec3726f2c758cfa605ddd9a2b50c)
  + .changes/unreleased/Features-20240422-173703.yaml
    [Features-20240422-173703.yaml](#diff-a859b37004f7c5a78d1a108c003c1a2d9736360574bee8d207c25181afc53d57)
  + .changes/unreleased/Under the Hood-20240418-172528.yaml
    [Under the Hood-20240418-172528.yaml](#diff-5e2cf3b0f0521399771285fe188c55228de626c5533e4f06cbaade7e372ea1ec)
* core/dbt

  + cli

    - core/dbt/cli/flags.py
      [flags.py](#diff-3e5c2add494f2ffa25c42dd0ea6ea0d4cc43875474b110506dff44385adb81ac)
  + config

    - core/dbt/config/\_\_init\_\_.py
      [\_\_init\_\_.py](#diff-a2ba8d46e3d69f8874c4c46f0d6a1d413f70879c405f82230e63d7c2bdb255be)
    - core/dbt/config/profile.py
      [profile.py](#diff-5231952f5e1234a0ee90a5f124a45ca1ebb429a9d606c76d01b2a32707d068cc)
    - core/dbt/config/project.py
      [project.py](#diff-8dc87da2257e24092820e0b29ea50eb16f002dd2c30b5879602b9311941858c0)
    - core/dbt/config/runtime.py
      [runtime.py](#diff-7685e44a07e8211f0e710116a07186168af0feb2e466fb46e40504d6b2282ec1)
  + contracts

    - core/dbt/contracts/connection.py
      [connection.py](#diff-b55d5ef96b8e7bb12401faa41c400f3f0ae07420483e3364f395fee85ad0a7d9)
    - graph

      * core/dbt/contracts/graph/manifest.py
        [manifest.py](#diff-1e80746bd25a5ea5ca6604030a2991dfbae0e486f971a6665f2b3a3512f05532)
    - core/dbt/contracts/project.py
      [project.py](#diff-b9f683ce224d6624bcea9a769ca6ad072c9206feb7df48a46340f8148ed87652)
  + core/dbt/deprecations.py
    [deprecations.py](#diff-3277eb602a187d7bfbcb01f646fa8a17697750aa5886869fddaea6c3026f03e1)
  + events

    - core/dbt/events/types.proto
      [types.proto](#diff-b156ebbbf8a9c444e70458528aa309da2229cdf139816385b81a9272399a0b46)
    - core/dbt/events/types.py
      [types.py](#diff-a307286f8c93d8a9dbf3a863a62a6b712921d15f6b4cf9d885b15a45be68f05a)
    - core/dbt/events/types\_pb2.py
      [types\_pb2.py](#diff-ca7bf06d149002b2ab8c076a5cd6c2ed421baa4690078295bf7dd5ec8a3ed0d2)
  + core/dbt/flags.py
    [flags.py](#diff-b99c74c2d09fa1ea054aa843fa3738bd7c9d39acb9c5b90ca920f0e1fcf38010)
  + include/starter\_project

    - core/dbt/include/starter\_project/dbt\_project.yml
      [dbt\_project.yml](#diff-9901b50e28841b4f5b721d454e6440a69976e7c9f4da2e79605f730ad2dc1e02)
  + tests/fixtures

    - core/dbt/tests/fixtures/project.py
      [project.py](#diff-5bab13c218ba16b33ff49936fb3b417cce1da20f705a4010d3e07d566100428c)
  + core/dbt/tracking.py
    [tracking.py](#diff-b67ce24493704fffa7a17d3f9ac9aa6a9928da0faa9c6067678a347d5bbdad91)
  + core/dbt/utils.py
    [utils.py](#diff-3113975fdb70cadc0c7b5f58d67b41fb50b7819a848b8244bb50d32e959d9f7f)
* tests

  + functional

    - basic

      * tests/functional/basic/test\_mixed\_case\_db.py
        [test\_mixed\_case\_db.py](#diff-d89f3f01175d657410596cc97e8a21ac2b68203e279e3a68b29d8889091542d8)
      * tests/functional/basic/test\_project.py
        [test\_project.py](#diff-74a7cf655824c967999890bee179e63b9063ac03ee336bbef0143f10e3ae8721)
    - configs

      * tests/functional/configs/test\_disabled\_configs.py
        [test\_disabled\_configs.py](#diff-48069bf80479bcce7a646cb4bfdb20f580074526a92c1b8a4e821609d26e2ee6)
    - dependencies

      * tests/functional/dependencies/test\_local\_dependency.py
        [test\_local\_dependency.py](#diff-4f5f78d9b3b6f6eda81916de152b5c17b9d1ef14e40b7a2031c4d10f601d6474)
    - deprecations

      * tests/functional/deprecations/test\_deprecations.py
        [test\_deprecations.py](#diff-5986b4f4b57fa3266d0f74f111101d4739fd736c858296b144f346005dfce495)
    - fail\_fast

      * tests/functional/fail\_fast/test\_fail\_fast\_run.py
        [test\_fail\_fast\_run.py](#diff-dc6f658511fecc56ae9215ef69aa07f4943da24dc2ec40b43da1cdda9e14e325)
    - init

      * tests/functional/init/test\_init.py
        [test\_init.py](#diff-e006c8f2447fb1e5cadad42706f6eb63acca642891c2e9749458e2031f35f0e5)
    - materializations

      * tests/functional/materializations/conftest.py
        [conftest.py](#diff-f83b97f48c96f6fe2f605434f413399869881b5c0855918e8b13162eeff90265)
      * tests/functional/materializations/test\_custom\_materialization.py
        [test\_custom\_materialization.py](#diff-f7ef628400f15d5875fd9c736b29e855b4bf942565854434fd14aeee1ee61d5d)
    - metrics

      * tests/functional/metrics/test\_metric\_deferral.py
        [test\_metric\_deferral.py](#diff-4d53d74d2d5e9c61f50d0ecc8e6c5dffea927b8e1f2ea0bd8febebb76ad6cd05)
    - run\_operations

      * tests/functional/run\_operations/test\_run\_operations.py
        [test\_run\_operations.py](#diff-4f01239a19ba49190ed8f12eb1d0df78d89ae89b2145f428615946801b335c43)
  + unit

    - tests/unit/test\_cli\_flags.py
      [test\_cli\_flags.py](#diff-a0d0e2e52e7dc98051466b0fb10fbc6891c2c014c964de159e6c688f76aa376e)
    - tests/unit/test\_config.py
      [test\_config.py](#diff-217a439192bc495c66132a58a1bf7a92ee70f0eb9702c6b00f60644e726479b5)
    - tests/unit/test\_events.py
      [test\_events.py](#diff-018e6871938b17be4afa923d354aad1059ace4f5d0c88eceaa29711e62171289)
    - tests/unit/test\_flags.py
      [test\_flags.py](#diff-99174253f160fb3d1e4ea9c5f35a0b75d53c882cce44284146ba7beea65f7184)
    - tests/unit/test\_graph.py
      [test\_graph.py](#diff-21f7dbaa90f66a1b158cd577efb2282a0e6d1f70ff840e8a0547b3a32f2b0f29)
    - tests/unit/test\_graph\_selection.py
      [test\_graph\_selection.py](#diff-5e7c2fb541bfa11c046974f42f5b09fa6081e0a864a3f9731899d7691fb8eb52)
    - tests/unit/test\_manifest.py
      [test\_manifest.py](#diff-b177cd7874fea9116510fc5a6770c8d26dfe7e7b92b7b529ca89bd588d26a81d)

## There are no files selected for viewing

6 changes: 6 additions & 0 deletions

6
[.changes/unreleased/Features-20231218-195854.yaml](#diff-4a35df33f9c4a8b9c142efef6820f3527e0cec3726f2c758cfa605ddd9a2b50c ".changes/unreleased/Features-20231218-195854.yaml")

Show comments

[View file](/dbt-labs/dbt-core/blob/87ac4deb00cc9fe334706e42a365903a1d581624/.changes/unreleased/Features-20231218-195854.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,6 @@ |
|  |  | kind: Features |
|  |  | body: Move flags from UserConfig in profiles.yml to flags in dbt\_project.yml |
|  |  | time: 2023-12-18T19:58:54.075811-05:00 |
|  |  | custom: |
|  |  | Author: gshank |
|  |  | Issue: "9183" |

6 changes: 6 additions & 0 deletions

6
[.changes/unreleased/Features-20240422-173703.yaml](#diff-a859b37004f7c5a78d1a108c003c1a2d9736360574bee8d207c25181afc53d57 ".changes/unreleased/Features-20240422-173703.yaml")

Show comments

[View file](/dbt-labs/dbt-core/blob/87ac4deb00cc9fe334706e42a365903a1d581624/.changes/unreleased/Features-20240422-173703.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,6 @@ |
|  |  | kind: Features |
|  |  | body: Add require\_explicit\_package\_overrides\_for\_builtin\_materializations to dbt\_project.yml flags, which can be used to opt-out of overriding built-in materializations from packages |
|  |  | time: 2024-04-22T17:37:03.892268-04:00 |
|  |  | custom: |
|  |  | Author: michelleark |
|  |  | Issue: "10007" |

6 changes: 6 additions & 0 deletions

6
[.changes/unreleased/Under the Hood-20240418-172528.yaml](#diff-5e2cf3b0f0521399771285fe188c55228de626c5533e4f06cbaade7e372ea1ec ".changes/unreleased/Under the Hood-20240418-172528.yaml")

Show comments

[View file](/dbt-labs/dbt-core/blob/87ac4deb00cc9fe334706e42a365903a1d581624/.changes/unreleased/Under%20the%20Hood-20240418-172528.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,6 @@ |
|  |  | kind: Under the Hood |
|  |  | body: Raise deprecation warning if installed package overrides built-in materialization |
|  |  | time: 2024-04-18T17:25:28.37886-04:00 |
|  |  | custom: |
|  |  | Author: michelleark |
|  |  | Issue: "9971" |

42 changes: 29 additions & 13 deletions

42
[core/dbt/cli/flags.py](#diff-3e5c2add494f2ffa25c42dd0ea6ea0d4cc43875474b110506dff44385adb81ac "core/dbt/cli/flags.py")

Show comments

[View file](/dbt-labs/dbt-core/blob/87ac4deb00cc9fe334706e42a365903a1d581624/core/dbt/cli/flags.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,6 +3,7 @@ |
|  |  | from dataclasses import dataclass |
|  |  | from importlib import import\_module |
|  |  | from multiprocessing import get\_context |
|  |  | from pathlib import Path |
|  |  | from pprint import pformat as pf |
|  |  | from typing import Any, Callable, Dict, List, Optional, Set, Union |
|  |  |  |
| Expand All | | @@ -11,8 +12,8 @@ |
|  |  | from dbt.cli.exceptions import DbtUsageException |
|  |  | from dbt.cli.resolvers import default\_log\_path, default\_project\_dir |
|  |  | from dbt.cli.types import Command as CliCommand |
|  |  | from dbt.config.profile import read\_user\_config |
|  |  | from dbt.contracts.project import UserConfig |
|  |  | from dbt.config.project import read\_project\_flags |
|  |  | from dbt.contracts.project import ProjectFlags |
|  |  | from dbt.exceptions import DbtInternalError |
|  |  | from dbt.deprecations import renamed\_env\_var |
|  |  | from dbt.helper\_types import WarnErrorOptions |
| Expand All | | @@ -25,7 +26,7 @@ |
|  |  | "INDIRECT\_SELECTION": "eager", |
|  |  | "TARGET\_PATH": None, |
|  |  | "WARN\_ERROR": None, |
|  |  | # Cli args without user\_config or env var option. |
|  |  | # Cli args without project\_flags or env var option. |
|  |  | "FULL\_REFRESH": False, |
|  |  | "STRICT\_MODE": False, |
|  |  | "STORE\_FAILURES": False, |
| Expand Down  Expand Up | | @@ -77,7 +78,7 @@ class Flags: |
|  |  | """Primary configuration artifact for running dbt""" |
|  |  |  |
|  |  | def \_\_init\_\_( |
|  |  | self, ctx: Optional[Context] = None, user\_config: Optional[UserConfig] = None |
|  |  | self, ctx: Optional[Context] = None, project\_flags: Optional[ProjectFlags] = None |
|  |  | ) -> None: |
|  |  | # Set the default flags. |
|  |  | for key, value in FLAGS\_DEFAULTS.items(): |
| Expand Down  Expand Up | | @@ -200,27 +201,40 @@ def \_assign\_params( |
|  |  | invoked\_subcommand\_ctx, params\_assigned\_from\_default, deprecated\_env\_vars |
|  |  | ) |
|  |  |  |
|  |  | if not user\_config: |
|  |  | if not project\_flags: |
|  |  | project\_dir = getattr(self, "PROJECT\_DIR", str(default\_project\_dir())) |
|  |  | profiles\_dir = getattr(self, "PROFILES\_DIR", None) |
|  |  | user\_config = read\_user\_config(profiles\_dir) if profiles\_dir else None |
|  |  | if profiles\_dir and project\_dir: |
|  |  | project\_flags = read\_project\_flags(project\_dir, profiles\_dir) |
|  |  | else: |
|  |  | project\_flags = None |
|  |  |  |
|  |  | # Add entire invocation command to flags |
|  |  | object.\_\_setattr\_\_(self, "INVOCATION\_COMMAND", "dbt " + " ".join(sys.argv[1:])) |
|  |  |  |
|  |  | # Overwrite default assignments with user config if available. |
|  |  | if user\_config: |
|  |  | if project\_flags: |
|  |  | # Overwrite default assignments with project flags if available. |
|  |  | param\_assigned\_from\_default\_copy = params\_assigned\_from\_default.copy() |
|  |  | for param\_assigned\_from\_default in params\_assigned\_from\_default: |
|  |  | user\_config\_param\_value = getattr(user\_config, param\_assigned\_from\_default, None) |
|  |  | if user\_config\_param\_value is not None: |
|  |  | project\_flags\_param\_value = getattr( |
|  |  | project\_flags, param\_assigned\_from\_default, None |
|  |  | ) |
|  |  | if project\_flags\_param\_value is not None: |
|  |  | object.\_\_setattr\_\_( |
|  |  | self, |
|  |  | param\_assigned\_from\_default.upper(), |
|  |  | convert\_config(param\_assigned\_from\_default, user\_config\_param\_value), |
|  |  | convert\_config(param\_assigned\_from\_default, project\_flags\_param\_value), |
|  |  | ) |
|  |  | param\_assigned\_from\_default\_copy.remove(param\_assigned\_from\_default) |
|  |  | params\_assigned\_from\_default = param\_assigned\_from\_default\_copy |
|  |  |  |
|  |  | # Add project-level flags that are not available as CLI options / env vars |
|  |  | for ( |
|  |  | project\_level\_flag\_name, |
|  |  | project\_level\_flag\_value, |
|  |  | ) in project\_flags.project\_only\_flags.items(): |
|  |  | object.\_\_setattr\_\_(self, project\_level\_flag\_name.upper(), project\_level\_flag\_value) |
|  |  |  |
|  |  | # Set hard coded flags. |
|  |  | object.\_\_setattr\_\_(self, "WHICH", invoked\_subcommand\_name or ctx.info\_name) |
|  |  | object.\_\_setattr\_\_(self, "MP\_CONTEXT", get\_context("spawn")) |
| Expand All | | @@ -234,9 +248,11 @@ def \_assign\_params( |
|  |  | # Starting in v1.5, if `log-path` is set in `dbt\_project.yml`, it will raise a deprecation warning, |
|  |  | # with the possibility of removing it in a future release. |
|  |  | if getattr(self, "LOG\_PATH", None) is None: |
|  |  | project\_dir = getattr(self, "PROJECT\_DIR", default\_project\_dir()) |
|  |  | project\_dir = getattr(self, "PROJECT\_DIR", str(default\_project\_dir())) |
|  |  | version\_check = getattr(self, "VERSION\_CHECK", True) |
|  |  | object.\_\_setattr\_\_(self, "LOG\_PATH", default\_log\_path(project\_dir, version\_check)) |
|  |  | object.\_\_setattr\_\_( |
|  |  | self, "LOG\_PATH", default\_log\_path(Path(project\_dir), version\_check) |
|  |  | ) |
|  |  |  |
|  |  | # Support console DO NOT TRACK initiative. |
|  |  | if os.getenv("DO\_NOT\_TRACK", "").lower() in ("1", "t", "true", "y", "yes"): |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[core/dbt/config/\_\_init\_\_.py](#diff-a2ba8d46e3d69f8874c4c46f0d6a1d413f70879c405f82230e63d7c2bdb255be "core/dbt/config/__init__.py")

Show comments

[View file](/dbt-labs/dbt-core/blob/87ac4deb00cc9fe334706e42a365903a1d581624/core/dbt/config/__init__.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,4 @@ |
|  |  | # all these are just exports, they need "noqa" so flake8 will not complain. |
|  |  | from .profile import Profile, read\_user\_config # noqa |
|  |  | from .profile import Profile # noqa |
|  |  | from .project import Project, IsFQNResource, PartialProject # noqa |
|  |  | from .runtime import RuntimeConfig # noqa |

39 changes: 1 addition & 38 deletions

39
[core/dbt/config/profile.py](#diff-5231952f5e1234a0ee90a5f124a45ca1ebb429a9d606c76d01b2a32707d068cc "core/dbt/config/profile.py")

Show comments

[View file](/dbt-labs/dbt-core/blob/87ac4deb00cc9fe334706e42a365903a1d581624/core/dbt/config/profile.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,7 +8,7 @@ |
|  |  | from dbt.clients.system import load\_file\_contents |
|  |  | from dbt.clients.yaml\_helper import load\_yaml\_text |
|  |  | from dbt.contracts.connection import Credentials, HasCredentials |
|  |  | from dbt.contracts.project import ProfileConfig, UserConfig |
|  |  | from dbt.contracts.project import ProfileConfig |
|  |  | from dbt.exceptions import ( |
|  |  | CompilationError, |
|  |  | DbtProfileError, |
| Expand All | | @@ -19,7 +19,6 @@ |
|  |  | ) |
|  |  | from dbt.events.types import MissingProfileTarget |
|  |  | from dbt.events.functions import fire\_event |
|  |  | from dbt.utils import coerce\_dict\_str |
|  |  |  |
|  |  | from .renderer import ProfileRenderer |
|  |  |  |
| Expand Down  Expand Up | | @@ -51,27 +50,13 @@ def read\_profile(profiles\_dir: str) -> Dict[str, Any]: |
|  |  | return {} |
|  |  |  |
|  |  |  |
|  |  | def read\_user\_config(directory: str) -> UserConfig: |
|  |  | try: |
|  |  | profile = read\_profile(directory) |
|  |  | if profile: |
|  |  | user\_config = coerce\_dict\_str(profile.get("config", {})) |
|  |  | if user\_config is not None: |
|  |  | UserConfig.validate(user\_config) |
|  |  | return UserConfig.from\_dict(user\_config) |
|  |  | except (DbtRuntimeError, ValidationError): |
|  |  | pass |
|  |  | return UserConfig() |
|  |  |  |
|  |  |  |
|  |  | # The Profile class is included in RuntimeConfig, so any attribute |
|  |  | # additions must also be set where the RuntimeConfig class is created |
|  |  | # `init=False` is a workaround for https://bugs.python.org/issue45081 |
|  |  | @dataclass(init=False) |
|  |  | class Profile(HasCredentials): |
|  |  | profile\_name: str |
|  |  | target\_name: str |
|  |  | user\_config: UserConfig |
|  |  | threads: int |
|  |  | credentials: Credentials |
|  |  | profile\_env\_vars: Dict[str, Any] |
| Expand All | | @@ -80,7 +65,6 @@ def \_\_init\_\_( |
|  |  | self, |
|  |  | profile\_name: str, |
|  |  | target\_name: str, |
|  |  | user\_config: UserConfig, |
|  |  | threads: int, |
|  |  | credentials: Credentials, |
|  |  | ) -> None: |
| Expand All | | @@ -89,7 +73,6 @@ def \_\_init\_\_( |
|  |  | """ |
|  |  | self.profile\_name = profile\_name |
|  |  | self.target\_name = target\_name |
|  |  | self.user\_config = user\_config |
|  |  | self.threads = threads |
|  |  | self.credentials = credentials |
|  |  | self.profile\_env\_vars = {} # never available on init |
| Expand All | | @@ -106,12 +89,10 @@ def to\_profile\_info(self, serialize\_credentials: bool = False) -> Dict[str, Any] |
|  |  | result = { |
|  |  | "profile\_name": self.profile\_name, |
|  |  | "target\_name": self.target\_name, |
|  |  | "user\_config": self.user\_config, |
|  |  | "threads": self.threads, |
|  |  | "credentials": self.credentials, |
|  |  | } |
|  |  | if serialize\_credentials: |
|  |  | result["user\_config"] = self.user\_config.to\_dict(omit\_none=True) |
|  |  | result["credentials"] = self.credentials.to\_dict(omit\_none=True) |
|  |  | return result |
|  |  |  |
| Expand All | | @@ -124,7 +105,6 @@ def to\_target\_dict(self) -> Dict[str, Any]: |
|  |  | "name": self.target\_name, |
|  |  | "target\_name": self.target\_name, |
|  |  | "profile\_name": self.profile\_name, |
|  |  | "config": self.user\_config.to\_dict(omit\_none=True), |
|  |  | } |
|  |  | ) |
|  |  | return target |
| Expand Down  Expand Up | | @@ -246,7 +226,6 @@ def from\_credentials( |
|  |  | threads: int, |
|  |  | profile\_name: str, |
|  |  | target\_name: str, |
|  |  | user\_config: Optional[Dict[str, Any]] = None, |
|  |  | ) -> "Profile": |
|  |  | """Create a profile from an existing set of Credentials and the |
|  |  | remaining information. |
| Expand All | | @@ -255,20 +234,13 @@ def from\_credentials( |
|  |  | :param threads: The number of threads to use for connections. |
|  |  | :param profile\_name: The profile name used for this profile. |
|  |  | :param target\_name: The target name used for this profile. |
|  |  | :param user\_config: The user-level config block from the |
|  |  | raw profiles, if specified. |
|  |  | :raises DbtProfileError: If the profile is invalid. |
|  |  | :returns: The new Profile object. |
|  |  | """ |
|  |  | if user\_config is None: |
|  |  | user\_config = {} |
|  |  | UserConfig.validate(user\_config) |
|  |  | user\_config\_obj: UserConfig = UserConfig.from\_dict(user\_config) |
|  |  |  |
|  |  | profile = cls( |
|  |  | profile\_name=profile\_name, |
|  |  | target\_name=target\_name, |
|  |  | user\_config=user\_config\_obj, |
|  |  | threads=threads, |
|  |  | credentials=credentials, |
|  |  | ) |
| Expand Down  Expand Up | | @@ -316,7 +288,6 @@ def from\_raw\_profile\_info( |
|  |  | raw\_profile: Dict[str, Any], |
|  |  | profile\_name: str, |
|  |  | renderer: ProfileRenderer, |
|  |  | user\_config: Optional[Dict[str, Any]] = None, |
|  |  | target\_override: Optional[str] = None, |
|  |  | threads\_override: Optional[int] = None, |
|  |  | ) -> "Profile": |
| Expand All | | @@ -328,8 +299,6 @@ def from\_raw\_profile\_info( |
|  |  | disk as yaml and its values rendered with jinja. |
|  |  | :param profile\_name: The profile name used. |
|  |  | :param renderer: The config renderer. |
|  |  | :param user\_config: The global config for the user, if it |
|  |  | was present. |
|  |  | :param target\_override: The target to use, if provided on |
|  |  | the command line. |
|  |  | :param threads\_override: The thread count to use, if |
| Expand All | | @@ -338,9 +307,6 @@ def from\_raw\_profile\_info( |
|  |  | target could not be found |
|  |  | :returns: The new Profile object. |
|  |  | """ |
|  |  | # user\_config is not rendered. |
|  |  | if user\_config is None: |
|  |  | user\_config = raw\_profile.get("config") |
|  |  | # TODO: should it be, and the values coerced to bool? |
|  |  | target\_name, profile\_data = cls.render\_profile( |
|  |  | raw\_profile, profile\_name, target\_override, renderer |
| Expand All | | @@ -361,7 +327,6 @@ def from\_raw\_profile\_info( |
|  |  | profile\_name=profile\_name, |
|  |  | target\_name=target\_name, |
|  |  | threads=threads, |
|  |  | user\_config=user\_config, |
|  |  | ) |
|  |  |  |
|  |  | @classmethod |
| Expand Down  Expand Up | | @@ -396,13 +361,11 @@ def from\_raw\_profiles( |
|  |  | if not raw\_profile: |
|  |  | msg = f"Profile {profile\_name} in profiles.yml is empty" |
|  |  | raise DbtProfileError(INVALID\_PROFILE\_MESSAGE.format(error\_string=msg)) |
|  |  | user\_config = raw\_profiles.get("config") |
|  |  |  |
|  |  | return cls.from\_raw\_profile\_info( |
|  |  | raw\_profile=raw\_profile, |
|  |  | profile\_name=profile\_name, |
|  |  | renderer=renderer, |
|  |  | user\_config=user\_config, |
|  |  | target\_override=target\_override, |
|  |  | threads\_override=threads\_override, |
|  |  | ) |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `87ac4de`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdbt-labs%2Fdbt-core%2Fcommit%2F87ac4deb00cc9fe334706e42a365903a1d581624) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

