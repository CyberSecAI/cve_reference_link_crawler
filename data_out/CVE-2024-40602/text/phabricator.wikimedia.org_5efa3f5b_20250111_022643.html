Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT361451)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T361451
# CVE-2024-40602: Tempo skin: stored XSS via MediaWiki:SidebarClosed, Resolved[Public](/policy/explain/PHID-TASK-u47rpdwovygc4bvkydae/view/)SecurityActions

* [Edit Task](/maniphest/task/edit/361451/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/361451/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-u47rpdwovygc4bvkydae/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-u47rpdwovygc4bvkydae/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-u47rpdwovygc4bvkydae/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-u47rpdwovygc4bvkydae/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-u47rpdwovygc4bvkydae/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-u47rpdwovygc4bvkydae/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-u47rpdwovygc4bvkydae/)
* [Protect as security issue](/wmf/escalate-task/361451/)
* [Award Token](/token/give/PHID-TASK-u47rpdwovygc4bvkydae/)
* [Flag For Later](/flag/edit/PHID-TASK-u47rpdwovygc4bvkydae/)

Assigned To

|  | [ashley](/p/ashley/) |
| --- | --- |

Authored By

|  | [ashley](/p/ashley/) |
| --- | --- |
| Mar 31 2024, 8:08 PM2024-03-31 20:08:14 (UTC+0) |

Tags

* [Security](/tag/security/)
* [Vuln-XSS](/tag/vuln-xss/)
* [Other-skins](/tag/other-skins/) [(Backlog)](/project/board/824/)
* [SecTeam-Processed](/tag/secteam-processed/) [(Completed)](/project/board/5180/)
* [security-bug](/tag/security-bug/)
Referenced FilesNoneSubscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [ashley](/p/ashley/) |
| --- | --- |

|  | [Bawolff](/p/Bawolff/) |
| --- | --- |

|  | [sbassett](/p/sbassett/) |
| --- | --- |

# Description

A continuation of [T361448](/T361448), [T361449](/T361449) & [T361450](/T361450), just for a different skin.

Proposed & tested patch:

```
diff --git a/Tempo.skin.php b/Tempo.skin.php
index fcb1f91..9cb7824 100644
--- a/Tempo.skin.php
+++ b/Tempo.skin.php
@@ -156,7 +156,7 @@ class TempoTemplate extends BaseTemplate {
                                        <div id="sidebar" role="navigation">
                                                <?php
                                                        foreach ( $this->getSidebar() as $boxName => $box ) { ?>
-                                                                               <section id="<?php echo Sanitizer::escapeIdForAttribute( $box['id'] ) ?>"<?php echo Linker::tooltip( $box['id'] ) ?>>
+                                                                               <section id="<?php echo htmlspecialchars( Sanitizer::escapeIdForAttribute( $box['id'] ), ENT_QUOTES ) ?>"<?php echo Linker::tooltip( $box['id'] ) ?>>
                                                                                <div class="top"><h3><?php echo htmlspecialchars( $box['header'] ); ?></h3></div>

                                                                                <?php if ( is_array( $box['content'] ) ) { ?>
```
# Details

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [SECURITY: avoid stored XSS via MediaWiki:Sidebar](https://gerrit.wikimedia.org/r/c/1051776) | [mediawiki/skins/Tempo](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/Tempo) | [REL1\_41](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/Tempo/%2B/REL1_41) | +1 -1 |
|  | [SECURITY: avoid stored XSS via MediaWiki:Sidebar](https://gerrit.wikimedia.org/r/c/1051778) | [mediawiki/skins/Tempo](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/Tempo) | [REL1\_39](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/Tempo/%2B/REL1_39) | +1 -1 |
|  | [SECURITY: avoid stored XSS via MediaWiki:Sidebar](https://gerrit.wikimedia.org/r/c/1051777) | [mediawiki/skins/Tempo](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/Tempo) | [REL1\_40](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/Tempo/%2B/REL1_40) | +1 -1 |
|  | [SECURITY: avoid stored XSS via MediaWiki:Sidebar](https://gerrit.wikimedia.org/r/c/1016852) | [mediawiki/skins/Tempo](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/Tempo) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/Tempo/%2B/master) | +1 -1 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T361451)
# Related Objects

* Mentions

Mentioned In [T361321: Write and send supplementary release announcement for extensions and skins with security patches (1.39.8/1.40.4/1.41.2/1.42.0)](/T361321) Mentioned Here [T361321: Write and send supplementary release announcement for extensions and skins with security patches (1.39.8/1.40.4/1.41.2/1.42.0)](/T361321)
[T361448: CVE-2024-40599: GuMaxDD skin: stored XSS via MediaWiki:Sidebar](/T361448)
[T361449: CVE-2024-40600: Metrolook skin: stored XSS via MediaWiki:Sidebar](/T361449)
[T361450: CVE-2024-40604: Nimbus skin: stored XSS via MediaWiki:Nimbus-sidebar](/T361450)
### Event Timeline

[ashley](/p/ashley/) created this task.[Mar 31 2024, 8:08 PM2024-03-31 20:08:14 (UTC+0)](#9675162)Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  · [View Herald Transcript](/herald/transcript/5856648/)[Mar 31 2024, 8:08 PM2024-03-31 20:08:16 (UTC+0)](#9675176)[ashley](/p/ashley/) claimed this task.[Mar 31 2024, 8:08 PM2024-03-31 20:08:37 (UTC+0)](#9675177)[ashley](/p/ashley/) added projects: [Vuln-XSS](/tag/vuln-xss/), [Other-skins](/tag/other-skins/).[sbassett](/p/sbassett/) mentioned this in [T361321: Write and send supplementary release announcement for extensions and skins with security patches (1.39.8/1.40.4/1.41.2/1.42.0)](/T361321).[Apr 2 2024, 5:56 PM2024-04-02 17:56:48 (UTC+0)](#9681771)[sbassett](/p/sbassett/) subscribed.[Apr 2 2024, 5:59 PM2024-04-02 17:59:05 (UTC+0)](#9681786)Comment Actions

Since this skin isn't deployed or bundled, the proposed patch can go through gerrit at any time. It will be (re)announced via the next supplemental security release: [T361321](/T361321).

[sbassett](/p/sbassett/) edited projects, added [SecTeam-Processed](/tag/secteam-processed/); removed [Security-Team](/tag/security-team/).[Apr 2 2024, 5:59 PM2024-04-02 17:59:31 (UTC+0)](#9681790)[sbassett](/p/sbassett/) added a project: [security-bug](/tag/security-bug/).[Apr 2 2024, 7:00 PM2024-04-02 19:00:23 (UTC+0)](#9681975)[Bawolff](/p/Bawolff/) subscribed.[Apr 3 2024, 9:10 PM2024-04-03 21:10:07 (UTC+0)](#9686150)Comment Actions

lgtm

[ashley](/p/ashley/) closed this task as Resolved.[May 20 2024, 11:33 AM2024-05-20 11:33:31 (UTC+0)](#9812144)Comment Actions

This patch, too, got merged a while ago.

[Reedy](/p/Reedy/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-5rezmqbwrnj7h7f/)" to "Public (No Login Required)".[May 20 2024, 11:33 AM2024-05-20 11:33:46 (UTC+0)](#9812146)[Reedy](/p/Reedy/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-xuan2ntulfaqnhv/)" to "All Users".[gerritbot](/p/gerritbot/) added a comment.[Jul 3 2024, 2:48 PM2024-07-03 14:48:04 (UTC+0)](#9949900)Comment Actions

Change #1051776 had a related patch set uploaded (by Mmartorana; author: Jack Phoenix):

[mediawiki/skins/Tempo@REL1\_41] SECURITY: avoid stored XSS via MediaWiki:Sidebar

<https://gerrit.wikimedia.org/r/1051776>

[gerritbot](/p/gerritbot/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Jul 3 2024, 2:48 PM2024-07-03 14:48:05 (UTC+0)](#9949901)Comment Actions

Change #1051777 had a related patch set uploaded (by Mmartorana; author: Jack Phoenix):

[mediawiki/skins/Tempo@REL1\_40] SECURITY: avoid stored XSS via MediaWiki:Sidebar

<https://gerrit.wikimedia.org/r/1051777>

[gerritbot](/p/gerritbot/) added a comment.[Jul 3 2024, 2:48 PM2024-07-03 14:48:34 (UTC+0)](#9949904)Comment Actions

Change #1051778 had a related patch set uploaded (by Mmartorana; author: Jack Phoenix):

[mediawiki/skins/Tempo@REL1\_39] SECURITY: avoid stored XSS via MediaWiki:Sidebar

<https://gerrit.wikimedia.org/r/1051778>

[gerritbot](/p/gerritbot/) added a comment.[Jul 5 2024, 7:38 PM2024-07-05 19:38:02 (UTC+0)](#9957552)Comment Actions

Change #1051777 **abandoned** by Umherirrender:

[mediawiki/skins/Tempo@REL1\_40] SECURITY: avoid stored XSS via MediaWiki:Sidebar

Reason:

REL1\_40 is end of life

<https://gerrit.wikimedia.org/r/1051777>

[gerritbot](/p/gerritbot/) added a comment.[Jul 5 2024, 7:39 PM2024-07-05 19:39:52 (UTC+0)](#9957557)Comment Actions

Change #1051778 **merged** by jenkins-bot:

[mediawiki/skins/Tempo@REL1\_39] SECURITY: avoid stored XSS via MediaWiki:Sidebar

<https://gerrit.wikimedia.org/r/1051778>

[gerritbot](/p/gerritbot/) added a comment.[Jul 5 2024, 7:40 PM2024-07-05 19:40:20 (UTC+0)](#9957558)Comment Actions

Change #1051776 **merged** by jenkins-bot:

[mediawiki/skins/Tempo@REL1\_41] SECURITY: avoid stored XSS via MediaWiki:Sidebar

<https://gerrit.wikimedia.org/r/1051776>

[mmartorana](/p/mmartorana/) renamed this task from Tempo skin: stored XSS via MediaWiki:Sidebar to CVE-2024-40602: Tempo skin: stored XSS via MediaWiki:Sidebar.[Jul 8 2024, 5:36 PM2024-07-08 17:36:24 (UTC+0)](#9962228)[Maintenance\_bot](/p/Maintenance_bot/) removed a project: [Patch-For-Review](/tag/patch-for-review/).[Jul 9 2024, 7:52 PM2024-07-09 19:52:19 (UTC+0)](#9966884)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)