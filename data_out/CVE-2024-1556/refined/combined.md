=== Content from bugzilla.mozilla.org_d4cdee6a_20250110_125410.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1870414)
* [XML](/show_bug.cgi?ctype=xml&id=1870414)

Closed
[Bug 1870414](/show_bug.cgi?id=1870414)
(CVE-2024-1556)

Opened 1 year ago
Closed 1 year ago

# Potential access beyond bounds caused by InChunkPointer::ShouldPointAtValidBlock()

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Potential access beyond bounds caused by InChunkPointer::ShouldPointAtValidBlock()

## Categories

### (Core :: Gecko Profiler, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Gecko%20Profiler#Gecko%20Profiler)

Gecko Profiler
▾

Core :: Gecko Profiler
The built-in profiler which can be used in order to get profiling information from within Gecko.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Gecko%20Profiler&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Gecko%20Profiler&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Gecko%20Profiler)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 120

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

123 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix) |
| firefox121 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=wontfix) |
| firefox122 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=wontfix) |
| firefox123 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | wontfix |
| firefox-esr128 | --- | --- |
| firefox121 |  | wontfix |
| firefox122 |  | wontfix |
| firefox123 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: mozillabugs, Assigned: canova)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/6ec3894dd8f6c79bebd9110120332aa9?d=mm&size=40)  [canova](/user_profile?user_id=525693)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d5c63f9bd72a6704ada7f9ca71771d8b?d=mm&size=40)  [mozillabugs](/user_profile?user_id=608633)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/6ec3894dd8f6c79bebd9110120332aa9?d=mm&size=40)  [canova](/user_profile?user_id=525693)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

### (Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1753192](/show_bug.cgi?id=1753192 "RESOLVED FIXED - Use a common buffer in both Base and Gecko Profilers")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [adv-main123+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-1556

[Keywords:](/describekeywords.cgi)

[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main123+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c17 "1 year ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | [qe-verify](#a3477209_488993 "1 year ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Bug 1870414 - Check the correct buffer block r?#profiler](/attachment.cgi?id=9369840)  [1 year ago](#c3)  [Nazım Can Altınova [:canova][:canaltinova on phabricator]](/user_profile?user_id=525693)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9369840&action=edit) | [Review](/attachment.cgi?id=9369840) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9380034)  [11 months ago](#c18)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   275 bytes, text/plain |  | [Details](/attachment.cgi?id=9380034&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1870414#c0)• 1 year ago |
|  | |

`InChunkPointer::ShouldPointAtValidBlock()` (`mozglue/baseprofiler/public/ProfileChunkedBufferDetail.h`) contains an invalid check, potentially allowing an access beyond bounds. The bug is at lines 389-90 (FIREFOX\_120\_0\_1\_RELEASE), which check `IsNull()` against `*this`, not against `pointer`.

If untrusted code can determine `entrySize` (line 381), then it might be able to cause an access beyond bounds in code that relies on `ShouldPointAtValidBlock()` to perform the correct check.

```
372:[[nodiscard]] bool ShouldPointAtValidBlock() const {
373:    if (IsNull()) {
374:      // Pointer is null, no blocks here.
375:      MOZ_ASSERT(false, "ShouldPointAtValidBlock - null pointer");
376:      return false;
377:    }
378:    // Use a copy, so we don't modify `*this`.
379:    InChunkPointer pointer = *this;
380:    // Try to read the entry size.
381:    Length entrySize = pointer.ReadEntrySize();
382:    if (entrySize == 0) {
383:      // Entry size of zero means we read 0 or a way-too-big value.
384:      MOZ_ASSERT(false, "ShouldPointAtValidBlock - invalid size");
385:      return false;
386:    }
387:    // See if the last byte of the entry is still inside the buffer.
388:    pointer += entrySize - 1;
389:    MOZ_ASSERT(!IsNull(), "ShouldPointAtValidBlock - past end of buffer");
390:    return !IsNull();
391: }

```
Flags: sec-bounty?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1870414#a231214_406194)• 1 year ago |

Group: core-security → dom-core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1870414#a231234_406194)• 1 year ago |

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1870414#c1)• 1 year ago |
|  | |

Nazım: can you take a look and see what the impact would be?

Flags: needinfo?(canaltinova)

|  | [Nazım Can Altınova [:canova][:canaltinova on phabricator]](/user_profile?user_id=525693)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1870414#c2)• 1 year ago |
|  | |

It looks like a valid bug. I think the impact of it is relatively low, because this code only runs when the profiler is active and running. So it requires users to do extra steps to enable it and run it. But this looks like something we should fix nevertheless.

I'll look into fixing it soon, but I believe most people who can review this are on PTO. I will try to find a person to review but it might wait until the new year until people are back.

Severity: -- → S3Flags: needinfo?(canaltinova)Priority: -- → P1

|  | [Nazım Can Altınova [:canova][:canaltinova on phabricator]](/user_profile?user_id=525693)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1870414#a468911_525693)• 1 year ago |

Assignee: nobody → canaltinovaStatus: NEW → ASSIGNED

|  | [Nazım Can Altınova [:canova][:canaltinova on phabricator]](/user_profile?user_id=525693)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1870414#c3)• 1 year ago |
|  | |

Attached file
[Bug 1870414 - Check the correct buffer block r?#profiler](attachment.cgi?id=9369840)
— [Details](attachment.cgi?id=9369840&action=edit)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1870414#c4)• 1 year ago |
|  | |

I'll mark this sec-moderate, though it might be a little high. I could imagine a web page being able to affect how much stuff the profiler is recording.

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Julien Wajsberg [:julienw]](/user_profile?user_id=364883) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1870414#c5)• 1 year ago |
|  | |

After discussion we thought that it's probably low impact. We think that there are other safeguards than just this code. Proof is that there are debug assertions, which, to me, points to the fact that the original author thought they wouldn't be hit thanks to some other logic. Of course in this case the condition is incorrect, but the *intention* shows that to me.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1870414#a484615_406194)• 1 year ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) → [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Nazım Can Altınova [:canova][:canaltinova on phabricator]](/user_profile?user_id=525693)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1870414#c6)• 1 year ago |
|  | |

Comment on [attachment 9369840](/attachment.cgi?id=9369840 "Bug 1870414 - Check the correct buffer block r?#profiler") [[details]](/attachment.cgi?id=9369840&action=edit "Bug 1870414 - Check the correct buffer block r?#profiler")

[Bug 1870414](/show_bug.cgi?id=1870414 "RESOLVED FIXED - Potential access beyond bounds caused by InChunkPointer::ShouldPointAtValidBlock()") - Check the correct buffer block r?#profiler

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: I think it couldn't be easily constructed. The profiler needs to be active and running. And also we have some more safeguards to make sure that we point out to a valid buffer location. See Julien's message above.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**:
* **If not all supported branches, which bug introduced the flaw?**: [Bug 1753192](/show_bug.cgi?id=1753192 "RESOLVED FIXED - Use a common buffer in both Base and Gecko Profilers")
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: I don't think it will be risky or hard considering that we didn't touch that code a lot.
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely to cause. Did manual testing and it's all good.
* **Is Android affected?**: Yes
[Attachment #9369840](/attachment.cgi?id=9369840&action=edit "Bug 1870414 - Check the correct buffer block r?#profiler") -
Flags: sec-approval?

|  | [Nazım Can Altınova [:canova][:canaltinova on phabricator]](/user_profile?user_id=525693)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1870414#c7)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1870414&comment_id=16722527 "1 revision") |
|  | |

Requesting a sec-approval just in case. Please let me know what you think.

Also, ["Fixing Security Bugs"](https://firefox-source-docs.mozilla.org/bug-mgmt/processes/fixing-security-bugs.html) document mentions that I should remove the bug number from the commit message. Does it apply to sec-low as well?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1870414#c8)• 1 year ago |
|  | |

(In reply to Nazım Can Altınova [:canova][:canaltinova on phabricator] from [comment #7](/show_bug.cgi?id=1870414#c7 "RESOLVED FIXED - Potential access beyond bounds caused by InChunkPointer::ShouldPointAtValidBlock()"))

> Requesting a sec-approval just in case. Please let me know what you think.

You don't need sec-approval except for sec-high and sec-critical bugs that affect more than Nightly.

> Also, ["Fixing Security Bugs"](https://firefox-source-docs.mozilla.org/bug-mgmt/processes/fixing-security-bugs.html) document mentions that I should remove the bug number from the commit message. Does it apply to sec-low as well?

It actually says you should remove everything EXCEPT for the bug number. Please always include the bug number. I think it is better to also include a bit of a description, but nothing beyond what a reasonable person would figure out from looking at the patch.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1870414#c9)• 1 year ago |
|  | |

Comment on [attachment 9369840](/attachment.cgi?id=9369840 "Bug 1870414 - Check the correct buffer block r?#profiler") [[details]](/attachment.cgi?id=9369840&action=edit "Bug 1870414 - Check the correct buffer block r?#profiler")

[Bug 1870414](/show_bug.cgi?id=1870414 "RESOLVED FIXED - Potential access beyond bounds caused by InChunkPointer::ShouldPointAtValidBlock()") - Check the correct buffer block r?#profiler

sec-low and sec-moderate bugs don't need sec-approval.

[Attachment #9369840](/attachment.cgi?id=9369840&action=edit "Bug 1870414 - Check the correct buffer block r?#profiler") -
Flags: sec-approval?

|  | [Nazım Can Altınova [:canova][:canaltinova on phabricator]](/user_profile?user_id=525693)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1870414#c10)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1870414&comment_id=16722617 "1 revision") |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #8](/show_bug.cgi?id=1870414#c8 "RESOLVED FIXED - Potential access beyond bounds caused by InChunkPointer::ShouldPointAtValidBlock()"))

> (In reply to Nazım Can Altınova [:canova][:canaltinova on phabricator] from [comment #7](/show_bug.cgi?id=1870414#c7 "RESOLVED FIXED - Potential access beyond bounds caused by InChunkPointer::ShouldPointAtValidBlock()"))
>
> > Requesting a sec-approval just in case. Please let me know what you think.
>
> You don't need sec-approval except for sec-high and sec-critical bugs that affect more than Nightly.

Ah, thanks. I just wanted to be sure.

> > Also, ["Fixing Security Bugs"](https://firefox-source-docs.mozilla.org/bug-mgmt/processes/fixing-security-bugs.html) document mentions that I should remove the bug number from the commit message. Does it apply to sec-low as well?
>
> It actually says you should remove everything EXCEPT for the bug number. Please always include the bug number. I think it is better to also include a bit of a description, but nothing beyond what a reasonable person would figure out from looking at the patch.

Huh, I think got confused by this sentence: "Definitely don’t include the bug number in the commit message."

It's here: <https://searchfox.org/mozilla-central/rev/8461ad1fc943ac560414322b66de5929ef10f706/docs/bug-mgmt/processes/fixing-security-bugs.rst#117-118>

But I guess that's when you need to obfuscate your code.

Ok, then I will push it like this. Thank you for the answer!

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1870414#c11)• 1 year ago |
|  | |

(In reply to Nazım Can Altınova [:canova][:canaltinova on phabricator] from [comment #10](/show_bug.cgi?id=1870414#c10 "RESOLVED FIXED - Potential access beyond bounds caused by InChunkPointer::ShouldPointAtValidBlock()"))

> Huh, I think got confused by this sentence: "Definitely don’t include the bug number in the commit message."
>
> It's here: <https://searchfox.org/mozilla-central/rev/8461ad1fc943ac560414322b66de5929ef10f706/docs/bug-mgmt/processes/fixing-security-bugs.rst#117-118>
>
> But I guess that's when you need to obfuscate your code.

I think that's mostly about pushing to Try, but I guess the phrasing is a bit convoluted.

|  | [Nazım Can Altınova [:canova][:canaltinova on phabricator]](/user_profile?user_id=525693)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1870414#c12)• 1 year ago |
|  | |

Oh sorry I missed that part. Thanks for clarifying.

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1870414#c13)• 1 year ago |
|  | |

Pushed by canaltinova@gmail.com:
<https://hg.mozilla.org/integration/autoland/rev/14c89fd054c7>
Check the correct buffer block r=profiler-reviewers,julienw

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1870414#c14)• 1 year ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/14c89fd054c7>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 1 year ago
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=wontfix)
[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
--- → [fix-optional](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fix-optional)
[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=fixed)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)Regressed by: [1753192](/show_bug.cgi?id=1753192 "RESOLVED FIXED - Use a common buffer in both Base and Gecko Profilers")Resolution: --- → FIXEDTarget Milestone: --- → 123 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1870414#c15)• 1 year ago |
|  | |

The patch landed in nightly and beta is affected.

:canova, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox122` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(canaltinova)

|  | [Nazım Can Altınova [:canova][:canaltinova on phabricator]](/user_profile?user_id=525693)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1870414#c16)• 1 year ago |
|  | |

I think it's safe enough that it's okay to ride the train.

[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fix-optional) → [wontfix](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=wontfix)Flags: needinfo?(canaltinova)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1870414#c17)• 1 year ago |
|  | |

We are awarding this as a "sec-low" bounty, but we would increase it back to sec-moderate if you can demonstrate a page that can trigger this condition when profiled.

Flags: sec-bounty? → sec-bounty+

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1870414#a3477209_488993)• 1 year ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1870414#a5169579_578488)• 11 months ago |

Whiteboard: [adv-main123+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1870414#c18)• 11 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9380034)
— [Details](attachment.cgi?id=9380034&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1870414#a5333440_578488)• 11 months ago |

Alias: CVE-2024-1556

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1870414#a14406365_5898)• 7 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1870414#a23784332_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1870414&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Nazım Can Altınova [:canova][:canaltinova on phabricator]](/user_profile?user_id=525693)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_34fd28ef_20250110_125411.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-05

## Security Vulnerabilities fixed in Firefox 123

Announced
February 20, 2024
Impact
high
Products
Firefox
Fixed in

* Firefox 123

#### [#CVE-2024-1546: Out-of-bounds memory read in networking channels](#CVE-2024-1546)

Reporter
Alfred Peters
Impact
high
##### Description

When storing and re-accessing data on a networking channel, the length of buffers may have been confused, resulting in an out-of-bounds memory read.

##### References

* [Bug 1843752](https://bugzilla.mozilla.org/show_bug.cgi?id=1843752)

#### [#CVE-2024-1547: Alert dialog could have been spoofed on another site](#CVE-2024-1547)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of API calls and redirects, an attacker-controlled alert dialog could have been displayed on another website (with the victim website's URL shown).

##### References

* [Bug 1877879](https://bugzilla.mozilla.org/show_bug.cgi?id=1877879)

#### [#CVE-2024-1554: fetch could be used to effect cache poisoning](#CVE-2024-1554)

Reporter
scarlet
Impact
moderate
##### Description

The `fetch()` API and navigation incorrectly shared the same cache, as the cache key did not include the optional headers `fetch()` may contain. Under the correct circumstances, an attacker may have been able to poison the local browser cache by priming it with a `fetch()` response controlled by the additional headers. Upon navigation to the same URL, the user would see the cached response instead of the expected response.

##### References

* [Bug 1816390](https://bugzilla.mozilla.org/show_bug.cgi?id=1816390)

#### [#CVE-2024-1548: Fullscreen Notification could have been hidden by select element](#CVE-2024-1548)

Reporter
Hafiizh
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using a dropdown select input element. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1832627](https://bugzilla.mozilla.org/show_bug.cgi?id=1832627)

#### [#CVE-2024-1549: Custom cursor could obscure the permission dialog](#CVE-2024-1549)

Reporter
Hafiizh
Impact
moderate
##### Description

If a website set a large custom cursor, portions of the cursor could have overlapped with the permission dialog, potentially resulting in user confusion and unexpected granted permissions.

##### References

* [Bug 1833814](https://bugzilla.mozilla.org/show_bug.cgi?id=1833814)

#### [#CVE-2024-1550: Mouse cursor re-positioned unexpectedly could have led to unintended permission grants](#CVE-2024-1550)

Reporter
Hafiizh
Impact
moderate
##### Description

A malicious website could have used a combination of exiting fullscreen mode and `requestPointerLock` to cause the user's mouse to be re-positioned unexpectedly, which could have led to user confusion and inadvertently granting permissions they did not intend to grant.

##### References

* [Bug 1860065](https://bugzilla.mozilla.org/show_bug.cgi?id=1860065)

#### [#CVE-2024-1551: Multipart HTTP Responses would accept the Set-Cookie header in response parts](#CVE-2024-1551)

Reporter
Johan Carlsson
Impact
moderate
##### Description

Set-Cookie response headers were being incorrectly honored in multipart HTTP responses. If an attacker could control the Content-Type response header, as well as control part of the response body, they could inject Set-Cookie response headers that would have been honored by the browser.

##### References

* [Bug 1864385](https://bugzilla.mozilla.org/show_bug.cgi?id=1864385)

#### [#CVE-2024-1555: SameSite cookies were not properly respected when opening a website from an external browser](#CVE-2024-1555)

Reporter
Narendra Bhati
Impact
moderate
##### Description

When opening a website using the `firefox://` protocol handler, SameSite cookies were not properly respected.

##### References

* [Bug 1873223](https://bugzilla.mozilla.org/show_bug.cgi?id=1873223)

#### [#CVE-2024-1556: Invalid memory access in the built-in profiler](#CVE-2024-1556)

Reporter
Ronald Crane
Impact
low
##### Description

The incorrect object was checked for NULL in the built-in profiler, potentially leading to invalid memory access and undefined behavior. *Note:* This issue only affects the application when the profiler is running.

##### References

* [Bug 1870414](https://bugzilla.mozilla.org/show_bug.cgi?id=1870414)

#### [#CVE-2024-1552: Incorrect code generation on 32-bit ARM devices](#CVE-2024-1552)

Reporter
Gary Kwong
Impact
low
##### Description

Incorrect code generation could have led to unexpected numeric conversions and potential undefined behavior. *Note:* This issue only affects 32-bit ARM devices.

##### References

* [Bug 1874502](https://bugzilla.mozilla.org/show_bug.cgi?id=1874502)

#### [#CVE-2024-1553: Memory safety bugs fixed in Firefox 123, Firefox ESR 115.8, and Thunderbird 115.8](#CVE-2024-1553)

Reporter
Andrew McCreight, Randell Jesup, Gabriele Svelto, Paul Bone, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 122, Firefox ESR 115.7, and Thunderbird 115.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 123, Firefox ESR 115.8, and Thunderbird 115.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1855686%2C1867982%2C1871498%2C1872296%2C1873521%2C1873577%2C1873597%2C1873866%2C1874080%2C1874740%2C1875795%2C1875906%2C1876425%2C1878211%2C1878286)

#### [#CVE-2024-1557: Memory safety bugs fixed in Firefox 123](#CVE-2024-1557)

Reporter
Andrew McCreight, Randell Jesup, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 122. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 123](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1746471%2C1848829%2C1864011%2C1869175%2C1869455%2C1869938%2C1871606)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


