<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>ZTE Routers HTTPD Vulnerabilities Avisory 2024 - wr3nchsr</title><meta name=Description content="This advisory shows the results of a vulnerability research which was conducted on multiple ZTE router models. As a result of this research 4 vulnerabilities were identified (CVE-2024-45413, CVE-2024-45414, CVE-2024-45415, CVE-2024-45416)."><meta property="og:title" content="ZTE Routers HTTPD Vulnerabilities Avisory 2024"><meta property="og:description" content="This advisory shows the results of a vulnerability research which was conducted on multiple ZTE router models. As a result of this research 4 vulnerabilities were identified (CVE-2024-45413, CVE-2024-45414, CVE-2024-45415, CVE-2024-45416)."><meta property="og:type" content="article"><meta property="og:url" content="https://wr3nchsr.github.io/zte-multiple-routers-httpd-vulnerabilities-advisory/"><meta property="og:image" content="https://wr3nchsr.github.io/images/avatar.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-10T00:00:00+02:00"><meta property="article:modified_time" content="2024-09-10T00:00:00+02:00"><meta property="og:site_name" content="wr3nchsr"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://wr3nchsr.github.io/images/avatar.png"><meta name=twitter:title content="ZTE Routers HTTPD Vulnerabilities Avisory 2024"><meta name=twitter:description content="This advisory shows the results of a vulnerability research which was conducted on multiple ZTE router models. As a result of this research 4 vulnerabilities were identified (CVE-2024-45413, CVE-2024-45414, CVE-2024-45415, CVE-2024-45416)."><meta name=twitter:site content="@wr3nchsr"><meta name=application-name content="wr3nchsr"><meta name=apple-mobile-web-app-title content="wr3nchsr"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#e25555"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico?><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#e25555><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://wr3nchsr.github.io/zte-multiple-routers-httpd-vulnerabilities-advisory/><link rel=prev href=https://wr3nchsr.github.io/cyctf-low-budget-router-trilogy-writeup/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><meta name=google-site-verification content="WapKEVOt_alwvxKMt6VFrx8oiTOEVYLPJrK6s9N8k5M"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"ZTE Routers HTTPD Vulnerabilities Avisory 2024","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/wr3nchsr.github.io\/zte-multiple-routers-httpd-vulnerabilities-advisory\/"},"image":[{"@type":"ImageObject","url":"https:\/\/wr3nchsr.github.io\/images\/avatar.png","width":400,"height":400}],"genre":"posts","wordcount":691,"url":"https:\/\/wr3nchsr.github.io\/zte-multiple-routers-httpd-vulnerabilities-advisory\/","datePublished":"2024-09-10T00:00:00+02:00","dateModified":"2024-09-10T00:00:00+02:00","publisher":{"@type":"Organization","name":"Saif Aziz","logo":{"@type":"ImageObject","url":"https:\/\/wr3nchsr.github.io\/images\/avatar.png","width":400,"height":400}},"author":{"@type":"Person","name":" Saif Aziz"},"description":"This advisory shows the results of a vulnerability research which was conducted on multiple ZTE router models. As a result of this research 4 vulnerabilities were identified (CVE-2024-45413, CVE-2024-45414, CVE-2024-45415, CVE-2024-45416)."}</script></head><body data-header-desktop=normal data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=wr3nchsr><span class=header-title-pre><i class='far fa-face-dizzy fa-fw' aria-hidden=true></i></span>wr3nchsr</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/vulnerabilities/>Vulnerabilities </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=wr3nchsr><span class=header-title-pre><i class='far fa-face-dizzy fa-fw' aria-hidden=true></i></span>wr3nchsr</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/vulnerabilities/ title>Vulnerabilities</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class=single-title>ZTE Routers HTTPD Vulnerabilities Avisory 2024</h1><div class=post-meta><div class=post-meta-line></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime="Sep 10, 2024">Sep 10, 2024</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;691 words&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#summary>Summary</a></li><li><a href=#vulnerabilities>Vulnerabilities</a><ul><li><a href=#stack-based-buffer-overflow-in-check_data_integrity-function>Stack-based Buffer Overflow in check_data_integrity Function</a></li><li><a href=#stack-based-buffer-overflow-in-webprivatedecrypt-function>Stack-based Buffer Overflow in webPrivateDecrypt Function</a></li><li><a href=#stack-based-buffer-overflow-in-rsa_decrypt-function>Stack-based Buffer Overflow in rsa_decrypt Function</a></li><li><a href=#local-file-inclusion>Local File Inclusion</a></li></ul></li><li><a href=#affected-systems>Affected Systems</a></li><li><a href=#disclosure-timeline>Disclosure Timeline</a></li><li><a href=#acknowledgement>Acknowledgement</a></li><li><a href=#disclaimer>Disclaimer</a></li></ul></nav></div></div><div class=content id=content><h2 id=summary>Summary</h2><p>This advisory shows the results of a vulnerability research which was conducted on multiple ZTE router models (<a href=#affected-systems rel>listed below</a>). As a result of this research 4 vulnerabilities were identified (CVE-2024-45413, CVE-2024-45414, CVE-2024-45415, CVE-2024-45416). These vulnerabilities can allow an attacker having access to the HTTP server of the router to gain RCE as root under different conditions.</p><h2 id=vulnerabilities>Vulnerabilities</h2><h3 id=stack-based-buffer-overflow-in-check_data_integrity-function>Stack-based Buffer Overflow in check_data_integrity Function</h3><p><strong>CVE ID</strong>: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-45415" target=_blank rel="noopener noreffer">CVE-2024-45415</a></p><p><strong>CVSS Score</strong>: <a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H&amp;version=3.1" target=_blank rel="noopener noreffer">9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)</a></p><p><strong>Category</strong>: CWE-121: Stack-based Buffer Overflow</p><p>The HTTPD binary in multiple ZTE routers has a stack-based buffer overflow vulnerability in <code>check_data_integrity</code> function. This function is responsible for validating the checksum of data in post request. The checksum is sent encrypted in the request, the function decrypts it and stores the checksum on the stack without validating it. An unauthenticated attacker can get RCE as root by exploiting this vulnerability.</p><h3 id=stack-based-buffer-overflow-in-webprivatedecrypt-function>Stack-based Buffer Overflow in webPrivateDecrypt Function</h3><p><strong>CVE ID</strong>: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-45414" target=_blank rel="noopener noreffer">CVE-2024-45414</a></p><p><strong>CVSS Score</strong>: <a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H&amp;version=3.1" target=_blank rel="noopener noreffer">9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)</a></p><p><strong>Category</strong>: CWE-121: Stack-based Buffer Overflow</p><p>The HTTPD binary in multiple ZTE routers has a stack-based buffer overflow vulnerability in <code>webPrivateDecrypt</code> function. This function is responsible for decrypting RSA encrypted ciphertext, the encrypted data is supplied base64 encoded. The decoded ciphertext is stored on the stack without checking its length. An unauthenticated attacker can get RCE as root by exploiting this vulnerability.</p><h3 id=stack-based-buffer-overflow-in-rsa_decrypt-function>Stack-based Buffer Overflow in rsa_decrypt Function</h3><p><strong>CVE ID</strong>: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-45413" target=_blank rel="noopener noreffer">CVE-2024-45413</a></p><p><strong>CVSS Score</strong>: <a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H&amp;version=3.1" target=_blank rel="noopener noreffer">8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)</a></p><p><strong>Category</strong>: CWE-121: Stack-based Buffer Overflow</p><p>The HTTPD binary in multiple ZTE routers has a stack-based buffer overflow vulnerability in <code>rsa_decrypt</code> function. This function is an API wrapper for LUA to decrypt RSA encrypted ciphertext, the decrypted data is stored on the stack without checking its length. An authenticated attacker can get RCE as root by exploiting this vulnerability.</p><h3 id=local-file-inclusion>Local File Inclusion</h3><p><strong>CVE ID</strong>: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-45416" target=_blank rel="noopener noreffer">CVE-2024-45416</a></p><p><strong>CVSS Score</strong>: <a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H&amp;version=3.1" target=_blank rel="noopener noreffer">8.1 (AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)</a></p><p><strong>Category</strong>: CWE-829: Inclusion of Functionality from Untrusted Control Sphere</p><p>The HTTPD binary in multiple ZTE routers has a local file inclusion vulnerability in <code>session_init</code> function. The session -LUA- files are stored in the directory <code>/var/lua_session</code>, the function iterates on all files in this directory and executes them using the function <code>dofile</code> without any validation if it is a valid session file or not. An attacker who is able to write a malicious file in the sessions directory can get RCE as root.</p><h2 id=affected-systems>Affected Systems</h2><p>These vulnerabilities were discovered/verified on the models and versions listed below. However, they may affect other models and versions. Please refer to ZTE for clarification on vulnerable models and/or versions.</p><table><thead><tr><th>Router Model</th><th>Firmware Version</th><th>Status at Time of Report</th></tr></thead><tbody><tr><td>ZXHN H168A V2.1</td><td>TTN.1T1_211029</td><td>Supported</td></tr><tr><td>ZXHN H168N V3.5</td><td>V3.5.5_CO.1T1</td><td>Supported</td></tr><tr><td>ZXHN H338A V1.5</td><td>V1.5.0_H3A.1T9P1-o</td><td>Supported</td></tr><tr><td>ZXHN E1600 V1.0</td><td>V1.0.0.2B1.1000</td><td>Supported</td></tr><tr><td>ZXHN E2618 V1.0</td><td>V1.0.0.2B4.3000</td><td>Supported</td></tr><tr><td>ZXHN E2603 V1.0</td><td>V1.0.1</td><td>Supported</td></tr><tr><td>ZXHN E2615 V1.0</td><td>V1.0.1</td><td>Supported</td></tr><tr><td>ZXHN H108N V2.6</td><td>V2.6.20.ROST12</td><td>EOS</td></tr><tr><td>ZXHN E500 V1.0</td><td>V1.0.1.1B2.1000</td><td>EOS</td></tr><tr><td>ZXHN Z500 V1.0</td><td>V1.0.1.1B2.1000</td><td>EOS</td></tr></tbody></table><h2 id=disclosure-timeline>Disclosure Timeline</h2><ul><li>Reported to Vendor: February 20, 2024</li><li>Vendor triaged the vulnerabilities: March 03, 2024</li><li>Trivial reward from the vendor: March 11, 2024</li><li>Vendor decide not to fix nor disclose: April 18, 2024</li><li>MITRE assigned CVE IDs: August 29, 2024</li><li>Disclosure: September 10, 2024</li></ul><h2 id=acknowledgement>Acknowledgement</h2><p>Saif Aziz (<a href=http://twitter.com/wr3nchsr target=_blank rel="noopener noreffer">@wr3nchsr</a>) of CyShield</p><h2 id=disclaimer>Disclaimer</h2><p>CYSHIELD FOR TECHNOLOGY S.A.E (CYSHIELD) are keen to share our expertise widely and to enrich public knowledge, through disseminating cyber security culture awareness. CYSHEILD relies on information provided by the vendor / product manufacturer when listing fixed versions, products or releases. CYSHIELD does not verify this contained information, except otherwise when specifically stipulated in the advisory text and contractually required or explicitly agreed in a written form by the vendor / product manufacturer to undertake as such. Unconfirmed vendor / product manufacturer fixes might be ineffective, incomplete, inaccurate or easy to bypass and it is the vendor’s / product manufacturer&rsquo;s liability to ensure all the discovered vulnerabilities found by CYSHIELD are resolved properly. CYSHIELD accepts zero liability, financial or otherwise, from any material and consequential losses, loss of life or reputational loss arising from or as a result of misuse of the information or code contained or mentioned in its advisories. It is the vendor&rsquo;s / product manufacturer’s liability not CYSHIELD to ensure their products&rsquo; security before, during and after release to market.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on Sep 10, 2024</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://wr3nchsr.github.io/zte-multiple-routers-httpd-vulnerabilities-advisory/ data-title="ZTE Routers HTTPD Vulnerabilities Avisory 2024" data-via=wr3nchsr><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://wr3nchsr.github.io/zte-multiple-routers-httpd-vulnerabilities-advisory/><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://wr3nchsr.github.io/zte-multiple-routers-httpd-vulnerabilities-advisory/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/cyctf-low-budget-router-trilogy-writeup/ class=prev rel=prev title="CyCTF 2023 - Low Budget Router Trilogy Writeup"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>CyCTF 2023 - Low Budget Router Trilogy Writeup</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>
2024 • </span>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.114.0">Hugo</a> and <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:100},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-86CNTM5M5F",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-86CNTM5M5F" async></script></body></html>