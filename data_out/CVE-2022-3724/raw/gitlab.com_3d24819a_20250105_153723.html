





<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Crash in USB-HID dissector on Windows (#18384) · Issues · Wireshark Foundation / Wireshark · GitLab</title>
<script nonce="apncnw5T6A9FkOMpqcftMQ==">
//<![CDATA[
window.gon={};gon.math_rendering_limits_enabled=true;gon.features={"preserveMarkdown":true,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":false,"workItemsBeta":false,"workItemsAlpha":false,"workItems":true,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false,"workItemsViewPreference":false,"okrsMvc":false,"workItemEpics":true};gon.licensed_features={"escalationPolicies":true,"okrs":true};gon.abilities={"summarizeComments":false,"measureCommentTemperature":false};
//]]>
</script>


<script nonce="apncnw5T6A9FkOMpqcftMQ==">
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/wireshark/wireshark/-/issues/18384/related_branches":{},"/wireshark/wireshark/-/issues/18384/discussions.json?per_page=20":{},"/wireshark/wireshark/-/issues/18384.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = null;

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"41Y9fkMdWIqtK-zSqFx41QkufCK9YCau0iCC6ylzmcM3EnJweZJRQQYFZZQTsnRwf8BZPvn8EVrSOllDq0Pg5g","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.com/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-9de688b302d723d15d70ba51a5410625092e3bc978dbb160cc523f86c4807968.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-f20ae9b5b8c9a0f793e3ffa2ddc13953bfd683e1d351c8e6cc75e0fcd4ddde90.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-b9f383aefa56f0a72990496e4a4b3aaf2c525843283a1c0c3d85876537187397.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-e25480d2326300d5c49ad31dbd847a53e39fc33a5fd595a961dd7238e411b558.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-7e727ab1e91b421915feadeb04a1b9d57213cb1b2f8f56f4d894b34d6b42e9b3.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-22a76cdd1fe2ae5431b7ff603f86212acaf81b49c4a932f19e3b3222dc1881ee.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-73b9a1c83703ccfccd0e1e418c7d8dc606fcac533fa38b9fa86792f098db0f9a.css" />
<link rel="stylesheet" href="/assets/tailwind-284f33824923c600abd24d7884ff853fd38734b17a1441a1b7e31d4aa365acc2.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" />

<script src="/assets/webpack/runtime.f0860ff2.bundle.js" defer="defer" nonce="apncnw5T6A9FkOMpqcftMQ=="></script>
<script src="/assets/webpack/main.78bd52ff.chunk.js" defer="defer" nonce="apncnw5T6A9FkOMpqcftMQ=="></script>
<script src="/assets/webpack/tracker.868aa839.chunk.js" defer="defer" nonce="apncnw5T6A9FkOMpqcftMQ=="></script>
<script src="/assets/webpack/analytics.cb60a77a.chunk.js" defer="defer" nonce="apncnw5T6A9FkOMpqcftMQ=="></script>
<script nonce="apncnw5T6A9FkOMpqcftMQ==">
//<![CDATA[
window.snowplowOptions = {"namespace":"gl","hostname":"snowplowprd.trx.gitlab.net","cookieDomain":".gitlab.com","appId":"gitlab","formTracking":true,"linkClickTracking":true}

gl = window.gl || {};
gl.snowplowStandardContext = {"schema":"iglu:com.gitlab/gitlab_standard/jsonschema/1-1-1","data":{"environment":"production","source":"gitlab-rails","correlation_id":"01JGVHT7NKEGP8C7FMTYM2FBHS","plan":"opensource","extra":{},"user_id":null,"global_user_id":null,"is_gitlab_team_member":null,"namespace_id":3421856,"project_id":7898047,"feature_enabled_by_namespace_ids":null,"realm":"saas","instance_id":"ea8bf810-1d6f-4a6a-b4fd-93e8cbd8b57f","host_name":"gitlab-webservice-web-757f6ccb78-phzc5","instance_version":"17.8.0","context_generated_at":"2025-01-05T15:37:23.081Z"}}
gl.snowplowPseudonymizedPageUrl = "https://gitlab.com/namespace3421856/project7898047/-/issues/18384";
gl.maskedDefaultReferrerUrl = null;
gl.ga4MeasurementId = 'G-ENFH3X7M5Y';


//]]>
</script>
<link rel="preload" href="/assets/application_utilities-73b9a1c83703ccfccd0e1e418c7d8dc606fcac533fa38b9fa86792f098db0f9a.css" as="style" type="text/css" nonce="2ow6WA2POUh2uMM7As/Ppw==">
<link rel="preload" href="/assets/application-9de688b302d723d15d70ba51a5410625092e3bc978dbb160cc523f86c4807968.css" as="style" type="text/css" nonce="2ow6WA2POUh2uMM7As/Ppw==">
<link rel="preload" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" as="style" type="text/css" nonce="2ow6WA2POUh2uMM7As/Ppw==">
<link crossorigin="" href="https://snowplowprd.trx.gitlab.net" rel="preconnect">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-1e0a5107ea3bbd4be93e8ad2c503467e43166cd37e4293570b490e0812ede98b.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-Italic-38eaf1a569a54ab28c58b92a4a8de3afb96b6ebc250cf372003a7b38151848cc.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-08d2c5e8ff8fd3d2d6ec55bc7713380f8981c35f9d2df14e12b835464d6e8f23.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-Italic-38e58d8df29485a20c550da1d0111e2c2169f6dcbcf894f2cd3afbdd97bcc588.woff2" rel="preload">
<link rel="preload" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" as="style" type="text/css" nonce="2ow6WA2POUh2uMM7As/Ppw==">



<script src="/assets/webpack/sentry.907cf3e4.chunk.js" defer="defer" nonce="apncnw5T6A9FkOMpqcftMQ=="></script>

<script src="/assets/webpack/9.49e5c3e3.chunk.js" defer="defer" nonce="apncnw5T6A9FkOMpqcftMQ=="></script>
<script src="/assets/webpack/11.e2e145a2.chunk.js" defer="defer" nonce="apncnw5T6A9FkOMpqcftMQ=="></script>
<script src="/assets/webpack/13.3d62f21f.chunk.js" defer="defer" nonce="apncnw5T6A9FkOMpqcftMQ=="></script>
<script src="/assets/webpack/commons-pages.groups.analytics.dashboards-pages.groups.harbor.repositories-pages.groups.iteration_ca-b07ae190.ba6536d6.chunk.js" defer="defer" nonce="apncnw5T6A9FkOMpqcftMQ=="></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.3be560a5.chunk.js" defer="defer" nonce="apncnw5T6A9FkOMpqcftMQ=="></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.ca4ee38a.chunk.js" defer="defer" nonce="apncnw5T6A9FkOMpqcftMQ=="></script>
<script src="/assets/webpack/super_sidebar.14e23139.chunk.js" defer="defer" nonce="apncnw5T6A9FkOMpqcftMQ=="></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-bce54798.cf2cb6b5.chunk.js" defer="defer" nonce="apncnw5T6A9FkOMpqcftMQ=="></script>
<script src="/assets/webpack/pages.projects.issues.show.779fd13b.chunk.js" defer="defer" nonce="apncnw5T6A9FkOMpqcftMQ=="></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="Crash in USB-HID dissector on Windows (#18384) · Issues · Wireshark Foundation / Wireshark · GitLab" property="og:title">
<meta content=" Summary When dissecting a PCAP with USB-HID data, a crash can happen if the string &quot;Keyboard 5 and %&quot; is loaded..." property="og:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/7898047/wsicon180.png" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.com/wireshark/wireshark/-/issues/18384" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="Crash in USB-HID dissector on Windows (#18384) · Issues · Wireshark Foundation / Wireshark · GitLab" property="twitter:title">
<meta content=" Summary When dissecting a PCAP with USB-HID data, a crash can happen if the string &quot;Keyboard 5 and %&quot; is loaded..." property="twitter:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/7898047/wsicon180.png" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="myrdyr">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="i0avqLC1dtUxGUek-3cAPfqXMpNZeRON6c_K57fKJWFfAuCmijp_Hpo3zuJAmQyYjHkXjx3lJHnp1RFPNfpcRA" />
<meta name="csp-nonce" content="apncnw5T6A9FkOMpqcftMQ==" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/assets/favicon-72a2cad5025aa931d6ea56c3201d1f18e68a8cd39788c7c80d5b2b82aa5143ef.png" id="favicon" data-original-href="/assets/favicon-72a2cad5025aa931d6ea56c3201d1f18e68a8cd39788c7c80d5b2b82aa5143ef.png" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content=" Summary When dissecting a PCAP with USB-HID data, a crash can happen if the string &quot;Keyboard 5 and %&quot; is loaded..." name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-group="wireshark" data-group-full-path="wireshark" data-namespace-id="3421856" data-page="projects:issues:show" data-page-type-id="18384" data-project="wireshark" data-project-full-path="wireshark/wireshark" data-project-id="7898047">
<script nonce="apncnw5T6A9FkOMpqcftMQ==">
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"epics":"/wireshark/wireshark/-/autocomplete_sources/epics","iterations":"/wireshark/wireshark/-/autocomplete_sources/iterations","vulnerabilities":"/wireshark/wireshark/-/autocomplete_sources/vulnerabilities","members":"/wireshark/wireshark/-/autocomplete_sources/members?type=Issue\u0026type_id=18384","issues":"/wireshark/wireshark/-/autocomplete_sources/issues","mergeRequests":"/wireshark/wireshark/-/autocomplete_sources/merge_requests","labels":"/wireshark/wireshark/-/autocomplete_sources/labels?type=Issue\u0026type_id=18384","milestones":"/wireshark/wireshark/-/autocomplete_sources/milestones","commands":"/wireshark/wireshark/-/autocomplete_sources/commands?type=Issue\u0026type_id=18384","snippets":"/wireshark/wireshark/-/autocomplete_sources/snippets","contacts":"/wireshark/wireshark/-/autocomplete_sources/contacts?type=Issue\u0026type_id=18384","wikis":"/wireshark/wireshark/-/autocomplete_sources/wikis"};


//]]>
</script>
<script nonce="apncnw5T6A9FkOMpqcftMQ==">
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" data-track-label="main_navigation" data-track-action="click_gitlab_logo_link" data-track-property="navigation_top" href="/"><svg aria-hidden="true" role="img" class="tanuki-logo" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path class="tanuki-shape tanuki" d="m24.507 9.5-.034-.09L21.082.562a.896.896 0 0 0-1.694.091l-2.29 7.01H7.825L5.535.653a.898.898 0 0 0-1.694-.09L.451 9.411.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 2.56 1.935 1.554 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#E24329"/>
  <path class="tanuki-shape right-cheek" d="m24.507 9.5-.034-.09a11.44 11.44 0 0 0-4.56 2.051l-7.447 5.632 4.742 3.584 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#FC6D26"/>
  <path class="tanuki-shape chin" d="m7.707 20.677 2.56 1.935 1.555 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935-4.743-3.584-4.755 3.584Z"
        fill="#FCA326"/>
  <path class="tanuki-shape left-cheek" d="M5.01 11.461a11.43 11.43 0 0 0-4.56-2.05L.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 4.745-3.584-7.444-5.632Z"
        fill="#FC6D26"/>
</svg>

</a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item header-logged-out-dropdown md:gl-hidden">
<button class="header-logged-out-toggle" data-toggle="dropdown" type="button">
<span class="gl-sr-only">
Menu
</span>
<svg class="s16" data-testid="hamburger-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#hamburger"></use></svg>
</button>
<div class="dropdown-menu">
<ul>
<li>
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li>
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li>
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li>
<a href="/explore">Explore</a>
</li>
</ul>
</div>
</li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li class="header-logged-out-nav-item gl-hidden gl-inline-block">
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
<li class="header-logged-out-nav-item">
<a class="gl-button btn btn-md btn-confirm !gl-inline-flex" href="/users/sign_up"><span class="gl-button-text">
Get free trial

</span>

</a></li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/wireshark/wireshark/-/files/master?format=json&quot;,&quot;project_blob_url&quot;:&quot;/wireshark/wireshark/-/blob/master&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="true" data-root-path="/" data-sidebar="{&quot;whats_new_most_recent_release_items_count&quot;:6,&quot;whats_new_version_digest&quot;:&quot;c955dbe1b30a1468b032fe6896086eda50f884ff9559d966e5ef75c34eee3ff0&quot;,&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;Wireshark&quot;,&quot;avatar&quot;:&quot;/uploads/-/system/project/avatar/7898047/wsicon180.png&quot;,&quot;entity_id&quot;:7898047,&quot;link&quot;:&quot;/wireshark/wireshark&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/issues&quot;,&quot;pill_count_field&quot;:&quot;openIssuesCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/milestones&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;iterations&quot;,&quot;title&quot;:&quot;Iterations&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/cadences&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_wiki&quot;,&quot;title&quot;:&quot;Wiki&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/wikis/home&quot;,&quot;link_classes&quot;:&quot;shortcuts-wiki&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;requirements&quot;,&quot;title&quot;:&quot;Requirements&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/requirements_management/requirements&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;external_wiki&quot;,&quot;title&quot;:&quot;External wiki&quot;,&quot;link&quot;:&quot;https://wiki.wireshark.org/&quot;,&quot;link_classes&quot;:&quot;shortcuts-external_wiki&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/merge_requests&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;project_merge_request_list&quot;,&quot;title&quot;:&quot;Merge requests&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/merge_requests&quot;,&quot;pill_count_field&quot;:&quot;openMergeRequestsCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-merge_requests&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/tree/master&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/commits/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/network/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/compare?from=master\u0026to=master&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_snippets&quot;,&quot;title&quot;:&quot;Snippets&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/snippets&quot;,&quot;link_classes&quot;:&quot;shortcuts-snippets&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;file_locks&quot;,&quot;title&quot;:&quot;Locked files&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/path_locks&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;test_cases&quot;,&quot;title&quot;:&quot;Test cases&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/quality/test_cases&quot;,&quot;link_classes&quot;:&quot;shortcuts-test-cases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/ml/models&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;operations_menu&quot;,&quot;title&quot;:&quot;Operate&quot;,&quot;icon&quot;:&quot;cloud-pod&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/environments&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;environments&quot;,&quot;title&quot;:&quot;Environments&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/environments&quot;,&quot;link_classes&quot;:&quot;shortcuts-environments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/incidents&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;incidents&quot;,&quot;title&quot;:&quot;Incidents&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/incidents&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;service_desk&quot;,&quot;title&quot;:&quot;Service Desk&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/issues/service_desk&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/graphs/master?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/graphs/master/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;code_review&quot;,&quot;title&quot;:&quot;Code review analytics&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/analytics/code_reviews&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;issues&quot;,&quot;title&quot;:&quot;Issue analytics&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/analytics/issues_analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;insights&quot;,&quot;title&quot;:&quot;Insights&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/insights/&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-insights&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_experiments&quot;,&quot;title&quot;:&quot;Model experiments&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/ml/experiments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:true,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:3421856,&quot;name&quot;:&quot;Wireshark Foundation&quot;,&quot;full_name&quot;:&quot;Wireshark Foundation&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/wireshark/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/wireshark/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:7898047,&quot;name&quot;:&quot;Wireshark&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/wireshark/wireshark/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/wireshark/wireshark/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">






























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Wireshark Foundation","item":"https://gitlab.com/wireshark"},{"@type":"ListItem","position":2,"name":"Wireshark","item":"https://gitlab.com/wireshark/wireshark"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.com/wireshark/wireshark/-/issues"},{"@type":"ListItem","position":4,"name":"#18384","item":"https://gitlab.com/wireshark/wireshark/-/issues/18384"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;Wireshark Foundation&quot;,&quot;href&quot;:&quot;/wireshark&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/group/avatar/3421856/wsicon180.png&quot;},{&quot;text&quot;:&quot;Wireshark&quot;,&quot;href&quot;:&quot;/wireshark/wireshark&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/project/avatar/7898047/wsicon180.png&quot;},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/wireshark/wireshark/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#18384&quot;,&quot;href&quot;:&quot;/wireshark/wireshark/-/issues/18384&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/wireshark/wireshark/-/issues/18384&quot;,&quot;new_issue_path&quot;:&quot;/wireshark/wireshark/-/issues/new?add_related_issue=18384&quot;,&quot;project_path&quot;:&quot;wireshark/wireshark&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:3342881,&quot;reported_from_url&quot;:&quot;https://gitlab.com/wireshark/wireshark/-/issues/18384&quot;,&quot;submit_as_spam_path&quot;:&quot;/wireshark/wireshark/-/issues/18384/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null,&quot;can_promote_to_epic&quot;:&quot;false&quot;}" data-initial="{&quot;endpoint&quot;:&quot;/wireshark/wireshark/-/issues/18384&quot;,&quot;updateEndpoint&quot;:&quot;/wireshark/wireshark/-/issues/18384.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#18384&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/wireshark/wireshark/-/preview_markdown?target_id=18384\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:0,&quot;issuableTemplateNamesPath&quot;:&quot;/wireshark/wireshark/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;Crash in USB-HID dissector on Windows&quot;,&quot;initialTitleText&quot;:&quot;Crash in USB-HID dissector on Windows&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003ch2 data-sourcepos=\&quot;1:1-1:10\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-summary\&quot; class=\&quot;anchor\&quot; href=\&quot;#summary\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSummary\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:1-3:307\&quot; dir=\&quot;auto\&quot;\u003eWhen dissecting a PCAP with USB-HID data, a crash can happen if the string \&quot;Keyboard 5 and %\&quot; is loaded from \u003ccode data-sourcepos=\&quot;3:111-3:200\&quot;\u003ehttps://gitlab.com/wireshark/wireshark/-/blob/master/epan/dissectors/packet-usb-hid.c#L827\u003c/code\u003e. On Windows, the spurious &#39;%&#39; is treated as a format string identifier and crashes further down the line.\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;6:1-6:21\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-steps-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#steps-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSteps to reproduce\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;7:1-7:43\&quot; dir=\&quot;auto\&quot;\u003eUsing version 3.6.8 (64-bit) on Windows 10:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;9:1-9:31\&quot; dir=\&quot;auto\&quot;\u003e\u003ccode data-sourcepos=\&quot;9:2-9:30\&quot;\u003etshark.exe -V -r minimal.pcap\u003c/code\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;11:1-11:2\&quot; dir=\&quot;auto\&quot;\u003eOR\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;13:1-13:28\&quot; dir=\&quot;auto\&quot;\u003e\u003ccode data-sourcepos=\&quot;13:2-13:27\&quot;\u003ewireshark.exe minimal.pcap\u003c/code\u003e\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;16:1-16:36\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-what-is-the-current-bug-behavior\&quot; class=\&quot;anchor\&quot; href=\&quot;#what-is-the-current-bug-behavior\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eWhat is the current bug behavior?\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;18:1-18:189\&quot; dir=\&quot;auto\&quot;\u003eTshark parses the first 5 frames, but crashes silently before finishing to output the 5th frame. Frame 6 doesn&#39;t get printed. Wireshark will crash without any error message or error report.\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;21:1-21:41\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-what-is-the-expected-correct-behavior\&quot; class=\&quot;anchor\&quot; href=\&quot;#what-is-the-expected-correct-behavior\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eWhat is the expected correct behavior?\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;23:1-23:155\&quot; dir=\&quot;auto\&quot;\u003eSome weird, but somewhat valid, dissected USB-HID data. The example is minimized from a much larger file in order to reproduce. Wireshark should not crash.\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;26:1-26:22\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-sample-capture-file\&quot; class=\&quot;anchor\&quot; href=\&quot;#sample-capture-file\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSample capture file\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;28:1-28:12\&quot; dir=\&quot;auto\&quot;\u003eminimal.pcap\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;31:1-31:35\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-relevant-logs-andor-screenshots\&quot; class=\&quot;anchor\&quot; href=\&quot;#relevant-logs-andor-screenshots\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eRelevant logs and/or screenshots\u003c/h2\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;32:1-67:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egdb: unknown target exception 0xc0000409 at 0x7ffeee4a1208\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eThread 1 received signal ?, Unknown signal.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e0x00007ffeee4a1208 in ucrtbase!_invoke_watson () from Windows/System32/ucrtbase.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e(gdb) info stack\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#0  0x00007ffeee4a1208 in ucrtbase!_invoke_watson () from Windows/System32/ucrtbase.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#1  0x00007ffeee4524b1 in ucrtbase!_invalid_parameter_noinfo () from Windows/System32/ucrtbase.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#2  0x00007ffeee452379 in ucrtbase!_invalid_parameter_noinfo () from Windows/System32/ucrtbase.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#3  0x00007ffeee4829fc in ucrtbase!.intrinsic_setjmpex () from Windows/System32/ucrtbase.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#4  0x00007ffeee441b49 in ucrtbase!_wtol () from Windows/System32/ucrtbase.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#5  0x00007ffeee442304 in ucrtbase!_wctomb_s_l () from Windows/System32/ucrtbase.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#6  0x00007ffeee442ed1 in ucrtbase!.stdio_common_vsprintf_s () from Windows/System32/ucrtbase.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#7  0x00007ffee9356c4b in wmem_strdup_vprintf () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwsutil.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#8  0x00007ffee9356bad in wmem_strdup_printf () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwsutil.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#9  0x00007ffe21146d33 in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#10 0x00007ffe211484f2 in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#11 0x00007ffe205d1546 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#12 0x00007ffe205d1771 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#13 0x00007ffe205d4c0d in libwireshark!dissector_try_uint_new () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#14 0x00007ffe211575fe in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#15 0x00007ffe21154b2b in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#16 0x00007ffe21152d89 in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#17 0x00007ffe21151c2d in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#18 0x00007ffe205d1546 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#19 0x00007ffe205d1771 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#20 0x00007ffe205d14b0 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC27\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#21 0x00007ffe20a04d85 in libwireshark!dissect_e212_utf8_imsi () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC28\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#22 0x00007ffe205d1546 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC29\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#23 0x00007ffe205d1771 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC30\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#24 0x00007ffe205d14b0 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC31\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#25 0x00007ffe205d15e7 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC32\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#26 0x00007ffe205d2a23 in libwireshark!deregister_depend_dissector () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC33\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e#27 0x00007ffe205c76e0 in libwireshark!epan_dissect_run_with_taps () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC34\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;69:1-69:20\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-build-information\&quot; class=\&quot;anchor\&quot; href=\&quot;#build-information\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eBuild information\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;71:1-72:64\&quot; dir=\&quot;auto\&quot;\u003eThe crash initially happened on \u003ccode data-sourcepos=\&quot;71:34-71:55\&quot;\u003ev3.6.8-0-gd25900c51508\u003c/code\u003e\u0026#x000A;Backtrace above is from \u003ccode data-sourcepos=\&quot;72:26-72:63\&quot;\u003eVersion 3.6.6 (v3.6.6-0-g7d96674e2a30)\u003c/code\u003e\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;74:1-92:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e3.6.6 (v3.6.6-0-g7d96674e2a30)\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eCompiled (64-bit) using Microsoft Visual Studio 2019 (VC++ 14.31, build 31107),\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ewith Qt 5.15.2, with libpcap, with GLib 2.66.4, with zlib 1.2.11, with Lua\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e5.2.4, with GnuTLS 3.6.3 and PKCS #11 support, with Gcrypt 1.8.3, with MIT\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eKerberos, with MaxMind DB resolver, with nghttp2 1.44.0, with brotli, with LZ4,\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ewith Zstandard, with Snappy, with libxml2 2.9.10, with libsmi 0.4.8, with\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eQtMultimedia, with automatic updates using WinSparkle 0.5.7, with AirPcap, with\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSpeexDSP (using bundled resampler), with Minizip.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRunning on 64-bit Windows 10 (21H2), build 19044, with Intel(R) Core(TM)\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ei7-10750H CPU @ 2.60GHz (with SSE4.2), with 65281 MB of physical memory, with\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGLib 2.66.4, with Qt 5.15.2, without Npcap or WinPcap, with c-ares 1.17.0, with\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGnuTLS 3.6.3, with Gcrypt 1.8.3, with nghttp2 1.44.0, with brotli 1.0.9, with\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eLZ4 1.9.3, with Zstandard 1.4.0, with AirPcap 4.1.0 build 1622, with light\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003edisplay mode, without HiDPI, with LC_TYPE=Norwegian Bokmål_Norway.utf8, binary\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eplugins supported (21 loaded).\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;## Summary\n\nWhen dissecting a PCAP with USB-HID data, a crash can happen if the string \&quot;Keyboard 5 and %\&quot; is loaded from `https://gitlab.com/wireshark/wireshark/-/blob/master/epan/dissectors/packet-usb-hid.c#L827`. On Windows, the spurious &#39;%&#39; is treated as a format string identifier and crashes further down the line.\n\n\n## Steps to reproduce\nUsing version 3.6.8 (64-bit) on Windows 10:\n\n`tshark.exe -V -r minimal.pcap`\n\nOR\n\n`wireshark.exe minimal.pcap`\n\n\n## What is the current bug behavior?\n\nTshark parses the first 5 frames, but crashes silently before finishing to output the 5th frame. Frame 6 doesn&#39;t get printed. Wireshark will crash without any error message or error report.\n\n\n## What is the expected correct behavior?\n\nSome weird, but somewhat valid, dissected USB-HID data. The example is minimized from a much larger file in order to reproduce. Wireshark should not crash.\n\n\n## Sample capture file\n\nminimal.pcap\n\n\n## Relevant logs and/or screenshots\n```\ngdb: unknown target exception 0xc0000409 at 0x7ffeee4a1208\n\nThread 1 received signal ?, Unknown signal.\n0x00007ffeee4a1208 in ucrtbase!_invoke_watson () from Windows/System32/ucrtbase.dll\n(gdb) info stack\n#0  0x00007ffeee4a1208 in ucrtbase!_invoke_watson () from Windows/System32/ucrtbase.dll\n#1  0x00007ffeee4524b1 in ucrtbase!_invalid_parameter_noinfo () from Windows/System32/ucrtbase.dll\n#2  0x00007ffeee452379 in ucrtbase!_invalid_parameter_noinfo () from Windows/System32/ucrtbase.dll\n#3  0x00007ffeee4829fc in ucrtbase!.intrinsic_setjmpex () from Windows/System32/ucrtbase.dll\n#4  0x00007ffeee441b49 in ucrtbase!_wtol () from Windows/System32/ucrtbase.dll\n#5  0x00007ffeee442304 in ucrtbase!_wctomb_s_l () from Windows/System32/ucrtbase.dll\n#6  0x00007ffeee442ed1 in ucrtbase!.stdio_common_vsprintf_s () from Windows/System32/ucrtbase.dll\n#7  0x00007ffee9356c4b in wmem_strdup_vprintf () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwsutil.dll\n#8  0x00007ffee9356bad in wmem_strdup_printf () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwsutil.dll\n#9  0x00007ffe21146d33 in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#10 0x00007ffe211484f2 in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#11 0x00007ffe205d1546 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#12 0x00007ffe205d1771 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#13 0x00007ffe205d4c0d in libwireshark!dissector_try_uint_new () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#14 0x00007ffe211575fe in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#15 0x00007ffe21154b2b in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#16 0x00007ffe21152d89 in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#17 0x00007ffe21151c2d in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#18 0x00007ffe205d1546 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#19 0x00007ffe205d1771 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#20 0x00007ffe205d14b0 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#21 0x00007ffe20a04d85 in libwireshark!dissect_e212_utf8_imsi () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#22 0x00007ffe205d1546 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#23 0x00007ffe205d1771 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#24 0x00007ffe205d14b0 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#25 0x00007ffe205d15e7 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#26 0x00007ffe205d2a23 in libwireshark!deregister_depend_dissector () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#27 0x00007ffe205c76e0 in libwireshark!epan_dissect_run_with_taps () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n\n```\n\n## Build information\n\nThe crash initially happened on `v3.6.8-0-gd25900c51508`\nBacktrace above is from `Version 3.6.6 (v3.6.6-0-g7d96674e2a30)`\n\n```\n3.6.6 (v3.6.6-0-g7d96674e2a30)\n\nCompiled (64-bit) using Microsoft Visual Studio 2019 (VC++ 14.31, build 31107),\nwith Qt 5.15.2, with libpcap, with GLib 2.66.4, with zlib 1.2.11, with Lua\n5.2.4, with GnuTLS 3.6.3 and PKCS #11 support, with Gcrypt 1.8.3, with MIT\nKerberos, with MaxMind DB resolver, with nghttp2 1.44.0, with brotli, with LZ4,\nwith Zstandard, with Snappy, with libxml2 2.9.10, with libsmi 0.4.8, with\nQtMultimedia, with automatic updates using WinSparkle 0.5.7, with AirPcap, with\nSpeexDSP (using bundled resampler), with Minizip.\n\nRunning on 64-bit Windows 10 (21H2), build 19044, with Intel(R) Core(TM)\ni7-10750H CPU @ 2.60GHz (with SSE4.2), with 65281 MB of physical memory, with\nGLib 2.66.4, with Qt 5.15.2, without Npcap or WinPcap, with c-ares 1.17.0, with\nGnuTLS 3.6.3, with Gcrypt 1.8.3, with nghttp2 1.44.0, with brotli 1.0.9, with\nLZ4 1.9.3, with Zstandard 1.4.0, with AirPcap 4.1.0 build 1622, with light\ndisplay mode, without HiDPI, with LC_TYPE=Norwegian Bokmål_Norway.utf8, binary\nplugins supported (21 loaded).\n```&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;wireshark/wireshark&quot;,&quot;iid&quot;:18384,&quot;issuableId&quot;:115852293,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:3342881,&quot;authorName&quot;:&quot;myrdyr&quot;,&quot;authorUsername&quot;:&quot;myrdyr&quot;,&quot;authorWebUrl&quot;:&quot;/myrdyr&quot;,&quot;createdAt&quot;:&quot;2022-09-27T12:46:50+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;publishedIncidentUrl&quot;:null,&quot;slaFeatureAvailable&quot;:&quot;false&quot;,&quot;uploadMetricsFeatureAvailable&quot;:&quot;false&quot;,&quot;projectId&quot;:7898047,&quot;projectPath&quot;:&quot;wireshark&quot;,&quot;projectNamespace&quot;:&quot;wireshark&quot;,&quot;canAdmin&quot;:false,&quot;hasIssueWeightsFeature&quot;:true,&quot;hasIterationsFeature&quot;:true,&quot;canAdminRelation&quot;:false}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">Crash in USB-HID dissector on Windows</h1>
</div>
<div class="description">
<div class="md"><h2 data-sourcepos="1:1-1:10" dir="auto">&#x000A;<a id="user-content-summary" class="anchor" href="#summary" aria-hidden="true"></a>Summary</h2>&#x000A;<p data-sourcepos="3:1-3:307" dir="auto">When dissecting a PCAP with USB-HID data, a crash can happen if the string "Keyboard 5 and %" is loaded from <code data-sourcepos="3:111-3:200">https://gitlab.com/wireshark/wireshark/-/blob/master/epan/dissectors/packet-usb-hid.c#L827</code>. On Windows, the spurious '%' is treated as a format string identifier and crashes further down the line.</p>&#x000A;<h2 data-sourcepos="6:1-6:21" dir="auto">&#x000A;<a id="user-content-steps-to-reproduce" class="anchor" href="#steps-to-reproduce" aria-hidden="true"></a>Steps to reproduce</h2>&#x000A;<p data-sourcepos="7:1-7:43" dir="auto">Using version 3.6.8 (64-bit) on Windows 10:</p>&#x000A;<p data-sourcepos="9:1-9:31" dir="auto"><code data-sourcepos="9:2-9:30">tshark.exe -V -r minimal.pcap</code></p>&#x000A;<p data-sourcepos="11:1-11:2" dir="auto">OR</p>&#x000A;<p data-sourcepos="13:1-13:28" dir="auto"><code data-sourcepos="13:2-13:27">wireshark.exe minimal.pcap</code></p>&#x000A;<h2 data-sourcepos="16:1-16:36" dir="auto">&#x000A;<a id="user-content-what-is-the-current-bug-behavior" class="anchor" href="#what-is-the-current-bug-behavior" aria-hidden="true"></a>What is the current bug behavior?</h2>&#x000A;<p data-sourcepos="18:1-18:189" dir="auto">Tshark parses the first 5 frames, but crashes silently before finishing to output the 5th frame. Frame 6 doesn't get printed. Wireshark will crash without any error message or error report.</p>&#x000A;<h2 data-sourcepos="21:1-21:41" dir="auto">&#x000A;<a id="user-content-what-is-the-expected-correct-behavior" class="anchor" href="#what-is-the-expected-correct-behavior" aria-hidden="true"></a>What is the expected correct behavior?</h2>&#x000A;<p data-sourcepos="23:1-23:155" dir="auto">Some weird, but somewhat valid, dissected USB-HID data. The example is minimized from a much larger file in order to reproduce. Wireshark should not crash.</p>&#x000A;<h2 data-sourcepos="26:1-26:22" dir="auto">&#x000A;<a id="user-content-sample-capture-file" class="anchor" href="#sample-capture-file" aria-hidden="true"></a>Sample capture file</h2>&#x000A;<p data-sourcepos="28:1-28:12" dir="auto">minimal.pcap</p>&#x000A;<h2 data-sourcepos="31:1-31:35" dir="auto">&#x000A;<a id="user-content-relevant-logs-andor-screenshots" class="anchor" href="#relevant-logs-andor-screenshots" aria-hidden="true"></a>Relevant logs and/or screenshots</h2>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="32:1-67:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">gdb: unknown target exception 0xc0000409 at 0x7ffeee4a1208</span>&#x000A;<span id="LC2" class="line" lang="plaintext"></span>&#x000A;<span id="LC3" class="line" lang="plaintext">Thread 1 received signal ?, Unknown signal.</span>&#x000A;<span id="LC4" class="line" lang="plaintext">0x00007ffeee4a1208 in ucrtbase!_invoke_watson () from Windows/System32/ucrtbase.dll</span>&#x000A;<span id="LC5" class="line" lang="plaintext">(gdb) info stack</span>&#x000A;<span id="LC6" class="line" lang="plaintext">#0  0x00007ffeee4a1208 in ucrtbase!_invoke_watson () from Windows/System32/ucrtbase.dll</span>&#x000A;<span id="LC7" class="line" lang="plaintext">#1  0x00007ffeee4524b1 in ucrtbase!_invalid_parameter_noinfo () from Windows/System32/ucrtbase.dll</span>&#x000A;<span id="LC8" class="line" lang="plaintext">#2  0x00007ffeee452379 in ucrtbase!_invalid_parameter_noinfo () from Windows/System32/ucrtbase.dll</span>&#x000A;<span id="LC9" class="line" lang="plaintext">#3  0x00007ffeee4829fc in ucrtbase!.intrinsic_setjmpex () from Windows/System32/ucrtbase.dll</span>&#x000A;<span id="LC10" class="line" lang="plaintext">#4  0x00007ffeee441b49 in ucrtbase!_wtol () from Windows/System32/ucrtbase.dll</span>&#x000A;<span id="LC11" class="line" lang="plaintext">#5  0x00007ffeee442304 in ucrtbase!_wctomb_s_l () from Windows/System32/ucrtbase.dll</span>&#x000A;<span id="LC12" class="line" lang="plaintext">#6  0x00007ffeee442ed1 in ucrtbase!.stdio_common_vsprintf_s () from Windows/System32/ucrtbase.dll</span>&#x000A;<span id="LC13" class="line" lang="plaintext">#7  0x00007ffee9356c4b in wmem_strdup_vprintf () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwsutil.dll</span>&#x000A;<span id="LC14" class="line" lang="plaintext">#8  0x00007ffee9356bad in wmem_strdup_printf () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwsutil.dll</span>&#x000A;<span id="LC15" class="line" lang="plaintext">#9  0x00007ffe21146d33 in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC16" class="line" lang="plaintext">#10 0x00007ffe211484f2 in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC17" class="line" lang="plaintext">#11 0x00007ffe205d1546 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC18" class="line" lang="plaintext">#12 0x00007ffe205d1771 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC19" class="line" lang="plaintext">#13 0x00007ffe205d4c0d in libwireshark!dissector_try_uint_new () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC20" class="line" lang="plaintext">#14 0x00007ffe211575fe in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC21" class="line" lang="plaintext">#15 0x00007ffe21154b2b in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC22" class="line" lang="plaintext">#16 0x00007ffe21152d89 in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC23" class="line" lang="plaintext">#17 0x00007ffe21151c2d in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC24" class="line" lang="plaintext">#18 0x00007ffe205d1546 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC25" class="line" lang="plaintext">#19 0x00007ffe205d1771 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC26" class="line" lang="plaintext">#20 0x00007ffe205d14b0 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC27" class="line" lang="plaintext">#21 0x00007ffe20a04d85 in libwireshark!dissect_e212_utf8_imsi () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC28" class="line" lang="plaintext">#22 0x00007ffe205d1546 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC29" class="line" lang="plaintext">#23 0x00007ffe205d1771 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC30" class="line" lang="plaintext">#24 0x00007ffe205d14b0 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC31" class="line" lang="plaintext">#25 0x00007ffe205d15e7 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC32" class="line" lang="plaintext">#26 0x00007ffe205d2a23 in libwireshark!deregister_depend_dissector () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC33" class="line" lang="plaintext">#27 0x00007ffe205c76e0 in libwireshark!epan_dissect_run_with_taps () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll</span>&#x000A;<span id="LC34" class="line" lang="plaintext"></span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h2 data-sourcepos="69:1-69:20" dir="auto">&#x000A;<a id="user-content-build-information" class="anchor" href="#build-information" aria-hidden="true"></a>Build information</h2>&#x000A;<p data-sourcepos="71:1-72:64" dir="auto">The crash initially happened on <code data-sourcepos="71:34-71:55">v3.6.8-0-gd25900c51508</code>&#x000A;Backtrace above is from <code data-sourcepos="72:26-72:63">Version 3.6.6 (v3.6.6-0-g7d96674e2a30)</code></p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="74:1-92:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">3.6.6 (v3.6.6-0-g7d96674e2a30)</span>&#x000A;<span id="LC2" class="line" lang="plaintext"></span>&#x000A;<span id="LC3" class="line" lang="plaintext">Compiled (64-bit) using Microsoft Visual Studio 2019 (VC++ 14.31, build 31107),</span>&#x000A;<span id="LC4" class="line" lang="plaintext">with Qt 5.15.2, with libpcap, with GLib 2.66.4, with zlib 1.2.11, with Lua</span>&#x000A;<span id="LC5" class="line" lang="plaintext">5.2.4, with GnuTLS 3.6.3 and PKCS #11 support, with Gcrypt 1.8.3, with MIT</span>&#x000A;<span id="LC6" class="line" lang="plaintext">Kerberos, with MaxMind DB resolver, with nghttp2 1.44.0, with brotli, with LZ4,</span>&#x000A;<span id="LC7" class="line" lang="plaintext">with Zstandard, with Snappy, with libxml2 2.9.10, with libsmi 0.4.8, with</span>&#x000A;<span id="LC8" class="line" lang="plaintext">QtMultimedia, with automatic updates using WinSparkle 0.5.7, with AirPcap, with</span>&#x000A;<span id="LC9" class="line" lang="plaintext">SpeexDSP (using bundled resampler), with Minizip.</span>&#x000A;<span id="LC10" class="line" lang="plaintext"></span>&#x000A;<span id="LC11" class="line" lang="plaintext">Running on 64-bit Windows 10 (21H2), build 19044, with Intel(R) Core(TM)</span>&#x000A;<span id="LC12" class="line" lang="plaintext">i7-10750H CPU @ 2.60GHz (with SSE4.2), with 65281 MB of physical memory, with</span>&#x000A;<span id="LC13" class="line" lang="plaintext">GLib 2.66.4, with Qt 5.15.2, without Npcap or WinPcap, with c-ares 1.17.0, with</span>&#x000A;<span id="LC14" class="line" lang="plaintext">GnuTLS 3.6.3, with Gcrypt 1.8.3, with nghttp2 1.44.0, with brotli 1.0.9, with</span>&#x000A;<span id="LC15" class="line" lang="plaintext">LZ4 1.9.3, with Zstandard 1.4.0, with AirPcap 4.1.0 build 1622, with light</span>&#x000A;<span id="LC16" class="line" lang="plaintext">display mode, without HiDPI, with LC_TYPE=Norwegian Bokmål_Norway.utf8, binary</span>&#x000A;<span id="LC17" class="line" lang="plaintext">plugins supported (21 loaded).</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div></div>
</div>

</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/7898047/issues/18384/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="gl-border-solid gl-border-1 gl-border-default gl-rounded-base gl-mt-5 gl-p-3 gl-text-center">
To upload designs, you'll need to enable LFS and have an admin enable hashed storage. <a href="/help/user/project/issues/design_management.md#prerequisites" target="_blank" rel="noopener noreferrer">More information</a>
</div>

<div class="js-work-item-links-root" data-full-path="wireshark/wireshark" data-issuable-id="115852293" data-issuable-iid="18384" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/wireshark/-/epics" data-wi-full-path="wireshark/wireshark" data-wi-group-id="3421856" data-wi-group-issues-path="/groups/wireshark/-/issues" data-wi-group-path="wireshark" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/wireshark/wireshark/-/issues" data-wi-labels-fetch-path="/groups/wireshark/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/wireshark/wireshark/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=3421856" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/wireshark/wireshark/-/issues/18384/links" data-full-path="wireshark/wireshark" data-has-issue-weights-feature="true" data-has-iterations-feature="true" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="true" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/wireshark/-/epics" data-wi-full-path="wireshark/wireshark" data-wi-group-id="3421856" data-wi-group-issues-path="/groups/wireshark/-/issues" data-wi-group-path="wireshark" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/wireshark/wireshark/-/issues" data-wi-labels-fetch-path="/groups/wireshark/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/wireshark/wireshark/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=3421856" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="true" data-iid="18384" data-project-path="wireshark/wireshark" id="js-related-merge-requests"></div>
<div data-url="/wireshark/wireshark/-/issues/18384/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:115852293,&quot;iid&quot;:18384,&quot;description&quot;:&quot;## Summary\n\nWhen dissecting a PCAP with USB-HID data, a crash can happen if the string \&quot;Keyboard 5 and %\&quot; is loaded from `https://gitlab.com/wireshark/wireshark/-/blob/master/epan/dissectors/packet-usb-hid.c#L827`. On Windows, the spurious &#39;%&#39; is treated as a format string identifier and crashes further down the line.\n\n\n## Steps to reproduce\nUsing version 3.6.8 (64-bit) on Windows 10:\n\n`tshark.exe -V -r minimal.pcap`\n\nOR\n\n`wireshark.exe minimal.pcap`\n\n\n## What is the current bug behavior?\n\nTshark parses the first 5 frames, but crashes silently before finishing to output the 5th frame. Frame 6 doesn&#39;t get printed. Wireshark will crash without any error message or error report.\n\n\n## What is the expected correct behavior?\n\nSome weird, but somewhat valid, dissected USB-HID data. The example is minimized from a much larger file in order to reproduce. Wireshark should not crash.\n\n\n## Sample capture file\n\nminimal.pcap\n\n\n## Relevant logs and/or screenshots\n```\ngdb: unknown target exception 0xc0000409 at 0x7ffeee4a1208\n\nThread 1 received signal ?, Unknown signal.\n0x00007ffeee4a1208 in ucrtbase!_invoke_watson () from Windows/System32/ucrtbase.dll\n(gdb) info stack\n#0  0x00007ffeee4a1208 in ucrtbase!_invoke_watson () from Windows/System32/ucrtbase.dll\n#1  0x00007ffeee4524b1 in ucrtbase!_invalid_parameter_noinfo () from Windows/System32/ucrtbase.dll\n#2  0x00007ffeee452379 in ucrtbase!_invalid_parameter_noinfo () from Windows/System32/ucrtbase.dll\n#3  0x00007ffeee4829fc in ucrtbase!.intrinsic_setjmpex () from Windows/System32/ucrtbase.dll\n#4  0x00007ffeee441b49 in ucrtbase!_wtol () from Windows/System32/ucrtbase.dll\n#5  0x00007ffeee442304 in ucrtbase!_wctomb_s_l () from Windows/System32/ucrtbase.dll\n#6  0x00007ffeee442ed1 in ucrtbase!.stdio_common_vsprintf_s () from Windows/System32/ucrtbase.dll\n#7  0x00007ffee9356c4b in wmem_strdup_vprintf () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwsutil.dll\n#8  0x00007ffee9356bad in wmem_strdup_printf () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwsutil.dll\n#9  0x00007ffe21146d33 in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#10 0x00007ffe211484f2 in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#11 0x00007ffe205d1546 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#12 0x00007ffe205d1771 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#13 0x00007ffe205d4c0d in libwireshark!dissector_try_uint_new () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#14 0x00007ffe211575fe in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#15 0x00007ffe21154b2b in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#16 0x00007ffe21152d89 in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#17 0x00007ffe21151c2d in udp_dissect_pdus () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#18 0x00007ffe205d1546 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#19 0x00007ffe205d1771 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#20 0x00007ffe205d14b0 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#21 0x00007ffe20a04d85 in libwireshark!dissect_e212_utf8_imsi () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#22 0x00007ffe205d1546 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#23 0x00007ffe205d1771 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#24 0x00007ffe205d14b0 in libwireshark!call_dissector_only () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#25 0x00007ffe205d15e7 in libwireshark!call_dissector_with_data () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#26 0x00007ffe205d2a23 in libwireshark!deregister_depend_dissector () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n#27 0x00007ffe205c76e0 in libwireshark!epan_dissect_run_with_taps () from Users/user/Downloads/WiresharkPortable64/App/Wireshark/libwireshark.dll\n\n```\n\n## Build information\n\nThe crash initially happened on `v3.6.8-0-gd25900c51508`\nBacktrace above is from `Version 3.6.6 (v3.6.6-0-g7d96674e2a30)`\n\n```\n3.6.6 (v3.6.6-0-g7d96674e2a30)\n\nCompiled (64-bit) using Microsoft Visual Studio 2019 (VC++ 14.31, build 31107),\nwith Qt 5.15.2, with libpcap, with GLib 2.66.4, with zlib 1.2.11, with Lua\n5.2.4, with GnuTLS 3.6.3 and PKCS #11 support, with Gcrypt 1.8.3, with MIT\nKerberos, with MaxMind DB resolver, with nghttp2 1.44.0, with brotli, with LZ4,\nwith Zstandard, with Snappy, with libxml2 2.9.10, with libsmi 0.4.8, with\nQtMultimedia, with automatic updates using WinSparkle 0.5.7, with AirPcap, with\nSpeexDSP (using bundled resampler), with Minizip.\n\nRunning on 64-bit Windows 10 (21H2), build 19044, with Intel(R) Core(TM)\ni7-10750H CPU @ 2.60GHz (with SSE4.2), with 65281 MB of physical memory, with\nGLib 2.66.4, with Qt 5.15.2, without Npcap or WinPcap, with c-ares 1.17.0, with\nGnuTLS 3.6.3, with Gcrypt 1.8.3, with nghttp2 1.44.0, with brotli 1.0.9, with\nLZ4 1.9.3, with Zstandard 1.4.0, with AirPcap 4.1.0 build 1622, with light\ndisplay mode, without HiDPI, with LC_TYPE=Norwegian Bokmål_Norway.utf8, binary\nplugins supported (21 loaded).\n```&quot;,&quot;title&quot;:&quot;Crash in USB-HID dissector on Windows&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:null,&quot;updated_by_id&quot;:860017,&quot;created_at&quot;:&quot;2022-09-27T12:46:50Z&quot;,&quot;updated_at&quot;:&quot;2022-10-27T16:11:05Z&quot;,&quot;milestone&quot;:null,&quot;labels&quot;:[],&quot;lock_version&quot;:0,&quot;author_id&quot;:3342881,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[],&quot;due_date&quot;:null,&quot;project_id&quot;:7898047,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/wireshark/wireshark/-/issues/18384&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/wireshark/wireshark/notes?target_id=115852293\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/wireshark/wireshark/-/preview_markdown?target_id=18384\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;,&quot;weight&quot;:null,&quot;blocked&quot;:false,&quot;blocked_by_issues&quot;:[]}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:115852293,&quot;projectId&quot;:7898047,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/wireshark/wireshark/-/issues/18384/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/wireshark/wireshark/-/issues/18384.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/wireshark/wireshark/-/issues/18384.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/wireshark/wireshark/noteable/issue/115852293/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736091443000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-border-0" type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/wireshark/wireshark/-/issues/18384.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="200">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>
<div class="block epic" data-testid="sidebar-epic">
<div class="js-sidebar-epic-widget-root" data-can-edit="false" data-group-path="wireshark" data-issue-id="115852293" data-issue-iid="18384" data-project-path="wireshark/wireshark"></div>
</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="true" data-can-edit="" data-iid="18384" data-issuable-type="issue" data-labels-fetch-path="/wireshark/wireshark/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/wireshark/wireshark/-/labels" data-project-issues-path="/wireshark/wireshark/-/issues" data-project-path="wireshark/wireshark" data-selected-labels="[]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="18384" data-project-path="wireshark/wireshark"></div>
</div>
<div class="block" data-testid="iteration-container"><div class="js-sidebar-iteration-widget-root" data-can-edit="" data-group-path="wireshark" data-issue-id="115852293" data-issue-iid="18384" data-project-path="wireshark/wireshark"></div>
</div>
<div class="js-sidebar-weight-widget-root" data-can-edit="" data-issue-iid="18384" data-project-path="wireshark/wireshark"></div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<div class="js-sidebar-health-status-widget-root" data-can-edit="" data-full-path="wireshark/wireshark" data-iid="18384" data-issuable-type="issue"></div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="block">
<div class="hide-collapsed gl-flex gl-items-center gl-font-bold gl-leading-20 gl-text-default">
Confidentiality
</div>
<div class="hide-collapsed gl-text-subtle">
Confidentiality controls have moved to the issue actions menu (<svg class="s12 gl-align-middle" data-testid="ellipsis_v-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#ellipsis_v"></use></svg>) at the top of the page.
</div>
</div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/wireshark/wireshark/-/issues/18384.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/wireshark/wireshark/-/issues/18384/toggle_subscription","moveIssueEndpoint":"/wireshark/wireshark/-/issues/18384/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=7898047","editable":"","currentUser":{},"rootPath":"/","fullPath":"wireshark/wireshark","iid":18384,"id":115852293,"severity":"unknown","timeTrackingLimitToHours":true,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false","weightOptions":["None","Any",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"weightNoneValue":"None","multipleApprovalRulesAvailable":null}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script nonce="apncnw5T6A9FkOMpqcftMQ==">
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script nonce="apncnw5T6A9FkOMpqcftMQ==">
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

