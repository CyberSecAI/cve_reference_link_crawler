```
{
  "vulnerability_details": {
    "Root cause": "An Access Point (AP) is permanently advertising an extended channel switch announcement (ECSA) in its probe response, even with quiet time, which prevents clients from connecting. The Linux kernel's cfg80211 module was previously updated to prevent connections to APs during a channel switch process, but this update inadvertently blocked connections to APs with this stuck ECSA element.",
    "Weaknesses": [
      "The cfg80211 module was not correctly handling APs that persistently advertise an ECSA in their probe response.",
      "Lack of validation to identify a stuck ECSA element causing connection issues."
    ],
    "Impact": "Clients cannot connect to the affected AP, causing connection failures and disrupting network service.",
    "Attack vectors": "The vulnerability is triggered by an AP misbehaving by sending a stuck ECSA, specifically the Asus RT-AC53 router with firmware version 3.0.0.4.380_10760-g21a5898.",
    "Required attacker capabilities": "An attacker would need to operate a malfunctioning AP that sends a stuck ECSA element in its probe responses. The attacker does not need to actively exploit the vulnerability, the malfunctioning AP is enough to cause the denial of service."
  },
  "Additional Details": "The patch adds a mechanism to detect a stuck ECSA element in the probe response. It does this by comparing the ECSA in probe responses over time. If the channel switch is the same and the mode is not 0, the proberesp_ecsa_stuck flag will be set. This allows the mac80211 layer to handle this situation."
}
```