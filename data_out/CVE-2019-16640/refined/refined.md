- **Root cause of vulnerability**: The `upload.php` file on the Ruijie EG-2000 series gateway mishandles parameters passed to the `UploadFile` class. Specifically, it does not properly check for `%00` and `/var/./html` path manipulations.
- **Weaknesses/vulnerabilities present**: Unrestricted file upload vulnerability due to insufficient input validation. Specifically, the application does not sanitize the `filedir` parameter, allowing an attacker to control the upload path and filename using `file` parameter in combination with path traversal such as `/var/./html/`.
- **Impact of exploitation**: An attacker can upload arbitrary files, including executable code like PHP scripts, to the gateway's web server. This can lead to remote code execution, full compromise of the device, and potentially other network attacks.
- **Attack vectors**: The vulnerability is exploited through a POST request to `upload.php`, with specific parameters including `c=upload`, `a=index`, `fileext=txt`, `filedir=%2Fvar%2Fhtml`, and `obj=1`. The file to be uploaded is included in the multipart/form-data.
- **Required attacker capabilities/position**: The attacker needs to have network access to the web interface of the Ruijie EG-2000 gateway. No authentication is explicitly mentioned as a requirement.