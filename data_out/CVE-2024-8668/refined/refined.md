Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from a lack of proper sanitization and output escaping in the `woolentor-widgets-active.js` file, specifically within the tooltip and countdown functionalities. This allows for the injection of malicious scripts through user-controlled data, such as the `customlavel` and `tipText` variables.

**Weaknesses/Vulnerabilities:**

*   **DOM-Based Stored Cross-Site Scripting (XSS):** The core vulnerability is DOM-based XSS. Malicious scripts are injected into the website's pages and are executed when a user interacts with the vulnerable components, like the tooltip or countdown timer.
*   **Insufficient Input Sanitization:** User-provided data, such as  `customlavel` and `tipText`, is not properly sanitized before being used in the dynamic generation of HTML. This means that if these parameters contain malicious script, they will be included into the DOM.
*   **Lack of Output Escaping:** The output of the unsanitized input is not properly escaped when being output to the page, allowing the malicious scripts to be rendered and executed in the user's browser.

**Impact of Exploitation:**

*   **Arbitrary Script Execution:** Successful exploitation allows an attacker to inject and execute arbitrary JavaScript code in the victim's browser whenever the injected page is accessed.
*   **Account Takeover:** This vulnerability could be used to steal user session cookies, potentially leading to account takeover.
*   **Malware Distribution:** Attackers could use this vulnerability to redirect users to malicious websites, install malware, or conduct other malicious activities.
*   **Website Defacement:** It can also lead to modification or defacement of website content.

**Attack Vectors:**

*   The vulnerability can be exploited via the tooltip and countdown components.
*   The attacker crafts malicious JavaScript payload as part of the data provided to either component.

**Required Attacker Capabilities/Position:**

*   **Authentication:** The attacker needs to be an authenticated user with at least contributor-level access to inject the malicious scripts in the website. This access level allows users to add or modify content where the plugin's shortcodes or blocks can be utilized.
*   **Knowledge of Vulnerable Parameters:** The attacker should be aware of the vulnerable parameters used by tooltip (`tipText`) and countdown (`customlavel`) functionalities.
*   **Ability to Inject Malicious Input:** The attacker needs to inject crafted malicious payload in the `tipText` attribute or countdown  `customlavel` options.

**Additional Details**
* The vulnerability was fixed by implementing proper sanitization and escaping function `woolentorSanitizeHTML` and `woolentorSanitizeObject`.
* Patched in version 2.9.8.
* The fix includes also sanitization of slider settings.