=== Content from github.com_c4abec5a_20250108_121143.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fparse-community%2Fparse-server%2Fpull%2F8054)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fparse-community%2Fparse-server%2Fpull%2F8054)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=parse-community%2Fparse-server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[parse-community](/parse-community)
/
**[parse-server](/parse-community/parse-server)**
Public

* [Notifications](/login?return_to=%2Fparse-community%2Fparse-server) You must be signed in to change notification settings
* [Fork
  4.8k](/login?return_to=%2Fparse-community%2Fparse-server)
* [Star
   21k](/login?return_to=%2Fparse-community%2Fparse-server)

* [Code](/parse-community/parse-server)
* [Issues
  374](/parse-community/parse-server/issues)
* [Pull requests
  92](/parse-community/parse-server/pulls)
* [Actions](/parse-community/parse-server/actions)
* [Projects
  0](/parse-community/parse-server/projects)
* [Wiki](/parse-community/parse-server/wiki)
* [Security](/parse-community/parse-server/security)
* [Insights](/parse-community/parse-server/pulse)

Additional navigation options

* [Code](/parse-community/parse-server)
* [Issues](/parse-community/parse-server/issues)
* [Pull requests](/parse-community/parse-server/pulls)
* [Actions](/parse-community/parse-server/actions)
* [Projects](/parse-community/parse-server/projects)
* [Wiki](/parse-community/parse-server/wiki)
* [Security](/parse-community/parse-server/security)
* [Insights](/parse-community/parse-server/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fparse-community%2Fparse-server%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fparse-community%2Fparse-server%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# fix: certificate in Apple Game Center auth adapter not validated #8054

 Merged

[mtrezza](/mtrezza)
merged 4 commits into
[parse-community:release](/parse-community/parse-server/tree/release "parse-community/parse-server:release")
from
[mtrezza:fix-gca-release](/mtrezza/parse-server/tree/fix-gca-release "mtrezza/parse-server:fix-gca-release")

Jun 17, 2022

 Merged

# [fix: certificate in Apple Game Center auth adapter not validated](#top) #8054

[mtrezza](/mtrezza)
merged 4 commits into
[parse-community:release](/parse-community/parse-server/tree/release "parse-community/parse-server:release")
from
[mtrezza:fix-gca-release](/mtrezza/parse-server/tree/fix-gca-release "mtrezza/parse-server:fix-gca-release")

Jun 17, 2022

[Conversation
3](/parse-community/parse-server/pull/8054)
[Commits
4](/parse-community/parse-server/pull/8054/commits)
[Checks
0](/parse-community/parse-server/pull/8054/checks)
[Files changed](/parse-community/parse-server/pull/8054/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![mtrezza](https://avatars.githubusercontent.com/u/5673677?s=60&v=4)](/mtrezza)

Copy link

Member

### @mtrezza **[mtrezza](/mtrezza)** commented [Jun 17, 2022](#issue-1275201335) ‚Ä¢ edited Loading

Fixes [GHSA-rh9j-f5f8-rvgc](https://github.com/parse-community/parse-server/security/advisories/GHSA-rh9j-f5f8-rvgc "GHSA-rh9j-f5f8-rvgc")

Sorry, something went wrong.

All reactions

 [mtrezza](/mtrezza)
added 4 commits
[June 17, 2022 14:45](#commits-pushed-b75eb7a)

[![@mtrezza](https://avatars.githubusercontent.com/u/5673677?s=40&v=4)](/mtrezza)

`[fix ci](/parse-community/parse-server/pull/8054/commits/b75eb7a63cf0b3dd30615bd913ab02dac7cdab24 "fix ci")`

`[b75eb7a](/parse-community/parse-server/pull/8054/commits/b75eb7a63cf0b3dd30615bd913ab02dac7cdab24)`

[![@mtrezza](https://avatars.githubusercontent.com/u/5673677?s=40&v=4)](/mtrezza)

`[fix adapter](/parse-community/parse-server/pull/8054/commits/a2d085e90d14e9f77bbc35636375526b433a1dce "fix adapter")`

`[a2d085e](/parse-community/parse-server/pull/8054/commits/a2d085e90d14e9f77bbc35636375526b433a1dce)`

[![@mtrezza](https://avatars.githubusercontent.com/u/5673677?s=40&v=4)](/mtrezza)

`[Create game_center.pem](/parse-community/parse-server/pull/8054/commits/2084b7c569697a5230e42511799eeac9219db5a9 "Create game_center.pem")`

`[2084b7c](/parse-community/parse-server/pull/8054/commits/2084b7c569697a5230e42511799eeac9219db5a9)`

[![@mtrezza](https://avatars.githubusercontent.com/u/5673677?s=40&v=4)](/mtrezza)

`[Update gcenter.js](/parse-community/parse-server/pull/8054/commits/0cc299f82e367518f2fe7a53b99f3f801a338cf4 "Update gcenter.js")`

`[0cc299f](/parse-community/parse-server/pull/8054/commits/0cc299f82e367518f2fe7a53b99f3f801a338cf4)`

[![@parse-github-assistant](https://avatars.githubusercontent.com/in/136195?s=80&v=4)](/apps/parse-github-assistant)

Copy link

### **[parse-github-assistant](/apps/parse-github-assistant) bot** commented [Jun 17, 2022](#issuecomment-1159009256) ‚Ä¢ edited Loading

| Thanks for opening this pull request!  * ‚ùå Please edit your post and use the provided template when creating a new pull request. This helps everyone to understand your post better and asks for essential information to quicker review the pull request. |
| --- |

All reactions

Sorry, something went wrong.

[![@codecov](https://avatars.githubusercontent.com/in/254?s=80&v=4)](/apps/codecov)

Copy link

### **[codecov](/apps/codecov) bot** commented [Jun 17, 2022](#issuecomment-1159015637) ‚Ä¢ edited Loading

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://codecov.io/gh/parse-community/parse-server/pull/8054?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=parse-community) Report Merging [#8054](https://codecov.io/gh/parse-community/parse-server/pull/8054?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=parse-community) ([0cc299f](https://github.com/parse-community/parse-server/commit/0cc299f82e367518f2fe7a53b99f3f801a338cf4)) into [release](https://codecov.io/gh/parse-community/parse-server/commit/c5cf282d11ffdc023764f8e7539a2bd6bc246fe1?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=parse-community) ([c5cf282](https://github.com/parse-community/parse-server/commit/c5cf282d11ffdc023764f8e7539a2bd6bc246fe1)) will **decrease** coverage by `0.00%`. The diff coverage is `91.30%`.  ``` @@             Coverage Diff             @@ ##           release    #8054      +/-   ## =========================================== - Coverage    94.17%   94.17%   -0.01%      ===========================================   Files          182      182                 Lines        13623    13650      +27      =========================================== + Hits         12830    12855      +25      - Misses         793      795       +2      ```  | [Impacted Files](https://codecov.io/gh/parse-community/parse-server/pull/8054?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=parse-community) | Coverage Œî |  | | --- | --- | --- | | [src/Adapters/Auth/gcenter.js](https://codecov.io/gh/parse-community/parse-server/pull/8054/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=parse-community#diff-c3JjL0FkYXB0ZXJzL0F1dGgvZ2NlbnRlci5qcw==) | `94.04% <91.30%> (-4.20%)` | ‚¨áÔ∏è | | [src/Adapters/Files/GridFSBucketAdapter.js](https://codecov.io/gh/parse-community/parse-server/pull/8054/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=parse-community#diff-c3JjL0FkYXB0ZXJzL0ZpbGVzL0dyaWRGU0J1Y2tldEFkYXB0ZXIuanM=) | `79.50% <0.00%> (-0.82%)` | ‚¨áÔ∏è | | [src/RestWrite.js](https://codecov.io/gh/parse-community/parse-server/pull/8054/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=parse-community#diff-c3JjL1Jlc3RXcml0ZS5qcw==) | `94.25% <0.00%> (+0.15%)` | ‚¨ÜÔ∏è | | [src/ParseServerRESTController.js](https://codecov.io/gh/parse-community/parse-server/pull/8054/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=parse-community#diff-c3JjL1BhcnNlU2VydmVyUkVTVENvbnRyb2xsZXIuanM=) | `98.48% <0.00%> (+1.51%)` | ‚¨ÜÔ∏è | | [src/batch.js](https://codecov.io/gh/parse-community/parse-server/pull/8054/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=parse-community#diff-c3JjL2JhdGNoLmpz) | `94.73% <0.00%> (+1.75%)` | ‚¨ÜÔ∏è |   ---   [Continue to review full report at Codecov](https://codecov.io/gh/parse-community/parse-server/pull/8054?src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=parse-community).  **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=parse-community) `Œî = absolute <relative> (impact)`, `√∏ = not affected`, `? = missing data` Powered by [Codecov](https://codecov.io/gh/parse-community/parse-server/pull/8054?src=pr&el=footer&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=parse-community). Last update [a8aef82...0cc299f](https://codecov.io/gh/parse-community/parse-server/pull/8054?src=pr&el=lastupdated&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=parse-community). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=parse-community). |

All reactions

Sorry, something went wrong.

[![@mtrezza](https://avatars.githubusercontent.com/u/5673677?s=40&u=fa2f4ed10cb5b8d49fd94c685f5c176937fd9a36&v=4)](/mtrezza)
[mtrezza](/mtrezza)
changed the title
~~fix~~
fix: certificate in Apple Game Center auth adapter not validated; this fixes a security vulnerability in which authentication could be bypassed using a fake certificate; if you are using the Apple Gamer Center auth adapter it is your responsibility to keep its root certificate up-to-date and we advice you read the security advisory ([GHSA-rh9j-f5f8-rvgc](https://github.com/parse-community/parse-server/security/advisories/GHSA-rh9j-f5f8-rvgc))
[Jun 17, 2022](#event-6830183721)

[![@mtrezza](https://avatars.githubusercontent.com/u/5673677?s=40&u=fa2f4ed10cb5b8d49fd94c685f5c176937fd9a36&v=4)](/mtrezza)
[mtrezza](/mtrezza)
merged commit [`ba2b0a9`](/parse-community/parse-server/commit/ba2b0a9cb9a568817a114b132a4c2e0911d76df1)
into
parse-community:release

[Jun 17, 2022](https://github.com/parse-community/parse-server/pull/8054#event-6830214704)

[![@parseplatformorg](https://avatars.githubusercontent.com/u/90459499?s=80&u=d22ed1dbc1210f8de54e26cdb15950b3666bbe91&v=4)](/parseplatformorg)

Copy link

Contributor

### **[parseplatformorg](/parseplatformorg)** commented [Jun 17, 2022](#issuecomment-1159048879)

| üéâ This change has been released in version [5.2.2](https://github.com/parse-community/parse-server/releases/tag/5.2.2) |
| --- |

All reactions

Sorry, something went wrong.

[![@parseplatformorg](https://avatars.githubusercontent.com/u/90459499?s=40&u=d22ed1dbc1210f8de54e26cdb15950b3666bbe91&v=4)](/parseplatformorg)
[parseplatformorg](/parseplatformorg)
added
the
[state:released](/parse-community/parse-server/labels/state%3Areleased)
Released as stable version
label
[Jun 17, 2022](#event-6830261905)

[![@mtrezza](https://avatars.githubusercontent.com/u/5673677?s=40&u=fa2f4ed10cb5b8d49fd94c685f5c176937fd9a36&v=4)](/mtrezza)
[mtrezza](/mtrezza)
changed the title
~~fix: certificate in Apple Game Center auth adapter not validated; this fixes a security vulnerability in which authentication could be bypassed using a fake certificate; if you are using the Apple Gamer Center auth adapter it is your responsibility to keep its root certificate up-to-date and we advice you read the security advisory ([GHSA-rh9j-f5f8-rvgc](https://github.com/parse-community/parse-server/security/advisories/GHSA-rh9j-f5f8-rvgc))~~
fix: certificate in Apple Game Center auth adapter not validated
[Jun 17, 2022](#event-6830305742)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fparse-community%2Fparse-server%2Fpull%2F8054)

Reviewers

No reviews

Assignees

No one assigned

Labels

[state:released](/parse-community/parse-server/labels/state%3Areleased)
Released as stable version

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@mtrezza](https://avatars.githubusercontent.com/u/5673677?s=52&v=4)](/mtrezza) [![@parseplatformorg](https://avatars.githubusercontent.com/u/90459499?s=52&v=4)](/parseplatformorg)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_51efb7fc_20250108_121141.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fparse-community%2Fparse-server%2Fcommit%2Fba2b0a9cb9a568817a114b132a4c2e0911d76df1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fparse-community%2Fparse-server%2Fcommit%2Fba2b0a9cb9a568817a114b132a4c2e0911d76df1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=parse-community%2Fparse-server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[parse-community](/parse-community)
/
**[parse-server](/parse-community/parse-server)**
Public

* [Notifications](/login?return_to=%2Fparse-community%2Fparse-server) You must be signed in to change notification settings
* [Fork
  4.8k](/login?return_to=%2Fparse-community%2Fparse-server)
* [Star
   21k](/login?return_to=%2Fparse-community%2Fparse-server)

* [Code](/parse-community/parse-server)
* [Issues
  374](/parse-community/parse-server/issues)
* [Pull requests
  92](/parse-community/parse-server/pulls)
* [Actions](/parse-community/parse-server/actions)
* [Projects
  0](/parse-community/parse-server/projects)
* [Wiki](/parse-community/parse-server/wiki)
* [Security](/parse-community/parse-server/security)
* [Insights](/parse-community/parse-server/pulse)

Additional navigation options

* [Code](/parse-community/parse-server)
* [Issues](/parse-community/parse-server/issues)
* [Pull requests](/parse-community/parse-server/pulls)
* [Actions](/parse-community/parse-server/actions)
* [Projects](/parse-community/parse-server/projects)
* [Wiki](/parse-community/parse-server/wiki)
* [Security](/parse-community/parse-server/security)
* [Insights](/parse-community/parse-server/pulse)

## Commit

[Permalink](/parse-community/parse-server/commit/ba2b0a9cb9a568817a114b132a4c2e0911d76df1)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: certificate in Apple Game Center auth adapter not validated; thi‚Ä¶

[Browse files](/parse-community/parse-server/tree/ba2b0a9cb9a568817a114b132a4c2e0911d76df1)
Browse the repository at this point in the history

```
‚Ä¶s fixes a security vulnerability in which authentication could be bypassed using a fake certificate; if you are using the Apple Gamer Center auth adapter it is your responsibility to keep its root certificate up-to-date and we advice you read the security advisory ([[GHSA-rh9j-f5f8-rvgc](https://github.com/advisories/GHSA-rh9j-f5f8-rvgc "GHSA-rh9j-f5f8-rvgc")]([GHSA-rh9j-f5f8-rvgc](https://github.com/parse-community/parse-server/security/advisories/GHSA-rh9j-f5f8-rvgc "GHSA-rh9j-f5f8-rvgc")))
```

* Loading branch information

[![@mtrezza](https://avatars.githubusercontent.com/u/5673677?s=40&v=4)](/mtrezza)

[mtrezza](/parse-community/parse-server/commits?author=mtrezza "View all commits by mtrezza")
authored
Jun 17, 2022

1 parent
[a8aef82](/parse-community/parse-server/commit/a8aef820afa2c8d87683668c2961e523016bad9b)

commit ba2b0a9

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**249 additions**
and
**38 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* release.config.js
  [release.config.js](#diff-ac88fd8e5da48b4c325de01dc00bc9609325e9bdb489c5a1abc781d538a1579e)
* spec

  + spec/AuthenticationAdapters.spec.js
    [AuthenticationAdapters.spec.js](#diff-6c48da2eb7a4b5d9630c3687ddac4ca033edd08d67f9d73439c5f80375399c9b)
  + support/cert

    - spec/support/cert/game\_center.pem
      [game\_center.pem](#diff-113b2c2c059260d6ec22c52862907753dea12a694b4225d80c88b6b1c3cef72d)
* src/Adapters/Auth

  + src/Adapters/Auth/gcenter.js
    [gcenter.js](#diff-c1aaab0b8c12344d2dddaaea5b5570aef4e8c332630ff1cea611cc7f421a8fd9)

## There are no files selected for viewing

11 changes: 5 additions & 6 deletions

11
[release.config.js](#diff-ac88fd8e5da48b4c325de01dc00bc9609325e9bdb489c5a1abc781d538a1579e "release.config.js")

Show comments

[View file](/parse-community/parse-server/blob/ba2b0a9cb9a568817a114b132a4c2e0911d76df1/release.config.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -83,21 +83,20 @@ async function config() { |
|  |  | ['@semantic-release/git', { |
|  |  | assets: [changelogFile, 'package.json', 'package-lock.json', 'npm-shrinkwrap.json'], |
|  |  | }], |
|  |  | ['@semantic-release/github', { |
|  |  | successComment: getReleaseComment(), |
|  |  | labels: ['type:ci'], |
|  |  | releasedLabels: ['state:released<%= nextRelease.channel ? `-\${nextRelease.channel}` : "" %>'] |
|  |  | }], |
|  |  | [ |
|  |  | "@saithodev/semantic-release-backmerge", |
|  |  | { |
|  |  | "branches": [ |
|  |  | { from: "beta", to: "alpha" }, |
|  |  | { from: "release", to: "beta" }, |
|  |  | { from: "release", to: "alpha" }, |
|  |  | ] |
|  |  | } |
|  |  | ], |
|  |  | ['@semantic-release/github', { |
|  |  | successComment: getReleaseComment(), |
|  |  | labels: ['type:ci'], |
|  |  | releasedLabels: ['state:released<%= nextRelease.channel ? `-\${nextRelease.channel}` : "" %>'] |
|  |  | }], |
|  |  | ], |
|  |  | }; |
|  |  |  |
| Expand Down | |  |

147 changes: 136 additions & 11 deletions

147
[spec/AuthenticationAdapters.spec.js](#diff-6c48da2eb7a4b5d9630c3687ddac4ca033edd08d67f9d73439c5f80375399c9b "spec/AuthenticationAdapters.spec.js")

Show comments

[View file](/parse-community/parse-server/blob/ba2b0a9cb9a568817a114b132a4c2e0911d76df1/spec/AuthenticationAdapters.spec.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1652,8 +1652,41 @@ describe('apple signin auth adapter', () => { |
|  |  |  |
|  |  | describe('Apple Game Center Auth adapter', () => { |
|  |  | const gcenter = require('../lib/Adapters/Auth/gcenter'); |
|  |  |  |
|  |  | const fs = require('fs'); |
|  |  | const testCert = fs.readFileSync(\_\_dirname + '/support/cert/game\_center.pem'); |
|  |  | it('can load adapter', async () => { |
|  |  | const options = { |
|  |  | gcenter: { |
|  |  | rootCertificateUrl: |
|  |  | 'https://cacerts.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt.pem', |
|  |  | }, |
|  |  | }; |
|  |  | const { adapter, appIds, providerOptions } = authenticationLoader.loadAuthAdapter( |
|  |  | 'gcenter', |
|  |  | options |
|  |  | ); |
|  |  | await adapter.validateAppId( |
|  |  | appIds, |
|  |  | { publicKeyUrl: 'https://static.gc.apple.com/public-key/gc-prod-4.cer' }, |
|  |  | providerOptions |
|  |  | ); |
|  |  | }); |
|  |  | it('validateAuthData should validate', async () => { |
|  |  | const options = { |
|  |  | gcenter: { |
|  |  | rootCertificateUrl: |
|  |  | 'https://cacerts.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt.pem', |
|  |  | }, |
|  |  | }; |
|  |  | const { adapter, appIds, providerOptions } = authenticationLoader.loadAuthAdapter( |
|  |  | 'gcenter', |
|  |  | options |
|  |  | ); |
|  |  | await adapter.validateAppId( |
|  |  | appIds, |
|  |  | { publicKeyUrl: 'https://static.gc.apple.com/public-key/gc-prod-4.cer' }, |
|  |  | providerOptions |
|  |  | ); |
|  |  | // real token is used |
|  |  | const authData = { |
|  |  | id: 'G:1965586982', |
| Expand All | | @@ -1664,29 +1697,49 @@ describe('Apple Game Center Auth adapter', () => { |
|  |  | salt: 'DzqqrQ==', |
|  |  | bundleId: 'cloud.xtralife.gamecenterauth', |
|  |  | }; |
|  |  |  |
|  |  | gcenter.cache['https://static.gc.apple.com/public-key/gc-prod-4.cer'] = testCert; |
|  |  | await gcenter.validateAuthData(authData); |
|  |  | }); |
|  |  |  |
|  |  | it('validateAuthData invalid signature id', async () => { |
|  |  | const { adapter, appIds, providerOptions } = authenticationLoader.loadAuthAdapter( |
|  |  | 'gcenter', |
|  |  | {} |
|  |  | ); |
|  |  | await adapter.validateAppId( |
|  |  | appIds, |
|  |  | { publicKeyUrl: 'https://static.gc.apple.com/public-key/gc-prod-4.cer' }, |
|  |  | providerOptions |
|  |  | ); |
|  |  | const authData = { |
|  |  | id: 'G:1965586982', |
|  |  | publicKeyUrl: 'https://static.gc.apple.com/public-key/gc-prod-4.cer', |
|  |  | publicKeyUrl: 'https://static.gc.apple.com/public-key/gc-prod-6.cer', |
|  |  | timestamp: 1565257031287, |
|  |  | signature: '1234', |
|  |  | salt: 'DzqqrQ==', |
|  |  | bundleId: 'cloud.xtralife.gamecenterauth', |
|  |  | bundleId: 'com.example.com', |
|  |  | }; |
|  |  |  |
|  |  | try { |
|  |  | await gcenter.validateAuthData(authData); |
|  |  | fail(); |
|  |  | } catch (e) { |
|  |  | expect(e.message).toBe('Apple Game Center - invalid signature'); |
|  |  | } |
|  |  | await expectAsync(gcenter.validateAuthData(authData)).toBeRejectedWith( |
|  |  | new Parse.Error(Parse.Error.SCRIPT\_FAILED, 'Apple Game Center - invalid signature') |
|  |  | ); |
|  |  | }); |
|  |  |  |
|  |  | it('validateAuthData invalid public key http url', async () => { |
|  |  | const options = { |
|  |  | gcenter: { |
|  |  | rootCertificateUrl: |
|  |  | 'https://cacerts.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt.pem', |
|  |  | }, |
|  |  | }; |
|  |  | const { adapter, appIds, providerOptions } = authenticationLoader.loadAuthAdapter( |
|  |  | 'gcenter', |
|  |  | options |
|  |  | ); |
|  |  | await adapter.validateAppId( |
|  |  | appIds, |
|  |  | { publicKeyUrl: 'https://static.gc.apple.com/public-key/gc-prod-4.cer' }, |
|  |  | providerOptions |
|  |  | ); |
|  |  | const publicKeyUrls = [ |
|  |  | 'example.com', |
|  |  | 'http://static.gc.apple.com/public-key/gc-prod-4.cer', |
| Expand Down  Expand Up | | @@ -1714,6 +1767,78 @@ describe('Apple Game Center Auth adapter', () => { |
|  |  | ) |
|  |  | ); |
|  |  | }); |
|  |  |  |
|  |  | it('should not validate Symantec Cert', async () => { |
|  |  | const options = { |
|  |  | gcenter: { |
|  |  | rootCertificateUrl: |
|  |  | 'https://cacerts.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt.pem', |
|  |  | }, |
|  |  | }; |
|  |  | const { adapter, appIds, providerOptions } = authenticationLoader.loadAuthAdapter( |
|  |  | 'gcenter', |
|  |  | options |
|  |  | ); |
|  |  | await adapter.validateAppId( |
|  |  | appIds, |
|  |  | { publicKeyUrl: 'https://static.gc.apple.com/public-key/gc-prod-4.cer' }, |
|  |  | providerOptions |
|  |  | ); |
|  |  | expect(() => |
|  |  | gcenter.verifyPublicKeyIssuer( |
|  |  | testCert, |
|  |  | 'https://static.gc.apple.com/public-key/gc-prod-4.cer' |
|  |  | ) |
|  |  | ); |
|  |  | }); |
|  |  |  |
|  |  | it('adapter should load default cert', async () => { |
|  |  | const options = { |
|  |  | gcenter: {}, |
|  |  | }; |
|  |  | const { adapter, appIds, providerOptions } = authenticationLoader.loadAuthAdapter( |
|  |  | 'gcenter', |
|  |  | options |
|  |  | ); |
|  |  | await adapter.validateAppId( |
|  |  | appIds, |
|  |  | { publicKeyUrl: 'https://static.gc.apple.com/public-key/gc-prod-4.cer' }, |
|  |  | providerOptions |
|  |  | ); |
|  |  | const previous = new Date(); |
|  |  | await adapter.validateAppId( |
|  |  | appIds, |
|  |  | { publicKeyUrl: 'https://static.gc.apple.com/public-key/gc-prod-4.cer' }, |
|  |  | providerOptions |
|  |  | ); |
|  |  |  |
|  |  | const duration = new Date().getTime() - previous.getTime(); |
|  |  | expect(duration).toEqual(0); |
|  |  | }); |
|  |  |  |
|  |  | it('adapter should throw', async () => { |
|  |  | const options = { |
|  |  | gcenter: { |
|  |  | rootCertificateUrl: 'https://example.com', |
|  |  | }, |
|  |  | }; |
|  |  | const { adapter, appIds, providerOptions } = authenticationLoader.loadAuthAdapter( |
|  |  | 'gcenter', |
|  |  | options |
|  |  | ); |
|  |  | await expectAsync( |
|  |  | adapter.validateAppId( |
|  |  | appIds, |
|  |  | { publicKeyUrl: 'https://static.gc.apple.com/public-key/gc-prod-4.cer' }, |
|  |  | providerOptions |
|  |  | ) |
|  |  | ).toBeRejectedWith( |
|  |  | new Parse.Error( |
|  |  | Parse.Error.OBJECT\_NOT\_FOUND, |
|  |  | 'Apple Game Center auth adapter parameter `rootCertificateURL` is invalid.' |
|  |  | ) |
|  |  | ); |
|  |  | }); |
|  |  | }); |
|  |  |  |
|  |  | describe('phant auth adapter', () => { |
| Expand Down | |  |

28 changes: 28 additions & 0 deletions

28
[spec/support/cert/game\_center.pem](#diff-113b2c2c059260d6ec22c52862907753dea12a694b4225d80c88b6b1c3cef72d "spec/support/cert/game_center.pem")

Show comments

[View file](/parse-community/parse-server/blob/ba2b0a9cb9a568817a114b132a4c2e0911d76df1/spec/support/cert/game_center.pem)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,28 @@ |
|  |  | -----BEGIN CERTIFICATE----- |
|  |  | MIIEvDCCA6SgAwIBAgIQXRHxNXkw1L9z5/3EZ/T/hDANBgkqhkiG9w0BAQsFADB/ |
|  |  | MQswCQYDVQQGEwJVUzEdMBsGA1UEChMUU3ltYW50ZWMgQ29ycG9yYXRpb24xHzAd |
|  |  | BgNVBAsTFlN5bWFudGVjIFRydXN0IE5ldHdvcmsxMDAuBgNVBAMTJ1N5bWFudGVj |
|  |  | IENsYXNzIDMgU0hBMjU2IENvZGUgU2lnbmluZyBDQTAeFw0xODA5MTcwMDAwMDBa |
|  |  | Fw0xOTA5MTcyMzU5NTlaMHMxCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxpZm9y |
|  |  | bmlhMRIwEAYDVQQHDAlDdXBlcnRpbm8xFDASBgNVBAoMC0FwcGxlLCBJbmMuMQ8w |
|  |  | DQYDVQQLDAZHQyBTUkUxFDASBgNVBAMMC0FwcGxlLCBJbmMuMIIBIjANBgkqhkiG |
|  |  | 9w0BAQEFAAOCAQ8AMIIBCgKCAQEA06fwIi8fgKrTQu7cBcFkJVF6+Tqvkg7MKJTM |
|  |  | IOYPPQtPF3AZYPsbUoRKAD7/JXrxxOSVJ7vU1mP77tYG8TcUteZ3sAwvt2dkRbm7 |
|  |  | ZO6DcmSggv1Dg4k3goNw4GYyCY4Z2/8JSmsQ80Iv/UOOwynpBziEeZmJ4uck6zlA |
|  |  | 17cDkH48LBpKylaqthym5bFs9gj11pto7mvyb5BTcVuohwi6qosvbs/4VGbC2Nsz |
|  |  | ie416nUZfv+xxoXH995gxR2mw5cDdeCew7pSKxEhvYjT2nVdQF0q/hnPMFnOaEyT |
|  |  | q79n3gwFXyt0dy8eP6KBF7EW9J6b7ubu/j7h+tQfxPM+gTXOBQIDAQABo4IBPjCC |
|  |  | ATowCQYDVR0TBAIwADAOBgNVHQ8BAf8EBAMCB4AwEwYDVR0lBAwwCgYIKwYBBQUH |
|  |  | AwMwYQYDVR0gBFowWDBWBgZngQwBBAEwTDAjBggrBgEFBQcCARYXaHR0cHM6Ly9k |
|  |  | LnN5bWNiLmNvbS9jcHMwJQYIKwYBBQUHAgIwGQwXaHR0cHM6Ly9kLnN5bWNiLmNv |
|  |  | bS9ycGEwHwYDVR0jBBgwFoAUljtT8Hkzl699g+8uK8zKt4YecmYwKwYDVR0fBCQw |
|  |  | IjAgoB6gHIYaaHR0cDovL3N2LnN5bWNiLmNvbS9zdi5jcmwwVwYIKwYBBQUHAQEE |
|  |  | SzBJMB8GCCsGAQUFBzABhhNodHRwOi8vc3Yuc3ltY2QuY29tMCYGCCsGAQUFBzAC |
|  |  | hhpodHRwOi8vc3Yuc3ltY2IuY29tL3N2LmNydDANBgkqhkiG9w0BAQsFAAOCAQEA |
|  |  | I/j/PcCNPebSAGrcqSFBSa2mmbusOX01eVBg8X0G/z8Z+ZWUfGFzDG0GQf89MPxV |
|  |  | woec+nZuqui7o9Bg8s8JbHV0TC52X14CbTj9w/qBF748WbH9gAaTkrJYPm+MlNhu |
|  |  | tjEuQdNl/YXVMvQW4O8UMHTi09GyJQ0NC4q92Wxvx1m/qzjvTLvrXHGQ9pEHhPyz |
|  |  | vfBLxQkWpNoCNKU7UeESyH06XOrGc9MsII9deeKsDJp9a0jtx+pP4MFVtFME9SSQ |
|  |  | tMBs0It7WwEf7qcRLpialxKwY2EzQ9g4WnANHqo18PrDBE10TFpZPzUh7JhMViVr |
|  |  | EEbl0YdElmF8Hlamah/yNw== |
|  |  | -----END CERTIFICATE----- |

101 changes: 80 additions & 21 deletions

101
[src/Adapters/Auth/gcenter.js](#diff-c1aaab0b8c12344d2dddaaea5b5570aef4e8c332630ff1cea611cc7f421a8fd9 "src/Adapters/Auth/gcenter.js")

Show comments

[View file](/parse-community/parse-server/blob/ba2b0a9cb9a568817a114b132a4c2e0911d76df1/src/Adapters/Auth/gcenter.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -14,7 +14,8 @@ const authData = { |
|  |  | const { Parse } = require('parse/node'); |
|  |  | const crypto = require('crypto'); |
|  |  | const https = require('https'); |
|  |  |  |
|  |  | const { pki } = require('node-forge'); |
|  |  | const ca = { cert: null, url: null }; |
|  |  | const cache = {}; // (publicKey -> cert) cache |
|  |  |  |
|  |  | function verifyPublicKeyUrl(publicKeyUrl) { |
| Expand Down  Expand Up | | @@ -52,39 +53,53 @@ async function getAppleCertificate(publicKeyUrl) { |
|  |  | path: url.pathname, |
|  |  | method: 'HEAD', |
|  |  | }; |
|  |  | const headers = await new Promise((resolve, reject) => |
|  |  | const cert\_headers = await new Promise((resolve, reject) => |
|  |  | https.get(headOptions, res => resolve(res.headers)).on('error', reject) |
|  |  | ); |
|  |  | const validContentTypes = ['application/x-x509-ca-cert', 'application/pkix-cert']; |
|  |  | if ( |
|  |  | headers['content-type'] !== 'application/pkix-cert' || |
|  |  | headers['content-length'] == null || |
|  |  | headers['content-length'] > 10000 |
|  |  | !validContentTypes.includes(cert\_headers['content-type']) || |
|  |  | cert\_headers['content-length'] == null || |
|  |  | cert\_headers['content-length'] > 10000 |
|  |  | ) { |
|  |  | throw new Parse.Error( |
|  |  | Parse.Error.OBJECT\_NOT\_FOUND, |
|  |  | `Apple Game Center - invalid publicKeyUrl: ${publicKeyUrl}` |
|  |  | ); |
|  |  | } |
|  |  | const { certificate, headers } = await getCertificate(publicKeyUrl); |
|  |  | if (headers['cache-control']) { |
|  |  | const expire = headers['cache-control'].match(/max-age=([0-9]+)/); |
|  |  | if (expire) { |
|  |  | cache[publicKeyUrl] = certificate; |
|  |  | // we'll expire the cache entry later, as per max-age |
|  |  | setTimeout(() => { |
|  |  | delete cache[publicKeyUrl]; |
|  |  | }, parseInt(expire[1], 10) \* 1000); |
|  |  | } |
|  |  | } |
|  |  | return verifyPublicKeyIssuer(certificate, publicKeyUrl); |
|  |  | } |
|  |  |  |
|  |  | function getCertificate(url, buffer) { |
|  |  | return new Promise((resolve, reject) => { |
|  |  | https |
|  |  | .get(publicKeyUrl, res => { |
|  |  | let data = ''; |
|  |  | .get(url, res => { |
|  |  | const data = []; |
|  |  | res.on('data', chunk => { |
|  |  | data += chunk.toString('base64'); |
|  |  | data.push(chunk); |
|  |  | }); |
|  |  | res.on('end', () => { |
|  |  | const cert = convertX509CertToPEM(data); |
|  |  | if (res.headers['cache-control']) { |
|  |  | var expire = res.headers['cache-control'].match(/max-age=([0-9]+)/); |
|  |  | if (expire) { |
|  |  | cache[publicKeyUrl] = cert; |
|  |  | // we'll expire the cache entry later, as per max-age |
|  |  | setTimeout(() => { |
|  |  | delete cache[publicKeyUrl]; |
|  |  | }, parseInt(expire[1], 10) \* 1000); |
|  |  | } |
|  |  | if (buffer) { |
|  |  | resolve({ certificate: Buffer.concat(data), headers: res.headers }); |
|  |  | return; |
|  |  | } |
|  |  | resolve(cert); |
|  |  | let cert = ''; |
|  |  | for (const chunk of data) { |
|  |  | cert += chunk.toString('base64'); |
|  |  | } |
|  |  | const certificate = convertX509CertToPEM(cert); |
|  |  | resolve({ certificate, headers: res.headers }); |
|  |  | }); |
|  |  | }) |
|  |  | .on('error', reject); |
| Expand Down  Expand Up | | @@ -115,6 +130,30 @@ function verifySignature(publicKey, authData) { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | function verifyPublicKeyIssuer(cert, publicKeyUrl) { |
|  |  | const publicKeyCert = pki.certificateFromPem(cert); |
|  |  | if (!ca.cert) { |
|  |  | throw new Parse.Error( |
|  |  | Parse.Error.OBJECT\_NOT\_FOUND, |
|  |  | 'Apple Game Center auth adapter parameter `rootCertificateURL` is invalid.' |
|  |  | ); |
|  |  | } |
|  |  | try { |
|  |  | if (!ca.cert.verify(publicKeyCert)) { |
|  |  | throw new Parse.Error( |
|  |  | Parse.Error.OBJECT\_NOT\_FOUND, |
|  |  | `Apple Game Center - invalid publicKeyUrl: ${publicKeyUrl}` |
|  |  | ); |
|  |  | } |
|  |  | } catch (e) { |
|  |  | throw new Parse.Error( |
|  |  | Parse.Error.OBJECT\_NOT\_FOUND, |
|  |  | `Apple Game Center - invalid publicKeyUrl: ${publicKeyUrl}` |
|  |  | ); |
|  |  | } |
|  |  | return cert; |
|  |  | } |
|  |  |  |
|  |  | // Returns a promise that fulfills if this user id is valid. |
|  |  | async function validateAuthData(authData) { |
|  |  | if (!authData.id) { |
| Expand All | | @@ -126,11 +165,31 @@ async function validateAuthData(authData) { |
|  |  | } |
|  |  |  |
|  |  | // Returns a promise that fulfills if this app id is valid. |
|  |  | function validateAppId() { |
|  |  | return Promise.resolve(); |
|  |  | async function validateAppId(appIds, authData, options = {}) { |
|  |  | if (!options.rootCertificateUrl) { |
|  |  | options.rootCertificateUrl = |
|  |  | 'https://cacerts.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt.pem'; |
|  |  | } |
|  |  | if (ca.url === options.rootCertificateUrl) { |
|  |  | return; |
|  |  | } |
|  |  | const { certificate, headers } = await getCertificate(options.rootCertificateUrl, true); |
|  |  | if ( |
|  |  | headers['content-type'] !== 'application/x-pem-file' || |
|  |  | headers['content-length'] == null || |
|  |  | headers['content-length'] > 10000 |
|  |  | ) { |
|  |  | throw new Parse.Error( |
|  |  | Parse.Error.OBJECT\_NOT\_FOUND, |
|  |  | 'Apple Game Center auth adapter parameter `rootCertificateURL` is invalid.' |
|  |  | ); |
|  |  | } |
|  |  | ca.cert = pki.certificateFromPem(certificate); |
|  |  | ca.url = options.rootCertificateUrl; |
|  |  | } |
|  |  |  |
|  |  | module.exports = { |
|  |  | validateAppId, |
|  |  | validateAuthData, |
|  |  | cache, |
|  |  | }; |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ba2b0a9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fparse-community%2Fparse-server%2Fcommit%2Fba2b0a9cb9a568817a114b132a4c2e0911d76df1) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from developer.apple.com_4f344572_20250108_121140.html ===


View in English

* [Global Nav Open Menu](#ac-gn-menustate)
  Global Nav Close Menu
* [Apple Developer](/)

[Search

Cancel](/search/)

* [Apple Developer](/)
* [News](/news/)
* [Discover](/discover/)
* [Design](/design/)
* [Develop](/develop/)
* [Distribute](/distribute/)
* [Support](/support/)
* [Account](/account/)

Cancel

Only search within ‚Äú‚Äù
### Quick Links

5 Quick Links

## [News](/news/)

[Open Menu](#localnav-menustate)
Close Menu

* [Hello Developer](/hello/)
* [Software Releases](/news/releases/)
* [Site Updates](/news/site-updates/)
* [Upcoming Requirements](/news/upcoming-requirements/)

![Get ready for a new Game Center authentication certificate](/assets/elements/icons/game-center/game-center-128x128_2x.png)
## Get ready for a new Game Center authentication certificate

July 30, 2021

Starting August¬†4,¬†2021, a new certificate for server-based Game¬†Center verification will be available via the [`publicKeyUrl`](https://developer.apple.com/documentation/gamekit/gklocalplayer/3516283-fetchitems). The previous certificate will no longer be available after this date. As a reminder, make sure your app always retrieves and uses the current `publicKeyUrl` value so it automatically uses the new certificate. If your app caches the certificate or hardcodes the certificate URL, it will require an update.

Please note, this root certificate issuer has been updated from Symantec Corporation to DigiCert, Inc. Make sure to check that the new root certificate issuer is on your list of trusted CAs. You can download the trusted root CA (DigiCert trusted G4) [here](https://knowledge.digicert.com/alerts/code-signing-new-minimum-rsa-keysize.html).

[Learn more](https://developer.apple.com/forums/thread/686122)

## Developer Footer

- [News](/news/)
- Get ready for a new Game Center authentication certificate

### Platforms

 [Open Menu](#footer-directory-column-section-state-platform)
Close Menu

* [iOS](/ios/)
* [iPadOS](/ipados/)
* [macOS](/macos/)
* [tvOS](/tvos/)
* [visionOS](/visionos/)
* [watchOS](/watchos/)

### Tools

 [Open Menu](#footer-directory-column-section-state-tools)
Close Menu

* [Swift](/swift/)
* [SwiftUI](/swiftui/)
* [Swift Playgrounds](/swift-playgrounds/)
* [TestFlight](/testflight/)
* [Xcode](/xcode/)
* [Xcode Cloud](/xcode-cloud/)
* [SF Symbols](/sf-symbols/)

### Topics & Technologies

 [Open Menu](#footer-directory-column-section-state-topics)
Close Menu

* [Accessibility](/accessibility/)
* [Accessories](/accessories/)
* [App Extensions](/app-extensions/)
* [App Store](/app-store/)
* [Audio & Video](/audio/)
* [Augmented Reality](/augmented-reality/)
* [Design](/design/)
* [Distribution](/distribute/)
* [Education](/education/)
* [Fonts](/fonts/)
* [Games](/games/)
* [Health & Fitness](/health-fitness/)
* [In-App Purchase](/in-app-purchase/)
* [Localization](/localization/)
* [Maps & Location](/maps/)
* [Machine Learning](/machine-learning/)
* [Open Source](https://opensource.apple.com)
* [Security](/security/)
* [Safari & Web](/safari/)

### Resources

 [Open Menu](#footer-directory-column-section-state-resources)
Close Menu

* [Documentation](/documentation/)
* [Tutorials](/learn/)
* [Downloads](/download/)
* [Forums](/forums/)
* [Videos](/videos/)

### Support

 [Open Menu](#footer-directory-column-section-state-support)
Close Menu

* [Support Articles](/support/articles/)
* [Contact Us](/contact/)
* [Bug Reporting](/bug-reporting/)
* [System Status](/system-status/)

### Account

 [Open Menu](#footer-directory-column-section-state-account)
Close Menu

* [Apple Developer](/account/)
* [App Store Connect](https://appstoreconnect.apple.com/)
* [Certificates, IDs, & Profiles](/account/ios/certificate/)
* [Feedback Assistant](https://feedbackassistant.apple.com/)

### Programs

 [Open Menu](#footer-directory-column-section-state-programs)
Close Menu

* [Apple Developer Program](/programs/)
* [Apple Developer Enterprise Program](/programs/enterprise/)
* [App Store Small Business Program](/app-store/small-business-program/)
* [MFi Program](https://mfi.apple.com/)
* [News Partner Program](/programs/news-partner/)
* [Video Partner Program](/programs/video-partner/)
* [Security Bounty Program](/security-bounty/)
* [Security Research Device Program](/programs/security-research-device/)

### Events

 [Open Menu](#footer-directory-column-section-state-events)
Close Menu

* [Meet with Apple](/events/)
* [Apple Developer Centers](/events/developer-centers/)
* [App Store Awards](/app-store/app-store-awards/)
* [Apple Design Awards](/design/awards/)
* [Apple Developer Academies](/academies/)
* [Entrepreneur Camp](/entrepreneur-camp/)
* [WWDC](/wwdc/)

Get the [Apple Developer app](https://apps.apple.com/us/app/apple-developer/id640199958).

Light

Dark

Auto

Copyright ¬© 2025 [Apple Inc.](https://www.apple.com) All rights reserved.
[Terms of Use](https://www.apple.com/legal/internet-services/terms/site.html)
[Privacy Policy](https://www.apple.com/legal/privacy/)
[Agreements and Guidelines](/support/terms/)



=== Content from github.com_52b5a7bd_20250108_121144.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fparse-community%2Fparse-server%2Fsecurity%2Fadvisories%2FGHSA-rh9j-f5f8-rvgc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fparse-community%2Fparse-server%2Fsecurity%2Fadvisories%2FGHSA-rh9j-f5f8-rvgc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=parse-community%2Fparse-server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[parse-community](/parse-community)
/
**[parse-server](/parse-community/parse-server)**
Public

* [Notifications](/login?return_to=%2Fparse-community%2Fparse-server) You must be signed in to change notification settings
* [Fork
  4.8k](/login?return_to=%2Fparse-community%2Fparse-server)
* [Star
   21k](/login?return_to=%2Fparse-community%2Fparse-server)

* [Code](/parse-community/parse-server)
* [Issues
  374](/parse-community/parse-server/issues)
* [Pull requests
  92](/parse-community/parse-server/pulls)
* [Actions](/parse-community/parse-server/actions)
* [Projects
  0](/parse-community/parse-server/projects)
* [Wiki](/parse-community/parse-server/wiki)
* [Security](/parse-community/parse-server/security)
* [Insights](/parse-community/parse-server/pulse)

Additional navigation options

* [Code](/parse-community/parse-server)
* [Issues](/parse-community/parse-server/issues)
* [Pull requests](/parse-community/parse-server/pulls)
* [Actions](/parse-community/parse-server/actions)
* [Projects](/parse-community/parse-server/projects)
* [Wiki](/parse-community/parse-server/wiki)
* [Security](/parse-community/parse-server/security)
* [Insights](/parse-community/parse-server/pulse)

# Authentication bypass vulnerability in Apple Game Center auth adapter

Critical

[mtrezza](/mtrezza)
published
GHSA-rh9j-f5f8-rvgc
Jun 17, 2022

## Package

npm

parse-server
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

(<4.10.11) || (>=5.0.0 <5.2.2)

## Patched versions

(>=4.10.11 <5.0.0) || (>=5.2.2)

## Description

### Impact

The certificate in Apple Game Center auth adapter not validated. As a result, authentication could potentially be bypassed by making a fake certificate accessible via certain Apple domains and providing the URL to that certificate in an authData object.

### Patches

To prevent this, a new `rootCertificateUrl` property is introduced to the Parse Server Apple Game Center auth adapter which takes the URL to the root certificate of Apple's Game Center authentication certificate. If no value is set, the `rootCertificateUrl` property defaults to the URL of the [current root certificate](https://developer.apple.com/news/?id=stttq465) as of May 27, 2022.

Keep in mind that the root certificate can change at any time (expected to be announced by Apple) and that it is the developer's responsibility to keep the root certificate URL up-to-date when using the Parse Server Apple Game Center auth adapter.

### Workarounds

None.

### References

* [GHSA-rh9j-f5f8-rvgc](https://github.com/parse-community/parse-server/security/advisories/GHSA-rh9j-f5f8-rvgc "GHSA-rh9j-f5f8-rvgc")
* <https://developer.apple.com/news/?id=stttq465>
* <https://github.com/parse-community/parse-server>

### More information

* For questions or comments about this vulnerability visit our [community forum](http://community.parseplatform.org) or [community chat](http://chat.parseplatform.org)
* Report other vulnerabilities at [report.parseplatform.org](https://report.parseplatform.org)

### Severity

Critical

### CVE ID

CVE-2022-31083

### Weaknesses

No CWEs

### Credits

* [![@yoshmidev](https://avatars.githubusercontent.com/u/103584114?s=40&v=4)](/yoshmidev)
  [yoshmidev](/yoshmidev)
  Analyst

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


