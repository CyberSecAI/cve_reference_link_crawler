<!-- MHonArc v2.6.19+ -->
<!--X-Subject: Re: Security vulnerability in htags -->
<!--X-From-R13: Euvtvb KO[OUGQVW &#60;fuvtvbNtah.bet> -->
<!--X-Date: Wed, 08 May 2024 03:44:36 &#45;0400 -->
<!--X-Message-Id: CADJmJYoXGBzy3CS1gv7=YT&#45;XD3drL7GQ&#45;zv2q9wqK0RYk8c7gQ@mail.gmail.com -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Reference: TYv_IWTtj_grsFHrF&#45;uG&#45;AvuFwFtK0Y_WtHMjbXva7SY7Y7i2aMLTxKll3ZV_k0ucQ7iIcHnGkymZAdSVfJA3DtQ0q8C6Q6ZOyYoe6X9xH0=@proton.me -->
<!--X-Derived: binm4U_rnMJZw.bin -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: Security vulnerability in htags</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<center>
<table border=0 cellspacing=2 cellpadding=0 bgcolor="#000000">
<tr><td><table border=0 bgcolor="#FFFFCC">
<tr><td><big><b>bug-global</b></big></td></tr></table></tr></table>
<div class="nowrap">
<small>[<a href="../"
>Top</a>][<a href="/archive/html">All Lists</a>]</small>
</div>
<form method="get" action="/archive/cgi-bin/namazu.cgi">
<input type="text" name="query" size="30">
<input type="submit" name="submit" value="Search">
<input type="hidden" name="idxname" value="bug-global">
<a href="/archive/cgi-bin/namazu.cgi?idxname=bug-global">Advanced</a>
</form>

</center>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00008.html">Date Prev</a>][<a href="msg00010.html">Date Next</a>][<a href="msg00007.html">Thread Prev</a>][Thread Next][<a
href="index.html#00009">Date Index</a>][<a
href="threads.html#00009">Thread Index</a>]

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h2>Re: Security vulnerability in htags</h2>
<hr>
<table border=0>
<tbody>
<tr>
<td align="right" valign="top">
<b>From</b>: </td>
<td align="left">
Shigio YAMAGUCHI</td>
</tr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->

<tr>
<td align="right" valign="top">
<b>Subject</b>: </td>
<td align="left">
Re: Security vulnerability in htags</td>
</tr>

<tr>
<td align="right" valign="top">
<b>Date</b>: </td>
<td align="left">
Wed, 8 May 2024 16:44:17 +0900</td>
</tr>

</tbody>
</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hi,
I confirmed the security vulnerability and fixed it.
The result of executing the modified command is as follows:

$ rm -f /tmp/w
$ htags --suggest2 -d '&amp;&amp; id'
gtags: directory '/tmp/global/htags/&amp;&amp; id' not found.
htags: cannot execute gtags(1) command.
$ cat /tmp/w
cat: /tmp/w: No such file or directory
$ htags --suggest2 -d '$(pwd&gt;/tmp/w)'
gtags: directory '/tmp/global/htags/$(pwd&gt;' not found.
htags: cannot execute gtags(1) command.
$ cat /tmp/w
cat: /tmp/w: No such file or directory

I have attached the patch to this mail.
Thank you for the report.

Regards,
Shigio

On Wed, May 8, 2024 at 6:10â¯AM u32i &lt;u32i@proton.me&gt; wrote:
&gt;<i></i>
&gt;<i> Hi,</i>
&gt;<i></i>
&gt;<i> I found a security vulnerability in htags. htags takes the input provided in </i>
&gt;<i> the dbpath option (-d) and appends it to a command string that will later be </i>
&gt;<i> executed by system() function, without any escaping, leading to a command </i>
&gt;<i> injection vulnerability.</i>
&gt;<i></i>
&gt;<i> Vulnerable code: src/htags/htags.c:L1336</i>
&gt;<i></i>
&gt;<i> Reproduce:</i>
&gt;<i></i>
&gt;<i> Run htags by injecting a command in the dbpath argument (-d) :</i>
&gt;<i></i>
&gt;<i>      $ htags --suggest2 -d '&amp;&amp; id'</i>
&gt;<i>      // SNIP</i>
&gt;<i>       uid=1000(user1) gid=1000(user1) </i>
&gt;<i> groups=1000(user1),24(cdrom),25(floppy),27(sudo)</i>
&gt;<i>       htags: GPATH, GTAGS and/or GRTAGS not found. Please reexecute htags </i>
&gt;<i> with the -g option.</i>
&gt;<i></i>
&gt;<i>            $ htags --suggest2 -d '$(pwd&gt;/tmp/w)'</i>
&gt;<i>      $ cat /tmp/w</i>
&gt;<i>      /home/user1/tests</i>
&gt;<i></i>
&gt;<i> Environment:</i>
&gt;<i></i>
&gt;<i> Tested in Debian 12, htags version 6.6.12</i>
&gt;<i></i>
&gt;<i> Mitigation:</i>
&gt;<i></i>
&gt;<i> Options added to or used in system commands should be validated and escaped </i>
&gt;<i> before used.</i>
&gt;<i></i>
&gt;<i> Best Regards</i>
&gt;<i></i>


-- 
Shigio YAMAGUCHI &lt;shigio@gnu.org&gt;
PGP fingerprint:
26F6 31B4 3D62 4A92 7E6F  1C33 969C 3BE3 89DD A6EB
</pre>
<p><strong><a href="binm4U_rnMJZw.bin" ><img src="/icons/binary.png" align="left" border=0 alt="Attachment:" width="20" height="22"></a>
<a href="binm4U_rnMJZw.bin" ><tt>htags.diff</tt></a></strong><br>
<em>Description:</em> Binary data</p>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<form method="post" action="/mp/yyz.py" enctype="multipart/form-data">
<input type="hidden" name="a" value="shigio">
<input type="hidden" name="b" value="Re: Security vulnerability in htags">
<input type="hidden" name="d" value="CADJmJYoXGBzy3CS1gv7=YT-XD3drL7GQ-zv2q9wqK0RYk8c7gQ@mail.gmail.com">
<input type="hidden" name="c" value="gnu.org">
<center>reply via email to<br><input type="submit" value=" Shigio YAMAGUCHI "></center>
</form>
<hr>
<table width="100%">
<tr><td align="left">[<a href="msg00007.html">Prev in Thread</a>]</td>
<td align="center"><b>Current Thread</b></td>
<td align="right">[Next in Thread]</td></tr></table>
<ul>
<li><b><a name="00007" href="msg00007.html">Security vulnerability in htags</a></b>, <i>u32i</i>, <tt>2024/05/07</tt>
<ul>
<li><font color="#666666"><strong>Re: Security vulnerability in htags</strong>,
<em>Shigio YAMAGUCHI</em></font>&nbsp;<b>&lt;=</b>
</li>
</ul>
</li>
</ul>

<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00008.html">Re: Python 3 and pygments-parser</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00010.html">Re: Python 3 and pygments-parser</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00007.html">Security vulnerability in htags</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="index.html#00009"><strong>Date</strong></a></li>
<li><a href="threads.html#00009"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
