

| | **bug-global** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-global)

---

[[Date Prev](msg00008.html)][[Date Next](msg00010.html)][[Thread Prev](msg00007.html)][Thread Next][[Date Index](index.html#00009)][[Thread Index](threads.html#00009)]

## Re: Security vulnerability in htags

---

| **From**: | Shigio YAMAGUCHI |
| --- | --- |

| **Subject**: | Re: Security vulnerability in htags |
| **Date**: | Wed, 8 May 2024 16:44:17 +0900 |

---

```
Hi,
I confirmed the security vulnerability and fixed it.
The result of executing the modified command is as follows:

$ rm -f /tmp/w
$ htags --suggest2 -d '&& id'
gtags: directory '/tmp/global/htags/&& id' not found.
htags: cannot execute gtags(1) command.
$ cat /tmp/w
cat: /tmp/w: No such file or directory
$ htags --suggest2 -d '$(pwd>/tmp/w)'
gtags: directory '/tmp/global/htags/$(pwd>' not found.
htags: cannot execute gtags(1) command.
$ cat /tmp/w
cat: /tmp/w: No such file or directory

I have attached the patch to this mail.
Thank you for the report.

Regards,
Shigio

On Wed, May 8, 2024 at 6:10â¯AM u32i <u32i@proton.me> wrote:
>
> Hi,
>
> I found a security vulnerability in htags. htags takes the input provided in
> the dbpath option (-d) and appends it to a command string that will later be
> executed by system() function, without any escaping, leading to a command
> injection vulnerability.
>
> Vulnerable code: src/htags/htags.c:L1336
>
> Reproduce:
>
> Run htags by injecting a command in the dbpath argument (-d) :
>
>      $ htags --suggest2 -d '&& id'
>      // SNIP
>       uid=1000(user1) gid=1000(user1)
> groups=1000(user1),24(cdrom),25(floppy),27(sudo)
>       htags: GPATH, GTAGS and/or GRTAGS not found. Please reexecute htags
> with the -g option.
>
>            $ htags --suggest2 -d '$(pwd>/tmp/w)'
>      $ cat /tmp/w
>      /home/user1/tests
>
> Environment:
>
> Tested in Debian 12, htags version 6.6.12
>
> Mitigation:
>
> Options added to or used in system commands should be validated and escaped
> before used.
>
> Best Regards
>

--
Shigio YAMAGUCHI <shigio@gnu.org>
PGP fingerprint:
26F6 31B4 3D62 4A92 7E6F  1C33 969C 3BE3 89DD A6EB

```

**[![Attachment:](/icons/binary.png)](binm4U_rnMJZw.bin)
[htags.diff](binm4U_rnMJZw.bin)**

*Description:* Binary data

---

reply via email to

---

| [[Prev in Thread](msg00007.html)] | **Current Thread** | [Next in Thread] |
| --- | --- | --- |

* **[Security vulnerability in htags](msg00007.html)**, *u32i*, 2024/05/07
  + **Re: Security vulnerability in htags**,
    *Shigio YAMAGUCHI* **<=**

---

* Prev by Date:
  **[Re: Python 3 and pygments-parser](msg00008.html)**
* Next by Date:
  **[Re: Python 3 and pygments-parser](msg00010.html)**
* Previous by thread:
  **[Security vulnerability in htags](msg00007.html)**
* Index(es):
  + [**Date**](index.html#00009)
  + [**Thread**](threads.html#00009)

