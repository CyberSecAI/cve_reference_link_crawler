- **Root cause of vulnerability**: The `SendRst` function in the AllJoyn Router Service does not properly initialize the `ArdpHeader` structure before sending a reset packet. This leads to the disclosure of uninitialized stack memory. Specifically, the code allocates a buffer on the stack, attempts to initialize it, but then uses a separate, uninitialized structure when sending the packet.
- **Weaknesses/vulnerabilities present**: Information Exposure Through Sent Data (CWE-201). The service leaks stack memory due to the incorrect handling of the `ArdpHeader` structure in the `SendRst` function. The allocated stack buffer is not used, and an uninitialized `ArdpHeader` structure is sent instead, resulting in the disclosure of stack memory contents.
- **Impact of exploitation**: An attacker can obtain potentially sensitive information from the process's stack memory, which could be used in further attacks or to gain a better understanding of the system.
- **Attack vectors**: An attacker can send an unauthenticated UDP packet to the AllJoyn Router Service with an invalid ARDP version flag, triggering a reset which leads to the information disclosure. Other invalid parameters or sequences can also trigger a reset and the same information leak.
- **Required attacker capabilities/position**: The attacker needs to be able to send unauthenticated UDP packets to the machine running the vulnerable service on the port being used for ARDP connections (typically 9955) or any other port that the service binds to. The attacker does not need any prior authentication or knowledge of the system. The attacker can be local or remote.