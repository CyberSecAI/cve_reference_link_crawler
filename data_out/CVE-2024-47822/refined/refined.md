- **Root cause of vulnerability**: Access tokens passed in the query string (`req.query`) are not redacted when the `LOG_STYLE` is set to `raw`. This results in the tokens being potentially logged in plain text.
- **Weaknesses/vulnerabilities present**:  Logging of sensitive information, specifically access tokens, in plain text. This falls under CWE-532: Insertion of Sensitive Information into Log File.
- **Impact of exploitation**: An attacker who gains access to the system logs can obtain access tokens. If these tokens are long-lived and have high privileges, the attacker can gain administrative control, leading to unauthorized data access and manipulation.
- **Attack vectors**: Access to system logs where the application logs are stored. This could be through compromised infrastructure or internal access.
- **Required attacker capabilities/position**: The attacker requires access to the system's logs where the application stores logs, specifically when `LOG_STYLE` is set to `raw`. The attacker needs to be able to see the unredacted access token that was passed in the query string, which means access to the log files. The vulnerability also requires the application's `LOG_STYLE` to be set to `raw`.