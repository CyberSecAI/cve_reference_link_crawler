Root cause of vulnerability: SQL injection vulnerability in the upgrade process for SQL Server.
Weaknesses/vulnerabilities present: SQL injection. The vulnerability lies in how the application processes the name of a database table's primary key index during SQL Server upgrades.
Impact of exploitation: Attackers can execute arbitrary SQL commands.
Attack vectors: The vulnerability is triggered during the database upgrade process. The attacker needs to modify the database before the upgrade.
Required attacker capabilities/position:
- The attacker must have the ability to modify the database.
- The attacker must wait for the application to be upgraded after modifying the database.
- The exploitation requires chaining with other attacks to modify the database.