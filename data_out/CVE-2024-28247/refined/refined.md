The provided content relates to CVE-2024-28247.

**Root cause of vulnerability:**
The vulnerability lies in how Pi-hole handles local file paths in the "Update Gravity" function. Specifically, when a URL starting with "file://" is added to the Adlists, the system attempts to read the specified local file. However, it doesn't properly restrict access, and prints the first 5 non-domain lines of the file to the output.

**Weaknesses/vulnerabilities present:**
- **Arbitrary File Read:** An authenticated user can read any file on the server by adding a "file://" URL to the Adlists.
- **Privilege Escalation:** The file read is performed with root privileges because the "pihole -g" command is executed with `sudo`.
- **Insufficient Input Validation:** The application fails to properly validate and sanitize the input URL, especially when using the `file://` scheme, leading to the arbitrary file read vulnerability.
- **Information Disclosure:** The first 5 lines of the file are printed to the screen, allowing an attacker to obtain sensitive information.

**Impact of exploitation:**
- **Sensitive Data Exposure:** An attacker can read any file on the server, potentially accessing configuration files, password hashes (/etc/shadow), or other sensitive data.
- **System Compromise:** By reading the /etc/shadow file, an attacker could potentially crack password hashes and gain root access to the system.
- **Further Attacks:** The attacker can enumerate the system and perform more complex attacks using the gathered information.

**Attack vectors:**
- The attack vector is network-based (remotely exploitable).
- An attacker exploits the vulnerability by adding a crafted `file://` URL to the Adlists within the Pi-hole admin interface.

**Required attacker capabilities/position:**
- The attacker needs to be an authenticated user with access to the Pi-hole web interface.
- No special privileges are required beyond standard user access to the Pi-hole interface.