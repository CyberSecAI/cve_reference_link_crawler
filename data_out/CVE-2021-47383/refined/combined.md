=== Content from git.kernel.org_33483c5c_20250111_021905.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=7e71fcedfda6f7de18f850a6b36e78d78b04476f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7e71fcedfda6f7de18f850a6b36e78d78b04476f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7e71fcedfda6f7de18f850a6b36e78d78b04476f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7e71fcedfda6f7de18f850a6b36e78d78b04476f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Igor Matheus Andrade Torrente <igormtorrente@gmail.com> | 2021-06-28 10:45:09 -0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-10-06 10:22:24 +0200 |
| commit | [7e71fcedfda6f7de18f850a6b36e78d78b04476f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7e71fcedfda6f7de18f850a6b36e78d78b04476f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=7e71fcedfda6f7de18f850a6b36e78d78b04476f)) | |
| tree | [b8f00c6d0e70dba00bb6a4fd5fe4276d1b19514b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7e71fcedfda6f7de18f850a6b36e78d78b04476f) | |
| parent | [6482984599bbbbc26375e903ca66453051e092ea](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6482984599bbbbc26375e903ca66453051e092ea) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7e71fcedfda6f7de18f850a6b36e78d78b04476f&id2=6482984599bbbbc26375e903ca66453051e092ea)) | |
| download | [linux-7e71fcedfda6f7de18f850a6b36e78d78b04476f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-7e71fcedfda6f7de18f850a6b36e78d78b04476f.tar.gz) | |

tty: Fix out-of-bound vmalloc access in imageblit[ Upstream commit 3b0c406124719b625b1aba431659f5cdc24a982c ]
This issue happens when a userspace program does an ioctl
FBIOPUT\_VSCREENINFO passing the fb\_var\_screeninfo struct
containing only the fields xres, yres, and bits\_per\_pixel
with values.
If this struct is the same as the previous ioctl, the
vc\_resize() detects it and doesn't call the resize\_screen(),
leaving the fb\_var\_screeninfo incomplete. And this leads to
the updatescrollmode() calculates a wrong value to
fbcon\_display->vrows, which makes the real\_y() return a
wrong value of y, and that value, eventually, causes
the imageblit to access an out-of-bound address value.
To solve this issue I made the resize\_screen() be called
even if the screen does not need any resizing, so it will
"fix and fill" the fb\_var\_screeninfo independently.
Cc: stable <stable@vger.kernel.org> # after 5.15-rc2 is out, give it time to bake
Reported-and-tested-by: syzbot+858dc7a2f7ef07c2c219@syzkaller.appspotmail.com
Signed-off-by: Igor Matheus Andrade Torrente <igormtorrente@gmail.com>
Link: [https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente@gmail.com](https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente%40gmail.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7e71fcedfda6f7de18f850a6b36e78d78b04476f)

| -rw-r--r-- | [drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vt/vt.c?id=7e71fcedfda6f7de18f850a6b36e78d78b04476f) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 19 insertions, 2 deletions

| diff --git a/drivers/tty/vt/vt.c b/drivers/tty/vt/vt.cindex 9f479b4c649199..0fab196a1d90b0 100644--- a/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=6482984599bbbbc26375e903ca66453051e092ea)+++ b/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=7e71fcedfda6f7de18f850a6b36e78d78b04476f)@@ -882,8 +882,25 @@ static int vc\_do\_resize(struct tty\_struct \*tty, struct vc\_data \*vc, new\_row\_size = new\_cols << 1; new\_screen\_size = new\_row\_size \* new\_rows; - if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows)- return 0;+ if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows) {+ /\*+ \* This function is being called here to cover the case+ \* where the userspace calls the FBIOPUT\_VSCREENINFO twice,+ \* passing the same fb\_var\_screeninfo containing the fields+ \* yres/xres equal to a number non-multiple of vc\_font.height+ \* and yres\_virtual/xres\_virtual equal to number lesser than the+ \* vc\_font.height and yres/xres.+ \* In the second call, the struct fb\_var\_screeninfo isn't+ \* being modified by the underlying driver because of the+ \* if above, and this causes the fbcon\_display->vrows to become+ \* negative and it eventually leads to out-of-bound+ \* access by the imageblit function.+ \* To give the correct values to the struct and to not have+ \* to deal with possible errors from the code below, we call+ \* the resize\_screen here as well.+ \*/+ return resize\_screen(vc, new\_cols, new\_rows, user);+ }  if (new\_screen\_size > (4 << 20)) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:17:42 +0000



=== Content from git.kernel.org_960277e6_20250111_021906.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=883f7897a25e3ce14a7f274ca4c73f49ac84002a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=883f7897a25e3ce14a7f274ca4c73f49ac84002a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=883f7897a25e3ce14a7f274ca4c73f49ac84002a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=883f7897a25e3ce14a7f274ca4c73f49ac84002a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Igor Matheus Andrade Torrente <igormtorrente@gmail.com> | 2021-06-28 10:45:09 -0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-10-06 15:42:29 +0200 |
| commit | [883f7897a25e3ce14a7f274ca4c73f49ac84002a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=883f7897a25e3ce14a7f274ca4c73f49ac84002a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=883f7897a25e3ce14a7f274ca4c73f49ac84002a)) | |
| tree | [6fb2df70b4620d5894f865a1e8120f04924df4a2](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=883f7897a25e3ce14a7f274ca4c73f49ac84002a) | |
| parent | [3a7dc5b4cfbdfd8da37cb0e54f439d84cf5a5123](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3a7dc5b4cfbdfd8da37cb0e54f439d84cf5a5123) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=883f7897a25e3ce14a7f274ca4c73f49ac84002a&id2=3a7dc5b4cfbdfd8da37cb0e54f439d84cf5a5123)) | |
| download | [linux-883f7897a25e3ce14a7f274ca4c73f49ac84002a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-883f7897a25e3ce14a7f274ca4c73f49ac84002a.tar.gz) | |

tty: Fix out-of-bound vmalloc access in imageblit[ Upstream commit 3b0c406124719b625b1aba431659f5cdc24a982c ]
This issue happens when a userspace program does an ioctl
FBIOPUT\_VSCREENINFO passing the fb\_var\_screeninfo struct
containing only the fields xres, yres, and bits\_per\_pixel
with values.
If this struct is the same as the previous ioctl, the
vc\_resize() detects it and doesn't call the resize\_screen(),
leaving the fb\_var\_screeninfo incomplete. And this leads to
the updatescrollmode() calculates a wrong value to
fbcon\_display->vrows, which makes the real\_y() return a
wrong value of y, and that value, eventually, causes
the imageblit to access an out-of-bound address value.
To solve this issue I made the resize\_screen() be called
even if the screen does not need any resizing, so it will
"fix and fill" the fb\_var\_screeninfo independently.
Cc: stable <stable@vger.kernel.org> # after 5.15-rc2 is out, give it time to bake
Reported-and-tested-by: syzbot+858dc7a2f7ef07c2c219@syzkaller.appspotmail.com
Signed-off-by: Igor Matheus Andrade Torrente <igormtorrente@gmail.com>
Link: [https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente@gmail.com](https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente%40gmail.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=883f7897a25e3ce14a7f274ca4c73f49ac84002a)

| -rw-r--r-- | [drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vt/vt.c?id=883f7897a25e3ce14a7f274ca4c73f49ac84002a) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 19 insertions, 2 deletions

| diff --git a/drivers/tty/vt/vt.c b/drivers/tty/vt/vt.cindex 404b80dc06b874..d1ab8561e25819 100644--- a/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=3a7dc5b4cfbdfd8da37cb0e54f439d84cf5a5123)+++ b/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=883f7897a25e3ce14a7f274ca4c73f49ac84002a)@@ -1215,8 +1215,25 @@ static int vc\_do\_resize(struct tty\_struct \*tty, struct vc\_data \*vc, new\_row\_size = new\_cols << 1; new\_screen\_size = new\_row\_size \* new\_rows; - if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows)- return 0;+ if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows) {+ /\*+ \* This function is being called here to cover the case+ \* where the userspace calls the FBIOPUT\_VSCREENINFO twice,+ \* passing the same fb\_var\_screeninfo containing the fields+ \* yres/xres equal to a number non-multiple of vc\_font.height+ \* and yres\_virtual/xres\_virtual equal to number lesser than the+ \* vc\_font.height and yres/xres.+ \* In the second call, the struct fb\_var\_screeninfo isn't+ \* being modified by the underlying driver because of the+ \* if above, and this causes the fbcon\_display->vrows to become+ \* negative and it eventually leads to out-of-bound+ \* access by the imageblit function.+ \* To give the correct values to the struct and to not have+ \* to deal with possible errors from the code below, we call+ \* the resize\_screen here as well.+ \*/+ return resize\_screen(vc, new\_cols, new\_rows, user);+ }  if (new\_screen\_size > KMALLOC\_MAX\_SIZE || !new\_screen\_size) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:17:43 +0000



=== Content from git.kernel.org_8d165e35_20250111_021900.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=067c694d06040db6f0c65281bb358452ca6d85b9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=067c694d06040db6f0c65281bb358452ca6d85b9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=067c694d06040db6f0c65281bb358452ca6d85b9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=067c694d06040db6f0c65281bb358452ca6d85b9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Igor Matheus Andrade Torrente <igormtorrente@gmail.com> | 2021-06-28 10:45:09 -0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-10-06 15:05:08 +0200 |
| commit | [067c694d06040db6f0c65281bb358452ca6d85b9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=067c694d06040db6f0c65281bb358452ca6d85b9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=067c694d06040db6f0c65281bb358452ca6d85b9)) | |
| tree | [03f7b61228296f0e7c1a6abf803da0dbe5064a98](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=067c694d06040db6f0c65281bb358452ca6d85b9) | |
| parent | [40faa4d13add5b6f79083f734b1a3a79e14a3336](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=40faa4d13add5b6f79083f734b1a3a79e14a3336) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=067c694d06040db6f0c65281bb358452ca6d85b9&id2=40faa4d13add5b6f79083f734b1a3a79e14a3336)) | |
| download | [linux-067c694d06040db6f0c65281bb358452ca6d85b9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-067c694d06040db6f0c65281bb358452ca6d85b9.tar.gz) | |

tty: Fix out-of-bound vmalloc access in imageblit[ Upstream commit 3b0c406124719b625b1aba431659f5cdc24a982c ]
This issue happens when a userspace program does an ioctl
FBIOPUT\_VSCREENINFO passing the fb\_var\_screeninfo struct
containing only the fields xres, yres, and bits\_per\_pixel
with values.
If this struct is the same as the previous ioctl, the
vc\_resize() detects it and doesn't call the resize\_screen(),
leaving the fb\_var\_screeninfo incomplete. And this leads to
the updatescrollmode() calculates a wrong value to
fbcon\_display->vrows, which makes the real\_y() return a
wrong value of y, and that value, eventually, causes
the imageblit to access an out-of-bound address value.
To solve this issue I made the resize\_screen() be called
even if the screen does not need any resizing, so it will
"fix and fill" the fb\_var\_screeninfo independently.
Cc: stable <stable@vger.kernel.org> # after 5.15-rc2 is out, give it time to bake
Reported-and-tested-by: syzbot+858dc7a2f7ef07c2c219@syzkaller.appspotmail.com
Signed-off-by: Igor Matheus Andrade Torrente <igormtorrente@gmail.com>
Link: [https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente@gmail.com](https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente%40gmail.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=067c694d06040db6f0c65281bb358452ca6d85b9)

| -rw-r--r-- | [drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vt/vt.c?id=067c694d06040db6f0c65281bb358452ca6d85b9) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 19 insertions, 2 deletions

| diff --git a/drivers/tty/vt/vt.c b/drivers/tty/vt/vt.cindex d497208b43f42c..f4ac5ec5dc022b 100644--- a/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=40faa4d13add5b6f79083f734b1a3a79e14a3336)+++ b/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=067c694d06040db6f0c65281bb358452ca6d85b9)@@ -883,8 +883,25 @@ static int vc\_do\_resize(struct tty\_struct \*tty, struct vc\_data \*vc, new\_row\_size = new\_cols << 1; new\_screen\_size = new\_row\_size \* new\_rows; - if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows)- return 0;+ if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows) {+ /\*+ \* This function is being called here to cover the case+ \* where the userspace calls the FBIOPUT\_VSCREENINFO twice,+ \* passing the same fb\_var\_screeninfo containing the fields+ \* yres/xres equal to a number non-multiple of vc\_font.height+ \* and yres\_virtual/xres\_virtual equal to number lesser than the+ \* vc\_font.height and yres/xres.+ \* In the second call, the struct fb\_var\_screeninfo isn't+ \* being modified by the underlying driver because of the+ \* if above, and this causes the fbcon\_display->vrows to become+ \* negative and it eventually leads to out-of-bound+ \* access by the imageblit function.+ \* To give the correct values to the struct and to not have+ \* to deal with possible errors from the code below, we call+ \* the resize\_screen here as well.+ \*/+ return resize\_screen(vc, new\_cols, new\_rows, user);+ }  if (new\_screen\_size > KMALLOC\_MAX\_SIZE || !new\_screen\_size) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:17:37 +0000



=== Content from git.kernel.org_fe84e04a_20250111_021909.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d570c48dd37dbe8fc6875d4461d01a9554ae2560)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d570c48dd37dbe8fc6875d4461d01a9554ae2560)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d570c48dd37dbe8fc6875d4461d01a9554ae2560)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d570c48dd37dbe8fc6875d4461d01a9554ae2560)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Igor Matheus Andrade Torrente <igormtorrente@gmail.com> | 2021-06-28 10:45:09 -0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-10-06 15:55:45 +0200 |
| commit | [d570c48dd37dbe8fc6875d4461d01a9554ae2560](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d570c48dd37dbe8fc6875d4461d01a9554ae2560) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d570c48dd37dbe8fc6875d4461d01a9554ae2560)) | |
| tree | [be265f885c45de1acf5a643baf6cb36553a682f5](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d570c48dd37dbe8fc6875d4461d01a9554ae2560) | |
| parent | [f93026b28e2afe5060a493b0bbcee19d12961b7e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f93026b28e2afe5060a493b0bbcee19d12961b7e) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d570c48dd37dbe8fc6875d4461d01a9554ae2560&id2=f93026b28e2afe5060a493b0bbcee19d12961b7e)) | |
| download | [linux-d570c48dd37dbe8fc6875d4461d01a9554ae2560.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d570c48dd37dbe8fc6875d4461d01a9554ae2560.tar.gz) | |

tty: Fix out-of-bound vmalloc access in imageblit[ Upstream commit 3b0c406124719b625b1aba431659f5cdc24a982c ]
This issue happens when a userspace program does an ioctl
FBIOPUT\_VSCREENINFO passing the fb\_var\_screeninfo struct
containing only the fields xres, yres, and bits\_per\_pixel
with values.
If this struct is the same as the previous ioctl, the
vc\_resize() detects it and doesn't call the resize\_screen(),
leaving the fb\_var\_screeninfo incomplete. And this leads to
the updatescrollmode() calculates a wrong value to
fbcon\_display->vrows, which makes the real\_y() return a
wrong value of y, and that value, eventually, causes
the imageblit to access an out-of-bound address value.
To solve this issue I made the resize\_screen() be called
even if the screen does not need any resizing, so it will
"fix and fill" the fb\_var\_screeninfo independently.
Cc: stable <stable@vger.kernel.org> # after 5.15-rc2 is out, give it time to bake
Reported-and-tested-by: syzbot+858dc7a2f7ef07c2c219@syzkaller.appspotmail.com
Signed-off-by: Igor Matheus Andrade Torrente <igormtorrente@gmail.com>
Link: [https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente@gmail.com](https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente%40gmail.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d570c48dd37dbe8fc6875d4461d01a9554ae2560)

| -rw-r--r-- | [drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vt/vt.c?id=d570c48dd37dbe8fc6875d4461d01a9554ae2560) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 19 insertions, 2 deletions

| diff --git a/drivers/tty/vt/vt.c b/drivers/tty/vt/vt.cindex cea40ef090b77e..a7ee1171eeb3e2 100644--- a/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=f93026b28e2afe5060a493b0bbcee19d12961b7e)+++ b/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=d570c48dd37dbe8fc6875d4461d01a9554ae2560)@@ -1220,8 +1220,25 @@ static int vc\_do\_resize(struct tty\_struct \*tty, struct vc\_data \*vc, new\_row\_size = new\_cols << 1; new\_screen\_size = new\_row\_size \* new\_rows; - if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows)- return 0;+ if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows) {+ /\*+ \* This function is being called here to cover the case+ \* where the userspace calls the FBIOPUT\_VSCREENINFO twice,+ \* passing the same fb\_var\_screeninfo containing the fields+ \* yres/xres equal to a number non-multiple of vc\_font.height+ \* and yres\_virtual/xres\_virtual equal to number lesser than the+ \* vc\_font.height and yres/xres.+ \* In the second call, the struct fb\_var\_screeninfo isn't+ \* being modified by the underlying driver because of the+ \* if above, and this causes the fbcon\_display->vrows to become+ \* negative and it eventually leads to out-of-bound+ \* access by the imageblit function.+ \* To give the correct values to the struct and to not have+ \* to deal with possible errors from the code below, we call+ \* the resize\_screen here as well.+ \*/+ return resize\_screen(vc, new\_cols, new\_rows, user);+ }  if (new\_screen\_size > KMALLOC\_MAX\_SIZE || !new\_screen\_size) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:17:46 +0000



=== Content from git.kernel.org_b06b9a64_20250111_021907.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8a6a240f52e14356386030d8958ae8b1761d2325)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8a6a240f52e14356386030d8958ae8b1761d2325)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8a6a240f52e14356386030d8958ae8b1761d2325)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8a6a240f52e14356386030d8958ae8b1761d2325)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Igor Matheus Andrade Torrente <igormtorrente@gmail.com> | 2021-06-28 10:45:09 -0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-10-06 15:31:20 +0200 |
| commit | [8a6a240f52e14356386030d8958ae8b1761d2325](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8a6a240f52e14356386030d8958ae8b1761d2325) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8a6a240f52e14356386030d8958ae8b1761d2325)) | |
| tree | [0ae2d02bd31c40524751193eada2d72b102b57ee](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8a6a240f52e14356386030d8958ae8b1761d2325) | |
| parent | [a4250df12f44ec736c4e30ece86a63a2c379663b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a4250df12f44ec736c4e30ece86a63a2c379663b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8a6a240f52e14356386030d8958ae8b1761d2325&id2=a4250df12f44ec736c4e30ece86a63a2c379663b)) | |
| download | [linux-8a6a240f52e14356386030d8958ae8b1761d2325.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8a6a240f52e14356386030d8958ae8b1761d2325.tar.gz) | |

tty: Fix out-of-bound vmalloc access in imageblit[ Upstream commit 3b0c406124719b625b1aba431659f5cdc24a982c ]
This issue happens when a userspace program does an ioctl
FBIOPUT\_VSCREENINFO passing the fb\_var\_screeninfo struct
containing only the fields xres, yres, and bits\_per\_pixel
with values.
If this struct is the same as the previous ioctl, the
vc\_resize() detects it and doesn't call the resize\_screen(),
leaving the fb\_var\_screeninfo incomplete. And this leads to
the updatescrollmode() calculates a wrong value to
fbcon\_display->vrows, which makes the real\_y() return a
wrong value of y, and that value, eventually, causes
the imageblit to access an out-of-bound address value.
To solve this issue I made the resize\_screen() be called
even if the screen does not need any resizing, so it will
"fix and fill" the fb\_var\_screeninfo independently.
Cc: stable <stable@vger.kernel.org> # after 5.15-rc2 is out, give it time to bake
Reported-and-tested-by: syzbot+858dc7a2f7ef07c2c219@syzkaller.appspotmail.com
Signed-off-by: Igor Matheus Andrade Torrente <igormtorrente@gmail.com>
Link: [https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente@gmail.com](https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente%40gmail.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8a6a240f52e14356386030d8958ae8b1761d2325)

| -rw-r--r-- | [drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vt/vt.c?id=8a6a240f52e14356386030d8958ae8b1761d2325) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 19 insertions, 2 deletions

| diff --git a/drivers/tty/vt/vt.c b/drivers/tty/vt/vt.cindex b2b5f19fb2fb95..72e3989dffa60b 100644--- a/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=a4250df12f44ec736c4e30ece86a63a2c379663b)+++ b/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=8a6a240f52e14356386030d8958ae8b1761d2325)@@ -1218,8 +1218,25 @@ static int vc\_do\_resize(struct tty\_struct \*tty, struct vc\_data \*vc, new\_row\_size = new\_cols << 1; new\_screen\_size = new\_row\_size \* new\_rows; - if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows)- return 0;+ if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows) {+ /\*+ \* This function is being called here to cover the case+ \* where the userspace calls the FBIOPUT\_VSCREENINFO twice,+ \* passing the same fb\_var\_screeninfo containing the fields+ \* yres/xres equal to a number non-multiple of vc\_font.height+ \* and yres\_virtual/xres\_virtual equal to number lesser than the+ \* vc\_font.height and yres/xres.+ \* In the second call, the struct fb\_var\_screeninfo isn't+ \* being modified by the underlying driver because of the+ \* if above, and this causes the fbcon\_display->vrows to become+ \* negative and it eventually leads to out-of-bound+ \* access by the imageblit function.+ \* To give the correct values to the struct and to not have+ \* to deal with possible errors from the code below, we call+ \* the resize\_screen here as well.+ \*/+ return resize\_screen(vc, new\_cols, new\_rows, user);+ }  if (new\_screen\_size > KMALLOC\_MAX\_SIZE || !new\_screen\_size) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:17:45 +0000



=== Content from git.kernel.org_cf70e7fd_20250111_021900.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3b0c406124719b625b1aba431659f5cdc24a982c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3b0c406124719b625b1aba431659f5cdc24a982c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3b0c406124719b625b1aba431659f5cdc24a982c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3b0c406124719b625b1aba431659f5cdc24a982c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Igor Matheus Andrade Torrente <igormtorrente@gmail.com> | 2021-06-28 10:45:09 -0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-07-21 12:41:28 +0200 |
| commit | [3b0c406124719b625b1aba431659f5cdc24a982c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3b0c406124719b625b1aba431659f5cdc24a982c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3b0c406124719b625b1aba431659f5cdc24a982c)) | |
| tree | [f31479e573eb234495f070a39caa8a041bedeaad](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3b0c406124719b625b1aba431659f5cdc24a982c) | |
| parent | [4fc2d3cd6d3a487a9fb79ebc81f7ae86a7dace7a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4fc2d3cd6d3a487a9fb79ebc81f7ae86a7dace7a) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3b0c406124719b625b1aba431659f5cdc24a982c&id2=4fc2d3cd6d3a487a9fb79ebc81f7ae86a7dace7a)) | |
| download | [linux-3b0c406124719b625b1aba431659f5cdc24a982c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3b0c406124719b625b1aba431659f5cdc24a982c.tar.gz) | |

tty: Fix out-of-bound vmalloc access in imageblitThis issue happens when a userspace program does an ioctl
FBIOPUT\_VSCREENINFO passing the fb\_var\_screeninfo struct
containing only the fields xres, yres, and bits\_per\_pixel
with values.
If this struct is the same as the previous ioctl, the
vc\_resize() detects it and doesn't call the resize\_screen(),
leaving the fb\_var\_screeninfo incomplete. And this leads to
the updatescrollmode() calculates a wrong value to
fbcon\_display->vrows, which makes the real\_y() return a
wrong value of y, and that value, eventually, causes
the imageblit to access an out-of-bound address value.
To solve this issue I made the resize\_screen() be called
even if the screen does not need any resizing, so it will
"fix and fill" the fb\_var\_screeninfo independently.
Cc: stable <stable@vger.kernel.org> # after 5.15-rc2 is out, give it time to bake
Reported-and-tested-by: syzbot+858dc7a2f7ef07c2c219@syzkaller.appspotmail.com
Signed-off-by: Igor Matheus Andrade Torrente <igormtorrente@gmail.com>
Link: [https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente@gmail.com](https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente%40gmail.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3b0c406124719b625b1aba431659f5cdc24a982c)

| -rw-r--r-- | [drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vt/vt.c?id=3b0c406124719b625b1aba431659f5cdc24a982c) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 19 insertions, 2 deletions

| diff --git a/drivers/tty/vt/vt.c b/drivers/tty/vt/vt.cindex ef981d3b7bb495..484eda1958f50e 100644--- a/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=4fc2d3cd6d3a487a9fb79ebc81f7ae86a7dace7a)+++ b/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=3b0c406124719b625b1aba431659f5cdc24a982c)@@ -1219,8 +1219,25 @@ static int vc\_do\_resize(struct tty\_struct \*tty, struct vc\_data \*vc, new\_row\_size = new\_cols << 1; new\_screen\_size = new\_row\_size \* new\_rows; - if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows)- return 0;+ if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows) {+ /\*+ \* This function is being called here to cover the case+ \* where the userspace calls the FBIOPUT\_VSCREENINFO twice,+ \* passing the same fb\_var\_screeninfo containing the fields+ \* yres/xres equal to a number non-multiple of vc\_font.height+ \* and yres\_virtual/xres\_virtual equal to number lesser than the+ \* vc\_font.height and yres/xres.+ \* In the second call, the struct fb\_var\_screeninfo isn't+ \* being modified by the underlying driver because of the+ \* if above, and this causes the fbcon\_display->vrows to become+ \* negative and it eventually leads to out-of-bound+ \* access by the imageblit function.+ \* To give the correct values to the struct and to not have+ \* to deal with possible errors from the code below, we call+ \* the resize\_screen here as well.+ \*/+ return resize\_screen(vc, new\_cols, new\_rows, user);+ }  if (new\_screen\_size > KMALLOC\_MAX\_SIZE || !new\_screen\_size) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:17:38 +0000



=== Content from git.kernel.org_d0a9e0fc_20250111_021902.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=699d926585daa6ec44be556cdc1ab89e5d54557b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=699d926585daa6ec44be556cdc1ab89e5d54557b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=699d926585daa6ec44be556cdc1ab89e5d54557b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=699d926585daa6ec44be556cdc1ab89e5d54557b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Igor Matheus Andrade Torrente <igormtorrente@gmail.com> | 2021-06-28 10:45:09 -0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-10-07 07:53:04 +0200 |
| commit | [699d926585daa6ec44be556cdc1ab89e5d54557b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=699d926585daa6ec44be556cdc1ab89e5d54557b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=699d926585daa6ec44be556cdc1ab89e5d54557b)) | |
| tree | [9602d489817fac8ab32e83c8f745c363985535ac](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=699d926585daa6ec44be556cdc1ab89e5d54557b) | |
| parent | [7be199764d46aafcbe2e0bb90997cc4de312bfa8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7be199764d46aafcbe2e0bb90997cc4de312bfa8) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=699d926585daa6ec44be556cdc1ab89e5d54557b&id2=7be199764d46aafcbe2e0bb90997cc4de312bfa8)) | |
| download | [linux-699d926585daa6ec44be556cdc1ab89e5d54557b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-699d926585daa6ec44be556cdc1ab89e5d54557b.tar.gz) | |

tty: Fix out-of-bound vmalloc access in imageblit[ Upstream commit 3b0c406124719b625b1aba431659f5cdc24a982c ]
This issue happens when a userspace program does an ioctl
FBIOPUT\_VSCREENINFO passing the fb\_var\_screeninfo struct
containing only the fields xres, yres, and bits\_per\_pixel
with values.
If this struct is the same as the previous ioctl, the
vc\_resize() detects it and doesn't call the resize\_screen(),
leaving the fb\_var\_screeninfo incomplete. And this leads to
the updatescrollmode() calculates a wrong value to
fbcon\_display->vrows, which makes the real\_y() return a
wrong value of y, and that value, eventually, causes
the imageblit to access an out-of-bound address value.
To solve this issue I made the resize\_screen() be called
even if the screen does not need any resizing, so it will
"fix and fill" the fb\_var\_screeninfo independently.
Cc: stable <stable@vger.kernel.org> # after 5.15-rc2 is out, give it time to bake
Reported-and-tested-by: syzbot+858dc7a2f7ef07c2c219@syzkaller.appspotmail.com
Signed-off-by: Igor Matheus Andrade Torrente <igormtorrente@gmail.com>
Link: [https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente@gmail.com](https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente%40gmail.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=699d926585daa6ec44be556cdc1ab89e5d54557b)

| -rw-r--r-- | [drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vt/vt.c?id=699d926585daa6ec44be556cdc1ab89e5d54557b) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 19 insertions, 2 deletions

| diff --git a/drivers/tty/vt/vt.c b/drivers/tty/vt/vt.cindex cb72393f92d3a2..153d4a88ec9ac1 100644--- a/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=7be199764d46aafcbe2e0bb90997cc4de312bfa8)+++ b/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=699d926585daa6ec44be556cdc1ab89e5d54557b)@@ -1219,8 +1219,25 @@ static int vc\_do\_resize(struct tty\_struct \*tty, struct vc\_data \*vc, new\_row\_size = new\_cols << 1; new\_screen\_size = new\_row\_size \* new\_rows; - if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows)- return 0;+ if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows) {+ /\*+ \* This function is being called here to cover the case+ \* where the userspace calls the FBIOPUT\_VSCREENINFO twice,+ \* passing the same fb\_var\_screeninfo containing the fields+ \* yres/xres equal to a number non-multiple of vc\_font.height+ \* and yres\_virtual/xres\_virtual equal to number lesser than the+ \* vc\_font.height and yres/xres.+ \* In the second call, the struct fb\_var\_screeninfo isn't+ \* being modified by the underlying driver because of the+ \* if above, and this causes the fbcon\_display->vrows to become+ \* negative and it eventually leads to out-of-bound+ \* access by the imageblit function.+ \* To give the correct values to the struct and to not have+ \* to deal with possible errors from the code below, we call+ \* the resize\_screen here as well.+ \*/+ return resize\_screen(vc, new\_cols, new\_rows, user);+ }  if (new\_screen\_size > KMALLOC\_MAX\_SIZE || !new\_screen\_size) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:17:39 +0000



=== Content from git.kernel.org_23d572c9_20250111_021903.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=70aed03b1d5a5df974f456cdc8eedb213c94bb8b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=70aed03b1d5a5df974f456cdc8eedb213c94bb8b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=70aed03b1d5a5df974f456cdc8eedb213c94bb8b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=70aed03b1d5a5df974f456cdc8eedb213c94bb8b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Igor Matheus Andrade Torrente <igormtorrente@gmail.com> | 2021-06-28 10:45:09 -0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-10-06 10:23:41 +0200 |
| commit | [70aed03b1d5a5df974f456cdc8eedb213c94bb8b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=70aed03b1d5a5df974f456cdc8eedb213c94bb8b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=70aed03b1d5a5df974f456cdc8eedb213c94bb8b)) | |
| tree | [154f1878f0fcc48db6633ffc1264145949b0454c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=70aed03b1d5a5df974f456cdc8eedb213c94bb8b) | |
| parent | [d488b40a3442b16e741edc80971caad1574b4098](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d488b40a3442b16e741edc80971caad1574b4098) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=70aed03b1d5a5df974f456cdc8eedb213c94bb8b&id2=d488b40a3442b16e741edc80971caad1574b4098)) | |
| download | [linux-70aed03b1d5a5df974f456cdc8eedb213c94bb8b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-70aed03b1d5a5df974f456cdc8eedb213c94bb8b.tar.gz) | |

tty: Fix out-of-bound vmalloc access in imageblit[ Upstream commit 3b0c406124719b625b1aba431659f5cdc24a982c ]
This issue happens when a userspace program does an ioctl
FBIOPUT\_VSCREENINFO passing the fb\_var\_screeninfo struct
containing only the fields xres, yres, and bits\_per\_pixel
with values.
If this struct is the same as the previous ioctl, the
vc\_resize() detects it and doesn't call the resize\_screen(),
leaving the fb\_var\_screeninfo incomplete. And this leads to
the updatescrollmode() calculates a wrong value to
fbcon\_display->vrows, which makes the real\_y() return a
wrong value of y, and that value, eventually, causes
the imageblit to access an out-of-bound address value.
To solve this issue I made the resize\_screen() be called
even if the screen does not need any resizing, so it will
"fix and fill" the fb\_var\_screeninfo independently.
Cc: stable <stable@vger.kernel.org> # after 5.15-rc2 is out, give it time to bake
Reported-and-tested-by: syzbot+858dc7a2f7ef07c2c219@syzkaller.appspotmail.com
Signed-off-by: Igor Matheus Andrade Torrente <igormtorrente@gmail.com>
Link: [https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente@gmail.com](https://lore.kernel.org/r/20210628134509.15895-1-igormtorrente%40gmail.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=70aed03b1d5a5df974f456cdc8eedb213c94bb8b)

| -rw-r--r-- | [drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vt/vt.c?id=70aed03b1d5a5df974f456cdc8eedb213c94bb8b) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 19 insertions, 2 deletions

| diff --git a/drivers/tty/vt/vt.c b/drivers/tty/vt/vt.cindex 8c74d9ebfc5021..9f1573b0e45306 100644--- a/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=d488b40a3442b16e741edc80971caad1574b4098)+++ b/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=70aed03b1d5a5df974f456cdc8eedb213c94bb8b)@@ -886,8 +886,25 @@ static int vc\_do\_resize(struct tty\_struct \*tty, struct vc\_data \*vc, new\_row\_size = new\_cols << 1; new\_screen\_size = new\_row\_size \* new\_rows; - if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows)- return 0;+ if (new\_cols == vc->vc\_cols && new\_rows == vc->vc\_rows) {+ /\*+ \* This function is being called here to cover the case+ \* where the userspace calls the FBIOPUT\_VSCREENINFO twice,+ \* passing the same fb\_var\_screeninfo containing the fields+ \* yres/xres equal to a number non-multiple of vc\_font.height+ \* and yres\_virtual/xres\_virtual equal to number lesser than the+ \* vc\_font.height and yres/xres.+ \* In the second call, the struct fb\_var\_screeninfo isn't+ \* being modified by the underlying driver because of the+ \* if above, and this causes the fbcon\_display->vrows to become+ \* negative and it eventually leads to out-of-bound+ \* access by the imageblit function.+ \* To give the correct values to the struct and to not have+ \* to deal with possible errors from the code below, we call+ \* the resize\_screen here as well.+ \*/+ return resize\_screen(vc, new\_cols, new\_rows, user);+ }  if (new\_screen\_size > (4 << 20) || !new\_screen\_size) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:17:40 +0000


