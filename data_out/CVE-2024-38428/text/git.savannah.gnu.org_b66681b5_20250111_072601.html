

| [cgit logo](/cgit/) | [index](/cgit/) : [wget.git](/cgit/wget.git/ "wget.git") | master parallel-wget |
| --- | --- | --- |
| GNU Wget |  |

| [summary](/cgit/wget.git/)[refs](/cgit/wget.git/refs/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace)[log](/cgit/wget.git/log/)[tree](/cgit/wget.git/tree/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace)[commit](/cgit/wget.git/commit/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace)[diff](/cgit/wget.git/diff/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Tim Rühsen <tim.ruehsen@gmx.de> | 2024-06-02 12:40:16 +0200 |
| --- | --- | --- |
| committer | Tim Rühsen <tim.ruehsen@gmx.de> | 2024-06-02 12:40:21 +0200 |
| commit | [ed0c7c7e0e8f7298352646b2fd6e06a11e242ace](/cgit/wget.git/commit/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace) ([patch](/cgit/wget.git/patch/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace)) | |
| tree | [2a074f60d4eaeb8d6efc39bdb1c2c6b4985cbe93](/cgit/wget.git/tree/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace) | |
| parent | [bb59ef7fd414cd6a68b58283cd868f55cb3c9a6c](/cgit/wget.git/commit/?id=bb59ef7fd414cd6a68b58283cd868f55cb3c9a6c) ([diff](/cgit/wget.git/diff/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace&id2=bb59ef7fd414cd6a68b58283cd868f55cb3c9a6c)) | |
| download | [wget-ed0c7c7e0e8f7298352646b2fd6e06a11e242ace.tar.gz](/cgit/wget.git/snapshot/wget-ed0c7c7e0e8f7298352646b2fd6e06a11e242ace.tar.gz) | |

Properly re-implement userinfo parsing (rfc2396)\* src/url.c (url\_skip\_credentials): Properly re-implement userinfo parsing (rfc2396)
The reason why the implementation is based on RFC 2396, an outdated standard,
is that the whole file is based on that RFC, and mixing standard here might be
dangerous.
[Diffstat](/cgit/wget.git/diff/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace)

| -rw-r--r-- | [src/url.c](/cgit/wget.git/diff/src/url.c?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace) | 40 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 34 insertions, 6 deletions

| diff --git a/src/url.c b/src/url.cindex 69e948b..07c3bc8 100644--- a/[src/url.c](/cgit/wget.git/tree/src/url.c?id=bb59ef7fd414cd6a68b58283cd868f55cb3c9a6c)+++ b/[src/url.c](/cgit/wget.git/tree/src/url.c?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace)@@ -41,6 +41,7 @@ as that of the covered work. \*/ #include "url.h" #include "host.h" /\* for is\_valid\_ipv6\_address \*/ #include "c-strcase.h"+#include "c-ctype.h"  #ifdef HAVE\_ICONV # include <iconv.h>@@ -526,12 +527,39 @@ scheme\_leading\_string (enum url\_scheme scheme) static const char \* url\_skip\_credentials (const char \*url) {- /\* Look for '@' that comes before terminators, such as '/', '?',- '#', or ';'. \*/- const char \*p = (const char \*)strpbrk (url, "@/?#;");- if (!p || \*p != '@')- return url;- return p + 1;+ /\*+ \* This whole file implements https://www.rfc-editor.org/rfc/rfc2396 .+ \* RFC 2396 is outdated since 2005 and needs a rewrite or a thorough re-visit.+ \*+ \* The RFC says+ \* server = [ [ userinfo "@" ] hostport ]+ \* userinfo = \*( unreserved | escaped | ";" | ":" | "&" | "=" | "+" | "$" | "," )+ \* unreserved = alphanum | mark+ \* mark = "-" | "\_" | "." | "!" | "~" | "\*" | "'" | "(" | ")"+ \*/+ static const char \*allowed = "-\_.!~\*'();:&=+$,";++ for (const char \*p = url; \*p; p++)+ {+ if (c\_isalnum(\*p))+ continue;++ if (strchr(allowed, \*p))+ continue;++ if (\*p == '%' && c\_isxdigit(p[1]) && c\_isxdigit(p[2]))+ {+ p += 2;+ continue;+ }++ if (\*p == '@')+ return p + 1;++ break;+ }++ return url; }  /\* Parse credentials contained in [BEG, END). The region is expected |
| --- |

generated by [cgit v1.1](https://git.zx2c4.com/cgit/about/) at 2025-01-11 07:26:01 +0000

