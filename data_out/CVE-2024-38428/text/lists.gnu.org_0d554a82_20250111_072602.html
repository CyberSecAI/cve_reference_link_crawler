

| | **bug-wget** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-wget)

---

[[Date Prev](msg00004.html)][[Date Next](msg00006.html)][[Thread Prev](msg00004.html)][[Thread Next](msg00002.html)][[Date Index](index.html#00005)][[Thread Index](threads.html#00005)]

## Re: Semicolon not allowed in userinfo

---

| **From**: | Tim RÃ¼hsen |
| --- | --- |

| **Subject**: | Re: Semicolon not allowed in userinfo |
| **Date**: | Sun, 2 Jun 2024 12:53:33 +0200 |
| **User-agent**: | Mozilla Thunderbird |

---

```

Hey Bachir,

```
thank you for going into the details and bringing up the concerns and
also for keeping pushing.
```

I just pushed ed0c7c7e0e8f7298352646b2fd6e06a11e242ace to fix the
issue.

```
Indeed, the URL parser implementation of wget 1.x is based on RFC 2396,
a standard from 1998.
But even by this outdated standard, the implementation of the userinfo
parsing was not correct. It hopefully is correct now.
```

```
Anyway, nobody is going to lift the whole URL parsing of wget 1.x to
newer standards. But we have wget2 and Fedora 40 recently switched to
using wget2 instead of wget (of course there are corner cases that break
backward compatibility).
```

Regards, Tim

On 6/2/24 01:27, Bachir Bendrissou wrote:

```
> ```
>
> Hi Tim,
>
> Thank you for your email.
>
>
> ```
> First, the current behavior of wget 1.x contradicts the URI standard
> defined in RFC 3986, which allows semicolons in the userinfo segment.
> Ensuring compliance with this widely accepted standard is essential for
> \_interoperability and correctness\_.
> ```
>
>
>
> ```
> Second, the discrepancy in how wget 1.x handles semicolons in the
> userinfo segment of a URL can potentially lead to \_security
> vulnerabilities\_. Here are a few ways this could happen:
> ```
>
>
> *Misinterpretation of Userinfo Data:*
>
>
> ```
> Authentication Details: If wget 1.x incorrectly parses the userinfo
> segment, it may fail to properly handle authentication details. For
> example, if a URL contains credentials such as user:pass or user;pass,
> misinterpretation could lead to failed authentication attempts or the
> exposure of sensitive information.
> ```
>
>
> *Phishing and Spoofing Attacks:*
>
>
> ```
> Host Header Manipulation: Attackers might craft URLs that, due to
> incorrect parsing by wget 1.x, lead to connections to unintended hosts.
> This can be exploited in phishing attacks where the user believes they
> are connecting to a legitimate server, but are actually redirected to a
> malicious one.
> ```
>
>
> *Man-in-the-Middle Attacks:*
>
>
> ```
> Incorrect DNS Resolution: If wget 1.x misinterprets the userinfo segment
> as part of the hostname, it could result in DNS queries to incorrect or
> malicious domains. This can be leveraged in man-in-the-middle attacks
> where the attacker intercepts and manipulates the communication.
> ```
>
>
> *Data Leakage:*
>
>
> ```
> Insecure Handling of Userinfo: When userinfo is misinterpreted,
> sensitive information (like usernames and passwords) might be logged or
> displayed in error messages, leading to unintended exposure of credentials.
> ```
>
>
> Thanks,
> Bachir
>
>
>
> ```
> On Sat, Jun 1, 2024 at 5:42â¯PM Tim RÃ¼hsen <tim.ruehsen@gmx.de
> <mailto:tim.ruehsen@gmx.de>> wrote:
> ```
>
>
>     Hi Bachir,
>
>     wget2 "a;bc@xyz"
>     wget2: Failed to resolve 'xyz' (Name or service not known)
>
>     Is there a real-life problem that requires wget 1.x to accept a
>     semicolon in the userinfo field?
>
>     Regards, Tim
>
>     On 5/14/24 12:42, Bachir Bendrissou wrote:
>      > Hi,
>      >
>      > The URL example below contains a semicolon in the userinfo segment.
>      >
>      > In the example, wget does not recognise the userinfo segment, and
>      > instead treats it as part of the hostname. When the semicolon is
>      > removed, the userinfo is recognised and is no longer processed as
>      > hostname. The rejection of semicolons in userinfo creates a parsing
>      > discrepancy with other URL parsers.
>      >
>      > curl "a;bc@xyz"
>      > curl: (6) Could not resolve host: xyz
>      >
>      > wget "a;bc@xyz"
>      > wget: unable to resolve host address âa;bc@xyzâ
>      >
>      > wget "abc@xyz"
>      > wget: unable to resolve host address âxyzâ
>      >
>      > You can replicate the above cases after disconnecting from your DNS.
>      >
>      > Thank you,
>      > Bachir
>      >
>
>
> ```

**[![Attachment:](/icons/generic.png)](pgpdlhDmjbn1i.pgp)
[OpenPGP\_signature.asc](pgpdlhDmjbn1i.pgp)**

*Description:* OpenPGP digital signature

---

reply via email to

---

| [[Prev in Thread](msg00004.html)] | **Current Thread** | [Next in Thread] |
| --- | --- | --- |

* **[Re: Semicolon not allowed in userinfo](msg00001.html)**, *Tim RÃ¼hsen*, 2024/06/01
  + **[Re: Semicolon not allowed in userinfo](msg00004.html)**, *Bachir Bendrissou*, 2024/06/01
    - **Re: Semicolon not allowed in userinfo**,
      *Tim RÃ¼hsen* **<=**

---

* Prev by Date:
  **[Re: Semicolon not allowed in userinfo](msg00004.html)**
* Next by Date:
  **[Re: Wget 1 is not preserving server-side modification times via FTP](msg00006.html)**
* Previous by thread:
  **[Re: Semicolon not allowed in userinfo](msg00004.html)**
* Next by thread:
  **[Re: Wget 1 is not preserving server-side modification times via FTP](msg00002.html)**
* Index(es):
  + [**Date**](index.html#00005)
  + [**Thread**](threads.html#00005)

