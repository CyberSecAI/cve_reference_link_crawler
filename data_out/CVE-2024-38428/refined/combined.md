=== Content from git.savannah.gnu.org_b66681b5_20250111_072601.html ===


| [cgit logo](/cgit/) | [index](/cgit/) : [wget.git](/cgit/wget.git/ "wget.git") | master parallel-wget |
| --- | --- | --- |
| GNU Wget |  |

| [summary](/cgit/wget.git/)[refs](/cgit/wget.git/refs/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace)[log](/cgit/wget.git/log/)[tree](/cgit/wget.git/tree/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace)[commit](/cgit/wget.git/commit/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace)[diff](/cgit/wget.git/diff/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Tim Rühsen <tim.ruehsen@gmx.de> | 2024-06-02 12:40:16 +0200 |
| --- | --- | --- |
| committer | Tim Rühsen <tim.ruehsen@gmx.de> | 2024-06-02 12:40:21 +0200 |
| commit | [ed0c7c7e0e8f7298352646b2fd6e06a11e242ace](/cgit/wget.git/commit/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace) ([patch](/cgit/wget.git/patch/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace)) | |
| tree | [2a074f60d4eaeb8d6efc39bdb1c2c6b4985cbe93](/cgit/wget.git/tree/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace) | |
| parent | [bb59ef7fd414cd6a68b58283cd868f55cb3c9a6c](/cgit/wget.git/commit/?id=bb59ef7fd414cd6a68b58283cd868f55cb3c9a6c) ([diff](/cgit/wget.git/diff/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace&id2=bb59ef7fd414cd6a68b58283cd868f55cb3c9a6c)) | |
| download | [wget-ed0c7c7e0e8f7298352646b2fd6e06a11e242ace.tar.gz](/cgit/wget.git/snapshot/wget-ed0c7c7e0e8f7298352646b2fd6e06a11e242ace.tar.gz) | |

Properly re-implement userinfo parsing (rfc2396)\* src/url.c (url\_skip\_credentials): Properly re-implement userinfo parsing (rfc2396)
The reason why the implementation is based on RFC 2396, an outdated standard,
is that the whole file is based on that RFC, and mixing standard here might be
dangerous.
[Diffstat](/cgit/wget.git/diff/?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace)

| -rw-r--r-- | [src/url.c](/cgit/wget.git/diff/src/url.c?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace) | 40 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 34 insertions, 6 deletions

| diff --git a/src/url.c b/src/url.cindex 69e948b..07c3bc8 100644--- a/[src/url.c](/cgit/wget.git/tree/src/url.c?id=bb59ef7fd414cd6a68b58283cd868f55cb3c9a6c)+++ b/[src/url.c](/cgit/wget.git/tree/src/url.c?id=ed0c7c7e0e8f7298352646b2fd6e06a11e242ace)@@ -41,6 +41,7 @@ as that of the covered work. \*/ #include "url.h" #include "host.h" /\* for is\_valid\_ipv6\_address \*/ #include "c-strcase.h"+#include "c-ctype.h"  #ifdef HAVE\_ICONV # include <iconv.h>@@ -526,12 +527,39 @@ scheme\_leading\_string (enum url\_scheme scheme) static const char \* url\_skip\_credentials (const char \*url) {- /\* Look for '@' that comes before terminators, such as '/', '?',- '#', or ';'. \*/- const char \*p = (const char \*)strpbrk (url, "@/?#;");- if (!p || \*p != '@')- return url;- return p + 1;+ /\*+ \* This whole file implements https://www.rfc-editor.org/rfc/rfc2396 .+ \* RFC 2396 is outdated since 2005 and needs a rewrite or a thorough re-visit.+ \*+ \* The RFC says+ \* server = [ [ userinfo "@" ] hostport ]+ \* userinfo = \*( unreserved | escaped | ";" | ":" | "&" | "=" | "+" | "$" | "," )+ \* unreserved = alphanum | mark+ \* mark = "-" | "\_" | "." | "!" | "~" | "\*" | "'" | "(" | ")"+ \*/+ static const char \*allowed = "-\_.!~\*'();:&=+$,";++ for (const char \*p = url; \*p; p++)+ {+ if (c\_isalnum(\*p))+ continue;++ if (strchr(allowed, \*p))+ continue;++ if (\*p == '%' && c\_isxdigit(p[1]) && c\_isxdigit(p[2]))+ {+ p += 2;+ continue;+ }++ if (\*p == '@')+ return p + 1;++ break;+ }++ return url; }  /\* Parse credentials contained in [BEG, END). The region is expected |
| --- |

generated by [cgit v1.1](https://git.zx2c4.com/cgit/about/) at 2025-01-11 07:26:01 +0000



=== Content from security.netapp.com_435876fc_20250111_072602.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2024-38428 GNU Wget Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20241115-0005)

## CVE-2024-38428 GNU Wget Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20241115-0005 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20241115-0005 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20241115-0005 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20241115-0005 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20241115-0005
**Version:**
3.0

**Last updated:**
12/20/2024

**Status:**
Interim.

**CVEs:** CVE-2024-38428

Overview
#### Summary

Multiple NetApp products incorporate GNU Wget. GNU Wget versions through 1.24.5 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2024-38428](https://nvd.nist.gov/vuln/detail/CVE-2024-38428) | 9.1 (CRITICAL) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

Affected Products
#### Affected Products

* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250

#### Products Under Investigation

* Brocade Fabric Operating System Firmware
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* ONTAP tools for VMware vSphere 10

#### Products Not Affected

* AFF BIOS - A1K/A70/A90
* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A1K/A70/A90
* AFF Baseboard Management Controller (BMC) - A700s
* AFF LOADER- A1K/A70/A90
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade SAN Navigator (SANnav)
* Cloud Volumes ONTAP Mediator
* Data Infrastructure Insights Acquisition Unit (formerly Cloud Insights Acquisition Unit)
* Data Infrastructure Insights Storage Workload Security Agent (formerly Cloud Insights Storage Workload Security Agent)
* Data Infrastructure Insights Telegraf Agent (formerly Cloud Insights Telegraf Agent)
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp DataOps Toolkit
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG5812/SG5860
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* StorageGRID Baseboard Management Controller (BMC) SG5812/SG5860
* System Manager 9.x
* Terraform Provider for ONTAP
* Workload Factory for VMware

Remediation
#### Software Versions and Fixes

None.

This section will be updated as patches are released.

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

mysupport.netapp.com

1 888 4 NETAPP (1 888 463 8277) (U.S. and Canada)

+00 800 44 638277 (EMEA/Europe)

+800 800 80 800 (Asia/Pacific)

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20241115-0005>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20241115 | Initial Public Release |
| 2.0 | 20241122 | ONTAP Select Deploy administration utility moved to Products Not Affected |
| 3.0 | 20241220 | FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250 moved to Affected Products |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from lists.gnu.org_0d554a82_20250111_072602.html ===


| | **bug-wget** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-wget)

---

[[Date Prev](msg00004.html)][[Date Next](msg00006.html)][[Thread Prev](msg00004.html)][[Thread Next](msg00002.html)][[Date Index](index.html#00005)][[Thread Index](threads.html#00005)]

## Re: Semicolon not allowed in userinfo

---

| **From**: | Tim RÃ¼hsen |
| --- | --- |

| **Subject**: | Re: Semicolon not allowed in userinfo |
| **Date**: | Sun, 2 Jun 2024 12:53:33 +0200 |
| **User-agent**: | Mozilla Thunderbird |

---

```

Hey Bachir,

```
thank you for going into the details and bringing up the concerns and
also for keeping pushing.
```

I just pushed ed0c7c7e0e8f7298352646b2fd6e06a11e242ace to fix the
issue.

```
Indeed, the URL parser implementation of wget 1.x is based on RFC 2396,
a standard from 1998.
But even by this outdated standard, the implementation of the userinfo
parsing was not correct. It hopefully is correct now.
```

```
Anyway, nobody is going to lift the whole URL parsing of wget 1.x to
newer standards. But we have wget2 and Fedora 40 recently switched to
using wget2 instead of wget (of course there are corner cases that break
backward compatibility).
```

Regards, Tim

On 6/2/24 01:27, Bachir Bendrissou wrote:

```
> ```
>
> Hi Tim,
>
> Thank you for your email.
>
>
> ```
> First, the current behavior of wget 1.x contradicts the URI standard
> defined in RFC 3986, which allows semicolons in the userinfo segment.
> Ensuring compliance with this widely accepted standard is essential for
> \_interoperability and correctness\_.
> ```
>
>
>
> ```
> Second, the discrepancy in how wget 1.x handles semicolons in the
> userinfo segment of a URL can potentially lead to \_security
> vulnerabilities\_. Here are a few ways this could happen:
> ```
>
>
> *Misinterpretation of Userinfo Data:*
>
>
> ```
> Authentication Details: If wget 1.x incorrectly parses the userinfo
> segment, it may fail to properly handle authentication details. For
> example, if a URL contains credentials such as user:pass or user;pass,
> misinterpretation could lead to failed authentication attempts or the
> exposure of sensitive information.
> ```
>
>
> *Phishing and Spoofing Attacks:*
>
>
> ```
> Host Header Manipulation: Attackers might craft URLs that, due to
> incorrect parsing by wget 1.x, lead to connections to unintended hosts.
> This can be exploited in phishing attacks where the user believes they
> are connecting to a legitimate server, but are actually redirected to a
> malicious one.
> ```
>
>
> *Man-in-the-Middle Attacks:*
>
>
> ```
> Incorrect DNS Resolution: If wget 1.x misinterprets the userinfo segment
> as part of the hostname, it could result in DNS queries to incorrect or
> malicious domains. This can be leveraged in man-in-the-middle attacks
> where the attacker intercepts and manipulates the communication.
> ```
>
>
> *Data Leakage:*
>
>
> ```
> Insecure Handling of Userinfo: When userinfo is misinterpreted,
> sensitive information (like usernames and passwords) might be logged or
> displayed in error messages, leading to unintended exposure of credentials.
> ```
>
>
> Thanks,
> Bachir
>
>
>
> ```
> On Sat, Jun 1, 2024 at 5:42â¯PM Tim RÃ¼hsen <tim.ruehsen@gmx.de
> <mailto:tim.ruehsen@gmx.de>> wrote:
> ```
>
>
>     Hi Bachir,
>
>     wget2 "a;bc@xyz"
>     wget2: Failed to resolve 'xyz' (Name or service not known)
>
>     Is there a real-life problem that requires wget 1.x to accept a
>     semicolon in the userinfo field?
>
>     Regards, Tim
>
>     On 5/14/24 12:42, Bachir Bendrissou wrote:
>      > Hi,
>      >
>      > The URL example below contains a semicolon in the userinfo segment.
>      >
>      > In the example, wget does not recognise the userinfo segment, and
>      > instead treats it as part of the hostname. When the semicolon is
>      > removed, the userinfo is recognised and is no longer processed as
>      > hostname. The rejection of semicolons in userinfo creates a parsing
>      > discrepancy with other URL parsers.
>      >
>      > curl "a;bc@xyz"
>      > curl: (6) Could not resolve host: xyz
>      >
>      > wget "a;bc@xyz"
>      > wget: unable to resolve host address âa;bc@xyzâ
>      >
>      > wget "abc@xyz"
>      > wget: unable to resolve host address âxyzâ
>      >
>      > You can replicate the above cases after disconnecting from your DNS.
>      >
>      > Thank you,
>      > Bachir
>      >
>
>
> ```

**[![Attachment:](/icons/generic.png)](pgpdlhDmjbn1i.pgp)
[OpenPGP\_signature.asc](pgpdlhDmjbn1i.pgp)**

*Description:* OpenPGP digital signature

---

reply via email to

---

| [[Prev in Thread](msg00004.html)] | **Current Thread** | [Next in Thread] |
| --- | --- | --- |

* **[Re: Semicolon not allowed in userinfo](msg00001.html)**, *Tim RÃ¼hsen*, 2024/06/01
  + **[Re: Semicolon not allowed in userinfo](msg00004.html)**, *Bachir Bendrissou*, 2024/06/01
    - **Re: Semicolon not allowed in userinfo**,
      *Tim RÃ¼hsen* **<=**

---

* Prev by Date:
  **[Re: Semicolon not allowed in userinfo](msg00004.html)**
* Next by Date:
  **[Re: Wget 1 is not preserving server-side modification times via FTP](msg00006.html)**
* Previous by thread:
  **[Re: Semicolon not allowed in userinfo](msg00004.html)**
* Next by thread:
  **[Re: Wget 1 is not preserving server-side modification times via FTP](msg00002.html)**
* Index(es):
  + [**Date**](index.html#00005)
  + [**Thread**](threads.html#00005)


