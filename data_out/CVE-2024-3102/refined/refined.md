Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**
The vulnerability stems from a lack of proper type coercion when handling user input during authentication. Specifically, the `username` and `password` fields, which are expected to be strings, were not explicitly converted to strings before being used in database queries and password comparison, respectively.

**Weaknesses/Vulnerabilities Present:**
* **Type Confusion/Type Coercion Issue:** The code was not ensuring that `username` and `password` from the request body were strings before being used. This allows for potential bypass via type confusion if an attacker sends the username or password as a different type like an object.
* **Authentication Bypass (Potential):** By not explicitly coercing input to string type, an attacker might be able to bypass the intended authentication logic. Specifically, if the database or bcrypt compare functions do not behave as expected with non-string inputs.

**Impact of Exploitation:**
* **Authentication Bypass:** A successful exploit could allow an attacker to bypass authentication and gain unauthorized access to the system.
* **Data Breach:** Once authenticated, an attacker could potentially access sensitive data or perform actions they are not authorized to do.

**Attack Vectors:**
* **Malicious API Requests:** An attacker can craft malicious API requests to the `/system/login` endpoint, sending non-string values for `username` or `password`.

**Required Attacker Capabilities/Position:**
* **Network Access:** An attacker needs network access to the API endpoint of the affected system.
* **Understanding of API Structure:** An attacker would need to know the structure of the login request body and the relevant fields, `username` and `password`.

**Technical Details:**
The provided diff highlights the fix:
```diff
--- a/server/endpoints/system.js
+++ b/server/endpoints/system.js
@@ -105,7 +105,7 @@
   if (await SystemSettings.isMultiUserMode()) {
     const { username, password } = reqBody(request);
     const existingUser = await User.get({ username });
-    const existingUser = await User.get({ username: String(username) });
+    const existingUser = await User.get({ username: String(username) });
 
     if (!existingUser) {
       await EventLogs.logEvent(
@@ -125,7 +125,7 @@
       return;
     }
 
-    if (!bcrypt.compareSync(password, existingUser.password)) {
+    if (!bcrypt.compareSync(String(password), existingUser.password)) {
       await EventLogs.logEvent(
         "failed_login_invalid_password",
         {
```
The fix adds `String()` to coerce `username` and `password` to string type before use.