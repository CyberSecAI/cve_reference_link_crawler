- **Root cause of vulnerability:** A stack buffer overflow vulnerability exists in the `update_dev_name` function within the `libtd_server.so` library of the Tenda RX9 Pro router. The function incorrectly calculates the buffer size when handling device names with Chinese characters (encoding "cn"), leading to a buffer overflow.

- **Weaknesses/vulnerabilities present:**
    - Stack buffer overflow: The `update_dev_name` function uses `strcpy` without proper bounds checking when copying the `devName` string into a fixed-size buffer on the stack.
    - Incorrect length calculation: The function only uses the length of the `devName` parameter, without considering the other parameter that will be copied before, resulting in writing beyond the allocated buffer when the encoding is "cn".

- **Impact of exploitation:**
    - Remote code execution: A successful buffer overflow can overwrite return addresses and other stack data, allowing an attacker to execute arbitrary code.
    - Denial of service: Sending a `mac` parameter with one additional byte causes the router to enter a `trap()` state, which leads to a denial-of-service condition requiring a device restart.

- **Attack vectors:**
    - HTTP POST request: The vulnerability is triggered by sending a crafted HTTP POST request to the `/goform/SetOnlineDevName` endpoint.
    - Specific parameters: The vulnerable function takes two parameters: `mac` and `devName`. The `devName` parameter is used to trigger the buffer overflow when the device's language setting is Chinese ("cn").

- **Required attacker capabilities/position:**
    - Network access: The attacker needs network access to the router's web interface.
    - Authentication: The attacker must be authenticated to send requests to `/goform/SetOnlineDevName`.