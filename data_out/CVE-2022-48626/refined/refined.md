The provided content relates to CVE-2022-48626.

**Root cause of vulnerability:**
The vulnerability is a use-after-free in the `moxart_remove()` function within the Linux kernel's MMC host driver for the Moxart platform.

**Weaknesses/vulnerabilities present:**
- Use-after-free: The code accesses the `mmc_host` structure after it has been freed, leading to a potential crash or other undefined behavior.

**Impact of exploitation:**
- The impact could lead to system crashes due to accessing freed memory.

**Attack vectors:**
- The vulnerability can be triggered when the MMC host is removed from the system (e.g., during device shutdown or unbinding of the driver).

**Required attacker capabilities/position:**
- An attacker needs to trigger the removal of the Moxart MMC host device to exploit this vulnerability. This might require some form of control over the system, such as the ability to unbind the driver or trigger a system shutdown.

**Technical details:**
The `moxart_remove()` function frees the `mmc_host` structure using `mmc_free_host(mmc);`. However, after this call, it attempts to access `host->base` to write to registers, resulting in the use-after-free condition. The fix involves saving the `host->base` register value before freeing the `mmc_host` structure and using the saved register value instead of accessing the pointer after the structure has been freed.
```diff
--- a/drivers/mmc/host/moxart-mmc.c
+++ b/drivers/mmc/host/moxart-mmc.c
@@ -705,12 +705,12 @@
 	if (!IS_ERR_OR_NULL(host->dma_chan_rx))
 		dma_release_channel(host->dma_chan_rx);
 
-	mmc_remove_host(mmc);
-	mmc_free_host(mmc);
+    mmc_remove_host(mmc);
+	
 	writel(0, host->base + REG_INTERRUPT_MASK);
 	writel(0, host->base + REG_POWER_CONTROL);
 	writel(readl(host->base + REG_CLOCK_CONTROL) | CLK_OFF, host->base + REG_CLOCK_CONTROL);
+    mmc_free_host(mmc);
 
 	return 0;
 }
```