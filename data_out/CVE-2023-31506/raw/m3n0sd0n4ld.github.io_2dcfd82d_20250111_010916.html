<!DOCTYPE html>

<!--
  portfolYOU Jekyll theme by yousinix
  Free for personal and commercial use under the MIT license
  https://github.com/yousinix/portfolYOU
-->

<html lang="en" class="h-100">

<head>

  
  
  

  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:type" content="website">
  <meta property="og:title" content="Grav &lt;= 1.7.44 - Stored XSS (Authenticated) (CVE-2023-31506)">
  <meta property="og:description" content="Crónicas Cuacfantásticas del Pato Suertudo.">
  <meta property="og:image" content="https://avatars.githubusercontent.com/u/54067582?v=4">

  <title>Grav &lt;= 1.7.44 - Stored XSS (Authenticated) (CVE-2023-31506)</title>
  <meta name="description" content="Crónicas Cuacfantásticas del Pato Suertudo.">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico">

  <!-- Theme style -->
  <script src="/assets/js/theme.js"></script>

  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">

  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">

  <!-- Animate CSS CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/style.css">

</head>


<body class="h-100 d-flex flex-column">

  <main class="flex-shrink-0 container mt-5">
    <nav class="navbar navbar-expand-lg navbar-themed">

  <a class="navbar-brand" href="/"><h5><b>m3n0sd0n4ld</b></h5></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-1x fa-bars text-themed"></i>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav ml-auto"><a class="nav-item nav-link " href="/mickey-tools/">Mickey-Herramientas</a>

      <a class="nav-item nav-link active" href="/patoHackventuras/">PatoHackventuras</a>

      <a class="nav-item nav-link " href="/about/">Sobre mi pedigree</a>

      

      <span id="theme-toggler" class="nav-item nav-link" role="button" onclick="toggleTheme()"></span>
    </div>
  </div>

</nav>
    <div class="col-lg-10 mx-auto mt-5 markdown-body">
  <h1><b>Grav <= 1.7.44 - Stored XSS (Authenticated) (CVE-2023-31506)</b></h1>

<p class="post-metadata text-muted">
  07 February 2024 -  
  <b>2 mins read time</b>

  <br>Tags: 
    
    <a class="text-decoration-none no-underline" href="/blog/tags#cve">
      <span class="tag badge badge-pill text-primary border border-primary">CVE</span>
    </a>
    
    <a class="text-decoration-none no-underline" href="/blog/tags#0day">
      <span class="tag badge badge-pill text-primary border border-primary">0day</span>
    </a>
    
    <a class="text-decoration-none no-underline" href="/blog/tags#xss">
      <span class="tag badge badge-pill text-primary border border-primary">XSS</span>
    </a>
    
    <a class="text-decoration-none no-underline" href="/blog/tags#grav">
      <span class="tag badge badge-pill text-primary border border-primary">Grav</span>
    </a>
    
    <a class="text-decoration-none no-underline" href="/blog/tags#cms">
      <span class="tag badge badge-pill text-primary border border-primary">CMS</span>
    </a>
    </p>

<h2 id="introduction">Introduction</h2>
<ul>
  <li><strong>CVE-ID:</strong> <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-31506">CVE-2023-31506</a></li>
  <li><strong>Vulnerability Type:</strong> Stored Cross-Site Scripting (Authenticated)</li>
  <li><strong>Affected Product Code Base:</strong> Grav 1.7.44 (or before)</li>
  <li><strong>Affected Component:</strong> Affects the CMS text editor (e.g. articles on the main page).</li>
  <li><strong>Attack Type:</strong> Remote</li>
  <li><strong>Impact:</strong> A remote and authenticated attacker (editor role or permissions to publish), would manage to inject malicious JavaScript code in the form fields to be executed on the users or administrators of the application when accessing the article or another area of the application.</li>
  <li><strong>Attack Vectors:</strong> To exploit the vulnerability, you need to be authenticated with a user with editor or publisher access.</li>
</ul>

<h2 id="description">Description</h2>
<p>A remote and authenticated attacker (editor role or permissions to publish), would manage to inject malicious JavaScript code in the form fields to be executed on the users or administrators of the application when accessing the article or another area of the application.</p>

<h2 id="disclaimer">Disclaimer</h2>
<p>The information contained in this disclosure is for educational and research purposes only. I am not responsible for any improper or illegal use of the details provided. It is intended to help improve the security of affected systems. System administrators and software owners are advised to take the necessary steps to mitigate the risks associated with this vulnerability. Unauthorized use of the information to exploit systems without permission is illegal and may have criminal consequences.</p>

<h2 id="exploitation">Exploitation</h2>
<p>In the following evidence, the payload used:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">isindex</span> <span class="nx">x</span><span class="o">=</span><span class="dl">"</span><span class="s2">javascript:</span><span class="dl">"</span> <span class="nx">onmouseover</span><span class="o">=</span><span class="dl">"</span><span class="s2">alert('m3n0sd0n4ld')</span><span class="dl">"</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>When saving, the application shows that there is a potential XSS, but has allowed the saving of the file:.</p>

<p><img src="../assets/img/cve-2023-31506/1.png" alt="" /></p>

<p>The following illustration, the victim’s browser is shown, in which the reload or access to the section is performed and the javascript code is executed.</p>

<p><img src="../assets/img/cve-2023-31506/2.png" alt="" /></p>

<h2 id="mitigation">Mitigation</h2>
<ul>
  <li>Perform strict server-side validation for all data entered by the user.</li>
  <li>Correctly escape or filter special characters, preventing them from being printable or executed.</li>
  <li>Filter or restrict entries with certain types of characters used in HTML/JavaScript in the different user input fields.</li>
</ul>

<h2 id="timeline">Timeline</h2>
<ul>
  <li>17/04/2023 - The vendor is notified without response.</li>
  <li>11/05/2023 - MITRE is notified and the CVE identifier is assigned.</li>
  <li>07/02/2024 - MITRE is notified of the status, fulldisclosure is authorized.</li>
  <li>09/02/2024 - NVD published the first details for <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-31506">CVE-2023-31506</a></li>
</ul>

<h2 id="acknowledgments">Acknowledgments</h2>
<p>We would like to thank <a href="https://cve.mitre.org/"><strong>MITRE CVE</strong></a> for their attention and speed in the procedures with the CVE identifier.</p>

<h2 id="references">References</h2>
<ul>
  <li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-31506">Mitre - CVE-2023-31506</a></li>
  <li><a href="https://owasp.org/www-community/attacks/xss/">OWASP - Cross Site Scripting</a></li>
  <li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/03-Testing_for_HTML_Injection">OWASP - HTML Injection</a></li>
</ul>



</div>
  </main>
  <footer class="mt-auto py-3 text-center">

  <small class="text-muted mb-2">
    <i class="fas fa-code"></i> with <i class="fas fa-heart"></i>
    by <strong>David Utón</strong>
  </small>

  <div class="container-fluid justify-content-center"><a class="social mx-1"  href="https://www.github.com/m3n0sd0n4ld"
       style="color: #6c757d"
       onMouseOver="this.style.color='#333333'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-github fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.linkedin.com/in/david-uton"
       style="color: #6c757d"
       onMouseOver="this.style.color='#007bb5'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-linkedin-in fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.twitter.com/David_Uton"
       style="color: #6c757d"
       onMouseOver="this.style.color='#1da1f2'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-twitter fa-1x"></i>
    </a>

</div><small id="attribution">
    theme <a href="https://github.com/yousinix/portfolYOU">portfolYOU</a>
  </small>

</footer>

  
  <!-- GitHub Buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

<!-- Bootstrap JS CDN -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- wow.js CDN & Activation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.js"></script>
<script> new WOW().init(); </script>

<!-- Initialize all tooltips -->
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>
</body>

</html>