

[HashiCorp Discuss](/)

# [HCSEC-2023-22 - Nomad Search API Leaks Information About CSI Plugins](/t/hcsec-2023-22-nomad-search-api-leaks-information-about-csi-plugins/56272)

[Security](/c/security/52)

[security-nomad](https://discuss.hashicorp.com/tag/security-nomad)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

July 19, 2023, 11:19pm

1

**Bulletin ID:** HCSEC-2023-22

**Affected Products / Versions:** Nomad and Nomad Enterprise 0.11 up to 1.5.6 and 1.4.1; fixed in 1.6.0, 1.5.7, and 1.4.11.

**Publication Date:** July 19, 2023

**Summary**

A vulnerability was identified in Nomad and Nomad Enterprise (“Nomad”) such that the search HTTP API can reveal names of available CSI plugins to unauthenticated users or users without the `plugin:read` policy. This vulnerability, CVE-2023-3300, affects Nomad since 0.11 and was fixed in 1.6.0, 1.5.7, and 1.4.11.

**Background**

Nomad provides [a search HTTP API](https://developer.hashicorp.com/nomad/api-docs/search) filtered by ACL policies so that unauthenticated users or users without the appropriate read/list permissions cannot search for objects they don’t have access to. HTTP endpoints are used both internally by Nomad, and externally by administrators or operators to interact with the cluster, and are also secured using mTLS.

**Details**

Internal testing by the Nomad engineering team identified it was possible to bypass intended ACL restrictions on the search API endpoint, which exposed only the names of CSI plugins configured in the cluster.

Nomad administrators should use mTLS for HTTP and RPC endpoints. More requirements and recommendations for a secure Nomad deployment can be found in the [security model](https://developer.hashicorp.com/nomad/docs/concepts/security).

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Nomad 1.6.0, 1.5.7, and 1.4.11, or newer.

See Nomad’s [Upgrading](https://www.nomadproject.io/docs/upgrade) for general guidance on this process.

**Acknowledgement**

This issue was identified by the Nomad engineering team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2022-14 - Nomad Impacted by go-getter Vulnerabilities](https://discuss.hashicorp.com/t/hcsec-2022-14-nomad-impacted-by-go-getter-vulnerabilities/39932)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 6839 | May 24, 2022 |
| [HCSEC-2023-13 - Nomad Unauthenticated Client Agent HTTP Request Privilege Escalation](https://discuss.hashicorp.com/t/hcsec-2023-13-nomad-unauthenticated-client-agent-http-request-privilege-escalation/52375)  [Security](/c/security/52) | 0 | 6042 | April 5, 2023 |
| [HCSEC-2023-21 - Nomad Caller ACL Token's Secret ID is Exposed to Sentinel](https://discuss.hashicorp.com/t/hcsec-2023-21-nomad-caller-acl-tokens-secret-id-is-exposed-to-sentinel/56271)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5588 | July 19, 2023 |
| [Nomad 1.2.6, 1.1.12, and 1.0.18 Released](https://discuss.hashicorp.com/t/nomad-1-2-6-1-1-12-and-1-0-18-released/35553)  [Release Notifications](/c/release-notifications/57) [nomad-release](https://discuss.hashicorp.com/tag/nomad-release) | 0 | 820 | February 10, 2022 |
| [HCSEC-2020-01 - Nomad’s HTTP/RPC Services Allow Unbounded Resource Usage, Susceptible to Unauthenticated Denial of Service](https://discuss.hashicorp.com/t/hcsec-2020-01-nomad-s-http-rpc-services-allow-unbounded-resource-usage-susceptible-to-unauthenticated-denial-of-service/18084)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 4091 | November 25, 2020 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

