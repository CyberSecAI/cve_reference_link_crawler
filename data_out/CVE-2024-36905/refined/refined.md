```
{
  "vulnerability": {
    "root_cause": "The vulnerability is triggered in the Linux kernel when a TCP socket transitions through specific states without proper initialization, leading to a divide-by-zero error. Specifically, the socket goes from TCP_CLOSE to TCP_SYN_SENT to TCP_SYN_RECV, and then shutdown() is called which leads to a premature transition to TCP_FIN_WAIT1. This path bypasses tcp_init_transfer() and tcp_init_buffer_space(), causing a division by zero in tcp_rcv_space_adjust() when the socket attempts to adjust the receive buffer space without the necessary initialization. The issue is a race condition related to the shutdown of TCP_SYN_RECV sockets.",
    "weaknesses": [
      "Improper state handling of TCP sockets during shutdown",
      "Missing initialization of receive buffer space for certain TCP socket states",
      "Race condition when closing sockets quickly"
    ],
    "impact": "Successful exploitation leads to a kernel panic due to a divide-by-zero error, resulting in a denial of service (DoS).",
    "attack_vectors": "The vulnerability can be triggered by a local user with the ability to create network sockets. It may also be exploitable remotely with a specifically crafted program that quickly opens and closes TCP connections in a way that triggers the vulnerability; however, the likelihood of this occurring remotely in typical setups is low.",
     "required_capabilities": "For local exploitation, an attacker needs the ability to execute code on the target system, and create network sockets. For potential remote exploitation, an attacker needs the ability to send packets to a server that has a specific client program with the unusual connection pattern, and be able to quickly open and close TCP connections."
  },
  "additional_details": {
    "cisa_analysis_dispute": "There is a discussion around the CVSS score provided by CISA-ADP. The CISA-ADP CVSS vector specifies the vulnerability as network-reachable and having high impact on Confidentiality and Integrity, resulting in a score of 9.8. This is disputed because a divide-by-zero error generally does not impact confidentiality or integrity, and the vulnerability is difficult to exploit remotely. It has been suggested to revise the CVSS score to reflect a more accurate impact.",
    "affected_versions": "The vulnerability has been present since Linux kernel version 2.6.12-rc2 (2005)",
    "fix_details": "The fix defers the shutdown(SEND_SHUTDOWN) for TCP_SYN_RECV sockets. The fix ensures that the FIN packet is only sent once the socket transitions out of TCP_SYN_RECV to the TCP_ESTABLISHED state which guarantees the initialization of receive buffer space. Allocations for sending the FIN packet are changed to GFP_ATOMIC.",
        "affected_products": [
            "AFF Baseboard Management Controller (BMC) - A700s",
            "Active IQ Unified Manager for VMware vSphere",
            "E-Series SANtricity OS Controller Software 11.x",
            "FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400",
            "FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250",
            "NetApp HCI Baseboard Management Controller (BMC) - H610C",
            "NetApp HCI Baseboard Management Controller (BMC) - H610S",
            "NetApp HCI Baseboard Management Controller (BMC) - H615C",
            "ONTAP Select Deploy administration utility",
            "ONTAP tools for VMware vSphere 9",
             "SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine",
            "Multiple NetApp products incorporate Linux kernel"
        ],
        "not_affected_products": [
            "AFF BIOS - A1K/A70/A90",
            "AFF BIOS - A700s",
             "AFF Baseboard Management Controller (BMC) - A1K/A70/A90",
              "AFF LOADER- A1K/A70/A90",
              "ATTO FibreBridge - 7600N",
              "Active IQ Unified Manager for Linux",
              "Active IQ Unified Manager for Microsoft Windows",
              "Active IQ mobile app",
              "Astra Control Center",
              "Astra Control Center - NetApp Kubernetes Monitoring Operator",
              "Astra Control Provisioner",
              "Astra Trident",
              "Astra Trident Autosupport",
               "BlueXP Classification",
               "Brocade Fabric Operating System Firmware",
                "Brocade SAN Navigator (SANnav)",
                 "Cloud Volumes ONTAP Mediator",
                 "Data Infrastructure Insights Acquisition Unit (formerly Cloud Insights Acquisition Unit)",
                  "Data Infrastructure Insights Storage Workload Security Agent (formerly Cloud Insights Storage Workload Security Agent)",
                   "Data Infrastructure Insights Telegraf Agent (formerly Cloud Insights Telegraf Agent)",
                   "E-Series BIOS",
                    "E-Series SANtricity Unified Manager and Web Services Proxy",
                    "Element .NET SDK",
                     "Element HealthTools",
                    "Element JAVA SDK",
                     "Element Plug-in for vCenter Server",
                     "Element Powershell Tools",
                      "Element Python SDK",
                      "FAS/AFF BIOS - 2820",
                      "FAS/AFF BIOS - 8300/8700/A400/C400",
                      "FAS/AFF BIOS - A250/500f/C250",
                      "FAS/AFF BIOS - A300/8200/C190/A220/2720/2750/A150",
                      "FAS/AFF BIOS - A320",
                      "FAS/AFF BIOS - A700/9000",
                      "FAS/AFF BIOS - A800/C800",
                      "FAS/AFF BIOS - A900/9500",
                      "FAS/AFF Baseboard Management Controller (BMC) - A320",
                      "FAS/AFF Baseboard Management Controller (BMC) - A800/C800",
                      "FAS/AFF Baseboard Management Controller (BMC) - A900/9500",
                      "FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750",
                      "FAS/AFF Baseboard Management Controller (BMC) - FAS2820",
                      "FAS/AFF Service Processor - A300/8200",
                      "FAS/AFF Service Processor - A700/9000",
                      "Global File Cache",
                      "Host Utilities - SAN for Linux",
                      "Host Utilities - SAN for Windows",
                      "IOM12 SAS Disk Shelf Firmware",
                      "IOM12B SAS Disk Shelf Firmware",
                      "IOM12E SAS Disk Shelf Firmware",
                      "IOM12F SAS Disk Shelf Firmware",
                      "IOM12G SAS Disk Shelf Firmware",
                      "IOM6 SAS Disk Shelf Firmware",
                       "IOM6E SAS Disk Shelf Firmware",
                       "Management Services for Element Software and NetApp HCI",
                       "MetroCluster DataCollector",
                      "MetroCluster Tiebreaker",
                      "Multipath I/O (SANtricity DSM for Windows MPIO)",
                      "NetApp BlueXP",
                      "NetApp Converged Systems Advisor Agent",
                      "NetApp DataOps Toolkit",
                      "NetApp E-Series Host Collection",
                      "NetApp E-Series SANtricity Collection",
                      "NetApp HCI Compute Node BIOS",
                      "NetApp HCI Storage Node BIOS",
                      "NetApp Kubernetes Monitoring Operator",
                       "NetApp Manageability SDK",
                       "NetApp NFS Plug-in for VMware VAAI",
                       "NetApp ONTAP PowerShell Toolkit (PSTK)",
                       "NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)",
                       "NetApp XCP NFS",
                       "NetApp XCP SMB",
                       "ONTAP 9",
                       "ONTAP Antivirus Connector",
                       "ONTAP Mediator",
                       "OnCommand Insight",
                       "OnCommand Workflow Automation",
                       "RcfFileGenerator for MetroCluster IP",
                       "SANtricity Storage Plugin for vCenter",
                       "SRA Plugin for Linux",
                        "SRA Plugin for Windows",
                       "Single Mailbox Recovery",
                       "Snap Creator Framework",
                       "SnapCenter",
                       "SnapGathers",
                       "SnapManager for Hyper-V",
                      "SolidFire Storage Replication Adapter",
                      "StorageGRID (formerly StorageGRID Webscale)",
                      "StorageGRID BIOS SG1000/SG100/SG1100/SG110",
                      "StorageGRID BIOS SG5660/SG5612/SG5760/SG5712",
                      "StorageGRID BIOS SG5812/SG5860",
                      "StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160",
                      "StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100",
                      "StorageGRID Baseboard Management Controller (BMC) SG5812/SG5860",
                       "System Manager 9.x",
                       "Terraform Provider for ONTAP",
                       "Workload Factory for VMware"
        ]
  }
}
```