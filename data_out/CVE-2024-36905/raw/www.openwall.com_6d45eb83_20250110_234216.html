<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - Re: CVE-2024-36905: Linux kernel: Divide-by-zero on shutdown of TCP_SYN_RECV sockets</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://twitter.com/openwall">
Follow @Openwall on Twitter for new release announcements and other news</a>

</TABLE>
</TABLE>

<a href="3">[&lt;prev]</a> <a href="5">[next&gt;]</a> <a href="../../../2024/10/30/1">[&lt;thread-prev]</a> <a href="5">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;20241112145853.GA6243&#64;openwall.com&gt;
Date: Tue, 12 Nov 2024 15:58:53 +0100
From: Solar Designer &lt;solar&#64;...nwall.com&gt;
To: oss-security&#64;...ts.openwall.com
Subject: Re: CVE-2024-36905: Linux kernel: Divide-by-zero on shutdown of TCP_SYN_RECV sockets

On Tue, Oct 29, 2024 at 09:09:01PM -0500, Jacob Bachmeyer wrote:
&gt; On 10/29/24 08:03, Joel GUITTET wrote:
&gt; &gt;We would like to ask your advice about the CVE-2024-36905 (tcp shutdown
&gt; &gt;vulnerability).
&gt; &gt;NIST indicates a network vector while AWS and Red Hat indicates local
&gt; &gt;attack vector.
&gt; &gt;Our cybersecurity team has difficulties to justify that a local vector is
&gt; &gt;appropriate here.
&gt; &gt;Can you help us to understand this specific point for this CVE ? The
&gt; &gt;hypothesis we have is that a TCP socket need to be open/closed quickly,
&gt; &gt;and maybe it's not possible remotely ?
&gt;
&gt; From my understanding of Git commit
&gt; 94062790aedb505bdda209b10bea47b294d6394f
&gt; (&lt;URL:<a href="https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=94062790aedb505bdda209b10bea47b294d6394f" rel="nofollow">https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=94062790aedb505bdda209b10bea47b294d6394f</a>&gt;),
&gt; this appears to be a race condition where a program (running locally) calls
&gt; connect(2) and then shutdown(2) without actually attempting to transfer any
&gt; data, with a further constraint that certain packets (I am unsure precisely
&gt; what) must have been transferred such that the TCP connection is
&gt; half-opened.  It *might* be possible to cause this crash remotely if a
&gt; program attempts to set up a unidirectional TCP connection (achieved by
&gt; shutting down the undesired direction) but I am unsure if any such programs
&gt; are actually in use.
&gt;
&gt; I would need to further study the Linux networking code to be sure, but
&gt; a comment updated in the patch seems to imply that this is an edge case
&gt; that was previously believed to be impossible to reach.  I suspect NIST
&gt; labeled it "network" because TCP is involved, but as of this writing
&gt; &lt;URL:<a href="https://nvd.nist.gov/vuln/detail/CVE-2024-36905" rel="nofollow">https://nvd.nist.gov/vuln/detail/CVE-2024-36905</a>&gt; says "This
&gt; vulnerability is currently awaiting analysis." so I would expect NIST's
&gt; indication to be revised after that analysis is completed.

NIST doesn't appear to provide their own CVSS vectors/scores lately.
However, they republish (with attribution) some third-party ones, this
time from CISA-ADP.  The CISA-ADP CVSS vector for this vulnerability
specifies that it not only is network-reachable, but also that it has
High impact not only on Availability, but also on Confidentiality and
Integrity.  This results in a CVSSv3.1 score of 9.8.  Even merely
correcting the vector not to claim any Confidentiality and Integrity
impact (as a divide-by-zero generally does not have that) would bring
the score down significantly.

So a question for this list/thread may be - where/how may we dispute
CISA-ADP analysis?  Maybe someone would reply with specific contact info
for them, and Joel would proceed with that.

Also, this bug existed since prehistoric times.  The commit referenced
above says:

Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")

This is git commit from 2005, which says "Initial git repository build."

If the issue were in fact network-reachable with low access complexity
and no user interaction required (as the CISA-ADP CVSS vector claims),
then we'd have had plenty of Linux systems on the Internet crashing with
divide-by-zero in the kernel very often.  Since we didn't notice that,
and since the bug doesn't involve e.g. any magic numbers, this disproves
that it's easily triggerable over network in typical setups.

&gt; Again, this issue is probably only remotely exploitable if the host is
&gt; running a very unusual client program, but a local exploit can supply
&gt; the required oddly-behaving program.

Joel wasn't subscribed to oss-security at the time, but has since
subscribed and wanted to post a follow-up question, which I am doing to
add it to the thread:

"Thanks for your reply Jacob.
Anyone able to comment about Red Hat or AWS justifications on this CVE ?"

To me, the above is already that kind of comment, but perhaps Joel would
like to hear specifically from Red Hat and AWS.

Alexander
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
