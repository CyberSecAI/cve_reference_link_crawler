
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2F12end%2F68c0c58d2564ef4141bccd4651480820)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2F12end%2F68c0c58d2564ef4141bccd4651480820&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2F12end%2F68c0c58d2564ef4141bccd4651480820) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2F12end%2F68c0c58d2564ef4141bccd4651480820&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@12end](https://avatars.githubusercontent.com/u/46096442?s=64&v=4)](/12end)

# [12end](/12end)/**[CVE-2024-46946.txt](/12end/68c0c58d2564ef4141bccd4651480820)**

Last active
December 27, 2024 06:35

Show Gist options

* [Download ZIP](/12end/68c0c58d2564ef4141bccd4651480820/archive/4f2e451f8853558e59e8253b0de14acc056b2313.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2F12end%2F68c0c58d2564ef4141bccd4651480820)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2F12end%2F68c0c58d2564ef4141bccd4651480820)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/12end/68c0c58d2564ef4141bccd4651480820.js&quot;&gt;&lt;/script&gt;
* Save 12end/68c0c58d2564ef4141bccd4651480820 to your computer and use it in GitHub Desktop.

[Code](/12end/68c0c58d2564ef4141bccd4651480820)
[Revisions
2](/12end/68c0c58d2564ef4141bccd4651480820/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/12end/68c0c58d2564ef4141bccd4651480820.js&quot;&gt;&lt;/script&gt;

Save 12end/68c0c58d2564ef4141bccd4651480820 to your computer and use it in GitHub Desktop.

[Download ZIP](/12end/68c0c58d2564ef4141bccd4651480820/archive/4f2e451f8853558e59e8253b0de14acc056b2313.zip)

CVE-2024-46946: Remote Code Execution in LangChain's SymbolicMathChain

 [Raw](/12end/68c0c58d2564ef4141bccd4651480820/raw/4f2e451f8853558e59e8253b0de14acc056b2313/CVE-2024-46946.txt)

[**CVE-2024-46946.txt**](#file-cve-2024-46946-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | CVE ID: CVE-2024-46946 |
| --- | --- |
|  | Vulnerability Type: Remote Code Execution |
|  | Affected Component: SymbolicMathChain in LangChain |
|  | Affected Versions: Introduced in commit https://github.com/langchain-ai/langchain/commit/fcccde406dd9e9b05fc9babcbeb9ff527b0ec0c6 |
|  | Discoverer: 12end@cyberkl |
|  |  |
|  | Description: |
|  | A remote code execution vulnerability has been identified in LangChain's SymbolicMathChain component. The vulnerability stems from the use of sympy.sympify() to evaluate mathematical expressions without proper input sanitization. |
|  |  |
|  | The SymbolicMathChain class was introduced in the commit fcccde406dd9e9b05fc9babcbeb9ff527b0ec0c6. It uses a regular expression to match content between ````text` delimiters and passes this content to sympy.sympify() for evaluation. |
|  |  |
|  | However, sympy.sympify() internally uses Python's eval() function, which can lead to arbitrary code execution if not properly restricted. |
|  |  |
|  | Proof of Concept: |
|  | The following payload demonstrates the ability to execute arbitrary system commands: |
|  |  |
|  | ```python |
|  | sympy.sympify("this.\_\_class\_\_.\_\_mro\_\_[8].\_\_subclasses\_\_()[154].\_\_init\_\_.\_\_globals\_\_['\_\_builtins\_\_']['exec']('import os;os.system(\"id\")')") |
|  | ``` |
|  |  |
|  | Impact: |
|  | An attacker who can control the input to SymbolicMathChain could potentially execute arbitrary code on the system running the LangChain application, leading to full system compromise. |
|  |  |
|  | Recommendation: |
|  | It is recommended to implement strict input validation and sanitization before passing any user-controlled input to sympy.sympify(). Consider using a whitelist of allowed mathematical operations and symbols, or explore alternative methods for safe mathematical expression evaluation. |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2F12end%2F68c0c58d2564ef4141bccd4651480820)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

