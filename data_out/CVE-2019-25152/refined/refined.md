Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The root cause of the vulnerability is the lack of input sanitization and output escaping in the "Abandoned Cart Lite for WooCommerce" and "Abandoned Cart Pro for WooCommerce" WordPress plugins. Specifically, user-supplied data from the checkout process is stored in the database without sanitization. This data is later displayed in the WordPress admin dashboard without output escaping.

**Weaknesses/Vulnerabilities:**

*   **Stored Cross-Site Scripting (XSS):** The plugins are vulnerable to stored XSS attacks because they do not sanitize user inputs and do not properly escape the output when displaying the abandoned cart data. This allows malicious JavaScript code to be injected into the database and executed in the administrator's browser.
*   **Lack of Input Sanitization:**  The plugin fails to sanitize user-provided data from checkout fields like `billing_first_name`, `billing_last_name`, `billing_company` and others before storing it in the database.
*  **Lack of Output Escaping**: When this data is displayed in the admin dashboard, it is not sanitized or escaped, allowing any malicious script that was previously injected to execute in the admin's browser.

**Impact of Exploitation:**

*   **Site Takeover:** Attackers can inject malicious JavaScript code that executes when an administrator views the abandoned carts list. This JavaScript can perform actions such as creating rogue administrator accounts, injecting backdoors into plugin files, redirecting users, or stealing session cookies.
*   **Rogue Administrator Accounts:** The malicious script can create a new administrator account with a username like "woouser" and an email address at Mailinator.
*   **Backdoor Injection:** Attackers can inject a PHP backdoor into an inactive plugin, allowing them to execute arbitrary PHP code or system commands on the compromised server.
*   **Data Theft/Manipulation:** Attackers could potentially use XSS to steal sensitive data or manipulate the website's content.

**Attack Vectors:**

*   **Unauthenticated Users:** An unauthenticated user can trigger the vulnerability by filling out the checkout form with malicious JavaScript code in fields such as `billing_first_name`, and `billing_last_name`.
*   **AJAX Request:** The plugin uses AJAX to send the checkout data to the server. The vulnerability is present in the processing of this AJAX request.

**Required Attacker Capabilities/Position:**

*   **No Privileges Needed:** The attacker does not need any privileges or user accounts on the target site to inject the malicious script. They can trigger the vulnerability simply by visiting the checkout page and providing crafted input.
*   **Basic Web Interaction:** The attacker only needs to be able to fill out a form on the website and submit it, requiring no special technical skills.

**Additional Details:**
*   The malicious javascript code injected by attackers fetches a script from a URL shortening service like bit.ly which redirects to a command and control server containing the `visionstat.js` payload.
* The `visionstat.js` payload uses hidden iframes to carry out its malicious actions.
* The plugin vendor implemented a patch that sanitizes the inputs using `sanitize_text_field` function and a cleanup function that removes `<` symbols from the stored data and removes the `woouser` account, if it exists. However, this cleanup function might not be enough to completely secure the website since it does not detect secondary backdoors injected in the plugin files.

The vulnerability is present in versions of "Abandoned Cart Lite for WooCommerce" prior to 5.2.0 and "Abandoned Cart Pro for WooCommerce" prior to 7.13.0.