=== Content from gitlab.freedesktop.org_ed9477e5_20250108_114741.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

# matroska: segfault / potential heap overflow in zlib decoding

### Describe the vulnerability

Integer overflow while decoding zlib encoded data in `gst_matroska_decompress_data`.

The given crashing POC [zlib-decode-overflow-1.mkv](/-/project/1357/uploads/ee211272daad143cc74ed775a5b8ae85/zlib-decode-overflow-1.mkv) has a block that when zlib decompressed is `0x100000000`.

This overflows the `new_size` integer here:
<https://gitlab.freedesktop.org/gstreamer/gstreamer/-/blob/main/subprojects/gst-plugins-good/gst/matroska/matroska-read-common.c#L117>

One potential root cause is that the `zstream` data counters are 64-bit:
<https://gitlab.freedesktop.org/gstreamer/gstreamer/-/blob/main/subprojects/gst-plugins-good/gst/matroska/matroska-read-common.c#L105>

while 32-bit integers are used to store the size in `gst_matroska_decompress_data`
<https://gitlab.freedesktop.org/gstreamer/gstreamer/-/blob/main/subprojects/gst-plugins-good/gst/matroska/matroska-read-common.c#L80>

#### Expected Behavior

Not segfault.

#### Observed Behavior

Segfault

#### Setup

* **Operating System:** Ubuntu 20.04.4
* **Device:** Computer
* **GStreamer Version:** 1.16.2
* **Command line:** `gst-play-1.0 ./zlib-decode-overflow-1.mkv`

### Steps to reproduce the bug

1. Download [zlib-decode-overflow-1.mkv](/-/project/1357/uploads/ee211272daad143cc74ed775a5b8ae85/zlib-decode-overflow-1.mkv)
2. Run `gst-play-1.0 ./zlib-decode-overflow-1.mkv` (takes about 8 seconds to trigger on my system)

### How reproducible is the bug?

Always

### Impact

Depending on the libc used, and the underlying OS capabilities, it could be just a segfault or a heap overwrite.

If the libc uses mmap for large chunks, and the OS supports mmap, then it is just a segfault (because the realloc before the integer overflow will use mremap to reduce the size of the chunk, and it will start to write to unmapped memory).

However, if using a libc implementation that does not use mmap, or if the OS does not support mmap while using libc, then this would likely result in a heap overwrite.

### Additional Information

Not sure if this qualifies for a CVE, not sure what this project does in the past. Happy to discuss.

Thanks!

Edited May 18, 2022 by [Adam Doupe](/adamdoupe)

Assignee
Loading

Time tracking
Loading



=== Content from lists.debian.org_94d1d083_20250108_114741.html ===


---

[[Date Prev](msg00000.html)][[Date Next](msg00002.html)]
[[Thread Prev](msg00000.html)][[Thread Next](msg00002.html)]
[[Date Index](maillist.html#00001)]
[[Thread Index](threads.html#00001)]

# [SECURITY] [DLA 3069-1] gst-plugins-good1.0 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3069-1] gst-plugins-good1.0 security update
* *From*: Sylvain Beucler <beuc@beuc.net>
* *Date*: Tue, 9 Aug 2022 17:51:07 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20220809155107.GA5552%40mail.beuc.net)Â [20220809155107.GA5552@mail.beuc.net](msg00001.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3069-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                     Sebastian Dro"ge
August 09, 2022                               <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : gst-plugins-good1.0
Version        : 1.14.4-1+deb10u2
CVE ID         : CVE-2022-1920 CVE-2022-1921 CVE-2022-1922 CVE-2022-1923
                 CVE-2022-1924 CVE-2022-1925 CVE-2022-2122

Multiple vulnerabilities were discovered in plugins for the GStreamer
media framework, which may result in denial of service or potentially
the execution of arbitrary code if a malformed media file is opened.

For Debian 10 buster, these problems have been fixed in version
1.14.4-1+deb10u2.

We recommend that you upgrade your gst-plugins-good1.0 packages.

For the detailed security status of gst-plugins-good1.0 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/gst-plugins-good1.0>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIyBAEBCgAdFiEE1vEOfV7HXWKqBieIDTl9HeUlXjAFAmLygaoACgkQDTl9HeUl
XjAF4w/2IeYnhT1RhuX8aRqDAiNdVs8QgF0V7Zo9yQ5DR5d9gZZ3htpk8yZEZ5do
yM5SN6XXAEAy25+/go3jHkeX8fEly0VuXbH/akFxGU7fRXPb4BGUtEBWW+a7OhOM
bKXe1+lTLN9CQCO+QMHPLsW4h3wbHrrx8GlNynfua3hKCKvYc3LIJG9KtmtoynLd
yWXF3+4EWqD5QXg33xTag6zjskXSf2wLbQjbnHx/scenYQGSO3UZV9bT1f19UHWG
paoMaFbiNUOY9j19h+6n9RAIwiyscFPrLu93CWvHrITqyV8On0sAQ565o2zm3sV4
dvxfvHNNVa0Tm9fN1l0Rgb2iLeY2wnsjvS7iCBS8zEaa17xq4TXuPAs2WvnMJvTR
EZzEKJaTrKfbR3hgJeAZwwxRCVj2+ZLDcygZtNMI18GzhHuonWqW/R7b+Ll5sNdw
mSVxbsOrLkeY8pq8dTnIpXrAgZUPQ8r0KAiHx78o0g9PeWcVh83S8sO54Bn/e7/j
9/J20MB2BpCxZOY674/k6neSpU8jAkFfJ320hLgRxiDXpnKSvf2V3JzebrOp0o4K
IteDPJMUXdujm0eWYRlIVcZJdsKw4x3fMFlfC/5GI+5QkkjP+2KvKTI0St+x9FAk
FoLXM0Y+F4QYq9530a6fBa66AKbUdBkQP7yXqwdxAaKMtpykpQ==
=lEIW
-----END PGP SIGNATURE-----

```

---



=== Content from www.debian.org_e8aef0f1_20250108_114741.html ===


---

[[Date Prev](msg00172.html)][[Date Next](msg00174.html)]
[[Thread Prev](msg00172.html)][[Thread Next](msg00174.html)]
[[Date Index](maillist.html#00173)]
[[Thread Index](threads.html#00173)]

# [SECURITY] [DSA 5204-1] gst-plugins-good1.0 security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5204-1] gst-plugins-good1.0 security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Tue, 9 Aug 2022 19:19:23 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20220809191923.GA17878%40seger.debian.org)Â [20220809191923.GA17878@seger.debian.org](msg00173.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5204-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
August 09, 2022                       <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : gst-plugins-good1.0
CVE ID         : CVE-2022-1920 CVE-2022-1921 CVE-2022-1922 CVE-2022-1923
                 CVE-2022-1924 CVE-2022-1925 CVE-2022-2122

Adam Doupe discovered multiple vulnerabilities in the Gstreamer plugins
to demux Mastroska and AVI files which could result in denial of service
or the execution of arbitrary code.

For the stable distribution (bullseye), these problems have been fixed in
version 1.18.4-2+deb11u1.

We recommend that you upgrade your gst-plugins-good1.0 packages.

For the detailed security status of gst-plugins-good1.0 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/gst-plugins-good1.0>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmLysv4ACgkQEMKTtsN8
TjbQ6Q//deQ/E455HEm5jW/IBLsCytvD4d6/mlsKvAuia4b4h6F2d37thjkZ8Cjd
zAUBXifep5FT+M4u0P2ig16kvallnhoPiMlFguqx84yigYFhzeDLv1VK3keGTVdv
1Bo+wrDnQeU+ASErCKMbGYevWP+l908FFZ1xq0EFvtmDZuuCS0kcU4ba0LR4wBXy
1opLeYXSlrnnNddXEdW45Xv0NHF/Opx52edEDH2VbOhleVP88SKy0HRq2hc4Qmec
HsP4uhEwA9+ZOoJaKK80c+3Nbr53L5/hm52bHMNWKwX+GIvMzXafoI5LxdkaF0sz
35h21ahMSMGPgg5IUXYfuWBjN2cwXF/ICHdLoa5q/zLBXs48kU7A3kGVVm0TNWek
NfjJjpcP2/5f36pPRW65HJHcym/jMpMCG8Mru+ra4zu0ixOyKL0h6xIl5g6QZtGz
6PZze9EZ05Wxa2RRr8mA9gal4pWWXTiy1lEczTspohK5tN+WD60r0fRhlGZqrFNy
yL/BKSBmZiUOhx3q8WOs5xlhddX9gE9WN+tCZLK2l0sd8b3F6xA+QcPom7UTNCtd
PvwI25U2YnudZlssVjEKfT7umrwdaadhvC9MHM1gnCMr8yfkFr+Hc5YIKFxPl6mI
gXX1tlWOG3rA9wF6YTFkcr0ldKQqk19aorwGy+WtNg3cDCDNyGM=
=nLED
-----END PGP SIGNATURE-----

```

---


