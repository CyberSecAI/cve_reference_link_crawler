

[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Service desk email address of a project is being leaked through graphql to non-members of the project even If a custom suffix is set for the same.

**[HackerOne report #1439254](https://hackerone.com/reports/1439254)** by `albatraoz` on 2022-01-02, assigned to [@cmaxim](/cmaxim "Costel Maxim"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

I've [reported](https://hackerone.com/reports/1330273) this vulnerability previously too but closed it as N/A myself as the service desk email address is guessable If we have a project name. But this time I saw some activity on gitlab [issues](https://gitlab.com/gitlab-org/gitlab/-/issues/345692 "To document: reporters allowed to see the service desk email address") about the visibility & it has been changed to [reporter](https://docs.gitlab.com/ee/user/project/service_desk.html) & also If any project owner decides to add suffix to their service desk email address to defend the spam, that too would be exposed through graphql.

##### Steps to reproduce

1. Visit <https://gitlab.com/-/graphql-explorer>
2. Put the following graphql query and hit play

```
query{
  project(fullPath:"gitlab-org/gitlab") {
    id
    serviceDeskAddress
  }
}
```

You will see the internal service desk email of the project in the response.

```
{
  "data": {
    "project": {
      "id": "gid://gitlab/Project/278964",
      "serviceDeskAddress": "contact-project+gitlab-org-gitlab-278964-issue-[@]incoming.gitlab.com"
    }
  }
}
```

##### What is the current *bug* behavior?

Service desk email address is visible to non members of a project.

##### What is the expected *correct* behavior?

Service desk email address should be visible only to members of a project with minium reporter level access.

##### Relevant logs and/or screenshots

[![GraphiQL.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/12b3593574ed2e796f9028343bb46b4a7467fd2a/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64623639333737382d656633632d343562622d616432382d3061653437643264353165632f477261706869514c2e706e67)

##### Issue references

[#345692 (closed)](https://gitlab.com/gitlab-org/gitlab/-/issues/345692 "To document: reporters allowed to see the service desk email address")

[!74179 (merged)](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/74179 "Allow reporters to see the service desk email address")

##### Impact reference

[#329446 (comment 563640175)](https://gitlab.com/gitlab-org/gitlab/-/issues/329446#note_563640175 "WebIDE discloses information about private projects")

#### Impact

Even though the service desk email address is guessable If we have the project name, If the owner decides to add a secret suffix only visible & shared with project members, the email address would be leaked to non members through graphql. This can lead to issue spam or vandalism of a project.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [GraphiQL.png](https://h1.sec.gitlab.net/a/db693778-ef3c-45bb-ad28-0ae47d2d51ec/GraphiQL.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.

