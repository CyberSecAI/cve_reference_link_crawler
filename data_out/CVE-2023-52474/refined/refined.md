```
{
  "cveId": "CVE-2023-52474",
  "related": true,
  "vulnerabilities": [
    {
      "rootCause": "The `user_sdma_txadd()` function does not correctly utilize the `user_sdma_iovec->iov.iov_len`, potentially reading past the intended boundary. Additionally, both `user_sdma_txadd()` and `user_sdma_send_pkts()` do not advance to the next iovec when the current one is not page-aligned and lacks sufficient data.",
      "weaknesses": [
        "Incorrect memory access in `user_sdma_txadd()` leading to out-of-bounds reads.",
        "Improper iovec handling in `user_sdma_txadd()` and `user_sdma_send_pkts()` resulting in incorrect data transmission.",
        "Concurrency issues in the SDMA pin cache (`struct mmu_rb_handler`) when handling overlapping memory ranges, leading to duplicate pinnings and potential data corruption.",
        "Race condition in the `mmu_rb_handler` during mmu_rb_node extension, potentially leading to unpinning of all pages.",
         "Race condition in `hfi1_mmu_rb_remove_unless_exact()` due to refcount being incremented outside the lock, possibly leading to eviction of mmu_rb_node by another thread.",
        "Use-after-free vulnerability because SDMA request submission failure path does not check mmu_rb_node->refcount before freeing `mmu_rb_node`."
      ],
      "impact": "Data corruption due to incorrect data being added to SDMA packets or dereferencing freed memory leading to system instability. Additionally, duplicate pinnings could lead to memory exhaustion",
      "attackVectors": "By submitting crafted user SDMA requests with multiple payload iovecs where an iovec other than the tail iovec does not run up to the page boundary for the buffer pointed to by that iovec.",
      "requiredCapabilities": "Attacker needs the ability to submit user SDMA requests."
    }
  ]
}
```