
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFoddy%2Fnode-red-contrib-huemagic%2Fissues%2F217)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFoddy%2Fnode-red-contrib-huemagic%2Fissues%2F217)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Foddy%2Fnode-red-contrib-huemagic)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Foddy](/Foddy)
/
**[node-red-contrib-huemagic](/Foddy/node-red-contrib-huemagic)**
Public

* [Notifications](/login?return_to=%2FFoddy%2Fnode-red-contrib-huemagic) You must be signed in to change notification settings
* [Fork
  68](/login?return_to=%2FFoddy%2Fnode-red-contrib-huemagic)
* [Star
   203](/login?return_to=%2FFoddy%2Fnode-red-contrib-huemagic)

* [Code](/Foddy/node-red-contrib-huemagic)
* [Issues
  84](/Foddy/node-red-contrib-huemagic/issues)
* [Pull requests
  3](/Foddy/node-red-contrib-huemagic/pulls)
* [Discussions](/Foddy/node-red-contrib-huemagic/discussions)
* [Security](/Foddy/node-red-contrib-huemagic/security)
* [Insights](/Foddy/node-red-contrib-huemagic/pulse)

Additional navigation options

* [Code](/Foddy/node-red-contrib-huemagic)
* [Issues](/Foddy/node-red-contrib-huemagic/issues)
* [Pull requests](/Foddy/node-red-contrib-huemagic/pulls)
* [Discussions](/Foddy/node-red-contrib-huemagic/discussions)
* [Security](/Foddy/node-red-contrib-huemagic/security)
* [Insights](/Foddy/node-red-contrib-huemagic/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FFoddy%2Fnode-red-contrib-huemagic%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FFoddy%2Fnode-red-contrib-huemagic%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Security bug in hue-magic.js #217

Closed

[martinzhou2015](/martinzhou2015) opened this issue
Jan 17, 2021
· 1 comment

Closed

# [Security bug in hue-magic.js](#top) #217

[martinzhou2015](/martinzhou2015) opened this issue
Jan 17, 2021
· 1 comment

Labels
[bug](/Foddy/node-red-contrib-huemagic/labels/bug)

## Comments

[![@martinzhou2015](https://avatars.githubusercontent.com/u/13579581?s=80&v=4)](/martinzhou2015)

Copy link

### **[martinzhou2015](/martinzhou2015)** commented [Jan 17, 2021](#issue-787686627) • edited Loading

| **Describe the bug**  The `res.sendFile` API, used in file `hue-magic.js`, introduces a `Path Traversal` vulnerability.     [node-red-contrib-huemagic/huemagic/hue-magic.js](https://github.com/Foddy/node-red-contrib-huemagic/blob/4cb9d2e32bd4fcbf7b04642bbcc80cdc2f3356dd/huemagic/hue-magic.js#L277)  Line 277 in [4cb9d2e](/Foddy/node-red-contrib-huemagic/commit/4cb9d2e32bd4fcbf7b04642bbcc80cdc2f3356dd)   |  | res.sendFile(path.resolve(\_\_dirname, 'animations', 'previews', req.params.file)); | | --- | --- |      **Flow to Reproduce** Since the path isn't protected by `RED.auth.needsPermission` API, the attacker could fetch arbitrary file on the server with the PoC below directly.  ``` http://target_host/hue/assets/..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2fpasswd  ```  **Expected behavior** To fix this vulnerability, `option` of the `res.sendFile` should be specified correctly.  ``` res.sendFile(path [, options] [, fn])  dotfiles : deny  ``` |
| --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@martinzhou2015](https://avatars.githubusercontent.com/u/13579581?s=40&v=4)](/martinzhou2015)
[martinzhou2015](/martinzhou2015)
added
the
[bug](/Foddy/node-red-contrib-huemagic/labels/bug)
label
[Jan 17, 2021](#event-4215006945)

[Foddy](/Foddy)
added a commit
that referenced
this issue
[Jan 9, 2022](#ref-commit-7d45a64)
[![@Foddy](https://avatars.githubusercontent.com/u/5302050?s=40&u=a014d697abd54aacb6e898f39d6fb2a0f5085cbe&v=4)](/Foddy)

`[Update to v4.0.0](/Foddy/node-red-contrib-huemagic/commit/7d45a64e0e17c63ceab8ee259203525ff45c4675 "Update to v4.0.0

> **Attention!** HueMagic v4 + has been almost completely rewritten under the hood and requires at least the (square-shaped) Philips Hue Bridge firmware 1948086000+ from November 1st, 2021 ([Upgrade instructions](https://www.lighting.philips.com/content/B2C/en_US/microsites/meethue/marketing-catalog/huewireless_ca/support/security-advisory/general/where-and-how-can-i-update-my-hue-system-with-the-latest-software.html)) and Node-RED v1 + ([Upgrade instructions](https://nodered.org/docs/getting-started/local#upgrading-node-red)). If you are upgrading from a previous HueMagic version to the v4, you will have to reconfigure (not completely rebuild) all nodes by clicking them and selecting the appropriate device from the list. This also applies to nodes / functions that are operated in universal mode, as the numeric identifiers of the latest Philips Hue API version have been replaced in UUIDs. The nodes \"Hue Switch\", \"Hue Button\" & \"Hue Tap\" have been replaced in v4 by the universal and uniform node \"Hue Buttons\", which works with all button / switch devices that are connected to the Hue Bridge (please note here also the new API in the documentation). The request and return objects of the individual nodes are largely compatible with older HueMagic versions - with the exception of the nodes \"Hue Bridge\", \"Hue Buttons\", \"Hue Scene\" & \"Hue Group\". These need to be adjusted in the v4. Make sure that you meet the minimum technical requirements and have a quiet minute for the migration before upgrading to the v4.

* HueMagic speaks now directly with the bridge without any submodules *(huejay dependency removed)*
* Migrated to the newest CLIP/v2 API version from the Philips Hue bridge
* Nodes are now updated via push notifications (SSE) from the bridge instead of periodic polling
* Instant \"current status\" queries on each node with no loading time
* \"Hue Buttons\" node supports all new Philips Hue buttons/switches (e.g. Dimmer Switch v2, Hue Wall Switch…)
* All nodes provide additional property information in the output (check docs)
* New universal node \"Hue Buttons\" replaces the following nodes: \"Hue Switch\", \"Hue Button\", \"Hue Tap\"
* New \"updated\" object for all nodes, which only contains the properties that have been updated since the last state
* New configuration option to suppress first message after node initialization (for all nodes)
* New gradient color setting for compatible light sources (in \"Hue Light node)
* New inject button for almost all nodes, which triggers the current status of a node
* New \"universal mode\" support for \"Hue Rule\" nodes
* New SVG-version of each node icon for higher quality rendering in the Node-RED UI
* New and full featured examples for each node right inside Node-RED
* New color mix feature in \"Hue Light\" nodes with the ability to mix the current light color with another
* New automatic brightness support based on the current time for \"Hue Light\" & \"Hue Group\" nodes
* New \"Superhero\", \"Neon City\" & \"Christmas\" (for next year, sorry) animations in \"Hue Magic\" node
* The custom alert effect on \"Hue Light\" & \"Hue Group\" nodes can now also be configured in brightness
* All nodes will now also forward the last command that has been applied ([#249](https://github.com/Foddy/node-red-contrib-huemagic/issues/249))
* \"Hue Temperature\" & \"Hue Brightness\" nodes can now also be activated & deactivated
* \"Hue Light\" & \"Hue Group\" nodes can now also receive XY color settings
* \"Hue Light\" & \"Hue Group\" can now also receive a named color temperature setting
* \"Hue Light\" & \"Hue Group\" nodes can now receive future brightness states in \"turned off\" mode ([#244](https://github.com/Foddy/node-red-contrib-huemagic/issues/244))
* Automatic light temperature setting outputs now values from 153 (coldest) to 500 (warmest)
* Automatic color correction based on the light´s capabilities for more accurate color settings
* Optimized node editor configuration UI to better match the current Node-RED´s UI
* The option for \"automatic firmware updates\" on the bridge moved to the bridge configuration node
* \"Hue Group\" node does no longer contain the \"msg.info.model\" & \"msg.info.class\" property
* Fixed timeout connection issues to the bridge
* Fixed an issue with non stopping custom animations ([#222](https://github.com/Foddy/node-red-contrib-huemagic/issues/222)), ([#224](https://github.com/Foddy/node-red-contrib-huemagic/issues/224)) & ([#226](https://github.com/Foddy/node-red-contrib-huemagic/pull/226)) (thx)
* Node-RED will no longer crash if there is no active connection to the bridge ([#237](https://github.com/Foddy/node-red-contrib-huemagic/issues/237))
* Fixed an issue that prevented the light / group from not reporting its own status when queried & node events were deactivated ([#248](https://github.com/Foddy/node-red-contrib-huemagic/issues/248))
* Fixed an issue with nodes in universal mode ([#245](https://github.com/Foddy/node-red-contrib-huemagic/issues/245))
* A possible attack target has been fixed ([#217](https://github.com/Foddy/node-red-contrib-huemagic/issues/217))
* Moved away from \"moment.js\" to \"Day.js\" for date/time formatting inside the nodes
* Updated README and help section on each node
* Updated dependencies to the latest version")`
…

`[7d45a64](/Foddy/node-red-contrib-huemagic/commit/7d45a64e0e17c63ceab8ee259203525ff45c4675)`

```
> **Attention!** HueMagic v4 + has been almost completely rewritten under the hood and requires at least the (square-shaped) Philips Hue Bridge firmware 1948086000+ from November 1st, 2021 ([Upgrade instructions](<https://www.lighting.philips.com/content/B2C/en_US/microsites/meethue/marketing-catalog/huewireless_ca/support/security-advisory/general/where-and-how-can-i-update-my-hue-system-with-the-latest-software.html>)) and Node-RED v1 + ([Upgrade instructions](<https://nodered.org/docs/getting-started/local#upgrading-node-red>)). If you are upgrading from a previous HueMagic version to the v4, you will have to reconfigure (not completely rebuild) all nodes by clicking them and selecting the appropriate device from the list. This also applies to nodes / functions that are operated in universal mode, as the numeric identifiers of the latest Philips Hue API version have been replaced in UUIDs. The nodes "Hue Switch", "Hue Button" & "Hue Tap" have been replaced in v4 by the universal and uniform node "Hue Buttons", which works with all button / switch devices that are connected to the Hue Bridge (please note here also the new API in the documentation). The request and return objects of the individual nodes are largely compatible with older HueMagic versions - with the exception of the nodes "Hue Bridge", "Hue Buttons", "Hue Scene" & "Hue Group". These need to be adjusted in the v4. Make sure that you meet the minimum technical requirements and have a quiet minute for the migration before upgrading to the v4.

* HueMagic speaks now directly with the bridge without any submodules *(huejay dependency removed)*
* Migrated to the newest CLIP/v2 API version from the Philips Hue bridge
* Nodes are now updated via push notifications (SSE) from the bridge instead of periodic polling
* Instant "current status" queries on each node with no loading time
* "Hue Buttons" node supports all new Philips Hue buttons/switches (e.g. Dimmer Switch v2, Hue Wall Switch…)
* All nodes provide additional property information in the output (check docs)
* New universal node "Hue Buttons" replaces the following nodes: "Hue Switch", "Hue Button", "Hue Tap"
* New "updated" object for all nodes, which only contains the properties that have been updated since the last state
* New configuration option to suppress first message after node initialization (for all nodes)
* New gradient color setting for compatible light sources (in "Hue Light node)
* New inject button for almost all nodes, which triggers the current status of a node
* New "universal mode" support for "Hue Rule" nodes
* New SVG-version of each node icon for higher quality rendering in the Node-RED UI
* New and full featured examples for each node right inside Node-RED
* New color mix feature in "Hue Light" nodes with the ability to mix the current light color with another
* New automatic brightness support based on the current time for "Hue Light" & "Hue Group" nodes
* New "Superhero", "Neon City" & "Christmas" (for next year, sorry) animations in "Hue Magic" node
* The custom alert effect on "Hue Light" & "Hue Group" nodes can now also be configured in brightness
* All nodes will now also forward the last command that has been applied ([[#249](https://github.com/Foddy/node-red-contrib-huemagic/issues/249)]([#249](https://github.com/Foddy/node-red-contrib-huemagic/issues/249)))
* "Hue Temperature" & "Hue Brightness" nodes can now also be activated & deactivated
* "Hue Light" & "Hue Group" nodes can now also receive XY color settings
* "Hue Light" & "Hue Group" can now also receive a named color temperature setting
* "Hue Light" & "Hue Group" nodes can now receive future brightness states in "turned off" mode ([[#244](https://github.com/Foddy/node-red-contrib-huemagic/issues/244)]([#244](https://github.com/Foddy/node-red-contrib-huemagic/issues/244)))
* Automatic light temperature setting outputs now values from 153 (coldest) to 500 (warmest)
* Automatic color correction based on the light´s capabilities for more accurate color settings
* Optimized node editor configuration UI to better match the current Node-RED´s UI
* The option for "automatic firmware updates" on the bridge moved to the bridge configuration node
* "Hue Group" node does no longer contain the "msg.info.model" & "msg.info.class" property
* Fixed timeout connection issues to the bridge
* Fixed an issue with non stopping custom animations ([[#222](https://github.com/Foddy/node-red-contrib-huemagic/issues/222)]([#222](https://github.com/Foddy/node-red-contrib-huemagic/issues/222))), ([[#224](https://github.com/Foddy/node-red-contrib-huemagic/issues/224)]([#224](https://github.com/Foddy/node-red-contrib-huemagic/issues/224))) & ([[#226](https://github.com/Foddy/node-red-contrib-huemagic/pull/226)]([#226](https://github.com/Foddy/node-red-contrib-huemagic/pull/226))) (thx)
* Node-RED will no longer crash if there is no active connection to the bridge ([[#237](https://github.com/Foddy/node-red-contrib-huemagic/issues/237)]([#237](https://github.com/Foddy/node-red-contrib-huemagic/issues/237)))
* Fixed an issue that prevented the light / group from not reporting its own status when queried & node events were deactivated ([[#248](https://github.com/Foddy/node-red-contrib-huemagic/issues/248)]([#248](https://github.com/Foddy/node-red-contrib-huemagic/issues/248)))
* Fixed an issue with nodes in universal mode ([[#245](https://github.com/Foddy/node-red-contrib-huemagic/issues/245)]([#245](https://github.com/Foddy/node-red-contrib-huemagic/issues/245)))
* A possible attack target has been fixed ([[#217](https://github.com/Foddy/node-red-contrib-huemagic/issues/217)]([#217](https://github.com/Foddy/node-red-contrib-huemagic/issues/217)))
* Moved away from "moment.js" to "Day.js" for date/time formatting inside the nodes
* Updated README and help section on each node
* Updated dependencies to the latest version
```

[![@Foddy](https://avatars.githubusercontent.com/u/5302050?s=80&u=a014d697abd54aacb6e898f39d6fb2a0f5085cbe&v=4)](/Foddy)

Copy link

Owner

### **[Foddy](/Foddy)** commented [Jan 9, 2022](#issuecomment-1008364023)

| Thank you very much. This has been fixed in the newest update. Better late than never :S |
| --- |

All reactions

Sorry, something went wrong.

[![@Foddy](https://avatars.githubusercontent.com/u/5302050?s=40&u=a014d697abd54aacb6e898f39d6fb2a0f5085cbe&v=4)](/Foddy)
[Foddy](/Foddy)
closed this as [completed](/Foddy/node-red-contrib-huemagic/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jan 9, 2022](#event-5862702897)

[![@Akokonunes](https://avatars.githubusercontent.com/u/46332131?s=40&v=4)](/Akokonunes)
[Akokonunes](/Akokonunes)
mentioned this issue
[Jan 29, 2022](#ref-pullrequest-1118186969)

[Create CVE-2021-25864.yaml
projectdiscovery/nuclei-templates#3631](/projectdiscovery/nuclei-templates/pull/3631)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FFoddy%2Fnode-red-contrib-huemagic%2Fissues%2F217)

Assignees

No one assigned

Labels

[bug](/Foddy/node-red-contrib-huemagic/labels/bug)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@Foddy](https://avatars.githubusercontent.com/u/5302050?s=52&v=4)](/Foddy) [![@martinzhou2015](https://avatars.githubusercontent.com/u/13579581?s=52&v=4)](/martinzhou2015)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

