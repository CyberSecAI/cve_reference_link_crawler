=== Content from bugs.ghostscript.com_68e9efb7_20250111_171918.html ===


Bugzilla ‚Äì Bug¬†697551
mujstest: stack-based buffer overflow in man (jstest\_main.c)
Last modified: 2017-04-29 09:32:37 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New¬†Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=697551&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=697551&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug¬†697551**](show_bug.cgi?id=697551)
- mujstest: stack-based buffer overflow in man (jstest\_main.c)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
mujstest: stack-based buffer overflow in man (jstest\_main.c)

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | MuPDF | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=MuPDF "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | apps ([show other bugs](buglist.cgi?component=apps&product=MuPDF&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 1.10 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | PC Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | P4 normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | MuPDF bugs | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2017-02-05 12:53 UTC by Agostino Sarubbo | | --- | --- | | Modified: | 2017-04-29 09:32 UTC ([History](show_activity.cgi?id=697551)) | | CC List: | 1 user (show)  sebastian.rasmussen | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Customer:](page.cgi?id=fields.html#cf_customer "A custom Free Text field in this installation of Bugzilla.") |  | | [Word Size:](page.cgi?id=fields.html#cf_wordsize "For example x86 would be 32 and x86_64 would be 64.") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**stacktrace**](attachment.cgi?id=13355 "View the content of the attachment") (3.38 KB, text/plain)  [2017-02-05 12:53 UTC](#attach_13355 "Go to the comment associated with the attachment"), Agostino Sarubbo | [Details](attachment.cgi?id=13355&action=edit) | | [Add an attachment](attachment.cgi?bugid=697551&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=697551&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=697551#c0)  Agostino Sarubbo    2017-02-05 12:53:17 UTC  ``` Created [attachment 13355](attachment.cgi?id=13355 "stacktrace") [[details]](attachment.cgi?id=13355&action=edit "stacktrace") stacktrace  Tested on: 1.10a  To reproduce: # mujstest $FILE  Reproducer: <https://github.com/asarubbo/poc/blob/master/00147-mupdf-mujstest-stackoverflow-main> ```  [Comment 1](show_bug.cgi?id=697551#c1)  Sebastian Rasmussen    2017-04-08 19:58:35 UTC  ``` This was resolved in [cfe8f35bca61056363368c343be36812abde0a06](http://www.ghostscript.com/cgi-bin/findgit.cgi?cfe8f35bca61056363368c343be36812abde0a06). ```  [Comment 2](show_bug.cgi?id=697551#c2)  Agostino Sarubbo    2017-04-10 07:35:11 UTC  ``` (In reply to Sebastian Rasmussen from [comment #1](show_bug.cgi?id=697551#c1)) > This was resolved in [cfe8f35bca61056363368c343be36812abde0a06](http://www.ghostscript.com/cgi-bin/findgit.cgi?cfe8f35bca61056363368c343be36812abde0a06).  No, this patch fixed the strcpy-param-overlap issue, but introduced the stack buffer overflow issue. ```  [Comment 3](show_bug.cgi?id=697551#c3)  Sebastian Rasmussen    2017-04-10 20:13:42 UTC  ``` (In reply to Agostino Sarubbo from [comment #2](show_bug.cgi?id=697551#c2)) > (In reply to Sebastian Rasmussen from [comment #1](show_bug.cgi?id=697551#c1)) > > This was resolved in [cfe8f35bca61056363368c343be36812abde0a06](http://www.ghostscript.com/cgi-bin/findgit.cgi?cfe8f35bca61056363368c343be36812abde0a06). >  > No, this patch fixed the strcpy-param-overlap issue, but introduced the > stack buffer overflow issue.  That's not entirely true. The stack buffer overflow was being masked by the issue my patch resolved. I did run your file successfully without issues in both valgrind and gdb before setting this bug as resolved. Prompted by your reponse I figured out how to run asan using gcc and was finally able to see the problem you mentioned.  I have a tentative fix here (which may or may not go into 1.11): <http://git.ghostscript.com/?p=user/sebras/mupdf.git;a=commit;h=06a012a42c9884e3cd653e7826cff1ddec04eb6e>  As well as a related cleanup here: <http://git.ghostscript.com/?p=user/sebras/mupdf.git;a=commit;h=e089b2e2c1d38c5696c7dfd741e21f8f3ef22b14> ```  [Comment 4](show_bug.cgi?id=697551#c4)  Agostino Sarubbo    2017-04-29 06:42:07 UTC  ``` <https://github.com/google/sanitizers/wiki/AddressSanitizerComparisonOfMemoryTools>  Valgrind does not report the stack buffer overflow, this is the reason because you didn't see the bug when you made a patch for the strcpy-param-overlap issue. ```  [Comment 5](show_bug.cgi?id=697551#c5)  Sebastian Rasmussen    2017-04-29 09:32:37 UTC  ``` As I anticipated the fixes [06a012a42c9884e3cd653e7826cff1ddec04eb6e](http://www.ghostscript.com/cgi-bin/findgit.cgi?06a012a42c9884e3cd653e7826cff1ddec04eb6e) and [e089b2e2c1d38c5696c7dfd741e21f8f3ef22b14](http://www.ghostscript.com/cgi-bin/findgit.cgi?e089b2e2c1d38c5696c7dfd741e21f8f3ef22b14) never made it into 1.11, but is on master now and will be in the next release. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=697551)
* -¬†[XML](show_bug.cgi?ctype=xml&id=697551)
* -¬†[Clone This Bug](enter_bug.cgi?cloned_bug_id=697551)
* -¬†Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New¬†Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=697551&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=697551&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from security.gentoo.org_184d12fb_20250111_171919.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# MuPDF: Multiple vulnerabilities ‚Äî GLSA **201706-08**

Multiple vulnerabilities have been found in MuPDF, the worst of
which allows remote attackers to cause a Denial of Service condition or
have other unspecified impact.

### Affected packages

| Package | **app-text/mupdf** on all architectures |
| --- | --- |
| Affected versions | < **1.11-r1** |
| Unaffected versions | >= **1.11-r1** |

### Background

A lightweight PDF, XPS, and E-book viewer.

### Description

Multiple vulnerabilities have been discovered in MuPDF. Please review
the CVE identifiers referenced below for details.

### Impact

A remote attacker could entice a user to process a specially crafted PDF
document or image using MuPDF, possibly resulting in a Denial of Service
condition or have other unspecified impact.

### Workaround

There is no known workaround at this time.

### Resolution

All MuPDF users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-text/mupdf-1.11-r1"

```
### References

* [CVE-2016-10221](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-10221)
* [CVE-2017-5991](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-5991)
* [CVE-2017-6060](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-6060)

**Release date**

June 06, 2017

**Latest revision**

June 06, 2017: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [611444](https://bugs.gentoo.org/show_bug.cgi?id=611444)
* [614044](https://bugs.gentoo.org/show_bug.cgi?id=614044)
* [614852](https://bugs.gentoo.org/show_bug.cgi?id=614852)

### Questions or comments?

Please feel free to contact us.

**¬© 2001‚Äì2020 Gentoo Foundation, Inc.**



=== Content from cgit.ghostscript.com_7dec2eaf_20250111_171919.html ===


| [cgit logo](/cgi-bin/cgit.cgi/) | [index](/cgi-bin/cgit.cgi/) : [mupdf.git](/cgi-bin/cgit.cgi/mupdf.git/ "mupdf.git") | 1.18.x 1.19.x 1.20.x 1.21.x 1.22.x 1.23.x 1.24.x 1.25.x android-muso android-muso-signing android-openjpeg-2.3.1 css fontconfig java-empty-store lcms lcms2 line\_art\_filter master muso muso-3.9-release muso-temporary-hack objc-openjpeg-2.3.1 release-1.10a release\_1.8 so so-tess2 stext-flags win-openjpeg-2.3.1 winRT winphone |
| --- | --- | --- |
| MuPDF library | Chris Liddell |

| [summary](/cgi-bin/cgit.cgi/mupdf.git/)[refs](/cgi-bin/cgit.cgi/mupdf.git/refs/?id=06a012a42c9884e3cd653e7826cff1ddec04eb6e)[log](/cgi-bin/cgit.cgi/mupdf.git/log/)[tree](/cgi-bin/cgit.cgi/mupdf.git/tree/?id=06a012a42c9884e3cd653e7826cff1ddec04eb6e)[commit](/cgi-bin/cgit.cgi/mupdf.git/commit/?id=06a012a42c9884e3cd653e7826cff1ddec04eb6e)[diff](/cgi-bin/cgit.cgi/mupdf.git/diff/?id=06a012a42c9884e3cd653e7826cff1ddec04eb6e) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sebastian Rasmussen <sebras@gmail.com> | 2017-04-11 10:54:12 +0800 |
| --- | --- | --- |
| committer | Sebastian Rasmussen <sebras@gmail.com> | 2017-04-11 10:57:35 +0800 |
| commit | [06a012a42c9884e3cd653e7826cff1ddec04eb6e](/cgi-bin/cgit.cgi/mupdf.git/commit/?id=06a012a42c9884e3cd653e7826cff1ddec04eb6e) ([patch](/cgi-bin/cgit.cgi/mupdf.git/patch/?id=06a012a42c9884e3cd653e7826cff1ddec04eb6e)) | |
| tree | [bd39f26b67469ce95ba5e6bc816d28f6fcb2f0f9](/cgi-bin/cgit.cgi/mupdf.git/tree/?id=06a012a42c9884e3cd653e7826cff1ddec04eb6e) | |
| parent | [34e18d127a02146e3415b33c4b67389ce1ddb614](/cgi-bin/cgit.cgi/mupdf.git/commit/?id=34e18d127a02146e3415b33c4b67389ce1ddb614) ([diff](/cgi-bin/cgit.cgi/mupdf.git/diff/?id=06a012a42c9884e3cd653e7826cff1ddec04eb6e&id2=34e18d127a02146e3415b33c4b67389ce1ddb614)) | |

Bug 697551: Make path and line buffers of equal size.Previously a too long line could be copied into the too short path buffer.
[Diffstat](/cgi-bin/cgit.cgi/mupdf.git/diff/?id=06a012a42c9884e3cd653e7826cff1ddec04eb6e)

| -rw-r--r-- | [platform/x11/jstest\_main.c](/cgi-bin/cgit.cgi/mupdf.git/diff/platform/x11/jstest_main.c?id=06a012a42c9884e3cd653e7826cff1ddec04eb6e) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/platform/x11/jstest\_main.c b/platform/x11/jstest\_main.cindex 13c3a0a3b..f158d9628 100644--- a/[platform/x11/jstest\_main.c](/cgi-bin/cgit.cgi/mupdf.git/tree/platform/x11/jstest_main.c?id=34e18d127a02146e3415b33c4b67389ce1ddb614)+++ b/[platform/x11/jstest\_main.c](/cgi-bin/cgit.cgi/mupdf.git/tree/platform/x11/jstest_main.c?id=06a012a42c9884e3cd653e7826cff1ddec04eb6e)@@ -346,7 +346,7 @@ main(int argc, char \*argv[]) } else if (match(&line, "OPEN")) {- char path[1024];+ char path[LONGLINE]; if (file\_open) pdfapp\_close(&gapp); if (prefix) |
| --- |

generated by [cgit v1.2.3](https://git.zx2c4.com/cgit/about/) ([git 2.25.1](https://git-scm.com/)) at 2025-01-11 17:19:19 +0000



=== Content from lists.debian.org_698a8e48_20250111_171919.html ===


---

[[Date Prev](msg00012.html)][[Date Next](msg00014.html)]
[[Thread Prev](msg00012.html)][[Thread Next](msg00014.html)]
[[Date Index](maillist.html#00013)]
[[Thread Index](threads.html#00013)]

# [SECURITY] [DLA 2765-1] mupdf security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2765-1] mupdf security update
* *From*: Anton Gladky <gladk@debian.org>
* *Date*: Thu, 23 Sep 2021 22:42:19 +0200
* *Message-id*: <[[üîé]](/msgid-search/20210923204219.659594A01E6%40thinkpad.localdomain)¬†[20210923204219.659594A01E6@thinkpad.localdomain](msg00013.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2765-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                         Anton Gladky
September 23, 2021                            <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : mupdf
Version        : 1.14.0+ds1-4+deb9u1
CVE ID         : CVE-2016-10246 CVE-2016-10247 CVE-2017-6060 CVE-2018-10289
                 CVE-2018-1000036 CVE-2020-19609

Multiple issues have been discovered in mupdf.

CVE-2016-10246

    Buffer overflow in the main function in jstest_main.c allows remote attackers
    to cause a denial of service (out-of-bounds write) via a crafted file.

CVE-2016-10247

    Buffer overflow in the my_getline function in jstest_main.c allows remote attackers
    to cause a denial of service (out-of-bounds write) via a crafted file.

CVE-2017-6060

    Stack-based buffer overflow in jstest_main.c allows remote attackers
    to have unspecified impact via a crafted image.

CVE-2018-10289

    An infinite loop in the fz_skip_space function of the pdf/pdf-xref.c file.
    A remote adversary could leverage this vulnerability to cause a denial of
    service via a crafted pdf file.

CVE-2018-1000036

    Multiple memory leaks in the PDF parser allow an attacker to cause a denial
    of service (memory leak) via a crafted file.

CVE-2020-19609

    A heap based buffer over-write in tiff_expand_colormap() function when parsing TIFF
    files allowing attackers to cause a denial of service.

For Debian 9 stretch, these problems have been fixed in version
1.14.0+ds1-4+deb9u1.

We recommend that you upgrade your mupdf packages.

For the detailed security status of mupdf please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/mupdf>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEu71F6oGKuG/2fnKF0+Fzg8+n/wYFAmFM5qcACgkQ0+Fzg8+n
/wZ+2w/+KMtJDPzaGgHYzhaeax75+IXBf9zfbS+AO/trnFuj8Jh7bNql5REN+7Bf
sT6R/8U74AMKmZrTrurq1Exp5KpNxxlPCOJvl8RgrSzC+0hmzIy/+MeIi+Q/TaiW
j1b6HpqILbWz2NmzM0cYcDXYFRt9voOwKDwehmz2Vr/Zm9elX+VPzlm77mcGJy0H
f0eC81vizuI1s+DPa1Psd0USzBjfcLgUaIN+e4/aGOSMUX6EwYzvX8DjIYGO1PeV
L8ye3XybwL734IUmgU7MSKdZi/qJ9pYeIuyq48mvNNlEZXu0pEmiJBepwKnIvtLi
eKMimFLs6Hth2+jKoSJn3evk/Wd6JT8/HK8aMlsEsad2NVrw/ovy07I09DfXIW8F
iphBKPJHQezLmDzCsrzutjDVmOrEs06IygD1wglsCxKDCXrT0lPQzbyiuHhDbbCv
+KStwXAmp+Q2sgsWqYU+/N4/60mGrgNNtFiLBFqtrb1mQzY+P867Vofg1KNjJ39L
egQhyJjnTE09PNXYA8S+Ev3CbgvWBaPX5n8uROpMaFhXR2g9t5Q6+sVEt+5oJ13f
DpLqPDWDUNlrqe3+MVyDUMkZ+Xoonl40Yxn3c+x3WuCiiiSJ2liJY4T/QLlpUqg3
MLQoQn+1C1tvc+peLGNh5Bgemr1qoz9wT0fI0CtUmJcmUAZQhMI=
=4y6v
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_4dbe879e_20250111_171916.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux ¬† *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper ¬† *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists ¬† *for password cracking*](/wordlists/)+ [passwdqc ¬† *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt ¬† *KDF & password hashing*](/yescrypt/)+ [yespower ¬† *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish ¬† *password hashing*](/crypt/)+ [phpass ¬† *ditto in PHP*](/phpass/)+ [tcb ¬† *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd ¬† *port scan detector*](/scanlogd/)+ [popa3d ¬† *tiny POP3 daemon*](/popa3d/)+ [blists ¬† *web interface to mailing lists*](/blists/)+ [msulogin ¬† *single user mode login*](/msulogin/)+ [php\_mt\_seed ¬† *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2017/02/17/6) [[next>]](../../../2017/02/19/1) [[thread-next>]](../../../2017/04/29/4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <3712113.HmbQZlNGGF@arcadia>
Date: Sat, 18 Feb 2017 12:38:45 +0100
From: Agostino Sarubbo <ago@...too.org>
To: oss-security@...ts.openwall.com
Subject: mupdf: mujstest: stack-based buffer overflow in main (jstest_main.c)

Description:
Mujstest, which is part of mupdf is a scriptable tester for mupdf + js.

A crafted image posted early for another issue, causes a stack overflow.

The complete ASan output:

# mujstest $FILE
==32127==ERROR: AddressSanitizer: stack-buffer-overflow on address
0x7fff29560b00 at pc 0x00000047cbf3 bp 0x7fff29560630 sp 0x7fff2955fde0
WRITE of size 1453 at 0x7fff29560b00 thread T0
    #0 0x47cbf2 in __interceptor_strcpy /tmp/portage/sys-devel/llvm-3.9.1-
r1/work/llvm-3.9.1.src/projects/compiler-rt/lib/asan/asan_interceptors.cc:548
    #1 0x50e903 in main /tmp/portage/app-text/mupdf-1.10a/work/mupdf-1.10a-
source/platform/x11/jstest_main.c:358:7
    #2 0x7f68df3c578f in __libc_start_main /tmp/portage/sys-libs/glibc-2.23-
r3/work/glibc-2.23/csu/../csu/libc-start.c:289
    #3 0x41bc18 in _init (/usr/bin/mujstest+0x41bc18)

Address 0x7fff29560b00 is located in stack of thread T0 at offset 1056 in
frame
    #0 0x50c45f in main /tmp/portage/app-text/mupdf-1.10a/work/mupdf-1.10a-
source/platform/x11/jstest_main.c:293

  This frame has 7 object(s):
    [32, 1056) 'path'
    [1184, 2208) 'text' <== Memory access at offset 1056 partially underflows
this variable
    [2336, 2340) 'w' <== Memory access at offset 1056 partially underflows
this variable
    [2352, 2356) 'h' <== Memory access at offset 1056 partially underflows
this variable
    [2368, 2372) 'x' <== Memory access at offset 1056 partially underflows
this variable
    [2384, 2388) 'y' <== Memory access at offset 1056 partially underflows
this variable
    [2400, 2404) 'b' 0x1000652a4160:[f2]f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 f2
f2 f2
  0x1000652a4170: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x1000652a4180: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x1000652a4190: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x1000652a41a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x1000652a41b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==32127==ABORTING

Affected version:
1.10a

Fixed version:
N/A

Commit fix:
N/A

Credit:
This bug was discovered by Agostino Sarubbo of Gentoo.

CVE:
CVE-2017-6060

Reproducer:
<https://github.com/asarubbo/poc/blob/master/00147-mupdf-mujstest-stackoverflow-main>

Timeline:
2017-02-05: bug discovered and reported to upstream
2017-02-17: blog post about the issue
2017-02-17: CVE assigned via cveform.mitre.org

Note:
This bug was found with Address Sanitizer.

Permalink:
<https://blogs.gentoo.org/ago/2017/02/17/mupdf-mujstest-stack-based-buffer-overflow-in-main-jstest_main-c>

--
Agostino Sarubbo
Gentoo Linux Developer

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from blogs.gentoo.org_c82bc0b8_20250111_171917.html ===


[agostino's blog](https://blogs.gentoo.org/ago/ "agostino's blog")

my fuzzer always find something more than your‚Ä¶
![](https://blogs.gentoo.org/ago/files/2015/06/cropped-modificato2.png)

[Skip to content](#content "Skip to content")

* [About me](https://blogs.gentoo.org/ago/agostino_sarubbo/)
* [Contact](https://blogs.gentoo.org/ago/contact/)
* [Advisories](https://blogs.gentoo.org/ago/advisories/)

[‚Üê mupdf: use-after-free in fz\_subsample\_pixmap (pixmap.c)](https://blogs.gentoo.org/ago/2017/02/09/mupdf-use-after-free-in-fz_subsample_pixmap-pixmap-c/)
[audiofile: heap-based buffer overflow in MSADPCM::initializeCoefficients (MSADPCM.cpp) ‚Üí](https://blogs.gentoo.org/ago/2017/02/20/audiofile-heap-based-buffer-overflow-in-msadpcminitializecoefficients-msadpcm-cpp/)

# mupdf: mujstest: stack-based buffer overflow in main (jstest\_main.c)

Posted on [February 17, 2017](https://blogs.gentoo.org/ago/2017/02/17/mupdf-mujstest-stack-based-buffer-overflow-in-main-jstest_main-c/ "5:46 pm") by [ago](https://blogs.gentoo.org/ago/author/ago/ "View all posts by ago")

**Description**:

Mujstest, which is part of [mupdf](http://mupdf.com/) is a scriptable tester for mupdf + js.

A crafted image posted early for another issue, causes a stack overflow.

The complete ASan output:

```
# mujstest $FILE
==32127==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fff29560b00 at pc 0x00000047cbf3 bp 0x7fff29560630 sp 0x7fff2955fde0
WRITE of size 1453 at 0x7fff29560b00 thread T0
    #0 0x47cbf2 in __interceptor_strcpy /tmp/portage/sys-devel/llvm-3.9.1-r1/work/llvm-3.9.1.src/projects/compiler-rt/lib/asan/asan_interceptors.cc:548
    #1 0x50e903 in main /tmp/portage/app-text/mupdf-1.10a/work/mupdf-1.10a-source/platform/x11/jstest_main.c:358:7
    #2 0x7f68df3c578f in __libc_start_main /tmp/portage/sys-libs/glibc-2.23-r3/work/glibc-2.23/csu/../csu/libc-start.c:289
    #3 0x41bc18 in _init (/usr/bin/mujstest+0x41bc18)

Address 0x7fff29560b00 is located in stack of thread T0 at offset 1056 in frame
    #0 0x50c45f in main /tmp/portage/app-text/mupdf-1.10a/work/mupdf-1.10a-source/platform/x11/jstest_main.c:293

  This frame has 7 object(s):
    [32, 1056) 'path'
    [1184, 2208) 'text' <== Memory access at offset 1056 partially underflows this variable
    [2336, 2340) 'w' <== Memory access at offset 1056 partially underflows this variable
    [2352, 2356) 'h' <== Memory access at offset 1056 partially underflows this variable
    [2368, 2372) 'x' <== Memory access at offset 1056 partially underflows this variable
    [2384, 2388) 'y' <== Memory access at offset 1056 partially underflows this variable
    [2400, 2404) 'b' 0x1000652a4160:[f2]f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 f2
  0x1000652a4170: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x1000652a4180: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x1000652a4190: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x1000652a41a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x1000652a41b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==32127==ABORTING

```

**Affected version:**

1.10a

**Fixed version:**

N/A

**Commit fix:**

<http://git.ghostscript.com/?p=user/sebras/mupdf.git;a=blobdiff;f=platform/x11/jstest_main.c;h=f158d9628ed0c0a84e37fe128277679e8334422a;hp=13c3a0a3ba3ff4aae29f6882d23740833c1d842f;hb=06a012a42c9884e3cd653e7826cff1ddec04eb6e;hpb=34e18d127a02146e3415b33c4b67389ce1ddb614>

**Credit:**

This bug was discovered by Agostino Sarubbo of Gentoo.

**CVE:**

CVE-2017-6060

**Reproducer:**

<https://github.com/asarubbo/poc/blob/master/00147-mupdf-mujstest-stackoverflow-main>

**Timeline:**

2017-02-05: bug discovered and reported to upstream

2017-02-17: blog post about the issue

2017-02-17: CVE assigned via cveform.mitre.org

2017-04-11: upstream released a patch

**Note:**

This bug was found with [Address Sanitizer](https://github.com/google/sanitizers/tree/master/address-sanitizer).

**Permalink:**

> [mupdf: mujstest: stack-based buffer overflow in main (jstest\_main.c)](http://blogs.gentoo.org/ago/2017/02/17/mupdf-mujstest-stack-based-buffer-overflow-in-main-jstest_main-c/)

This entry was posted in [advisories](https://blogs.gentoo.org/ago/category/advisories/), [security](https://blogs.gentoo.org/ago/category/security/). Bookmark the [permalink](https://blogs.gentoo.org/ago/2017/02/17/mupdf-mujstest-stack-based-buffer-overflow-in-main-jstest_main-c/ "Permalink to mupdf: mujstest: stack-based buffer overflow in main (jstest_main.c)").

[‚Üê mupdf: use-after-free in fz\_subsample\_pixmap (pixmap.c)](https://blogs.gentoo.org/ago/2017/02/09/mupdf-use-after-free-in-fz_subsample_pixmap-pixmap-c/)
[audiofile: heap-based buffer overflow in MSADPCM::initializeCoefficients (MSADPCM.cpp) ‚Üí](https://blogs.gentoo.org/ago/2017/02/20/audiofile-heap-based-buffer-overflow-in-msadpcminitializecoefficients-msadpcm-cpp/)

### Leave a Reply [Cancel reply](/ago/2017/02/17/mupdf-mujstest-stack-based-buffer-overflow-in-main-jstest_main-c/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

 Notify me of follow-up comments by email.

 Notify me of new posts by email.

Authenticate this comment using OpenID.

Œî

This site uses Akismet to reduce spam. [Learn how your comment data is processed](https://akismet.com/privacy/).

* Search for:
* ### Recent Posts

  + [gentoo tinderbox](https://blogs.gentoo.org/ago/2020/07/04/gentoo-tinderbox/)
  + [re2c: heap overflow in Scanner::fill (scanner.cc)](https://blogs.gentoo.org/ago/2020/04/19/re2c-heap-overflow-in-scannerfill-scanner-cc/)
  + [Why I stopped fuzzing research](https://blogs.gentoo.org/ago/2020/04/16/why-i-stopped-fuzzing-research/)
  + [Install Gentoo in less than one minute](https://blogs.gentoo.org/ago/2019/03/20/install-gentoo-in-less-than-one-minute/)
  + [binutils: invalid memory read in find\_abstract\_instance\_name (dwarf2.c)](https://blogs.gentoo.org/ago/2017/10/24/binutils-invalid-memory-read-in-find_abstract_instance_name-dwarf2-c/)
* ### Recent Comments

  + strongcourage on [Why I stopped fuzzing research](https://blogs.gentoo.org/ago/2020/04/16/why-i-stopped-fuzzing-research/#comment-181437)
  + [Bob Friesenhahn](http://www.graphicsmagick.org/) on [Why I stopped fuzzing research](https://blogs.gentoo.org/ago/2020/04/16/why-i-stopped-fuzzing-research/#comment-181419)
  + [#gentoo dev: Why I stopped fuzzing research https://blogs.gentoo.or‚Ä¶ | Dr. Roy Schestowitz (ÁΩó‰ºä)](https://placeholderapi.wordpress.com/2020/04/18/gentoo-dev-why-i-stopped-fuzzing-research-https-blogs-gentoo-or/) on [Why I stopped fuzzing research](https://blogs.gentoo.org/ago/2020/04/16/why-i-stopped-fuzzing-research/#comment-181400)
  + Ulya on [Why I stopped fuzzing research](https://blogs.gentoo.org/ago/2020/04/16/why-i-stopped-fuzzing-research/#comment-181396)
  + ago on [Install Gentoo in less than one minute](https://blogs.gentoo.org/ago/2019/03/20/install-gentoo-in-less-than-one-minute/#comment-178429)
* ### Archives

  + [July 2020](https://blogs.gentoo.org/ago/2020/07/)
  + [April 2020](https://blogs.gentoo.org/ago/2020/04/)
  + [March 2019](https://blogs.gentoo.org/ago/2019/03/)
  + [October 2017](https://blogs.gentoo.org/ago/2017/10/)
  + [September 2017](https://blogs.gentoo.org/ago/2017/09/)
  + [August 2017](https://blogs.gentoo.org/ago/2017/08/)
  + [July 2017](https://blogs.gentoo.org/ago/2017/07/)
  + [June 2017](https://blogs.gentoo.org/ago/2017/06/)
  + [May 2017](https://blogs.gentoo.org/ago/2017/05/)
  + [April 2017](https://blogs.gentoo.org/ago/2017/04/)
  + [March 2017](https://blogs.gentoo.org/ago/2017/03/)
  + [February 2017](https://blogs.gentoo.org/ago/2017/02/)
  + [January 2017](https://blogs.gentoo.org/ago/2017/01/)
  + [December 2016](https://blogs.gentoo.org/ago/2016/12/)
  + [November 2016](https://blogs.gentoo.org/ago/2016/11/)
  + [October 2016](https://blogs.gentoo.org/ago/2016/10/)
  + [September 2016](https://blogs.gentoo.org/ago/2016/09/)
  + [August 2016](https://blogs.gentoo.org/ago/2016/08/)
  + [July 2016](https://blogs.gentoo.org/ago/2016/07/)
  + [February 2016](https://blogs.gentoo.org/ago/2016/02/)
  + [July 2015](https://blogs.gentoo.org/ago/2015/07/)
  + [August 2013](https://blogs.gentoo.org/ago/2013/08/)
  + [June 2013](https://blogs.gentoo.org/ago/2013/06/)
  + [May 2013](https://blogs.gentoo.org/ago/2013/05/)
  + [January 2013](https://blogs.gentoo.org/ago/2013/01/)
  + [December 2012](https://blogs.gentoo.org/ago/2012/12/)
  + [November 2012](https://blogs.gentoo.org/ago/2012/11/)
  + [October 2012](https://blogs.gentoo.org/ago/2012/10/)
  + [August 2012](https://blogs.gentoo.org/ago/2012/08/)
  + [July 2012](https://blogs.gentoo.org/ago/2012/07/)
  + [June 2012](https://blogs.gentoo.org/ago/2012/06/)
* ### Categories

  + [advisories](https://blogs.gentoo.org/ago/category/advisories/)
  + [arch testing](https://blogs.gentoo.org/ago/category/arch-testing/)
  + [gentoo](https://blogs.gentoo.org/ago/category/gentoo/)
  + [security](https://blogs.gentoo.org/ago/category/security/)
* ### Meta

  + [Log in](https://blogs.gentoo.org/ago/wp-login.php)
  + [Entries feed](https://blogs.gentoo.org/ago/feed/)
  + [Comments feed](https://blogs.gentoo.org/ago/comments/feed/)
  + [WordPress.org](https://wordpress.org/)

[agostino's blog](https://blogs.gentoo.org/ago/ "agostino's blog")
Original theme twentyten, modified by csslayer. Better experience in firefox and webkit.

[Proudly powered by WordPress.](http://wordpress.org/ "Semantic Personal Publishing Platform")



=== Content from cgit.ghostscript.com_14993276_20250111_171919.html ===


| [cgit logo](/cgi-bin/cgit.cgi/) | [index](/cgi-bin/cgit.cgi/) : [mupdf.git](/cgi-bin/cgit.cgi/mupdf.git/ "mupdf.git") | 1.18.x 1.19.x 1.20.x 1.21.x 1.22.x 1.23.x 1.24.x 1.25.x android-muso android-muso-signing android-openjpeg-2.3.1 css fontconfig java-empty-store lcms lcms2 line\_art\_filter master muso muso-3.9-release muso-temporary-hack objc-openjpeg-2.3.1 release-1.10a release\_1.8 so so-tess2 stext-flags win-openjpeg-2.3.1 winRT winphone |
| --- | --- | --- |
| MuPDF library | Chris Liddell |

| [summary](/cgi-bin/cgit.cgi/mupdf.git/)[refs](/cgi-bin/cgit.cgi/mupdf.git/refs/?id=e089b2e2c1d38c5696c7dfd741e21f8f3ef22b14)[log](/cgi-bin/cgit.cgi/mupdf.git/log/)[tree](/cgi-bin/cgit.cgi/mupdf.git/tree/?id=e089b2e2c1d38c5696c7dfd741e21f8f3ef22b14)[commit](/cgi-bin/cgit.cgi/mupdf.git/commit/?id=e089b2e2c1d38c5696c7dfd741e21f8f3ef22b14)[diff](/cgi-bin/cgit.cgi/mupdf.git/diff/?id=e089b2e2c1d38c5696c7dfd741e21f8f3ef22b14) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sebastian Rasmussen <sebras@gmail.com> | 2017-04-11 11:04:12 +0800 |
| --- | --- | --- |
| committer | Sebastian Rasmussen <sebras@gmail.com> | 2017-04-11 11:04:12 +0800 |
| commit | [e089b2e2c1d38c5696c7dfd741e21f8f3ef22b14](/cgi-bin/cgit.cgi/mupdf.git/commit/?id=e089b2e2c1d38c5696c7dfd741e21f8f3ef22b14) ([patch](/cgi-bin/cgit.cgi/mupdf.git/patch/?id=e089b2e2c1d38c5696c7dfd741e21f8f3ef22b14)) | |
| tree | [40db010c68b58e8621d31feca9001cb8cd32bbf7](/cgi-bin/cgit.cgi/mupdf.git/tree/?id=e089b2e2c1d38c5696c7dfd741e21f8f3ef22b14) | |
| parent | [06a012a42c9884e3cd653e7826cff1ddec04eb6e](/cgi-bin/cgit.cgi/mupdf.git/commit/?id=06a012a42c9884e3cd653e7826cff1ddec04eb6e) ([diff](/cgi-bin/cgit.cgi/mupdf.git/diff/?id=e089b2e2c1d38c5696c7dfd741e21f8f3ef22b14&id2=06a012a42c9884e3cd653e7826cff1ddec04eb6e)) | |

jstest: Stop printing bogus script lines.[Diffstat](/cgi-bin/cgit.cgi/mupdf.git/diff/?id=e089b2e2c1d38c5696c7dfd741e21f8f3ef22b14)

| -rw-r--r-- | [platform/x11/jstest\_main.c](/cgi-bin/cgit.cgi/mupdf.git/diff/platform/x11/jstest_main.c?id=e089b2e2c1d38c5696c7dfd741e21f8f3ef22b14) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/platform/x11/jstest\_main.c b/platform/x11/jstest\_main.cindex f158d9628..36b321555 100644--- a/[platform/x11/jstest\_main.c](/cgi-bin/cgit.cgi/mupdf.git/tree/platform/x11/jstest_main.c?id=06a012a42c9884e3cd653e7826cff1ddec04eb6e)+++ b/[platform/x11/jstest\_main.c](/cgi-bin/cgit.cgi/mupdf.git/tree/platform/x11/jstest_main.c?id=e089b2e2c1d38c5696c7dfd741e21f8f3ef22b14)@@ -402,7 +402,7 @@ main(int argc, char \*argv[]) } else {- fprintf(stderr, "Unmatched: %s\n", line);+ fprintf(stderr, "Ignoring line without script statement.\n"); } } while (!feof(script)); |
| --- |

generated by [cgit v1.2.3](https://git.zx2c4.com/cgit/about/) ([git 2.25.1](https://git-scm.com/)) at 2025-01-11 17:19:19 +0000


