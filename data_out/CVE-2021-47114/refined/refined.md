```
{
  "vulnerability": {
    "root_cause": "When fallocate punches holes out of inode size, if the original isize is in the middle of the last cluster, the part from the isize to the end of the cluster will be zeroed with a buffer write. At that time, the isize is not yet updated to match the new size. If writeback is kicked in, it will invoke ocfs2_writepage()->block_write_full_page() where the pages out of inode size will be dropped.",
    "weaknesses": [
      "Race condition during fallocate operation and writeback, leading to inconsistent file size and data corruption."
    ],
    "impact": "File corruption due to incorrect zeroing of data and subsequent dropping of pages during writeback.",
    "attack_vectors": [
      "Use of `fallocate` with `FALLOC_FL_KEEP_SIZE` and `FALLOC_FL_PUNCH_HOLE` flags to punch holes, followed by extending the inode size."
    ],
    "required_capabilities": "Ability to call fallocate on a file on an ocfs2 filesystem."
  },
  "affected_component": "ocfs2 filesystem",
    "additional_information": "The vulnerability can be triggered by using qemu-img convert operations which use fallocate to modify the file metadata and size."
}
```