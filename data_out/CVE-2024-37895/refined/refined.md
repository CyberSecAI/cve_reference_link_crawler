- **Root cause of vulnerability**: The vulnerability stems from the ability to modify the base URL in the frontend and configure requests to be made server-side, without a proper outbound traffic whitelist. This allows an attacker to redirect requests containing sensitive API keys to their own server.
- **Weaknesses/vulnerabilities present**:
    - Lack of outbound traffic whitelisting, allowing requests to be sent to arbitrary URLs.
    - Insecure configuration allowing the frontend to modify the base URL.
    - API key exposed in request headers.
- **Impact of exploitation**: An attacker can obtain the backend API key, which could potentially allow them to perform unauthorized actions on the server side or access sensitive data.
- **Attack vectors**:
    - The attacker must have network access to the application and be able to make requests to it.
    - The attacker also needs to successfully authenticate via SSO or Access Code.
- **Required attacker capabilities/position**:
    - Network access to the LobeChat instance.
    - Valid user credentials that allow authentication via SSO or Access Code.
    - Ability to modify settings in the frontend to point the base URL to an attacker-controlled server.
    - Ability to receive and inspect HTTP request headers at the attacker-controlled server.