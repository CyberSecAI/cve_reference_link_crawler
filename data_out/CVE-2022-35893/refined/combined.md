=== Content from www.insyde.com_d7e5ffbd_20250108_121004.html ===

[![Home](https://www.insyde.com/sites/default/files/Insyde%20Logo%202018%20500px.png)](/ "Home")

[Insyde Software](/ "Home")

UEFI Firmware & Engineering Services Provider

English

* [Company](/company/who-we-are)
  + [Who We Are](/company/who-we-are)
    - [Fast Facts](/company/fast-facts)
    - [Why Us?](/company/who-we-are/why-us)
    - [Our Service](/company/who-we-are/our-service)
  + [Management Team](/company/executive-management)
  + [Global Operation](/company/global-operation)
  + [Industry Testimonials & Awards](/company/who-we-are/customer-testimonials)
  + [Partners](/partners)
    - [Sales Channel Partners](/partners)
    - [Technology Partners](/partners/technology-partners)
  + Corporate Social Responsibility
    - [Sustainable Development](/csr/sustainable-development)
    - [Employees](/csr/employees)
    - [Shareholder](/csr/shareholder)
    - [Social Welfare](/csr/social-welfare)
    - [Environmental Protection](/csr/environmental-protection)
  + [Careers](/company/careers)
  + [Certification](/company/certification)
  + [Security Advisories](/security-pledge)
* [Products](/products)
  + [InsydeH2O UEFI BIOS](/products)
    - [Client Solutions](/products)
    - [Server Solutions](/products/insydeh2o_servers)
    - [IoT/Embedded Solutions](/products/insydeh2o_embedded)
    - [Developer Tools](/products/developertools "BIOS Development Tools")
  + [Supervyse OpenBMC Firmware](/products/supervyse "BMC Firmware Solutions")
  + [BlinkBoot UEFI Boot Loader](/products/blinkboot)
* [Services](/services)
  + [Services Overview](/services)
  + [Engineering Services](/services/engineering-services)
  + [UEFI Training](/services/uefi-training)
  + [Learning Center](/services/learningcenter)
* [Investors](/company/investor-relations)
  + Corporate Governance
    - [Structure](/investor-relations/corporate-governance/structure)
    - [B.O.D](/investor-relations/corporate-governance/board)
    - [Committee](/investor-relations/corporate-governance/committee)
    - [Internal Audit](/investor-relations/corporate-governance/internal-audit)
    - [Major Internal Policies](/investor-relations/corporate-governance/internal-policies)
  + Financials
    - [Monthly Sales](/investor-relations/financials/monthly-sales)
    - [Financial Report](/investor-relations/financials/financial-reports)
  + Shareholder Services
    - [Shareholder Meetings](/investor-relations/shareholder-services/shareholder-meetings)
    - [Stock & Price Dividend](/investor-relations/shareholder-services/stock-dividend)
    - [MOPS](/investor-relations/shareholder-services/mops)
    - [Investor Conferences](/investor-relations/shareholder-services/investor-conferences)
    - [Q&A](/investor-relations/shareholder-services/qa)
  + [Stakeholder Engagement](/investor-relations/stakeholder-engagement)
* [Press/News](/press_news)
  + [Press Releases](/press_news/press-releases-archive)
  + [Events](/press_news/events_all)
* [Contact](/contact)

# **Insyde's Security Pledge**

# Insyde Security Advisory 2022035

| **Insyde ID** | **Advisory Category** | **Impact of Vulnerability** | **Severity Rating** | **Original Date** | **Last Revised** |
| --- | --- | --- | --- | --- | --- |
| INSYDE-SA-2022035 | Software | CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H | 8.2 | 09/21/2022 | 09/21/2022 |

#### **Summary:**

SMM memory corruption vulnerability in SMM driver (SMRAM write) in InsydeH2O.

#### **Vulnerability Details**

[CVE-2022-35893](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-35893)

This affects the FvbServicesRuntimeDxe driver of InsydeH2O. This issue was discovered by the Binarly efiXplorer team. This issue is fixed in InsydeH2O, versions:

Kernel 5.0 (issue IB02961492 in version 05.09.37)

Kernel 5.1 (issue IB02961492 in version 05.17.37)

Kernel 5.2 (issue IB02961492 in version 05.27.29)

Kernel 5.3 (issue IB02961492 in version 05.36.29)

Kernel 5.4 (issue IB02961492 in version 05.44.29)

Kernel 5.5 (issue IB02961492 in version 05.52.29)

#### **Acknowledgements**

Insyde Software would like to thank [Binarly](https://www.binarly.io) for reporting this issue.

#### **Revision History:**

| **Revision** | **Date** | **Description** |
| --- | --- | --- |
| 1.0 | 09/21/2022 | Initial Release || - | - | - |

**[Return to Insyde's Security Pledge](/security-pledge)**

*Boot. Secure. Manage.*

## Become an Insider

Keep up on our always evolving product features and technology. Become an Insyde Insider!

[Sign Up Today!](/insider/become-insider)

## Contact Us

* **Insyde Worldwide HQ**
* **Address:** 16F., No.120, Sec.2, Jianguo N. Rd., Zhongshan District. Taipei, Taiwan, R. O. C.
* **Phone:** +886.2.6608.3688
* **Email Taiwan Sales:** contact.tw@insyde.com
* **Email US Sales:** contact.us@insyde.com
* For support and other Insyde locations [click here.](/contact)

## Follow Us

© Copyright 2024 Insyde Software

* [Search](/search)
* [Contact](/contact)
* [Privacy](/privacy)



=== Content from www.insyde.com_5f3cf67a_20250108_121004.html ===

[![Home](https://www.insyde.com/sites/default/files/Insyde%20Logo%202018%20500px.png)](/ "Home")

# [Insyde Software](/ "Home")

UEFI Firmware & Engineering Services Provider

English繁體中文简体中文

* [Company](/company/who-we-are)
  + [Who We Are](/company/who-we-are)
    - [Fast Facts](/company/fast-facts)
    - [Why Us?](/company/who-we-are/why-us)
    - [Our Service](/company/who-we-are/our-service)
  + [Management Team](/company/executive-management)
  + [Global Operation](/company/global-operation)
  + [Industry Testimonials & Awards](/company/who-we-are/customer-testimonials)
  + [Partners](/partners)
    - [Sales Channel Partners](/partners)
    - [Technology Partners](/partners/technology-partners)
  + Corporate Social Responsibility
    - [Sustainable Development](/csr/sustainable-development)
    - [Employees](/csr/employees)
    - [Shareholder](/csr/shareholder)
    - [Social Welfare](/csr/social-welfare)
    - [Environmental Protection](/csr/environmental-protection)
  + [Careers](/company/careers)
  + [Certification](/company/certification)
  + [Security Advisories](/security-pledge)
* [Products](/products)
  + [InsydeH2O UEFI BIOS](/products)
    - [Client Solutions](/products)
    - [Server Solutions](/products/insydeh2o_servers)
    - [IoT/Embedded Solutions](/products/insydeh2o_embedded)
    - [Developer Tools](/products/developertools "BIOS Development Tools")
  + [Supervyse OpenBMC Firmware](/products/supervyse "BMC Firmware Solutions")
  + [BlinkBoot UEFI Boot Loader](/products/blinkboot)
* [Services](/services)
  + [Services Overview](/services)
  + [Engineering Services](/services/engineering-services)
  + [UEFI Training](/services/uefi-training)
  + [Learning Center](/services/learningcenter)
* [Investors](/company/investor-relations)
  + Corporate Governance
    - [Structure](/investor-relations/corporate-governance/structure)
    - [B.O.D](/investor-relations/corporate-governance/board)
    - [Committee](/investor-relations/corporate-governance/committee)
    - [Internal Audit](/investor-relations/corporate-governance/internal-audit)
    - [Major Internal Policies](/investor-relations/corporate-governance/internal-policies)
  + Financials
    - [Monthly Sales](/investor-relations/financials/monthly-sales)
    - [Financial Report](/investor-relations/financials/financial-reports)
  + Shareholder Services
    - [Shareholder Meetings](/investor-relations/shareholder-services/shareholder-meetings)
    - [Stock & Price Dividend](/investor-relations/shareholder-services/stock-dividend)
    - [MOPS](/investor-relations/shareholder-services/mops)
    - [Investor Conferences](/investor-relations/shareholder-services/investor-conferences)
    - [Q&A](/investor-relations/shareholder-services/qa)
  + [Stakeholder Engagement](/investor-relations/stakeholder-engagement)
* [Press/News](/press_news)
  + [Press Releases](/press_news/press-releases-archive)
  + [Events](/press_news/events_all)
* [Contact](/contact)

# **Insyde's Security Pledge**

#

![](/sites/default/files/page_images/insyde-pledge-3.jpg)

Since our inception 20 years ago, security has been essential. Hundreds of OEMs and ODM partners have trusted us with enabling the platforms that form the foundation of their products, knowing we share their commitment to make them secure. Product security is a top priority with our company and an area of focus that we continue to improve upon every day.

* We sit on the security review team of the industry’s leading firmware standards body; the UEFI Security Response Team.
* We have internal product security experts that drive our Security Development Lifecycle (SDL) process within our BIOS and BMC firmware teams and evaluate existing and emerging threats.
* We issue regular and timely security alert bulletins when mitigations to vulnerabilities are discovered.
* We work closely with all of our silicon vendor partners to ensure the timely and critical delivery of microcode updates and other patches.

At Insyde, we work with the broader industry to identify, report, mitigate and disclose security vulnerabilities. We support you, our customers and partners, in closing the door to anything which compromises the security or privacy in your platforms. We take this role seriously, because if your firmware is not secure, your product is not secure.

This is our pledge to you. If you have any questions about Insyde Software’s commitment to security, I urge you to reach out to us at security.report@insyde.com

**Tim Lewis, Chief Technology Officer**

![](/sites/default/files/page_images/InsydeLogo2018-3COLOR-R-RGBcopy-small-200px.png)

---

* [**InsydeH2O UEFI Firmware**](#InsydeH2OBIOS)
* [**Supervyse BMC**](#SupervyseBMC)

**Insyde Software Security Advisories for InsydeH2O UEFI Firmware:**

#### [**November 12, 2024**](#InsydeNov122024)

| **Common Vulnerabilities and Exposures (CVE)** | **CVSS v3 Vulnerability Severity** | **Description** | **Insyde Security Advisory (SA)** | **Date (MM/DD/YYYY)** | **Last Revised** |
| --- | --- | --- | --- | --- | --- |
| CVE-2024-39707 | 5.3 | IhisiServiceSmm: A vulnerability in the module could allow an attacker to modify UEFI variables. | [INSYDE-SA-2024007](/security-pledge/SA-2024007) | 11/12/2024 | 11/12/2024 |

#### [**September 10, 2024**](#InsydeSept102024)

| **Common Vulnerabilities and Exposures (CVE)** | **CVSS v3 Vulnerability Severity** | **Description** | **Insyde Security Advisory (SA)** | **Date (MM/DD/YYYY)** | **Last Revised** |
| --- | --- | --- | --- | --- | --- |
| CVE-2024-1298 | 5.3 | [EDK2] FirmwarePerformancePei: Potential UINT32 overflow and subsequent divide by 0 | [INSYDE-SA-2024006](/security-pledge/SA-2024006) | 09/10/2024 | 09/10/2024 |

#### [**May 13, 2024**](#InsydeMay132024)

| **Common Vulnerabilities and Exposures (CVE)** | **CVSS v3 Vulnerability Severity** | **Description** | **Insyde Security Advisory (SA)** | **Date (MM/DD/YYYY)** | **Last Revised** |
| --- | --- | --- | --- | --- | --- |
| Multiple | 7.4 | SMM memory corruption vulnerability could lead to escalating privileges in SMM. (CWE-822) | [INSYDE-SA-2024001](/security-pledge/SA-2024001) | 05/13/2024 | 05/13/2024 |

#### [**April 09, 2024**](#InsydeApr092024)

| **Common Vulnerabilities and Exposures (CVE)** | **CVSS v3 Vulnerability Severity** | **Description** | **Insyde Security Advisory (SA)** | **Date (MM/DD/YYYY)** | **Last Revised** |
| --- | --- | --- | --- | --- | --- |
| [CVE-2023-47252](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-47252) | 4.7 | PnpSmm: Possible out of bounds in SMM communication buffer, leading to tampering. | [INSYDE-SA-2023067](/security-pledge/SA-2023067) | 04/09/2024 | 04/09/2024 |

#### [**March 12, 2024**](#InsydeMar122024)

| **Common Vulnerabilities and Exposures (CVE)** | **CVSS v3 Vulnerability Severity** | **Description** | **Insyde Security Advisory (SA)** | **Date (MM/DD/YYYY)** | **Last Revised** |
| --- | --- | --- | --- | --- | --- |
| [CVE-2023-28149](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-28149) | 6.1 | IhisiServiceSmm: A vulnerability in the module that could allow an attacker to modify UEFI variables. | [INSYDE-SA-2023040](/security-pledge/SA-2023040) | 03/12/2024 | 03/12/2024 |

#### [**January 16, 2024**](#InsydeJan162024)

| **Common Vulnerabilities and Exposures (CVE)** | **CVSS v3 Vulnerability Severity** | **Description** | **Insyde Security Advisory (SA)** | **Date (MM/DD/YYYY)** | **Last Revised** |
| --- | --- | --- | --- | --- | --- |
| Multiple | 5.3~8.3 | VU#132380 Vulnerabilities in EDK2 NetworkPkg IP stack implementation. | [INSYDE-SA-2023066](/security-pledge/SA-2023066) | 01/16/2024 | 09/10/2024 |

#### [**January 09, 2024**](#InsydeJan092024)

| **Common Vulnerabilities and Exposures (CVE)** | **CVSS v3 Vulnerability Severity** | **Description** | **Insyde Security Advisory (SA)** | **Date (MM/DD/YYYY)** | **Last Revised** |
| --- | --- | --- | --- | --- | --- |
| Multiple | 7 | VU#275256 Vulnerabilities in EDK2 Reference implementation of the UEFI Specification. | [INSYDE-SA-2023031](/security-pledge/SA-2023031) | 01/09/2024 | 01/09/2024 |

**Insyde Software Security Advisories for Supervyse BMC Firmware:**

#### [**November 12, 2024**](#SPVNov122024)

| **Common Vulnerabilities and Exposures (CVE)** | **CVSS v3 Vulnerability Severity** | **Description** | **Insyde Security Advisory (SA)** | **Date (MM/DD/YYYY)** | **Last Revised** |
| --- | --- | --- | --- | --- | --- |
| Multiple | Multiple | Upgrade OpenSSL to 3.2.3 | [INSYDE-SA-2024012](/security-pledge/SA-2024012) | 11/12/2024 | 11/12/2024 |

#### [**October 08, 2024**](#SPVOct082024)

| **Common Vulnerabilities and Exposures (CVE)** | **CVSS v3 Vulnerability Severity** | **Description** | **Insyde Security Advisory (SA)** | **Date (MM/DD/YYYY)** | **Last Revised** |
| --- | --- | --- | --- | --- | --- |
| Multiple | Multiple | Upgrade curl to v8.10.1. | [INSYDE-SA-2024011](/security-pledge/SA-2024011) | 10/08/2024 | 10/08/2024 |
| Multiple | 7.5 | Upgrade BIND to v9.18.28. | [INSYDE-SA-2024010](/security-pledge/SA-2024010) | 10/08/2024 | 10/08/2024 |

#### [**September 10, 2024**](#SPVSept102024)

| **Common Vulnerabilities and Exposures (CVE)** | **CVSS v3 Vulnerability Severity** | **Description** | **Insyde Security Advisory (SA)** | **Date (MM/DD/YYYY)** | **Last Revised** |
| --- | --- | --- | --- | --- | --- |
| Multiple | Low | Upgrade OpenSSL to 3.2.1 | [INSYDE-SA-2024009](/security-pledge/SA-2024009) | 09/10/2024 | 09/10/2024 |

#### [**August 19, 2024**](#SPVAug192024)

| **Common Vulnerabilities and Exposures (CVE)** | **CVSS v3 Vulnerability Severity** | **Description** | **Insyde Security Advisory (SA)** | **Date (MM/DD/YYYY)** | **Last Revised** |
| --- | --- | --- | --- | --- | --- |
| CVE-2024-26306 | TBD | Upgrade iperf3 to 3.17 | [INSYDE-SA-2024005](/security-pledge/SA-2024005) | 08/19/2024 | 08/19/2024 |

#### [**May 13, 2024**](#SPVMay132024)

| **Common Vulnerabilities and Exposures (CVE)** | **CVSS v3 Vulnerability Severity** | **Description** | **Insyde Security Advisory (SA)** | **Date (MM/DD/YYYY)** | **Last Revised** |
| --- | --- | --- | --- | --- | --- |
| Multiple | N/A | Upgrade libexpat to 2.6.2 | [INSYDE-SA-2024004](/security-pledge/SA-2024004) | 05/13/2024 | 05/13/2024 |
| Multiple | 5.5~8.1 | Upgrade libcurl to 8.7.1 | [INSYDE-SA-2024002](/security-pledge/SA-2024002) | 05/13/2024 | 05/13/2024 |

#### [**March 12, 2024**](#SPVMar122024)

| **Common Vulnerabilities and Exposures (CVE)** | **CVSS v3 Vulnerability Severity** | **Description** | **Insyde Security Advisory (SA)** | **Date (MM/DD/YYYY)** | **Last Revised** |
| --- | --- | --- | --- | --- | --- |
| Multiple | 5.3~6.5 | Upgrade to curl version 8.5.0 | [INSYDE-SA-2023068](/security-pledge/SA-2023068) | 03/12/2024 | 03/12/2024 |

#### [**January 09, 2024**](#SPVJan092024)

| **Common Vulnerabilities and Exposures (CVE)** | **CVSS v3 Vulnerability Severity** | **Description** | **Insyde Security Advisory (SA)** | **Date (MM/DD/YYYY)** | **Last Revised** |
| --- | --- | --- | --- | --- | --- |
| [CVE-2023-38545](https://www.cve.org/CVERecord?id=CVE-2023-38545) | 9.8 | curl: SOCKS5 heap buffer overflow. | [INSYDE-SA-2023065](/security-pledge/SA-2023065) | 01/09/2024 | 01/09/2024 |

---

#### Past Announcements

**[2023 Advisories](/security-pledge/2023-advisories)**

**[2022 Advisories](/security-pledge/2022-advisories)**

**[2021 and Previous Years Advisories](/security-pledge/2021-advisories)**

*Boot. Secure. Manage.*

## Become an Insider

Keep up on our always evolving product features and technology. Become an Insyde Insider!

[Sign Up Today!](/insider/become-insider)

## Contact Us

* **Insyde Worldwide HQ**
* **Address:** 16F., No.120, Sec.2, Jianguo N. Rd., Zhongshan District. Taipei, Taiwan, R. O. C.
* **Phone:** +886.2.6608.3688
* **Email Taiwan Sales:** contact.tw@insyde.com
* **Email US Sales:** contact.us@insyde.com
* For support and other Insyde locations [click here.](/contact)

## Follow Us

© Copyright 2024 Insyde Software

* [Search](/search)
* [Contact](/contact)
* [Privacy](/privacy)



=== Content from binarly.io_4da8af3a_20250108_121003.html ===
![Header banner](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e289a20ba0137147b_Research.webp)![Header banner](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660fca2e8e27621fab7d4c8a_Research%20(1).webp)[![Binarly logo with text 'Binarly'
](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660d4f979dbb18c2088ddda1_Group354.svg)](/)

* [Home](/)
* PlatformPlatform[Features](/features)[Packages](/packages)[Customers](/customers)
* REsearchREsearch[Advisories](/advisories)[All REsearch](/articles)[PKfail](/pkfail)[Lighttpd](/lighttpd)[XZ Backdoor](/blog/xz-utils-supply-chain-puzzle-binarly-ships-free-scanner-for-cve-2024-3094-backdoor)[LogoFAIL](/logofail)
* LearnLearn[All Resources](/learn)[Product Blog](/blog)[Videos](/video)[Free Detection Tools](/free-tools)[Reports](/reports)
* CompanyCompany[About Binarly](/about)[News](/news)[Press](/press)
* [Free scan](https://risk.binarly.io/)
* [Book a demo](/book-a-demo-old)
[Free scan](https://risk.binarly.io/)[Book a demo](/book-a-demo)Advisory ID:BRLY-2022-026
# [BRLY-2022-026] SMM memory corruption vulnerability in SMM driver (SMRAM write).

September 21, 2022Severity:HighCVSS Score8.2Public Disclosure Date:September 21, 2022CVE ID:

[CVE-2022-35893](https://nvd.nist.gov/vuln/detailCVE-2022-35893)

## Summary

Binarly REsearch Team identified an SMM memory corruption vulnerability allowing a possible attacker to write fixed or predictable data to SMRAM. Exploiting this issue could lead to escalating privileges to SMM.![Vendors Affected Icon](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6698dd226326f191c074ad7b_Vendors.svg)
### Vendors Affected

FrameworkInsyde[Framework](/advisory-vendor/framework),[Insyde](/advisory-vendor/insyde),![Affected Products icon](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6698dd3fad8b6d927d1b45c4_Affected%20products.svg)
### Affected Products

No items found.
## Potential Impact

An attacker can exploit this vulnerability to elevate privileges from ring 0 to ring -2, execute arbitrary code in System Management Mode - an environment more privileged than operating system (OS) and completely isolated from it. Running arbitrary code in SMM additionally bypasses SMM-based SPI flash protections against modifications, which can help an attacker to install a firmware backdoor/implant into the BIOS. Such a malicious firmware code in the BIOS could persist across operating system re-installs. Additionally, this vulnerability potentially could be used by threat actors to bypass security mechanisms provided by the UEFI firmware (for example, Secure Boot and some types of memory isolation for hypervisors).

## Summary

**Binarly REsearch Team** identified an SMM memory corruption vulnerability allowing a possible attacker to write fixed or predictable data to SMRAM. Exploiting this issue could lead to escalating privileges to SMM.

## Vulnerability Information

* BINARLY internal vulnerability identifier: BRLY-2022-026
* Insyde PSIRT assigned CVE identifier: CVE-2022-35893
* FwHunt rule: [BRLY-2022-026](https://github.com/binarly-io/FwHunt/blob/main/rules/Vulnerabilities/Insyde/BRLY-2022-026.yml)
* CVSS v3.1: 8.2 High AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H

## Affected HP firmwares with confirmed impact by Binarly REsearch Team

| Fimware | Module name | Module SHA256 | File GUID |
| --- | --- | --- | --- |
| Framework\_Laptop\_12th\_Gen\_Intel\_Core\_capsule\_EFI\_signed\_allsku\_3.01.bin | FvbServicesRuntimeDxe | 84A3AC77B498004DEAE28A98E37BFE7C00775432385D9F20884CE31414FCE815 | BDFE5FAA-2A35-44BB-B17A-8084D4E2B9E9 |

## Potential impact

An attacker can exploit this vulnerability to elevate privileges from ring 0 to ring -2, execute arbitrary code in System Management Mode - an evironment more privileged than operating system (OS) and completely isolated from it. Running arbitrary code in SMM additionally bypasses SMM-based SPI flash protections against modifications, which can help an attacker to install a firmware backdoor/implant into the BIOS. Such a malicious firmware code in the BIOS could persist across operating system re-installs. Additionally, this vulnerability potentially could be used by threat actors to bypass security mechanisms provided by the UEFI firmware (for example, Secure Boot and some types of memory isolation for hypervisors).

## Vulnerability description

The vulnerable module registers a child SW SMI handler with GUID `145f21ab-d92c-4eab-ab1e-5d24b90c3c6c`:

```
gSmst->SmiHandlerRegister)(SmiHandler, &gUnknownProtocol145F21ABGuid, &Handle);

```

Also, it locates the protocol with GUID `2970687c-618c-4de5-b8f9-6c7576dca83d` (implemented in SMM driver `FwBlockServiceSmm` GUID `74D936FA-D8BD-4633-B64D-6424BDD23D24`):

```
gBuffer = AllocateBuffer(0x10);
  if ( gSmst->SmmLocateProtocol)(&gUnknownProtocol2970687CGuid, 0, gBuffer + 8) >= 0 )

```

The handler is located at offset `0x2DC8`:

```
EFI_STATUS __fastcall SmiHandler(EFI_HANDLE DispatchHandle, const void *Context, void *CommBuffer, UINTN *CommBufferSize)
{
  if ( !CommBuffer )
    return 0;
  if ( !CommBufferSize )
    return 0;
  CommBufferSize_val = *CommBufferSize;
  if ( *CommBufferSize != gCommBufferSize - 0x18 || CommBuffer != (char *)gCommBuffer + 0x18 )
    return 0;

  ...

  if ( *((_DWORD *)CommBuffer + 2) == 'AFMS' )
  {
    v8 = (char *)CommBuffer + 0x20;
    v9 = (char *)CommBuffer + 0x28;
    if ( *((_QWORD *)CommBuffer + 4) <= *CommBufferSize - 0x28 )
    {
      Status = EFI_UNSUPPORTED;

      cmd = *((_DWORD *)CommBuffer + 6);
      UnknownProtocol297067C = *(_QWORD *)(gBuffer + 8);    // gSmst_2->SmmLocateProtocol)(&gUnknownProtocol297067CGuid, 0, gBuffer + 8)

      if ( cmd )
      {
        cmd = cmd - 1;
        // cmd = 2
        if ( cmd )
        {
          if ( cmd != 1 )
          {
LABEL_18:
            *(_QWORD *)CommBuffer = Status;
            return 0;
          }                                     // SmfbFunc3: SMM memory write
          Status = (*(UnknownProtocol297067C + 0x18))(
                     *(_QWORD *)(gBuffer + 8),
                     *((_QWORD *)CommBuffer + 2),
                     v8,
                     v9);
        }
        // cmd = 1
        else
        {                                       // SmbFunc2: SMM memory write
          Status = (*(UnknownProtocol297067C + 0x10))(
                     *(_QWORD *)(gBuffer + 8),
                     *((_QWORD *)CommBuffer + 2),
                     v8,
                     v9);
        }
      }
      else
      {
        ...
      }

      goto LABEL_18;
    }
  }

  return 0;
}
```

As we can see if a caller specifies `*((_DWORD *)CommBuffer + 6) = 1` routine `(*(UnknownProtocol297067C + 0x10))()` will be called. It is implemented in SMM driver `FwBlockServiceSmm` GUID `74D936FA-D8BD-4633-B64D-6424BDD23D24`, we call it as `SmfbFunc2()` (located at offset `0x1EBC`) with controllable arguments passed into it:- `addr` (retrieved `*((_QWORD *)CommBuffer + 2)`) - main pointer for the operation- `size` (located at `(_QWORD *)CommBuffer + 3`) - size of data for the operation- `dest` (the rest of Communication Buffer located at `(__int64)(CommBuffer + 0x20)`) - destination buffer address for the operation (if applicable)

```
__int64 __fastcall SmfbFunc2(__int64 a1, char *addr, unsigned __int64 *size_ptr, char *dest)
{
  switch ( *(_DWORD *)gValueInitializedByUnknownProtocol1c2e4602 )
  {
    case 0:
      return sub_800027F8((__int64)gValueInitializedByUnknownProtocol1c2e4602, addr, dest, size_ptr);// SMM memory corruption
    case 1:
      return sub_80002BFC(                      // SMM memory corruption
               gValueInitializedByUnknownProtocol1c2e4602,
               addr,
               dest,
               size_ptr,
               addr);
    case 3:
      return sub_80003044(
               gValueInitializedByUnknownProtocol1c2e4602,
               addr,
               dest,
               size_ptr,
               addr);
  }
  return EFI_UNSUPPORTED;
}
```

From this point there are two ways available for corrupting SMM memory.

The first is bug located in `sub_800027F8()`:

```
MACRO_EFI __fastcall sub_800027F8(__int64 val, char *addr, char *dest, unsigned __int64 *size_ptr)
{
  if ( *(_DWORD *)gValueInitializedByUnknownProtocol1c2e4602 )
    return EFI_UNSUPPORTED;

  v8 = *((_QWORD *)gValueInitializedByUnknownProtocol1c2e4602 + 0xB);
  v9 = EFI_SUCCESS;

  counter = 0;

  v11 = *(void **)(v8 + 0x10);
  v12 = *(void **)(v8 + 8);
  v16 = *(void **)(v8 + 0x10);

  if ( !*size_ptr )
    return v9;

  while ( 1 )
  {
    if ( addr == dest || !CompareMemory(addr, dest, 1i64) )
      goto LABEL_12;
    SetMemory(v12, 1ui64, 0xAA);
    SetMemory(v11, 1ui64, 0x55);
    SetMemory(v12, 1ui64, 0xA0);
    SetMemory(addr, 1ui64, *dest);              // Write controllable byte to a controllable address

```

The second bug is located at `sub_80002BFC()`:

```
unsigned __int64 __fastcall sub_80002BFC(__int64 val, char *addr, __int64 dest, unsigned __int64 *size_ptr, __int64 addr_copy)
{
  v5 = 0;
  v8 = 0;
  if ( *size_ptr )
  {
    v9 = dest - (_QWORD)addr;
    do
    {
      SetMemory(addr, 1, 0x40);           // Write byte to a controllable address
      SetMemory(addr, 1, addr[v9]);       // Write byte to a controllable address
      SetMemory(addr, 1, 0x70);           // Write byte to a controllable address
      v10 = 0i64;
      while ( *addr_1 >= 0 )
      {
        sub_80003D5C();
        v10 += 2;
        if ( v10 >= 0x989680 )
        {
          *size_ptr = v8;
          v5 = EFI_DEVICE_ERROR;

          goto LABEL_7;
        }
      }
      ++v8;
      ++addr;
    }
    while ( v8 < *size_ptr );
  }
LABEL_7:
  SetMemory((void *)addr_copy, 1ui64, 0x50);    // Write byte to a controllable address
  SetMemory((void *)addr_copy, 1ui64, 0xFF);    // Write byte to a controllable address

  return v5;
}
```

Because no validation is applied for the input `addr` argument (when invoking `SmfbFunc2()`), a possible attacker can make it to point into SMRAM contents. Then:- the execution flow in `SmfbFunc2()->sub_800027F8()` will lead to writing controllable bytes from `dest` to `addr`;- the execution flow in `SmfbFunc2()->sub_80002BFC()` will lead to writing fixed bytes to `addr`.

In case a caller specifies `*((_DWORD *)CommBuffer + 6) = 1` before entering this handler, routine `(*(UnknownProtocol297067C + 0x18))()` will be called. It is implemented in SMM driver `FwBlockServiceSmm` GUID `74D936FA-D8BD-4633-B64D-6424BDD23D24`, we call it as `SmfbFunc3()` (located at offset `0x1F20`) with the same controllable arguments:

```
__int64 __fastcall SmfbFunc3(__int64 a1, unsigned __int64 addr, unsigned __int64 *size_ptr)
{
  size = *size_ptr;
  if ( *(_DWORD *)gValueInitializedByUnknownProtocol1c2e4602 )
  {
    if ( *(_DWORD *)gValueInitializedByUnknownProtocol1c2e4602 == 1 )
    {
      if ( (_WORD)size )
      {
        result = EFI_INVALID_PARAMETER;
      }
      else
      {
        for ( counter = *size_ptr >> 16; counter; --counter )
        {
          SetMemory((void *)addr_1, 1ui64, 0x20);    // Write byte to a controllable address
          SetMemory((void *)addr_1, 1ui64, 0xD0);    // Write byte to a controllable address
          SetMemory((void *)addr_1, 1ui64, 0x70);    // Write byte to a controllable address

```

This also ends up into writing fixed bytes to `addr`.

The abovementioned cases lead to corrupting memory in SMRAM at a controllable address with a predictable data and size. It could be used for example to change SMI handler's code or modify SMRAM Map structures to break input pointers validation for other SMI handlers, hence to completely make this mitigation inefficient. This could lead to gaining arbitrary code execution in SMM.

This vulnerability is explotiable from the runtime.

## Disclosure timeline

This bug is subject to a 90 day disclosure deadline. After 90 days elapsed or a patch has been made broadly available (whichever is earlier), the bug report will become visible to the public.

| Disclosure Activity | Date |
| --- | --- |
| Framework PSIRT is notified | 2022-06-27 |
| Insyde PSIRT confirmed reported issue | 2022-07-19 |
| Insyde PSIRT assigned CVE number | 2022-07-25 |
| BINARLY public disclosure date | 2022-09-21 |

## Acknowledgements

**Binarly REsearch Team**

TagsSMM![](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/65faef3e5a64d8387dca69cd_Group%204845.svg)
#### Related Advisories

No items found.![](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/65faef3e5a64d8387dca69cd_Group%204845.svg)FWHuntSee if you are impacted now with our Firmware Vulnerability Scanner[Scan now![Arrow indicating link](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/65f86908fed31c26610fe934_Group%20381.svg)](https://fwhunt.run/)![](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/65f8528901f2494591983c76_Mask%20Group%20148%20(1).svg)[![Binarly logo with text 'Binarly'
](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660d4f979dbb18c2088ddda1_Group354.svg)](/)[![X logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b9591b951116fb5f47de_Subtraction%205.svg)](https://twitter.com/binarly_io?lang=en)[![linkedin logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b958f35f981e228095d6_Subtraction%204.svg)](https://www.linkedin.com/company/binarlyinc/)[![github logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b959b5a62bb6adb058a5_github-mark-white.svg)](https://github.com/binarly-io)[![youtube logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b95946e1fd610eef4f94_Subtraction%203.svg)](https://www.youtube.com/channel/UCpJ_uhTb4_NNoq3-02QfOsA)

* ###### Platform

  + [Features](/features)
  + [Packages](/packages)
  + [Customers](/customers)
* ###### REsearch

  + [Advisories](/advisories)
  + [All REsearch](/articles)
  + [PKfail](/pkfail)
  + [Lighttpd](/lighttpd)
  + [XZ Backdoor](/blog/xz-utils-supply-chain-puzzle-binarly-ships-free-scanner-for-cve-2024-3094-backdoor)
  + [LogoFAIL](/logofail)
* ###### Learn

  + [All Resources](/learn)
  + [Product Blog](/blog)
  + [Videos](/video)
  + [Free Detection Tools](/free-tools)
  + [Reports](/reports)
* ###### Company

  + [About Binarly](/about)
  + [News](/news)
  + [Press](/press)

* Copyright Â© 2024
* [Terms of use](/terms-of-use)
* [Cookie Policy](/cookie-policy)
* [Privacy Policy](/privacy-policy)
* [CCPA Privacy Notice](/ccpa-privacy-notice)
* [Security Commitments](/organizational-security)
[![Binarly logo with text 'Binarly'
](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/660d4f979dbb18c2088ddda1_Group354.svg)](/)[![X logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b9591b951116fb5f47de_Subtraction%205.svg)](https://twitter.com/binarly_io?lang=en)[![linkedin logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b958f35f981e228095d6_Subtraction%204.svg)](https://www.linkedin.com/company/binarlyinc/)[![github logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b959b5a62bb6adb058a5_github-mark-white.svg)](https://github.com/binarly-io)[![youtube logo](https://cdn.prod.website-files.com/65d392ca924b59f0fcd873eb/6601b95946e1fd610eef4f94_Subtraction%203.svg)](https://www.youtube.com/channel/UCpJ_uhTb4_NNoq3-02QfOsA)

* ###### Platform

  + Features
  + Packages
  + Customers
* ###### REsearch

  + Advisories
  + All REsearch
  + PKfail
  + Lighttpd
  + XZ Backdoor
  + LogoFAIL
* ###### Learn

  + All Resources
  + Product Blog
  + Videos
  + Free Detection Tools
  + Reports
* ###### Company

  + About Binarly
  + News
  + Press

* [Capabilities](/features)
* [Packages](/packages)
* [Customers](/customers)

* [REsearch](/articles)
* [Advisories](/advisories)
* [Free Tools](/free-tools)

* [About](/about)
* [News](/news)
* [Press](/press)

Copyright Â© 2024Â Â |Â Â [Terms of use](/terms-of-use)Â Â |Â Â [Cookie Policy](/cookie-policy)Â Â | [Privacy Policy](/privacy-policy)Â Â |Â Â [CCPA Privacy Notice](/ccpa-privacy-notice)


