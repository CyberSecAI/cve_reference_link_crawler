
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSpiderLabs%2Fowasp-modsecurity-crs%2Fissues%2F1372)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSpiderLabs%2Fowasp-modsecurity-crs%2Fissues%2F1372)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=SpiderLabs%2Fowasp-modsecurity-crs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on May 14, 2020. It is now read-only.

[SpiderLabs](/SpiderLabs)
/
**[owasp-modsecurity-crs](/SpiderLabs/owasp-modsecurity-crs)**
Public archive

* [Notifications](/login?return_to=%2FSpiderLabs%2Fowasp-modsecurity-crs) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2FSpiderLabs%2Fowasp-modsecurity-crs)
* [Star
   2.5k](/login?return_to=%2FSpiderLabs%2Fowasp-modsecurity-crs)

* [Code](/SpiderLabs/owasp-modsecurity-crs)
* [Issues
  39](/SpiderLabs/owasp-modsecurity-crs/issues)
* [Pull requests
  6](/SpiderLabs/owasp-modsecurity-crs/pulls)
* [Actions](/SpiderLabs/owasp-modsecurity-crs/actions)
* [Projects
  0](/SpiderLabs/owasp-modsecurity-crs/projects)
* [Wiki](/SpiderLabs/owasp-modsecurity-crs/wiki)
* [Security](/SpiderLabs/owasp-modsecurity-crs/security)
* [Insights](/SpiderLabs/owasp-modsecurity-crs/pulse)

Additional navigation options

* [Code](/SpiderLabs/owasp-modsecurity-crs)
* [Issues](/SpiderLabs/owasp-modsecurity-crs/issues)
* [Pull requests](/SpiderLabs/owasp-modsecurity-crs/pulls)
* [Actions](/SpiderLabs/owasp-modsecurity-crs/actions)
* [Projects](/SpiderLabs/owasp-modsecurity-crs/projects)
* [Wiki](/SpiderLabs/owasp-modsecurity-crs/wiki)
* [Security](/SpiderLabs/owasp-modsecurity-crs/security)
* [Insights](/SpiderLabs/owasp-modsecurity-crs/pulse)

# Regarding the ReDOS exploit strings & the un-reproducibility #1372

Closed

[s0md3v](/s0md3v) opened this issue
Apr 28, 2019
¬∑ 5 comments

Closed

# [Regarding the ReDOS exploit strings & the un-reproducibility](#top) #1372

[s0md3v](/s0md3v) opened this issue
Apr 28, 2019
¬∑ 5 comments

Labels
[Stale issue](/SpiderLabs/owasp-modsecurity-crs/labels/Stale%20issue)
This issue has been open 120 days with no activity.

## Comments

[![@s0md3v](https://avatars.githubusercontent.com/u/26716802?s=80&u=5597754f1d88957b135f9e45280909a780bd1902&v=4)](/s0md3v)

Copy link

### **[s0md3v](/s0md3v)** commented [Apr 28, 2019](#issue-438031743)

| Hi there,  I am submitting this issue as the team is unable to see any impact by using the "exploit strings" i provided. Look at the following regular expression:  ``` (?i:(?:(?:(?:^[\"'`\\\\]*?[^\"'`]+[\"'`])+|(?:^[\"'`\\\\]*?[\d\"'`]+)+)\s*?(?:n(?:and|ot)| (?:x?x)?or|between|\|\||like|and|div|&&)\s*?[\w\"'`][+&!@(),.-]|\@(?:[\w-]+\s(?:between|like| x?or|and|div)\s*?[^\w\s]|\w+\s+(?:between|like|x?or|and|div)\s*?[\"'`\d]+)|[\"'`]\s*?(?:b etween|like|x?or|and|div)\s*?[\"'`]?\d|[^\w\s:]\s*?\d\W+[^\w\s]\s*?[\"'`].|[^\w\s]\w+\s*?[|-]\s* ?[\"'`]\s*?\w|\Winformation_schema|\\\\x(?:23|27|3d)|table_name\W|^.?[\"'`]$))  ```  This is indeed a very long regular expression to reverse into a string by hand when you are looking at tons of such regular expressions. However, the only vulnerable part of the regular expression is the following:  ``` (?:^[\"'`\\\\]*?[^\"'`]+[\"'`])+|(?:^[\"'`\\\\]*?[\d\"'`]+)+)\s*?(?:n(?:and|ot)  ```  This part will cause the regex engine to backtrack a lot because of the alternate and adjacent sub-patterns and character classes matching the same characters. I focused only on finding vulnerabilities and not on writing exploits and that way, I was able to find and verify 5 vulnerabilities under and hour. I assumed you guys would understand what I was trying to convey without making a ready-to-use exploit public, open to abuse.  The strings I mentioned are exploits for the vulnerable parts of the regular expressions, they aren't complete attack vectors as I mentioned in [my interview with Portswigger](https://portswigger.net/daily-swig/unpatched-modsecurity-crs-vulnerabilities-leave-web-servers-open-to-denial-of-service-attacks):  The researcher added: ‚ÄúIt should be noted that I haven‚Äôt released the full exploit strings yet because the vulnerabilities still exist and can be abused. The exploits mentioned in my blog are just for the vulnerable parts of the regular expressions and won‚Äôt have any effect on an implementation of ModSecurity.‚Äù  I hope it makes sense now. |
| --- |
| The text was updated successfully, but these errors were encountered: |

 üëç
1
 centminmod reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[![@s0md3v](https://avatars.githubusercontent.com/u/26716802?s=80&u=5597754f1d88957b135f9e45280909a780bd1902&v=4)](/s0md3v)

Copy link

Author

### **[s0md3v](/s0md3v)** commented [Apr 28, 2019](#issuecomment-487358900)

| CC: [@dune73](https://github.com/dune73) |
| --- |

All reactions

Sorry, something went wrong.

[![@fgsch](https://avatars.githubusercontent.com/u/241785?s=80&u=d9986414f08f481f28a6554286ffd1f1902219a4&v=4)](/fgsch)

Copy link

Contributor

### **[fgsch](/fgsch)** commented [Apr 28, 2019](#issuecomment-487364740)

| [@s0md3v](https://github.com/s0md3v) if this is really a matter of using the right payload you can send this privately to the core developers. I still fail to understand why a different payload will work when the pcre limits are in place though. |
| --- |

All reactions

Sorry, something went wrong.

[![@s0md3v](https://avatars.githubusercontent.com/u/26716802?s=80&u=5597754f1d88957b135f9e45280909a780bd1902&v=4)](/s0md3v)

Copy link

Author

### **[s0md3v](/s0md3v)** commented [Apr 28, 2019](#issuecomment-487371185)

| [@fgsch](https://github.com/fgsch) If PCRE limits are in place, ReDOS won't occur but i guess Mod Security v3 doesn't have those limits because of some compatibility issue. It's up to you if you want to fix the regexes or set up the limits. |
| --- |

All reactions

Sorry, something went wrong.

[![@dune73](https://avatars.githubusercontent.com/u/618722?s=80&u=19aed5be603ff5cd91880863f295cc331853a517&v=4)](/dune73)

Copy link

Contributor

### **[dune73](/dune73)** commented [Apr 29, 2019](#issuecomment-487486688) ‚Ä¢ edited Loading

| ModSec 3 does not allow a user to configure the limits, but they are there baked into the binary. However, transformations come into play too, so maybe it's the transformations that kill your attack (payload). Honestly, I do not really know why the attacks do not work.  The resulting problem with your issues / CVEs is thus, that they do not lead to a DoS. It is obvious, that quite a few of our regular expressions have a ReDoS problem. That is no news, at least not to the project as explained in the blog post at <https://coreruleset.org/20190425/regular-expression-dos-weaknesses-in-crs/>.  We know we need to fix the regular expressions. But we want to do so in a very diligent way. Ideally, the updated regex will match 100% the same patterns as before. And developing that takes time, so we did not merge your welcome submissions just yet.  With regards to the CVEs, I just do not see a constellation (with the excaption of [CVE-2019-11387](https://github.com/advisories/GHSA-473r-xgj8-7xqq "CVE-2019-11387")), where you / your payloads are able to DoS a system running CRS. ModSec 2 and ModSec 3 do not seem to be affected and we clearly write that our rules work on *compatible* systems too. Compatible would mean, that the rule execution is the same. If the rule execution is different and DoS happens, then they are no longer compatible and they are beyond our responsibility / authority.  Do you understand this argumentation, or is there something flawed in my thinking? |
| --- |

 üëç
4
 theMiddleBlue, s0md3v, fgsch, and 0xInfection reacted with thumbs up emoji

All reactions

* üëç
  4 reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)

Copy link

### **[github-actions](/apps/github-actions) bot** commented [Nov 18, 2019](#issuecomment-554803550)

| This issue has been open 120 days with no activity. Remove the stale label or comment, or this will be closed in 14 days |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added
the
[Stale issue](/SpiderLabs/owasp-modsecurity-crs/labels/Stale%20issue)
This issue has been open 120 days with no activity.
label
[Nov 18, 2019](#event-2805799294)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
closed this as [completed](/SpiderLabs/owasp-modsecurity-crs/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Dec 3, 2019](#event-2847760520)

[![@CRS-migration-bot](https://avatars.githubusercontent.com/u/64548429?s=40&v=4)](/CRS-migration-bot)
[CRS-migration-bot](/CRS-migration-bot)
mentioned this issue
[May 13, 2020](#ref-issue-617499198)

[Regarding the ReDOS exploit strings & the un-reproducibility
coreruleset/coreruleset#1372](/coreruleset/coreruleset/issues/1372)

Closed

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSpiderLabs%2Fowasp-modsecurity-crs%2Fissues%2F1372).

Assignees

No one assigned

Labels

[Stale issue](/SpiderLabs/owasp-modsecurity-crs/labels/Stale%20issue)
This issue has been open 120 days with no activity.

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

3 participants

[![@fgsch](https://avatars.githubusercontent.com/u/241785?s=52&v=4)](/fgsch) [![@dune73](https://avatars.githubusercontent.com/u/618722?s=52&v=4)](/dune73) [![@s0md3v](https://avatars.githubusercontent.com/u/26716802?s=52&v=4)](/s0md3v)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.

