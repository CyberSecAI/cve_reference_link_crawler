=== Content from plugins.trac.wordpress.org_79464498_20250111_104759.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fsimple-basic-contact-form%2Ftrunk%2Fsimple-basic-contact-form.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/simple-basic-contact-form/trunk/simple-basic-contact-form.php?rev=3080542 "Revision 3080542")
* Next Revision →
* [Blame](/browser/simple-basic-contact-form/trunk/simple-basic-contact-form.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/simple-basic-contact-form/trunk/simple-basic-contact-form.php)

---

# [source:](/browser?order=name "Go to repository root") [simple-basic-contact-form](/browser/simple-basic-contact-form?order=name "View simple-basic-contact-form")/[trunk](/browser/simple-basic-contact-form/trunk?order=name "View trunk")/[simple-basic-contact-form.php](/browser/simple-basic-contact-form/trunk/simple-basic-contact-form.php?order=name "View simple-basic-contact-form.php")

View diff against:

View revision:

| [Last change](/changeset/3085036/simple-basic-contact-form/trunk/simple-basic-contact-form.php "View differences") on this file was [3085036](/changeset/3085036/ "View changeset 3085036"), checked in by wpkube, [8 months ago](/timeline?from=2024-05-11T19%3A35%3A30Z&precision=second "See timeline at 05/11/2024 07:35:30 PM") |
| --- |
| trunk 20240511 |
| **File size:** 72.2 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | Plugin Name: Simple Basic Contact Form |
| [4](#L4) | Plugin URI: https://wordpress.org/plugins/simple-basic-contact-form/ |
| [5](#L5) | Description: A secure contact form that&rsquo;s fast and flexible. |
| [6](#L6) | Tags: contact, form, contact form, email, mail,  captcha, spam, anti spam, anti-spam, antispam |
| [7](#L7) | Author: WPKube |
| [8](#L8) | Author URI: https://www.wpkube.com/ |
| [9](#L9) | Contributors: WPKube |
| [10](#L10) | Requires at least: 4.1 |
| [11](#L11) | Tested up to: 6.5 |
| [12](#L12) | Version: 20240511 |
| [13](#L13) | Requires PHP: 5.2 |
| [14](#L14) | Text Domain: scf |
| [15](#L15) | Domain Path: /languages |
| [16](#L16) | License: GPL v2 or later |
| [17](#L17) | \*/ |
| [18](#L18) |  |
| [19](#L19) | /\* |
| [20](#L20) | This program is free software; you can redistribute it and/or |
| [21](#L21) | modify it under the terms of the GNU General Public License |
| [22](#L22) | as published by the Free Software Foundation; either version |
| [23](#L23) | 2 of the License, or (at your option) any later version. |
| [24](#L24) |  |
| [25](#L25) | This program is distributed in the hope that it will be useful, |
| [26](#L26) | but WITHOUT ANY WARRANTY; without even the implied warranty of |
| [27](#L27) | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the |
| [28](#L28) | GNU General Public License for more details. |
| [29](#L29) |  |
| [30](#L30) | You should have received a copy of the GNU General Public License |
| [31](#L31) | with this program. If not, visit: https://www.gnu.org/licenses/ |
| [32](#L32) |  |
| [33](#L33) | Copyright 2017 Monzilla Media. All rights reserved. |
| [34](#L34) | \*/ |
| [35](#L35) |  |
| [36](#L36) | if (!function\_exists('add\_action')) die(); |
| [37](#L37) |  |
| [38](#L38) |  |
| [39](#L39) |  |
| [40](#L40) | $scf\_wp\_vers = '4.1'; |
| [41](#L41) | $scf\_version = '20240511'; |
| [42](#L42) | $scf\_plugin  = esc\_html\_\_('Simple Basic Contact Form', 'scf'); |
| [43](#L43) | $scf\_options = get\_option('scf\_options'); |
| [44](#L44) | $scf\_path    = plugin\_basename(\_\_FILE\_\_); // 'simple-basic-contact-form/simple-basic-contact-form.php'; |
| [45](#L45) | $scf\_homeurl = 'https://wordpress.org/plugins/simple-basic-contact-form/'; |
| [46](#L46) |  |
| [47](#L47) | if ( ! isset( $scf\_options['scf\_input\_confirm\_email'] ) ) { |
| [48](#L48) | $scf\_options['scf\_input\_confirm\_email'] = ''; |
| [49](#L49) | } |
| [50](#L50) |  |
| [51](#L51) | if ( ! isset( $scf\_options['scf\_confirm\_mailtext'] ) ) { |
| [52](#L52) | $scf\_options['scf\_confirm\_mailtext'] = ''; |
| [53](#L53) | } |
| [54](#L54) |  |
| [55](#L55) | if ( ! isset( $scf\_options['scf\_input\_name'] ) ) { |
| [56](#L56) | $scf\_options['scf\_input\_name'] = ''; |
| [57](#L57) | } |
| [58](#L58) |  |
| [59](#L59) | if ( ! isset( $scf\_options['scf\_input\_email'] ) ) { |
| [60](#L60) | $scf\_options['scf\_input\_email'] = ''; |
| [61](#L61) | } |
| [62](#L62) |  |
| [63](#L63) | if ( ! isset( $scf\_options['scf\_input\_subject'] ) ) { |
| [64](#L64) | $scf\_options['scf\_input\_subject'] = ''; |
| [65](#L65) | } |
| [66](#L66) |  |
| [67](#L67) | if ( ! isset( $scf\_options['scf\_input\_captcha'] ) ) { |
| [68](#L68) | $scf\_options['scf\_input\_captcha'] = ''; |
| [69](#L69) | } |
| [70](#L70) |  |
| [71](#L71) | if ( ! isset( $scf\_options['scf\_input\_message'] ) ) { |
| [72](#L72) | $scf\_options['scf\_input\_message'] = ''; |
| [73](#L73) | } |
| [74](#L74) |  |
| [75](#L75) | if ( ! isset( $scf\_options['default\_options'] ) ) { |
| [76](#L76) | $scf\_options['default\_options'] = ''; |
| [77](#L77) | } |
| [78](#L78) |  |
| [79](#L79) | function scf\_i18n\_init() { |
| [80](#L80) |  |
| [81](#L81) | load\_plugin\_textdomain('scf', false, dirname(plugin\_basename(\_\_FILE\_\_)) .'/languages/'); |
| [82](#L82) |  |
| [83](#L83) | } |
| [84](#L84) | add\_action('plugins\_loaded', 'scf\_i18n\_init'); |
| [85](#L85) |  |
| [86](#L86) |  |
| [87](#L87) |  |
| [88](#L88) | function scf\_require\_wp\_version() { |
| [89](#L89) |  |
| [90](#L90) | global $scf\_path, $scf\_plugin, $scf\_wp\_vers; |
| [91](#L91) |  |
| [92](#L92) | if (isset($\_GET['activate']) && $\_GET['activate'] == 'true') { |
| [93](#L93) |  |
| [94](#L94) | $wp\_version = get\_bloginfo('version'); |
| [95](#L95) |  |
| [96](#L96) | if (version\_compare($wp\_version, $scf\_wp\_vers, '<')) { |
| [97](#L97) |  |
| [98](#L98) | if (is\_plugin\_active($scf\_path)) { |
| [99](#L99) |  |
| [100](#L100) | deactivate\_plugins($scf\_path); |
| [101](#L101) |  |
| [102](#L102) | $msg  = '<strong>'. $scf\_plugin .'</strong> '; |
| [103](#L103) | $msg .= esc\_html\_\_('requires WordPress ', 'scf') . $scf\_wp\_vers; |
| [104](#L104) | $msg .= esc\_html\_\_(' or higher, and has been deactivated! Please return to the', 'scf'); |
| [105](#L105) | $msg .= ' <a href="'. admin\_url() .'">'. esc\_html\_\_('WP Admin Area', 'scf') .'</a> '; |
| [106](#L106) | $msg .= esc\_html\_\_('to upgrade WordPress and try again.', 'scf'); |
| [107](#L107) |  |
| [108](#L108) | wp\_die($msg); |
| [109](#L109) |  |
| [110](#L110) | } |
| [111](#L111) |  |
| [112](#L112) | } |
| [113](#L113) |  |
| [114](#L114) | } |
| [115](#L115) |  |
| [116](#L116) | } |
| [117](#L117) | add\_action('admin\_init', 'scf\_require\_wp\_version'); |
| [118](#L118) |  |
| [119](#L119) |  |
| [120](#L120) |  |
| [121](#L121) | $scf\_value\_name     = isset($\_POST['scf\_name'])     ? sanitize\_text\_field($\_POST['scf\_name'])        : ''; |
| [122](#L122) | $scf\_value\_email    = isset($\_POST['scf\_email'])    ? sanitize\_text\_field($\_POST['scf\_email']) : ''; |
| [123](#L123) | $scf\_value\_confirm\_email = isset($\_POST['scf\_confirm\_email']) ? sanitize\_text\_field($\_POST['scf\_confirm\_email']) : ''; |
| [124](#L124) | $scf\_value\_subject  = isset($\_POST['scf\_subject'])  ? sanitize\_text\_field($\_POST['scf\_subject'])     : ''; |
| [125](#L125) | $scf\_value\_response = isset($\_POST['scf\_response']) ? sanitize\_text\_field($\_POST['scf\_response'])    : ''; |
| [126](#L126) | $scf\_value\_message  = isset($\_POST['scf\_message'])  ? sanitize\_text\_field($\_POST['scf\_message']) : ''; |
| [127](#L127) |  |
| [128](#L128) | $scf\_strings = array( |
| [129](#L129) | 'name'     => '<input name="scf\_name" id="scf\_name" type="text" size="33" maxlength="99" value="'. esc\_attr( $scf\_value\_name ) .'" placeholder="' . $scf\_options['scf\_input\_name'] . '" />', |
| [130](#L130) | 'email'    => '<input name="scf\_email" id="scf\_email" type="text" size="33" maxlength="99" value="'. esc\_attr( $scf\_value\_email ) .'" placeholder="' . $scf\_options['scf\_input\_email'] . '" />', |
| [131](#L131) | 'confirm\_email' => '<input name="scf\_confirm\_email" id="scf\_confirm\_email" type="text" size="33" maxlength="99" value="'. esc\_attr( $scf\_value\_confirm\_email ) .'" placeholder="' . $scf\_options['scf\_input\_confirm\_email'] . '" />', |
| [132](#L132) | 'subject'  => '<input name="scf\_subject" id="scf\_subject" type="text" size="33" maxlength="99" value="'. esc\_attr( $scf\_value\_subject ) .'" placeholder="' . $scf\_options['scf\_input\_subject'] . '" />', |
| [133](#L133) | 'response' => '<input name="scf\_response" id="scf\_response" type="text" size="33" maxlength="99" value="'. esc\_attr( $scf\_value\_response ) .'" placeholder="' . $scf\_options['scf\_input\_captcha'] . '" />', |
| [134](#L134) | 'message'  => '<textarea name="scf\_message" id="scf\_message" cols="33" rows="7" placeholder="' . $scf\_options['scf\_input\_message'] . '">'. $scf\_value\_message .'</textarea>', |
| [135](#L135) | 'error'    => '' |
| [136](#L136) | ); |
| [137](#L137) |  |
| [138](#L138) |  |
| [139](#L139) |  |
| [140](#L140) | function scf\_input\_filter() { |
| [141](#L141) |  |
| [142](#L142) | global $scf\_options, $scf\_strings, $scf\_value\_name, $scf\_value\_email, $scf\_value\_confirm\_email, $scf\_value\_subject, $scf\_value\_message, $scf\_value\_response; |
| [143](#L143) |  |
| [144](#L144) | global $scf\_processed; |
| [145](#L145) |  |
| [146](#L146) | $input\_name     = $scf\_value\_name; |
| [147](#L147) | $input\_email    = $scf\_value\_email; |
| [148](#L148) | $input\_confirm\_email = $scf\_value\_confirm\_email; |
| [149](#L149) | $input\_subject  = $scf\_value\_subject; |
| [150](#L150) | $input\_message  = $scf\_value\_message; |
| [151](#L151) | $input\_response = $scf\_value\_response; |
| [152](#L152) |  |
| [153](#L153) | $name    = isset($scf\_options['scf\_input\_name'])    ? $scf\_options['scf\_input\_name']    : ''; |
| [154](#L154) | $email   = isset($scf\_options['scf\_input\_email'])   ? $scf\_options['scf\_input\_email']   : ''; |
| [155](#L155) | $confirm\_email   = isset($scf\_options['scf\_input\_confirm\_email']) ? $scf\_options['scf\_input\_confirm\_email']   : ''; |
| [156](#L156) | $subject = isset($scf\_options['scf\_input\_subject']) ? $scf\_options['scf\_input\_subject'] : ''; |
| [157](#L157) | $message = isset($scf\_options['scf\_input\_message']) ? $scf\_options['scf\_input\_message'] : ''; |
| [158](#L158) | $captcha = isset($scf\_options['scf\_input\_captcha']) ? $scf\_options['scf\_input\_captcha'] : ''; |
| [159](#L159) | $style   = isset($scf\_options['scf\_style'])         ? $scf\_options['scf\_style']         : ''; |
| [160](#L160) | $error   = isset($scf\_options['scf\_error'])         ? $scf\_options['scf\_error']         : ''; |
| [161](#L161) | $spam    = isset($scf\_options['scf\_spam'])          ? $scf\_options['scf\_spam']          : ''; |
| [162](#L162) |  |
| [163](#L163) | $show\_subject = isset($scf\_options['scf\_subject'])        ? $scf\_options['scf\_subject']        : false; |
| [164](#L164) | $show\_message = isset($scf\_options['scf\_enable\_message']) ? $scf\_options['scf\_enable\_message'] : true; |
| [165](#L165) | $show\_captcha = isset($scf\_options['scf\_captcha'])        ? $scf\_options['scf\_captcha']        : true; |
| [166](#L166) | $show\_honeypot = isset($scf\_options['scf\_honeypot'])      ? $scf\_options['scf\_honeypot']       : true; |
| [167](#L167) |  |
| [168](#L168) | // recaptcha |
| [169](#L169) | $recaptcha = isset($scf\_options['scf\_recaptcha']) ? $scf\_options['scf\_recaptcha'] : false; |
| [170](#L170) | $recaptcha\_version = isset($scf\_options['scf\_recaptcha\_version']) ? $scf\_options['scf\_recaptcha\_version'] : 'v2'; |
| [171](#L171) | $recaptcha\_site\_key = isset($scf\_options['scf\_recaptcha\_site\_key']) ? $scf\_options['scf\_recaptcha\_site\_key'] : ''; |
| [172](#L172) | $recaptcha\_secret\_key = isset($scf\_options['scf\_recaptcha\_secret\_key']) ? $scf\_options['scf\_recaptcha\_secret\_key'] : ''; |
| [173](#L173) |  |
| [174](#L174) | $include\_additional\_information = isset($scf\_options['scf\_include\_additional\_information']) ? $scf\_options['scf\_include\_additional\_information'] : true; |
| [175](#L175) |  |
| [176](#L176) | $nonce = isset($\_POST['scf-nonce']) ? sanitize\_text\_field($\_POST['scf-nonce']) : false; |
| [177](#L177) | $key   = isset($\_POST['scf-key'])   ? sanitize\_text\_field($\_POST['scf-key'])   : false; |
| [178](#L178) |  |
| [179](#L179) | $pass = true; |
| [180](#L180) |  |
| [181](#L181) | if (empty($key)) return false; |
| [182](#L182) |  |
| [183](#L183) | if ( ! empty( $\_POST['website3dhhsy3'] ) ) { |
| [184](#L184) |  |
| [185](#L185) | $pass = false; |
| [186](#L186) | $notice = esc\_html\_\_( 'Invalid submission.', 'scf' ); |
| [187](#L187) | $scf\_strings['error'] = '<p class="scf\_error">'. $notice .'</p>'; |
| [188](#L188) |  |
| [189](#L189) | } |
| [190](#L190) |  |
| [191](#L191) | if (!wp\_verify\_nonce($nonce, 'scf-nonce')) { |
| [192](#L192) |  |
| [193](#L193) | $pass = false; |
| [194](#L194) | $notice = esc\_html\_\_('Invalid nonce value! Please try again or contact the administrator for help.', 'scf'); |
| [195](#L195) | $scf\_strings['error'] = '<p class="scf\_error">'. $notice .'</p>'; |
| [196](#L196) |  |
| [197](#L197) | } |
| [198](#L198) |  |
| [199](#L199) | if (scf\_malicious\_input($input\_name) || scf\_malicious\_input($input\_email) || scf\_malicious\_input($input\_subject)) { |
| [200](#L200) |  |
| [201](#L201) | $pass = false; |
| [202](#L202) | $notice  = esc\_html\_\_('Please do not include any of the following in the Name, Email, or Subject fields: ', 'scf'); |
| [203](#L203) | $notice .= esc\_html\_\_('line breaks, &ldquo;mime-version&rdquo;, &ldquo;content-type&rdquo;, &ldquo;cc:&rdquo; &ldquo;to:&rdquo;', 'scf'); |
| [204](#L204) | $scf\_strings['error'] = '<p class="scf\_error">'. $notice .'</p>'; |
| [205](#L205) |  |
| [206](#L206) | } |
| [207](#L207) |  |
| [208](#L208) | if (empty($input\_name)) { |
| [209](#L209) |  |
| [210](#L210) | $pass = false; |
| [211](#L211) | $scf\_strings['error'] = $error; |
| [212](#L212) | $scf\_strings['name']  = '<input class="scf\_error" name="scf\_name" id="scf\_name" type="text" size="33" maxlength="99" '; |
| [213](#L213) | $scf\_strings['name'] .= 'value="'. $input\_name .'" '. $style .' placeholder="'. $name .'" />'; |
| [214](#L214) | } |
| [215](#L215) |  |
| [216](#L216) | if (!is\_email($input\_email)) { |
| [217](#L217) |  |
| [218](#L218) | $pass = false; |
| [219](#L219) | $scf\_strings['error'] = $error; |
| [220](#L220) | $scf\_strings['email']  = '<input class="scf\_error" name="scf\_email" id="scf\_email" type="text" size="33" maxlength="99" '; |
| [221](#L221) | $scf\_strings['email'] .= 'value="'. $input\_email .'" '. $style .' placeholder="'. $email .'" />'; |
| [222](#L222) |  |
| [223](#L223) | } |
| [224](#L224) |  |
| [225](#L225) | if ( ! empty( $scf\_options['scf\_input\_confirm\_email'] ) && ! empty( $scf\_options['scf\_confirm\_mailtext'] ) && $input\_email != $input\_confirm\_email ) { |
| [226](#L226) |  |
| [227](#L227) | $pass = false; |
| [228](#L228) | $scf\_strings['error'] = '<p class="scf\_error">' . esc\_html\_\_('Confirmation email needs to match email. ', 'scf') . '</p>'; |
| [229](#L229) | $scf\_strings['confirm\_email']  = '<input class="scf\_error" name="scf\_confirm\_email" id="scf\_confirm\_email" type="text" size="33" maxlength="99" '; |
| [230](#L230) | $scf\_strings['confirm\_email'] .= 'value="'. $input\_confirm\_email .'" '. $style .' placeholder="'. $confirm\_email .'" />'; |
| [231](#L231) |  |
| [232](#L232) | } |
| [233](#L233) |  |
| [234](#L234) | if (empty($show\_subject) && empty($input\_subject)) { |
| [235](#L235) |  |
| [236](#L236) | $pass = false; |
| [237](#L237) | $scf\_strings['error'] = $error; |
| [238](#L238) | $scf\_strings['subject']  = '<input class="scf\_error" name="scf\_subject" id="scf\_subject" type="text" size="33" maxlength="99" '; |
| [239](#L239) | $scf\_strings['subject'] .= 'value="'. $input\_subject .'" '. $style .' placeholder="'. $subject .'" />'; |
| [240](#L240) |  |
| [241](#L241) | } |
| [242](#L242) |  |
| [243](#L243) | if ($show\_message && empty($input\_message)) { |
| [244](#L244) |  |
| [245](#L245) | $pass = false; |
| [246](#L246) | $scf\_strings['error'] = $error; |
| [247](#L247) | $scf\_strings['message']  = '<textarea class="scf\_error" name="scf\_message" id="scf\_message" cols="33" rows="7" '; |
| [248](#L248) | $scf\_strings['message'] .= $style .' placeholder="' . $message .'">'. $input\_message .'</textarea>'; |
| [249](#L249) |  |
| [250](#L250) | } |
| [251](#L251) |  |
| [252](#L252) | if ($show\_captcha && (empty($input\_response) || !scf\_spam\_question($input\_response))) { |
| [253](#L253) |  |
| [254](#L254) | $pass = false; |
| [255](#L255) | $scf\_strings['error'] = $spam; |
| [256](#L256) | $scf\_strings['response']  = '<input class="scf\_error" name="scf\_response" id="scf\_response" type="text" size="33" maxlength="99" '; |
| [257](#L257) | $scf\_strings['response'] .= 'value="'. $input\_response .'" '. $style .' placeholder="'. $captcha .'" />'; |
| [258](#L258) |  |
| [259](#L259) | } |
| [260](#L260) |  |
| [261](#L261) | if ( $recaptcha && ! $scf\_processed ) { |
| [262](#L262) |  |
| [263](#L263) | // recaptcha v2 |
| [264](#L264) | if ( $recaptcha\_version == 'v2' ) { |
| [265](#L265) |  |
| [266](#L266) | if ( isset( $\_POST['g-recaptcha-response'] ) ) { |
| [267](#L267) |  |
| [268](#L268) | $captcha = $\_POST['g-recaptcha-response']; |
| [269](#L269) | $captcha\_result = wp\_remote\_post( 'https://www.google.com/recaptcha/api/siteverify', array( |
| [270](#L270) | 'method' => 'POST', |
| [271](#L271) | 'body' => array( |
| [272](#L272) | 'secret' => $recaptcha\_secret\_key, |
| [273](#L273) | 'response' => $captcha, |
| [274](#L274) | ) |
| [275](#L275) | )); |
| [276](#L276) | if ( is\_wp\_error( $captcha\_result ) ) { |
| [277](#L277) | $pass = false; |
| [278](#L278) | $scf\_strings['error'] = '<p class="scf\_error">' . esc\_html\_\_('reCAPTCHA not filled in. ', 'scf') . '</p>'; |
| [279](#L279) | } else { |
| [280](#L280) | $captcha\_response = json\_decode( $captcha\_result['body'], true ); |
| [281](#L281) | if ( ! $captcha\_response['success'] ) { |
| [282](#L282) | $pass = false; |
| [283](#L283) | $scf\_strings['error'] = '<p class="scf\_error">' . esc\_html\_\_('reCAPTCHA not filled in. ', 'scf') . '</p>'; |
| [284](#L284) | } |
| [285](#L285) | } |
| [286](#L286) |  |
| [287](#L287) | } else { |
| [288](#L288) |  |
| [289](#L289) | $pass = false; |
| [290](#L290) | $scf\_strings['error'] = '<p class="scf\_error">' . esc\_html\_\_('reCAPTCHA not filled in. ', 'scf') . '</p>'; |
| [291](#L291) |  |
| [292](#L292) | } |
| [293](#L293) |  |
| [294](#L294) | } elseif ( $recaptcha\_version == 'v3' ) { |
| [295](#L295) |  |
| [296](#L296) | if ( isset( $\_POST['token'] ) ) { |
| [297](#L297) |  |
| [298](#L298) | $captcha = $\_POST['token']; |
| [299](#L299) | $action = $\_POST['action']; |
| [300](#L300) |  |
| [301](#L301) | $captcha\_result = wp\_remote\_post( 'https://www.google.com/recaptcha/api/siteverify', array( |
| [302](#L302) | 'method' => 'POST', |
| [303](#L303) | 'body' => array( |
| [304](#L304) | 'secret' => $recaptcha\_secret\_key, |
| [305](#L305) | 'response' => $captcha, |
| [306](#L306) | ) |
| [307](#L307) | )); |
| [308](#L308) | if ( is\_wp\_error( $captcha\_result ) ) { |
| [309](#L309) | $pass = false; |
| [310](#L310) | $scf\_strings['error'] = '<p class="scf\_error">' . esc\_html\_\_('reCAPTCHA not passed [error 1]. ', 'scf') . '</p>'; |
| [311](#L311) | } else { |
| [312](#L312) | $captcha\_response = json\_decode( $captcha\_result['body'], true ); |
| [313](#L313) | if ( ! $captcha\_response['success'] || ! $captcha\_response['action'] == $action || $captcha\_response['score'] < 0.5 ) { |
| [314](#L314) | $pass = false; |
| [315](#L315) | $scf\_strings['error'] = '<p class="scf\_error">' . esc\_html\_\_('reCAPTCHA not passed [error 2]. ', 'scf') . '</p>'; |
| [316](#L316) | } |
| [317](#L317) | } |
| [318](#L318) |  |
| [319](#L319) | } else { |
| [320](#L320) |  |
| [321](#L321) | $pass = false; |
| [322](#L322) | $scf\_strings['error'] = '<p class="scf\_error">' . esc\_html\_\_('reCAPTCHA not filled in. ', 'scf') . '</p>'; |
| [323](#L323) |  |
| [324](#L324) | } |
| [325](#L325) |  |
| [326](#L326) | } |
| [327](#L327) |  |
| [328](#L328) | } |
| [329](#L329) |  |
| [330](#L330) | if ($pass == true) return true; |
| [331](#L331) |  |
| [332](#L332) | return false; |
| [333](#L333) |  |
| [334](#L334) | } |
| [335](#L335) |  |
| [336](#L336) |  |
| [337](#L337) |  |
| [338](#L338) | function scf\_malicious\_input($input) { |
| [339](#L339) |  |
| [340](#L340) | $maliciousness = false; |
| [341](#L341) |  |
| [342](#L342) | $denied\_inputs = array("\r", "\n", "mime-version", "content-type", "cc:", "to:"); |
| [343](#L343) |  |
| [344](#L344) | foreach($denied\_inputs as $denied\_input) { |
| [345](#L345) |  |
| [346](#L346) | if (strpos(strtolower($input), strtolower($denied\_input)) !== false) { |
| [347](#L347) |  |
| [348](#L348) | $maliciousness = true; |
| [349](#L349) |  |
| [350](#L350) | break; |
| [351](#L351) |  |
| [352](#L352) | } |
| [353](#L353) |  |
| [354](#L354) | } |
| [355](#L355) |  |
| [356](#L356) | return $maliciousness; |
| [357](#L357) |  |
| [358](#L358) | } |
| [359](#L359) |  |
| [360](#L360) |  |
| [361](#L361) |  |
| [362](#L362) | function scf\_spam\_question($input) { |
| [363](#L363) |  |
| [364](#L364) | global $scf\_options; |
| [365](#L365) |  |
| [366](#L366) | $casing   = $scf\_options['scf\_casing']; |
| [367](#L367) | $response = $scf\_options['scf\_response']; |
| [368](#L368) | $response = sanitize\_text\_field($response); |
| [369](#L369) |  |
| [370](#L370) | if ($casing == false) return (strtoupper($input) == strtoupper($response)); |
| [371](#L371) |  |
| [372](#L372) | else return ($input == $response); |
| [373](#L373) |  |
| [374](#L374) | } |
| [375](#L375) |  |
| [376](#L376) |  |
| [377](#L377) |  |
| [378](#L378) | function scf\_get\_ip\_address() { |
| [379](#L379) |  |
| [380](#L380) | if (isset($\_SERVER)) { |
| [381](#L381) |  |
| [382](#L382) | if (isset($\_SERVER['HTTP\_X\_FORWARDED\_FOR'])) { |
| [383](#L383) | $ip\_address = $\_SERVER['HTTP\_X\_FORWARDED\_FOR']; |
| [384](#L384) |  |
| [385](#L385) | } elseif (isset($\_SERVER['HTTP\_CLIENT\_IP'])) { |
| [386](#L386) | $ip\_address = $\_SERVER['HTTP\_CLIENT\_IP']; |
| [387](#L387) |  |
| [388](#L388) | } else { |
| [389](#L389) | $ip\_address = $\_SERVER['REMOTE\_ADDR']; |
| [390](#L390) |  |
| [391](#L391) | } |
| [392](#L392) |  |
| [393](#L393) | } else { |
| [394](#L394) |  |
| [395](#L395) | if (getenv('HTTP\_X\_FORWARDED\_FOR')) { |
| [396](#L396) | $ip\_address = getenv('HTTP\_X\_FORWARDED\_FOR'); |
| [397](#L397) |  |
| [398](#L398) | } elseif (getenv('HTTP\_CLIENT\_IP')) { |
| [399](#L399) | $ip\_address = getenv('HTTP\_CLIENT\_IP'); |
| [400](#L400) |  |
| [401](#L401) | } else { |
| [402](#L402) | $ip\_address = getenv('REMOTE\_ADDR'); |
| [403](#L403) |  |
| [404](#L404) | } |
| [405](#L405) |  |
| [406](#L406) | } |
| [407](#L407) |  |
| [408](#L408) | return $ip\_address; |
| [409](#L409) |  |
| [410](#L410) | } |
| [411](#L411) |  |
| [412](#L412) |  |
| [413](#L413) |  |
| [414](#L414) | function scf\_shortcode() { |
| [415](#L415) |  |
| [416](#L416) | if (scf\_input\_filter()) return scf\_process\_contact\_form(); |
| [417](#L417) |  |
| [418](#L418) | return scf\_display\_contact\_form(); |
| [419](#L419) |  |
| [420](#L420) | } |
| [421](#L421) | add\_shortcode('simple\_contact\_form','scf\_shortcode'); |
| [422](#L422) |  |
| [423](#L423) | /\*\* |
| [424](#L424) | \* Shortcode for inputs |
| [425](#L425) | \* |
| [426](#L426) | \* @since 20191009 |
| [427](#L427) | \*/ |
| [428](#L428) | function scf\_input\_shortcode( $atts = array() ) { |
| [429](#L429) |  |
| [430](#L430) | $settings = shortcode\_atts( array( |
| [431](#L431) | 'type' => 'text', |
| [432](#L432) | 'name' => '', |
| [433](#L433) | 'value' => '', |
| [434](#L434) | 'required' => '', |
| [435](#L435) | 'checked' => '', |
| [436](#L436) | ), $atts ); |
| [437](#L437) |  |
| [438](#L438) | $extra\_atts = ''; |
| [439](#L439) |  |
| [440](#L440) | if ( ! empty( $settings['required'] ) ) { |
| [441](#L441) | $extra\_atts .= ' required'; |
| [442](#L442) | } |
| [443](#L443) |  |
| [444](#L444) | if ( ! empty( $settings['checked'] ) ) { |
| [445](#L445) | $extra\_atts .= ' checked'; |
| [446](#L446) | } |
| [447](#L447) |  |
| [448](#L448) | return '<input type="' . esc\_attr( $settings['type'] ) . '" name="' . esc\_attr( $settings['name'] ) . '" value="' . esc\_attr( $settings['value'] ) . '"' . $extra\_atts .' />'; |
| [449](#L449) |  |
| [450](#L450) | } add\_shortcode('simple\_contact\_form\_input', 'scf\_input\_shortcode'); |
| [451](#L451) |  |
| [452](#L452) | /\*\* |
| [453](#L453) | \* Shortcode for date |
| [454](#L454) | \* |
| [455](#L455) | \* @since 20191024 |
| [456](#L456) | \*/ |
| [457](#L457) | function scf\_date\_shortcode( $atts = array(), $content = '' ) { |
| [458](#L458) |  |
| [459](#L459) | if ( empty( $content ) ) { |
| [460](#L460) | $content = get\_option( 'date\_format' ); |
| [461](#L461) | } |
| [462](#L462) |  |
| [463](#L463) | return current\_time( $content ); |
| [464](#L464) |  |
| [465](#L465) | } add\_shortcode('simple\_contact\_form\_date', 'scf\_date\_shortcode'); |
| [466](#L466) |  |
| [467](#L467) | function simple\_contact\_form() { |
| [468](#L468) |  |
| [469](#L469) | if (scf\_input\_filter()) { |
| [470](#L470) |  |
| [471](#L471) | echo scf\_process\_contact\_form(); |
| [472](#L472) |  |
| [473](#L473) | } else { |
| [474](#L474) |  |
| [475](#L475) | echo scf\_display\_contact\_form(); |
| [476](#L476) |  |
| [477](#L477) | } |
| [478](#L478) |  |
| [479](#L479) | } |
| [480](#L480) |  |
| [481](#L481) |  |
| [482](#L482) |  |
| [483](#L483) | function scf\_process\_contact\_form() { |
| [484](#L484) |  |
| [485](#L485) | global $scf\_options; |
| [486](#L486) | global $scf\_processed; |
| [487](#L487) |  |
| [488](#L488) | $recipient = $scf\_options['scf\_email']; |
| [489](#L489) | $recipfrom = $scf\_options['scf\_from']; |
| [490](#L490) | $recipname = $scf\_options['scf\_name']; |
| [491](#L491) | $recipsite = $scf\_options['scf\_website']; |
| [492](#L492) | $success   = $scf\_options['scf\_success']; |
| [493](#L493) | $subject   = $scf\_options['scf\_subject']; |
| [494](#L494) | $prepend   = $scf\_options['scf\_prepend']; |
| [495](#L495) | $append    = $scf\_options['scf\_append']; |
| [496](#L496) | $carbon    = $scf\_options['scf\_carbon']; |
| [497](#L497) | $custom    = $scf\_options['scf\_css']; |
| [498](#L498) | $messdisp  = $scf\_options['scf\_enable\_message']; |
| [499](#L499) | $mailfunc  = $scf\_options['scf\_mail\_function']; |
| [500](#L500) | $verbose   = $scf\_options['scf\_success\_details']; |
| [501](#L501) |  |
| [502](#L502) | if ( ! empty( $scf\_options['scf\_include\_additional\_information'] ) ) { |
| [503](#L503) | $include\_additional\_information = $scf\_options['scf\_include\_additional\_information']; |
| [504](#L504) | } else { |
| [505](#L505) | $include\_additional\_information = false; |
| [506](#L506) | } |
| [507](#L507) |  |
| [508](#L508) | if ( ! empty( $scf\_options['scf\_blacklist'] ) ) { |
| [509](#L509) | $blacklist = explode( ',', $scf\_options['scf\_blacklist'] ); |
| [510](#L510) | } else { |
| [511](#L511) | $blacklist = false; |
| [512](#L512) | } |
| [513](#L513) |  |
| [514](#L514) | if ( ! empty( $scf\_options['scf\_recaptcha'] ) ) { |
| [515](#L515) | $recaptcha = $scf\_options['scf\_recaptcha']; |
| [516](#L516) | } else { |
| [517](#L517) | $recaptcha = false; |
| [518](#L518) | } |
| [519](#L519) |  |
| [520](#L520) | if ( ! empty( $scf\_options['scf\_recaptcha\_version'] ) ) { |
| [521](#L521) | $recaptcha\_version = $scf\_options['scf\_recaptcha\_version']; |
| [522](#L522) | } else { |
| [523](#L523) | $recaptcha\_version = 'v2'; |
| [524](#L524) | } |
| [525](#L525) |  |
| [526](#L526) | if ( ! empty( $scf\_options['scf\_recaptcha\_site\_key'] ) ) { |
| [527](#L527) | $recaptcha\_site\_key = $scf\_options['scf\_recaptcha\_site\_key']; |
| [528](#L528) | } else { |
| [529](#L529) | $recaptcha\_site\_key = ''; |
| [530](#L530) | } |
| [531](#L531) |  |
| [532](#L532) | if ( ! empty( $scf\_options['scf\_recaptcha\_secrey\_key'] ) ) { |
| [533](#L533) | $recaptcha\_secret\_key = $scf\_options['scf\_recaptcha\_secrey\_key']; |
| [534](#L534) | } else { |
| [535](#L535) | $recaptcha\_secret\_key = ''; |
| [536](#L536) | } |
| [537](#L537) |  |
| [538](#L538) | $charset = get\_option('blog\_charset', 'UTF-8'); |
| [539](#L539) |  |
| [540](#L540) | $date    = date\_i18n(get\_option('date\_format'), current\_time('timestamp')) .' @ '. date\_i18n(get\_option('time\_format'), current\_time('timestamp')); |
| [541](#L541) |  |
| [542](#L542) | $topic   = (isset($\_POST['scf\_subject']) && !empty($\_POST['scf\_subject'])) ? sanitize\_text\_field( stripslashes(strip\_tags(trim($\_POST['scf\_subject'])))) : $subject; |
| [543](#L543) | $topic = strip\_shortcodes( $topic ); |
| [544](#L544) | $topic = str\_replace( '[simple\_contact\_form\_date]', current\_time( get\_option( 'date\_format' ) ), $topic ); |
| [545](#L545) |  |
| [546](#L546) | $name    = isset($\_POST['scf\_name']) ? sanitize\_text\_field( stripslashes(strip\_tags(trim($\_POST['scf\_name']))) ) : ''; |
| [547](#L547) | $name = strip\_shortcodes( $name ); |
| [548](#L548) | $topic = str\_replace( '{name}', $name, $topic ); |
| [549](#L549) |  |
| [550](#L550) | $message = isset($\_POST['scf\_message']) ? sanitize\_text\_field( stripslashes(trim($\_POST['scf\_message'])) ) : ''; |
| [551](#L551) | $message = strip\_shortcodes( $message ); |
| [552](#L552) |  |
| [553](#L553) | $email   = isset($\_POST['scf\_email']) ? sanitize\_text\_field($\_POST['scf\_email']) : ''; |
| [554](#L554) | $email = strip\_shortcodes( $email ); |
| [555](#L555) |  |
| [556](#L556) | $agent   = isset($\_SERVER['HTTP\_USER\_AGENT']) ? sanitize\_text\_field($\_SERVER['HTTP\_USER\_AGENT']) : esc\_html\_\_('[ undefined ]', 'scf'); |
| [557](#L557) | $agent = sanitize\_text\_field( $agent ); |
| [558](#L558) |  |
| [559](#L559) | $form    = isset($\_SERVER['HTTP\_REFERER']) ? sanitize\_text\_field($\_SERVER['HTTP\_REFERER']) : esc\_html\_\_('[ undefined ]', 'scf'); |
| [560](#L560) | $form = sanitize\_text\_field( $form ); |
| [561](#L561) |  |
| [562](#L562) | $host    = isset($\_SERVER['REMOTE\_ADDR']) ? sanitize\_text\_field(gethostbyaddr($\_SERVER['REMOTE\_ADDR'])) : esc\_html\_\_('[ undefined ]', 'scf'); |
| [563](#L563) | $host = sanitize\_text\_field( $host ); |
| [564](#L564) |  |
| [565](#L565) | $from    = !empty($recipfrom) ? $recipfrom : $email; |
| [566](#L566) |  |
| [567](#L567) | $ip      = sanitize\_text\_field(scf\_get\_ip\_address()); |
| [568](#L568) |  |
| [569](#L569) | $style   = !empty($custom) ? '<style type="text/css">'. $custom .'</style>' : ''; |
| [570](#L570) |  |
| [571](#L571) | $copy    = ($carbon) ? '<p class="scf\_carbon">'. esc\_html\_\_('A copy of this message was sent to your email address.', 'scf') .'</p>' : ''; |
| [572](#L572) |  |
| [573](#L573) | $headers  = 'X-Mailer: Simple Basic Contact Form'. "\n"; |
| [574](#L574) | $headers .= 'From: '. $name .' <'. $from .'>'. "\n"; |
| [575](#L575) | $headers .= 'Reply-To: '. $name .' <'. $email .'>'. "\n"; |
| [576](#L576) | $headers .= 'Content-Type: text/plain; charset='. $charset . "\n"; |
| [577](#L577) |  |
| [578](#L578) | $message\_encode = htmlentities($message, ENT\_QUOTES, $charset); |
| [579](#L579) |  |
| [580](#L580) | $message\_plain = ($messdisp) ? "\n" . esc\_html\_\_('Message: ', 'scf') . "\n\n" . $message : ''; |
| [581](#L581) | $message\_front = ($messdisp) ? "\n" . esc\_html\_\_('Message: ', 'scf') . "\n\n" . $message\_encode : ''; |
| [582](#L582) |  |
| [583](#L583) | $custom\_content = apply\_filters( 'scf\_custom\_email\_content', '' ); |
| [584](#L584) | if ( empty( $custom\_content ) ) { |
| [585](#L585) | $custom\_content = ''; |
| [586](#L586) | } |
| [587](#L587) |  |
| [588](#L588) | $message\_send = esc\_html\_\_('Hello ', 'scf') . $recipname .', '. "\n\n" . |
| [589](#L589) | esc\_html\_\_('You are being contacted via ', 'scf') . $recipsite .': '. "\n\n" . |
| [590](#L590) |  |
| [591](#L591) | esc\_html\_\_('Name:     ', 'scf') . $name  . "\n" . |
| [592](#L592) | esc\_html\_\_('Email:    ', 'scf') . $email . "\n" . |
| [593](#L593) | esc\_html\_\_('Subject:  ', 'scf') . $topic . "\n" . |
| [594](#L594) | esc\_html\_\_('Date:     ', 'scf') . $date  . "\n" . |
| [595](#L595) |  |
| [596](#L596) | $custom\_content . $message\_plain . "\n\n"; |
| [597](#L597) |  |
| [598](#L598) | // additional information |
| [599](#L599) | if ( $include\_additional\_information ) { |
| [600](#L600) |  |
| [601](#L601) | $message\_send .= esc\_html\_\_('-----------------------', 'scf') . "\n\n"; |
| [602](#L602) | $message\_send .= esc\_html\_\_('Additional Information:', 'scf') . "\n\n"; |
| [603](#L603) | $message\_send .= esc\_html\_\_('Site:     ', 'scf') . $recipsite . "\n"; |
| [604](#L604) | $message\_send .= esc\_html\_\_('URL:      ', 'scf') . $form      . "\n"; |
| [605](#L605) | $message\_send .= esc\_html\_\_('IP:       ', 'scf') . $ip        . "\n"; |
| [606](#L606) | $message\_send .= esc\_html\_\_('Host:     ', 'scf') . $host      . "\n"; |
| [607](#L607) | $message\_send .= esc\_html\_\_('Agent:    ', 'scf') . $agent     . "\n\n"; |
| [608](#L608) |  |
| [609](#L609) | } |
| [610](#L610) |  |
| [611](#L611) | $message\_send = apply\_filters('scf\_full\_message', $message\_send); |
| [612](#L612) |  |
| [613](#L613) | // check if message contains blacklisted words |
| [614](#L614) | $valid\_submission = true; |
| [615](#L615) | if ( is\_array( $blacklist ) ) { |
| [616](#L616) | foreach ( $blacklist as $blacklist\_item ) { |
| [617](#L617) | if ( ! empty( trim( $blacklist\_item) ) ) { |
| [618](#L618) | if (stripos( $message\_plain, trim( $blacklist\_item ) ) !== false) { |
| [619](#L619) | $valid\_submission = false; |
| [620](#L620) | } |
| [621](#L621) | } |
| [622](#L622) | } |
| [623](#L623) | } |
| [624](#L624) |  |
| [625](#L625) | if ( $valid\_submission && ! $scf\_processed ) { |
| [626](#L626) |  |
| [627](#L627) | if ($mailfunc) { |
| [628](#L628) |  |
| [629](#L629) | if ($carbon) mail($email,     $topic, $message\_send, $headers); |
| [630](#L630) | mail($recipient, $topic, $message\_send, $headers); |
| [631](#L631) |  |
| [632](#L632) | } else { |
| [633](#L633) |  |
| [634](#L634) | if ($carbon) wp\_mail($email,     $topic, $message\_send, $headers); |
| [635](#L635) | wp\_mail($recipient, $topic, $message\_send, $headers); |
| [636](#L636) |  |
| [637](#L637) | } |
| [638](#L638) |  |
| [639](#L639) | } |
| [640](#L640) |  |
| [641](#L641) | do\_action('scf\_send\_email', $recipient, $topic, $message\_send, $headers, $email); |
| [642](#L642) |  |
| [643](#L643) | $reset\_link  = '<p class="scf\_reset">'. esc\_html\_\_('[ ', 'scf'); |
| [644](#L644) | $reset\_link .= '<a href="'. $form .'">'. esc\_html\_\_('Click here to reset the form', 'scf') .'</a>'; |
| [645](#L645) | $reset\_link .= esc\_html\_\_(' ]', 'scf') .'</p></div>'. $style . do\_shortcode( $append ); |
| [646](#L646) |  |
| [647](#L647) | $short\_results  = do\_shortcode( $prepend ) .'<div id="scf\_success" class="scf">'. $success; |
| [648](#L648) | $short\_results .= ($messdisp) ? '<pre><code>'. esc\_html\_\_('Message: ', 'scf') . "\n\n" . $message\_encode .'</code></pre>' : ''; |
| [649](#L649) | $short\_results .= $copy . $reset\_link; |
| [650](#L650) |  |
| [651](#L651) | $full\_results = do\_shortcode( $prepend ) .'<div id="scf\_success" class="scf">'. $success .'<pre><code>'. |
| [652](#L652) | esc\_html\_\_('Name:     ', 'scf') . $name  . "\n" . |
| [653](#L653) | esc\_html\_\_('Email:    ', 'scf') . $email . "\n" . |
| [654](#L654) | esc\_html\_\_('Subject:  ', 'scf') . $topic . "\n" . |
| [655](#L655) | esc\_html\_\_('Date:     ', 'scf') . $date  . $message\_front .'</code></pre>'. $copy . $reset\_link; |
| [656](#L656) |  |
| [657](#L657) | $full\_results = '<div id="simple-contact-form-wrap">' . $full\_results . '</div>'; |
| [658](#L658) | $short\_results = '<div id="simple-contact-form-wrap">' . $short\_results . '</div>'; |
| [659](#L659) |  |
| [660](#L660) | $short\_results = apply\_filters('scf\_short\_results', $short\_results); |
| [661](#L661) | $full\_results  = apply\_filters('scf\_full\_results',  $full\_results); |
| [662](#L662) |  |
| [663](#L663) | $scf\_processed = true; |
| [664](#L664) |  |
| [665](#L665) | if ($verbose) return $full\_results; |
| [666](#L666) |  |
| [667](#L667) | return $short\_results; |
| [668](#L668) |  |
| [669](#L669) | } |
| [670](#L670) |  |
| [671](#L671) |  |
| [672](#L672) |  |
| [673](#L673) | function scf\_display\_contact\_form() { |
| [674](#L674) |  |
| [675](#L675) | global $scf\_options, $scf\_strings; |
| [676](#L676) |  |
| [677](#L677) | $question = $scf\_options['scf\_question']; |
| [678](#L678) | $nametext = $scf\_options['scf\_nametext']; |
| [679](#L679) | $subjtext = $scf\_options['scf\_subjtext']; |
| [680](#L680) | $mailtext = $scf\_options['scf\_mailtext']; |
| [681](#L681) | $messtext = $scf\_options['scf\_messtext']; |
| [682](#L682) | $submittext = $scf\_options['scf\_submittext']; |
| [683](#L683) | $captcha  = $scf\_options['scf\_captcha']; |
| [684](#L684) | $preform  = $scf\_options['scf\_preform']; |
| [685](#L685) | $appform  = $scf\_options['scf\_appform']; |
| [686](#L686) | $custom   = $scf\_options['scf\_css']; |
| [687](#L687) | $error    = $scf\_strings['error']; |
| [688](#L688) | $subject  = $scf\_options['scf\_subject']; |
| [689](#L689) |  |
| [690](#L690) | if ( ! empty( $scf\_options['scf\_honeypot'] ) ) { |
| [691](#L691) | $honeypot = $scf\_options['scf\_honeypot']; |
| [692](#L692) | } else { |
| [693](#L693) | $honeypot = false; |
| [694](#L694) | } |
| [695](#L695) |  |
| [696](#L696) | if ( ! empty( $scf\_options['scf\_include\_additional\_information'] ) ) { |
| [697](#L697) | $include\_additional\_information = $scf\_options['scf\_include\_additional\_information']; |
| [698](#L698) | } else { |
| [699](#L699) | $include\_additional\_information = false; |
| [700](#L700) | } |
| [701](#L701) |  |
| [702](#L702) | if ( ! empty( $scf\_options['scf\_before\_button'] ) ) { |
| [703](#L703) | $before\_button = $scf\_options['scf\_before\_button']; |
| [704](#L704) | } else { |
| [705](#L705) | $before\_button = ''; |
| [706](#L706) | } |
| [707](#L707) |  |
| [708](#L708) | if ( ! empty( $scf\_options['scf\_blacklist'] ) ) { |
| [709](#L709) | $blacklist = $scf\_options['scf\_blacklist']; |
| [710](#L710) | } else { |
| [711](#L711) | $blacklist = ''; |
| [712](#L712) | } |
| [713](#L713) |  |
| [714](#L714) | if ( ! empty( $scf\_options['scf\_gdpr\_position'] ) ) { |
| [715](#L715) | $gdpr\_position = $scf\_options['scf\_gdpr\_position']; |
| [716](#L716) | } else { |
| [717](#L717) | $gdpr\_position = 'after\_submit'; |
| [718](#L718) | } |
| [719](#L719) |  |
| [720](#L720) | if ( ! empty( $scf\_options['scf\_recaptcha'] ) ) { |
| [721](#L721) | $recaptcha = $scf\_options['scf\_recaptcha']; |
| [722](#L722) | } else { |
| [723](#L723) | $recaptcha = false; |
| [724](#L724) | } |
| [725](#L725) |  |
| [726](#L726) | if ( ! empty( $scf\_options['scf\_recaptcha\_version'] ) ) { |
| [727](#L727) | $recaptcha\_version = $scf\_options['scf\_recaptcha\_version']; |
| [728](#L728) | } else { |
| [729](#L729) | $recaptcha\_version = 'v2'; |
| [730](#L730) | } |
| [731](#L731) |  |
| [732](#L732) | if ( ! empty( $scf\_options['scf\_recaptcha\_site\_key'] ) ) { |
| [733](#L733) | $recaptcha\_site\_key = $scf\_options['scf\_recaptcha\_site\_key']; |
| [734](#L734) | } else { |
| [735](#L735) | $recaptcha\_site\_key = ''; |
| [736](#L736) | } |
| [737](#L737) |  |
| [738](#L738) | if ( ! empty( $scf\_options['scf\_recaptcha\_secret\_key'] ) ) { |
| [739](#L739) | $recaptcha\_secret\_key = $scf\_options['scf\_recaptcha\_secret\_key']; |
| [740](#L740) | } else { |
| [741](#L741) | $recaptcha\_secret\_key = ''; |
| [742](#L742) | } |
| [743](#L743) |  |
| [744](#L744) | $styles = !empty($custom) ? '<style>.scf-confirm-checkbox { margin-top: 15px; } .scf-website3dhhsy3 { display: none; } #simple-contact-form .scf-row { width: 100%; overflow: hidden; margin: 5px 0; padding: 5px 0; border: 0; } #simple-contact-form .scf-row input { box-sizing: border-box; float: left; clear: none; width: 75%; margin: 0; } #simple-contact-form .scf-row label { box-sizing: border-box; float: left; clear: both; width: 25%; margin-top: 5px; font-size: 90%; } #simple-contact-form .scf-row textarea { box-sizing: border-box; float: left; clear: both; width: 100%; margin-top: 2px; }' . $custom . '</style>' : ''; |
| [745](#L745) |  |
| [746](#L746) | $scf\_subject = ''; |
| [747](#L747) | $scf\_captcha = ''; |
| [748](#L748) | $scf\_honeypot = ''; |
| [749](#L749) | $scf\_message = ''; |
| [750](#L750) | $scf\_recaptcha = ''; |
| [751](#L751) |  |
| [752](#L752) | if (empty($subject)) { |
| [753](#L753) | $scf\_subject = ' |
| [754](#L754) | <div class="scf-row scf-subject"> |
| [755](#L755) | <label for="scf\_subject">'. $subjtext .'</label> |
| [756](#L756) | '. $scf\_strings['subject'] .' |
| [757](#L757) | </div>'; |
| [758](#L758) | } |
| [759](#L759) |  |
| [760](#L760) | if ($captcha) { |
| [761](#L761) | $scf\_captcha = ' |
| [762](#L762) | <div class="scf-row scf-response"> |
| [763](#L763) | <label for="scf\_response">'. $question .'</label> |
| [764](#L764) | '. $scf\_strings['response'] .' |
| [765](#L765) | </div>'; |
| [766](#L766) | } |
| [767](#L767) |  |
| [768](#L768) | if ((!isset($scf\_options['scf\_enable\_message'])) || (isset($scf\_options['scf\_enable\_message']) && $scf\_options['scf\_enable\_message'])) { |
| [769](#L769) | $scf\_message = ' |
| [770](#L770) | <div class="scf-row scf-message"> |
| [771](#L771) | <label for="scf\_message">'. $messtext .'</label> |
| [772](#L772) | '. $scf\_strings['message'] .' |
| [773](#L773) | </div>'; |
| [774](#L774) | } |
| [775](#L775) |  |
| [776](#L776) | if ( $honeypot ) { |
| [777](#L777) | $scf\_honeypot = ' |
| [778](#L778) | <div class="scf-row scf-website3dhhsy3"> |
| [779](#L779) | <label for="website3dhhsy3">' . esc\_html\_\_( 'Leave this field empty', 'scf' ) . '</label> |
| [780](#L780) | <input type="text" name="website3dhhsy3" tabindex="-1" autocomplete="off" /> |
| [781](#L781) | </div>'; |
| [782](#L782) | } |
| [783](#L783) |  |
| [784](#L784) | // |
| [785](#L785) | if ( $recaptcha ) { |
| [786](#L786) | if ( $recaptcha\_version == 'v2' ) { |
| [787](#L787) | $scf\_recaptcha = ' |
| [788](#L788) | <div class="scf-recaptcha"> |
| [789](#L789) | <script src="https://www.google.com/recaptcha/api.js"></script> |
| [790](#L790) | <div class="g-recaptcha" data-sitekey="' . $recaptcha\_site\_key . '"></div> |
| [791](#L791) | </div>'; |
| [792](#L792) | } elseif ( $recaptcha\_version == 'v3' ) { |
| [793](#L793) | ob\_start(); |
| [794](#L794) | ?> |
| [795](#L795) | <div class="scf-recaptcha"> |
| [796](#L796) | <script src="https://www.google.com/recaptcha/api.js?render=<?php echo esc\_attr( $recaptcha\_site\_key ); ?>"></script> |
| [797](#L797) | <script> |
| [798](#L798) | jQuery(document).ready(function(){ |
| [799](#L799) | jQuery('.scf form').on( 'submit', function(event) { |
| [800](#L800) |  |
| [801](#L801) | event.preventDefault(); |
| [802](#L802) | var scfForm = jQuery(this); |
| [803](#L803) | var scfEmail = jQuery(this).find('#scf\_email').val(); |
| [804](#L804) |  |
| [805](#L805) | grecaptcha.ready(function() { |
| [806](#L806) | grecaptcha.execute('<?php echo esc\_attr( $recaptcha\_site\_key ); ?>', {action: 'contact'}).then(function(token) { |
| [807](#L807) | scfForm.prepend('<input type="hidden" name="token" value="' + token + '">'); |
| [808](#L808) | scfForm.prepend('<input type="hidden" name="action" value="contact">'); |
| [809](#L809) | scfForm.unbind('submit').submit(); |
| [810](#L810) | }); |
| [811](#L811) | }); |
| [812](#L812) |  |
| [813](#L813) | }); |
| [814](#L814) | }); |
| [815](#L815) | </script> |
| [816](#L816) | </div> |
| [817](#L817) | <?php |
| [818](#L818) | $scf\_recaptcha = ob\_get\_contents(); |
| [819](#L819) | ob\_end\_clean(); |
| [820](#L820) | } |
| [821](#L821) | } |
| [822](#L822) | // |
| [823](#L823) |  |
| [824](#L824) | $scf\_custom\_fields = apply\_filters( 'scf\_custom\_fields', '' ); |
| [825](#L825) | if ( empty( $scf\_custom\_fields ) ) { |
| [826](#L826) | $scf\_custom\_fields = ''; |
| [827](#L827) | } |
| [828](#L828) |  |
| [829](#L829) | $scf\_confirm\_email = ''; |
| [830](#L830) | if ( ! empty( $scf\_options['scf\_input\_confirm\_email'] ) && ! empty( $scf\_options['scf\_confirm\_mailtext'] ) ) { |
| [831](#L831) | $scf\_confirm\_email = ' |
| [832](#L832) | <div class="scf-row scf-confirm-email"> |
| [833](#L833) | <label for="scf\_confirm\_email">'. $scf\_options['scf\_confirm\_mailtext'] .'</label> |
| [834](#L834) | ' . $scf\_strings['confirm\_email'] . ' |
| [835](#L835) | </div>'; |
| [836](#L836) | } |
| [837](#L837) |  |
| [838](#L838) | $scf\_form = '<div id="simple-contact-form-wrap">' . do\_shortcode( $preform ) . $error . ' |
| [839](#L839) | <div id="simple-contact-form" class="scf"> |
| [840](#L840) | <form action="#simple-contact-form-wrap" method="post"> |
| [841](#L841) | <div class="scf-row scf-name"> |
| [842](#L842) | <label for="scf\_name">'. $nametext .'</label> |
| [843](#L843) | '. $scf\_strings['name'] .' |
| [844](#L844) | </div> |
| [845](#L845) | <div class="scf-row scf-email"> |
| [846](#L846) | <label for="scf\_email">'. $mailtext .'</label> |
| [847](#L847) | '. $scf\_strings['email'] .' |
| [848](#L848) | </div>'; |
| [849](#L849) |  |
| [850](#L850) | $scf\_form .= $scf\_confirm\_email; |
| [851](#L851) | $scf\_form .= $scf\_subject; |
| [852](#L852) | $scf\_form .= $scf\_custom\_fields; |
| [853](#L853) | $scf\_form .= $scf\_captcha; |
| [854](#L854) | $scf\_form .= $scf\_honeypot; |
| [855](#L855) | $scf\_form .= $scf\_message; |
| [856](#L856) | $scf\_form .= $scf\_recaptcha; |
| [857](#L857) | $scf\_form .= do\_shortcode( $before\_button ); |
| [858](#L858) |  |
| [859](#L859) | if ( $gdpr\_position == 'before\_submit' ) { |
| [860](#L860) | $scf\_form .= scf\_confirm\_checkbox(); |
| [861](#L861) | } |
| [862](#L862) |  |
| [863](#L863) | $scf\_form .= '<div class="scf-submit"> |
| [864](#L864) | <input type="submit" id="scf-button" value="'. $submittext .'"> |
| [865](#L865) | <input type="hidden" id="scf-key" name="scf-key" value="process"> |
| [866](#L866) | '. wp\_nonce\_field('scf-nonce', 'scf-nonce', false, false) .' |
| [867](#L867) | </div>'; |
| [868](#L868) |  |
| [869](#L869) | if ( $gdpr\_position == 'after\_submit' ) { |
| [870](#L870) | $scf\_form .= scf\_confirm\_checkbox(); |
| [871](#L871) | } |
| [872](#L872) |  |
| [873](#L873) | $scf\_form .= '</form> |
| [874](#L874) | </div> |
| [875](#L875) | '. $styles . do\_shortcode( $appform ) . '</div>'; |
| [876](#L876) |  |
| [877](#L877) | return apply\_filters('scf\_filter\_contact\_form', $scf\_form); |
| [878](#L878) |  |
| [879](#L879) | } |
| [880](#L880) |  |
| [881](#L881) |  |
| [882](#L882) |  |
| [883](#L883) | function scf\_default\_styles() { |
| [884](#L884) |  |
| [885](#L885) | return '#simple-contact-form form { max-width: 700px; padding: 5px; } |
| [886](#L886) | #simple-contact-form .scf-row { width: 100%; overflow: hidden; margin: 5px 0; padding: 5px 0; border: 0; } |
| [887](#L887) | #simple-contact-form .scf-row input { box-sizing: border-box; float: left; clear: none; width: 75%; margin: 0; } |
| [888](#L888) | #simple-contact-form .scf-row label { box-sizing: border-box; float: left; clear: both; width: 25%; margin-top: 5px; font-size: 90%; } |
| [889](#L889) | #simple-contact-form .scf-row textarea { box-sizing: border-box; float: left; clear: both; width: 100%; margin-top: 2px; } |
| [890](#L890) | #scf\_success pre { white-space: pre-wrap; } |
| [891](#L891) | p.scf\_error, p.scf\_spam { color: #cc0000; } |
| [892](#L892) | div.scf-submit { margin-top: 10px; } |
| [893](#L893) | p.scf\_success { color: #669966; } |
| [894](#L894) | .scf-confirm-checkbox { margin-top: 15px; } |
| [895](#L895) | .scf-website3dhhsy3 { display: none; }'; |
| [896](#L896) |  |
| [897](#L897) | } |
| [898](#L898) |  |
| [899](#L899) |  |
| [900](#L900) |  |
| [901](#L901) | function scf\_plugin\_action\_links($links, $file) { |
| [902](#L902) |  |
| [903](#L903) | global $scf\_path; |
| [904](#L904) |  |
| [905](#L905) | if ($file == $scf\_path) { |
| [906](#L906) |  |
| [907](#L907) | $scf\_links = '<a href="'. get\_admin\_url() .'options-general.php?page='. $scf\_path .'">'. esc\_html\_\_('Settings', 'scf') .'</a>'; |
| [908](#L908) |  |
| [909](#L909) | array\_unshift($links, $scf\_links); |
| [910](#L910) |  |
| [911](#L911) | } |
| [912](#L912) |  |
| [913](#L913) | return $links; |
| [914](#L914) |  |
| [915](#L915) | } |
| [916](#L916) | add\_filter ('plugin\_action\_links', 'scf\_plugin\_action\_links', 10, 2); |
| [917](#L917) |  |
| [918](#L918) |  |
| [919](#L919) |  |
| [920](#L920) | function add\_scf\_links($links, $file) { |
| [921](#L921) |  |
| [922](#L922) | if ($file == plugin\_basename(\_\_FILE\_\_)) { |
| [923](#L923) |  |
| [924](#L924) | $href  = 'https://wordpress.org/support/plugin/simple-basic-contact-form/reviews/?rate=5#new-post'; |
| [925](#L925) | $title = esc\_html\_\_('Give us a 5-star rating at WordPress.org', 'scf'); |
| [926](#L926) | $text  = esc\_html\_\_('Rate this plugin', 'scf') .'&nbsp;&raquo;'; |
| [927](#L927) |  |
| [928](#L928) | $links[] = '<a target="\_blank" href="'. $href .'" title="'. $title .'">'. $text .'</a>'; |
| [929](#L929) |  |
| [930](#L930) | } |
| [931](#L931) |  |
| [932](#L932) | return $links; |
| [933](#L933) |  |
| [934](#L934) | } |
| [935](#L935) | add\_filter('plugin\_row\_meta', 'add\_scf\_links', 10, 2); |
| [936](#L936) |  |
| [937](#L937) |  |
| [938](#L938) |  |
| [939](#L939) | function scf\_init() { |
| [940](#L940) |  |
| [941](#L941) | register\_setting('scf\_plugin\_options', 'scf\_options', 'scf\_validate\_options'); |
| [942](#L942) |  |
| [943](#L943) | } |
| [944](#L944) | add\_action ('admin\_init', 'scf\_init'); |
| [945](#L945) |  |
| [946](#L946) |  |
| [947](#L947) |  |
| [948](#L948) | function scf\_delete\_plugin\_options() { |
| [949](#L949) |  |
| [950](#L950) | delete\_option('scf\_options'); |
| [951](#L951) |  |
| [952](#L952) | } |
| [953](#L953) | if ($scf\_options['default\_options'] == 1) { |
| [954](#L954) |  |
| [955](#L955) | register\_uninstall\_hook (\_\_FILE\_\_, 'scf\_delete\_plugin\_options'); |
| [956](#L956) |  |
| [957](#L957) | } |
| [958](#L958) |  |
| [959](#L959) |  |
| [960](#L960) |  |
| [961](#L961) | function scf\_add\_defaults() { |
| [962](#L962) |  |
| [963](#L963) | $user\_info = get\_userdata(1); |
| [964](#L964) |  |
| [965](#L965) | $admin\_name = $user\_info->user\_login; |
| [966](#L966) |  |
| [967](#L967) | if (!$admin\_name) $admin\_name = 'Awesome Person'; |
| [968](#L968) |  |
| [969](#L969) | $site\_title = get\_bloginfo('name'); |
| [970](#L970) | $admin\_mail = get\_bloginfo('admin\_email'); |
| [971](#L971) | $tmp        = get\_option('scf\_options'); |
| [972](#L972) |  |
| [973](#L973) | if ( ! is\_array( $tmp ) || $tmp['default\_options'] == '1' ) { |
| [974](#L974) |  |
| [975](#L975) | $arr = array( |
| [976](#L976) |  |
| [977](#L977) | 'default\_options'     => 0, |
| [978](#L978) |  |
| [979](#L979) | // General |
| [980](#L980) | 'scf\_name'            => $admin\_name, |
| [981](#L981) | 'scf\_email'           => $admin\_mail, |
| [982](#L982) | 'scf\_from'            => $admin\_mail, |
| [983](#L983) | 'scf\_website'         => $site\_title, |
| [984](#L984) | 'scf\_subject'         => esc\_html\_\_('Message sent from your contact form.', 'scf'), |
| [985](#L985) | 'scf\_enable\_message'  => 1, |
| [986](#L986) | 'scf\_carbon'          => 1, |
| [987](#L987) | 'scf\_success\_details' => 1, |
| [988](#L988) | 'scf\_gdpr\_message'    => \_\_('I consent to having this website store my submitted information so they can respond to my inquiry. See our privacy policy to learn more how we use data.', 'scf'), |
| [989](#L989) | 'scf\_gdpr\_position'   => 'after\_submit', |
| [990](#L990) | 'scf\_mail\_function'   => 0, |
| [991](#L991) |  |
| [992](#L992) | // Captcha |
| [993](#L993) | 'scf\_honeypot'        => 0, |
| [994](#L994) | 'scf\_captcha'         => 1, |
| [995](#L995) | 'scf\_question'        => esc\_html\_\_('1 + 1 =', 'scf'), |
| [996](#L996) | 'scf\_response'        => esc\_attr\_\_('2', 'scf'), |
| [997](#L997) | 'scf\_casing'          => 0, |
| [998](#L998) | 'scf\_recaptcha'       => 0, |
| [999](#L999) | 'scf\_recaptcha\_site\_key' => '', |
| [1000](#L1000) | 'scf\_recaptcha\_secret\_key' => '', |
| [1001](#L1001) |  |
| [1002](#L1002) | // Styles |
| [1003](#L1003) | 'scf\_css'             => scf\_default\_styles(), |
| [1004](#L1004) |  |
| [1005](#L1005) | // Labels |
| [1006](#L1006) | 'scf\_nametext'        => esc\_html\_\_('Your Name', 'scf'), |
| [1007](#L1007) | 'scf\_input\_name'      => esc\_attr\_\_('Your Name', 'scf'), |
| [1008](#L1008) | 'scf\_mailtext'        => esc\_html\_\_('Your Email', 'scf'), |
| [1009](#L1009) | 'scf\_confirm\_mailtext'=> esc\_html\_\_('Confirm Your Email', 'scf'), |
| [1010](#L1010) | 'scf\_input\_email'     => esc\_attr\_\_('Your Email', 'scf'), |
| [1011](#L1011) | 'scf\_input\_confirm\_email' => esc\_attr\_\_('Confirm Your Email', 'scf'), |
| [1012](#L1012) | 'scf\_subjtext'        => esc\_html\_\_('Email Subject', 'scf'), |
| [1013](#L1013) | 'scf\_input\_subject'   => esc\_attr\_\_('Email Subject', 'scf'), |
| [1014](#L1014) | 'scf\_messtext'        => esc\_html\_\_('Your Message', 'scf'), |
| [1015](#L1015) | 'scf\_submittext'      => esc\_attr\_\_('Send email', 'scf'), |
| [1016](#L1016) | 'scf\_input\_message'   => esc\_attr\_\_('Your Message', 'scf'), |
| [1017](#L1017) | 'scf\_input\_captcha'   => esc\_attr\_\_('Correct Response', 'scf'), |
| [1018](#L1018) |  |
| [1019](#L1019) | // Errors |
| [1020](#L1020) | 'scf\_success'         => '<p class="scf\_success"><strong>'. esc\_html\_\_('Success!', 'scf') .'</strong> '. esc\_html\_\_('Your message has been sent.', 'scf') .'</p>', |
| [1021](#L1021) | 'scf\_error'           => '<p class="scf\_error">'. esc\_html\_\_('Please complete the required fields.', 'scf') .'</p>', |
| [1022](#L1022) | 'scf\_style'           => 'style="border: 2px solid #cc0000;"', |
| [1023](#L1023) | 'scf\_spam'            => '<p class="scf\_spam">'. esc\_html\_\_('Incorrect response for challenge question. Please try again.', 'scf') .'</p>', |
| [1024](#L1024) |  |
| [1025](#L1025) | // Custom |
| [1026](#L1026) | 'scf\_preform'         => '', |
| [1027](#L1027) | 'scf\_appform'         => '<div style="clear:both;">&nbsp;</div>', |
| [1028](#L1028) | 'scf\_prepend'         => '', |
| [1029](#L1029) | 'scf\_append'          => '', |
| [1030](#L1030) | 'scf\_before\_button'   => '', |
| [1031](#L1031) |  |
| [1032](#L1032) | // blacklist |
| [1033](#L1033) | 'scf\_blacklist'       => '', |
| [1034](#L1034) |  |
| [1035](#L1035) | ); |
| [1036](#L1036) |  |
| [1037](#L1037) | update\_option('scf\_options', $arr); |
| [1038](#L1038) |  |
| [1039](#L1039) | } |
| [1040](#L1040) |  |
| [1041](#L1041) | } |
| [1042](#L1042) | register\_activation\_hook(\_\_FILE\_\_, 'scf\_add\_defaults'); |
| [1043](#L1043) |  |
| [1044](#L1044) |  |
| [1045](#L1045) |  |
| [1046](#L1046) | function scf\_validate\_options($input) { |
| [1047](#L1047) |  |
| [1048](#L1048) | if (!isset($input['default\_options'])) $input['default\_options'] = null; |
| [1049](#L1049) | $input['default\_options'] = ($input['default\_options'] == 1 ? 1 : 0); |
| [1050](#L1050) |  |
| [1051](#L1051) | // General |
| [1052](#L1052) | $input['scf\_name']     = esc\_attr($input['scf\_name']); |
| [1053](#L1053) | $input['scf\_email']    = esc\_attr($input['scf\_email']); |
| [1054](#L1054) | $input['scf\_website']  = esc\_attr($input['scf\_website']); |
| [1055](#L1055) | $input['scf\_subject']  = esc\_attr($input['scf\_subject']); |
| [1056](#L1056) |  |
| [1057](#L1057) | if (!isset($input['scf\_enable\_message'])) $input['scf\_enable\_message'] = null; |
| [1058](#L1058) | $input['scf\_enable\_message'] = ($input['scf\_enable\_message'] == 1 ? 1 : 0); |
| [1059](#L1059) |  |
| [1060](#L1060) | if (!isset($input['scf\_carbon'])) $input['scf\_carbon'] = null; |
| [1061](#L1061) | $input['scf\_carbon'] = ($input['scf\_carbon'] == 1 ? 1 : 0); |
| [1062](#L1062) |  |
| [1063](#L1063) | if (!isset($input['scf\_success\_details'])) $input['scf\_success\_details'] = null; |
| [1064](#L1064) | $input['scf\_success\_details'] = ($input['scf\_success\_details'] == 1 ? 1 : 0); |
| [1065](#L1065) |  |
| [1066](#L1066) | if (!isset($input['scf\_mail\_function'])) $input['scf\_mail\_function'] = null; |
| [1067](#L1067) | $input['scf\_mail\_function'] = ($input['scf\_mail\_function'] == 1 ? 1 : 0); |
| [1068](#L1068) |  |
| [1069](#L1069) | // Captcha |
| [1070](#L1070) | if (!isset($input['scf\_captcha'])) $input['scf\_captcha'] = null; |
| [1071](#L1071) | $input['scf\_captcha'] = ($input['scf\_captcha'] == 1 ? 1 : 0); |
| [1072](#L1072) |  |
| [1073](#L1073) | // Honepot |
| [1074](#L1074) | if (!isset($input['scf\_honeypot'])) $input['scf\_honeypot'] = null; |
| [1075](#L1075) | $input['scf\_honeypot'] = ($input['scf\_honeypot'] == 1 ? 1 : 0); |
| [1076](#L1076) |  |
| [1077](#L1077) | $input['scf\_question'] = esc\_attr($input['scf\_question']); |
| [1078](#L1078) | $input['scf\_response'] = esc\_attr($input['scf\_response']); |
| [1079](#L1079) |  |
| [1080](#L1080) | // recaptcha |
| [1081](#L1081) | if (!isset($input['scf\_recaptcha'])) $input['scf\_recaptcha'] = null; |
| [1082](#L1082) | $input['scf\_recaptcha'] = ($input['scf\_recaptcha'] == 1 ? 1 : 0); |
| [1083](#L1083) | $input['scf\_recaptcha\_version'] = esc\_attr($input['scf\_recaptcha\_version']); |
| [1084](#L1084) | $input['scf\_recaptcha\_site\_key'] = esc\_attr($input['scf\_recaptcha\_site\_key']); |
| [1085](#L1085) | $input['scf\_recaptcha\_secret\_key'] = esc\_attr($input['scf\_recaptcha\_secret\_key']); |
| [1086](#L1086) |  |
| [1087](#L1087) | if (!isset($input['scf\_casing'])) $input['scf\_casing'] = null; |
| [1088](#L1088) | $input['scf\_casing'] = ($input['scf\_casing'] == 1 ? 1 : 0); |
| [1089](#L1089) |  |
| [1090](#L1090) | // Styles |
| [1091](#L1091) | $input['scf\_css'] = sanitize\_text\_field($input['scf\_css']); |
| [1092](#L1092) |  |
| [1093](#L1093) | // Labels |
| [1094](#L1094) | $input['scf\_nametext']      = esc\_attr($input['scf\_nametext']); |
| [1095](#L1095) | $input['scf\_input\_name']    = esc\_attr($input['scf\_input\_name']); |
| [1096](#L1096) | $input['scf\_mailtext']      = esc\_attr($input['scf\_mailtext']); |
| [1097](#L1097) | $input['scf\_confirm\_mailtext'] = esc\_attr($input['scf\_confirm\_mailtext']); |
| [1098](#L1098) | $input['scf\_input\_email']   = esc\_attr($input['scf\_input\_email']); |
| [1099](#L1099) | $input['scf\_input\_confirm\_email'] = esc\_attr($input['scf\_input\_confirm\_email']); |
| [1100](#L1100) | $input['scf\_subjtext']      = esc\_attr($input['scf\_subjtext']); |
| [1101](#L1101) | $input['scf\_input\_subject'] = esc\_attr($input['scf\_input\_subject']); |
| [1102](#L1102) | $input['scf\_messtext']      = esc\_attr($input['scf\_messtext']); |
| [1103](#L1103) | $input['scf\_submittext']    = esc\_attr($input['scf\_submittext']); |
| [1104](#L1104) | $input['scf\_input\_message'] = esc\_attr($input['scf\_input\_message']); |
| [1105](#L1105) | $input['scf\_input\_captcha'] = esc\_attr($input['scf\_input\_captcha']); |
| [1106](#L1106) |  |
| [1107](#L1107) | // Errors |
| [1108](#L1108) | $input['scf\_success'] = wp\_kses\_post($input['scf\_success']); |
| [1109](#L1109) | $input['scf\_error']   = wp\_kses\_post($input['scf\_error']); |
| [1110](#L1110) | $input['scf\_style']   = wp\_kses\_post($input['scf\_style']); |
| [1111](#L1111) | $input['scf\_spam']    = wp\_kses\_post($input['scf\_spam']); |
| [1112](#L1112) |  |
| [1113](#L1113) | // Custom |
| [1114](#L1114) | $input['scf\_preform'] = wp\_kses\_post($input['scf\_preform']); |
| [1115](#L1115) | $input['scf\_appform'] = wp\_kses\_post($input['scf\_appform']); |
| [1116](#L1116) | $input['scf\_prepend'] = wp\_kses\_post($input['scf\_prepend']); |
| [1117](#L1117) | $input['scf\_append']  = wp\_kses\_post($input['scf\_append']); |
| [1118](#L1118) | $input['scf\_before\_button']  = wp\_kses\_post($input['scf\_before\_button']); |
| [1119](#L1119) |  |
| [1120](#L1120) | // blacklist |
| [1121](#L1121) | $input['scf\_blacklist']  = wp\_kses\_post($input['scf\_blacklist']); |
| [1122](#L1122) |  |
| [1123](#L1123) | return $input; |
| [1124](#L1124) |  |
| [1125](#L1125) | } |
| [1126](#L1126) |  |
| [1127](#L1127) |  |
| [1128](#L1128) |  |
| [1129](#L1129) | function scf\_add\_options\_page() { |
| [1130](#L1130) |  |
| [1131](#L1131) | global $scf\_plugin; |
| [1132](#L1132) |  |
| [1133](#L1133) | add\_options\_page($scf\_plugin, esc\_html\_\_('Contact Form', 'scf'), 'manage\_options', \_\_FILE\_\_, 'scf\_render\_form'); |
| [1134](#L1134) |  |
| [1135](#L1135) | } |
| [1136](#L1136) | add\_action ('admin\_menu', 'scf\_add\_options\_page'); |
| [1137](#L1137) |  |
| [1138](#L1138) |  |
| [1139](#L1139) |  |
| [1140](#L1140) | function scf\_render\_form() { |
| [1141](#L1141) |  |
| [1142](#L1142) | global $scf\_plugin, $scf\_options, $scf\_path, $scf\_homeurl, $scf\_version; ?> |
| [1143](#L1143) |  |
| [1144](#L1144) | <?php |
| [1145](#L1145) | if ( ! isset( $scf\_options['scf\_gdpr\_message'] ) ) { |
| [1146](#L1146) | $scf\_options['scf\_gdpr\_message'] = \_\_('I consent to having this website store my submitted information so they can respond to my inquiry. See our privacy policy to learn more how we use data.', 'scf'); |
| [1147](#L1147) | } |
| [1148](#L1148) |  |
| [1149](#L1149) | if ( ! isset( $scf\_options['scf\_gdpr\_position'] ) ) { |
| [1150](#L1150) | $scf\_options['scf\_gdpr\_position'] = 'after\_submit'; |
| [1151](#L1151) | } |
| [1152](#L1152) |  |
| [1153](#L1153) | if ( ! isset( $scf\_options['scf\_submittext'] ) ) { |
| [1154](#L1154) | $scf\_options['scf\_submittext'] = esc\_attr\_\_('Send email', 'scf'); |
| [1155](#L1155) | } |
| [1156](#L1156) |  |
| [1157](#L1157) | if ( ! isset( $scf\_options['scf\_include\_additional\_information'] ) ) { |
| [1158](#L1158) | $scf\_options['scf\_include\_additional\_information'] = false; |
| [1159](#L1159) | } |
| [1160](#L1160) |  |
| [1161](#L1161) | if ( ! isset( $scf\_options['scf\_before\_button'] ) ) { |
| [1162](#L1162) | $scf\_options['scf\_before\_button'] = ''; |
| [1163](#L1163) | } |
| [1164](#L1164) |  |
| [1165](#L1165) | if ( ! isset( $scf\_options['scf\_blacklist'] ) ) { |
| [1166](#L1166) | $scf\_options['scf\_blacklist'] = ''; |
| [1167](#L1167) | } |
| [1168](#L1168) |  |
| [1169](#L1169) | if ( ! isset( $scf\_options['scf\_recaptcha\_version'] ) ) { |
| [1170](#L1170) | $scf\_options['scf\_recaptcha\_version'] = 'v2'; |
| [1171](#L1171) | } |
| [1172](#L1172) |  |
| [1173](#L1173) | if ( ! isset( $scf\_options['scf\_recaptcha\_site\_key'] ) ) { |
| [1174](#L1174) | $scf\_options['scf\_recaptcha\_site\_key'] = false; |
| [1175](#L1175) | } |
| [1176](#L1176) |  |
| [1177](#L1177) | if ( ! isset( $scf\_options['scf\_recaptcha\_secret\_key'] ) ) { |
| [1178](#L1178) | $scf\_options['scf\_recaptcha\_secret\_key'] = false; |
| [1179](#L1179) | } |
| [1180](#L1180) |  |
| [1181](#L1181) | ?> |
| [1182](#L1182) |  |
| [1183](#L1183) | <style type="text/css"> |
| [1184](#L1184) | .mm-panel-overview { |
| [1185](#L1185) | padding: 0 15px 15px 150px; |
| [1186](#L1186) | background-image: url(<?php echo plugins\_url('/simple-basic-contact-form/sbcf-icon.png'); ?>); |
| [1187](#L1187) | background-repeat: no-repeat; background-position: 15px 0; background-size: 130px 130px; |
| [1188](#L1188) | } |
| [1189](#L1189) | #mm-plugin-options h1 small { line-height: 12px; font-size: 12px; color: #bbb; } |
| [1190](#L1190) | #mm-plugin-options h2 { margin: 0; padding: 12px 15px; font-size: 16px; cursor: pointer; } |
| [1191](#L1191) | #mm-plugin-options h3 { margin: 20px 15px; font-size: 14px; } |
| [1192](#L1192) | #mm-plugin-options p { margin: 15px; } |
| [1193](#L1193) | #mm-plugin-options ul { margin: 15px 15px 20px 40px; } |
| [1194](#L1194) | #mm-plugin-options li { margin: 8px 0; list-style-type: disc; } |
| [1195](#L1195) | #mm-plugin-options textarea { width: 90%; } |
| [1196](#L1196) | #mm-plugin-options .button-primary { margin: 0 0 15px 15px; } |
| [1197](#L1197) |  |
| [1198](#L1198) | .mm-table-wrap { margin: 15px; } |
| [1199](#L1199) | .mm-table-wrap table { padding: 10px 0; } |
| [1200](#L1200) | .mm-table-wrap td, .mm-table-wrap th { padding: 10px 15px; vertical-align: middle; } |
| [1201](#L1201) | .mm-item-caption { font-size: 12px; color: #777; } |
| [1202](#L1202) | span.mm-item-caption { display: inline-block; vertical-align: middle; } |
| [1203](#L1203) | .mm-item-caption code { margin: 0; padding: 3px 3px 2px 3px; font-size: 12px; } |
| [1204](#L1204) | .mm-code { padding: 6px 5px 5px 5px; background-color: #fafae0; color: #333; font-size: 14px; } |
| [1205](#L1205) |  |
| [1206](#L1206) | #setting-error-settings\_updated { margin: 8px 0 15px 0; } |
| [1207](#L1207) | #setting-error-settings\_updated p { margin: 7px 0; } |
| [1208](#L1208) |  |
| [1209](#L1209) | #mm-panel-toggle { margin: 5px 0; } |
| [1210](#L1210) | #mm-credit-info { margin: -5px 0 0 2px; } |
| [1211](#L1211) |  |
| [1212](#L1212) | </style> |
| [1213](#L1213) |  |
| [1214](#L1214) | <div id="mm-plugin-options" class="wrap"> |
| [1215](#L1215) |  |
| [1216](#L1216) | <h1><?php echo esc\_html( $scf\_plugin ); ?> <small><?php echo 'v'. esc\_html( $scf\_version ); ?></small></h1> |
| [1217](#L1217) | <div id="mm-panel-toggle"><a href="<?php get\_admin\_url() .'options-general.php?page='. $scf\_path; ?>"><?php esc\_html\_e('Toggle all panels', 'scf'); ?></a></div> |
| [1218](#L1218) |  |
| [1219](#L1219) | <form method="post" action="options.php"> |
| [1220](#L1220) | <?php settings\_fields('scf\_plugin\_options'); ?> |
| [1221](#L1221) |  |
| [1222](#L1222) | <div class="metabox-holder"> |
| [1223](#L1223) | <div class="meta-box-sortables ui-sortable"> |
| [1224](#L1224) |  |
| [1225](#L1225) | <div id="mm-panel-overview" class="postbox"> |
| [1226](#L1226) | <h2><?php esc\_html\_e('Overview', 'scf'); ?></h2> |
| [1227](#L1227) | <div class="toggle<?php if (isset($\_GET["settings-updated"])) { echo ' default-hidden'; } ?>"> |
| [1228](#L1228) | <div class="mm-panel-overview"> |
| [1229](#L1229) | <p> |
| [1230](#L1230) | <strong><?php echo esc\_html( $scf\_plugin ); ?></strong> <?php esc\_html\_e('is a secure contact form that&rsquo;s fast and flexible.', 'scf'); ?> |
| [1231](#L1231) | <?php esc\_html\_e('To display the form on any WP Post or Page, add the shortcode:', 'scf'); ?>  <code>[simple\_contact\_form]</code>. |
| [1232](#L1232) | </p> |
| [1233](#L1233) | <ul> |
| [1234](#L1234) | <li><a id="mm-panel-primary-link" href="#mm-panel-primary"><?php esc\_html\_e('Plugin Settings', 'scf'); ?></a></li> |
| [1235](#L1235) | <li><a id="mm-panel-secondary-link" href="#mm-panel-secondary"><?php esc\_html\_e('Shortcode &amp; Template Tag', 'scf'); ?></a></li> |
| [1236](#L1236) | <li><a target="\_blank" href="https://wordpress.org/plugins/simple-basic-contact-form/"><?php esc\_html\_e('Plugin Homepage', 'scf'); ?>&nbsp;&raquo;</a></li> |
| [1237](#L1237) | </ul> |
| [1238](#L1238) | <p> |
| [1239](#L1239) | <?php esc\_html\_e('If you like this plugin, please', 'scf'); ?> |
| [1240](#L1240) | <a target="\_blank" href="https://wordpress.org/support/plugin/simple-basic-contact-form/reviews/?rate=5#new-post" title="<?php esc\_attr\_e('THANK YOU for your support!', 'scf'); ?>"><?php esc\_html\_e('give it a 5-star rating', 'scf'); ?>&nbsp;&raquo;</a> |
| [1241](#L1241) | </p> |
| [1242](#L1242) | </div> |
| [1243](#L1243) | </div> |
| [1244](#L1244) | </div> |
| [1245](#L1245) |  |
| [1246](#L1246) | <div id="mm-panel-primary" class="postbox"> |
| [1247](#L1247) | <h2><?php esc\_html\_e('Plugin Options', 'scf'); ?></h2> |
| [1248](#L1248) | <div class="toggle<?php if (!isset($\_GET["settings-updated"])) { echo ' default-hidden'; } ?>"> |
| [1249](#L1249) | <p><?php esc\_html\_e('Configure and customize the contact form.', 'scf'); ?></p> |
| [1250](#L1250) |  |
| [1251](#L1251) | <h3><?php esc\_html\_e('General Options', 'scf'); ?></h3> |
| [1252](#L1252) | <div class="mm-table-wrap"> |
| [1253](#L1253) | <table class="widefat mm-table"> |
| [1254](#L1254) | <tr> |
| [1255](#L1255) | <th scope="row"><label class="description" for="scf\_options[scf\_name]"><?php esc\_html\_e('Your Name', 'scf'); ?></label></th> |
| [1256](#L1256) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_name]" value="<?php echo esc\_attr( $scf\_options['scf\_name'] ); ?>" /> |
| [1257](#L1257) | <div class="mm-item-caption"><?php esc\_html\_e('Name of person that will receive messages', 'scf'); ?></div></td> |
| [1258](#L1258) | </tr> |
| [1259](#L1259) | <tr> |
| [1260](#L1260) | <th scope="row"><label class="description" for="scf\_options[scf\_email]"><?php esc\_html\_e('Your Email', 'scf'); ?></label></th> |
| [1261](#L1261) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_email]" value="<?php echo esc\_attr( $scf\_options['scf\_email'] ); ?>" /> |
| [1262](#L1262) | <div class="mm-item-caption"><?php esc\_html\_e('Email of person that will receive messages', 'scf'); ?></div></td> |
| [1263](#L1263) | </tr> |
| [1264](#L1264) | <tr> |
| [1265](#L1265) | <th scope="row"><label class="description" for="scf\_options[scf\_from]"><?php esc\_html\_e('From Address', 'scf'); ?></label></th> |
| [1266](#L1266) | <td><input type="text" size="50" maxlength="200" name="scf\_options[scf\_from]" value="<?php echo esc\_attr( $scf\_options['scf\_from'] ); ?>" /> |
| [1267](#L1267) | <div class="mm-item-caption"><?php esc\_html\_e('Here you may customize the address used for the &ldquo;From&rdquo; header (see plugin FAQs for info)', 'scf'); ?></div></td> |
| [1268](#L1268) | </tr> |
| [1269](#L1269) | <tr> |
| [1270](#L1270) | <th scope="row"><label class="description" for="scf\_options[scf\_website]"><?php esc\_html\_e('Your Website', 'scf'); ?></label></th> |
| [1271](#L1271) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_website]" value="<?php echo esc\_attr( $scf\_options['scf\_website'] ); ?>" /> |
| [1272](#L1272) | <div class="mm-item-caption"><?php esc\_html\_e('The name of your website', 'scf'); ?></div></td> |
| [1273](#L1273) | </tr> |
| [1274](#L1274) | <tr> |
| [1275](#L1275) | <th scope="row"><label class="description" for="scf\_options[scf\_subject]"><?php esc\_html\_e('Default Subject', 'scf'); ?></label></th> |
| [1276](#L1276) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_subject]" value="<?php echo esc\_attr( $scf\_options['scf\_subject'] ); ?>" /> |
| [1277](#L1277) | <div class="mm-item-caption"><?php esc\_html\_e('Default subject (or leave blank to display the subject field). {name} will be dynamically replaced by the value of the name field.', 'scf'); ?></div></td> |
| [1278](#L1278) | </tr> |
| [1279](#L1279) | <tr> |
| [1280](#L1280) | <th scope="row"><label class="description" for="scf\_options[scf\_gdpr\_message]"><?php esc\_html\_e('GDPR Message', 'scf'); ?></label></th> |
| [1281](#L1281) | <td> |
| [1282](#L1282) | <textarea class="large-text code" rows="3" cols="50" name="scf\_options[scf\_gdpr\_message]"><?php echo esc\_textarea($scf\_options['scf\_gdpr\_message']); ?></textarea> |
| [1283](#L1283) | <div class="mm-item-caption"><?php esc\_html\_e('GDPR message ( or leave blank not to display it )', 'scf'); ?></div></td> |
| [1284](#L1284) | </tr> |
| [1285](#L1285) | <tr> |
| [1286](#L1286) | <th scope="row"><label class="description" for="scf\_options[scf\_gdpr\_position]"><?php esc\_html\_e('GDPR Message - Position', 'scf'); ?></label></th> |
| [1287](#L1287) | <td> |
| [1288](#L1288) | <select name="scf\_options[scf\_gdpr\_position]"> |
| [1289](#L1289) | <option value="before\_submit" <?php selected( 'before\_submit', sanitize\_text\_field( $scf\_options['scf\_gdpr\_position'] ), true ); ?>><?php esc\_html\_e('Before Submit Button', 'scf'); ?></option> |
| [1290](#L1290) | <option value="after\_submit" <?php selected( 'after\_submit', sanitize\_text\_field( $scf\_options['scf\_gdpr\_position'] ), true ); ?>><?php esc\_html\_e('After Submit Button', 'scf'); ?></option> |
| [1291](#L1291) | </select> |
| [1292](#L1292) | <div class="mm-item-caption"><?php esc\_html\_e('The location/position of the GDPR message.', 'scf'); ?></div></td> |
| [1293](#L1293) | </tr> |
| [1294](#L1294) | <tr> |
| [1295](#L1295) | <th scope="row"><label class="description" for="scf\_options[scf\_enable\_message]"><?php esc\_html\_e('Show Message Field', 'scf'); ?></label></th> |
| [1296](#L1296) | <td><input type="checkbox" name="scf\_options[scf\_enable\_message]" value="1" <?php if (isset($scf\_options['scf\_enable\_message'])) { checked('1', $scf\_options['scf\_enable\_message']); } ?> /> |
| [1297](#L1297) | <span class="mm-item-caption"><?php esc\_html\_e('Enable/display the message field', 'scf'); ?></span></td> |
| [1298](#L1298) | </tr> |
| [1299](#L1299) | <tr> |
| [1300](#L1300) | <th scope="row"><label class="description" for="scf\_options[scf\_carbon]"><?php esc\_html\_e('Enable Carbon Copies', 'scf'); ?></label></th> |
| [1301](#L1301) | <td><input type="checkbox" name="scf\_options[scf\_carbon]" value="1" <?php if (isset($scf\_options['scf\_carbon'])) { checked('1', $scf\_options['scf\_carbon']); } ?> /> |
| [1302](#L1302) | <span class="mm-item-caption"><?php esc\_html\_e('Send a carbon copy to the sender', 'scf'); ?></span></td> |
| [1303](#L1303) | </tr> |
| [1304](#L1304) | <tr> |
| [1305](#L1305) | <th scope="row"><label class="description" for="scf\_options[scf\_success\_details]"><?php esc\_html\_e('Success Message', 'scf'); ?></label></th> |
| [1306](#L1306) | <td><input type="checkbox" name="scf\_options[scf\_success\_details]" value="1" <?php if (isset($scf\_options['scf\_success\_details'])) { checked('1', $scf\_options['scf\_success\_details']); } ?> /> |
| [1307](#L1307) | <span class="mm-item-caption"><?php esc\_html\_e('Display verbose success message', 'scf'); ?></span></td> |
| [1308](#L1308) | </tr> |
| [1309](#L1309) | <tr> |
| [1310](#L1310) | <th scope="row"><label class="description" for="scf\_options[scf\_mail\_function]"><?php esc\_html\_e('Mail Function', 'scf'); ?></label></th> |
| [1311](#L1311) | <td><input type="checkbox" name="scf\_options[scf\_mail\_function]" value="1" <?php if (isset($scf\_options['scf\_mail\_function'])) { checked('1', $scf\_options['scf\_mail\_function']); } ?> /> |
| [1312](#L1312) | <span class="mm-item-caption"><?php esc\_html\_e('Use PHP&rsquo;s', 'scf'); ?> <code>mail()</code> <?php esc\_html\_e('instead of WP&rsquo;s', 'scf'); ?> <code>wp\_mail()</code></span></td> |
| [1313](#L1313) | </tr> |
| [1314](#L1314) | <tr> |
| [1315](#L1315) | <th scope="row"><label class="description" for="scf\_options[scf\_include\_additional\_information]"><?php esc\_html\_e('Additional Information', 'scf'); ?></label></th> |
| [1316](#L1316) | <td><input type="checkbox" name="scf\_options[scf\_include\_additional\_information]" value="1" <?php if (isset($scf\_options['scf\_include\_additional\_information'])) { checked('1', $scf\_options['scf\_include\_additional\_information']); } ?> /> |
| [1317](#L1317) | <span class="mm-item-caption"><?php esc\_html\_e('Includes additional information in the email such as IP, browser...', 'scf' ); ?></span></td> |
| [1318](#L1318) | </tr> |
| [1319](#L1319) | </table> |
| [1320](#L1320) | </div> |
| [1321](#L1321) |  |
| [1322](#L1322) | <h3><?php esc\_html\_e('Antispam', 'scf'); ?></h3> |
| [1323](#L1323) | <div class="mm-table-wrap"> |
| [1324](#L1324) | <table class="widefat mm-table"> |
| [1325](#L1325) | <tr> |
| [1326](#L1326) | <th scope="row"><label class="description" for="scf\_options[scf\_honeypot]"><?php esc\_html\_e('Enable Honeypot', 'scf'); ?></label></th> |
| [1327](#L1327) | <td><input type="checkbox" name="scf\_options[scf\_honeypot]" value="1" <?php if (isset($scf\_options['scf\_honeypot'])) { checked('1', $scf\_options['scf\_honeypot']); } ?> /> |
| [1328](#L1328) | <span class="mm-item-caption"><?php esc\_html\_e('Enable Honeypot', 'scf'); ?></span></td> |
| [1329](#L1329) | </tr> |
| [1330](#L1330) | <tr> |
| [1331](#L1331) | <th scope="row"><label class="description" for="scf\_options[scf\_captcha]"><?php esc\_html\_e('Enable Challenge Question', 'scf'); ?></label></th> |
| [1332](#L1332) | <td><input type="checkbox" name="scf\_options[scf\_captcha]" value="1" <?php if (isset($scf\_options['scf\_captcha'])) { checked('1', $scf\_options['scf\_captcha']); } ?> /> |
| [1333](#L1333) | <span class="mm-item-caption"><?php esc\_html\_e('Enable the Challenge Question', 'scf'); ?></span></td> |
| [1334](#L1334) | </tr> |
| [1335](#L1335) | <tr> |
| [1336](#L1336) | <th scope="row"><label class="description" for="scf\_options[scf\_question]"><?php esc\_html\_e('Challenge Question', 'scf'); ?></label></th> |
| [1337](#L1337) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_question]" value="<?php echo esc\_attr( $scf\_options['scf\_question'] ); ?>" /> |
| [1338](#L1338) | <div class="mm-item-caption"><?php esc\_html\_e('Question that must be answered correctly', 'scf'); ?></div></td> |
| [1339](#L1339) | </tr> |
| [1340](#L1340) | <tr> |
| [1341](#L1341) | <th scope="row"><label class="description" for="scf\_options[scf\_response]"><?php esc\_html\_e('Challenge Response', 'scf'); ?></label></th> |
| [1342](#L1342) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_response]" value="<?php echo esc\_attr( $scf\_options['scf\_response'] ); ?>" /> |
| [1343](#L1343) | <div class="mm-item-caption"><?php esc\_html\_e('The \*only\* correct answer to the challenge question', 'scf'); ?></div></td> |
| [1344](#L1344) | </tr> |
| [1345](#L1345) | <tr> |
| [1346](#L1346) | <th scope="row"><label class="description" for="scf\_options[scf\_casing]"><?php esc\_html\_e('Case Sensitivity', 'scf'); ?></label></th> |
| [1347](#L1347) | <td><input type="checkbox" name="scf\_options[scf\_casing]" value="1" <?php if (isset($scf\_options['scf\_casing'])) { checked('1', $scf\_options['scf\_casing']); } ?> /> |
| [1348](#L1348) | <span class="mm-item-caption"><?php esc\_html\_e('The challenge response should be case-sensitive', 'scf'); ?></span></td> |
| [1349](#L1349) | </tr> |
| [1350](#L1350) | <tr> |
| [1351](#L1351) | <th scope="row"><label class="description" for="scf\_options[scf\_blacklist]"><?php esc\_html\_e('Blacklisted Words', 'scf'); ?></label></th> |
| [1352](#L1352) | <td><textarea class="large-text code" rows="3" cols="55" name="scf\_options[scf\_blacklist]"><?php echo esc\_textarea($scf\_options['scf\_blacklist']); ?></textarea> |
| [1353](#L1353) | <div class="mm-item-caption"><?php esc\_html\_e('If message contains a word/term on the list it will show the succesfully sent message but it will actually NOT be sent. Separate words or terms with a comma. Example: casino, some term, pills', 'scf'); ?></div></td> |
| [1354](#L1354) | </tr> |
| [1355](#L1355) | <!-- reCAPTCHA start --> |
| [1356](#L1356) | <tr> |
| [1357](#L1357) | <th scope="row"><label class="description" for="scf\_options[scf\_recaptcha]"><?php esc\_html\_e('Enable reCAPTCHA', 'scf'); ?></label></th> |
| [1358](#L1358) | <td><input type="checkbox" name="scf\_options[scf\_recaptcha]" value="1" <?php if (isset($scf\_options['scf\_recaptcha'])) { checked('1', $scf\_options['scf\_recaptcha']); } ?> /> |
| [1359](#L1359) | <span class="mm-item-caption"><?php esc\_html\_e('Enable reCAPTCHA', 'scf'); ?></span></td> |
| [1360](#L1360) | </tr> |
| [1361](#L1361) | <tr> |
| [1362](#L1362) | <th scope="row"><label class="description" for="scf\_options[scf\_recaptcha\_version]"><?php esc\_html\_e('reCAPTCHA Version', 'scf'); ?></label></th> |
| [1363](#L1363) | <td> |
| [1364](#L1364) | <select name="scf\_options[scf\_recaptcha\_version]"> |
| [1365](#L1365) | <option value="v2" <?php selected( 'v2', sanitize\_text\_field( $scf\_options['scf\_recaptcha\_version'] ), true ); ?>><?php esc\_html\_e('V2', 'scf'); ?></option> |
| [1366](#L1366) | <option value="v3" <?php selected( 'v3', sanitize\_text\_field( $scf\_options['scf\_recaptcha\_version'] ), true ); ?>><?php esc\_html\_e('V3', 'scf'); ?></option> |
| [1367](#L1367) | </select> |
| [1368](#L1368) | <div class="mm-item-caption"><?php esc\_html\_e('reCAPTCHA version', 'scf'); ?></div></td> |
| [1369](#L1369) | </tr> |
| [1370](#L1370) | <tr> |
| [1371](#L1371) | <th scope="row"><label class="description" for="scf\_options[scf\_recaptcha\_site\_key]"><?php esc\_html\_e('reCAPTCHA site key', 'scf'); ?></label></th> |
| [1372](#L1372) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_recaptcha\_site\_key]" value="<?php echo esc\_attr( $scf\_options['scf\_recaptcha\_site\_key'] ); ?>" /> |
| [1373](#L1373) | <div class="mm-item-caption"><?php esc\_html\_e('reCAPTCHA site key', 'scf'); ?></div></td> |
| [1374](#L1374) | </tr> |
| [1375](#L1375) | <tr> |
| [1376](#L1376) | <th scope="row"><label class="description" for="scf\_options[scf\_recaptcha\_secret\_key]"><?php esc\_html\_e('reCAPTCHA secret key', 'scf'); ?></label></th> |
| [1377](#L1377) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_recaptcha\_secret\_key]" value="<?php echo esc\_attr( $scf\_options['scf\_recaptcha\_secret\_key'] ); ?>" /> |
| [1378](#L1378) | <div class="mm-item-caption"><?php esc\_html\_e('reCAPTCHA secret key', 'scf'); ?></div></td> |
| [1379](#L1379) | </tr> |
| [1380](#L1380) | <!-- reCAPTCHA end --> |
| [1381](#L1381) | </table> |
| [1382](#L1382) | </div> |
| [1383](#L1383) |  |
| [1384](#L1384) | <h3><?php esc\_html\_e('Field Labels &amp; Placeholders', 'scf'); ?></h3> |
| [1385](#L1385) | <div class="mm-table-wrap"> |
| [1386](#L1386) | <table class="widefat mm-table"> |
| [1387](#L1387) | <tr> |
| [1388](#L1388) | <th scope="row"><label class="description" for="scf\_options[scf\_nametext]"><?php esc\_html\_e('Name Label', 'scf'); ?></label></th> |
| [1389](#L1389) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_nametext]" value="<?php echo esc\_attr( $scf\_options['scf\_nametext'] ); ?>" /> |
| [1390](#L1390) | <div class="mm-item-caption"><?php esc\_html\_e('Label for the Name field', 'scf'); ?></div></td> |
| [1391](#L1391) | </tr> |
| [1392](#L1392) | <tr> |
| [1393](#L1393) | <th scope="row"><label class="description" for="scf\_options[scf\_input\_name]"><?php esc\_html\_e('Name Placeholder', 'scf'); ?></label></th> |
| [1394](#L1394) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_input\_name]" value="<?php echo esc\_attr( $scf\_options['scf\_input\_name'] ); ?>" /> |
| [1395](#L1395) | <div class="mm-item-caption"><?php esc\_html\_e('Placeholder for the Name field', 'scf'); ?></div></td> |
| [1396](#L1396) | </tr> |
| [1397](#L1397) |  |
| [1398](#L1398) | <tr> |
| [1399](#L1399) | <th scope="row"><label class="description" for="scf\_options[scf\_mailtext]"><?php esc\_html\_e('Email Label', 'scf'); ?></label></th> |
| [1400](#L1400) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_mailtext]" value="<?php echo esc\_attr( $scf\_options['scf\_mailtext'] ); ?>" /> |
| [1401](#L1401) | <div class="mm-item-caption"><?php esc\_html\_e('Label for the Email field', 'scf'); ?></div></td> |
| [1402](#L1402) | </tr> |
| [1403](#L1403) | <tr> |
| [1404](#L1404) | <th scope="row"><label class="description" for="scf\_options[scf\_input\_email]"><?php esc\_html\_e('Email Placeholder', 'scf'); ?></label></th> |
| [1405](#L1405) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_input\_email]" value="<?php echo esc\_attr( $scf\_options['scf\_input\_email'] ); ?>" /> |
| [1406](#L1406) | <div class="mm-item-caption"><?php esc\_html\_e('Placeholder for the Email field', 'scf'); ?></div></td> |
| [1407](#L1407) | </tr> |
| [1408](#L1408) |  |
| [1409](#L1409) | <tr> |
| [1410](#L1410) | <th scope="row"><label class="description" for="scf\_options[scf\_confirm\_mailtext]"><?php esc\_html\_e('Confirm Email Label', 'scf'); ?></label></th> |
| [1411](#L1411) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_confirm\_mailtext]" value="<?php echo esc\_attr( $scf\_options['scf\_confirm\_mailtext'] ); ?>" /> |
| [1412](#L1412) | <div class="mm-item-caption"><?php esc\_html\_e('Label for the Confirm Email field. Leave empty to not display the field.', 'scf'); ?></div></td> |
| [1413](#L1413) | </tr> |
| [1414](#L1414) | <tr> |
| [1415](#L1415) | <th scope="row"><label class="description" for="scf\_options[scf\_input\_confirm\_email]"><?php esc\_html\_e('Confirm Email Placeholder', 'scf'); ?></label></th> |
| [1416](#L1416) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_input\_confirm\_email]" value="<?php echo esc\_attr( $scf\_options['scf\_input\_confirm\_email'] ); ?>" /> |
| [1417](#L1417) | <div class="mm-item-caption"><?php esc\_html\_e('Placeholder for the Confirm Email field. Leave empty to not display the field.', 'scf'); ?></div></td> |
| [1418](#L1418) | </tr> |
| [1419](#L1419) |  |
| [1420](#L1420) | <tr> |
| [1421](#L1421) | <th scope="row"><label class="description" for="scf\_options[scf\_subjtext]"><?php esc\_html\_e('Subject Label', 'scf'); ?></label></th> |
| [1422](#L1422) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_subjtext]" value="<?php echo esc\_attr( $scf\_options['scf\_subjtext'] ); ?>" /> |
| [1423](#L1423) | <div class="mm-item-caption"><?php esc\_html\_e('Label for the Subject field', 'scf'); ?></div></td> |
| [1424](#L1424) | </tr> |
| [1425](#L1425) | <tr> |
| [1426](#L1426) | <th scope="row"><label class="description" for="scf\_options[scf\_input\_subject]"><?php esc\_html\_e('Subject Placeholder', 'scf'); ?></label></th> |
| [1427](#L1427) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_input\_subject]" value="<?php echo esc\_attr( $scf\_options['scf\_input\_subject'] ); ?>" /> |
| [1428](#L1428) | <div class="mm-item-caption"><?php esc\_html\_e('Placeholder for the Subject field', 'scf'); ?></div></td> |
| [1429](#L1429) | </tr> |
| [1430](#L1430) |  |
| [1431](#L1431) | <tr> |
| [1432](#L1432) | <th scope="row"><label class="description" for="scf\_options[scf\_messtext]"><?php esc\_html\_e('Message Label', 'scf'); ?></label></th> |
| [1433](#L1433) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_messtext]" value="<?php echo esc\_attr( $scf\_options['scf\_messtext'] ); ?>" /> |
| [1434](#L1434) | <div class="mm-item-caption"><?php esc\_html\_e('Label for the Message field', 'scf'); ?></div></td> |
| [1435](#L1435) | </tr> |
| [1436](#L1436) | <tr> |
| [1437](#L1437) | <th scope="row"><label class="description" for="scf\_options[scf\_submittext]"><?php esc\_html\_e('Submit Label', 'scf'); ?></label></th> |
| [1438](#L1438) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_submittext]" value="<?php echo esc\_attr( $scf\_options['scf\_submittext'] ); ?>" /> |
| [1439](#L1439) | <div class="mm-item-caption"><?php esc\_html\_e('Label for the submit button', 'scf'); ?></div></td> |
| [1440](#L1440) | </tr> |
| [1441](#L1441) | <tr> |
| [1442](#L1442) | <th scope="row"><label class="description" for="scf\_options[scf\_input\_message]"><?php esc\_html\_e('Message Placeholder', 'scf'); ?></label></th> |
| [1443](#L1443) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_input\_message]" value="<?php echo esc\_attr( $scf\_options['scf\_input\_message'] ); ?>" /> |
| [1444](#L1444) | <div class="mm-item-caption"><?php esc\_html\_e('Placeholder for the Message field', 'scf'); ?></div></td> |
| [1445](#L1445) | </tr> |
| [1446](#L1446) |  |
| [1447](#L1447) | <tr> |
| [1448](#L1448) | <th scope="row"><label class="description" for="scf\_options[scf\_input\_captcha]"><?php esc\_html\_e('Captcha Placeholder', 'scf'); ?></label></th> |
| [1449](#L1449) | <td><input type="text" class="regular-text" size="50" maxlength="200" name="scf\_options[scf\_input\_captcha]" value="<?php echo esc\_attr( $scf\_options['scf\_input\_captcha'] ); ?>" /> |
| [1450](#L1450) | <div class="mm-item-caption"><?php esc\_html\_e('Placeholder for the Captcha field', 'scf'); ?></div></td> |
| [1451](#L1451) | </tr> |
| [1452](#L1452) | </table> |
| [1453](#L1453) | </div> |
| [1454](#L1454) |  |
| [1455](#L1455) | <h3><?php esc\_html\_e('Appearance', 'scf'); ?></h3> |
| [1456](#L1456) | <div class="mm-table-wrap"> |
| [1457](#L1457) | <table class="widefat mm-table"> |
| [1458](#L1458) | <tr> |
| [1459](#L1459) | <th scope="row"><label class="description" for="scf\_options[scf\_css]"><?php esc\_html\_e('Custom CSS', 'scf'); ?></label></th> |
| [1460](#L1460) | <td> |
| [1461](#L1461) | <textarea class="large-text code" rows="8" cols="50" name="scf\_options[scf\_css]"><?php echo esc\_textarea($scf\_options['scf\_css']); ?></textarea> |
| [1462](#L1462) | <div class="mm-item-caption"> |
| [1463](#L1463) | <?php esc\_html\_e('Optional CSS to style the contact form. Do not include any', 'scf'); ?> <code>&lt;style&gt;</code> <?php esc\_html\_e('tags.', 'scf'); ?> |
| [1464](#L1464) | </div> |
| [1465](#L1465) | </td> |
| [1466](#L1466) | </tr> |
| [1467](#L1467) | </table> |
| [1468](#L1468) | </div> |
| [1469](#L1469) |  |
| [1470](#L1470) | <h3><?php esc\_html\_e('Success &amp; Error Messages', 'scf'); ?></h3> |
| [1471](#L1471) | <div class="mm-table-wrap"> |
| [1472](#L1472) | <table class="widefat mm-table"> |
| [1473](#L1473) | <tr> |
| [1474](#L1474) | <th scope="row"><label class="description" for="scf\_options[scf\_success]"><?php esc\_html\_e('Success Message', 'scf'); ?></label></th> |
| [1475](#L1475) | <td><textarea class="large-text code" rows="3" cols="55" name="scf\_options[scf\_success]"><?php echo esc\_textarea($scf\_options['scf\_success']); ?></textarea> |
| [1476](#L1476) | <div class="mm-item-caption"><?php esc\_html\_e('Message displayed when the form is submitted successfully', 'scf'); ?></div></td> |
| [1477](#L1477) | </tr> |
| [1478](#L1478) | <tr> |
| [1479](#L1479) | <th scope="row"><label class="description" for="scf\_options[scf\_error]"><?php esc\_html\_e('Error Message', 'scf'); ?></label></th> |
| [1480](#L1480) | <td><textarea class="large-text code" rows="3" cols="55" name="scf\_options[scf\_error]"><?php echo esc\_textarea($scf\_options['scf\_error']); ?></textarea> |
| [1481](#L1481) | <div class="mm-item-caption"><?php esc\_html\_e('Message displayed when a required field is empty', 'scf'); ?></div></td> |
| [1482](#L1482) | </tr> |
| [1483](#L1483) | <tr> |
| [1484](#L1484) | <th scope="row"><label class="description" for="scf\_options[scf\_spam]"><?php esc\_html\_e('Incorrect Response', 'scf'); ?></label></th> |
| [1485](#L1485) | <td><textarea class="large-text code" rows="3" cols="55" name="scf\_options[scf\_spam]"><?php echo esc\_textarea($scf\_options['scf\_spam']); ?></textarea> |
| [1486](#L1486) | <div class="mm-item-caption"><?php esc\_html\_e('Message displayed when the challenge question is answered incorrectly', 'scf'); ?></div></td> |
| [1487](#L1487) | </tr> |
| [1488](#L1488) | <tr> |
| [1489](#L1489) | <th scope="row"><label class="description" for="scf\_options[scf\_style]"><?php esc\_html\_e('Error Field Attributes', 'scf'); ?></label></th> |
| [1490](#L1490) | <td><textarea class="large-text code" rows="3" cols="55" name="scf\_options[scf\_style]"><?php echo esc\_textarea($scf\_options['scf\_style']); ?></textarea> |
| [1491](#L1491) | <div class="mm-item-caption"><?php esc\_html\_e('Optional custom attributes for any field that returns an error', 'scf'); ?></div></td> |
| [1492](#L1492) | </tr> |
| [1493](#L1493) | </table> |
| [1494](#L1494) | </div> |
| [1495](#L1495) |  |
| [1496](#L1496) | <h3><?php esc\_html\_e('Custom Content', 'scf'); ?></h3> |
| [1497](#L1497) | <div class="mm-table-wrap"> |
| [1498](#L1498) | <table class="widefat mm-table"> |
| [1499](#L1499) | <tr> |
| [1500](#L1500) | <th scope="row"><label class="description" for="scf\_options[scf\_preform]"><?php esc\_html\_e('Before Form', 'scf'); ?></label></th> |
| [1501](#L1501) | <td><textarea class="large-text code" rows="3" cols="55" name="scf\_options[scf\_preform]"><?php echo esc\_textarea($scf\_options['scf\_preform']); ?></textarea> |
| [1502](#L1502) | <div class="mm-item-caption"><?php esc\_html\_e('Optional markup to appear \*before\* the contact form', 'scf'); ?></div></td> |
| [1503](#L1503) | </tr> |
| [1504](#L1504) | <tr> |
| [1505](#L1505) | <th scope="row"><label class="description" for="scf\_options[scf\_appform]"><?php esc\_html\_e('After Form', 'scf'); ?></label></th> |
| [1506](#L1506) | <td><textarea class="large-text code" rows="3" cols="55" name="scf\_options[scf\_appform]"><?php echo esc\_textarea($scf\_options['scf\_appform']); ?></textarea> |
| [1507](#L1507) | <div class="mm-item-caption"><?php esc\_html\_e('Optional markup to appear \*after\* the contact form', 'scf'); ?></div></td> |
| [1508](#L1508) | </tr> |
| [1509](#L1509) | <tr> |
| [1510](#L1510) | <th scope="row"><label class="description" for="scf\_options[scf\_prepend]"><?php esc\_html\_e('Before Results', 'scf'); ?></label></th> |
| [1511](#L1511) | <td><textarea class="large-text code" rows="3" cols="55" name="scf\_options[scf\_prepend]"><?php echo esc\_textarea($scf\_options['scf\_prepend']); ?></textarea> |
| [1512](#L1512) | <div class="mm-item-caption"><?php esc\_html\_e('Optional markup to appear \*before\* the success message', 'scf'); ?></div></td> |
| [1513](#L1513) | </tr> |
| [1514](#L1514) | <tr> |
| [1515](#L1515) | <th scope="row"><label class="description" for="scf\_options[scf\_append]"><?php esc\_html\_e('After Results', 'scf'); ?></label></th> |
| [1516](#L1516) | <td><textarea class="large-text code" rows="3" cols="55" name="scf\_options[scf\_append]"><?php echo esc\_textarea($scf\_options['scf\_append']); ?></textarea> |
| [1517](#L1517) | <div class="mm-item-caption"><?php esc\_html\_e('Optional markup to appear \*after\* the success message', 'scf'); ?></div></td> |
| [1518](#L1518) | </tr> |
| [1519](#L1519) | <tr> |
| [1520](#L1520) | <th scope="row"><label class="description" for="scf\_options[scf\_before\_button]"><?php esc\_html\_e('Before Submit Button', 'scf'); ?></label></th> |
| [1521](#L1521) | <td><textarea class="large-text code" rows="3" cols="55" name="scf\_options[scf\_before\_button]"><?php echo esc\_textarea($scf\_options['scf\_before\_button']); ?></textarea> |
| [1522](#L1522) | <div class="mm-item-caption"><?php esc\_html\_e('Optional markup to appear \*before\* the submit button', 'scf'); ?></div></td> |
| [1523](#L1523) | </tr> |
| [1524](#L1524) | </table> |
| [1525](#L1525) | </div> |
| [1526](#L1526) |  |
| [1527](#L1527) | <input type="submit" class="button-primary" value="<?php esc\_attr\_e('Save Settings', 'scf'); ?>" /> |
| [1528](#L1528) | </div> |
| [1529](#L1529) | </div> |
| [1530](#L1530) |  |
| [1531](#L1531) | <div id="mm-restore-settings" class="postbox"> |
| [1532](#L1532) | <h2><?php esc\_html\_e('Restore Defaults', 'scf'); ?></h2> |
| [1533](#L1533) | <div class="toggle<?php if (!isset($\_GET["settings-updated"])) { echo ' default-hidden'; } ?>"> |
| [1534](#L1534) | <p> |
| [1535](#L1535) | <input name="scf\_options[default\_options]" type="checkbox" value="1" id="mm\_restore\_defaults" <?php if (isset($scf\_options['default\_options'])) { checked('1', $scf\_options['default\_options']); } ?> /> |
| [1536](#L1536) | <label class="description" for="scf\_options[default\_options]"><?php esc\_html\_e('Restore default options upon plugin deactivation/reactivation.', 'scf'); ?></label> |
| [1537](#L1537) | </p> |
| [1538](#L1538) | <p> |
| [1539](#L1539) | <small> |
| [1540](#L1540) | <strong><?php esc\_html\_e('Tip:', 'scf'); ?></strong> |
| [1541](#L1541) | <?php esc\_html\_e('leave this option unchecked to remember your settings.', 'scf'); ?> |
| [1542](#L1542) | <?php esc\_html\_e('Or, to go ahead and restore all default options, check the box, save your settings, and then deactivate/reactivate the plugin.', 'scf'); ?> |
| [1543](#L1543) | </small> |
| [1544](#L1544) | </p> |
| [1545](#L1545) | <input type="submit" class="button-primary" value="<?php esc\_attr\_e('Save Settings', 'scf'); ?>" /> |
| [1546](#L1546) | </div> |
| [1547](#L1547) | </div> |
| [1548](#L1548) |  |
| [1549](#L1549) | <div id="mm-panel-secondary" class="postbox"> |
| [1550](#L1550) | <h2><?php esc\_html\_e('Shortcode &amp; Template Tag', 'scf'); ?></h2> |
| [1551](#L1551) | <div class="toggle default-hidden"> |
| [1552](#L1552) |  |
| [1553](#L1553) | <h3><?php esc\_html\_e('Shortcode', 'scf'); ?></h3> |
| [1554](#L1554) | <p><?php esc\_html\_e('Use this shortcode to display the contact form on any WP Post or Page:', 'scf'); ?></p> |
| [1555](#L1555) | <p><code class="mm-code">[simple\_contact\_form]</code></p> |
| [1556](#L1556) |  |
| [1557](#L1557) | <h3><?php esc\_html\_e('Template tag', 'scf'); ?></h3> |
| [1558](#L1558) | <p><?php esc\_html\_e('Use this template tag to display the form anywhere in your theme template:', 'scf'); ?></p> |
| [1559](#L1559) | <p><code class="mm-code">&lt;?php if (function\_exists('simple\_contact\_form')) simple\_contact\_form(); ?&gt;</code></p> |
| [1560](#L1560) |  |
| [1561](#L1561) | </div> |
| [1562](#L1562) | </div> |
| [1563](#L1563) |  |
| [1564](#L1564) | </div> |
| [1565](#L1565) | </div> |
| [1566](#L1566) |  |
| [1567](#L1567) | <div id="mm-credit-info"> |
| [1568](#L1568) | <a target="\_blank" href="<?php echo esc\_url( $scf\_homeurl ); ?>" title="<?php esc\_attr\_e('Plugin Homepage', 'scf'); ?>"><?php echo esc\_html( $scf\_plugin ); ?></a> <?php esc\_html\_e('by', 'scf'); ?> |
| [1569](#L1569) | <a target="\_blank" href="https://twitter.com/wpkube" title="<?php esc\_attr\_e('WPKube on Twitter', 'scf'); ?>">WPKube</a> @ |
| [1570](#L1570) | <a target="\_blank" href="https://www.wpkube.com/" title="<?php esc\_attr\_e('WPKube', 'scf'); ?>">WPKube</a> |
| [1571](#L1571) | </div> |
| [1572](#L1572) |  |
| [1573](#L1573) | </form> |
| [1574](#L1574) | </div> |
| [1575](#L1575) |  |
| [1576](#L1576) | <script type="text/javascript"> |
| [1577](#L1577) | jQuery(document).ready(function(){ |
| [1578](#L1578) | // toggle panels |
| [1579](#L1579) | jQuery('.default-hidden').hide(); |
| [1580](#L1580) | jQuery('#mm-panel-toggle a').click(function(){ |
| [1581](#L1581) | jQuery('.toggle').slideToggle(300); |
| [1582](#L1582) | return false; |
| [1583](#L1583) | }); |
| [1584](#L1584) | jQuery('h2').click(function(){ |
| [1585](#L1585) | jQuery(this).next().slideToggle(300); |
| [1586](#L1586) | }); |
| [1587](#L1587) | jQuery('#mm-panel-primary-link').click(function(){ |
| [1588](#L1588) | jQuery('.toggle').hide(); |
| [1589](#L1589) | jQuery('#mm-panel-primary .toggle').slideToggle(300); |
| [1590](#L1590) | return true; |
| [1591](#L1591) | }); |
| [1592](#L1592) | jQuery('#mm-panel-secondary-link').click(function(){ |
| [1593](#L1593) | jQuery('.toggle').hide(); |
| [1594](#L1594) | jQuery('#mm-panel-secondary .toggle').slideToggle(300); |
| [1595](#L1595) | return true; |
| [1596](#L1596) | }); |
| [1597](#L1597) | jQuery('#mm-restore-settings-link').click(function(){ |
| [1598](#L1598) | jQuery('.toggle').hide(); |
| [1599](#L1599) | jQuery('#mm-restore-settings .toggle').slideToggle(300); |
| [1600](#L1600) | return true; |
| [1601](#L1601) | }); |
| [1602](#L1602) | // prevent accidents |
| [1603](#L1603) | if(!jQuery("#mm\_restore\_defaults").is(":checked")){ |
| [1604](#L1604) | jQuery('#mm\_restore\_defaults').click(function(event){ |
| [1605](#L1605) | var r = confirm("<?php esc\_html\_e('Are you sure you want to restore all default options? (this action cannot be undone)', 'scf'); ?>"); |
| [1606](#L1606) | if (r == true){ |
| [1607](#L1607) | jQuery("#mm\_restore\_defaults").attr('checked', true); |
| [1608](#L1608) | } else { |
| [1609](#L1609) | jQuery("#mm\_restore\_defaults").attr('checked', false); |
| [1610](#L1610) | } |
| [1611](#L1611) | }); |
| [1612](#L1612) | } |
| [1613](#L1613) | }); |
| [1614](#L1614) | </script> |
| [1615](#L1615) |  |
| [1616](#L1616) | <?php } |
| [1617](#L1617) |  |
| [1618](#L1618) | function scf\_confirm\_checkbox() { |
| [1619](#L1619) |  |
| [1620](#L1620) | global $scf\_options; |
| [1621](#L1621) |  |
| [1622](#L1622) | if ( ! isset ( $scf\_options['scf\_gdpr\_message'] ) ) { |
| [1623](#L1623) | $scf\_options['scf\_gdpr\_message'] = \_\_('I consent to having this website store my submitted information so they can respond to my inquiry. See our privacy policy to learn more how we use data.', 'scf'); |
| [1624](#L1624) | } |
| [1625](#L1625) |  |
| [1626](#L1626) | if ( empty( $scf\_options['scf\_gdpr\_message'] ) ) { |
| [1627](#L1627) | return ''; |
| [1628](#L1628) | } |
| [1629](#L1629) |  |
| [1630](#L1630) | ob\_start(); |
| [1631](#L1631) | ?> |
| [1632](#L1632) | <div class="scf-confirm-checkbox"> |
| [1633](#L1633) | <label><input type="checkbox" required> <?php echo wp\_kses\_post( $scf\_options['scf\_gdpr\_message'] ); ?></label> |
| [1634](#L1634) | </div><!-- .scf-confirm-checkbox --> |
| [1635](#L1635) | <?php |
| [1636](#L1636) | $output = ob\_get\_contents(); |
| [1637](#L1637) | ob\_end\_clean(); |
| [1638](#L1638) |  |
| [1639](#L1639) | return $output; |
| [1640](#L1640) |  |
| [1641](#L1641) | } add\_action( 'scf\_before\_form\_close', 'scf\_confirm\_checkbox' ); |
| [1642](#L1642) |  |
| [1643](#L1643) | function scf\_get\_field\_value( $name ) { |
| [1644](#L1644) |  |
| [1645](#L1645) | $message = isset($\_POST[$name]) ? sanitize\_text\_field( stripslashes(trim($\_POST[$name]))) : ''; |
| [1646](#L1646) | return $message; |
| [1647](#L1647) |  |
| [1648](#L1648) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/simple-basic-contact-form/trunk/simple-basic-contact-form.php?format=txt)
* [Original Format](/export/3220660/simple-basic-contact-form/trunk/simple-basic-contact-form.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_6ed258c3_20250111_104759.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3085036)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3085035 "Changeset 3085035")
* [Next Changeset](/changeset/3085037 "Changeset 3085037") →

---

# Changeset 3085036

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
05/11/2024 07:35:30 PM
([8 months](/timeline?from=2024-05-11T19%3A35%3A30Z&precision=second "See timeline at 05/11/2024 07:35:30 PM") ago)

Author:
wpkube
Message:

trunk 20240511

Location:
[simple-basic-contact-form/trunk](/browser/simple-basic-contact-form/trunk?rev=3085036)
Files:

2 edited

* [readme.txt](/browser/simple-basic-contact-form/trunk/readme.txt?rev=3085036 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [simple-basic-contact-form.php](/browser/simple-basic-contact-form/trunk/simple-basic-contact-form.php?rev=3085036 "Show entry in browser")
  (modified)
  ([3 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [simple-basic-contact-form/trunk/readme.txt](/changeset/3085036/simple-basic-contact-form/trunk/readme.txt "Show the changeset 3085036 restricted to simple-basic-contact-form/trunk/readme.txt")

  | [r3080546](/browser/simple-basic-contact-form/trunk/readme.txt?rev=3080546#L145 "Show revision 3080546 of this file in browser") | [r3085036](/browser/simple-basic-contact-form/trunk/readme.txt?rev=3085036#L145 "Show revision 3085036 of this file in browser") |  |
  | --- | --- | --- |
  | 145 | 145 |  |
  | 146 | 146 | == Changelog == |
  |  | 147 |  |
  |  | 148 | \*\*20240511\*\* |
  |  | 149 |  |
  |  | 150 | \* Fixed security issues |
  | 147 | 151 |  |
  | 148 | 152 | \*\*20240502\*\* |
* ## [simple-basic-contact-form/trunk/simple-basic-contact-form.php](/changeset/3085036/simple-basic-contact-form/trunk/simple-basic-contact-form.php "Show the changeset 3085036 restricted to simple-basic-contact-form/trunk/simple-basic-contact-form.php")

  | [r3080542](/browser/simple-basic-contact-form/trunk/simple-basic-contact-form.php?rev=3080542#L10 "Show revision 3080542 of this file in browser") | [r3085036](/browser/simple-basic-contact-form/trunk/simple-basic-contact-form.php?rev=3085036#L10 "Show revision 3085036 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | Requires at least: 4.1 |
  | 11 | 11 | Tested up to: 6.5 |
  | 12 |  | Version: 202405~~02~~ |
  |  | 12 | Version: 20240511 |
  | 13 | 13 | Requires PHP: 5.2 |
  | 14 | 14 | Text Domain: scf |
  | […](/browser/simple-basic-contact-form/trunk/simple-basic-contact-form.php?rev=3080542#L39) | […](/browser/simple-basic-contact-form/trunk/simple-basic-contact-form.php?rev=3085036#L39) |  |
  | 39 | 39 |  |
  | 40 | 40 | $scf\_wp\_vers = '4.1'; |
  | 41 |  | $scf\_version = '202405~~02~~'; |
  |  | 41 | $scf\_version = '20240511'; |
  | 42 | 42 | $scf\_plugin  = esc\_html\_\_('Simple Basic Contact Form', 'scf'); |
  | 43 | 43 | $scf\_options = get\_option('scf\_options'); |
  | […](/browser/simple-basic-contact-form/trunk/simple-basic-contact-form.php?rev=3080542#L541) | […](/browser/simple-basic-contact-form/trunk/simple-basic-contact-form.php?rev=3085036#L541) |  |
  | 541 | 541 |  |
  | 542 | 542 | $topic   = (isset($\_POST['scf\_subject']) && !empty($\_POST['scf\_subject'])) ? sanitize\_text\_field( stripslashes(strip\_tags(trim($\_POST['scf\_subject'])))) : $subject; |
  |  | 543 | $topic = strip\_shortcodes( $topic ); |
  | 543 | 544 | $topic = str\_replace( '[simple\_contact\_form\_date]', current\_time( get\_option( 'date\_format' ) ), $topic ); |
  | 544 | 545 |  |
  | 545 | 546 | $name    = isset($\_POST['scf\_name']) ? sanitize\_text\_field( stripslashes(strip\_tags(trim($\_POST['scf\_name']))) ) : ''; |
  |  | 547 | $name = strip\_shortcodes( $name ); |
  | 546 | 548 | $topic = str\_replace( '{name}', $name, $topic ); |
  | 547 | 549 |  |
  | 548 | 550 | $message = isset($\_POST['scf\_message']) ? sanitize\_text\_field( stripslashes(trim($\_POST['scf\_message'])) ) : ''; |
  |  | 551 | $message = strip\_shortcodes( $message ); |
  | 549 | 552 |  |
  | 550 | 553 | $email   = isset($\_POST['scf\_email']) ? sanitize\_text\_field($\_POST['scf\_email']) : ''; |
  |  | 554 | $email = strip\_shortcodes( $email ); |
  | 551 | 555 |  |
  | 552 | 556 | $agent   = isset($\_SERVER['HTTP\_USER\_AGENT']) ? sanitize\_text\_field($\_SERVER['HTTP\_USER\_AGENT']) : esc\_html\_\_('[ undefined ]', 'scf'); |
  |  | 557 | $agent = sanitize\_text\_field( $agent ); |
  | 553 | 558 |  |
  | 554 | 559 | $form    = isset($\_SERVER['HTTP\_REFERER']) ? sanitize\_text\_field($\_SERVER['HTTP\_REFERER']) : esc\_html\_\_('[ undefined ]', 'scf'); |
  |  | 560 | $form = sanitize\_text\_field( $form ); |
  | 555 | 561 |  |
  | 556 | 562 | $host    = isset($\_SERVER['REMOTE\_ADDR']) ? sanitize\_text\_field(gethostbyaddr($\_SERVER['REMOTE\_ADDR'])) : esc\_html\_\_('[ undefined ]', 'scf'); |
  |  | 563 | $host = sanitize\_text\_field( $host ); |
  | 557 | 564 |  |
  | 558 | 565 | $from    = !empty($recipfrom) ? $recipfrom : $email; |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3085036)
* [Zip Archive](?format=zip&new=3085036)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_be04ab81_20250111_104801.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Simple Basic Contact Form <= 20240502 - Unauthenticated Arbitrary Shortcode Execution

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Simple Basic Contact Form <= 20240502 - Unauthenticated Arbitrary Shortcode Execution

6.5

**Improper Control of Generation of Code ('Code Injection')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L)

| CVE | [CVE-2024-4144](https://www.cve.org/CVERecord?id=CVE-2024-4144) |
| --- | --- |
| CVSS | 6.5 (Medium) |
| Publicly Published | May 13, 2024 |
| Last Updated | May 14, 2024 |
| Researcher | [stealthcopter](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/stealthcopter) |

### Description

The Simple Basic Contact Form plugin for WordPress for WordPress is vulnerable to arbitrary shortcode execution in all versions up to, and including, 20240502. This allows unauthenticated attackers to execute arbitrary shortcodes. The severity and exploitability depends on the functionality of other plugins installed in the environment.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/simple-basic-contact-form/trunk/simple-basic-contact-form.php#L543)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3085036/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fsimple-basic-contact-form%2Fsimple-basic-contact-form-20240502-unauthenticated-arbitrary-shortcode-execution&t=Simple%20Basic%20Contact%20Form%20%3C%3D%2020240502%20-%20Unauthenticated%20Arbitrary%20Shortcode%20Execution "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fsimple-basic-contact-form%2Fsimple-basic-contact-form-20240502-unauthenticated-arbitrary-shortcode-execution&text=Simple%20Basic%20Contact%20Form%20%3C%3D%2020240502%20-%20Unauthenticated%20Arbitrary%20Shortcode%20Execution "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fsimple-basic-contact-form%2Fsimple-basic-contact-form-20240502-unauthenticated-arbitrary-shortcode-execution "LinkedIn")
Email

## Vulnerability Details for Simple Basic Contact Form

#### [Simple Basic Contact Form](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/simple-basic-contact-form)

| Software Type | Plugin |
| --- | --- |
| Software Slug | simple-basic-contact-form [(view on wordpress.org)](https://wordpress.org/plugins/simple-basic-contact-form) |
| Patched? | Yes |
| Remediation | Update to version 20240511, or a newer patched version |
| Affected Version | * <= 20240502 |
| Patched Version | * 20240511 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


