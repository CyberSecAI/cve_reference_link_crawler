-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Advisory ID:               SYSS-2024-062
Product:                   mbNET.mini
Manufacturer:              Red Lion Europe GmbH
Affected Version(s):       Firmware Versions: <= 2.2.13; 
                           other/similar devices are also affected 
                           (see manufacturer note[4])
Tested Version(s):         Firmware Version: 2.2.13, 2.2.11
Vulnerability Type:        Use of Hard-coded Cryptographic Key (CWE-321)
Risk Level:                Medium
Solution Status:           Fixed
Manufacturer Notification: 2024-07-25
Solution Date:             2024-09-25
Public Disclosure:         2024-10-15
CVE Reference:             CVE-2024-45273
Author of Advisory:        Moritz Abrell, SySS GmbH

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

The mbNET.mini is a VPN gateway used for remote access and maintenance
in industrial environments.

The manufacturer describes the product as follows (see [1]):

"The mbNET industrial router is the ideal basis for securely connecting
your machines and systems to the Internet - for direct access or via
our remote service portal (my)mbCONNECT24."

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

Configuration files for the mbNET.mini device can be encrypted.
However, the encryption key is derived from a known pattern:

<serial-number><device-type>

An attacker with access to encrypted configuration files is therefore
able to generate the encryption key and access sensitive data such as
VPN credentials.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

1. The script "/etc/rc.d/init.d/cfg" handles configuration files.
    If the file extension is set to ".mbnx", the script decrypts the file
    using OpenSSL and Triple DES.

2. For the key derivation, the OpenSSL built-in function is used and
    the key follows a predefined format:

    <serial-number><device-type> e.g. 391586000123456MDH860:

    openssl des3 -in MDH860.391586000123456.MDH860.mbnx -out out.tar \
     -d -salt -pass pass:391586000123456MDH860 -md md5

3. The decrypted configuration file contains several sensitive pieces of 
    information, such as VPN credentials.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

Update the device according to the manufacturer note.[4]

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2024-07-23: Vulnerability discovered
2024-07-25: Vulnerability reported to manufacturer
2024-07-25: Manufacturer confirmed reception
2024-07-31: Manufacturer asked for alternative publication date
2024-07-31: Asked the manufacturer for updates on the planned fixes
2024-08-02: Manufacturer responded that SYSS-2024-060 will not be fixed and
            a new "encryption" concept will be implemented for SYSS-2024-059
2024-09-10: Update of the vulnerability state and the planned fixes by 
            the manufacturer
2024-09-20: CVE IDs assigned by the manufacturer
2024-09-24: Committment of the publication date (2024-10-15)
2024-10-15: Public disclosure

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1] mbNET product website
    https://mbconnectline.com/mbnet-en/
[2] SySS Security Advisory SYSS-2024-062
    https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2024-062.txt
[3] SySS Responsible Disclosure Policy
    https://www.syss.de/en/responsible-disclosure-policy
[4] Manufacturer note
    https://advisories.mbconnectline.com/pdf/SIM2024-04.pdf
[5] CVE-2024-45273
    https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-45273

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

This security vulnerability was found by Moritz Abrell of SySS GmbH.

E-Mail: moritz.abrell@syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Moritz_Abrell.asc
Key Fingerprint: 2927 7EB6 1A20 0679 79E9  87E6 AE0C 9BF8 F134 8B53

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided "as is"
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS website.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEKSd+thogBnl56Yfmrgyb+PE0i1MFAmcGHc4ACgkQrgyb+PE0
i1PhmQ//Rbcu3u0bE4Zo+g8kMjkNsU1QPvPZ7/HNjBIjqQXHMEWt5Qtc8hYmfh5n
P3kqD2oE3NfHFEihsJ9Ghj0EVtQWzgAK126QClXJjQXyEC+ni3efiNrrEEkrMDry
7lJUh36C44nZnGx3w8hfQ0cf3O1cK4W7+WXAYRh+P8xnxLjT3ARk75UNPGHDG7gZ
d+fzyR7i/MrsCKMSQwsTOr0qkF8vVK13x26JD8c9D94j4G6/gjOBwFkywbKGPvwq
U3VspBQotOIprfi0fwJp8J7RMg2MNm0jPE72E2YrfX5y3W6wn3JnFP0ov6jXuBDw
yWzS91X2x+yVHgjM8OmvSHgYULopt+vQSbv6c/fcWnbBFguTtlUvxTUIOtS1iBQe
980M4tiHM8bVPahDssV+IR54/6s0SYapuLpU3nzUP2f4Bfpr2zfB8XMMPri6c4/z
zvAgIFzDxUKx5J3ABVbxlddUl6Ykk/JR7Xib7F0cEKP4uxmUYlSQAA0i8d7HnGnm
l5gsz4/8TCgr5gyfD21V5MIaMe+wADJX07iPSHWcsQl6MmR3EZF3j/vyYcEjfyHO
UDVSxbwcMhFtR//evgO+OdCFaKvGakMEcTFnWDMMhnagQzM0wBx2K8kVZOfsiSk8
bSfVntx8GCZZqHfCB9EhZo0uNCJwfQoyKPyafuwfNL5qeTSHQmI=
=Ue4e
-----END PGP SIGNATURE-----
