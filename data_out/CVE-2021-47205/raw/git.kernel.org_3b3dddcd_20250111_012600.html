<!DOCTYPE html>
<html lang='en'>
<head>
<title>clk: sunxi-ng: Unregister clocks/resets when unbinding - kernel/git/stable/linux.git - Linux kernel stable tree</title>
<meta name='generator' content='cgit 1.2.3-korg'/>
<meta name='robots' content='noindex, nofollow'/>
<link rel='stylesheet' type='text/css' href='/cgit-data/cgit.css'/>
<script type='text/javascript' src='/cgit-data/cgit.js'></script>
<link rel='shortcut icon' href='/favicon.ico'/>
<link rel='alternate' title='Atom feed' href='https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/atom/?h=master' type='application/atom+xml'/>
<link rel='vcs-git' href='git://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
<link rel='vcs-git' href='https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
<link rel='vcs-git' href='https://kernel.googlesource.com/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
</head>
<body>
<div id='cgit'><table id='header'>
<tr>
<td class='logo' rowspan='2'><a href='/'><img src='/cgit-data/cgit.png' alt='cgit logo'/></a></td>
<td class='main'><a href='/'>index</a> : <a href='/pub/scm/linux/kernel/git/stable/linux.git/'>kernel/git/stable/linux.git</a></td><td class='form'><form method='get'>
<input type='hidden' name='id' value='b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'/><select name='h' onchange='this.form.submit();'>
<option value='linux-2.6.11.y'>linux-2.6.11.y</option>
<option value='linux-2.6.12.y'>linux-2.6.12.y</option>
<option value='linux-2.6.13.y'>linux-2.6.13.y</option>
<option value='linux-2.6.14.y'>linux-2.6.14.y</option>
<option value='linux-2.6.15.y'>linux-2.6.15.y</option>
<option value='linux-2.6.16.y'>linux-2.6.16.y</option>
<option value='linux-2.6.17.y'>linux-2.6.17.y</option>
<option value='linux-2.6.18.y'>linux-2.6.18.y</option>
<option value='linux-2.6.19.y'>linux-2.6.19.y</option>
<option value='linux-2.6.20.y'>linux-2.6.20.y</option>
<option value='linux-2.6.21.y'>linux-2.6.21.y</option>
<option value='linux-2.6.22.y'>linux-2.6.22.y</option>
<option value='linux-2.6.23.y'>linux-2.6.23.y</option>
<option value='linux-2.6.24.y'>linux-2.6.24.y</option>
<option value='linux-2.6.25.y'>linux-2.6.25.y</option>
<option value='linux-2.6.26.y'>linux-2.6.26.y</option>
<option value='linux-2.6.27.y'>linux-2.6.27.y</option>
<option value='linux-2.6.28.y'>linux-2.6.28.y</option>
<option value='linux-2.6.29.y'>linux-2.6.29.y</option>
<option value='linux-2.6.30.y'>linux-2.6.30.y</option>
<option value='linux-2.6.31.y'>linux-2.6.31.y</option>
<option value='linux-2.6.32.y'>linux-2.6.32.y</option>
<option value='linux-2.6.33.y'>linux-2.6.33.y</option>
<option value='linux-2.6.34.y'>linux-2.6.34.y</option>
<option value='linux-2.6.35.y'>linux-2.6.35.y</option>
<option value='linux-2.6.36.y'>linux-2.6.36.y</option>
<option value='linux-2.6.37.y'>linux-2.6.37.y</option>
<option value='linux-2.6.38.y'>linux-2.6.38.y</option>
<option value='linux-2.6.39.y'>linux-2.6.39.y</option>
<option value='linux-3.0.y'>linux-3.0.y</option>
<option value='linux-3.1.y'>linux-3.1.y</option>
<option value='linux-3.10.y'>linux-3.10.y</option>
<option value='linux-3.11.y'>linux-3.11.y</option>
<option value='linux-3.12.y'>linux-3.12.y</option>
<option value='linux-3.13.y'>linux-3.13.y</option>
<option value='linux-3.14.y'>linux-3.14.y</option>
<option value='linux-3.15.y'>linux-3.15.y</option>
<option value='linux-3.16.y'>linux-3.16.y</option>
<option value='linux-3.17.y'>linux-3.17.y</option>
<option value='linux-3.18.y'>linux-3.18.y</option>
<option value='linux-3.19.y'>linux-3.19.y</option>
<option value='linux-3.2.y'>linux-3.2.y</option>
<option value='linux-3.3.y'>linux-3.3.y</option>
<option value='linux-3.4.y'>linux-3.4.y</option>
<option value='linux-3.5.y'>linux-3.5.y</option>
<option value='linux-3.6.y'>linux-3.6.y</option>
<option value='linux-3.7.y'>linux-3.7.y</option>
<option value='linux-3.8.y'>linux-3.8.y</option>
<option value='linux-3.9.y'>linux-3.9.y</option>
<option value='linux-4.0.y'>linux-4.0.y</option>
<option value='linux-4.1.y'>linux-4.1.y</option>
<option value='linux-4.10.y'>linux-4.10.y</option>
<option value='linux-4.11.y'>linux-4.11.y</option>
<option value='linux-4.12.y'>linux-4.12.y</option>
<option value='linux-4.13.y'>linux-4.13.y</option>
<option value='linux-4.14.y'>linux-4.14.y</option>
<option value='linux-4.15.y'>linux-4.15.y</option>
<option value='linux-4.16.y'>linux-4.16.y</option>
<option value='linux-4.17.y'>linux-4.17.y</option>
<option value='linux-4.18.y'>linux-4.18.y</option>
<option value='linux-4.19.y'>linux-4.19.y</option>
<option value='linux-4.2.y'>linux-4.2.y</option>
<option value='linux-4.20.y'>linux-4.20.y</option>
<option value='linux-4.3.y'>linux-4.3.y</option>
<option value='linux-4.4.y'>linux-4.4.y</option>
<option value='linux-4.5.y'>linux-4.5.y</option>
<option value='linux-4.6.y'>linux-4.6.y</option>
<option value='linux-4.7.y'>linux-4.7.y</option>
<option value='linux-4.8.y'>linux-4.8.y</option>
<option value='linux-4.9.y'>linux-4.9.y</option>
<option value='linux-5.0.y'>linux-5.0.y</option>
<option value='linux-5.1.y'>linux-5.1.y</option>
<option value='linux-5.10.y'>linux-5.10.y</option>
<option value='linux-5.11.y'>linux-5.11.y</option>
<option value='linux-5.12.y'>linux-5.12.y</option>
<option value='linux-5.13.y'>linux-5.13.y</option>
<option value='linux-5.14.y'>linux-5.14.y</option>
<option value='linux-5.15.y'>linux-5.15.y</option>
<option value='linux-5.16.y'>linux-5.16.y</option>
<option value='linux-5.17.y'>linux-5.17.y</option>
<option value='linux-5.18.y'>linux-5.18.y</option>
<option value='linux-5.19.y'>linux-5.19.y</option>
<option value='linux-5.2.y'>linux-5.2.y</option>
<option value='linux-5.3.y'>linux-5.3.y</option>
<option value='linux-5.4.y'>linux-5.4.y</option>
<option value='linux-5.5.y'>linux-5.5.y</option>
<option value='linux-5.6.y'>linux-5.6.y</option>
<option value='linux-5.7.y'>linux-5.7.y</option>
<option value='linux-5.8.y'>linux-5.8.y</option>
<option value='linux-5.9.y'>linux-5.9.y</option>
<option value='linux-6.0.y'>linux-6.0.y</option>
<option value='linux-6.1.y'>linux-6.1.y</option>
<option value='linux-6.10.y'>linux-6.10.y</option>
<option value='linux-6.11.y'>linux-6.11.y</option>
<option value='linux-6.12.y'>linux-6.12.y</option>
<option value='linux-6.2.y'>linux-6.2.y</option>
<option value='linux-6.3.y'>linux-6.3.y</option>
<option value='linux-6.4.y'>linux-6.4.y</option>
<option value='linux-6.5.y'>linux-6.5.y</option>
<option value='linux-6.6.y'>linux-6.6.y</option>
<option value='linux-6.7.y'>linux-6.7.y</option>
<option value='linux-6.8.y'>linux-6.8.y</option>
<option value='linux-6.9.y'>linux-6.9.y</option>
<option value='linux-rolling-lts'>linux-rolling-lts</option>
<option value='linux-rolling-stable'>linux-rolling-stable</option>
<option value='master' selected='selected'>master</option>
</select> <input type='submit' value='switch'/></form></td></tr>
<tr><td class='sub'>Linux kernel stable tree</td><td class='sub right'>Stable Group</td></tr></table>
<table class='tabs'><tr><td>
<a href='/pub/scm/linux/kernel/git/stable/linux.git/about/'>about</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/'>summary</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>refs</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/log/'>log</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>tree</a><a class='active' href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>commit</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>diff</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/stats/'>stats</a></td><td class='form'><form class='right' method='get' action='/pub/scm/linux/kernel/git/stable/linux.git/log/'>
<input type='hidden' name='id' value='b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'/><select name='qt'>
<option value='grep'>log msg</option>
<option value='author'>author</option>
<option value='committer'>committer</option>
<option value='range'>range</option>
</select>
<input class='txt' type='search' size='10' name='q' value=''/>
<input type='submit' value='search'/>
</form>
</td></tr></table>
<div class='content'><div class='cgit-panel'><b>diff options</b><form method='get'><input type='hidden' name='id' value='b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'/><table><tr><td colspan='2'/></tr><tr><td class='label'>context:</td><td class='ctrl'><select name='context' onchange='this.form.submit();'><option value='1'>1</option><option value='2'>2</option><option value='3' selected='selected'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='15'>15</option><option value='20'>20</option><option value='25'>25</option><option value='30'>30</option><option value='35'>35</option><option value='40'>40</option></select></td></tr><tr><td class='label'>space:</td><td class='ctrl'><select name='ignorews' onchange='this.form.submit();'><option value='0' selected='selected'>include</option><option value='1'>ignore</option></select></td></tr><tr><td class='label'>mode:</td><td class='ctrl'><select name='dt' onchange='this.form.submit();'><option value='0' selected='selected'>unified</option><option value='1'>ssdiff</option><option value='2'>stat only</option></select></td></tr><tr><td/><td class='ctrl'><noscript><input type='submit' value='reload'/></noscript></td></tr></table></form></div><table summary='commit info' class='commit-info'>
<tr><th>author</th><td>Samuel Holland &lt;samuel@sholland.org&gt;</td><td class='right'>2021-09-01 00:05:19 -0500</td></tr>
<tr><th>committer</th><td>Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;</td><td class='right'>2021-11-25 09:48:23 +0100</td></tr>
<tr><th>commit</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>b5dd513daa70ee8f6d281a20bd28485ee9bb7db2</a> (<a href='/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>patch</a>)</td></tr>
<tr><th>tree</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>dedf9d0ab0833151d0f3650259ff70a405ac1ab2</a></td></tr>
<tr><th>parent</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5d729f4b5b56975781e279d3039ff28882789c99'>5d729f4b5b56975781e279d3039ff28882789c99</a> (<a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2&amp;id2=5d729f4b5b56975781e279d3039ff28882789c99'>diff</a>)</td></tr><tr><th>download</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-b5dd513daa70ee8f6d281a20bd28485ee9bb7db2.tar.gz'>linux-b5dd513daa70ee8f6d281a20bd28485ee9bb7db2.tar.gz</a><br/></td></tr></table>
<div class='commit-subject'>clk: sunxi-ng: Unregister clocks/resets when unbinding</div><div class='commit-msg'>[ Upstream commit 9bec2b9c6134052994115d2d3374e96f2ccb9b9d ]

Currently, unbinding a CCU driver unmaps the device's MMIO region, while
leaving its clocks/resets and their providers registered. This can cause
a page fault later when some clock operation tries to perform MMIO. Fix
this by separating the CCU initialization from the memory allocation,
and then using a devres callback to unregister the clocks and resets.

This also fixes a memory leak of the `struct ccu_reset`, and uses the
correct owner (the specific platform driver) for the clocks and resets.

Early OF clock providers are never unregistered, and limited error
handling is possible, so they are mostly unchanged. The error reporting
is made more consistent by moving the message inside of_sunxi_ccu_probe.

Signed-off-by: Samuel Holland &lt;samuel@sholland.org&gt;
Signed-off-by: Maxime Ripard &lt;maxime@cerno.tech&gt;
Link: <a href="https://lore.kernel.org/r/20210901050526.45673-2-samuel@sholland.org">https://lore.kernel.org/r/20210901050526.45673-2-samuel@sholland.org</a>
Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;
</div><div class='diffstat-header'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>Diffstat</a></div><table summary='diffstat' class='diffstat'><tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun4i-a10.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun4i-a10.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun50i-a100-r.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun50i-a100-r.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun50i-a100.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun50i-a100.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun50i-a64.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun50i-a64.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun50i-h6-r.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun50i-h6-r.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun50i-h6.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun50i-h6.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun50i-h616.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun50i-h616.c</a></td><td class='right'>4</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 3.4%;'/><td class='none' style='width: 95.5%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun5i.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun5i.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun6i-a31.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun6i-a31.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun8i-a23.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-a23.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun8i-a33.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-a33.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun8i-a83t.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-a83t.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun8i-de2.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-de2.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun8i-h3.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-h3.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun8i-r.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-r.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun8i-r40.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-r40.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun8i-v3s.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-v3s.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun9i-a80-de.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun9i-a80-de.c</a></td><td class='right'>3</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 2.2%;'/><td class='none' style='width: 96.6%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun9i-a80-usb.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun9i-a80-usb.c</a></td><td class='right'>3</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 2.2%;'/><td class='none' style='width: 96.6%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-sun9i-a80.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun9i-a80.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu-suniv-f1c100s.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-suniv-f1c100s.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 1.1%;'/><td class='rem' style='width: 1.1%;'/><td class='none' style='width: 97.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu_common.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu_common.c</a></td><td class='right'>89</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 84.3%;'/><td class='rem' style='width: 15.7%;'/><td class='none' style='width: 0.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/clk/sunxi-ng/ccu_common.h?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu_common.h</a></td><td class='right'>6</td><td class='graph'><table summary='file diffstat' width='89%'><tr><td class='add' style='width: 4.5%;'/><td class='rem' style='width: 2.2%;'/><td class='none' style='width: 93.3%;'/></tr></table></td></tr>
</table><div class='diffstat-summary'>23 files changed, 100 insertions, 41 deletions</div><table summary='diff' class='diff'><tr><td><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun4i-a10.c b/drivers/clk/sunxi-ng/ccu-sun4i-a10.c<br/>index f32366d9336e7b..bd9a8782fec3d4 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun4i-a10.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun4i-a10.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun4i-a10.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun4i-a10.c</a></div><div class='hunk'>@@ -1464,7 +1464,7 @@ static void __init sun4i_ccu_init(struct device_node *node,</div><div class='ctx'> 	val &amp;= ~GENMASK(7, 6);</div><div class='ctx'> 	writel(val | (2 &lt;&lt; 6), reg + SUN4I_AHB_REG);</div><div class='ctx'> </div><div class='del'>-	sunxi_ccu_probe(node, reg, desc);</div><div class='add'>+	of_sunxi_ccu_probe(node, reg, desc);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> static void __init sun4i_a10_ccu_setup(struct device_node *node)</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun50i-a100-r.c b/drivers/clk/sunxi-ng/ccu-sun50i-a100-r.c<br/>index a56142b9099383..6f2a5897055610 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun50i-a100-r.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun50i-a100-r.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun50i-a100-r.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun50i-a100-r.c</a></div><div class='hunk'>@@ -196,7 +196,7 @@ static int sun50i_a100_r_ccu_probe(struct platform_device *pdev)</div><div class='ctx'> 	if (IS_ERR(reg))</div><div class='ctx'> 		return PTR_ERR(reg);</div><div class='ctx'> </div><div class='del'>-	return sunxi_ccu_probe(pdev-&gt;dev.of_node, reg, &amp;sun50i_a100_r_ccu_desc);</div><div class='add'>+	return devm_sunxi_ccu_probe(&amp;pdev-&gt;dev, reg, &amp;sun50i_a100_r_ccu_desc);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> static const struct of_device_id sun50i_a100_r_ccu_ids[] = {</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun50i-a100.c b/drivers/clk/sunxi-ng/ccu-sun50i-a100.c<br/>index 81b48c73d389fd..913bb08e6dee8b 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun50i-a100.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun50i-a100.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun50i-a100.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun50i-a100.c</a></div><div class='hunk'>@@ -1247,7 +1247,7 @@ static int sun50i_a100_ccu_probe(struct platform_device *pdev)</div><div class='ctx'> 		writel(val, reg + sun50i_a100_usb2_clk_regs[i]);</div><div class='ctx'> 	}</div><div class='ctx'> </div><div class='del'>-	ret = sunxi_ccu_probe(pdev-&gt;dev.of_node, reg, &amp;sun50i_a100_ccu_desc);</div><div class='add'>+	ret = devm_sunxi_ccu_probe(&amp;pdev-&gt;dev, reg, &amp;sun50i_a100_ccu_desc);</div><div class='ctx'> 	if (ret)</div><div class='ctx'> 		return ret;</div><div class='ctx'> </div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun50i-a64.c b/drivers/clk/sunxi-ng/ccu-sun50i-a64.c<br/>index 149cfde817cba7..54f25c624f020b 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun50i-a64.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun50i-a64.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun50i-a64.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun50i-a64.c</a></div><div class='hunk'>@@ -955,7 +955,7 @@ static int sun50i_a64_ccu_probe(struct platform_device *pdev)</div><div class='ctx'> </div><div class='ctx'> 	writel(0x515, reg + SUN50I_A64_PLL_MIPI_REG);</div><div class='ctx'> </div><div class='del'>-	ret = sunxi_ccu_probe(pdev-&gt;dev.of_node, reg, &amp;sun50i_a64_ccu_desc);</div><div class='add'>+	ret = devm_sunxi_ccu_probe(&amp;pdev-&gt;dev, reg, &amp;sun50i_a64_ccu_desc);</div><div class='ctx'> 	if (ret)</div><div class='ctx'> 		return ret;</div><div class='ctx'> </div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun50i-h6-r.c b/drivers/clk/sunxi-ng/ccu-sun50i-h6-r.c<br/>index f8909a7ed5539a..f30d7eb5424d8a 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun50i-h6-r.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun50i-h6-r.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun50i-h6-r.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun50i-h6-r.c</a></div><div class='hunk'>@@ -232,7 +232,7 @@ static void __init sunxi_r_ccu_init(struct device_node *node,</div><div class='ctx'> 		return;</div><div class='ctx'> 	}</div><div class='ctx'> </div><div class='del'>-	sunxi_ccu_probe(node, reg, desc);</div><div class='add'>+	of_sunxi_ccu_probe(node, reg, desc);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> static void __init sun50i_h6_r_ccu_setup(struct device_node *node)</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun50i-h6.c b/drivers/clk/sunxi-ng/ccu-sun50i-h6.c<br/>index bff446b7829071..c0800da2fa3d70 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun50i-h6.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun50i-h6.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun50i-h6.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun50i-h6.c</a></div><div class='hunk'>@@ -1240,7 +1240,7 @@ static int sun50i_h6_ccu_probe(struct platform_device *pdev)</div><div class='ctx'> 	val |= BIT(24);</div><div class='ctx'> 	writel(val, reg + SUN50I_H6_HDMI_CEC_CLK_REG);</div><div class='ctx'> </div><div class='del'>-	return sunxi_ccu_probe(pdev-&gt;dev.of_node, reg, &amp;sun50i_h6_ccu_desc);</div><div class='add'>+	return devm_sunxi_ccu_probe(&amp;pdev-&gt;dev, reg, &amp;sun50i_h6_ccu_desc);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> static const struct of_device_id sun50i_h6_ccu_ids[] = {</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun50i-h616.c b/drivers/clk/sunxi-ng/ccu-sun50i-h616.c<br/>index 225307305880e2..22eb18079a154e 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun50i-h616.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun50i-h616.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun50i-h616.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun50i-h616.c</a></div><div class='hunk'>@@ -1141,9 +1141,7 @@ static void __init sun50i_h616_ccu_setup(struct device_node *node)</div><div class='ctx'> 	val |= BIT(24);</div><div class='ctx'> 	writel(val, reg + SUN50I_H616_HDMI_CEC_CLK_REG);</div><div class='ctx'> </div><div class='del'>-	i = sunxi_ccu_probe(node, reg, &amp;sun50i_h616_ccu_desc);</div><div class='del'>-	if (i)</div><div class='del'>-		pr_err("%pOF: probing clocks fails: %d\n", node, i);</div><div class='add'>+	of_sunxi_ccu_probe(node, reg, &amp;sun50i_h616_ccu_desc);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> CLK_OF_DECLARE(sun50i_h616_ccu, "allwinner,sun50i-h616-ccu",</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun5i.c b/drivers/clk/sunxi-ng/ccu-sun5i.c<br/>index b78e9b507c1c68..1f4bc0e773a7ed 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun5i.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun5i.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun5i.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun5i.c</a></div><div class='hunk'>@@ -1012,7 +1012,7 @@ static void __init sun5i_ccu_init(struct device_node *node,</div><div class='ctx'> 	val &amp;= ~GENMASK(7, 6);</div><div class='ctx'> 	writel(val | (2 &lt;&lt; 6), reg + SUN5I_AHB_REG);</div><div class='ctx'> </div><div class='del'>-	sunxi_ccu_probe(node, reg, desc);</div><div class='add'>+	of_sunxi_ccu_probe(node, reg, desc);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> static void __init sun5i_a10s_ccu_setup(struct device_node *node)</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun6i-a31.c b/drivers/clk/sunxi-ng/ccu-sun6i-a31.c<br/>index 9b40d53266a3f4..3df5c0b4158046 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun6i-a31.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun6i-a31.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun6i-a31.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun6i-a31.c</a></div><div class='hunk'>@@ -1257,7 +1257,7 @@ static void __init sun6i_a31_ccu_setup(struct device_node *node)</div><div class='ctx'> 	val |= 0x3 &lt;&lt; 12;</div><div class='ctx'> 	writel(val, reg + SUN6I_A31_AHB1_REG);</div><div class='ctx'> </div><div class='del'>-	sunxi_ccu_probe(node, reg, &amp;sun6i_a31_ccu_desc);</div><div class='add'>+	of_sunxi_ccu_probe(node, reg, &amp;sun6i_a31_ccu_desc);</div><div class='ctx'> </div><div class='ctx'> 	ccu_mux_notifier_register(pll_cpu_clk.common.hw.clk,</div><div class='ctx'> 				  &amp;sun6i_a31_cpu_nb);</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun8i-a23.c b/drivers/clk/sunxi-ng/ccu-sun8i-a23.c<br/>index 103aa504f6c8a6..577bb235d65841 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-a23.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun8i-a23.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-a23.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-a23.c</a></div><div class='hunk'>@@ -745,7 +745,7 @@ static void __init sun8i_a23_ccu_setup(struct device_node *node)</div><div class='ctx'> 	val &amp;= ~BIT(16);</div><div class='ctx'> 	writel(val, reg + SUN8I_A23_PLL_MIPI_REG);</div><div class='ctx'> </div><div class='del'>-	sunxi_ccu_probe(node, reg, &amp;sun8i_a23_ccu_desc);</div><div class='add'>+	of_sunxi_ccu_probe(node, reg, &amp;sun8i_a23_ccu_desc);</div><div class='ctx'> }</div><div class='ctx'> CLK_OF_DECLARE(sun8i_a23_ccu, "allwinner,sun8i-a23-ccu",</div><div class='ctx'> 	       sun8i_a23_ccu_setup);</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun8i-a33.c b/drivers/clk/sunxi-ng/ccu-sun8i-a33.c<br/>index 91838cd110377c..8f65cd03f5acc0 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-a33.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun8i-a33.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-a33.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-a33.c</a></div><div class='hunk'>@@ -805,7 +805,7 @@ static void __init sun8i_a33_ccu_setup(struct device_node *node)</div><div class='ctx'> 	val &amp;= ~BIT(16);</div><div class='ctx'> 	writel(val, reg + SUN8I_A33_PLL_MIPI_REG);</div><div class='ctx'> </div><div class='del'>-	sunxi_ccu_probe(node, reg, &amp;sun8i_a33_ccu_desc);</div><div class='add'>+	of_sunxi_ccu_probe(node, reg, &amp;sun8i_a33_ccu_desc);</div><div class='ctx'> </div><div class='ctx'> 	/* Gate then ungate PLL CPU after any rate changes */</div><div class='ctx'> 	ccu_pll_notifier_register(&amp;sun8i_a33_pll_cpu_nb);</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun8i-a83t.c b/drivers/clk/sunxi-ng/ccu-sun8i-a83t.c<br/>index 2b434521c5ccfc..c2ddcd2ddab4ec 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-a83t.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun8i-a83t.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-a83t.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-a83t.c</a></div><div class='hunk'>@@ -906,7 +906,7 @@ static int sun8i_a83t_ccu_probe(struct platform_device *pdev)</div><div class='ctx'> 	sun8i_a83t_cpu_pll_fixup(reg + SUN8I_A83T_PLL_C0CPUX_REG);</div><div class='ctx'> 	sun8i_a83t_cpu_pll_fixup(reg + SUN8I_A83T_PLL_C1CPUX_REG);</div><div class='ctx'> </div><div class='del'>-	return sunxi_ccu_probe(pdev-&gt;dev.of_node, reg, &amp;sun8i_a83t_ccu_desc);</div><div class='add'>+	return devm_sunxi_ccu_probe(&amp;pdev-&gt;dev, reg, &amp;sun8i_a83t_ccu_desc);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> static const struct of_device_id sun8i_a83t_ccu_ids[] = {</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun8i-de2.c b/drivers/clk/sunxi-ng/ccu-sun8i-de2.c<br/>index 524f33275bc73c..4b94b6041b271a 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-de2.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun8i-de2.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-de2.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-de2.c</a></div><div class='hunk'>@@ -342,7 +342,7 @@ static int sunxi_de2_clk_probe(struct platform_device *pdev)</div><div class='ctx'> 		goto err_disable_mod_clk;</div><div class='ctx'> 	}</div><div class='ctx'> </div><div class='del'>-	ret = sunxi_ccu_probe(pdev-&gt;dev.of_node, reg, ccu_desc);</div><div class='add'>+	ret = devm_sunxi_ccu_probe(&amp;pdev-&gt;dev, reg, ccu_desc);</div><div class='ctx'> 	if (ret)</div><div class='ctx'> 		goto err_assert_reset;</div><div class='ctx'> </div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun8i-h3.c b/drivers/clk/sunxi-ng/ccu-sun8i-h3.c<br/>index 7e629a4493afde..d2fc2903787d8f 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-h3.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun8i-h3.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-h3.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-h3.c</a></div><div class='hunk'>@@ -1154,7 +1154,7 @@ static void __init sunxi_h3_h5_ccu_init(struct device_node *node,</div><div class='ctx'> 	val &amp;= ~GENMASK(19, 16);</div><div class='ctx'> 	writel(val | (0 &lt;&lt; 16), reg + SUN8I_H3_PLL_AUDIO_REG);</div><div class='ctx'> </div><div class='del'>-	sunxi_ccu_probe(node, reg, desc);</div><div class='add'>+	of_sunxi_ccu_probe(node, reg, desc);</div><div class='ctx'> </div><div class='ctx'> 	/* Gate then ungate PLL CPU after any rate changes */</div><div class='ctx'> 	ccu_pll_notifier_register(&amp;sun8i_h3_pll_cpu_nb);</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun8i-r.c b/drivers/clk/sunxi-ng/ccu-sun8i-r.c<br/>index 4c8c491b87c277..9e754d1f754a13 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-r.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun8i-r.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-r.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-r.c</a></div><div class='hunk'>@@ -265,7 +265,7 @@ static void __init sunxi_r_ccu_init(struct device_node *node,</div><div class='ctx'> 		return;</div><div class='ctx'> 	}</div><div class='ctx'> </div><div class='del'>-	sunxi_ccu_probe(node, reg, desc);</div><div class='add'>+	of_sunxi_ccu_probe(node, reg, desc);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> static void __init sun8i_a83t_r_ccu_setup(struct device_node *node)</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun8i-r40.c b/drivers/clk/sunxi-ng/ccu-sun8i-r40.c<br/>index 84153418453f41..002e0c3a04dbea 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-r40.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun8i-r40.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-r40.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-r40.c</a></div><div class='hunk'>@@ -1346,7 +1346,7 @@ static int sun8i_r40_ccu_probe(struct platform_device *pdev)</div><div class='ctx'> 	if (IS_ERR(regmap))</div><div class='ctx'> 		return PTR_ERR(regmap);</div><div class='ctx'> </div><div class='del'>-	ret = sunxi_ccu_probe(pdev-&gt;dev.of_node, reg, &amp;sun8i_r40_ccu_desc);</div><div class='add'>+	ret = devm_sunxi_ccu_probe(&amp;pdev-&gt;dev, reg, &amp;sun8i_r40_ccu_desc);</div><div class='ctx'> 	if (ret)</div><div class='ctx'> 		return ret;</div><div class='ctx'> </div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun8i-v3s.c b/drivers/clk/sunxi-ng/ccu-sun8i-v3s.c<br/>index f49724a22540e5..ce150f83ab54e2 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-v3s.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun8i-v3s.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun8i-v3s.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun8i-v3s.c</a></div><div class='hunk'>@@ -822,7 +822,7 @@ static void __init sun8i_v3_v3s_ccu_init(struct device_node *node,</div><div class='ctx'> 	val &amp;= ~GENMASK(19, 16);</div><div class='ctx'> 	writel(val, reg + SUN8I_V3S_PLL_AUDIO_REG);</div><div class='ctx'> </div><div class='del'>-	sunxi_ccu_probe(node, reg, ccu_desc);</div><div class='add'>+	of_sunxi_ccu_probe(node, reg, ccu_desc);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> static void __init sun8i_v3s_ccu_setup(struct device_node *node)</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun9i-a80-de.c b/drivers/clk/sunxi-ng/ccu-sun9i-a80-de.c<br/>index 6616e8114f6238..261e64416f26a8 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun9i-a80-de.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun9i-a80-de.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun9i-a80-de.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun9i-a80-de.c</a></div><div class='hunk'>@@ -246,8 +246,7 @@ static int sun9i_a80_de_clk_probe(struct platform_device *pdev)</div><div class='ctx'> 		goto err_disable_clk;</div><div class='ctx'> 	}</div><div class='ctx'> </div><div class='del'>-	ret = sunxi_ccu_probe(pdev-&gt;dev.of_node, reg,</div><div class='del'>-			      &amp;sun9i_a80_de_clk_desc);</div><div class='add'>+	ret = devm_sunxi_ccu_probe(&amp;pdev-&gt;dev, reg, &amp;sun9i_a80_de_clk_desc);</div><div class='ctx'> 	if (ret)</div><div class='ctx'> 		goto err_assert_reset;</div><div class='ctx'> </div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun9i-a80-usb.c b/drivers/clk/sunxi-ng/ccu-sun9i-a80-usb.c<br/>index 4b4a507d04edfa..596243b3e0fa3e 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun9i-a80-usb.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun9i-a80-usb.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun9i-a80-usb.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun9i-a80-usb.c</a></div><div class='hunk'>@@ -117,8 +117,7 @@ static int sun9i_a80_usb_clk_probe(struct platform_device *pdev)</div><div class='ctx'> 		return ret;</div><div class='ctx'> 	}</div><div class='ctx'> </div><div class='del'>-	ret = sunxi_ccu_probe(pdev-&gt;dev.of_node, reg,</div><div class='del'>-			      &amp;sun9i_a80_usb_clk_desc);</div><div class='add'>+	ret = devm_sunxi_ccu_probe(&amp;pdev-&gt;dev, reg, &amp;sun9i_a80_usb_clk_desc);</div><div class='ctx'> 	if (ret)</div><div class='ctx'> 		goto err_disable_clk;</div><div class='ctx'> </div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-sun9i-a80.c b/drivers/clk/sunxi-ng/ccu-sun9i-a80.c<br/>index ef29582676f6ee..97aaed0e685000 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun9i-a80.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-sun9i-a80.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-sun9i-a80.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-sun9i-a80.c</a></div><div class='hunk'>@@ -1231,7 +1231,7 @@ static int sun9i_a80_ccu_probe(struct platform_device *pdev)</div><div class='ctx'> 	sun9i_a80_cpu_pll_fixup(reg + SUN9I_A80_PLL_C0CPUX_REG);</div><div class='ctx'> 	sun9i_a80_cpu_pll_fixup(reg + SUN9I_A80_PLL_C1CPUX_REG);</div><div class='ctx'> </div><div class='del'>-	return sunxi_ccu_probe(pdev-&gt;dev.of_node, reg, &amp;sun9i_a80_ccu_desc);</div><div class='add'>+	return devm_sunxi_ccu_probe(&amp;pdev-&gt;dev, reg, &amp;sun9i_a80_ccu_desc);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> static const struct of_device_id sun9i_a80_ccu_ids[] = {</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu-suniv-f1c100s.c b/drivers/clk/sunxi-ng/ccu-suniv-f1c100s.c<br/>index 7ecc3a5a5b5e1a..61ad7ee91c1140 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-suniv-f1c100s.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu-suniv-f1c100s.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu-suniv-f1c100s.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu-suniv-f1c100s.c</a></div><div class='hunk'>@@ -538,7 +538,7 @@ static void __init suniv_f1c100s_ccu_setup(struct device_node *node)</div><div class='ctx'> 	val &amp;= ~GENMASK(19, 16);</div><div class='ctx'> 	writel(val | (3 &lt;&lt; 16), reg + SUNIV_PLL_AUDIO_REG);</div><div class='ctx'> </div><div class='del'>-	sunxi_ccu_probe(node, reg, &amp;suniv_ccu_desc);</div><div class='add'>+	of_sunxi_ccu_probe(node, reg, &amp;suniv_ccu_desc);</div><div class='ctx'> </div><div class='ctx'> 	/* Gate then ungate PLL CPU after any rate changes */</div><div class='ctx'> 	ccu_pll_notifier_register(&amp;suniv_pll_cpu_nb);</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu_common.c b/drivers/clk/sunxi-ng/ccu_common.c<br/>index 2e20e650b6c01b..88cb569e58358d 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu_common.c?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu_common.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu_common.c?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu_common.c</a></div><div class='hunk'>@@ -7,6 +7,7 @@</div><div class='ctx'> </div><div class='ctx'> #include &lt;linux/clk.h&gt;</div><div class='ctx'> #include &lt;linux/clk-provider.h&gt;</div><div class='add'>+#include &lt;linux/device.h&gt;</div><div class='ctx'> #include &lt;linux/iopoll.h&gt;</div><div class='ctx'> #include &lt;linux/slab.h&gt;</div><div class='ctx'> </div><div class='hunk'>@@ -14,6 +15,11 @@</div><div class='ctx'> #include "ccu_gate.h"</div><div class='ctx'> #include "ccu_reset.h"</div><div class='ctx'> </div><div class='add'>+struct sunxi_ccu {</div><div class='add'>+	const struct sunxi_ccu_desc	*desc;</div><div class='add'>+	struct ccu_reset		reset;</div><div class='add'>+};</div><div class='add'>+</div><div class='ctx'> static DEFINE_SPINLOCK(ccu_lock);</div><div class='ctx'> </div><div class='ctx'> void ccu_helper_wait_for_lock(struct ccu_common *common, u32 lock)</div><div class='hunk'>@@ -79,12 +85,15 @@ int ccu_pll_notifier_register(struct ccu_pll_nb *pll_nb)</div><div class='ctx'> 				     &amp;pll_nb-&gt;clk_nb);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='del'>-int sunxi_ccu_probe(struct device_node *node, void __iomem *reg,</div><div class='del'>-		    const struct sunxi_ccu_desc *desc)</div><div class='add'>+static int sunxi_ccu_probe(struct sunxi_ccu *ccu, struct device *dev,</div><div class='add'>+			   struct device_node *node, void __iomem *reg,</div><div class='add'>+			   const struct sunxi_ccu_desc *desc)</div><div class='ctx'> {</div><div class='ctx'> 	struct ccu_reset *reset;</div><div class='ctx'> 	int i, ret;</div><div class='ctx'> </div><div class='add'>+	ccu-&gt;desc = desc;</div><div class='add'>+</div><div class='ctx'> 	for (i = 0; i &lt; desc-&gt;num_ccu_clks; i++) {</div><div class='ctx'> 		struct ccu_common *cclk = desc-&gt;ccu_clks[i];</div><div class='ctx'> </div><div class='hunk'>@@ -103,7 +112,10 @@ int sunxi_ccu_probe(struct device_node *node, void __iomem *reg,</div><div class='ctx'> 			continue;</div><div class='ctx'> </div><div class='ctx'> 		name = hw-&gt;init-&gt;name;</div><div class='del'>-		ret = of_clk_hw_register(node, hw);</div><div class='add'>+		if (dev)</div><div class='add'>+			ret = clk_hw_register(dev, hw);</div><div class='add'>+		else</div><div class='add'>+			ret = of_clk_hw_register(node, hw);</div><div class='ctx'> 		if (ret) {</div><div class='ctx'> 			pr_err("Couldn't register clock %d - %s\n", i, name);</div><div class='ctx'> 			goto err_clk_unreg;</div><div class='hunk'>@@ -115,15 +127,10 @@ int sunxi_ccu_probe(struct device_node *node, void __iomem *reg,</div><div class='ctx'> 	if (ret)</div><div class='ctx'> 		goto err_clk_unreg;</div><div class='ctx'> </div><div class='del'>-	reset = kzalloc(sizeof(*reset), GFP_KERNEL);</div><div class='del'>-	if (!reset) {</div><div class='del'>-		ret = -ENOMEM;</div><div class='del'>-		goto err_alloc_reset;</div><div class='del'>-	}</div><div class='del'>-</div><div class='add'>+	reset = &amp;ccu-&gt;reset;</div><div class='ctx'> 	reset-&gt;rcdev.of_node = node;</div><div class='ctx'> 	reset-&gt;rcdev.ops = &amp;ccu_reset_ops;</div><div class='del'>-	reset-&gt;rcdev.owner = THIS_MODULE;</div><div class='add'>+	reset-&gt;rcdev.owner = dev ? dev-&gt;driver-&gt;owner : THIS_MODULE;</div><div class='ctx'> 	reset-&gt;rcdev.nr_resets = desc-&gt;num_resets;</div><div class='ctx'> 	reset-&gt;base = reg;</div><div class='ctx'> 	reset-&gt;lock = &amp;ccu_lock;</div><div class='hunk'>@@ -131,13 +138,11 @@ int sunxi_ccu_probe(struct device_node *node, void __iomem *reg,</div><div class='ctx'> </div><div class='ctx'> 	ret = reset_controller_register(&amp;reset-&gt;rcdev);</div><div class='ctx'> 	if (ret)</div><div class='del'>-		goto err_of_clk_unreg;</div><div class='add'>+		goto err_del_provider;</div><div class='ctx'> </div><div class='ctx'> 	return 0;</div><div class='ctx'> </div><div class='del'>-err_of_clk_unreg:</div><div class='del'>-	kfree(reset);</div><div class='del'>-err_alloc_reset:</div><div class='add'>+err_del_provider:</div><div class='ctx'> 	of_clk_del_provider(node);</div><div class='ctx'> err_clk_unreg:</div><div class='ctx'> 	while (--i &gt;= 0) {</div><div class='hunk'>@@ -149,3 +154,59 @@ err_clk_unreg:</div><div class='ctx'> 	}</div><div class='ctx'> 	return ret;</div><div class='ctx'> }</div><div class='add'>+</div><div class='add'>+static void devm_sunxi_ccu_release(struct device *dev, void *res)</div><div class='add'>+{</div><div class='add'>+	struct sunxi_ccu *ccu = res;</div><div class='add'>+	const struct sunxi_ccu_desc *desc = ccu-&gt;desc;</div><div class='add'>+	int i;</div><div class='add'>+</div><div class='add'>+	reset_controller_unregister(&amp;ccu-&gt;reset.rcdev);</div><div class='add'>+	of_clk_del_provider(dev-&gt;of_node);</div><div class='add'>+</div><div class='add'>+	for (i = 0; i &lt; desc-&gt;hw_clks-&gt;num; i++) {</div><div class='add'>+		struct clk_hw *hw = desc-&gt;hw_clks-&gt;hws[i];</div><div class='add'>+</div><div class='add'>+		if (!hw)</div><div class='add'>+			continue;</div><div class='add'>+		clk_hw_unregister(hw);</div><div class='add'>+	}</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+int devm_sunxi_ccu_probe(struct device *dev, void __iomem *reg,</div><div class='add'>+			 const struct sunxi_ccu_desc *desc)</div><div class='add'>+{</div><div class='add'>+	struct sunxi_ccu *ccu;</div><div class='add'>+	int ret;</div><div class='add'>+</div><div class='add'>+	ccu = devres_alloc(devm_sunxi_ccu_release, sizeof(*ccu), GFP_KERNEL);</div><div class='add'>+	if (!ccu)</div><div class='add'>+		return -ENOMEM;</div><div class='add'>+</div><div class='add'>+	ret = sunxi_ccu_probe(ccu, dev, dev-&gt;of_node, reg, desc);</div><div class='add'>+	if (ret) {</div><div class='add'>+		devres_free(ccu);</div><div class='add'>+		return ret;</div><div class='add'>+	}</div><div class='add'>+</div><div class='add'>+	devres_add(dev, ccu);</div><div class='add'>+</div><div class='add'>+	return 0;</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+void of_sunxi_ccu_probe(struct device_node *node, void __iomem *reg,</div><div class='add'>+			const struct sunxi_ccu_desc *desc)</div><div class='add'>+{</div><div class='add'>+	struct sunxi_ccu *ccu;</div><div class='add'>+	int ret;</div><div class='add'>+</div><div class='add'>+	ccu = kzalloc(sizeof(*ccu), GFP_KERNEL);</div><div class='add'>+	if (!ccu)</div><div class='add'>+		return;</div><div class='add'>+</div><div class='add'>+	ret = sunxi_ccu_probe(ccu, NULL, node, reg, desc);</div><div class='add'>+	if (ret) {</div><div class='add'>+		pr_err("%pOF: probing clocks failed: %d\n", node, ret);</div><div class='add'>+		kfree(ccu);</div><div class='add'>+	}</div><div class='add'>+}</div><div class='head'>diff --git a/drivers/clk/sunxi-ng/ccu_common.h b/drivers/clk/sunxi-ng/ccu_common.h<br/>index 04e7a12200a212..98a1834b58bb4f 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu_common.h?id=5d729f4b5b56975781e279d3039ff28882789c99'>drivers/clk/sunxi-ng/ccu_common.h</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/clk/sunxi-ng/ccu_common.h?id=b5dd513daa70ee8f6d281a20bd28485ee9bb7db2'>drivers/clk/sunxi-ng/ccu_common.h</a></div><div class='hunk'>@@ -63,7 +63,9 @@ struct ccu_pll_nb {</div><div class='ctx'> </div><div class='ctx'> int ccu_pll_notifier_register(struct ccu_pll_nb *pll_nb);</div><div class='ctx'> </div><div class='del'>-int sunxi_ccu_probe(struct device_node *node, void __iomem *reg,</div><div class='del'>-		    const struct sunxi_ccu_desc *desc);</div><div class='add'>+int devm_sunxi_ccu_probe(struct device *dev, void __iomem *reg,</div><div class='add'>+			 const struct sunxi_ccu_desc *desc);</div><div class='add'>+void of_sunxi_ccu_probe(struct device_node *node, void __iomem *reg,</div><div class='add'>+			const struct sunxi_ccu_desc *desc);</div><div class='ctx'> </div><div class='ctx'> #endif /* _COMMON_H_ */</div></td></tr></table></div> <!-- class=content -->
<div class='footer'>generated by <a href='https://git.zx2c4.com/cgit/about/'>cgit 1.2.3-korg</a> (<a href='https://git-scm.com/'>git 2.43.0</a>) at 2025-01-11 01:24:38 +0000</div>
</div> <!-- id=cgit -->
</body>
</html>
