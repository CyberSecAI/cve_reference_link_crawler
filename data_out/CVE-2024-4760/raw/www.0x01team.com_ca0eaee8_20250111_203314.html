<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="profile" href="https://gmpg.org/xfn/11">
	<title>Bypassing Microchip Atmel SAM E70/S70/V70/V71 Security &#8211; 0x01 Team blog</title>
<meta name='robots' content='max-image-preview:large' />
<link rel="alternate" type="application/rss+xml" title="0x01 Team blog &raquo; Feed" href="https://www.0x01team.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="0x01 Team blog &raquo; Comments Feed" href="https://www.0x01team.com/comments/feed/" />
<script>
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.0x01team.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.2.6"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){p.clearRect(0,0,i.width,i.height),p.fillText(e,0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(t,0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(p&&p.fillText)switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s("\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!s("\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!s("\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!s("\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udfff","\ud83e\udef1\ud83c\udffb\u200b\ud83e\udef2\ud83c\udfff")}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style>
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css' href='https://www.0x01team.com/wp-includes/css/dist/block-library/style.min.css?ver=6.2.6' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<link rel='stylesheet' id='classic-theme-styles-css' href='https://www.0x01team.com/wp-includes/css/classic-themes.min.css?ver=6.2.6' media='all' />
<style id='global-styles-inline-css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://www.0x01team.com/wp-content/plugins/droit-dark-mode/assets/font-awesome/css/all.css?ver=1.0.7' media='all' />
<link rel='stylesheet' id='dtdr-public-css' href='https://www.0x01team.com/wp-content/plugins/droit-dark-mode/assets/css/public-mode.css?ver=1.0.7' media='all' />
<style id='dtdr-public-inline-css'>
:root {--drdt-color-white: #fff;--drdt-color-bg: #1A1A1A;--drdt-color-body: #7D7D7D;--drdt-color-head: #FFFFFF;--drdt-color-link: #7D7D7D;--drdt-color-link-hover: #FFFFFF;--drdt-color-btn: #1A1A1A;--drdt-color-border: #626060;}html.drdt-dark-mode :not(.drdt-ignore-dark):not(.drdt_checkbox):not(.droit_dark):not(.droit_light):not(.dark_switch_box):not(img):not(option):not(input):not(select):not(textarea):not(mark):not(code):not(pre):not(ins):not(button):not(a):not(video):not(canvas):not(progress):not(iframe):not(svg):not(path):not(.mejs-iframe-overlay):not(.mejs-iframe-overlay):not(.elementor-element-overlay):not(.elementor-background-overlay):not(i):not(button *):not(a *) { background-color: var(--drdt-color-bg) !important; color: var(--drdt-color-body); border-color: var(--drdt-color-border) !important; box-shadow: none !important; } html.drdt-dark-mode > body h1:not(.drdt-ignore-dark), html.drdt-dark-mode > body h2:not(.drdt-ignore-dark), html.drdt-dark-mode > body h3:not(.drdt-ignore-dark), html.drdt-dark-mode > body h4:not(.drdt-ignore-dark), html.drdt-dark-mode > body h5:not(.drdt-ignore-dark), html.drdt-dark-mode > body h6:not(.drdt-ignore-dark){color: var(--drdt-color-head) !important; } html.drdt-dark-mode a:not(.drdt-ignore-dark), html.drdt-dark-mode a *:not(.drdt-ignore-dark), html.drdt-dark-mode a:active:not(.drdt-ignore-dark), html.drdt-dark-mode a:active *:not(.drdt-ignore-dark), html.drdt-dark-mode a:visited:not(.drdt-ignore-dark), html.drdt-dark-mode a:visited *:not(.drdt-ignore-dark) { background: transparent !important; background-color: transparent !important; color: var(--drdt-color-link) !important; border-color: var(--drdt-color-border) !important; box-shadow: none; } html.drdt-dark-mode > body a:hover:not(.drdt-ignore-dark), html.drdt-dark-mode > body a *:hover:not(.drdt-ignore-dark){color: var(--drdt-color-head) !important; } html.drdt-dark-mode input:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=button]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=checkebox]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=date]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=datetime-local]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=email]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=image]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=month]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=number]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=range]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=reset]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=search]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=submit]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=tel]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=text]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=time]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=url]:not(.drdt-ignore-dark), html.drdt-dark-mode input[type=week]:not(.drdt-ignore-dark), html.drdt-dark-mode button:not(.drdt-ignore-dark), html.drdt-dark-mode iframe:not(.drdt-ignore-dark), html.drdt-dark-mode iframe *:not(.drdt-ignore-dark), html.drdt-dark-mode select:not(.drdt-ignore-dark), html.drdt-dark-mode textarea:not(.drdt-ignore-dark), html.drdt-dark-mode i:not(.drdt-ignore-dark) { background: var(--drdt-color-btn) !important; background-color: var(--drdt-color-btn) !important; color: var(--drdt-color-head) !important; border-color: var(--drdt-color-border) !important; box-shadow: none !important;}/*@media (prefers-color-scheme: dark) {			html :not(.drdt-ignore-dark):not(input):not(textarea):not(button):not(select):not(mark):not(code):not(pre):not(ins):not(option):not(img):not(progress):not(iframe):not(.mejs-iframe-overlay):not(svg):not(video):not(canvas):not(a):not(path):not(.elementor-element-overlay):not(.elementor-background-overlay):not(i):not(button *):not(a *) {background-color: var(--drdt-color-bg) !important;color: var(--drdt-color-body);border-color: var(--drdt-color-border) !important;box-shadow: none !important;			}		}*/html.drdt-dark-mode .drdt-ignore-dark-back{background: transparent !important;background-color: transparent !important;}
</style>
<link rel='stylesheet' id='oceanly-fonts-css' href='https://www.0x01team.com/wp-content/fonts/ab5942726b7b8f814058631cfcd8b10b.css' media='all' />
<link rel='stylesheet' id='oceanly-style-css' href='https://www.0x01team.com/wp-content/themes/oceanly/style.min.css?ver=1.7.5' media='all' />
<style id='oceanly-style-inline-css'>
.site-hero-header{background-color:#808080;}
</style>
<script src='https://www.0x01team.com/wp-includes/js/jquery/jquery.min.js?ver=3.6.4' id='jquery-core-js'></script>
<script src='https://www.0x01team.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.0' id='jquery-migrate-js'></script>
<link rel="https://api.w.org/" href="https://www.0x01team.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.0x01team.com/wp-json/wp/v2/posts/181" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.0x01team.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.0x01team.com/wp-includes/wlwmanifest.xml" />
<meta name="generator" content="WordPress 6.2.6" />
<link rel="canonical" href="https://www.0x01team.com/hw_security/bypassing-microchip-atmel-sam-e70-s70-v70-v71-security/" />
<link rel='shortlink' href='https://www.0x01team.com/?p=181' />
<link rel="alternate" type="application/json+oembed" href="https://www.0x01team.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.0x01team.com%2Fhw_security%2Fbypassing-microchip-atmel-sam-e70-s70-v70-v71-security%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.0x01team.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.0x01team.com%2Fhw_security%2Fbypassing-microchip-atmel-sam-e70-s70-v70-v71-security%2F&#038;format=xml" />
<link rel="icon" href="https://www.0x01team.com/wp-content/uploads/2023/05/cropped-cropped-industries_electronics_header_interior_desktop-jpg-e1685343313338-32x32.jpg" sizes="32x32" />
<link rel="icon" href="https://www.0x01team.com/wp-content/uploads/2023/05/cropped-cropped-industries_electronics_header_interior_desktop-jpg-e1685343313338-192x192.jpg" sizes="192x192" />
<link rel="apple-touch-icon" href="https://www.0x01team.com/wp-content/uploads/2023/05/cropped-cropped-industries_electronics_header_interior_desktop-jpg-e1685343313338-180x180.jpg" />
<meta name="msapplication-TileImage" content="https://www.0x01team.com/wp-content/uploads/2023/05/cropped-cropped-industries_electronics_header_interior_desktop-jpg-e1685343313338-270x270.jpg" />
</head>
<body class="post-template-default single single-post postid-181 single-format-standard wp-embed-responsive no-sidebar left-sidebar post-thumbnail-hover-effect">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-dark-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 0.49803921568627" /><feFuncG type="table" tableValues="0 0.49803921568627" /><feFuncB type="table" tableValues="0 0.49803921568627" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 1" /><feFuncG type="table" tableValues="0 1" /><feFuncB type="table" tableValues="0 1" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-purple-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.54901960784314 0.98823529411765" /><feFuncG type="table" tableValues="0 1" /><feFuncB type="table" tableValues="0.71764705882353 0.25490196078431" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-blue-red"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 1" /><feFuncG type="table" tableValues="0 0.27843137254902" /><feFuncB type="table" tableValues="0.5921568627451 0.27843137254902" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-midnight"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 0" /><feFuncG type="table" tableValues="0 0.64705882352941" /><feFuncB type="table" tableValues="0 1" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-magenta-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.78039215686275 1" /><feFuncG type="table" tableValues="0 0.94901960784314" /><feFuncB type="table" tableValues="0.35294117647059 0.47058823529412" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-purple-green"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.65098039215686 0.40392156862745" /><feFuncG type="table" tableValues="0 1" /><feFuncB type="table" tableValues="0.44705882352941 0.4" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-blue-orange"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.098039215686275 1" /><feFuncG type="table" tableValues="0 0.66274509803922" /><feFuncB type="table" tableValues="0.84705882352941 0.41960784313725" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg>
<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header u-b-margin">
		
<div class="site-header-branding">
	<div class="site-branding-wrap c-wrap">

		<div class="site-branding site-branding--sm-center site-branding--md-center site-branding--sm-logo-top site-branding--md-logo-left site-branding--sm-logo-size-xs site-branding--md-logo-size-xs site-branding--lg-logo-size-md">
						<div class="site-title-desc-wrap">
										<p class="site-title site-title--sm-size-md site-title--md-size-lg"><a href="https://www.0x01team.com/" rel="home">0x01 Team blog</a></p>
											<p class="site-description site-desc--sm-size-md site-desc--md-size-md"></p>
								</div><!-- .site-title-desc-wrap -->
						</div><!-- .site-branding -->

	</div><!-- .site-branding-wrap -->
</div><!-- .site-header-branding -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">

	<div class="content-sidebar-wrap c-wrap">
		<main id="primary" class="site-main">

		
<article id="post-181" class="singular-content-wrap single-content-wrap post-181 post type-post status-publish format-standard hentry category-hw_security">
	
	<div class="content-wrap">
		
<header class="entry-header">
    <h1 class="entry-title">Bypassing Microchip Atmel SAM E70/S70/V70/V71 Security</h1>        <div class="entry-meta">
            		<span class="posted-on">
			<svg class="svg-icon" width="24" height="24" aria-hidden="true" role="img" focusable="false" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M192 1664h288v-288h-288v288zm352 0h320v-288h-320v288zm-352-352h288v-320h-288v320zm352 0h320v-320h-320v320zm-352-384h288v-288h-288v288zm736 736h320v-288h-320v288zm-384-736h320v-288h-320v288zm768 736h288v-288h-288v288zm-384-352h320v-320h-320v320zm-352-864v-288q0-13-9.5-22.5t-22.5-9.5h-64q-13 0-22.5 9.5t-9.5 22.5v288q0 13 9.5 22.5t22.5 9.5h64q13 0 22.5-9.5t9.5-22.5zm736 864h288v-320h-288v320zm-384-384h320v-288h-320v288zm384 0h288v-288h-288v288zm32-480v-288q0-13-9.5-22.5t-22.5-9.5h-64q-13 0-22.5 9.5t-9.5 22.5v288q0 13 9.5 22.5t22.5 9.5h64q13 0 22.5-9.5t9.5-22.5zm384-64v1280q0 52-38 90t-90 38h-1408q-52 0-90-38t-38-90v-1280q0-52 38-90t90-38h128v-96q0-66 47-113t113-47h64q66 0 113 47t47 113v96h384v-96q0-66 47-113t113-47h64q66 0 113 47t47 113v96h128q52 0 90 38t38 90z"></path></svg>			<a href="https://www.0x01team.com/hw_security/bypassing-microchip-atmel-sam-e70-s70-v70-v71-security/" rel="bookmark">
				<span class="screen-reader-text">Posted on </span><time class="entry-date published" datetime="2024-05-16T09:42:01+00:00">May 16, 2024</time><time class="updated" datetime="2024-06-11T21:12:07+00:00">June 11, 2024</time>			</a>
		</span>
		<a href="https://www.0x01team.com/author/admin/" title="Posts by Waleed" class="author url fn" rel="author">Waleed</a>, <a href="https://www.0x01team.com/author/b4/" title="Posts by B4" class="author url fn" rel="author">B4</a> and <a href="https://www.0x01team.com/author/meshari/" title="Posts by Meshari" class="author url fn" rel="author">Meshari</a>        </div><!-- .entry-meta -->
        </header><!-- .entry-header -->			<span class="cat-links">
				<svg class="svg-icon" width="24" height="24" aria-hidden="true" role="img" focusable="false" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M384 448q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm1067 576q0 53-37 90l-491 492q-39 37-91 37-53 0-90-37l-715-716q-38-37-64.5-101t-26.5-117v-416q0-52 38-90t90-38h416q53 0 117 26.5t102 64.5l715 714q37 39 37 91zm384 0q0 53-37 90l-491 492q-39 37-91 37-36 0-59-14t-53-45l470-470q37-37 37-90 0-52-37-91l-715-714q-38-38-102-64.5t-117-26.5h224q53 0 117 26.5t102 64.5l715 714q37 39 37 91z"></path></svg><a href="https://www.0x01team.com/category/hw_security/" rel="category tag">HW_Security</a>			</span>
			
<div class="entry-content">
	
<h2 class="wp-block-heading">Introduction </h2>



<p>In this writeup we will introduce our finding of a vulnerability in Microchip Atmel SAM microcontrollers family [<a href="https://www.cve.org/cverecord?id=CVE-2024-4760" data-type="URL" data-id="https://www.cve.org/cverecord?id=CVE-2024-4760">CVE-2024-4760</a>] to bypass the security bit. To all who is new to the Atmel SAM E70/S70/V70/V71 family, we will briefly talk about this family and it&#8217;s capabilities and then move on to it security mechanism. Following we will dive to the power analysis of the controller and exploring the possible vulnerability. After that we will show how we can take advantage of the vulnerability and have a successful <strong>voltage fault injection</strong> <strong>(glitch)</strong> to bypass the security mechanism and have full control of the microcontroller.</p>



<p></p>



<h2 class="wp-block-heading">What is Atmel SAM E70/S70/V70/V71?</h2>



<p class="has-text-align-left">Microchip Atmel has a variety of microcontrollers and our focus in this writeup will be on the SAM E70/S70/V70/V71 family. This family consist of 32-bit Arm Cortex-M7 and could run up to 300 MHz, also has an embedded Flash of 2048 Kbytes, and a 384 Kbytes SRAM which is pretty powerful in the microcontrollers world. More to this family it has AES key algorithm, compliant with FIPS PUB-197 specifications, True Random Number Generator (TRNG), Integrity Check Monitor (ICM) supports secure hash algorithm SHA1, SHA224 and SHA256, Unique Identifier, and user signature of 512 bytes. Due to its high performance and different peripherals (as shown below) it is used in audio, video, USB, and even drones products. Let&#8217;s move on to how you can make this microcontroller secure.</p>



<figure class="wp-block-image size-large"><img decoding="async" width="1024" height="611" src="https://www.0x01team.com/wp-content/uploads/2024/05/image-1024x611.png" alt="" class="wp-image-186" srcset="https://www.0x01team.com/wp-content/uploads/2024/05/image-1024x611.png 1024w, https://www.0x01team.com/wp-content/uploads/2024/05/image-300x179.png 300w, https://www.0x01team.com/wp-content/uploads/2024/05/image-768x458.png 768w, https://www.0x01team.com/wp-content/uploads/2024/05/image-1536x916.png 1536w, https://www.0x01team.com/wp-content/uploads/2024/05/image-2048x1221.png 2048w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption class="wp-element-caption">SAM S70 144-pin Block Diagram</figcaption></figure>



<p></p>



<h2 class="wp-block-heading">Atmel SAM E70/S70/V70/V7 Security Mechanism</h2>



<p>After programming the firmware (the code), usually the product owner needs to secure it from reverse engineering, implementing a backdoor, or any misuse of the controller. The Atmel SAM E70/S70/V70/V71 family has security feature called the security bit. <strong>When the security bit is enabled, any access to the firmware, SRAM, core registers and internal peripherals is blocked. This ensures the confidentiality of the code programmed. </strong></p>



<p>The security bit is stored internally in the Enhanced Embedded Flash Controller (EEFC) which is a controller inside a the SAM controller that:</p>



<blockquote class="wp-block-quote">
<p>manages the programming, erasing, locking and unlocking sequences of the Flash using a full set of commands.</p>
<cite>Section 22.1 in SAM E70/S70/V70/V71 Family Data Sheet</cite></blockquote>



<p>By sending the Flash controller command within the code, or by connecting the SAM through The&nbsp;<em>Atmel</em>&nbsp;Embedded Debugger (<em>EDBG</em>) or JTAG/SWD both are which used for programming and debugging the SAM , then using Microchip Studio IDE Tools -&gt; Device Programming -&gt; Security -&gt; Set (as shown in the figure below) the security bit will be enabled and access to the code or other peripherals will be denied.</p>



<figure class="wp-block-image size-full"><img decoding="async" loading="lazy" width="933" height="710" src="https://www.0x01team.com/wp-content/uploads/2024/05/set_security.png" alt="" class="wp-image-191" srcset="https://www.0x01team.com/wp-content/uploads/2024/05/set_security.png 933w, https://www.0x01team.com/wp-content/uploads/2024/05/set_security-300x228.png 300w, https://www.0x01team.com/wp-content/uploads/2024/05/set_security-768x584.png 768w" sizes="(max-width: 933px) 100vw, 933px" /><figcaption class="wp-element-caption">Microchip Studio IDE Programming tool</figcaption></figure>



<p>The only way to disable the security bit is by <strong>erasing all</strong> the contents of the flash, by either sending a Chip erase command inside your firmware or physically connecting the erase pin to high. <strong>That means the firmware code and everything will be erased. </strong></p>



<p>Usually any change within the microcontroller will make a difference in it&#8217;s power. In the next section we will observe the changes.</p>



<p></p>



<h2 class="wp-block-heading">What Changed In The Power?</h2>



<p>We know for a fact that we changed the flash controller settings by enabling the security bit. So, we will observe the power consumption with and without security bit is enabled and see the difference. To do so, we used SAM E70 Xplained Ultra board. The Xplained Ultra board has a header for pins called VDDCORE (shown below), this VDDCORE pins are the power entering to the CORE controller only, using these pins will eliminate all other power that are not related to the core, such as the peripherals, clocks, … etc.</p>



<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="815" height="1024" src="https://www.0x01team.com/wp-content/uploads/2024/05/VDDCore2-815x1024.png" alt="" class="wp-image-203" srcset="https://www.0x01team.com/wp-content/uploads/2024/05/VDDCore2-815x1024.png 815w, https://www.0x01team.com/wp-content/uploads/2024/05/VDDCore2-239x300.png 239w, https://www.0x01team.com/wp-content/uploads/2024/05/VDDCore2-768x965.png 768w, https://www.0x01team.com/wp-content/uploads/2024/05/VDDCore2.png 1085w" sizes="(max-width: 815px) 100vw, 815px" /><figcaption class="wp-element-caption">Microchip Atmel SAM E70 Xplained Ultra board</figcaption></figure>



<p>From the J401 the headers you could add a low value resistor and see the drop voltage, or use one of the current probes (we used <a href="https://www.riscure.com/products/current-probe/" data-type="URL" data-id="https://www.riscure.com/products/current-probe/">Riscure </a><a href="https://www.riscure.com/products/current-probe/" data-type="URL" data-id="https://www.riscure.com/products/current-probe/" target="_blank" rel="noreferrer noopener">Current </a><a href="https://www.riscure.com/products/current-probe/" data-type="URL" data-id="https://www.riscure.com/products/current-probe/">Probe</a>).</p>



<figure class="wp-block-image size-full"><img decoding="async" loading="lazy" width="974" height="452" src="https://www.0x01team.com/wp-content/uploads/2024/05/VDDCore.png" alt="" class="wp-image-207" srcset="https://www.0x01team.com/wp-content/uploads/2024/05/VDDCore.png 974w, https://www.0x01team.com/wp-content/uploads/2024/05/VDDCore-300x139.png 300w, https://www.0x01team.com/wp-content/uploads/2024/05/VDDCore-768x356.png 768w" sizes="(max-width: 974px) 100vw, 974px" /><figcaption class="wp-element-caption">SAM E70 Xplained Ultra Evaluation User&#8217;s Guide Schematics</figcaption></figure>



<p>Also it is recommended to remove the De-Coupling capacitors that are connected to the VDDCORE (as shown above). After connecting the current probe to the headers, then we connect the current probe to the Oscilloscope channel (In our case Channel B), and we need another channel from the oscilloscope for triggering (In our case Channel A) connected to the 3.3v on the SAM board, we will explain why connecting the trigger to the 3.3v next.</p>



<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="1024" height="558" src="https://www.0x01team.com/wp-content/uploads/2024/05/VDDCore3-1024x558.png" alt="" class="wp-image-213" srcset="https://www.0x01team.com/wp-content/uploads/2024/05/VDDCore3-1024x558.png 1024w, https://www.0x01team.com/wp-content/uploads/2024/05/VDDCore3-300x163.png 300w, https://www.0x01team.com/wp-content/uploads/2024/05/VDDCore3-768x418.png 768w, https://www.0x01team.com/wp-content/uploads/2024/05/VDDCore3-1536x837.png 1536w, https://www.0x01team.com/wp-content/uploads/2024/05/VDDCore3-2048x1116.png 2048w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption class="wp-element-caption">Section 58.1 Electrical Characteristics for SAM E70/S70 in the Family Data Sheet</figcaption></figure>



<p>In the electrical characteristics for SAM E70 figure above shows that the reset will be held for 240-800us long, and as known in most microcontrollers, after releasing the Reset the code will run. Therefore, the security bit should be loaded before running the code. It is always a good idea to read the booting process and the timing of releasing the Reset to know exactly when the code will start to run. More into the booting process in part 2 of this series. </p>



<p>After setting the setup we start to capture the Power-On of the SAM E70, which is the startup shown below</p>



<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="1024" height="845" src="https://www.0x01team.com/wp-content/uploads/2024/05/2-1024x845.png" alt="" class="wp-image-217" srcset="https://www.0x01team.com/wp-content/uploads/2024/05/2-1024x845.png 1024w, https://www.0x01team.com/wp-content/uploads/2024/05/2-300x248.png 300w, https://www.0x01team.com/wp-content/uploads/2024/05/2-768x634.png 768w, https://www.0x01team.com/wp-content/uploads/2024/05/2-1536x1268.png 1536w, https://www.0x01team.com/wp-content/uploads/2024/05/2-2048x1691.png 2048w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption class="wp-element-caption">SAM E70 Startup (Power-On) trace</figcaption></figure>



<p>The <mark style="background-color:rgba(0, 0, 0, 0)" class="has-inline-color has-vivid-cyan-blue-color">blue trace</mark> is the trigger on the SAM 3.3v, the <mark style="background-color:rgba(0, 0, 0, 0)" class="has-inline-color has-vivid-red-color">red trace</mark> is power of the VDDCORE. As we can see the first spikes on the VDDCORE are related to powering up the core, and after ~400us we have another spike which we think is related to the flash controller (EEFC) which where the security bit configured.</p>



<p>The plan is to capture the same traces 25 times then average them while the security bit is disabled, then do it all again while the security bit is enabled. Recapture and average the traces will help us eliminate the jitters. </p>



<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="1024" height="651" src="https://www.0x01team.com/wp-content/uploads/2024/05/SAM_p1-1-1024x651.png" alt="" class="wp-image-223" srcset="https://www.0x01team.com/wp-content/uploads/2024/05/SAM_p1-1-1024x651.png 1024w, https://www.0x01team.com/wp-content/uploads/2024/05/SAM_p1-1-300x191.png 300w, https://www.0x01team.com/wp-content/uploads/2024/05/SAM_p1-1-768x489.png 768w, https://www.0x01team.com/wp-content/uploads/2024/05/SAM_p1-1-1536x977.png 1536w, https://www.0x01team.com/wp-content/uploads/2024/05/SAM_p1-1-2048x1303.png 2048w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption class="wp-element-caption">SAM E70 open vs closed traces</figcaption></figure>



<p>Here we can see that the <mark style="background-color:rgba(0, 0, 0, 0)" class="has-inline-color has-vivid-cyan-blue-color">blue trace</mark> is the trigger of the SAM 3.3v, the <mark style="background-color:rgba(0, 0, 0, 0)" class="has-inline-color has-luminous-vivid-amber-color">yellow trace</mark> is an average of 25 traces while the SAM is <strong>security bit</strong> <strong>enabled</strong>, also it&#8217;s vertically shifted. The <mark style="background-color:rgba(0, 0, 0, 0)" class="has-inline-color has-vivid-red-color">red trace</mark> is an average of 25 traces while the SAM is <strong>security bit disabled</strong>. Now let&#8217;s see if we lay the traces on each other and see if there is a difference. </p>



<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="1024" height="757" src="https://www.0x01team.com/wp-content/uploads/2024/05/SAM_p22-1-1024x757.png" alt="" class="wp-image-228" srcset="https://www.0x01team.com/wp-content/uploads/2024/05/SAM_p22-1-1024x757.png 1024w, https://www.0x01team.com/wp-content/uploads/2024/05/SAM_p22-1-300x222.png 300w, https://www.0x01team.com/wp-content/uploads/2024/05/SAM_p22-1-768x568.png 768w, https://www.0x01team.com/wp-content/uploads/2024/05/SAM_p22-1-1536x1136.png 1536w, https://www.0x01team.com/wp-content/uploads/2024/05/SAM_p22-1-2048x1515.png 2048w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>



<p>Remember we are focusing on the second spike as shown above highlighted with blue rectangle. And yes indeed there is a difference between the security bit enabled and disabled traces. Therefor, we know where is the security bit is affecting, and from that we will move to the next section.</p>



<p></p>



<p>   </p>



<h2 class="wp-block-heading">Taking Advantage From Power Analysis (The Attack) </h2>



<p>The goal is to bypass the security bit and take full control of the SAM, to do that we will try and corrupt the area where the security bit is effecting. We will perform a voltage fault injection using <a href="https://www.newae.com/chipwhisperer" data-type="URL" data-id="https://www.newae.com/chipwhisperer" target="_blank" rel="noreferrer noopener">Chipwhisperer</a>, which is a tool capable of preforming side channel and fault injection attacks. </p>



<figure class="wp-block-image size-full"><img decoding="async" loading="lazy" width="720" height="402" src="https://www.0x01team.com/wp-content/uploads/2024/05/setup_diagram.png" alt="" class="wp-image-239" srcset="https://www.0x01team.com/wp-content/uploads/2024/05/setup_diagram.png 720w, https://www.0x01team.com/wp-content/uploads/2024/05/setup_diagram-300x168.png 300w" sizes="(max-width: 720px) 100vw, 720px" /><figcaption class="wp-element-caption">Setup diagram [Between the brackets means the SAME70 pin]</figcaption></figure>



<p>From the diagram above:</p>



<ul>
<li>PC: To run the exploit code and observe the power analysis.</li>



<li><a href="https://www.rohde-schwarz.com/us/products/test-and-measurement/dc-power-supplies/rs-hmc804x-dc-power-supply-series_63493-61542.html" data-type="URL" data-id="https://www.rohde-schwarz.com/us/products/test-and-measurement/dc-power-supplies/rs-hmc804x-dc-power-supply-series_63493-61542.html" target="_blank" rel="noreferrer noopener">Power Supply (HMC 8042)</a>: Where it will Power On/Off the SAM board.</li>



<li><a href="https://www.segger.com/products/debug-probes/j-link/" data-type="URL" data-id="https://www.segger.com/products/debug-probes/j-link/" target="_blank" rel="noreferrer noopener">JLink</a>: A debug tool to check whither we have access to the SAM or not.</li>



<li><a href="https://www.picotech.com/products/oscilloscope" data-type="URL" data-id="https://www.picotech.com/products/oscilloscope" target="_blank" rel="noreferrer noopener">PicoScope</a>: The oscilloscope.</li>



<li><a href="https://www.newae.com/chipwhisperer" data-type="URL" data-id="https://www.newae.com/chipwhisperer" target="_blank" rel="noreferrer noopener">Chipwhisperer (CW)</a>: The tool to preform the voltage fault injection. </li>
</ul>



<p>The attack could be done without the oscilloscope. However, it always nice to see the glitches ⚡.</p>



<p>Then we wrote the code as follows:</p>



<ol>
<li>Configure the Power supply, JLink, and CW</li>



<li>Write a function to check the debug port of the SAM from JLink </li>



<li>Enter the Offset, which is a variable needed from the CW and it is the time to wait after the trigger to glitch.</li>



<li>The Repeat is a range from (140-200), which is also a variable needed from the CW and it is the duration of the glitch.</li>



<li>Power Off the SAM from the power supply.</li>



<li>Arm the CW (Be ready for the trigger, which is the 3.3v of the SAM).</li>



<li>Power On the SAM from the power supply.</li>



<li>In this time the glitch will happen, then we check on the debugging port of the SAM if it opened or not.</li>
</ol>



<p>The Offset in our case will be from 80000-90000 (800us-900us) the CW clock configured at 100MHz. The Offset in that range because our trigger is on the 3.3v not the VDDCORE. That&#8217;s another reason to use an oscilloscope while glitching at least in the begging of the setup. </p>



<p>The Repeat is range in our case which is 140 to 200 that is the range that we found is very suitable for the SAM.</p>



<p>The code: <a href="https://github.com/Waleedmz10/Bypassing-Microchip-Atmel-SAM-E70-S70-V70-V71/blob/main/SAME70_glitch_with_Supply_Power_CW.py">https://github.com/Waleedmz10/Bypassing-Microchip-Atmel-SAM-E70-S70-V70-V71/blob/main/SAME70_glitch_with_Supply_Power_CW.py</a></p>



<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="1024" height="809" src="https://www.0x01team.com/wp-content/uploads/2024/05/SAME70_glitch-1024x809.png" alt="" class="wp-image-253" srcset="https://www.0x01team.com/wp-content/uploads/2024/05/SAME70_glitch-1024x809.png 1024w, https://www.0x01team.com/wp-content/uploads/2024/05/SAME70_glitch-300x237.png 300w, https://www.0x01team.com/wp-content/uploads/2024/05/SAME70_glitch-768x607.png 768w, https://www.0x01team.com/wp-content/uploads/2024/05/SAME70_glitch-1536x1214.png 1536w, https://www.0x01team.com/wp-content/uploads/2024/05/SAME70_glitch-2048x1618.png 2048w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption class="wp-element-caption">Trace of the glitch</figcaption></figure>



<p>As we can see above the glitch happened at ~800us and it was a successful glitch!</p>



<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="1024" height="199" src="https://www.0x01team.com/wp-content/uploads/2024/05/SAME70_glitch3-1024x199.png" alt="" class="wp-image-254" srcset="https://www.0x01team.com/wp-content/uploads/2024/05/SAME70_glitch3-1024x199.png 1024w, https://www.0x01team.com/wp-content/uploads/2024/05/SAME70_glitch3-300x58.png 300w, https://www.0x01team.com/wp-content/uploads/2024/05/SAME70_glitch3-768x149.png 768w, https://www.0x01team.com/wp-content/uploads/2024/05/SAME70_glitch3.png 1268w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption class="wp-element-caption">Terminal output </figcaption></figure>



<p>After a successful glitch it showed the debugging core ID (red rectangle) and now the <strong>debugging port is open while the security bit in enabled</strong>. <strong>You could dump the flash, control all the peripherals, access the SRAM, and have full control. </strong></p>



<p></p>



<h2 class="wp-block-heading">Conclusion</h2>



<p>To conclude, Atmel SAM has implemented a security mechanism that can lock the microcontroller and disable any access, preventing against reading the firmware (the code) and reverse engineering it, or have any kind of control. However, by observing the difference between security enabled and disabled power analysis, then injecting a voltage fault on the area of difference taken from the power analysis will lead to bypassing the security mechanism and have full control. This is a serious impact on the product owner intellectual property firmware or keys if implemented. <strong>The vulnerability is on the silicon level of the Atmel SAM E70/S70/V70/V71 family, therefore, it is almost imposable to patch it without hardware redesign.</strong></p>



<p><a href="https://www.0x01team.com/sw_security/same70-emulator/" data-type="URL" data-id="https://www.0x01team.com/sw_security/same70-emulator/"><strong>Part2</strong></a></p>



<h2 class="wp-block-heading">Disclosure</h2>



<p>We contacted Microchip PSIRT in 2024/2/15 and after several emails they were able to see the vulnerability and issued the CVE. Many thanks for the PSIRT team at Microchip for their professional and quick responses!</p>
</div><!-- .entry-content -->
	</div><!-- .content-wrap -->

	</article><!-- #post-181 -->

	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://www.0x01team.com/hw_security/nxp-lpc-family-bypass/" rel="prev"><span class="post-navigation-arrow" aria-hidden="true">&#10094;</span> <span class="post-navigation-title"><span class="screen-reader-text">Previous Post:</span> BYPASS NXP LPC-FAMILY DEBUG CHECK WITH VOLTAGE FAULT INJECTION</span></a></div><div class="nav-next"><a href="https://www.0x01team.com/sw_security/same70-emulator/" rel="next"><span class="post-navigation-title"><span class="screen-reader-text">Next Post:</span> SAME70 Emulator</span> <span class="post-navigation-arrow" aria-hidden="true">&#10095;</span></a></div></div>
	</nav>
		</main><!-- #primary -->

			</div><!-- .content-sidebar-wrap -->

	</div><!-- #content -->

	<footer id="colophon" class="site-footer">
		
<div class="footer-bottom-area">

	<div class="footer-bottom-area-wrap c-wrap">
		
<div class="footer-copyright">

		<p class="copyright-text">
		Copyright &copy; 2025 0x01 Team blog.	</p><!-- .copyright-text -->
	
	<p class="oceanly-credit">
		Theme: Oceanly by <a href="https://scriptstown.com/" itemprop="url">ScriptsTown</a>	</p><!-- .oceanly-credit -->

</div><!-- .footer-copyright -->
	</div><!-- .footer-bottom-area-wrap -->

</div><!-- .footer-bottom-area -->
	</footer>

		<a href="#" class="back-to-top" aria-label="Back to top"></a>
	</div><!-- #page -->

<div class="dark_switch_box box_1 floating-bottom-left">
    <div class="drdt_checkbox switch_1">
        <img src="https://www.0x01team.com/wp-content/plugins/droit-dark-mode/assets/images/front_btn/1.png">
    </div>
</div>
<script id='dtdr-public-js-extra'>
var dtdr_settings = {"ajax_url":"https:\/\/www.0x01team.com\/wp-admin\/admin-ajax.php","mode":"yes","os_based":"no","default":"no","colorset":"dtdr-color-1","excludes":"","includes":"","replace":"[]"};
</script>
<script src='https://www.0x01team.com/wp-content/plugins/droit-dark-mode/assets/scripts/public.min.js?ver=1.0.7' id='dtdr-public-js'></script>
<script src='https://www.0x01team.com/wp-content/themes/oceanly/js/script.min.js?ver=1.7.5' id='oceanly-script-js'></script>
<script src='https://www.0x01team.com/wp-content/themes/oceanly/js/ResizeObserver.min.js?ver=1.5.1' id='resize-observer-polyfill-js'></script>
<script src='https://www.0x01team.com/wp-content/themes/oceanly/js/sticky-sidebar.min.js?ver=1.1.1' id='sticky-sidebar-js'></script>
<script id='sticky-sidebar-js-after'>
try{new StickySidebar(".site-content > .content-sidebar-wrap > .c-sidebar",{topSpacing:100,bottomSpacing:0,containerSelector:".site-content > .content-sidebar-wrap",minWidth:1023});}catch(e){}
</script>
</body>
</html>
