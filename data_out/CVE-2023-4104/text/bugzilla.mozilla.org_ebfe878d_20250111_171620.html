

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1831318)
* [XML](/show_bug.cgi?ctype=xml&id=1831318)

Closed
[Bug 1831318](/show_bug.cgi?id=1831318)
(CVE-2023-4104)

Opened 2 years ago
Closed 1 year ago

# Linux privileged vpndaemon wrongly and incompletely implements Polkit authentication; potential information Leaks

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Linux privileged vpndaemon wrongly and incompletely implements Polkit authentication; potential information Leaks

## Categories

### (Mozilla VPN :: Client for Linux, defect)

[Product:](/describecomponents.cgi?product=Mozilla%20VPN)

Mozilla VPN
▾

Mozilla VPN
Mozilla's full-device VPN available on desktop and mobile operating systems
[See Open Bugs in This Product](/buglist.cgi?product=Mozilla%20VPN&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Mozilla%20VPN)
Watch This Product

[Component:](/describecomponents.cgi?product=Mozilla%20VPN&component=Client%20for%20Linux#Client%20for%20Linux)

Client for Linux
▾

Mozilla VPN :: Client for Linux
Issues related to the Mozilla VPN Linux client
[See Open Bugs in This Component](/buglist.cgi?product=Mozilla%20VPN&component=Client%20for%20Linux&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Mozilla%20VPN&component=Client%20for%20Linux&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Mozilla%20VPN&component=Client%20for%20Linux)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

## Tracking

### (Not tracked)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

## People

### (Reporter: freddy, Assigned: nkirby)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c6d5ce5d439d170fe341f98d825686c7?d=mm&size=40)  [nkirby](/user_profile?user_id=691471)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/dfb8d0427dd67216b2664131a5c31421?d=mm&size=40)  [baku](/user_profile?user_id=446257)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[github.com/mozilla-mobile/mozilla-vpn...](https://github.com/mozilla-mobile/mozilla-vpn-client/pull/7110 "https://github.com/mozilla-mobile/mozilla-vpn-client/pull/7110")

[github.com/mozilla-mobile/mozilla-vpn...](https://github.com/mozilla-mobile/mozilla-vpn-client/pull/7055 "https://github.com/mozilla-mobile/mozilla-vpn-client/pull/7055")

[github.com/mozilla-mobile/mozilla-vpn...](https://github.com/mozilla-mobile/mozilla-vpn-client/pull/7151 "https://github.com/mozilla-mobile/mozilla-vpn-client/pull/7151")

[openwall.com/lists/oss-security/2023/...](https://www.openwall.com/lists/oss-security/2023/08/03/1 "https://www.openwall.com/lists/oss-security/2023/08/03/1")

## Details

### (Whiteboard: [external reporter][suggested disclosure date 2023-08-02 or earlier])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-4104

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[external reporter][suggested disclosure date 2023-08-02 or earlier]

Change Request:

---

Bug Flags:

|  | sec-bounty | ? |
| --- | --- | --- |
|  | sec-bounty-hof |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 1 obsolete file)

| [advsiory.txt](/attachment.cgi?id=9350604)  [1 year ago](#c19)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   350 bytes, text/plain |  | [Details](/attachment.cgi?id=9350604&action=edit) |
| --- | --- | --- |
| [advsiory.txt](/attachment.cgi?id=9350789)  [1 year ago](#c20)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   352 bytes, text/plain |  | [Details](/attachment.cgi?id=9350789&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1831318#c0)• 2 years ago |
|  | |

> Hello Mozilla security,
>
> I am a member of the SUSE security team. An openSUSE user wants to
>
> package Mozilla VPN for openSUSE Tumbleweed. For this a review of the
>
> D-Bus service and Polkit authentication contained in Mozilla VPN is
>
> required.
>
> A colleague and I reviewed the Mozilla VPN codebase for release 2.14.1
>
> and we believe to have found local security issues in the D-Bus daemon
>
> implementation. Please find the details below.
>
> # Coordinated Disclosure Process
>
> The SUSE security team offers coordinated disclosure according to the
>
> openSUSE disclosure policy [1](https://en.opensuse.org/openSUSE%3ASecurity_disclosure_policy). We can keep the issue(s) private for up
>
> to 90 days, but recommend shorter embargo periods of 14 days. As of
>
> today the latest publication date will be 2023-08-02.
>
> Please inform us whether you can confirm the security issues in this
>
> report, whether you want to follow coordinated disclosure and what your
>
> desired publication date is. The alternative to coorindated disclosure
>
> is to make the issues public right away.
>
> # Broken Polkit Authentication Check
>
> The code for the privileged component in Mozilla VPN on Linux is mostly
>
> found in mozillavpn-2.14.1/src/apps/vpn/platforms/linux. The D-Bus
>
> method callbacks are found in
>
> ```
> src/apps/vpn/platforms/linux/daemon/dbusservice.cpp.
>
> ```
>
> Mozilla VPN ships a Polkit policy with the following content:
>
> ```
>  <action id="org.mozilla.vpn.activate">
>     <description>Activate the Mozilla VPN</description>
>     <message>Activate the Mozilla VPN</message>
>     <defaults>
>       <allow_inactive>no</allow_inactive>
>       <allow_active>auth_admin</allow_active>
>     </defaults>
>   </action>
>
>   <action id="org.mozilla.vpn.deactivate">
>     <description>Deactivate the Mozilla VPN</description>
>     <message>Deactivate the Mozilla VPN</message>
>     <defaults>
>       <allow_inactive>no</allow_inactive>
>       <allow_active>auth_admin</allow_active>
>     </defaults>
>   </action>
>
> ```
>
> Of these two privileged actions, the polkit authorization check is only
>
> performed in the `activate` D-Bus method, while no such check is present
>
> at all in the `deactive` method.
>
> For the activate D-Bus method the Polkit check is implemented in
>
> PolkitHelper::checkAuthorization() in
>
> src/apps/vpn/platforms/linux/daemon/polkithelper.cpp line 58:
>
> ```
> h.m_subject = polkit_unix_process_new_for_owner(getpid(), 0, -1);
>
> ```
>
> The UNIX process Polkit subject is deprecated and shouldn't be used
>
> anymore, because it is by design affected by race conditions. Instead
>
> the D-Bus sender subject should be used, which is based on the UNIX
>
> domain socket used by D-Bus to identify the credentials of the client
>
> via the Linux kernel.
>
> Even worse, the UNIX process polkit subject is initialized here using
>
> `getpid()` as the process ID and `-1` for the user ID, The latter asks
>
> Polkit to determine the given PID's user ID by looking into /proc.
>
> Basically this asks Polkit to check whether the *privileged* Mozilla VPN
>
> D-Bus service *itself* is authorized to perform the action. Since The
>
> Mozilla VPN D-Bus service runs as root, this will always be true.
>
> This can be verified from the command line using a minimal pseudo
>
> configuration like this:
>
> ```
> nobody$ gdbus call -y -d org.mozilla.vpn.dbus -o / -m org.mozilla.vpn.dbus.activate \
>     '{"privateKey": "stuff", "serverPublicKey": "stuff", "serverPort": 1234, "deviceIpv4Address": "127.0.0.2", "serverIpv4AddrIn": "127.0.0.3", "allowedIPAddressRanges": []}'
>
> ```
>
> This D-Bus call will work without any authentication, even if a fully
>
> unprivileged user account like `nobody` runs it.
>
> The impact is that arbitrary local users can configure arbitrary VPN
>
> setups using Mozilla VPN and thus possibly redirect network traffic to
>
> malicious parties, pretend that a secure VPN is present while it
>
> actually isn't, perform a DoS against an existing VPN connection or
>
> other integrity violations.
>
> Since the linux daemon does not perform any file system operations or
>
> otherwise dangerous operations besides of the network setup I don't see
>
> a possibility to escalate privileges using this attack vector.
>
> # Missing Polkit Authentication Checks
>
> Apart from the fact that the existing Polkit authentication check is
>
> wrong, there isn't even an attempt to secure any of the other D-Bus
>
> methods offered by the Mozilla VPN D-Bus service.
>
> For the following methods Polkit authorization checks should be
>
> considered, or their scope should be limited by other means:
>
> * getLogs(): returns potentially problematic world-readable log data, even
>
>   debug logs, e.g. also about other users' activities in the system. The
>
>   same data is publically available in /var/log/mozillavpn.txt. These
>
>   logs allow tracking of what applications other users start, for
>
>   example.
>
>   Log data of system services should generally not be world readable, so
>
>   this item refers to both, the D-Bus API and the logfile in /var/log.
>
>   This is an information leak (especially since there is also debug data
>
>   found here) that might facilitate other security issues or might allow
>
>   other users in the system to deduce what a Mozilla VPN user is doing.
> * cleanupLogs(): allows everybody to clear the current logs. This should
>
>   be restricted to authorized users, otherwise it might be used to clear
>
>   traces of attacks etc.
> * runningApps(): this leaks information from other users'
>
>   sessions and their apps to everybody in the system. Most of this data
>
>   is probably also available via `ps` or /proc, respectively. Some
>
>   hardened systems may not allow this, though. A solution might be to
>
>   only return data here that belongs to the user making the request on
>
>   D-Bus.
> * firewallApp(): allows to put arbitrary appIDs into split tunneling /
>
>   exclude, even for other users. This should be restricted to
>
>   applications of the requesting D-Bus user.
> * firewallClear(): clears the exclude list. should also be restricted to
>
>   entries affecting the calling user.
> * deactivate(): everybody may shutdown the whole VPN. There is a
>
>   deactivate() Polkit action declared but is is never used.
>
> From looking at the D-Bus implementation it is apparent that Mozilla VPN
>
> on Linux doesn't really have a proper multi user concept. A simple way
>
> out of this may be to store the UID of the user that successfully
>
> authenticates during activate() and then only allow the other D-Bus
>
> methods for the same user until deactivate() is called. Mixing
>
> different user contexts would be avoided this way.
>
> # Privilege Drop Considerations
>
> As far as I see the Mozilla VPN linux daemon only uses its higher
>
> privileges for two things:
>
> * setting up the network
> * monitoring user sessions and attaching to their D-Bus session busses
>
>   to keep track of running applications ("AppTracker" class).
>
> It could be considered running this service not as root but only with
>
> the CAP\_NET\_ADMIN capability. This would limit the potential attack
>
> surface considerably. I'm not sure how well this idea plays with the
>
> monitoring aspects, but it is a direction that could be investigated to
>
> harden this D-Bus service. Also dropping privileged to an unauthorized
>
> user and only raising them on a case-by-case basic e.g. when connecting
>
> to other users' session busses might be a way to go.
>
> # CVE assignments
>
> The invalid Polkit Authentication check and the unauthenticated
>
> decativate() D-Bus method deserve CVE assignments. Please inform us
>
> whether you will assign CVEs on your end. I understand that you are a
>
> CVE CNA so this would fall into your responsibility.
>
> The other missing authentication checks and possible information leaks
>
> are a bit of a gray area and will not necessarily need CVEs from my
>
> point of view.
>
> Cheers
>
> Matthias

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1831318#c1)• 2 years ago |
|  | |

While the team is developing a plan and gathering the necessary patches to address these issues, let me answer the last question about CVE assignments: Yes, Mozilla is a a CNA and we generally issue CVE IDs once a bug has been resolved (in order to make sure that we fully appreciate the issue when we submit this).

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1831318#a68622_428608)• 2 years ago |

Whiteboard: [external reporter] → [external reporter][suggested disclosure date 2023-08-02 or earlier]

|  | [matthias.gerstner](/user_profile?user_id=726784) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1831318#c2)• 2 years ago |
|  | |

Can you meanwhile confirm the outlined security problems?

It seems you want to follow coordinated disclosure. Do you have a desired publication date yet?

|  | [matthias.gerstner](/user_profile?user_id=726784) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1831318#c3)• 2 years ago |
|  | |

We are still missing any formal recognition of the report and any details about the disclosure process. Please provide that.

If there is no progress in communicating these details then we will consider disclosing the report to the public in 14 days on 2023-06-14.

|  | [Naomi Kirby](/user_profile?user_id=691471)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1831318#c4)• 2 years ago |
|  | |

We are are beginning to look into this issue, and we are hoping to have a mitigation in place for the 2.16 release. I do not yet have a date on when this release will happen.

My initial thoughts are that we should be able to eliminate the use of polkit entirely and the network interface management should be feasible with only the CAP\_NET\_ADMIN permission. I am unsure on the best approach for dealing with the AppTracker and whether we can continue to support split tunnelling if we drop root permissions in the daemon, but I agree that some additional hardening is a good idea for this component.

|  | [matthias.gerstner](/user_profile?user_id=726784) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1831318#c5)• 2 years ago |
|  | |

Thanks for the update. Please bear in mind that our maximum embargo period according to our disclosure policy is until 2023-08-02.

|  | [Lesley Norton [:lnorton]](/user_profile?user_id=618576) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1831318#a2423954_618576)• 2 years ago |

Assignee: nobody → nkirby

|  | [Lesley Norton [:lnorton]](/user_profile?user_id=618576) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1831318#a2423966_618576)• 2 years ago |

Status: NEW → ASSIGNED

|  | [matthias.gerstner](/user_profile?user_id=726784) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1831318#c6)• 2 years ago |
|  | |

I'm sorry to tell you that our community packager, that triggered the review of this component, and thus shared the knowledge about this issue, just violated the embargo by creating this public pull request:

<https://github.com/mozilla-mobile/mozilla-vpn-client/pull/7151>

Maybe you can try to remove this information for GitHub again (is this even possible?). Otherwise I don't really know how to continue from here. The PR# is no full information leak but it's still not ideal.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1831318#c7)• 2 years ago |
|  | |

While the cat is out of the bag, we should discuss our options. If this was a simple patch, we should probably just take it.

Given this is a non-trivial patch, we're going to take some time to review and decide.

I've nudged the development team to see if they can give this priority, but further information TBD.

Thanks for the heads up!

|  | [Lesley Norton [:lnorton]](/user_profile?user_id=618576) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1831318#c8)• 2 years ago |
|  | |

Thanks for the heads up here. As far as I know it's not possible to meaningfully remove the PR from GitHub. Naomi, the engineer assigned to this bug, and who is best suited to review this patch, is on PTO until tomorrow. We've added another reviewer to the [PR](https://github.com/mozilla-mobile/mozilla-vpn-client/pull/7151) in the meantime.

|  | [matthias.gerstner](/user_profile?user_id=726784) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1831318#c9)• 2 years ago |
|  | |

It seems our community packager was inspired by another PR# that also talked openly about the problem here:

<https://github.com/mozilla-mobile/mozilla-vpn-client/pull/7055>

I don't know if that was discovered independently or if it is related to our report.

Please let us now you further plans once you've come to a decision.

|  | [matthias.gerstner](/user_profile?user_id=726784) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1831318#c10)• 2 years ago |
|  | |

Adding a colleague from my team as backup since I will be unavailable for a while after this week.

|  | [Frida K [:frida]](/user_profile?user_id=697037) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1831318#a3966772_697037)• 2 years ago |

See Also: → <https://github.com/mozilla-mobile/mozilla-vpn-client/pull/7110>

|  | [matthias.gerstner](/user_profile?user_id=726784) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1831318#c11)• 1 years ago |
|  | |

The maximum embargo time we offer will be reached tomorrow on August 2nd. Although parts of the issue already leaked via the GitHub PRs anyway. I will be publishing my formal report after this date.

You still did not answer any of the questions about the disclosure process. There is no CVE visible. There is no update here on the supposed patch - it seems from the Pull request #7710 that the use of Polkit has been removed. Do you have anything to add for the publishing of the formal report? Especially about the following topics:

* which version(s) will receive a fix?
* will there be a CVE assignment?
* what is the impact analysis on your end?

Thanks

Matthias

|  | [Frida K [:frida]](/user_profile?user_id=697037) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1831318#c12)• 1 years ago |
|  | |

Hello Lesley,

Can you please check the questions in the above comment?

Thanks,

Frida

Flags: needinfo?(lnorton)

|  | [Naomi Kirby](/user_profile?user_id=691471)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1831318#c13)• 1 years ago |
|  | |

We wound up fixing this issue in two parts, the first PR (<https://github.com/mozilla-mobile/mozilla-vpn-client/pull/7055>) removed the buggy use of polkit, which should close off any potential privilege escalation issues that could have manifested from polkit. However this PR on its own effectively changes nothing in the VPN behaviour, and it still permits any logged in user to control the VPN tunnel. This change will be included in the v2.16.0 release whenever that goes live (currently in QA and release testing as of today).

The follow-up PR (<https://github.com/mozilla-mobile/mozilla-vpn-client/pull/7110>) attempts to introduce better authorization controls on the D-Bus API by requiring the caller to possess CAP\_NET\_ADMIN permission, or matching the UID of the user who activated the connection. This lets any user activate the VPN, but once active only that user (or root) can control the VPN. This patch did not land in time for the 2.16.0 merge window, so we anticipate it will go live in the 2.17.0 release. There is no date for the 2.17 release yet, but our typical cadence should see it go live in 1-2 months time.

|  | [matthias.gerstner](/user_profile?user_id=726784) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1831318#c14)• 1 years ago |
|  | |

Thanks for the update. This still leaves the question of a CVE assignment, what are your plans?

|  | [Frida K [:frida]](/user_profile?user_id=697037) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1831318#c15)• 1 years ago |
|  | |

Hello Matthias,

We are working on issuing the CVE.

Thanks,

Frida

|  | [matthias.gerstner](/user_profile?user_id=726784) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1831318#c16)• 1 years ago |
|  | |

Regarding the fix for this you should not forget the following two aspects:

* only users with an active local session should be allowed to initiate a connection, not just anybody (like `nobody`). Polkit, if used properly, can be used for this with via the `allow_active: yes` policy setting.
* the leaking of log data as outlined in the initial report (see: getLogs()) should also be hardened.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1831318#a7778320_578488)• 1 years ago |

Alias: CVE-2023-4104

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1831318#a7963936_1689)• 1 years ago |

See Also: → <https://github.com/mozilla-mobile/mozilla-vpn-client/pull/7055>

|  | [Frida K [:frida]](/user_profile?user_id=697037) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1831318#a8212941_697037)• 1 year ago |

See Also: → <https://github.com/mozilla-mobile/mozilla-vpn-client/pull/7151>

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1831318#c17)• 1 year ago |
|  | |

The bug has been discussed in public, so there's no need to keep this hidden any longer.

The team is targeting a release of 2.16.1 for Linux on August 11th.

Group: mozilla-vpn-securitySee Also: → <https://www.openwall.com/lists/oss-security/2023/08/03/1>

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1831318#c18)• 1 year ago |
|  | |

Mozilla VPN v2.16.1 has been made available by the team.

Status: ASSIGNED → RESOLVEDClosed: 1 year agoResolution: --- → FIXED

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1831318#c19)• 1 year ago |
|  | |

Attached file
[advsiory.txt](attachment.cgi?id=9350604) (obsolete)
— [Details](attachment.cgi?id=9350604&action=edit)

Attaching draft advisory for internal review.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1831318#c20)• 1 year ago |
|  | |

Attached file
[advsiory.txt](attachment.cgi?id=9350789)
— [Details](attachment.cgi?id=9350789&action=edit)

[Attachment #9350604](/attachment.cgi?id=9350604&action=edit "advsiory.txt") -
Attachment is obsolete: true

|  | [Lesley Norton [:lnorton]](/user_profile?user_id=618576) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1831318#a12630560_618576)• 1 year ago |

Flags: needinfo?(lnorton)
You need to [log in](/show_bug.cgi?id=1831318&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Frederik Braun [:freddy]](/user_profile?user_id=428608)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

