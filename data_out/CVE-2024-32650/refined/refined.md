```
{
  "vulnerability": {
    "root_cause": "The `rustls::ConnectionCommon::complete_io` function could enter an infinite loop if a client sends a `close_notify` message immediately after the `client_hello` message, while the handshake is still in progress.",
    "weaknesses": [
      "CWE-835"
    ],
    "impact": "Denial of Service (DoS). A multithreaded server using `rustls` can be rendered unresponsive by a few malicious requests, each causing a thread to spin in an infinite loop.",
    "attack_vectors": "Network. A malicious client can send crafted TLS messages to trigger the infinite loop.",
    "required_attacker_capabilities": "The attacker only needs the ability to establish a network connection and send custom TLS messages. No specific privileges or user interaction is required."
  },
  "additional_details": {
    "affected_versions": [
      "<=0.23.4",
      "<=0.22.3",
      "<=0.21.10",
      "0.20"
    ],
    "patched_versions": [
      ">=0.23.5",
      ">=0.22.4",
      ">=0.21.11"
    ],
    "vulnerable_functions": [
      "rustls::ConnectionCommon::complete_io"
    ],
     "not_affected": [
        "`tokio-rustls` and `rustls-ffi` as they do not call `complete_io`."
     ],
    "affected_types":[
        "`rustls::Stream` and `rustls::StreamOwned` types"
    ],
    "poc": "A python script is provided to simulate a malicious client that sends a client_hello followed immediately by a close_notify message.",
    "fix": "The fix involves adding a check to `complete_io` to bail out if no progress is possible. The commit `6e938bc` implements the fix.",
   "regression_test": "Commit `2123576` added a regression test for the `complete_io` infinite loop. Commit `f45664f` modifies how unauthenticated close_notify alerts are handled, contributing to the fix."
  }
}
```