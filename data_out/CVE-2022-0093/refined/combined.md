=== Content from gitlab.com_c7fc61c6_20250108_111625.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-0093.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-0093.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-0093.json)
[Permalink](/gitlab-org/cves/-/blob/c6a6f86828227186d5080abce4d5f88d42571ec9/2022/CVE-2022-0093.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Jan 16, 2022

  [ada74d0e](/gitlab-org/cves/-/commit/ada74d0e15a68fc8f2e69e429ff89f72bf721be1)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/ada74d0e15a68fc8f2e69e429ff89f72bf721be1)
  ·
  ada74d0e

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jan 16, 2022

  ada74d0e

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/ada74d0e15a68fc8f2e69e429ff89f72bf721be1)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jan 16, 2022

Loading



=== Content from gitlab.com_6b469b7b_20250108_111625.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# User with expired password can still access sensitive info

**[HackerOne report #1348738](https://hackerone.com/reports/1348738)** by `joaxcar` on 2021-09-22, assigned to [@vdesousa](/vdesousa "Vitor Meireles De Sousa"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

When a users password expired the user can not access the GitLab instance before providing a new one. The user will not be able to view projects or groups, and not the merge request list in these projects where the user previously had access.

The latest patch to GitLab introduces a RSS feed for tracking updates to a projects merge requests. This feed is available to the user even after the rest of Gitlab is blocked due to password expiration.

This could be related to my previous report where a user with expired password could access the API, but I have not been able to confirm that.

(This also affect users who have retrieved a RSS feed prior to a "terms of service" is put in place by an admin. The user will be prompted with "accept or log out", if the user click deny and log out the user will not be able to access internal or private projects anymore. But can still access the RSS feeds!)

##### Steps to reproduce

1. Create two users, one admin `admin1` and one user `user1`
2. Log in as `admin1` and create a private project `project1` on <https://gitlab.domain.com/projects/new#blank_project>
3. Create a branch on <https://gitlab.joaxcar.com/admin1/project1/-/branches/new> and and click "create merge request" when the branch is created
4. Create a merge request to main
5. Go to <https://gitlab.domain.com/admin1/project1/-/project_members> and invite `user1` as a `Developer` to the project
6. Log out and log in as `user1`
7. Go to <https://gitlab.domain.com/admin1/project1/-/merge_requests>
8. Click the RSS icon

[![rss.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/09fbd125b335ea4479f6beb2991f98a4d8d7795c/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62353032656336612d313735662d343533322d616134662d6365376261363536336335622f7273732e706e67)

9. Save the path to the RSS feed in a separate tab
10. Log out and log in as `admin1`
11. Go to the admin page for editing `user1` <https://gitlab.domain.com/admin/users/user1/edit> and change the users password. This triggers "password expired at" to be set to the current time. Effectively putting the `user1` in the state of "expired password"
12. Log out
13. Refresh the tab with the RSS feed and confirm that it still can access the feed.(This is done as `user1`)

##### Impact

A user with expired password can still access information about merge requests in internal and private projects

##### What is the current *bug* behaviour?

RSS feeds are accessible by users that have expired password

##### What is the expected *correct* behaviour?

RSS feeds should be blocked for users with expired password as the rest of GitLab

##### Output of checks

This bug happens on GitLab.com

#### Impact

A user with expired password can access a stream of information from internal and private projects which should be out of reach.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [rss.png](https://h1.sec.gitlab.net/a/b502ec6a-175f-4532-aa4f-ce7ba6563c5b/rss.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

## `@bdenkovych` update

While reading the codebase I noticed that there are lots of endpoints that authenticate users with an expired passwords. Here is the list:

* User
  + `/:username.atom` - this endpoint is publicly available, but when a user is authenticated response contains private info
* Dashboard issues
  + `/dashboard/issues.atom`
  + `/dashboard/issues.ics`
* Dashboard projects
  + `/dashboard/projects.atom`
* Group
  + `/*id.atom`
  + `/groups/*id/-/issues.atom`
  + `/groups/*id/-/issues.ics`
* Project
  + `/*namespace_id/:id.atom`
* Project commits
  + `/*namespace_id/:project_id/-/commits/*id?format=atom`
* Project tags
  + `/*namespace_id/:project_id/-/tags?format=atom`
* Project issues
  + `/*namespace_id/:project_id/-/issues.atom`
  + `/*namespace_id/:project_id/-/issues.ics`
* Project merge requests
  + `/*namespace_id/:project_id/-/merge_requests.atom`
* Project raw files with external storage
  + `/*namespace_id/:project_id/-/raw/*id`
    - <https://docs.gitlab.com/ee/administration/static_objects_external_storage.html#serving-private-static-objects>
* Project archive with external storage
  + `/*namespace_id/:project_id/-/archive/*id(.:format)`
  + <https://docs.gitlab.com/ee/administration/static_objects_external_storage.html#serving-private-static-objects>
* GraphQL
  + `/api/graphql` with PAT

You can reproduce this issue for all those endpoints by following similar steps described for `/*namespace_id/:project_id/-/merge_requests.atom`.

As mentioned in [#343247 (comment 713877122)](https://gitlab.com/gitlab-org/gitlab/-/issues/343247#note_713877122 "User with expired password can still access sensitive info"), users like LDAP and OmniAuth users should retain access even with an expired password.

In <https://gitlab.com/gitlab-org/security/gitlab/-/merge_requests/2042> I added test cases to cover all these endpoints.

Edited Dec 07, 2021 by [Bogdan Denkovych](/bdenkovych)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


