

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=73eeba71dc9932970befa009e68272a3d5ec4a58)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=73eeba71dc9932970befa009e68272a3d5ec4a58)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=73eeba71dc9932970befa009e68272a3d5ec4a58)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=73eeba71dc9932970befa009e68272a3d5ec4a58)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maxim Mikityanskiy <maximmi@nvidia.com> | 2021-06-10 19:40:30 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-06-23 14:42:43 +0200 |
| commit | [73eeba71dc9932970befa009e68272a3d5ec4a58](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=73eeba71dc9932970befa009e68272a3d5ec4a58) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=73eeba71dc9932970befa009e68272a3d5ec4a58)) | |
| tree | [8dd01aa5f8ed2c26ffad61d3e069e15b43fc3916](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=73eeba71dc9932970befa009e68272a3d5ec4a58) | |
| parent | [9cdf299ba4e153b5e56187648420de22c6216f02](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9cdf299ba4e153b5e56187648420de22c6216f02) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=73eeba71dc9932970befa009e68272a3d5ec4a58&id2=9cdf299ba4e153b5e56187648420de22c6216f02)) | |
| download | [linux-73eeba71dc9932970befa009e68272a3d5ec4a58.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-73eeba71dc9932970befa009e68272a3d5ec4a58.tar.gz) | |

mptcp: Fix out of bounds when parsing TCP options[ Upstream commit 07718be265680dcf496347d475ce1a5442f55ad7 ]
The TCP option parser in mptcp (mptcp\_get\_options) could read one byte
out of bounds. When the length is 1, the execution flow gets into the
loop, reads one byte of the opcode, and if the opcode is neither
TCPOPT\_EOL nor TCPOPT\_NOP, it reads one more byte, which exceeds the
length of 1.
This fix is inspired by commit 9609dad263f8 ("ipv4: tcp\_input: fix stack
out of bounds when parsing TCP options.").
Cc: Young Xiao <92siuyang@gmail.com>
Fixes: cec37a6e41aa ("mptcp: Handle MP\_CAPABLE options for outgoing connections")
Signed-off-by: Maxim Mikityanskiy <maximmi@nvidia.com>
Reviewed-by: Mat Martineau <mathew.j.martineau@linux.intel.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=73eeba71dc9932970befa009e68272a3d5ec4a58)

| -rw-r--r-- | [net/mptcp/options.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/mptcp/options.c?id=73eeba71dc9932970befa009e68272a3d5ec4a58) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 0 deletions

| diff --git a/net/mptcp/options.c b/net/mptcp/options.cindex 91034a221983c4..ac0233c9cd349f 100644--- a/[net/mptcp/options.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mptcp/options.c?id=9cdf299ba4e153b5e56187648420de22c6216f02)+++ b/[net/mptcp/options.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mptcp/options.c?id=73eeba71dc9932970befa009e68272a3d5ec4a58)@@ -314,6 +314,8 @@ void mptcp\_get\_options(const struct sk\_buff \*skb, length--; continue; default:+ if (length < 2)+ return; opsize = \*ptr++; if (opsize < 2) /\* "silly options" \*/ return; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 08:58:54 +0000

