

[Log in](/login.jsp?os_destination=%2Fbrowse%2FJAVA-4017)[Skip to main content](#main)[Skip to sidebar](#sidebar)[![MongoDB Jira](/s/ub562g/9160001/fy41z4/_/jira-logo-scaled.png)](https://jira.mongodb.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")
* [eazyBI](/plugins/servlet/eazybi)

* Give feedback to Atlassian
* [Help](/secure/ViewKeyboardShortcuts%21default.jspa "Help")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FJAVA-4017)
  + [Acknowledged notifications](/plugins/servlet/wittified/profile/notifications)

![Uploaded image for project: 'Java Driver'](https://jira.mongodb.org/secure/projectavatar?pid=10006&avatarId=10010)

1. [Java Driver](/browse/JAVA)
2. [JAVA-4017](/browse/JAVA-4017)

## Fix CVE-2021-20328

Schedule Issue[Undo Transition](/secure/UndoTransition%21default.jspa?id=1626041)ClosedExportnullXMLWordPrintableJSON
### Details

* **Type:**
  ![Icon: Bug](/secure/viewavatar?size=xsmall&avatarId=14703&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![Icon: Major - P3](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.") Major - P3
* **Fix Version/s:**
  [3.11.3](/issues/?jql=project+%3D+JAVA+AND+fixVersion+%3D+3.11.3 "3.11.3 Patch release"), [3.12.8](/issues/?jql=project+%3D+JAVA+AND+fixVersion+%3D+3.12.8 "3.12.8 Patch release"), [4.0.6](/issues/?jql=project+%3D+JAVA+AND+fixVersion+%3D+4.0.6 "4.0.6 Patch release"), [4.1.2](/issues/?jql=project+%3D+JAVA+AND+fixVersion+%3D+4.1.2 "4.1.2 Patch release"), [4.2.1](/issues/?jql=project+%3D+JAVA+AND+fixVersion+%3D+4.2.1 "4.2.1 Patch release")
* **Affects Version/s:**
  None
* **Component/s:**
  [Client Side Encryption](/issues/?jql=project+%3D+JAVA+AND+component+%3D+%22Client+Side+Encryption%22 "Client Side Encryption ")
* **Labels:**
  None
### Description

Fix CVE-2021-20328

**CVE ID:** CVE-2021-20328

**Title:** MongoDB Java driver client-side field level encryption not verifying KMS host name

**Description**: Specific versions of the Java driver that support client-side field level encryption (CSFLE) fail to perform correct host name verification on the KMS server’s certificate. This vulnerability in combination with a privileged network position active MITM attack could result in interception of traffic between the Java driver and the KMS service rendering Field Level Encryption ineffective. This issue was discovered during internal testing and affects all versions of the Java driver that support CSFLE. The Java async, Scala, and reactive streams drivers are not impacted. This vulnerability does not impact driver traffic payloads with CSFLE-supported key services originating from applications residing inside the AWS, GCP, and Azure network fabrics due to compensating controls in these environments. This issue does not impact driver workloads that don’t use Field Level Encryption.

**CVSS Score:** 6.4

<https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N>

**Exact affected versions:**

* mongo-java-driver, mongodb-driver, mongodb-driver-sync, mongodb-driver-legacy: 3.11.0 - 3.11.2, 3.12.0 - 3.12.7
* mongodb-driver-sync, mongodb-driver-legacy: 4.0.0 - 4.0.5, 4.1.0 - 4.1.1, 4.2.0

**Is fixed version available:** Yes.  Fixed versions:

* mongo-java-driver, mongodb-driver, mongodb-driver-sync, mongodb-driver-legacy: 3.11.3, 3.12.8.
* mongodb-driver-sync, mongodb-driver-legacy: 4.0.6, 4.1.2, 4.2.1

**Underlying operating systems affected:** All

**How the issue was discovered:** Internally

### Attachments

### Activity

### People

Assignee:
![jeff.yemin@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=10122)
Jeffrey Yemin

Reporter:
![jeff.yemin@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=10122)
Jeffrey Yemin

Votes:
0
Vote for this issue

Watchers:
2
Start watching this issue

### Dates

Created:

Feb 17 2021 05:41:59 PM UTC

Updated:

Oct 28 2023 11:21:24 AM UTC

Resolved:

Feb 18 2021 09:02:38 PM UTC

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for MongoDB. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

