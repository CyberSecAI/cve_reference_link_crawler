=== Content from plugins.trac.wordpress.org_f9480331_20250111_054122.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2922313%2Fchp-ads-block-detector)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2920522/chp-ads-block-detector "Changeset 2920522 for chp-ads-block-detector")
* [Next Change](/changeset/2926660/chp-ads-block-detector "Changeset 2926660 for chp-ads-block-detector") →

---

# Changeset [2922313](/changeset/2922313 "Show full changeset") for [chp-ads-block-detector](/browser/chp-ads-block-detector?rev=2922313 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
06/06/2023 12:05:49 PM
([19 months](/timeline?from=2023-06-06T12%3A05%3A49Z&precision=second "See timeline at 06/06/2023 12:05:49 PM") ago)

Author:
sureshchand12a
Message:

Security Update

Location:
[chp-ads-block-detector/trunk](/browser/chp-ads-block-detector/trunk?rev=2922313)
Files:

6 edited

* [chp-adsblocker-detector.php](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2922313 "Show entry in browser")
  (modified)
  ([3 diffs](#file0 "Show differences"))
* [composer.json](/browser/chp-ads-block-detector/trunk/composer.json?rev=2922313 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [includes/ajax.php](/browser/chp-ads-block-detector/trunk/includes/ajax.php?rev=2922313 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))
* [readme.md](/browser/chp-ads-block-detector/trunk/readme.md?rev=2922313 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [readme.txt](/browser/chp-ads-block-detector/trunk/readme.txt?rev=2922313 "Show entry in browser")
  (modified)
  ([2 diffs](#file4 "Show differences"))
* [view/settings.php](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313 "Show entry in browser")
  (modified)
  ([16 diffs](#file5 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [chp-ads-block-detector/trunk/chp-adsblocker-detector.php](/changeset/2922313/chp-ads-block-detector/trunk/chp-adsblocker-detector.php "Show the changeset 2922313 restricted to chp-ads-block-detector/trunk/chp-adsblocker-detector.php")

  | [r2920522](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2920522#L5 "Show revision 2920522 of this file in browser") | [r2922313](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2922313#L5 "Show revision 2922313 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | \* Plugin URI:        https://chpadblock.com |
  | 6 | 6 | \* Description:       CHP Ads Block Detector plugin is developed in order to  detect most of the AdBlock extensions installed on the browser and show a popup to disable the extension. This plugin restricts the user to access the page unless the user will disable the extension for your website. |
  | 7 |  | \* Version:           3.9.~~6~~ |
  |  | 7 | \* Version:           3.9.7 |
  | 8 | 8 | \* Requires at least: 5.2 |
  | 9 | 9 | \* Requires PHP:      7.2 |
  | […](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2920522#L124) | […](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2922313#L124) |  |
  | 124 | 124 | //load all the constants |
  | 125 | 125 | $consts = array( |
  | 126 |  | 'CHP\_ADSB\_VERSION' => '3.9.~~6~~', |
  |  | 126 | 'CHP\_ADSB\_VERSION' => '3.9.7', |
  | 127 | 127 | 'CHP\_ADSB\_DIR' => plugin\_dir\_path(\_\_FILE\_\_), |
  | 128 | 128 | 'CHP\_ADSB\_URL' => plugin\_dir\_url(\_\_FILE\_\_), |
  | […](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2920522#L156) | […](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2922313#L156) |  |
  | 156 | 156 | <div class="notice notice-error"> |
  | 157 | 157 | <p> |
  | 158 |  | <?php \_e('You have premium version of <code>CHP Ads Block Detector</code>. You can disable or deactive free version!', 'chp-adsblocker-detector'); ?> |
  |  | 158 | <?php esc\_attr\_e('You have premium version of <code>CHP Ads Block Detector</code>. You can disable or deactive free version!', 'chp-adsblocker-detector'); ?> |
  | 159 | 159 | </p> |
  | 160 | 160 | </div> |
* ## [chp-ads-block-detector/trunk/composer.json](/changeset/2922313/chp-ads-block-detector/trunk/composer.json "Show the changeset 2922313 restricted to chp-ads-block-detector/trunk/composer.json")

  | [r2920522](/browser/chp-ads-block-detector/trunk/composer.json?rev=2920522#L1 "Show revision 2920522 of this file in browser") | [r2922313](/browser/chp-ads-block-detector/trunk/composer.json?rev=2922313#L1 "Show revision 2922313 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | { |
  | 2 | 2 | "name": "scthakuri12a/chp-ads-block-detector", |
  | 3 |  | "version": "3.9.~~6~~", |
  |  | 3 | "version": "3.9.7", |
  | 4 | 4 | "description": "Block Ads Blocker Extensions and Increase your revenue by using Ads Blocker Detector Plugin", |
  | 5 | 5 | "homepage": "https://wordpress.org/plugins/chp-ads-block-detector/", |
* ## [chp-ads-block-detector/trunk/includes/ajax.php](/changeset/2922313/chp-ads-block-detector/trunk/includes/ajax.php "Show the changeset 2922313 restricted to chp-ads-block-detector/trunk/includes/ajax.php")

  | [r2920522](/browser/chp-ads-block-detector/trunk/includes/ajax.php?rev=2920522#L83 "Show revision 2920522 of this file in browser") | [r2922313](/browser/chp-ads-block-detector/trunk/includes/ajax.php?rev=2922313#L83 "Show revision 2922313 of this file in browser") |  |
  | --- | --- | --- |
  | 83 | 83 | Save All the settings |
  | 84 | 84 | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
  | 85 |  | if ( isset($\_REQUEST['\_wpnonce']) && wp\_verify\_nonce($\_REQUEST['\_wpnonce'], 'update\_chpadb\_settings' ) ){ |
  |  | 85 | if ( isset($\_REQUEST['\_wpnonce']) && wp\_verify\_nonce($\_REQUEST['\_wpnonce'], 'update\_chpadb\_settings' ) && current\_user\_can('manage\_options') ){ |
  | 86 | 86 | if( isset( $\_POST['settings'] ) ){ |
  | 87 | 87 | $settings = $this->recursive\_sanitize\_array\_field($\_POST['settings']); |
  | […](/browser/chp-ads-block-detector/trunk/includes/ajax.php?rev=2920522#L106) | […](/browser/chp-ads-block-detector/trunk/includes/ajax.php?rev=2922313#L106) |  |
  | 106 | 106 | update\_option( "chpadb\_plugin\_settings", json\_encode($newSettings) ); |
  | 107 | 107 |  |
  | 108 |  | echo ~~\_\_~~('Settings save successfully', 'chp-adsblocker-detector'); |
  |  | 108 | echo esc\_attr('Settings save successfully', 'chp-adsblocker-detector'); |
  | 109 | 109 | }else{ |
  | 110 |  | echo ~~\_\_~~('We got some issue on updating settings.', 'chp-adsblocker-detector'); |
  |  | 110 | echo esc\_attr('We got some issue on updating settings.', 'chp-adsblocker-detector'); |
  | 111 | 111 | } |
  | 112 | 112 | } |
  | […](/browser/chp-ads-block-detector/trunk/includes/ajax.php?rev=2920522#L118) | […](/browser/chp-ads-block-detector/trunk/includes/ajax.php?rev=2922313#L118) |  |
  | 118 | 118 | setDefaultValues(); |
  | 119 | 119 |  |
  | 120 |  | echo ~~\_\_~~('Settings reset successfully.', 'chp-adsblocker-detector'); |
  |  | 120 | echo esc\_attr('Settings reset successfully.', 'chp-adsblocker-detector'); |
  | 121 | 121 | } |
  | 122 | 122 | }else{ |
  | 123 |  | echo \_\_('Unable to update settings.', 'chp-adsblocker-detector'); |
  | 124 |  | die(); |
  |  | 123 | echo esc\_attr('Unable to update settings.', 'chp-adsblocker-detector'); |
  | 125 | 124 | } |
  | 126 | 125 |  |
* ## [chp-ads-block-detector/trunk/readme.md](/changeset/2922313/chp-ads-block-detector/trunk/readme.md "Show the changeset 2922313 restricted to chp-ads-block-detector/trunk/readme.md")

  | [r2920522](/browser/chp-ads-block-detector/trunk/readme.md?rev=2920522#L109 "Show revision 2920522 of this file in browser") | [r2922313](/browser/chp-ads-block-detector/trunk/readme.md?rev=2922313#L109 "Show revision 2922313 of this file in browser") |  |
  | --- | --- | --- |
  | 109 | 109 | \*\*CHANGELOG\*\* |
  | 110 | 110 |  |
  | 111 |  | > ## v3.9.~~6 (02~~/06/2023) |
  |  | 111 | > ## v3.9.7 (06/06/2023) |
  | 112 | 112 | > |
  | 113 | 113 | > - Security Update |
* ## [chp-ads-block-detector/trunk/readme.txt](/changeset/2922313/chp-ads-block-detector/trunk/readme.txt "Show the changeset 2922313 restricted to chp-ads-block-detector/trunk/readme.txt")

  | [r2920522](/browser/chp-ads-block-detector/trunk/readme.txt?rev=2920522#L4 "Show revision 2920522 of this file in browser") | [r2922313](/browser/chp-ads-block-detector/trunk/readme.txt?rev=2922313#L4 "Show revision 2922313 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 5.2 |
  | 5 | 5 | Tested up to: 6.2 |
  | 6 |  | Stable tag: 3.9.~~6~~ |
  |  | 6 | Stable tag: 3.9.7 |
  | 7 | 7 | Requires PHP: 7.2 |
  | 8 | 8 | License: GPLv2 or later |
  | […](/browser/chp-ads-block-detector/trunk/readme.txt?rev=2920522#L137) | […](/browser/chp-ads-block-detector/trunk/readme.txt?rev=2922313#L137) |  |
  | 137 | 137 | == Changelog == |
  | 138 | 138 |  |
  | 139 |  | = 3.9.~~6~~ = |
  |  | 139 | = 3.9.7 = |
  | 140 | 140 | \*  ☞ Security Update |
  | 141 | 141 |  |
* ## [chp-ads-block-detector/trunk/view/settings.php](/changeset/2922313/chp-ads-block-detector/trunk/view/settings.php "Show the changeset 2922313 restricted to chp-ads-block-detector/trunk/view/settings.php")

  | [r2920522](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L3 "Show revision 2920522 of this file in browser") | [r2922313](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L3 "Show revision 2922313 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | <img class="hamrocsit\_adb\_logo" src="<?php echo CHP\_ADSB\_URL . 'assets/img/icon.png'; ?>"> |
  | 4 | 4 | <div class="hamrocsit\_adb\_content"> |
  | 5 |  | <h1><?php \_e('CHP ADS Block Detector!', 'chp-adsblocker-detector'); ?></h1> |
  | 6 |  | <span>#<?php \_e('The Best ads block detector wordpress plugin', 'chp-adsblocker-detector'); ?></span> |
  |  | 5 | <h1><?php esc\_attr\_e('CHP ADS Block Detector!', 'chp-adsblocker-detector'); ?></h1> |
  |  | 6 | <span>#<?php esc\_attr\_e('The Best ads block detector wordpress plugin', 'chp-adsblocker-detector'); ?></span> |
  | 7 | 7 | </div> |
  | 8 |  | <div class="hamrocsit\_adb\_version"><?php \_e('Version', 'chp-adsblocker-detector'); ?>: |
  |  | 8 | <div class="hamrocsit\_adb\_version"><?php esc\_attr\_e('Version', 'chp-adsblocker-detector'); ?>: |
  | 9 | 9 | <b><?php echo CHP\_ADSB\_VERSION; ?></b> |
  | 10 | 10 | </div> |
  | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L12) | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L12) |  |
  | 12 | 12 | <div class="hamrocsit\_adb\_nav-tab-wrapper"> |
  | 13 | 13 | <a target="\_blank" href="https://chpadblock.com/pricing/" |
  | 14 |  | class="hamrocsit\_adb\_nav-tab pro"><?php \_e('Check Pro Version', 'chp-adsblocker-detector'); ?></a> |
  |  | 14 | class="hamrocsit\_adb\_nav-tab pro"><?php esc\_attr\_e('Check Pro Version', 'chp-adsblocker-detector'); ?></a> |
  | 15 | 15 | </div> |
  | 16 | 16 | </div> |
  | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L28) | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L28) |  |
  | 28 | 28 | <thead> |
  | 29 | 29 | <tr> |
  | 30 |  | <th colspan="2"><?php \_e('Settings', 'chp-adsblocker-detector'); ?></th> |
  |  | 30 | <th colspan="2"><?php esc\_attr\_e('Settings', 'chp-adsblocker-detector'); ?></th> |
  | 31 | 31 | </tr> |
  | 32 | 32 | </thead> |
  | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L34) | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L34) |  |
  | 34 | 34 | <tr> |
  | 35 | 35 | <td> |
  | 36 |  | <?php \_e('Enable', 'chp-adsblocker-detector'); ?> |
  |  | 36 | <?php esc\_attr\_e('Enable', 'chp-adsblocker-detector'); ?> |
  | 37 | 37 | </td> |
  | 38 | 38 | <td> |
  | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L47) | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L47) |  |
  | 47 | 47 | <tr> |
  | 48 | 48 | <td> |
  | 49 |  | <?php \_e('Title', 'chp-adsblocker-detector'); ?> |
  |  | 49 | <?php esc\_attr\_e('Title', 'chp-adsblocker-detector'); ?> |
  | 50 | 50 | </td> |
  | 51 | 51 | <td> |
  | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L56) | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L56) |  |
  | 56 | 56 | <tr> |
  | 57 | 57 | <td> |
  | 58 |  | <?php \_e('Content', 'chp-adsblocker-detector'); ?> |
  |  | 58 | <?php esc\_attr\_e('Content', 'chp-adsblocker-detector'); ?> |
  | 59 | 59 | </td> |
  | 60 | 60 | <td> |
  | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L72) | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L72) |  |
  | 72 | 72 | <tr> |
  | 73 | 73 | <td> |
  | 74 |  | <?php \_e('Width (in %)', 'chp-adsblocker-detector'); ?> |
  |  | 74 | <?php esc\_attr\_e('Width (in %)', 'chp-adsblocker-detector'); ?> |
  | 75 | 75 | </td> |
  | 76 | 76 | <td> |
  | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L82) | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L82) |  |
  | 82 | 82 | <tr> |
  | 83 | 83 | <td> |
  | 84 |  | <?php \_e('Show Refresh Button', 'chp-adsblocker-detector'); ?> |
  |  | 84 | <?php esc\_attr\_e('Show Refresh Button', 'chp-adsblocker-detector'); ?> |
  | 85 | 85 | </td> |
  | 86 | 86 | <td> |
  | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L96) | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L96) |  |
  | 96 | 96 | <tr> |
  | 97 | 97 | <td> |
  | 98 |  | <?php \_e('Refresh Button (Text)', 'chp-adsblocker-detector'); ?> |
  | 99 |  | </td> |
  | 100 |  | <td> |
  | 101 |  | <input type="text" value="<?php e~~cho @$settings->btn1\_text~~; ?>" |
  |  | 98 | <?php esc\_attr\_e('Refresh Button (Text)', 'chp-adsblocker-detector'); ?> |
  |  | 99 | </td> |
  |  | 100 | <td> |
  |  | 101 | <input type="text" value="<?php esc\_attr\_e($settings->btn1\_text, 'chp-adsblocker-detector'); ?>" |
  | 102 | 102 | class="chpabd\_form\_settings include" name="btn1\_text" |
  | 103 |  | placeholder="<?php \_e('Button Text', 'chp-adsblocker-detector'); ?>"> |
  | 104 |  | </td> |
  | 105 |  | </tr> |
  | 106 |  |  |
  | 107 |  | <tr> |
  | 108 |  | <td> |
  | 109 |  | <?php \_e('Show Close Button', 'chp-adsblocker-detector'); ?> |
  |  | 103 | placeholder="<?php esc\_attr\_e('Button Text', 'chp-adsblocker-detector'); ?>"> |
  |  | 104 | </td> |
  |  | 105 | </tr> |
  |  | 106 |  |
  |  | 107 | <tr> |
  |  | 108 | <td> |
  |  | 109 | <?php esc\_attr\_e('Show Close Button', 'chp-adsblocker-detector'); ?> |
  | 110 | 110 | </td> |
  | 111 | 111 | <td> |
  | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L121) | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L121) |  |
  | 121 | 121 | <tr> |
  | 122 | 122 | <td> |
  | 123 |  | <?php \_e('Close Button (Text)', 'chp-adsblocker-detector'); ?> |
  | 124 |  | </td> |
  | 125 |  | <td> |
  | 126 |  | <input type="text" value="<?php e~~cho @$settings->btn2\_text~~; ?>" |
  |  | 123 | <?php esc\_attr\_e('Close Button (Text)', 'chp-adsblocker-detector'); ?> |
  |  | 124 | </td> |
  |  | 125 | <td> |
  |  | 126 | <input type="text" value="<?php esc\_attr\_e($settings->btn2\_text, 'chp-adsblocker-detector'); ?>" |
  | 127 | 127 | class="chpabd\_form\_settings include" name="btn2\_text" |
  | 128 |  | placeholder="<?php \_e('Button Text', 'chp-adsblocker-detector'); ?>"> |
  | 129 |  | </td> |
  | 130 |  | </tr> |
  | 131 |  |  |
  | 132 |  | <tr> |
  | 133 |  | <td> |
  | 134 |  | <?php \_e('Include in Header', 'chp-adsblocker-detector'); ?> |
  |  | 128 | placeholder="<?php esc\_attr\_e('Button Text', 'chp-adsblocker-detector'); ?>"> |
  |  | 129 | </td> |
  |  | 130 | </tr> |
  |  | 131 |  |
  |  | 132 | <tr> |
  |  | 133 | <td> |
  |  | 134 | <?php esc\_attr\_e('Include in Header', 'chp-adsblocker-detector'); ?> |
  | 135 | 135 | </td> |
  | 136 | 136 | <td> |
  | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L152) | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L152) |  |
  | 152 | 152 | <tr> |
  | 153 | 153 | <td> |
  | 154 |  | <?php \_e('Minify JS', 'chp-adsblocker-detector'); ?> |
  |  | 154 | <?php esc\_attr\_e('Minify JS', 'chp-adsblocker-detector'); ?> |
  | 155 | 155 | </td> |
  | 156 | 156 | <td> |
  | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L166) | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L166) |  |
  | 166 | 166 | <tr> |
  | 167 | 167 | <td> |
  | 168 |  | <?php \_e('Branding', 'chp-adsblocker-detector'); ?> |
  |  | 168 | <?php esc\_attr\_e('Branding', 'chp-adsblocker-detector'); ?> |
  | 169 | 169 | </td> |
  | 170 | 170 | <td> |
  | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L189) | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L189) |  |
  | 189 | 189 | <thead> |
  | 190 | 190 | <tr> |
  | 191 |  | <th><?php \_e('PRO Version Capability', 'chp-adsblocker-detector'); ?></th> |
  |  | 191 | <th><?php esc\_attr\_e('PRO Version Capability', 'chp-adsblocker-detector'); ?></th> |
  | 192 | 192 | </tr> |
  | 193 | 193 | </thead> |
  | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L200) | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L200) |  |
  | 200 | 200 | </tr> |
  | 201 | 201 | <tr> |
  | 202 |  | <td><?php \_e('Button Text Customizable', 'chp-adsblocker-detector'); ?></td> |
  | 203 |  | </tr> |
  | 204 |  | <tr> |
  | 205 |  | <td><?php \_e('Overlay Effect Customizable', 'chp-adsblocker-detector'); ?></td> |
  | 206 |  | </tr> |
  | 207 |  | <tr> |
  | 208 |  | <td><?php \_e('Dark and Light Theme', 'chp-adsblocker-detector'); ?></td> |
  | 209 |  | </tr> |
  | 210 |  | <tr> |
  | 211 |  | <td><?php \_e('Control Body Scroll', 'chp-adsblocker-detector'); ?>l</td> |
  | 212 |  | </tr> |
  | 213 |  | <tr> |
  | 214 |  | <td><?php \_e('Disable for individual pages and user roles', 'chp-adsblocker-detector'); ?></td> |
  | 215 |  | </tr> |
  | 216 |  | <tr> |
  | 217 |  | <td><?php \_e('Customize according to theme color', 'chp-adsblocker-detector'); ?></td> |
  | 218 |  | </tr> |
  | 219 |  | <tr> |
  | 220 |  | <td><?php \_e('Content Wrapper: Automatically Blur Content If Detected', 'chp-adsblocker-detector'); ?> |
  | 221 |  | </td> |
  | 222 |  | </tr> |
  | 223 |  | <tr> |
  | 224 |  | <td><?php \_e('Google Analytics Trackers', 'chp-adsblocker-detector'); ?></td> |
  | 225 |  | </tr> |
  | 226 |  | <tr> |
  | 227 |  | <td><a target="\_blank" |
  | 228 |  | href="https://chpadblock.com/docs/features/"><strong><?php \_e('And Many More . . .', 'chp-adsblocker-detector'); ?></strong></a> |
  |  | 202 | <td><?php esc\_attr\_e('Button Text Customizable', 'chp-adsblocker-detector'); ?></td> |
  |  | 203 | </tr> |
  |  | 204 | <tr> |
  |  | 205 | <td><?php esc\_attr\_e('Overlay Effect Customizable', 'chp-adsblocker-detector'); ?></td> |
  |  | 206 | </tr> |
  |  | 207 | <tr> |
  |  | 208 | <td><?php esc\_attr\_e('Dark and Light Theme', 'chp-adsblocker-detector'); ?></td> |
  |  | 209 | </tr> |
  |  | 210 | <tr> |
  |  | 211 | <td><?php esc\_attr\_e('Control Body Scroll', 'chp-adsblocker-detector'); ?>l</td> |
  |  | 212 | </tr> |
  |  | 213 | <tr> |
  |  | 214 | <td><?php esc\_attr\_e('Disable for individual pages and user roles', 'chp-adsblocker-detector'); ?></td> |
  |  | 215 | </tr> |
  |  | 216 | <tr> |
  |  | 217 | <td><?php esc\_attr\_e('Customize according to theme color', 'chp-adsblocker-detector'); ?></td> |
  |  | 218 | </tr> |
  |  | 219 | <tr> |
  |  | 220 | <td><?php esc\_attr\_e('Content Wrapper: Automatically Blur Content If Detected', 'chp-adsblocker-detector'); ?> |
  |  | 221 | </td> |
  |  | 222 | </tr> |
  |  | 223 | <tr> |
  |  | 224 | <td><?php esc\_attr\_e('Google Analytics Trackers', 'chp-adsblocker-detector'); ?></td> |
  |  | 225 | </tr> |
  |  | 226 | <tr> |
  |  | 227 | <td><a target="\_blank" href="https://chpadblock.com/docs/features/"><strong><?php esc\_attr\_e('And Many More . . .', 'chp-adsblocker-detector'); ?></strong></a> |
  | 229 | 228 | </td> |
  | 230 | 229 | </tr> |
  | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L233) | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L232) |  |
  | 233 | 232 | <tr> |
  | 234 | 233 | <th style="text-align:center;"><a target="\_blank" href="https://chpadblock.com/pricing/" |
  | 235 |  | style="    padding: 0;border: none;outline: none;box-shadow: none;background: transparent;color: #fff;text-align: center;text-decoration:none;"><?php \_e('Check PRO Version', 'chp-adsblocker-detector'); ?></a> |
  |  | 234 | style="    padding: 0;border: none;outline: none;box-shadow: none;background: transparent;color: #fff;text-align: center;text-decoration:none;"><?php esc\_attr\_e('Check PRO Version', 'chp-adsblocker-detector'); ?></a> |
  | 236 | 235 | </th> |
  | 237 | 236 | </tr> |
  | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L243) | […](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L242) |  |
  | 243 | 242 | <?php echo wp\_nonce\_field('update\_chpadb\_settings'); ?> |
  | 244 | 243 | <button class="button button-primary" type="button" |
  | 245 |  | id="chp\_ads\_save\_settings"><?php \_e('Save Changes', 'chp-adsblocker-detector'); ?></button> |
  |  | 244 | id="chp\_ads\_save\_settings"><?php esc\_attr\_e('Save Changes', 'chp-adsblocker-detector'); ?></button> |
  | 246 | 245 | <button class="button button-secondary" type="button" |
  | 247 |  | id="chp\_ads\_reset\_settings"><?php \_e('Reset Changes', 'chp-adsblocker-detector'); ?></button> |
  |  | 246 | id="chp\_ads\_reset\_settings"><?php esc\_attr\_e('Reset Changes', 'chp-adsblocker-detector'); ?></button> |
  | 248 | 247 | </div> |
  | 249 | 248 | </div> |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2922313)
* [Zip Archive](?format=zip&new=2922313)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_e02deb21_20250111_054125.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2926660%2Fchp-ads-block-detector)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2922313/chp-ads-block-detector "Changeset 2922313 for chp-ads-block-detector")
* [Next Change](/changeset/3004893/chp-ads-block-detector "Changeset 3004893 for chp-ads-block-detector") →

---

# Changeset [2926660](/changeset/2926660 "Show full changeset") for [chp-ads-block-detector](/browser/chp-ads-block-detector?rev=2926660 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
06/15/2023 03:32:05 PM
([19 months](/timeline?from=2023-06-15T15%3A32%3A05Z&precision=second "See timeline at 06/15/2023 03:32:05 PM") ago)

Author:
sureshchand12a
Message:

Security Update

Location:
[chp-ads-block-detector/trunk](/browser/chp-ads-block-detector/trunk?rev=2926660)
Files:

6 edited

* [chp-adsblocker-detector.php](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2926660 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [composer.json](/browser/chp-ads-block-detector/trunk/composer.json?rev=2926660 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [readme.md](/browser/chp-ads-block-detector/trunk/readme.md?rev=2926660 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [readme.txt](/browser/chp-ads-block-detector/trunk/readme.txt?rev=2926660 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [view/footer\_part.php](/browser/chp-ads-block-detector/trunk/view/footer_part.php?rev=2926660 "Show entry in browser")
  (modified)
  ([2 diffs](#file4 "Show differences"))
* [view/settings.php](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2926660 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [chp-ads-block-detector/trunk/chp-adsblocker-detector.php](/changeset/2926660/chp-ads-block-detector/trunk/chp-adsblocker-detector.php "Show the changeset 2926660 restricted to chp-ads-block-detector/trunk/chp-adsblocker-detector.php")

  | [r2922313](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2922313#L5 "Show revision 2922313 of this file in browser") | [r2926660](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2926660#L5 "Show revision 2926660 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | \* Plugin URI:        https://chpadblock.com |
  | 6 | 6 | \* Description:       CHP Ads Block Detector plugin is developed in order to  detect most of the AdBlock extensions installed on the browser and show a popup to disable the extension. This plugin restricts the user to access the page unless the user will disable the extension for your website. |
  | 7 |  | \* Version:           3.9.~~7~~ |
  |  | 7 | \* Version:           3.9.8 |
  | 8 | 8 | \* Requires at least: 5.2 |
  | 9 | 9 | \* Requires PHP:      7.2 |
  | […](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2922313#L124) | […](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2926660#L124) |  |
  | 124 | 124 | //load all the constants |
  | 125 | 125 | $consts = array( |
  | 126 |  | 'CHP\_ADSB\_VERSION' => '3.9.~~7~~', |
  |  | 126 | 'CHP\_ADSB\_VERSION' => '3.9.8', |
  | 127 | 127 | 'CHP\_ADSB\_DIR' => plugin\_dir\_path(\_\_FILE\_\_), |
  | 128 | 128 | 'CHP\_ADSB\_URL' => plugin\_dir\_url(\_\_FILE\_\_), |
* ## [chp-ads-block-detector/trunk/composer.json](/changeset/2926660/chp-ads-block-detector/trunk/composer.json "Show the changeset 2926660 restricted to chp-ads-block-detector/trunk/composer.json")

  | [r2922313](/browser/chp-ads-block-detector/trunk/composer.json?rev=2922313#L1 "Show revision 2922313 of this file in browser") | [r2926660](/browser/chp-ads-block-detector/trunk/composer.json?rev=2926660#L1 "Show revision 2926660 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | { |
  | 2 | 2 | "name": "scthakuri12a/chp-ads-block-detector", |
  | 3 |  | "version": "3.9.~~7~~", |
  |  | 3 | "version": "3.9.8", |
  | 4 | 4 | "description": "Block Ads Blocker Extensions and Increase your revenue by using Ads Blocker Detector Plugin", |
  | 5 | 5 | "homepage": "https://wordpress.org/plugins/chp-ads-block-detector/", |
* ## [chp-ads-block-detector/trunk/readme.md](/changeset/2926660/chp-ads-block-detector/trunk/readme.md "Show the changeset 2926660 restricted to chp-ads-block-detector/trunk/readme.md")

  | [r2922313](/browser/chp-ads-block-detector/trunk/readme.md?rev=2922313#L109 "Show revision 2922313 of this file in browser") | [r2926660](/browser/chp-ads-block-detector/trunk/readme.md?rev=2926660#L109 "Show revision 2926660 of this file in browser") |  |
  | --- | --- | --- |
  | 109 | 109 | \*\*CHANGELOG\*\* |
  | 110 | 110 |  |
  | 111 |  | > ## v3.9.~~7~~ (06/06/2023) |
  |  | 111 | > ## v3.9.8 (06/06/2023) |
  | 112 | 112 | > |
  | 113 | 113 | > - Security Update |
* ## [chp-ads-block-detector/trunk/readme.txt](/changeset/2926660/chp-ads-block-detector/trunk/readme.txt "Show the changeset 2926660 restricted to chp-ads-block-detector/trunk/readme.txt")

  | [r2922313](/browser/chp-ads-block-detector/trunk/readme.txt?rev=2922313#L4 "Show revision 2922313 of this file in browser") | [r2926660](/browser/chp-ads-block-detector/trunk/readme.txt?rev=2926660#L4 "Show revision 2926660 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 5.2 |
  | 5 | 5 | Tested up to: 6.2 |
  | 6 |  | Stable tag: 3.9.~~7~~ |
  |  | 6 | Stable tag: 3.9.8 |
  | 7 | 7 | Requires PHP: 7.2 |
  | 8 | 8 | License: GPLv2 or later |
  | […](/browser/chp-ads-block-detector/trunk/readme.txt?rev=2922313#L137) | […](/browser/chp-ads-block-detector/trunk/readme.txt?rev=2926660#L137) |  |
  | 137 | 137 | == Changelog == |
  | 138 | 138 |  |
  | 139 |  | = 3.9.~~7~~ = |
  |  | 139 | = 3.9.8 = |
  | 140 | 140 | \*  ☞ Security Update |
  | 141 | 141 |  |
* ## [chp-ads-block-detector/trunk/view/footer\_part.php](/changeset/2926660/chp-ads-block-detector/trunk/view/footer_part.php "Show the changeset 2926660 restricted to chp-ads-block-detector/trunk/view/footer_part.php")

  | [r2912322](/browser/chp-ads-block-detector/trunk/view/footer_part.php?rev=2912322#L8 "Show revision 2912322 of this file in browser") | [r2926660](/browser/chp-ads-block-detector/trunk/view/footer_part.php?rev=2926660#L8 "Show revision 2926660 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | $debug = apply\_filters('adb/debug/js', false); |
  | 9 | 9 | $onPageFullyLoaded = apply\_filters('adb/onpageload', true); |
  | 10 |  | ~~$branding = apply\_filters('adb/branding', @$this->settings->branding);~~ |
  | 11 |  |  |
  | 12 |  | ~~$brandingcode = '';~~ |
  | 13 |  | ~~if( filter\_var($branding, FILTER\_VALIDATE\_BOOLEAN) ){~~ |
  | 14 |  | ~~$brandingURLArray = array("https://chpadblock.com/", "https://toolkitspro.com");~~ |
  | 15 |  | ~~$brandingURLAlt = array("Best Wordpress Adblock Detecting Plugin | CHP Adblock", "100% Free SEO Tools - Tool Kits PRO");~~ |
  | 16 |  | ~~$random = array\_rand($brandingURLArray);~~ |
  | 17 |  | ~~$brandingURL = $brandingURLArray[$random];~~ |
  | 18 |  | ~~$brandingText = $brandingURLAlt[$random];~~ |
  | 19 |  | ~~$brandingcode = sprintf('<div class="%s"><a id="%s" href="%s" target="\_blank" rel="noopener noreferrer"><span class="%s" style="color: rgb(9, 13, 22);">Powered By</span> <div class="%s"><img src="%sassets/img/d.svg" alt="%s" /></div></a></div>', $this->rclass("chp\_branding"), $this->rclass("chp\_branding"), $brandingURL, $this->rclass("powered\_by"), $this->rclass("chp\_brading\_svg"), CHP\_ADSB\_URL, $brandingText);~~ |
  | 20 |  | ~~}~~ |
  | 21 | 10 | ?> |
  | 22 | 11 |  |
  | […](/browser/chp-ads-block-detector/trunk/view/footer_part.php?rev=2912322#L60) | […](/browser/chp-ads-block-detector/trunk/view/footer_part.php?rev=2926660#L49) |  |
  | 60 | 49 | </div> |
  | 61 | 50 | </div> |
  | 62 |  |  |
  | 63 |  | ~~<?php echo $brandingcode; ?>~~ |
  | 64 | 51 | </div> |
  | 65 | 52 |  |
* ## [chp-ads-block-detector/trunk/view/settings.php](/changeset/2926660/chp-ads-block-detector/trunk/view/settings.php "Show the changeset 2926660 restricted to chp-ads-block-detector/trunk/view/settings.php")

  | [r2922313](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2922313#L241 "Show revision 2922313 of this file in browser") | [r2926660](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2926660#L241 "Show revision 2926660 of this file in browser") |  |
  | --- | --- | --- |
  | 241 | 241 | <div class="chp\_ads\_button\_row"> |
  | 242 | 242 | <?php echo wp\_nonce\_field('update\_chpadb\_settings'); ?> |
  | 243 |  | <button class="button button-primary" type="button" |
  | 244 |  | id="chp\_ads\_save\_settings"><?php esc\_attr\_e('Save Changes', 'chp-adsblocker-detector'); ?></button> |
  | 245 |  | <button class="button button-secondary" type="button" |
  | 246 |  | id="chp\_ads\_reset\_settings"><?php esc\_attr\_e('Reset Changes', 'chp-adsblocker-detector'); ?></button> |
  |  | 243 | <button class="button button-primary" type="button" id="chp\_ads\_save\_settings"><?php esc\_attr\_e('Save Changes', 'chp-adsblocker-detector'); ?></button> |
  |  | 244 | <button class="button button-secondary" type="button" id="chp\_ads\_reset\_settings"><?php esc\_attr\_e('Reset Changes', 'chp-adsblocker-detector'); ?></button> |
  | 247 | 245 | </div> |
  | 248 | 246 | </div> |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2926660)
* [Zip Archive](?format=zip&new=2926660)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_bd447234_20250111_054121.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2920522%2Fchp-ads-block-detector)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2912322/chp-ads-block-detector "Changeset 2912322 for chp-ads-block-detector")
* [Next Change](/changeset/2922313/chp-ads-block-detector "Changeset 2922313 for chp-ads-block-detector") →

---

# Changeset [2920522](/changeset/2920522 "Show full changeset") for [chp-ads-block-detector](/browser/chp-ads-block-detector?rev=2920522 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
06/02/2023 09:29:57 AM
([20 months](/timeline?from=2023-06-02T09%3A29%3A57Z&precision=second "See timeline at 06/02/2023 09:29:57 AM") ago)

Author:
sureshchand12a
Message:

Security Update

Location:
[chp-ads-block-detector/trunk](/browser/chp-ads-block-detector/trunk?rev=2920522)
Files:

7 edited

* [assets/js/admin.js](/browser/chp-ads-block-detector/trunk/assets/js/admin.js?rev=2920522 "Show entry in browser")
  (modified)
  ([4 diffs](#file0 "Show differences"))
* [chp-adsblocker-detector.php](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2920522 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [composer.json](/browser/chp-ads-block-detector/trunk/composer.json?rev=2920522 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [includes/ajax.php](/browser/chp-ads-block-detector/trunk/includes/ajax.php?rev=2920522 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [readme.md](/browser/chp-ads-block-detector/trunk/readme.md?rev=2920522 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [readme.txt](/browser/chp-ads-block-detector/trunk/readme.txt?rev=2920522 "Show entry in browser")
  (modified)
  ([2 diffs](#file5 "Show differences"))
* [view/settings.php](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [chp-ads-block-detector/trunk/assets/js/admin.js](/changeset/2920522/chp-ads-block-detector/trunk/assets/js/admin.js "Show the changeset 2920522 restricted to chp-ads-block-detector/trunk/assets/js/admin.js")

  | [r2756270](/browser/chp-ads-block-detector/trunk/assets/js/admin.js?rev=2756270#L1 "Show revision 2756270 of this file in browser") | [r2920522](/browser/chp-ads-block-detector/trunk/assets/js/admin.js?rev=2920522#L1 "Show revision 2920522 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | !(function (~~n~~) { |
  | 2 |  | ~~n~~(document).on("ready", function () { |
  | 3 |  | 0 < ~~n(".chp\_ads\_color\_picker").length && n~~(".chp\_ads\_color\_picker").wpColorPicker(); |
  |  | 1 | !(function ($) { |
  |  | 2 | $(document).on("ready", function () { |
  |  | 3 | 0 < $(".chp\_ads\_color\_picker").length && $(".chp\_ads\_color\_picker").wpColorPicker(); |
  | 4 | 4 | }); |
  | 5 | 5 |  |
  | […](/browser/chp-ads-block-detector/trunk/assets/js/admin.js?rev=2756270#L9) | […](/browser/chp-ads-block-detector/trunk/assets/js/admin.js?rev=2920522#L9) |  |
  | 9 | 9 | try { |
  | 10 | 10 | let editor = tinyMCE.get(inputid); |
  | 11 |  | let textArea = ~~jQuery~~('textarea#' + inputid); |
  |  | 11 | let textArea = $('textarea#' + inputid); |
  | 12 | 12 | if (textArea.length > 0 && textArea.is(':visible')) { |
  | 13 | 13 | content = textArea.val(); |
  | […](/browser/chp-ads-block-detector/trunk/assets/js/admin.js?rev=2756270#L16) | […](/browser/chp-ads-block-detector/trunk/assets/js/admin.js?rev=2920522#L16) |  |
  | 16 | 16 | } |
  | 17 | 17 | } catch (error) { |
  | 18 |  | content = ~~jQuery~~('textarea#' + inputid).val(); |
  |  | 18 | content = $('textarea#' + inputid).val(); |
  | 19 | 19 | } |
  | 20 | 20 | return content; |
  | 21 | 21 | } |
  | 22 | 22 |  |
  | 23 |  | ~~n~~(document).on("click", "#chp\_ads\_save\_settings", function (t) { |
  |  | 23 | $(document).on("click", "#chp\_ads\_save\_settings", function (t) { |
  | 24 | 24 | t.preventDefault(); |
  | 25 |  | var e = ~~n~~(this), |
  |  | 25 | var e = $(this), |
  | 26 | 26 | c = e.html(); |
  | 27 | 27 | e.html('<img style="width:15px;" src="' + chpadb.plugin\_path + 'assets/img/load.gif">'); |
  | 28 | 28 | var i = { content: get\_tinymce\_content("chp\_ads\_content") }; |
  | 29 | 29 |  |
  | 30 |  | ~~n~~(document).find(".chpabd\_form\_settings.include").each(function () { |
  | 31 |  | if (~~n~~(this).attr('type') == 'checkbox') |
  | 32 |  | i[~~n(this).attr('name')] = n~~(this).is(':checked') ? 'true' : 'false'; |
  |  | 30 | $(document).find(".chpabd\_form\_settings.include").each(function () { |
  |  | 31 | if ($(this).attr('type') == 'checkbox') |
  |  | 32 | i[$(this).attr('name')] = $(this).is(':checked') ? 'true' : 'false'; |
  | 33 | 33 | else |
  | 34 |  | i[~~n(this).attr('name')] = n~~(this).val(); |
  |  | 34 | i[$(this).attr('name')] = $(this).val(); |
  | 35 | 35 | }); |
  | 36 | 36 | t = { action: "chp\_abd\_action", settings: i }; |
  | 37 |  |  |
  | 38 |  | jQuery.post(ajaxurl, t, function (t) { |
  |  | 37 | t.\_wpnonce = $(document).find("#\_wpnonce").val(); |
  |  | 38 |  |
  |  | 39 | $.post(ajaxurl, t, function (t) { |
  | 39 | 40 | alert(t); |
  | 40 | 41 | e.html(c); |
  | […](/browser/chp-ads-block-detector/trunk/assets/js/admin.js?rev=2756270#L42) | […](/browser/chp-ads-block-detector/trunk/assets/js/admin.js?rev=2920522#L43) |  |
  | 42 | 43 | }); |
  | 43 | 44 |  |
  | 44 |  | ~~n~~(document).on("click", "#chp\_ads\_reset\_settings", function (t) { |
  |  | 45 | $(document).on("click", "#chp\_ads\_reset\_settings", function (t) { |
  | 45 | 46 | t.preventDefault(); |
  | 46 |  | var e = ~~n~~(this), |
  |  | 47 | var e = $(this), |
  | 47 | 48 | c = e.html(); |
  | 48 | 49 | e.html('<img style="width:15px;" src="' + chpadb.plugin\_path + 'assets/img/load.gif">'); |
  | 49 |  | jQuery.post(ajaxurl, { action: "chp\_abd\_action", reset: "reset" }, function (t) { |
  |  | 50 | $.post(ajaxurl, { |
  |  | 51 | action: "chp\_abd\_action", |
  |  | 52 | reset: "reset" , |
  |  | 53 | \_wpnonce : $(document).find("#\_wpnonce").val() |
  |  | 54 | }, function (t) { |
  | 50 | 55 | alert(t); |
  | 51 | 56 | window.location.href = window.location.href; |
* ## [chp-ads-block-detector/trunk/chp-adsblocker-detector.php](/changeset/2920522/chp-ads-block-detector/trunk/chp-adsblocker-detector.php "Show the changeset 2920522 restricted to chp-ads-block-detector/trunk/chp-adsblocker-detector.php")

  | [r2912322](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2912322#L5 "Show revision 2912322 of this file in browser") | [r2920522](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2920522#L5 "Show revision 2920522 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | \* Plugin URI:        https://chpadblock.com |
  | 6 | 6 | \* Description:       CHP Ads Block Detector plugin is developed in order to  detect most of the AdBlock extensions installed on the browser and show a popup to disable the extension. This plugin restricts the user to access the page unless the user will disable the extension for your website. |
  | 7 |  | \* Version:           3.9.~~5~~ |
  |  | 7 | \* Version:           3.9.6 |
  | 8 | 8 | \* Requires at least: 5.2 |
  | 9 | 9 | \* Requires PHP:      7.2 |
  | […](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2912322#L124) | […](/browser/chp-ads-block-detector/trunk/chp-adsblocker-detector.php?rev=2920522#L124) |  |
  | 124 | 124 | //load all the constants |
  | 125 | 125 | $consts = array( |
  | 126 |  | 'CHP\_ADSB\_VERSION' => '3.9.~~5~~', |
  |  | 126 | 'CHP\_ADSB\_VERSION' => '3.9.6', |
  | 127 | 127 | 'CHP\_ADSB\_DIR' => plugin\_dir\_path(\_\_FILE\_\_), |
  | 128 | 128 | 'CHP\_ADSB\_URL' => plugin\_dir\_url(\_\_FILE\_\_), |
* ## [chp-ads-block-detector/trunk/composer.json](/changeset/2920522/chp-ads-block-detector/trunk/composer.json "Show the changeset 2920522 restricted to chp-ads-block-detector/trunk/composer.json")

  | [r2912322](/browser/chp-ads-block-detector/trunk/composer.json?rev=2912322#L1 "Show revision 2912322 of this file in browser") | [r2920522](/browser/chp-ads-block-detector/trunk/composer.json?rev=2920522#L1 "Show revision 2920522 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | { |
  | 2 | 2 | "name": "scthakuri12a/chp-ads-block-detector", |
  | 3 |  | "version": "3.9.~~5~~", |
  |  | 3 | "version": "3.9.6", |
  | 4 | 4 | "description": "Block Ads Blocker Extensions and Increase your revenue by using Ads Blocker Detector Plugin", |
  | 5 | 5 | "homepage": "https://wordpress.org/plugins/chp-ads-block-detector/", |
* ## [chp-ads-block-detector/trunk/includes/ajax.php](/changeset/2920522/chp-ads-block-detector/trunk/includes/ajax.php "Show the changeset 2920522 restricted to chp-ads-block-detector/trunk/includes/ajax.php")

  | [r2876305](/browser/chp-ads-block-detector/trunk/includes/ajax.php?rev=2876305#L82 "Show revision 2876305 of this file in browser") | [r2920522](/browser/chp-ads-block-detector/trunk/includes/ajax.php?rev=2920522#L82 "Show revision 2920522 of this file in browser") |  |
  | --- | --- | --- |
  | 82 | 82 | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
  | 83 | 83 | Save All the settings |
  | 84 |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
  | 85 |  | if( isset( $\_POST['settings'] ) ){ |
  | 86 |  | $settings = $this->recursive\_sanitize\_array\_field($\_POST['settings']); |
  | 87 |  | $defaults = (array) \CHPADB\Includes\defaults(); |
  | 88 |  | if(is\_array($settings) && !empty($settings)){ |
  |  | 84 | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
  |  | 85 | if ( isset($\_REQUEST['\_wpnonce']) && wp\_verify\_nonce($\_REQUEST['\_wpnonce'], 'update\_chpadb\_settings' ) ){ |
  |  | 86 | if( isset( $\_POST['settings'] ) ){ |
  |  | 87 | $settings = $this->recursive\_sanitize\_array\_field($\_POST['settings']); |
  |  | 88 | $defaults = (array) \CHPADB\Includes\defaults(); |
  |  | 89 | if(is\_array($settings) && !empty($settings)){ |
  |  | 90 |  |
  |  | 91 | //sanitize post message |
  |  | 92 | $newSettings = array(); |
  |  | 93 | foreach($settings as $k => $v){ |
  |  | 94 | if( isset( $settings[$k] ) ){ |
  |  | 95 | if( $k == 'content' ){ |
  |  | 96 | $newSettings[$k] = wp\_kses\_post($settings[$k]); |
  |  | 97 | }else if( $k == 'servers' ){ |
  |  | 98 | $newSettings[$k] = sanitize\_textarea\_field($settings[$k]); |
  |  | 99 | }else{ |
  |  | 100 | $newSettings[$k] = sanitize\_text\_field($settings[$k]); |
  |  | 101 | } |
  |  | 102 | }else{ |
  |  | 103 | $newSettings[$k] = $defaults[$k]; |
  |  | 104 | } |
  |  | 105 | } |
  |  | 106 | update\_option( "chpadb\_plugin\_settings", json\_encode($newSettings) ); |
  |  | 107 |  |
  |  | 108 | echo \_\_('Settings save successfully', 'chp-adsblocker-detector'); |
  |  | 109 | }else{ |
  |  | 110 | echo \_\_('We got some issue on updating settings.', 'chp-adsblocker-detector'); |
  |  | 111 | } |
  |  | 112 | } |
  | 89 | 113 |  |
  | 90 |  | //sanitize post message |
  | 91 |  | $newSettings = array(); |
  | 92 |  | foreach($settings as $k => $v){ |
  | 93 |  | if( isset( $settings[$k] ) ){ |
  | 94 |  | if( $k == 'content' ){ |
  | 95 |  | $newSettings[$k] = wp\_kses\_post($settings[$k]); |
  | 96 |  | }else if( $k == 'servers' ){ |
  | 97 |  | $newSettings[$k] = sanitize\_textarea\_field($settings[$k]); |
  | 98 |  | }else{ |
  | 99 |  | $newSettings[$k] = sanitize\_text\_field($settings[$k]); |
  | 100 |  | } |
  | 101 |  | }else{ |
  | 102 |  | $newSettings[$k] = $defaults[$k]; |
  | 103 |  | } |
  | 104 |  | } |
  | 105 |  | update\_option( "chpadb\_plugin\_settings", json\_encode($newSettings) ); |
  |  | 114 | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
  |  | 115 | Reset All the settings |
  |  | 116 | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
  |  | 117 | if( isset( $\_POST['reset'] ) ){ |
  |  | 118 | setDefaultValues(); |
  | 106 | 119 |  |
  | 107 |  | echo \_\_('Settings save successfully', 'chp-adsblocker-detector'); |
  | 108 |  | }else{ |
  | 109 |  | echo \_\_('We got some issue on updating settings.', 'chp-adsblocker-detector'); |
  |  | 120 | echo \_\_('Settings reset successfully.', 'chp-adsblocker-detector'); |
  | 110 | 121 | } |
  | 111 |  | } |
  | 112 |  |  |
  | 113 |  |  |
  | 114 |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
  | 115 |  | Reset All the settings |
  | 116 |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
  | 117 |  | if( isset( $\_POST['reset'] ) ){ |
  | 118 |  | setDefaultValues(); |
  | 119 |  |  |
  | 120 |  | echo \_\_('Settings reset successfully.', 'chp-adsblocker-detector'); |
  |  | 122 | }else{ |
  |  | 123 | echo \_\_('Unable to update settings.', 'chp-adsblocker-detector'); |
  |  | 124 | die(); |
  | 121 | 125 | } |
  | 122 | 126 |  |
* ## [chp-ads-block-detector/trunk/readme.md](/changeset/2920522/chp-ads-block-detector/trunk/readme.md "Show the changeset 2920522 restricted to chp-ads-block-detector/trunk/readme.md")

  | [r2882403](/browser/chp-ads-block-detector/trunk/readme.md?rev=2882403#L79 "Show revision 2882403 of this file in browser") | [r2920522](/browser/chp-ads-block-detector/trunk/readme.md?rev=2920522#L79 "Show revision 2920522 of this file in browser") |  |
  | --- | --- | --- |
  | 79 | 79 |  |
  | 80 | 80 | \*\*Q:\*\* WHAT IS CONTENT WRAPPER SETTINGS? |
  |  | 81 |  |
  | 81 | 82 | \*\*A:\*\* Content Wrapper settings is new released settings on PRO release. This settings will detect the content on the page and blur the content and show the adblock message over the content. You don't need additional setup for this. Just enable this settings. For more details, [check here](https://chpadblock.com/docs/content-wrapper/). |
  | 82 | 83 |  |
  | 83 | 84 |  |
  | 84 | 85 | \*\*Q:\*\* IS IT WORKING FOR OPERA BUILT-IN ADS BLOCKER EXTENSION? |
  |  | 86 |  |
  | 85 | 87 | \*\*A:\*\* Yes, we have tested our plugin for opera built-in ads blocker extension on 1.2 version. We would recommend you to use latest version which will support for opera also. |
  | 86 | 88 |  |
  | 87 | 89 | \*\*Q:\*\* IS IT WORKING WITH GOOGLE ADSENSE? |
  |  | 90 |  |
  | 88 | 91 | \*\*A:\*\* Yes, and probably with all kinds of content hidden by AdBlocker software. |
  | 89 | 92 |  |
  | 90 | 93 | \*\*Q:\*\* IS IT COMBABILITY WITH CACHING SYSTEM? |
  |  | 94 |  |
  | 91 | 95 | \*\*A:\*\* Yes, it is. It may depend on the parameter also. |
  | 92 | 96 |  |
  | 93 | 97 | \*\*Q:\*\* IS THIS COMPATIBLE WITH WOOCOMMERCE? |
  |  | 98 |  |
  | 94 | 99 | \*\*A:\*\* Yes, it is. It will compatible with most of the plugin that exists on WordPress repository. |
  | 95 | 100 |  |
  | 96 | 101 | \*\*Q:\*\* I FOUND INCOMPATIBILITY, WHAT WILL I DO? |
  |  | 102 |  |
  | 97 | 103 | \*\*A:\*\* Please create a forum in [https://chpadblock.com/docs/support/](https://chpadblock.com/docs/support/) or WordPress support inside the CHP Ads Block Detector section. We will contact you as soon as possible. |
  | 98 | 104 |  |
  | 99 | 105 | \*\*Q:\*\* CAN I IMPLEMENT CUSTOM MODAL? |
  |  | 106 |  |
  | 100 | 107 | \*\*A:\*\* Yes, For this you have to purchase the premium version of Ads Block Detector. And also [check the documentation](https://chpadblock.com/docs/custom-modal/). |
  | 101 | 108 |  |
  | 102 | 109 | \*\*CHANGELOG\*\* |
  | 103 | 110 |  |
  | 104 |  | = 3.9.2 = |
  | 105 |  | \*  ☞ Remove Branding Settings |
  | 106 |  | \*  ☞ Updated Server List |
  | 107 |  | \*  ☞ Minor issues fixed |
  | 108 |  |  |
  | 109 |  | = 3.8.9 = |
  | 110 |  | \*  ☞ Optimize plugin images |
  | 111 |  | \*  ☞ Removed Image Request Method |
  | 112 |  | \*  ☞ Minor issues fixed |
  | 113 |  |  |
  | 114 |  | = 3.8.8 = |
  | 115 |  | \*  ☞ Fix for uBlock Extension |
  | 116 |  | \*  ☞ Favicon not showing on activation [Oceanwp theme] |
  | 117 |  |  |
  | 118 |  | = 3.8.7 = |
  | 119 |  | \*  ☞ Popup Vertical Alignment |
  | 120 |  | \*  ☞ Adguard popup fixed |
  | 121 |  |  |
  | 122 |  | = 3.8.4 = |
  | 123 |  | \*  ☞ Popup Vertical Alignment |
  | 124 |  | \*  ☞ Adguard popup fixed |
  | 125 |  |  |
  | 126 |  | = 3.8.1 = |
  | 127 |  | \*  ☞ Improve Random Class generator |
  | 128 |  | \*  ☞ Compatible with wordpress 6.0 |
  | 129 |  |  |
  | 130 |  | \*\*\*3.6.1\*\*\* |
  | 131 |  | \*  ☞ Multiple Ads server added |
  | 132 |  | \*  ☞ Supported to wordpress 6.0 Version |
  | 133 |  |  |
  | 134 |  | \*\*\*3.6\*\*\* |
  | 135 |  | \*  ☞ Class Ads Request Issue Fixed |
  | 136 |  | \*  ☞ Remove Check Request on fixed interval |
  | 137 |  | \*  ☞ Minor Issue Fixed |
  | 138 |  |  |
  | 139 |  | \*\*\*3.5\*\*\* |
  | 140 |  | \*  ☞ Sine our plugin is whitelist autmatically by adblock extension, We have added random class generator to free version also. We request you to update your plugin immediately. |
  | 141 |  | \*  ☞ Random Class Generator [On every refresh, the classes and ids are changed.] |
  | 142 |  | \*  ☞ Remove Hide on Mobile |
  | 143 |  | \*  ☞ Remove Interval Check |
  | 144 |  | \*  ☞ Minify css and js code automatically while rendering |
  | 145 |  | \*  ☞ Can control google,image and class ads request |
  | 146 |  |  |
  | 147 |  | \*\*\*3.4.1\*\*\* |
  | 148 |  | \*  ☞ Make stable with wordpress |
  | 149 |  | \*  ☞ Minor Issues Fixed |
  | 150 |  |  |
  | 151 |  | \*\*\*2.5.5\*\*\* |
  | 152 |  | \*  ☞ Fixed: Error shown if adblock is disabled also |
  | 153 |  | \*  ☞ Improved: Improved way to check the ad block extension |
  | 154 |  | \*  ☞ Added: Now, You can customize interval to check for adblock extensions. On each interval of time, Script will check whether adblock is installed or not. [Check the documentation](https://chpadblock.com/docs/filter-hooks/) for more details. |
  | 155 |  |  |
  | 156 |  | \*\*\*2.5.3\*\*\* |
  | 157 |  | \*  ☞ Added: Ability to control the multiple request |
  | 158 |  | \*  ☞ Improved: Plugin Performance |
  | 159 |  | \*  ☞ Added: Ability to Customize icon |
  | 160 |  | \*  ☞ Minor Bug fixes |
  | 161 |  |  |
  | 162 |  | \*\*\*2.5.2\*\*\* |
  | 163 |  | \*  ☞ Added: Ability to disable the plugin via filter hook |
  | 164 |  | \*  ☞ Minor Bug fixes |
  | 165 |  |  |
  | 166 |  | \*\*\*2.5.0\*\*\* |
  | 167 |  | \*  ☞ Improved : Adjust to theme color |
  | 168 |  | \*  ☞ Improved : For Opera Built-in AdBlock extension |
  | 169 |  | \*  ☞ Added : New languages added |
  | 170 |  | \*  ☞ Minor Bug fixes |
  | 171 |  |  |
  | 172 |  | \*\*\*2.3.1\*\*\* |
  | 173 |  | \*  ☞ Improved : Plugin Disable for single page |
  | 174 |  | \*  ☞ Fixed : Plugin Security |
  | 175 |  | \*  ☞ Minor Bug fixes |
  | 176 |  |  |
  | 177 |  | \*\*\*2.3\*\*\* |
  | 178 |  | \*  ☞ Fixed : Plugin Security |
  | 179 |  | \*  ☞ Minor Bug fixes |
  | 180 |  |  |
  | 181 |  | \*\*\*2.2\*\*\* |
  | 182 |  | \*  ☞ Minor Bug fixes |
  | 183 |  |  |
  | 184 |  | \*\*\*2.1\*\*\* |
  | 185 |  | \*  ☞ Fixed : Responsive Issue |
  | 186 |  | \*  ☞ Fixed : Not detecting for ublock extension |
  | 187 |  | \*  ☞ Minor Bug fixes |
  | 188 |  |  |
  | 189 |  | \*\*\*1.2\*\*\* |
  | 190 |  | \*  ☞ Fixes for opera built-in ads block extension |
  | 191 |  | \*  ☞ Increase on plugin performance |
  | 192 |  | \*  ☞ Minor Bug fixes |
  | 193 |  |  |
  | 194 |  | \*\*\*1.1\*\*\* |
  | 195 |  | \*  ☞ Change style of the popup |
  | 196 |  | \*  ☞ Customize own title or message |
  | 197 |  | \*  ☞ Custom Buttons text |
  | 198 |  | \*  ☞ Popup Alignment |
  | 199 |  | \*  ☞ Minor Bug fixes |
  | 200 |  |  |
  | 201 |  | \*\*\*1.0\*\*\* |
  | 202 |  | Initail Release |
  |  | 111 | > ## v3.9.6 (02/06/2023) |
  |  | 112 | > |
  |  | 113 | > - Security Update |
  |  | 114 |  |
  |  | 115 | > ## v3.9.5 (15/05/2023) |
  |  | 116 | > |
  |  | 117 | > - Compressed Scripts |
  |  | 118 | > - Include Script in Header or Footer Support |
  |  | 119 | > - Fixed for uBlock origin extension |
  |  | 120 | > - Minor issues fixed |
  |  | 121 |  |
  |  | 122 | > ## v3.8.9 |
  |  | 123 | > |
  |  | 124 | > - Optimize plugin images |
  |  | 125 | > - Removed Image Request Method |
  |  | 126 | > - Minor issues fixed |
  |  | 127 |  |
  |  | 128 | > ## v3.8.8 |
  |  | 129 | > |
  |  | 130 | > - Fix for uBlock Extension |
  |  | 131 | > - Favicon not showing on activation [Oceanwp theme] |
  |  | 132 |  |
  |  | 133 | > ## v3.8.7 |
  |  | 134 | > |
  |  | 135 | > - Popup Vertical Alignment |
  |  | 136 | > - Adguard popup fixed |
  |  | 137 |  |
  |  | 138 | > ## v3.8.4 |
  |  | 139 | > |
  |  | 140 | > - Popup Vertical Alignment |
  |  | 141 | > - Adguard popup fixed |
  |  | 142 |  |
  |  | 143 | > ## v3.8.1 |
  |  | 144 | > |
  |  | 145 | > - Improve Random Class generator |
  |  | 146 | > - Compatible with wordpress 6.0 |
  |  | 147 |  |
  |  | 148 | > ## v3.6.1 |
  |  | 149 | > |
  |  | 150 | > - Multiple Ads server added |
  |  | 151 | > - Supported to wordpress 6.0 Version |
  |  | 152 |  |
  |  | 153 | > ## v3.6 |
  |  | 154 | > |
  |  | 155 | > - Class Ads Request Issue Fixed |
  |  | 156 | > - Remove Check Request on fixed interval |
  |  | 157 | > - Minor Issue Fixed |
  |  | 158 |  |
  |  | 159 | > ## v3.5 |
  |  | 160 | > |
  |  | 161 | > - Sine our plugin is whitelist autmatically by adblock extension, We have added random class generator to free version also. We request you to update your plugin immediately. |
  |  | 162 | > - Random Class Generator [On every refresh, the classes and ids are changed.] |
  |  | 163 | > - Remove Hide on Mobile |
  |  | 164 | > - Remove Interval Check |
  |  | 165 | > - Minify css and js code automatically while rendering |
  |  | 166 | > - Can control google,image and class ads request |
  |  | 167 |  |
  |  | 168 | > ## v3.4.1 |
  |  | 169 | > |
  |  | 170 | > - Make stable with wordpress |
  |  | 171 | > - Minor Issues Fixed |
  |  | 172 |  |
  |  | 173 | > ## v2.5.5 |
  |  | 174 | > |
  |  | 175 | > - Fixed: Error shown if adblock is disabled also |
  |  | 176 | > - Improved: Improved way to check the ad block extension |
  |  | 177 | > - Added: Now, You can customize interval to check for adblock extensions. On each interval of time, Script will check whether adblock is installed or not. [Check the documentation](https://chpadblock.com/docs/filter-hooks/) for more details. |
  |  | 178 |  |
  |  | 179 | > ## v2.5.3 |
  |  | 180 | > |
  |  | 181 | > - Added: Ability to control the multiple request |
  |  | 182 | > - Improved: Plugin Performance |
  |  | 183 | > - Added: Ability to Customize icon |
  |  | 184 | > - Minor Bug fixes |
  |  | 185 |  |
  |  | 186 | > ## v2.5.2 |
  |  | 187 | > |
  |  | 188 | > - Added: Ability to disable the plugin via filter hook |
  |  | 189 | > - Minor Bug fixes |
  |  | 190 |  |
  |  | 191 | > ## v2.5.0 |
  |  | 192 | > |
  |  | 193 | > - Improved : Adjust to theme color |
  |  | 194 | > - Improved : For Opera Built-in AdBlock extension |
  |  | 195 | > - Added : New languages added |
  |  | 196 | > - Minor Bug fixes |
  |  | 197 |  |
  |  | 198 | > ## v2.3.1 |
  |  | 199 | > |
  |  | 200 | > - Improved : Plugin Disable for single page |
  |  | 201 | > - Fixed : Plugin Security |
  |  | 202 | > - Minor Bug fixes |
  |  | 203 |  |
  |  | 204 | > ## v2.3 |
  |  | 205 | > |
  |  | 206 | > - Fixed : Plugin Security |
  |  | 207 | > - Minor Bug fixes |
  |  | 208 |  |
  |  | 209 | > ## v2.2 |
  |  | 210 | > |
  |  | 211 | > - Minor Bug fixes |
  |  | 212 |  |
  |  | 213 | > ## v2.1 |
  |  | 214 | > |
  |  | 215 | > - Fixed : Responsive Issue |
  |  | 216 | > - Fixed : Not detecting for ublock extension |
  |  | 217 | > - Minor Bug fixes |
  |  | 218 |  |
  |  | 219 | > ## v1.2 |
  |  | 220 | > |
  |  | 221 | > - Fixes for opera built-in ads block extension |
  |  | 222 | > - Increase on plugin performance |
  |  | 223 | > - Minor Bug fixes |
  |  | 224 |  |
  |  | 225 | > ## v1.1 |
  |  | 226 | > |
  |  | 227 | > - Change style of the popup |
  |  | 228 | > - Customize own title or message |
  |  | 229 | > - Custom Buttons text |
  |  | 230 | > - Popup Alignment |
  |  | 231 | > - Minor Bug fixes |
  |  | 232 |  |
  |  | 233 | > ## v1.0 |
  |  | 234 | > |
  |  | 235 | > - Initail Release |
* ## [chp-ads-block-detector/trunk/readme.txt](/changeset/2920522/chp-ads-block-detector/trunk/readme.txt "Show the changeset 2920522 restricted to chp-ads-block-detector/trunk/readme.txt")

  | [r2912322](/browser/chp-ads-block-detector/trunk/readme.txt?rev=2912322#L4 "Show revision 2912322 of this file in browser") | [r2920522](/browser/chp-ads-block-detector/trunk/readme.txt?rev=2920522#L4 "Show revision 2920522 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 5.2 |
  | 5 | 5 | Tested up to: 6.2 |
  | 6 |  | Stable tag: 3.9.~~5~~ |
  |  | 6 | Stable tag: 3.9.6 |
  | 7 | 7 | Requires PHP: 7.2 |
  | 8 | 8 | License: GPLv2 or later |
  | […](/browser/chp-ads-block-detector/trunk/readme.txt?rev=2912322#L137) | […](/browser/chp-ads-block-detector/trunk/readme.txt?rev=2920522#L137) |  |
  | 137 | 137 | == Changelog == |
  | 138 | 138 |  |
  |  | 139 | = 3.9.6 = |
  |  | 140 | \*  ☞ Security Update |
  |  | 141 |  |
  | 139 | 142 | = 3.9.5 = |
  | 140 | 143 | \*  ☞ Include Script in Header or Footer Support |
* ## [chp-ads-block-detector/trunk/view/settings.php](/changeset/2920522/chp-ads-block-detector/trunk/view/settings.php "Show the changeset 2920522 restricted to chp-ads-block-detector/trunk/view/settings.php")

  | [r2912322](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2912322#L241 "Show revision 2912322 of this file in browser") | [r2920522](/browser/chp-ads-block-detector/trunk/view/settings.php?rev=2920522#L241 "Show revision 2920522 of this file in browser") |  |
  | --- | --- | --- |
  | 241 | 241 |  |
  | 242 | 242 | <div class="chp\_ads\_button\_row"> |
  |  | 243 | <?php echo wp\_nonce\_field('update\_chpadb\_settings'); ?> |
  | 243 | 244 | <button class="button button-primary" type="button" |
  | 244 | 245 | id="chp\_ads\_save\_settings"><?php \_e('Save Changes', 'chp-adsblocker-detector'); ?></button> |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2920522)
* [Zip Archive](?format=zip&new=2920522)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_b840e822_20250111_054126.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# CHP Ads Block Detector <= 3.9.4 - Missing Authorization to Plugin Settings Update

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   CHP Ads Block Detector <= 3.9.4 - Missing Authorization to Plugin Settings Update

4.3

**Missing Authorization**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

| CVE | [CVE-2023-2353](https://www.cve.org/CVERecord?id=CVE-2023-2353) |
| --- | --- |
| CVSS | 4.3 (Medium) |
| Publicly Published | June 15, 2023 |
| Last Updated | January 22, 2024 |
| Researcher | [Marco Wotschka - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/marco-wotschka) |

### Description

The CHP Ads Block Detector plugin for WordPress is vulnerable to unauthorized plugin settings update and reset due to a missing capability check on the chp\_abd\_action function in versions up to, and including, 3.9.4. This makes it possible for subscriber-level attackers to change or reset plugin settings. CVE-2023-36509 appears to be a duplicate of this issue.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/2920522/chp-ads-block-detector)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/2922313/chp-ads-block-detector)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/2926660/chp-ads-block-detector)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fchp-ads-block-detector%2Fchp-ads-block-detector-394-missing-authorization-to-plugin-settings-update&t=CHP%20Ads%20Block%20Detector%20%3C%3D%203.9.4%20-%20Missing%20Authorization%20to%20Plugin%20Settings%20Update "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fchp-ads-block-detector%2Fchp-ads-block-detector-394-missing-authorization-to-plugin-settings-update&text=CHP%20Ads%20Block%20Detector%20%3C%3D%203.9.4%20-%20Missing%20Authorization%20to%20Plugin%20Settings%20Update "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fchp-ads-block-detector%2Fchp-ads-block-detector-394-missing-authorization-to-plugin-settings-update "LinkedIn")
Email

## Vulnerability Details for CHP Ads Block Detector

#### [CHP Ads Block Detector](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/chp-ads-block-detector)

| Software Type | Plugin |
| --- | --- |
| Software Slug | chp-ads-block-detector [(view on wordpress.org)](https://wordpress.org/plugins/chp-ads-block-detector) |
| Patched? | Yes |
| Remediation | Update to version 3.9.8, or a newer patched version |
| Affected Version | * <= 3.9.4 |
| Patched Version | * 3.9.8 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


