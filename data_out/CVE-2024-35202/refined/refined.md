```
{
  "cve": "CVE-2024-35202",
  "description": "Before Bitcoin Core v25.0, an attacker could remotely crash Bitcoin Core nodes by triggering an assertion in the blocktxn message handling logic.",
  "affected_versions": "< v25.0",
  "root_cause": "The vulnerability stems from the way Bitcoin Core handles compact block reconstruction and the subsequent processing of blocktxn messages. Specifically, a `PartiallyDownloadedBlock` instance is not properly reset after a compact block reconstruction fails due to short-id collisions. This allows a second blocktxn message for the same block to be processed, triggering the `FillBlock` function more than once, violating an assertion and leading to a crash.",
  "vulnerabilities": [
    "Improper handling of compact block reconstruction failures.",
    "Missing state reset after failed block reconstruction due to short-id collisions.",
    "Violation of an assertion that `FillBlock` can only be called once.",
     "Lack of input validation on transactions included in blocktxn message, allowing for inclusion of uncommitted transactions."
  ],
  "impact": "Remote denial-of-service (DoS). An attacker can crash Bitcoin Core nodes.",
  "attack_vector": "The attacker sends a crafted `blocktxn` message that includes transactions not committed in the block's Merkle root after a short-id collision is detected.",
  "attacker_capabilities": "The attacker needs to be able to send network messages to a vulnerable Bitcoin Core node.",
  "additional_information": "The vulnerability is triggered when a compact block reconstruction fails due to short-id collisions, and the system fails to clear the state associated with the partially downloaded block allowing it to be reprocessed. An attacker doesn't need to rely on random short-id collisions and can force a collision by providing invalid transaction data in the `blocktxn` message."
}
```