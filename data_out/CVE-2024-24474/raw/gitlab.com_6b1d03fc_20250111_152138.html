





<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>heap-buffer-overflow in esp_do_dma() (#1810) · Issues · QEMU / QEMU · GitLab</title>
<script nonce="q3pHw79SKipFraIBJPmkLQ==">
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.com/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=100;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.analytics_url="https://collector.prd-278964.gl-product-analytics.com";gon.analytics_id="715db59f-f350-4bfd-aef8-e7a7f0c023f0";gon.sentry_dsn="https://f5573e26de8f4293b285e556c35dfd6e@new-sentry.gitlab.net/4";gon.sentry_environment="gprd";gon.sentry_clientside_traces_sample_rate=0.05;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="6LfAERQTAAAAAL4GYSiAMGLbcLyUIBSfPrDNJgeC";gon.gitlab_url="https://gitlab.com";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="35056b58a87";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-bd26211944b9d072037ec97cb138f1a52cd03ef185cd38b8d1fcc963245199a1.css";gon.emoji_backend_version=4;gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=null;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=0;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=true;gon.jh=false;gon.dot_com=true;gon.uf_error_prefix="UF";gon.pat_prefix="glpat-";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"findAndReplace":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"duoChatDynamicDimension":false,"advancedContextResolver":true,"preserveMarkdown":false,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":false,"workItemsBeta":false,"workItemsAlpha":false,"workItems":true,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false,"okrsMvc":false,"workItemEpics":true};gon.roadmap_epics_limit=1000;gon.subscriptions_url="https://customers.gitlab.com";gon.subscriptions_legacy_sign_in_url="https://customers.gitlab.com/customers/sign_in?legacy=true";gon.billing_accounts_url="https://customers.gitlab.com/billing_accounts";gon.payment_form_url="https://customers.gitlab.com/payment_forms/cc_validation";gon.payment_validation_form_id="payment_method_validation";gon.licensed_features={"escalationPolicies":true,"okrs":true};gon.abilities={"summarizeComments":false,"measureCommentTemperature":false};
//]]>
</script>


<script nonce="q3pHw79SKipFraIBJPmkLQ==">
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/qemu-project/qemu/-/issues/1810/related_branches":{},"/qemu-project/qemu/-/issues/1810/discussions.json?per_page=20":{},"/qemu-project/qemu/-/issues/1810.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = null;

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"xiSiwCRyHxkmj2TJgfJpjGYnfkMUJtZo_D6LwJxuOfAEf_ssZOtR6xhQzRKKXEFXYp_4WsuLV1eLndaZPzVYEQ","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.com/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-3ac16694767839eb5e86660635af7a58d98adbf48dd11dbf3d42f80beff008ee.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-f20ae9b5b8c9a0f793e3ffa2ddc13953bfd683e1d351c8e6cc75e0fcd4ddde90.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-b9f383aefa56f0a72990496e4a4b3aaf2c525843283a1c0c3d85876537187397.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-e25480d2326300d5c49ad31dbd847a53e39fc33a5fd595a961dd7238e411b558.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-7e727ab1e91b421915feadeb04a1b9d57213cb1b2f8f56f4d894b34d6b42e9b3.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-22a76cdd1fe2ae5431b7ff603f86212acaf81b49c4a932f19e3b3222dc1881ee.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" />
<link rel="stylesheet" href="/assets/tailwind-e004e28eba8aa7ab9946870893dbaa4961cf178d8f976367b60e77aeb3ae342c.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" />

<script src="/assets/webpack/runtime.3753ae21.bundle.js" defer="defer" nonce="q3pHw79SKipFraIBJPmkLQ=="></script>
<script src="/assets/webpack/main.ab6b0ac3.chunk.js" defer="defer" nonce="q3pHw79SKipFraIBJPmkLQ=="></script>
<script src="/assets/webpack/tracker.493c474d.chunk.js" defer="defer" nonce="q3pHw79SKipFraIBJPmkLQ=="></script>
<script src="/assets/webpack/analytics.4c4c0b50.chunk.js" defer="defer" nonce="q3pHw79SKipFraIBJPmkLQ=="></script>
<script nonce="q3pHw79SKipFraIBJPmkLQ==">
//<![CDATA[
window.snowplowOptions = {"namespace":"gl","hostname":"snowplowprd.trx.gitlab.net","cookieDomain":".gitlab.com","appId":"gitlab","formTracking":true,"linkClickTracking":true}

gl = window.gl || {};
gl.snowplowStandardContext = {"schema":"iglu:com.gitlab/gitlab_standard/jsonschema/1-1-1","data":{"environment":"production","source":"gitlab-rails","correlation_id":"01JHAZ9PMQ28Y3EVQ0G8HJ1RD7","plan":"opensource","extra":{},"user_id":null,"global_user_id":null,"is_gitlab_team_member":null,"namespace_id":3038080,"project_id":11167699,"feature_enabled_by_namespace_ids":null,"realm":"saas","instance_id":"ea8bf810-1d6f-4a6a-b4fd-93e8cbd8b57f","host_name":"gitlab-webservice-web-7d9464c448-nvdv2","instance_version":"17.8.0","context_generated_at":"2025-01-11T15:21:37.919Z"}}
gl.snowplowPseudonymizedPageUrl = "https://gitlab.com/namespace3038080/project11167699/-/issues/1810";
gl.maskedDefaultReferrerUrl = null;
gl.ga4MeasurementId = 'G-ENFH3X7M5Y';


//]]>
</script>
<link rel="preload" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" as="style" type="text/css" nonce="ZO3X8BA/eH+SW7ZNSkCxJg==">
<link rel="preload" href="/assets/application-3ac16694767839eb5e86660635af7a58d98adbf48dd11dbf3d42f80beff008ee.css" as="style" type="text/css" nonce="ZO3X8BA/eH+SW7ZNSkCxJg==">
<link rel="preload" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" as="style" type="text/css" nonce="ZO3X8BA/eH+SW7ZNSkCxJg==">
<link crossorigin="" href="https://snowplowprd.trx.gitlab.net" rel="preconnect">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-1e0a5107ea3bbd4be93e8ad2c503467e43166cd37e4293570b490e0812ede98b.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-Italic-38eaf1a569a54ab28c58b92a4a8de3afb96b6ebc250cf372003a7b38151848cc.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-08d2c5e8ff8fd3d2d6ec55bc7713380f8981c35f9d2df14e12b835464d6e8f23.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-Italic-38e58d8df29485a20c550da1d0111e2c2169f6dcbcf894f2cd3afbdd97bcc588.woff2" rel="preload">
<link rel="preload" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" as="style" type="text/css" nonce="ZO3X8BA/eH+SW7ZNSkCxJg==">



<script src="/assets/webpack/sentry.b707854c.chunk.js" defer="defer" nonce="q3pHw79SKipFraIBJPmkLQ=="></script>

<script src="/assets/webpack/10.983bd1ac.chunk.js" defer="defer" nonce="q3pHw79SKipFraIBJPmkLQ=="></script>
<script src="/assets/webpack/12.0b1b07c1.chunk.js" defer="defer" nonce="q3pHw79SKipFraIBJPmkLQ=="></script>
<script src="/assets/webpack/14.629d03c2.chunk.js" defer="defer" nonce="q3pHw79SKipFraIBJPmkLQ=="></script>
<script src="/assets/webpack/commons-pages.groups.analytics.dashboards-pages.groups.harbor.repositories-pages.groups.iteration_ca-b07ae190.ec7189d6.chunk.js" defer="defer" nonce="q3pHw79SKipFraIBJPmkLQ=="></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.570d5e43.chunk.js" defer="defer" nonce="q3pHw79SKipFraIBJPmkLQ=="></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.f7a558c9.chunk.js" defer="defer" nonce="q3pHw79SKipFraIBJPmkLQ=="></script>
<script src="/assets/webpack/super_sidebar.566fc613.chunk.js" defer="defer" nonce="q3pHw79SKipFraIBJPmkLQ=="></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-bce54798.33350df1.chunk.js" defer="defer" nonce="q3pHw79SKipFraIBJPmkLQ=="></script>
<script src="/assets/webpack/pages.projects.issues.show.3ad61df3.chunk.js" defer="defer" nonce="q3pHw79SKipFraIBJPmkLQ=="></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="heap-buffer-overflow in esp_do_dma() (#1810) · Issues · QEMU / QEMU · GitLab" property="og:title">
<meta content=" Host environment   Operating system: Ubuntu 20.04   OS/kernel version: Linux 5.4.0-148  ..." property="og:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/11167699/logo.png" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.com/qemu-project/qemu/-/issues/1810" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="heap-buffer-overflow in esp_do_dma() (#1810) · Issues · QEMU / QEMU · GitLab" property="twitter:title">
<meta content=" Host environment   Operating system: Ubuntu 20.04   OS/kernel version: Linux 5.4.0-148  ..." property="twitter:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/11167699/logo.png" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="Chuhong Yuan">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="J0P2UH_KAYO3X0MxwokpRLtegwQaaayOIPeTbW298WDlGK-8P1NPcYmA6urJJwGfv-YFHcXELbFXVM40zuaQgQ" />
<meta name="csp-nonce" content="q3pHw79SKipFraIBJPmkLQ==" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/assets/favicon-72a2cad5025aa931d6ea56c3201d1f18e68a8cd39788c7c80d5b2b82aa5143ef.png" id="favicon" data-original-href="/assets/favicon-72a2cad5025aa931d6ea56c3201d1f18e68a8cd39788c7c80d5b2b82aa5143ef.png" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content=" Host environment   Operating system: Ubuntu 20.04   OS/kernel version: Linux 5.4.0-148  ..." name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-group="qemu-project" data-group-full-path="qemu-project" data-namespace-id="3038080" data-page="projects:issues:show" data-page-type-id="1810" data-project="qemu" data-project-full-path="qemu-project/qemu" data-project-id="11167699">
<script nonce="q3pHw79SKipFraIBJPmkLQ==">
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"epics":"/qemu-project/qemu/-/autocomplete_sources/epics","iterations":"/qemu-project/qemu/-/autocomplete_sources/iterations","vulnerabilities":"/qemu-project/qemu/-/autocomplete_sources/vulnerabilities","members":"/qemu-project/qemu/-/autocomplete_sources/members?type=Issue\u0026type_id=1810","issues":"/qemu-project/qemu/-/autocomplete_sources/issues","mergeRequests":"/qemu-project/qemu/-/autocomplete_sources/merge_requests","labels":"/qemu-project/qemu/-/autocomplete_sources/labels?type=Issue\u0026type_id=1810","milestones":"/qemu-project/qemu/-/autocomplete_sources/milestones","commands":"/qemu-project/qemu/-/autocomplete_sources/commands?type=Issue\u0026type_id=1810","snippets":"/qemu-project/qemu/-/autocomplete_sources/snippets","contacts":"/qemu-project/qemu/-/autocomplete_sources/contacts?type=Issue\u0026type_id=1810","wikis":null};


//]]>
</script>
<script nonce="q3pHw79SKipFraIBJPmkLQ==">
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" data-track-label="main_navigation" data-track-action="click_gitlab_logo_link" data-track-property="navigation_top" href="/"><svg aria-hidden="true" role="img" class="tanuki-logo" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path class="tanuki-shape tanuki" d="m24.507 9.5-.034-.09L21.082.562a.896.896 0 0 0-1.694.091l-2.29 7.01H7.825L5.535.653a.898.898 0 0 0-1.694-.09L.451 9.411.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 2.56 1.935 1.554 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#E24329"/>
  <path class="tanuki-shape right-cheek" d="m24.507 9.5-.034-.09a11.44 11.44 0 0 0-4.56 2.051l-7.447 5.632 4.742 3.584 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#FC6D26"/>
  <path class="tanuki-shape chin" d="m7.707 20.677 2.56 1.935 1.555 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935-4.743-3.584-4.755 3.584Z"
        fill="#FCA326"/>
  <path class="tanuki-shape left-cheek" d="M5.01 11.461a11.43 11.43 0 0 0-4.56-2.05L.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 4.745-3.584-7.444-5.632Z"
        fill="#FC6D26"/>
</svg>

</a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item header-logged-out-dropdown md:gl-hidden">
<button class="header-logged-out-toggle" data-toggle="dropdown" type="button">
<span class="gl-sr-only">
Menu
</span>
<svg class="s16" data-testid="hamburger-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#hamburger"></use></svg>
</button>
<div class="dropdown-menu">
<ul>
<li>
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li>
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li>
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li>
<a href="/explore">Explore</a>
</li>
</ul>
</div>
</li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li class="header-logged-out-nav-item gl-hidden gl-inline-block">
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
<li class="header-logged-out-nav-item">
<a class="gl-button btn btn-md btn-confirm !gl-inline-flex" href="/users/sign_up"><span class="gl-button-text">
Get free trial

</span>

</a></li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/qemu-project/qemu/-/files/master?format=json&quot;,&quot;project_blob_url&quot;:&quot;/qemu-project/qemu/-/blob/master&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="true" data-root-path="/" data-sidebar="{&quot;whats_new_most_recent_release_items_count&quot;:6,&quot;whats_new_version_digest&quot;:&quot;c955dbe1b30a1468b032fe6896086eda50f884ff9559d966e5ef75c34eee3ff0&quot;,&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;QEMU&quot;,&quot;avatar&quot;:&quot;/uploads/-/system/project/avatar/11167699/logo.png&quot;,&quot;entity_id&quot;:11167699,&quot;link&quot;:&quot;/qemu-project/qemu&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/issues&quot;,&quot;pill_count_field&quot;:&quot;openIssuesCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/milestones&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;iterations&quot;,&quot;title&quot;:&quot;Iterations&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/cadences&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;requirements&quot;,&quot;title&quot;:&quot;Requirements&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/requirements_management/requirements&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;external_wiki&quot;,&quot;title&quot;:&quot;External wiki&quot;,&quot;link&quot;:&quot;https://wiki.qemu.org/Documentation&quot;,&quot;link_classes&quot;:&quot;shortcuts-external_wiki&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/tree/master&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/tree/master&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/commits/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/network/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/compare?from=master\u0026to=master&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;file_locks&quot;,&quot;title&quot;:&quot;Locked files&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/path_locks&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;test_cases&quot;,&quot;title&quot;:&quot;Test cases&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/quality/test_cases&quot;,&quot;link_classes&quot;:&quot;shortcuts-test-cases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;packages_registry&quot;,&quot;title&quot;:&quot;Package Registry&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/packages&quot;,&quot;link_classes&quot;:&quot;shortcuts-container-registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;container_registry&quot;,&quot;title&quot;:&quot;Container Registry&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/container_registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/ml/models&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;operations_menu&quot;,&quot;title&quot;:&quot;Operate&quot;,&quot;icon&quot;:&quot;cloud-pod&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/environments&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;environments&quot;,&quot;title&quot;:&quot;Environments&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/environments&quot;,&quot;link_classes&quot;:&quot;shortcuts-environments&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;infrastructure_registry&quot;,&quot;title&quot;:&quot;Terraform modules&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/terraform_module_registry&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/incidents&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;incidents&quot;,&quot;title&quot;:&quot;Incidents&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/incidents&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;service_desk&quot;,&quot;title&quot;:&quot;Service Desk&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/issues/service_desk&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/graphs/master?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/graphs/master/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;issues&quot;,&quot;title&quot;:&quot;Issue analytics&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/analytics/issues_analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;insights&quot;,&quot;title&quot;:&quot;Insights&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/insights/&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-insights&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_experiments&quot;,&quot;title&quot;:&quot;Model experiments&quot;,&quot;link&quot;:&quot;/qemu-project/qemu/-/ml/experiments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:true,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:3038080,&quot;name&quot;:&quot;QEMU&quot;,&quot;full_name&quot;:&quot;QEMU&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/qemu-project/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/qemu-project/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:11167699,&quot;name&quot;:&quot;QEMU&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/qemu-project/qemu/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/qemu-project/qemu/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">






























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"QEMU","item":"https://gitlab.com/qemu-project"},{"@type":"ListItem","position":2,"name":"QEMU","item":"https://gitlab.com/qemu-project/qemu"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.com/qemu-project/qemu/-/issues"},{"@type":"ListItem","position":4,"name":"#1810","item":"https://gitlab.com/qemu-project/qemu/-/issues/1810"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;QEMU&quot;,&quot;href&quot;:&quot;/qemu-project&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/group/avatar/3038080/logo.png&quot;},{&quot;text&quot;:&quot;QEMU&quot;,&quot;href&quot;:&quot;/qemu-project/qemu&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/project/avatar/11167699/logo.png&quot;},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/qemu-project/qemu/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#1810&quot;,&quot;href&quot;:&quot;/qemu-project/qemu/-/issues/1810&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/qemu-project/qemu/-/issues/1810&quot;,&quot;new_issue_path&quot;:&quot;/qemu-project/qemu/-/issues/new?add_related_issue=1810&quot;,&quot;project_path&quot;:&quot;qemu-project/qemu&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:1226603,&quot;reported_from_url&quot;:&quot;https://gitlab.com/qemu-project/qemu/-/issues/1810&quot;,&quot;submit_as_spam_path&quot;:&quot;/qemu-project/qemu/-/issues/1810/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null,&quot;can_promote_to_epic&quot;:&quot;false&quot;}" data-initial="{&quot;endpoint&quot;:&quot;/qemu-project/qemu/-/issues/1810&quot;,&quot;updateEndpoint&quot;:&quot;/qemu-project/qemu/-/issues/1810.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#1810&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/qemu-project/qemu/-/preview_markdown?target_id=1810\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:0,&quot;issuableTemplateNamesPath&quot;:&quot;/qemu-project/qemu/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;heap-buffer-overflow in esp_do_dma()&quot;,&quot;initialTitleText&quot;:&quot;heap-buffer-overflow in esp_do_dma()&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003ch2 data-sourcepos=\&quot;1:1-1:19\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-host-environment\&quot; class=\&quot;anchor\&quot; href=\&quot;#host-environment\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eHost environment\u003c/h2\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;3:1-13:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;3:1-3:32\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:3-3:32\&quot;\u003eOperating system: Ubuntu 20.04\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;4:1-4:36\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;4:3-4:36\&quot;\u003eOS/kernel version: Linux 5.4.0-148\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;5:1-5:22\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;5:3-5:22\&quot;\u003eArchitecture: x86_64\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;6:1-6:33\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;6:3-6:33\&quot;\u003eQEMU flavor: qemu-system-x86_64\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;7:1-7:36\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;7:3-7:36\&quot;\u003eQEMU version: commit at \u003ca href=\&quot;/qemu-project/qemu/-/commit/c167c80b463768e04a22fbe37ba6c53a4a08e41e\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;c167c80b46\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;11167699\&quot; data-commit=\&quot;c167c80b463768e04a22fbe37ba6c53a4a08e41e\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Merge tag &#39;pull-request-2023-08-03&#39; of https://gitlab.com/thuth/qemu into staging\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003ec167c80b\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;8:1-13:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;8:3-8:20\&quot;\u003eQEMU command line:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;10:3-12:5\&quot; data-canonical-lang=\&quot;plaintext\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eQEMU_FUZZ_ARGS=\&quot;-device am53c974,id=scsi -device scsi-hd,drive=disk0 -drive id=disk0,if=none,file=null-co://,format=raw -nodefaults\&quot; \\ QEMU_FUZZ_OBJECTS=\&quot;*esp* *scsi* *am53c974*\&quot; ./qemu-fuzz-x86_64 --fuzz-target=generic-fuzz\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;14:1-14:25\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-description-of-problem\&quot; class=\&quot;anchor\&quot; href=\&quot;#description-of-problem\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eDescription of problem\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;16:1-16:66\&quot; dir=\&quot;auto\&quot;\u003eGot a heap-buffer-overflow error when fuzzing the device am53c974.\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;18:1-18:21\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-steps-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#steps-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSteps to reproduce\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;20:1-20:21\&quot; dir=\&quot;auto\&quot;\u003eMinimized reproducer:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;22:1-49:3\&quot; data-canonical-lang=\&quot;plaintext\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ecat \u0026lt;\u0026lt; EOF | ./qemu-system-x86_64 -display none -machine accel=qtest, -m 512M -device \\\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eam53c974,id=scsi -device scsi-hd,drive=disk0 -drive \\\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eid=disk0,if=none,file=null-co://,format=raw -nodefaults -qtest /dev/null\\\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e -qtest stdio\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xcf8 0x80001010\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xcfc 0xc000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xcf8 0x80001004\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutw 0xcfc 0x05\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xc03d 0x03000000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xc047 0x065a9d80\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xc00a 0xc10000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ewrite 0x65a9d 0x1 0x04\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ewrite 0x65a9e 0x1 0x10\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xc03d 0x03000000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xc00a 0xc10000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xc00b 0x0800\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xc00b 0x00\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xc00b 0x0800\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xc00b 0x0800\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xc00b 0x0800\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xc00b 0x0400\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xc00b 0x0800\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutl 0xc00b 0x0800\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutw 0xc00b 0x1000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eoutw 0xc00b 0x9000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eEOF\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;51:1-51:25\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-additional-information\&quot; class=\&quot;anchor\&quot; href=\&quot;#additional-information\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eAdditional information\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;53:1-53:48\&quot; dir=\&quot;auto\&quot;\u003eThe crash report triggered by the reproducer is:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;55:1-208:3\&quot; data-canonical-lang=\&quot;plaintext\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[I 0.000000] OPENED\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.022834] outl 0xcf8 0x80001010\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.022864] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.022874] outl 0xcfc 0xc000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.022887] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.022942] outl 0xcf8 0x80001004\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.022990] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.023028] outw 0xcfc 0x05\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.023508] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.023518] outl 0xc03d 0x03000000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.023527] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.023532] outl 0xc047 0x065a9d80\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.023537] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.023544] outl 0xc00a 0xc10000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.023573] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.023581] write 0x65a9d 0x1 0x04\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.023891] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.023900] write 0x65a9e 0x1 0x10\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC27\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.023906] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC28\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK                                                                                                                                                                                                                                                                                                                           [R +0.023910] outl 0xc03d 0x03000000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC29\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.023917] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC30\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC31\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.023921] outl 0xc00a 0xc10000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC32\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.023983] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC33\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC34\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.023581] write 0x65a9d 0x1 0x04\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC35\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.023891] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC36\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC37\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.023900] write 0x65a9e 0x1 0x10\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC38\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.023906] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC39\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK                                                                                                                                                                                                                                                                                                                           [R +0.023910] outl 0xc03d 0x03000000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC40\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.023917] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC41\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC42\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.023921] outl 0xc00a 0xc10000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC43\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.023983] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC44\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC45\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.023991] outl 0xc00b 0x0800\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC46\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.023998] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC47\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC48\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.024002] outl 0xc00b 0x00\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC49\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.024008] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC50\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC51\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.024014] outl 0xc00b 0x0800\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC52\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.024028] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC53\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC54\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.024034] outl 0xc00b 0x0800\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC55\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.024040] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC56\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC57\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.024051] outl 0xc00b 0x0800\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC58\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.024058] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC59\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC60\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.024065] outl 0xc00b 0x0400\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC61\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.024073] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC62\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC63\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.024082] outl 0xc00b 0x0800\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC64\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.024089] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC65\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC66\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.024104] outl 0xc00b 0x0800\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC67\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.024121] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC68\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC69\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.024133] outw 0xc00b 0x1000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC70\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[S +0.024150] OK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC71\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOK\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC72\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e[R +0.024159] outw 0xc00b 0x9000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC73\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e=================================================================\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC74\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e==63330==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62500020c000 at pc 0x5601fffcf1d4 bp 0x7ffe1920dcf0 sp 0x7ffe1920d4b0\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC75\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eWRITE of size 32736 at 0x62500020c000 thread T0\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC76\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #0 0x5601fffcf1d3 in __asan_memcpy ../../llvm-project-15.0.0.src/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC77\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #1 0x5602015f506b in flatview_read_continue ../softmmu/physmem.c:2726:13\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC78\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #2 0x5602015f5ee3 in flatview_read ../softmmu/physmem.c:2762:12\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC79\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #3 0x5602015f5bf7 in address_space_read_full ../softmmu/physmem.c:2775:18\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC80\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #4 0x560200943ef0 in dma_memory_rw_relaxed ../include/sysemu/dma.h:87:12\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC81\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #5 0x560200943ef0 in dma_memory_rw ../include/sysemu/dma.h:130:12\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC82\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #6 0x560200943ef0 in pci_dma_rw ../hw/pci/pci_device.h:233:12\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC83\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #7 0x560200943ef0 in esp_pci_dma_memory_rw ../hw/scsi/esp-pci.c:283:5\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC84\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #8 0x56020092db7e in esp_do_dma ../hw/scsi/esp.c\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC85\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #9 0x560200935774 in handle_ti ../hw/scsi/esp.c:912:9\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC86\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #10 0x560200932db6 in esp_reg_write ../hw/scsi/esp.c:1083:13\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC87\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #11 0x56020094574d in esp_pci_io_write ../hw/scsi/esp-pci.c:214:9\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC88\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #12 0x5602015b5f23 in memory_region_write_accessor ../softmmu/memory.c:493:5\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC89\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #13 0x5602015b56aa in access_with_adjusted_size ../softmmu/memory.c:569:18\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC90\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #14 0x5602015b4a50 in memory_region_dispatch_write ../softmmu/memory.c\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC91\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #15 0x5602015fefbf in flatview_write_continue ../softmmu/physmem.c:2653:23\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC92\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #16 0x5602015f6463 in flatview_write ../softmmu/physmem.c:2695:12\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC93\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #17 0x5602015f6177 in address_space_write ../softmmu/physmem.c:2791:18\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC94\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #18 0x5602015a7e99 in cpu_outw ../softmmu/ioport.c:75:5\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC95\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #19 0x560200d28daa in qtest_process_command ../softmmu/qtest.c:483:13\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC96\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #20 0x560200d2795b in qtest_process_inbuf ../softmmu/qtest.c:788:9\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC97\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #21 0x560201b581a6 in fd_chr_read ../chardev/char-fd.c:72:9\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC98\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #22 0x7f8fce57e04d in g_main_context_dispatch (/lib/x86_64-linux-gnu/libglib-2.0.so.0+0x5204d) (BuildId: 5fdb313daf182a33a858ba2cc945211b11d34561)\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC99\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #23 0x560201dc540f in glib_pollfds_poll ../util/main-loop.c:290:9\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC100\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #24 0x560201dc540f in os_host_main_loop_wait ../util/main-loop.c:313:5\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC101\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #25 0x560201dc540f in main_loop_wait ../util/main-loop.c:592:11\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC102\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #26 0x560200d34f76 in qemu_main_loop ../softmmu/runstate.c:732:9\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC103\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #27 0x56020173e835 in qemu_default_main ../softmmu/main.c:37:14\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC104\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #28 0x7f8fcd3a5082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC105\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #29 0x5601fff2009d in _start ./qemu-system-x86_64+0x1e9109d)\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC106\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC107\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e0x62500020c000 is located 0 bytes to the right of 4096-byte region [0x62500020b000,0x62500020c000)\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC108\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eallocated by thread T0 here:\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC109\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #0 0x5601fffd0a0c in posix_memalign ../../llvm-project-15.0.0.src/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC110\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #1 0x560201db83da in qemu_try_memalign ../util/memalign.c:53:11\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC111\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #2 0x560201db8762 in qemu_memalign ../util/memalign.c:73:15\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC112\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #3 0x5602008c779e in scsi_req_enqueue ../hw/scsi/scsi-bus.c:906:10\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC113\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #4 0x56020093bd2f in do_command_phase ../hw/scsi/esp.c:296:15\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC114\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #5 0x56020093bd2f in do_cmd ../hw/scsi/esp.c:344:5\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC115\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #6 0x560200932911 in esp_reg_write ../hw/scsi/esp.c:1112:13\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC116\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #7 0x56020094574d in esp_pci_io_write ../hw/scsi/esp-pci.c:214:9\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC117\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #8 0x5602015b5f23 in memory_region_write_accessor ../softmmu/memory.c:493:5\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC118\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #9 0x5602015b56aa in access_with_adjusted_size ../softmmu/memory.c:569:18\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC119\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC120\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSUMMARY: AddressSanitizer: heap-buffer-overflow ./llvm-project-15.0.0.src/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3 in __asan_memcpy\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC121\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eShadow bytes around the buggy address:\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC122\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c4a800397b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC123\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c4a800397c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC124\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c4a800397d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC125\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c4a800397e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC126\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c4a800397f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC127\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e=\u0026gt;0x0c4a80039800:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC128\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c4a80039810: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC129\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c4a80039820: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC130\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c4a80039830: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC131\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c4a80039840: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC132\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c4a80039850: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC133\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eShadow byte legend (one shadow byte represents 8 application bytes):\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC134\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Addressable:           00\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC135\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Partially addressable: 01 02 03 04 05 06 07\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC136\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Heap left redzone:       fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC137\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Freed heap region:       fd\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC138\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Stack left redzone:      f1\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC139\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Stack mid redzone:       f2\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC140\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Stack right redzone:     f3\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC141\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Stack after return:      f5\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC142\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Stack use after scope:   f8\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC143\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Global redzone:          f9\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC144\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Global init order:       f6\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC145\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Poisoned by user:        f7\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC146\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Container overflow:      fc\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC147\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Array cookie:            ac\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC148\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Intra object redzone:    bb\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC149\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  ASan internal:           fe\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC150\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Left alloca redzone:     ca\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC151\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Right alloca redzone:    cb\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC152\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e==63330==ABORTING\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;## Host environment\n\n- Operating system: Ubuntu 20.04\n- OS/kernel version: Linux 5.4.0-148\n- Architecture: x86_64\n- QEMU flavor: qemu-system-x86_64\n- QEMU version: commit at c167c80b46\n- QEMU command line:\n\n  ```plaintext\n  QEMU_FUZZ_ARGS=\&quot;-device am53c974,id=scsi -device scsi-hd,drive=disk0 -drive id=disk0,if=none,file=null-co://,format=raw -nodefaults\&quot; \\ QEMU_FUZZ_OBJECTS=\&quot;*esp* *scsi* *am53c974*\&quot; ./qemu-fuzz-x86_64 --fuzz-target=generic-fuzz\n  ```\n\n## Description of problem\n\nGot a heap-buffer-overflow error when fuzzing the device am53c974.\n\n## Steps to reproduce\n\nMinimized reproducer:\n\n```plaintext\ncat \u003c\u003c EOF | ./qemu-system-x86_64 -display none -machine accel=qtest, -m 512M -device \\\nam53c974,id=scsi -device scsi-hd,drive=disk0 -drive \\\nid=disk0,if=none,file=null-co://,format=raw -nodefaults -qtest /dev/null\\\n -qtest stdio\noutl 0xcf8 0x80001010\noutl 0xcfc 0xc000\noutl 0xcf8 0x80001004\noutw 0xcfc 0x05\noutl 0xc03d 0x03000000\noutl 0xc047 0x065a9d80\noutl 0xc00a 0xc10000\nwrite 0x65a9d 0x1 0x04\nwrite 0x65a9e 0x1 0x10\noutl 0xc03d 0x03000000\noutl 0xc00a 0xc10000\noutl 0xc00b 0x0800\noutl 0xc00b 0x00\noutl 0xc00b 0x0800\noutl 0xc00b 0x0800\noutl 0xc00b 0x0800\noutl 0xc00b 0x0400\noutl 0xc00b 0x0800\noutl 0xc00b 0x0800\noutw 0xc00b 0x1000\noutw 0xc00b 0x9000\nEOF\n```\n\n## Additional information\n\nThe crash report triggered by the reproducer is:\n\n```plaintext\n[I 0.000000] OPENED\n[R +0.022834] outl 0xcf8 0x80001010\n[S +0.022864] OK\nOK\n[R +0.022874] outl 0xcfc 0xc000\n[S +0.022887] OK\nOK\n[R +0.022942] outl 0xcf8 0x80001004\n[S +0.022990] OK\nOK\n[R +0.023028] outw 0xcfc 0x05\n[S +0.023508] OK\nOK\n[R +0.023518] outl 0xc03d 0x03000000\n[S +0.023527] OK\nOK\n[R +0.023532] outl 0xc047 0x065a9d80\n[S +0.023537] OK\nOK\n[R +0.023544] outl 0xc00a 0xc10000\n[S +0.023573] OK\nOK\n[R +0.023581] write 0x65a9d 0x1 0x04\n[S +0.023891] OK\nOK\n[R +0.023900] write 0x65a9e 0x1 0x10\n[S +0.023906] OK\nOK                                                                                                                                                                                                                                                                                                                           [R +0.023910] outl 0xc03d 0x03000000\n[S +0.023917] OK\nOK\n[R +0.023921] outl 0xc00a 0xc10000\n[S +0.023983] OK\nOK\n[R +0.023581] write 0x65a9d 0x1 0x04\n[S +0.023891] OK\nOK\n[R +0.023900] write 0x65a9e 0x1 0x10\n[S +0.023906] OK\nOK                                                                                                                                                                                                                                                                                                                           [R +0.023910] outl 0xc03d 0x03000000\n[S +0.023917] OK\nOK\n[R +0.023921] outl 0xc00a 0xc10000\n[S +0.023983] OK\nOK\n[R +0.023991] outl 0xc00b 0x0800\n[S +0.023998] OK\nOK\n[R +0.024002] outl 0xc00b 0x00\n[S +0.024008] OK\nOK\n[R +0.024014] outl 0xc00b 0x0800\n[S +0.024028] OK\nOK\n[R +0.024034] outl 0xc00b 0x0800\n[S +0.024040] OK\nOK\n[R +0.024051] outl 0xc00b 0x0800\n[S +0.024058] OK\nOK\n[R +0.024065] outl 0xc00b 0x0400\n[S +0.024073] OK\nOK\n[R +0.024082] outl 0xc00b 0x0800\n[S +0.024089] OK\nOK\n[R +0.024104] outl 0xc00b 0x0800\n[S +0.024121] OK\nOK\n[R +0.024133] outw 0xc00b 0x1000\n[S +0.024150] OK\nOK\n[R +0.024159] outw 0xc00b 0x9000\n=================================================================\n==63330==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62500020c000 at pc 0x5601fffcf1d4 bp 0x7ffe1920dcf0 sp 0x7ffe1920d4b0\nWRITE of size 32736 at 0x62500020c000 thread T0\n    #0 0x5601fffcf1d3 in __asan_memcpy ../../llvm-project-15.0.0.src/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3\n    #1 0x5602015f506b in flatview_read_continue ../softmmu/physmem.c:2726:13\n    #2 0x5602015f5ee3 in flatview_read ../softmmu/physmem.c:2762:12\n    #3 0x5602015f5bf7 in address_space_read_full ../softmmu/physmem.c:2775:18\n    #4 0x560200943ef0 in dma_memory_rw_relaxed ../include/sysemu/dma.h:87:12\n    #5 0x560200943ef0 in dma_memory_rw ../include/sysemu/dma.h:130:12\n    #6 0x560200943ef0 in pci_dma_rw ../hw/pci/pci_device.h:233:12\n    #7 0x560200943ef0 in esp_pci_dma_memory_rw ../hw/scsi/esp-pci.c:283:5\n    #8 0x56020092db7e in esp_do_dma ../hw/scsi/esp.c\n    #9 0x560200935774 in handle_ti ../hw/scsi/esp.c:912:9\n    #10 0x560200932db6 in esp_reg_write ../hw/scsi/esp.c:1083:13\n    #11 0x56020094574d in esp_pci_io_write ../hw/scsi/esp-pci.c:214:9\n    #12 0x5602015b5f23 in memory_region_write_accessor ../softmmu/memory.c:493:5\n    #13 0x5602015b56aa in access_with_adjusted_size ../softmmu/memory.c:569:18\n    #14 0x5602015b4a50 in memory_region_dispatch_write ../softmmu/memory.c\n    #15 0x5602015fefbf in flatview_write_continue ../softmmu/physmem.c:2653:23\n    #16 0x5602015f6463 in flatview_write ../softmmu/physmem.c:2695:12\n    #17 0x5602015f6177 in address_space_write ../softmmu/physmem.c:2791:18\n    #18 0x5602015a7e99 in cpu_outw ../softmmu/ioport.c:75:5\n    #19 0x560200d28daa in qtest_process_command ../softmmu/qtest.c:483:13\n    #20 0x560200d2795b in qtest_process_inbuf ../softmmu/qtest.c:788:9\n    #21 0x560201b581a6 in fd_chr_read ../chardev/char-fd.c:72:9\n    #22 0x7f8fce57e04d in g_main_context_dispatch (/lib/x86_64-linux-gnu/libglib-2.0.so.0+0x5204d) (BuildId: 5fdb313daf182a33a858ba2cc945211b11d34561)\n    #23 0x560201dc540f in glib_pollfds_poll ../util/main-loop.c:290:9\n    #24 0x560201dc540f in os_host_main_loop_wait ../util/main-loop.c:313:5\n    #25 0x560201dc540f in main_loop_wait ../util/main-loop.c:592:11\n    #26 0x560200d34f76 in qemu_main_loop ../softmmu/runstate.c:732:9\n    #27 0x56020173e835 in qemu_default_main ../softmmu/main.c:37:14\n    #28 0x7f8fcd3a5082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16\n    #29 0x5601fff2009d in _start ./qemu-system-x86_64+0x1e9109d)\n\n0x62500020c000 is located 0 bytes to the right of 4096-byte region [0x62500020b000,0x62500020c000)\nallocated by thread T0 here:\n    #0 0x5601fffd0a0c in posix_memalign ../../llvm-project-15.0.0.src/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3\n    #1 0x560201db83da in qemu_try_memalign ../util/memalign.c:53:11\n    #2 0x560201db8762 in qemu_memalign ../util/memalign.c:73:15\n    #3 0x5602008c779e in scsi_req_enqueue ../hw/scsi/scsi-bus.c:906:10\n    #4 0x56020093bd2f in do_command_phase ../hw/scsi/esp.c:296:15\n    #5 0x56020093bd2f in do_cmd ../hw/scsi/esp.c:344:5\n    #6 0x560200932911 in esp_reg_write ../hw/scsi/esp.c:1112:13\n    #7 0x56020094574d in esp_pci_io_write ../hw/scsi/esp-pci.c:214:9\n    #8 0x5602015b5f23 in memory_region_write_accessor ../softmmu/memory.c:493:5\n    #9 0x5602015b56aa in access_with_adjusted_size ../softmmu/memory.c:569:18\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow ./llvm-project-15.0.0.src/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3 in __asan_memcpy\nShadow bytes around the buggy address:\n  0x0c4a800397b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c4a800397c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c4a800397d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c4a800397e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c4a800397f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=\u003e0x0c4a80039800:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c4a80039810: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c4a80039820: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c4a80039830: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c4a80039840: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c4a80039850: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07\n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==63330==ABORTING\n```&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;qemu-project/qemu&quot;,&quot;iid&quot;:1810,&quot;issuableId&quot;:131718767,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:1226603,&quot;authorName&quot;:&quot;Chuhong Yuan&quot;,&quot;authorUsername&quot;:&quot;WillLester&quot;,&quot;authorWebUrl&quot;:&quot;/WillLester&quot;,&quot;createdAt&quot;:&quot;2023-08-04T06:22:03+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;publishedIncidentUrl&quot;:null,&quot;slaFeatureAvailable&quot;:&quot;false&quot;,&quot;uploadMetricsFeatureAvailable&quot;:&quot;false&quot;,&quot;projectId&quot;:11167699,&quot;projectPath&quot;:&quot;qemu&quot;,&quot;projectNamespace&quot;:&quot;qemu-project&quot;,&quot;canAdmin&quot;:false,&quot;hasIssueWeightsFeature&quot;:true,&quot;hasIterationsFeature&quot;:true,&quot;canAdminRelation&quot;:false}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">heap-buffer-overflow in esp_do_dma()</h1>
</div>
<div class="description">
<div class="md"><h2 data-sourcepos="1:1-1:19" dir="auto">&#x000A;<a id="user-content-host-environment" class="anchor" href="#host-environment" aria-hidden="true"></a>Host environment</h2>&#x000A;<ul data-sourcepos="3:1-13:0" dir="auto">&#x000A;<li data-sourcepos="3:1-3:32">&#x000A;<p data-sourcepos="3:3-3:32">Operating system: Ubuntu 20.04</p>&#x000A;</li>&#x000A;<li data-sourcepos="4:1-4:36">&#x000A;<p data-sourcepos="4:3-4:36">OS/kernel version: Linux 5.4.0-148</p>&#x000A;</li>&#x000A;<li data-sourcepos="5:1-5:22">&#x000A;<p data-sourcepos="5:3-5:22">Architecture: x86_64</p>&#x000A;</li>&#x000A;<li data-sourcepos="6:1-6:33">&#x000A;<p data-sourcepos="6:3-6:33">QEMU flavor: qemu-system-x86_64</p>&#x000A;</li>&#x000A;<li data-sourcepos="7:1-7:36">&#x000A;<p data-sourcepos="7:3-7:36">QEMU version: commit at <a href="/qemu-project/qemu/-/commit/c167c80b463768e04a22fbe37ba6c53a4a08e41e" data-reference-type="commit" data-original="c167c80b46" data-link="false" data-link-reference="false" data-project="11167699" data-commit="c167c80b463768e04a22fbe37ba6c53a4a08e41e" data-container="body" data-placement="top" title="Merge tag 'pull-request-2023-08-03' of https://gitlab.com/thuth/qemu into staging" class="gfm gfm-commit has-tooltip">c167c80b</a></p>&#x000A;</li>&#x000A;<li data-sourcepos="8:1-13:0">&#x000A;<p data-sourcepos="8:3-8:20">QEMU command line:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="10:3-12:5" data-canonical-lang="plaintext" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">QEMU_FUZZ_ARGS="-device am53c974,id=scsi -device scsi-hd,drive=disk0 -drive id=disk0,if=none,file=null-co://,format=raw -nodefaults" \ QEMU_FUZZ_OBJECTS="*esp* *scsi* *am53c974*" ./qemu-fuzz-x86_64 --fuzz-target=generic-fuzz</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;</li>&#x000A;</ul>&#x000A;<h2 data-sourcepos="14:1-14:25" dir="auto">&#x000A;<a id="user-content-description-of-problem" class="anchor" href="#description-of-problem" aria-hidden="true"></a>Description of problem</h2>&#x000A;<p data-sourcepos="16:1-16:66" dir="auto">Got a heap-buffer-overflow error when fuzzing the device am53c974.</p>&#x000A;<h2 data-sourcepos="18:1-18:21" dir="auto">&#x000A;<a id="user-content-steps-to-reproduce" class="anchor" href="#steps-to-reproduce" aria-hidden="true"></a>Steps to reproduce</h2>&#x000A;<p data-sourcepos="20:1-20:21" dir="auto">Minimized reproducer:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="22:1-49:3" data-canonical-lang="plaintext" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">cat &lt;&lt; EOF | ./qemu-system-x86_64 -display none -machine accel=qtest, -m 512M -device \</span>&#x000A;<span id="LC2" class="line" lang="plaintext">am53c974,id=scsi -device scsi-hd,drive=disk0 -drive \</span>&#x000A;<span id="LC3" class="line" lang="plaintext">id=disk0,if=none,file=null-co://,format=raw -nodefaults -qtest /dev/null\</span>&#x000A;<span id="LC4" class="line" lang="plaintext"> -qtest stdio</span>&#x000A;<span id="LC5" class="line" lang="plaintext">outl 0xcf8 0x80001010</span>&#x000A;<span id="LC6" class="line" lang="plaintext">outl 0xcfc 0xc000</span>&#x000A;<span id="LC7" class="line" lang="plaintext">outl 0xcf8 0x80001004</span>&#x000A;<span id="LC8" class="line" lang="plaintext">outw 0xcfc 0x05</span>&#x000A;<span id="LC9" class="line" lang="plaintext">outl 0xc03d 0x03000000</span>&#x000A;<span id="LC10" class="line" lang="plaintext">outl 0xc047 0x065a9d80</span>&#x000A;<span id="LC11" class="line" lang="plaintext">outl 0xc00a 0xc10000</span>&#x000A;<span id="LC12" class="line" lang="plaintext">write 0x65a9d 0x1 0x04</span>&#x000A;<span id="LC13" class="line" lang="plaintext">write 0x65a9e 0x1 0x10</span>&#x000A;<span id="LC14" class="line" lang="plaintext">outl 0xc03d 0x03000000</span>&#x000A;<span id="LC15" class="line" lang="plaintext">outl 0xc00a 0xc10000</span>&#x000A;<span id="LC16" class="line" lang="plaintext">outl 0xc00b 0x0800</span>&#x000A;<span id="LC17" class="line" lang="plaintext">outl 0xc00b 0x00</span>&#x000A;<span id="LC18" class="line" lang="plaintext">outl 0xc00b 0x0800</span>&#x000A;<span id="LC19" class="line" lang="plaintext">outl 0xc00b 0x0800</span>&#x000A;<span id="LC20" class="line" lang="plaintext">outl 0xc00b 0x0800</span>&#x000A;<span id="LC21" class="line" lang="plaintext">outl 0xc00b 0x0400</span>&#x000A;<span id="LC22" class="line" lang="plaintext">outl 0xc00b 0x0800</span>&#x000A;<span id="LC23" class="line" lang="plaintext">outl 0xc00b 0x0800</span>&#x000A;<span id="LC24" class="line" lang="plaintext">outw 0xc00b 0x1000</span>&#x000A;<span id="LC25" class="line" lang="plaintext">outw 0xc00b 0x9000</span>&#x000A;<span id="LC26" class="line" lang="plaintext">EOF</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h2 data-sourcepos="51:1-51:25" dir="auto">&#x000A;<a id="user-content-additional-information" class="anchor" href="#additional-information" aria-hidden="true"></a>Additional information</h2>&#x000A;<p data-sourcepos="53:1-53:48" dir="auto">The crash report triggered by the reproducer is:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="55:1-208:3" data-canonical-lang="plaintext" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">[I 0.000000] OPENED</span>&#x000A;<span id="LC2" class="line" lang="plaintext">[R +0.022834] outl 0xcf8 0x80001010</span>&#x000A;<span id="LC3" class="line" lang="plaintext">[S +0.022864] OK</span>&#x000A;<span id="LC4" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC5" class="line" lang="plaintext">[R +0.022874] outl 0xcfc 0xc000</span>&#x000A;<span id="LC6" class="line" lang="plaintext">[S +0.022887] OK</span>&#x000A;<span id="LC7" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC8" class="line" lang="plaintext">[R +0.022942] outl 0xcf8 0x80001004</span>&#x000A;<span id="LC9" class="line" lang="plaintext">[S +0.022990] OK</span>&#x000A;<span id="LC10" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC11" class="line" lang="plaintext">[R +0.023028] outw 0xcfc 0x05</span>&#x000A;<span id="LC12" class="line" lang="plaintext">[S +0.023508] OK</span>&#x000A;<span id="LC13" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC14" class="line" lang="plaintext">[R +0.023518] outl 0xc03d 0x03000000</span>&#x000A;<span id="LC15" class="line" lang="plaintext">[S +0.023527] OK</span>&#x000A;<span id="LC16" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC17" class="line" lang="plaintext">[R +0.023532] outl 0xc047 0x065a9d80</span>&#x000A;<span id="LC18" class="line" lang="plaintext">[S +0.023537] OK</span>&#x000A;<span id="LC19" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC20" class="line" lang="plaintext">[R +0.023544] outl 0xc00a 0xc10000</span>&#x000A;<span id="LC21" class="line" lang="plaintext">[S +0.023573] OK</span>&#x000A;<span id="LC22" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC23" class="line" lang="plaintext">[R +0.023581] write 0x65a9d 0x1 0x04</span>&#x000A;<span id="LC24" class="line" lang="plaintext">[S +0.023891] OK</span>&#x000A;<span id="LC25" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC26" class="line" lang="plaintext">[R +0.023900] write 0x65a9e 0x1 0x10</span>&#x000A;<span id="LC27" class="line" lang="plaintext">[S +0.023906] OK</span>&#x000A;<span id="LC28" class="line" lang="plaintext">OK                                                                                                                                                                                                                                                                                                                           [R +0.023910] outl 0xc03d 0x03000000</span>&#x000A;<span id="LC29" class="line" lang="plaintext">[S +0.023917] OK</span>&#x000A;<span id="LC30" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC31" class="line" lang="plaintext">[R +0.023921] outl 0xc00a 0xc10000</span>&#x000A;<span id="LC32" class="line" lang="plaintext">[S +0.023983] OK</span>&#x000A;<span id="LC33" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC34" class="line" lang="plaintext">[R +0.023581] write 0x65a9d 0x1 0x04</span>&#x000A;<span id="LC35" class="line" lang="plaintext">[S +0.023891] OK</span>&#x000A;<span id="LC36" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC37" class="line" lang="plaintext">[R +0.023900] write 0x65a9e 0x1 0x10</span>&#x000A;<span id="LC38" class="line" lang="plaintext">[S +0.023906] OK</span>&#x000A;<span id="LC39" class="line" lang="plaintext">OK                                                                                                                                                                                                                                                                                                                           [R +0.023910] outl 0xc03d 0x03000000</span>&#x000A;<span id="LC40" class="line" lang="plaintext">[S +0.023917] OK</span>&#x000A;<span id="LC41" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC42" class="line" lang="plaintext">[R +0.023921] outl 0xc00a 0xc10000</span>&#x000A;<span id="LC43" class="line" lang="plaintext">[S +0.023983] OK</span>&#x000A;<span id="LC44" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC45" class="line" lang="plaintext">[R +0.023991] outl 0xc00b 0x0800</span>&#x000A;<span id="LC46" class="line" lang="plaintext">[S +0.023998] OK</span>&#x000A;<span id="LC47" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC48" class="line" lang="plaintext">[R +0.024002] outl 0xc00b 0x00</span>&#x000A;<span id="LC49" class="line" lang="plaintext">[S +0.024008] OK</span>&#x000A;<span id="LC50" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC51" class="line" lang="plaintext">[R +0.024014] outl 0xc00b 0x0800</span>&#x000A;<span id="LC52" class="line" lang="plaintext">[S +0.024028] OK</span>&#x000A;<span id="LC53" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC54" class="line" lang="plaintext">[R +0.024034] outl 0xc00b 0x0800</span>&#x000A;<span id="LC55" class="line" lang="plaintext">[S +0.024040] OK</span>&#x000A;<span id="LC56" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC57" class="line" lang="plaintext">[R +0.024051] outl 0xc00b 0x0800</span>&#x000A;<span id="LC58" class="line" lang="plaintext">[S +0.024058] OK</span>&#x000A;<span id="LC59" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC60" class="line" lang="plaintext">[R +0.024065] outl 0xc00b 0x0400</span>&#x000A;<span id="LC61" class="line" lang="plaintext">[S +0.024073] OK</span>&#x000A;<span id="LC62" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC63" class="line" lang="plaintext">[R +0.024082] outl 0xc00b 0x0800</span>&#x000A;<span id="LC64" class="line" lang="plaintext">[S +0.024089] OK</span>&#x000A;<span id="LC65" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC66" class="line" lang="plaintext">[R +0.024104] outl 0xc00b 0x0800</span>&#x000A;<span id="LC67" class="line" lang="plaintext">[S +0.024121] OK</span>&#x000A;<span id="LC68" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC69" class="line" lang="plaintext">[R +0.024133] outw 0xc00b 0x1000</span>&#x000A;<span id="LC70" class="line" lang="plaintext">[S +0.024150] OK</span>&#x000A;<span id="LC71" class="line" lang="plaintext">OK</span>&#x000A;<span id="LC72" class="line" lang="plaintext">[R +0.024159] outw 0xc00b 0x9000</span>&#x000A;<span id="LC73" class="line" lang="plaintext">=================================================================</span>&#x000A;<span id="LC74" class="line" lang="plaintext">==63330==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62500020c000 at pc 0x5601fffcf1d4 bp 0x7ffe1920dcf0 sp 0x7ffe1920d4b0</span>&#x000A;<span id="LC75" class="line" lang="plaintext">WRITE of size 32736 at 0x62500020c000 thread T0</span>&#x000A;<span id="LC76" class="line" lang="plaintext">    #0 0x5601fffcf1d3 in __asan_memcpy ../../llvm-project-15.0.0.src/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3</span>&#x000A;<span id="LC77" class="line" lang="plaintext">    #1 0x5602015f506b in flatview_read_continue ../softmmu/physmem.c:2726:13</span>&#x000A;<span id="LC78" class="line" lang="plaintext">    #2 0x5602015f5ee3 in flatview_read ../softmmu/physmem.c:2762:12</span>&#x000A;<span id="LC79" class="line" lang="plaintext">    #3 0x5602015f5bf7 in address_space_read_full ../softmmu/physmem.c:2775:18</span>&#x000A;<span id="LC80" class="line" lang="plaintext">    #4 0x560200943ef0 in dma_memory_rw_relaxed ../include/sysemu/dma.h:87:12</span>&#x000A;<span id="LC81" class="line" lang="plaintext">    #5 0x560200943ef0 in dma_memory_rw ../include/sysemu/dma.h:130:12</span>&#x000A;<span id="LC82" class="line" lang="plaintext">    #6 0x560200943ef0 in pci_dma_rw ../hw/pci/pci_device.h:233:12</span>&#x000A;<span id="LC83" class="line" lang="plaintext">    #7 0x560200943ef0 in esp_pci_dma_memory_rw ../hw/scsi/esp-pci.c:283:5</span>&#x000A;<span id="LC84" class="line" lang="plaintext">    #8 0x56020092db7e in esp_do_dma ../hw/scsi/esp.c</span>&#x000A;<span id="LC85" class="line" lang="plaintext">    #9 0x560200935774 in handle_ti ../hw/scsi/esp.c:912:9</span>&#x000A;<span id="LC86" class="line" lang="plaintext">    #10 0x560200932db6 in esp_reg_write ../hw/scsi/esp.c:1083:13</span>&#x000A;<span id="LC87" class="line" lang="plaintext">    #11 0x56020094574d in esp_pci_io_write ../hw/scsi/esp-pci.c:214:9</span>&#x000A;<span id="LC88" class="line" lang="plaintext">    #12 0x5602015b5f23 in memory_region_write_accessor ../softmmu/memory.c:493:5</span>&#x000A;<span id="LC89" class="line" lang="plaintext">    #13 0x5602015b56aa in access_with_adjusted_size ../softmmu/memory.c:569:18</span>&#x000A;<span id="LC90" class="line" lang="plaintext">    #14 0x5602015b4a50 in memory_region_dispatch_write ../softmmu/memory.c</span>&#x000A;<span id="LC91" class="line" lang="plaintext">    #15 0x5602015fefbf in flatview_write_continue ../softmmu/physmem.c:2653:23</span>&#x000A;<span id="LC92" class="line" lang="plaintext">    #16 0x5602015f6463 in flatview_write ../softmmu/physmem.c:2695:12</span>&#x000A;<span id="LC93" class="line" lang="plaintext">    #17 0x5602015f6177 in address_space_write ../softmmu/physmem.c:2791:18</span>&#x000A;<span id="LC94" class="line" lang="plaintext">    #18 0x5602015a7e99 in cpu_outw ../softmmu/ioport.c:75:5</span>&#x000A;<span id="LC95" class="line" lang="plaintext">    #19 0x560200d28daa in qtest_process_command ../softmmu/qtest.c:483:13</span>&#x000A;<span id="LC96" class="line" lang="plaintext">    #20 0x560200d2795b in qtest_process_inbuf ../softmmu/qtest.c:788:9</span>&#x000A;<span id="LC97" class="line" lang="plaintext">    #21 0x560201b581a6 in fd_chr_read ../chardev/char-fd.c:72:9</span>&#x000A;<span id="LC98" class="line" lang="plaintext">    #22 0x7f8fce57e04d in g_main_context_dispatch (/lib/x86_64-linux-gnu/libglib-2.0.so.0+0x5204d) (BuildId: 5fdb313daf182a33a858ba2cc945211b11d34561)</span>&#x000A;<span id="LC99" class="line" lang="plaintext">    #23 0x560201dc540f in glib_pollfds_poll ../util/main-loop.c:290:9</span>&#x000A;<span id="LC100" class="line" lang="plaintext">    #24 0x560201dc540f in os_host_main_loop_wait ../util/main-loop.c:313:5</span>&#x000A;<span id="LC101" class="line" lang="plaintext">    #25 0x560201dc540f in main_loop_wait ../util/main-loop.c:592:11</span>&#x000A;<span id="LC102" class="line" lang="plaintext">    #26 0x560200d34f76 in qemu_main_loop ../softmmu/runstate.c:732:9</span>&#x000A;<span id="LC103" class="line" lang="plaintext">    #27 0x56020173e835 in qemu_default_main ../softmmu/main.c:37:14</span>&#x000A;<span id="LC104" class="line" lang="plaintext">    #28 0x7f8fcd3a5082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16</span>&#x000A;<span id="LC105" class="line" lang="plaintext">    #29 0x5601fff2009d in _start ./qemu-system-x86_64+0x1e9109d)</span>&#x000A;<span id="LC106" class="line" lang="plaintext"></span>&#x000A;<span id="LC107" class="line" lang="plaintext">0x62500020c000 is located 0 bytes to the right of 4096-byte region [0x62500020b000,0x62500020c000)</span>&#x000A;<span id="LC108" class="line" lang="plaintext">allocated by thread T0 here:</span>&#x000A;<span id="LC109" class="line" lang="plaintext">    #0 0x5601fffd0a0c in posix_memalign ../../llvm-project-15.0.0.src/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3</span>&#x000A;<span id="LC110" class="line" lang="plaintext">    #1 0x560201db83da in qemu_try_memalign ../util/memalign.c:53:11</span>&#x000A;<span id="LC111" class="line" lang="plaintext">    #2 0x560201db8762 in qemu_memalign ../util/memalign.c:73:15</span>&#x000A;<span id="LC112" class="line" lang="plaintext">    #3 0x5602008c779e in scsi_req_enqueue ../hw/scsi/scsi-bus.c:906:10</span>&#x000A;<span id="LC113" class="line" lang="plaintext">    #4 0x56020093bd2f in do_command_phase ../hw/scsi/esp.c:296:15</span>&#x000A;<span id="LC114" class="line" lang="plaintext">    #5 0x56020093bd2f in do_cmd ../hw/scsi/esp.c:344:5</span>&#x000A;<span id="LC115" class="line" lang="plaintext">    #6 0x560200932911 in esp_reg_write ../hw/scsi/esp.c:1112:13</span>&#x000A;<span id="LC116" class="line" lang="plaintext">    #7 0x56020094574d in esp_pci_io_write ../hw/scsi/esp-pci.c:214:9</span>&#x000A;<span id="LC117" class="line" lang="plaintext">    #8 0x5602015b5f23 in memory_region_write_accessor ../softmmu/memory.c:493:5</span>&#x000A;<span id="LC118" class="line" lang="plaintext">    #9 0x5602015b56aa in access_with_adjusted_size ../softmmu/memory.c:569:18</span>&#x000A;<span id="LC119" class="line" lang="plaintext"></span>&#x000A;<span id="LC120" class="line" lang="plaintext">SUMMARY: AddressSanitizer: heap-buffer-overflow ./llvm-project-15.0.0.src/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3 in __asan_memcpy</span>&#x000A;<span id="LC121" class="line" lang="plaintext">Shadow bytes around the buggy address:</span>&#x000A;<span id="LC122" class="line" lang="plaintext">  0x0c4a800397b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span>&#x000A;<span id="LC123" class="line" lang="plaintext">  0x0c4a800397c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span>&#x000A;<span id="LC124" class="line" lang="plaintext">  0x0c4a800397d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span>&#x000A;<span id="LC125" class="line" lang="plaintext">  0x0c4a800397e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span>&#x000A;<span id="LC126" class="line" lang="plaintext">  0x0c4a800397f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span>&#x000A;<span id="LC127" class="line" lang="plaintext">=&gt;0x0c4a80039800:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span>&#x000A;<span id="LC128" class="line" lang="plaintext">  0x0c4a80039810: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span>&#x000A;<span id="LC129" class="line" lang="plaintext">  0x0c4a80039820: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span>&#x000A;<span id="LC130" class="line" lang="plaintext">  0x0c4a80039830: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span>&#x000A;<span id="LC131" class="line" lang="plaintext">  0x0c4a80039840: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span>&#x000A;<span id="LC132" class="line" lang="plaintext">  0x0c4a80039850: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span>&#x000A;<span id="LC133" class="line" lang="plaintext">Shadow byte legend (one shadow byte represents 8 application bytes):</span>&#x000A;<span id="LC134" class="line" lang="plaintext">  Addressable:           00</span>&#x000A;<span id="LC135" class="line" lang="plaintext">  Partially addressable: 01 02 03 04 05 06 07</span>&#x000A;<span id="LC136" class="line" lang="plaintext">  Heap left redzone:       fa</span>&#x000A;<span id="LC137" class="line" lang="plaintext">  Freed heap region:       fd</span>&#x000A;<span id="LC138" class="line" lang="plaintext">  Stack left redzone:      f1</span>&#x000A;<span id="LC139" class="line" lang="plaintext">  Stack mid redzone:       f2</span>&#x000A;<span id="LC140" class="line" lang="plaintext">  Stack right redzone:     f3</span>&#x000A;<span id="LC141" class="line" lang="plaintext">  Stack after return:      f5</span>&#x000A;<span id="LC142" class="line" lang="plaintext">  Stack use after scope:   f8</span>&#x000A;<span id="LC143" class="line" lang="plaintext">  Global redzone:          f9</span>&#x000A;<span id="LC144" class="line" lang="plaintext">  Global init order:       f6</span>&#x000A;<span id="LC145" class="line" lang="plaintext">  Poisoned by user:        f7</span>&#x000A;<span id="LC146" class="line" lang="plaintext">  Container overflow:      fc</span>&#x000A;<span id="LC147" class="line" lang="plaintext">  Array cookie:            ac</span>&#x000A;<span id="LC148" class="line" lang="plaintext">  Intra object redzone:    bb</span>&#x000A;<span id="LC149" class="line" lang="plaintext">  ASan internal:           fe</span>&#x000A;<span id="LC150" class="line" lang="plaintext">  Left alloca redzone:     ca</span>&#x000A;<span id="LC151" class="line" lang="plaintext">  Right alloca redzone:    cb</span>&#x000A;<span id="LC152" class="line" lang="plaintext">==63330==ABORTING</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div></div>
</div>

</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/11167699/issues/1810/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="gl-border-solid gl-border-1 gl-border-default gl-rounded-base gl-mt-5 gl-p-3 gl-text-center">
To upload designs, you'll need to enable LFS and have an admin enable hashed storage. <a href="/help/user/project/issues/design_management.md#prerequisites" target="_blank" rel="noopener noreferrer">More information</a>
</div>

<div class="js-work-item-links-root" data-full-path="qemu-project/qemu" data-issuable-id="131718767" data-issuable-iid="1810" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/qemu/-/epics" data-wi-full-path="qemu-project/qemu" data-wi-group-id="3038080" data-wi-group-issues-path="/groups/qemu/-/issues" data-wi-group-path="qemu-project" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/qemu-project/qemu/-/issues" data-wi-labels-fetch-path="/groups/qemu/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/qemu-project/qemu/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=3038080" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/qemu-project/qemu/-/issues/1810/links" data-full-path="qemu-project/qemu" data-has-issue-weights-feature="true" data-has-iterations-feature="true" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="true" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/qemu/-/epics" data-wi-full-path="qemu-project/qemu" data-wi-group-id="3038080" data-wi-group-issues-path="/groups/qemu/-/issues" data-wi-group-path="qemu-project" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/qemu-project/qemu/-/issues" data-wi-labels-fetch-path="/groups/qemu/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/qemu-project/qemu/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=3038080" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="true" data-iid="1810" data-project-path="qemu-project/qemu" id="js-related-merge-requests"></div>
<div data-url="/qemu-project/qemu/-/issues/1810/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:131718767,&quot;iid&quot;:1810,&quot;description&quot;:&quot;## Host environment\n\n- Operating system: Ubuntu 20.04\n- OS/kernel version: Linux 5.4.0-148\n- Architecture: x86_64\n- QEMU flavor: qemu-system-x86_64\n- QEMU version: commit at c167c80b46\n- QEMU command line:\n\n  ```plaintext\n  QEMU_FUZZ_ARGS=\&quot;-device am53c974,id=scsi -device scsi-hd,drive=disk0 -drive id=disk0,if=none,file=null-co://,format=raw -nodefaults\&quot; \\ QEMU_FUZZ_OBJECTS=\&quot;*esp* *scsi* *am53c974*\&quot; ./qemu-fuzz-x86_64 --fuzz-target=generic-fuzz\n  ```\n\n## Description of problem\n\nGot a heap-buffer-overflow error when fuzzing the device am53c974.\n\n## Steps to reproduce\n\nMinimized reproducer:\n\n```plaintext\ncat \u003c\u003c EOF | ./qemu-system-x86_64 -display none -machine accel=qtest, -m 512M -device \\\nam53c974,id=scsi -device scsi-hd,drive=disk0 -drive \\\nid=disk0,if=none,file=null-co://,format=raw -nodefaults -qtest /dev/null\\\n -qtest stdio\noutl 0xcf8 0x80001010\noutl 0xcfc 0xc000\noutl 0xcf8 0x80001004\noutw 0xcfc 0x05\noutl 0xc03d 0x03000000\noutl 0xc047 0x065a9d80\noutl 0xc00a 0xc10000\nwrite 0x65a9d 0x1 0x04\nwrite 0x65a9e 0x1 0x10\noutl 0xc03d 0x03000000\noutl 0xc00a 0xc10000\noutl 0xc00b 0x0800\noutl 0xc00b 0x00\noutl 0xc00b 0x0800\noutl 0xc00b 0x0800\noutl 0xc00b 0x0800\noutl 0xc00b 0x0400\noutl 0xc00b 0x0800\noutl 0xc00b 0x0800\noutw 0xc00b 0x1000\noutw 0xc00b 0x9000\nEOF\n```\n\n## Additional information\n\nThe crash report triggered by the reproducer is:\n\n```plaintext\n[I 0.000000] OPENED\n[R +0.022834] outl 0xcf8 0x80001010\n[S +0.022864] OK\nOK\n[R +0.022874] outl 0xcfc 0xc000\n[S +0.022887] OK\nOK\n[R +0.022942] outl 0xcf8 0x80001004\n[S +0.022990] OK\nOK\n[R +0.023028] outw 0xcfc 0x05\n[S +0.023508] OK\nOK\n[R +0.023518] outl 0xc03d 0x03000000\n[S +0.023527] OK\nOK\n[R +0.023532] outl 0xc047 0x065a9d80\n[S +0.023537] OK\nOK\n[R +0.023544] outl 0xc00a 0xc10000\n[S +0.023573] OK\nOK\n[R +0.023581] write 0x65a9d 0x1 0x04\n[S +0.023891] OK\nOK\n[R +0.023900] write 0x65a9e 0x1 0x10\n[S +0.023906] OK\nOK                                                                                                                                                                                                                                                                                                                           [R +0.023910] outl 0xc03d 0x03000000\n[S +0.023917] OK\nOK\n[R +0.023921] outl 0xc00a 0xc10000\n[S +0.023983] OK\nOK\n[R +0.023581] write 0x65a9d 0x1 0x04\n[S +0.023891] OK\nOK\n[R +0.023900] write 0x65a9e 0x1 0x10\n[S +0.023906] OK\nOK                                                                                                                                                                                                                                                                                                                           [R +0.023910] outl 0xc03d 0x03000000\n[S +0.023917] OK\nOK\n[R +0.023921] outl 0xc00a 0xc10000\n[S +0.023983] OK\nOK\n[R +0.023991] outl 0xc00b 0x0800\n[S +0.023998] OK\nOK\n[R +0.024002] outl 0xc00b 0x00\n[S +0.024008] OK\nOK\n[R +0.024014] outl 0xc00b 0x0800\n[S +0.024028] OK\nOK\n[R +0.024034] outl 0xc00b 0x0800\n[S +0.024040] OK\nOK\n[R +0.024051] outl 0xc00b 0x0800\n[S +0.024058] OK\nOK\n[R +0.024065] outl 0xc00b 0x0400\n[S +0.024073] OK\nOK\n[R +0.024082] outl 0xc00b 0x0800\n[S +0.024089] OK\nOK\n[R +0.024104] outl 0xc00b 0x0800\n[S +0.024121] OK\nOK\n[R +0.024133] outw 0xc00b 0x1000\n[S +0.024150] OK\nOK\n[R +0.024159] outw 0xc00b 0x9000\n=================================================================\n==63330==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62500020c000 at pc 0x5601fffcf1d4 bp 0x7ffe1920dcf0 sp 0x7ffe1920d4b0\nWRITE of size 32736 at 0x62500020c000 thread T0\n    #0 0x5601fffcf1d3 in __asan_memcpy ../../llvm-project-15.0.0.src/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3\n    #1 0x5602015f506b in flatview_read_continue ../softmmu/physmem.c:2726:13\n    #2 0x5602015f5ee3 in flatview_read ../softmmu/physmem.c:2762:12\n    #3 0x5602015f5bf7 in address_space_read_full ../softmmu/physmem.c:2775:18\n    #4 0x560200943ef0 in dma_memory_rw_relaxed ../include/sysemu/dma.h:87:12\n    #5 0x560200943ef0 in dma_memory_rw ../include/sysemu/dma.h:130:12\n    #6 0x560200943ef0 in pci_dma_rw ../hw/pci/pci_device.h:233:12\n    #7 0x560200943ef0 in esp_pci_dma_memory_rw ../hw/scsi/esp-pci.c:283:5\n    #8 0x56020092db7e in esp_do_dma ../hw/scsi/esp.c\n    #9 0x560200935774 in handle_ti ../hw/scsi/esp.c:912:9\n    #10 0x560200932db6 in esp_reg_write ../hw/scsi/esp.c:1083:13\n    #11 0x56020094574d in esp_pci_io_write ../hw/scsi/esp-pci.c:214:9\n    #12 0x5602015b5f23 in memory_region_write_accessor ../softmmu/memory.c:493:5\n    #13 0x5602015b56aa in access_with_adjusted_size ../softmmu/memory.c:569:18\n    #14 0x5602015b4a50 in memory_region_dispatch_write ../softmmu/memory.c\n    #15 0x5602015fefbf in flatview_write_continue ../softmmu/physmem.c:2653:23\n    #16 0x5602015f6463 in flatview_write ../softmmu/physmem.c:2695:12\n    #17 0x5602015f6177 in address_space_write ../softmmu/physmem.c:2791:18\n    #18 0x5602015a7e99 in cpu_outw ../softmmu/ioport.c:75:5\n    #19 0x560200d28daa in qtest_process_command ../softmmu/qtest.c:483:13\n    #20 0x560200d2795b in qtest_process_inbuf ../softmmu/qtest.c:788:9\n    #21 0x560201b581a6 in fd_chr_read ../chardev/char-fd.c:72:9\n    #22 0x7f8fce57e04d in g_main_context_dispatch (/lib/x86_64-linux-gnu/libglib-2.0.so.0+0x5204d) (BuildId: 5fdb313daf182a33a858ba2cc945211b11d34561)\n    #23 0x560201dc540f in glib_pollfds_poll ../util/main-loop.c:290:9\n    #24 0x560201dc540f in os_host_main_loop_wait ../util/main-loop.c:313:5\n    #25 0x560201dc540f in main_loop_wait ../util/main-loop.c:592:11\n    #26 0x560200d34f76 in qemu_main_loop ../softmmu/runstate.c:732:9\n    #27 0x56020173e835 in qemu_default_main ../softmmu/main.c:37:14\n    #28 0x7f8fcd3a5082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16\n    #29 0x5601fff2009d in _start ./qemu-system-x86_64+0x1e9109d)\n\n0x62500020c000 is located 0 bytes to the right of 4096-byte region [0x62500020b000,0x62500020c000)\nallocated by thread T0 here:\n    #0 0x5601fffd0a0c in posix_memalign ../../llvm-project-15.0.0.src/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3\n    #1 0x560201db83da in qemu_try_memalign ../util/memalign.c:53:11\n    #2 0x560201db8762 in qemu_memalign ../util/memalign.c:73:15\n    #3 0x5602008c779e in scsi_req_enqueue ../hw/scsi/scsi-bus.c:906:10\n    #4 0x56020093bd2f in do_command_phase ../hw/scsi/esp.c:296:15\n    #5 0x56020093bd2f in do_cmd ../hw/scsi/esp.c:344:5\n    #6 0x560200932911 in esp_reg_write ../hw/scsi/esp.c:1112:13\n    #7 0x56020094574d in esp_pci_io_write ../hw/scsi/esp-pci.c:214:9\n    #8 0x5602015b5f23 in memory_region_write_accessor ../softmmu/memory.c:493:5\n    #9 0x5602015b56aa in access_with_adjusted_size ../softmmu/memory.c:569:18\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow ./llvm-project-15.0.0.src/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3 in __asan_memcpy\nShadow bytes around the buggy address:\n  0x0c4a800397b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c4a800397c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c4a800397d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c4a800397e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c4a800397f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=\u003e0x0c4a80039800:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c4a80039810: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c4a80039820: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c4a80039830: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c4a80039840: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c4a80039850: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07\n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==63330==ABORTING\n```&quot;,&quot;title&quot;:&quot;heap-buffer-overflow in esp_do_dma()&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:null,&quot;updated_by_id&quot;:1984097,&quot;created_at&quot;:&quot;2023-08-04T06:22:03Z&quot;,&quot;updated_at&quot;:&quot;2023-10-03T16:30:22Z&quot;,&quot;milestone&quot;:null,&quot;labels&quot;:[{&quot;id&quot;:19837702,&quot;title&quot;:&quot;Fuzzer&quot;,&quot;color&quot;:&quot;#e6e6fa&quot;,&quot;description&quot;:&quot;Issues found via fuzzing. For security issues, please consult https://www.qemu.org/contribute/security-process/&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2021-05-01T05:48:13.545Z&quot;,&quot;updated_at&quot;:&quot;2023-02-02T10:19:22.407Z&quot;,&quot;group_id&quot;:null,&quot;project_id&quot;:11167699,&quot;template&quot;:false},{&quot;id&quot;:16943896,&quot;title&quot;:&quot;Storage&quot;,&quot;color&quot;:&quot;#f7e7ce&quot;,&quot;description&quot;:&quot;Block subsystem, Storage devices, etc.&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-11-04T15:25:32.216Z&quot;,&quot;updated_at&quot;:&quot;2023-02-02T10:16:47.907Z&quot;,&quot;group_id&quot;:null,&quot;project_id&quot;:11167699,&quot;template&quot;:false}],&quot;lock_version&quot;:0,&quot;author_id&quot;:1226603,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[],&quot;due_date&quot;:null,&quot;project_id&quot;:11167699,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/qemu-project/qemu/-/issues/1810&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/qemu-project/qemu/notes?target_id=131718767\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/qemu-project/qemu/-/preview_markdown?target_id=1810\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;,&quot;weight&quot;:null,&quot;blocked&quot;:false,&quot;blocked_by_issues&quot;:[]}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:131718767,&quot;projectId&quot;:11167699,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/qemu-project/qemu/-/issues/1810/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/qemu-project/qemu/-/issues/1810.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/qemu-project/qemu/-/issues/1810.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/qemu-project/qemu/noteable/issue/131718767/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736608897000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-border-0" type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/qemu-project/qemu/-/issues/1810.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="200">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>
<div class="block epic" data-testid="sidebar-epic">
<div class="js-sidebar-epic-widget-root" data-can-edit="false" data-group-path="qemu-project" data-issue-id="131718767" data-issue-iid="1810" data-project-path="qemu-project/qemu"></div>
</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="true" data-can-edit="" data-iid="1810" data-issuable-type="issue" data-labels-fetch-path="/qemu-project/qemu/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/qemu-project/qemu/-/labels" data-project-issues-path="/qemu-project/qemu/-/issues" data-project-path="qemu-project/qemu" data-selected-labels="[{&quot;id&quot;:19837702,&quot;title&quot;:&quot;Fuzzer&quot;,&quot;color&quot;:&quot;#e6e6fa&quot;,&quot;description&quot;:&quot;Issues found via fuzzing. For security issues, please consult https://www.qemu.org/contribute/security-process/&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2021-05-01T05:48:13.545Z&quot;,&quot;updated_at&quot;:&quot;2023-02-02T10:19:22.407Z&quot;,&quot;group_id&quot;:null,&quot;project_id&quot;:11167699,&quot;template&quot;:false},{&quot;id&quot;:16943896,&quot;title&quot;:&quot;Storage&quot;,&quot;color&quot;:&quot;#f7e7ce&quot;,&quot;description&quot;:&quot;Block subsystem, Storage devices, etc.&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-11-04T15:25:32.216Z&quot;,&quot;updated_at&quot;:&quot;2023-02-02T10:16:47.907Z&quot;,&quot;group_id&quot;:null,&quot;project_id&quot;:11167699,&quot;template&quot;:false}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="1810" data-project-path="qemu-project/qemu"></div>
</div>
<div class="block" data-testid="iteration-container"><div class="js-sidebar-iteration-widget-root" data-can-edit="" data-group-path="qemu-project" data-issue-id="131718767" data-issue-iid="1810" data-project-path="qemu-project/qemu"></div>
</div>
<div class="js-sidebar-weight-widget-root" data-can-edit="" data-issue-iid="1810" data-project-path="qemu-project/qemu"></div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<div class="js-sidebar-health-status-widget-root" data-can-edit="" data-full-path="qemu-project/qemu" data-iid="1810" data-issuable-type="issue"></div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="block">
<div class="hide-collapsed gl-flex gl-items-center gl-font-bold gl-leading-20 gl-text-default">
Confidentiality
</div>
<div class="hide-collapsed gl-text-subtle">
Confidentiality controls have moved to the issue actions menu (<svg class="s12 gl-align-middle" data-testid="ellipsis_v-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#ellipsis_v"></use></svg>) at the top of the page.
</div>
</div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/qemu-project/qemu/-/issues/1810.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/qemu-project/qemu/-/issues/1810/toggle_subscription","moveIssueEndpoint":"/qemu-project/qemu/-/issues/1810/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=11167699","editable":"","currentUser":{},"rootPath":"/","fullPath":"qemu-project/qemu","iid":1810,"id":131718767,"severity":"unknown","timeTrackingLimitToHours":true,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false","weightOptions":["None","Any",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"weightNoneValue":"None","multipleApprovalRulesAvailable":null}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script nonce="q3pHw79SKipFraIBJPmkLQ==">
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script nonce="q3pHw79SKipFraIBJPmkLQ==">
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

