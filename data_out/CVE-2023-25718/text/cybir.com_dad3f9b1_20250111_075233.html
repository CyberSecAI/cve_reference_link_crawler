
[Skip to the content](#maincontent)

* [Company](https://cybir.com/company/)
* [Our Services](https://cybir.com/services/)
  + [Managed Security Services Provider](https://cybir.com/service/managed-security-services-provider/)
  + [Data Security and Privacy Compliance](https://cybir.com/service/data-security-and-privacy-compliance/)
  + [Breach Response](https://cybir.com/service/breach-incident-response/)
  + [Digital Forensics, eDiscovery, & Data Recovery](https://cybir.com/service/digital-forensics-ediscovery-data-recovery/)
* [Insights](https://cybir.com/insights/)
* [Contact](https://cybir.com/contact/)
* Breach Hotline

# Proof Of Concept: Connectwise Control Screenconnect Signed Executable to Arbitrary Code Execution via ARP Poisoning / DNS Hijacking / Unsanitized Client Parameters or Host Headers with CVE-2020-3147 (Cisco Sx / SMB Series Switches)

December 6, 2022[CVE](https://cybir.com/category/cve/)[Cyber Security](https://cybir.com/category/cyber-security/)[Forensics](https://cybir.com/category/forensics/)[Incident Response](https://cybir.com/category/incident-response/)

I am providing this simple proof of concept walkthrough to demonstrate weaponization of an Arbitrary Code Execution (HTTP/HTTPS Request) in Connectwise ScreenConnect & Control Client (via CVE-2020-3147.) This walkthrough can be performed / used to man-in-the-middle or poison DNS requests via Responder and trigger the condition.

Step 1: Attacker triggers CVE-2020-3147 via malformed HTTP request to web interface. OR… step 2.

[Cisco Small Business Switches Denial of Service Vulnerability – Cisco](https://www.cisco.com/c/en/us/support/docs/csa/cisco-sa-smlbus-switch-dos-R6VquS2u.html)

Step 2: The attacker poisons DNS via ARP / Known Attacks. Responder provides a spoofed DNS record.

![](https://cybir.com/wp-content/uploads/2022/12/poisoning-DNS.png)

Responder Launch

![](https://cybir.com/wp-content/uploads/2022/12/image-12.png)

Poisoned DNS response.

On the victim machine, the DNS record is poisoned:

![](https://cybir.com/wp-content/uploads/2022/12/two-fqdns-1024x546.png)

Pre-Activation copy of ScreenConnect controlled by attacker.

***The client is downloaded by the victim*** and executes the requested code. (http request to vulnerable Cisco switch, exploit embedded in file & HTTP request to 192.168.1.254)

***THIS EXECUTABLE, SIGNED BINARY BYPASSES HASH BANNING AND ENDPOINT CONTROLS…. in things like Huntress!***

![](https://cybir.com/wp-content/uploads/2022/12/image-14.png)
## Attack Flow: What has happened?

1. The trusted executable still runs, triggering an HTTP request to the resolving IP.
2. This MALFORMED HTTP Request is the exploit for CVE-2020-3147
3. The client is tampered (via Poisoning of the DNS response or hijacked record.)
4. The now resolving DNS record is where the request is sent.
5. The server fails to sanitize these parameters.
6. Open WinHex and examine the executable.
7. Look at this client download request.. IT’S VIA HTTP!

[Intercepting HTTP traffic with Burp Proxy – PortSwigger](https://portswigger.net/burp/documentation/desktop/getting-started/intercepting-http-traffic)

![](https://cybir.com/wp-content/uploads/2022/12/image-13-1024x363.png)

It really is this easy. No social engineering needed.

I have succesfully tampered with a trusted, signed executable in transit. The executable performs an arbitrary HTTP request that will reboot a Cisco Sx series switch and allow the attacker to MITM / ARP / HTTP intercept the entire network.\*The switch / network are taken down for 5-10 minutes.. hence a Denial of Service (and high severity problem, ask Cisco!)

Prreeettty basic stuff..

[Man in the Middle (MITM) Attacks | Types, Techniques, and Prevention (rapid7.com)](https://www.rapid7.com/fundamentals/man-in-the-middle-attacks/)

## References and Tools for PoC / Exploitation:

[Kali Linux ARP Poisoning/Spoofing Attack – YouTube](https://www.youtube.com/watch?v=mchrDyBdMmc)

[Man in the Middle Attack: Tutorial & Examples | Veracode](https://www.veracode.com/security/man-middle-attack)

[DNS spoofing – The Hacker Recipes](https://www.thehacker.recipes/ad/movement/mitm-and-coerced-authentications/dns-spoofing)

***Still a banger of a track and a watermark:***

[DMX – We Right Here – YouTube](https://www.youtube.com/watch?v=MHl2OzgPlgA)

116 Front St #68 Lewes,
DE 19958 USA

© 2025 CYBIR. All Rights Reserved.

* [Company](https://cybir.com/company/)
* [Our Services](https://cybir.com/services/)
* [Insights](https://cybir.com/insights/)
* [Contact](https://cybir.com/contact/)

Join Our Mailing List

Sign-up with your email address to get all product updates and security news delivered to your inbox.

