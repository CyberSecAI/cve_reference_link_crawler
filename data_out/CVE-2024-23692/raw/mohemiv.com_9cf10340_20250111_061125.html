<!DOCTYPE html>
<html lang="en">

<head>


<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="format-detection" content="telephone=no">
<meta name='robots' content='max-image-preview:large' />
<meta charset="utf-8"/>

<title>Rejetto HTTP File Server 2.3m Unauthenticated RCE</title>

<base href="https://mohemiv.com/" />

<link rel="stylesheet" type="text/css" href="https://mohemiv.com/system/themes/plain/styles/main.css?1659243194" />
<link rel="stylesheet" type="text/css" href="https://mohemiv.com/system/themes/plain/styles/additional.css?1660397055" />

<link rel="alternate" type="application/rss+xml" title="Arseniy Sharoglazov" href="https://mohemiv.com/rss/" />

<link rel="index" id="link-index" href="https://mohemiv.com/" />
<link rel="prev" id="link-prev" href="https://mohemiv.com/all/exploiting-xxe-with-local-dtd-files/" />
<link rel="next" id="link-next" href="https://mohemiv.com/all/que-es-xxe-y-como-funciona/" />


<meta name="robots" content="index, follow" />

<meta name="description" content="I just decided to share an interesting Unauthenticated RCE and the story behind it!" />
<meta name="og:description" content="I just decided to share an interesting Unauthenticated RCE and the story behind it!" />

<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:site" content="@_mohemiv" />

<meta property="og:type" content="article" />
<meta property="article:author" content="Arseniy Sharoglazov" />
<meta name="twitter:creator" content="@_mohemiv"/>
<meta property="og:title" content="Rejetto HTTP File Server 2.3m Unauthenticated RCE" />
<meta property="og:url" content="https://mohemiv.com/all/rejetto-http-file-server-2-3m-unauthenticated-rce/" />

<meta property="og:image" content="https://mohemiv.com/pictures/httpfileserver-preview-twitter.png" />

<meta name="twitter:card" content="summary_large_image" />


<script type="text/javascript">
document.e2 = document.e2 || {}
document.e2.serverTime = 1736575885 
document.e2.cookiePrefix = '_'
</script>
<script type="text/javascript" src="https://mohemiv.com/system/library/highlight/highlight.js?1511684478"></script>
<script type="text/javascript" src="https://mohemiv.com/system/library/jquery/jquery.js?1649011394"></script>
<script type="text/javascript" src="https://mohemiv.com/system/theme/js/main.js?1659207356"></script>


</head>

<body
  >





<div class="common">



<div class="flag">
  
  <div class="header-content">

    <div class="header-description">

      <div class="title">

        <div class="title-inner">

          <div class="logo-marginal">
            <div
  class="
    e2-user-picture-container
          "
  >
  <div class="e2-user-picture-inner">
    <a href="https://mohemiv.com/" class="nu e2-user-picture-container-link">
        <img
          src="https://mohemiv.com/user/userpic@2x.jpg?1660410813"
          class="e2-user-picture-image"
          alt=""
        />
        <div class="e2-user-picture-placeholder">
          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" xml:space="preserve"><circle fill="none" cx="20" cy="20" r="19.5"/><path stroke="none" d="m33.009 33.775-.66-.327c-1.905-.544-3.805-1.104-5.715-1.627-2.121-.58-2.958-1.511-2.557-3.646.349-1.86 1.183-3.627 1.766-5.447.403-1.259 1.265-2.668.989-3.778-.398-1.603-.046-3.015.045-4.518.123-2.023-.255-3.987-2.162-5.055C23.196 8.529 21.61 7.984 20 8c-1.61-.016-3.196.528-4.714 1.378-1.907 1.068-2.285 3.032-2.162 5.055.091 1.503.443 2.914.045 4.518-.276 1.11.586 2.519.989 3.778.583 1.82 1.417 3.586 1.766 5.447.401 2.134-.436 3.066-2.557 3.646-1.911.522-3.811 1.083-5.715 1.627l-.66.327-.295 1.254C9.24 37.341 13.461 40 20 40s10.76-2.659 13.304-4.971l-.295-1.254z"/></svg>
        </div>
      </a>      </div>
</div>
          </div>

          <div class="logo">
            <div
  class="
    e2-user-picture-container
          "
  >
  <div class="e2-user-picture-inner">
    <a href="https://mohemiv.com/" class="nu e2-user-picture-container-link">
        <img
          src="https://mohemiv.com/user/userpic@2x.jpg?1660410813"
          class="e2-user-picture-image"
          alt=""
        />
        <div class="e2-user-picture-placeholder">
          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" xml:space="preserve"><circle fill="none" cx="20" cy="20" r="19.5"/><path stroke="none" d="m33.009 33.775-.66-.327c-1.905-.544-3.805-1.104-5.715-1.627-2.121-.58-2.958-1.511-2.557-3.646.349-1.86 1.183-3.627 1.766-5.447.403-1.259 1.265-2.668.989-3.778-.398-1.603-.046-3.015.045-4.518.123-2.023-.255-3.987-2.162-5.055C23.196 8.529 21.61 7.984 20 8c-1.61-.016-3.196.528-4.714 1.378-1.907 1.068-2.285 3.032-2.162 5.055.091 1.503.443 2.914.045 4.518-.276 1.11.586 2.519.989 3.778.583 1.82 1.417 3.586 1.766 5.447.401 2.134-.436 3.066-2.557 3.646-1.911.522-3.811 1.083-5.715 1.627l-.66.327-.295 1.254C9.24 37.341 13.461 40 20 40s10.76-2.659 13.304-4.971l-.295-1.254z"/></svg>
        </div>
      </a>      </div>
</div>
          </div>

          <h1>
            <a href="https://mohemiv.com/"><span id="e2-blog-title">Arseniy Sharoglazov</span></a>          </h1>

        </div>

        <div id="e2-blog-description"></div>

      </div>

    </div>

    <div class="spotlight">
      
      <span class="admin-links-floating">
              </span>

              
<form
  class="e2-search-box-nano e2-enterable"
  action="https://mohemiv.com/@actions/search/"
  method="post"
  accept-charset="utf-8"
>
  <label>
    <input type="search" inputmode="search" name="query" value="" placeholder="Search" required="required" />
    <span class="e2-search-icon"><span class="e2-svgi"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" xml:space="preserve"><path stroke="none" fill-rule="evenodd" clip-rule="evenodd" d="m16 14.5-4.399-4.399a6.212 6.212 0 0 0 1.148-3.602 6.25 6.25 0 1 0-12.5 0 6.25 6.25 0 0 0 6.251 6.25 6.212 6.212 0 0 0 3.602-1.148L14.5 16l1.5-1.5zM1.25 6.501a5.251 5.251 0 1 1 10.502 0 5.251 5.251 0 0 1-10.502 0z"/></svg></span></span>
  </label>
</form>

          </div>

  </div>

  
  </div>



<div class="content">






<div
  class="e2-note  e2-note-favourite"
  data-note-id="5"
    data-note-read-href="https://mohemiv.com/all/rejetto-http-file-server-2-3m-unauthenticated-rce/read/"
  >



<article>




<h1 class="e2-smart-title">
<span class="e2-note-favourite-title">Rejetto HTTP File Server 2.3m Unauthenticated RCE</span> 
</h1>




<div class="e2-note-text e2-text">
<p>I just decided to share an interesting Unauthenticated RCE and the story behind it!</p>
<div class="e2-text-picture">
<div style="width: 740px; max-width: 100%"><div class="e2-text-proportional-wrapper" style="padding-bottom: 56.22%"><img src="https://mohemiv.com/pictures/httpfileserver-preview.png" width="740" height="416" alt="" />
</div></div></div>
<h2>Rejetto HTTP File Server</h2>
<p>During a red team assessment, I stumbled upon a mysterious web app:</p>
<div class="e2-text-picture">
<div style="width: 696px; max-width: 100%"><div class="e2-text-proportional-wrapper" style="padding-bottom: 78.59%"><img src="https://mohemiv.com/pictures/httpfileserver-2.3m-80.png" width="696" height="547" alt="" />
</div></div><div class="e2-text-caption">Here’s what I encountered on the 80/tcp port</div>
</div>
<p>This web application was confirmed to be Rejetto HFS, a once-popular Windows web server first released in August 2002.</p>
<p>A quick online search revealed that version 2.3m has no known vulnerabilities. However, I was surprised to find that older versions had numerous RCEs!</p>
<pre><code class="hljs python">import socket

url = raw_input("Enter URL : ")
try:
      while True:
            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            sock.connect((url, 80))
            cmd = raw_input("Enter command (E.g. calc) or press Ctrl+C to exit : ")
            req = "GET /?{.exec|"+cmd+".}"
            req += " HTTP/1.1\r\n\r\n"
            sock.send(req)
            sock.close()
            print "Done!"
except KeyboardInterrupt:
      print "Bye!"
</code></pre><div class="table-descr-div"><p>This code for exploiting RCE in HTTP File Server 2.1.2 was found <a target="_blank" href="https://www.exploit-db.com/exploits/37985">on ExploitDB</a></p>
</div><p>What is “{.exec”? Is this one of the earliest known template injections? The software appeared too old for such attacks, and the platform, Windows, is also unconventional.</p>
<p>Confused, I decided to download and analyze what was going on. I obtained an exe file from <a target="_blank" href="https://www.rejetto.com/hfs/?f=dl">the official website</a> and found <a target="_blank" href="https://github.com/rejetto/hfs2">the source code on GitHub</a>, which turned out to be written in Delphi.</p>
<h2>Unauthenticated Remote Code Execution</h2>
<p>When I saw the code on both GitHub and IDA Pro, I was amazed. Indeed, HFS has its own template parser, making it one of the oldest among its kind.</p>
<p>Furthermore, it took me less than 10 minutes to bypass all restrictions and execute my code on version 2.3m, which was marked as the latest and stable!</p>
<div class="e2-text-picture">
<div style="width: 691px; max-width: 100%"><div class="e2-text-proportional-wrapper" style="padding-bottom: 69.18%"><img src="https://mohemiv.com/pictures/httpfileserver-rce.png" width="691" height="478" alt="" />
</div></div><div class="e2-text-caption">I decided to publish the screenshot in a redacted version</div>
</div>
<p>It was a bit challenging, but in the end, I created a POC that not only executes the code, but also returns the output and hides itself from log files (via a null byte). Note that the value of the Host header was also tampered with, which is crucial for the injection.</p>
<h2>Reporting</h2>
<p>I was sad to learn that Rejetto HTTP File Server 2.x is now obsolete and no longer supported. After a discussion with Massimo Melina, we concluded that we should recommend all users to update to HFS 3.</p>
<h2>Timeline</h2>
<pre><code class="hljs xml">18/08/2023 — Reported to the vendor
21/08/2023 — Reply received
24/05/2024 — Vendor informed about disclosure
24/05/2024 — Reply received
25/05/2024 — Article released
25/05/2024 — CVE Request 1671764
31/05/2024 — MITRE assigned CVE-2024-23692
06/06/2024 — Stephen Fewer published <a href="https://github.com/rapid7/metasploit-framework/pull/19240" target="_blank">the metasploit module</a> and <a href="https://attackerkb.com/topics/d9AVVdmNhH/cve-2024-23692" target="_blank">the attackerkb article</a>
 </code></pre></div>

</article>







<div class="e2-note-meta">


<span><span class="e2-svgi"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 16 16" style="enable-background:new 0 0 16 16" xml:space="preserve"><path d="M8 12.5C3 12.5.3 8.4.2 8.3L0 8l.1-.3C.2 7.6 2.5 3.5 8 3.5s7.8 4.1 7.8 4.3l.2.3-.2.2c-.1.2-2.8 4.2-7.8 4.2zM1.2 8c.7.8 3.1 3.5 6.8 3.5 3.8 0 6.1-2.7 6.8-3.5-.6-.9-2.6-3.5-6.8-3.5-4.2 0-6.2 2.6-6.8 3.5z" stroke="none"/><path d="M8 10.5c-1.9 0-3.5-1.6-3.5-3.5S6.1 3.5 8 3.5s3.5 1.6 3.5 3.5-1.6 3.5-3.5 3.5zm0-6C6.6 4.5 5.5 5.6 5.5 7S6.6 9.5 8 9.5s2.5-1.1 2.5-2.5S9.4 4.5 8 4.5z" stroke="none"/><circle cx="6.7" cy="6.5" r="1.5"/></svg></span> 7750</span> &nbsp;
<span title="25 May 2024, 01:51, GMT+03:00">7 mo</span> &nbsp;

<a href="https://mohemiv.com/tags/rce/" class="e2-tag">RCE</a> &nbsp; <a href="https://mohemiv.com/tags/security/" class="e2-tag">SECURITY</a></div>


</div>







<section>
<div class="e2-section-heading">Next</div>




<div class="e2-notes-gallery ">


  
  <div class="e2-notes-gallery-area" style="grid-area: 1/3/2/5">

    
  
  
  <div class="e2-notes-gallery-item  e2-notes-gallery-item-with-large-title">

    
    <div class="e2-notes-gallery-text">

      <div class="e2-notes-gallery-item-title  e2-notes-gallery-item-title-large"><a href="https://mohemiv.com/all/que-es-xxe-y-como-funciona/" title="31 May 2024, 15:52">¿Qué es XXE y cómo funciona?</a></div>

            <div class="e2-notes-gallery-item-summary">XXE es una vulnerabilidad en el procesamiento de XML, un texto que está marcado según reglas específicas</div>
      
      <div class="e2-notes-gallery-item-meta">
        
                
        <span><span class="e2-svgi"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 16 16" style="enable-background:new 0 0 16 16" xml:space="preserve"><path d="M8 12.5C3 12.5.3 8.4.2 8.3L0 8l.1-.3C.2 7.6 2.5 3.5 8 3.5s7.8 4.1 7.8 4.3l.2.3-.2.2c-.1.2-2.8 4.2-7.8 4.2zM1.2 8c.7.8 3.1 3.5 6.8 3.5 3.8 0 6.1-2.7 6.8-3.5-.6-.9-2.6-3.5-6.8-3.5-4.2 0-6.2 2.6-6.8 3.5z" stroke="none"/><path d="M8 10.5c-1.9 0-3.5-1.6-3.5-3.5S6.1 3.5 8 3.5s3.5 1.6 3.5 3.5-1.6 3.5-3.5 3.5zm0-6C6.6 4.5 5.5 5.6 5.5 7S6.6 9.5 8 9.5s2.5-1.1 2.5-2.5S9.4 4.5 8 4.5z" stroke="none"/><circle cx="6.7" cy="6.5" r="1.5"/></svg></span> 806</span> &nbsp;        
        <span title="31 May 2024, 15:52, GMT+03:00">7 mo</span>

      </div>

    </div>
  </div>

    </div>


  
  <div class="e2-notes-gallery-area" style="grid-area: 1/1/2/2">

    
  
  
  <div class="e2-notes-gallery-item ">

        <a href="https://mohemiv.com/all/exploiting-xxe-with-local-dtd-files/" class="e2-notes-gallery-image nu" >
    <div class=" e2-notes-gallery-thumb" ><img src="https://mohemiv.com/pictures/thumbs/exploiting-xxe-with-local-dtd-files-preview.thumb@2x.png" width="90" height="51" /></div>
    </a>
    
    <div class="e2-notes-gallery-text">

      <div class="e2-notes-gallery-item-title "><a href="https://mohemiv.com/all/exploiting-xxe-with-local-dtd-files/" title="13 December 2018, 21:00">Exploiting XXE with local DTD files</a></div>

      
      <div class="e2-notes-gallery-item-meta">
        
                
        <span><span class="e2-svgi"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 16 16" style="enable-background:new 0 0 16 16" xml:space="preserve"><path d="M8 12.5C3 12.5.3 8.4.2 8.3L0 8l.1-.3C.2 7.6 2.5 3.5 8 3.5s7.8 4.1 7.8 4.3l.2.3-.2.2c-.1.2-2.8 4.2-7.8 4.2zM1.2 8c.7.8 3.1 3.5 6.8 3.5 3.8 0 6.1-2.7 6.8-3.5-.6-.9-2.6-3.5-6.8-3.5-4.2 0-6.2 2.6-6.8 3.5z" stroke="none"/><path d="M8 10.5c-1.9 0-3.5-1.6-3.5-3.5S6.1 3.5 8 3.5s3.5 1.6 3.5 3.5-1.6 3.5-3.5 3.5zm0-6C6.6 4.5 5.5 5.6 5.5 7S6.6 9.5 8 9.5s2.5-1.1 2.5-2.5S9.4 4.5 8 4.5z" stroke="none"/><circle cx="6.7" cy="6.5" r="1.5"/></svg></span> 47873</span> &nbsp;        
        <span title="13 December 2018, 21:00, GMT+03:00">2018</span>

      </div>

    </div>
  </div>

    </div>


  
  <div class="e2-notes-gallery-area" style="grid-area: 1/2/2/3">

    
  
  
  <div class="e2-notes-gallery-item ">

        <a href="https://mohemiv.com/all/evil-xml/" class="e2-notes-gallery-image nu" >
    <div class=" e2-notes-gallery-thumb" ><img src="https://mohemiv.com/pictures/thumbs/evil-xml-with-two-encodings-preview.thumb@2x.png" width="90" height="45" /></div>
    </a>
    
    <div class="e2-notes-gallery-text">

      <div class="e2-notes-gallery-item-title "><a href="https://mohemiv.com/all/evil-xml/" title="4 February 2018, 09:00">Evil XML with Two Encodings</a></div>

      
      <div class="e2-notes-gallery-item-meta">
        
                
        <span><span class="e2-svgi"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 16 16" style="enable-background:new 0 0 16 16" xml:space="preserve"><path d="M8 12.5C3 12.5.3 8.4.2 8.3L0 8l.1-.3C.2 7.6 2.5 3.5 8 3.5s7.8 4.1 7.8 4.3l.2.3-.2.2c-.1.2-2.8 4.2-7.8 4.2zM1.2 8c.7.8 3.1 3.5 6.8 3.5 3.8 0 6.1-2.7 6.8-3.5-.6-.9-2.6-3.5-6.8-3.5-4.2 0-6.2 2.6-6.8 3.5z" stroke="none"/><path d="M8 10.5c-1.9 0-3.5-1.6-3.5-3.5S6.1 3.5 8 3.5s3.5 1.6 3.5 3.5-1.6 3.5-3.5 3.5zm0-6C6.6 4.5 5.5 5.6 5.5 7S6.6 9.5 8 9.5s2.5-1.1 2.5-2.5S9.4 4.5 8 4.5z" stroke="none"/><circle cx="6.7" cy="6.5" r="1.5"/></svg></span> 13790</span> &nbsp;        
        <span title="4 February 2018, 09:00, GMT+03:00">2018</span>

      </div>

    </div>
  </div>

    </div>


</div></section>





<div class="e2-pages">
<div class="e2-pages-prev-next">

<div class="e2-pages-prev"><span class="e2-keyboard-shortcut">Ctrl ←</span><a href="https://mohemiv.com/all/exploiting-xxe-with-local-dtd-files/">Exploiting XXE with local DTD files</a></div><div class="e2-pages-next"><span class="e2-keyboard-shortcut">Ctrl →</span><a href="https://mohemiv.com/all/que-es-xxe-y-como-funciona/">¿Qué es XXE y cómo funciona?</a></div>
</div>
</div>

  <a name="comments"></a>



        







  

</div>




<div class="footer engine">
<div style= "display:inline-block; width: auto; vertical-align:middle; margin-top:-20px; margin-bottom: 40px;  border: 1px solid #D9D9D9; border-radius: .7em;"><a style="text-decoration: none; font-size: 18px; color: black; padding: 10px; display:inline-block;" href="https://twitter.com/_mohemiv"><img style="vertical-align:middle;" src="/system/themes/plain/twitter.png" height="40">Subscribe to new articles</a></div>
<br>

© <span id="e2-blog-author">Arseniy Sharoglazov</span>,
 2018–2025, All content is available under
 <a class="nu" rel="license" href="https://creativecommons.org/licenses/by/4.0/" target="_blank"><u>CC BY 4.0</u></a>
<a class="e2-rss-button" href="https://mohemiv.com/rss/">RSS</a>

<div class="engine">
<span>Powered by <a href="https://blogengine.me/" target="_blank" class="nu"><u>Aegea</u> <span class="e2-svgi"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" xml:space="preserve"><path fill-rule="evenodd" clip-rule="evenodd" d="M30.674 23.666c-3.088 5.904-12.169 10.445-20.277 7.313-1.482-.573-3.709-.478-5.3-1.794-1.616-1.336-1.724-3.301-2.422-4.409-3.758-5.963-2.902-13.47.025-18.003C6.547.816 15.82-.531 23.298 3.826c7.477 4.357 10.48 13.904 7.376 19.84zM22.666 4.741C16.286.647 6.68 2.3 3.711 7.833c-2.7 5.032-.013 13.225 7.464 17.583 7.479 4.356 15.47 3.562 18.5-2.447 2.897-5.746-.051-13.763-7.009-18.228zm-2.695 11.171c-.731-.468-.918-1.25.138-1.65.765-.291 4.051-1.271 5.974-1.851.427-.128 1.101-.133 1.587.256 1.61 1.283 2.196 5.594.737 7.865-.337.524-1.116.518-1.651.136-2.113-1.505-6.099-4.315-6.785-4.756zm-1.754-4.197c.019-.904.143-5.073.178-5.586.044-.656.562-.851 1.283-.881 2.078-.087 5.48 2.535 6.146 4.546.284.859-.21 1.358-.808 1.562a271.793 271.793 0 0 1-5.349 1.716c-.814.251-1.472-.208-1.45-1.357zm-9.284 6.666c1.742-.755 6.02-2.299 6.67-2.555.486-.192 1.044.31 1.034.924-.017.958-.244 5.146-.334 7.134-.039.864-.543 1.153-1.459 1.071-2.591-.233-5.901-2.468-6.539-4.902-.234-.896.179-1.477.628-1.672zm8.055-6.536c-.021.846-.787.842-1.427.34-.605-.475-4.481-3.609-6.367-5.093-.504-.395-.508-1.114-.139-1.533 1.308-1.485 5.064-2.103 7.116-1.224.658.281.951.753.945 1.264-.017 1.603-.1 5.174-.128 6.246zm-2.223 2.897c-.824.319-6.743 2.44-7.326 2.614-.8.236-1.26.015-1.663-.404-1.576-1.64-1.669-7.936.767-9.131.523-.257 1.045-.173 1.326.027.281.2 6.277 4.754 7.188 5.506.404.334.396 1.122-.292 1.388zm4.39 2.137c.508.394 4.744 3.436 6.789 5.03.636.496.846 1.222.561 1.872-1.06 2.422-5.861 3.161-7.895 2.271-.846-.371-.923-.87-.908-1.812.031-2.188.16-5.93.146-6.589-.023-1.116.673-1.263 1.307-.772z" stroke="none"/></svg></span></a></span></div>


</div>




</div>

<div class="e2-nice-error e2-nice-error_hidden" role="alert">
  <div class="e2-nice-error-inner"></div>
</div>


</body>




</html>
