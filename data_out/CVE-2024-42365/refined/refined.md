```
{
  "vulnerability": {
    "root_cause": "The Asterisk Manager Interface (AMI) allows users with 'write=originate' permissions to bypass intended restrictions on executing dialplan applications. Specifically, the `Originate` action allows the use of `SET` application with `FILE` and `CURL` functions to modify configuration files and execute system commands, despite checks in `manager.c` aiming to prevent low-privilege users from using applications like `System` directly.",
    "weaknesses": [
      "Insufficient privilege checks for the 'Originate' action in AMI.",
      "Inadequate filtering of appdata, allowing the use of FILE and CURL functions with the SET application.",
      "Bypass of restrictions on sensitive dialplan applications (e.g., System) due to insufficient validation in the 'Originate' action."
    ],
    "impact": "Privilege escalation, remote code execution, and/or blind Server-Side Request Forgery (SSRF). An attacker can modify configuration files, execute arbitrary system commands, and create new administrative users with full permissions.",
    "attack_vectors": "The attacker leverages the Asterisk Manager Interface (AMI) using the 'Originate' action with a low privilege user that has `write=originate` permissions.",
    "required_capabilities": "The attacker needs network access to the Asterisk server and a valid user that has the `write=originate` permission."
  },
  "affected_versions": [
    "<= 18.24.1",
    "<= 20.9.1",
    "<= 21.4.1",
     "<= 18.9-cert10",
    "<= 20.7-cert1"
  ],
  "patched_versions": [
    "18.24.2",
    "20.9.2",
    "21.4.2",
     "18.9-cert11",
    "20.7-cert2"
  ],
    "cwe": [
        "CWE-267",
        "CWE-1220"
    ]
}
```