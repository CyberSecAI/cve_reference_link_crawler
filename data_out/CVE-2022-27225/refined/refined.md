- **Root cause of vulnerability:** Keycloak, used by Gradle Enterprise for identity management, sets a duplicate of a session cookie without the `Secure` attribute for backward compatibility with older Safari browsers.
- **Weaknesses/vulnerabilities present:** The absence of the `Secure` attribute on the duplicate cookie allows it to be sent over plain HTTP, while the original cookie is sent over HTTPS.
- **Impact of exploitation:** An attacker capable of impersonating the Gradle Enterprise host can capture a user's login session by tricking them into accessing the server through an `http://` link. This allows the attacker to steal the insecure cookie and impersonate the user, even when the legitimate server requires HTTPS.
- **Attack vectors:** The attack vector involves tricking a user into clicking on a link to the Gradle Enterprise server via HTTP instead of HTTPS.
- **Required attacker capabilities/position:** The attacker needs to be able to impersonate the Gradle Enterprise host and convince the victim to use an HTTP link to the server.