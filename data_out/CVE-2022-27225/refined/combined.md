=== Content from security.gradle.com_525bfcd2_20250108_121949.html ===

.
[![](/assets/img/98abe277ff094e554056b42b0ea1c0fb.header-logo.svg)](https://gradle.com)

[All advisories](/)
# Keycloak legacy cookies are not secured

## Affected product(s)

* Gradle Enterprise 2020.1 - 2021.4.2

## Severity

Low

## Published at

2022-03-15

## Related CVE ID(s)

* [CVE-2022-27225](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-27225)

## Description

Gradle Enterprise uses [Keycloak](https://www.keycloak.org/downloads.html) for identity management services.
During the sign-in process, Keycloak sets browser cookies that effectively provide remember-me functionality.

For backwards compatibility with older Safari browser versions, Keycloak sets a duplicate of the cookie without the `Secure` attribute,
which allows the cookie to be sent when accessing the location that cookie is set for via plain HTTP.
This creates the potential for an attacker with the ability to impersonate the Gradle Enterprise host to capture the login session of a user by
having them click a `http://` link to the server, regardless of the real server requiring HTTPS.

Since Gradle Enteprise 2021.4.3, the insecure cookies are no longer set.

## Mitigation

The most effective mitigation is to update to Gradle Enterprise 2021.4.3.

Alternatively, if you have Gradle Enterprise deployed behind a layer 7 network proxy,
you can filter any `Set-Cookie` response headers that set a cookie with a name ending in `_LEGACY`,
from any request path with the prefix `/keycloak`.

Â© Gradle Inc. 2025
![](/assets/img/a2cf0da4490c1245d3634f57f2e4d8b1.footer-logo.svg)
[Privacy](https://gradle.com/help/legal-privacy)
|
[Gradle Terms of Use](https://gradle.com/help/legal-terms-of-use)
|
[Status](https://status.gradle.com)


