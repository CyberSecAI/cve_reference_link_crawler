=== Content from discuss.hashicorp.com_8eb63242_20250111_181908.html ===


[HashiCorp Discuss](/)

# [HCSEC-2023-21 - Nomad Caller ACL Token's Secret ID is Exposed to Sentinel](/t/hcsec-2023-21-nomad-caller-acl-tokens-secret-id-is-exposed-to-sentinel/56271)

[Security](/c/security/52)

[security-nomad](https://discuss.hashicorp.com/tag/security-nomad)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

July 19, 2023, 11:16pm

1

**Bulletin ID:** HCSEC-2023-21

**Affected Products / Versions:** Nomad Enterprise 1.2.11 up to 1.5.6, and 1.4.10; fixed in 1.6.0, 1.5.7, and 1.4.11.

**Publication Date:** July 19, 2023

**Summary**

A vulnerability was identified in Nomad Enterprise such that the API caller’s ACL token secret ID is exposed to Sentinel policies. This vulnerability, CVE-2023-3299, affects Nomad Enterprise from 1.2.11 up to 1.5.6, and 1.4.10 and was fixed in 1.6.0, 1.5.7, and 1.4.11.

**Background**

Nomad Enterprise provides an expressive policy-as-code system called [Sentinel](https://developer.hashicorp.com/nomad/tutorials/governance-and-policy/sentinel) which can be used by administrators to enforce criteria for jobs submitted to a cluster. Authoring or enforcing these Sentinel policies in a cluster requires management-level (administrative) privileges.

**Details**

Internal testing by the Nomad engineering team identified that Sentinel policies could access a caller’s ACL token secret ID, which is not strictly required to enforce policies.

This may allow a poorly specified policy to access the token’s secret ID and risk leaking it to command and API output if printed. Exploitation requires a management token to submit a Sentinel policy to a Nomad cluster, with the policy explicitly reading the secret from the token as `nomad_acl_token.secret_id`.

More requirements and recommendations for a secure Nomad deployment can be found in the [security model](https://developer.hashicorp.com/nomad/docs/concepts/security).

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Nomad Enterprise 1.6.0, 1.5.7, and 1.4.11, or newer.

See Nomad’s [Upgrading](https://www.nomadproject.io/docs/upgrade) for general guidance on this process.

**Acknowledgement**

This issue was identified by the Nomad engineering team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2023-22 - Nomad Search API Leaks Information About CSI Plugins](https://discuss.hashicorp.com/t/hcsec-2023-22-nomad-search-api-leaks-information-about-csi-plugins/56272)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5700 | July 19, 2023 |
| [HCSEC-2023-20 - Nomad ACL Policies without Label are Applied to Unexpected Resources](https://discuss.hashicorp.com/t/hcsec-2023-20-nomad-acl-policies-without-label-are-applied-to-unexpected-resources/56270)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5793 | July 19, 2023 |
| [HCSEC-2021-21 - Nomad Raft RPC Privilege Escalation](https://discuss.hashicorp.com/t/hcsec-2021-21-nomad-raft-rpc-privilege-escalation/29023)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 6792 | September 1, 2021 |
| [[help] Issue with Nomad acl configuration in production environment](https://discuss.hashicorp.com/t/help-issue-with-nomad-acl-configuration-in-production-environment/18145)  [Nomad](/c/nomad/28) | 2 | 2016 | November 27, 2020 |
| [HCSEC-2023-13 - Nomad Unauthenticated Client Agent HTTP Request Privilege Escalation](https://discuss.hashicorp.com/t/hcsec-2023-13-nomad-unauthenticated-client-agent-http-request-privilege-escalation/52375)  [Security](/c/security/52) | 0 | 6042 | April 5, 2023 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


