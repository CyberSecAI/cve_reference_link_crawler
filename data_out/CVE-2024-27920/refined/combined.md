=== Content from docs.projectdiscovery.io_8e7532dc_20250110_165251.html ===
Code Protocol - ProjectDiscovery Documentation[ProjectDiscovery Documentation home page![light logo](https://mintlify.s3.us-west-1.amazonaws.com/projectdiscovery/logo/ProjectDiscovery-Logo-OnLight.svg)![dark logo](https://mintlify.s3.us-west-1.amazonaws.com/projectdiscovery/logo/ProjectDiscovery-Logo-OnDark.svg)](/)Search or ask...

* [Login](https://cloud.projectdiscovery.io/)
* [Blog](https://blog.projectdiscovery.io/)
* [Get Started](https://github.com/projectdiscovery/nuclei)
* [Get Started](https://github.com/projectdiscovery/nuclei)
Search...NavigationProtocolsCode Protocol[Documentation](/introduction)[Tools](/tools/index)[Templates](/templates/introduction)[Cloud Platform](/cloud/introduction)[API](/api-reference/introduction)[Help](/help/home)- [GitHub](https://github.com/projectdiscovery)
- [Website](https://projectdiscovery.io/)
- [Community](https://projectdiscovery.io/community)
##### Templates

* [Introduction](/templates/introduction)
* [Structure](/templates/structure)
* [FAQ](/templates/faq)
##### Protocols

* HTTP
* [Headless](/templates/protocols/headless)
* [Network](/templates/protocols/network)
* [DNS](/templates/protocols/dns)
* [File](/templates/protocols/file)
* JavaScript
* [Code](/templates/protocols/code)
* [Flow](/templates/protocols/flow)
* [Multi-protocol](/templates/protocols/multi-protocol)
##### Reference

* [Matchers](/templates/reference/matchers)
* [Extractors](/templates/reference/extractors)
* [Variables](/templates/reference/variables)
* [Helper Functions](/templates/reference/helper-functions)
* [Javascript Helper Functions](/templates/reference/js-helper-functions)
* [Preprocessors](/templates/reference/preprocessors)
* [Template Signing](/templates/reference/template-signing)
* [OOB Testing](/templates/reference/oob-testing)
##### Workflows

* [Template Workflows](/templates/workflows/overview)
* [Examples](/templates/workflows/examples)
Protocols
# Code Protocol

Learn about using external code with Nuclei

Nuclei enables the execution of external code on the host operating system. This feature allows security researchers, pentesters, and developers to extend the capabilities of Nuclei and perform complex actions beyond the scope of regular supported protocol-based testing.

By leveraging this capability, Nuclei can interact with the underlying operating system and execute custom scripts or commands, opening up a wide range of possibilities. It enables users to perform tasks such as system-level configurations, file operations, network interactions, and more. This level of control and flexibility empowers users to tailor their security testing workflows according to their specific requirements.

To write code template, a code block is used to indicate the start of the requests for the template. This block marks the beginning of the code-related instructions.

```
# Start the requests for the template right here
code:

```
## [​](#engine)Engine

To execute the code, a list of language interpreters, which are installed or available on the system environment, is specified. These interpreters can be and not limited to `bash` `sh` `py` `python3`, `go`, `ps`, among others, and they are searched sequentially until a suitable one is found. The identifiers for these interpreters should correspond to their respective names or identifiers recognized by the system environment.

```
- engine:
    - py
    - python3

```

The code to be executed can be provided either as an external file or as a code snippet directly within the template.

For an external file:

```
source: helpers/code/pyfile.py

```

For a code snippet:

```
source: |
      import sys
      print("hello from " + sys.stdin.read())

```

The target is passed to the template via stdin, and the output of the executed code is available for further processing in matchers and extractors. In the case of the Code protocol, the response part represents all data printed to stdout during the execution of the code.

## [​](#parts)Parts

Valid `part` values supported by **Code** protocol for Matchers / Extractor are -

| Value | Description |
| --- | --- |
| response | execution output (trailing whitespaces are filtered) |
| stderr | Raw Stderr Output(if any) |

The provided example demonstrates the execution of a bash and python code snippet within the template. The specified engines are searched in the given order, and the code snippet is executed accordingly. Additionally, dynamic template variables are used in the code snippet, which are replaced with their respective values during the execution of the template which shows the flexibility and customization that can be achieved using this protocol.

```
id: code-template

info:
  name: example code template
  author: pdteam
  severity: info

variables:
  OAST: "{{interactsh-url}}"

code:
  - engine:
      - sh
      - bash
    source: |
      echo "$OAST" | base64

  - engine:
      - py
      - python3
    source: |
      import base64
      import os

      text = os.getenv('OAST')
      text_bytes = text.encode('utf-8')
      base64_bytes = base64.b64encode(text_bytes)
      base64_text = base64_bytes.decode('utf-8')

      print(base64_text)

http:
  - method: GET
    path:
      - "{{BaseURL}}/?x={{code_1_response}}"
      - "{{BaseURL}}/?x={{code_2_response}}"

# digest: 4a0a0047304502202ce8fe9f5992782da6ba59da4e8ebfde9f19a12e247adc507040e9f1f1124b4e022100cf0bc7a44a557a6655f79a2b4789e103f5099f0f81a8d1bc4ad8aabe7829b1c5:8eeeebe39b11b16384b45bc7e9163000

```

Apart from required fields mentioned above, Code protocol also supports following optional fields to further customize the execution of code.

## [​](#args)Args

Args are arguments that are sent to engine while executing the code. For example if we want to bypass execution policy in powershell for specific template this can be done by adding following args to the template.

```
  - engine:
      - powershell
      - powershell.exe
    args:
      - -ExecutionPolicy
      - Bypass
      - -File

```
## [​](#pattern)Pattern

Pattern field can be used to customize name / extension of temporary file while executing a code snippet in a template

```
    pattern: "*.ps1"

```

adding `pattern: "*.ps1"` will make sure that name of temporary file given pattern.

## [​](#examples)Examples

This code example shows a basic response based on DSL.

```
id: code-template

info:
  name: example code template
  author: pdteam
  severity: info

self-contained: true
code:
  - engine:
      - py
      - python3
    source: |
      print("Hello World")

    extractors:
      - type: dsl
        dsl:
          - response
# digest: 4a0a0047304502204576db451ff35ea9a13c107b07a6d74f99fd9a78f5c2316cc3dece411e7d5a2b022100a36db96f2a56492147ca3e7de3c4d36b8e1361076a70924061790003958c4ef3:c40a3a04977cdbf9dca31c1002ea8279

```

Below is a example code template where we are executing a powershell script while customizing behaviour of execution policy and setting pattern to `*.ps1`

```
id: ps1-code-snippet

info:
  name: ps1-code-snippet
  author: pdteam
  severity: info
  description: |
    ps1-code-snippet
  tags: code

code:
  - engine:
      - powershell
      - powershell.exe
    args:
      - -ExecutionPolicy
      - Bypass
      - -File
    pattern: "*.ps1"
    source: |
      $stdin = [Console]::In
      $line = $stdin.ReadLine()
      Write-Host "hello from $line"

    matchers:
      - type: word
        words:
          - "hello from input"
# digest: 4a0a00473045022100eb01da6b97893e7868c584f330a0cd52df9bddac005860bb8595ba5b8aed58c9022050043feac68d69045cf320cba9298a2eb2e792ea4720d045d01e803de1943e7d:4a3eb6b4988d95847d4203be25ed1d46

```
## [​](#running-code-templates)Running Code Templates

By default Nuclei will not execute code templates. To enable code protocol execution, `-code` flag needs to be explicitly passed to nuclei.

```
nuclei -t code-template.yaml -code

```
## [​](#learn-more)Learn More

For more examples, please refer to example [code-templates](https://github.com/projectdiscovery/nuclei/tree/main/integration_tests/protocols/code) in integration tests.

It’s important to exercise caution while utilizing this feature, as executing external code on the host operating system carries inherent risks. It is crucial to ensure that the executed code is secure, thoroughly tested, and does not pose any unintended consequences or security risks to the target system.

To ensure the integrity of the code in your templates, be sure to sign your templates using the [Template Signing](/templates/reference/template-signing) methods.

Was this page helpful?

YesNo[Suggest edits](https://github.com/projectdiscovery/docs/edit/main/templates/protocols/code.mdx)[Vnc](/templates/protocols/javascript/modules/vnc)[Flow](/templates/protocols/flow)[github](https://github.com/projectdiscovery)[twitter](https://twitter.com/pdiscoveryio)[discord](https://discord.com/invite/projectdiscovery)[linkedin](https://www.linkedin.com/company/projectdiscovery)[youtube](https://www.youtube.com/%40projectdiscovery)[Powered by Mintlify](https://mintlify.com/preview-request?utm_campaign=poweredBy&utm_medium=docs&utm_source=docs.projectdiscovery.io)On this page

* [Engine](#engine)
* [Parts](#parts)
* [Args](#args)
* [Pattern](#pattern)
* [Examples](#examples)
* [Running Code Templates](#running-code-templates)
* [Learn More](#learn-more)


=== Content from docs.projectdiscovery.io_811fa5b4_20250110_165252.html ===
Template Workflows Overview - ProjectDiscovery Documentation[ProjectDiscovery Documentation home page![light logo](https://mintlify.s3.us-west-1.amazonaws.com/projectdiscovery/logo/ProjectDiscovery-Logo-OnLight.svg)![dark logo](https://mintlify.s3.us-west-1.amazonaws.com/projectdiscovery/logo/ProjectDiscovery-Logo-OnDark.svg)](/)Search or ask...

* [Login](https://cloud.projectdiscovery.io/)
* [Blog](https://blog.projectdiscovery.io/)
* [Get Started](https://github.com/projectdiscovery/nuclei)
* [Get Started](https://github.com/projectdiscovery/nuclei)
Search...NavigationWorkflowsTemplate Workflows Overview[Documentation](/introduction)[Tools](/tools/index)[Templates](/templates/introduction)[Cloud Platform](/cloud/introduction)[API](/api-reference/introduction)[Help](/help/home)- [GitHub](https://github.com/projectdiscovery)
- [Website](https://projectdiscovery.io/)
- [Community](https://projectdiscovery.io/community)
##### Templates

* [Introduction](/templates/introduction)
* [Structure](/templates/structure)
* [FAQ](/templates/faq)
##### Protocols

* HTTP
* [Headless](/templates/protocols/headless)
* [Network](/templates/protocols/network)
* [DNS](/templates/protocols/dns)
* [File](/templates/protocols/file)
* JavaScript
* [Code](/templates/protocols/code)
* [Flow](/templates/protocols/flow)
* [Multi-protocol](/templates/protocols/multi-protocol)
##### Reference

* [Matchers](/templates/reference/matchers)
* [Extractors](/templates/reference/extractors)
* [Variables](/templates/reference/variables)
* [Helper Functions](/templates/reference/helper-functions)
* [Javascript Helper Functions](/templates/reference/js-helper-functions)
* [Preprocessors](/templates/reference/preprocessors)
* [Template Signing](/templates/reference/template-signing)
* [OOB Testing](/templates/reference/oob-testing)
##### Workflows

* [Template Workflows](/templates/workflows/overview)
* [Examples](/templates/workflows/examples)
Workflows
# Template Workflows Overview

Learn about template workflows in Nuclei

Workflows enable users to orchestrate a series of actions by setting a defined execution order for various templates. These templates are activated upon predetermined conditions, establishing a streamlined method to leverage the capabilities of nuclei tailored to the user’s specific requirements. Consequently, you can craft workflows that are contingent on particular technologies or targets—such as those exclusive to WordPress or Jira—triggering these sequences only when the relevant technology is identified.

Within a workflow, all templates share a unified execution environment, which means that any named extractor from one template can be seamlessly accessed in another by simply referencing its designated name.

For those with prior knowledge of the technology stack in use, we advise constructing personalized workflows for your scans. This strategic approach not only substantially reduces the duration of scans but also enhances the quality and precision of the outcomes.

Workflows can be defined with `workflows` attribute, following the `template` / `subtemplates` and `tags` to execute.

```
workflows:
  - template: http/technologies/template-to-execute.yaml

```

**Type of workflows**

1. [Generic workflows](/_sites/docs.projectdiscovery.io/templates/workflows/overview#generic-workflows)
2. [Conditional workflows](/_sites/docs.projectdiscovery.io/templates/workflows/overview#conditional-workflows)

## [​](#generic-workflows)Generic Workflows

In generic workflow one can define single or multiple template to be executed from a single workflow file. It supports both files and directories as input.

A workflow that runs all config related templates on the list of give URLs.

```
workflows:
  - template: http/exposures/configs/git-config.yaml
  - template: http/exposures/configs/exposed-svn.yaml
  - template: http/vulnerabilities/generic/generic-env.yaml
  - template: http/exposures/backups/zip-backup-files.yaml
  - tags: xss,ssrf,cve,lfi

```

A workflow that runs specific list of checks defined for your project.

```
workflows:
  - template: http/cves/
  - template: http/exposures/
  - tags: exposures

```
## [​](#conditional-workflows)Conditional Workflows

You can also create conditional templates which execute after matching the condition from a previous template. This is mostly useful for vulnerability detection and exploitation as well as tech based detection and exploitation. Use-cases for this kind of workflows are vast and varied.

**Templates based condition check**

A workflow that executes subtemplates when base template gets matched.

```
workflows:
  - template: http/technologies/jira-detect.yaml
    subtemplates:
      - tags: jira
      - template: exploits/jira/

```

**Matcher Name based condition check**

A workflow that executes subtemplates when a matcher of base template is found in result.

```
workflows:
  - template: http/technologies/tech-detect.yaml
    matchers:
      - name: vbulletin
        subtemplates:
          - template: exploits/vbulletin-exp1.yaml
          - template: exploits/vbulletin-exp2.yaml
      - name: jboss
        subtemplates:
          - template: exploits/jboss-exp1.yaml
          - template: exploits/jboss-exp2.yaml

```

In similar manner, one can create as many and as nested checks for workflows as needed.

**Subtemplate and matcher name based multi level conditional check**

A workflow showcasing chain of template executions that run only if the previous templates get matched.

```
workflows:
  - template: http/technologies/tech-detect.yaml
    matchers:
      - name: lotus-domino
        subtemplates:
          - template: http/technologies/lotus-domino-version.yaml
            subtemplates:
              - template: http/cves/2020/xx-yy-zz.yaml
                subtemplates:
                  - template: http/cves/2020/xx-xx-xx.yaml

```

Conditional workflows are great examples of performing checks and vulnerability detection in most efficient manner instead of spraying all the templates on all the targets and generally come with good ROI on your time and is gentle for the targets as well.

## [​](#shared-execution-context)Shared Execution Context

Nuclei engine supports transparent workflow cookiejar and key-value sharing across templates parts of a same workflow. Here follow an example of a workflow that extract a value from the first template and use it in the second conditional one:

```
id: key-value-sharing-example
info:
  name: Key Value Sharing Example
  author: pdteam
  severity: info

workflows:
  - template: template-with-named-extractor.yaml
    subtemplates:
      - template: template-using-named-extractor.yaml

```

For example, the following templates extract `href` links from a target web page body and make the value available under the `extracted` key:

```
# template-with-named-extractor.yaml

id: value-sharing-template1

info:
  name: value-sharing-template1
  author: pdteam
  severity: info

http:
  - path:
      - "{{BaseURL}}/path1"
    extractors:
      - type: regex
        part: body
        name: extracted
        regex:
          - 'href="(.*)"'
        group: 1

```

Finally the second template in the workflow will use the obtained value by referencing the extractor name (`extracted`):

```
# template-using-named-extractor.yaml

id: value-sharing-template2

info:
  name: value-sharing-template2
  author: pdteam
  severity: info

http:
  - raw:
      - |
        GET /path2 HTTP/1.1
        Host: {{Hostname}}

        {{extracted}}

```

Was this page helpful?

YesNo[Suggest edits](https://github.com/projectdiscovery/docs/edit/main/templates/workflows/overview.mdx)[OOB Testing](/templates/reference/oob-testing)[Examples](/templates/workflows/examples)[github](https://github.com/projectdiscovery)[twitter](https://twitter.com/pdiscoveryio)[discord](https://discord.com/invite/projectdiscovery)[linkedin](https://www.linkedin.com/company/projectdiscovery)[youtube](https://www.youtube.com/%40projectdiscovery)[Powered by Mintlify](https://mintlify.com/preview-request?utm_campaign=poweredBy&utm_medium=docs&utm_source=docs.projectdiscovery.io)On this page

* [Generic Workflows](#generic-workflows)
* [Conditional Workflows](#conditional-workflows)
* [Shared Execution Context](#shared-execution-context)


=== Content from github.com_95a79b00_20250110_165253.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fprojectdiscovery%2Fnuclei%2Fpull%2F4822)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fprojectdiscovery%2Fnuclei%2Fpull%2F4822)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=projectdiscovery%2Fnuclei)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[projectdiscovery](/projectdiscovery)
/
**[nuclei](/projectdiscovery/nuclei)**
Public

* [Notifications](/login?return_to=%2Fprojectdiscovery%2Fnuclei) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2Fprojectdiscovery%2Fnuclei)
* [Star
   21.7k](/login?return_to=%2Fprojectdiscovery%2Fnuclei)

* [Code](/projectdiscovery/nuclei)
* [Issues
  345](/projectdiscovery/nuclei/issues)
* [Pull requests
  31](/projectdiscovery/nuclei/pulls)
* [Discussions](/projectdiscovery/nuclei/discussions)
* [Actions](/projectdiscovery/nuclei/actions)
* [Projects
  0](/projectdiscovery/nuclei/projects)
* [Security](/projectdiscovery/nuclei/security)
* [Insights](/projectdiscovery/nuclei/pulse)

Additional navigation options

* [Code](/projectdiscovery/nuclei)
* [Issues](/projectdiscovery/nuclei/issues)
* [Pull requests](/projectdiscovery/nuclei/pulls)
* [Discussions](/projectdiscovery/nuclei/discussions)
* [Actions](/projectdiscovery/nuclei/actions)
* [Projects](/projectdiscovery/nuclei/projects)
* [Security](/projectdiscovery/nuclei/security)
* [Insights](/projectdiscovery/nuclei/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fprojectdiscovery%2Fnuclei%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fprojectdiscovery%2Fnuclei%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# validate code template in workflows #4822

 Merged

[ehsandeep](/ehsandeep)
merged 2 commits into
[dev](/projectdiscovery/nuclei/tree/dev "projectdiscovery/nuclei:dev")
from
[issue-4796-workflow-unsigned](/projectdiscovery/nuclei/tree/issue-4796-workflow-unsigned "projectdiscovery/nuclei:issue-4796-workflow-unsigned")

Mar 1, 2024

 Merged

# [validate code template in workflows](#top) #4822

[ehsandeep](/ehsandeep)
merged 2 commits into
[dev](/projectdiscovery/nuclei/tree/dev "projectdiscovery/nuclei:dev")
from
[issue-4796-workflow-unsigned](/projectdiscovery/nuclei/tree/issue-4796-workflow-unsigned "projectdiscovery/nuclei:issue-4796-workflow-unsigned")

Mar 1, 2024

[Conversation
1](/projectdiscovery/nuclei/pull/4822)
[Commits
2](/projectdiscovery/nuclei/pull/4822/commits)
[Checks
12](/projectdiscovery/nuclei/pull/4822/checks)
[Files changed](/projectdiscovery/nuclei/pull/4822/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![tarunKoyalwar](https://avatars.githubusercontent.com/u/45962551?s=60&v=4)](/tarunKoyalwar)

Copy link

Member

### @tarunKoyalwar **[tarunKoyalwar](/tarunKoyalwar)** commented [Mar 1, 2024](#issue-2163505014) • edited Loading

### Proposed Changes

* validate code protocol templates in workflow according to existing rules
* closes [Code in template is executed without a signature if the template is in a Workflow #4796](https://github.com/projectdiscovery/nuclei/issues/4796)

```
$  ./nuclei -w workflow.yaml -debug -v -u https://scanme.sh

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.2.0-dev

		projectdiscovery.io

[WRN] `-code` flag not found, skipping code template from workflow: /Users/tarun/Codebase2/nuclei/test.yaml
[INF] Current nuclei version: v3.2.0-dev (development)
[INF] Current nuclei-templates version: v9.7.6 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] Workflows loaded for current scan: 1
[WRN] Executing 1 unsigned templates. Use with caution.
[INF] Targets loaded for current scan: 1
[INF] No results found. Better luck next time!
```

```
$  ./nuclei -w workflow.yaml -debug -v -u https://scanme.sh  -code

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.2.0-dev

		projectdiscovery.io

[WRN] skipping unverified code template from workflow: /Users/tarun/Codebase2/nuclei/test.yaml
[INF] Current nuclei version: v3.2.0-dev (development)
[INF] Current nuclei-templates version: v9.7.6 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] Workflows loaded for current scan: 1
[WRN] Executing 1 unsigned templates. Use with caution.
[INF] Targets loaded for current scan: 1
[INF] No results found. Better luck next time!
```

Sorry, something went wrong.

All reactions

[![@tarunKoyalwar](https://avatars.githubusercontent.com/u/45962551?s=40&v=4)](/tarunKoyalwar)

`[validate code template in workflows](/projectdiscovery/nuclei/pull/4822/commits/80b22ae16b2e212aeb31d3b9b8169b25e76407b2 "validate code template in workflows")`

`[80b22ae](/projectdiscovery/nuclei/pull/4822/commits/80b22ae16b2e212aeb31d3b9b8169b25e76407b2)`

[![@tarunKoyalwar](https://avatars.githubusercontent.com/u/45962551?s=40&u=18bfec9c41c3e2b883a40a60843c987e8db3c90f&v=4)](/tarunKoyalwar)
[tarunKoyalwar](/tarunKoyalwar)
self-assigned this
[Mar 1, 2024](#event-11980081808)

 [![@tarunKoyalwar](https://avatars.githubusercontent.com/u/45962551?s=40&u=18bfec9c41c3e2b883a40a60843c987e8db3c90f&v=4)](/tarunKoyalwar)
[tarunKoyalwar](/tarunKoyalwar)
marked this pull request as ready for review
[March 1, 2024 14:16](#event-11980102666)

 [![@tarunKoyalwar](https://avatars.githubusercontent.com/u/45962551?s=40&u=18bfec9c41c3e2b883a40a60843c987e8db3c90f&v=4)](/tarunKoyalwar)
[tarunKoyalwar](/tarunKoyalwar)
requested a review
from [ehsandeep](/ehsandeep)
[March 1, 2024 14:16](#event-11980104044)

 [![@tarunKoyalwar](https://avatars.githubusercontent.com/u/45962551?s=40&u=18bfec9c41c3e2b883a40a60843c987e8db3c90f&v=4)](/tarunKoyalwar)
[tarunKoyalwar](/tarunKoyalwar)
marked this pull request as draft
[March 1, 2024 14:16](#event-11980113650)

[![@tarunKoyalwar](https://avatars.githubusercontent.com/u/45962551?s=40&v=4)](/tarunKoyalwar)

`[fix missing executer](/projectdiscovery/nuclei/pull/4822/commits/3f7e7889b5e3e5b8bac778fe6c9343f4e5f68eac "fix missing executer")`

`[3f7e788](/projectdiscovery/nuclei/pull/4822/commits/3f7e7889b5e3e5b8bac778fe6c9343f4e5f68eac)`

[![@tarunKoyalwar](https://avatars.githubusercontent.com/u/45962551?s=80&u=18bfec9c41c3e2b883a40a60843c987e8db3c90f&v=4)](/tarunKoyalwar)

Copy link

Member

Author

### **[tarunKoyalwar](/tarunKoyalwar)** commented [Mar 1, 2024](#issuecomment-1973304318)

| ``` $  ./nuclei -w workflow.yaml  -u https://scanme.sh  -code                        __     _    ____  __  _______/ /__  (_)   / __ \/ / / / ___/ / _ \/ /  / / / / /_/ / /__/ /  __/ / /_/ /_/\__,_/\___/_/\___/_/   v3.2.0-dev  		projectdiscovery.io  [INF] Current nuclei version: v3.2.0-dev (development) [INF] Current nuclei-templates version: v9.7.6 (latest) [WRN] Scan results upload to cloud is disabled. [INF] Workflows loaded for current scan: 1 [INF] Executing 1 signed templates from tarun [INF] Targets loaded for current scan: 1 [code-template] [code] [info] https://scanme.sh ["hack with nuclei"] ``` |
| --- |

All reactions

Sorry, something went wrong.

 [![@tarunKoyalwar](https://avatars.githubusercontent.com/u/45962551?s=40&u=18bfec9c41c3e2b883a40a60843c987e8db3c90f&v=4)](/tarunKoyalwar)
[tarunKoyalwar](/tarunKoyalwar)
marked this pull request as ready for review
[March 1, 2024 14:30](#event-11980265055)

[![ehsandeep](https://avatars.githubusercontent.com/u/8293321?s=60&v=4)](/ehsandeep)

**[ehsandeep](/ehsandeep)**
approved these changes
[Mar 1, 2024](#pullrequestreview-1911482837)

 [View reviewed changes](/projectdiscovery/nuclei/pull/4822/files/3f7e7889b5e3e5b8bac778fe6c9343f4e5f68eac)

 Hide details
View details

[![@ehsandeep](https://avatars.githubusercontent.com/u/8293321?s=40&u=ae3abc7734bd873f76ae355b60423e16d6006a6e&v=4)](/ehsandeep)
[ehsandeep](/ehsandeep)
merged commit [`e86f382`](/projectdiscovery/nuclei/commit/e86f38299765b82ad724fdb701557e0eaff3884d)
into
dev

[Mar 1, 2024](https://github.com/projectdiscovery/nuclei/pull/4822#event-11981231815)
9 of 12 checks passed

 [![@ehsandeep](https://avatars.githubusercontent.com/u/8293321?s=40&u=ae3abc7734bd873f76ae355b60423e16d6006a6e&v=4)](/ehsandeep)
[ehsandeep](/ehsandeep)
deleted the
issue-4796-workflow-unsigned

branch
[March 1, 2024 16:00](#event-11981232011)

[![@BrewTestBot](https://avatars.githubusercontent.com/u/1589480?s=40&v=4)](/BrewTestBot)
[BrewTestBot](/BrewTestBot)
mentioned this pull request
[Mar 14, 2024](#ref-pullrequest-2185174224)

[nuclei 3.2.0
Homebrew/homebrew-core#166046](/Homebrew/homebrew-core/pull/166046)
 Merged

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[Apr 3, 2024](#ref-issue-2222631956)

[x/vulndb: potential Go vuln in github.com/projectdiscovery/nuclei: CVE-2024-27920
golang/vulndb#2677](/golang/vulndb/issues/2677)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fprojectdiscovery%2Fnuclei%2Fpull%2F4822)

Reviewers

[![@ehsandeep](https://avatars.githubusercontent.com/u/8293321?s=40&v=4)](/ehsandeep) [ehsandeep](/ehsandeep)

ehsandeep approved these changes

Assignees

[![@tarunKoyalwar](https://avatars.githubusercontent.com/u/45962551?s=40&v=4)](/tarunKoyalwar) [tarunKoyalwar](/tarunKoyalwar)

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [Code in template is executed without a signature if the template is in a Workflow](https://github.com/projectdiscovery/nuclei/issues/4796)

2 participants

[![@tarunKoyalwar](https://avatars.githubusercontent.com/u/45962551?s=52&v=4)](/tarunKoyalwar) [![@ehsandeep](https://avatars.githubusercontent.com/u/8293321?s=52&v=4)](/ehsandeep)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from docs.projectdiscovery.io_bbf2957d_20250110_165252.html ===
Template Signing - ProjectDiscovery Documentation[ProjectDiscovery Documentation home page![light logo](https://mintlify.s3.us-west-1.amazonaws.com/projectdiscovery/logo/ProjectDiscovery-Logo-OnLight.svg)![dark logo](https://mintlify.s3.us-west-1.amazonaws.com/projectdiscovery/logo/ProjectDiscovery-Logo-OnDark.svg)](/)Search or ask...

* [Login](https://cloud.projectdiscovery.io/)
* [Blog](https://blog.projectdiscovery.io/)
* [Get Started](https://github.com/projectdiscovery/nuclei)
* [Get Started](https://github.com/projectdiscovery/nuclei)
Search...NavigationReferenceTemplate Signing[Documentation](/introduction)[Tools](/tools/index)[Templates](/templates/introduction)[Cloud Platform](/cloud/introduction)[API](/api-reference/introduction)[Help](/help/home)- [GitHub](https://github.com/projectdiscovery)
- [Website](https://projectdiscovery.io/)
- [Community](https://projectdiscovery.io/community)
##### Templates

* [Introduction](/templates/introduction)
* [Structure](/templates/structure)
* [FAQ](/templates/faq)
##### Protocols

* HTTP
* [Headless](/templates/protocols/headless)
* [Network](/templates/protocols/network)
* [DNS](/templates/protocols/dns)
* [File](/templates/protocols/file)
* JavaScript
* [Code](/templates/protocols/code)
* [Flow](/templates/protocols/flow)
* [Multi-protocol](/templates/protocols/multi-protocol)
##### Reference

* [Matchers](/templates/reference/matchers)
* [Extractors](/templates/reference/extractors)
* [Variables](/templates/reference/variables)
* [Helper Functions](/templates/reference/helper-functions)
* [Javascript Helper Functions](/templates/reference/js-helper-functions)
* [Preprocessors](/templates/reference/preprocessors)
* [Template Signing](/templates/reference/template-signing)
* [OOB Testing](/templates/reference/oob-testing)
##### Workflows

* [Template Workflows](/templates/workflows/overview)
* [Examples](/templates/workflows/examples)
Reference
# Template Signing

Review details on template signing for Nuclei

Template signing via the private-public key mechanism is a crucial aspect of ensuring the integrity, authenticity, and security of templates. This mechanism involves the use of asymmetric cryptography, specifically the Elliptic Curve Digital Signature Algorithm (ECDSA), to create a secure and verifiable signature.

In this process, a template author generates a private key that remains confidential and securely stored. The corresponding public key is then shared with the template consumers. When a template is created or modified, the author signs it using their private key, generating a unique signature that is attached to the template.

Template consumers can verify the authenticity and integrity of a signed template by using the author’s public key. By applying the appropriate cryptographic algorithm (ECDSA), they can validate the signature and ensure that the template has not been tampered with since it was signed. This provides a level of trust, as any modifications or unauthorized changes to the template would result in a failed verification process.

By employing the private-public key mechanism, template signing adds an additional layer of security and trust to the template ecosystem. It helps establish the identity of the template author and ensures that the templates used in various systems are genuine and have not been altered maliciously.

**What does signing a template mean?**

Template signing is a mechanism to ensure the integrity and authenticity of templates. The primary goal is to provide template writers and consumers a way to trust crowdsourced or custom templates ensuring that they are not tampered with.

All [official Nuclei templates](https://github.com/projectdiscovery/nuclei-templates) include a digital signature and are verified by Nuclei while loading templates using ProjectDiscovery’s public key (shipped with the Nuclei binary).

Individuals or organizations running Nuclei in their work environment can generate their own key-pair with `nuclei` and sign their custom templates with their private key, thus ensuring that only authorized templates are being used in their environment.

This also allows entities to fully utilize the power of new protocols like `code` without worrying about malicious custom templates being used in their environment.

**NOTE:**

* **Template signing is optional for all protocols except `code`**.
* **Unsigned code templates are disabled and can not be executed using Nuclei**.
* **Only signed code templates by the author (yourself) or ProjectDiscovery can be executed.**
* **Template signing is primarily introduced to ensure security of template to run code on host machine.**
* Code file references (for example: `source: protocols/code/pyfile.py`) are allowed and content of these files is included in the template digest.
* Payload file references (for example: `payloads: protocols/http/params.txt`) are not included in the template digest as it is treated as a payload/helper and not actual code that is being executed.
* Template signing is deterministic while both signing and verifying a template i.e. if a code file is referenced in a template that is present outside of templates directory with `-lfa` flag then verification will fail if same template is used without `-lfa` flag. (Note this only applies to `-lfa` i.e. local file access flag only)

### [​](#signing-custom-template)Signing Custom Template

The simplest and recommended way to generate key-pair and signing/verfifying templates is to use `nuclei` itself.

When signing a template if key-pair does not exist then Nuclei will prompt user to generate a new key-pair with options.

```
$ ./nuclei -t templates.yaml -sign
[INF] Generating new key-pair for signing templates
[*] Enter User/Organization Name (exit to abort) : acme
[*] Enter passphrase (exit to abort):
[*] Enter same passphrase again:
[INF] Successfully generated new key-pair for signing templates

```
> **Note:** Passphrase is optional and can be left blank when used private key is encrypted with passphrase using PEMCipherAES256 Algo

Once a key-pair is generated, you can sign any custom template using `-sign` flag as shown below.

```
$ ./nuclei -t templates.yaml -sign
[INF] All templates signatures were elaborated success=1 failed=0

```
> **Note:** Every time you make any change in your code template, you need to re-sign it to run with Nuclei.

### [​](#template-digest-and-signing-keys)Template Digest and Signing Keys

When a template is signed, a digest is generated and added to the template. This digest is a hash of the template content and is used to verify the integrity of the template. If the template is modified after signing, the digest will change, and the signature verification will fail during template loading.

```
# digest: 4a0a00473045022100eb01da6b97893e7868c584f330a0cd52df9bddac005860bb8595ba5b8aed58c9022050043feac68d69045cf320cba9298a2eb2e792ea4720d045d01e803de1943e7d:4a3eb6b4988d95847d4203be25ed1d46

```

The digest is in the format of `signature:fragment`, where the signature is the digital signature of the template used to verify its integrity, and the fragment is metadata generated by MD5 hashing the public key to disable re-signing of code templates not written by you.

The key-pair generated by Nuclei is stored in two files in the `$CONFIG/nuclei/keys directory`, where `$CONFIG` is the system-specific config directory. The private key is stored in nuclei-user-private-key.pem, which is encrypted with a passphrase if provided. The public key is stored in nuclei-user.crt, which includes the public key and identifier (e.g., user/org name) in a self-signed certificate.

```
$ la ~/.config/nuclei/keys
total 16
-rw-------  1 tarun  staff   251B Oct  4 21:45 nuclei-user-private-key.pem # encrypted private key with passphrase
-rw-------  1 tarun  staff   572B Oct  4 21:45 nuclei-user.crt # self signed certificate which includes public key and identifier (i.e user/org name)

```

To use the public key for verification, you can either copy it to the `$CONFIG/nuclei/keys` directory on another user’s machine, or set the `NUCLEI_USER_CERTIFICATE` environment variable to the path or content of the public key.

To use the private key, you can copy it to the `$CONFIG/nuclei/keys` directory on another user’s machine, or set the `NUCLEI_USER_PRIVATE_KEY` environment variable to the path or content of the private key.

```
$ export NUCLEI_USER_CERTIFICATE=$(cat path/to/nuclei-user.crt)
$ export NUCLEI_USER_PRIVATE_KEY=$(cat path/to/nuclei-user-private-key.pem)

```

It’s important to note that you are responsible for securing and managing the private key, and Nuclei has no accountability for any loss of the private key.

By default, Nuclei loads the user certificate (public key) from the default locations mentioned above and uses it to verify templates. When running Nuclei, it will execute signed templates and warn about executing unsigned custom templates and block unsigned code templates. You can disable this warning by setting the `HIDE_TEMPLATE_SIG_WARNING` environment variable to `true`.

## [​](#faq)FAQ

**Found X unsigned or tampered code template?**

```
./nuclei -u scanme.sh -t simple-code.yaml

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.0.0-dev

		projectdiscovery.io

[WRN] Found 1 unsigned or tampered code template (carefully examine before using it & use -sign flag to sign them)
[INF] Current nuclei version: v3.0.0-dev (development)
[INF] Current nuclei-templates version: v9.6.4 (latest)
[WRN] Executing 1 unsigned templates. Use with caution.
[INF] Targets loaded for current scan: 1
[INF] No results found. Better luck next time!
[FTL] Could not run nuclei: no templates provided for scan

```

Here `simple-code.yaml` is a code protocol template which is not signed or content of template has been modified after signing which indicates loss of integrity of template.
If you are template writer then you can go ahead and sign the template using `-sign` flag and if you are template consumer then you should carefully examine the template before signing it.

**Re-signing code templates are not allowed for security reasons?**

```
nuclei -u scanme.sh -t simple-code.yaml -sign

[ERR] could not sign 'simple-code.yaml': [signer:RUNTIME] re-signing code templates are not allowed for security reasons.
[INF] All templates signatures were elaborated success=0 failed=1

```

The error message `re-signing code templates are not allowed for security reasons` comes from the Nuclei engine. This error indicates that a code template initially signed by another user and someone is trying to re-sign it.

This measure was implemented to prevent running untrusted templates unknowingly, which might lead to potential security issues.
When you encounter this error, it suggests that you’re dealing with a template that has been signed by another user Likely, the original signer is not you or the team from projectdiscovery.

By default, Nuclei disallows executing code templates that are signed by anyone other than you or from the public templates provided by projectdiscovery/nuclei-templates.

This is done to prevent potential security abuse using code templates.

To resolve this error:

1. Open and thoroughly examine the code template for any modifications.
2. Manually remove the existing digest signature from the template.
3. Sign the template again.

This way, you can ensure that only templates verified and trusted by you (or projectdiscovery) are run, thus maintaining a secure environment.

Was this page helpful?

YesNo[Suggest edits](https://github.com/projectdiscovery/docs/edit/main/templates/reference/template-signing.mdx)[Preprocessors](/templates/reference/preprocessors)[OOB Testing](/templates/reference/oob-testing)[github](https://github.com/projectdiscovery)[twitter](https://twitter.com/pdiscoveryio)[discord](https://discord.com/invite/projectdiscovery)[linkedin](https://www.linkedin.com/company/projectdiscovery)[youtube](https://www.youtube.com/%40projectdiscovery)[Powered by Mintlify](https://mintlify.com/preview-request?utm_campaign=poweredBy&utm_medium=docs&utm_source=docs.projectdiscovery.io)On this page

* [Signing Custom Template](#signing-custom-template)
* [Template Digest and Signing Keys](#template-digest-and-signing-keys)
* [FAQ](#faq)


=== Content from github.com_19092bff_20250110_165253.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fprojectdiscovery%2Fnuclei%2Fsecurity%2Fadvisories%2FGHSA-w5wx-6g2r-r78q)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fprojectdiscovery%2Fnuclei%2Fsecurity%2Fadvisories%2FGHSA-w5wx-6g2r-r78q)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=projectdiscovery%2Fnuclei)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[projectdiscovery](/projectdiscovery)
/
**[nuclei](/projectdiscovery/nuclei)**
Public

* [Notifications](/login?return_to=%2Fprojectdiscovery%2Fnuclei) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2Fprojectdiscovery%2Fnuclei)
* [Star
   21.7k](/login?return_to=%2Fprojectdiscovery%2Fnuclei)

* [Code](/projectdiscovery/nuclei)
* [Issues
  345](/projectdiscovery/nuclei/issues)
* [Pull requests
  31](/projectdiscovery/nuclei/pulls)
* [Discussions](/projectdiscovery/nuclei/discussions)
* [Actions](/projectdiscovery/nuclei/actions)
* [Projects
  0](/projectdiscovery/nuclei/projects)
* [Security](/projectdiscovery/nuclei/security)
* [Insights](/projectdiscovery/nuclei/pulse)

Additional navigation options

* [Code](/projectdiscovery/nuclei)
* [Issues](/projectdiscovery/nuclei/issues)
* [Pull requests](/projectdiscovery/nuclei/pulls)
* [Discussions](/projectdiscovery/nuclei/discussions)
* [Actions](/projectdiscovery/nuclei/actions)
* [Projects](/projectdiscovery/nuclei/projects)
* [Security](/projectdiscovery/nuclei/security)
* [Insights](/projectdiscovery/nuclei/pulse)

# Unsigned code template execution through workflows in projectdiscovery/nuclei

High

[ehsandeep](/ehsandeep)
published
GHSA-w5wx-6g2r-r78q
Mar 15, 2024

## Package

gomod

github.com/projectdiscovery/nuclei
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

> 3.0.0

## Patched versions

3.2.0

## Description

### Overview

A significant security oversight was identified in Nuclei v3, involving the execution of unsigned code templates through workflows. This vulnerability specifically affects users utilizing custom workflows, potentially allowing the execution of malicious code on the user's system. This advisory outlines the impacted users, provides details on the security patch, and suggests mitigation strategies.

### Affected Users

1. **CLI Users:** Those executing custom workflows from untrusted sources. This includes workflows authored by third parties or obtained from unverified repositories.
2. **SDK Users:** Developers integrating Nuclei into their platforms, particularly if they permit the execution of custom workflows by end-users.

### Security Patch

The vulnerability is addressed in Nuclei v3.2.0. Users are strongly recommended to update to this version to mitigate the security risk.

### Mitigation

* **Immediate Upgrade:** The primary recommendation is to upgrade to Nuclei v3.2.0, where the vulnerability has been patched.
* **Avoid Untrusted Workflows:** As an interim measure, users should refrain from using custom workflows if unable to upgrade immediately. Only trusted, verified workflows should be executed.

### Details

The vulnerability stems from an oversight in the workflow execution mechanism, where unsigned code templates could be executed, bypassing the security measures intended to authenticate the integrity and source of the templates. This issue is isolated to workflow executions and does not affect direct template executions.

### Workarounds

The only effective workaround, aside from upgrading, is to avoid the use of custom workflows altogether. This approach limits functionality but ensures security until the upgrade can be performed.

### Acknowledgements

We extend our sincere gratitude to [@gpc1996](https://github.com/gpc1996) for their diligence in identifying and reporting this vulnerability.

### References

* Security Patch Pull Request: [GitHub PR #4822](https://github.com/projectdiscovery/nuclei/pull/4822)
* Workflows Overview: [Nuclei Workflows Documentation](https://docs.projectdiscovery.io/templates/workflows/overview)
* Code Template Reference: [Nuclei Code Protocols Documentation](https://docs.projectdiscovery.io/templates/protocols/code)
* Template Signing Reference: [Nuclei Template Signing Documentation](https://docs.projectdiscovery.io/templates/reference/template-signing)

### Severity

High

7.4

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
High

Privileges required
None

User interaction
Required

Scope
Changed

Confidentiality
High

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N

### CVE ID

CVE-2024-27920

### Weaknesses

[CWE-78](/advisories?query=cwe%3A78)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


