

[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Commit information visible through release atom endpoint for guest users

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2573397](https://hackerone.com/reports/2573397)** by `ashish_r_padelkar` on 2024-06-24, assigned to [@kmorrison1](/kmorrison1 "Kevin Morrison"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Hello,

As per this documentation, `https://docs.gitlab.com/ee/user/permissions.html`, **Guest users can access GitLab Releases for downloading assets but are not allowed to download the source code nor see repository information like commits and release evidence.**

[![Screenshot_2024-06-25_at_12.42.26_AM.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/b5abcff97762c266f67761ffc621f797e019e681/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f31643764363338312d376530322d343835372d626638372d3938376565396565623038352f53637265656e73686f745f323032342d30362d32355f61745f31322e34322e32365f414d2e706e67)

However, through release atom endpoint, guest user can see the commit of the release.

##### Steps to reproduce

1.Create a group.

2.Create private project underneath.

3.Now create a release within the project.

4.The release will show information like below including commit information.

[![Screenshot_2024-06-25_at_12.45.30_AM_Large.jpeg](data:image/gif;base64...)](https://user-content.gitlab-static.net/58f6eca7377ecb99a77df621bf4a67cfcdd22efb/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65326530623436662d343239622d343161312d613434342d3335626537346465623431312f53637265656e73686f745f323032342d30362d32355f61745f31322e34352e33305f414d5f4c617267652e6a706567)

5.Now add a guest user at group level `https://gitlab.com/groups/<groupName>/-/group_members`.

6.Login as guest user and navigate to releases at `https://gitlab.com/<groupName>/<ProjectName>/-/releases`.

7.You see the release but you dont see repository information like commits and release evidence as expected and working as intended as per documentation.

[![Screenshot_2024-06-25_at_12.54.19_AM.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/d6df77fb1e90622fcece3ab8f3efbae079b24d8a/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64316334343538302d646363312d346562332d623961342d6437396236323762393630612f53637265656e73686f745f323032342d30362d32355f61745f31322e35342e31395f414d2e706e67)

8.Now click on RSS feed button and it will open an URL like `https://gitlab.com/<groupName>/<ProjectName>/-/releases.atom?feed_token=glft-<>Token-3148078`.

[![Screenshot_2024-06-25_at_12.54.50_AM.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/09458e74fe6537933295973472b211ddac393ace/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f35633164616630372d656334352d343230642d393362632d3365373438313436356264362f53637265656e73686f745f323032342d30362d32355f61745f31322e35342e35305f414d2e706e67)

9.In response, look for `<summary>` tag which contains the commit information which they shouldn't see as per documentation.

##### What is the current *bug* behavior?

Guest users are able to view commit information which they shouldnt.

##### What is the expected *correct* behavior?

Commit information should be redacted from release atom endpoint for guest users.

##### Output of checks

This bug happens on GitLab.com `GitLab Enterprise Edition 17.2.0-pre 59d98c8baff`

Regards,

Ashish

#### Impact

Commit information visible through release atom endpoint for guest users

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_2024-06-25\_at\_12.42.26\_AM.png](https://h1.sec.gitlab.net/a/1d7d6381-7e02-4857-bf87-987ee9eeb085/Screenshot_2024-06-25_at_12.42.26_AM.png)
* [Screenshot\_2024-06-25\_at\_12.45.30\_AM\_Large.jpeg](https://h1.sec.gitlab.net/a/e2e0b46f-429b-41a1-a444-35be74deb411/Screenshot_2024-06-25_at_12.45.30_AM_Large.jpeg)
* [Screenshot\_2024-06-25\_at\_12.54.19\_AM.png](https://h1.sec.gitlab.net/a/d1c44580-dcc1-4eb3-b9a4-d79b627b960a/Screenshot_2024-06-25_at_12.54.19_AM.png)
* [Screenshot\_2024-06-25\_at\_12.54.50\_AM.png](https://h1.sec.gitlab.net/a/5c1daf07-ec45-420d-93bc-3e7481465bd6/Screenshot_2024-06-25_at_12.54.50_AM.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

## Implementation guide

For the `commit.message` information, first check if the current user can read code for the current repository with `can?(current_user, :readf_code, project)`.

This is a possible fix:

```
diff --git a/app/views/projects/releases/_release.atom.builder b/app/views/projects/releases/_release.atom.builder
index e0295a0f38fc..d815163d659a 100644
--- a/app/views/projects/releases/_release.atom.builder
+++ b/app/views/projects/releases/_release.atom.builder
@@ -9,7 +9,7 @@ xml.entry do
   xml.id        release_url
   xml.link      href: release_url
   xml.title     truncate(release.name, length: 160)
-  xml.summary   strip_signature(release.commit.message)
+  xml.summary   strip_signature(release.commit.message) unless !can?(current_user, :read_code, @project)
   xml.content   markdown_field(release, :description), type: 'html'
   xml.updated   release.updated_at.xmlschema
   xml.published release.released_at.xmlschema
```

Edited Jul 09, 2024 by [Anna Vovchenko](/anna_vovchenko)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.

