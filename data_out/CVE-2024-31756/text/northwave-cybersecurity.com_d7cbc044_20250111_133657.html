

[Skip to content](#main-content)

arrow-alt-circle-up icon

#### Cyber Incident?

arrow-alt-circle-up icon

#### Call 00800 1744 0000

arrow-alt-circle-up icon

####

[![](https://northwave-cybersecurity.com/hs-fs/hubfs/NW%20Logo%20Horizontal%20rgb.png?width=2598&height=768&name=NW%20Logo%20Horizontal%20rgb.png)](//northwave-cybersecurity.com/?hsLang=en)

* [Services](https://northwave-cybersecurity.com/cyber-security-services)

  + [Incident Response](https://northwave-cybersecurity.com/cert-cyber-incident-response)
  + [NIS2](https://northwave-cybersecurity.com/navigate-your-nis2-journey)
  + [Intelligent Security Operations](https://northwave-cybersecurity.com/managed-cyber-security-intelligent-security-operations)
  + Business

    - [Managed Security & Privacy office](https://northwave-cybersecurity.com/managed-security-privacy-office)
    - [State of Security Assessment](https://northwave-cybersecurity.com/state-of-security-assessment)
    - [Data Protection Impact Assessment](https://northwave-cybersecurity.com/data-protection-impact-assessment)
    - [Security Roadmap](https://northwave-cybersecurity.com/cyber-security-roadmap)
    - [Audit & Control](https://northwave-cybersecurity.com/audits-control-service)
    - [ISO 27001 FastTrack](https://northwave-cybersecurity.com/iso-27001-fasttrack)
  + Bytes

    - [Managed Detection & Response](https://northwave-cybersecurity.com/managed-detection-response-service)
    - [SOC CMM](https://northwave-cybersecurity.com/soc-capability-and-maturity-assessment)
    - [Rapid Response](https://northwave-cybersecurity.com/cyber-rapid-response-service)
    - [Red Teaming](https://northwave-cybersecurity.com/red-teaming)
    - [TIBER](https://northwave-cybersecurity.com/tiber-threat-intelligence-based-ethical-red-teaming)
    - [ART (Advanced Red Teaming)](https://northwave-cybersecurity.com/art-advanced-red-teaming)
    - [Gold Teaming](https://northwave-cybersecurity.com/gold-teaming)
    - [Pentesting & Vuln. Assessments](https://northwave-cybersecurity.com/pentest)
    - [Vulnerability Management](https://northwave-cybersecurity.com/vulnerability-management)
  + Behaviour

    - [Managed Cyber Behaviour](https://northwave-cybersecurity.com/cyber-behaviour-service)
    - [Workshops & Assessments](https://northwave-cybersecurity.com/mcb-workshops-and-assessments)
    - [Cyber Resilience Service](https://northwave-cybersecurity.com/cyber-resilience-service-2.0)
    - [Gold Teaming](https://northwave-cybersecurity.com/gold-teaming)
* [About](https://northwave-cybersecurity.com/about)
* [Career](https://northwave-cybersecurity.com/career)

  + [Vacancies](https://careers.northwave-cybersecurity.com/)
  + [Working At Northwave](https://northwave-cybersecurity.com/working-at-northwave)
  + [Meet the Team](https://northwave-cybersecurity.com/people-of-northwave)
* News

  + [News & Press](https://northwave-cybersecurity.com/news-press)
  + [Events](https://northwave-cybersecurity.com/events)
  + [Threat Response](https://northwave-cybersecurity.com/threat-response)
* Expertise

  + [White papers & Articles](https://northwave-cybersecurity.com/whitepapers-articles)
  + [Interviews](https://northwave-cybersecurity.com/interviews)
  + [Intel & Research](https://northwave-cybersecurity.com/threat-intel-research)
  + [Vulnerability Notices](https://northwave-cybersecurity.com/vulnerability-notice)
* [Contact](https://northwave-cybersecurity.com/contact)

[24/7 Incident Response](https://northwave-cybersecurity.com/cert-cyber-incident-response?hsLang=en)

✖

# Vulnerability Notice - Hardware Access Driver MarvinTest Solutions

[*See all Vulnerability notices*](https://northwave-cybersecurity.com/vulnerability-notice?hsLang=en)

## CVE NUMBER

CVE-2024-31756

## CVSS SCORE

7.3 - CVSS:4.0/AV:L/AC:L/AT:P/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N

## SUMMARY

Our reverse engineering team discovered a kernel handle leak vulnerability in [Hardware Access Driver](https://www.marvintest.com/Downloads.aspx?Type=Setup/Package&keywords=&filename=HW&search=download&FileID=303&UserAction=FileDownload). The vulnerability can be ubused for, for example, privilege escalation on a local system. During our research, we have also noticed that there have been attacks by Candiru (spyware) using another vulnerability in this same Hw64.sys/Hw.sys driver ([source](https://decoded.avast.io/janvojtesek/the-return-of-candiru-zero-days-in-the-middle-east/ "https://decoded.avast.io/janvojtesek/the-return-of-candiru-zero-days-in-the-middle-east/")). Candiru is a surveillance company from Tel Aviv, that works for the Israeli government ([source](https://citizenlab.ca/2021/07/hooking-candiru-another-mercenary-spyware-vendor-comes-into-focus/ "https://citizenlab.ca/2021/07/hooking-candiru-another-mercenary-spyware-vendor-comes-into-focus/")).

## Impacted Versions

The vulnerable component is Hw64.sys, a kernel driver that facilitates in enumerating devices on the local system. The latest version of driver is 5.0.2.0 (originating from the file attributes of the PE-file). However, the software itself (PXI/PCI) states that the latest version 5.0.3.0 is installed.

* MD5 (HW64.sys, version 5.0.2.0) = 9347fbeeaf917fc4a1d64a0b4d61187a
* MD5 (intsaller.exe, version 5.0.3.0) = 1ed7945e47ef927eb2f482751c48112c

MarvinTest Solutions notified Northwave that version 5.0.4.0 includes a patch for the vulnerability.

## DETAILS

The vulnerable component is Hw64.sys. There is at least one kernel handle leak present in the driver, which can be triggered from a low-privileged user context. This is due to the driver device being accessible by everyone on the local system. The kernel handle leak can be abused to obtain privilege escalation by abusing existing handles in other processes communicating with the driver.

## TIMELINE

* 04-03-2024 - Initial notice to and request for security contact.
* 05-03-2024 - First reply from MarvinTest Solutions security team requesting more information.
* 05-03-2024 - Sent full vulnerability details to MarvinTest Solutions security team.
* 28-03-2024 - MarvinTest Solutions security team notified Northwave of patched versions.
* 26-03-2024 - MarvinTest Solutions published the patched software.

## REFERENCE

Hardware Access Driver software: <https://www.marvintest.com/Downloads.aspx?Type=Setup/Package&keywords=&filename=HW&search=download&FileID=303&UserAction=FileDownload>

## CREDIT

Discovered by Tijme Gommers, Jan-Jaap Korpershoek and Alex Oudenaarden of Northwave Cyber Security.

## Disclaimer

*Northwave has made every effort to make this information accurate and reliable. However, the information provided is without warranty of any kind and its use is at the sole risk of the user. Northwave does not accept any responsibility or liability for the accuracy, content, completeness, legality or reliability of the information provided. We shall not be liable for any loss or damage of whatever nature, direct or indirect, consequential or other, whether arising in contract, tort or otherwise, which may arise as a result of your use of, or inability to use, this information or any additional information provided by us in direct or indirect relation to the information provided here.*

![NW-Logo-Horizontal-rgb-2](https://northwave-cybersecurity.com/hubfs/NW-Logo-Horizontal-rgb-2.png "NW-Logo-Horizontal-rgb-2")

Tel: +31 (0)30 303 1240

E-mail: info@northwave-cybersecurity.com

Van Deventerlaan 31-51, 3528 AG Utrecht

PO 1305, 3430 BH, Nieuwegein

[Responsible Disclosure](https://northwave-cybersecurity.com/responsible-disclosure?hsLang=en)

[Privacy Statement](https://northwave-cybersecurity.com/privacy-cookie-statement?hsLang=en)

[Cookie Statement](https://northwave-cybersecurity.com/cookie-statement?hsLang=en)

#### Business

[Managed Security & Privacy Office](https://northwave-cybersecurity.com/security-privacy-office-service?hsLang=en)

[State of Security Assessment](https://northwave-cybersecurity.com/state-of-security-assessment?hsLang=en)

[Data Protection Impact Assessment](https://northwave-cybersecurity.com/data-protection-impact-assessment?hsLang=en)

[Security Roadmap](https://northwave-cybersecurity.com/security-roadmap?hsLang=en)

[Assess & Control](https://northwave-cybersecurity.com/audits-control-service?hsLang=en)

[ISO 27001 FastTrack](https://northwave-cybersecurity.com/iso-27001-fasttrack?hsLang=en)

#### Bytes

[Managed Detection & Response](https://northwave-cybersecurity.com/managed-detection-response-service?hsLang=en)

[Rapid Response](https://northwave-cybersecurity.com/rapid-response-service?hsLang=en)

[Red Teaming](https://northwave-cybersecurity.com/adversary-simulation?hsLang=en)

[ART (Advanced Red Teaming)](https://northwave-cybersecurity.com/art-advanced-red-teaming?hsLang=en)

[Pentest](https://northwave-cybersecurity.com/pentest?hsLang=en)

[Vulnerability Management](https://northwave-cybersecurity.com/vulnerability-management?hsLang=en)

#### Behaviour

[Managed Cyber Behaviour](https://northwave-cybersecurity.com/cyber-behaviour-service?hsLang=en)

[Cyber Resilience Service](https://northwave-cybersecurity.com/cyber-resilience-service-2.0?hsLang=en)

© 2024 Northwave All Rights Reserved.

