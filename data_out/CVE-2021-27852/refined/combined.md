=== Content from www.kb.cert.org_c872ea3a_20250108_134813.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#706695

## Checkbox Survey insecurely deserializes ASP.NET View State data

#### Vulnerability Note VU#706695

Original Release Date: 2021-05-25 | Last Revised: 2021-05-25

---

### Overview

Checkbox Survey prior to version 7.0 insecurely deserializes ASP.NET [View State](https://docs.microsoft.com/en-us/previous-versions/aspnet/bb386448%28v%3Dvs.100%29) data, which can allow a remote, unauthenticated attacker to execute arbitrary code on a vulnerable server.

### Description

**CVE-2021-27852**
Checkbox Survey insecurely deserializes ASP.NET View State data.

[Checkbox Survey](https://www.checkbox.com/) is an ASP.NET application that can add survey functionality to a website. Prior to version 7.0, Checkbox Survey implements its own View State functionality by accepting a `_VSTATE` argument, which it then deserializes using [LosFormatter](https://docs.microsoft.com/en-us/dotnet/api/system.web.ui.losformatter?view=netframework-4.8). Because this data is manually handled by the Checkbox Survey code, the ASP.NET ViewState Message Authentication Code (MAC) setting on the server is ignored. Without MAC, an attacker can create arbitrary data that will be deserialized, resulting in arbitrary code execution.

This vulnerability is reportedly being exploited in the wild.

### Impact

By making a specially-crafted request to a server that uses Checkbox Survey 6.x or earlier, a remote, unauthenticated attacker may be able to execute arbitrary code with the privileges of the web server.

### Solution

#### Apply an update

Starting with Checkbox Survey 7.0, View State data is not used. Therefore, Checkbox Survey versions 7.0 and later do not contain this vulnerability.

#### Remove Checkbox Survey versions older than 7

Checkbox is no longer developing Checkbox Survey version 6, so this version is no longer safe to use. If you are unable to update to an unaffected version of Checkbox Survey, this software should be removed from any systems that have it installed.

### Acknowledgements

Thanks to the reporter who wishes to remain anonymous.

This document was written by Will Dormann.

### Vendor Information

706695
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

### [Checkbox](#Checkbox) Affected

Notified:  2021-05-18
Updated: 2021-05-25

| **CVE-2021-27852** | Affected |
| --- | --- |

#### Vendor Statement

We have not received a statement from the vendor.

### References

* <https://www.checkbox.com/>
* [https://docs.microsoft.com/en-us/previous-versions/aspnet/bb386448(v=vs.100)](https://docs.microsoft.com/en-us/previous-versions/aspnet/bb386448%28v%3Dvs.100%29)
* <https://docs.microsoft.com/en-us/dotnet/api/system.web.ui.losformatter?view=netframework-4.8>
* <https://swapneildash.medium.com/deep-dive-into-net-viewstate-deserialization-and-its-exploitation-54bf5b788817>

### Other Information

| **CVE IDs:** | [CVE-2021-27852](http://web.nvd.nist.gov/vuln/detail/CVE-2021-27852) |
| --- | --- |
| **Date Public:** | 2021-05-25 |
| **Date First Published:** | 2021-05-25 |
| **Date Last Updated:** | 2021-05-25 20:33 UTC |
| **Document Revision:** | 1 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


