

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2933915%2Fmeeting-scheduler-by-vcita%2Ftrunk%2Fvcita-ajax-function.php%3Fcontextall%3D1%26old%3D2924763%26old_path%3D%252Fmeeting-scheduler-by-vcita%252Ftrunk%252Fvcita-ajax-function.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/2924763/meeting-scheduler-by-vcita/trunk/vcita-ajax-function.php?old=2933915&old_path=%2Fmeeting-scheduler-by-vcita%2Ftrunk%2Fvcita-ajax-function.php)

---

# Changes in [meeting-scheduler-by-vcita/trunk/vcita-ajax-function.php](/browser/meeting-scheduler-by-vcita/trunk/vcita-ajax-function.php?rev=2933915 "Show entry in browser") [[2924763:2933915]](/log/meeting-scheduler-by-vcita/trunk/vcita-ajax-function.php?rev=2933915&stop_rev=2924763 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

File:

1 edited

* [meeting-scheduler-by-vcita/trunk/vcita-ajax-function.php](/browser/meeting-scheduler-by-vcita/trunk/vcita-ajax-function.php?rev=2933915 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [meeting-scheduler-by-vcita/trunk/vcita-ajax-function.php](/changeset/2933915/meeting-scheduler-by-vcita/trunk/vcita-ajax-function.php?old=2924763&old_path=meeting-scheduler-by-vcita%2Ftrunk%2Fvcita-ajax-function.php "Show the [2924763:2933915] differences restricted to meeting-scheduler-by-vcita/trunk/vcita-ajax-function.php")

  | [r2924763](/browser/meeting-scheduler-by-vcita/trunk/vcita-ajax-function.php?rev=2924763#L1 "Show revision 2924763 of this file in browser") | [r2933915](/browser/meeting-scheduler-by-vcita/trunk/vcita-ajax-function.php?rev=2933915#L1 "Show revision 2933915 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 | 2 |  |
  | 3 | 3 | add\_action('wp\_ajax\_vcita\_dismiss', 'vcita\_dismiss'); |
  | 4 | 4 | add\_action('wp\_ajax\_vcita\_logout', 'vcita\_logout\_callback'); |
  | 5 | 5 | add\_action('wp\_ajax\_vcita\_check\_auth', 'vcita\_check\_auth'); |
  | 6 | 6 | add\_action('wp\_ajax\_vcita\_save\_settings', 'vcita\_save\_settings\_callback'); |
  | 7 | 7 | add\_action('wp\_ajax\_vcita\_save\_data', 'vcita\_save\_user\_data\_callback'); |
  | 8 | 8 | add\_action('wp\_ajax\_vcita\_deactivate\_others', 'vcita\_vcita\_deactivate\_others\_callback'); |
  | 9 | 9 |  |
  | 10 | 10 | function vcita\_dismiss() |
  | 11 | 11 | { |
  | 12 | 12 | if (isset($\_GET['dismiss'])) { |
  | 13 | 13 | $wpshd\_vcita\_widget = (array)get\_option(WPSHD\_VCITA\_WIDGET\_KEY); |
  | 14 | 14 | $wpshd\_vcita\_widget['dismiss'] = true; |
  | 15 | 15 | $wpshd\_vcita\_widget['dismiss\_time'] = microtime(true); |
  | 16 | 16 | update\_option(WPSHD\_VCITA\_WIDGET\_KEY, $wpshd\_vcita\_widget); |
  | 17 | 17 | echo 'dismissed'; |
  | 18 | 18 | wp\_die(); |
  | 19 | 19 | } else if (isset($\_GET['dismiss\_switch'])) { |
  | 20 | 20 | $wpshd\_vcita\_widget = (array)get\_option(WPSHD\_VCITA\_WIDGET\_KEY); |
  | 21 | 21 | $wpshd\_vcita\_widget['dismiss\_switch'] = true; |
  | 22 | 22 | $wpshd\_vcita\_widget['dismiss\_switch\_time'] = microtime(true); |
  | 23 | 23 | update\_option(WPSHD\_VCITA\_WIDGET\_KEY, $wpshd\_vcita\_widget); |
  | 24 | 24 | echo 'dismissed'; |
  | 25 | 25 | wp\_die(); |
  | 26 | 26 | } else if (isset($\_GET['switch\_on'])) { |
  | 27 | 27 | $wpshd\_vcita\_widget = (array)get\_option(WPSHD\_VCITA\_WIDGET\_KEY); |
  | 28 | 28 | $wpshd\_vcita\_widget['dismiss\_switch'] = false; |
  | 29 | 29 | unset($wpshd\_vcita\_widget['dismiss\_switch\_time']); |
  | 30 | 30 | $wpshd\_vcita\_widget['show\_on\_site'] = 1; |
  | 31 | 31 | update\_option(WPSHD\_VCITA\_WIDGET\_KEY, $wpshd\_vcita\_widget); |
  | 32 | 32 | echo 'dismissed'; |
  | 33 | 33 | wp\_die(); |
  | 34 | 34 | } |
  | 35 | 35 | } |
  | 36 | 36 |  |
  | 37 | 37 | function vcita\_check\_auth() |
  | 38 | 38 | { |
  | 39 | 39 | $wpshd\_vcita\_widget = (array)get\_option(WPSHD\_VCITA\_WIDGET\_KEY); |
  | 40 | 40 | echo json\_encode($wpshd\_vcita\_widget); |
  | 41 | 41 | wp\_die(); |
  | 42 | 42 | } |
  | 43 | 43 |  |
  | 44 | 44 | function vcita\_vcita\_deactivate\_others\_callback() |
  | 45 | 45 | { |
  | 46 | 46 | $av\_plugin\_list = wp\_cache\_get('WPSHD\_VCITA\_ANOTHER\_PLUGIN\_LIST'); |
  | 47 | 47 | $found = array(); |
  | 48 | 48 | foreach ($av\_plugin\_list as $av\_plugin) $found[] = $av\_plugin['file']; |
  | 49 | 49 | deactivate\_plugins($found); |
  | 50 | 50 |  |
  | 51 | 51 | echo 'success'; |
  | 52 | 52 | wp\_die(); |
  | 53 | 53 | } |
  | 54 | 54 |  |
  | 55 | 55 | function vcita\_logout\_callback() |
  | 56 | 56 | { |
  | 57 | 57 | if ( current\_user\_can('delete\_plugins') ) { |
  | 58 | 58 | $wpshd\_vcita\_widget = wpshd\_vcita\_clean\_expert\_data(); |
  | 59 | 59 | $wpshd\_vcita\_widget['dismiss'] = false; |
  | 60 | 60 | unset($wpshd\_vcita\_widget['dismiss\_time']); |
  | 61 | 61 |  |
  | 62 | 62 | if (isset($wpshd\_vcita\_widget['wp\_id']) && $wpshd\_vcita\_widget['wp\_id']) { |
  | 63 | 63 | vcita\_send\_get('https://us-central1-scheduler-272415.cloudfunctions.net/scheduler-proxy/logout/' . $wpshd\_vcita\_widget['wp\_id']); |
  | 64 | 64 | } |
  | 65 | 65 |  |
  | 66 | 66 | update\_option(WPSHD\_VCITA\_WIDGET\_KEY, $wpshd\_vcita\_widget); |
  | 67 | 67 | echo 'logged out'; |
  | 68 | 68 | wp\_die(); |
  | 69 | 69 | } |
  | 70 | 70 | } |
  | 71 | 71 |  |
  | 72 | 72 | function vcita\_save\_user\_data\_callback() |
  | 73 | 73 | { |
  | 74 | 74 | header('Content-Type: application/json'); |
  | 75 | 75 | $response = array(); |
  | 76 | 76 |  |
  | 77 | 77 | if (isset($\_REQUEST['data\_name']) && isset($\_REQUEST['data\_val'])) { |
  | 78 | 78 | $wpshd\_vcita\_widget = (array)get\_option(WPSHD\_VCITA\_WIDGET\_KEY); |
  | 79 | 79 | $wpshd\_vcita\_widget[$\_REQUEST['data\_name']] = $\_REQUEST['data\_val']; |
  | 80 | 80 | update\_option(WPSHD\_VCITA\_WIDGET\_KEY, $wpshd\_vcita\_widget); |
  | 81 | 81 | $response['success'] = true; |
  | 82 | 82 | } else { |
  | 83 | 83 | $response['error'] = 'Request invalid'; |
  | 84 | 84 | } |
  | 85 | 85 |  |
  | 86 | 86 | echo json\_encode($response); |
  | 87 | 87 | wp\_die(); |
  | 88 | 88 | } |
  | 89 | 89 |  |
  | 90 | 90 | function vcita\_save\_settings\_callback() |
  | 91 | 91 | { |
  | 92 | 92 | header('Content-Type: application/json'); |
  | 93 | 93 | $response = array(); |
  | 94 | 94 |  |
  | 95 | 95 | if (isset($\_POST['btn\_text']) || isset($\_POST['btn\_color']) || isset($\_POST['txt\_color']) || |
  | 96 | 96 | isset($\_POST['show\_on\_site']) || isset($\_POST['widget\_title']) || isset($\_POST['widget\_title']) || |
  | 97 | 97 | isset($\_POST['txt\_color']) || isset($\_POST['widget\_show']) || isset($\_POST['widget\_text']) || |
  | 98 | 98 | isset($\_FILES['widget\_img']) || isset($\_POST['calendar\_page\_active']) || isset($\_POST['contact\_page\_active']) || |
  | 99 | 99 | isset($\_POST['hover\_color']) || isset($\_POST['vcita\_design']) |
  | 100 | 100 | ) { |
  | 101 | 101 | $wpshd\_vcita\_widget = (array)get\_option(WPSHD\_VCITA\_WIDGET\_KEY); |
  | 102 | 102 |  |
  | 103 | 103 | if (isset($\_POST['show\_on\_site'])) { |
  | 104 |  | $wpshd\_vcita\_widget['show\_on\_site'] = ~~$\_POST['show\_on\_site']~~; |
  |  | 104 | $wpshd\_vcita\_widget['show\_on\_site'] = filter\_var($\_POST['show\_on\_site'], FILTER\_VALIDATE\_INT); |
  | 105 | 105 |  |
  | 106 | 106 | if ($\_POST['show\_on\_site']) { |
  | 107 | 107 | $wpshd\_vcita\_widget['dismiss\_switch'] = false; |
  | 108 | 108 | unset($wpshd\_vcita\_widget['dismiss\_switch\_time']); |
  | 109 | 109 | } |
  | 110 | 110 | } |
  | 111 | 111 |  |
  | 112 | 112 | if (isset($\_POST['vcita\_design'])) { |
  | 113 |  | $wpshd\_vcita\_widget['vcita\_design'] = ~~$\_POST['vcita\_design']~~; |
  |  | 113 | $wpshd\_vcita\_widget['vcita\_design'] = filter\_var($\_POST['vcita\_design'], FILTER\_VALIDATE\_INT); |
  | 114 | 114 | } |
  | 115 | 115 |  |
  | 116 | 116 | if (isset($\_POST['btn\_text'])) { |
  | 117 | 117 | $wpshd\_vcita\_widget['btn\_text'] = htmlentities($\_POST['btn\_text']); |
  | 118 | 118 | } |
  | 119 | 119 |  |
  | 120 | 120 | if (isset($\_POST['btn\_color'])) { |
  | 121 |  | $wpshd\_vcita\_widget['btn\_color'] = ~~$\_POST['btn\_color']~~; |
  |  | 121 | $wpshd\_vcita\_widget['btn\_color'] = filter\_var($\_POST['btn\_color'], FILTER\_SANITIZE\_SPECIAL\_CHARS, FILTER\_FLAG\_ENCODE\_HIGH); |
  | 122 | 122 | } |
  | 123 | 123 |  |
  | 124 | 124 | if (isset($\_POST['txt\_color'])) { |
  | 125 |  | $wpshd\_vcita\_widget['txt\_color'] = ~~$\_POST['txt\_color']~~; |
  |  | 125 | $wpshd\_vcita\_widget['txt\_color'] = filter\_var($\_POST['txt\_color'], FILTER\_SANITIZE\_SPECIAL\_CHARS, FILTER\_FLAG\_ENCODE\_HIGH); |
  | 126 | 126 | } |
  | 127 | 127 |  |
  | 128 | 128 | if (isset($\_POST['hover\_color'])) { |
  | 129 |  | $wpshd\_vcita\_widget['hover\_color'] = ~~$\_POST['hover\_color']~~; |
  |  | 129 | $wpshd\_vcita\_widget['hover\_color'] = filter\_var($\_POST['hover\_color'], FILTER\_SANITIZE\_SPECIAL\_CHARS, FILTER\_FLAG\_ENCODE\_HIGH); |
  | 130 | 130 | } |
  | 131 | 131 |  |
  | 132 | 132 | if (isset($\_POST['widget\_title'])) { |
  | 133 | 133 | $wpshd\_vcita\_widget['widget\_title'] = htmlentities($\_POST['widget\_title']); |
  | 134 | 134 | } |
  | 135 | 135 |  |
  | 136 | 136 | if (isset($\_POST['txt\_color'])) { |
  | 137 |  | $wpshd\_vcita\_widget['txt\_color'] = ~~$\_POST['txt\_color']~~; |
  |  | 137 | $wpshd\_vcita\_widget['txt\_color'] = filter\_var($\_POST['txt\_color'], FILTER\_SANITIZE\_SPECIAL\_CHARS, FILTER\_FLAG\_ENCODE\_HIGH); |
  | 138 | 138 | } |
  | 139 | 139 |  |
  | 140 | 140 | if (isset($\_POST['widget\_show'])) { |
  | 141 |  | $wpshd\_vcita\_widget['widget\_show'] = ~~$\_POST['widget\_show']~~; |
  |  | 141 | $wpshd\_vcita\_widget['widget\_show'] = filter\_var($\_POST['widget\_show'], FILTER\_SANITIZE\_SPECIAL\_CHARS, FILTER\_FLAG\_ENCODE\_HIGH); |
  | 142 | 142 | } |
  | 143 | 143 |  |
  | 144 | 144 | if (isset($\_POST['widget\_text'])) { |
  | 145 | 145 | $wpshd\_vcita\_widget['widget\_text'] = htmlentities($\_POST['widget\_text']); |
  | 146 | 146 | } |
  | 147 | 147 |  |
  | 148 | 148 | if (isset($\_POST['widget\_img\_clear']) && $\_POST['widget\_img\_clear']) { |
  | 149 | 149 | if (!empty($wpshd\_vcita\_widget['widget\_img'])) { |
  | 150 | 150 | wp\_delete\_attachment($wpshd\_vcita\_widget['widget\_img'], true); |
  | 151 | 151 | $wpshd\_vcita\_widget['widget\_img'] = ''; |
  | 152 | 152 | } |
  | 153 | 153 | } |
  | 154 | 154 |  |
  | 155 | 155 | if (isset($\_POST['calendar\_page\_active'])) { |
  | 156 | 156 | if ($\_POST['calendar\_page\_active'] && $wpshd\_vcita\_widget['uid']) { |
  | 157 | 157 | wpshd\_vcita\_make\_sure\_calendar\_page\_published($wpshd\_vcita\_widget, true); |
  | 158 | 158 | $wpshd\_vcita\_widget['calendar\_page\_active'] = 1; |
  | 159 | 159 | } else { |
  | 160 | 160 | wpshd\_vcita\_trash\_current\_calendar\_page($wpshd\_vcita\_widget); |
  | 161 | 161 | $wpshd\_vcita\_widget['calendar\_page\_active'] = 0; |
  | 162 | 162 | } |
  | 163 | 163 | } |
  | 164 | 164 |  |
  | 165 | 165 | if (isset($\_POST['contact\_page\_active'])) { |
  | 166 | 166 | if ($\_POST['contact\_page\_active'] && $wpshd\_vcita\_widget['uid']) { |
  | 167 | 167 | wpshd\_vcita\_make\_sure\_page\_published($wpshd\_vcita\_widget, true); |
  | 168 | 168 | $wpshd\_vcita\_widget['contact\_page\_active'] = 1; |
  | 169 | 169 | } else { |
  | 170 | 170 | wpshd\_vcita\_trash\_contact\_page($wpshd\_vcita\_widget); |
  | 171 | 171 | $wpshd\_vcita\_widget['contact\_page\_active'] = 0; |
  | 172 | 172 | } |
  | 173 | 173 | } |
  | 174 | 174 |  |
  | 175 | 175 | function isFileImage($mimeType) |
  | 176 | 176 | { |
  | 177 | 177 | return in\_array($mimeType, ['image/jpeg', 'image/png', 'image/gif']); |
  | 178 | 178 | } |
  | 179 | 179 |  |
  | 180 | 180 | if (isset($\_FILES['widget\_img']) && $\_FILES['widget\_img']['error'] == UPLOAD\_ERR\_OK) { |
  | 181 | 181 |  |
  | 182 | 182 | if (!isFileImage($\_FILES['widget\_img']['type'])) { |
  | 183 | 183 | $response['error'] = 'Invalid file type must be jpeg, png or gif'; |
  | 184 | 184 |  |
  | 185 | 185 | echo json\_encode($response); |
  | 186 | 186 | wp\_die(); |
  | 187 | 187 | } |
  | 188 | 188 |  |
  | 189 | 189 | require\_once($\_SERVER['DOCUMENT\_ROOT'] . '/wp-load.php'); |
  | 190 | 190 |  |
  | 191 | 191 | $wordpress\_upload\_dir = wp\_upload\_dir(); |
  | 192 | 192 | $i = 1; |
  | 193 | 193 |  |
  | 194 | 194 | $widget\_img = $\_FILES['widget\_img']; |
  | 195 | 195 | $new\_file\_path = $wordpress\_upload\_dir['path'] . '/' . $widget\_img['name']; |
  | 196 | 196 | $new\_file\_mime = mime\_content\_type($widget\_img['tmp\_name']); |
  | 197 | 197 | $\_error = false; |
  | 198 | 198 |  |
  | 199 | 199 | if (empty($widget\_img)) $\_error = true; |
  | 200 | 200 | if ($widget\_img['error']) $\_error = true; |
  | 201 | 201 | if ($widget\_img['size'] > wp\_max\_upload\_size()) $\_error = true; |
  | 202 | 202 | if (!in\_array($new\_file\_mime, get\_allowed\_mime\_types())) $\_error = true; |
  | 203 | 203 |  |
  | 204 | 204 | while (file\_exists($new\_file\_path)) { |
  | 205 | 205 | $i++; |
  | 206 | 206 | $new\_file\_path = $wordpress\_upload\_dir['path'] . '/' . $i . '\_' . $widget\_img['name']; |
  | 207 | 207 | } |
  | 208 | 208 |  |
  | 209 | 209 | if ($\_error) { |
  | 210 | 210 | file\_put\_contents(dirname(\_\_FILE\_\_) . '/debug.log', print\_r($\_FILES['widget\_img'], TRUE), FILE\_APPEND); |
  | 211 | 211 | file\_put\_contents(dirname(\_\_FILE\_\_) . '/debug.log', 'error occured', FILE\_APPEND); |
  | 212 | 212 | } |
  | 213 | 213 |  |
  | 214 | 214 | if (move\_uploaded\_file($widget\_img['tmp\_name'], $new\_file\_path) && $\_error === false) { |
  | 215 | 215 | $upload\_id = wp\_insert\_attachment(array( |
  | 216 | 216 | 'guid' => $new\_file\_path, |
  | 217 | 217 | 'post\_mime\_type' => $new\_file\_mime, |
  | 218 | 218 | 'post\_title' => preg\_replace('/\.[^.]+$/', '', $widget\_img['name']), |
  | 219 | 219 | 'post\_content' => '', |
  | 220 | 220 | 'post\_status' => 'inherit' |
  | 221 | 221 | ), $new\_file\_path); |
  | 222 | 222 |  |
  | 223 | 223 | require\_once(ABSPATH . 'wp-admin/includes/image.php'); |
  | 224 | 224 |  |
  | 225 | 225 | wp\_update\_attachment\_metadata($upload\_id, wp\_generate\_attachment\_metadata($upload\_id, $new\_file\_path)); |
  | 226 | 226 | $wpshd\_vcita\_widget['widget\_img'] = $upload\_id; |
  | 227 | 227 | $response['widget\_img'] = wp\_get\_attachment\_image($upload\_id); |
  | 228 | 228 | } |
  | 229 | 229 | } |
  | 230 | 230 |  |
  | 231 | 231 | if (!isset($response['error']) || !$response['error']) { |
  | 232 | 232 | $response['success'] = true; |
  | 233 | 233 | } |
  | 234 | 234 |  |
  | 235 | 235 | update\_option(WPSHD\_VCITA\_WIDGET\_KEY, $wpshd\_vcita\_widget); |
  | 236 | 236 | } else { |
  | 237 | 237 | $response['error'] = 'Nothing to change'; |
  | 238 | 238 | } |
  | 239 | 239 |  |
  | 240 | 240 | echo json\_encode($response); |
  | 241 | 241 | wp\_die(); |
  | 242 | 242 | } |
  | 243 | 243 |  |
  | 244 | 244 | function vcita\_send\_get($url, $options = array()) |
  | 245 | 245 | { |
  | 246 | 246 | $ch = curl\_init(); |
  | 247 | 247 | curl\_setopt($ch, CURLOPT\_URL, $url); |
  | 248 | 248 | curl\_setopt($ch, CURLOPT\_SSL\_VERIFYHOST, 0); |
  | 249 | 249 | curl\_setopt($ch, CURLOPT\_SSL\_VERIFYPEER, 0); |
  | 250 | 250 | curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, 1); |
  | 251 | 251 |  |
  | 252 | 252 | if (isset($options['auth\_token'])) { |
  | 253 | 253 | curl\_setopt($ch, CURLOPT\_HTTPHEADER, array( |
  | 254 | 254 | 'Authorization: Bearer ' . $options['auth\_token'])); |
  | 255 | 255 | } |
  | 256 | 256 |  |
  | 257 | 257 | $output = curl\_exec($ch); |
  | 258 | 258 | $error = curl\_error($ch); |
  | 259 | 259 | $httpcode = curl\_getinfo($ch, CURLINFO\_HTTP\_CODE); |
  | 260 | 260 | curl\_close($ch); |
  | 261 | 261 |  |
  | 262 | 262 | if (empty($error) && $httpcode === 200) { |
  | 263 | 263 | return json\_decode($output, true); |
  | 264 | 264 | } else if (empty($error)) { |
  | 265 | 265 | return array( |
  | 266 | 266 | 'error' => $output, |
  | 267 | 267 | 'description' => 'Request was not successful', |
  | 268 | 268 | 'http\_code' => $httpcode |
  | 269 | 269 | ); |
  | 270 | 270 | } else { |
  | 271 | 271 | return array( |
  | 272 | 272 | 'error' => $error, |
  | 273 | 273 | 'description' => 'request was not successful' |
  | 274 | 274 | ); |
  | 275 | 275 | } |
  | 276 | 276 | } |
  | 277 | 277 |  |
  | 278 | 278 | function vcita\_send\_post($url, $options = array()) |
  | 279 | 279 | { |
  | 280 | 280 | $ch = curl\_init(); |
  | 281 | 281 | curl\_setopt($ch, CURLOPT\_URL, $url); |
  | 282 | 282 | curl\_setopt($ch, CURLOPT\_POST, 1); |
  | 283 | 283 | curl\_setopt($ch, CURLOPT\_SSL\_VERIFYHOST, 0); |
  | 284 | 284 | curl\_setopt($ch, CURLOPT\_SSL\_VERIFYPEER, 0); |
  | 285 | 285 | curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, 1); |
  | 286 | 286 |  |
  | 287 | 287 | if ($options['post\_data']) { |
  | 288 | 288 | curl\_setopt($ch, CURLOPT\_POSTFIELDS, $options['post\_data']); |
  | 289 | 289 | } |
  | 290 | 290 |  |
  | 291 | 291 | if (isset($options['auth\_token'])) { |
  | 292 | 292 | curl\_setopt($ch, CURLOPT\_HTTPHEADER, array( |
  | 293 | 293 | 'Content-Type: application/json', |
  | 294 | 294 | 'Authorization: Bearer ' . $options['auth\_token'])); |
  | 295 | 295 | } |
  | 296 | 296 |  |
  | 297 | 297 | $output = curl\_exec($ch); |
  | 298 | 298 | $error = curl\_error($ch); |
  | 299 | 299 | $httpcode = curl\_getinfo($ch, CURLINFO\_HTTP\_CODE); |
  | 300 | 300 | curl\_close($ch); |
  | 301 | 301 |  |
  | 302 | 302 | if (empty($error) && $httpcode === 200) { |
  | 303 | 303 | return json\_decode($output, true); |
  | 304 | 304 | } else if (empty($error)) { |
  | 305 | 305 | return array( |
  | 306 | 306 | 'error' => $output, |
  | 307 | 307 | 'description' => 'Request was not successful', |
  | 308 | 308 | 'status' => $httpcode |
  | 309 | 309 | ); |
  | 310 | 310 | } else { |
  | 311 | 311 | return array( |
  | 312 | 312 | 'error' => $error, |
  | 313 | 313 | 'description' => 'request was not successful', |
  | 314 | 314 | 'status' => $httpcode |
  | 315 | 315 | ); |
  | 316 | 316 | } |
  | 317 | 317 | } |
  | 318 | 318 |  |
  | 319 | 319 | ?> |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2933915&old=2924763&new_path=%2Fmeeting-scheduler-by-vcita%2Ftrunk%2Fvcita-ajax-function.php&old_path=%2Fmeeting-scheduler-by-vcita%2Ftrunk%2Fvcita-ajax-function.php)
* [Zip Archive](?format=zip&new=2933915&old=2924763&new_path=%2Fmeeting-scheduler-by-vcita%2Ftrunk%2Fvcita-ajax-function.php&old_path=%2Fmeeting-scheduler-by-vcita%2Ftrunk%2Fvcita-ajax-function.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

