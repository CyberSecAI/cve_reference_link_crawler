- **Root cause of vulnerability**: Path traversal vulnerability compounded by an improper access control bug.
- **Weaknesses/vulnerabilities present**:
    - CWE-22: Path Traversal
    - CWE-284: Improper Access Control
- **Impact of exploitation**: A malicious user with read-only repository access can leak sensitive files from Argo CD's repo-server. This could include files from other Applications' source repositories (potentially decrypted files) or secrets mounted as files on the repo-server.
- **Attack vectors**: A malicious user crafts an API request to the `/api/v1/repositories/{repo_url}/appdetails` endpoint, referencing an out-of-bounds file.
- **Required attacker capabilities/position**:
    - The attacker needs to have `get` access for a repository containing a Helm chart in Argo CD.
    - The attacker needs to know or guess the location of the target file on the repo-server.