

| [cgit logo](/cgi-bin/cgit.cgi/) | [index](/cgi-bin/cgit.cgi/) : [ghostpdl.git](/cgi-bin/cgit.cgi/ghostpdl.git/ "ghostpdl.git") | 7cf36fb5bd BGPrint\_fixes CCAUX-configure OpenJpeg-1.5 PDF\_gstate PJL\_pdfwrite\_config Type3\_PCL alphabits\_fix\_test alphaslay apitest bug699791 bug707828 build\_consolidation chameleon dev-robin device\_subclassing expat-2.6.4\_update filesec fill-stroke3 freetype-2.13.3\_update freetype-2.5.5 ghostpdl-9.03 ghostpdl-9.53.x-ocr-fixes ghostpdl-9.55.0-customer470 ghostpdl-9.55.0-docs ghostpdl-9.56.0\_ttf\_fix ghostpdl-9.56.1 ghostpdl-9.56.1-backport gpdl-shared-device gs-sprintf gs10.0.0 gs10.01.0 gs10.01.1 gs10.01.1\_Bug706761 gs10.01.2 gs10.02.0 gs10.02.1 gs10.03.0 gs10.03.1 gs10.04.0 gs10.04.0\_openjpeg-2.5.2 gs9.24 gs9.26 gs9.27 gs9.27-release\_tests gs9.28-temp-for-testing gs9.50 gs9.51 gs9.52.1 gs9.53.0 gs9.53.x gs9.54.0 gs9.55.0 gs9.56.0 gs9.56.0\_zlib\_1.2.12 gs904 gs905 gs906 gs907 gs908 gs910 gs912 gs914 gs915 gs916 gs917 gs918 gs919 gs920 gs921 gs922 gs923 gs925 gs925\_scanconvfixes gs\_sprintf-apache\_sprintf gs\_strtok-apache\_strtok gse-10.0.0 java-demo libpng-1.6.44\_update libs-update libtiff\_4.5.0 master mooscript nobble-cal nup-endpage opacity\_shape openjpeg-2.2.0-update openjpeg-2.5.2\_update openjpeg-update-20160927 page\_group patt\_trans\_clist pattern\_simplification pdfi pdfi\_alpha1 pdfwrite\_ocr ramfs\_branch rjw-test robin-test-base tiff-4.7.0\_update zlib-1.2.8 |
| --- | --- | --- |
| Ghostscript and GhostPDL | Tor Andersson |

| [summary](/cgi-bin/cgit.cgi/ghostpdl.git/)[refs](/cgi-bin/cgit.cgi/ghostpdl.git/refs/?id=7145885041bb52cc23964f0aa2aec1b1c82b5908)[log](/cgi-bin/cgit.cgi/ghostpdl.git/log/)[tree](/cgi-bin/cgit.cgi/ghostpdl.git/tree/?id=7145885041bb52cc23964f0aa2aec1b1c82b5908)[commit](/cgi-bin/cgit.cgi/ghostpdl.git/commit/?id=7145885041bb52cc23964f0aa2aec1b1c82b5908)[diff](/cgi-bin/cgit.cgi/ghostpdl.git/diff/?id=7145885041bb52cc23964f0aa2aec1b1c82b5908) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Zdenek Hutyra <zhutyra@centrum.cz> | 2024-04-22 13:33:47 +0100 |
| --- | --- | --- |
| committer | Chris Liddell <chris.liddell@artifex.com> | 2024-05-02 10:40:55 +0100 |
| commit | [7145885041bb52cc23964f0aa2aec1b1c82b5908](/cgi-bin/cgit.cgi/ghostpdl.git/commit/?id=7145885041bb52cc23964f0aa2aec1b1c82b5908) ([patch](/cgi-bin/cgit.cgi/ghostpdl.git/patch/?id=7145885041bb52cc23964f0aa2aec1b1c82b5908)) | |
| tree | [a3a83b2fbafddad0d1e2853eb6aa7bf218b5ae2a](/cgi-bin/cgit.cgi/ghostpdl.git/tree/?id=7145885041bb52cc23964f0aa2aec1b1c82b5908) | |
| parent | [be3fa36d2f57551a29c9e5d35f76906a50e63d4a](/cgi-bin/cgit.cgi/ghostpdl.git/commit/?id=be3fa36d2f57551a29c9e5d35f76906a50e63d4a) ([diff](/cgi-bin/cgit.cgi/ghostpdl.git/diff/?id=7145885041bb52cc23964f0aa2aec1b1c82b5908&id2=be3fa36d2f57551a29c9e5d35f76906a50e63d4a)) | |

OPVP device - prevent unsafe parameter change with SAFER[ghostpdl-10.03.1](/cgi-bin/cgit.cgi/ghostpdl.git/tag/?h=ghostpdl-10.03.1)[gs10.03.1](/cgi-bin/cgit.cgi/ghostpdl.git/log/?h=gs10.03.1)Bug #707754 "OPVP device - Arbitrary code execution via custom Driver library"
The "Driver" parameter for the "opvp"/"oprp" device specifies the name
of a dynamic library and allows any library to be loaded.
The patch does not allow changing this parameter after activating path
control.
This addresses CVE-2024-33871
[Diffstat](/cgi-bin/cgit.cgi/ghostpdl.git/diff/?id=7145885041bb52cc23964f0aa2aec1b1c82b5908)

| -rw-r--r-- | [contrib/opvp/gdevopvp.c](/cgi-bin/cgit.cgi/ghostpdl.git/diff/contrib/opvp/gdevopvp.c?id=7145885041bb52cc23964f0aa2aec1b1c82b5908) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/contrib/opvp/gdevopvp.c b/contrib/opvp/gdevopvp.cindex 74200cf9d..80eb23b17 100644--- a/[contrib/opvp/gdevopvp.c](/cgi-bin/cgit.cgi/ghostpdl.git/tree/contrib/opvp/gdevopvp.c?id=be3fa36d2f57551a29c9e5d35f76906a50e63d4a)+++ b/[contrib/opvp/gdevopvp.c](/cgi-bin/cgit.cgi/ghostpdl.git/tree/contrib/opvp/gdevopvp.c?id=7145885041bb52cc23964f0aa2aec1b1c82b5908)@@ -3456,6 +3456,12 @@ \_put\_params(gx\_device \*dev, gs\_param\_list \*plist) code = param\_read\_string(plist, pname, &vdps); switch (code) { case 0:+ if (gs\_is\_path\_control\_active(dev->memory)+ && (!opdev->globals.vectorDriver || strlen(opdev->globals.vectorDriver) != vdps.size+ || memcmp(opdev->globals.vectorDriver, vdps.data, vdps.size) != 0)) {+ param\_signal\_error(plist, pname, gs\_error\_invalidaccess);+ return\_error(gs\_error\_invalidaccess);+ } buff = realloc(buff, vdps.size + 1); memcpy(buff, vdps.data, vdps.size); buff[vdps.size] = 0; |
| --- |

generated by [cgit v1.2.3](https://git.zx2c4.com/cgit/about/) ([git 2.25.1](https://git-scm.com/)) at 2025-01-10 17:34:13 +0000

