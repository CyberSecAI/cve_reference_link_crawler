<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title> SVD-2024-0301 | Splunk Vulnerability Disclosure</title><meta property="og:site_name" content="Splunk Vulnerability Disclosure"><meta property="og:site_description" content="Splunk Vulnerability Disclosure"><meta property="og:title" content="Splunk Authentication Token Exposure in Debug Log in Splunk Enterprise"><meta property="og:description" content="In Splunk Enterprise versions below 9.2.1, 9.1.4, and 9.0.9, the software potentially exposes authentication tokens during the token validation process. This exposure could happen when either Splunk Enterprise runs in debug mode or the `JsonWebToken` component has been configured to log its activity at the DEBUG logging level. Normally, Splunk Enterprise runs with debug mode and token authentication turned off, as well as the `JsonWebToken` process configured at the INFO logging level. <br><br>The vulnerability would require either local access to the log files or administrative access to internal indexes, which by default only the admin role receives. Review roles and capabilities on your instance and restrict internal index access to administrator-level roles. See [Define roles on the Splunk platform with capabilities](https://docs.splunk.com/Documentation/Splunk/latest/Security/Rolesandcapabilities) in the Splunk documentation for more information."><meta property="og:locale" content="en-US"><meta property="og:url" content=""><meta property="og:image" content="/assets/img/logo_color.jpg"><link rel="shortcut icon" type="image/x-icon" href="/assets/img/favicon.png"/><link rel="stylesheet" href="/assets/css/datatables.css"><link rel="stylesheet" href="/assets/css/main.css"><link rel="stylesheet" href="/assets/css/fontawesome-free-6.2.0.css"> <script src="/assets/js/jquery-3.7.1.js"></script> <script src="/assets/js/jquery.greedy-navigation.js"></script> <script src="/assets/js/datatables.js"></script> <script src="/assets/js/main.js"></script></head><body class="layout--advisory"><div class="masthead"><div class="masthead__inner-wrap"><div class="masthead__menu"><nav class="greedy-nav"> <a class="site-logo" href="https://www.splunk.com/"><img src="/assets/img/logo.svg" alt=" "></a><ul class="visible-links"><li class="advisory-hide-on-mobile masthead__menu-item"> <a href="/" class="advisory-link">Home</a></li><li class="advisory-hide-on-mobile masthead__menu-item"> <a href="/report" class="advisory-link">Report a Vulnerability</a></li><li class="advisory-hide-on-mobile masthead__menu-item"> <a href="/faqs" class="advisory-link">FAQs</a></li><li class="advisory-hide-on-mobile masthead__menu-item"> <a href="https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html" class="advisory-link">Mailing List</a></li></ul><button class="greedy-nav__toggle hidden advisory-show-on-mobile" type="button"> <span class="visually-hidden">Toggle menu</span><div class="navicon"></div></button><ul class="hidden-links hidden advisory-show-on-mobile"><li class="masthead__menu-item"> <a href="/">Home</a></li><li class="masthead__menu-item"> <a href="/report">Report a Vulnerability</a></li><li class="masthead__menu-item"> <a href="/faqs">FAQs</a></li><li class="masthead__menu-item"> <a href="https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html">Mailing List</a></li></ul></nav></div></div></div><div class="initial-content"><div id="main" role="main"><article class="splash"><section class="page__content"><div class="advisory-show-on-mobile"><p>&nbsp;</p></div><div id="advisory" role="main"><div class="advisory-title"><h1>Splunk Authentication Token Exposure in Debug Log in Splunk Enterprise</h1></div><div><div class="advisory-row"><div class="advisory-column-left"><p><b>Advisory&nbsp;ID:</b>&nbsp;SVD-2024-0301</p></div><div class="advisory-column-right"><p><b>CVE&nbsp;ID:</b>&nbsp;<a href="https://www.cve.org/CVERecord?id=CVE-2024-29945" class="advisory-no-link advisory-link">CVE-2024-29945</a></p></div></div><div class="advisory-row"><div class="advisory-column-left"><p><b>Published:</b>&nbsp;2024-03-27</p></div><div class="advisory-column-right"><p><b>Last&nbsp;Update:</b>&nbsp;2024-03-27</p></div></div><div class="advisory-row"><div class="advisory-column-left"><p><b>CVSSv3.1&nbsp;Score:</b>&nbsp;7.2,&nbsp;High</p></div><div class="advisory-column-right"><p><b>CVSSv3.1&nbsp;Vector:</b>&nbsp;<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H" class="advisory-no-link advisory-link">CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H</a></p></div></div><div class="advisory-row"><div class="advisory-column-left"><p><b>CWE:</b>&nbsp;<a href="https://cwe.mitre.org/data/definitions/532.html" class="advisory-no-link advisory-link">CWE-532</a></p></div><div class="advisory-column-right"><p><b>Bug&nbsp;ID:</b>&nbsp;SPL-248977</p></div></div></div><div><h2 id="description">Description</h2><p>In Splunk Enterprise versions below 9.2.1, 9.1.4, and 9.0.9, the software potentially exposes authentication tokens during the token validation process. This exposure could happen when either Splunk Enterprise runs in debug mode or the <code class="language-plaintext highlighter-rouge">JsonWebToken</code> component has been configured to log its activity at the DEBUG logging level. Normally, Splunk Enterprise runs with debug mode and token authentication turned off, as well as the <code class="language-plaintext highlighter-rouge">JsonWebToken</code> process configured at the INFO logging level. <br /><br />The vulnerability would require either local access to the log files or administrative access to internal indexes, which by default only the admin role receives. Review roles and capabilities on your instance and restrict internal index access to administrator-level roles. See <a href="https://docs.splunk.com/Documentation/Splunk/latest/Security/Rolesandcapabilities">Define roles on the Splunk platform with capabilities</a> in the Splunk documentation for more information.</p><h2 id="solution">Solution</h2><div><p data-renderer-start-pos="2009">There are multiple solutions depending on how you have configured the Splunk Enterprise instance.</p><p data-renderer-start-pos="2108">First, determine whether or not debug logging is on, either globally or for the <code class="code css-1o5d2cw" data-renderer-mark="true">JsonWebToken</code> component. You must log into the Splunk Enterprise instance as an admin user or equivalent to perform these actions.</p><ol class="ak-ol" start="1" data-indent-level="1"><li><p data-renderer-start-pos="2328">To determine the current global logging mode on the instance:</p><ol class="ak-ol" start="1" data-indent-level="2"><li><p data-renderer-start-pos="2393">In a web browser, visit the Server Logging Settings page in Splunk Web at <code class="code css-1o5d2cw" data-renderer-mark="true">/en-US/manager/system/server/logger</code>.</p></li><li><p data-renderer-start-pos="2536">Review the Logging Level column on the page that loads. If every row in this column shows DEBUG as the logging level, then the Splunk Enterprise instance is in debug mode. Otherwise, it is not in debug mode.</p></li></ol></li><li><p data-renderer-start-pos="2749">To determine the current logging level for the <code class="code css-1o5d2cw" data-renderer-mark="true">JsonWebToken</code> processor:</p><ol class="ak-ol" start="1" data-indent-level="2"><li><p data-renderer-start-pos="2830">In a web browser, search for the JsonWebToken processor configuration by visiting <code class="code css-1o5d2cw" data-renderer-mark="true">/en-US/manager/system/server/logger?search=JsonWebToken</code>.</p></li><li><p data-renderer-start-pos="2986">Review the Logging level column for the processor. If this row has a value of DEBUG, then the processor currently logs its activity at the DEBUG level.</p></li></ol></li></ol><p data-renderer-start-pos="3143">See <a class="css-tgpl01" title="https://docs.splunk.com/Documentation/Splunk/latest/Troubleshooting/Enabledebuglogging" href="https://docs.splunk.com/Documentation/Splunk/latest/Troubleshooting/Enabledebuglogging" data-testid="link-with-safety" data-renderer-mark="true">Enable debug logging</a> for more information.</p><p data-renderer-start-pos="3192">If either of these steps determines that debug logging is on, either globally or for the <code class="code css-1o5d2cw" data-renderer-mark="true">JsonWebToken</code> component, then remedy the problem by performing the following tasks:</p><ol class="ak-ol" start="1" data-indent-level="1"><li><p data-renderer-start-pos="3374">Upgrade Splunk Enterprise to versions 9.2.1, 9.1.4, 9.0.9, or higher.</p></li><li><p data-renderer-start-pos="3447">Delete the following log file on the Splunk Enterprise instance: <code class="code css-1o5d2cw" data-renderer-mark="true">$SPLUNK_HOME/var/log/splunk/splunkd.log</code></p></li><li><p data-renderer-start-pos="3555">Log into Splunk Web on the Splunk Enterprise instance and delete all log file events for the <code class="code css-1o5d2cw" data-renderer-mark="true">JsonWebToken</code> component from the _internal index by running the following search command:<br /> <code class="code css-1o5d2cw" data-renderer-mark="true">index=_internal component=JsonWebToken | delete</code><br />Note: The delete SPL command requires the can_delete role, which administrators do not receive by default. See <a class="css-tgpl01" title="https://docs.splunk.com/Documentation/Splunk/latest/SearchReference/Delete" href="https://docs.splunk.com/Documentation/Splunk/latest/SearchReference/Delete" data-testid="link-with-safety" data-renderer-mark="true">delete</a> for more info on the delete search command.</p></li><li><p data-renderer-start-pos="3958">While you are logged in, rotate any potentially exposed authentication tokens. See <a class="css-tgpl01" title="https://docs.splunk.com/Documentation/Splunk/latest/Security/ManageAuthTokens" href="https://docs.splunk.com/Documentation/Splunk/latest/Security/ManageAuthTokens" data-testid="link-with-safety" data-renderer-mark="true">Manage or delete authentication tokens</a> for more information.</p></li></ol></div><h2 id="product-status">Product Status</h2><div><table class="advisory-table" id="advisory-table"><thead class="advisory-th"><tr><th>Product</th><th>Version</th><th>Component</th><th>Affected Version</th><th>Fix Version</th></tr></thead><tbody><tr class="advisory-tr"><td class="advisory-td" label="Product">Splunk Enterprise</td><td class="advisory-td" label="Version">9.2</td><td class="advisory-td" label="Component"></td><td class="advisory-td" label="Affected Version">9.2.0 to 9.2.0.1</td><td class="advisory-td" label="Fix Version">9.2.1</td></tr><tr class="advisory-tr"><td class="advisory-td" label="Product">Splunk Enterprise</td><td class="advisory-td" label="Version">9.1</td><td class="advisory-td" label="Component"></td><td class="advisory-td" label="Affected Version">9.1.0 to 9.1.3</td><td class="advisory-td" label="Fix Version">9.1.4</td></tr><tr class="advisory-tr"><td class="advisory-td" label="Product">Splunk Enterprise</td><td class="advisory-td" label="Version">9.0</td><td class="advisory-td" label="Component"></td><td class="advisory-td" label="Affected Version">9.0.0 to 9.0.8</td><td class="advisory-td" label="Fix Version">9.0.9</td></tr></tbody></table></div><h2 id="mitigations-and-workarounds">Mitigations and Workarounds</h2><p>If it isn&rsquo;t currently possible to upgrade to a fixed version of Splunk Enterprise, you can remedy the vulnerability by doing the following:</p><ol class="ak-ol" start="1"><li><p>If the Splunk Enterprise instance runs in debug mode, turn it off. Restart the instance without using the <code>--debug</code> argument.</p></li><li><p>If you don&rsquo;t use tokens to authenticate users on the Splunk Enterprise instance and token authentication is on, turn it off. See <a href="http://docs.splunk.com/Documentation/Splunk/latest/Security/EnableTokenAuth">Enable or disable token authentication</a> for more information.</p></li><li><p>If the JsonWebToken component is at the DEBUG logging level, raise it to the INFO level.</p><ol class="ak-ol" start="1"><li><p>Log into Splunk Web on the Splunk Enterprise instance and visit the Server Logging page as described previously.</p></li><li><p>Select the JsonWebToken component, change its logging level to INFO, then select Save.</p></li></ol></li><li><p>View the <code>$SPLUNK_HOME/etc/log.cfg</code> logging configuration files and confirm that the JsonWebToken component is at the INFO logging level. Look for a line in the file that says <code>category.JsonWebToken=</code>. If it equals DEBUG, raise the logging level to INFO by doing the following:</p><ol class="ak-ol" start="1"><li><p>Edit the <code>$SPLUNK_HOME/etc/log.cfg</code> file.</p></li><li><p>Add the line <code>category.JsonWebToken=INFO</code> to this file.</p></li><li><p>Save the file.</p></li><li><p>Repeat Steps 4a-4c with the <code>log-local.cfg</code> file, if it exists.</p></li><li><p>Restart Splunk Enterprise for the changes to <code>log.cfg</code>or <code>log-local.cfg</code> to take effect. Note: Confirm that you do not use the <code>--debug</code> flag to restart Splunk Enterprise.</p></li></ol></li><li><p>Delete the following log file: <code>$SPLUNK_HOME/var/log/splunk/splunkd.log</code></p></li><li><p>Delete all the Splunk Enterprise log file events from the _internal index by running the following search command: <br /><div><code>index=_internal component=JsonWebToken | delete</code></div><br />Note: The delete command requires the can_delete role, which administrators do not receive by default. See <a href="https://docs.splunk.com/Documentation/Splunk/latest/SearchReference/Delete">delete</a> for more info on the delete search command.</p></li><li><p>While you are logged in, rotate any potentially exposed authentication tokens. See <a href="https://docs.splunk.com/Documentation/Splunk/latest/Security/ManageAuthTokens">Manage or delete authentication tokens</a> for more information.</p></li></ol><h2 id="detections">Detections</h2><ul><li><a href="https://research.splunk.com/application/9a67e749-d291-40dd-8376-d422e7ecf8b5">Splunk Authentication Token Exposure in Debug Log</a></li></ul><h2 id="severity">Severity</h2><div><p data-renderer-start-pos="6130">Splunk rates this vulnerability as informational, or falling between a 6.7, Medium, and a 7.2, High. The following scenarios affect the score:</p><ul class="ak-ul" data-indent-level="1"><li><p data-renderer-start-pos="6600">If token authentication is turned off, then the vulnerability does not affect this Splunk Enterprise instance and the advisory is Informational.</p></li><li><p data-renderer-start-pos="6404">If you limit access to the _internal index to holders of the admin role only, then the CVSS score lowers to 6.7, Medium, with a CVSSv3.1 vector of CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H.</p></li><li><p data-renderer-start-pos="6404">If admin users have provided lower-privilege users access to the _internal index, then the CVSS score would be 7.2, High, with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H.</p></li></ul></div><h2 id="acknowledgments">Acknowledgments</h2><p>Alex Napier, Splunk</p></div></div></section></article></div></div><div id="footer" class="page__footer"><footer><div class="page__footer-follow"><ul class="social-icons"><li><a href="mailto:prodsec@splunk.com" rel="nofollow noopener noreferrer" class="advisory-icon-a"><i class="fa-regular fa-envelope advisory-icon-i"></i> Email</a></li><li><a href="/feed.xml" rel="nofollow noopener noreferrer" class="advisory-icon-a"><i class="fa-solid fa-rss advisory-icon-i"></i> RSS Feed</a></li><li><a href="https://login.splunk.com/page/sso_redirect?type=portal" rel="nofollow noopener noreferrer" class="advisory-icon-a"><i class="fa-solid fa-link advisory-icon-i"></i> Support</a></li></ul></div><div class="page__footer-copyright">&copy; 2005 - 2025 Splunk Inc. All rights reserved.</div><div class="page__footer-links"><a href="https://www.splunk.com/en_us/legal.html" rel="nofollow noopener noreferrer">Legal</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://www.splunk.com/en_us/legal/privacy/privacy-policy.html" rel="nofollow noopener noreferrer">Privacy<a/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://www.splunk.com/en_us/legal/terms/terms-of-use.html" rel="nofollow noopener noreferrer">Website Terms of Use<a/></div></footer></div></body></html>
