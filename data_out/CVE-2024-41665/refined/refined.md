- **Root cause of vulnerability:** Insufficient filtering of the `$title` variable in the `/public/templates/show_box_top.inc.php` file.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS). The application does not properly sanitize user input before displaying it, allowing an attacker to inject malicious scripts into the page.
- **Impact of exploitation:** An attacker with Content Manager permissions can inject malicious scripts that will be executed in the context of other users (including administrators) who access the democratic.php functionality. This can lead to session hijacking by stealing cookies, and potentially further compromise the application or user accounts.
- **Attack vectors:** The attacker crafts a malicious payload (e.g., `<svg onload=alert(8)>`) in the "Name" field when creating or configuring a democratic playlist. This payload is stored in the application's database. When a user or administrator accesses the Democratic functionality, the payload is rendered, causing the malicious script to execute.
- **Required attacker capabilities/position:** The attacker needs to have Content Manager permissions within the application to create or modify democratic playlists. The attacker needs to send a crafted POST request.