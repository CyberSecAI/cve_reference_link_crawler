
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSafeBreach-Labs%2FMagicDot)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSafeBreach-Labs%2FMagicDot)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=SafeBreach-Labs%2FMagicDot)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[SafeBreach-Labs](/SafeBreach-Labs)
/
**[MagicDot](/SafeBreach-Labs/MagicDot)**
Public

* [Notifications](/login?return_to=%2FSafeBreach-Labs%2FMagicDot) You must be signed in to change notification settings
* [Fork
  16](/login?return_to=%2FSafeBreach-Labs%2FMagicDot)
* [Star
   96](/login?return_to=%2FSafeBreach-Labs%2FMagicDot)

A set of rootkit-like abilities for unprivileged users, and vulnerabilities based on the DOT-to-NT path conversion known issue

### License

[BSD-3-Clause license](/SafeBreach-Labs/MagicDot/blob/main/LICENSE)

[96
stars](/SafeBreach-Labs/MagicDot/stargazers) [16
forks](/SafeBreach-Labs/MagicDot/forks) [Branches](/SafeBreach-Labs/MagicDot/branches) [Tags](/SafeBreach-Labs/MagicDot/tags) [Activity](/SafeBreach-Labs/MagicDot/activity)
 [Star](/login?return_to=%2FSafeBreach-Labs%2FMagicDot)

 [Notifications](/login?return_to=%2FSafeBreach-Labs%2FMagicDot) You must be signed in to change notification settings

* [Code](/SafeBreach-Labs/MagicDot)
* [Issues
  0](/SafeBreach-Labs/MagicDot/issues)
* [Pull requests
  0](/SafeBreach-Labs/MagicDot/pulls)
* [Actions](/SafeBreach-Labs/MagicDot/actions)
* [Projects
  0](/SafeBreach-Labs/MagicDot/projects)
* [Security](/SafeBreach-Labs/MagicDot/security)
* [Insights](/SafeBreach-Labs/MagicDot/pulse)

Additional navigation options

* [Code](/SafeBreach-Labs/MagicDot)
* [Issues](/SafeBreach-Labs/MagicDot/issues)
* [Pull requests](/SafeBreach-Labs/MagicDot/pulls)
* [Actions](/SafeBreach-Labs/MagicDot/actions)
* [Projects](/SafeBreach-Labs/MagicDot/projects)
* [Security](/SafeBreach-Labs/MagicDot/security)
* [Insights](/SafeBreach-Labs/MagicDot/pulse)

# SafeBreach-Labs/MagicDot

    main[Branches](/SafeBreach-Labs/MagicDot/branches)[Tags](/SafeBreach-Labs/MagicDot/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[26 Commits](/SafeBreach-Labs/MagicDot/commits/main/) | | |
| [images](/SafeBreach-Labs/MagicDot/tree/main/images "images") | | [images](/SafeBreach-Labs/MagicDot/tree/main/images "images") |  |  |
| [src/magic\_dot](/SafeBreach-Labs/MagicDot/tree/main/src/magic_dot "This path skips through empty directories") | | [src/magic\_dot](/SafeBreach-Labs/MagicDot/tree/main/src/magic_dot "This path skips through empty directories") |  |  |
| [tools](/SafeBreach-Labs/MagicDot/tree/main/tools "tools") | | [tools](/SafeBreach-Labs/MagicDot/tree/main/tools "tools") |  |  |
| [.gitignore](/SafeBreach-Labs/MagicDot/blob/main/.gitignore ".gitignore") | | [.gitignore](/SafeBreach-Labs/MagicDot/blob/main/.gitignore ".gitignore") |  |  |
| [LICENSE](/SafeBreach-Labs/MagicDot/blob/main/LICENSE "LICENSE") | | [LICENSE](/SafeBreach-Labs/MagicDot/blob/main/LICENSE "LICENSE") |  |  |
| [README.md](/SafeBreach-Labs/MagicDot/blob/main/README.md "README.md") | | [README.md](/SafeBreach-Labs/MagicDot/blob/main/README.md "README.md") |  |  |
| [requirements.txt](/SafeBreach-Labs/MagicDot/blob/main/requirements.txt "requirements.txt") | | [requirements.txt](/SafeBreach-Labs/MagicDot/blob/main/requirements.txt "requirements.txt") |  |  |
| [setup.py](/SafeBreach-Labs/MagicDot/blob/main/setup.py "setup.py") | | [setup.py](/SafeBreach-Labs/MagicDot/blob/main/setup.py "setup.py") |  |  |
| View all files | | |

## Repository files navigation

* README
* BSD-3-Clause license
# MagicDot

A set of rootkit-like abilities for unprivileged users, and vulnerabilities based on the DOT-to-NT path conversion known issue.

Presented at Black Hat Asia 2024 under the title - [**MagicDot: A Hacker's Magic Show of Disappearing Dots and Spaces**](https://www.blackhat.com/asia-24/briefings/schedule/#magicdot-a-hackers-magic-show-of-disappearing-dots-and-spaces-36561)

For a deeper understanding of the research, read this blog post - [**MagicDot: A Hacker's Magic Show of Disappearing Dots and Spaces**](https://www.safebreach.com/blog/magicdot-a-hackers-magic-show-of-disappearing-dots-and-spaces/)

[![](/SafeBreach-Labs/MagicDot/raw/main/images/magician-w-md-logo-KO-white.png)](/SafeBreach-Labs/MagicDot/blob/main/images/magician-w-md-logo-KO-white.png)

## MagicDot Python Package

Implements MagicDot's rootkit-like techniques:

* Files/Directories named with dots only
  + Bonus - Such Directories prevent any shadow copy restoration of any parent directory of the inoperable directory
* Inoperable Files/Directories
* Impersonated Files/Directories
* Impersonated Process
* Process Explorer DoS Vulnerability - `CVE-2023-42757`
* Hidden files in ZIP archives

### MagicDot Python Package Installation

1. Clone the repo
2. Install it locally:

```
pip install <cloned repo path>

```

## MagicDot Tools

Inside the `tools` folder you'll find the `magic_dot_cli` tool (dependent on the MagicDot Python package) along with 3 different solo scripts that implement the exploits for vulnerabilities `CVE-2023-36396`, `CVE-2023-32054`, and a third unfixed Deletion EoP vulnerability. During the installation of the MagicDot Python package, the requirements for these scripts are installed as well.

For convenience purposes, it is recommended to pack magic\_dot\_cli into an executable using Pyinstaller:

```
cd tools\magic_dot_cli\
pyinstaller --onefile magic_dot_cli.py

```

### magic\_dot\_cli Usage

```
python .\magic_dot_cli.py -h
usage: magic_dot_cli.py [-h]
                        {CREATE_IMPERSONATED_PROCESS,CREATE_INOPERABLE_FILE,CREATE_INOPERABLE_DIR,CREATE_DOTS_FILE,CREATE_DOTS_DIR,CREATE_IMPERSONATED_FILE,CREATE_IMPERSONATED_DIR,ADD_INVISIBLE_FILE_INTO_ZIP,DISABLE_PROCEXP}
                        ...

An unprivileged rootkit-like tool

optional arguments:
  -h, --help            show this help message and exit

command:
  {CREATE_IMPERSONATED_PROCESS,CREATE_INOPERABLE_FILE,CREATE_INOPERABLE_DIR,CREATE_DOTS_FILE,CREATE_DOTS_DIR,CREATE_IMPERSONATED_FILE,CREATE_IMPERSONATED_DIR,ADD_INVISIBLE_FILE_INTO_ZIP,DISABLE_PROCEXP}
    CREATE_IMPERSONATED_PROCESS
                        Create a process that impersonates a different process. Both Task Manager and Process Explorer will display
                        information about the target process to impersonate to
    CREATE_INOPERABLE_FILE
                        Create an inoperable file
    CREATE_INOPERABLE_DIR
                        Create an inoperable directory
    CREATE_DOTS_FILE    Create a dots file
    CREATE_DOTS_DIR     Create a dots directory
    CREATE_IMPERSONATED_FILE
                        Create a file that impersonates a different file
    CREATE_IMPERSONATED_DIR
                        Create a directory that impersonates a different directory
    ADD_INVISIBLE_FILE_INTO_ZIP
                        Inserts a file into a zip. The file is inserted with a name that prevents Windows' ZIP archiver from being
                        able to list it in the ZIP.
    DISABLE_PROCEXP     Exploits a DOS vulnerability in ProcExp. Creates a process that runs forever and does nothing. The process
                        has a certain name that crashes ProcExp whenever it runs. Valid against all ProcExp versions under version
                        17.04 (released in April 3rd 2023).

```

For more help per each command use `-h` for the specific command. For Example:

```
python magic_dot_cli.py CREATE_IMPERSONATED_PROCESS -h

```

### prepare\_archive\_rce\_exploit Usage (CVE-2023-36396)

```
python prepare_archive_rce_exploit.py -h
usage: prepare_archive_rce_exploit.py [-h] [--target-dir-relative TARGET_DIR_RELATIVE]
                                      files_to_write_paths [files_to_write_paths ...]
                                      out_archive_path

Exploits CVE-2023-36396. Crafts a malicious archive that exploits Windows File Explorer
to extract a file to an arbitrary relative path. The default relative path is set to
point from the Downloads directory to the user's Startup folder

positional arguments:
  files_to_write_paths  File paths separated by spaces. These files are the files which
                        will be written to the chosen victim's directory
  out_archive_path      Path to the archive to be created that will contain the exploit.
                        the type of the archive will be determined based on the file
                        extension provided. Supported types: .tar|.tar.gz|.tar.gzip|.tar
                        .xz|.tar.bz2|.tar.bzip2|.tar.zst|.tar.zstd|.7z|.7zip

optional arguments:
  -h, --help            show this help message and exit
  --target-dir-relative TARGET_DIR_RELATIVE
                        A relative path from the victim's estimated extraction folder to
                        the destination folder of the executables

```

### prepare\_shadow\_copy\_restoration\_write\_exploit Usage (CVE-2023-32054)

```
python .\prepare_shadow_copy_restoration_write_exploit.py -h
usage: prepare_shadow_copy_restoration_write_exploit.py [-h] -target-dir TARGET_DIR
                                                        (-replacing-dir REPLACING_DIR | -remove-dir)

Exploits CVE-2023-32054

optional arguments:
  -h, --help            show this help message and exit
  -target-dir TARGET_DIR
                        The target directory to try to overwrite its files. The
                        directory is vulnerable if an unprivileged user is allowed to
                        create a new directory its parent directory
  -replacing-dir REPLACING_DIR
                        The directory that contains files with the same names in the
                        same structure of the target dir but with the new desired
                        content
  -remove-dir           Delete the directory created a part of the exploit in an
                        earlier point in time. This is recommended to be done after a
                        shadow copy was taken by an admin, while the directory
                        existed

```

### prepare\_delete\_dir\_exploit Usage

```
python prepare_delete_dir_exploit.py -h
usage: prepare_delete_dir_exploit.py [-h] target_dir

Exploits a "won't fixed" deletion EoP vulnerability triggered by a privileged user
interaction. Creates a directory called "... " in a target directory to delete. When
"... " is deleted, then its parent directory is deleted too.

positional arguments:
  target_dir  The target directory to try to delete. It is vulnerable only if you can
              create a directory inside it.

optional arguments:
  -h, --help  show this help message and exit

```

## About

A set of rootkit-like abilities for unprivileged users, and vulnerabilities based on the DOT-to-NT path conversion known issue

### Resources

[Readme](#readme-ov-file)
### License

[BSD-3-Clause license](#BSD-3-Clause-1-ov-file)

[Activity](/SafeBreach-Labs/MagicDot/activity)
[Custom properties](/SafeBreach-Labs/MagicDot/custom-properties)
### Stars

[**96**
stars](/SafeBreach-Labs/MagicDot/stargazers)
### Watchers

[**2**
watching](/SafeBreach-Labs/MagicDot/watchers)
### Forks

[**16**
forks](/SafeBreach-Labs/MagicDot/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FSafeBreach-Labs%2FMagicDot&report=SafeBreach-Labs+%28user%29)

## [Releases](/SafeBreach-Labs/MagicDot/releases)

No releases published

## [Packages 0](/orgs/SafeBreach-Labs/packages?repo_name=MagicDot)

No packages published

## Languages

* [Python
  65.2%](/SafeBreach-Labs/MagicDot/search?l=python)
* [C
  34.8%](/SafeBreach-Labs/MagicDot/search?l=c)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

