

[Log in](/login.jsp?os_destination=%2Fbrowse%2FSERVER-51083)[Skip to main content](#main)[Skip to sidebar](#sidebar)[![MongoDB Jira](/s/ub562g/9160001/fy41z4/_/jira-logo-scaled.png)](https://jira.mongodb.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")
* [eazyBI](/plugins/servlet/eazybi)

* Give feedback to Atlassian
* [Help](/secure/ViewKeyboardShortcuts%21default.jspa "Help")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FSERVER-51083)
  + [Acknowledged notifications](/plugins/servlet/wittified/profile/notifications)

![Uploaded image for project: 'Core Server'](https://jira.mongodb.org/secure/projectavatar?pid=10000&avatarId=13900)

1. [Core Server](/browse/SERVER)
2. [SERVER-51083](/browse/SERVER-51083)

## Problem with regex index bounds

Schedule Issue[Undo Transition](/secure/UndoTransition%21default.jspa?id=1482605)ClosedExportnullXMLWordPrintableJSON
### Details

* **Type:**
  ![Icon: Bug](/secure/viewavatar?size=xsmall&avatarId=14703&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![Icon: Critical - P2](/images/icons/priorities/critical.svg "Critical - P2 - Crashes, loss of data, severe memory leak.") Critical - P2
* **Fix Version/s:**
  [4.0.21](/issues/?jql=project+%3D+SERVER+AND+fixVersion+%3D+4.0.21 "4.0.21 "), [3.6.21](/issues/?jql=project+%3D+SERVER+AND+fixVersion+%3D+3.6.21 "3.6.21 ")
* **Affects Version/s:**
  4.0.20
* **Component/s:**
  [Querying](/issues/?jql=project+%3D+SERVER+AND+component+%3D+Querying "Querying ")
* **Labels:**
  + [qopt-team](/issues/?jql=labels+%3D+qopt-team "qopt-team")

* **Backwards Compatibility:**
  Fully Compatible
* **Operating System:**
  ALL
* **Sprint:**
  Query 2020-10-19
* **Linked BF Score:**
  50

### Description

**CVE ID:** CVE-2020-7929

**Title:** Specially crafted regex query can cause DoS

**Description:**  A user authorized to perform database queries may trigger denial of service by issuing specially crafted query contain a type of regex. This issue affects: MongoDB Inc.

MongoDB Server v3.6 versions prior to 3.6.21 and MongoDB Server v4.0 versions prior to 4.0.20;

**CVSS score:** 6.5 ([https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H&version=3.1)](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H&version=3.1)

**Affected products and versions:**

MongoDB Server v3.6 versions prior to 3.6.21

MongoDB Server v4.0 versions prior to 4.0.20

**CWE ID**: CWE-185: Incorrect Regular Expression

### Attachments

### Issue Links

is related to

![Task - A task that needs to be done.](/secure/viewavatar?size=xsmall&avatarId=14718&avatarType=issuetype "Task - A task that needs to be done.")
[SERVER-12204](/browse/SERVER-12204)
Buffer::readUTF8String in bson\_validate.cpp should validate utf8

* ![Major - P3 - Major loss of function.](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.")
* Closed

![Improvement - An improvement or enhancement to an existing feature or task.](/secure/viewavatar?size=xsmall&avatarId=14710&avatarType=issuetype "Improvement - An improvement or enhancement to an existing feature or task.")
[SERVER-39697](/browse/SERVER-39697)
Regex MatchExpression should error at parse time if the regex is not valid

* ![Major - P3 - Major loss of function.](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.")
* Closed

### Activity

### People

Assignee:
![jacob.evans@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=10122)
Jacob Evans

Reporter:
![david.storch@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=10122)
David Storch

Participants:

[David Storch](/secure/IssueNavigator.jspa?reset=true&customfield_10051=david.storch%40mongodb.com "Find all issues David Storch participated in"), [Githook User](/secure/IssueNavigator.jspa?reset=true&customfield_10051=xgen-internal-githook "Find all issues Githook User participated in"), [Jacob Evans](/secure/IssueNavigator.jspa?reset=true&customfield_10051=jacob.evans%40mongodb.com "Find all issues Jacob Evans participated in")

Votes:
0
Vote for this issue

Watchers:
9
Start watching this issue

### Dates

Created:

Sep 21 2020 11:44:20 PM UTC

Updated:

Oct 29 2023 10:02:53 PM UTC

Resolved:

Oct 15 2020 12:40:42 AM UTC

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for MongoDB. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

