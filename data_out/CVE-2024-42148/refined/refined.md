{
  "vulnerability": {
    "root_cause": "The `stats_query_entry query` array within the `bnx2x_fw_stats_req` struct in `drivers/net/ethernet/broadcom/bnx2x/bnx2x.h` was not sized correctly to accommodate the larger number of queues supported by E2 NICs. The array size was based on `FP_SB_MAX_E1x`, which represents the maximum number of fast path interrupts for E1x NICs, instead of using `FP_SB_MAX_E2` for E2 NICs. This oversight led to out-of-bounds access when the driver was used with E2 NICs configured with a high number of queues.",
    "weaknesses": [
      "Array-index-out-of-bounds vulnerability due to incorrect array sizing",
       "Use of a fixed size array for a variable number of queues"
    ],
    "impact": "When a system with 32 or more physical CPU cores is used with an E2 NIC, or when the user defines a number of Ethernet queues greater than or equal to `FP_SB_MAX_E1x`, out-of-bounds memory access occurs, leading to a crash of the kernel and denial of service. This is evident from the UBSAN stack traces provided.",
    "attack_vectors": [
      "Using systems with E2 NICs that have more cores than E1x",
      "Setting the 'num_queues' module parameter to a value that exceeds FP_SB_MAX_E1x on E2 NICs"
    ],
    "required_attacker_capabilities": "The attacker needs to be able to load the bnx2x kernel module, or the system is already running the vulnerable code. The attacker can set the `num_queues` parameter when loading the module.",
     "additional_information": "The issue was an oversight when the driver was updated to support E2 NICs. The fix replaces `FP_SB_MAX_E1x` with `FP_SB_MAX_E2` in the definition of `stats_query_entry query` array size."
  }
}