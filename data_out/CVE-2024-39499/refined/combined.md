=== Content from git.kernel.org_a72ae443_20250111_172824.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=757804e1c599af5d2a7f864c8e8b2842406ff4bb)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=757804e1c599af5d2a7f864c8e8b2842406ff4bb)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=757804e1c599af5d2a7f864c8e8b2842406ff4bb)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=757804e1c599af5d2a7f864c8e8b2842406ff4bb)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hagar Gamal Halim Hemdan <hagarhem@amazon.com> | 2024-04-30 08:59:16 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-21 14:40:33 +0200 |
| commit | [757804e1c599af5d2a7f864c8e8b2842406ff4bb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=757804e1c599af5d2a7f864c8e8b2842406ff4bb) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=757804e1c599af5d2a7f864c8e8b2842406ff4bb)) | |
| tree | [37d368fd24275198262d02df449499cb9a5f5803](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=757804e1c599af5d2a7f864c8e8b2842406ff4bb) | |
| parent | [0c1f6e1418297c44e91ecab6e309d2cf4cdd9461](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0c1f6e1418297c44e91ecab6e309d2cf4cdd9461) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=757804e1c599af5d2a7f864c8e8b2842406ff4bb&id2=0c1f6e1418297c44e91ecab6e309d2cf4cdd9461)) | |
| download | [linux-757804e1c599af5d2a7f864c8e8b2842406ff4bb.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-757804e1c599af5d2a7f864c8e8b2842406ff4bb.tar.gz) | |

vmci: prevent speculation leaks by sanitizing event in event\_deliver()commit 8003f00d895310d409b2bf9ef907c56b42a4e0f4 upstream.
Coverity spotted that event\_msg is controlled by user-space,
event\_msg->event\_data.event is passed to event\_deliver() and used
as an index without sanitization.
This change ensures that the event index is sanitized to mitigate any
possibility of speculative information leaks.
This bug was discovered and resolved using Coverity Static Analysis
Security Testing (SAST) by Synopsys, Inc.
Only compile tested, no access to HW.
Fixes: 1d990201f9bb ("VMCI: event handling implementation.")
Cc: stable <stable@kernel.org>
Signed-off-by: Hagar Gamal Halim Hemdan <hagarhem@amazon.com>
Link: <https://lore.kernel.org/stable/20231127193533.46174-1-hagarhem%40amazon.com>
Link: [https://lore.kernel.org/r/20240430085916.4753-1-hagarhem@amazon.com](https://lore.kernel.org/r/20240430085916.4753-1-hagarhem%40amazon.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=757804e1c599af5d2a7f864c8e8b2842406ff4bb)

| -rw-r--r-- | [drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/misc/vmw_vmci/vmci_event.c?id=757804e1c599af5d2a7f864c8e8b2842406ff4bb) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/drivers/misc/vmw\_vmci/vmci\_event.c b/drivers/misc/vmw\_vmci/vmci\_event.cindex 5d7ac07623c273..9a41ab65378de0 100644--- a/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=0c1f6e1418297c44e91ecab6e309d2cf4cdd9461)+++ b/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=757804e1c599af5d2a7f864c8e8b2842406ff4bb)@@ -9,6 +9,7 @@ #include <linux/vmw\_vmci\_api.h> #include <linux/list.h> #include <linux/module.h>+#include <linux/nospec.h> #include <linux/sched.h> #include <linux/slab.h> #include <linux/rculist.h>@@ -86,9 +87,12 @@ static void event\_deliver(struct vmci\_event\_msg \*event\_msg) { struct vmci\_subscription \*cur; struct list\_head \*subscriber\_list;+ u32 sanitized\_event, max\_vmci\_event;  rcu\_read\_lock();- subscriber\_list = &subscriber\_array[event\_msg->event\_data.event];+ max\_vmci\_event = ARRAY\_SIZE(subscriber\_array);+ sanitized\_event = array\_index\_nospec(event\_msg->event\_data.event, max\_vmci\_event);+ subscriber\_list = &subscriber\_array[sanitized\_event]; list\_for\_each\_entry\_rcu(cur, subscriber\_list, node) { cur->callback(cur->id, &event\_msg->event\_data, cur->callback\_data); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:27:01 +0000



=== Content from git.kernel.org_f30072a3_20250111_172825.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=95ac3e773a1f8da83c4710a720fbfe80055aafae)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=95ac3e773a1f8da83c4710a720fbfe80055aafae)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=95ac3e773a1f8da83c4710a720fbfe80055aafae)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=95ac3e773a1f8da83c4710a720fbfe80055aafae)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hagar Gamal Halim Hemdan <hagarhem@amazon.com> | 2024-04-30 08:59:16 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-07-05 09:14:20 +0200 |
| commit | [95ac3e773a1f8da83c4710a720fbfe80055aafae](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=95ac3e773a1f8da83c4710a720fbfe80055aafae) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=95ac3e773a1f8da83c4710a720fbfe80055aafae)) | |
| tree | [2208e70a0044d43cbaebad24d7be76c9d0289c55](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=95ac3e773a1f8da83c4710a720fbfe80055aafae) | |
| parent | [4959ffc65a0e94f8acaac20deac49f89e6ded52d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4959ffc65a0e94f8acaac20deac49f89e6ded52d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=95ac3e773a1f8da83c4710a720fbfe80055aafae&id2=4959ffc65a0e94f8acaac20deac49f89e6ded52d)) | |
| download | [linux-95ac3e773a1f8da83c4710a720fbfe80055aafae.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-95ac3e773a1f8da83c4710a720fbfe80055aafae.tar.gz) | |

vmci: prevent speculation leaks by sanitizing event in event\_deliver()commit 8003f00d895310d409b2bf9ef907c56b42a4e0f4 upstream.
Coverity spotted that event\_msg is controlled by user-space,
event\_msg->event\_data.event is passed to event\_deliver() and used
as an index without sanitization.
This change ensures that the event index is sanitized to mitigate any
possibility of speculative information leaks.
This bug was discovered and resolved using Coverity Static Analysis
Security Testing (SAST) by Synopsys, Inc.
Only compile tested, no access to HW.
Fixes: 1d990201f9bb ("VMCI: event handling implementation.")
Cc: stable <stable@kernel.org>
Signed-off-by: Hagar Gamal Halim Hemdan <hagarhem@amazon.com>
Link: <https://lore.kernel.org/stable/20231127193533.46174-1-hagarhem%40amazon.com>
Link: [https://lore.kernel.org/r/20240430085916.4753-1-hagarhem@amazon.com](https://lore.kernel.org/r/20240430085916.4753-1-hagarhem%40amazon.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=95ac3e773a1f8da83c4710a720fbfe80055aafae)

| -rw-r--r-- | [drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/misc/vmw_vmci/vmci_event.c?id=95ac3e773a1f8da83c4710a720fbfe80055aafae) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/drivers/misc/vmw\_vmci/vmci\_event.c b/drivers/misc/vmw\_vmci/vmci\_event.cindex e3436abf39f458..5b7ef47f4c1186 100644--- a/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=4959ffc65a0e94f8acaac20deac49f89e6ded52d)+++ b/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=95ac3e773a1f8da83c4710a720fbfe80055aafae)@@ -9,6 +9,7 @@ #include <linux/vmw\_vmci\_api.h> #include <linux/list.h> #include <linux/module.h>+#include <linux/nospec.h> #include <linux/sched.h> #include <linux/slab.h> #include <linux/rculist.h>@@ -86,9 +87,12 @@ static void event\_deliver(struct vmci\_event\_msg \*event\_msg) { struct vmci\_subscription \*cur; struct list\_head \*subscriber\_list;+ u32 sanitized\_event, max\_vmci\_event;  rcu\_read\_lock();- subscriber\_list = &subscriber\_array[event\_msg->event\_data.event];+ max\_vmci\_event = ARRAY\_SIZE(subscriber\_array);+ sanitized\_event = array\_index\_nospec(event\_msg->event\_data.event, max\_vmci\_event);+ subscriber\_list = &subscriber\_array[sanitized\_event]; list\_for\_each\_entry\_rcu(cur, subscriber\_list, node) { cur->callback(cur->id, &event\_msg->event\_data, cur->callback\_data); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:27:02 +0000



=== Content from git.kernel.org_5971cfc4_20250111_172826.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e293c6b38ac9029d76ff0d2a6b2d74131709a9a8)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e293c6b38ac9029d76ff0d2a6b2d74131709a9a8)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e293c6b38ac9029d76ff0d2a6b2d74131709a9a8)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e293c6b38ac9029d76ff0d2a6b2d74131709a9a8)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hagar Gamal Halim Hemdan <hagarhem@amazon.com> | 2024-04-30 08:59:16 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-21 14:38:40 +0200 |
| commit | [e293c6b38ac9029d76ff0d2a6b2d74131709a9a8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e293c6b38ac9029d76ff0d2a6b2d74131709a9a8) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e293c6b38ac9029d76ff0d2a6b2d74131709a9a8)) | |
| tree | [c7dd8b5f3af398c65084d4b546ec3a003df6cf35](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e293c6b38ac9029d76ff0d2a6b2d74131709a9a8) | |
| parent | [2d11505e79c7c4191e9f117da3a058d7f24c4189](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2d11505e79c7c4191e9f117da3a058d7f24c4189) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e293c6b38ac9029d76ff0d2a6b2d74131709a9a8&id2=2d11505e79c7c4191e9f117da3a058d7f24c4189)) | |
| download | [linux-e293c6b38ac9029d76ff0d2a6b2d74131709a9a8.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e293c6b38ac9029d76ff0d2a6b2d74131709a9a8.tar.gz) | |

vmci: prevent speculation leaks by sanitizing event in event\_deliver()commit 8003f00d895310d409b2bf9ef907c56b42a4e0f4 upstream.
Coverity spotted that event\_msg is controlled by user-space,
event\_msg->event\_data.event is passed to event\_deliver() and used
as an index without sanitization.
This change ensures that the event index is sanitized to mitigate any
possibility of speculative information leaks.
This bug was discovered and resolved using Coverity Static Analysis
Security Testing (SAST) by Synopsys, Inc.
Only compile tested, no access to HW.
Fixes: 1d990201f9bb ("VMCI: event handling implementation.")
Cc: stable <stable@kernel.org>
Signed-off-by: Hagar Gamal Halim Hemdan <hagarhem@amazon.com>
Link: <https://lore.kernel.org/stable/20231127193533.46174-1-hagarhem%40amazon.com>
Link: [https://lore.kernel.org/r/20240430085916.4753-1-hagarhem@amazon.com](https://lore.kernel.org/r/20240430085916.4753-1-hagarhem%40amazon.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e293c6b38ac9029d76ff0d2a6b2d74131709a9a8)

| -rw-r--r-- | [drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/misc/vmw_vmci/vmci_event.c?id=e293c6b38ac9029d76ff0d2a6b2d74131709a9a8) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/drivers/misc/vmw\_vmci/vmci\_event.c b/drivers/misc/vmw\_vmci/vmci\_event.cindex 5d7ac07623c273..9a41ab65378de0 100644--- a/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=2d11505e79c7c4191e9f117da3a058d7f24c4189)+++ b/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=e293c6b38ac9029d76ff0d2a6b2d74131709a9a8)@@ -9,6 +9,7 @@ #include <linux/vmw\_vmci\_api.h> #include <linux/list.h> #include <linux/module.h>+#include <linux/nospec.h> #include <linux/sched.h> #include <linux/slab.h> #include <linux/rculist.h>@@ -86,9 +87,12 @@ static void event\_deliver(struct vmci\_event\_msg \*event\_msg) { struct vmci\_subscription \*cur; struct list\_head \*subscriber\_list;+ u32 sanitized\_event, max\_vmci\_event;  rcu\_read\_lock();- subscriber\_list = &subscriber\_array[event\_msg->event\_data.event];+ max\_vmci\_event = ARRAY\_SIZE(subscriber\_array);+ sanitized\_event = array\_index\_nospec(event\_msg->event\_data.event, max\_vmci\_event);+ subscriber\_list = &subscriber\_array[sanitized\_event]; list\_for\_each\_entry\_rcu(cur, subscriber\_list, node) { cur->callback(cur->id, &event\_msg->event\_data, cur->callback\_data); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:27:03 +0000



=== Content from git.kernel.org_d608af4d_20250111_172827.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f70ff737346744633e7b655c1fb23e1578491ff3)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f70ff737346744633e7b655c1fb23e1578491ff3)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f70ff737346744633e7b655c1fb23e1578491ff3)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f70ff737346744633e7b655c1fb23e1578491ff3)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hagar Gamal Halim Hemdan <hagarhem@amazon.com> | 2024-04-30 08:59:16 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-07-05 09:12:30 +0200 |
| commit | [f70ff737346744633e7b655c1fb23e1578491ff3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f70ff737346744633e7b655c1fb23e1578491ff3) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f70ff737346744633e7b655c1fb23e1578491ff3)) | |
| tree | [cbdf0bc47ed486eb4dccbbac7ccd488443b995c3](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f70ff737346744633e7b655c1fb23e1578491ff3) | |
| parent | [4dfffb50316c761c59386c9b002a10ac6d7bb6c9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4dfffb50316c761c59386c9b002a10ac6d7bb6c9) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f70ff737346744633e7b655c1fb23e1578491ff3&id2=4dfffb50316c761c59386c9b002a10ac6d7bb6c9)) | |
| download | [linux-f70ff737346744633e7b655c1fb23e1578491ff3.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f70ff737346744633e7b655c1fb23e1578491ff3.tar.gz) | |

vmci: prevent speculation leaks by sanitizing event in event\_deliver()commit 8003f00d895310d409b2bf9ef907c56b42a4e0f4 upstream.
Coverity spotted that event\_msg is controlled by user-space,
event\_msg->event\_data.event is passed to event\_deliver() and used
as an index without sanitization.
This change ensures that the event index is sanitized to mitigate any
possibility of speculative information leaks.
This bug was discovered and resolved using Coverity Static Analysis
Security Testing (SAST) by Synopsys, Inc.
Only compile tested, no access to HW.
Fixes: 1d990201f9bb ("VMCI: event handling implementation.")
Cc: stable <stable@kernel.org>
Signed-off-by: Hagar Gamal Halim Hemdan <hagarhem@amazon.com>
Link: <https://lore.kernel.org/stable/20231127193533.46174-1-hagarhem%40amazon.com>
Link: [https://lore.kernel.org/r/20240430085916.4753-1-hagarhem@amazon.com](https://lore.kernel.org/r/20240430085916.4753-1-hagarhem%40amazon.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f70ff737346744633e7b655c1fb23e1578491ff3)

| -rw-r--r-- | [drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/misc/vmw_vmci/vmci_event.c?id=f70ff737346744633e7b655c1fb23e1578491ff3) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/drivers/misc/vmw\_vmci/vmci\_event.c b/drivers/misc/vmw\_vmci/vmci\_event.cindex e3436abf39f458..5b7ef47f4c1186 100644--- a/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=4dfffb50316c761c59386c9b002a10ac6d7bb6c9)+++ b/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=f70ff737346744633e7b655c1fb23e1578491ff3)@@ -9,6 +9,7 @@ #include <linux/vmw\_vmci\_api.h> #include <linux/list.h> #include <linux/module.h>+#include <linux/nospec.h> #include <linux/sched.h> #include <linux/slab.h> #include <linux/rculist.h>@@ -86,9 +87,12 @@ static void event\_deliver(struct vmci\_event\_msg \*event\_msg) { struct vmci\_subscription \*cur; struct list\_head \*subscriber\_list;+ u32 sanitized\_event, max\_vmci\_event;  rcu\_read\_lock();- subscriber\_list = &subscriber\_array[event\_msg->event\_data.event];+ max\_vmci\_event = ARRAY\_SIZE(subscriber\_array);+ sanitized\_event = array\_index\_nospec(event\_msg->event\_data.event, max\_vmci\_event);+ subscriber\_list = &subscriber\_array[sanitized\_event]; list\_for\_each\_entry\_rcu(cur, subscriber\_list, node) { cur->callback(cur->id, &event\_msg->event\_data, cur->callback\_data); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:27:04 +0000



=== Content from git.kernel.org_813b489e_20250111_172823.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=58730dfbd4ae01c1b022b0d234a8bf8c02cdfb81)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=58730dfbd4ae01c1b022b0d234a8bf8c02cdfb81)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=58730dfbd4ae01c1b022b0d234a8bf8c02cdfb81)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=58730dfbd4ae01c1b022b0d234a8bf8c02cdfb81)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hagar Gamal Halim Hemdan <hagarhem@amazon.com> | 2024-04-30 08:59:16 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-07-05 09:00:24 +0200 |
| commit | [58730dfbd4ae01c1b022b0d234a8bf8c02cdfb81](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=58730dfbd4ae01c1b022b0d234a8bf8c02cdfb81) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=58730dfbd4ae01c1b022b0d234a8bf8c02cdfb81)) | |
| tree | [e9ba821c51068ecac2438256e757be75a433ed6e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=58730dfbd4ae01c1b022b0d234a8bf8c02cdfb81) | |
| parent | [540ca99729e28dbe902b01039a3b4bd74520a819](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=540ca99729e28dbe902b01039a3b4bd74520a819) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=58730dfbd4ae01c1b022b0d234a8bf8c02cdfb81&id2=540ca99729e28dbe902b01039a3b4bd74520a819)) | |
| download | [linux-58730dfbd4ae01c1b022b0d234a8bf8c02cdfb81.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-58730dfbd4ae01c1b022b0d234a8bf8c02cdfb81.tar.gz) | |

vmci: prevent speculation leaks by sanitizing event in event\_deliver()commit 8003f00d895310d409b2bf9ef907c56b42a4e0f4 upstream.
Coverity spotted that event\_msg is controlled by user-space,
event\_msg->event\_data.event is passed to event\_deliver() and used
as an index without sanitization.
This change ensures that the event index is sanitized to mitigate any
possibility of speculative information leaks.
This bug was discovered and resolved using Coverity Static Analysis
Security Testing (SAST) by Synopsys, Inc.
Only compile tested, no access to HW.
Fixes: 1d990201f9bb ("VMCI: event handling implementation.")
Cc: stable <stable@kernel.org>
Signed-off-by: Hagar Gamal Halim Hemdan <hagarhem@amazon.com>
Link: <https://lore.kernel.org/stable/20231127193533.46174-1-hagarhem%40amazon.com>
Link: [https://lore.kernel.org/r/20240430085916.4753-1-hagarhem@amazon.com](https://lore.kernel.org/r/20240430085916.4753-1-hagarhem%40amazon.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=58730dfbd4ae01c1b022b0d234a8bf8c02cdfb81)

| -rw-r--r-- | [drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/misc/vmw_vmci/vmci_event.c?id=58730dfbd4ae01c1b022b0d234a8bf8c02cdfb81) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/drivers/misc/vmw\_vmci/vmci\_event.c b/drivers/misc/vmw\_vmci/vmci\_event.cindex 84258a48029d41..da24cb341a7f59 100644--- a/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=540ca99729e28dbe902b01039a3b4bd74520a819)+++ b/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=58730dfbd4ae01c1b022b0d234a8bf8c02cdfb81)@@ -17,6 +17,7 @@ #include <linux/vmw\_vmci\_api.h> #include <linux/list.h> #include <linux/module.h>+#include <linux/nospec.h> #include <linux/sched.h> #include <linux/slab.h> #include <linux/rculist.h>@@ -94,9 +95,12 @@ static void event\_deliver(struct vmci\_event\_msg \*event\_msg) { struct vmci\_subscription \*cur; struct list\_head \*subscriber\_list;+ u32 sanitized\_event, max\_vmci\_event;  rcu\_read\_lock();- subscriber\_list = &subscriber\_array[event\_msg->event\_data.event];+ max\_vmci\_event = ARRAY\_SIZE(subscriber\_array);+ sanitized\_event = array\_index\_nospec(event\_msg->event\_data.event, max\_vmci\_event);+ subscriber\_list = &subscriber\_array[sanitized\_event]; list\_for\_each\_entry\_rcu(cur, subscriber\_list, node) { cur->callback(cur->id, &event\_msg->event\_data, cur->callback\_data); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:27:00 +0000



=== Content from git.kernel.org_d770c397_20250111_172824.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=681967c4ff210e06380acf9b9a1b33ae06e77cbd)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=681967c4ff210e06380acf9b9a1b33ae06e77cbd)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=681967c4ff210e06380acf9b9a1b33ae06e77cbd)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=681967c4ff210e06380acf9b9a1b33ae06e77cbd)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hagar Gamal Halim Hemdan <hagarhem@amazon.com> | 2024-04-30 08:59:16 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-07-05 09:08:18 +0200 |
| commit | [681967c4ff210e06380acf9b9a1b33ae06e77cbd](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=681967c4ff210e06380acf9b9a1b33ae06e77cbd) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=681967c4ff210e06380acf9b9a1b33ae06e77cbd)) | |
| tree | [0dbfc726b465d47d4420e9709ab3d4616b515caa](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=681967c4ff210e06380acf9b9a1b33ae06e77cbd) | |
| parent | [4c2df1874b8845316ee70c10379fdc602017050b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4c2df1874b8845316ee70c10379fdc602017050b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=681967c4ff210e06380acf9b9a1b33ae06e77cbd&id2=4c2df1874b8845316ee70c10379fdc602017050b)) | |
| download | [linux-681967c4ff210e06380acf9b9a1b33ae06e77cbd.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-681967c4ff210e06380acf9b9a1b33ae06e77cbd.tar.gz) | |

vmci: prevent speculation leaks by sanitizing event in event\_deliver()commit 8003f00d895310d409b2bf9ef907c56b42a4e0f4 upstream.
Coverity spotted that event\_msg is controlled by user-space,
event\_msg->event\_data.event is passed to event\_deliver() and used
as an index without sanitization.
This change ensures that the event index is sanitized to mitigate any
possibility of speculative information leaks.
This bug was discovered and resolved using Coverity Static Analysis
Security Testing (SAST) by Synopsys, Inc.
Only compile tested, no access to HW.
Fixes: 1d990201f9bb ("VMCI: event handling implementation.")
Cc: stable <stable@kernel.org>
Signed-off-by: Hagar Gamal Halim Hemdan <hagarhem@amazon.com>
Link: <https://lore.kernel.org/stable/20231127193533.46174-1-hagarhem%40amazon.com>
Link: [https://lore.kernel.org/r/20240430085916.4753-1-hagarhem@amazon.com](https://lore.kernel.org/r/20240430085916.4753-1-hagarhem%40amazon.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=681967c4ff210e06380acf9b9a1b33ae06e77cbd)

| -rw-r--r-- | [drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/misc/vmw_vmci/vmci_event.c?id=681967c4ff210e06380acf9b9a1b33ae06e77cbd) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/drivers/misc/vmw\_vmci/vmci\_event.c b/drivers/misc/vmw\_vmci/vmci\_event.cindex e3436abf39f458..5b7ef47f4c1186 100644--- a/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=4c2df1874b8845316ee70c10379fdc602017050b)+++ b/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=681967c4ff210e06380acf9b9a1b33ae06e77cbd)@@ -9,6 +9,7 @@ #include <linux/vmw\_vmci\_api.h> #include <linux/list.h> #include <linux/module.h>+#include <linux/nospec.h> #include <linux/sched.h> #include <linux/slab.h> #include <linux/rculist.h>@@ -86,9 +87,12 @@ static void event\_deliver(struct vmci\_event\_msg \*event\_msg) { struct vmci\_subscription \*cur; struct list\_head \*subscriber\_list;+ u32 sanitized\_event, max\_vmci\_event;  rcu\_read\_lock();- subscriber\_list = &subscriber\_array[event\_msg->event\_data.event];+ max\_vmci\_event = ARRAY\_SIZE(subscriber\_array);+ sanitized\_event = array\_index\_nospec(event\_msg->event\_data.event, max\_vmci\_event);+ subscriber\_list = &subscriber\_array[sanitized\_event]; list\_for\_each\_entry\_rcu(cur, subscriber\_list, node) { cur->callback(cur->id, &event\_msg->event\_data, cur->callback\_data); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:27:01 +0000



=== Content from git.kernel.org_a173b6f0_20250111_172825.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8003f00d895310d409b2bf9ef907c56b42a4e0f4)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8003f00d895310d409b2bf9ef907c56b42a4e0f4)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8003f00d895310d409b2bf9ef907c56b42a4e0f4)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8003f00d895310d409b2bf9ef907c56b42a4e0f4)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hagar Gamal Halim Hemdan <hagarhem@amazon.com> | 2024-04-30 08:59:16 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-05-03 07:28:53 +0200 |
| commit | [8003f00d895310d409b2bf9ef907c56b42a4e0f4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8003f00d895310d409b2bf9ef907c56b42a4e0f4) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8003f00d895310d409b2bf9ef907c56b42a4e0f4)) | |
| tree | [5c02070102d4937d992cf6fb98a7f0e1356c5b1a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8003f00d895310d409b2bf9ef907c56b42a4e0f4) | |
| parent | [35230d31056d82a416bba881cceca420fc90d079](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=35230d31056d82a416bba881cceca420fc90d079) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8003f00d895310d409b2bf9ef907c56b42a4e0f4&id2=35230d31056d82a416bba881cceca420fc90d079)) | |
| download | [linux-8003f00d895310d409b2bf9ef907c56b42a4e0f4.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8003f00d895310d409b2bf9ef907c56b42a4e0f4.tar.gz) | |

vmci: prevent speculation leaks by sanitizing event in event\_deliver()Coverity spotted that event\_msg is controlled by user-space,
event\_msg->event\_data.event is passed to event\_deliver() and used
as an index without sanitization.
This change ensures that the event index is sanitized to mitigate any
possibility of speculative information leaks.
This bug was discovered and resolved using Coverity Static Analysis
Security Testing (SAST) by Synopsys, Inc.
Only compile tested, no access to HW.
Fixes: 1d990201f9bb ("VMCI: event handling implementation.")
Cc: stable <stable@kernel.org>
Signed-off-by: Hagar Gamal Halim Hemdan <hagarhem@amazon.com>
Link: <https://lore.kernel.org/stable/20231127193533.46174-1-hagarhem%40amazon.com>
Link: [https://lore.kernel.org/r/20240430085916.4753-1-hagarhem@amazon.com](https://lore.kernel.org/r/20240430085916.4753-1-hagarhem%40amazon.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8003f00d895310d409b2bf9ef907c56b42a4e0f4)

| -rw-r--r-- | [drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/misc/vmw_vmci/vmci_event.c?id=8003f00d895310d409b2bf9ef907c56b42a4e0f4) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/drivers/misc/vmw\_vmci/vmci\_event.c b/drivers/misc/vmw\_vmci/vmci\_event.cindex 5d7ac07623c273..9a41ab65378de0 100644--- a/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=35230d31056d82a416bba881cceca420fc90d079)+++ b/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=8003f00d895310d409b2bf9ef907c56b42a4e0f4)@@ -9,6 +9,7 @@ #include <linux/vmw\_vmci\_api.h> #include <linux/list.h> #include <linux/module.h>+#include <linux/nospec.h> #include <linux/sched.h> #include <linux/slab.h> #include <linux/rculist.h>@@ -86,9 +87,12 @@ static void event\_deliver(struct vmci\_event\_msg \*event\_msg) { struct vmci\_subscription \*cur; struct list\_head \*subscriber\_list;+ u32 sanitized\_event, max\_vmci\_event;  rcu\_read\_lock();- subscriber\_list = &subscriber\_array[event\_msg->event\_data.event];+ max\_vmci\_event = ARRAY\_SIZE(subscriber\_array);+ sanitized\_event = array\_index\_nospec(event\_msg->event\_data.event, max\_vmci\_event);+ subscriber\_list = &subscriber\_array[sanitized\_event]; list\_for\_each\_entry\_rcu(cur, subscriber\_list, node) { cur->callback(cur->id, &event\_msg->event\_data, cur->callback\_data); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:27:02 +0000



=== Content from git.kernel.org_f9e03559_20250111_172826.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=95bac1c8bedb362374ea1937b1d3e833e01174ee)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=95bac1c8bedb362374ea1937b1d3e833e01174ee)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=95bac1c8bedb362374ea1937b1d3e833e01174ee)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=95bac1c8bedb362374ea1937b1d3e833e01174ee)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hagar Gamal Halim Hemdan <hagarhem@amazon.com> | 2024-04-30 08:59:16 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-21 14:35:55 +0200 |
| commit | [95bac1c8bedb362374ea1937b1d3e833e01174ee](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=95bac1c8bedb362374ea1937b1d3e833e01174ee) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=95bac1c8bedb362374ea1937b1d3e833e01174ee)) | |
| tree | [14e0da8a7ec7eb185ed76add054815fadb86dd1c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=95bac1c8bedb362374ea1937b1d3e833e01174ee) | |
| parent | [5eabdf17fed2ad41b836bb4055ec36d95e512c50](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5eabdf17fed2ad41b836bb4055ec36d95e512c50) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=95bac1c8bedb362374ea1937b1d3e833e01174ee&id2=5eabdf17fed2ad41b836bb4055ec36d95e512c50)) | |
| download | [linux-95bac1c8bedb362374ea1937b1d3e833e01174ee.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-95bac1c8bedb362374ea1937b1d3e833e01174ee.tar.gz) | |

vmci: prevent speculation leaks by sanitizing event in event\_deliver()commit 8003f00d895310d409b2bf9ef907c56b42a4e0f4 upstream.
Coverity spotted that event\_msg is controlled by user-space,
event\_msg->event\_data.event is passed to event\_deliver() and used
as an index without sanitization.
This change ensures that the event index is sanitized to mitigate any
possibility of speculative information leaks.
This bug was discovered and resolved using Coverity Static Analysis
Security Testing (SAST) by Synopsys, Inc.
Only compile tested, no access to HW.
Fixes: 1d990201f9bb ("VMCI: event handling implementation.")
Cc: stable <stable@kernel.org>
Signed-off-by: Hagar Gamal Halim Hemdan <hagarhem@amazon.com>
Link: <https://lore.kernel.org/stable/20231127193533.46174-1-hagarhem%40amazon.com>
Link: [https://lore.kernel.org/r/20240430085916.4753-1-hagarhem@amazon.com](https://lore.kernel.org/r/20240430085916.4753-1-hagarhem%40amazon.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=95bac1c8bedb362374ea1937b1d3e833e01174ee)

| -rw-r--r-- | [drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/misc/vmw_vmci/vmci_event.c?id=95bac1c8bedb362374ea1937b1d3e833e01174ee) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/drivers/misc/vmw\_vmci/vmci\_event.c b/drivers/misc/vmw\_vmci/vmci\_event.cindex 2100297c94ad02..a1205bce0b7eed 100644--- a/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=5eabdf17fed2ad41b836bb4055ec36d95e512c50)+++ b/[drivers/misc/vmw\_vmci/vmci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/misc/vmw_vmci/vmci_event.c?id=95bac1c8bedb362374ea1937b1d3e833e01174ee)@@ -9,6 +9,7 @@ #include <linux/vmw\_vmci\_api.h> #include <linux/list.h> #include <linux/module.h>+#include <linux/nospec.h> #include <linux/sched.h> #include <linux/slab.h> #include <linux/rculist.h>@@ -86,9 +87,12 @@ static void event\_deliver(struct vmci\_event\_msg \*event\_msg) { struct vmci\_subscription \*cur; struct list\_head \*subscriber\_list;+ u32 sanitized\_event, max\_vmci\_event;  rcu\_read\_lock();- subscriber\_list = &subscriber\_array[event\_msg->event\_data.event];+ max\_vmci\_event = ARRAY\_SIZE(subscriber\_array);+ sanitized\_event = array\_index\_nospec(event\_msg->event\_data.event, max\_vmci\_event);+ subscriber\_list = &subscriber\_array[sanitized\_event]; list\_for\_each\_entry\_rcu(cur, subscriber\_list, node) { cur->callback(cur->id, &event\_msg->event\_data, cur->callback\_data); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:27:03 +0000


