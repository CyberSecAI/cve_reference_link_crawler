<!doctype html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<meta name="description" content="Personal blog of Julien (jvoisin) Voisin">
<meta name="fediverse:creator" content="@jvoisin@infosec.exchange">
<link rel="me" href="https://infosec.exchange/@jvoisin">
<link rel="me" href="https://bsky.app/profile/jvoisin.bsky.social">
<title>Carrot disclosure</title>
<link href="./theme/css/full.css" type="text/css" rel="stylesheet">
<link rel="alternate" href="https://dustri.org/b/atom.xml" type="application/atom+xml" title="Atom Feed">
<link rel="alternate" href="https://dustri.org/b/rss.xml" type="application/rss+xml" title="RSS Feed">
<link rel="icon" href="https://dustri.org/static/favicon.jpg">
<script src="./theme/js/quotes.js" async defer></script>
<div class="container">
  <div class="row">
    <header>
      <h1 class="float-left">
        <a href=".">Artificial truth</a>
      </h1>
      <h3 class="float-right">
        <a href="archives.html">archives</a> |
        <a href="index.html">latest</a> |
        <a href="https://dustri.org">homepage</a>
      </h3>
      <div class="fix"></div>
      <div id="subtitle">
        <div id="divider"></div>
        <div id="quote">The more you see, the less you believe.</div>
        <span hidden id="qs"></span>
      </div>
    </header>
  </div>
  <div class="row" role="main">
      <section id="content" class="body">
        <article>
          <header>
            <h2 class="title">
              <a href="./carrot-disclosure.html" rel="bookmark" title="Permalink to Carrot disclosure">Carrot disclosure</a>
               <div class="date" title="2024-03-08T21:30:00+01:00">
                 Fri 08 March 2024 â <a class="source" href="carrot-disclosure.markdown">download</a><br>
               </div>
            </h2>
          </header>
          <div class="entry-content">
            <p>Once you have found a vulnerability, you can either sit on it, or disclose it.
There are usually two ways to disclose, with minor variations:</p>
<ol>
<li><a href="https://en.wikipedia.org/wiki/Coordinated_vulnerability_disclosure">Coordinated Disclosure</a>,
   where one gives time to the vendor to issue a fix before disclosing</li>
<li><a href="https://en.wikipedia.org/wiki/Full_disclosure_(computer_security)">Full Disclosure</a>,
   where one discloses immediately without notifying anyone before.</li>
</ol>
<p>I would like to coin a 3<sup>rd</sup> one: <em>Carrot Disclosure</em>, dangling a
<a href="https://en.wikipedia.org/wiki/Carrot_and_stick">metaphorical carrot</a> in front
of the vendor to incentivise change. The main idea is to only publish the
(redacted) output of the exploit for a critical vulnerability, to showcase that the
software is exploitable. Now the vendor has two choices: either perform a
holistic audit of its software, fixing as many issues as possible in the hope
of fixing the showcased vulnerability; or losing users who might not be happy
running a known-vulnerable software. Users of this disclosure model are of
course called Bugs Bunnies.</p>
<p>We all looked at catastrophic web applications, finding a ton
of bugs, and deciding not to bother with reporting them, because they were too
many of them, because we knew that there will be more of them lurking, because
the vendor is a complete tool and it would take more time trying to properly
disclose things than it took finding the vulnerabilities, â¦ This is an
excellent use case for Carrot Disclosure! Of course, for unauditably-large
codebases, it doesn't work: you've got a Linux LPE, who cares.</p>
<p>Interestingly, it shifts the work balance a bit: it's usually harder to write
an exploit than it's to fix here. But here, the vendor has to audit and fix
its entire codebase, for the ~low cost of one (1) exploit, that you don't even
have to publish if you don't want to.</p>
<p>If you want to be extra-nice, you can:</p>
<ul>
<li>Publish the SHA256 of the exploit, to prove
  that you weren't making things up, once it's fixed or if you get sued for
  whatever frivolous reasons like libel.</li>
<li>Maintain the exploits against new versions, proving that the exploit is still
  working.</li>
<li>Publish the exploit once it has been fixed, otherwise you risk to have
  vendors call your bluff next time, or at least notify that the issue has been
  fixed. Since you don't have hardcoded offsets because we're in 2024, you can even
  put this in a continuous integration.</li>
</ul>
<p>Let's have an example, as a treat. A couple of shitty vulnerabilities for
<a href="https://raspap.com/">RaspAP</a> that took me 5 minutes to find and at least 5
more to write an exploit for each of them:</p>
<div class="codehilite"><pre><span></span><code><span class="gp">$ </span>./read-raspap.py<span class="w"> </span><span class="m">10</span>.3.141.1<span class="w"> </span>/etc/passwd<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-n<span class="w"> </span><span class="m">5</span>
<span class="go">[+] Target is running RaspAP</span>
<span class="go">[+] Dumping /etc/passwd</span>
<span class="go">root:x:0:0:root:/root:/bin/bash</span>
<span class="go">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span>
<span class="go">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span>
<span class="gp">$ </span>./authed-mitm-raspap.py<span class="w"> </span><span class="m">10</span>.3.141.1
<span class="go">[+] default login/password in use</span>
<span class="go">[+] backdooring systemâ¦</span>
<span class="go">[+] system backdoored, enjoy your permanent MITM!</span>
<span class="gp">$ </span>./leak-wifi-password-raspap.py<span class="w"> </span><span class="m">10</span>.3.141.1
<span class="go">[+] Got the wifi password: &quot;secretwifipassword&quot;</span>
<span class="gp">$ </span>./leak-wireguard-key-raspap.py<span class="w"> </span><span class="m">10</span>.3.141.1
<span class="go">[+] Got the key! Saved as ./wg-10.3.141.1.key</span>
<span class="gp">$ </span>./brick-raspap.py<span class="w"> </span><span class="m">10</span>.3.141.1
<span class="go">[+] Target is running RaspAP</span>
<span class="go">[+] Bricking the systemâ¦</span>
<span class="go">[+] System bricked!</span>
<span class="gp">$</span>
</code></pre></div>

<p>It looks like there is a low-hanging unauthenticated arbitrary code execution
chainable with a privilege escalation to root as well, but since writing an
exploit would take more than 5 minutes, I can't be bothered, and odds are that
it'll be fixed along with the persistent denial-of-service anyway. Let me know
when you think those are fixed.</p>
<p>edit: couple of days later, it seems to be a success:</p>
<ul>
<li>A <a href="https://github.com/RaspAP/raspap-webgui/pull/1546">pull-request</a> from
  <a href="https://twitter.com/defendtheworld/status/1767204517316108414">defendtheworld</a>
  adding more escaping, and making all the ajax requests authenticated.</li>
<li>Another <a href="https://github.com/RaspAP/raspap-webgui/pull/1548">pull-request</a> from one of the authors of RaspAP,
  adding a bit more hardening on top of it.</li>
</ul>
<p>But there are still more things to fix.</p>
<p>This article has been published in <a href="https://gynvael.coldwind.pl/?id=786">Paged Out #4</a>, page 37.</p>
          </div>
        </article>
      </section>
  </div>
  <hr>
  <div class="row">
    <footer>
      2011-2025 -
      Julien (<a rel="author" href="https://dustri.org">jvoisin</a>) Voisin -
      <a href="https://creativecommons.org/licenses/by-sa/4.0" rel="license">CC BY-SA</a> -
      <a href="https://dustri.org/b/atom.xml">atom</a>/<a href="https://dustri.org/b/rss.xml">rss</a>/<a href="https://twitter.com/dustriorg">twitter</a>/<a href="https://bsky.app/profile/dustri.org">bluesky</a>/<a rel="me" href="https://infosec.exchange/@jvoisin">mastodon</a> -
      â¥
    </footer>
  </div>
</div>