=== Content from jvn.jp_9f3487c6_20250110_122433.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2024/07/30  Last Updated:2024/07/30
# JVN#26225832 EC-CUBE plugin (for EC-CUBE 4 series) "EC-CUBE Web API Plugin" vulnerable to stored cross-site scripting

## Overview

EC-CUBE plugin (for EC-CUBE 4 series) "EC-CUBE Web API Plugin" provided by EC-CUBE CO.,LTD. contains a stored cross-site scripting vulnerability.

## Products Affected

* "EC-CUBE Web API Plugin" 1.0.0 and 2.1.0 to 2.1.3 (for EC-CUBE 4.0/4.1 series)
* "EC-CUBE Web API Plugin (4.2 series)" 4.2.0 to 4.2.3 (for EC-CUBE 4.2 series)

## Description

EC-CUBE plugin (for EC-CUBE 4 series) "EC-CUBE Web API Plugin" provided by EC-CUBE CO.,LTD. contains a stored cross-site scripting vulnerability ([CWE-79](https://cwe.mitre.org/data/definitions/79.html)) in OAuth Management feature.

## Impact

When there are multiple users using OAuth Management feature and one of them inputs some crafted value on the OAuth Management page, an arbitrary script may be executed on the web browser of the other user who accessed the management page.

## Solution

**Update the plugin**

Update the plugin to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Status | Last Update | Vendor Notes |
| --- | --- | --- | --- |
| EC-CUBE CO.,LTD. | [Vulnerable](491122/index.html) | 2024/07/30 | [EC-CUBE CO.,LTD. website](https://www.ec-cube.net/info/weakness/20240701/web_api_plugin.php) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
Base Score:
4.8

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

## Credit

EC-CUBE CO.,LTD. reported this vulnerability to JPCERT/CC to notify users of its solution through JVN. JPCERT/CC and EC-CUBE CO.,LTD. coordinated under the Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2024-41141](https://www.cve.org/CVERecord?id=CVE-2024-41141) |
| JVN iPedia | [JVNDB-2024-000081](https://jvndb.jvn.jp/jvndb/JVNDB-2024-000081) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2024 JPCERT/CC and IPA. All rights reserved.



=== Content from www.ec-cube.net_e23c17a9_20250110_122434.html ===

# EC-CUBEプラグイン「EC-CUBE Web API プラグイン」におけるクロスサイトスクリプティングの脆弱性(JVN#26225832)

##### 更新履歴

2024/07/30 14:00
JVNからの公表内容情報へのリンクを追加

2024/07/17 14:00
初版公開

## EC-CUBE Web API プラグインにおけるクロスサイトスクリプティングの脆弱性

EC-CUBE Web API プラグインに脆弱性(緊急度: 低)があることが判明いたしました。

脆弱性そのものは、修正ファイルの反映によりすぐに解決するものです。

以下のいずれかの方法により、ご対応をお願いいたします。

* 修正方法1: プラグインのバージョンアップを行う場合
* 修正方法2: 修正差分を確認して適用する場合

皆様にはお手数おかけし誠に申し訳ございません。

本脆弱性における被害報告は現時点でございませんが、できるだけ速やかにご対応をお願いいたします。

## 脆弱性の概要

### EC-CUBE Web API プラグインにおけるクロスサイトスクリプティングの脆弱性

#### 危険度:

低

#### 不具合が存在するEC-CUBE Web API プラグインのバージョン:

* **1.0.0、2.1.0〜2.1.3 (EC-CUBE 4.0系/4.1系対応)**
* **4.2.0〜4.2.3 (EC-CUBE 4.2系対応)**

#### 詳細:

EC-CUBE4系のWeb APIプラグインのOAuth管理には、クロスサイトスクリプティングの脆弱性が存在します。

管理画面にアクセス可能なユーザの操作によって、別ユーザのブラウザ上で不正な JavaScriptの実行や、一時的な画面改変が可能です。

---

### JVNからの公表内容 (2024/07/30公開)

[JVN#26225832: EC-CUBE 4系用プラグイン「EC-CUBE Web API プラグイン」における格納型クロスサイトス クリプティングの脆弱性](https://jvn.jp/jp/JVN26225832/)

## 修正方法1: プラグインのバージョンアップを行う場合

EC-CUBE Web API プラグインを最新版にバージョンアップしていただくことで、本件の脆弱性は修正されます。

ご利用の方は、速やかにプラグインのバージョンアップをお願いいたします。

#### 修正済みプラグインのバージョン:

* **バージョン 2.1.4 (EC-CUBE 4.0系/4.1系対応)**
* **バージョン 4.3.1 (EC-CUBE 4.2系/4.3系対応)**

## 修正方法2-1: 修正差分を確認して適用する場合(バージョン 2.1.3 EC-CUBE 4.0系/4.1系対応)

下記のコード差分情報を参照して頂き、必要な箇所に修正を反映してください。

本修正方法はEC-CUBE Web API プラグイン 2.1.3のバージョンを例として提示しております。

過去バージョンをご利用の場合は、下記修正対象ファイルの修正差分を参考にご対応お願いいたします。
### 修正差分

Files changed (1)
hide
show

1. [/app/Plugin/Api/Resource/template/admin/OAuth/authorization.twig](#d2h-407106-213)
   +2
   -2

 /app/Plugin/Api/Resource/template/admin/OAuth/authorization.twig
CHANGED

Viewed

|  | @@ -10,11 +10,11 @@ |
| --- | --- |
| 10 10 | <div class="text-center p-5 bg-white"> |
| 11 11 | <form name="form1" id="form1" method="post" action=""> |
| 12 12 | {{ form\_widget(form.\_token) }} |
| 13 | -  <p class="text-left">{{ 'api.admin.oauth.allow\_\_confirm\_message'|trans({'%shop\_name%': "<a href=\"#{path('homepage')}\">#{BaseInfo.shop\_name}</a>"})|raw }}</p> |
| 13 | +  <p class="text-left">{{ 'api.admin.oauth.allow\_\_confirm\_message'|trans({'%shop\_name%': "<a href=\"#{path('homepage')}\">#{BaseInfo.shop\_name|escape}</a>"})|raw }}</p> |
| 14 14 | <p class="text-left">{{ 'api.admin.oauth.allow\_\_confirm\_description'|trans }}</p> |
| 15 15 | <ul> |
| 16 16 | {% for scope in scopes %} |
| 17 | -  <li class="text-left">{{ "api.admin.oauth.scope.#{scope}.description"|trans({'%shop\_name%': "<a href=\"#{path('homepage')}\">#{BaseInfo.shop\_name}</a>"})|raw }}</li> |
| 17 | +  <li class="text-left">{{ "api.admin.oauth.scope.#{scope}.description"|trans({'%shop\_name%': "<a href=\"#{path('homepage')}\">#{BaseInfo.shop\_name|escape}</a>"})|raw }}</li> |
| 18 18 | {% endfor %} |
| 19 19 | </ul> |
| 20 20 |  |

## 修正方法2-2: 修正差分を確認して適用する場合(バージョン 4.2.3 EC-CUBE 4.2系対応)

下記のコード差分情報を参照して頂き、必要な箇所に修正を反映してください。

本修正方法はEC-CUBE Web API プラグイン 4.2.3のバージョンを例として提示しております。

過去バージョンをご利用の場合は、下記修正対象ファイルの修正差分を参考にご対応お願いいたします。
### 修正差分

Files changed (1)
hide
show

1. [/app/Plugin/Api/Resource/template/admin/OAuth/authorization.twig](#d2h-407106-423)
   +2
   -2

 /app/Plugin/Api/Resource/template/admin/OAuth/authorization.twig
CHANGED

Viewed

|  | @@ -10,11 +10,11 @@ |
| --- | --- |
| 10 10 | <div class="text-center p-5 bg-white"> |
| 11 11 | <form name="form1" id="form1" method="post" action=""> |
| 12 12 | {{ form\_widget(form.\_token) }} |
| 13 | -  <p class="text-start">{{ 'api.admin.oauth.allow\_\_confirm\_message'|trans({'%shop\_name%': "<a href=\"#{path('homepage')}\">#{BaseInfo.shop\_name}</a>"})|raw }}</p> |
| 13 | +  <p class="text-start">{{ 'api.admin.oauth.allow\_\_confirm\_message'|trans({'%shop\_name%': "<a href=\"#{path('homepage')}\">#{BaseInfo.shop\_name|escape}</a>"})|raw }}</p> |
| 14 14 | <p class="text-start">{{ 'api.admin.oauth.allow\_\_confirm\_description'|trans }}</p> |
| 15 15 | <ul> |
| 16 16 | {% for scope in scopes %} |
| 17 | -  <li class="text-start">{{ "api.admin.oauth.scope.#{scope}.description"|trans({'%shop\_name%': "<a href=\"#{path('homepage')}\">#{BaseInfo.shop\_name}</a>"})|raw }}</li> |
| 17 | +  <li class="text-start">{{ "api.admin.oauth.scope.#{scope}.description"|trans({'%shop\_name%': "<a href=\"#{path('homepage')}\">#{BaseInfo.shop\_name|escape}</a>"})|raw }}</li> |
| 18 18 | {% endfor %} |
| 19 19 | </ul> |
| 20 20 |  |

### 問い合わせ先

本脆弱性に関するお問合せ：

EC-CUBE 運営チーム

MAIL: [[email protected]](/cdn-cgi/l/email-protection)


