<!--
                              _.._        ,------------.
                           ,'      `.    ( We want you! )
                          /  __) __` \    `-,----------'
                         (  (`-`(-')  ) _.-'
                         /)  \  = /  (
                        /'    |--' .  \
                       (  ,---|  `-.)__`
                        )(  `-.,--'   _`-.
                       '/,'          (  Uu",
                        (_       ,    `/,-' )
                        `.__,  : `-'/  /`--'
                          |     `--'  |
                          `   `-._   /
                           \        (
                           /\ .      \.  freebuf
                          / |` \     ,-\
                         /  \| .)   /   \
                        ( ,'|\    ,'     :
                        | \,`.`--"/      }
                        `,'    \  |,'    /
                       / "-._   `-/      |
                       "-.   "-.,'|     ;
                      /        _/["---'""]
                     :        /  |"-     '
                     '           |      /
                                 `      |
-->
<!doctype html>
<html data-n-head-ssr>

<head>
  <meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" name="renderer" content="webkit"><meta data-n-head="ssr" http-equiv="X-UA-Compatible" content="IE=edge"><meta data-n-head="ssr" name="baidu-site-verification" content="nKKKqQxp6R"><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,inital-scal=1"><meta data-n-head="ssr" data-hid="description" name="description" content="本次攻击事件中黑客利用了基于Plex服务发起的DDoS反射攻击。"><meta data-n-head="ssr" name="keywords" content="web,资讯,web安全,企业安全"><title>预警：基于Plex媒体播放平台的DDoS反射攻击来袭 - FreeBuf网络安全行业门户</title><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="stylesheet" href="/style/editor.css"><link rel="preload" href="/freebuf/2.1.0.7f26a497a2eb221ea1de.js" as="script"><link rel="preload" href="/freebuf/2.1.0.c0b276a5b9ee3a7a5a34.js" as="script"><link rel="preload" href="/freebuf/2.1.0.adec09679a5f1ff7f4f1.js" as="script"><link rel="preload" href="/freebuf/2.1.0.14f77b2afcd5f04e4c4e.css" as="style"><link rel="preload" href="/freebuf/2.1.0.b3a8a5d3b07bb45639a0.js" as="script"><link rel="preload" href="/freebuf/2.1.0.20b07d7021373ccdc6e0.css" as="style"><link rel="preload" href="/freebuf/2.1.0.1c90b07ce7070207ef8f.js" as="script"><link rel="preload" href="/freebuf/2.1.0.2f44e4b838fc7fc70c40.js" as="script"><link rel="preload" href="/freebuf/2.1.0.689e7dd7cbf544710ee4.js" as="script"><link rel="preload" href="/freebuf/2.1.0.ab4582407bfdec9e4184.js" as="script"><link rel="preload" href="/freebuf/2.1.0.e21c04f32fbd7819bb01.css" as="style"><link rel="preload" href="/freebuf/2.1.0.041c5bec9093967514e0.js" as="script"><link rel="preload" href="/freebuf/2.1.0.30122be9f86e13f2c9fc.css" as="style"><link rel="preload" href="/freebuf/2.1.0.515b3409dfbccb639d20.js" as="script"><link rel="preload" href="/freebuf/2.1.0.253d0ad2cf48ad406302.css" as="style"><link rel="preload" href="/freebuf/2.1.0.3d76cbae95b53b76724c.js" as="script"><link rel="preload" href="/freebuf/2.1.0.48c1971024b1cf64550a.css" as="style"><link rel="preload" href="/freebuf/2.1.0.b8023a32ab92b65f00ec.js" as="script"><link rel="preload" href="/freebuf/2.1.0.cdaee8341ba85cb818fc.css" as="style"><link rel="preload" href="/freebuf/2.1.0.9de09eb00a6f5848e45d.js" as="script"><link rel="stylesheet" href="/freebuf/2.1.0.14f77b2afcd5f04e4c4e.css"><link rel="stylesheet" href="/freebuf/2.1.0.20b07d7021373ccdc6e0.css"><link rel="stylesheet" href="/freebuf/2.1.0.e21c04f32fbd7819bb01.css"><link rel="stylesheet" href="/freebuf/2.1.0.30122be9f86e13f2c9fc.css"><link rel="stylesheet" href="/freebuf/2.1.0.253d0ad2cf48ad406302.css"><link rel="stylesheet" href="/freebuf/2.1.0.48c1971024b1cf64550a.css"><link rel="stylesheet" href="/freebuf/2.1.0.cdaee8341ba85cb818fc.css">
</head>

<body>
  <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div id="components-layout-demo-basic" class="public-header-article" data-v-55d8de90><section class="ant-layout" data-v-55d8de90><header class="articles-layout-header ant-layout-header" style="position:fixed;z-index:51;width:100%" data-v-55d8de90><div class="content-header" data-v-55d8de90><a href="/" class="logo-view nuxt-link-active" data-v-c5f1b53a data-v-55d8de90><img src="/images/logoMax.png" alt="freeBuf" style="color:#fff" data-v-c5f1b53a></a> <div class="main-view" data-v-e790bf04 data-v-55d8de90><div class="main-but" data-v-e790bf04><span style="font-size:14px;display:inline-block;white-space:nowrap;letter-spacing:1px" data-v-e790bf04>主站</span> <svg aria-hidden="true" class="svg-icon main-slider-cion" style="margin-left:3px" data-v-322983b7 data-v-e790bf04><use xlink:href="#caret-down" data-v-322983b7></use></svg> <div class="main-but-view" data-v-e790bf04><div data-v-e790bf04><div class="tag-top" data-v-e790bf04><p data-v-e790bf04><svg aria-hidden="true" class="svg-icon tag-svg" data-v-322983b7 data-v-e790bf04><use xlink:href="#heike" data-v-322983b7></use></svg><span data-v-e790bf04>分类</span></p> <div class="tag-top-bottom" data-v-e790bf04><span class="border-none" data-v-e790bf04>
              漏洞
            </span> <span data-v-e790bf04>
              工具
            </span> <span data-v-e790bf04>
              极客
            </span> <span class="nuxt-link-active" data-v-e790bf04>
              Web安全
            </span> <span data-v-e790bf04>
              系统安全
            </span> <span data-v-e790bf04>
              网络安全
            </span> <span data-v-e790bf04>
              无线安全
            </span> <span class="border-none" data-v-e790bf04>
              设备/客户端安全
            </span> <span data-v-e790bf04>
              数据安全
            </span> <span data-v-e790bf04>
              安全管理
            </span> <span data-v-e790bf04>
              企业安全
            </span> <span data-v-e790bf04>
              工控安全
            </span></div></div> <div class="tag-top" style="margin-top:10px" data-v-e790bf04><p data-v-e790bf04><svg aria-hidden="true" class="svg-icon tag-svg" data-v-322983b7 data-v-e790bf04><use xlink:href="#eye-fill" data-v-322983b7></use></svg><span data-v-e790bf04>特色</span></p> <div class="tag-top-bottom" data-v-e790bf04><span class="border-none" data-v-e790bf04>
              头条
            </span> <span data-v-e790bf04>
              人物志
            </span> <span data-v-e790bf04>
              活动
            </span> <span data-v-e790bf04>
              视频
            </span> <span data-v-e790bf04>
              观点
            </span> <span data-v-e790bf04>
              招聘
            </span> <span data-v-e790bf04>
              报告
            </span> <span data-v-e790bf04>
              资讯
            </span> <span class="border-none" data-v-e790bf04>
              区块链安全
            </span> <span data-v-e790bf04>
              标准与合规
            </span> <span data-v-e790bf04>
              容器安全
            </span> <span data-v-e790bf04>
              公开课
            </span></div></div></div> <div class="tag-bottom" data-v-e790bf04><a href="https://www.freebuf.com/report" target="_blank" class="left-slider-but" data-v-e790bf04><svg aria-hidden="true" class="svg-icon tag-svg" data-v-322983b7 data-v-e790bf04><use xlink:href="#file-text-fill" data-v-322983b7></use></svg><span data-v-e790bf04>报告</span></a> <div role="separator" class="ant-divider ant-divider-vertical" style="margin:0 30px;background:#3a3a3a" data-v-e790bf04></div> <a href="/column" data-v-e790bf04><svg aria-hidden="true" class="svg-icon tag-svg" data-v-322983b7 data-v-e790bf04><use xlink:href="#folder-open-fill" data-v-322983b7></use></svg><span data-v-e790bf04>专辑</span></a></div></div></div></div> <div class="menu-view" data-v-ed2d7bb0 data-v-55d8de90><ul role="menu" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-dark" data-v-ed2d7bb0><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item" data-v-ed2d7bb0><a href="https://live.freebuf.com" target="_blank" data-v-ed2d7bb0>公开课</a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item" data-v-ed2d7bb0><a href="https://shop.freebuf.com" target="_blank" data-v-ed2d7bb0>商城</a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="menu-item-self ant-menu-submenu ant-menu-submenu-horizontal" data-v-ed2d7bb0><div aria-haspopup="true" class="ant-menu-submenu-title"><span class="submenu-title-wrapper" data-v-ed2d7bb0>
            用户服务
            <svg aria-hidden="true" class="svg-icon home-menu" data-v-322983b7 data-v-ed2d7bb0><use xlink:href="#caret-down" data-v-322983b7></use></svg></span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <div class="feature-column-container" data-v-13f5f620 data-v-ed2d7bb0><span class="feature-column-item" data-v-13f5f620>行业服务
    <svg aria-hidden="true" class="svg-icon home-menu" data-v-322983b7 data-v-13f5f620><use xlink:href="#caret-down" data-v-322983b7></use></svg></span> <div class="feature-column-menu" data-v-13f5f620><div class="feature-column" data-v-13f5f620><span data-v-13f5f620><svg aria-hidden="true" class="svg-icon zhengfu" data-v-322983b7 data-v-13f5f620><use xlink:href="#zhengfu" data-v-322983b7></use></svg>
        政 府
      </span> <div data-v-13f5f620><span data-v-13f5f620>
          CNCERT
          <span class="line" data-v-13f5f620></span></span><span data-v-13f5f620>
          CNNVD
          <!----></span></div></div> <div class="company-rewrite" data-v-13f5f620><span data-v-13f5f620>
        会员体系（甲方）
        <span class="line" data-v-13f5f620></span></span><span data-v-13f5f620>
        会员体系（厂商）
        <span class="line" data-v-13f5f620></span></span><span data-v-13f5f620>
        产品名录
        <span class="line" data-v-13f5f620></span></span><span data-v-13f5f620>
        企业空间
        <!----></span></div></div></div> <span class="wikibtn" data-v-ed2d7bb0><a href="https://wiki.freebuf.com/page" target="_blank" data-v-ed2d7bb0>知识大陆</a></span></div> <div class="user-view" data-v-55d8de90><div class="search-cloud"><i aria-label="icon: search" class="anticon anticon-search" style="color:rgba(255,255,255,.6)"><svg viewBox="64 64 896 896" focusable="false" data-icon="search" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0 0 11.6 0l43.6-43.5a8.2 8.2 0 0 0 0-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"></path></svg></i> <span class="ant-input-search ant-input-search-enter-button ant-input-group-wrapper"><span class="ant-input-wrapper ant-input-group"><input placeholder="搜索关键词..." class="ant-input"><span class="ant-input-group-addon"><button type="button" class="ant-btn ant-input-search-button"><span>搜索</span></button></span></span></span></div> <div class="search-resoure"><img src="/freebuf/img/7aa3bf7.svg" alt class="default"> <img src="/freebuf/img/181d733.svg" alt class="hover"></div> <div class="guide-write-wrap"><button type="button" class="write-btn ant-btn ant-btn-primary ant-dropdown-trigger"><span>创作中心</span></button> <!----></div> <div class="tool-but-view album-square ant-dropdown-trigger"><svg aria-hidden="true" class="svg-icon" data-v-322983b7><use xlink:href="#load-app" data-v-322983b7></use></svg></div> <div class="tool-but-view ant-dropdown-trigger"><svg aria-hidden="true" class="svg-icon" data-v-322983b7><use xlink:href="#calendar" data-v-322983b7></use></svg></div> <div class="tool-but-view ant-dropdown-trigger"><svg aria-hidden="true" class="svg-icon" data-v-322983b7><use xlink:href="#tool" data-v-322983b7></use></svg></div> <button type="button" class="login-register ant-btn ant-btn-primary"><a href="https://www.freebuf.com/oauth" class="login-but login-btn">登录</a><a href="https://www.freebuf.com/oauth" class="login-but">注册</a></button> <div id="geetest-button" data-v-62f69d24></div> <!----></div></div></header> <main class="content-body ant-layout-content" style="padding:20px 0;margin-top:55px" data-v-55d8de90><div id="artical-detail-page" data-v-761cb514 data-v-55d8de90 data-v-55d8de90><div class="floating-view" data-v-37be1ed8 data-v-761cb514><!----> <div class="floating-view-item qianbao" data-v-37be1ed8></div> <div class="floating-view-item" data-v-37be1ed8><svg aria-hidden="true" class="svg-icon floating-icon" data-v-322983b7 data-v-37be1ed8><use xlink:href="#edit1" data-v-322983b7></use></svg></div> <div class="floating-view-item qrcode-box" data-v-37be1ed8><svg aria-hidden="true" class="svg-icon floating-icon" data-v-322983b7 data-v-37be1ed8><use xlink:href="#qrcode" data-v-322983b7></use></svg> <div class="qrcode-list" data-v-37be1ed8><div class="tab-view" data-v-37be1ed8><p data-v-37be1ed8><span class="active" data-v-37be1ed8>官方公众号</span><span data-v-37be1ed8>企业安全</span><span data-v-37be1ed8>新浪微博</span></p> <div class="qrcode-view" data-v-37be1ed8><img src="/images/gzh_code.jpg" alt data-v-37be1ed8> <p data-v-37be1ed8>FreeBuf.COM网络安全行业门户，每日发布专业的安全资讯、技术剖析。</p></div></div> <div class="sanjiao-view" data-v-37be1ed8></div></div></div> <div class="floating-view-item qrcode-xcx" data-v-37be1ed8><svg aria-hidden="true" class="svg-icon floating-icon" data-v-322983b7 data-v-37be1ed8><use xlink:href="#erweima" data-v-322983b7></use></svg> <div class="qrcode-list" data-v-37be1ed8><div class="tab-view" data-v-37be1ed8><div class="qrcode-view xcx-box" data-v-37be1ed8><img src="/images/xcx-code.jpg" alt="FreeBuf+小程序" style="color:#fff" data-v-37be1ed8> <p class="xcx-wiew" data-v-37be1ed8><span data-v-37be1ed8>FreeBuf+小程序</span><label data-v-37be1ed8>把安全装进口袋</label></p></div></div> <div class="sanjiao-view" data-v-37be1ed8></div></div></div> <div class="floating-view-item qrcode-xcx" data-v-37be1ed8><a href="https://wiki.freebuf.com" target="_blank" data-v-37be1ed8><img src="https://image.3001.net/images/20231020/1697804527_653270ef7570cc7356ba8.png" alt style="width:20px" data-v-37be1ed8></a></div> <div style="width:40px;height:40px" data-v-37be1ed8><!----></div> <!----> <!----> <!----></div> <div class="page-header" data-v-761cb514><div class="header-container" data-v-761cb514><div class="page-head-wrapper" data-v-761cb514><div class="title" data-v-761cb514>预警：基于Plex媒体播放平台的DDoS反射攻击来袭</div> <ul class="wrpper" data-v-761cb514><li class="auth" data-v-761cb514><a href="" data-v-761cb514><span class="img" data-v-761cb514><img src="" data-v-761cb514></span> <span class="name" data-v-761cb514></span></a></li> <li class="collet" data-v-761cb514><span class="focus" data-v-761cb514>
                关注
              </span></li> <!----></ul></div></div></div> <div class="container" data-v-761cb514><div class="aside-left" data-v-761cb514><div class="aside-left-wrapper" data-v-761cb514><ul class="tabs-panel" data-v-761cb514><li class="tab active" data-v-761cb514><a href="https://www.freebuf.com/articles/web" target="_blank" data-v-761cb514>Web安全</a></li></ul> <div class="approve-panel" data-v-761cb514><div class="approve" data-v-761cb514><div data-v-761cb514 data-v-761cb514><span class="ant-badge" data-v-761cb514><i aria-label="图标: heart" class="anticon anticon-heart" data-v-761cb514><svg viewBox="64 64 896 896" focusable="false" data-icon="heart" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M923 283.6a260.04 260.04 0 0 0-56.9-82.8 264.4 264.4 0 0 0-84-55.5A265.34 265.34 0 0 0 679.7 125c-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5a258.44 258.44 0 0 0-56.9 82.8c-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3.1-35.3-7-69.6-20.9-101.9zM512 814.8S156 586.7 156 385.5C156 283.6 240.3 201 344.3 201c73.1 0 136.5 40.8 167.7 100.4C543.2 241.8 606.6 201 679.7 201c104 0 188.3 82.6 188.3 184.5 0 201.2-356 429.3-356 429.3z"></path></svg></i><!----></span></div></div> <div class="approve" data-v-761cb514><span data-v-761cb514></span> <div data-v-761cb514 data-v-761cb514><span class="ant-badge" data-v-761cb514><i aria-label="图标: star" class="anticon anticon-star" data-v-761cb514><svg viewBox="64 64 896 896" focusable="false" data-icon="star" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 0 0 .6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0 0 46.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"></path></svg></i><!----></span></div></div> <div class="approve" data-v-761cb514><span data-v-761cb514></span> <div data-v-761cb514 data-v-761cb514><svg aria-hidden="true" class="svg-icon" style="font-size:20px" data-v-322983b7 data-v-761cb514><use xlink:href="#collect" data-v-322983b7></use></svg></div></div> <div class="approve" data-v-761cb514><div class="share-draw" data-v-761cb514><i aria-label="图标: share-alt" class="anticon anticon-share-alt" data-v-761cb514><svg viewBox="64 64 896 896" focusable="false" data-icon="share-alt" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M752 664c-28.5 0-54.8 10-75.4 26.7L469.4 540.8a160.68 160.68 0 0 0 0-57.6l207.2-149.9C697.2 350 723.5 360 752 360c66.2 0 120-53.8 120-120s-53.8-120-120-120-120 53.8-120 120c0 11.6 1.6 22.7 4.7 33.3L439.9 415.8C410.7 377.1 364.3 352 312 352c-88.4 0-160 71.6-160 160s71.6 160 160 160c52.3 0 98.7-25.1 127.9-63.8l196.8 142.5c-3.1 10.6-4.7 21.8-4.7 33.3 0 66.2 53.8 120 120 120s120-53.8 120-120-53.8-120-120-120zm0-476c28.7 0 52 23.3 52 52s-23.3 52-52 52-52-23.3-52-52 23.3-52 52-52zM312 600c-48.5 0-88-39.5-88-88s39.5-88 88-88 88 39.5 88 88-39.5 88-88 88zm440 236c-28.7 0-52-23.3-52-52s23.3-52 52-52 52 23.3 52 52-23.3 52-52 52z"></path></svg></i></div></div> <div style="display:none" data-v-761cb514><div class="approve" data-v-761cb514 data-v-761cb514><div class="share-draw" data-v-761cb514><i aria-label="图标: wechat" class="anticon anticon-wechat" data-v-761cb514><svg viewBox="64 64 896 896" focusable="false" data-icon="wechat" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M690.1 377.4c5.9 0 11.8.2 17.6.5-24.4-128.7-158.3-227.1-319.9-227.1C209 150.8 64 271.4 64 420.2c0 81.1 43.6 154.2 111.9 203.6a21.5 21.5 0 0 1 9.1 17.6c0 2.4-.5 4.6-1.1 6.9-5.5 20.3-14.2 52.8-14.6 54.3-.7 2.6-1.7 5.2-1.7 7.9 0 5.9 4.8 10.8 10.8 10.8 2.3 0 4.2-.9 6.2-2l70.9-40.9c5.3-3.1 11-5 17.2-5 3.2 0 6.4.5 9.5 1.4 33.1 9.5 68.8 14.8 105.7 14.8 6 0 11.9-.1 17.8-.4-7.1-21-10.9-43.1-10.9-66 0-135.8 132.2-245.8 295.3-245.8zm-194.3-86.5c23.8 0 43.2 19.3 43.2 43.1s-19.3 43.1-43.2 43.1c-23.8 0-43.2-19.3-43.2-43.1s19.4-43.1 43.2-43.1zm-215.9 86.2c-23.8 0-43.2-19.3-43.2-43.1s19.3-43.1 43.2-43.1 43.2 19.3 43.2 43.1-19.4 43.1-43.2 43.1zm586.8 415.6c56.9-41.2 93.2-102 93.2-169.7 0-124-120.8-224.5-269.9-224.5-149 0-269.9 100.5-269.9 224.5S540.9 847.5 690 847.5c30.8 0 60.6-4.4 88.1-12.3 2.6-.8 5.2-1.2 7.9-1.2 5.2 0 9.9 1.6 14.3 4.1l59.1 34c1.7 1 3.3 1.7 5.2 1.7a9 9 0 0 0 6.4-2.6 9 9 0 0 0 2.6-6.4c0-2.2-.9-4.4-1.4-6.6-.3-1.2-7.6-28.3-12.2-45.3-.5-1.9-.9-3.8-.9-5.7.1-5.9 3.1-11.2 7.6-14.5zM600.2 587.2c-19.9 0-36-16.1-36-35.9 0-19.8 16.1-35.9 36-35.9s36 16.1 36 35.9c0 19.8-16.2 35.9-36 35.9zm179.9 0c-19.9 0-36-16.1-36-35.9 0-19.8 16.1-35.9 36-35.9s36 16.1 36 35.9a36.08 36.08 0 0 1-36 35.9z"></path></svg></i></div></div> <div class="approve" data-v-761cb514><div class="share-draw" data-v-761cb514><i aria-label="图标: weibo-circle" class="anticon anticon-weibo-circle" data-v-761cb514><svg viewBox="64 64 896 896" focusable="false" data-icon="weibo-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-44.4 672C353.1 736 236 680.4 236 588.9c0-47.8 30.2-103.1 82.3-155.3 69.5-69.6 150.6-101.4 181.1-70.8 13.5 13.5 14.8 36.8 6.1 64.6-4.5 14 13.1 6.3 13.1 6.3 56.2-23.6 105.2-25 123.1.7 9.6 13.7 8.6 32.8-.2 55.1-4.1 10.2 1.3 11.8 9 14.1 31.7 9.8 66.9 33.6 66.9 75.5.2 69.5-99.7 156.9-249.8 156.9zm207.3-290.8a34.9 34.9 0 0 0-7.2-34.1 34.68 34.68 0 0 0-33.1-10.7 18.24 18.24 0 0 1-7.6-35.7c24.1-5.1 50.1 2.3 67.7 21.9 17.7 19.6 22.4 46.3 14.9 69.8a18.13 18.13 0 0 1-22.9 11.7 18.18 18.18 0 0 1-11.8-22.9zm106 34.3s0 .1 0 0a21.1 21.1 0 0 1-26.6 13.7 21.19 21.19 0 0 1-13.6-26.7c11-34.2 4-73.2-21.7-101.8a104.04 104.04 0 0 0-98.9-32.1 21.14 21.14 0 0 1-25.1-16.3 21.07 21.07 0 0 1 16.2-25.1c49.4-10.5 102.8 4.8 139.1 45.1 36.3 40.2 46.1 95.1 30.6 143.2zm-334.5 6.1c-91.4 9-160.7 65.1-154.7 125.2 5.9 60.1 84.8 101.5 176.2 92.5 91.4-9.1 160.7-65.1 154.7-125.3-5.9-60.1-84.8-101.5-176.2-92.4zm80.2 141.7c-18.7 42.3-72.3 64.8-117.8 50.1-43.9-14.2-62.5-57.7-43.3-96.8 18.9-38.4 68-60.1 111.5-48.8 45 11.7 68 54.2 49.6 95.5zm-93-32.2c-14.2-5.9-32.4.2-41.2 13.9-8.8 13.8-4.7 30.2 9.3 36.6 14.3 6.5 33.2.3 42-13.8 8.8-14.3 4.2-30.6-10.1-36.7zm34.9-14.5c-5.4-2.2-12.2.5-15.4 5.8-3.1 5.4-1.4 11.5 4.1 13.8 5.5 2.3 12.6-.3 15.8-5.8 3-5.6 1-11.8-4.5-13.8z"></path></svg></i></div></div> <div class="approve" data-v-761cb514><div class="share-draw" data-v-761cb514><i aria-label="图标: qq" class="anticon anticon-qq" data-v-761cb514><svg viewBox="64 64 896 896" focusable="false" data-icon="qq" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M824.8 613.2c-16-51.4-34.4-94.6-62.7-165.3C766.5 262.2 689.3 112 511.5 112 331.7 112 256.2 265.2 261 447.9c-28.4 70.8-46.7 113.7-62.7 165.3-34 109.5-23 154.8-14.6 155.8 18 2.2 70.1-82.4 70.1-82.4 0 49 25.2 112.9 79.8 159-26.4 8.1-85.7 29.9-71.6 53.8 11.4 19.3 196.2 12.3 249.5 6.3 53.3 6 238.1 13 249.5-6.3 14.1-23.8-45.3-45.7-71.6-53.8 54.6-46.2 79.8-110.1 79.8-159 0 0 52.1 84.6 70.1 82.4 8.5-1.1 19.5-46.4-14.5-155.8z"></path></svg></i></div></div> <div class="approve" data-v-761cb514><div class="share-draw" data-v-761cb514><i aria-label="图标: link" class="anticon anticon-link" data-v-761cb514><svg viewBox="64 64 896 896" focusable="false" data-icon="link" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M574 665.4a8.03 8.03 0 0 0-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 0 0-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 0 0 0 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 0 0 0 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 0 0-11.3 0L372.3 598.7a8.03 8.03 0 0 0 0 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z"></path></svg></i></div></div></div></div></div></div> <div class="main" data-v-761cb514><!----> <div class="main-warpper" data-v-761cb514><div class="artical-header" data-v-761cb514><div class="title" data-v-761cb514><span class="title-span" data-v-761cb514>预警：基于Plex媒体播放平台的DDoS反射攻击来袭</span> <!----> <!----> <!----> <!----></div> <div class="author-info" data-v-761cb514><div class="author-left" data-v-761cb514><a href="" class="author" data-v-761cb514><i aria-label="图标: user" class="anticon anticon-user" data-v-761cb514><svg viewBox="64 64 896 896" focusable="false" data-icon="user" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M858.5 763.6a374 374 0 0 0-80.6-119.5 375.63 375.63 0 0 0-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 0 0-80.6 119.5A371.7 371.7 0 0 0 136 901.8a8 8 0 0 0 8 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 0 0 8-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"></path></svg></i>
                   <!----></a> <span class="date" style="margin:0 15px" data-v-761cb514><i aria-label="图标: clock-circle" class="anticon anticon-clock-circle" data-v-761cb514><svg viewBox="64 64 896 896" focusable="false" data-icon="clock-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"></path><path d="M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"></path></svg></i>2021-01-08 19:38:17
                </span> <span class="review" style="margin-right:15px" data-v-761cb514><i aria-label="图标: fire" class="anticon anticon-fire" data-v-761cb514><svg viewBox="64 64 896 896" focusable="false" data-icon="fire" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M834.1 469.2A347.49 347.49 0 0 0 751.2 354l-29.1-26.7a8.09 8.09 0 0 0-13 3.3l-13 37.3c-8.1 23.4-23 47.3-44.1 70.8-1.4 1.5-3 1.9-4.1 2-1.1.1-2.8-.1-4.3-1.5-1.4-1.2-2.1-3-2-4.8 3.7-60.2-14.3-128.1-53.7-202C555.3 171 510 123.1 453.4 89.7l-41.3-24.3c-5.4-3.2-12.3 1-12 7.3l2.2 48c1.5 32.8-2.3 61.8-11.3 85.9-11 29.5-26.8 56.9-47 81.5a295.64 295.64 0 0 1-47.5 46.1 352.6 352.6 0 0 0-100.3 121.5A347.75 347.75 0 0 0 160 610c0 47.2 9.3 92.9 27.7 136a349.4 349.4 0 0 0 75.5 110.9c32.4 32 70 57.2 111.9 74.7C418.5 949.8 464.5 959 512 959s93.5-9.2 136.9-27.3A348.6 348.6 0 0 0 760.8 857c32.4-32 57.8-69.4 75.5-110.9a344.2 344.2 0 0 0 27.7-136c0-48.8-10-96.2-29.9-140.9zM713 808.5c-53.7 53.2-125 82.4-201 82.4s-147.3-29.2-201-82.4c-53.5-53.1-83-123.5-83-198.4 0-43.5 9.8-85.2 29.1-124 18.8-37.9 46.8-71.8 80.8-97.9a349.6 349.6 0 0 0 58.6-56.8c25-30.5 44.6-64.5 58.2-101a240 240 0 0 0 12.1-46.5c24.1 22.2 44.3 49 61.2 80.4 33.4 62.6 48.8 118.3 45.8 165.7a74.01 74.01 0 0 0 24.4 59.8 73.36 73.36 0 0 0 53.4 18.8c19.7-1 37.8-9.7 51-24.4 13.3-14.9 24.8-30.1 34.4-45.6 14 17.9 25.7 37.4 35 58.4 15.9 35.8 24 73.9 24 113.1 0 74.9-29.5 145.4-83 198.4z"></path></svg></i>
                </span> <!----></div> <div data-v-761cb514><!----></div></div> <!----> <!----></div> <div class="artical-body" data-v-761cb514><div class="payread-panel" data-v-761cb514><div id="tinymce-editor" class="content-detail" data-v-761cb514><div><h2 id="h2-1"><strong>0x00</strong><strong>概述</strong></h2><p>百度智云盾团队在2021年1月首次捕获到利用Plex（媒体播放平台）的网络服务发起的DDoS反射攻击。据现有资料表明，这种反射攻击方式尚属全网首次出现，智云盾系统在2秒内识别攻击，实时对流量做了隔离和清洗，保障用户免遭DDoS的伤害。</p><p>本次攻击事件中黑客利用了基于Plex服务发起的DDoS反射攻击，Plex是一套媒体播放平台，基于UDP协议提供服务，由于UDP协议的不可靠性质，导致开启该服务的主机容易被黑客利用作为反射源进行DDoS反射攻击。</p><h2 id="h2-2"><strong>0x01</strong><strong>反射原理</strong></h2><p>攻击者采用反射方式实施DDoS攻击时，不是直接攻击受害者IP，而是伪造了大量受害者IP的请求发给相应的开放服务，通常这类开放服务不对源进行校验而是立即完成响应，这样更大更多的响应数据包发送到受害者IP，从而实现了流量的反射，这类开放服务就是反射源。</p><p>原理如下图所示：</p><p><img src="https://image.3001.net/images/20210108/1610105244_5ff8419ca9d7e1f2b32e4.png!small" alt="" width="423" height="299"></p><p style="text-align:center">图1 反射攻击原理示意图</p><p>图1中攻击者P伪造了请求包BA并发送到PA，但BA的源IP是PV，所以PA响应的时候发送BV给到PV。</p><p>反射攻击一方面隐藏了攻击IP，同时还有一个重要特征是放大，上述原理图中的BV往往是BA的好几倍，甚至是成千上万倍。正是有了这样的特性，黑客组织乐此不疲的使用这一攻击方式，并不断的研究新型反射攻击增强攻击效果。</p><h2 id="h2-3"><strong>0x02</strong><strong>攻击分析</strong></h2><p>智云盾系统检测到攻击时，自动对攻击流量进行采样，安全专家对采样包及时进行了深层次的分析和演练。本次攻击事件共涉及反射源2451个。</p><h3 id="h3-1">攻击包分析</h3><p>通过分析智云盾的攻击采样包发现，反射流量的端口来自于32414端口，下图红色箭头指向的是反射源端口：</p><p><img src="https://image.3001.net/images/20210108/1610105283_5ff841c35b57fe7063817.png!small" alt="" width="485" height="302"></p><p style="text-align:center">图2 采样包内攻击来源端口图</p><p>采样包中udp携带的攻击载荷如下图所示：</p><p><img src="https://image.3001.net/images/20210108/1610105307_5ff841db7282cbad9df1b.png!small" alt="" width="514" height="267"></p><p style="text-align:center">图3 攻击载荷</p><p>数据包中的攻击载荷固定包含plex/media-server，通过搜索分析，这是一套媒体播放平台的服务器软件。攻击载荷如下图所示：</p><p><img src="https://image.3001.net/images/20210108/1610105329_5ff841f13bf225993761e.png!small" alt="" width="690" height="206"></p><p style="text-align:center">图4 格式化后的攻击载荷</p><h3 id="h3-2">攻击模拟</h3><p>为了进一步分析，我们在一台纯净的ubuntu16.04上安装了Plex服务，安装完成后查看服务绑定的端口号，如下图所示：</p><p><img src="https://image.3001.net/images/20210108/1610105353_5ff842091ea7240931c98.png!small" alt="" width="516" height="259"></p><p style="text-align:center">图5</p><p>可以看到Plex服务监听32410、32412、32413和32414四个udp端口，通过对攻击载荷的分析，并借鉴设备查询请求的消息格式，我们编写软件向这几个端口发送攻击载荷为M-SEARCH * HTTP/1.1的udp数据包，并针对反射源IP进行抓包，最后发现32410与32414均有响应。复现攻击如下图所示：</p><p><img src="https://image.3001.net/images/20210108/1610105378_5ff842226aa03d76c3db0.png!small" alt="" width="507" height="277"></p><p style="text-align:center">图6 反射源的响应</p><p style="text-align:center"><img src="https://image.3001.net/images/20210108/1610105397_5ff84235ca34fd71d95e4.png!small" alt="" width="690" height="179">图7 抓包结果</p><p>我们在模拟攻击请求的验证中，发出一个载荷长度为20字节，获取到的响应包载荷为258字节。</p><h3 id="h3-3">放大倍数</h3><p>按照我们前期对反射倍数的研究结果，科学的统计放大倍数，应当包括数据包协议头和网络帧间隙。详细的方案可以参阅《<a href="https://anquan.baidu.com/article/180">MEMCACHED DRDoS攻击趋势</a>》一文。</p><p>协议头和网络帧间隙计算为：14（以太头）+20（IP头）+8（UDP头）+4（FCS头）+20（帧间隙）=66字节，所以计算实际响应的数据包大小为258+66=324字节，请求包大小为20+66=86字节。</p><p>最终我们计算得到的放大倍数为324/86=3.77倍。</p><p>对比udpflood可以伪造大数据包攻击，3.77倍的放大攻击实际能达到的效果并不理想，攻击者之所以热衷于此类探索，一方面是反射攻击是个『技术活』，另一方面他们还有一个倍数『更大』的计算方法，业内也比较流行，就是只计算请求响应的载荷比。这里的Plex反射则可以达到258/20=12.9倍，放大倍数一下就超过了10倍。</p><h2 id="h2-4"><strong>0x03</strong><strong>反射源分析</strong></h2><h3 id="h3-4">Plex服务介绍</h3><p>Plex是一套全面的影音媒体播放平台，包括一整套媒体播放器及服务器软件，个人用户可以利用这个平台整理电脑、NAS、XBOX等设备上的电影、音乐、电视和图片文件，并可以方便的在朋友间分享。Plex服务向个人用户免费开放，支持大多数平台，随着家庭影音的普及，相信未来部署Plex服务系统或设备会越来越多。</p><h3 id="h3-5">全网数据</h3><p>我们在shodan、zoomeye等全网扫描数据库中查询32410、32414等端口获取到的IP数据非常少，说明当前Plex服务受关注度还比较低。</p><p>受限于其他原因，我们没有对Plex服务进行全网扫描。</p><h3 id="h3-6">反射源分析</h3><p>对参与此次攻击的反射源进行了调查分析，其中被利用的反射源主要来源于海外。下图是IP分布情况：</p><p><img src="https://image.3001.net/images/20210108/1610105491_5ff84293f17422be8afb8.png!small" alt="" width="503" height="313"></p><p style="text-align:center">图8 反射源IP分布</p><p>通过分析攻击包载荷中的name字段（主机标识）可以发现，主机标识大多数不重复，且未使用默认的主机标识，多数为个人用户配置使用。下图展示了此次攻击的反射源主机信息：</p><p style="text-align:center"><img src="https://image.3001.net/images/20210108/1610105509_5ff842a5c4a3b99e234e1.png!small" alt="" width="528" height="272">图9 反射源的主机信息</p><h2 id="h2-5"><strong>0x04</strong><strong>防范建议</strong></h2><p>反射攻击与传统的flood攻击相比，能更好的隐藏攻击者，并且产生的流量更大，因而反射攻击越来越受到黑客青睐。</p><p>建议参考以下方式提升防护能力。</p><ul><li><p>对互联网服务应避免被滥用，充当黑客攻击的帮凶</p><ol><li><p>禁用UDP服务，不能禁用时，应确保响应与请求不要有倍数关系</p></li><li><p>启用的UDP服务应采取授权认证，对未授权请求不予响应</p></li></ol></li><li><p>对企业用户应做好防范，减少DDoS对自有网络和业务的影响</p><ol><li><p>如果没有UDP相关业务，可以在上层交换机或者本机防火墙过滤UDP包</p></li><li><p>寻求运营商提供UDP黑洞的IP网段做对外网站服务</p></li><li><p>选择接入DDoS云防安全服务对抗大规模的DDoS攻击</p></li></ol></li></ul><h3 id="h3-7">DDoS攻击防护：<a href="https://anquan.baidu.com/productDetail/1">https://anquan.baidu.com/productDetail/1</a></h3></div></div> <!----> <div class="other-panel" data-v-761cb514><!----> <!----></div> <!----> <!----></div> <div class="tags-panel" data-v-761cb514><div data-v-761cb514><span class="tag" data-v-761cb514><span class="spot" data-v-761cb514><i class="pot" data-v-761cb514></i></span> <span class="txt" data-v-761cb514># 资讯</span></span><span class="tag" data-v-761cb514><span class="spot" data-v-761cb514><i class="pot" data-v-761cb514></i></span> <span class="txt" data-v-761cb514># web安全</span></span><span class="tag" data-v-761cb514><span class="spot" data-v-761cb514><i class="pot" data-v-761cb514></i></span> <span class="txt" data-v-761cb514># 企业安全</span></span></div></div> <div class="original-user" data-v-761cb514><!----> <div class="user-tips" data-v-761cb514>
                本文为<span data-v-761cb514>  </span>独立观点，未经允许不得转载，授权请联系FreeBuf客服小蜜蜂，微信：freebee2022
              </div></div></div></div> <!----> <div class="remix-module" data-v-761cb514><div class="module-title" data-v-761cb514><div class="title" data-v-761cb514>
              被以下专辑收录，发现更多精彩内容
              <!----></div></div> <div class="content column-module" data-v-761cb514><div class="add column-tag" style="background:#f1fff9" data-v-761cb514>
              + 收入我的专辑
            </div> <div class="add column-tag" style="background:#f1fff9" data-v-761cb514>
              + 加入我的收藏
            </div>  <div class="add column-tag" style="display:none" data-v-761cb514><span data-v-761cb514>展开更多</span> <span class="arrow" data-v-761cb514><i aria-label="图标: down" class="anticon anticon-down" data-v-761cb514><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></div></div></div> <div class="introduce" data-v-761cb514><div class="module-title" data-v-761cb514><div class="title" data-v-761cb514>
              相关推荐
            </div></div> <div class="intro-list" data-v-761cb514></div></div></div> <div class="aside-right" data-v-761cb514><div class="module-top" data-v-761cb514><div class="author-panel" data-v-761cb514><div class="top-panel" data-v-761cb514><div class="avatar" data-v-761cb514><span data-v-761cb514><img src="" data-v-761cb514></span></div> <div class="info" data-v-761cb514><div class="name-info" data-v-761cb514><span class="name" data-v-761cb514></span> <!----> <!----> <!----></div> <div class="desc text-line-3" data-v-761cb514>
                  
                </div> <p class="follow-view" data-v-761cb514><button type="button" class="focus ant-btn ant-btn-colorBorder" style="margin-top:20px;width:132px" data-v-761cb514><span>关 注</span></button></p></div></div> <ul class="number-panel" data-v-761cb514><li class="item" data-v-761cb514><span class="num" data-v-761cb514>0</span> <span data-v-761cb514>文章数</span></li> <li class="item" data-v-761cb514><span class="num" data-v-761cb514>0</span> <span data-v-761cb514>关注者</span></li></ul></div> <!----> <!----></div> <div class="module-middle" data-v-761cb514></div> <div class="module-container" data-v-761cb514><div class="module-bottom" data-v-761cb514><div class="h-title" data-v-761cb514>
              文章目录
            </div> <div class="menu-panel scroll-view" data-v-761cb514><div class="list-name" data-v-761cb514><div data-id="h2-1" class="name" data-v-761cb514><span data-v-761cb514>0x00概述</span></div> <div class="list-panel" data-v-761cb514><div class="line" data-v-761cb514></div> <ul data-v-761cb514></ul></div></div><div class="list-name" data-v-761cb514><div data-id="h2-2" class="name" data-v-761cb514><span data-v-761cb514>0x01反射原理</span></div> <div class="list-panel" data-v-761cb514><div class="line" data-v-761cb514></div> <ul data-v-761cb514></ul></div></div><div class="list-name" data-v-761cb514><div data-id="h2-3" class="name" data-v-761cb514><span data-v-761cb514>0x02攻击分析</span></div> <div class="list-panel" data-v-761cb514><div class="line" data-v-761cb514></div> <ul data-v-761cb514><li data-id="h3-1" class="active" data-v-761cb514><span data-v-761cb514>攻击包分析</span></li><li data-id="h3-2" data-v-761cb514><span data-v-761cb514>攻击模拟</span></li><li data-id="h3-3" data-v-761cb514><span data-v-761cb514>放大倍数</span></li></ul></div></div><div class="list-name" data-v-761cb514><div data-id="h2-4" class="name" data-v-761cb514><span data-v-761cb514>0x03反射源分析</span></div> <div class="list-panel" data-v-761cb514><div class="line" data-v-761cb514></div> <ul data-v-761cb514><li data-id="h3-4" data-v-761cb514><span data-v-761cb514>Plex服务介绍</span></li><li data-id="h3-5" data-v-761cb514><span data-v-761cb514>全网数据</span></li><li data-id="h3-6" data-v-761cb514><span data-v-761cb514>反射源分析</span></li></ul></div></div><div class="list-name" data-v-761cb514><div data-id="h2-5" class="name" data-v-761cb514><span data-v-761cb514>0x04防范建议</span></div> <div class="list-panel" data-v-761cb514><div class="line" data-v-761cb514></div> <ul data-v-761cb514><li data-id="h3-7" data-v-761cb514><span data-v-761cb514>DDoS攻击防护：https://anquan.baidu.com/productDetail/1</span></li></ul></div></div></div></div></div></div></div> <!----> <!----> <!----> <div data-v-2a4dba56 data-v-761cb514><!----></div> <!----> <!----> <!----> <!----> <div data-v-1adb0fca data-v-761cb514><!----></div></div></main> <footer class="ant-layout-footer" data-v-55d8de90><div class="footer" data-v-efda12b0 data-v-55d8de90><div class="container" data-v-efda12b0><div class="footer-left" data-v-efda12b0><img src="/images/logo_b.png" data-v-efda12b0> <p data-v-efda12b0><span data-v-efda12b0>本站由</span>阿里云 提供计算与安全服务</p></div> <div class="footer-center clearfix" data-v-efda12b0><div class="footer-list" data-v-efda12b0><h3 data-v-efda12b0>用户服务</h3> <ul data-v-efda12b0><li data-v-efda12b0><a target="_blank" href="https://www.freebuf.com/write" data-v-efda12b0>有奖投稿</a></li> <li data-v-efda12b0><a target="_blank" href="https://www.vulbox.com/bounties/detail-72" data-v-efda12b0>提交漏洞</a></li> <li data-v-efda12b0><a target="_blank" href="https://www.vulbox.com/projects/list" data-v-efda12b0>参与众测</a></li> <li data-v-efda12b0><a target="_blank" href="https://shop.freebuf.com" data-v-efda12b0>商城</a></li></ul></div> <div class="footer-list" data-v-efda12b0><h3 data-v-efda12b0>企业服务</h3> <ul data-v-efda12b0><li data-v-efda12b0><a target="_blank" href="https://company.freebuf.com" data-v-efda12b0>安全咨询</a></li> <li data-v-efda12b0><a target="_blank" href="https://www.freebuf.com/news/307349.html" data-v-efda12b0>产业全景图</a></li> <li data-v-efda12b0><a target="_blank" href="https://www.vulbox.com/service/src" data-v-efda12b0>企业SRC</a></li> <li data-v-efda12b0><a target="_blank" href="https://www.vulbox.com/" data-v-efda12b0>安全众测</a></li></ul></div> <div class="footer-list" data-v-efda12b0><h3 data-v-efda12b0>合作信息</h3> <ul data-v-efda12b0><li data-v-efda12b0><a target="_blank" href="https://www.tophant.com/" data-v-efda12b0>斗象官网</a></li> <li data-v-efda12b0><a target="_blank" href="https://www.freebuf.com/advertise" data-v-efda12b0>广告投放</a></li> <li data-v-efda12b0><a target="_blank" href="mailto:help@freebuf.com" data-v-efda12b0>联系我们</a></li> <li data-v-efda12b0><a target="_blank" href="https://www.freebuf.com/friends" data-v-efda12b0>友情链接</a></li></ul></div> <div class="footer-list" data-v-efda12b0><h3 data-v-efda12b0>关于我们</h3> <ul data-v-efda12b0><li data-v-efda12b0><a target="_blank" href="https://www.freebuf.com/news/others/864.html" data-v-efda12b0>关于我们</a></li> <li data-v-efda12b0><a target="_blank" href="https://www.freebuf.com/jobs/40386.html" data-v-efda12b0>加入我们</a></li> <li data-v-efda12b0><div class="weixin-pannel weixin" data-v-efda12b0 data-v-efda12b0><a href="javascript:;" class="g-icon-qr1" data-v-efda12b0>微信公众号</a></div></li> <li data-v-efda12b0><a target="_blank" href="http://weibo.com/freebuf" data-v-efda12b0>新浪微博</a></li></ul></div> <div class="footer-list" data-v-efda12b0><h3 data-v-efda12b0>战略伙伴</h3> <ul data-v-efda12b0><li style="padding:0 0 10px" data-v-efda12b0><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf" data-v-efda12b0><img src="https://image.3001.net/images/20191017/1571306518_5da83c1686dd9.png" data-v-efda12b0></a></li> <li style="padding:0 0 10px" data-v-efda12b0><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf" data-v-efda12b0><img src="https://image.3001.net/images/20191017/1571310907_5da84d3bbdf2c.png" data-v-efda12b0></a></li> <li style="padding:0 0 10px" data-v-efda12b0><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf" data-v-efda12b0><img src="https://image.3001.net/images/20191017/1571306606_5da83c6e8de1c.png" data-v-efda12b0></a></li></ul></div></div> <div class="footer-right" data-v-efda12b0><h3 data-v-efda12b0>FreeBuf+小程序</h3> <img src="/images/xcx-code.png" alt data-v-efda12b0> <p data-v-efda12b0>扫码把安全装进口袋</p></div></div> <div class="copyright" data-v-efda12b0><div class="container" data-v-efda12b0><ul class="clearfix" data-v-efda12b0><li data-v-efda12b0><a href="https://www.tophant.com/" target="_blank" data-v-efda12b0>斗象科技</a></li> <li data-v-efda12b0><a href="https://www.freebuf.com" target="_blank" data-v-efda12b0>FreeBuf</a></li> <li data-v-efda12b0><a href="https://www.vulbox.com/" target="_blank" data-v-efda12b0>漏洞盒子</a></li> <li data-v-efda12b0><a href="https://www.tophant.ai/" target="_blank" data-v-efda12b0>斗象智能安全平台</a></li> <li data-v-efda12b0><a href="https://www.freebuf.com/dis" target="_blank" data-v-efda12b0>免责条款</a></li> <li data-v-efda12b0><a href="https://my.freebuf.com/AgreeProtocol/duty" target="_blank" data-v-efda12b0>协议条款</a></li></ul> <p data-v-efda12b0>
        Copyright © 2024 WWW.FREEBUF.COM All Rights Reserved
        <a rel="nofollow" target="_blank" href="https://beian.miit.gov.cn/#/Integrated/index" data-v-efda12b0>
             沪ICP备2024099014号
        </a> <span style="padding:0 8px" data-v-efda12b0>|</span> <a rel="nofollow" target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011502009321" data-v-efda12b0>
          沪公安网备
          <img src="https://image.3001.net/images/20200106/1578291342_5e12d08ec2379.png" style="display:inline-block;width:14px;height:12px;position:relative;top:1px;left:3px" data-v-efda12b0></a></p></div></div></div></footer></section></div></div></div><script>window.__NUXT__=function(e,t,a){return{layout:"articles",data:[{articalId:"260338",jobPosition:e,serverData:{post_title:"预警：基于Plex媒体播放平台的DDoS反射攻击来袭",ip_address:t,post_author:a,nickname:a,post_date:"2021-01-08 19:38:17",post_picture:"https://image.3001.net/images/20210108/1610105745_5ff8439181a56ca3fc005.png!small",category:[{name:"Web安全",slug:"web",url:"https://www.freebuf.com/articles/web"}],tag:[{tag_id:"3",name:"资讯",url:"https://www.freebuf.com/tag/%25e8%25b5%2584%25e8%25ae%25af"},{tag_id:"128",name:"web安全",url:"https://www.freebuf.com/tag/web%25e5%25ae%2589%25e5%2585%25a8"},{tag_id:"1518",name:"企业安全",url:"https://www.freebuf.com/tag/%25e4%25bc%2581%25e4%25b8%259a%25e5%25ae%2589%25e5%2585%25a8"}],post_desc:"本次攻击事件中黑客利用了基于Plex服务发起的DDoS反射攻击。",paid_read:e,vip_read:e,paid_read_amount:"0",post_content:'<h2 id="h2-1"><strong>0x00</strong><strong>概述</strong></h2><p>百度智云盾团队在2021年1月首次捕获到利用Plex（媒体播放平台）的网络服务发起的DDoS反射攻击。据现有资料表明，这种反射攻击方式尚属全网首次出现，智云盾系统在2秒内识别攻击，实时对流量做了隔离和清洗，保障用户免遭DDoS的伤害。</p><p>本次攻击事件中黑客利用了基于Plex服务发起的DDoS反射攻击，Plex是一套媒体播放平台，基于UDP协议提供服务，由于UDP协议的不可靠性质，导致开启该服务的主机容易被黑客利用作为反射源进行DDoS反射攻击。</p><h2 id="h2-2"><strong>0x01</strong><strong>反射原理</strong></h2><p>攻击者采用反射方式实施DDoS攻击时，不是直接攻击受害者IP，而是伪造了大量受害者IP的请求发给相应的开放服务，通常这类开放服务不对源进行校验而是立即完成响应，这样更大更多的响应数据包发送到受害者IP，从而实现了流量的反射，这类开放服务就是反射源。</p><p>原理如下图所示：</p><p><img src="https://image.3001.net/images/20210108/1610105244_5ff8419ca9d7e1f2b32e4.png!small" alt="" width="423" height="299" /></p><p style="text-align:center;">图1 反射攻击原理示意图</p><p>图1中攻击者P伪造了请求包BA并发送到PA，但BA的源IP是PV，所以PA响应的时候发送BV给到PV。</p><p>反射攻击一方面隐藏了攻击IP，同时还有一个重要特征是放大，上述原理图中的BV往往是BA的好几倍，甚至是成千上万倍。正是有了这样的特性，黑客组织乐此不疲的使用这一攻击方式，并不断的研究新型反射攻击增强攻击效果。</p><h2 id="h2-3"><strong>0x02</strong><strong>攻击分析</strong></h2><p>智云盾系统检测到攻击时，自动对攻击流量进行采样，安全专家对采样包及时进行了深层次的分析和演练。本次攻击事件共涉及反射源2451个。</p><h3 id="h3-1">攻击包分析</h3><p>通过分析智云盾的攻击采样包发现，反射流量的端口来自于32414端口，下图红色箭头指向的是反射源端口：</p><p><img src="https://image.3001.net/images/20210108/1610105283_5ff841c35b57fe7063817.png!small" alt="" width="485" height="302" /></p><p style="text-align:center;">图2 采样包内攻击来源端口图</p><p>采样包中udp携带的攻击载荷如下图所示：</p><p><img src="https://image.3001.net/images/20210108/1610105307_5ff841db7282cbad9df1b.png!small" alt="" width="514" height="267" /></p><p style="text-align:center;">图3 攻击载荷</p><p>数据包中的攻击载荷固定包含plex/media-server，通过搜索分析，这是一套媒体播放平台的服务器软件。攻击载荷如下图所示：</p><p><img src="https://image.3001.net/images/20210108/1610105329_5ff841f13bf225993761e.png!small" alt="" width="690" height="206" /></p><p style="text-align:center;">图4 格式化后的攻击载荷</p><h3 id="h3-2">攻击模拟</h3><p>为了进一步分析，我们在一台纯净的ubuntu16.04上安装了Plex服务，安装完成后查看服务绑定的端口号，如下图所示：</p><p><img src="https://image.3001.net/images/20210108/1610105353_5ff842091ea7240931c98.png!small" alt="" width="516" height="259" /></p><p style="text-align:center;">图5</p><p>可以看到Plex服务监听32410、32412、32413和32414四个udp端口，通过对攻击载荷的分析，并借鉴设备查询请求的消息格式，我们编写软件向这几个端口发送攻击载荷为M-SEARCH * HTTP/1.1的udp数据包，并针对反射源IP进行抓包，最后发现32410与32414均有响应。复现攻击如下图所示：</p><p><img src="https://image.3001.net/images/20210108/1610105378_5ff842226aa03d76c3db0.png!small" alt="" width="507" height="277" /></p><p style="text-align:center;">图6 反射源的响应</p><p style="text-align:center;"><img src="https://image.3001.net/images/20210108/1610105397_5ff84235ca34fd71d95e4.png!small" alt="" width="690" height="179" />图7 抓包结果</p><p>我们在模拟攻击请求的验证中，发出一个载荷长度为20字节，获取到的响应包载荷为258字节。</p><h3 id="h3-3">放大倍数</h3><p>按照我们前期对反射倍数的研究结果，科学的统计放大倍数，应当包括数据包协议头和网络帧间隙。详细的方案可以参阅《<a href="https://anquan.baidu.com/article/180">MEMCACHED DRDoS攻击趋势</a>》一文。</p><p>协议头和网络帧间隙计算为：14（以太头）+20（IP头）+8（UDP头）+4（FCS头）+20（帧间隙）=66字节，所以计算实际响应的数据包大小为258+66=324字节，请求包大小为20+66=86字节。</p><p>最终我们计算得到的放大倍数为324/86=3.77倍。</p><p>对比udpflood可以伪造大数据包攻击，3.77倍的放大攻击实际能达到的效果并不理想，攻击者之所以热衷于此类探索，一方面是反射攻击是个『技术活』，另一方面他们还有一个倍数『更大』的计算方法，业内也比较流行，就是只计算请求响应的载荷比。这里的Plex反射则可以达到258/20=12.9倍，放大倍数一下就超过了10倍。</p><h2 id="h2-4"><strong>0x03</strong><strong>反射源分析</strong></h2><h3 id="h3-4">Plex服务介绍</h3><p>Plex是一套全面的影音媒体播放平台，包括一整套媒体播放器及服务器软件，个人用户可以利用这个平台整理电脑、NAS、XBOX等设备上的电影、音乐、电视和图片文件，并可以方便的在朋友间分享。Plex服务向个人用户免费开放，支持大多数平台，随着家庭影音的普及，相信未来部署Plex服务系统或设备会越来越多。</p><h3 id="h3-5">全网数据</h3><p>我们在shodan、zoomeye等全网扫描数据库中查询32410、32414等端口获取到的IP数据非常少，说明当前Plex服务受关注度还比较低。</p><p>受限于其他原因，我们没有对Plex服务进行全网扫描。</p><h3 id="h3-6">反射源分析</h3><p>对参与此次攻击的反射源进行了调查分析，其中被利用的反射源主要来源于海外。下图是IP分布情况：</p><p><img src="https://image.3001.net/images/20210108/1610105491_5ff84293f17422be8afb8.png!small" alt="" width="503" height="313" /></p><p style="text-align:center;">图8 反射源IP分布</p><p>通过分析攻击包载荷中的name字段（主机标识）可以发现，主机标识大多数不重复，且未使用默认的主机标识，多数为个人用户配置使用。下图展示了此次攻击的反射源主机信息：</p><p style="text-align:center;"><img src="https://image.3001.net/images/20210108/1610105509_5ff842a5c4a3b99e234e1.png!small" alt="" width="528" height="272" />图9 反射源的主机信息</p><h2 id="h2-5"><strong>0x04</strong><strong>防范建议</strong></h2><p>反射攻击与传统的flood攻击相比，能更好的隐藏攻击者，并且产生的流量更大，因而反射攻击越来越受到黑客青睐。</p><p>建议参考以下方式提升防护能力。</p><ul><li><p>对互联网服务应避免被滥用，充当黑客攻击的帮凶</p><ol><li><p>禁用UDP服务，不能禁用时，应确保响应与请求不要有倍数关系</p></li><li><p>启用的UDP服务应采取授权认证，对未授权请求不予响应</p></li></ol></li><li><p>对企业用户应做好防范，减少DDoS对自有网络和业务的影响</p><ol><li><p>如果没有UDP相关业务，可以在上层交换机或者本机防火墙过滤UDP包</p></li><li><p>寻求运营商提供UDP黑洞的IP网段做对外网站服务</p></li><li><p>选择接入DDoS云防安全服务对抗大规模的DDoS攻击</p></li></ol></li></ul><h3 id="h3-7">DDoS攻击防护：<a href="https://anquan.baidu.com/productDetail/1">https://anquan.baidu.com/productDetail/1</a></h3>',is_original:e,is_reward:e,is_reproduce:e,post_list:[{name:"0x00概述",id:"h2-1",child:[]},{name:"0x01反射原理",id:"h2-2",child:[]},{name:"0x02攻击分析",id:"h2-3",child:[{id:"h3-1",name:"攻击包分析"},{id:"h3-2",name:"攻击模拟"},{id:"h3-3",name:"放大倍数"}]},{name:"0x03反射源分析",id:"h2-4",child:[{id:"h3-4",name:"Plex服务介绍"},{id:"h3-5",name:"全网数据"},{id:"h3-6",name:"反射源分析"}]},{name:"0x04防范建议",id:"h2-5",child:[{id:"h3-7",name:"DDoS攻击防护：https://anquan.baidu.com/productDetail/1"}]}],share_status:!0},serverMemuRender:!0}],fetch:[],error:null,state:{counter:0,uuid:t,blogIsPlay:e,blogInfo:null,blogIsShow:e,isOpenGeet:e,openFileId:0,audioLoading:e,modal:{exchangeData:t},userInfo:{userInfo:{},skinData:{skin:"classical",vip:e,vip_time:t},dynamicCount:t,columnNumber:t,keyAuth:t,messageCount:{},isParty:e,guestRemind:e}},serverRendered:!0,routePath:"/articles/web/260338.html"}}(!1,"","百度安全实验室")</script><script src="/freebuf/2.1.0.7f26a497a2eb221ea1de.js" defer></script><script src="/freebuf/2.1.0.9de09eb00a6f5848e45d.js" defer></script><script src="/freebuf/2.1.0.c0b276a5b9ee3a7a5a34.js" defer></script><script src="/freebuf/2.1.0.adec09679a5f1ff7f4f1.js" defer></script><script src="/freebuf/2.1.0.b3a8a5d3b07bb45639a0.js" defer></script><script src="/freebuf/2.1.0.1c90b07ce7070207ef8f.js" defer></script><script src="/freebuf/2.1.0.2f44e4b838fc7fc70c40.js" defer></script><script src="/freebuf/2.1.0.689e7dd7cbf544710ee4.js" defer></script><script src="/freebuf/2.1.0.ab4582407bfdec9e4184.js" defer></script><script src="/freebuf/2.1.0.041c5bec9093967514e0.js" defer></script><script src="/freebuf/2.1.0.515b3409dfbccb639d20.js" defer></script><script src="/freebuf/2.1.0.3d76cbae95b53b76724c.js" defer></script><script src="/freebuf/2.1.0.b8023a32ab92b65f00ec.js" defer></script>
</body>
<script>var _czc=_czc||[];!function(){var e=document.createElement("script"),c=(e.src="https://s9.cnzz.com/z.js?id=1281392854&async=1",document.getElementsByTagName("script")[0]);c.parentNode.insertBefore(e,c)}()</script>
  
</html>