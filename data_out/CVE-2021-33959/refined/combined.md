=== Content from github.com_d4fd782a_20250108_131838.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flixiang957%2FCVE-2021-33959)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flixiang957%2FCVE-2021-33959)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=lixiang957%2FCVE-2021-33959)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lixiang957](/lixiang957)
/
**[CVE-2021-33959](/lixiang957/CVE-2021-33959)**
Public

* [Notifications](/login?return_to=%2Flixiang957%2FCVE-2021-33959) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Flixiang957%2FCVE-2021-33959)
* [Star
   1](/login?return_to=%2Flixiang957%2FCVE-2021-33959)

CVE-2021-33959

[1
star](/lixiang957/CVE-2021-33959/stargazers) [0
forks](/lixiang957/CVE-2021-33959/forks) [Branches](/lixiang957/CVE-2021-33959/branches) [Tags](/lixiang957/CVE-2021-33959/tags) [Activity](/lixiang957/CVE-2021-33959/activity)
 [Star](/login?return_to=%2Flixiang957%2FCVE-2021-33959)

 [Notifications](/login?return_to=%2Flixiang957%2FCVE-2021-33959) You must be signed in to change notification settings

* [Code](/lixiang957/CVE-2021-33959)
* [Issues
  0](/lixiang957/CVE-2021-33959/issues)
* [Pull requests
  0](/lixiang957/CVE-2021-33959/pulls)
* [Actions](/lixiang957/CVE-2021-33959/actions)
* [Projects
  0](/lixiang957/CVE-2021-33959/projects)
* [Security](/lixiang957/CVE-2021-33959/security)
* [Insights](/lixiang957/CVE-2021-33959/pulse)

Additional navigation options

* [Code](/lixiang957/CVE-2021-33959)
* [Issues](/lixiang957/CVE-2021-33959/issues)
* [Pull requests](/lixiang957/CVE-2021-33959/pulls)
* [Actions](/lixiang957/CVE-2021-33959/actions)
* [Projects](/lixiang957/CVE-2021-33959/projects)
* [Security](/lixiang957/CVE-2021-33959/security)
* [Insights](/lixiang957/CVE-2021-33959/pulse)

# lixiang957/CVE-2021-33959

    main[Branches](/lixiang957/CVE-2021-33959/branches)[Tags](/lixiang957/CVE-2021-33959/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[1 Commit](/lixiang957/CVE-2021-33959/commits/main/) | | |
| [Images](/lixiang957/CVE-2021-33959/tree/main/Images "Images") | | [Images](/lixiang957/CVE-2021-33959/tree/main/Images "Images") |  |  |
| [README.md](/lixiang957/CVE-2021-33959/blob/main/README.md "README.md") | | [README.md](/lixiang957/CVE-2021-33959/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2021-33959

It can be seen that Plex service listens to the four udp ports 32410, 32412, 32413 and 32414. Through the analysis of the attack payload and using the message format of the device query request for reference, we write software to send udp packets with the attack payload of M-SEARCH \* HTTP/1.1 to these ports, and capture packets for the reflection source IP. Finally, we find that both 32410 and 32414 respond. The recurrence attack is shown in the following figure:

# send request

echo "M-SEARCH \* HTTP/1.1" | nc -4u 32410

# example

[![test](/lixiang957/CVE-2021-33959/raw/main/Images/img.png)](/lixiang957/CVE-2021-33959/blob/main/Images/img.png)

# Affected version

plex media server - 1.21 before

# Reference link

<https://www.freebuf.com/articles/web/260338.html>

## About

CVE-2021-33959

### Resources

[Readme](#readme-ov-file)

[Activity](/lixiang957/CVE-2021-33959/activity)
### Stars

[**1**
star](/lixiang957/CVE-2021-33959/stargazers)
### Watchers

[**1**
watching](/lixiang957/CVE-2021-33959/watchers)
### Forks

[**0**
forks](/lixiang957/CVE-2021-33959/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Flixiang957%2FCVE-2021-33959&report=lixiang957+%28user%29)

## [Releases](/lixiang957/CVE-2021-33959/releases)

No releases published

## [Packages 0](/users/lixiang957/packages?repo_name=CVE-2021-33959)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.freebuf.com_ce14ac84_20250108_131840.html ===

[![freeBuf](/images/logoMax.png)](/) 主站

分类

漏洞

工具

极客

Web安全

系统安全

网络安全

无线安全

设备/客户端安全

数据安全

安全管理

企业安全

工控安全

特色

头条

人物志

活动

视频

观点

招聘

报告

资讯

区块链安全

标准与合规

容器安全

公开课
 [报告](https://www.freebuf.com/report)  [专辑](/column)

* ···
* [公开课](https://live.freebuf.com)
* ···
* [商城](https://shop.freebuf.com)
* ···
* 用户服务
* ···

行业服务

政 府

CNCERT
CNNVD

会员体系（甲方）
会员体系（厂商）
产品名录
企业空间
 [知识大陆](https://wiki.freebuf.com/page)  搜索 ![](/freebuf/img/7aa3bf7.svg) ![](/freebuf/img/181d733.svg) 创作中心     [登录](https://www.freebuf.com/oauth)[注册](https://www.freebuf.com/oauth)

官方公众号企业安全新浪微博

![](/images/gzh_code.jpg)

FreeBuf.COM网络安全行业门户，每日发布专业的安全资讯、技术剖析。

   ![FreeBuf+小程序](/images/xcx-code.jpg)

FreeBuf+小程序把安全装进口袋

  [![](https://image.3001.net/images/20231020/1697804527_653270ef7570cc7356ba8.png)](https://wiki.freebuf.com)     预警：基于Plex媒体播放平台的DDoS反射攻击来袭

* ![]()
* 关注

* [Web安全](https://www.freebuf.com/articles/web)

           预警：基于Plex媒体播放平台的DDoS反射攻击来袭      2021-01-08 19:38:17

## **0x00****概述**

百度智云盾团队在2021年1月首次捕获到利用Plex（媒体播放平台）的网络服务发起的DDoS反射攻击。据现有资料表明，这种反射攻击方式尚属全网首次出现，智云盾系统在2秒内识别攻击，实时对流量做了隔离和清洗，保障用户免遭DDoS的伤害。

本次攻击事件中黑客利用了基于Plex服务发起的DDoS反射攻击，Plex是一套媒体播放平台，基于UDP协议提供服务，由于UDP协议的不可靠性质，导致开启该服务的主机容易被黑客利用作为反射源进行DDoS反射攻击。

## **0x01****反射原理**

攻击者采用反射方式实施DDoS攻击时，不是直接攻击受害者IP，而是伪造了大量受害者IP的请求发给相应的开放服务，通常这类开放服务不对源进行校验而是立即完成响应，这样更大更多的响应数据包发送到受害者IP，从而实现了流量的反射，这类开放服务就是反射源。

原理如下图所示：

![](https://image.3001.net/images/20210108/1610105244_5ff8419ca9d7e1f2b32e4.png!small)

图1 反射攻击原理示意图

图1中攻击者P伪造了请求包BA并发送到PA，但BA的源IP是PV，所以PA响应的时候发送BV给到PV。

反射攻击一方面隐藏了攻击IP，同时还有一个重要特征是放大，上述原理图中的BV往往是BA的好几倍，甚至是成千上万倍。正是有了这样的特性，黑客组织乐此不疲的使用这一攻击方式，并不断的研究新型反射攻击增强攻击效果。

## **0x02****攻击分析**

智云盾系统检测到攻击时，自动对攻击流量进行采样，安全专家对采样包及时进行了深层次的分析和演练。本次攻击事件共涉及反射源2451个。

### 攻击包分析

通过分析智云盾的攻击采样包发现，反射流量的端口来自于32414端口，下图红色箭头指向的是反射源端口：

![](https://image.3001.net/images/20210108/1610105283_5ff841c35b57fe7063817.png!small)

图2 采样包内攻击来源端口图

采样包中udp携带的攻击载荷如下图所示：

![](https://image.3001.net/images/20210108/1610105307_5ff841db7282cbad9df1b.png!small)

图3 攻击载荷

数据包中的攻击载荷固定包含plex/media-server，通过搜索分析，这是一套媒体播放平台的服务器软件。攻击载荷如下图所示：

![](https://image.3001.net/images/20210108/1610105329_5ff841f13bf225993761e.png!small)

图4 格式化后的攻击载荷

### 攻击模拟

为了进一步分析，我们在一台纯净的ubuntu16.04上安装了Plex服务，安装完成后查看服务绑定的端口号，如下图所示：

![](https://image.3001.net/images/20210108/1610105353_5ff842091ea7240931c98.png!small)

图5

可以看到Plex服务监听32410、32412、32413和32414四个udp端口，通过对攻击载荷的分析，并借鉴设备查询请求的消息格式，我们编写软件向这几个端口发送攻击载荷为M-SEARCH \* HTTP/1.1的udp数据包，并针对反射源IP进行抓包，最后发现32410与32414均有响应。复现攻击如下图所示：

![](https://image.3001.net/images/20210108/1610105378_5ff842226aa03d76c3db0.png!small)

图6 反射源的响应

![](https://image.3001.net/images/20210108/1610105397_5ff84235ca34fd71d95e4.png!small)图7 抓包结果

我们在模拟攻击请求的验证中，发出一个载荷长度为20字节，获取到的响应包载荷为258字节。

### 放大倍数

按照我们前期对反射倍数的研究结果，科学的统计放大倍数，应当包括数据包协议头和网络帧间隙。详细的方案可以参阅《[MEMCACHED DRDoS攻击趋势](https://anquan.baidu.com/article/180)》一文。

协议头和网络帧间隙计算为：14（以太头）+20（IP头）+8（UDP头）+4（FCS头）+20（帧间隙）=66字节，所以计算实际响应的数据包大小为258+66=324字节，请求包大小为20+66=86字节。

最终我们计算得到的放大倍数为324/86=3.77倍。

对比udpflood可以伪造大数据包攻击，3.77倍的放大攻击实际能达到的效果并不理想，攻击者之所以热衷于此类探索，一方面是反射攻击是个『技术活』，另一方面他们还有一个倍数『更大』的计算方法，业内也比较流行，就是只计算请求响应的载荷比。这里的Plex反射则可以达到258/20=12.9倍，放大倍数一下就超过了10倍。

## **0x03****反射源分析**

### Plex服务介绍

Plex是一套全面的影音媒体播放平台，包括一整套媒体播放器及服务器软件，个人用户可以利用这个平台整理电脑、NAS、XBOX等设备上的电影、音乐、电视和图片文件，并可以方便的在朋友间分享。Plex服务向个人用户免费开放，支持大多数平台，随着家庭影音的普及，相信未来部署Plex服务系统或设备会越来越多。

### 全网数据

我们在shodan、zoomeye等全网扫描数据库中查询32410、32414等端口获取到的IP数据非常少，说明当前Plex服务受关注度还比较低。

受限于其他原因，我们没有对Plex服务进行全网扫描。

### 反射源分析

对参与此次攻击的反射源进行了调查分析，其中被利用的反射源主要来源于海外。下图是IP分布情况：

![](https://image.3001.net/images/20210108/1610105491_5ff84293f17422be8afb8.png!small)

图8 反射源IP分布

通过分析攻击包载荷中的name字段（主机标识）可以发现，主机标识大多数不重复，且未使用默认的主机标识，多数为个人用户配置使用。下图展示了此次攻击的反射源主机信息：

![](https://image.3001.net/images/20210108/1610105509_5ff842a5c4a3b99e234e1.png!small)图9 反射源的主机信息

## **0x04****防范建议**

反射攻击与传统的flood攻击相比，能更好的隐藏攻击者，并且产生的流量更大，因而反射攻击越来越受到黑客青睐。

建议参考以下方式提升防护能力。

* 对互联网服务应避免被滥用，充当黑客攻击的帮凶

  1. 禁用UDP服务，不能禁用时，应确保响应与请求不要有倍数关系
  2. 启用的UDP服务应采取授权认证，对未授权请求不予响应
* 对企业用户应做好防范，减少DDoS对自有网络和业务的影响

  1. 如果没有UDP相关业务，可以在上层交换机或者本机防火墙过滤UDP包
  2. 寻求运营商提供UDP黑洞的IP网段做对外网站服务
  3. 选择接入DDoS云防安全服务对抗大规模的DDoS攻击

### DDoS攻击防护：<https://anquan.baidu.com/productDetail/1>

       # 资讯 # web安全 # 企业安全
本文为 独立观点，未经允许不得转载，授权请联系FreeBuf客服小蜜蜂，微信：freebee2022

被以下专辑收录，发现更多精彩内容

+ 收入我的专辑

+ 加入我的收藏
 展开更多
相关推荐
  ![]()

关 注

* 0 文章数
* 0 关注者

文章目录
 0x00概述

0x01反射原理

0x02攻击分析

* 攻击包分析
* 攻击模拟
* 放大倍数
0x03反射源分析

* Plex服务介绍
* 全网数据
* 反射源分析
0x04防范建议

* DDoS攻击防护：https://anquan.baidu.com/productDetail/1
          ![](/images/logo_b.png)

本站由阿里云 提供计算与安全服务

### 用户服务

* [有奖投稿](https://www.freebuf.com/write)
* [提交漏洞](https://www.vulbox.com/bounties/detail-72)
* [参与众测](https://www.vulbox.com/projects/list)
* [商城](https://shop.freebuf.com)

### 企业服务

* [安全咨询](https://company.freebuf.com)
* [产业全景图](https://www.freebuf.com/news/307349.html)
* [企业SRC](https://www.vulbox.com/service/src)
* [安全众测](https://www.vulbox.com/)

### 合作信息

* [斗象官网](https://www.tophant.com/)
* [广告投放](https://www.freebuf.com/advertise)
* 联系我们
* [友情链接](https://www.freebuf.com/friends)

### 关于我们

* [关于我们](https://www.freebuf.com/news/others/864.html)
* [加入我们](https://www.freebuf.com/jobs/40386.html)
* 微信公众号
* [新浪微博](http://weibo.com/freebuf)

### 战略伙伴

* [![](https://image.3001.net/images/20191017/1571306518_5da83c1686dd9.png)](http://www.aliyun.com/?freebuf)
* [![](https://image.3001.net/images/20191017/1571310907_5da84d3bbdf2c.png)](http://www.upyun.com/?freebuf)
* [![](https://image.3001.net/images/20191017/1571306606_5da83c6e8de1c.png)](https://www.trustasia.com/?freebuf)

### FreeBuf+小程序

![](/images/xcx-code.png)

扫码把安全装进口袋

* [斗象科技](https://www.tophant.com/)
* [FreeBuf](https://www.freebuf.com)
* [漏洞盒子](https://www.vulbox.com/)
* [斗象智能安全平台](https://www.tophant.ai/)
* [免责条款](https://www.freebuf.com/dis)
* [协议条款](https://my.freebuf.com/AgreeProtocol/duty)

Copyright © 2024 WWW.FREEBUF.COM All Rights Reserved
[沪ICP备2024099014号](https://beian.miit.gov.cn/#/Integrated/index) | [沪公安网备
![](https://image.3001.net/images/20200106/1578291342_5e12d08ec2379.png)](http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011502009321)


