=== Content from johnermac.github.io_00a8a39b_20250110_110136.html ===

## Skip links

* [Skip to primary navigation](#site-nav)
* [Skip to content](#main)
* [Skip to footer](#footer)

[![](/assets/images/main/kaizen.png)](/)

* [Posts](/)
* [Menu](/menu)
* [About](/about)

Toggle search

Toggle menu

# SQL Injection (SQLi)

CVE-2024-2480

1 minute read

Toggle menu

* Posts
  + [- How to become a Pentester (2024)](/insights/roadmap/)
  + [- Security Awareness](/awareness/awarenessdoc/)
  + [- Sliver C2 Basics](/c2/sliverbasics/)
  + ────────────────
* Notes
  + [eJPT](/notes/ejpt/)
  + ────────────────
  + [eCPPTv2](/review/ecppt/)
  + [- System Security](/notes/ecppt/systemsecurity/)
  + [- Network Security](/notes/ecppt/networksecurity/)
  + [- Powershell](/notes/ecppt/powershell/)
  + [- Linux Security](/notes/ecppt/linux/)
  + [- Web App Security](/notes/ecppt/webapp/)
  + [- Wi-Fi Pentest](/notes/ecppt/wifi/)
  + [- Metasploit & Ruby](/notes/ecppt/ruby/)
  + ────────────────
  + [PNPT](/review/pnpt/)
  + [- Practical Ethical Hacker](/notes/pnpt/peh/)
  + [- OSINT](/notes/pnpt/osint/)
  + [- External Pentest Playbook](/notes/pnpt/pentestexternal/)
  + [- Linux Privesc](/notes/pnpt/linuxprivesc/)
  + [- Windows Privesc](/notes/pnpt/winprivesc/)
  + [- Movement, Pivoting and Persistence](/notes/pnpt/wpivoting/)
  + ────────────────
  + [eWPTXv2](/review/eewptx/)
  + [- Encoding & Filtering](/notes/ewptx/encoding/)
  + [- Evasion Basics](/notes/ewptx/evasionbasics/)
  + [- Cross-site scripting (XSS)](/notes/ewptx/xss/)
  + [- XSS Filter Evasion](/notes/ewptx/xssfilter/)
  + [- Cross-site request forgery (CSRF)](/notes/ewptx/csrf/)
  + [- HTML5](/notes/ewptx/html5/)
  + [- SQL Injection](/notes/ewptx/sqli/)
  + [- SQLI Filter Evasion](/notes/ewptx/sqlievasion/)
  + [- XML Attacks](/notes/ewptx/xmlattacks/)
  + [- Attacking Serialization](/notes/ewptx/zattackingserialization/)
  + [- Server Side Attacks](/notes/ewptx/serverside/)
  + [- Attacking Crypto](/notes/ewptx/crypto/)
  + [- Authentication & SSO](/notes/ewptx/authenticationsso/)
  + [- APIs & Cloud Apps](/notes/ewptx/apiscloud/)
  + [- Attacking LDAP](/notes/ewptx/ldap/)
  + ────────────────
  + Active Directory Exploitation
  + [- Powershell](/notes/adx/powershell/)
  + [- Bloodhound](/notes/adx/bloodhound/)
  + [- Win Privesc](/notes/adx/privesc/)
  + [- Lateral Movement](/notes/adx/zlateralmov/)
  + [- AD CS](/notes/adcs/)
  + ────────────────
  + [CRTP](/review/crtp/)
  + [- AD Enumeration](/notes/crtp/enum/)
  + [- Local Privesc](/notes/crtp/winprivesc/)
  + [- Lateral Movement](/notes/crtp/latmov/)
  + [- Offensive .NET](/notes/crtp/offdotnet/)
  + [- AD Persistence](/notes/crtp/domdom/)
  + [- AD Privesc](/notes/crtp/domprivesc/)
  + [- AD Defense](/notes/crtp/defense/)
  + ────────────────
  + [CRTE](/review/crte/)
  + [- Lateral Movement](/notes/crte/latmov/)
  + [- AD Privesc](/notes/crte/adprivesc/)
  + [- AD Persistence](/notes/crte/adpersistence/)
  + [- Cross attacks](/notes/crte/cross/)
  + [- Cheat Sheet](/notes/crte/cheatsheet/)
  + ────────────────
  + CLOUD
  + [- Intro to Cloud Pentesting!](/notes/cloud/introcloud/)
  + [- Get Familiar with Azure!](/notes/cloud/midazure/)
  + [- CARTP Review (Azure)](/review/cartp/)
  + [- Intro & Recon](/notes/cartp/cartp1/)
  + [- Enum & Privilege Escalation](/notes/cartp/cartp2/)
  + [- Lateral mov & Persistence](/notes/cartp/cartp3/)
  + ────────────────
  + CONTAINER
  + [- Hacking Containers!](/notes/container/hackcontainers/)
* My CVEs
  + [CVE-2024-2479](/cve/xss/)
  + [CVE-2024-2480](/cve/sqli/)

| SQL Injection allows authenticated attackers to run unauthorized SQL commands, compromising systems by injecting malicious code into web forms, leading to access to sensitive data, manipulation of database contents, or even complete compromise of the system |
| --- |

During the assessment, a SQL Injection vulnerability was found in MHA Systems.

Through the ‘**Consulta/Executa**’ field, followed by clicking on any of the listed options. This functionality allows us to query records in the database:

![Alt text](/assets/images/posts/cve/images/5.png)

It was identified that in any field of “**Parâmetros**” user input was not filtered. Because of this, our request is sent directly to the database query.

In this case, we inserted a single quote to test the error response:

![Alt text](/assets/images/posts/cve/images/6.png)

The error message states that “SQL was not finished correctly”. With this information at hand, we can proceed further with the tests.

![Alt text](/assets/images/posts/cve/images/7.png)

By changing the parameter to “*‘UNION SELECT 1,2,3;*”, the error message also changes to “*Keyword FROM was not found in the request*”

![Alt text](/assets/images/posts/cve/images/8.png)

With this last test, it was possible to retrieve some information from the database:

![Alt text](/assets/images/posts/cve/images/9.png)

To automate the exploration process, we utilized the tool *SQLMAP* to dump the tables of the database. As shown below, it reveals two types of payloads: Error-based and Time-based blind:

![Alt text](/assets/images/posts/cve/images/10.png)

Below are the results of the *DUMP*:

![Alt text](/assets/images/posts/cve/images/11.png)

![Alt text](/assets/images/posts/cve/images/12.png)

> This vulnerability was discovered by two security researchers:

* João Silveira - [Johnermac](https://johnermac.github.io)
* Leonardo Teodoro - [SQU4NCH](https://squ4nch.github.io)

 **Tags:**
[cve](/tags/#cve),
[web](/tags/#web)

 **Categories:**
[cve](/categories/#cve)

 **Updated:** March 5, 2024

#### Share on

 [Twitter](https://twitter.com/intent/tweet?text=SQL+Injection+%28SQLi%29%20https%3A%2F%2Fjohnermac.github.io%2F%2Fcve%2Fsqli%2F "Share on Twitter")
 [Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fjohnermac.github.io%2F%2Fcve%2Fsqli%2F "Share on Facebook")
 [LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fjohnermac.github.io%2F%2Fcve%2Fsqli%2F "Share on LinkedIn")

[Previous](/awareness/awarenessdoc/ "Security Awareness
")
[Next](/cve/xss/ "Stored cross-site scripting (XSS)
")

Enter your search term...


