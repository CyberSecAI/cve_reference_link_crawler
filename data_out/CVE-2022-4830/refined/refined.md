- **Root cause of vulnerability:** The plugin does not properly validate and escape shortcode attributes before outputting them in the page.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS) vulnerability.
- **Impact of exploitation:** An attacker can inject malicious JavaScript code that executes in the context of a user's browser when they view the affected page. This can be used to perform actions on behalf of the victim user. High privilege users like admins are at risk.
- **Attack vectors:** By inserting a crafted shortcode with malicious JavaScript code in the class attribute of the `pmpro_checkout_button` shortcode, the malicious script is stored in the database. When a user views the page containing the shortcode, the JavaScript code is executed in the user's browser.
- **Required attacker capabilities/position:** An attacker with a role as low as "contributor" can exploit this vulnerability. They can create or edit posts/pages to insert the malicious shortcode.