
<!DOCTYPE HTML>
<html lang="en">
<head><script src="//archive.org/includes/athena.js" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app211.us.archive.org';v.server_ms=790;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="/_static/js/bundle-playback.js?v=HxkREWBo" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=txqj7nKC" charset="utf-8"></script>
<script>window.RufflePlayer=window.RufflePlayer||{};window.RufflePlayer.config={"autoplay":"on","unmuteOverlay":"hidden"};</script>
<script type="text/javascript" src="/_static/js/ruffle/ruffle.js"></script>
<script type="text/javascript">
    __wm.init("https://web.archive.org/web");
  __wm.wombat("https://multibit.org/blog/2015/07/25/bit-flipping-attack.html","20160506095434","https://web.archive.org/","web","/_static/",
	      "1462528474");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=S1zqJCYt" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=3PDvdIFv" />
<!-- End Wayback Rewrite JS Include -->

<meta charset="UTF-8">
<meta http-equiv="Content-type" content="text/html; charset=UTF-8">

<title>MultiBit HD • Desktop Bitcoin wallet</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="MultiBit HD Bitcoin wallet - Official Site"/>
<meta name="keywords" content="multibit,multibit classic,multibit hd,multibithd,bitcoin,bitcoin wallet,bitcoin desktop wallet,bitcoin laptop wallet,bitcoin software,digital currency,trezor,xchange,bip32,bip39,bip44"/>
<meta name="alexaVerifyID" content="7tCwJOsMCYO8h_sG800FoCMpMJc"/>
<meta name="author" content="Gary Rowe"/>

<link rel="shortcut icon" href="/web/20160506095434im_/https://multibit.org/images/favicon.png">

<script src="https://web.archive.org/web/20160506095434js_/https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js" type="application/javascript"></script>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="//web.archive.org/web/20160506095434cs_/https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" type="text/css">

<!-- Optional theme -->
<link rel="stylesheet" href="//web.archive.org/web/20160506095434cs_/https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css" type="text/css">

<!-- Latest compiled and minified JavaScript -->
<script src="https://web.archive.org/web/20160506095434js_/https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js" type="application/javascript"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js" type="application/javascript"></script>
<![endif]-->

<link rel="stylesheet" href="https://web.archive.org/web/20160506095434cs_/https://fonts.googleapis.com/css?family=Corben" type="text/css">
<link rel="stylesheet" href="https://web.archive.org/web/20160506095434cs_/https://fonts.googleapis.com/css?family=Roboto" type="text/css">
<link rel="stylesheet" href="https://web.archive.org/web/20160506095434cs_/https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" type="text/css">

<link rel="stylesheet" href="/web/20160506095434cs_/https://multibit.org/css/main.css" type="text/css"/>
</head>
<body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display:none;direction:ltr;">
<div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;">
<div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=https%3A//web.archive.org/web/20160506095434/https%3A//multibit.org/blog/2015/07/25/bit-flipping-attack.html"
	    scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><div id="wm-ipp-inside">
  <div id="wm-toolbar" style="position:relative;display:flex;flex-flow:row nowrap;justify-content:space-between;">
    <div id="wm-logo" style="/*width:110px;*/padding-top:12px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="/_static/images/toolbar/wayback-toolbar-logo-100.png, /_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, /_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0" /></a>
    </div>
    <div class="c" style="display:flex;flex-flow:column nowrap;justify-content:space-between;flex:1;">
      <form class="u" style="display:flex;flex-direction:row;flex-wrap:nowrap;" target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="https://multibit.org/blog/2015/07/25/bit-flipping-attack.html" onfocus="this.focus();this.select();" style="flex:1;"/><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20160506095434" /><input type="submit" value="Go" />
      </form>
      <div style="display:flex;flex-flow:row nowrap;align-items:flex-end;">
                <div class="s" id="wm-nav-captures" style="flex:1;">
                    <a class="t" href="/web/20160506095434*/https://multibit.org/blog/2015/07/25/bit-flipping-attack.html" title="See a list of every capture for this URL">4 captures</a>
          <div class="r" title="Timespan for captures of this URL">06 May 2016 - 27 Sep 2023</div>
          </div>
        <div class="k">
          <a href="" id="wm-graph-anchor">
            <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
              <canvas id="wm-sparkline-canvas" width="750" height="27" border="0"></canvas>
            </div>
          </a>
        </div>
      </div>
    </div>
    <div class="n">
      <table>
        <tbody>
          <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
          <tr class="m">
            <td class="b" nowrap="nowrap">Apr</td>
            <td class="c" id="displayMonthEl" title="You are here: 09:54:34 May 06, 2016">MAY</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20201108131214/https://multibit.org/blog/2015/07/25/bit-flipping-attack.html" title="08 Nov 2020"><strong>Nov</strong></a></td>
          </tr>
          <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
          <tr class="d">
            <td class="b" nowrap="nowrap"><img src="/_static/images/toolbar/wm_tb_prv_off.png" alt="Previous capture" width="14" height="16" border="0" /></td>
            <td class="c" id="displayDayEl" style="width:34px;font-size:22px;white-space:nowrap;" title="You are here: 09:54:34 May 06, 2016">06</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20201108131214/https://multibit.org/blog/2015/07/25/bit-flipping-attack.html" title="13:12:14 Nov 08, 2020"><img src="/_static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0" /></a></td>
          </tr>
          <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
          <tr class="y">
            <td class="b" nowrap="nowrap">2015</td>
            <td class="c" id="displayYearEl" title="You are here: 09:54:34 May 06, 2016">2016</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20201108131214/https://multibit.org/blog/2015/07/25/bit-flipping-attack.html" title="08 Nov 2020"><strong>2020</strong></a></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="r" style="display:flex;flex-flow:column nowrap;align-items:flex-end;justify-content:space-between;">
      <div id="wm-btns" style="text-align:right;height:23px;">
                <span class="xxs">
          <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="#" title="Share via My Web Archive" >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php" title="Sign In" id="wm-sign-in">
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
        </span>
                <a class="xxs" href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
        <a id="wm-tb-close" href="#close" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" class="xxs">
        <a href="/web/20160506095434/http://web.archive.org/screenshot/https://multibit.org/blog/2015/07/25/bit-flipping-attack.html"
           id="wm-screenshot"
           title="screenshot">
          <span class="wm-icon-screen-shot"></span>
        </a>
        <a href="#" id="wm-video" title="video">
          <span class="iconochive-movies"></span>
        </a>
        <a id="wm-share-facebook" href="#" data-url="https://web.archive.org/web/20160506095434/https://multibit.org/blog/2015/07/25/bit-flipping-attack.html" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
        <a id="wm-share-twitter" href="#" data-url="https://web.archive.org/web/20160506095434/https://multibit.org/blog/2015/07/25/bit-flipping-attack.html" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
      <div style="padding-right:2px;text-align:right;white-space:nowrap;">
        <a id="wm-expand" class="wm-btn wm-closed" href="#expand"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span class="xxs" style="font-size:80%;">About this capture</span></a>
      </div>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
        <div id="wm-capinfo-notice" source="api"></div>
                <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/webwidecrawl);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/webwidecrawl" target="_new"><span class="wm-title">Internet Archive</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  The Internet Archive discovers and captures web pages through many different web crawls.

At any given time several distinct crawls are running, some for months, and some every day or longer.

View the web archive through the <a href="http://archive.org/web/web.php">Wayback Machine</a>.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/hackernews00000)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/hackernews00000" target="_new"><span class="wm-title">Hackernews crawl number 0</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Hacker News Crawl of their links.
	</div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="/_static/images/loading.gif" alt="loading" /></div>
    </div>
    </div>
  </div></div></div></div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20160506095434/https://multibit.org/blog/2015/07/25/bit-flipping-attack.html</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(750,27,25,2,"web","https://multibit.org/blog/2015/07/25/bit-flipping-attack.html","20160506095434",1996,"/_static/",["/_static/css/banner-styles.css?v=S1zqJCYt","/_static/css/iconochive.css?v=3PDvdIFv"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->
 
<div class="navbar navbar-inverse" role="navigation">

  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a title="MultiBit HD home" class="navbar-brand hidden-md hidden-lg" href="/web/20160506095434/https://multibit.org/index.html">MultiBit HD</a>
  </div>

  <div class="navbar-collapse collapse">
    <ul class="nav navbar-nav">
    <li><a href="/web/20160506095434/https://multibit.org/download.html" title="Download latest and previous versions">Download</a></li>
<li><a href="/web/20160506095434/https://multibit.org/faq.html" title="Frequently asked questions">FAQ</a></li>
<li><a href="/web/20160506095434/https://multibit.org/community.html" title="The Bitcoin community at a glance">Community</a></li>
<li class="active"><a href="/web/20160506095434/https://multibit.org/blog.html" title="Blog posts">Blog</a></li>
<li><a href="/web/20160506095434/https://multibit.org/help.html" title="Help with this site and our software">Help</a></li>

    </ul>

    <ul class="nav navbar-nav mb-banner-text hidden-md hidden-lg navbar-right">
      <li>
          <a title="KeepKey: A Simple Bitcoin Hardware Wallet" href="/web/20160506095434/https://multibit.org/goto/keep-key/1/small" target="_blank"><strong>KeepKey:&nbsp;A&nbsp;Simple&nbsp;Bitcoin&nbsp;Hardware&nbsp;Wallet</strong></a>
      </li>
    </ul>

  </div>

</div>

<div class="page-header hidden-xs hidden-sm">
  <a title="MultiBit HD home" href="/web/20160506095434/https://multibit.org/index.html"><h1><img class="header-logo" src="/web/20160506095434im_/https://multibit.org/images/clients/MultiBitHD-logo-96x96-simple.png">MultiBit HD</h1>

    <h2>Desktop Bitcoin wallet</h2></a>
  <span class="mb-banner-large pull-right">
    <a title="KeepKey: A Simple Bitcoin Hardware Wallet" href="/web/20160506095434/https://multibit.org/goto/keep-key/1/large" target="_blank"><img src="/web/20160506095434im_/https://multibit.org/images/banner/keepkey-get-yours-banner-512x72.png"></a>
  </span>
  <span class="mb-banner-medium pull-right">
    <a title="KeepKey: A Simple Bitcoin Hardware Wallet" href="/web/20160506095434/https://multibit.org/goto/keep-key/1/medium" target="_blank"><img src="/web/20160506095434im_/https://multibit.org/images/banner/keepkey-get-yours-banner-280x72.png"></a>
  </span>
</div>


<div class="container">

<h3>Bit flipping attack</h3>

<p>This is a guest post from a security researcher who took a close look at the way that <a href="/web/20160506095434/https://multibit.org/en/help/hd0.1/how-brit-works.html">MultiBit receives payment through the BRIT
  system</a>. As part of our <a href="/web/20160506095434/https://multibit.org/en/responsible-disclosure.html">responsible disclosure procedure</a> here are the details of the attack and what has been done to mitigate
  it.<p>

<p>As an ordinary user of MultiBit HD <strong>this does not affect the security of your bitcoins</strong>. That said, it is always best to run on the latest version of MultiBit
  HD so you should upgrade to version 0.1.2 or higher. We announce all our releases on Twitter and our RSS/Atom feed (see below) as a backup to our auto-upgrade system.</p>

<p>If you are a developer with an interest in cryptography we would urge you to read the entirety of the article since it illustrates why AES wrapped in HTTPS does not
  offer sufficient security against certain attacks.</p>

<hr/>

<h4>Overview</h4>

<p>A vulnerability was identified and fixed in MultiBit HD 0.1.2 that allowed an attacker to insert unspendable Bitcoin addresses into the list MultiBit uses to
  send fees to the developers. (CVE-2015-6964)</p>

<h4>Background</h4>

<p>Recently I took a close look at BRIT, the protocol MultiBit uses to send lists of fee addresses from the developers to the wallet users. Each transaction a MultiBit user makes
  earns the developers a small fee that is periodically sent to one of the Bitcoin addresses received via BRIT, or to a hard coded address if no BRIT addresses are available. I
  noticed in the <a href="https://web.archive.org/web/20160506095434/https://github.com/bitcoin-solutions/brit-service/blob/9c725ddc2262ae2b404fbaec76cea34cc9909514/src/main/doc/Early-draft-of-overview-of-BRIT.md" target="_blank">documentation</a> that the fee addresses sent to the user from the server are strongly encrypted, but the messages <em>had no built in
    authentication mechanism</em>. Specifically in step 7 they make the claim that encryption</p>
<blockquote>"...also validates the Matcher is actually the BRIT Matcher and has not been man-in-the-middled."</blockquote>
<p>While it is true that the BRIT Matcher (server) is the only entity that could decrypt the request to get the AES key to use for the exchange, without a message authentication
  code (MAC) the client has no way to know for sure if whatever response it receives was what the server actually sent. The client could receive random garbage and it has no way of
  telling the difference between a response from a server with severe memory issues or just random garbage. More subtle, however, is that the client has no way of telling a valid
  response with some non-malicious corruption from a valid response with malicious corruption. This is bad.</p>

<h4>Technical</h4>

<p>BRIT uses strong encryption to protect the address exchange. Specifically, they use <a href="https://web.archive.org/web/20160506095434/https://en.wikipedia.org/wiki/Advanced_Encryption_Standard" target="_blank">AES-256
  (Advanced Encryption Standard)</a> in <a href="https://web.archive.org/web/20160506095434/https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_Block_Chaining_.28CBC.29" target="_blank">CBC (cipher block
  chaining)</a> mode to encrypt the actual address list. CBC mode has the property that changing the ciphertext of block <code>i</code> causes predictable changes in the
  plaintext of block <code>i+1</code> at the cost of scrambling the plaintext for block <code>i</code>. Any bits flipped in block <code>i</code> will cause the same bits to flip in
  the plaintext for block <code>i+1</code>. This is called a <a href="https://web.archive.org/web/20160506095434/https://en.wikipedia.org/wiki/Bit-flipping_attack" target="_blank">bit flipping attack</a> and it is
  especially powerful when the message has a predictable format.</p>

<p>In the case of BRIT the address list changes every day, but the list is static for all users who request it on the same day. Thus if Eve requests it at 00:01 she will get the
  same list as Bob who requests it at 23:00.</p>

<p>Generally this set of conditions is not good:</p>
<ul>
  <li>the lack of a MAC</li>
  <li>CBC mode</li>
  <li>known plaintext</li>
</ul>

<p>It puts a man-in-the-middle (MITM) attacker, Eve, in a pretty powerful position. Specifically, Eve is able to change up to half of the message arbitrarily <strong>without
  needing to break any encryption</strong> and the client will accept it as valid.</p>

<p>Let's say Eve doesn't like MultiBit and wants to deny it funding. Let's also say that she can:</p>
<ol>
  <li>MITM any connection between a client and server (large ISP, backbone router)</li>
  <li>alter the traffic sent between them </li>
  <li>contact the server once a day (trivial)</li>
  <li>has access to modest computing resources (trivial)</li>
</ol>

<p>Eve is now in a position to cut off nearly all of the fees MultiBit gets if she exploits this vulnerability carefully.</p>

<p>While Bitcoin addresses may look random, they have some strong error detection built in. Specifically, <a href="https://web.archive.org/web/20160506095434/https://en.bitcoin.it/wiki/Technical_background_of_version_1_Bitcoin_addresses" target="_blank"> the last 4 bytes of the address are the first 4 bytes of the double
  SHA-256 of the rest of the address</a>. This means randomly changing any part of an address is very unlikely to still make a valid Bitcoin address. MultiBit does this error
  checking when importing addresses from BRIT so Eve has to do a little work to get a malicious address inserted into MultiBit's fee address list. Luckily for Eve the list is
  static for every single user so any change that still gives her a valid address will work for every user for the entire day.</p>
<p>In this context a malicious address is one that the MultiBit developers do not have control over and can not spend any funds sent to it. Additionally it is very, very
  unlikely that anyone has a corresponding private key for the address so the coins sent to it are effectively burned.</p>

<h4>The attack</h4>

<p>To generate a malicious address:</p>
<ol>
  <li>select an address in the genuine fee list that begins very soon after the start of an AES block boundary (several are guaranteed since 50 addresses are returned)</li>
  <li>randomly change the portion of the address that falls within the AES block until you get one with a valid double SHA-256 checksum</li>
</ol>
<p>The above has a complexity of 2<sup>32</sup> with the actual work being the double SHA-256 calculations. I re-purposed some of the MultiBit and Bitcoinj code to generate
  these malicious addresses and I was able to get ~0.8M cracks/s on my i7-4790K and found an address about every 90 minutes. It's important to note that the work to validate the
  addresses is the same as the proof of work to mine a block, so benchmarks from Bitcoin mining with CPUs and GPUs can be used to get an idea of how much faster finding addresses
  can be done with a better tool or different hardware. <a href="https://web.archive.org/web/20160506095434/https://en.bitcoin.it/wiki/Non-specialized_hardware_comparison" target="_blank">This list</a> shows a similar i7 achieving 66.6Mhash/s
  with a dedicated Bitcoin mining tool, so this attack can be sped up considerably. GPUs (and possibly ASICs) could also be used to further accelerate the attack.</p>

<p>My <a href="https://web.archive.org/web/20160506095434/https://github.com/Marclass/BritExploit">demonstration exploit script</a> generates these addresses at roughly 10 minute intervals at a cost of about 0.20 USD
  per address on an Amazon EC2 C4 instance.</p>

<p>Consider an address from the Bitcoin wiki: <code>16UwLL9Risc3QfP<strong>qBUvKofHmBQ7wMtjvM</strong></code> we can generate some examples of malicious addresses:</p>

<div align="center">
  <table>
    <tbody align="right">

    <tr>
      <td>1yoVWJsArgM6FgL<strong>qBUvKofHmBQ7wMtjvM</strong></td>
    </tr>

    <tr>
      <td>1VEZvA4mApUjvP5<strong>qBUvKofHmBQ7wMtjvM</strong></td>
    </tr>
    <tr>
      <td>1wXXbEVRu9XGzcp<strong>qBUvKofHmBQ7wMtjvM</strong></td>
    </tr>
    <tr>
      <td>13sPH9iJyriu24y<strong>qBUvKofHmBQ7wMtjvM</strong></td>
    </tr>
    <tr>
      <td>1fDmv7J6XTNQmXV<strong>qBUvKofHmBQ7wMtjvM</strong></td>
    </tr>
    <tr>
      <td>11N3myPVa79dJCi<strong>qBUvKofHmBQ7wMtjvM</strong></td>
    </tr>
    <tr>
      <td>1Cv2dEJFA11R3Yj<strong>qBUvKofHmBQ7wMtjvM</strong></td>
    </tr>
    <tr>
      <td>17aq24aB6jMDt4g<strong>qBUvKofHmBQ7wMtjvM</strong></td>
    </tr>
    <tr>
      <td>1ZuW4d5rqL9giyF<strong>qBUvKofHmBQ7wMtjvM</strong></td>
    </tr>
    <tr>
      <td>11YKLgUDqxXD8Do<strong>qBUvKofHmBQ7wMtjvM</strong></td>
    </tr>
    <tr>
      <td>1WYZjME5s9tXdD4<strong>qBUvKofHmBQ7wMtjvM</strong></td>
    </tr>
    <tr>
      <td>1HSb2C1FR6A9y88<strong>qBUvKofHmBQ7wMtjvM</strong></td>
    </tr>
    <tr>
      <td>1XR1GM2ScaMFvxW<strong>qBUvKofHmBQ7wMtjvM</strong></td>
    </tr>
    <tr>
      <td>1oyHaBvLALhrZxK<strong>qBUvKofHmBQ7wMtjvM</strong></td>
    </tr>

    </tbody>
  </table>
</div>
<br/>
<p>If the original address was one of the fee addresses sent via BRIT, Eve would be able to use any of the above malicious addresses to replace it and keep fees from going
  back to MultiBit's developers.</p>

<p>If Eve wanted to steal fees for herself she would need to generate an ECDSA keypair that has a partial RIPEMD-160 collision with a genuine address and a valid SHA-256
  checksum. Assuming Eve gets an optimal address/block match up and a simplified mapping of the base 58 string to binary to make the math easier (it's not actually 1:1) this task
  has a complexity of <code>&gt;=2<sup>(25-14)*8</sup> = 2<sup>88</sup></code> so stealing fees for herself is unlikely even if Eve is backed by a nation state.</p>

<h4>The fix</h4>

<p>To stop this attack BRIT was updated in version 2 and MultiBit version 0.1.2 to include a keyed MAC so that clients can detect when something was changed in transit.
  Specifically <a href="https://web.archive.org/web/20160506095434/https://en.wikipedia.org/wiki/Hash-based_message_authentication_code" target="_blank">HMAC-SHA-256</a> is used to ensure message integrity.
  If an invalid HMAC is detected MultiBit treats it as if it cannot contact the BRIT server and falls back to hardcoded fee addresses.</p>

<h4>Conclusion</h4>

<p>It is important to remember that even though something was encrypted with a secret key, that alone is not enough to prove a message's validity. It is essential to include
  authentication in addition to encryption. In the case of BRIT the lack of a MAC was enough to permit an attacker to cut off a major source of funding for the project.
  <strong>Don't let this happen to you.</strong></p>

<p>Marclass</p>

<p>25 July 2015</p>

<h4>Related articles</h4>
<p>Here are some related articles:</p>
<ul>
  <li><a href="/web/20160506095434/https://multibit.org/en/help/hd0.1/how-brit-works.html">FAQ for BRIT</a></li>
  <li><a href="/web/20160506095434/https://multibit.org/blog/2014/04/11/multibit-hd-brit.html">Introducing BRIT (older article)</a></li>
</ul>

  <p><a href="/web/20160506095434/https://multibit.org/atom.xml"><img src="/web/20160506095434im_/https://multibit.org/images/common/rssicon.png" alt="Subscribe via Atom">&nbsp;Subscribe via Atom</a> | <a href="/web/20160506095434/https://multibit.org/blog.html">Back to blog contents</a></p>

  <hr/>
  <p>Great read ! How can I reward you ?<br/>MultiBit Classic is "donationware" and all
    <a href="https://web.archive.org/web/20160506095434/bitcoin:1AhN6rPdrMuKBGFDKR1k9A8SCLYaNgXhty?amount=0.01&amp;label=Please%20donate%20to%20multibit.org">donations</a>
    go towards development and server costs.</p>

  <p>Was this article accurate ?<br/>If not please <a href="https://web.archive.org/web/20160506095434/https://github.com/bitcoin-solutions/multibit-website/issues/new">raise a website improvement Issue</a> so that we can do better.
  </p>

</div>


<footer class="container-fluid">
  <p class="text-muted">&copy;<a href="https://web.archive.org/web/20160506095434/https://multibit.org/" target="_blank">MultiBit HD developers</a> 2011–2016.
    &nbsp;Powered by Bitcoin Solutions Ltd.
    &nbsp;Released under the <a href="https://web.archive.org/web/20160506095434/https://opensource.org/licenses/MIT" target="_blank">MIT license</a>.
    &nbsp;All trademarks acknowledged.
    &nbsp;<a href="/web/20160506095434/https://multibit.org/privacy.html" target="_blank">Privacy.</a>
    &nbsp;<a href="/web/20160506095434/https://multibit.org/tandc.html" target="_blank">Terms and conditions.</a>
  </p>
</footer>
</body>

</html><!--
     FILE ARCHIVED ON 09:54:34 May 06, 2016 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 17:33:37 Jan 11, 2025.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 0.542
  exclusion.robots: 0.026
  exclusion.robots.policy: 0.016
  esindex: 0.011
  cdx.remote: 6.541
  LoadShardBlock: 573.316 (3)
  PetaboxLoader3.resolve: 473.032 (4)
  PetaboxLoader3.datanode: 154.134 (4)
  load_resource: 178.899
-->