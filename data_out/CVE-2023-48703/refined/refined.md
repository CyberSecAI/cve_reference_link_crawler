- **Root cause of vulnerability:** The `xmlsec1` command-line tool is called without specifying which public keys should be used for signature verification. This allows an attacker to embed their own public key in a SAML token, which is then used by `xmlsec1` for signature verification, bypassing the intended authentication process.
- **Weaknesses/vulnerabilities present:** Improper verification of SAML assertion signatures. Specifically, the `xmlsec1` tool does not restrict the source of the public key, which allows an attacker to use their own key.
- **Impact of exploitation:** Successful exploitation allows for authentication bypass, granting unauthorized access to systems or resources that rely on the vulnerable go-saml library for SAML authentication.
- **Attack vectors:** An attacker crafts a malicious SAML token, embedding their own public key, and presents it to the vulnerable application. Since the application doesn't restrict the source of the verification key, the attacker's signature is deemed valid, bypassing authentication.
- **Required attacker capabilities/position:** The attacker needs to be able to send crafted SAML assertions to the application using the vulnerable library. They also need the capability to generate a valid signature and a corresponding public key to embed within the assertion.