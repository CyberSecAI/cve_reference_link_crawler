The provided content is related to CVE-2022-48657.

**Root cause of vulnerability:**
- The `cpufreq_get_hw_max_freq()` function returns the maximum CPU frequency in kHz as an `unsigned int`. This value is then multiplied by 1000 to convert it to Hz. The result is then used as input to `freq_inv_set_max_ratio()`, which expects a `u64` value in Hz. The multiplication by 1000, without explicit casting to a 64 bit integer, can cause an integer overflow if the `unsigned int` value of `cpufreq_get_hw_max_freq()` is large enough.

**Weaknesses/vulnerabilities present:**
- Integer overflow in the calculation of the maximum frequency in Hz

**Impact of exploitation:**
- The overflow could lead to incorrect maximum frequency values being used by the `freq_inv_set_max_ratio()` function. This could lead to frequency invariance not working correctly and unpredictable system behavior.

**Attack vectors:**
- The vulnerability can be triggered by the system during the setup process, specifically in the `amu_fie_setup()` function which is called to setup the frequency invariance logic.

**Required attacker capabilities/position:**
- No specific attacker capabilities or position are needed as this is a coding error in the kernel.