
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fcosign%2Fsecurity%2Fadvisories%2FGHSA-vfp6-jrw2-99g9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fcosign%2Fsecurity%2Fadvisories%2FGHSA-vfp6-jrw2-99g9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=sigstore%2Fcosign)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sigstore](/sigstore)
/
**[cosign](/sigstore/cosign)**
Public

* [Notifications](/login?return_to=%2Fsigstore%2Fcosign) You must be signed in to change notification settings
* [Fork
  552](/login?return_to=%2Fsigstore%2Fcosign)
* [Star
   4.6k](/login?return_to=%2Fsigstore%2Fcosign)

* [Code](/sigstore/cosign)
* [Issues
  233](/sigstore/cosign/issues)
* [Pull requests
  16](/sigstore/cosign/pulls)
* [Discussions](/sigstore/cosign/discussions)
* [Actions](/sigstore/cosign/actions)
* [Projects
  0](/sigstore/cosign/projects)
* [Security](/sigstore/cosign/security)
* [Insights](/sigstore/cosign/pulse)

Additional navigation options

* [Code](/sigstore/cosign)
* [Issues](/sigstore/cosign/issues)
* [Pull requests](/sigstore/cosign/pulls)
* [Discussions](/sigstore/cosign/discussions)
* [Actions](/sigstore/cosign/actions)
* [Projects](/sigstore/cosign/projects)
* [Security](/sigstore/cosign/security)
* [Insights](/sigstore/cosign/pulse)

# Possible endless data attack from attacker-controlled registry

Low

[bobcallaway](/bobcallaway)
published
GHSA-vfp6-jrw2-99g9
Nov 7, 2023

## Package

gomod

github.com/sigstore/cosign
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

<= 2.2.0

## Patched versions

2.2.1

## Description

### Summary

Cosign is susceptible to a denial of service by an attacker controlled registry. An attacker who controls a remote registry can return a high number of attestations and/or signatures to Cosign and cause Cosign to enter a long loop resulting in an endless data attack. The root cause is that Cosign loops through all attestations fetched from the remote registry in `pkg/cosign.FetchAttestations`.

The attacker needs to compromise the registry or make a request to a registry they control. When doing so, the attacker must return a high number of attestations in the response to Cosign. The result will be that the attacker can cause Cosign to go into a long or infinite loop that will prevent other users from verifying their data. In Kyvernos case, an attacker whose privileges are limited to making requests to the cluster can make a request with an image reference to their own registry, trigger the infinite loop and deny other users from completing their admission requests. Alternatively, the attacker can obtain control of the registry used by an organization and return a high number of attestations instead the expected number of attestations.

The vulnerable loop in Cosign starts on line 154 below:

[cosign/pkg/cosign/fetch.go](https://github.com/sigstore/cosign/blob/004443228442850fb28f248fd59765afad99b6df/pkg/cosign/fetch.go#L135-L196)

Lines 135 to 196
in
[0044432](/sigstore/cosign/commit/004443228442850fb28f248fd59765afad99b6df)

|  | func FetchAttestations(se oci.SignedEntity, predicateType string) ([]AttestationPayload, error) { |
| --- | --- |
|  | atts, err := se.Attestations() |
|  | if err != nil { |
|  | return nil, fmt.Errorf("remote image: %w", err) |
|  | } |
|  | l, err := atts.Get() |
|  | if err != nil { |
|  | return nil, fmt.Errorf("fetching attestations: %w", err) |
|  | } |
|  | if len(l) == 0 { |
|  | return nil, errors.New("found no attestations") |
|  | } |
|  |  |
|  | attestations := make([]AttestationPayload, 0, len(l)) |
|  | var attMu sync.Mutex |
|  |  |
|  | var g errgroup.Group |
|  | g.SetLimit(runtime.NumCPU()) |
|  |  |
|  | for \_, att := range l { |
|  | att := att |
|  | g.Go(func() error { |
|  | rawPayload, err := att.Payload() |
|  | if err != nil { |
|  | return fmt.Errorf("fetching payload: %w", err) |
|  | } |
|  | var payload AttestationPayload |
|  | if err := json.Unmarshal(rawPayload, &payload); err != nil { |
|  | return fmt.Errorf("unmarshaling payload: %w", err) |
|  | } |
|  |  |
|  | if predicateType != "" { |
|  | var decodedPayload []byte |
|  | decodedPayload, err = base64.StdEncoding.DecodeString(payload.PayLoad) |
|  | if err != nil { |
|  | return fmt.Errorf("decoding payload: %w", err) |
|  | } |
|  | var statement in\_toto.Statement |
|  | if err := json.Unmarshal(decodedPayload, &statement); err != nil { |
|  | return fmt.Errorf("unmarshaling statement: %w", err) |
|  | } |
|  | if statement.PredicateType != predicateType { |
|  | return nil |
|  | } |
|  | } |
|  |  |
|  | attMu.Lock() |
|  | defer attMu.Unlock() |
|  | attestations = append(attestations, payload) |
|  | return nil |
|  | }) |
|  | } |
|  | if err := g.Wait(); err != nil { |
|  | return nil, err |
|  | } |
|  |  |
|  | if len(attestations) == 0 && predicateType != "" { |
|  | return nil, fmt.Errorf("no attestations with predicate type '%s' found", predicateType) |
|  | } |
|  |  |
|  | return attestations, nil |
|  | } |

The `l` slice is controllable by an attacker who controls the remote registry.

Many cloud-native projects consider the remote registry to be untrusted, including Crossplane, Notary and Kyverno. We consider the same to be the case for Cosign, since users are not in control of whether the registry returns the expected data.

TUF's security model labels this type of vulnerability an ["Endless data attack"](https://theupdateframework.io/security/), but an attacker could use this as a type of rollback attack, in case the user attempts to deploy a patched version of a vulnerable image; The attacker could prevent this upgrade by causing Cosign to get stuck in an infinite loop and never complete.

### Mitigation

The issue can be mitigated rather simply by setting a limit to the limit of attestations that Cosign will loop through. The limit does not need to be high to be within the vast majority of use cases and still prevent the endless data attack.

### Severity

Low

3.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:N/A:L

### CVE ID

CVE-2023-46737

### Weaknesses

No CWEs

### Credits

* [![@AdamKorcz](https://avatars.githubusercontent.com/u/44787359?s=40&v=4)](/AdamKorcz)
  [AdamKorcz](/AdamKorcz)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

