
[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

December 9, 2022
# GHSL-2022-028: Copy/paste cross-site scripting (XSS) in codex-team

[![Author avatar](https://avatars.githubusercontent.com/u/61799930)
Stephan Brandauer, Erik Krogh Kristensen, Daniel Santos](https://github.com/ghsecuritylab)

## Coordinated Disclosure Timeline

* 2022-05-12: Report sent to team@codex.so
* 2022-06-12: Reminder sent to team@codex.so and peter@codex.so
* 2022-10-10: Reminder sent to team@codex.so and peter@codex.so
* 2022-10-14: Extended deadline since the fix is [being addressed](https://github.com/codex-team/editor.js/pull/2100)
* 2022-11-21: Fix merged

## Summary

`codex-team/editor.js` is vulnerable to XSS attacks when copy/pasting specially crafted input into the editor.

## Product

Editor.js

## Tested Version

[2.24.2](https://github.com/codex-team/editor.js/releases/tag/v2.24.3)

## Details

### Issue: XSS copy/pasting HTML in the editor (`GHSL-2022-028`)

The [`processHTML`](https://github.com/codex-team/editor.js/blob/f2b19cc7660248f95316e6b9e37b257e25268371/src/components/modules/paste.ts#L520) method is passing pasted input into `wrapper`’s `innerHTML`.

#### PoC:

1. Open https://cdn.sekurak.pl/copy-paste/playground.html in your browser, enter `<img src='foo' onerror='alert(123)'/>` in the HTML Input box.
2. Click `Copy as HTML`.
3. Open https://editorjs.io/ in your browser.
4. Paste the content you copied in [2] into the editor.
5. JavaScript: `alert(123)` is executed.

#### Impact

This issue may lead to XSS in all projects that depend on editor.js, such as [webiny/webiny-js](https://github.com/webiny/webiny-js), [frappe/frappe](https://github.com/frappe/frappe), and [Jungwoo-An/react-editor-js](https://github.com/Jungwoo-An/react-editor-js).

## CVE

* CVE-2022-23474

## Credit

This issue was discovered by CodeQL team members [@kaeluka (Stephan Brandauer)](https://github.com/kaeluka) and [@erik-krogh (Erik Krogh Kristensen)](https://github.com/erik-krogh), using a CodeQL query originally [contributed](https://github.com/github/securitylab/issues/422) by community member [@bananabr (Daniel Santos)](https://github.com/bananabr).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2022-028` in any communication regarding this issue.

## GitHub Security Advisories

We recommend you create a private [GitHub Security Advisory](https://help.github.com/en/github/managing-security-vulnerabilities/creating-a-security-advisory) for these findings. This also allows you to invite the GHSL team to collaborate and further discuss these findings in private before they are [published](https://help.github.com/en/github/managing-security-vulnerabilities/publishing-a-security-advisory).

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information

