=== Content from git.kernel.org_afde5c55_20250111_101653.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=a1766a4fd83befa0b34d932d532e7ebb7fab1fa7)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a1766a4fd83befa0b34d932d532e7ebb7fab1fa7)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a1766a4fd83befa0b34d932d532e7ebb7fab1fa7)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a1766a4fd83befa0b34d932d532e7ebb7fab1fa7)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2023-09-22 14:38:07 +0200 |
| --- | --- | --- |
| committer | Hans Verkuil <hverkuil-cisco@xs4all.nl> | 2023-10-07 10:55:48 +0200 |
| commit | [a1766a4fd83befa0b34d932d532e7ebb7fab1fa7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a1766a4fd83befa0b34d932d532e7ebb7fab1fa7) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=a1766a4fd83befa0b34d932d532e7ebb7fab1fa7)) | |
| tree | [af1a821d7b2fb735b8dd2b63f01174ca700cddbf](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a1766a4fd83befa0b34d932d532e7ebb7fab1fa7) | |
| parent | [462e108bac18419f17c6a34eb348b600a614aa4f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=462e108bac18419f17c6a34eb348b600a614aa4f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a1766a4fd83befa0b34d932d532e7ebb7fab1fa7&id2=462e108bac18419f17c6a34eb348b600a614aa4f)) | |
| download | [linux-a1766a4fd83befa0b34d932d532e7ebb7fab1fa7.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-a1766a4fd83befa0b34d932d532e7ebb7fab1fa7.tar.gz) | |

media: imon: fix access to invalid resource for the second interfaceimon driver probes two USB interfaces, and at the probe of the second
interface, the driver assumes blindly that the first interface got
bound with the same imon driver. It's usually true, but it's still
possible that the first interface is bound with another driver via a
malformed descriptor. Then it may lead to a memory corruption, as
spotted by syzkaller; imon driver accesses the data from drvdata as
struct imon\_context object although it's a completely different one
that was assigned by another driver.
This patch adds a sanity check -- whether the first interface is
really bound with the imon driver or not -- for avoiding the problem
above at the probe time.
Reported-by: syzbot+59875ffef5cb9c9b29e9@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/all/000000000000a838aa0603cc74d6@google.com/
Tested-by: Ricardo B. Marliere <ricardo@marliere.net>
Link: [https://lore.kernel.org/r/20230922005152.163640-1-ricardo@marliere.net](https://lore.kernel.org/r/20230922005152.163640-1-ricardo%40marliere.net)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Sean Young <sean@mess.org>
Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a1766a4fd83befa0b34d932d532e7ebb7fab1fa7)

| -rw-r--r-- | [drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/media/rc/imon.c?id=a1766a4fd83befa0b34d932d532e7ebb7fab1fa7) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/drivers/media/rc/imon.c b/drivers/media/rc/imon.cindex 74546f7e34691e..5719dda6e0f0ef 100644--- a/[drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/media/rc/imon.c?id=462e108bac18419f17c6a34eb348b600a614aa4f)+++ b/[drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/media/rc/imon.c?id=a1766a4fd83befa0b34d932d532e7ebb7fab1fa7)@@ -2427,6 +2427,12 @@ static int imon\_probe(struct usb\_interface \*interface, goto fail; } + if (first\_if->dev.driver != interface->dev.driver) {+ dev\_err(&interface->dev, "inconsistent driver matching\n");+ ret = -EINVAL;+ goto fail;+ }+ if (ifnum == 0) { ictx = imon\_init\_intf0(interface, id); if (!ictx) { |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 10:15:31 +0000



=== Content from git.kernel.org_e34eab3f_20250111_101652.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=2a493a34bd6e496c55fabedd82b957193ace178f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2a493a34bd6e496c55fabedd82b957193ace178f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2a493a34bd6e496c55fabedd82b957193ace178f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2a493a34bd6e496c55fabedd82b957193ace178f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2023-09-22 14:38:07 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-11-28 17:19:47 +0000 |
| commit | [2a493a34bd6e496c55fabedd82b957193ace178f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2a493a34bd6e496c55fabedd82b957193ace178f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=2a493a34bd6e496c55fabedd82b957193ace178f)) | |
| tree | [5ff9b9832902f617cb825469a09483b9378291fd](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2a493a34bd6e496c55fabedd82b957193ace178f) | |
| parent | [e943d65c3247d1824d0274b0a9fd1116afa335ed](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e943d65c3247d1824d0274b0a9fd1116afa335ed) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2a493a34bd6e496c55fabedd82b957193ace178f&id2=e943d65c3247d1824d0274b0a9fd1116afa335ed)) | |
| download | [linux-2a493a34bd6e496c55fabedd82b957193ace178f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-2a493a34bd6e496c55fabedd82b957193ace178f.tar.gz) | |

media: imon: fix access to invalid resource for the second interface[ Upstream commit a1766a4fd83befa0b34d932d532e7ebb7fab1fa7 ]
imon driver probes two USB interfaces, and at the probe of the second
interface, the driver assumes blindly that the first interface got
bound with the same imon driver. It's usually true, but it's still
possible that the first interface is bound with another driver via a
malformed descriptor. Then it may lead to a memory corruption, as
spotted by syzkaller; imon driver accesses the data from drvdata as
struct imon\_context object although it's a completely different one
that was assigned by another driver.
This patch adds a sanity check -- whether the first interface is
really bound with the imon driver or not -- for avoiding the problem
above at the probe time.
Reported-by: syzbot+59875ffef5cb9c9b29e9@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/all/000000000000a838aa0603cc74d6@google.com/
Tested-by: Ricardo B. Marliere <ricardo@marliere.net>
Link: [https://lore.kernel.org/r/20230922005152.163640-1-ricardo@marliere.net](https://lore.kernel.org/r/20230922005152.163640-1-ricardo%40marliere.net)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Sean Young <sean@mess.org>
Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2a493a34bd6e496c55fabedd82b957193ace178f)

| -rw-r--r-- | [drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/media/rc/imon.c?id=2a493a34bd6e496c55fabedd82b957193ace178f) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/drivers/media/rc/imon.c b/drivers/media/rc/imon.cindex 74546f7e34691e..5719dda6e0f0ef 100644--- a/[drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/media/rc/imon.c?id=e943d65c3247d1824d0274b0a9fd1116afa335ed)+++ b/[drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/media/rc/imon.c?id=2a493a34bd6e496c55fabedd82b957193ace178f)@@ -2427,6 +2427,12 @@ static int imon\_probe(struct usb\_interface \*interface, goto fail; } + if (first\_if->dev.driver != interface->dev.driver) {+ dev\_err(&interface->dev, "inconsistent driver matching\n");+ ret = -EINVAL;+ goto fail;+ }+ if (ifnum == 0) { ictx = imon\_init\_intf0(interface, id); if (!ictx) { |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 10:15:29 +0000



=== Content from git.kernel.org_5052c475_20250111_101651.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=10ec5a97f8f5a772a1a42b4eb27196b447cd3aa9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=10ec5a97f8f5a772a1a42b4eb27196b447cd3aa9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=10ec5a97f8f5a772a1a42b4eb27196b447cd3aa9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=10ec5a97f8f5a772a1a42b4eb27196b447cd3aa9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2023-09-22 14:38:07 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-11-28 17:14:51 +0000 |
| commit | [10ec5a97f8f5a772a1a42b4eb27196b447cd3aa9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=10ec5a97f8f5a772a1a42b4eb27196b447cd3aa9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=10ec5a97f8f5a772a1a42b4eb27196b447cd3aa9)) | |
| tree | [6f795af79af7dafc1369a0ca719aa04200b62ed9](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=10ec5a97f8f5a772a1a42b4eb27196b447cd3aa9) | |
| parent | [163c0a38dfaf027193ce612de91f427e181fe666](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=163c0a38dfaf027193ce612de91f427e181fe666) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=10ec5a97f8f5a772a1a42b4eb27196b447cd3aa9&id2=163c0a38dfaf027193ce612de91f427e181fe666)) | |
| download | [linux-10ec5a97f8f5a772a1a42b4eb27196b447cd3aa9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-10ec5a97f8f5a772a1a42b4eb27196b447cd3aa9.tar.gz) | |

media: imon: fix access to invalid resource for the second interface[ Upstream commit a1766a4fd83befa0b34d932d532e7ebb7fab1fa7 ]
imon driver probes two USB interfaces, and at the probe of the second
interface, the driver assumes blindly that the first interface got
bound with the same imon driver. It's usually true, but it's still
possible that the first interface is bound with another driver via a
malformed descriptor. Then it may lead to a memory corruption, as
spotted by syzkaller; imon driver accesses the data from drvdata as
struct imon\_context object although it's a completely different one
that was assigned by another driver.
This patch adds a sanity check -- whether the first interface is
really bound with the imon driver or not -- for avoiding the problem
above at the probe time.
Reported-by: syzbot+59875ffef5cb9c9b29e9@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/all/000000000000a838aa0603cc74d6@google.com/
Tested-by: Ricardo B. Marliere <ricardo@marliere.net>
Link: [https://lore.kernel.org/r/20230922005152.163640-1-ricardo@marliere.net](https://lore.kernel.org/r/20230922005152.163640-1-ricardo%40marliere.net)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Sean Young <sean@mess.org>
Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=10ec5a97f8f5a772a1a42b4eb27196b447cd3aa9)

| -rw-r--r-- | [drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/media/rc/imon.c?id=10ec5a97f8f5a772a1a42b4eb27196b447cd3aa9) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/drivers/media/rc/imon.c b/drivers/media/rc/imon.cindex 74546f7e34691e..5719dda6e0f0ef 100644--- a/[drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/media/rc/imon.c?id=163c0a38dfaf027193ce612de91f427e181fe666)+++ b/[drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/media/rc/imon.c?id=10ec5a97f8f5a772a1a42b4eb27196b447cd3aa9)@@ -2427,6 +2427,12 @@ static int imon\_probe(struct usb\_interface \*interface, goto fail; } + if (first\_if->dev.driver != interface->dev.driver) {+ dev\_err(&interface->dev, "inconsistent driver matching\n");+ ret = -EINVAL;+ goto fail;+ }+ if (ifnum == 0) { ictx = imon\_init\_intf0(interface, id); if (!ictx) { |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 10:15:28 +0000



=== Content from git.kernel.org_72d9cf32_20250111_101654.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=b083aaf5db2eeca9e362723258e5d8698f7dd84e)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b083aaf5db2eeca9e362723258e5d8698f7dd84e)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b083aaf5db2eeca9e362723258e5d8698f7dd84e)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b083aaf5db2eeca9e362723258e5d8698f7dd84e)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2023-09-22 14:38:07 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-11-28 17:07:02 +0000 |
| commit | [b083aaf5db2eeca9e362723258e5d8698f7dd84e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b083aaf5db2eeca9e362723258e5d8698f7dd84e) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=b083aaf5db2eeca9e362723258e5d8698f7dd84e)) | |
| tree | [f6d5c49b1ef495b45c0c59fd2671468218113ef0](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b083aaf5db2eeca9e362723258e5d8698f7dd84e) | |
| parent | [65335aef1ab6bb335f420a520c8160b4d5a35db3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=65335aef1ab6bb335f420a520c8160b4d5a35db3) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b083aaf5db2eeca9e362723258e5d8698f7dd84e&id2=65335aef1ab6bb335f420a520c8160b4d5a35db3)) | |
| download | [linux-b083aaf5db2eeca9e362723258e5d8698f7dd84e.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-b083aaf5db2eeca9e362723258e5d8698f7dd84e.tar.gz) | |

media: imon: fix access to invalid resource for the second interface[ Upstream commit a1766a4fd83befa0b34d932d532e7ebb7fab1fa7 ]
imon driver probes two USB interfaces, and at the probe of the second
interface, the driver assumes blindly that the first interface got
bound with the same imon driver. It's usually true, but it's still
possible that the first interface is bound with another driver via a
malformed descriptor. Then it may lead to a memory corruption, as
spotted by syzkaller; imon driver accesses the data from drvdata as
struct imon\_context object although it's a completely different one
that was assigned by another driver.
This patch adds a sanity check -- whether the first interface is
really bound with the imon driver or not -- for avoiding the problem
above at the probe time.
Reported-by: syzbot+59875ffef5cb9c9b29e9@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/all/000000000000a838aa0603cc74d6@google.com/
Tested-by: Ricardo B. Marliere <ricardo@marliere.net>
Link: [https://lore.kernel.org/r/20230922005152.163640-1-ricardo@marliere.net](https://lore.kernel.org/r/20230922005152.163640-1-ricardo%40marliere.net)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Sean Young <sean@mess.org>
Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b083aaf5db2eeca9e362723258e5d8698f7dd84e)

| -rw-r--r-- | [drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/media/rc/imon.c?id=b083aaf5db2eeca9e362723258e5d8698f7dd84e) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/drivers/media/rc/imon.c b/drivers/media/rc/imon.cindex 74546f7e34691e..5719dda6e0f0ef 100644--- a/[drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/media/rc/imon.c?id=65335aef1ab6bb335f420a520c8160b4d5a35db3)+++ b/[drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/media/rc/imon.c?id=b083aaf5db2eeca9e362723258e5d8698f7dd84e)@@ -2427,6 +2427,12 @@ static int imon\_probe(struct usb\_interface \*interface, goto fail; } + if (first\_if->dev.driver != interface->dev.driver) {+ dev\_err(&interface->dev, "inconsistent driver matching\n");+ ret = -EINVAL;+ goto fail;+ }+ if (ifnum == 0) { ictx = imon\_init\_intf0(interface, id); if (!ictx) { |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 10:15:31 +0000



=== Content from git.kernel.org_d18a2c49_20250111_101650.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=0f5068519f89d928d6c51100e4b274479123829f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0f5068519f89d928d6c51100e4b274479123829f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0f5068519f89d928d6c51100e4b274479123829f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0f5068519f89d928d6c51100e4b274479123829f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2023-09-22 14:38:07 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-11-28 16:54:52 +0000 |
| commit | [0f5068519f89d928d6c51100e4b274479123829f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0f5068519f89d928d6c51100e4b274479123829f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=0f5068519f89d928d6c51100e4b274479123829f)) | |
| tree | [38a859d97bdcdbdd3c454fc8acee1ea415c5d889](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0f5068519f89d928d6c51100e4b274479123829f) | |
| parent | [cf8519f40ce30a66f7bf05ea31a4fab7253580bd](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cf8519f40ce30a66f7bf05ea31a4fab7253580bd) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0f5068519f89d928d6c51100e4b274479123829f&id2=cf8519f40ce30a66f7bf05ea31a4fab7253580bd)) | |
| download | [linux-0f5068519f89d928d6c51100e4b274479123829f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-0f5068519f89d928d6c51100e4b274479123829f.tar.gz) | |

media: imon: fix access to invalid resource for the second interface[ Upstream commit a1766a4fd83befa0b34d932d532e7ebb7fab1fa7 ]
imon driver probes two USB interfaces, and at the probe of the second
interface, the driver assumes blindly that the first interface got
bound with the same imon driver. It's usually true, but it's still
possible that the first interface is bound with another driver via a
malformed descriptor. Then it may lead to a memory corruption, as
spotted by syzkaller; imon driver accesses the data from drvdata as
struct imon\_context object although it's a completely different one
that was assigned by another driver.
This patch adds a sanity check -- whether the first interface is
really bound with the imon driver or not -- for avoiding the problem
above at the probe time.
Reported-by: syzbot+59875ffef5cb9c9b29e9@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/all/000000000000a838aa0603cc74d6@google.com/
Tested-by: Ricardo B. Marliere <ricardo@marliere.net>
Link: [https://lore.kernel.org/r/20230922005152.163640-1-ricardo@marliere.net](https://lore.kernel.org/r/20230922005152.163640-1-ricardo%40marliere.net)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Sean Young <sean@mess.org>
Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0f5068519f89d928d6c51100e4b274479123829f)

| -rw-r--r-- | [drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/media/rc/imon.c?id=0f5068519f89d928d6c51100e4b274479123829f) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/drivers/media/rc/imon.c b/drivers/media/rc/imon.cindex 98a38755c694ec..253a1d1a840a0b 100644--- a/[drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/media/rc/imon.c?id=cf8519f40ce30a66f7bf05ea31a4fab7253580bd)+++ b/[drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/media/rc/imon.c?id=0f5068519f89d928d6c51100e4b274479123829f)@@ -2430,6 +2430,12 @@ static int imon\_probe(struct usb\_interface \*interface, goto fail; } + if (first\_if->dev.driver != interface->dev.driver) {+ dev\_err(&interface->dev, "inconsistent driver matching\n");+ ret = -EINVAL;+ goto fail;+ }+ if (ifnum == 0) { ictx = imon\_init\_intf0(interface, id); if (!ictx) { |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 10:15:28 +0000



=== Content from git.kernel.org_157c3b4c_20250111_101653.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=5e0b788fb96be36d1baf1a5c88d09c7c82a0452a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5e0b788fb96be36d1baf1a5c88d09c7c82a0452a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5e0b788fb96be36d1baf1a5c88d09c7c82a0452a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5e0b788fb96be36d1baf1a5c88d09c7c82a0452a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2023-09-22 14:38:07 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-11-28 16:56:20 +0000 |
| commit | [5e0b788fb96be36d1baf1a5c88d09c7c82a0452a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5e0b788fb96be36d1baf1a5c88d09c7c82a0452a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=5e0b788fb96be36d1baf1a5c88d09c7c82a0452a)) | |
| tree | [778f402dad8c26769182d5894ff6bba2b3191607](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5e0b788fb96be36d1baf1a5c88d09c7c82a0452a) | |
| parent | [ae6bcafe1f6bb10fe5c1357d14b0292a7e842586](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ae6bcafe1f6bb10fe5c1357d14b0292a7e842586) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5e0b788fb96be36d1baf1a5c88d09c7c82a0452a&id2=ae6bcafe1f6bb10fe5c1357d14b0292a7e842586)) | |
| download | [linux-5e0b788fb96be36d1baf1a5c88d09c7c82a0452a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-5e0b788fb96be36d1baf1a5c88d09c7c82a0452a.tar.gz) | |

media: imon: fix access to invalid resource for the second interface[ Upstream commit a1766a4fd83befa0b34d932d532e7ebb7fab1fa7 ]
imon driver probes two USB interfaces, and at the probe of the second
interface, the driver assumes blindly that the first interface got
bound with the same imon driver. It's usually true, but it's still
possible that the first interface is bound with another driver via a
malformed descriptor. Then it may lead to a memory corruption, as
spotted by syzkaller; imon driver accesses the data from drvdata as
struct imon\_context object although it's a completely different one
that was assigned by another driver.
This patch adds a sanity check -- whether the first interface is
really bound with the imon driver or not -- for avoiding the problem
above at the probe time.
Reported-by: syzbot+59875ffef5cb9c9b29e9@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/all/000000000000a838aa0603cc74d6@google.com/
Tested-by: Ricardo B. Marliere <ricardo@marliere.net>
Link: [https://lore.kernel.org/r/20230922005152.163640-1-ricardo@marliere.net](https://lore.kernel.org/r/20230922005152.163640-1-ricardo%40marliere.net)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Sean Young <sean@mess.org>
Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5e0b788fb96be36d1baf1a5c88d09c7c82a0452a)

| -rw-r--r-- | [drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/media/rc/imon.c?id=5e0b788fb96be36d1baf1a5c88d09c7c82a0452a) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/drivers/media/rc/imon.c b/drivers/media/rc/imon.cindex 72e4bb0fb71ecd..4e7c3d889d5ce8 100644--- a/[drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/media/rc/imon.c?id=ae6bcafe1f6bb10fe5c1357d14b0292a7e842586)+++ b/[drivers/media/rc/imon.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/media/rc/imon.c?id=5e0b788fb96be36d1baf1a5c88d09c7c82a0452a)@@ -2427,6 +2427,12 @@ static int imon\_probe(struct usb\_interface \*interface, goto fail; } + if (first\_if->dev.driver != interface->dev.driver) {+ dev\_err(&interface->dev, "inconsistent driver matching\n");+ ret = -EINVAL;+ goto fail;+ }+ if (ifnum == 0) { ictx = imon\_init\_intf0(interface, id); if (!ictx) { |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 10:15:30 +0000


