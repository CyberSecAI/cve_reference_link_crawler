

| [cgit logo](/) | [index](/) : [wireless/iwd.git](/pub/scm/network/wireless/iwd.git/) | master |
| --- | --- | --- |
| Wireless daemon for Linux | Marcel Holtmann |

| [about](/pub/scm/network/wireless/iwd.git/about/)[summary](/pub/scm/network/wireless/iwd.git/)[refs](/pub/scm/network/wireless/iwd.git/refs/?id=d34b4e16e045142590ed7cb653e01ed0ae5362eb)[log](/pub/scm/network/wireless/iwd.git/log/)[tree](/pub/scm/network/wireless/iwd.git/tree/?id=d34b4e16e045142590ed7cb653e01ed0ae5362eb)[commit](/pub/scm/network/wireless/iwd.git/commit/?id=d34b4e16e045142590ed7cb653e01ed0ae5362eb)[diff](/pub/scm/network/wireless/iwd.git/diff/?id=d34b4e16e045142590ed7cb653e01ed0ae5362eb)[stats](/pub/scm/network/wireless/iwd.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | James Prestwood <prestwoj@gmail.com> | 2024-02-29 09:07:33 -0800 |
| --- | --- | --- |
| committer | Denis Kenzior <denkenz@gmail.com> | 2024-02-29 14:33:23 -0600 |
| commit | [d34b4e16e045142590ed7cb653e01ed0ae5362eb](/pub/scm/network/wireless/iwd.git/commit/?id=d34b4e16e045142590ed7cb653e01ed0ae5362eb) ([patch](/pub/scm/network/wireless/iwd.git/patch/?id=d34b4e16e045142590ed7cb653e01ed0ae5362eb)) | |
| tree | [d9b122536670ef21d6f390161954549c1133cfbe](/pub/scm/network/wireless/iwd.git/tree/?id=d34b4e16e045142590ed7cb653e01ed0ae5362eb) | |
| parent | [52a47c9fd428904de611a90cbf8b223af879684d](/pub/scm/network/wireless/iwd.git/commit/?id=52a47c9fd428904de611a90cbf8b223af879684d) ([diff](/pub/scm/network/wireless/iwd.git/diff/?id=d34b4e16e045142590ed7cb653e01ed0ae5362eb&id2=52a47c9fd428904de611a90cbf8b223af879684d)) | |

p2putil: initialize all parsing structures to zeroSince these are all stack variables they are not zero initialized.
If parsing fails there may be invalid pointers within the structures
which can get dereferenced by p2p\_clear\_\*
[Diffstat](/pub/scm/network/wireless/iwd.git/diff/?id=d34b4e16e045142590ed7cb653e01ed0ae5362eb)

| -rw-r--r-- | [src/p2putil.c](/pub/scm/network/wireless/iwd.git/diff/src/p2putil.c?id=d34b4e16e045142590ed7cb653e01ed0ae5362eb) | 34 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 17 insertions, 17 deletions

| diff --git a/src/p2putil.c b/src/p2putil.cindex faf151a5f..c90810e56 100644--- a/[src/p2putil.c](/pub/scm/network/wireless/iwd.git/tree/src/p2putil.c?id=52a47c9fd428904de611a90cbf8b223af879684d)+++ b/[src/p2putil.c](/pub/scm/network/wireless/iwd.git/tree/src/p2putil.c?id=d34b4e16e045142590ed7cb653e01ed0ae5362eb)@@ -776,7 +776,7 @@ done: /\* Section 4.2.1 \*/ int p2p\_parse\_beacon(const uint8\_t \*pdu, size\_t len, struct p2p\_beacon \*out) {- struct p2p\_beacon d = {};+ struct p2p\_beacon d = {0}; int r;  r = p2p\_parse\_attrs(pdu, len,@@ -797,7 +797,7 @@ int p2p\_parse\_beacon(const uint8\_t \*pdu, size\_t len, struct p2p\_beacon \*out) int p2p\_parse\_probe\_req(const uint8\_t \*pdu, size\_t len, struct p2p\_probe\_req \*out) {- struct p2p\_probe\_req d = {};+ struct p2p\_probe\_req d = {0}; int r;  r = p2p\_parse\_attrs(pdu, len,@@ -828,7 +828,7 @@ int p2p\_parse\_probe\_req(const uint8\_t \*pdu, size\_t len, int p2p\_parse\_probe\_resp(const uint8\_t \*pdu, size\_t len, struct p2p\_probe\_resp \*out) {- struct p2p\_probe\_resp d = {};+ struct p2p\_probe\_resp d = {0}; int r;  r = p2p\_parse\_attrs(pdu, len,@@ -853,7 +853,7 @@ int p2p\_parse\_probe\_resp(const uint8\_t \*pdu, size\_t len, int p2p\_parse\_association\_req(const uint8\_t \*pdu, size\_t len, struct p2p\_association\_req \*out) {- struct p2p\_association\_req d = {};+ struct p2p\_association\_req d = {0}; int r;  r = p2p\_parse\_attrs(pdu, len,@@ -876,7 +876,7 @@ int p2p\_parse\_association\_req(const uint8\_t \*pdu, size\_t len, int p2p\_parse\_association\_resp(const uint8\_t \*pdu, size\_t len, struct p2p\_association\_resp \*out) {- struct p2p\_association\_resp d = {};+ struct p2p\_association\_resp d = {0}; int r;  r = p2p\_parse\_attrs(pdu, len,@@ -939,7 +939,7 @@ int p2p\_parse\_disassociation(const uint8\_t \*pdu, size\_t len, int p2p\_parse\_go\_negotiation\_req(const uint8\_t \*pdu, size\_t len, struct p2p\_go\_negotiation\_req \*out) {- struct p2p\_go\_negotiation\_req d = {};+ struct p2p\_go\_negotiation\_req d = {0}; int r; struct p2p\_go\_intent\_attr go\_intent; uint8\_t \*wsc\_data;@@ -1001,7 +1001,7 @@ error: int p2p\_parse\_go\_negotiation\_resp(const uint8\_t \*pdu, size\_t len, struct p2p\_go\_negotiation\_resp \*out) {- struct p2p\_go\_negotiation\_resp d = {};+ struct p2p\_go\_negotiation\_resp d = {0}; int r; struct p2p\_go\_intent\_attr go\_intent; uint8\_t \*wsc\_data;@@ -1062,7 +1062,7 @@ error: int p2p\_parse\_go\_negotiation\_confirmation(const uint8\_t \*pdu, size\_t len, struct p2p\_go\_negotiation\_confirmation \*out) {- struct p2p\_go\_negotiation\_confirmation d = {};+ struct p2p\_go\_negotiation\_confirmation d = {0}; int r;  if (len < 1)@@ -1096,7 +1096,7 @@ error: int p2p\_parse\_invitation\_req(const uint8\_t \*pdu, size\_t len, struct p2p\_invitation\_req \*out) {- struct p2p\_invitation\_req d = {};+ struct p2p\_invitation\_req d = {0}; int r; uint8\_t \*wsc\_data; ssize\_t wsc\_len;@@ -1151,7 +1151,7 @@ error: int p2p\_parse\_invitation\_resp(const uint8\_t \*pdu, size\_t len, struct p2p\_invitation\_resp \*out) {- struct p2p\_invitation\_resp d = {};+ struct p2p\_invitation\_resp d = {0}; int r;  if (len < 1)@@ -1185,7 +1185,7 @@ error: int p2p\_parse\_device\_disc\_req(const uint8\_t \*pdu, size\_t len, struct p2p\_device\_discoverability\_req \*out) {- struct p2p\_device\_discoverability\_req d = {};+ struct p2p\_device\_discoverability\_req d = {0}; int r;  if (len < 1)@@ -1210,7 +1210,7 @@ int p2p\_parse\_device\_disc\_req(const uint8\_t \*pdu, size\_t len, int p2p\_parse\_device\_disc\_resp(const uint8\_t \*pdu, size\_t len, struct p2p\_device\_discoverability\_resp \*out) {- struct p2p\_device\_discoverability\_resp d = {};+ struct p2p\_device\_discoverability\_resp d = {0}; int r;  if (len < 1)@@ -1234,7 +1234,7 @@ int p2p\_parse\_device\_disc\_resp(const uint8\_t \*pdu, size\_t len, int p2p\_parse\_provision\_disc\_req(const uint8\_t \*pdu, size\_t len, struct p2p\_provision\_discovery\_req \*out) {- struct p2p\_provision\_discovery\_req d = {};+ struct p2p\_provision\_discovery\_req d = {0}; int r; uint8\_t \*wsc\_data; ssize\_t wsc\_len;@@ -1309,7 +1309,7 @@ error: int p2p\_parse\_provision\_disc\_resp(const uint8\_t \*pdu, size\_t len, struct p2p\_provision\_discovery\_resp \*out) {- struct p2p\_provision\_discovery\_resp d = {};+ struct p2p\_provision\_discovery\_resp d = {0}; int r; uint8\_t \*wsc\_data; ssize\_t wsc\_len;@@ -1389,7 +1389,7 @@ error: int p2p\_parse\_notice\_of\_absence(const uint8\_t \*pdu, size\_t len, struct p2p\_notice\_of\_absence \*out) {- struct p2p\_notice\_of\_absence d = {};+ struct p2p\_notice\_of\_absence d = {0}; int r;  if (len < 1)@@ -1411,7 +1411,7 @@ int p2p\_parse\_notice\_of\_absence(const uint8\_t \*pdu, size\_t len, int p2p\_parse\_presence\_req(const uint8\_t \*pdu, size\_t len, struct p2p\_presence\_req \*out) {- struct p2p\_presence\_req d = {};+ struct p2p\_presence\_req d = {0}; int r;  if (len < 1)@@ -1437,7 +1437,7 @@ int p2p\_parse\_presence\_req(const uint8\_t \*pdu, size\_t len, int p2p\_parse\_presence\_resp(const uint8\_t \*pdu, size\_t len, struct p2p\_presence\_resp \*out) {- struct p2p\_presence\_resp d = {};+ struct p2p\_presence\_resp d = {0}; int r;  if (len < 1) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 12:54:57 +0000

