=== Content from github.com_0c709270_20250110_161357.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcardano-scaling%2Fhydra%2Fblob%2Fmaster%2Fhydra-plutus%2Fsrc%2FHydra%2FContract%2FHead.hs)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcardano-scaling%2Fhydra%2Fblob%2Fmaster%2Fhydra-plutus%2Fsrc%2FHydra%2FContract%2FHead.hs)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=cardano-scaling%2Fhydra)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cardano-scaling](/cardano-scaling)
/
**[hydra](/cardano-scaling/hydra)**
Public

* [Notifications](/login?return_to=%2Fcardano-scaling%2Fhydra) You must be signed in to change notification settings
* [Fork
  87](/login?return_to=%2Fcardano-scaling%2Fhydra)
* [Star
   291](/login?return_to=%2Fcardano-scaling%2Fhydra)

* [Code](/cardano-scaling/hydra)
* [Issues
  73](/cardano-scaling/hydra/issues)
* [Pull requests
  4](/cardano-scaling/hydra/pulls)
* [Discussions](/cardano-scaling/hydra/discussions)
* [Actions](/cardano-scaling/hydra/actions)
* [Projects
  1](/cardano-scaling/hydra/projects)
* [Wiki](/cardano-scaling/hydra/wiki)
* [Security](/cardano-scaling/hydra/security)
* [Insights](/cardano-scaling/hydra/pulse)

Additional navigation options

* [Code](/cardano-scaling/hydra)
* [Issues](/cardano-scaling/hydra/issues)
* [Pull requests](/cardano-scaling/hydra/pulls)
* [Discussions](/cardano-scaling/hydra/discussions)
* [Actions](/cardano-scaling/hydra/actions)
* [Projects](/cardano-scaling/hydra/projects)
* [Wiki](/cardano-scaling/hydra/wiki)
* [Security](/cardano-scaling/hydra/security)
* [Insights](/cardano-scaling/hydra/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0be45606_20250110_161359.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcardano-scaling%2Fhydra%2Fsecurity%2Fadvisories%2FGHSA-mgcx-6p7h-5996)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcardano-scaling%2Fhydra%2Fsecurity%2Fadvisories%2FGHSA-mgcx-6p7h-5996)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=cardano-scaling%2Fhydra)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cardano-scaling](/cardano-scaling)
/
**[hydra](/cardano-scaling/hydra)**
Public

* [Notifications](/login?return_to=%2Fcardano-scaling%2Fhydra) You must be signed in to change notification settings
* [Fork
  87](/login?return_to=%2Fcardano-scaling%2Fhydra)
* [Star
   291](/login?return_to=%2Fcardano-scaling%2Fhydra)

* [Code](/cardano-scaling/hydra)
* [Issues
  73](/cardano-scaling/hydra/issues)
* [Pull requests
  4](/cardano-scaling/hydra/pulls)
* [Discussions](/cardano-scaling/hydra/discussions)
* [Actions](/cardano-scaling/hydra/actions)
* [Projects
  1](/cardano-scaling/hydra/projects)
* [Wiki](/cardano-scaling/hydra/wiki)
* [Security](/cardano-scaling/hydra/security)
* [Insights](/cardano-scaling/hydra/pulse)

Additional navigation options

* [Code](/cardano-scaling/hydra)
* [Issues](/cardano-scaling/hydra/issues)
* [Pull requests](/cardano-scaling/hydra/pulls)
* [Discussions](/cardano-scaling/hydra/discussions)
* [Actions](/cardano-scaling/hydra/actions)
* [Projects](/cardano-scaling/hydra/projects)
* [Wiki](/cardano-scaling/hydra/wiki)
* [Security](/cardano-scaling/hydra/security)
* [Insights](/cardano-scaling/hydra/pulse)

# Contestation period in head datum can be modified during Close transaction, allowing malicious participant to freely modify the contestation deadline

High

Unknown
published
GHSA-mgcx-6p7h-5996
Oct 4, 2023

## Package

No package listed

## Affected versions

< 0.13

## Patched versions

None

## Description

### Summary

The specification states that the contestation period in the datum of the UTxO at the head validator must stay unchanged as the state progresses from Open to Closed (Close transaction), but no such check appears to be performed in the `checkClose` function of the head validator.

This would allow a malicious participant to modify the contestation deadline of the head to either allow them to fanout the head without giving another participant the chance to contest, or prevent any participant from ever redistributing the funds locked in the head via a fan-out.

### Details

In the `checkClose` function in Head.hs, the contestation period in the Closed state datum in the outgoing UTxO at the head validator is not checked to be unchanged, allowing the participant closing the head to choose any contestation period they would like.

<https://github.com/input-output-hk/hydra/blob/master/hydra-plutus/src/Hydra/Contract/Head.hs#L284-L296>

<https://github.com/input-output-hk/hydra/blob/master/hydra-plutus/src/Hydra/Contract/Head.hs#L320-L323>

### PoC

Malicious participant creates Close transaction as normal but changes the contestation period field of the head output datum such that it does not match the contestation period specified in the `Head.Open` datum of the head UTxO being spent.

### Impact

A malicious participant can choose any contestation period they want in the head output `Head.Closed` datum when they build the Close transaction (in the `checkClose` function of the head validator), and this value is then used in the `checkContest` function of the head validator to update the `contestDeadline` in a contest transaction. In fact, it looks like `ContestationPeriod` is a wrapper around the Integer type so can even be set to a negative number (?) which would then shift the contest deadline backwards in time. This would allow a malicious participant to modify the contestation deadline of the head to either allow them to fanout the head without giving another participant the chance to contest, or prevent any participant from reclaiming the funds from the head via a fan-out.

The former scenario would like like:

* malicious participant progresses the head from Open to Closed with a Close transaction, specifying some large negative number as the contestation period in the head output datum instead of keeping it unchanged (`malicious_cp`)
* the malicious participant submits a Contest transaction, in which the new contestation deadline `new_contest_deadline` is checked to equal `current_contest_deadline + malicious_cp`, but `malicious_cp` is a large negative number which means the contestation deadline will actually move backwards in time (to a point in time which has passed) instead of forwards
* the malicious participant can now immediately submit a fanout transaction without allowing other participants to contest their submitted snapshot, because the contest deadline has been set to a point in the past and so has already passed

The latter scenario is similar, but the malicious participant specifies a large positive number as the contestation period, which causes the contest deadline to be set unreachably far in the future in `checkContest`, and then no participant can cause a fanout because they can only do so once the deadline has been reached, but this deadline is unreachably far in the future.

### Severity

High

8.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H

### CVE ID

CVE-2023-42448

### Weaknesses

No CWEs

### Credits

* [![@jmhrpr](https://avatars.githubusercontent.com/u/25673452?s=40&v=4)](/jmhrpr)
  [jmhrpr](/jmhrpr)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_bc670b54_20250110_161356.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcardano-scaling%2Fhydra%2Fblob%2Fmaster%2FCHANGELOG.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcardano-scaling%2Fhydra%2Fblob%2Fmaster%2FCHANGELOG.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=cardano-scaling%2Fhydra)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cardano-scaling](/cardano-scaling)
/
**[hydra](/cardano-scaling/hydra)**
Public

* [Notifications](/login?return_to=%2Fcardano-scaling%2Fhydra) You must be signed in to change notification settings
* [Fork
  87](/login?return_to=%2Fcardano-scaling%2Fhydra)
* [Star
   291](/login?return_to=%2Fcardano-scaling%2Fhydra)

* [Code](/cardano-scaling/hydra)
* [Issues
  73](/cardano-scaling/hydra/issues)
* [Pull requests
  4](/cardano-scaling/hydra/pulls)
* [Discussions](/cardano-scaling/hydra/discussions)
* [Actions](/cardano-scaling/hydra/actions)
* [Projects
  1](/cardano-scaling/hydra/projects)
* [Wiki](/cardano-scaling/hydra/wiki)
* [Security](/cardano-scaling/hydra/security)
* [Insights](/cardano-scaling/hydra/pulse)

Additional navigation options

* [Code](/cardano-scaling/hydra)
* [Issues](/cardano-scaling/hydra/issues)
* [Pull requests](/cardano-scaling/hydra/pulls)
* [Discussions](/cardano-scaling/hydra/discussions)
* [Actions](/cardano-scaling/hydra/actions)
* [Projects](/cardano-scaling/hydra/projects)
* [Wiki](/cardano-scaling/hydra/wiki)
* [Security](/cardano-scaling/hydra/security)
* [Insights](/cardano-scaling/hydra/pulse)

## Files

 master
## Breadcrumbs

1. [hydra](/cardano-scaling/hydra/tree/master)
/
# CHANGELOG.md

 Blame  Blame
## Latest commit

## History

[History](/cardano-scaling/hydra/commits/master/CHANGELOG.md)923 lines (670 loc) · 53.4 KB master
## Breadcrumbs

1. [hydra](/cardano-scaling/hydra/tree/master)
/
# CHANGELOG.md

Top
## File metadata and controls

* Preview
* Code
* Blame

923 lines (670 loc) · 53.4 KB[Raw](https://github.com/cardano-scaling/hydra/raw/refs/heads/master/CHANGELOG.md)
# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

As a minor extension, we also keep a semantic version for the `UNRELEASED`
changes.

## [0.20.0] - UNRELEASED

* **BETA** hydra-node now supports incremental commits in beta mode. We would like to test out this feature
  with the community members building on Hydra. This feature means you can commit funds to a Head while it is running.
  TODO: Implement missing spec changes.
* **BREAKING** hydra-node accepts multiple `hydra-scripts-tx-id` as a comma-seperated list, as the outcome of changes in the Hydra scripts publishing.
* Tested with `cardano-node 10.1.2` and `cardano-cli 10.1.1.0`.
* **BREAKING** Rewrite of the commit script in aiken:

  + This makes `abort` and `collectCom` transactions more efficient and results
    in a new maximum number of head participants being `8`.
  + Changes script hashes in `hydra-plutus`
* **BREAKING** Rewrite of the initial script in aiken and update to Plutus V3:

  + This makes the initial script smaller by 1337 bytes
  + Changes script hashes in `hydra-plutus`
* Fix the bug where commit endpoint drops withdraw redeemers [#1643](https://github.com/cardano-scaling/hydra/issues/1643)
* **BREAKING** Change to `SnapshotConfirmed` and `TxValid` server outputs, as
  well as to persisted `StateEvent` format:

  + Snapshots now contain the full transactions in `confirmed` and field names changed.
  + Persisted `StateChanged` events containing a snapshot changed consequently
    and are not backward compatible.
  + `TxValid` only refers to the transaction by id.
  + Overall this results in transactions still to be submitted once per client,
    but requires signifanctly less book-keeping on the client-side.
* Bump docusaurus version
* Add blockfrost support to `hydra-chain-observer`, to follow the chain via Blockfrost API.
* Fix `bench-e2e single` benchmarks and only use `--output-directory` to keep
  the whole benchmark state.
* Add `inlineDatumRaw` to transaction outputs on the `hydra-node` API.
* Use different versions of mithril depending on the network (Sanchonet/Preview: Unstable, Mainnet/Preproduction: 2450.0)
* New websocket URL parameter `?address=...` to filter `SnapshotConfirmed`, `TxValid` and `TxInvalid` server outputs by address.
* Updated `hydra-tui` to handle `incremental commits`.

## [0.19.0] - 2024-09-13

* Tested with `cardano-node 9.1.1` and `cardano-cli 9.2.1.0`
* Switch L2 ledger to use the `Conway` era. [#1178](https://github.com/cardano-scaling/hydra/issues/1178)

  + Conway formatted transactions can be submitted to the `hydra-node`, while past eras are still supported (except deprecated features like protocol updates).
  + This includes support for `PlutusV3` scripts, but most of the governance-related features have no meaning in the Hydra L2.
* Added head id information into the Greetings message.
* Adds a manual recipient address entry to `hydra-tui` and fixes event handling. [#1607](https://github.com/cardano-scaling/hydra/pull/1607)
* Add a demo mode to hydra-cluster to facilitate network resiliance tests [#1552](https://github.com/cardano-scaling/hydra/pull/1552)

## [0.18.1] - 2024-08-15

* New landing page and updated documentation style. [#1560](https://github.com/cardano-scaling/hydra/pull/1560)
* Fixed pruning of transactions when a snapshot is requested:

  + Before, the `hydra-node` would re-apply transactions in the wrong order which made already "seen" transactions (indicated by `TxValid`) disappear from the local ledger state and also not get snapshotted.
  + Details in [#1559](https://github.com/cardano-scaling/hydra/pull/1559)
* Add TLS support for the API server via `--tls-cert` and `--tls-key` command line options. [#1555](https://github.com/cardano-scaling/hydra/pull/1555)

## [0.18.0] - 2024-08-08

* Tested with `cardano-node 9.1.0` and `cardano-cli 9.2.1.0`.
* Fixed fee calculation of the internal wallet when the network switches to `Conway`. This allows heads to be opened in `Babbage` and closed/finalized in `Conway`. [#1553](https://github.com/cardano-scaling/hydra/pull/1553)
* **BREAKING** Changes to the `hydra-node` API `/commit` endpoint [#1463](https://github.com/cardano-scaling/hydra/pull/1463):

  + Removed the check that prevented committing UTxOs from an internal `hydra-node` wallet.
  + `SpendingNodeUtxoForbidden` error was removed.
* **BREAKING** Add capability to move UTxO out of an open Head to the Cardano main chain: [#1344](https://github.com/cardano-scaling/hydra/pull/1344)

  + Submitting a decommit transaction to `POST /decommit` or as `Decommit` command through websocket, requests removal of this transactions' outputs from the head.
  + When successful, `DecommitApproved` and `DecommitFinalized` indicate that all outputs are made available on the layer one.
  + Invalid transactions are explained through a `DecommitInvalid` server output.
* Change `--start-chain-from` to always use the newer point when also a head state is known. [#1471](https://github.com/cardano-scaling/hydra/pull/1471)
* Moved several pages from "core concepts" into the user manual and developer docs to futher improve user journey. [#1486](https://github.com/cardano-scaling/hydra/pull/1486)
* Offline mode of `hydra-node` uses `--node-id` to derive an artificial offline `headId`. [#1551](https://github.com/cardano-scaling/hydra/pull/1551)

## [0.17.0] - 2024-05-20

* **BREAKING** Change `hydra-node` API `/commit` endpoint for committing from scripts [#1380](https://github.com/cardano-scaling/hydra/pull/1380):

  + Instead of the custom `witness` extension of `UTxO`, the endpoint now accepts a *blueprint* transaction together with the `UTxO` which is spent in this transaction.
  + Usage is still the same for commiting "normal" `UTxO` owned by public key addresses.
  + Spending from a script `UTxO` now needs the `blueprintTx` request type, which also unlocks more involved use-cases, where the commit transaction should also satisfy script spending constraints (like additional signers, validity ranges etc.)
* *DEPRECATED* the `GetUTxO` client input and `GetUTxOResponse` server output. Use `GET /snapshot/utxo` instead.
* Update navigation and re-organized documentation website <https://hydra.family> [#1440](https://github.com/cardano-scaling/hydra/pull/1440)

  + Updated logos
  + Removed localization as it got outdated and on-demand site translation tools exist.
* Add `GET /snapshot/utxo` API endpoint to query confirmed UTxO set on demand. [#1398](https://github.com/cardano-scaling/hydra/pull/1398)

  + Always responds with the last confirmed UTxO
* Set [CORS](https://fetch.spec.whatwg.org/#http-cors-protocol) headers on `hydra-node` API to allow requests from any origin `*`. [#1434](https://github.com/cardano-scaling/hydra/pull/1434)
* `hydra-node` logs will now report `NetworkEvents` to distinguish between `ConnectivityEvent`s and `ReceivedMessage`s on the network. [#1396](https://github.com/cardano-scaling/hydra/pull/1396)
* Hydra now uses a versioned protocol for handshaking. In the event of a node
  attempting to connect using a different version of the networking protocol, a
  `HandshakeFailure` event will be recorded in the logs and sent as a server
  output on the API. [#1381](https://github.com/cardano-scaling/hydra/pull/1381)
* Make `hydra-cluster --devnet` more configurable

  + Now it is idle by default again and a `--busy` will make it busy respending the same UTxO. [#1420](https://github.com/cardano-scaling/hydra/pull/1420)

## [0.16.0] - 2024-04-03

* Tested with `cardano-node 8.9.0`, `cardano-cli 8.20.3.0` and `mithril 2412.0`.
* **BREAKING** Change to the `hydra-node` logs, monitoring and removal of `log-filter` executable:

  + Renamed the `Event` data types to `Input` and consequently log items like `BeginEvent` to `BeginInput`.
  + Changed structure of `LogicOutcome` entries.
  + Added node-level log entry when an input was `DroppedFromQueue`.
  + In course of this, the `log-filter` executable was removed as nobody is actively using it and other off-the-shelf utilities to manipulate structured JSON logs (`jq` is already quite powerful) are recommended.
  + Renamed prometheus metric `hydra_head_events -> hydra_head_inputs`.
* **BREAKING** Hydra scripts changed due to updates in the `plutus` toolchain:

  + Overall slight increase in script size.
  + 50% less memory usage in `close` and `contest` transactions.
  + Slightly less memory usage in `abort` and may be possible with 6 parties now.
* **BREAKING** Transaction serialization on hydra-node api and persisted data changed.
* Introduce `EventSource` and `EventSink` interfaces in `hydra-node`:

  + These handles can now be used as "extension points" to make the `hydra-node` store and load its state differently or expose `StateEvent`s to other, external services.
  + Internal refactoring of persistence mechanism as event source and sink in a backward-compatible way.
  + More details can be found in [ADR21](https://hydra.family/head-protocol/adr/21/)
* Add metadata to identify Hydra protocol transactions created by `hydra-node`.
* Provide more details about why a command failed. Added the state of the head logic at the point of failure.
* Fix a bug where the `hydra-node` would not correctly observe a contest transaction and fail to fanout a head [#1260](https://github.com/cardano-scaling/hydra/issues/1260).
* Add `contestationDeadline` to the `HeadIsContested` output on the `hydra-node` API.
* Add `--sanchonet` option to `hydra-cluster` binary.
* Enhance `hydra-cluster --devnet` mode to produce a constant stream of snaphsots by re-spending the sandbox UTxO.
* Reduce cost of transactions submitted by `hydra-node` by better estimating fees in internal wallet [#1315](https://github.com/cardano-scaling/hydra/pull/1315).
* Fix conversion of `Conway` blocks in `hydra-node` and `hydra-chain-observer`. This also includes tests that verify `hydra-node` working on Conway networks like `sanchonet` and the `hydra-explorer` observing heads on `sanchonet`.
* Fix a bug in the contest observation where contesters were extracted from the
  input instead of the output datum.
  [#1266](https://github.com/cardano-scaling/hydra/pull/1266)

## [0.15.0] - 2024-01-18

* Tested with `cardano-node 8.7.3` and `cardano-cli 8.17.0.0`.
* **BREAKING** Remove head state from `hydra-node` chain layer [#1196](https://github.com/cardano-scaling/hydra/pull/1196):

  + Not maintain head state in the chain layer anymore and all decision making (whether it's "our" head) is now fully contained in the logic layer.
  + This is a breaking change on the persisted `state` file, which now only stores so-called `spendableUTxO`. This raises a `PersistenceException` if an incompatible `state` file is loaded.
  + Heads need to be closed before upgrade to this version, as wiping `state` in the `--persistence-dir` is needed.
  + This also changes the `NodeOptions` log output because of internal restructuring of chain layer configuration.
* New `offline` sub-command for `hydra-node` [#1118](https://github.com/cardano-scaling/hydra/pull/1118), [#1222](https://github.com/cardano-scaling/hydra/pull/1222):

  + Initializes a head with given `--initial-utxo` parameter, and does not connect to the Cardano network.
  + Transactions submitted on the L2 are validated as usual, where the offline chain simulates time passing in slots.
  + The `--ledger-genesis` option allows to give a shelley genesis file to configure start time and slot length of the simulated chain time.
* Prepare `hydra-node` for the upcoming `Conway` hard-fork [#1177](https://github.com/cardano-scaling/hydra/issues/1177):

  + Interactions with `cardano-node` are updated to work in both, `Babbage` and `Conway` era.
  + Unsupported eras are reported as error when starting.
* Add a default for `hydra-node --node-id` (`"hydra-node-1"`) to simplify configuration.
* Fix `hydra-node` API reference & schema for `/protocol-parameters` [#1241](https://github.com/cardano-scaling/hydra/pull/1241). This now matches the JSON returned by `cardano-cli query protocol-parameters`, expected at `hydra-node --ledger-protocol-parameters` and produced by the API endpoint.
* The `hydra-cluster` binary can bootstrap `cardano-node`s running on public networks using `mithril-client`.
* **BREAKING** Internal changes to `hydra-cardano-api`:

  + Renamed `HasMultiAsset` type class to `IsMaryEraOnwards`. Use `maryEraOnwards` to produce witnesses for features from mary onwards.
  + Renamed `HasScriptData` type class to `IsAlonzoEraOnwards`. Use `alonzoEraOnwards` to produce witnesses for features from alonzo onwards.
  + Renamed `HasInlineDatums` type class to `IsBabbageEraOnwards`. Use `babbageEraOnwards` to produce witnesses for features from babbage onwards.

## [0.14.0] - 2023-12-04

* **BREAKING** Multiple changes to the Hydra Head protocol on-chain:

  + Sign the head identifier as part of snapshot signature and verify it
    on-chain. This fully addresses security advisory
    [CVE-2023-42806](https://github.com/cardano-scaling/hydra/security/advisories/GHSA-gr36-mc6v-72qq).
  + Switched to using inline datums instead of (optionally) published datums in
    transactions. [#1162](https://github.com/cardano-scaling/hydra/pull/1162)
  + Upgraded toolchain to GHC 9.6 and a newer `plutus-tx` compiler.
* **BREAKING** Internal persisted chain state serialization changed when
  switching to inline datums. Make sure to close heads before and wipe the
  `--persistence-dir` before using this `hydra-node` version.
* **BREAKING** Introduced messages resending logic in the `Network` layer to
  improve reliability in the face of connection issues.
  [#188](https://github.com/cardano-scaling/hydra/issues/188) This persists
  network messages on disk in order to gracefully handle crashes and detects
  inconsistencies between persisted state and configuration.
* Increased maximum number of parties to 5. This is possible to small
  optimizations on the Head protocol transactions.
* Removed hard-coded deposit of 2₳ from internal wallet. Now the wallet does
  only use as much deposit for script outputs as minimally needed and reduces
  the Ada locked throughout a head life-cycle.
  [#1176](https://github.com/cardano-scaling/hydra/pull/1176)
* Clients are notified when head initialization is ignored via a new
  `IgnoredHeadInitializing` API server output. This helps detecting
  misconfigurations of credentials and head parameters (which need to match).
  [#529](https://github.com/cardano-scaling/hydra/issues/529)
* Removed false positive `PostTxOnChainFailed` error from API outputs when the
  collect transaction of another `hydra-node` was "faster" than ours.
  [#839](https://github.com/cardano-scaling/hydra/issues/839)
* Hydra node API `submit-transaction` endpoint now accepts three types of
  encoding: Base16 encoded CBOR string, a TextEnvelope with CBOR and full JSON.
  [#1111](https://github.com/cardano-scaling/hydra/issues/1111)
* Improved `gen-hydra-keys` command to not overwrite keys if they are present
  already. [#1136](https://github.com/cardano-scaling/hydra/issues/1136)
* Add a `hydra-chain-observer` executable to subscribe to a chain and just
  observe Hydra Head transactions (with minimal information right now).
  [#1158](https://github.com/cardano-scaling/hydra/pull/1158)
* Fixed `hydra-tui` key bindings for exiting in dialogs.
  [#1159](https://github.com/cardano-scaling/hydra/issues/1159)

## [0.13.0] - 2023-10-03

* **BREAKING** Update to plutus 1.9. This changes the script hashes.
* Query at the tip for local cardano-node queries. We witnessed these queries
  failing in case of a rollback and always querying at the tip seems to fix
  this.
* **BREAKING** Changes to `hydra-plutus` scripts.
* Add option to draft a commit tx using inline datums.
* Remove hydra-tools package. Move functionality to generate hydra keys to the
  hydra-node executable.
* Changes to `hydra-node` state persistency:

  + Remove the recursive definition of the chain state.
  + This makes the event store more lightweight and easier to read and work with.

## [0.12.0] - 2023-08-18

* **BREAKING** Support new cardano-node version 8.1.2

  + Updated chain client and internal (layer 2) ledger versions to support the
    new cardano-node versions. No direct impact on hydra clients expected.
  + The JSON encoding of transaction as used at the `hydra-node` API changed
    slightly. Verification key witnesses (`keys` field `witnesses`) are not
    double wrapped cbor arrays anymore. Do not rely on this serialization as we
    will change this again into a more "cardanonical" form. Alternative: Use
    `cbor=true` query parameter to receive full CBOR encoded transactions.
  + The last stable cardano-node version 1.35.7 is not compatible anymore.
* **BREAKING** Remove the *DEPRECATED* `Commit` websocket command to commit
  funds held by the `hydra-node` internal wallet. Use the external commit feature
  instead. Also rename the `ErrNoFuelUTxOFound` to `ErrNoUTxOFound`.
* **BREAKING** Changes to Hydra scripts due to upgrading our plutus version and
  toolchain to GHC 9.2.8.
* **BREAKING** Change persisted state to be a sequence of events instead. This
  increases the performance of the `hydra-node` as less data needs to be written
  and prepares internal architecture for more event-sourced improvements.
* **BREAKING** Introduce authenticated network messages [#965](/cardano-scaling/hydra/blob/master/965):

  + Peers will sign messages before broadcasting them to other peers,
    and verify signature of received messages is from a known party
    and of course valid.
* **BREAKING** Layer 2 protocol change:

  + Wait for all transactions requested in a snapshot to be seen before
    acknowledging it, and only send transaction ids in snapshot requests.
* Enhanced `hydra-node` api.

  + New HTTP endpoint (`POST /cardano-transaction`) to submit a transaction on L1.
  + `Greetings` message now contains also the hydra-node version.
  + New HTTP endpoint (`GET /protocol-parameters`) which provides the current protocol parameters.
* Fixed a bug in `hydra-node` (on-chain protocol not affected) where
  multisignature verification would silently ignore certain keys in case the
  list of verification keys is not of same length as the list of signatures.
* Fixed a bug in the `hydra-tui` dialogs where recipient and UTxO to spend where
  not correctly selected.
* **BREAKING** Changes to `hydra-cardano-api`:

  + Drop `UsingRawBytesHex` as it is available upstream in `cardano-api` now.
  + Remove `totalExecutionCost` as `cardano-ledger` provides `getMinFeeTx` now.
  + Add `BundledProtocolParameters` pattern for latest `Era` to `Hydra.Cardano.Api`.
  + Add `ledgerEraVersion` for the latest `Era` en-/decoder version.
  + Change `minUTxOValue` to take `BundledProtocolParameters`.
  + Add `fromLedgerMultiAsset` helper as transactions only `mint` `MultiAsset`.
* Created `hydra-plutus-extras` package to re-use some utilities better between
  packages.

## [0.11.0] - 2023-06-30

* **BREAKING** Allow to commit multiple `UTxO` [#774](/cardano-scaling/hydra/blob/master/774)

  + This changes `hydra-plutus` scripts to allow commit transactions which
    spend multiple UTxOs into a Hydra head.
  + Removes the `MoreThanOneUTxOCommitted` server output on the API.
* Suport commits from external wallets [#215](/cardano-scaling/hydra/blob/master/215)

  + Added the `/commit` HTTP endpoint to the `hydra-node` for creating a draft
    `commit` transaction to commit requested UTxO into a head. This
    transaction can be signed and submitted to the network by the hydra client
    now instead of `hydra-node`.
  + Commits via `/commit` also allow to commit scripts into a Hydra Head. For
    that, the UTxO entry in the HTTP request needs to provide a `witness` with
    scrpit, datum, and redeemer to be used.
  + Removed the need to mark fuel when using external commits. Fees for Hydra
    protocol transactions are paid the largest UTxO held by the internal
    wallet if no marked fuel UTxO is present.
  + **BREAKING** The `hydra-tui` now uses the `--cardano-signing-key` to
    select and commit "external funds" to the Hydra Head. If you have used
    this in the past, make sure to **not use the same key** as also given to
    the `hydra-node`.
* *DEPRECATED* the `Commit` command to commit funds held by the `hydra-node`
  internal wallet. Use the external commit feature instead.
* Make `hydra-node` support time bounded transactions [#196](/cardano-scaling/hydra/blob/master/196)

  + The `hydra-node` tracks time as seen on-chain and uses that to validate
    any transactions, which can now use validity ranges the same way as on the
    layer 1.
  + Added current chain slot and time to log outputs.
* **BREAKING** API output `SnapshotConfirmed` only includes transaction ids.
  [#922](/cardano-scaling/hydra/blob/master/922)
* **BREAKING** Changed to the persisted state by removing the plutus scripts
  from the internal chain state and adding the `headId`.

  + Only the `seedTxIn` parameter is stored and the `hydra-node` will use the
    script compiled into it instead.
  + This substantially decreases the size of persisted and logged data.
* **BREAKING** Changed the `hydra-node` command line options:

  + Removed `--ledger-genesis` argument and query this information from
    `cardano-node` now. [#863](/cardano-scaling/hydra/blob/master/863)
  + `--version` always displays git revision (SHA) alongside the declared
    version. [#849](/cardano-scaling/hydra/blob/master/849)
* Fixed a bug where `hydra-node` resets head state when replaying close of
  another head. [#927](/cardano-scaling/hydra/blob/master/927)
* Fixed a bug where `hydra-node` reports a wrong head status on `Greetings`
  after restart. [#932](/cardano-scaling/hydra/blob/master/932)
* Decreased verbosity of logs [#849](/cardano-scaling/hydra/blob/master/849)

  + `BeginEvent`/`EndEvent` and `BeginEffect`/`EndEffect` log items are now
    paired using a numeric `eventId` and `effectId`.
  + Repurpose `log-filter` executable to compute duration of events and
    effects.

## [0.10.0] - 2023-05-11

* Make `hydra-node` compatible to mainnet [#713](/cardano-scaling/hydra/blob/master/713)

  + **BREAKING** Change to command line options: Replaced `--network-id` with
    `--mainnet` or `--testnet-magic`.
  + Hard-coded temporary **limit of 100 ADA** for commits to a head on
    mainnet. This will be incraeased or be made configurable in future
    versions.
* **BREAKING** Change in internal handling of rollbacks. Now, the `hydra-node`
  does only rollback it's low level state and not report when a rollback
  happened, under the optimistic assumption that the Hydra protocol transactions
  are still applicable and the Head is unaffected by the rollback. This was
  needed to avoid [#784](/cardano-scaling/hydra/blob/master/784) and will be further improved in [#185](/cardano-scaling/hydra/blob/master/185). This
  removes `RolledBack` server output from the API and also changes the log
  format of the internal `Rollback` event.
* Reject commits of `UTxO` containing `ReferenceScript` to avoid a head not
  being finalizable by the `hydra-node`. The layer 1 scripts still accept these
  outputs, but we would not be able to automatically finalize a head which was
  opened from commits with reference scripts. Reference scripts on the layer 2
  ledger (e.g. included in transactions via `NewTx`) are non-problematic.
  [#766](/cardano-scaling/hydra/blob/master/766)
* All participants try to collect once seeing the last `commitTx`. [#786](/cardano-scaling/hydra/blob/master/786)
  This may lead to misleading errors on the logs about not being able to post
  collect transactions (see also [#839](/cardano-scaling/hydra/blob/master/839)).
* The `hydra-node` detects misconfiguration and mismatch of command line options
  with persisted state. [#764](/cardano-scaling/hydra/blob/master/764)
* Fixed a bug where the `hydra-node` would crash sometimes when the
  `cardano-node` switches onto a fork, which is a common event on mainnet.
  [#560](/cardano-scaling/hydra/blob/master/560)
* **BREAKING** Hydra scripts changed, need to use new `--hydra-scripts-tx-id`

  + Check contract continuity of state machine, i.e. that the output with the
    state datum and ST is actually owned by vHead.
    [#777](/cardano-scaling/hydra/blob/master/777)
  + Collect the right value in `collect` transactions (had been dropped for cost
    reasons, but found a constant cost way to do it).
  + The right `headId` is enforced in `commit` transactions.
  + Updated `plutus-tx` tool-chain. This also resulted in changed return type
    of `validatorScript` functions of script modules to `SerialisedScript`.
    [#826](/cardano-scaling/hydra/blob/master/826)
  + Use of a custom script context for `vInitial` and `vCommit` validators to
    reduce cost of transactions again.
    [#825](/cardano-scaling/hydra/blob/master/825)
  + The hydra scripts are persisted in `hydra-plutus/scripts` and golden tests
    ensure they are not changed accidentally.
    [#772](/cardano-scaling/hydra/blob/master/772)
* **BREAKING** Changes to `hydra-node` API

  + Configurable API using query parameters. [#380](/cardano-scaling/hydra/blob/master/380) Clients can decide to:

    - Skip observing history of events before they connected
    - View the transactions in the server output encoded as CBOR
    - Prevent utxo display in `SnapshotConfirmed` server outputs
      [#808](/cardano-scaling/hydra/blob/master/808)
  + `Greetings` message is now only sent last (after replaying history) on
    connection and added additional information [#813](/cardano-scaling/hydra/blob/master/813):

    - `headStatus` - representing current hydra head status
    - `snapshotUtxo` - containing UTxOs and updating on each `SnapshotConfirmed` message
  + Updated `hydra-tui` to handle `Greetings` message accordingly. Make sure
    to use the same version.
  + Reference scripts in the `hydra-node` API (e.g. on `NewTx`) are not
    decodable when using `SimpleScriptV2` envelope anymore (just use
    `SimpleScript`).
* Versioned the documentation website, now the last released, stable is the
  default available at <https://hydra.family/head-protocol>, while the
  bleeding-edge from `master` branch is available at
  <https://hydra.family/head-protocol/unstable>. [#803](/cardano-scaling/hydra/blob/master/803) [#805](/cardano-scaling/hydra/blob/master/805) [#783](/cardano-scaling/hydra/blob/master/783)
* Add the
  [specification](https://github.com/cardano-scaling/hydra/tree/master/spec) to
  the repository and
  [website](https://hydra.family/head-protocol/dev/specification).
  [#693](/cardano-scaling/hydra/blob/master/693)
* Disabled `aarch64-darwin` support, until a `cardano-node` for this platform is
  also available.
* Use the server-provided `timestamp` of messages in the `hydra-tui`. [#837](/cardano-scaling/hydra/blob/master/837)
* **BREAKING** Changes to `hydra-cardano-api` [#826](/cardano-scaling/hydra/blob/master/826):

  + Removed `HasPlutusScriptVersion` and `plutusScriptVersion` with upstream version from `cardano-api`.
  + Renamed `getScriptData` to `txOutScriptData` to not conflict with the new function in `cardano-api`.
  + Changed `toScriptData`, `toLedgerData`, `fromLedgerData`,
    `txOutScriptData` and `lookupScriptData` to return or require a
    `HashableScriptData` instead.
  + Added `fromScriptData` generic conversion function.
  + Changed signature of `totalExecutionCost` to be more clearly `Babbage` era specific.
  + Changed `fromPlutusScript` to take new `SerialisedScript` type (it's just an alias now).
  + Added `genTxIn` and `arbitrary` instance for `TxIn`.
  + Added `getChainPoint`.

## [0.9.0] - 2023-03-02

🐲 Renamed the repository from `hydra-poc` to [`hydra`](https://github.com/cardano-scaling/hydra)!

### Changes to `hydra-node`

* **BREAKING** Changes in the persistence format
  [#725](https://github.com/cardano-scaling/hydra/pull/725),
  [#745](https://github.com/cardano-scaling/hydra/pull/745).
* **BREAKING** Changes to the API:

  + Removed `TxSeen` and `TxExpired` server outputs. Use the `TxValid` and
    `TxInvalid` responses instead.
  + All participants now see `TxValid` for all valid transactions (it replaces `TxSeen`).
  + Renamed `ReadyToCommit -> HeadIsInitializing`
  + Added a `headId` to most server outputs. [#678](https://github.com/cardano-scaling/hydra/pull/678)
  + Added a `timestamp` and a monotonic `seq`uence number. [#618](https://github.com/cardano-scaling/hydra/pull/618)
* **BREAKING** Addressed short-comings in `hydra-plutus` scripts
  [#452](https://github.com/cardano-scaling/hydra/pull/452) and improved their
  performance / reduced cost
  [#652](https://github.com/cardano-scaling/hydra/pull/652),
  [#701](https://github.com/cardano-scaling/hydra/pull/701),
  [#709](https://github.com/cardano-scaling/hydra/pull/709). Roughly the cost of
  transactions according to our
  [benchmarks](https://hydra.family/head-protocol/benchmarks/transaction-cost/)
  changed:

  + Init increased by 10%.
  + Commit reduced by 50%.
  + Collect reduced by 30%.
  + Close reduced by 0.2-0.3₳
  + Contest reduced by 0.1-0.2₳.
  + Abort reduced by 0.1-0.3₳.
  + Fanout reduced by 0.2-0.3₳.
* **BREAKING** Change the way contestation period and deadline are handled:

  + There is a new hydra-node flag `--contestation-period` expressed in seconds
    to control the close tx validity bounds as well as determine the
    contestation deadline. For example, with `--contestation-period` 60s, the
    node will close the head 60s after submitting the close transaction and
    other parties will have another 60s to contest. This means the deadline may
    be up `2 * --contestation-period` after a close transaction.
    [#615](https://github.com/cardano-scaling/hydra/pull/615) and
    [ADR21](https://hydra.family/head-protocol/adr/21/)
  + If hydra-node receives a `init` transaction with *not matching*
    `--contestation-period` then this tx is ignored which implies that all
    parties need to agree on the same value for contestation period.
  + Removed `contestationPeriod` from the `Init` API request payload.
  + The deadline get's pushed by `--contestation-period` **on each** contest
    transaction. [#716](https://github.com/cardano-scaling/hydra/pull/716)
* Change the way the internal wallet initializes its state.
  [#621](https://github.com/cardano-scaling/hydra/pull/621)

  + The internal wallet does now always query ledger state and parameters at the
    tip. This should fix the `AcquireFailure` issues.
* Added `NoFuelUTXOFound` error next to the already existing `NotEnoughFuel`.
  Previously the node would fail with `NotEnoughFuel` when utxo was not found.
  Now `NotEnoughFuel` is used when there is not enough fuel and
  `NoFuelUTXOFound` when utxo was not to be found.
* Added support have `hydra-node` to start following the chain from *genesis* by
  setting `--start-chain-from 0`.
* Added script sizes to `hydra-node --script-info` and published transaction
  cost benchmarks.
* Changes to the logs:

  + HeadLogic `Outcome` is now being logged on every protocol step transition.
  + Added intermediate `LastSeenSnapshot` and extended `RequestedSnapshot` seen snapshot states.
  + Changed wallet-related logs of `BeginInitialize`, `EndInitialize` and added
    `SkipUpdate`.

### Changes to `hydra-cardano-api`

* **BREAKING** Remove `Hydra.Cardano.Api.SlotNo` module.
* **BREAKING** Replace `fromConsensusPointHF` with `fromConsensusPointInMode` and
  `toConsensusPointHF` with `toConsensusPointInMode`.
* Re-export new `AcquiringFailure` type from `cardano-api`.
* Add `fromPlutusCurrencySymbol` conversion function.
* Introduce new `Hydra.Cardano.Api.Pretty` module and move functions
  `renderTx`, `renderTxWithUTxO` and `renderTxs` from `hydra-node` package to
  this new module.

### Other changes

* `hydra-cluster` executable can be used to provide a local cardano "network"
  with `--devnet` argument
* Switched to using [nix flakes](https://nixos.wiki/wiki/Flakes) and
  [CHaP](https://input-output-hk.github.io/cardano-haskell-packages/all-packages/)

  + Makes configuration of binary-caches easier to discover (you get asked about adding them).
  + Will make bumping dependencies (e.g. cardano-node) easier.
  + Build commands for binaries and docker images change, see updated [Contribution Guidelines](https://github.com/cardano-scaling/hydra/blob/master/CONTRIBUTING.md)

## [0.8.1] - 2022-11-17

* **BREAKING** Implemented [ADR18](https://hydra.family/head-protocol/adr/18) to keep only a single state:

  + The `hydra-node` now only uses a single `state` file in `--persistence-dir` to keep it's state.
  + The `chainState` does not include read-only chain context information anymore (is smaller now).
  + Include the `chainState` in `InvalidStateToPost` errors.
  + Moved received transaction ids into `RolledForward` log message.
  + Reduce log size by removing ChainContext. [#598](https://github.com/cardano-scaling/hydra/issues/598)
* **BREAKING** Changed internal wallet logs to help with debugging [#600](https://github.com/cardano-scaling/hydra/pull/600)

  + Split `ApplyBlock` into `BeginUpdate` and `EndUpdate`
  + Split `InitializedWallet` into `BeginInitialize` and `EndInitialize`
* After restarting `hydra-node`, clients will receive the whole history. [#580](https://github.com/cardano-scaling/hydra/issues/580)

  + This history will be stored in the `server-output` file in `--persistence-dir`.
  + Clients should use `Greetings` to identify the end of a [restart/replay of events](https://hydra.family/head-protocol/docs/api-behavior#replay-of-past-server-outputs).
* Fixed observing the chain for Hydra L1 transactions after restart. [599](https://github.com/cardano-scaling/hydra/issues/599)
* `hydra-cardano-api` now published on [Cardano Haskell Packages (CHaP)](https://input-output-hk.github.io/cardano-haskell-packages/package/hydra-cardano-api-0.8.0/). [#504](https://github.com/cardano-scaling/hydra/issues/504)

## [0.8.0] - 2022-10-27

* **BREAKING** Hydra keys now use the text envelope format.

  + `hydra-tools` executable now produces keys in the same format as cardano keys so this should make key handling simpler.
  + Take a look at the [example](https://github.com/cardano-scaling/hydra/blob/master/docs/docs/getting-started/quickstart.md#hydra-keys) on how to use `hydra-tools` to generate necessary hydra keys.
* **BREAKING** hydra-node command line flag `--node-id` is now mandatory.

  + Instead of `Host` we are using the `node-id` in the server messages like + `PeerConnected/Disconnected` which are also used in
  + the TUI to distinguish between different connected peers.
  + This also changes the way how `NodeId`s are represented on the API.
* **BREAKING** Keep track of `contestationDeadline` instead of `remainingContestationPeriod` and fix `ReadyToFanout`. [#483](https://github.com/cardano-scaling/hydra/pull/483)

  + Clients can now rely on `ReadyToFanout`, such that sending a `Fanout` input after seeing this output will never be "too early".
  + The `HeadIsClosed` server output now contains the deadline instead of the remaining time.
  + See `hydra-tui` for an example how to use the `contestationDeadline` and `ReadyToFanout`.
  + See [ADR20](/cardano-scaling/hydra/blob/master/docs/adr/2022-08-02_020-handling-time.md) for details and the rationale.
* **BREAKING** Several changes to the API:

  + The `InitialSnapshot` only contains the `initialUTxO` as the rest of the information was useless. [#533](https://github.com/cardano-scaling/hydra/pull/533)
  + Renamed `CannotSpendInput -> InternalWalletError` and `CannotCoverFees -> NotEnoughFuel`. [#582](https://github.com/cardano-scaling/hydra/pull/582)
* **BREAKING** Changed logs to improve legibility and trace on-chain posting errors. [#472](https://github.com/cardano-scaling/hydra/pull/472)

  + Strip chain layer logs to only contain `TxId` instead of full transactions in the nominal cases.
  + Renamed log entry prefixes `Processing -> Begin` and `Processed -> End`.
  + Added `PostingFailed` log entry.
* **BREAKING** The `hydra-cluster` executable (our smoke test) does require `--publish-hydra-scripts` or `--hydra-scripts-tx-id` now as it may be provided with pre-published hydra scripts.
* The `hydra-node` does persist L1 and L2 states on disk now: [#187](https://github.com/cardano-scaling/hydra/issues/187)

  + New `--persistence-dir` command line argument to configure location.
  + Writes two JSON files `headstate` and `chainstate` to the persistence directory.
  + While introspectable, modification of these files is not recommended.
* *Fixed bugs* in `hydra-node`:

  + Crash after `3k` blocks because of a failed time conversion. [#523](https://github.com/cardano-scaling/hydra/pull/523)
  + Internal wallet was losing memory of spent fuel UTxOs in presence of transaction failures. [#525](https://github.com/cardano-scaling/hydra/pull/525)
  + Node does not see some UTxOs sent to the internal wallet on startup. [#526](https://github.com/cardano-scaling/hydra/pull/526)
  + Prevent transactions from being resubmitted for application over and over. [#485](https://github.com/cardano-scaling/hydra/pull/485)
* Prevent misconfiguration of `hydra-node` by logging the command line options used and error out when:

  + provided number of Hydra parties exceeds a known working maximum (currently 4)
  + number of provided Cardano and Hydra keys is not the same
* Added a `hydra-tools` executable, to help with generating Hydra keys and get hold of the marker datum hash. [#474](https://github.com/cardano-scaling/hydra/pull/474)
* Compute transaction costs as a "min fee" and report it in the [tx-cost benchmark](https://hydra.family/head-protocol/benchmarks/transaction-cost/).
* Update [hydra-node-options](https://hydra.family/head-protocol/docs/getting-started/quickstart/#hydra-node-options) section in docs.
* Publish test results on [website](https://hydra.family/head-protocol/benchmarks/tests/hydra-node/hspec-results). [#547](https://github.com/cardano-scaling/hydra/pull/547)
* Improved `hydra-tui` user experience:

  + Fixed too fast clearing of errors and other feedback [#506](https://github.com/cardano-scaling/hydra/pull/506)
  + Introduced a pending state to avoid resubmission of transactions [#526](https://github.com/cardano-scaling/hydra/pull/526)
  + Can show full history (scrollable) [#577](https://github.com/cardano-scaling/hydra/pull/577)
* Build & publish static Linux x86\_64 executables on each [release](https://github.com/cardano-scaling/hydra/releases/tag/0.8.0) 👇 [#546](https://github.com/cardano-scaling/hydra/pull/546)

## [0.7.0] - 2022-08-23

* **BREAKING** Switch to `BabbageEra` and `PlutusV2`.

  + `hydra-cardano-api` now uses `Era = BabbageEra` and constructs `PlutusV2` scripts.
  + `hydra-plutus` scripts now use the `serialiseData` builtin to CBOR encode data on-chain.
  + `hydra-node` now expects `BabbageEra` blocks and produces `BabbageEra` transactions.
  + `hydra-cluster` now spins up a stake pool instead of a BFT node (not possible in `Praos` anymore).
  + As a consequence, the Hydra scripts in `hydra-plutus` have now different script hashes.
* **BREAKING** Use reference inputs and reference scripts in `abort` transaction.

  + Need to provide a `--hydra-scripts-tx-id` to the `hydra-node` containing the current (`--script-info`) Hydra scripts.
  + Added the `publish-scripts` sub-command to `hydra-node` to publish the current Hydra scripts.
* Added a `hydra-cluster` executable, which runs a single scenario against a known network (smoke test) [#430](https://github.com/cardano-scaling/hydra/pull/430) [#423](https://github.com/cardano-scaling/hydra/pull/430).
* Use deadline when posting a `fanoutTx` instead of the current slot [#441](https://github.com/cardano-scaling/hydra/pull/441).
* The user manual is now also available in Japanese thanks to @btbf! 🇯🇵
* Fixed display of remaining contestation period in `hydra-tui` [#437](https://github.com/cardano-scaling/hydra/pull/437).

## [0.6.0] - 2022-06-22

#### Added

* Implement on-chain contestation logic [#192](https://github.com/cardano-scaling/hydra/issues/192):

  + Node will automatically post a `Contest` transaction when it observes a `Close` or `Contest` with an obsolete snapshot
  + Posting a fan-out transaction is not possible before the contestation dealine has passed
* Transactions can now be submitted as raw CBOR-serialized object, base16 encoded, using the `NewTx` client input. This also supports the text-envelope format from cardano-cli out of the box. See the [api Reference](https://hydra.family/head-protocol/api-reference#operation-publish-/-message).
* **BREAKING** The `hydra-node` does not finalize Heads automatically anymore.

  + Instead clients do get a new `ReadyToFanout` server output after the contestation period and
  + Clients can use the `Fanout` client input command to deliberately finalize a Head when it is closed and the contestation period passed.
* Remaining contestation period is included in `HeadIsClosed` and displayed in `hydra-tui`.

#### Changed

* **BREAKING**: The starting state of a Head is renamed to `IdleState`, which is visible in the log API.

#### Fixed

* Head script to check UTxO hash upon closing the head correctly [#338](https://github.com/cardano-scaling/hydra/pull/338). Previously it was possible to close the head with arbitrary UTxO.
* Clients can fanout a Head closed without any off-chain transactions (eg. with initial snapshot) [#395](https://github.com/cardano-scaling/hydra/issues/395)

## [0.5.0] - 2022-05-06

#### Added

* Start `hydra-node` tracking the chain starting at a previous point using new `--start-chain-from` command line option [#300](https://github.com/cardano-scaling/hydra/issues/300).

  + This is handy to re-initialize a stopped (or crashed) `hydra-node` with an already inititalized Head
  + Note that off-chain state is NOT persisted, but this feature is good enough to continue opening or closing/finalizing a Head
* Handle rollbacks [#184](https://github.com/cardano-scaling/hydra/issues/184)

  + Not crash anymore on rollbacks
  + Rewind the internal head state to the point prior to rollback point
  + Added `RolledBack` server output, see [API reference](https://hydra.family/head-protocol/api-reference)
  + See the [user manual](https://hydra.family/head-protocol/dev/rollbacks/) for a detailed explanation on how rollbacks are handled.
* [Hydra Network](https://hydra.family/head-protocol/dev/networking) section on the website about networking requirements and considerations
* [Benchmarks](https://hydra.family/head-protocol/benchmarks) section on the website with continuously updated and published results on transaction costs of Hydra protocol transactions

  + These are also performed and reported now on every PR -> [Example](https://github.com/cardano-scaling/hydra/pull/340#issuecomment-1116247611)
* New architectural decision records:

  + [ADR-0017: UDP for Hydra networking](https://hydra.family/head-protocol/adr/17)
  + [ADR-0018: Single state in Hydra.Node](https://hydra.family/head-protocol/adr/18)
* Improved `hydra-node --version` to show an easier to understand and accurate revision based on `git describe`
* Added `hydra-node --script-info` to check hashes of plutus scripts available in a `hydra-node`.

  + This can also be seen as the "script version" and should stabilize as we progress in maturity of the codebase.

#### Changed

* **BREAKING** Switch to Ed25519 keys and proper EdDSA signatures for the Hydra Head protocol

  + The `--hydra-signing-key` and consequently `--hydra-verification-key` are now longer and not compatible with previous versions!
* **BREAKING** The Hydra plutus scripts have changed in course of finalizing [#181](https://github.com/cardano-scaling/hydra/issues/181)

  + All Hydra protocol transactions need to be signed by a Head participant now
  + This changes the script address(es) and the current `hydra-node` would not detect old Heads on the testnet.
* **BREAKING** Renamed server output `UTxO -> GetUTxOResponse`

  + This should be a better name for the response of `GetUTxO` client input on our API :)
* Updated our dependencies (`plutus`, `cardano-ledger`, etc.) to most recent released versions making scripts smaller and Head transactions slighly cheaper already, see benchmarks for current limits.

#### Fixed

* Reject commit transactions locking a UTxO locked by Byron addresses, part of [#182](https://github.com/cardano-scaling/hydra/issues/182)

  + This would render a Head unclosable because Byron addresses are filtered out by the ledger and not visible to plutus scripts
* Fix instructions in [demo setup without docker](https://hydra.family/head-protocol/docs/getting-started/demo/without-docker) to use `0.0.0.0` and correct paths.

#### Known Issues

* TUI quickly flashes an error on fanout. This is because all nodes try to post a fanout transaction, but only one of the participants' transactions wins. Related to [#279](https://github.com/cardano-scaling/hydra/issues/279)
* Recipient addresses to send money to in the TUI are inferred from the current UTXO set. If a party does not commit a UTXO or consumes all its UTXO in a Head, it won't be able to send or receive anything anymore.
* TUI crashes when user tries to post a new transaction without any UTXO remaining.
* The internal wallet of hydra-node requires a UTXO to be marked as "fuel" to drive the Hydra protocol transactions. See [user manual](https://hydra.family/head-protocol/docs/getting-started/demo/with-docker/#seeding-the-network).

## [0.4.0] - 2022-03-23

#### Added

* Our [user manual 📖](https://hydra.family/head-protocol) is now available! It includes installation and usage instructions, a full API reference and also a knowledge base about Hydra concepts. The manual will be an ever-evolving source of documentation that we'll maintain alongside the project.
* Support multiple Heads per Cardano network by identifying and distinguishing transactions of individual Head instances [#180](https://github.com/cardano-scaling/hydra/issues/180).
* Mint and burn state token used to thread state across the OCV state machine, and participation tokens for each party in the head [#181](https://github.com/cardano-scaling/hydra/issues/181)
* Provide (mandatory) command-line options `--ledger-genesis` and `--ledger-protocol-parameters` to configure the ledger that runs *inside a head*. Options are provided as filepath to JSON files which match formats from `cardano-cli` and `cardano-node` [#180](https://github.com/input-output-hk/hydra/issues/180).
* Created [hydra-cardano-api](https://hydra.family/head-protocol/haddock/hydra-cardano-api/) as wrapper around [cardano-api](https://github.com/input-output-hk/cardano-node/tree/master/cardano-api#cardano-api) specialized to the latest Cardano's era, and with useful extra utility functions.
* Two new architectural decision records:
  + [ADR-0014: Token usage in Hydra Scripts](https://hydra.family/head-protocol/adr/14)
  + [ADR-0015: Configuration Through an Admin API](https://hydra.family/head-protocol/adr/15)

#### Changed

* `--network-magic` option for the `hydra-node` and `hydra-tui` has been changed to `--network-id`. Also, the `hydra-tui` command-line used to default to mainnet when not provided with any `--network-magic` option, it doesn't anymore, `--network-id` is mandatory. [#180](https://github.com/input-output-hk/hydra/issues/180)
* Optimize the `CollectCom` transition of the on-chain Hydra contract to allow collecting commits from more than 2 parties! [#254](https://github.com/cardano-scaling/hydra/issues/254)
* Use a faucet to distribute funds in test suites and the `demo/` setup.
* Internally, better decouple the management of the on-chain head state from the network component. While not visible to the end user, this improvement paves the way for better handling rollbacks and on-chain *"instability"* of newly posted transactions. [#184](https://github.com/input-output-hk/hydra/issues/184)
* Internally, improved and consolidate generators used for property-based testing to cover a wider range of cases, be more consistent and also faster (avoiding to generate too large nested data-structures).

#### Fixed

* `Hydra.Network.Ouroboros` not using hard-coded valency values anymore to allow more than 7 peer connections [#203](https://github.com/cardano-scaling/hydra/issues/203).
* Build issues due to explicit packages list in nix shell [#223](https://github.com/cardano-scaling/hydra/issues/223).
* `hydra-tui` to show form focus, indicate invalid fields in dialogs and only allow valid values to be submitted [#224](https://github.com/cardano-scaling/hydra/issues/224).
* Repaired benchmarks and improved collected metrics; in particular, benchmarks now collect CPU usage and provide average confirmation times over 5s windows.
* Fixed a bug in the Fanout transaction scheduling and submission where clients would attempt to post a fanout transaction before a 'Close' transaction is even observed. Now, every participant of the head will attempt to post a fanout a transaction after they successfully observed a transaction. Of course, the layer 1 will enforce that only one fanout is posted [#279](https://github.com/input-output-hk/hydra/issues/279).

#### Known Issues

* Only no or one utxo can be committed to a Head.
* Recipient addresses to send money to in the TUI are inferred from the current UTXO set. If a party does not commit a UTXO or consumes all its UTXO in a Head, it won't be able to send or receive anything anymore.
* TUI crashes when user tries to post a new transaction without any UTXO remaining.
* The internal wallet of hydra-node requires a UTXO to be marked as "fuel" to drive the Hydra protocol transactions. See [user manual](https://hydra.family/head-protocol/docs/getting-started/demo/with-docker/#seeding-the-network).
* Aborting a head with more than 2 participants (i.e. `> 2`) requires increase in tx size limit over current mainchain parameters to ~20KB.
* Head can collect at most 3 commits and each party can commit either 1 or 0 UTXO to a Head.
* The head cannot be finalized if holding more than ~100 assets (or ~50 ada-only UTxO entries) with the standard tx size of 16KB.

## [0.3.0] - 2022-02-02

#### Added

* Implementation of on-chain verification of Hydra Head lifecycle without contests. This first version with its various shortcuts is documented on examples of the [full](/cardano-scaling/hydra/blob/master/docs/adr/img/on-chain-full.jpg) and [abort](/cardano-scaling/hydra/blob/master/docs/adr/img/on-chain-abort.jpg) on-chain life-cycles of a Hydra Head
* Enable nix-shell on Mac
* Build separate docker images for `hydra-node` and `hydra-tui` available as [packages](https://github.com/orgs/input-output-hk/packages?repo_name=hydra) from GitHub repo
* Utility executable `inspect-script` to dump contracts for further analysis
* CBOR encoder and Merkle-Tree in Plutus as separate packages `plutus-cbor` and `plutus-merkle-tree`, released & tagged separately

#### Changed

* Package `local-cluster` is now `hydra-cluster`.
* Use `cardano-api` types and functions to interact with chain.
* Refine computation of fees from internal wallet.
* Remove several sources of `error` in chain interaction component.

#### Known issues

* `collectComTx` requires increase in tx size limit over current mainchain parameters to 32KB, which should be alleviated with Plutus optimisations and merging all contracts in one in future releases
* Head can collect at most 9 commits and each party can commit either 1 or 0 UTXO to a Head
* `fanoutTx` cannot handle more than 100 UTxO with the standard tx size of 16KB (200 with the temporary increase for test purpose).
* Known issues from `0.2.0` still apply

## [0.2.0] - 2021-12-14

#### Added

* Direct chain integration which allows to connect to a real cardano-node /
  devnet; no on-chain validators though.
* Support alonzo transactions inside the Hydra Head. For now using a `freeCostModel`.
* Command line options `--node-socket`, `--network-magic` and
  `--cardano-{signing,verification}-key` to `hydra-node` and `hydra-tui` to
  configure the Cardano network access.

#### Changed

* Command line options of `hydra-node` quite significantly to distinguish hydra
  credentials from cardano credentials.
* Commit and transaction creation logic of TUI to use cardano credentials.

#### Removed

* ZeroMQ mock-chain executable, chain component and corresponding `hydra-node`
  command line options.
* ZeroMQ based network component.
* Aliases from party identifiers.

#### Fixed

* `hydra-tui` to correctly show current state when re-connecting.

#### Known issues

* There can only be one Head per Cardano network (i.e. on the devnet).
* Only no or one utxo can be committed to a Head.
* Recipient addresses to send money to in the TUI are inferred from the current
  UTXO set. If a party does not commit a UTXO or consumes all its UTXO in a
  Head, it won't be able to send or receive anything anymore.
* TUI crashes when user tries to post a new transaction wihout any UTXO
  remaining.
* Not an issue, but a workaround: The internal wallet of `hydra-node` requires a
  UTXO to be marked as "fuel" to drive the Hydra protocol transactions.

## [0.1.0] - 2021-09-30

* First proof-of-concept for a `hydra-node`

### Added

* Coordinated Hydra Head protocol
* Single Head per hydra-node
* Stubbed chain using external process
* Network statically configured, direct TCP connections
* WebSocket, message-based API Server
* Terminal user interface client

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5ff789a0_20250110_161358.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcardano-scaling%2Fhydra%2Fcommit%2F2f45529729e28254a62f7a7c8d6649066923ed1f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcardano-scaling%2Fhydra%2Fcommit%2F2f45529729e28254a62f7a7c8d6649066923ed1f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=cardano-scaling%2Fhydra)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cardano-scaling](/cardano-scaling)
/
**[hydra](/cardano-scaling/hydra)**
Public

* [Notifications](/login?return_to=%2Fcardano-scaling%2Fhydra) You must be signed in to change notification settings
* [Fork
  87](/login?return_to=%2Fcardano-scaling%2Fhydra)
* [Star
   291](/login?return_to=%2Fcardano-scaling%2Fhydra)

* [Code](/cardano-scaling/hydra)
* [Issues
  73](/cardano-scaling/hydra/issues)
* [Pull requests
  4](/cardano-scaling/hydra/pulls)
* [Discussions](/cardano-scaling/hydra/discussions)
* [Actions](/cardano-scaling/hydra/actions)
* [Projects
  1](/cardano-scaling/hydra/projects)
* [Wiki](/cardano-scaling/hydra/wiki)
* [Security](/cardano-scaling/hydra/security)
* [Insights](/cardano-scaling/hydra/pulse)

Additional navigation options

* [Code](/cardano-scaling/hydra)
* [Issues](/cardano-scaling/hydra/issues)
* [Pull requests](/cardano-scaling/hydra/pulls)
* [Discussions](/cardano-scaling/hydra/discussions)
* [Actions](/cardano-scaling/hydra/actions)
* [Projects](/cardano-scaling/hydra/projects)
* [Wiki](/cardano-scaling/hydra/wiki)
* [Security](/cardano-scaling/hydra/security)
* [Insights](/cardano-scaling/hydra/pulse)

## Commit

[Permalink](/cardano-scaling/hydra/commit/2f45529729e28254a62f7a7c8d6649066923ed1f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Ensure close transaction does not change contestation period

[Browse files](/cardano-scaling/hydra/tree/2f45529729e28254a62f7a7c8d6649066923ed1f)
Browse the repository at this point in the history

* Loading branch information

[![@abailly](https://avatars.githubusercontent.com/u/40221?s=40&v=4)](/abailly) [![@ch1bo](https://avatars.githubusercontent.com/u/2621189?s=40&v=4)](/ch1bo)

[abailly](/cardano-scaling/hydra/commits?author=abailly "View all commits by abailly")
authored and
[ch1bo](/cardano-scaling/hydra/commits?author=ch1bo "View all commits by ch1bo")
committed
Aug 31, 2023

1 parent
[07159cf](/cardano-scaling/hydra/commit/07159cfc909dcd0549ad2eb0ebcfc170ecc06833)

commit 2f45529

 Show file tree

 Hide file tree

Showing
**8 changed files**
with
**24 additions**
and
**14 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* hydra-node/test/Hydra/Chain/Direct/Contract

  + hydra-node/test/Hydra/Chain/Direct/Contract/Close.hs
    [Close.hs](#diff-2d5a1ada69de208a695126849996e45914a735af38f06b812872d01ac73b173c)
* hydra-plutus

  + hydra-plutus/hydra-plutus.cabal
    [hydra-plutus.cabal](#diff-dc10d9f40b74fbbaf4142d1e734da2e3d06135c5f507190dd3ecd471ca899547)
  + scripts

    - hydra-plutus/scripts/mHead.plutus
      [mHead.plutus](#diff-7c97603049f3737591ff0fa7db089a2952a73cfad8356b074e00a84bbb54457c)
    - hydra-plutus/scripts/vCommit.plutus
      [vCommit.plutus](#diff-6e0b4c00176fba638383433b3fc855e0edb1177bfa5a8d51e93e34de7dc70503)
    - hydra-plutus/scripts/vHead.plutus
      [vHead.plutus](#diff-e97c6d0bd3fd40a8af2b056a468e411cdbd2f42f1c8196bf9d2806e07674a6df)
    - hydra-plutus/scripts/vInitial.plutus
      [vInitial.plutus](#diff-81653062e0ece70cf395d7ed0d609f3629f0be6b517670e5d2fc175f1b7df8fb)
  + src/Hydra/Contract

    - hydra-plutus/src/Hydra/Contract/Head.hs
      [Head.hs](#diff-acbd6a75e65446acdbedda2023a91f15b072d83479648e359121ff802555c09e)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/cardano-scaling/hydra/blob/2f45529729e28254a62f7a7c8d6649066923ed1f/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -10,6 +10,8 @@ changes. |
|  |  |  |
|  |  | ## [0.13.0] - UNRELEASED |
|  |  |  |
|  |  | - \*\*BREAKING\*\* Changes to `hydra-plutus` scripts. |
|  |  |  |
|  |  | - Remove hydra-tools package. Move functionality to generate hydra keys to the |
|  |  | hydra-node executable. |
|  |  |  |
| Expand Down | |  |

8 changes: 7 additions & 1 deletion

8
[hydra-node/test/Hydra/Chain/Direct/Contract/Close.hs](#diff-2d5a1ada69de208a695126849996e45914a735af38f06b812872d01ac73b173c "hydra-node/test/Hydra/Chain/Direct/Contract/Close.hs")

Show comments

[View file](/cardano-scaling/hydra/blob/2f45529729e28254a62f7a7c8d6649066923ed1f/hydra-node/test/Hydra/Chain/Direct/Contract/Close.hs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,6 +17,7 @@ import Hydra.Chain.Direct.Contract.Mutation ( |
|  |  | changeHeadOutputDatum, |
|  |  | changeMintedTokens, |
|  |  | replaceContestationDeadline, |
|  |  | replaceContestationPeriod, |
|  |  | replaceContesters, |
|  |  | replaceHeadId, |
|  |  | replaceParties, |
| Expand All | | @@ -42,9 +43,9 @@ import Hydra.Ledger (hashUTxO) |
|  |  | import Hydra.Ledger.Cardano (genAddressInEra, genOneUTxOFor, genValue, genVerificationKey) |
|  |  | import Hydra.Ledger.Cardano.Evaluate (genValidityBoundsFromContestationPeriod) |
|  |  | import Hydra.Party (Party, deriveParty, partyToChain) |
|  |  | import Hydra.Snapshot (Snapshot (..), SnapshotNumber) |
|  |  | import Hydra.Plutus.Extras (posixFromUTCTime) |
|  |  | import Hydra.Plutus.Orphans () |
|  |  | import Hydra.Snapshot (Snapshot (..), SnapshotNumber) |
|  |  | import PlutusLedgerApi.V1.Time (DiffMilliSeconds (..), fromMilliSeconds) |
|  |  | import PlutusLedgerApi.V2 (BuiltinByteString, POSIXTime, PubKeyHash (PubKeyHash), toBuiltin) |
|  |  | import Test.Hydra.Fixture (aliceSk, bobSk, carolSk) |
| Expand Down  Expand Up | | @@ -284,6 +285,8 @@ data CloseMutation |
|  |  | -- |
|  |  | -- Ensures values are preserved between head input and output. |
|  |  | MutateValueInOutput |
|  |  | | -- | Invalidate the tx by changing the contestation period. |
|  |  | MutateContestationPeriod |
|  |  | deriving (Generic, Show, Enum, Bounded) |
|  |  |  |
|  |  | genCloseMutation :: (Tx, UTxO) -> Gen SomeMutation |
| Expand Down  Expand Up | | @@ -330,6 +333,9 @@ genCloseMutation (tx, \_utxo) = |
|  |  | , SomeMutation (Just $ toErrorCode IncorrectClosedContestationDeadline) MutateContestationDeadline <$> do |
|  |  | mutatedDeadline <- genMutatedDeadline |
|  |  | pure $ ChangeOutput 0 $ changeHeadOutputDatum (replaceContestationDeadline mutatedDeadline) headTxOut |
|  |  | , SomeMutation (Just $ toErrorCode ChangedParameters) MutateContestationPeriod <$> do |
|  |  | mutatedPeriod <- arbitrary |
|  |  | pure $ ChangeOutput 0 $ changeHeadOutputDatum (replaceContestationPeriod mutatedPeriod) headTxOut |
|  |  | , SomeMutation (Just $ toErrorCode InfiniteLowerBound) MutateInfiniteLowerBound . ChangeValidityLowerBound <$> do |
|  |  | pure TxValidityNoLowerBound |
|  |  | , SomeMutation (Just $ toErrorCode InfiniteUpperBound) MutateInfiniteUpperBound . ChangeValidityUpperBound <$> do |
| Expand Down | |  |

10 changes: 5 additions & 5 deletions

10
[hydra-plutus/hydra-plutus.cabal](#diff-dc10d9f40b74fbbaf4142d1e734da2e3d06135c5f507190dd3ecd471ca899547 "hydra-plutus/hydra-plutus.cabal")

Show comments

[View file](/cardano-scaling/hydra/blob/2f45529729e28254a62f7a7c8d6649066923ed1f/hydra-plutus/hydra-plutus.cabal)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | cabal-version: 2.2 |
|  |  | name: hydra-plutus |
|  |  | version: 0.12.0 |
|  |  | version: 0.13.0 |
|  |  | synopsis: Hydra Plutus Contracts |
|  |  | author: IOG |
|  |  | copyright: 2022 IOG |
| Expand Down  Expand Up | | @@ -100,10 +100,10 @@ library |
|  |  | , hydra-cardano-api |
|  |  | , hydra-plutus-extras |
|  |  | , hydra-prelude |
|  |  | , plutus-core  >=1.7 && <1.8 |
|  |  | , plutus-ledger-api  >=1.7 && <1.8 |
|  |  | , plutus-tx  >=1.7 && <1.8 |
|  |  | , plutus-tx-plugin  >=1.7 && <1.8 |
|  |  | , plutus-core >=1.7 && <1.8 |
|  |  | , plutus-ledger-api >=1.7 && <1.8 |
|  |  | , plutus-tx >=1.7 && <1.8 |
|  |  | , plutus-tx-plugin >=1.7 && <1.8 |
|  |  | , QuickCheck |
|  |  | , serialise |
|  |  | , template-haskell |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[hydra-plutus/scripts/mHead.plutus](#diff-7c97603049f3737591ff0fa7db089a2952a73cfad8356b074e00a84bbb54457c "hydra-plutus/scripts/mHead.plutus")

Show comments

[View file](/cardano-scaling/hydra/blob/2f45529729e28254a62f7a7c8d6649066923ed1f/hydra-plutus/scripts/mHead.plutus)
Edit file

Delete file

Load diff

Large diffs are not rendered by default.

Oops, something went wrong.

Retry

2 changes: 1 addition & 1 deletion

2
[hydra-plutus/scripts/vCommit.plutus](#diff-6e0b4c00176fba638383433b3fc855e0edb1177bfa5a8d51e93e34de7dc70503 "hydra-plutus/scripts/vCommit.plutus")

Show comments

[View file](/cardano-scaling/hydra/blob/2f45529729e28254a62f7a7c8d6649066923ed1f/hydra-plutus/scripts/vCommit.plutus)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | { |
|  |  | "type": "PlutusScriptV2", |
|  |  | "description": "hydra-vCommit-0.11.0-439-g9f4198034", |
|  |  | "description": "hydra-vCommit-0.12.0-86-gcd14dca2f", |
|  |  | "cborHex": "59082a59082701000032323232323322323322323232323232222533533223530060052225323233500713300249010343303100323301b225335001101422135002225335333573466e3c0080280640604c04c0044c01800c004cc0408d4004888888888888020c0040184cc00924010343303200323301b225335001101422135002225335333573466e3c0080280640604c0540044c01800c004cc0408d54cd40044c0392410350543800221002222200335300100622222222222200a235001220022253350011012133573800402264646666ae68cdc3800a4004424400446666ae68cdc3801240004244002464c6402e66ae70050054054050d55ce8009baa00232323333573466e1c0052000232323232323322123300100300232323333573466e1c0052000232323232323232323232323232323232323232323232323232323333332222221233333333333300100701200600500400e00d00c00300a0020083302d232323333573466e1c0052000232323233221233001003002303b0023014001357426ae894008d5d0a80089aab9e00323263203c3357380720740746aae74004dd500080619816806805199807bae00e00933300f75c01c0106605aeb8010ccc03dd710008011aba135744a01e6ae854038d5d0a8071aba1500e35742a01c6ae854038d5d0a8071aba1500e35742a01c6ae854038d5d0a8071aba1500e232323333573466e1c0052000232323232323232323333222212333300100500400300232323333573466e1c005200023232323322123300100300230260023300b025001357426ae894008d5d0a80089aab9e00323263203a33573806e0700706aae74004dd50021998073ae00d00332323333573466e1c005200423212223002004357426aae7800c8cccd5cd19b87002480088c8c84888c004010dd70009aba135573c00846666ae68cdc3801a400042444006464c6407866ae700e40e80e80e40e0d55ce8009baa0023300575c0026ae84d5d128029aba1500435742a0086ae85401088c8c8cccd5cd19b87001480008c8c8488c00800cc018004d5d09aab9e00323333573466e1c0092002212200123263203833573806a06c06c06a6aae74004dd500089aba25001135744a00226aae7800c8c98c80bccd5ce0160168169aab9d00137540024666004eb9d68009119118011bab001302b2233335573e002405246466a05266442466002006004600c6aae754004c014d55cf280098021aba200313574200405626ae8940044d5d1280089aba25001135744a00226ae8940044d5d1280089aba25001135744a00226ae8940044d5d1280089aab9e00323263201e3357380360380386aae74004dd500119191999ab9a3370e00290031191909111180200299191999ab9a3370e002900610911111100191919191999ab9a3370e00a900510911111100211999ab9a3370e00c900411919199109111111198008048041bae002375a0026ae84d5d128021aba1500323333573466e1c01d20062323233221222222233002009008375c0046eb8004d5d09aba2500635742a00a46666ae68cdc380424008464646644244444446600c01201060260046eb8004d5d09aba2500835742a00e46666ae68cdc3804a40044646424444444600e01060260026ae84d55cf00591999ab9a3370e014900011919091111111802804180a0009aba135573c018464c6405666ae700a00a40a40a009c0980940904d55cf00289aab9e004135573c0060406aae74004dd50009aba135573c00646666ae68cdc3801240084646424444600400a60100026ae84d55cf00211999ab9a3370e006900111919091111800802980e8009aba135573c00a46666ae68cdc3802240004646424444600600a6eb8004d5d09aab9e00623263202133573803c03e03e03c03a0386aae74004dd50009aba135744a0086ae85400c8c8c8cccd5cd19b87001480088c8c8c8c8c8ccc888488ccc00401401000cdd68019bad002375a0026ae84d5d128019aba1500235742a00426ae8940044d55cf00191999ab9a3370e004900011919091180100198038009aba135573c008464c6403a66ae7006806c06c068d55ce8009baa001232323333573466e1c0052002232321223001003375c0026ae84d55cf00191999ab9a3370e00490001191909118010019bae001357426aae780108c98c8070cd5ce00c80d00d00c9aab9d001375400226aae7800c8c98c8058cd5ce00980a00a1aab9d001375400220222600c921035054350032232323333573466e1c00520002323232323233322212333001004003002375c00660140046eb8004d5d09aba2500335742a0046ae8540084d5d1280089aab9e0032326320143357380220240246aae74004dd50009802119191999ab9a3370e002900011919191991091980080180118090011bae001357426ae894008d5d0a80089aab9e0032326320133357380200220226aae74004dd5000980711299a80088039109a80111299a999ab9a3371e00401a0180162666ae68cdc380099b8148001200200c00b1300600323263200e335738002018601844a66a002200a4426a00444a66a666ae68cdc78010058050048999ab9a3370e002900100500489803001919118011bac001300c2233335573e0024014466a01260086ae84008c00cd5d1001006111801000891001091000a450b48796472614865616456310012200212212233001004003232323333573466e1c005200023232323322123300100300232323333573466e1c0052000232375c0026ae84d55cf00191931900719ab9c00b00c00c35573a0026ea8008dd68009aba135744a0046ae8540044d55cf00191931900419ab9c00500600635573a0026ea80052410350543100120014988c8c00400488cc00cc0080080041" |
|  |  | } |

4 changes: 2 additions & 2 deletions

4
[hydra-plutus/scripts/vHead.plutus](#diff-e97c6d0bd3fd40a8af2b056a468e411cdbd2f42f1c8196bf9d2806e07674a6df "hydra-plutus/scripts/vHead.plutus")

Show comments

[View file](/cardano-scaling/hydra/blob/2f45529729e28254a62f7a7c8d6649066923ed1f/hydra-plutus/scripts/vHead.plutus)
Edit file

Delete file

Load diff

Large diffs are not rendered by default.

Oops, something went wrong.

Retry

2 changes: 1 addition & 1 deletion

2
[hydra-plutus/scripts/vInitial.plutus](#diff-81653062e0ece70cf395d7ed0d609f3629f0be6b517670e5d2fc175f1b7df8fb "hydra-plutus/scripts/vInitial.plutus")

Show comments

[View file](/cardano-scaling/hydra/blob/2f45529729e28254a62f7a7c8d6649066923ed1f/hydra-plutus/scripts/vInitial.plutus)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,5 @@ |
|  |  | { |
|  |  | "type": "PlutusScriptV2", |
|  |  | "description": "hydra-vInitial-0.11.0-439-g9f4198034", |
|  |  | "description": "hydra-vInitial-0.12.0-86-gcd14dca2f", |
|  |  | "cborHex": "5910335910300100003323232332233223232332232323232323232323232323233223232323232323232323232323300b22225335333004375c00664646666ae68cdc3800a4004464642446002006660380360026ae84d55cf00191999ab9a3370e0049000109100111931901199ab9c02b01f02102035573a0026ea8008c8c8cccd5cd19b87001480008c8c8c8c8c8cc8848cc00400c008c8c8cccd5cd19b87001480008c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8cccccc88888848cccccccccccc00401c04801801401003803403000c028008020cc0f48c8c8cccd5cd19b87001480008c8c8c8cc8848cc00400c008c10c008c050004d5d09aba2500235742a00226aae7800c8c98c8120cd5ce0280220231aab9d00137540020186607a01a01466601eeb8038024ccc03dd70070041981ebae00433300f75c40020046ae84d5d128079aba1500e35742a01c6ae854038d5d0a8071aba1500e35742a01c6ae854038d5d0a8071aba1500e35742a01c6ae8540388c8c8cccd5cd19b87001480008c8c8c8c8c8c8c8c8cccc888848cccc00401401000c008c8c8cccd5cd19b87001480008c8c8c8cc8848cc00400c008c098008cc02c094004d5d09aba2500235742a00226aae7800c8c98c8118cd5ce0270210221aab9d001375400866601ceb803400cc8c8cccd5cd19b87001480108c84888c008010d5d09aab9e00323333573466e1c00920022323212223001004375c0026ae84d55cf00211999ab9a3370e00690001091100191931902419ab9c05004404604504435573a0026ea8008cc015d70009aba135744a00a6ae854010d5d0a8021aba150042232323333573466e1c005200023230453006001357426aae7800c8cccd5cd19b8700248008941108c98c8110cd5ce0260200210209aab9d001375400226ae8940044d5d1280089aab9e00323263203b33573808606e0726aae74004dd500091998013ae75a0024464460046eac004c10488cccd55cf800902091919a8209981e98031aab9d5001300535573ca00260086ae8800c4d5d080101a89aba25001135744a00226ae8940044d5d1280089aba25001135744a00226ae8940044d5d1280089aba25001135744a00226aae7800c8c98c80a8cd5ce0190130141aab9d001375400464646666ae68cdc3800a400c4646424444600800a64646666ae68cdc3800a401842444444400646464646666ae68cdc3802a401442444444400846666ae68cdc38032401046464664424444444660020120106eb8008dd68009aba135744a0086ae85400c8cccd5cd19b87007480188c8c8cc8848888888cc008024020dd70011bae001357426ae894018d5d0a80291999ab9a3370e0109002119191991091111111980300480418098011bae001357426ae894020d5d0a80391999ab9a3370e01290011191909111111180380418098009aba135573c01646666ae68cdc3805240004646424444444600a01060280026ae84d55cf00611931901b99ab9c03f033035034033032031030135573c00a26aae780104d55cf0018161aab9d00137540026ae84d55cf00191999ab9a3370e00490021191909111180100298040009aba135573c00846666ae68cdc3801a40044646424444600200a604a0026ae84d55cf00291999ab9a3370e0089000119190911118018029bae001357426aae780188c98c80b4cd5ce01a8148158150148141aab9d00137540026ae84d5d128021aba15003232323333573466e1c005200223232323232333222122333001005004003375a0066eb4008dd68009aba135744a0066ae854008d5d0a80109aba25001135573c00646666ae68cdc380124000464642446004006600e0026ae84d55cf00211931901499ab9c03102502702635573a0026ea80048c8c8cccd5cd19b87001480088c8c8488c00400cdd70009aba135573c00646666ae68cdc3801240004646424460040066eb8004d5d09aab9e00423263202833573806004804c04a6aae74004dd500089aab9e00323263202233573805403c0406aae74004dd5000880d8980d24810350543500222253350021330094910349303100323302a225335001102622135002225335333573466e3c0080280ac0a84c0300044c01800c004cc054028d40048800884c8c8c8c8cc09ccc068c0392410349303300332233030225335001102d22321350032230030013034225335001130060032213500222323335002253353301f480000045400840d8894cd4cc0800080045400c40dc94cd4cc07c00520001500210361300600333015002001323335530161200101302c3355300c12001235001220013300200a00150043301250023332232322300200130312253350011003221333007220023006002300400130022200123300101302c3301400d00c500332330283301b300f4910349303400301c33027500435500122002330283301b300f490103493134003302235500122001009330283301b300f491034930320033232230020013030225335001102c221533533027005002102f13004001533532330302253350011502822135002225335330290020101302d00113006003001500321533500113020498884d4008894cd400c54cd4cc05c0052002100213024498884c099261302049010349303500323355301a1200120010013550052222222222220043301b300f490103493135003301b23012001301050051533533001009500413019498884d4008894cd400c54ccd40084c08d2410349303900213024490103493130002153353235500a222222222222300d00230332253350011502b22135002225335333573466e3c00801c0d00cc4c0c00044c01800c854cd4cc080c8c88ccccccd5d20009199919ab9a3370e6aae7540052000232323233335573ea0064a06846666aae7d400c940d48cccd55cfa8019281b11999aab9f35744a0084a66a64a66a601c0024260740022a0706ae85401c854cd4c034d5d0a80390a99a98079aba1500721303b123330010040030021503915038150372503703203103002f135744a00226ae8940044d55cf280109baa0022502f02d2502e2502e2502e2502e029322333333357480024a05c4a05c460066eb0008940b8940b80a4c0d488cccd55cf8009181781a9299a991999999aba40012333233573466e1cd55cea800a4000464646666aae7d4008940d48cccd55cfa8011281b11999aab9f35744a0064a66a646666666ae900048ccc8cd5cd19b8735573aa0029000119191999aab9f50022503e233335573ea0044a07e46666aae7cd5d128019299a991999999aba40012333233573466e1cd55cea800a40004646666aae7d4004941188cccd55cf9aba2500225335301d35742a0064260920022a08e4a08e08408226aae7940084dd5001128218209282112821128211282101e9aba1500521533532333333357480024a0864a0864a086460886eb40089410c0f8d5d0a802909821998258010008a8208a8201282001d81d01c89aba25001135573ca00426ea8008940e80e0940e4940e4940e4940e40d0d5d0a80290a99a98071aba1500521303a1233001003002150381503725037032031030135744a00226aae7940084dd500112818817928181281812818128180159aba100221533530043574400642606266a06c0040022a05e2a05c05246666666ae90004940b0940b0940b0940b08c0b4dd7001013800909a8009111981800100089812a4810349313200130244910349313100221301f49888d4004888888888888ccd54c0884800488d40088888d401088cd4008802094cd4ccd5cd19b8f00101703f03e13350403303c005006008100803800a1330183225335001213003001102b3301200b00a3500422350022222222222223333500d25031250312503123303b225335001150332213500222533533035002007130380041300600300d13301732233002001004553015120012533532355003222222222222300d00c302c2253350011502422135002225335330260020071302900413006003210011301d4910349313600135002220023024225335001102022135002225335333573466e3c0092210b4879647261486561645631000250241333573466e1c004cdc0a40009001012812098030019811910891299a800881211099a812980200119aa98030900080200091a8009100091a800911100191299a800880e899ab9c00201c235001222222222222008301e225335001101b223213500322300300130222253350011300600322135002225335333573466e1d200000102302213006003102222333573466e1c00800406806488c8cd54c024480048d400488cc068008cd54c030480048d400488cc074008ccd40048cc0212000001223300900200123300800148000004cc01000c00888cdc0001000911919aa98040900091a800911980c801199a800919aa98060900091a800911980e80118070008009119980300b001000919aa98060900091a800911980e8011aa806800800999800808801801111199aa9803890009119a80f00100099aa98050900091a800911980d8011806000999aa980389000911a80111911801003981191299a800899a8108028021109a80111299a9980600100388040980300180e80099aa98050900091a80091191980e0019800802981191299a80089aa8068019109a80111299a9980600100408911198010050020980300180111118019801000980c9108911299a800880111099802801199aa98038900080280200090911180180208909111800802180b110891299a800880b91099a80c180200119aa98030900080200091803a49034931330022300200130132235001225335002153350011012221300a4901034930370022153350031300a4910349303800221350042253350071356622135002223301a3301437666a00a444466e952000323357406a00a4466e95200032335740600200666ae80cc0108cd40048cdd2a400066ae80c00c004dd881011119ba548008cd5d01ba80033357406ea0008cd5d01ba800137620440046ec40788cd40048cdd2a400066ae80dd48009bb101f23374a900119aba037520026ec407ccd5d019919800ba9233300275246ea000400488c88dd31801000981411299a80089bb201f221350022233574066ec0c020008c01c004c01800c010cd5d02999a801899ba548000dd880d9099ba548010cd5d00009bb101c213374a900119aba037520026ec4070cd5d019800ba9002376203644a66a0024266e95200033574060060026ec40744cdd2a40046ec4070004cc068cc054018008c038cc06402400c8c8c8cccd5cd19b87001480008c8c8c8cc060c8c8cccd5cd19b87001480008c8dd70009aba135573c006464c6402466ae70068038040d55ce8009baa002375a0026ae84d5d128011aba15001135573c006464c6401866ae70050020028d55ce8009baa0012322300237580026024446666aae7c00480488cd4044c010d5d080118019aba20020062300249103493036002326320063357380020042400244666ae68cdc780100080500491299a999ab9a3371e6a004440046a002440040120102666ae68cdc39a801110009a80091000804804080424c42446004006224400244246600200600444a66a0042002200624400424400224400424424466002008006921035054310022123300100300223230010012233003300200200148811ce4c32d6dc83b2917aa7805571f30437ad98b6d20d821d34d459437550001" |
|  |  | } |

6 changes: 4 additions & 2 deletions

6
[hydra-plutus/src/Hydra/Contract/Head.hs](#diff-acbd6a75e65446acdbedda2023a91f15b072d83479648e359121ff802555c09e "hydra-plutus/src/Hydra/Contract/Head.hs")

Show comments

[View file](/cardano-scaling/hydra/blob/2f45529729e28254a62f7a7c8d6649066923ed1f/hydra-plutus/src/Hydra/Contract/Head.hs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -281,7 +281,7 @@ checkClose ctx parties initialUtxoHash sig cperiod headPolicyId = |
|  |  | traceIfFalse $(errorCode HasBoundedValidityCheckFailed) $ |
|  |  | tMax - tMin <= cp |
|  |  |  |
|  |  | (closedSnapshotNumber, closedUtxoHash, parties', closedContestationDeadline, headId', contesters') = |
|  |  | (closedSnapshotNumber, closedUtxoHash, parties', closedContestationDeadline, cperiod', headId', contesters') = |
|  |  | -- XXX: fromBuiltinData is super big (and also expensive?) |
|  |  | case fromBuiltinData @DatumType $ getDatum (headOutputDatum ctx) of |
|  |  | Just |
| Expand All | | @@ -292,7 +292,8 @@ checkClose ctx parties initialUtxoHash sig cperiod headPolicyId = |
|  |  | , contestationDeadline |
|  |  | , headId |
|  |  | , contesters |
|  |  | } -> (snapshotNumber, utxoHash, p, contestationDeadline, headId, contesters) |
|  |  | , contestationPeriod |
|  |  | } -> (snapshotNumber, utxoHash, p, contestationDeadline, contestationPeriod, headId, contesters) |
|  |  | \_ -> traceError $(errorCode WrongStateInOutputDatum) |
|  |  |  |
|  |  | checkSnapshot |
| Expand Down  Expand Up | | @@ -321,6 +322,7 @@ checkClose ctx parties initialUtxoHash sig cperiod headPolicyId = |
|  |  | traceIfFalse $(errorCode ChangedParameters) $ |
|  |  | headId' == headPolicyId |
|  |  | && parties' == parties |
|  |  | && cperiod' == cperiod |
|  |  |  |
|  |  | mustInitializeContesters = |
|  |  | traceIfFalse $(errorCode ContestersNonEmpty) $ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2f45529`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcardano-scaling%2Fhydra%2Fcommit%2F2f45529729e28254a62f7a7c8d6649066923ed1f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_9ea1fece_20250110_161357.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcardano-scaling%2Fhydra%2Fblob%2Fmaster%2Fhydra-plutus%2Fsrc%2FHydra%2FContract%2FHead.hs)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcardano-scaling%2Fhydra%2Fblob%2Fmaster%2Fhydra-plutus%2Fsrc%2FHydra%2FContract%2FHead.hs)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=cardano-scaling%2Fhydra)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cardano-scaling](/cardano-scaling)
/
**[hydra](/cardano-scaling/hydra)**
Public

* [Notifications](/login?return_to=%2Fcardano-scaling%2Fhydra) You must be signed in to change notification settings
* [Fork
  87](/login?return_to=%2Fcardano-scaling%2Fhydra)
* [Star
   291](/login?return_to=%2Fcardano-scaling%2Fhydra)

* [Code](/cardano-scaling/hydra)
* [Issues
  73](/cardano-scaling/hydra/issues)
* [Pull requests
  4](/cardano-scaling/hydra/pulls)
* [Discussions](/cardano-scaling/hydra/discussions)
* [Actions](/cardano-scaling/hydra/actions)
* [Projects
  1](/cardano-scaling/hydra/projects)
* [Wiki](/cardano-scaling/hydra/wiki)
* [Security](/cardano-scaling/hydra/security)
* [Insights](/cardano-scaling/hydra/pulse)

Additional navigation options

* [Code](/cardano-scaling/hydra)
* [Issues](/cardano-scaling/hydra/issues)
* [Pull requests](/cardano-scaling/hydra/pulls)
* [Discussions](/cardano-scaling/hydra/discussions)
* [Actions](/cardano-scaling/hydra/actions)
* [Projects](/cardano-scaling/hydra/projects)
* [Wiki](/cardano-scaling/hydra/wiki)
* [Security](/cardano-scaling/hydra/security)
* [Insights](/cardano-scaling/hydra/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


