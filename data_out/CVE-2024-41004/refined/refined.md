```
{
  "CVE-2024-41004": {
    "related": true,
    "description": "The kprobes and synth event generation test modules add events and lock (get a reference) those event file reference in module init function, and unlock and delete it in module exit function. This is because those are designed for playing as modules. If we make those modules as built-in, those events are left locked in the kernel, and never be removed. This causes kprobe event self-test failure.",
    "root_cause": "The kprobes and synth event generation test modules were being built-in instead of as modules. When built-in, the events are left locked in the kernel and never removed. The modules are designed to add events and lock them in module init and then unlock and delete in module exit.",
    "vulnerabilities": [
      "Resource leak: event file reference not unlocked and deleted when built-in instead of as a module."
    ],
    "impact": "kprobe event self-test failure, failure of ftracetest due to inability to clean up dynamic_event file",
     "attack_vectors": "Build the test modules as built-in, not as modules.",
    "attacker_capabilities": "An attacker would need to be able to configure and build the kernel."
  }
}
```