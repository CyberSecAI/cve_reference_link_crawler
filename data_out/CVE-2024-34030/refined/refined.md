The provided content is related to CVE-2024-34030.

**Root cause of vulnerability:**
The vulnerability is a NULL pointer dereference that occurs in the `of_pci_prop_intr_map` function within the Linux kernel's PCI subsystem. Specifically, if the memory allocation for `int_map` using `kcalloc` fails, the function does not handle the allocation failure and proceeds to dereference the NULL pointer.

**Weaknesses/vulnerabilities present:**
-   **NULL pointer dereference:** The core vulnerability is a NULL pointer dereference which occurs when the allocation for the `int_map` fails.
-   **Missing error handling:** The function `of_pci_prop_intr_map` does not check the return value of the `kcalloc` call, leading to the NULL dereference when `kcalloc` fails.

**Impact of exploitation:**
A NULL pointer dereference typically leads to a kernel crash (Denial of Service).

**Attack vectors:**
The vulnerability is triggered when the memory allocation for interrupt mapping within the PCI subsystem fails, which is typically during device initialization or configuration. The attacker would need to trigger the memory allocation failure within the kernel by potentially exhausting available memory.

**Required attacker capabilities/position:**
-   The attacker must be able to trigger the memory allocation failure within the PCI subsystem's `of_pci_prop_intr_map` function. This likely involves having a user or process capable of interacting with the PCI device and triggering device enumeration, or performing memory exhaustion.

**Additional details:**
The provided patches address this vulnerability by adding a check for the return value of `kcalloc` and returning `-ENOMEM` if the allocation fails. This prevents the NULL pointer dereference and avoids the kernel crash. The fix was introduced by commit `e6f7d27df5d208b50cae817a91d128fb434bb12c`.