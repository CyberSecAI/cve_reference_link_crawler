

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3130155%2Fpost-grid%2Ftags%2F2.2.87%2Fincludes%2Fblocks%2Fform-wrap%2Ffunctions.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3120992/post-grid/trunk/includes/blocks/form-wrap/functions.php "Changeset 3120992 for post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php")
* Next Change →

---

# Changeset [3130155](/changeset/3130155 "Show full changeset") for [post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
08/02/2024 04:13:56 PM
([5 months](/timeline?from=2024-08-02T16%3A13%3A56Z&precision=second "See timeline at 08/02/2024 04:13:56 PM") ago)

Author:
pickplugins
Message:

Update to version 2.2.87 from GitHub

Location:
[post-grid/tags/2.2.87](/browser/post-grid/tags/2.2.87?rev=3130155)
Files:

1 edited
1 copied

* [.](/browser/post-grid/tags/2.2.87?rev=3130155 "Show entry in browser")
  (copied)
  *(copied from [post-grid/trunk](/browser/post-grid/trunk?rev=3120992 "Show original file (revision 3130154)"))*
* [includes/blocks/form-wrap/functions.php](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155 "Show entry in browser")
  (modified)
  ([19 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php](/changeset/3130155/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php "Show the changeset 3130155 restricted to post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php")

  | [r3120992](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L79 "Show revision 3120992 of this file in browser") | [r3130155](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L79 "Show revision 3130155 of this file in browser") |  |
  | --- | --- | --- |
  | 79 | 79 | $post\_meta = $request->get\_param('post\_meta'); |
  | 80 | 80 | //$metaFields = isset($arg->metaFields) ? $arg->metaFields :  ['email']; |
  | 81 |  |  |
  | 82 |  |  |
  | 83 |  |  |
  | 84 |  |  |
  | 85 |  |  |
  | 86 | 81 |  |
  | 87 | 82 | $postParent = (!empty($post\_parent)) ? $post\_parent : $postParent; |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L138) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L133) |  |
  | 138 | 133 | } |
  | 139 | 134 |  |
  |  | 135 | ////////################/////////////// |
  |  | 136 | $post\_meta\_files = $request->get\_file\_params()['post\_meta']; |
  |  | 137 |  |
  |  | 138 | $files = []; |
  |  | 139 | if (!empty($post\_meta\_files)) { |
  |  | 140 | $i = 0; |
  |  | 141 | foreach ($post\_meta\_files as $index => $data) { |
  |  | 142 |  |
  |  | 143 | foreach ($data as $metaKey => $fileInfo) { |
  |  | 144 | $files[$metaKey][$index] = $fileInfo; |
  |  | 145 | } |
  |  | 146 | } |
  |  | 147 | } |
  |  | 148 |  |
  |  | 149 | if (!empty($files)) { |
  |  | 150 | foreach ($files as $metaKey => $metavalue) { |
  |  | 151 |  |
  |  | 152 | $file\_response = post\_grid\_upload\_file($metavalue); |
  |  | 153 |  |
  |  | 154 | if ($file\_response['id']) { |
  |  | 155 | update\_post\_meta($new\_post\_id, $metaKey, $file\_response['id']); |
  |  | 156 | } |
  |  | 157 | } |
  |  | 158 | } |
  |  | 159 |  |
  |  | 160 |  |
  |  | 161 | ///////////##################////////// |
  |  | 162 |  |
  |  | 163 |  |
  |  | 164 |  |
  |  | 165 |  |
  |  | 166 |  |
  |  | 167 |  |
  | 140 | 168 |  |
  | 141 | 169 |  |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L343) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L371) |  |
  | 343 | 371 |  |
  | 344 | 372 |  |
  |  | 373 |  |
  |  | 374 | ///////////##############/////////////////// |
  |  | 375 |  |
  |  | 376 | $term\_meta\_files = isset($request->get\_file\_params()['term\_meta']) ? $request->get\_file\_params()['term\_meta'] : []; |
  |  | 377 |  |
  |  | 378 | $files = []; |
  |  | 379 | if (!empty($term\_meta\_files)) { |
  |  | 380 | $i = 0; |
  |  | 381 | foreach ($term\_meta\_files as $index => $data) { |
  |  | 382 |  |
  |  | 383 | foreach ($data as $metaKey => $fileInfo) { |
  |  | 384 | $files[$metaKey][$index] = $fileInfo; |
  |  | 385 | } |
  |  | 386 | } |
  |  | 387 | } |
  |  | 388 |  |
  |  | 389 | if (!empty($files)) { |
  |  | 390 | foreach ($files as $metaKey => $metavalue) { |
  |  | 391 |  |
  |  | 392 | $file\_response = post\_grid\_upload\_file($metavalue); |
  |  | 393 |  |
  |  | 394 | if ($file\_response['id']) { |
  |  | 395 | update\_term\_meta($new\_term\_id, $metaKey, $file\_response['id']); |
  |  | 396 | } |
  |  | 397 | } |
  |  | 398 | } |
  |  | 399 |  |
  |  | 400 |  |
  |  | 401 |  |
  |  | 402 | ///////////##############/////////////////// |
  |  | 403 |  |
  |  | 404 |  |
  |  | 405 |  |
  |  | 406 |  |
  |  | 407 |  |
  |  | 408 |  |
  |  | 409 |  |
  |  | 410 |  |
  |  | 411 |  |
  |  | 412 |  |
  |  | 413 |  |
  |  | 414 |  |
  |  | 415 |  |
  | 345 | 416 | if ($showOnResponse) { |
  | 346 | 417 | if (is\_wp\_error($new\_term\_id)) { |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L507) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L578) |  |
  | 507 | 578 | } else { |
  | 508 | 579 | $response['errors']['sendMail'] = $errorMessage; |
  |  | 580 | } |
  |  | 581 | } |
  |  | 582 | } |
  |  | 583 |  |
  |  | 584 | if ($id == 'createWCOrder') { |
  |  | 585 |  |
  |  | 586 | $showOnResponse = isset($arg->showOnResponse) ? $arg->showOnResponse : true; |
  |  | 587 | $successMessage = isset($arg->successMessage) ? $arg->successMessage : |
  |  | 588 | \_\_('Send mail success', 'post-grid'); |
  |  | 589 | $errorMessage = isset($arg->errorMessage) ? $arg->errorMessage : |
  |  | 590 | \_\_('Send mail failed', 'post-grid'); |
  |  | 591 |  |
  |  | 592 |  |
  |  | 593 |  |
  |  | 594 | $status = form\_wrap\_process\_create\_wc\_order($arg, $request); |
  |  | 595 |  |
  |  | 596 | if ($showOnResponse) { |
  |  | 597 | if ($status) { |
  |  | 598 | $response['success']['createWCOrder'] = $successMessage; |
  |  | 599 | } else { |
  |  | 600 | $response['errors']['createWCOrder'] = $errorMessage; |
  | 509 | 601 | } |
  | 510 | 602 | } |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L2203) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L2295) |  |
  | 2203 | 2295 |  |
  | 2204 | 2296 |  |
  | 2205 |  | foreach ($comment\_meta as $metaKey => $fieldValue) { |
  | 2206 |  |  |
  | 2207 |  | //$fieldValue = isset($formFields[$metaField]) ? $formFields[$metaField] : ''; |
  | 2208 |  | update\_comment\_meta($status, $metaKey, $fieldValue); |
  | 2209 |  | } |
  |  | 2297 | if (!empty($comment\_meta)) |
  |  | 2298 | foreach ($comment\_meta as $metaKey => $fieldValue) { |
  |  | 2299 | update\_comment\_meta($status, $metaKey, $fieldValue); |
  |  | 2300 | } |
  |  | 2301 |  |
  |  | 2302 |  |
  |  | 2303 |  |
  |  | 2304 | ////////################/////////////// |
  |  | 2305 | $comment\_meta\_files = isset($request->get\_file\_params()['comment\_meta']) ? $request->get\_file\_params()['comment\_meta'] : []; |
  |  | 2306 |  |
  |  | 2307 |  |
  |  | 2308 | $files = []; |
  |  | 2309 | if (!empty($comment\_meta\_files)) { |
  |  | 2310 | $i = 0; |
  |  | 2311 | foreach ($comment\_meta\_files as $index => $data) { |
  |  | 2312 |  |
  |  | 2313 | foreach ($data as $metaKey => $fileInfo) { |
  |  | 2314 | $files[$metaKey][$index] = $fileInfo; |
  |  | 2315 | } |
  |  | 2316 | } |
  |  | 2317 | } |
  |  | 2318 |  |
  |  | 2319 | if (!empty($files)) { |
  |  | 2320 | foreach ($files as $metaKey => $metavalue) { |
  |  | 2321 |  |
  |  | 2322 |  |
  |  | 2323 | if (!empty($metavalue['name'])) { |
  |  | 2324 | $file\_response = post\_grid\_upload\_file($metavalue); |
  |  | 2325 |  |
  |  | 2326 | if ($file\_response['id']) { |
  |  | 2327 | update\_comment\_meta($status, $metaKey, $file\_response['id']); |
  |  | 2328 | } |
  |  | 2329 | } |
  |  | 2330 | } |
  |  | 2331 | } |
  |  | 2332 |  |
  |  | 2333 |  |
  |  | 2334 | ///////////##################////////// |
  |  | 2335 |  |
  |  | 2336 |  |
  |  | 2337 |  |
  |  | 2338 |  |
  |  | 2339 |  |
  | 2210 | 2340 |  |
  | 2211 | 2341 |  |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L2768) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L2898) |  |
  | 2768 | 2898 |  |
  | 2769 | 2899 |  |
  |  | 2900 | add\_filter('form\_wrap\_process\_userProfileUpdate', 'form\_wrap\_process\_userProfileUpdate', 99, 3); |
  |  | 2901 |  |
  |  | 2902 | function form\_wrap\_process\_userProfileUpdate($formFields, $onprocessargs, $request) |
  |  | 2903 | { |
  |  | 2904 |  |
  |  | 2905 |  |
  |  | 2906 | $response = []; |
  |  | 2907 |  |
  |  | 2908 | $first\_name = $request->get\_param('first\_name'); |
  |  | 2909 | $last\_name = $request->get\_param('last\_name'); |
  |  | 2910 | $display\_name = $request->get\_param('display\_name'); |
  |  | 2911 | $user\_url = $request->get\_param('user\_url'); |
  |  | 2912 | $description = $request->get\_param('description'); |
  |  | 2913 | $nickname = $request->get\_param('nickname'); |
  |  | 2914 | $locale = $request->get\_param('locale'); |
  |  | 2915 | $rich\_editing = $request->get\_param('rich\_editing'); |
  |  | 2916 | $syntax\_highlighting = $request->get\_param('syntax\_highlighting'); |
  |  | 2917 | $admin\_color = $request->get\_param('admin\_color'); |
  |  | 2918 | $admin\_bar\_front = $request->get\_param('admin\_bar\_front'); |
  |  | 2919 | $user\_login = $request->get\_param('user\_login'); |
  |  | 2920 | $user\_email = $request->get\_param('user\_email'); |
  |  | 2921 | $pass1 = $request->get\_param('pass1'); |
  |  | 2922 | $pass2 = $request->get\_param('pass2'); |
  |  | 2923 |  |
  |  | 2924 |  |
  |  | 2925 |  |
  |  | 2926 |  |
  |  | 2927 |  |
  |  | 2928 | $currentUser = wp\_get\_current\_user(); |
  |  | 2929 | $currentUserId = ($currentUser->ID) ? $currentUser->ID : 0; |
  |  | 2930 |  |
  |  | 2931 |  |
  |  | 2932 |  |
  |  | 2933 |  |
  |  | 2934 | if (!$currentUserId) { |
  |  | 2935 | $response['errors']['registerUserConfirm'] = \_\_('Please login first', 'post-grid'); |
  |  | 2936 |  |
  |  | 2937 | return $response; |
  |  | 2938 | } |
  |  | 2939 |  |
  |  | 2940 |  |
  |  | 2941 |  |
  |  | 2942 |  |
  |  | 2943 | $email\_data = []; |
  |  | 2944 |  |
  |  | 2945 |  |
  |  | 2946 | foreach ($onprocessargs as $arg) { |
  |  | 2947 |  |
  |  | 2948 | $id = $arg->id; |
  |  | 2949 |  |
  |  | 2950 |  |
  |  | 2951 | if ($id == 'updateUserProfile') { |
  |  | 2952 |  |
  |  | 2953 | $user\_new\_data = []; |
  |  | 2954 | $user\_new\_data["ID"] = $currentUserId; |
  |  | 2955 |  |
  |  | 2956 | if (!empty($first\_name)) { |
  |  | 2957 | $user\_new\_data["first\_name"] = $first\_name; |
  |  | 2958 | } |
  |  | 2959 | if (!empty($last\_name)) { |
  |  | 2960 | $user\_new\_data["last\_name"] = $last\_name; |
  |  | 2961 | } |
  |  | 2962 | if (!empty($display\_name)) { |
  |  | 2963 | $user\_new\_data["display\_name"] = $display\_name; |
  |  | 2964 | } |
  |  | 2965 | if (!empty($user\_url)) { |
  |  | 2966 | $user\_new\_data["user\_url"] = $user\_url; |
  |  | 2967 | } |
  |  | 2968 | if (!empty($description)) { |
  |  | 2969 | $user\_new\_data["description"] = $description; |
  |  | 2970 | } |
  |  | 2971 | if (!empty($nickname)) { |
  |  | 2972 | $user\_new\_data["nickname"] = $nickname; |
  |  | 2973 | } |
  |  | 2974 | if (!empty($locale)) { |
  |  | 2975 | $user\_new\_data["locale"] = $locale; |
  |  | 2976 | } |
  |  | 2977 | if (!empty($rich\_editing)) { |
  |  | 2978 | $user\_new\_data["rich\_editing"] = $rich\_editing; |
  |  | 2979 | } |
  |  | 2980 | if (!empty($syntax\_highlighting)) { |
  |  | 2981 | $user\_new\_data["syntax\_highlighting"] = $syntax\_highlighting; |
  |  | 2982 | } |
  |  | 2983 | if (!empty($admin\_color)) { |
  |  | 2984 | $user\_new\_data["admin\_color"] = $admin\_color; |
  |  | 2985 | } |
  |  | 2986 | if (!empty($admin\_bar\_front)) { |
  |  | 2987 | $user\_new\_data["admin\_bar\_front"] = $admin\_bar\_front; |
  |  | 2988 | } |
  |  | 2989 |  |
  |  | 2990 |  |
  |  | 2991 |  |
  |  | 2992 | if (!empty($user\_email)) { |
  |  | 2993 | $currentUserEmail = ($currentUser->user\_email) ? $currentUser->user\_email : 0; |
  |  | 2994 |  |
  |  | 2995 | if ($user\_email != $currentUserEmail) { |
  |  | 2996 |  |
  |  | 2997 | $user = get\_user\_by('email', $user\_email); |
  |  | 2998 |  |
  |  | 2999 | if ($user) { |
  |  | 3000 | $response['errors']['userEmailExist'] = \_\_('User email exist, Please try another.', 'post-grid'); |
  |  | 3001 | return $response; |
  |  | 3002 | } else { |
  |  | 3003 |  |
  |  | 3004 | $user\_new\_data["user\_email"] = $user\_email; |
  |  | 3005 | $response['success']['userEmailUpdateSuccess'] = \_\_('Email update request sent.', 'post-grid'); |
  |  | 3006 | } |
  |  | 3007 | } |
  |  | 3008 | } |
  |  | 3009 | // if (!empty($pass1)) { |
  |  | 3010 | //   $user\_new\_data["pass1"] = $pass1; |
  |  | 3011 | // } |
  |  | 3012 |  |
  |  | 3013 |  |
  |  | 3014 | if (isset($response['errors'])) { |
  |  | 3015 |  |
  |  | 3016 | return $response; |
  |  | 3017 | } |
  |  | 3018 |  |
  |  | 3019 |  |
  |  | 3020 |  |
  |  | 3021 |  |
  |  | 3022 | $user\_update = wp\_update\_user($user\_new\_data); |
  |  | 3023 |  |
  |  | 3024 |  |
  |  | 3025 |  |
  |  | 3026 | $user\_meta = $request->get\_param('user\_meta'); |
  |  | 3027 |  |
  |  | 3028 |  |
  |  | 3029 |  |
  |  | 3030 | if (!empty($user\_meta)) { |
  |  | 3031 | foreach ($user\_meta as $metaKey => $metavalue) { |
  |  | 3032 | update\_user\_meta($currentUserId, $metaKey, $metavalue); |
  |  | 3033 | } |
  |  | 3034 | } |
  |  | 3035 |  |
  |  | 3036 | $user\_meta\_files = $request->get\_file\_params()['user\_meta']; |
  |  | 3037 |  |
  |  | 3038 |  |
  |  | 3039 |  |
  |  | 3040 | $files = []; |
  |  | 3041 | if (!empty($user\_meta\_files)) { |
  |  | 3042 | $i = 0; |
  |  | 3043 | foreach ($user\_meta\_files as $index => $data) { |
  |  | 3044 |  |
  |  | 3045 | foreach ($data as $metaKey => $fileInfo) { |
  |  | 3046 | $files[$metaKey][$index] = $fileInfo; |
  |  | 3047 | } |
  |  | 3048 | } |
  |  | 3049 | } |
  |  | 3050 |  |
  |  | 3051 | if (!empty($files)) { |
  |  | 3052 | foreach ($files as $metaKey => $metavalue) { |
  |  | 3053 |  |
  |  | 3054 | $file\_response = post\_grid\_upload\_file($metavalue); |
  |  | 3055 |  |
  |  | 3056 | if ($file\_response['id']) { |
  |  | 3057 | update\_user\_meta($currentUserId, $metaKey, $file\_response['id']); |
  |  | 3058 | } |
  |  | 3059 | } |
  |  | 3060 | } |
  |  | 3061 |  |
  |  | 3062 |  |
  |  | 3063 |  |
  |  | 3064 |  |
  |  | 3065 |  |
  |  | 3066 |  |
  |  | 3067 |  |
  |  | 3068 |  |
  |  | 3069 |  |
  |  | 3070 |  |
  |  | 3071 | if (!is\_wp\_error($user\_update)) { |
  |  | 3072 | $response['success']['profileUpdateSuccess'] = \_\_('User profile update success', 'post-grid'); |
  |  | 3073 | } else { |
  |  | 3074 | $response['errors']['profileUpdateSuccess'] = \_\_('User profile update failed', 'post-grid'); |
  |  | 3075 | } |
  |  | 3076 | } |
  |  | 3077 |  |
  |  | 3078 |  |
  |  | 3079 | if ($id == 'doAction') { |
  |  | 3080 |  |
  |  | 3081 | $actionName = isset($arg->actionName) ? $arg->actionName : ''; |
  |  | 3082 | do\_action($actionName, $request); |
  |  | 3083 | } |
  |  | 3084 |  |
  |  | 3085 |  |
  |  | 3086 | if ($id == 'webhookRequest') { |
  |  | 3087 |  |
  |  | 3088 | $url = isset($arg->url) ? $arg->url : ''; |
  |  | 3089 | $requestHeader = isset($arg->requestHeader) ? $arg->requestHeader : true; |
  |  | 3090 | $method = isset($arg->method) ? $arg->method : 'POST'; |
  |  | 3091 | $format = isset($arg->format) ? $arg->format : ''; |
  |  | 3092 | $fields = isset($arg->fields) ? $arg->fields : []; |
  |  | 3093 |  |
  |  | 3094 | $requestPrams =  $request->get\_params(); |
  |  | 3095 |  |
  |  | 3096 | unset($requestPrams['onprocessargs']); |
  |  | 3097 | unset($requestPrams['formFieldNames']); |
  |  | 3098 |  |
  |  | 3099 |  |
  |  | 3100 | // Encode the data as JSON |
  |  | 3101 | $payload = json\_encode($requestPrams); |
  |  | 3102 |  |
  |  | 3103 | // Prepare headers |
  |  | 3104 | $headers = [ |
  |  | 3105 | 'Content-Type: application/json', |
  |  | 3106 | 'Content-Length: ' . strlen($payload) |
  |  | 3107 | ]; |
  |  | 3108 |  |
  |  | 3109 | // Initialize curl session |
  |  | 3110 | $ch = curl\_init($url); |
  |  | 3111 |  |
  |  | 3112 | // Set curl options |
  |  | 3113 | curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true); |
  |  | 3114 | curl\_setopt($ch, CURLOPT\_CUSTOMREQUEST, $method); |
  |  | 3115 | curl\_setopt($ch, CURLOPT\_POSTFIELDS, $payload); |
  |  | 3116 | curl\_setopt($ch, CURLOPT\_HTTPHEADER, $headers); |
  |  | 3117 |  |
  |  | 3118 | // Execute curl session |
  |  | 3119 | $response = curl\_exec($ch); |
  |  | 3120 |  |
  |  | 3121 | // Check for errors |
  |  | 3122 | if (curl\_errno($ch)) { |
  |  | 3123 | echo 'Webhook delivery failed: ' . curl\_error($ch); |
  |  | 3124 | } else { |
  |  | 3125 | echo 'Webhook sent successfully. Response: ' . $response; |
  |  | 3126 | } |
  |  | 3127 |  |
  |  | 3128 | // Close curl session |
  |  | 3129 | curl\_close($ch); |
  |  | 3130 | } |
  |  | 3131 |  |
  |  | 3132 |  |
  |  | 3133 |  |
  |  | 3134 | if ($id == 'createEntry') { |
  |  | 3135 | $status = form\_wrap\_process\_create\_entry($email\_data); |
  |  | 3136 |  |
  |  | 3137 |  |
  |  | 3138 | if ($status) { |
  |  | 3139 | //$response['createEntry'] = 'createEntry Success'; |
  |  | 3140 | $response['success']['createEntry'] = \_\_('Create entry success', 'post-grid'); |
  |  | 3141 | } else { |
  |  | 3142 | //$response['createEntry'] = 'createEntry Failed'; |
  |  | 3143 | $response['errors']['createEntry'] = \_\_('Create entry failed', 'post-grid'); |
  |  | 3144 | } |
  |  | 3145 | } |
  |  | 3146 | } |
  |  | 3147 |  |
  |  | 3148 |  |
  |  | 3149 |  |
  |  | 3150 |  |
  |  | 3151 |  |
  |  | 3152 |  |
  |  | 3153 |  |
  |  | 3154 |  |
  |  | 3155 |  |
  |  | 3156 | return $response; |
  |  | 3157 | } |
  |  | 3158 |  |
  | 2770 | 3159 |  |
  | 2771 | 3160 |  |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L2846) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L3235) |  |
  | 2846 | 3235 |  |
  | 2847 | 3236 |  |
  |  | 3237 |  |
  |  | 3238 | $user\_meta\_files = $request->get\_file\_params()['user\_meta']; |
  |  | 3239 |  |
  |  | 3240 | $files = []; |
  |  | 3241 | if (!empty($user\_meta\_files)) { |
  |  | 3242 | $i = 0; |
  |  | 3243 | foreach ($user\_meta\_files as $index => $data) { |
  |  | 3244 |  |
  |  | 3245 | foreach ($data as $metaKey => $fileInfo) { |
  |  | 3246 | $files[$metaKey][$index] = $fileInfo; |
  |  | 3247 | } |
  |  | 3248 | } |
  |  | 3249 | } |
  |  | 3250 |  |
  |  | 3251 | if (!empty($files)) { |
  |  | 3252 | foreach ($files as $metaKey => $metavalue) { |
  |  | 3253 |  |
  |  | 3254 | $file\_response = post\_grid\_upload\_file($metavalue); |
  |  | 3255 |  |
  |  | 3256 | if ($file\_response['id']) { |
  |  | 3257 | update\_user\_meta($new\_user\_id, $metaKey, $file\_response['id']); |
  |  | 3258 | } |
  |  | 3259 | } |
  |  | 3260 | } |
  |  | 3261 |  |
  |  | 3262 |  |
  |  | 3263 |  |
  |  | 3264 |  |
  |  | 3265 |  |
  |  | 3266 |  |
  |  | 3267 |  |
  |  | 3268 |  |
  |  | 3269 |  |
  |  | 3270 |  |
  |  | 3271 |  |
  | 2848 | 3272 | if ($new\_user\_id) { |
  | 2849 |  | ~~//$response['registerUser'] = 'User register Success';~~ |
  | 2850 | 3273 | $response['success']['registerUserExist'] = \_\_('User register Success', 'post-grid'); |
  | 2851 | 3274 | } else { |
  | 2852 |  | ~~// $response['registerUser'] = 'User register Failed';~~ |
  | 2853 | 3275 | $response['errors']['registerUserExist'] = \_\_('User register Failed', 'post-grid'); |
  | 2854 | 3276 | } |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L3315) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L3737) |  |
  | 3315 | 3737 |  |
  | 3316 | 3738 | // Execute curl session |
  | 3317 |  | $response = curl\_exec($ch); |
  |  | 3739 | $curl\_response = curl\_exec($ch); |
  | 3318 | 3740 |  |
  | 3319 | 3741 | // Check for errors |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L3321) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L3743) |  |
  | 3321 | 3743 | echo 'Webhook delivery failed: ' . curl\_error($ch); |
  | 3322 | 3744 | } else { |
  | 3323 |  | echo 'Webhook sent successfully. Response: ' . $response; |
  |  | 3745 | echo 'Webhook sent successfully. Response: ' . $curl\_response; |
  | 3324 | 3746 | } |
  | 3325 | 3747 |  |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L3354) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L3776) |  |
  | 3354 | 3776 | return $response; |
  | 3355 | 3777 | } |
  |  | 3778 | add\_filter('form\_wrap\_process\_customForm', 'form\_wrap\_process\_customForm', 99, 3); |
  |  | 3779 |  |
  |  | 3780 | function form\_wrap\_process\_customForm($formFields, $onprocessargs, $request) |
  |  | 3781 | { |
  |  | 3782 |  |
  |  | 3783 |  |
  |  | 3784 | $response = []; |
  |  | 3785 | $entryData = []; |
  |  | 3786 |  |
  |  | 3787 | $post\_grid\_block\_editor = get\_option("post\_grid\_block\_editor"); |
  |  | 3788 |  |
  |  | 3789 | $apiKeys = isset($post\_grid\_block\_editor['apiKeys']) ? $post\_grid\_block\_editor['apiKeys'] : []; |
  |  | 3790 |  |
  |  | 3791 |  |
  |  | 3792 | // if (!empty($response['errors'])) { |
  |  | 3793 | //   return $response; |
  |  | 3794 | // } |
  |  | 3795 |  |
  |  | 3796 |  |
  |  | 3797 |  |
  |  | 3798 |  |
  |  | 3799 |  |
  |  | 3800 | // Collect entry data |
  |  | 3801 | $entryData['id'] = 'customForm'; |
  |  | 3802 | $entryData['formFields'] = $formFields; |
  |  | 3803 |  |
  |  | 3804 |  |
  |  | 3805 |  |
  |  | 3806 | if (!empty($onprocessargs)) |
  |  | 3807 | foreach ($onprocessargs as $arg) { |
  |  | 3808 |  |
  |  | 3809 | $id = $arg->id; |
  |  | 3810 |  |
  |  | 3811 |  |
  |  | 3812 | if ($id == 'doAction') { |
  |  | 3813 |  |
  |  | 3814 | $actionName = isset($arg->actionName) ? $arg->actionName : ''; |
  |  | 3815 |  |
  |  | 3816 | do\_action($actionName, $request); |
  |  | 3817 | } |
  |  | 3818 | if ($id == 'droboxUpload') { |
  |  | 3819 |  |
  |  | 3820 | $accessToken = isset($apiKeys['dropbox']['args']['accessToken']) ? $apiKeys['dropbox']['args']['accessToken'] : ""; |
  |  | 3821 |  |
  |  | 3822 | if (empty($accessToken)) { |
  |  | 3823 | $response['errors']['dropboxUpload'] = \_\_("Access token is empty."); |
  |  | 3824 |  |
  |  | 3825 | return $response; |
  |  | 3826 | } |
  |  | 3827 |  |
  |  | 3828 |  |
  |  | 3829 |  |
  |  | 3830 |  |
  |  | 3831 | $path = isset($arg->path) ? $arg->path : ''; |
  |  | 3832 | $successMessage = isset($arg->successMessage) ? $arg->successMessage : ''; |
  |  | 3833 | $failedMessage = isset($arg->failedMessage) ? $arg->failedMessage : ''; |
  |  | 3834 |  |
  |  | 3835 | $files = $request->get\_file\_params(); |
  |  | 3836 |  |
  |  | 3837 |  |
  |  | 3838 | $file\_response = []; |
  |  | 3839 |  |
  |  | 3840 | foreach ($files as $fileIndex => $file) { |
  |  | 3841 |  |
  |  | 3842 | $file\_temp\_name = isset($file['tmp\_name']) ? $file['tmp\_name'] : ''; |
  |  | 3843 | $file\_name = isset($file['name']) ? $file['name'] : ''; |
  |  | 3844 |  |
  |  | 3845 |  |
  |  | 3846 | $dropboxPath = $path . '/' . $file\_name; |
  |  | 3847 | $localFilePath = $file\_temp\_name; |
  |  | 3848 | $headers = [ |
  |  | 3849 | 'Authorization: Bearer ' . $accessToken, |
  |  | 3850 | 'Dropbox-API-Arg: {"path": "' . $dropboxPath . '","mode": "add","autorename": true,"mute": false,"strict\_conflict": false}', |
  |  | 3851 | 'Content-Type: application/octet-stream', |
  |  | 3852 | ]; |
  |  | 3853 |  |
  |  | 3854 | $ch = curl\_init('https://content.dropboxapi.com/2/files/upload'); |
  |  | 3855 | curl\_setopt($ch, CURLOPT\_HTTPHEADER, $headers); |
  |  | 3856 | curl\_setopt($ch, CURLOPT\_POST, true); |
  |  | 3857 | curl\_setopt($ch, CURLOPT\_POSTFIELDS, file\_get\_contents($localFilePath)); |
  |  | 3858 | curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true); |
  |  | 3859 |  |
  |  | 3860 | $curl\_response = curl\_exec($ch); |
  |  | 3861 |  |
  |  | 3862 | $curl\_response\_obj = json\_decode($curl\_response); |
  |  | 3863 |  |
  |  | 3864 |  |
  |  | 3865 | if (!isset($curl\_response\_obj->id)) { |
  |  | 3866 | $file\_response['errors'][$fileIndex] = \_\_("File Upload failed", 'post-grid'); |
  |  | 3867 | } |
  |  | 3868 | } |
  |  | 3869 |  |
  |  | 3870 |  |
  |  | 3871 | if (isset($file\_response['errors'])) { |
  |  | 3872 | //echo 'Error: ' . curl\_error($ch); |
  |  | 3873 | $response['errors']['dropboxUpload'] = empty($errorMessage) ? $failedMessage : curl\_error($ch); |
  |  | 3874 | } else { |
  |  | 3875 | $response['success']['dropboxUpload'] = $successMessage; |
  |  | 3876 | } |
  |  | 3877 |  |
  |  | 3878 |  |
  |  | 3879 |  |
  |  | 3880 | curl\_close($ch); |
  |  | 3881 | } |
  |  | 3882 | if ($id == 'googleDriveUpload') { |
  |  | 3883 | $accessToken = "ya29.a0AcM612x9N943zfeq3Rl\_0j61mEEC-4VmsDezl9cbOWgn2kvY1yr2YcKibi0iVLnFN8lDQhGxfNloaQwUK-mnjSgiSWrd1s4gXTMUFuwL3z-BMcte8D1zt01xBm-0ECxYNvbSDFoIaPtPP8bZgp4HBgWObzwD6UA6dyA8aCgYKATQSARMSFQHGX2MiwbgUmArTs1cY6zgrqfeUXA0171"; |
  |  | 3884 | //$accessToken = isset($apiKeys['googleDrive']['args']['accessToken']) ? $apiKeys['googleDrive']['args']['accessToken'] : ""; |
  |  | 3885 |  |
  |  | 3886 | if (empty($accessToken)) { |
  |  | 3887 | $response['errors']['googleDriveUpload'] = \_\_("Access token is empty."); |
  |  | 3888 |  |
  |  | 3889 | return $response; |
  |  | 3890 | } |
  |  | 3891 |  |
  |  | 3892 |  |
  |  | 3893 |  |
  |  | 3894 |  |
  |  | 3895 | $path = isset($arg->path) ? $arg->path : ''; |
  |  | 3896 | $successMessage = isset($arg->successMessage) ? $arg->successMessage : ''; |
  |  | 3897 | $failedMessage = isset($arg->failedMessage) ? $arg->failedMessage : ''; |
  |  | 3898 |  |
  |  | 3899 | $files = $request->get\_file\_params(); |
  |  | 3900 |  |
  |  | 3901 |  |
  |  | 3902 | $file\_response = []; |
  |  | 3903 |  |
  |  | 3904 | foreach ($files as $fileIndex => $file) { |
  |  | 3905 |  |
  |  | 3906 | $file\_temp\_name = isset($file['tmp\_name']) ? $file['tmp\_name'] : ''; |
  |  | 3907 | $file\_name = isset($file['name']) ? $file['name'] : ''; |
  |  | 3908 |  |
  |  | 3909 | if (empty($file\_name)) continue; |
  |  | 3910 |  |
  |  | 3911 | $dropboxPath = $path . '/' . $file\_name; |
  |  | 3912 | //$localFilePath = $file\_temp\_name; |
  |  | 3913 | // $fileName = 'example.txt'; // Desired file name in Google Drive |
  |  | 3914 | $localFilePath = $file\_temp\_name; // Local file path |
  |  | 3915 | //$mimeType = 'text/plain'; // MIME type of the file |
  |  | 3916 | $mimeType = mime\_content\_type($file\_temp\_name); // MIME type of the file |
  |  | 3917 |  |
  |  | 3918 | $metadata = [ |
  |  | 3919 | 'name' => $file\_name |
  |  | 3920 | ]; |
  |  | 3921 |  |
  |  | 3922 | $boundary = uniqid(); |
  |  | 3923 | $delimiter = '-------------' . $boundary; |
  |  | 3924 |  |
  |  | 3925 | $postData = "--{$delimiter}\r\n" . |
  |  | 3926 | "Content-Type: application/json; charset=UTF-8\r\n\r\n" . |
  |  | 3927 | json\_encode($metadata) . "\r\n" . |
  |  | 3928 | "--{$delimiter}\r\n" . |
  |  | 3929 | "Content-Type: {$mimeType}\r\n\r\n" . |
  |  | 3930 | file\_get\_contents($localFilePath) . "\r\n" . |
  |  | 3931 | "--{$delimiter}--"; |
  |  | 3932 |  |
  |  | 3933 | $headers = [ |
  |  | 3934 | "Authorization: Bearer $accessToken", |
  |  | 3935 | "Content-Type: multipart/related; boundary={$delimiter}", |
  |  | 3936 | "Content-Length: " . strlen($postData) |
  |  | 3937 | ]; |
  |  | 3938 |  |
  |  | 3939 | $ch = curl\_init('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart'); |
  |  | 3940 | curl\_setopt($ch, CURLOPT\_HTTPHEADER, $headers); |
  |  | 3941 | curl\_setopt($ch, CURLOPT\_POST, true); |
  |  | 3942 | curl\_setopt($ch, CURLOPT\_POSTFIELDS, $postData); |
  |  | 3943 | curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true); |
  |  | 3944 | $curl\_response = curl\_exec($ch); |
  |  | 3945 |  |
  |  | 3946 | $curl\_response\_obj = json\_decode($curl\_response); |
  |  | 3947 |  |
  |  | 3948 |  |
  |  | 3949 | if (!isset($curl\_response\_obj->id)) { |
  |  | 3950 | $file\_response['errors'][$fileIndex] = \_\_("File Upload failed", 'post-grid'); |
  |  | 3951 | } |
  |  | 3952 | } |
  |  | 3953 |  |
  |  | 3954 |  |
  |  | 3955 | if (isset($file\_response['errors'])) { |
  |  | 3956 | //echo 'Error: ' . curl\_error($ch); |
  |  | 3957 | $response['errors']['dropboxUpload'] = empty($errorMessage) ? $failedMessage : curl\_error($ch); |
  |  | 3958 | } else { |
  |  | 3959 | $response['success']['dropboxUpload'] = $successMessage; |
  |  | 3960 | } |
  |  | 3961 |  |
  |  | 3962 |  |
  |  | 3963 |  |
  |  | 3964 | curl\_close($ch); |
  |  | 3965 | } |
  |  | 3966 |  |
  |  | 3967 |  |
  |  | 3968 |  |
  |  | 3969 | if ($id == 'applyFilters') { |
  |  | 3970 |  |
  |  | 3971 | $filterName = isset($arg->filterName) ? $arg->filterName : ''; |
  |  | 3972 | $successMessage = isset($arg->successMessage) ? $arg->successMessage : ''; |
  |  | 3973 | $failedMessage = isset($arg->failedMessage) ? $arg->failedMessage : ''; |
  |  | 3974 |  |
  |  | 3975 | $return = false; |
  |  | 3976 | $filter = apply\_filters($filterName, $return, $request); |
  |  | 3977 |  |
  |  | 3978 |  |
  |  | 3979 | if ($filter) { |
  |  | 3980 | $response['success']['createEntry'] = $successMessage; |
  |  | 3981 | } else { |
  |  | 3982 | $response['errors']['createEntry'] = $failedMessage; |
  |  | 3983 | } |
  |  | 3984 | } |
  |  | 3985 |  |
  |  | 3986 |  |
  |  | 3987 | if ($id == 'webhookRequest') { |
  |  | 3988 |  |
  |  | 3989 | $url = isset($arg->url) ? $arg->url : ''; |
  |  | 3990 | $requestHeader = isset($arg->requestHeader) ? $arg->requestHeader : true; |
  |  | 3991 | $method = isset($arg->method) ? $arg->method : 'POST'; |
  |  | 3992 | $format = isset($arg->format) ? $arg->format : ''; |
  |  | 3993 | $fields = isset($arg->fields) ? $arg->fields : []; |
  |  | 3994 |  |
  |  | 3995 | $requestPrams =  $request->get\_params(); |
  |  | 3996 |  |
  |  | 3997 | unset($requestPrams['onprocessargs']); |
  |  | 3998 | unset($requestPrams['formFieldNames']); |
  |  | 3999 |  |
  |  | 4000 |  |
  |  | 4001 | // Encode the data as JSON |
  |  | 4002 | $payload = json\_encode($requestPrams); |
  |  | 4003 |  |
  |  | 4004 |  |
  |  | 4005 |  |
  |  | 4006 | // Prepare headers |
  |  | 4007 | $headers = [ |
  |  | 4008 | 'Content-Type: application/json', |
  |  | 4009 | 'Content-Length: ' . strlen($payload) |
  |  | 4010 | ]; |
  |  | 4011 |  |
  |  | 4012 | // Initialize curl session |
  |  | 4013 | $ch = curl\_init($url); |
  |  | 4014 |  |
  |  | 4015 | // Set curl options |
  |  | 4016 | curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true); |
  |  | 4017 | curl\_setopt($ch, CURLOPT\_CUSTOMREQUEST, $method); |
  |  | 4018 | curl\_setopt($ch, CURLOPT\_POSTFIELDS, $payload); |
  |  | 4019 | curl\_setopt($ch, CURLOPT\_HTTPHEADER, $headers); |
  |  | 4020 |  |
  |  | 4021 | curl\_setopt($ch, CURLOPT\_SSL\_VERIFYHOST, 0); |
  |  | 4022 | curl\_setopt($ch, CURLOPT\_SSL\_VERIFYPEER, 0); |
  |  | 4023 |  |
  |  | 4024 | // Execute curl session |
  |  | 4025 | $curl\_response = curl\_exec($ch); |
  |  | 4026 |  |
  |  | 4027 | // Check for errors |
  |  | 4028 | if (curl\_errno($ch)) { |
  |  | 4029 | $failedMessage = 'Webhook delivery failed: ' . curl\_error($ch); |
  |  | 4030 | $response['errors']['createEntry'] = $failedMessage; |
  |  | 4031 | } else { |
  |  | 4032 | $successMessage =  'Webhook sent successfully. Response: ' . $curl\_response; |
  |  | 4033 | $response['success']['createEntry'] = $successMessage; |
  |  | 4034 | } |
  |  | 4035 |  |
  |  | 4036 | // Close curl session |
  |  | 4037 | curl\_close($ch); |
  |  | 4038 | } |
  |  | 4039 |  |
  |  | 4040 |  |
  |  | 4041 |  |
  |  | 4042 |  |
  |  | 4043 |  |
  |  | 4044 | if ($id == 'createEntry') { |
  |  | 4045 | $status = form\_wrap\_process\_create\_entry($entryData); |
  |  | 4046 |  |
  |  | 4047 |  |
  |  | 4048 | if ($status) { |
  |  | 4049 | $response['success']['createEntry'] = \_\_('Create entry success', 'post-grid'); |
  |  | 4050 | } else { |
  |  | 4051 | $response['errors']['createEntry'] = \_\_('Create entry failed', 'post-grid'); |
  |  | 4052 | } |
  |  | 4053 | } |
  |  | 4054 | } |
  |  | 4055 |  |
  |  | 4056 |  |
  |  | 4057 |  |
  |  | 4058 |  |
  |  | 4059 |  |
  |  | 4060 |  |
  |  | 4061 |  |
  |  | 4062 |  |
  |  | 4063 |  |
  |  | 4064 | return $response; |
  |  | 4065 | } |
  | 3356 | 4066 |  |
  | 3357 | 4067 |  |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L3366) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L4076) |  |
  | 3366 | 4076 | $full\_name = isset($formFields['full\_name']) ? sanitize\_text\_field($formFields['full\_name']) : ''; |
  | 3367 | 4077 | $email = isset($formFields['email']) ? sanitize\_email($formFields['email']) : ''; |
  | 3368 |  | $message = isset($formFields['message']) ? wp\_kses\_post($formFields['message']) : ''; |
  |  | 4078 | $mail\_message = isset($formFields['message']) ? wp\_kses\_post($formFields['message']) : ''; |
  | 3369 | 4079 | $subject = isset($formFields['subject']) ? wp\_kses\_post($formFields['subject']) : ''; |
  | 3370 | 4080 | $recaptchaResponse = isset($formFields['g-recaptcha-response']) ? wp\_kses\_post($formFields['g-recaptcha-response']) : ''; |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L3388) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L4098) |  |
  | 3388 | 4098 |  |
  | 3389 | 4099 | $id = $arg->id; |
  |  | 4100 |  |
  |  | 4101 |  |
  |  | 4102 |  |
  |  | 4103 |  |
  |  | 4104 |  |
  | 3390 | 4105 |  |
  | 3391 | 4106 | if ($id == 'sendMail') { |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L3409) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L4124) |  |
  | 3409 | 4124 | $email\_data['email\_from\_name'] = $full\_name; |
  | 3410 | 4125 | $email\_data['subject'] = $subject; |
  | 3411 |  | $email\_data['html'] = $message . $footer; |
  |  | 4126 | $email\_data['html'] = $mail\_message . $footer; |
  | 3412 | 4127 | $email\_data['attachments'] = []; |
  | 3413 | 4128 |  |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L3446) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L4161) |  |
  | 3446 | 4161 | $email\_data['reply\_to\_name'] = $replyToName; |
  | 3447 | 4162 | $email\_data['subject'] = $subject; |
  | 3448 |  | $email\_data['html'] = $message . $footer; |
  |  | 4163 | $email\_data['html'] = $mail\_message . $footer; |
  | 3449 | 4164 | $email\_data['attachments'] = []; |
  | 3450 | 4165 |  |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L3482) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L4197) |  |
  | 3482 | 4197 | $email\_data['reply\_to\_name'] = $replyToName; |
  | 3483 | 4198 | $email\_data['subject'] = $subject; |
  | 3484 |  | $email\_data['html'] = $message . $footer; |
  |  | 4199 | $email\_data['html'] = $mail\_message . $footer; |
  | 3485 | 4200 | $email\_data['attachments'] = []; |
  | 3486 | 4201 |  |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L3517) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L4232) |  |
  | 3517 | 4232 | $email\_data['reply\_to\_name'] = $replyToName; |
  | 3518 | 4233 | $email\_data['subject'] = $subject; |
  | 3519 |  | $email\_data['html'] = $message . $footer; |
  |  | 4234 | $email\_data['html'] = $mail\_message . $footer; |
  | 3520 | 4235 | $email\_data['attachments'] = []; |
  | 3521 | 4236 |  |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L3530) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L4245) |  |
  | 3530 | 4245 | } |
  | 3531 | 4246 | } |
  |  | 4247 |  |
  |  | 4248 |  |
  |  | 4249 |  |
  |  | 4250 |  |
  |  | 4251 |  |
  |  | 4252 |  |
  |  | 4253 | if ($id == 'validatedField') { |
  |  | 4254 |  |
  |  | 4255 | $conditions = isset($arg->conditions) ? $arg->conditions : []; |
  |  | 4256 | $field = isset($arg->field) ? $arg->field : ""; |
  |  | 4257 | $errorMessage = isset($arg->errorMessage) ? $arg->errorMessage : ''; |
  |  | 4258 |  |
  |  | 4259 |  |
  |  | 4260 | $fieldValue = $request->get\_param($field); |
  |  | 4261 |  |
  |  | 4262 |  |
  |  | 4263 |  |
  |  | 4264 | $valid = true; |
  |  | 4265 |  |
  |  | 4266 | if (!empty($conditions)) { |
  |  | 4267 |  |
  |  | 4268 | foreach ($conditions as $index => $condition) { |
  |  | 4269 |  |
  |  | 4270 | $compare = isset($condition->compare) ? $condition->compare : ''; |
  |  | 4271 | $relation = isset($condition->relation) ? $condition->relation : 'OR'; |
  |  | 4272 |  |
  |  | 4273 | $value = isset($condition->value) ? $condition->value : ''; |
  |  | 4274 | $values = isset($condition->values) ? $condition->values : ''; |
  |  | 4275 | $message = isset($condition->message) ? $condition->message : ''; |
  |  | 4276 |  |
  |  | 4277 |  |
  |  | 4278 |  |
  |  | 4279 | if ($compare == "equal") { |
  |  | 4280 | if ($fieldValue != $value) { |
  |  | 4281 | $response['errors']['validFailed' . $index] = $message; |
  |  | 4282 | return $response; |
  |  | 4283 | } |
  |  | 4284 | } |
  |  | 4285 |  |
  |  | 4286 | if ($compare == "notEqual") { |
  |  | 4287 | if ($fieldValue == $value) { |
  |  | 4288 | $response['errors']['validFailed' . $index] = $message; |
  |  | 4289 | return $response; |
  |  | 4290 | } |
  |  | 4291 | } |
  |  | 4292 |  |
  |  | 4293 | if ($compare == "greaterThan") { |
  |  | 4294 | $isGreater = ((int)$fieldValue > (int) $value) ? true : false; |
  |  | 4295 | if (!$isGreater) { |
  |  | 4296 | $response['errors']['validFailed' . $index] = $message; |
  |  | 4297 | return $response; |
  |  | 4298 | } |
  |  | 4299 | } |
  |  | 4300 | if ($compare == "GreaterThanEqual") { |
  |  | 4301 | $isGreater = ((int)$fieldValue >= (int) $value) ? true : false; |
  |  | 4302 | if (!$isGreater) { |
  |  | 4303 | $response['errors']['validFailed' . $index] = $message; |
  |  | 4304 | return $response; |
  |  | 4305 | } |
  |  | 4306 | } |
  |  | 4307 |  |
  |  | 4308 |  |
  |  | 4309 | if ($compare == "lessThan") { |
  |  | 4310 | $isLess = ((int)$fieldValue < (int) $value) ? true : false; |
  |  | 4311 | if (!$isLess) { |
  |  | 4312 | $response['errors']['validFailed' . $index] = $message; |
  |  | 4313 | return $response; |
  |  | 4314 | } |
  |  | 4315 | } |
  |  | 4316 | if ($compare == "lessThanEqual") { |
  |  | 4317 | $isLess = ((int)$fieldValue <= (int) $value) ? true : false; |
  |  | 4318 | if (!$isLess) { |
  |  | 4319 | $response['errors']['validFailed' . $index] = $message; |
  |  | 4320 | return $response; |
  |  | 4321 | } |
  |  | 4322 | } |
  |  | 4323 |  |
  |  | 4324 |  |
  |  | 4325 |  |
  |  | 4326 |  |
  |  | 4327 |  |
  |  | 4328 |  |
  |  | 4329 |  |
  |  | 4330 | if ($compare == "empty") { |
  |  | 4331 | if (!empty($fieldValue)) { |
  |  | 4332 | $response['errors']['validFailed' . $index] = $message; |
  |  | 4333 | return $response; |
  |  | 4334 | } |
  |  | 4335 | } |
  |  | 4336 | if ($compare == "notEmpty") { |
  |  | 4337 | if (empty($fieldValue)) { |
  |  | 4338 | $response['errors']['validFailed' . $index] = $message; |
  |  | 4339 | return $response; |
  |  | 4340 | } |
  |  | 4341 | } |
  |  | 4342 | if ($compare == "contains") { |
  |  | 4343 |  |
  |  | 4344 | if (!empty($values)) { |
  |  | 4345 |  |
  |  | 4346 | foreach ($values as $valueX) { |
  |  | 4347 | $status = preg\_match("/$valueX/", $fieldValue); |
  |  | 4348 |  |
  |  | 4349 |  |
  |  | 4350 | if ($status == 0) { |
  |  | 4351 | $response['errors']['validFailed' . $index] = $message; |
  |  | 4352 | return $response; |
  |  | 4353 | } |
  |  | 4354 | } |
  |  | 4355 | } |
  |  | 4356 | } |
  |  | 4357 | if ($compare == "notContains") { |
  |  | 4358 |  |
  |  | 4359 |  |
  |  | 4360 | if (!empty($values)) { |
  |  | 4361 |  |
  |  | 4362 | foreach ($values as $valueX) { |
  |  | 4363 | $status = preg\_match("/$valueX/", $fieldValue); |
  |  | 4364 | if ($status == 1) { |
  |  | 4365 | $response['errors']['validFailed' . $index] = $message; |
  |  | 4366 | return $response; |
  |  | 4367 | } |
  |  | 4368 | } |
  |  | 4369 | } |
  |  | 4370 | } |
  |  | 4371 | if ($compare == "startsWith") { |
  |  | 4372 | if (!empty($values)) { |
  |  | 4373 |  |
  |  | 4374 | foreach ($values as $valueX) { |
  |  | 4375 | $status = preg\_match("/^$valueX/", $fieldValue); |
  |  | 4376 |  |
  |  | 4377 |  |
  |  | 4378 | if ($status == 0) { |
  |  | 4379 | $response['errors']['validFailed' . $index] = $message; |
  |  | 4380 | return $response; |
  |  | 4381 | } |
  |  | 4382 | } |
  |  | 4383 | } |
  |  | 4384 | } |
  |  | 4385 | if ($compare == "endsWith") { |
  |  | 4386 | if (!empty($values)) { |
  |  | 4387 |  |
  |  | 4388 | foreach ($values as $valueX) { |
  |  | 4389 | $status = preg\_match("/$valueX$/", $fieldValue); |
  |  | 4390 |  |
  |  | 4391 | if ($status == 0) { |
  |  | 4392 | $response['errors']['validFailed' . $index] = $message; |
  |  | 4393 | return $response; |
  |  | 4394 | } |
  |  | 4395 | } |
  |  | 4396 | } |
  |  | 4397 | } |
  |  | 4398 | if ($compare == "regex") { |
  |  | 4399 |  |
  |  | 4400 | if (!empty($values)) { |
  |  | 4401 |  |
  |  | 4402 |  |
  |  | 4403 | if ($relation == "AND") { |
  |  | 4404 |  |
  |  | 4405 | $regexValid = true; |
  |  | 4406 |  |
  |  | 4407 | foreach ($values as $valueX) { |
  |  | 4408 | $status = preg\_match("/$valueX/", $fieldValue); |
  |  | 4409 |  |
  |  | 4410 |  |
  |  | 4411 |  |
  |  | 4412 | if ($status == 0) { |
  |  | 4413 | $regexValid = false; |
  |  | 4414 | $response['errors']['validFailed' . $index] = $message; |
  |  | 4415 |  |
  |  | 4416 | break; |
  |  | 4417 | } |
  |  | 4418 | } |
  |  | 4419 |  |
  |  | 4420 | if (!$regexValid) return $response; |
  |  | 4421 | } else { |
  |  | 4422 | $regexValid = false; |
  |  | 4423 |  |
  |  | 4424 | foreach ($values as $valueX) { |
  |  | 4425 | $status = preg\_match("/$valueX/", $fieldValue); |
  |  | 4426 |  |
  |  | 4427 |  |
  |  | 4428 |  |
  |  | 4429 | if ($status == 1) { |
  |  | 4430 | $regexValid = true; |
  |  | 4431 |  |
  |  | 4432 |  |
  |  | 4433 | break; |
  |  | 4434 | } |
  |  | 4435 | } |
  |  | 4436 |  |
  |  | 4437 |  |
  |  | 4438 |  |
  |  | 4439 | if (!$regexValid) { |
  |  | 4440 | $response['errors']['validFailed'] = $message; |
  |  | 4441 | return $response; |
  |  | 4442 | } |
  |  | 4443 | } |
  |  | 4444 | } |
  |  | 4445 | } |
  |  | 4446 | if ($compare == "between") { |
  |  | 4447 |  |
  |  | 4448 | $min = isset($values[0]) ? $values[0] : ''; |
  |  | 4449 | $max = isset($values[1]) ? $values[1] : ''; |
  |  | 4450 |  |
  |  | 4451 | $isBetween = ($min <= $fieldValue) && ($fieldValue <= $max) ? true : false; |
  |  | 4452 |  |
  |  | 4453 | if (!$isBetween) { |
  |  | 4454 | $response['errors']['validFailed' . $index] = $message; |
  |  | 4455 | return $response; |
  |  | 4456 | } |
  |  | 4457 | } |
  |  | 4458 | if ($compare == "exist") { |
  |  | 4459 |  |
  |  | 4460 | if (!in\_array($fieldValue, $values)) { |
  |  | 4461 | $response['errors']['validFailed' . $index] = $message; |
  |  | 4462 | return $response; |
  |  | 4463 | } |
  |  | 4464 | } |
  |  | 4465 | } |
  |  | 4466 | } |
  |  | 4467 | } |
  |  | 4468 |  |
  |  | 4469 |  |
  |  | 4470 |  |
  |  | 4471 |  |
  | 3532 | 4472 |  |
  | 3533 | 4473 |  |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L3647) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L4587) |  |
  | 3647 | 4587 |  |
  | 3648 | 4588 |  |
  |  | 4589 | function form\_wrap\_process\_create\_wc\_order($arg, $request) |
  |  | 4590 | { |
  |  | 4591 |  |
  |  | 4592 | $orderStatus = isset($arg->orderStatus) ? $arg->orderStatus : ''; |
  |  | 4593 | $orderStatus = !empty($orderStatus) ? $orderStatus : 'completed'; |
  |  | 4594 | $orderNote = isset($arg->orderNote) ? $arg->orderNote : ''; |
  |  | 4595 | $paymentMethod = isset($arg->paymentMethod) ? $arg->paymentMethod : 'ComboBlockForm'; |
  |  | 4596 | $paymentMethodTitle = isset($arg->paymentMethodTitle) ? $arg->paymentMethodTitle : 'ComboBlockForm'; |
  |  | 4597 |  |
  |  | 4598 |  |
  |  | 4599 |  |
  |  | 4600 |  |
  |  | 4601 | $order = wc\_create\_order(); |
  |  | 4602 |  |
  |  | 4603 | $product\_id = (int) $request->get\_param("product\_id"); |
  |  | 4604 |  |
  |  | 4605 |  |
  |  | 4606 | $first\_name = $request->get\_param("first\_name"); |
  |  | 4607 | $last\_name = $request->get\_param("last\_name"); |
  |  | 4608 | $company = $request->get\_param("company"); |
  |  | 4609 | $email = $request->get\_param("email"); |
  |  | 4610 | $phone = $request->get\_param("phone"); |
  |  | 4611 | $address\_1 = $request->get\_param("address\_1"); |
  |  | 4612 | $address\_2 = $request->get\_param("address\_2"); |
  |  | 4613 | $city = $request->get\_param("city"); |
  |  | 4614 | $state = $request->get\_param("state"); |
  |  | 4615 | $postcode = $request->get\_param("postcode"); |
  |  | 4616 | $country = $request->get\_param("country"); |
  |  | 4617 | $coupon\_code = $request->get\_param("coupon\_code"); |
  |  | 4618 |  |
  |  | 4619 | $user\_id =  email\_exists($email); |
  |  | 4620 |  |
  |  | 4621 | $product = wc\_get\_product($product\_id); |
  |  | 4622 |  |
  |  | 4623 | $downloads = $product->get\_downloads(); |
  |  | 4624 | $product->set\_downloads($downloads); |
  |  | 4625 |  |
  |  | 4626 | $order->add\_product($product); |
  |  | 4627 | $order->calculate\_totals(); |
  |  | 4628 | $order->apply\_coupon($coupon\_code); |
  |  | 4629 |  |
  |  | 4630 |  |
  |  | 4631 |  |
  |  | 4632 | $address = array( |
  |  | 4633 | 'first\_name' => $first\_name, |
  |  | 4634 | 'last\_name'  => $last\_name, |
  |  | 4635 | 'company'    => $company, |
  |  | 4636 | 'email'      => $email, |
  |  | 4637 | 'phone'      => $phone, |
  |  | 4638 | 'address\_1'  => $address\_1, |
  |  | 4639 | 'address\_2'  => $address\_2, |
  |  | 4640 | 'city'       => $city, |
  |  | 4641 | 'state'      => $state, |
  |  | 4642 | 'postcode'   => $postcode, |
  |  | 4643 | 'country'    => $country |
  |  | 4644 | ); |
  |  | 4645 | $order->set\_address($address, 'billing'); |
  |  | 4646 | $order->set\_customer\_id($user\_id); |
  |  | 4647 |  |
  |  | 4648 | $order->set\_payment\_method($paymentMethod); |
  |  | 4649 | $order->set\_payment\_method\_title($paymentMethodTitle); |
  |  | 4650 |  |
  |  | 4651 | $order->add\_order\_note($orderNote); |
  |  | 4652 |  |
  |  | 4653 |  |
  |  | 4654 | $order->update\_status($orderStatus); |
  |  | 4655 |  |
  |  | 4656 | $order->save(); |
  |  | 4657 | $order\_id = $order->get\_id(); |
  |  | 4658 |  |
  |  | 4659 | return $order\_id; |
  |  | 4660 | } |
  | 3649 | 4661 |  |
  | 3650 | 4662 |  |
  | […](/browser/post-grid/trunk/includes/blocks/form-wrap/functions.php?rev=3120992#L3677) | […](/browser/post-grid/tags/2.2.87/includes/blocks/form-wrap/functions.php?rev=3130155#L4689) |  |
  | 3677 | 4689 | return $status; |
  | 3678 | 4690 | } |
  |  | 4691 |  |
  |  | 4692 |  |
  |  | 4693 | function form\_wrap\_input\_name($inputOptions, $args) |
  |  | 4694 | { |
  |  | 4695 |  |
  |  | 4696 | $blockId = isset($args['blockId']) ? $args['blockId'] : ''; |
  |  | 4697 |  |
  |  | 4698 |  |
  |  | 4699 | $inputObjMap = isset($inputOptions['objMap']) ? $inputOptions['objMap'] : ""; |
  |  | 4700 | $inputName = !empty($inputOptions['name']) ? $inputOptions['name'] : $blockId; |
  |  | 4701 | $inputMultiple = isset($inputOptions['multiple']) ? $inputOptions['multiple'] : false; |
  |  | 4702 | $inputName = ($inputMultiple) ? $inputName . '[]' : $inputName; |
  |  | 4703 |  |
  |  | 4704 |  |
  |  | 4705 | if ($inputObjMap == 'postTerm') { |
  |  | 4706 | $inputName =  'post\_term[' . $inputName . ']'; |
  |  | 4707 | } |
  |  | 4708 |  |
  |  | 4709 | if ($inputObjMap == 'postMeta') { |
  |  | 4710 | $inputName =  'post\_meta[' . $inputName . ']'; |
  |  | 4711 | } |
  |  | 4712 | if ($inputObjMap == 'commentMeta') { |
  |  | 4713 | $inputName =  'comment\_meta[' . $inputName . ']'; |
  |  | 4714 | } |
  |  | 4715 | if ($inputObjMap == 'termMeta') { |
  |  | 4716 | $inputName =  'term\_meta[' . $inputName . ']'; |
  |  | 4717 | } |
  |  | 4718 | if ($inputObjMap == 'userMeta') { |
  |  | 4719 | $inputName =  'user\_meta[' . $inputName . ']'; |
  |  | 4720 | } |
  |  | 4721 |  |
  |  | 4722 | return $inputName; |
  |  | 4723 | } |
  |  | 4724 |  |
  |  | 4725 | function form\_wrap\_input\_default\_value($inputOptions, $args) |
  |  | 4726 | { |
  |  | 4727 |  |
  |  | 4728 |  |
  |  | 4729 | $post\_ID = isset($args['post\_ID']) ? $args['post\_ID'] : ''; |
  |  | 4730 | $blockId = isset($args['blockId']) ? $args['blockId'] : ''; |
  |  | 4731 |  |
  |  | 4732 | $currentUser = wp\_get\_current\_user(); |
  |  | 4733 |  |
  |  | 4734 | $global\_post = get\_post($post\_ID); |
  |  | 4735 |  |
  |  | 4736 | $inputType = !empty($inputOptions['type']) ? $inputOptions['type'] : ""; |
  |  | 4737 | $inputName = !empty($inputOptions['name']) ? $inputOptions['name'] : $blockId; |
  |  | 4738 | $inputValueSource = isset($inputOptions['valueSource']) ? $inputOptions['valueSource'] : ''; |
  |  | 4739 | $inputValue = isset($inputOptions['value']) ? $inputOptions['value'] : ''; |
  |  | 4740 |  |
  |  | 4741 |  |
  |  | 4742 |  |
  |  | 4743 |  |
  |  | 4744 | if (!empty($inputValueSource)) { |
  |  | 4745 | if ($inputValueSource == 'postID') { |
  |  | 4746 |  |
  |  | 4747 | $inputValue = $post\_ID; |
  |  | 4748 | } else if ($inputValueSource == 'postSlug') { |
  |  | 4749 | $inputValue = isset($global\_post->post\_name) ? $global\_post->post\_name : ""; |
  |  | 4750 | } else if ($inputValueSource == 'postTitle') { |
  |  | 4751 |  |
  |  | 4752 | $inputValue = isset($global\_post->post\_title) ? $global\_post->post\_title : ""; |
  |  | 4753 | } else if ($inputValueSource == 'postContent') { |
  |  | 4754 |  |
  |  | 4755 | $inputValue = isset($global\_post->post\_content) ? $global\_post->post\_content : ""; |
  |  | 4756 | } else if ($inputValueSource == 'postExcerpt') { |
  |  | 4757 |  |
  |  | 4758 | $inputValue = isset($global\_post->post\_excerpt) ? $global\_post->post\_excerpt : ""; |
  |  | 4759 | } else if ($inputValueSource == 'postDate') { |
  |  | 4760 |  |
  |  | 4761 | $inputValue = isset($global\_post->post\_date) ? $global\_post->post\_date : ""; |
  |  | 4762 | } else if ($inputValueSource == 'postAuthorID') { |
  |  | 4763 |  |
  |  | 4764 | $inputValue = isset($global\_post->post\_author) ? $global\_post->post\_author : 0; |
  |  | 4765 | } else if ($inputValueSource == 'postTags') { |
  |  | 4766 | $inputValue = ''; |
  |  | 4767 | } else if ($inputValueSource == 'postTagsIds') { |
  |  | 4768 | $inputValue = ''; |
  |  | 4769 | } else if ($inputValueSource == 'postCategoryIds') { |
  |  | 4770 | $inputValue = ''; |
  |  | 4771 | } else if ($inputValueSource == 'postCategorySlugs') { |
  |  | 4772 | $inputValue = ''; |
  |  | 4773 | } else if ($inputValueSource == 'userId') { |
  |  | 4774 |  |
  |  | 4775 |  |
  |  | 4776 | $inputValue = isset($currentUser->ID) ? $currentUser->ID : 0; |
  |  | 4777 | } else if ($inputValueSource == 'userEmail') { |
  |  | 4778 |  |
  |  | 4779 | $inputValue = isset($currentUser->user\_email) ? $currentUser->user\_email : ''; |
  |  | 4780 | } else if ($inputValueSource == 'userDisplayName') { |
  |  | 4781 | $inputValue = isset($currentUser->display\_name) ? $currentUser->display\_name : ''; |
  |  | 4782 | } else if ($inputValueSource == 'userFirstName') { |
  |  | 4783 | $inputValue = isset($currentUser->first\_name) ? $currentUser->first\_name : ''; |
  |  | 4784 | } else if ($inputValueSource == 'userLastName') { |
  |  | 4785 |  |
  |  | 4786 |  |
  |  | 4787 |  |
  |  | 4788 | $inputValue = isset($currentUser->last\_name) ? $currentUser->last\_name : ''; |
  |  | 4789 | } else if ($inputValueSource == 'userDescription') { |
  |  | 4790 | $inputValue = isset($currentUser->description) ? $currentUser->description : ''; |
  |  | 4791 | } else if ($inputValueSource == 'userUrl') { |
  |  | 4792 | $inputValue = isset($currentUser->user\_url) ? $currentUser->user\_url : ''; |
  |  | 4793 | } else if ($inputValueSource == 'userLogin') { |
  |  | 4794 | $inputValue = isset($currentUser->user\_login) ? $currentUser->user\_login : ''; |
  |  | 4795 | } else if ($inputValueSource == 'userNicename') { |
  |  | 4796 | $inputValue = isset($currentUser->user\_nicename) ? $currentUser->user\_nicename : ''; |
  |  | 4797 | } else if ($inputValueSource == 'GET') { |
  |  | 4798 | $inputValue = isset($\_GET[$inputName]) ? sanitize\_text\_field($\_GET[$inputName]) : ""; |
  |  | 4799 | } else if ($inputValueSource == 'postMeta') { |
  |  | 4800 | $inputValue = get\_post\_meta($post\_ID, $inputName, true); |
  |  | 4801 | } else if ($inputValueSource == 'termMeta') { |
  |  | 4802 |  |
  |  | 4803 | $currentUserId = isset($currentUser->ID) ? $currentUser->ID : 0; |
  |  | 4804 | $inputValue = get\_term\_meta($currentUserId, $inputName, true); |
  |  | 4805 |  |
  |  | 4806 | $inputValue = isset($\_GET[$inputName]) ? sanitize\_text\_field($\_GET[$inputName]) : ""; |
  |  | 4807 | } else if ($inputValueSource == 'userMeta') { |
  |  | 4808 | $currentUserId = isset($currentUser->ID) ? $currentUser->ID : 0; |
  |  | 4809 | $inputValue = get\_user\_meta($currentUserId, $inputName, true); |
  |  | 4810 | } |
  |  | 4811 | } |
  |  | 4812 |  |
  |  | 4813 |  |
  |  | 4814 | return $inputValue; |
  |  | 4815 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3130155)
* [Zip Archive](?format=zip&new=3130155)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

