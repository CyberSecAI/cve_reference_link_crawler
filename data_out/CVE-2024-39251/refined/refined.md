The provided content is related to CVE-2024-39251.

**Root cause of vulnerability:**
The `ControlCenter.sys` and `ControlCenter64.sys` drivers, developed by Quanta Computer Inc., for ThundeRobot Control Center v2.0.0.10, expose functionality that allows low-privileged users to perform privileged operations. These drivers do not restrict the privileges of the caller when handling IOCTL requests, enabling low-privileged users to execute sensitive functions.

**Weaknesses/vulnerabilities present:**
The driver exposes multiple vulnerabilities:
- Arbitrary physical memory read and write via `MmMapIoSpace` using IOCTL codes `0x9C406104` and `0x9C40A108`.
- Read/Write access to Model Specific Registers (MSRs) via IOCTL codes `0x9C402084` (`__readmsr`) and `0x9C40A148` (`__writemsr`).
- Reading Performance Monitoring Counters (PMC) using IOCTL `0x9C40208C` (`__readpmc`).
- System halt via IOCTL code `0x9C402090`
- Access to PCI bus data via `HalGetBusDataByOffset` and `HalSetBusDataByOffset` using IOCTL codes `0x9C406144` and `0x9C40A148`.
- Arbitrary read/write to I/O ports using various IOCTL codes (e.g. `0x9C4060CC`, `0x9C4060D0`, `0x9C4060D4` for input and `0x9C40A0D8`, `0x9C40A0DC`, `0x9C40A0E0` for output).

**Impact of exploitation:**
- **Privilege escalation:** Low-privileged users can exploit these vulnerabilities to gain elevated privileges by reading and modifying kernel memory and other sensitive registers.
- **Arbitrary code execution:** Attackers can execute code with high privileges by manipulating system resources and registers.
- **Information disclosure:** Reading physical memory, MSRs and PCI bus data can lead to the leakage of sensitive information.
- **Denial of service:** The ability to halt the microprocessor can be used to perform a denial of service attack.
- **Bypassing Driver-signing policy**: Since the drivers are signed they can be abused to deploy malicious unsigned code.

**Attack vectors:**
- Attackers can use specially crafted IOCTL requests through the `DeviceIoControl` API to trigger the vulnerable functions.

**Required attacker capabilities/position:**
- The attacker needs to be able to execute code on the target system.
- The attacker needs to be able to interact with the driver using the DeviceIoControl API.
- The attacker does not need special privileges to perform the exploit, since the vulnerability is that low privileged users can access the mentioned driver functions.