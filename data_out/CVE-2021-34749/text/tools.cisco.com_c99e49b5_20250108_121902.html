

[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Security AdvisoryMultiple Cisco Products Server Name Identification Data Exfiltration Vulnerability Medium   Advisory ID:  cisco-sa-sni-data-exfil-mFgzXqLN  First Published: 2021 August 18 16:00 GMT  Last Updated:  2021 September 27 16:31 GMT  Version 1.1:  [Interim](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#interim)   Workarounds:  No workarounds available  Cisco Bug IDs: [CSCvy50873](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy50873)  [CSCvy64824](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy64824)  [CSCvy76771](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy76771)  More...  ,[CSCvy50873](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy50873),[CSCvy64824](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy64824),[CSCvy76771](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy76771),[CSCvz34379](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz34379)   CVE-2021-34749     CWE-200       CVSS Score: [Base 5.8](https://sec.cloudapps.cisco.com/security/center/cvssCalculator.x?version=3.1&vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N)**Click Icon to Copy Verbose Score** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N/E:X/RL:X/RC:X       CVE-2021-34749     CWE-200       [Download CSAF](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-sni-data-exfil-mFgzXqLN/csaf/cisco-sa-sni-data-exfil-mFgzXqLN.json)   Email      Summary  * A vulnerability in the web filtering features of multiple Cisco products could allow an unauthenticated, remote attacker to bypass web reputation filters and threat detection mechanisms on an affected device and exfiltrate data from a compromised host to a blocked external server.  This vulnerability is due to inadequate inspection of the Server Name Identification (SNI) header in the SSL/TLS handshake. An attacker could exploit this vulnerability by using data from the TLS client hello packet to communicate with a blocked external server. A successful exploit could be used to exfiltrate data from a protected network. The attacker must compromise a host on the network to exfiltrate the sensitive data.  The following Snort rule can be used to detect possible exploitation of this vulnerability: Snort SID 58062.  There are no workarounds that address this vulnerability.  This advisory is available at the following link:<https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-sni-data-exfil-mFgzXqLN>  Affected Products  * Vulnerable Products At the time of publication, this vulnerability affected all open source Snort project releases earlier than Release 2.9.18. For more information about open source Snort, see the [Snort website](https://www.snort.org/).  At the time of publication, this vulnerability affected the following Cisco products if they were configured with the SSL/TLS decryption option and were also using web reputation or URL filtering features:    + 3000 Series Industrial Security Appliances (ISAs)   + 4000 Series Integrated Services Routers (ISRs) (except 4321 ISRs)   + Catalyst 8000V Edge Software   + Catalyst 8200 Series Edge Platforms   + Catalyst 8300 Series Edge Platforms   + Cloud Services Router 1000V Series (CSR 1000V)   + Firepower Threat Defense (FTD) Software, if the SSL/TLS decryption option is enabled   + Integrated Services Virtual Router (ISRv)   + Web Security Appliance (WSA), both physical and virtual devices, deployed in transparent mode For information about which Cisco software releases were vulnerable at the time of publication, see the [Fixed Software](#fs) section of this advisory. See the Details section in the bug ID(s) at the top of this advisory for the most complete and current information. Additional Considerations for FTD For an FTD device to be vulnerable, at least one SSL decryption policy must be enabled. As a prerequisite, an SSL decryption policy must be associated with a running access control policy.  **Determine Whether an SSL Decryption Policy Is Enabled on Cisco FTD Software**  There are two methods for determining whether an SSL decryption policy is enabled:  *Option 1: Use the CLI*  Use the **show ssl-policy-config** CLI command to verify whether an SSL decryption policy is enabled on a device. The following example shows the output of the **show ssl-policy-config** command on a device that does *not* have an SSL policy configured and is *not* vulnerable:  ```   > show ssl-policy-configSSL policy not yet applied.   ```  Any other output returned by the **show ssl-policy-config** command indicates that an SSL policy is configured and the device is vulnerable.  For more information about the **show ssl-policy-config** command, see the [Cisco Firepower Threat Defense Command Reference](https://www.cisco.com/c/en/us/td/docs/security/firepower/command_ref/b_Command_Reference_for_Firepower_Threat_Defense/s_8.html#wp8230585640).  *Option 2: Use the GUI*  To determine whether an SSL decryption policy is enabled on a device, check the appropriate policy:    + For devices managed by [Firepower Management Center (FMC)](https://www.cisco.com/c/en/us/td/docs/security/firepower/660/configuration/guide/fpmc-config-guide-v66/getting_started_with_ssl_policies.html#ID-2253-00000021): **Policies > Access Control > SSL**   + For devices managed by [Firepower Device Manager (FDM)](https://www.cisco.com/c/en/us/td/docs/security/firepower/660/fdm/fptd-fdm-config-guide-660/fptd-fdm-ssl-decryption.html#task_A46EB67387764C209439122818AB7B43): **Policies > SSL Decryption**Additional Considerations for WSA For a WSA device to be vulnerable, the HTTPS Proxy feature must be enabled and at least one decryption policy must be configured. The HTTPS Proxy feature is disabled by default.  To determine whether the HTTPS Proxy feature is enabled for a WSA, administrators can log in to the web interface of the WSA and navigate to **Security Services > HTTPS Proxy**. The value in the **HTTPS Proxy** field indicates whether the feature is enabled or disabled. Products Confirmed Not Vulnerable Only products listed in the [Vulnerable Products](#vp) section of this advisory are known to be affected by this vulnerability.  The following products either already inspect the SNI header, do not perform SSL/TLS inspection, or do not use any web reputation or URL filtering feature to detect malicious web domains that could be used as recipients for data exfiltration. Therefore, Cisco has confirmed that these products are not affected by this vulnerability:    + 1000 Series ISRs   + 4321 ISRs   + Adaptive Security Appliance (ASA) Software   + Catalyst 8500 Series Edge Platforms   + Firepower Management Center (FMC) Software   + Meraki security appliances, all models   + Open source Snort 3   + Umbrella  Details  * Using SNIcat or a similar tool, a remote attacker could exploit this vulnerability by sending sensitive data to an arbitrary server, hiding it in the SNI header of the TLS client hello packet. This vulnerability does not provide a means for an attacker to obtain the data in the first place; the attacker must have already compromised a host in a protected network to use for collecting and exfiltrating the confidential information.  This advisory describes a filter bypass technique that could be used to circumvent protections that are based on web reputation filters, URL filtering, and threat detection. There is not a simple and deterministic way to identify every instance of data exfiltration because attackers may obfuscate the leaked data and use arbitrary, nonmalicious domains as recipients. However, Cisco is currently working to develop a solution that would extend the web reputation, URL filtering, or threat inspection features to the SNI header. This fix will mitigate this attack in cases where destination servers have a poor reputation or are already explicitly blocked by the administrators. This advisory will be updated once this solution becomes available.  In the meantime, to detect and mitigate any attack performed with the SNIcat tool, Cisco has released a Snort rule with the SID 58062. To ensure full protection, the action for the rule should be set to **Block**.  Workarounds  * For potential workarounds on a specific Cisco product, refer to the Description section in the bug ID(s) at the top of this advisory.  Fixed Software  * When [considering software upgrades](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes), customers are advised to regularly consult the advisories for Cisco products, which are available from the [Cisco Security Advisories page](https://www.cisco.com/go/psirt), to determine exposure and a complete upgrade solution.  In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. Fixed Releases For information about [fixed software releases](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes), see the Details section in the bug ID(s) at the top of this advisory.  Exploitation and Public Announcements  * The Cisco Product Security Incident Response Team (PSIRT) is aware that proof-of-concept exploit code is available for the vulnerability described in this advisory.  The Cisco PSIRT is not aware of any malicious use of the vulnerability that is described in this advisory.  Source  * Cisco would like to thank Morten Marstrander and Alvaro Gutierrez from mnemonic, along with Matteo Malvica, for discovering and reporting this vulnerability.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Action Links for This Advisory  * [Snort Rule 58062](https://www.snort.org)  Related to This Advisory    URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-sni-data-exfil-mFgzXqLN>  Revision History  * | Version | Description | Section | Status | Date |   | --- | --- | --- | --- | --- |   | 1.1 | Provided additional information about the vulnerability, affected products, and possible mitigations. | Multiple sections | Interim | 2021-SEP-27 |   | 1.0 | Initial public release. | - | Interim | 2021-AUG-18 |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME. CISCO EXPECTS TO UPDATE THIS DOCUMENT AS NEW INFORMATION BECOMES AVAILABLE.  A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Action Links for This Advisory  * [Snort Rule 58062](https://www.snort.org)  Related to This Advisory |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |

