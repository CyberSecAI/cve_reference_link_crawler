```
{
  "vulnerability": {
    "root_cause": "The `cgroup_attach_task_all()` function in the Linux kernel's cgroup subsystem was missing a `cpus_read_lock()` call before accessing per-CPU data. This omission could lead to a race condition and a deadlock with the `cpu_hotplug_lock`.",
    "weaknesses": [
      "Race condition",
      "Deadlock",
	  "Missing lock"
    ],
    "impact": "A deadlock could occur if `cpuset_attach()` is called from `cgroup_attach_task_all()` without the necessary `cpus_read_lock()`, leading to a system hang or denial of service. The `percpu_rwsem_assert_held(&cpu_hotplug_lock)` warning triggered by syzbot confirms the potential for this issue.",
    "attack_vectors": "The vulnerability can be triggered by attaching a task to a cgroup, which indirectly calls `cpuset_attach` via `cgroup_attach_task_all()`. An attacker would need to be able to create and manipulate cgroups and attach processes to them.",
    "required_capabilities": "An attacker would require the ability to create and manage cgroups and attach tasks to them. This typically requires some level of privilege on the system, though the exact privileges would depend on the system configuration."
  },
  "fixes": [
    {
      "commit_id": "43626dade36fa74d3329046f4ae2d7fdefe401c6",
      "description": "This commit adds the missing `cpus_read_lock()` before acquiring the `cgroup_threadgroup_rwsem` in `cgroup_attach_task_all()` and `cpus_read_unlock()` after releasing the `cgroup_threadgroup_rwsem`. This prevents the race condition and the deadlock. Also adds `<linux/cpu.h>` include",
	  "changes": [
        "Added `cpus_read_lock()` before `percpu_down_write(&cgroup_threadgroup_rwsem)`.",
		"Added `cpus_read_unlock()` after `percpu_up_write(&cgroup_threadgroup_rwsem)`. ",
		"Added `#include <linux/cpu.h>`"
      ]
    },
    {
      "commit_id": "5db17805b6ba4c34dab303f49aea3562fc25af75",
      "description": "Backport of commit 43626dade36fa74d3329046f4ae2d7fdefe401c6 to address the same issue.",
        "changes": [
        "Added `cpus_read_lock()` before `percpu_down_write(&cgroup_threadgroup_rwsem)`.",
		"Added `cpus_read_unlock()` after `percpu_up_write(&cgroup_threadgroup_rwsem)`."
      ]
    },
    {
        "commit_id": "9f267393b036f1470fb12fb892d59e7ff8aeb58d",
        "description": "Backport of commit 43626dade36fa74d3329046f4ae2d7fdefe401c6 to address the same issue.",
        "changes": [
        "Added `cpus_read_lock()` before `percpu_down_write(&cgroup_threadgroup_rwsem)`.",
		"Added `cpus_read_unlock()` after `percpu_up_write(&cgroup_threadgroup_rwsem)`."
      ]
    },
    {
       "commit_id": "99bc25748e394d17f9e8b10cc7f273b8e64c1c7e",
       "description": "Backport of commit 43626dade36fa74d3329046f4ae2d7fdefe401c6 to address the same issue.",
       "changes": [
        "Added `cpus_read_lock()` before `percpu_down_write(&cgroup_threadgroup_rwsem)`.",
		"Added `cpus_read_unlock()` after `percpu_up_write(&cgroup_threadgroup_rwsem)`."
      ]
    },
     {
       "commit_id": "07191f984842d50020789ff14c75da436a7f46a9",
       "description": "Backport of commit 43626dade36fa74d3329046f4ae2d7fdefe401c6 to address the same issue. Also adds `<linux/cpu.h>` include",
       "changes": [
        "Added `cpus_read_lock()` before `percpu_down_write(&cgroup_threadgroup_rwsem)`.",
		"Added `cpus_read_unlock()` after `percpu_up_write(&cgroup_threadgroup_rwsem)`. ",
        "Added `#include <linux/cpu.h>`"
      ]
    },
    {
       "commit_id": "321488cfac7d0eb6d97de467015ff754f85813ff",
       "description": "Backport of commit 43626dade36fa74d3329046f4ae2d7fdefe401c6 to address the same issue. Also adds `get_online_cpus()` and `put_online_cpus()`",
       "changes": [
		"Replaced `cpus_read_lock()` with `get_online_cpus()`",
        "Replaced `cpus_read_unlock()` with `put_online_cpus()`",
        "Added `#include <linux/cpu.h>`"
      ]
    }
  ]
}
```