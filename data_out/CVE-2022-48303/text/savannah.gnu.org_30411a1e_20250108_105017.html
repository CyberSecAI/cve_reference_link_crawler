

* [![Back to Savannah Homepage](/images/Savannah.theme/floating.png)](/)
* Not Logged in
* [Login](/account/login.php?uri=%2Fbugs%2F%3F62387 "Login page - you must have registered an account first")
* [New User](/account/register.php "Account registration form")
* This Page
* [Language](/i18n.php?lang_uri=%2Fbugs%2F%3F62387 "Choose website language")
* [Clean Reload](/bugs/index.php?reload=1&func=detailitem&item_id=62387 "Reload the page without risk of reposting data")
* Search
* Area to search in
  Groups
  People
  Support
  Bugs
  Tasks
  Patches
* Hosted Projects
* [Hosting requirements](/register/requirements.php)
* [Register New Project](/register/ "Register your project at Savannah")
* [Full List](/search/index.php?type_of_search=soft&words=%%% "Browse the full list of hosted projects")
* [Contributors Wanted](/people/ "Browse the list of request for contributions")
* [Statistics](/stats/ "Browse statistics about Savannah")
* Site Help
* [User Docs: FAQ](/maintenance/FrontPage/)
* [User Docs: In Depth Guide](/maintenance/back-page/ "In-depth Documentation dedicated to any users, including group admins")
* [Get Support](/support/?group=administration "Get help from the Admins of Savannah, when documentation is not enough")
* [Contact Savannah](/contact.php "Contact address of Savannah Admins")
* GNU Project
* [Help GNU](//www.gnu.org/help/help.html)
* [All GNU Packages](//www.gnu.org/software/software.html)
* [Dev Resources](//www.gnu.org/software/devel.html)
* [License List](//www.gnu.org/licenses/license-list.html)
* [GNU Mirrors](//www.gnu.org/prep/ftp.html)
* [![Support freedom](/images/Savannah.theme/thin-image.png)

  Help us protect your freedom and the rights of computer
  users everywhere by becoming a member of the FSF.

  **Join Now!**](//www.fsf.org/associate/support_freedom/join_fsf?referrer=2442)
* Free Software Foundation
* [Coming Events](//www.fsf.org/events/)
* [Free Software Directory](//www.fsf.org/directory/)
* [Cryptographic software legal notice](//savannah.gnu.org/maintenance/SavannahCryptographicRestrictions)
* [Copyright infringement notification](//www.fsf.org/about/dmca-notice)
* Related Forges
* [Savannah Non-GNU](//savannah.nongnu.org/)
* [Puszcza](//puszcza.gnu.org.ua/)

# bugGNU tar - Bugs: bug #62387, [SECURITY] Heap Buffer Overflow

 Group

* [Main](/projects/tar/ "Group main page at Savannah")
  + [Main](/projects/tar/)
  + [View members](/project/memberlist.php?group=tar)
  + [Search](/project/search.php?group=tar)
* [Homepage](http://www.gnu.org/software/tar "Browse group home page (outside of Savane)")
* [Download](/files/?group=tar "Visit download area: files released")
* [Support](/support/?group=tar "Tech Support Tracker: post, search and manage support requests")
  + [Submit new](/support/?group=tar&func=additem)
  + [Browse](/support/?group=tar)
  + [Reset to open](/support/?group=tar&func=browse&set=open)
  + [Digest](/support/?group=tar&func=digest)
  + [Dependencies](/support/dependencies.php?group=tar)
  + ~~Export~~
  + [Get statistics](/support/reporting.php?group=tar)
  + [Search](/support/?group=tar&func=search)
* [Mailing lists](/mail/?group=tar "List existing mailing lists")
* [Source code](/projects/tar/#devtools "Source code management")
  + [Use CVS](/cvs/?group=tar "CVS Repository")
  + [Browse Web Pages Repository](//web.cvs.savannah.gnu.org/viewvc/?root=tar)
  + [Use Git](/git/?group=tar "Git Repository")
  + [Browse Git repository](//git.savannah.gnu.org/cgit/tar.git)
* [Bugs](/bugs/?group=tar "Bug Tracker: report, search and track bugs")
  + [Submit new](/bugs/?group=tar&func=additem)
  + [Browse](/bugs/?group=tar)
  + [Reset to open](/bugs/?group=tar&func=browse&set=open)
  + [Digest](/bugs/?group=tar&func=digest)
  + [Dependencies](/bugs/dependencies.php?group=tar)
  + ~~Export~~
  + [Get statistics](/bugs/reporting.php?group=tar)
  + [Search](/bugs/?group=tar&func=search)
* [Tasks](/task/?group=tar "Task Manager: post, search and manage tasks")
  + ~~Submit new~~
  + [Browse](/task/?group=tar)
  + [Reset to open](/task/?group=tar&func=browse&set=open)
  + [Digest](/task/?group=tar&func=digest)
  + [Dependencies](/task/dependencies.php?group=tar)
  + ~~Export~~
  + [Get statistics](/task/reporting.php?group=tar)
  + [Search](/task/?group=tar&func=search)
* [Patches](/patch/?group=tar "Patch Manager: post, search and manage patches")
  + ~~Submit new~~
  + [Browse](/patch/?group=tar)
  + [Reset to open](/patch/?group=tar&func=browse&set=open)
  + [Digest](/patch/?group=tar&func=digest)
  + [Dependencies](/patch/dependencies.php?group=tar)
  + ~~Export~~
  + [Get statistics](/patch/reporting.php?group=tar)
  + [Search](/patch/?group=tar&func=search)
* [News](/news/?group=tar "Read latest News, post News")
  + [Browse](/news/?group=tar)
  + [Atom feed](/news/atom.php?group=tar)
  + ~~Submit~~
  + ~~Manage~~

# *[bug #62387](?62387)*: [SECURITY] Heap Buffer Overflow

| Submitter: | [Carlos Andres Ramirez <carlos\_ramirez>](/users/carlos_ramirez) |  | |
| --- | --- | --- | --- |
| Submitted: | Sat 30 Apr 2022 08:58:25 AM UTC |  | |
|  |  |  | |
|  | | | |
| Category: | None | Severity: | 3 - Normal |
| Item Group: | None | Status: | Fixed |
| Privacy: | Public | Assigned to: | gray |
| Open/Closed: | Closed |

Discussion locked!

## [Discussion](#discussion)

|
|  |
|  | [Spam posted by \_341921](/bugs/index.php?func=viewspam&item_id=62387&comment_internal_id=434210#spam434210 "Current spam score: 6") |
| [Sat 11 Feb 2023 10:07:43 AM UTC, comment #2:](#comment2)   Fixed in commit 3da78400eafcccb97e2f2fd4b227ea40d794ede8 | [Sergey Poznyakoff <gray>](/users/gray) Group administrator |
| [Wed 11 Jan 2023 09:01:16 AM UTC, comment #1:](#comment1)   I created a *[patch #10307](/patch/?10307)* fixing this issue. | [Matej Mužila <mmuzila>](/users/mmuzila) |
| [Sat 30 Apr 2022 08:58:25 AM UTC, **original submission:**](#comment0)   A Heap Buffer Overflow exists in GNU Tar 1.34. The issue takes place at from\_header() in list.c in the tar application. The issue occurs when attempting to read files with old V7 tar format with an especially crafted checksum.   As a result, an invalid memory read that leads to a conditional jump or move operation on uninitialised memory values takes place. Exploitation of this issue leads to code execution or DOS attacks and could potentially result in other memory-related issues.   Attached to this report is a PoC malcrafted file "vuln.tar"  VALGRIND OUTPUT:  ...  ==17455== Command: tar -xf vuln.tar -O  ==17455==  ==17455== Conditional jump or move depends on uninitialised value(s)  ==17455==    at 0x1293AC: ??? (in /usr/bin/tar)  ==17455==    by 0x12A010: ??? (in /usr/bin/tar)  ==17455==    by 0x12B398: ??? (in /usr/bin/tar)  ==17455==    by 0x112ECA: ??? (in /usr/bin/tar)  ==17455==    by 0x48CB7FC: (below main) (libc-start.c:332)  ==17455==  ==17455== Invalid read of size 1  ==17455==    at 0x1293B2: ??? (in /usr/bin/tar)  ==17455==    by 0x12A010: ??? (in /usr/bin/tar)  ==17455==    by 0x12B398: ??? (in /usr/bin/tar)  ==17455==    by 0x112ECA: ??? (in /usr/bin/tar)  ==17455==    by 0x48CB7FC: (below main) (libc-start.c:332)  ==17455==  Address 0x4b4cf30 is 0 bytes after a block of size 14,336 alloc'd  ==17455==    at 0x483F7B5: malloc (vg\_replace\_malloc.c:381)   NOTE: Compilation with ASAN confirms the vulnerability.   I will update the ticket if I can manage to find out more.  ---  Carlos Andres Ramirez - Security Engineer <carlos\_ramirez>  <https://carlos.engineer> | [Carlos Andres Ramirez <carlos\_ramirez>](/users/carlos_ramirez) |

## [Attached Files](#attached)

(Note: upload size limit is set to 16384 kB, after insertion of
the required escape characters.)

Attached Files
[file #53164:  tar-1.34\_ASAN.png](https://file.savannah.gnu.org/file/tar-1.34_ASAN.png?file_id=53164) added by [carlos\_ramirez](/users/carlos_ramirez) (274KiB - image/png)
[file #53162:  vuln.tar](https://file.savannah.gnu.org/file/vuln.tar?file_id=53162) added by [carlos\_ramirez](/users/carlos_ramirez) (512B - application/x-tar)
[file #53163:  tar-1.34\_valgrind.png](https://file.savannah.gnu.org/file/tar-1.34_valgrind.png?file_id=53163) added by [carlos\_ramirez](/users/carlos_ramirez) (242KiB - image/png)

## [Dependencies](#dependencies)

Depends on the following items: None found

Items that depend on this one: None found

## [Mail Notification Carbon-Copy List](#cc)

Carbon-Copy List- -email is unavailable- added by [\_341921](/users/_341921) (Posted a comment)- -email is unavailable- added by [mmuzila](/users/mmuzila) (Posted a comment)- -email is unavailable- added by [gray](/users/gray) (Updated the item)- -email is unavailable- added by [carlos\_ramirez](/users/carlos_ramirez) (Submitted the item)
## [Votes](#votes)

There are 0 votes so far. Votes easily highlight which items people would like to see resolved
in priority, independently of the priority of the item set by tracker
managers.

## [History](#history)

Follow 8 latest changes.

| Date | Changed by | Updated Field | Previous Value | => | Replaced by |
| --- | --- | --- | --- | --- | --- |
| 2023-03-28 | [gray](/users/gray) | Discussion Lock | None |  | Locked |
| 2023-02-11 | [gray](/users/gray) | Status | None |  | Fixed |
|  |  | Assigned to | None |  | gray |
|  |  | Open/Closed | Open |  | Closed |
| 2022-10-22 | [gray](/users/gray) | Privacy | Private |  | Public |
| 2022-04-30 | [carlos\_ramirez](/users/carlos_ramirez) | Attached File | - |  | Added tar-1.34\_valgrind.png, #53163 |
|  |  | Attached File | - |  | Added tar-1.34\_ASAN.png, #53164 |
| 2022-04-30 | [carlos\_ramirez](/users/carlos_ramirez) | Attached File | - |  | Added vuln.tar, #53162 |

[![Back to the top](/images/Savannah.theme/arrows/top.orig.png)](#top)

Copyright © 2024 Free Software Foundation, Inc.

Verbatim copying and distribution of this entire article
is permitted in any medium, provided this notice is preserved.

The [Levitating,
Meditating, Flute-playing Gnu](//www.gnu.org/graphics/meditate.html) logo is a GNU GPL'ed image provided
by the Nevrax Design Team.

[Page source code](//git.savannah.nongnu.org/cgit/administration/savane.git/plain//frontend/php/bugs/index.php?id=60bab5f4bb97079a4f50fd30c5633b2562628477)

Powered by Savane 3.14-60ba.
[Corresponding source code](https://savannah.gnu.org/source/savane-60bab5f4bb97079a4f50fd30c5633b2562628477.tar.gz)

