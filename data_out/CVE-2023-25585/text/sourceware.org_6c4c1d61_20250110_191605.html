

Sourceware Bugzilla – Bug 29892
Field `file\_table` of `struct module \*module` is uninitialized
Last modified: 2022-12-12 09:07:53 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=29892&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=29892&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 29892**](show_bug.cgi?id=29892)
- Field `file\_table` of `struct module \*module` is uninitialized

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Field `file\_table` of `struct module \*module` is uninitialized

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | binutils | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=binutils "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | binutils ([show other bugs](buglist.cgi?component=binutils&product=binutils&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 2.40 | |  | | | [Importance](page.cgi?id=fields.html#importance): | P2 normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | 2.40 | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Alan Modra | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2022-12-12 03:45 UTC by 2019 | | --- | --- | | Modified: | 2022-12-12 09:07 UTC ([History](show_activity.cgi?id=29892)) | | CC List: | 0 users | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Host:](page.cgi?id=fields.html#cf_gcchost "A custom Free Text field in this installation of Bugzilla.") |  | | [Target:](page.cgi?id=fields.html#cf_gcctarget "A custom Free Text field in this installation of Bugzilla.") |  | | [Build:](page.cgi?id=fields.html#cf_gccbuild "A custom Free Text field in this installation of Bugzilla.") |  | | [Last reconfirmed:](page.cgi?id=fields.html#cf_reconfirmed_on "A custom Date/Time field in this installation of Bugzilla.") | 2022-12-12 00:00:00 | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**PoC**](attachment.cgi?id=14513 "View the content of the attachment") (2.88 KB, application/octet-stream)  [2022-12-12 03:45 UTC](#attach_14513 "Go to the comment associated with the attachment"), 2019 | [Details](attachment.cgi?id=14513&action=edit) | | [View All](attachment.cgi?bugid=29892&action=viewall)  [Add an attachment](attachment.cgi?bugid=29892&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=29892&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=29892#c0)  2019    2022-12-12 03:45:12 UTC  ``` Created [attachment 14513](attachment.cgi?id=14513 "PoC") [[details]](attachment.cgi?id=14513&action=edit "PoC") PoC  # Reproduce  ```bash cd binutils-gdb git reset --hard f2f58a399cf3f946983398cdfe52d0eaa72bf877 mkdir build && cd build ../configure --disable-gdb --disable-gdbserver --disable-gdbsupport --disable-libdecnumber --disable-readline --disable-sim --disable-libbacktrace --disable-gas --disable-ld --disable-werror --enable-targets=all CPPFLAGS=-DDEBUG CFLAGS="-g -O0 -fsanitize=address" make all-binutils MAKEINFO=true && true binutils/addr2line -e poc.bin 0 ```  # Output  ``` /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 52 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 192 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 66 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 95 /binutils-gdb/build/binutils/addr2line: unknown source command 99 /binutils-gdb/build/binutils/addr2line: unknown source command 116 /binutils-gdb/build/binutils/addr2line: unknown source command 105 /binutils-gdb/build/binutils/addr2line: unknown source command 103 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 95 /binutils-gdb/build/binutils/addr2line: unknown source command 84 /binutils-gdb/build/binutils/addr2line: unknown source command 88 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 148 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 161 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 95 /binutils-gdb/build/binutils/addr2line: unknown source command 98 /binutils-gdb/build/binutils/addr2line: unknown source command 99 /binutils-gdb/build/binutils/addr2line: unknown source command 109 /binutils-gdb/build/binutils/addr2line: unknown source command 116 /binutils-gdb/build/binutils/addr2line: unknown source command 110 /binutils-gdb/build/binutils/addr2line: unknown source command 109 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 95 /binutils-gdb/build/binutils/addr2line: unknown source command 69 /binutils-gdb/build/binutils/addr2line: unknown source command 84 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 228 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 18 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 164 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 95 /binutils-gdb/build/binutils/addr2line: unknown source command 98 /binutils-gdb/build/binutils/addr2line: unknown source command 99 /binutils-gdb/build/binutils/addr2line: unknown source command 99 /binutils-gdb/build/binutils/addr2line: unknown source command 97 /binutils-gdb/build/binutils/addr2line: unknown source command 115 /binutils-gdb/build/binutils/addr2line: unknown source command 97 /binutils-gdb/build/binutils/addr2line: unknown source command 101 /binutils-gdb/build/binutils/addr2line: unknown source command 95 /binutils-gdb/build/binutils/addr2line: unknown source command 69 /binutils-gdb/build/binutils/addr2line: unknown source command 84 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 /binutils-gdb/build/binutils/addr2line: unknown source command 0 AddressSanitizer:DEADLYSIGNAL ================================================================= ==172769==ERROR: AddressSanitizer: SEGV on unknown address (pc 0x7f7f32ca7066 bp 0x7ffe23f9a990 sp 0x7ffe23f9a0d8 T0) ==172769==The signal is caused by a READ memory access. ==172769==Hint: this fault was caused by a dereference of a high value address (see register values below).  Dissassemble the provided pc to learn which register was used.     #0 0x7f7f32ca7066 in __sanitizer::internal_strlen(char const*) ../../../../src/libsanitizer/sanitizer_common/sanitizer_libc.cpp:167     #1 0x7f7f32c382ed in printf_common ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors_format.inc:551     #2 0x7f7f32c386cc in __interceptor_vprintf ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:1660     #3 0x7f7f32c387c6 in __interceptor_printf ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:1718     #4 0x564e4c920af9 in translate_addresses ../../binutils/addr2line.c:392     #5 0x564e4c920fbc in process_file ../../binutils/addr2line.c:470     #6 0x564e4c9215b1 in main ../../binutils/addr2line.c:579     #7 0x7f7f329dbd8f in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58     #8 0x7f7f329dbe3f in __libc_start_main_impl ../csu/libc-start.c:392     #9 0x564e4c91f244 in _start (/binutils-gdb/build/binutils/addr2line+0x343244)  AddressSanitizer can not provide additional info. SUMMARY: AddressSanitizer: SEGV ../../../../src/libsanitizer/sanitizer_common/sanitizer_libc.cpp:167 in __sanitizer::internal_strlen(char const*) ==172769==ABORTING ```  # Analysis  The field `file_table` of `struct module *module` is created at [1] but without being initialized, and then its uninitialized field is used to assign `*file`[2], which is a pointer to a global variable `filename`[3]. Later on when this variable is used[4], the segmentation fault occurs.  [1] <https://github.com/bminor/binutils-gdb/blob/85f9067d3a47d51a46ba369c60fdec752da0f885/bfd/vms-alpha.c#L4340> [2] <https://github.com/bminor/binutils-gdb/blob/85f9067d3a47d51a46ba369c60fdec752da0f885/bfd/vms-alpha.c#L4926> [3] <https://github.com/bminor/binutils-gdb/blob/85f9067d3a47d51a46ba369c60fdec752da0f885/binutils/addr2line.c#L167> [4] <https://github.com/bminor/binutils-gdb/blob/85f9067d3a47d51a46ba369c60fdec752da0f885/binutils/addr2line.c#L392> ```  [Comment 1](show_bug.cgi?id=29892#c1)  Sourceware Commits    2022-12-12 08:59:50 UTC  ``` The master branch has been updated by Alan Modra <amodra@sourceware.org>:  <https://sourceware.org/git/gitweb.cgi?p=binutils-gdb.git;h=65cf035b8dc1df5d8020e0b1449514a3c42933e7>  commit 65cf035b8dc1df5d8020e0b1449514a3c42933e7 Author: Alan Modra <amodra@gmail.com> Date:   Mon Dec 12 19:01:08 2022 +1030      [PR29892](show_bug.cgi?id=29892 "RESOLVED FIXED - Field `file_table` of `struct module *module` is uninitialized"), Field file_table of struct module is uninitialized                  [PR 29892](show_bug.cgi?id=29892 "RESOLVED FIXED - Field `file_table` of `struct module *module` is uninitialized")             * vms-alphs.c (new_module): Use bfd_zmalloc to alloc file_table.             (parse_module): Rewrite file_table reallocation code and clear. ```  [Comment 2](show_bug.cgi?id=29892#c2)  Alan Modra    2022-12-12 09:07:53 UTC  ``` Fixed for 2.40 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=29892)
* - [XML](show_bug.cgi?ctype=xml&id=29892)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=29892)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=29892&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=29892&GoAheadAndLogIn=1#forgot)
    Login:

    [x]

