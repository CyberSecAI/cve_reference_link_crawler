```
{
  "vulnerability": {
    "root_cause": "The `nfs4_listxattr` function in the Linux kernel's NFSv4.2 implementation does not correctly handle the case where the combined size of the extended attributes exceeds the provided buffer size. When `listxattr()` is called with a `size` > 0,  `nfs4_listxattr` doesn't return an error if the combined size from `generic_listxattr()`, `nfs4_listxattr_nfs4_label()`, and `nfs4_listxattr_nfs4_user()` exceeds the provided `size`. This can lead to a situation where `nfs4_listxattr_nfs4_user` is called with a size of 0, triggering a kernel BUG in `mm/usercopy.c`.",
    "weaknesses": [
      "Incorrect size handling in `nfs4_listxattr`.",
      "Lack of proper error checking when the combined size of extended attributes exceeds the buffer size."
    ],
    "impact": "A kernel BUG is triggered, leading to a denial of service and a system crash.",
     "attack_vectors": [
      "Calling `listxattr()` with a size greater than zero on an NFSv4.2 mount where the combined size of extended attributes will exceed the buffer size"
    ],
    "required_capabilities": "A user with the ability to call `listxattr` on an NFSv4.2 mount that has the 'system.nfs4_acl' extended attribute."
  }
}
```