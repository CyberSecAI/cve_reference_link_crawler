- **Root cause of vulnerability**: The `touchlist_sync.cgi` script copies the `v7` parameter to the `v36` buffer without any filtering. The `IP` parameter passed via a GET request to `touchlist_sync.cgi` is used to populate the `v7` parameter, which is then copied into the `v36` buffer. This allows for command injection by passing shell metacharacters and commands within the IP parameter.
- **Weaknesses/vulnerabilities present**: Command Injection vulnerability exists due to lack of proper sanitization of the `IP` parameter before using it in a system command.
- **Impact of exploitation**: An attacker can execute arbitrary shell commands on the target system by injecting commands through the vulnerable parameter. This can potentially lead to complete compromise of the device and its network. As demonstrated in the PoC, the attacker is able to execute `ls` and redirect the output to a file in the device's filesystem.
- **Attack vectors**: The attack vector is via a crafted HTTP POST request to the `/cgi-bin/touchlist_sync.cgi` endpoint, by providing the malicious commands in the `IP` parameter within the query string.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the vulnerable device on the network. The attacker does not need prior authentication to exploit this vulnerability.