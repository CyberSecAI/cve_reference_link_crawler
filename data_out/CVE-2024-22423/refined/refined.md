```
{
  "CVE-2024-22423": {
    "related_content": [
      {
        "source": "github.com_26f94540_20250111_125135.html",
        "content_type": "commit",
        "details": {
          "root_cause": "Improper escaping of special characters in the shell escape function when using `--exec` with `%q` on Windows.",
          "weaknesses": [
            "Insufficient escaping of %, \\, and \\n characters in shell commands on Windows."
          ],
          "impact": "Remote code execution.",
          "attack_vectors": [
            "Maliciously crafted input within the output template expansion of the `--exec` command"
          ],
          "attacker_capabilities": "Attacker needs the ability to control the output template expansion within the yt-dlp --exec command."
        }
      },
       {
        "source": "github.com_efa6b6e7_20250111_125137.html",
        "content_type": "release_notes",
        "details": {
           "root_cause": "The shell escape function did not properly escape %, \\ and \\n, allowing for command injection.",
            "weaknesses": [
              "Improper escaping of special characters in the shell escape function when using `--exec` with `%q` on Windows."
            ],
            "impact": "Remote code execution via crafted input.",
            "attack_vectors": [
                "Using the `--exec` option with a `%q` template specifier on Windows and providing a malicious input."
            ],
           "attacker_capabilities": "Attacker needs the ability to control the output template expansion within the yt-dlp --exec command."
        }
      },
      {
        "source": "github.com_bea46589_20250111_125138.html",
        "content_type": "security_advisory",
        "details": {
            "root_cause": "The previous patch for CVE-2023-40581 was insufficient, allowing environment variable expansion through `%` characters in the output template when using `--exec` with `%q` on Windows.",
            "weaknesses": [
              "Insufficient escaping of `\"`, `%`, `|` and `&` characters when using `--exec` with `%q` on Windows.",
                "Failure to sanitize special characters that could be exploited for command injection.",
                "Inadequate quoting of arguments passed to shell commands."
            ],
            "impact": "Remote code execution by injecting shell commands.",
            "attack_vectors": [
                "Using a maliciously crafted string in a metadata field that is later passed to the shell via `--exec` and `%q`."
            ],
           "attacker_capabilities": "Attacker needs the ability to control the output template expansion within the yt-dlp --exec command. They can craft metadata fields, or trick the user to download a video with malicious metadata"
        }
      },
      {
        "source": "www.kb.cert.org_5478b803_20250111_125139.html",
        "content_type": "vulnerability_note",
         "details": {
           "root_cause": "Multiple programming languages and their command execution modules fail to properly escape arguments when invoking commands in a Microsoft Windows environment.",
          "weaknesses": [
            "Lack of proper command and argument validation mechanisms.",
              "Failure to correctly escape arguments, which could lead to command injection.",
              "Insufficient neutralization of arguments before execution.",
              "Vulnerable handling of command arguments within a Windows environment."
          ],
            "impact": "Arbitrary command execution.",
            "attack_vectors": [
                "An attacker with knowledge of a vulnerable programming language and its command execution method can craft malicious inputs which will be treated as commands."
            ],
            "attacker_capabilities": "Attacker needs to have knowledge of a vulnerable programming language and how it invokes shell commands. "
        }
     }
    ]
  },
    "CVE-2023-40581": {
    "related_content": [
    {
        "source": "github.com_b1003ced_20250111_125134.html",
        "content_type": "commit",
        "details": {
           "root_cause": "Improper escaping of double quotes in the shell escape function when using `--exec` with `%q` on Windows.",
          "weaknesses": [
            "Insufficient escaping of `\"` character in shell commands on Windows."
          ],
          "impact": "Remote code execution.",
          "attack_vectors": [
            "Maliciously crafted input within the output template expansion of the `--exec` command"
          ],
          "attacker_capabilities": "Attacker needs the ability to control the output template expansion within the yt-dlp --exec command."
        }
      },
      {
        "source": "github.com_052463e1_20250111_125137.html",
        "content_type": "security_advisory",
        "details": {
            "root_cause": "The escaping mechanism used for `cmd` on Windows did not properly escape special characters, allowing for remote code execution through the `--exec` flag with `%q`.",
            "weaknesses": [
              "Insufficient escaping of special characters, specifically `\"`, `|` and `&`.",
               "Vulnerable output template expansion in `--exec`.",
              "Inadequate quoting of arguments passed to shell commands."
            ],
           "impact": "Remote code execution by injecting shell commands.",
           "attack_vectors": [
              "A malicious crafted string in a metadata field that gets passed to the shell via `--exec` and `%q`."
            ],
            "attacker_capabilities": "Attacker needs the ability to control the output template expansion within the yt-dlp --exec command. They can craft metadata fields, or trick the user to download a video with malicious metadata"
        }
      }
        ]
  },
   "UNRELATED": [
    {
        "source": "github.com_720d3672_20250111_125136.html",
        "content_type": "release_notes"
    }
   ]
}
```