=== Content from github.com_26f94540_20250111_125135.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Fcommit%2Fff07792676f404ffff6ee61b5638c9dc1a33a37a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Fcommit%2Fff07792676f404ffff6ee61b5638c9dc1a33a37a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=yt-dlp%2Fyt-dlp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[yt-dlp](/yt-dlp)
/
**[yt-dlp](/yt-dlp/yt-dlp)**
Public

* [Notifications](/login?return_to=%2Fyt-dlp%2Fyt-dlp) You must be signed in to change notification settings
* [Fork
  7.5k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)
* [Star
   95.9k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)

* [Code](/yt-dlp/yt-dlp)
* [Issues
  1.5k](/yt-dlp/yt-dlp/issues)
* [Pull requests
  326](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects
  4](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

Additional navigation options

* [Code](/yt-dlp/yt-dlp)
* [Issues](/yt-dlp/yt-dlp/issues)
* [Pull requests](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

## Commit

[Permalink](/yt-dlp/yt-dlp/commit/ff07792676f404ffff6ee61b5638c9dc1a33a37a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[core] Prevent RCE when using `--exec` with `%q` ([CVE-2024-22423](https://github.com/advisories/GHSA-hjq6-52gw-2g7p "CVE-2024-22423"))

[Browse files](/yt-dlp/yt-dlp/tree/ff07792676f404ffff6ee61b5638c9dc1a33a37a)
Browse the repository at this point in the history

```
The shell escape function now properly escapes `%`, `\\` and `\n`. `utils.Popen` as well as `%q` output template expansion have been patched accordingly.

Prior to this fix using `--exec` together with `%q` when on Windows could cause remote code to execute. See [GHSA-hjq6-52gw-2g7p](https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-hjq6-52gw-2g7p "GHSA-hjq6-52gw-2g7p") for more details.

Authored by: Grub4K
```

* Loading branch information

[![@Grub4K](https://avatars.githubusercontent.com/u/37424085?s=40&v=4)](/Grub4K)

[Grub4K](/yt-dlp/yt-dlp/commits?author=Grub4K "View all commits by Grub4K")
committed
Apr 9, 2024

1 parent
[216f6a3](/yt-dlp/yt-dlp/commit/216f6a3cb57824e6a3c859649ce058c199b1b247)

commit ff07792

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**53 additions**
and
**23 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* devscripts

  + devscripts/changelog\_override.json
    [changelog\_override.json](#diff-323808d1d1a45be3d06ea051c76192878238cd5c25e74087fbdad00eab2c6a16)
* test

  + test/test\_utils.py
    [test\_utils.py](#diff-1780a2492dac55d0b4c5ff13cd3cf852a72cdac8995e17b10c87eeb678b3179e)
* yt\_dlp

  + yt\_dlp/YoutubeDL.py
    [YoutubeDL.py](#diff-d3ba8be45cae8dd7889a71c3360c9e4ac1160de8a5f3443b6e4a656395267f9b)
  + compat

    - yt\_dlp/compat/\_\_init\_\_.py
      [\_\_init\_\_.py](#diff-1853c8069ffee0155a7ecc579d8729512ec6c7d0a05f485f6a1f03d322d6a6df)
  + utils

    - yt\_dlp/utils/\_utils.py
      [\_utils.py](#diff-feda8f56946dc048e754111850baaef0eec4b9f8bbc2d3f04b1a785626ea5c0e)

## There are no files selected for viewing

5 changes: 5 additions & 0 deletions

5
[devscripts/changelog\_override.json](#diff-323808d1d1a45be3d06ea051c76192878238cd5c25e74087fbdad00eab2c6a16 "devscripts/changelog_override.json")

Show comments

[View file](/yt-dlp/yt-dlp/blob/ff07792676f404ffff6ee61b5638c9dc1a33a37a/devscripts/changelog_override.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -142,5 +142,10 @@ |
|  |  | "when": "e3a3ed8a981d9395c4859b6ef56cd02bc3148db2", |
|  |  | "short": "[cleanup:ie] No `from` stdlib imports in extractors", |
|  |  | "authors": ["pukkandan"] |
|  |  | }, |
|  |  | { |
|  |  | "action": "add", |
|  |  | "when": "9590cc6b4768e190183d7d071a6c78170889116a", |
|  |  | "short": "[priority] Security: [[CVE-2024-22423](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-22423)] [Prevent RCE when using `--exec` with `%q` on Windows](https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-hjq6-52gw-2g7p)\n - The shell escape function now properly escapes `%`, `\\` and `\\n`.\n - `utils.Popen` has been patched accordingly." |
|  |  | } |
|  |  | ] |

4 changes: 4 additions & 0 deletions

4
[test/test\_utils.py](#diff-1780a2492dac55d0b4c5ff13cd3cf852a72cdac8995e17b10c87eeb678b3179e "test/test_utils.py")

Show comments

[View file](/yt-dlp/yt-dlp/blob/ff07792676f404ffff6ee61b5638c9dc1a33a37a/test/test_utils.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2069,6 +2069,10 @@ def run\_shell(args): |
|  |  |  |
|  |  | # Test escaping |
|  |  | assert run\_shell(['echo', 'test"&']) == '"test""&"\n' |
|  |  | assert run\_shell(['echo', '%CMDCMDLINE:~-1%&']) == '"%CMDCMDLINE:~-1%&"\n' |
|  |  | assert run\_shell(['echo', 'a\nb']) == '"a"\n"b"\n' |
|  |  | assert run\_shell(['echo', '"']) == '""""\n' |
|  |  | assert run\_shell(['echo', '\\']) == '\\\n' |
|  |  | # Test if delayed expansion is disabled |
|  |  | assert run\_shell(['echo', '^!']) == '"^!"\n' |
|  |  | assert run\_shell('echo "^!"') == '"^!"\n' |
| Expand Down | |  |

8 changes: 4 additions & 4 deletions

8
[yt\_dlp/YoutubeDL.py](#diff-d3ba8be45cae8dd7889a71c3360c9e4ac1160de8a5f3443b6e4a656395267f9b "yt_dlp/YoutubeDL.py")

Show comments

[View file](/yt-dlp/yt-dlp/blob/ff07792676f404ffff6ee61b5638c9dc1a33a37a/yt_dlp/YoutubeDL.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,7 +25,7 @@ |
|  |  |  |
|  |  | from .cache import Cache |
|  |  | from .compat import functools, urllib # isort: split |
|  |  | from .compat import compat\_os\_name, compat\_shlex\_quote, urllib\_req\_to\_req |
|  |  | from .compat import compat\_os\_name, urllib\_req\_to\_req |
|  |  | from .cookies import LenientSimpleCookie, load\_cookies |
|  |  | from .downloader import FFmpegFD, get\_suitable\_downloader, shorten\_protocol\_name |
|  |  | from .downloader.rtmp import rtmpdump\_version |
| Expand Down  Expand Up | | @@ -102,7 +102,6 @@ |
|  |  | UserNotLive, |
|  |  | YoutubeDLError, |
|  |  | age\_restricted, |
|  |  | args\_to\_str, |
|  |  | bug\_reports\_message, |
|  |  | date\_from\_str, |
|  |  | deprecation\_warning, |
| Expand Down  Expand Up | | @@ -141,6 +140,7 @@ |
|  |  | sanitize\_filename, |
|  |  | sanitize\_path, |
|  |  | sanitize\_url, |
|  |  | shell\_quote, |
|  |  | str\_or\_none, |
|  |  | strftime\_or\_none, |
|  |  | subtitles\_filename, |
| Expand Down  Expand Up | | @@ -823,7 +823,7 @@ def warn\_if\_short\_id(self, argv): |
|  |  | self.report\_warning( |
|  |  | 'Long argument string detected. ' |
|  |  | 'Use -- to separate parameters and URLs, like this:\n%s' % |
|  |  | args\_to\_str(correct\_argv)) |
|  |  | shell\_quote(correct\_argv)) |
|  |  |  |
|  |  | def add\_info\_extractor(self, ie): |
|  |  | """Add an InfoExtractor object to the end of the list.""" |
| Expand Down  Expand Up | | @@ -1355,7 +1355,7 @@ def create\_key(outer\_mobj): |
|  |  | value, fmt = escapeHTML(str(value)), str\_fmt |
|  |  | elif fmt[-1] == 'q': # quoted |
|  |  | value = map(str, variadic(value) if '#' in flags else [value]) |
|  |  | value, fmt = ' '.join(map(compat\_shlex\_quote, value)), str\_fmt |
|  |  | value, fmt = shell\_quote(value, shell=True), str\_fmt |
|  |  | elif fmt[-1] == 'B': # bytes |
|  |  | value = f'%{str\_fmt}'.encode() % str(value).encode() |
|  |  | value, fmt = value.decode('utf-8', 'ignore'), 's' |
| Expand Down | |  |

9 changes: 3 additions & 6 deletions

9
[yt\_dlp/compat/\_\_init\_\_.py](#diff-1853c8069ffee0155a7ecc579d8729512ec6c7d0a05f485f6a1f03d322d6a6df "yt_dlp/compat/__init__.py")

Show comments

[View file](/yt-dlp/yt-dlp/blob/ff07792676f404ffff6ee61b5638c9dc1a33a37a/yt_dlp/compat/__init__.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -27,12 +27,9 @@ def compat\_etree\_fromstring(text): |
|  |  | compat\_os\_name = os.\_name if os.name == 'java' else os.name |
|  |  |  |
|  |  |  |
|  |  | if compat\_os\_name == 'nt': |
|  |  | def compat\_shlex\_quote(s): |
|  |  | import re |
|  |  | return s if re.match(r'^[-\_\w./]+$', s) else s.replace('"', '""').join('""') |
|  |  | else: |
|  |  | from shlex import quote as compat\_shlex\_quote # noqa: F401 |
|  |  | def compat\_shlex\_quote(s): |
|  |  | from ..utils import shell\_quote |
|  |  | return shell\_quote(s) |
|  |  |  |
|  |  |  |
|  |  | def compat\_ord(c): |
| Expand Down | |  |

50 changes: 37 additions & 13 deletions

50
[yt\_dlp/utils/\_utils.py](#diff-feda8f56946dc048e754111850baaef0eec4b9f8bbc2d3f04b1a785626ea5c0e "yt_dlp/utils/_utils.py")

Show comments

[View file](/yt-dlp/yt-dlp/blob/ff07792676f404ffff6ee61b5638c9dc1a33a37a/yt_dlp/utils/_utils.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -50,7 +50,6 @@ |
|  |  | compat\_expanduser, |
|  |  | compat\_HTMLParseError, |
|  |  | compat\_os\_name, |
|  |  | compat\_shlex\_quote, |
|  |  | ) |
|  |  | from ..dependencies import xattr |
|  |  |  |
| Expand Down  Expand Up | | @@ -836,9 +835,11 @@ def \_\_init\_\_(self, args, \*remaining, env=None, text=False, shell=False, \*\*kwargs |
|  |  |  |
|  |  | if shell and compat\_os\_name == 'nt' and kwargs.get('executable') is None: |
|  |  | if not isinstance(args, str): |
|  |  | args = ' '.join(compat\_shlex\_quote(a) for a in args) |
|  |  | args = shell\_quote(args, shell=True) |
|  |  | shell = False |
|  |  | args = f'{self.\_\_comspec()} /Q /S /D /V:OFF /C "{args}"' |
|  |  | # Set variable for `cmd.exe` newline escaping (see `utils.shell\_quote`) |
|  |  | env['='] = '"^\n\n"' |
|  |  | args = f'{self.\_\_comspec()} /Q /S /D /V:OFF /E:ON /C "{args}"' |
|  |  |  |
|  |  | super().\_\_init\_\_(args, \*remaining, env=env, shell=shell, \*\*kwargs, startupinfo=self.\_startupinfo) |
|  |  |  |
| Expand Down  Expand Up | | @@ -1637,15 +1638,38 @@ def get\_filesystem\_encoding(): |
|  |  | return encoding if encoding is not None else 'utf-8' |
|  |  |  |
|  |  |  |
|  |  | def shell\_quote(args): |
|  |  | quoted\_args = [] |
|  |  | encoding = get\_filesystem\_encoding() |
|  |  | for a in args: |
|  |  | if isinstance(a, bytes): |
|  |  | # We may get a filename encoded with 'encodeFilename' |
|  |  | a = a.decode(encoding) |
|  |  | quoted\_args.append(compat\_shlex\_quote(a)) |
|  |  | return ' '.join(quoted\_args) |
|  |  | \_WINDOWS\_QUOTE\_TRANS = str.maketrans({'"': '\\"', '\\': '\\\\'}) |
|  |  | \_CMD\_QUOTE\_TRANS = str.maketrans({ |
|  |  | # Keep quotes balanced by replacing them with `""` instead of `\\"` |
|  |  | '"': '""', |
|  |  | # Requires a variable `=` containing `"^\n\n"` (set in `utils.Popen`) |
|  |  | # `=` should be unique since variables containing `=` cannot be set using cmd |
|  |  | '\n': '%=%', |
|  |  | # While we are only required to escape backslashes immediately before quotes, |
|  |  | # we instead escape all of 'em anyways to be consistent |
|  |  | '\\': '\\\\', |
|  |  | # Use zero length variable replacement so `%` doesn't get expanded |
|  |  | # `cd` is always set as long as extensions are enabled (`/E:ON` in `utils.Popen`) |
|  |  | '%': '%%cd:~,%', |
|  |  | }) |
|  |  |  |
|  |  |  |
|  |  | def shell\_quote(args, \*, shell=False): |
|  |  | args = list(variadic(args)) |
|  |  | if any(isinstance(item, bytes) for item in args): |
|  |  | deprecation\_warning('Passing bytes to utils.shell\_quote is deprecated') |
|  |  | encoding = get\_filesystem\_encoding() |
|  |  | for index, item in enumerate(args): |
|  |  | if isinstance(item, bytes): |
|  |  | args[index] = item.decode(encoding) |
|  |  |  |
|  |  | if compat\_os\_name != 'nt': |
|  |  | return shlex.join(args) |
|  |  |  |
|  |  | trans = \_CMD\_QUOTE\_TRANS if shell else \_WINDOWS\_QUOTE\_TRANS |
|  |  | return ' '.join( |
|  |  | s if re.fullmatch(r'[\w#$\*\-+./:?@\\]+', s, re.ASCII) else s.translate(trans).join('""') |
|  |  | for s in args) |
|  |  |  |
|  |  |  |
|  |  | def smuggle\_url(url, data): |
| Expand Down  Expand Up | | @@ -2849,7 +2873,7 @@ def ytdl\_is\_updateable(): |
|  |  |  |
|  |  | def args\_to\_str(args): |
|  |  | # Get a short string representation for a subprocess command |
|  |  | return ' '.join(compat\_shlex\_quote(a) for a in args) |
|  |  | return shell\_quote(args) |
|  |  |  |
|  |  |  |
|  |  | def error\_to\_str(err): |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ff07792`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Fcommit%2Fff07792676f404ffff6ee61b5638c9dc1a33a37a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b1003ced_20250111_125134.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Fcommit%2Fde015e930747165dbb8fcd360f8775fd973b7d6e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Fcommit%2Fde015e930747165dbb8fcd360f8775fd973b7d6e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=yt-dlp%2Fyt-dlp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[yt-dlp](/yt-dlp)
/
**[yt-dlp](/yt-dlp/yt-dlp)**
Public

* [Notifications](/login?return_to=%2Fyt-dlp%2Fyt-dlp) You must be signed in to change notification settings
* [Fork
  7.5k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)
* [Star
   95.9k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)

* [Code](/yt-dlp/yt-dlp)
* [Issues
  1.5k](/yt-dlp/yt-dlp/issues)
* [Pull requests
  326](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects
  4](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

Additional navigation options

* [Code](/yt-dlp/yt-dlp)
* [Issues](/yt-dlp/yt-dlp/issues)
* [Pull requests](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

## Commit

[Permalink](/yt-dlp/yt-dlp/commit/de015e930747165dbb8fcd360f8775fd973b7d6e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[core] Prevent RCE when using `--exec` with `%q` ([CVE-2023-40581](https://github.com/advisories/GHSA-42h4-v29r-42qg "CVE-2023-40581"))

[Browse files](/yt-dlp/yt-dlp/tree/de015e930747165dbb8fcd360f8775fd973b7d6e)
Browse the repository at this point in the history

```
The shell escape function is now using `""` instead of `\"`. `utils.Popen` has been patched to properly quote commands.

Prior to this fix using `--exec` together with `%q` when on Windows could cause remote code to execute. See [GHSA-42h4-v29r-42qg](https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-42h4-v29r-42qg "GHSA-42h4-v29r-42qg") for reference.

Authored by: Grub4K
```

* Loading branch information

[![@Grub4K](https://avatars.githubusercontent.com/u/37424085?s=40&v=4)](/Grub4K)

[Grub4K](/yt-dlp/yt-dlp/commits?author=Grub4K "View all commits by Grub4K")
committed
Sep 24, 2023

1 parent
[61bdf15](/yt-dlp/yt-dlp/commit/61bdf15fc7400601c3da1aa7a43917310a5bf391)

commit de015e9

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**46 additions**
and
**13 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* devscripts

  + devscripts/changelog\_override.json
    [changelog\_override.json](#diff-323808d1d1a45be3d06ea051c76192878238cd5c25e74087fbdad00eab2c6a16)
* test

  + test/test\_YoutubeDL.py
    [test\_YoutubeDL.py](#diff-f1abc5b91afa326c01cbc20d98d5fe6e2fb38ea0e03bcc31d7f1a5b5ee23e0ea)
  + test/test\_utils.py
    [test\_utils.py](#diff-1780a2492dac55d0b4c5ff13cd3cf852a72cdac8995e17b10c87eeb678b3179e)
* yt\_dlp

  + compat

    - yt\_dlp/compat/\_\_init\_\_.py
      [\_\_init\_\_.py](#diff-1853c8069ffee0155a7ecc579d8729512ec6c7d0a05f485f6a1f03d322d6a6df)
  + postprocessor

    - yt\_dlp/postprocessor/exec.py
      [exec.py](#diff-6af56f42c8848bc40997439912a1fa88494b11cc7ced4407fccee134138ec777)
  + utils

    - yt\_dlp/utils/\_utils.py
      [\_utils.py](#diff-feda8f56946dc048e754111850baaef0eec4b9f8bbc2d3f04b1a785626ea5c0e)

## There are no files selected for viewing

5 changes: 5 additions & 0 deletions

5
[devscripts/changelog\_override.json](#diff-323808d1d1a45be3d06ea051c76192878238cd5c25e74087fbdad00eab2c6a16 "devscripts/changelog_override.json")

Show comments

[View file](/yt-dlp/yt-dlp/blob/de015e930747165dbb8fcd360f8775fd973b7d6e/devscripts/changelog_override.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -93,5 +93,10 @@ |
|  |  | "action": "add", |
|  |  | "when": "c1d71d0d9f41db5e4306c86af232f5f6220a130b", |
|  |  | "short": "[priority] \*\*The minimum \*recommended\* Python version has been raised to 3.8\*\*\nSince Python 3.7 has reached end-of-life, support for it will be dropped soon. [Read more](https://github.com/yt-dlp/yt-dlp/issues/7803)" |
|  |  | }, |
|  |  | { |
|  |  | "action": "add", |
|  |  | "when": "61bdf15fc7400601c3da1aa7a43917310a5bf391", |
|  |  | "short": "[priority] Security: [[CVE-2023-40581](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-40581)] [Prevent RCE when using `--exec` with `%q` on Windows](https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-42h4-v29r-42qg)\n - The shell escape function is now using `\"\"` instead of `\\\"`.\n - `utils.Popen` has been patched to properly quote commands." |
|  |  | } |
|  |  | ] |

6 changes: 3 additions & 3 deletions

6
[test/test\_YoutubeDL.py](#diff-f1abc5b91afa326c01cbc20d98d5fe6e2fb38ea0e03bcc31d7f1a5b5ee23e0ea "test/test_YoutubeDL.py")

Show comments

[View file](/yt-dlp/yt-dlp/blob/de015e930747165dbb8fcd360f8775fd973b7d6e/test/test_YoutubeDL.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -784,9 +784,9 @@ def expect\_same\_infodict(out): |
|  |  | test('%(title4)#S', 'foo\_bar\_test') |
|  |  | test('%(title4).10S', ('foo ＂bar＂ ', 'foo ＂bar＂' + ('#' if compat\_os\_name == 'nt' else ' '))) |
|  |  | if compat\_os\_name == 'nt': |
|  |  | test('%(title4)q', ('"foo \\"bar\\" test"', "＂foo ⧹＂bar⧹＂ test＂")) |
|  |  | test('%(formats.:.id)#q', ('"id 1" "id 2" "id 3"', '＂id 1＂ ＂id 2＂ ＂id 3＂')) |
|  |  | test('%(formats.0.id)#q', ('"id 1"', '＂id 1＂')) |
|  |  | test('%(title4)q', ('"foo ""bar"" test"', None)) |
|  |  | test('%(formats.:.id)#q', ('"id 1" "id 2" "id 3"', None)) |
|  |  | test('%(formats.0.id)#q', ('"id 1"', None)) |
|  |  | else: |
|  |  | test('%(title4)q', ('\'foo "bar" test\'', '\'foo ＂bar＂ test\'')) |
|  |  | test('%(formats.:.id)#q', "'id 1' 'id 2' 'id 3'") |
| Expand Down | |  |

16 changes: 16 additions & 0 deletions

16
[test/test\_utils.py](#diff-1780a2492dac55d0b4c5ff13cd3cf852a72cdac8995e17b10c87eeb678b3179e "test/test_utils.py")

Show comments

[View file](/yt-dlp/yt-dlp/blob/de015e930747165dbb8fcd360f8775fd973b7d6e/test/test_utils.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -14,6 +14,7 @@ |
|  |  | import io |
|  |  | import itertools |
|  |  | import json |
|  |  | import subprocess |
|  |  | import xml.etree.ElementTree |
|  |  |  |
|  |  | from yt\_dlp.compat import ( |
| Expand All | | @@ -28,6 +29,7 @@ |
|  |  | InAdvancePagedList, |
|  |  | LazyList, |
|  |  | OnDemandPagedList, |
|  |  | Popen, |
|  |  | age\_restricted, |
|  |  | args\_to\_str, |
|  |  | base\_url, |
| Expand Down  Expand Up | | @@ -2388,6 +2390,20 @@ def test\_extract\_basic\_auth(self): |
|  |  | assert extract\_basic\_auth('http://user:@foo.bar') == ('http://foo.bar', 'Basic dXNlcjo=') |
|  |  | assert extract\_basic\_auth('http://user:pass@foo.bar') == ('http://foo.bar', 'Basic dXNlcjpwYXNz') |
|  |  |  |
|  |  | @unittest.skipUnless(compat\_os\_name == 'nt', 'Only relevant on Windows') |
|  |  | def test\_Popen\_windows\_escaping(self): |
|  |  | def run\_shell(args): |
|  |  | stdout, stderr, error = Popen.run( |
|  |  | args, text=True, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE) |
|  |  | assert not stderr |
|  |  | assert not error |
|  |  | return stdout |
|  |  |  |
|  |  | # Test escaping |
|  |  | assert run\_shell(['echo', 'test"&']) == '"test""&"\n' |
|  |  | # Test if delayed expansion is disabled |
|  |  | assert run\_shell(['echo', '^!']) == '"^!"\n' |
|  |  | assert run\_shell('echo "^!"') == '"^!"\n' |
|  |  |  |
|  |  | if \_\_name\_\_ == '\_\_main\_\_': |
|  |  | unittest.main() |

2 changes: 1 addition & 1 deletion

2
[yt\_dlp/compat/\_\_init\_\_.py](#diff-1853c8069ffee0155a7ecc579d8729512ec6c7d0a05f485f6a1f03d322d6a6df "yt_dlp/compat/__init__.py")

Show comments

[View file](/yt-dlp/yt-dlp/blob/de015e930747165dbb8fcd360f8775fd973b7d6e/yt_dlp/compat/__init__.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,7 +30,7 @@ def compat\_etree\_fromstring(text): |
|  |  | if compat\_os\_name == 'nt': |
|  |  | def compat\_shlex\_quote(s): |
|  |  | import re |
|  |  | return s if re.match(r'^[-\_\w./]+$', s) else '"%s"' % s.replace('"', '\\"') |
|  |  | return s if re.match(r'^[-\_\w./]+$', s) else s.replace('"', '""').join('""') |
|  |  | else: |
|  |  | from shlex import quote as compat\_shlex\_quote # noqa: F401 |
|  |  |  |
| Expand Down | |  |

12 changes: 5 additions & 7 deletions

12
[yt\_dlp/postprocessor/exec.py](#diff-6af56f42c8848bc40997439912a1fa88494b11cc7ced4407fccee134138ec777 "yt_dlp/postprocessor/exec.py")

Show comments

[View file](/yt-dlp/yt-dlp/blob/de015e930747165dbb8fcd360f8775fd973b7d6e/yt_dlp/postprocessor/exec.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,8 +1,6 @@ |
|  |  | import subprocess |
|  |  |  |
|  |  | from .common import PostProcessor |
|  |  | from ..compat import compat\_shlex\_quote |
|  |  | from ..utils import PostProcessingError, encodeArgument, variadic |
|  |  | from ..utils import Popen, PostProcessingError, variadic |
|  |  |  |
|  |  |  |
|  |  | class ExecPP(PostProcessor): |
| Expand All | | @@ -27,10 +25,10 @@ def parse\_cmd(self, cmd, info): |
|  |  | def run(self, info): |
|  |  | for tmpl in self.exec\_cmd: |
|  |  | cmd = self.parse\_cmd(tmpl, info) |
|  |  | self.to\_screen('Executing command: %s' % cmd) |
|  |  | retCode = subprocess.call(encodeArgument(cmd), shell=True) |
|  |  | if retCode != 0: |
|  |  | raise PostProcessingError('Command returned error code %d' % retCode) |
|  |  | self.to\_screen(f'Executing command: {cmd}') |
|  |  | \_, \_, return\_code = Popen.run(cmd, shell=True) |
|  |  | if return\_code != 0: |
|  |  | raise PostProcessingError(f'Command returned error code {return\_code}') |
|  |  | return [], info |
|  |  |  |
|  |  |  |
| Expand Down | |  |

18 changes: 16 additions & 2 deletions

18
[yt\_dlp/utils/\_utils.py](#diff-feda8f56946dc048e754111850baaef0eec4b9f8bbc2d3f04b1a785626ea5c0e "yt_dlp/utils/_utils.py")

Show comments

[View file](/yt-dlp/yt-dlp/blob/de015e930747165dbb8fcd360f8775fd973b7d6e/yt_dlp/utils/_utils.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -825,7 +825,7 @@ def \_fix(key): |
|  |  | \_fix('LD\_LIBRARY\_PATH') # Linux |
|  |  | \_fix('DYLD\_LIBRARY\_PATH') # macOS |
|  |  |  |
|  |  | def \_\_init\_\_(self, \*args, env=None, text=False, \*\*kwargs): |
|  |  | def \_\_init\_\_(self, args, \*remaining, env=None, text=False, shell=False, \*\*kwargs): |
|  |  | if env is None: |
|  |  | env = os.environ.copy() |
|  |  | self.\_fix\_pyinstaller\_ld\_path(env) |
| Expand All | | @@ -835,7 +835,21 @@ def \_\_init\_\_(self, \*args, env=None, text=False, \*\*kwargs): |
|  |  | kwargs['universal\_newlines'] = True # For 3.6 compatibility |
|  |  | kwargs.setdefault('encoding', 'utf-8') |
|  |  | kwargs.setdefault('errors', 'replace') |
|  |  | super().\_\_init\_\_(\*args, env=env, \*\*kwargs, startupinfo=self.\_startupinfo) |
|  |  |  |
|  |  | if shell and compat\_os\_name == 'nt' and kwargs.get('executable') is None: |
|  |  | if not isinstance(args, str): |
|  |  | args = ' '.join(compat\_shlex\_quote(a) for a in args) |
|  |  | shell = False |
|  |  | args = f'{self.\_\_comspec()} /Q /S /D /V:OFF /C "{args}"' |
|  |  |  |
|  |  | super().\_\_init\_\_(args, \*remaining, env=env, shell=shell, \*\*kwargs, startupinfo=self.\_startupinfo) |
|  |  |  |
|  |  | def \_\_comspec(self): |
|  |  | comspec = os.environ.get('ComSpec') or os.path.join( |
|  |  | os.environ.get('SystemRoot', ''), 'System32', 'cmd.exe') |
|  |  | if os.path.isabs(comspec): |
|  |  | return comspec |
|  |  | raise FileNotFoundError('shell not found: neither %ComSpec% nor %SystemRoot% is set') |
|  |  |  |
|  |  | def communicate\_or\_kill(self, \*args, \*\*kwargs): |
|  |  | try: |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `de015e9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Fcommit%2Fde015e930747165dbb8fcd360f8775fd973b7d6e) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_720d3672_20250111_125136.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Freleases%2Ftag%2F2021.04.11)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Freleases%2Ftag%2F2021.04.11)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=yt-dlp%2Fyt-dlp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[yt-dlp](/yt-dlp)
/
**[yt-dlp](/yt-dlp/yt-dlp)**
Public

* [Notifications](/login?return_to=%2Fyt-dlp%2Fyt-dlp) You must be signed in to change notification settings
* [Fork
  7.5k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)
* [Star
   95.9k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)

* [Code](/yt-dlp/yt-dlp/tree/2021.04.11)
* [Issues
  1.5k](/yt-dlp/yt-dlp/issues)
* [Pull requests
  326](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects
  4](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

Additional navigation options

* [Code](/yt-dlp/yt-dlp/tree/2021.04.11)
* [Issues](/yt-dlp/yt-dlp/issues)
* [Pull requests](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

1. [Releases](/yt-dlp/yt-dlp/releases)
2. [2021.04.11](/yt-dlp/yt-dlp/releases/tag/2021.04.11)

# yt-dlp 2021.04.11

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/yt-dlp/yt-dlp/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2021.04.11)

 Loading

[View all tags](/yt-dlp/yt-dlp/tags)

![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)
[github-actions](/apps/github-actions)
released this
11 Apr 21:52

[2021.04.11](/yt-dlp/yt-dlp/tree/2021.04.11)

[`a0f30f1`](/yt-dlp/yt-dlp/commit/a0f30f194ad6b8e6c56a37df9469ca51f3812692)

This commit was signed with the committer’s **verified signature**.

[![](https://avatars.githubusercontent.com/u/6623388?s=64&v=4)](/pukkandan)
[pukkandan](/pukkandan)

GPG key ID: 0F00D95A001F4698

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

Changelog:

* Add option `--convert-thumbnails` (only jpg currently supported)
* Format selector `mergeall` to download and merge all formats
* Pass any field to `--exec` using similar syntax to output template
* Choose downloader for each protocol using `--downloader PROTO:NAME`
  + Alias `--downloader` for `--external-downloader`
  + Added `native` as an option for the downloader
* Merge youtube-dl: Upto [commit/4fb25ff](https://github.com/ytdl-org/youtube-dl/commit/4fb25ff5a3be5206bb72e5c4046715b1529fb2c7) (except vimeo)
* [DiscoveryPlusIndia] Add DiscoveryPlusIndiaShowIE by [Ashish0804](https://github.com/Ashish0804)
* [NFHSNetwork] Add extractor by [llacb47](https://github.com/llacb47)
* [nebula] Add extractor (watchnebula.com) by [hheimbuerger](https://github.com/hheimbuerger)
* [nitter] Fix extraction of reply tweets and update instance list by [B0pol](https://github.com/B0pol)
* [nitter] Fix thumbnails by [B0pol](https://github.com/B0pol)
* [youtube] Fix thumbnail URL
* [youtube] Parse API parameters from initial webpage by [colethedj](https://github.com/colethedj)
* [youtube] Extract comments' approximate timestamp by [colethedj](https://github.com/colethedj)
* [youtube] Fix alert extraction
* [bilibili] Fix uploader
* [utils] Add `datetime_from_str` and `datetime_add_months` by [colethedj](https://github.com/colethedj)
* Run some `postprocessors` before actual download
* Improve argument parsing for `-P`, `-o`, `-S`
* Fix some `m3u8` not obeying `--allow-unplayable-formats`
* Fix default of `dynamic_mpd`
* Deprecate `--all-formats`, `--include-ads`, `--hls-prefer-native`, `--hls-prefer-ffmpeg`
* [documentation] Improvements

 Assets
6

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_efa6b6e7_20250111_125137.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Freleases%2Ftag%2F2024.04.09)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Freleases%2Ftag%2F2024.04.09)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=yt-dlp%2Fyt-dlp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[yt-dlp](/yt-dlp)
/
**[yt-dlp](/yt-dlp/yt-dlp)**
Public

* [Notifications](/login?return_to=%2Fyt-dlp%2Fyt-dlp) You must be signed in to change notification settings
* [Fork
  7.5k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)
* [Star
   95.9k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)

* [Code](/yt-dlp/yt-dlp/tree/2024.04.09)
* [Issues
  1.5k](/yt-dlp/yt-dlp/issues)
* [Pull requests
  326](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects
  4](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

Additional navigation options

* [Code](/yt-dlp/yt-dlp/tree/2024.04.09)
* [Issues](/yt-dlp/yt-dlp/issues)
* [Pull requests](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

1. [Releases](/yt-dlp/yt-dlp/releases)
2. [2024.04.09](/yt-dlp/yt-dlp/releases/tag/2024.04.09)

# yt-dlp 2024.04.09

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/yt-dlp/yt-dlp/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2024.04.09)

 Loading

[View all tags](/yt-dlp/yt-dlp/tags)

![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)
[github-actions](/apps/github-actions)
released this
09 Apr 17:10

[2024.04.09](/yt-dlp/yt-dlp/tree/2024.04.09)

[`168e72d`](/yt-dlp/yt-dlp/commit/168e72dcd3e04e0e19e92c012a04b8a1e4658f50)

[![Installation](https://camo.githubusercontent.com/a03bddc2b3a93bcb6a5d86ea8f79c570c68779769a12de2364477acae72538bc/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d576869636825323066696c65253230746f253230646f776e6c6f61642533462d77686974652e7376673f7374796c653d666f722d7468652d6261646765)](https://github.com/yt-dlp/yt-dlp#installation "Installation instructions") [![Discord](https://camo.githubusercontent.com/bcdc8bc6e8838a459e598b3746c9adb9c5c0812f8f32e704022f36461ba4eecd/68747470733a2f2f696d672e736869656c64732e696f2f646973636f72642f3830373234353635323037323835373631303f636f6c6f723d626c7565266c6162656c436f6c6f723d353535353535266c6162656c3d266c6f676f3d646973636f7264267374796c653d666f722d7468652d6261646765)](https://discord.gg/H5MNcFW63r "Discord") [![Donate](https://camo.githubusercontent.com/a8b252926d34e6123df43a4f0b9fa19d1fef006ffe4613e79eeff5421acf90e3/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f5f2d446f6e6174652d7265642e7376673f6c6f676f3d67697468756273706f6e736f7273266c6162656c436f6c6f723d353535353535267374796c653d666f722d7468652d6261646765)](https://github.com/yt-dlp/yt-dlp/blob/master/Collaborators.md#collaborators "Donate") [![Documentation](https://camo.githubusercontent.com/0d68539d0356a8e3bf8e2dd8f90d25721b77d62be5356760d74530f9c61e1157/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d446f63732d627269676874677265656e2e7376673f7374796c653d666f722d7468652d6261646765266c6f676f3d476974426f6f6b266c6162656c436f6c6f723d353535353535)](https://github.com/yt-dlp/yt-dlp/tree/2024.04.09#readme "Documentation") [![Nightly](https://camo.githubusercontent.com/52209411b6ccd5fddc2b96c8e3cb793154ccf12fb3402f48d76e31b63398aea4/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4e696768746c792532306275696c64732d707572706c652e7376673f7374796c653d666f722d7468652d6261646765)](https://github.com/yt-dlp/yt-dlp-nightly-builds/releases/latest "Nightly builds") [![Master](https://camo.githubusercontent.com/4a10df286c03ca0454dfcbc70ed6c19ef67d97acbdf57eae71688c76246c1f24/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4d61737465722532306275696c64732d6c69676874626c75652e7376673f7374796c653d666f722d7468652d6261646765)](https://github.com/yt-dlp/yt-dlp-master-builds/releases/latest "Master builds")

#### A description of the various files are in the [README](https://github.com/yt-dlp/yt-dlp#release-files)

---

#### Important changes

* Security: [[CVE-2024-22423](https://www.cve.org/CVERecord?id=CVE-2024-22423)] [Prevent RCE when using `--exec` with `%q` on Windows](https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-hjq6-52gw-2g7p)
  + The shell escape function now properly escapes `%`, `\` and `\n`.
  + `utils.Popen` has been patched accordingly.

### Changelog

#### Core changes

* [Add new option `--progress-delta`](https://github.com/yt-dlp/yt-dlp/commit/9590cc6b4768e190183d7d071a6c78170889116a) ([#9082](https://github.com/yt-dlp/yt-dlp/issues/9082)) by [Grub4K](https://github.com/Grub4K)
* [Add new options `--impersonate` and `--list-impersonate-targets`](https://github.com/yt-dlp/yt-dlp/commit/0b81d4d252bd065ccd352722987ea34fe17f9244) by [bashonly](https://github.com/bashonly), [coletdjnz](https://github.com/coletdjnz), [Grub4K](https://github.com/Grub4K), [pukkandan](https://github.com/pukkandan)
* [Add option `--no-break-on-existing`](https://github.com/yt-dlp/yt-dlp/commit/16be117729150b2784f3b17755c886cb0cf73374) ([#9610](https://github.com/yt-dlp/yt-dlp/issues/9610)) by [bashonly](https://github.com/bashonly)
* [Fix `filesize_approx` calculation](https://github.com/yt-dlp/yt-dlp/commit/86e3b82261e8ebc6c6707c09544c9dfb8907c0fd) ([#9560](https://github.com/yt-dlp/yt-dlp/issues/9560)) by [pukkandan](https://github.com/pukkandan), [seproDev](https://github.com/seproDev)
* [Infer `acodec` for single-codec containers](https://github.com/yt-dlp/yt-dlp/commit/86a972033e05fea80e5fe7f2aff6723dbe2f3952) by [pukkandan](https://github.com/pukkandan)
* [Prevent RCE when using `--exec` with `%q` (CVE-2024-22423)](https://github.com/yt-dlp/yt-dlp/commit/ff07792676f404ffff6ee61b5638c9dc1a33a37a) by [Grub4K](https://github.com/Grub4K)
* **cookies**: [Add `--cookies-from-browser` support for Firefox Flatpak](https://github.com/yt-dlp/yt-dlp/commit/2ab2651a4a7be18939e2b4cb21be79fe477c797a) ([#9619](https://github.com/yt-dlp/yt-dlp/issues/9619)) by [un-def](https://github.com/un-def)
* **utils**
  + `traverse_obj`
    - [Allow unbranching using `all` and `any`](https://github.com/yt-dlp/yt-dlp/commit/3699eeb67cad333272b14a42dd3843d93fda1a2e) ([#9571](https://github.com/yt-dlp/yt-dlp/issues/9571)) by [Grub4K](https://github.com/Grub4K)
    - [Convenience improvements](https://github.com/yt-dlp/yt-dlp/commit/32abfb00bdbd119ca675fdc6d1719331f0a2741a) ([#9577](https://github.com/yt-dlp/yt-dlp/issues/9577)) by [Grub4K](https://github.com/Grub4K)

#### Extractor changes

* [Add extractor impersonate API](https://github.com/yt-dlp/yt-dlp/commit/50c29352312f5662acf9a64b0012766f5c40af61) ([#9474](https://github.com/yt-dlp/yt-dlp/issues/9474)) by [bashonly](https://github.com/bashonly), [Grub4K](https://github.com/Grub4K), [pukkandan](https://github.com/pukkandan)
* **afreecatv**
  + [Overhaul extractor](https://github.com/yt-dlp/yt-dlp/commit/9415f1a5ef88482ebafe3083e8bcb778ac512df7) ([#9566](https://github.com/yt-dlp/yt-dlp/issues/9566)) by [bashonly](https://github.com/bashonly), [Tomoka1](https://github.com/Tomoka1)
  + live: [Fix extractor](https://github.com/yt-dlp/yt-dlp/commit/9073ae6458f4c6a832aa832c67174c61852869be) ([#9348](https://github.com/yt-dlp/yt-dlp/issues/9348)) by [hui1601](https://github.com/hui1601)
* **asobistage**: [Add extractor](https://github.com/yt-dlp/yt-dlp/commit/0284f1fee202302a78888420f933deae19d9f4e1) ([#8735](https://github.com/yt-dlp/yt-dlp/issues/8735)) by [pzhlkj6612](https://github.com/pzhlkj6612)
* **box**: [Support URLs without file IDs](https://github.com/yt-dlp/yt-dlp/commit/07f5b2f7570fd9ac85aed17f4c0118f6eac77beb) ([#9504](https://github.com/yt-dlp/yt-dlp/issues/9504)) by [shreyasminocha](https://github.com/shreyasminocha)
* **cbc.ca**: player: [Support new URL format](https://github.com/yt-dlp/yt-dlp/commit/b49d5ffc53a72d8245ba319ff07bdc5b8c6a4f0c) ([#9561](https://github.com/yt-dlp/yt-dlp/issues/9561)) by [trainman261](https://github.com/trainman261)
* **crunchyroll**
  + [Extract `vo_adaptive_hls` formats by default](https://github.com/yt-dlp/yt-dlp/commit/be77923ffe842f667971019460f6005f3cad01eb) ([#9447](https://github.com/yt-dlp/yt-dlp/issues/9447)) by [bashonly](https://github.com/bashonly)
  + [Fix extractor](https://github.com/yt-dlp/yt-dlp/commit/954e57e405f79188450eb30103a9308732cd318f) ([#9615](https://github.com/yt-dlp/yt-dlp/issues/9615)) by [bytedream](https://github.com/bytedream)
* **dropbox**: [Fix formats extraction](https://github.com/yt-dlp/yt-dlp/commit/a48cc86d6f6b20427553620c2ddb990ede6a4b41) ([#9627](https://github.com/yt-dlp/yt-dlp/issues/9627)) by [bashonly](https://github.com/bashonly)
* **fathom**: [Add extractor](https://github.com/yt-dlp/yt-dlp/commit/bc2b8c0596fd6b75af24822c4f0f1da6783d71f7) ([#9495](https://github.com/yt-dlp/yt-dlp/issues/9495)) by [src-tinkerer](https://github.com/src-tinkerer)
* **gofile**: [Fix extractor](https://github.com/yt-dlp/yt-dlp/commit/0da66980d3193cad3dae0120cddddbfcabddf7a1) ([#9446](https://github.com/yt-dlp/yt-dlp/issues/9446)) by [jazz1611](https://github.com/jazz1611)
* **imgur**: [Fix extraction](https://github.com/yt-dlp/yt-dlp/commit/86d2f4d24849af0d1f3af7c0e2ac43bf8a058f74) ([#9471](https://github.com/yt-dlp/yt-dlp/issues/9471)) by [trwstin](https://github.com/trwstin)
* **jiosaavn**
  + [Extract artists](https://github.com/yt-dlp/yt-dlp/commit/0ae16ceb1846cc4e609b70ce7c5d8e7458efceb2) ([#9612](https://github.com/yt-dlp/yt-dlp/issues/9612)) by [bashonly](https://github.com/bashonly)
  + [Fix format extensions](https://github.com/yt-dlp/yt-dlp/commit/443e206ec41e64ca2aef61d8ef91640fb69b3113) ([#9609](https://github.com/yt-dlp/yt-dlp/issues/9609)) by [bashonly](https://github.com/bashonly)
  + [Support playlists](https://github.com/yt-dlp/yt-dlp/commit/2e94602f241f6e41bdc48576c61089435529339b) ([#9622](https://github.com/yt-dlp/yt-dlp/issues/9622)) by [bashonly](https://github.com/bashonly)
* **joqrag**: [Fix live status detection](https://github.com/yt-dlp/yt-dlp/commit/f2fd449b46c4058222e1744f7a35caa20b2d003d) ([#9624](https://github.com/yt-dlp/yt-dlp/issues/9624)) by [pzhlkj6612](https://github.com/pzhlkj6612)
* **kick**: [Support browser impersonation](https://github.com/yt-dlp/yt-dlp/commit/c8a61a910096c77ce08dad5e1b2fbda5eb964156) ([#9611](https://github.com/yt-dlp/yt-dlp/issues/9611)) by [bashonly](https://github.com/bashonly)
* **loom**: [Add extractors](https://github.com/yt-dlp/yt-dlp/commit/f859ed3ba1e8b129ae6a467592c65687e73fbca1) ([#8686](https://github.com/yt-dlp/yt-dlp/issues/8686)) by [bashonly](https://github.com/bashonly), [hruzgar](https://github.com/hruzgar)
* **medici**: [Fix extractor](https://github.com/yt-dlp/yt-dlp/commit/4cd9e251b9abada107b10830de997bf4d79ca369) ([#9518](https://github.com/yt-dlp/yt-dlp/issues/9518)) by [Offert4324](https://github.com/Offert4324)
* **mixch**
  + [Fix extractor](https://github.com/yt-dlp/yt-dlp/commit/4c3b7a0769706f7f0ea24adf1f219d5ae82d2b07) ([#9608](https://github.com/yt-dlp/yt-dlp/issues/9608)) by [bashonly](https://github.com/bashonly), [nipotan](https://github.com/nipotan)
  + archive: [Fix extractor](https://github.com/yt-dlp/yt-dlp/commit/c59de48e2bb4c681b03b93b584a05f52609ce4a0) ([#8761](https://github.com/yt-dlp/yt-dlp/issues/8761)) by [pzhlkj6612](https://github.com/pzhlkj6612)
* **nhk**: [Fix NHK World extractors](https://github.com/yt-dlp/yt-dlp/commit/4af9d5c2f6aa81403ae2a8a5ae3cc824730f0b86) ([#9623](https://github.com/yt-dlp/yt-dlp/issues/9623)) by [bashonly](https://github.com/bashonly)
* **patreon**: [Do not extract dead embed URLs](https://github.com/yt-dlp/yt-dlp/commit/36b240f9a72af57eb2c9d927ebb7fd1c917ebf18) ([#9613](https://github.com/yt-dlp/yt-dlp/issues/9613)) by [johnvictorfs](https://github.com/johnvictorfs)
* **radio1be**: [Add extractor](https://github.com/yt-dlp/yt-dlp/commit/36baaa10e06715ccba06b78885b2042c4844c826) ([#9122](https://github.com/yt-dlp/yt-dlp/issues/9122)) by [HobbyistDev](https://github.com/HobbyistDev)
* **sharepoint**: [Add extractor](https://github.com/yt-dlp/yt-dlp/commit/ff349ff94aae0b2b148bd3670f7c91d39c2f1d8e) ([#6531](https://github.com/yt-dlp/yt-dlp/issues/6531)) by [bashonly](https://github.com/bashonly), [C0D3D3V](https://github.com/C0D3D3V)
* **sonylivseries**: [Fix season extraction](https://github.com/yt-dlp/yt-dlp/commit/f2868b26e917354203f82a370ad2396646edb813) ([#9423](https://github.com/yt-dlp/yt-dlp/issues/9423)) by [bashonly](https://github.com/bashonly)
* **soundcloud**
  + [Adjust format sorting](https://github.com/yt-dlp/yt-dlp/commit/a2d0840739cddd585d24e0ce4796394fc8a4fa2e) ([#9584](https://github.com/yt-dlp/yt-dlp/issues/9584)) by [bashonly](https://github.com/bashonly)
  + [Support cookies](https://github.com/yt-dlp/yt-dlp/commit/97362712a1f2b04e735bdf54f749ad99165a62fe) ([#9586](https://github.com/yt-dlp/yt-dlp/issues/9586)) by [bashonly](https://github.com/bashonly)
  + [Support retries for API rate-limit](https://github.com/yt-dlp/yt-dlp/commit/246571ae1d867df8bf31a056bdf3bbbfd398366a) ([#9585](https://github.com/yt-dlp/yt-dlp/issues/9585)) by [bashonly](https://github.com/bashonly)
* **thisoldhouse**: [Support Brightcove embeds](https://github.com/yt-dlp/yt-dlp/commit/0df63cce69026d2f4c0cbb4dd36163e83eac93dc) ([#9576](https://github.com/yt-dlp/yt-dlp/issues/9576)) by [bashonly](https://github.com/bashonly)
* **tiktok**
  + [Fix API extraction](https://github.com/yt-dlp/yt-dlp/commit/cb61e20c266facabb7a30f9ce53bd79dfc158475) ([#9548](https://github.com/yt-dlp/yt-dlp/issues/9548)) by [bashonly](https://github.com/bashonly), [Grub4K](https://github.com/Grub4K)
  + [Prefer non-bytevc2 formats](https://github.com/yt-dlp/yt-dlp/commit/63f685f341f35f6f02b0368d1ba53bdb5b520410) ([#9575](https://github.com/yt-dlp/yt-dlp/issues/9575)) by [bashonly](https://github.com/bashonly)
  + [Restore `carrier_region` API parameter](https://github.com/yt-dlp/yt-dlp/commit/fc53ec13ff1ee926a3e533a68cfca8acc887b661) ([#9637](https://github.com/yt-dlp/yt-dlp/issues/9637)) by [bashonly](https://github.com/bashonly)
  + [Update API hostname](https://github.com/yt-dlp/yt-dlp/commit/8c05b3ebae23c5b444857549a85b84004c01a536) ([#9444](https://github.com/yt-dlp/yt-dlp/issues/9444)) by [bashonly](https://github.com/bashonly)
* **twitch**: [Extract AV1 and HEVC formats](https://github.com/yt-dlp/yt-dlp/commit/02f93ff51b3ff9436d60c4993562b366eaae8851) ([#9158](https://github.com/yt-dlp/yt-dlp/issues/9158)) by [kasper93](https://github.com/kasper93)
* **vkplay**: [Fix `_VALID_URL`](https://github.com/yt-dlp/yt-dlp/commit/b15b0c1d2106437ec61a5c436c543e8760eac160) ([#9636](https://github.com/yt-dlp/yt-dlp/issues/9636)) by [bashonly](https://github.com/bashonly)
* **xvideos**: [Support new URL format](https://github.com/yt-dlp/yt-dlp/commit/aa7e9ae4f48276bd5d0173966c77db9484f65a0a) ([#9502](https://github.com/yt-dlp/yt-dlp/issues/9502)) by [sta1us](https://github.com/sta1us)
* **youtube**
  + [Calculate more accurate `filesize`](https://github.com/yt-dlp/yt-dlp/commit/a25a424323267e3f6f9f63c0b62df499bd7b8d46) by [pukkandan](https://github.com/pukkandan)
  + [Update `android` params](https://github.com/yt-dlp/yt-dlp/commit/e7b17fce14775bd2448695c8eb7379b8d31d3537) by [pukkandan](https://github.com/pukkandan)
  + search: [Fix params for uncensored results](https://github.com/yt-dlp/yt-dlp/commit/17d248a58781e2588d18a5ebe00c441d10011fcd) ([#9456](https://github.com/yt-dlp/yt-dlp/issues/9456)) by [alb](https://github.com/alb), [pukkandan](https://github.com/pukkandan)

#### Downloader changes

* **ffmpeg**: [Accept output args from info dict](https://github.com/yt-dlp/yt-dlp/commit/9c42b7eef547e826e9fcc7beb6706a2523949d05) ([#9278](https://github.com/yt-dlp/yt-dlp/issues/9278)) by [bashonly](https://github.com/bashonly)

#### Networking changes

* [Respect `SSLKEYLOGFILE` environment variable](https://github.com/yt-dlp/yt-dlp/commit/79a451e5763eda8b10d00684d5d3378f3255ee01) ([#9543](https://github.com/yt-dlp/yt-dlp/issues/9543)) by [luiso1979](https://github.com/luiso1979)
* **Request Handler**
  + curlcffi: [Add support for `curl_cffi`](https://github.com/yt-dlp/yt-dlp/commit/52f5be1f1e0dc45bb397ab950f564721976a39bf) by [bashonly](https://github.com/bashonly), [coletdjnz](https://github.com/coletdjnz), [Grub4K](https://github.com/Grub4K), [pukkandan](https://github.com/pukkandan)
  + websockets: [Workaround race condition causing issues on PyPy](https://github.com/yt-dlp/yt-dlp/commit/e5d4f11104ce7ea1717a90eea82c0f7d230ea5d5) ([#9514](https://github.com/yt-dlp/yt-dlp/issues/9514)) by [coletdjnz](https://github.com/coletdjnz)

#### Misc. changes

* **build**
  + [Do not include `curl_cffi` in `macos_legacy`](https://github.com/yt-dlp/yt-dlp/commit/b19ae095fdddd43c2a2c67d10fbe0d9a645bb98f) ([#9653](https://github.com/yt-dlp/yt-dlp/issues/9653)) by [bashonly](https://github.com/bashonly)
  + [Optional dependencies cleanup](https://github.com/yt-dlp/yt-dlp/commit/58dd0f8d1eee6bc9fdc57f1923bed772fa3c946d) ([#9550](https://github.com/yt-dlp/yt-dlp/issues/9550)) by [bashonly](https://github.com/bashonly)
  + [Print SHA sums to GHA logs](https://github.com/yt-dlp/yt-dlp/commit/e8032503b9517465b0e86d776fc1e60d8795d673) ([#9582](https://github.com/yt-dlp/yt-dlp/issues/9582)) by [bashonly](https://github.com/bashonly)
  + [Update changelog for tarball and sdist](https://github.com/yt-dlp/yt-dlp/commit/17b96974a334688f76b57d350e07cae8cda46877) ([#9425](https://github.com/yt-dlp/yt-dlp/issues/9425)) by [bashonly](https://github.com/bashonly)
* **cleanup**
  + [Standardize `import datetime as dt`](https://github.com/yt-dlp/yt-dlp/commit/c305a25c1b16bcf7a5ec499c3b786ed1e2c748da) ([#8978](https://github.com/yt-dlp/yt-dlp/issues/8978)) by [pukkandan](https://github.com/pukkandan)
  + ie: [No `from` stdlib imports in extractors](https://github.com/yt-dlp/yt-dlp/commit/e3a3ed8a981d9395c4859b6ef56cd02bc3148db2) by [pukkandan](https://github.com/pukkandan)
  + Miscellaneous: [216f6a3](https://github.com/yt-dlp/yt-dlp/commit/216f6a3cb57824e6a3c859649ce058c199b1b247) by [bashonly](https://github.com/bashonly), [pukkandan](https://github.com/pukkandan)
* **docs**
  + [Update yt-dlp tagline](https://github.com/yt-dlp/yt-dlp/commit/388c979ac63a8774339fac2516fe1cc852b4276e) ([#9481](https://github.com/yt-dlp/yt-dlp/issues/9481)) by [bashonly](https://github.com/bashonly), [coletdjnz](https://github.com/coletdjnz), [Grub4K](https://github.com/Grub4K), [pukkandan](https://github.com/pukkandan), [seproDev](https://github.com/seproDev)
  + [Various manpage fixes](https://github.com/yt-dlp/yt-dlp/commit/df0e138fc02ae2764a44f2f59fc93c756c4d3ee2) by [leoheitmannruiz](https://github.com/leoheitmannruiz)
* **test**
  + [Workaround websocket server hanging](https://github.com/yt-dlp/yt-dlp/commit/f849d77ab54788446b995d256e1ee0894c4fb927) ([#9467](https://github.com/yt-dlp/yt-dlp/issues/9467)) by [coletdjnz](https://github.com/coletdjnz)
  + `traversal`: [Separate traversal tests](https://github.com/yt-dlp/yt-dlp/commit/979ce2e786f2ee3fc783b6dc1ef4188d8805c923) ([#9574](https://github.com/yt-dlp/yt-dlp/issues/9574)) by [Grub4K](https://github.com/Grub4K)

 Assets
20

 Loading

 👍
130
 SiV44, AAndyProgram, bigjoe54321, Mohamed-Noah, sovalyeler, jonm58, UIUXGuy, roland-5, legend2ks, junguler, and 120 more reacted with thumbs up emoji
 😄
9
 egorenar, mpoullet, PostApoc, justTOBBI, Salah242222, HardikNaveen, DumZee, kayzzen01, and qUeLo reacted with laugh emoji
 🎉
37
 BackSpace54, LoayGhreeb, wader, AAndyProgram, bigjoe54321, Stewie410, crazyoptimist, Wojtaz0w, UIUXGuy, roland-5, and 27 more reacted with hooray emoji
 ❤️
43
 AAndyProgram, bigjoe54321, procopaeus, Mohamed-Noah, fer-moreira, Voltra, VerTigoNTxvii, UIUXGuy, roland-5, fqdb, and 33 more reacted with heart emoji
 🚀
17
 roland-5, Heliodex, Ero-gamer, vanadissss, libreom, K3V1991, mpoullet, loicreynier, PostApoc, Salah242222, and 7 more reacted with rocket emoji
 👀
10
 Paxsenix0, libreom, mpoullet, ageorge95, aaronliu0130, PostApoc, Salah242222, DumZee, kayzzen01, and qUeLo reacted with eyes emoji

All reactions

* 👍
  130 reactions
* 😄
  9 reactions
* 🎉
  37 reactions
* ❤️
  43 reactions
* 🚀
  17 reactions
* 👀
  10 reactions

 172 people reacted

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_bea46589_20250111_125138.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Fsecurity%2Fadvisories%2FGHSA-hjq6-52gw-2g7p)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Fsecurity%2Fadvisories%2FGHSA-hjq6-52gw-2g7p)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=yt-dlp%2Fyt-dlp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[yt-dlp](/yt-dlp)
/
**[yt-dlp](/yt-dlp/yt-dlp)**
Public

* [Notifications](/login?return_to=%2Fyt-dlp%2Fyt-dlp) You must be signed in to change notification settings
* [Fork
  7.5k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)
* [Star
   95.9k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)

* [Code](/yt-dlp/yt-dlp)
* [Issues
  1.5k](/yt-dlp/yt-dlp/issues)
* [Pull requests
  326](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects
  4](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

Additional navigation options

* [Code](/yt-dlp/yt-dlp)
* [Issues](/yt-dlp/yt-dlp/issues)
* [Pull requests](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

# `--exec` command injection when using `%q` in yt-dlp on Windows (CVE-2023-40581 bypass)

High

[Grub4K](/Grub4K)
published
GHSA-hjq6-52gw-2g7p
Apr 9, 2024

## Package

pip

yt-dlp
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

>=2021.04.11, <2024.04.09

## Patched versions

2024.04.09

## Description

### Summary

The [patch that addressed CVE-2023-40581](https://github.com/yt-dlp/yt-dlp/commit/de015e930747165dbb8fcd360f8775fd973b7d6e) attempted to prevent RCE when using `--exec` with `%q` by replacing double quotes with two double quotes.

However, this escaping is not sufficient, and still allows expansion of environment variables.

Support for output template expansion in `--exec`, along with this vulnerable behavior, was added to `yt-dlp` in version [2021.04.11](https://github.com/yt-dlp/yt-dlp/releases/tag/2021.04.11).

```
> yt-dlp "https://youtu.be/42xO6rVqf2E" --ignore-config -f 18 --exec "echo %(title)q"
[youtube] Extracting URL: https://youtu.be/42xO6rVqf2E
[youtube] 42xO6rVqf2E: Downloading webpage
[youtube] 42xO6rVqf2E: Downloading ios player API JSON
[youtube] 42xO6rVqf2E: Downloading android player API JSON
[youtube] 42xO6rVqf2E: Downloading m3u8 information
[info] 42xO6rVqf2E: Downloading 1 format(s): 18
[download] Destination: %CMDCMDLINE：~-1%&echo pwned&calc.exe [42xO6rVqf2E].mp4
[download] 100% of  126.16KiB in 00:00:00 at 2.46MiB/s
[Exec] Executing command: echo "%CMDCMDLINE:~-1%&echo pwned&calc.exe"
""
pwned
```
### Patches

yt-dlp version 2024.04.09 fixes this issue by properly escaping `%`. It replaces them with `%%cd:~,%`, a variable that expands to nothing, leaving only the leading percent.

### Workarounds

It is recommended to upgrade yt-dlp to version 2024.04.09 as soon as possible. Also, always be careful when using `--exec`, because while this specific vulnerability has been patched, using unvalidated input in shell commands is inherently dangerous.

For Windows users who are not able to upgrade:

* Avoid using any output template expansion in `--exec` other than `{}` (filepath).
* If expansion in `--exec` is needed, verify the fields you are using do not contain `%`, `"`, `|` or `&`.
* Instead of using `--exec`, write the info json and load the fields from it instead.

### Details

When escaping variables, the following code is used for Windows.

[`yt_dlp/compat/__init__.py` line 31-33](https://github.com/yt-dlp/yt-dlp/blob/8e6e3651727b0b85764857fc6329fe5e0a3f00de/yt_dlp/compat/__init__.py#L31-L33)

```
    def compat_shlex_quote(s):
        import re
        return s if re.match(r'^[-_\w./]+$', s) else s.replace('"', '""').join('""')
```

It replaces `"` with `""` to balance out the quotes and keep quoting intact if non-allowed characters are included. However, the `%CMDCMDLINE%` variable can be used to generate a quote using `%CMDCMDLINE:~-1%`; since the value of `%CMDCMDLINE%` is the commandline with which `cmd.exe` was called, and it is always called with the command surrounded by quotes, `%CMDCMDLINE:~-1%` expands to `"`. After the quotes have been unbalanced, special characters are no longer quoted and commands can be executed:

```
%CMDCMDLINE:~-1%&calc.exe
```
### References

* [GHSA-hjq6-52gw-2g7p](https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-hjq6-52gw-2g7p "GHSA-hjq6-52gw-2g7p")
* <https://nvd.nist.gov/vuln/detail/CVE-2024-22423>
* <https://github.com/yt-dlp/yt-dlp/releases/tag/2024.04.09>
* [ff07792](https://github.com/yt-dlp/yt-dlp/commit/ff07792676f404ffff6ee61b5638c9dc1a33a37a)

### Severity

High

8.4

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
Required

Scope
Changed

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H

### CVE ID

CVE-2024-22423

### Weaknesses

No CWEs

### Credits

* [![@Ry0taK](https://avatars.githubusercontent.com/u/49341894?s=40&v=4)](/Ry0taK)
  [Ry0taK](/Ry0taK)
  Reporter
* [![@Grub4K](https://avatars.githubusercontent.com/u/37424085?s=40&v=4)](/Grub4K)
  [Grub4K](/Grub4K)
  Remediation developer
* [![@pukkandan](https://avatars.githubusercontent.com/u/6623388?s=40&v=4)](/pukkandan)
  [pukkandan](/pukkandan)
  Remediation reviewer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_052463e1_20250111_125137.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Fsecurity%2Fadvisories%2FGHSA-42h4-v29r-42qg)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyt-dlp%2Fyt-dlp%2Fsecurity%2Fadvisories%2FGHSA-42h4-v29r-42qg)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=yt-dlp%2Fyt-dlp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[yt-dlp](/yt-dlp)
/
**[yt-dlp](/yt-dlp/yt-dlp)**
Public

* [Notifications](/login?return_to=%2Fyt-dlp%2Fyt-dlp) You must be signed in to change notification settings
* [Fork
  7.5k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)
* [Star
   95.9k](/login?return_to=%2Fyt-dlp%2Fyt-dlp)

* [Code](/yt-dlp/yt-dlp)
* [Issues
  1.5k](/yt-dlp/yt-dlp/issues)
* [Pull requests
  326](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects
  4](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

Additional navigation options

* [Code](/yt-dlp/yt-dlp)
* [Issues](/yt-dlp/yt-dlp/issues)
* [Pull requests](/yt-dlp/yt-dlp/pulls)
* [Discussions](/yt-dlp/yt-dlp/discussions)
* [Actions](/yt-dlp/yt-dlp/actions)
* [Projects](/yt-dlp/yt-dlp/projects)
* [Wiki](/yt-dlp/yt-dlp/wiki)
* [Security](/yt-dlp/yt-dlp/security)
* [Insights](/yt-dlp/yt-dlp/pulse)

# `--exec` command injection when using `%q` in yt-dlp on Windows

High

[coletdjnz](/coletdjnz)
published
GHSA-42h4-v29r-42qg
Sep 24, 2023

## Package

pip

yt-dlp
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

>= 2021.04.11, < 2023.09.24, < nightly 2023.09.24.003044

## Patched versions

2023.09.24, nightly 2023.09.24.003044

## Description

### Impact

[`yt-dlp`](https://github.com/yt-dlp/yt-dlp) allows the user to provide shell commands to be executed at various stages in its download process through the `--exec` flag. This flag allows output template expansion in its argument, so that video metadata values may be used in the shell commands. The metadata fields can be combined with the `%q` conversion, which is intended to quote/escape these values so they can be safely passed to the shell.

However, the escaping used for `cmd` (the shell used by Python's `subprocess` on Windows) did not properly escape special characters, which can allow for remote code execution if `--exec` is used directly with maliciously crafted remote data. This vulnerability only impacts `yt-dlp` on Windows, and the vulnerability is present regardless of whether `yt-dlp` is run from `cmd` or from `PowerShell`.

Support for output template expansion in `--exec`, along with this vulnerable behavior, was added to `yt-dlp` in version [2021.04.11](https://github.com/yt-dlp/yt-dlp/releases/tag/2021.04.11).

```
> yt-dlp https://youtu.be/Jo66yyCpHcQ --exec "echo %(title)q"
[youtube] Extracting URL: https://youtu.be/Jo66yyCpHcQ
[youtube] Jo66yyCpHcQ: Downloading webpage
[youtube] Jo66yyCpHcQ: Downloading ios player API JSON
[youtube] Jo66yyCpHcQ: Downloading android player API JSON
[youtube] Jo66yyCpHcQ: Downloading m3u8 information
[info] Jo66yyCpHcQ: Downloading 1 format(s): 135+251
[download] Destination: ＂&echo(&echo(pwned&rem( [Jo66yyCpHcQ].f135.mp4
[download] 100% of    4.85KiB in 00:00:00 at 60.20KiB/s
[download] Destination: ＂&echo(&echo(pwned&rem( [Jo66yyCpHcQ].f251.webm
[download] 100% of    4.80KiB in 00:00:00 at 31.58KiB/s
[Merger] Merging formats into "＂&echo(&echo(pwned&rem( [Jo66yyCpHcQ].mkv"
Deleting original file ＂&echo(&echo(pwned&rem( [Jo66yyCpHcQ].f135.mp4 (pass -k to keep)
Deleting original file ＂&echo(&echo(pwned&rem( [Jo66yyCpHcQ].f251.webm (pass -k to keep)
[Exec] Executing command: echo "\"&echo(&echo(pwned&rem("
"\"

pwned
```
### Patches

yt-dlp version 2023.09.24 fixes this issue by properly escaping each special character.

`\n` will be replaced by `\r`, as no way of escaping it has been found.

### Workarounds

It is recommended to upgrade yt-dlp to version 2023.09.24 as soon as possible. Also, always be careful when using `--exec`, because while this specific vulnerability has been patched, using unvalidated input in shell commands is inherently dangerous.

For Windows users who are not able to upgrade:

* Avoid using any output template expansion in `--exec` other than `{}` (filepath).
* If expansion in `--exec` is needed, verify the fields you are using do not contain `"`, `|` or `&`.
* Instead of using `--exec`, write the info json and load the fields from it instead.

### References

* [GHSA-42h4-v29r-42qg](https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-42h4-v29r-42qg "GHSA-42h4-v29r-42qg")
* <https://nvd.nist.gov/vuln/detail/CVE-2023-40581>
* <https://github.com/yt-dlp/yt-dlp/releases/tag/2023.09.24>
* <https://github.com/yt-dlp/yt-dlp-nightly-builds/releases/tag/2023.09.24.003044>
* [de015e9](https://github.com/yt-dlp/yt-dlp/commit/de015e930747165dbb8fcd360f8775fd973b7d6e)

### Severity

High

8.4

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
Required

Scope
Changed

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H

### CVE ID

CVE-2023-40581

### Weaknesses

[CWE-78](/advisories?query=cwe%3A78)

### Credits

* [![@Grub4K](https://avatars.githubusercontent.com/u/37424085?s=40&v=4)](/Grub4K)
  [Grub4K](/Grub4K)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.kb.cert.org_5478b803_20250111_125139.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#123335

## Multiple programming languages fail to escape arguments properly in Microsoft Windows

#### Vulnerability Note VU#123335

Original Release Date: 2024-04-10 | Last Revised: 2024-05-13

---

## Overview

Various programming languages lack proper validation mechanisms for commands and in some cases also fail to escape arguments correctly when invoking commands within a Microsoft Windows environment. The command injection vulnerability in these programming languages, when running on Windows, allows attackers to execute arbitrary code disguised as arguments to the command. This vulnerability may also affect the application that executes commands without specifying the file extension.

## Description

Programming languages typically provide a way to execute commands (for e.g., os/exec in Golang) on the operating system to facilitate interaction with the OS. Typically, the programming languages also allow for passing `arguments` which are considered data (or variables) for the command to be executed. The arguments themselves are expected to be not executable and the command is expected to be executed along with properly escaped arguments, as inputs to the command. Microsoft Windows typically processes these commands using a `CreateProcess` function that spawns a `cmd.exe` for execution of the command. Microsoft Windows has documented some of the concerns related to how these should be properly escaped before execution as early as 2011. See <https://learn.microsoft.com/en-us/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way>.

A vulnerability was discovered in the way multiple programming languages fail to properly escape the arguments in a Microsoft Windows command execution environment. This can lead confusion at execution time where an expected argument for a command could be executed as another command itself. An attacker with knowledge of the programming language can carefully craft inputs that will be processed by the compiled program as commands. This unexpected behavior is due to lack of neutralization of arguments by the programming language (or its command execution module) that initiates a Windows execution environment. The researcher has found multiple programming languages, and their command execution modules fail to perform such sanitization and/or validation before processing these in their runtime environment.

## Impact

Successful exploitation of this vulnerability permits an attacker to execute arbitrary commands. The complete impact of this vulnerability depends on the implementation that uses a vulnerable programming language or such a vulnerable module.

## Solution

#### Updating the runtime environment

Please visit the Vendor Information section so see if your programming language Vendor has released the patch for this vulnerability and update the runtime environment that can prevent abuse of this vulnerability.

#### Update the programs and escape manually

If the runtime of your application doesn't provide a patch for this vulnerability and you want to execute batch files with user-controlled arguments, you will need to perform the escaping and neutralization of the data to prevent any intended command execution.

Security researcher has more detailed information in the [blog post](https://flatt.tech/research/posts/batbadbut-you-cant-securely-execute-commands-on-windows/) which provides details on specific languages that were identified and their Status.

## Acknowledgements

Thanks to the reporter, [RyotaK](https://flatt.tech/research/posts/batbadbut-you-cant-securely-execute-commands-on-windows/).This document was written by Timur Snoke.

### Vendor Information

123335
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

### [Haskell Programming Language](#Haskell%20Programming%20Language) Affected

Notified:  2024-03-21
Updated: 2024-04-10

**Statement Date:   April 10, 2024**

| **CVE-2024-1874** | Unknown |
| --- | --- |
| **CVE-2024-22423** | Unknown |
| **CVE-2024-24576** | Unknown |
| **CVE-2024-3566** | Affected |
| **References:**   * <https://github.com/haskell/security-advisories/blob/main/advisories/hackage/process/HSEC-2024-0003.md> | |

#### Vendor Statement

The Haskell *process* library is affected. We assigned HSEC-2024-0003 for this issue. A fix was released in process-1.6.19.0.

#### References

* <https://github.com/haskell/security-advisories/blob/main/advisories/hackage/process/HSEC-2024-0003.md>

### [Node.js](#Node.js) Affected

Notified:  2024-02-22
Updated: 2024-04-12

**Statement Date:   February 26, 2024**

| **CVE-2024-1874** | Unknown |
| --- | --- |
| **CVE-2024-22423** | Unknown |
| **CVE-2024-24576** | Unknown |
| **CVE-2024-3566** | Affected |

#### Vendor Statement

We have not received a statement from the vendor.

#### References

* <https://nodejs.org/en/blog/release/v18.20.2>
* <https://nodejs.org/en/blog/release/v20.12.2>
* <https://nodejs.org/en/blog/release/v21.7.3>

#### CERT Addendum

Added references.

### [Rust Security Response WG](#Rust%20Security%20Response%20WG) Affected

Notified:  2024-02-22
Updated: 2024-04-10

**Statement Date:   April 10, 2024**

| **CVE-2024-1874** | Not Affected |
| --- | --- |
| **CVE-2024-22423** | Not Affected |
| **CVE-2024-24576** | Affected |
| **CVE-2024-3566** | Affected |

#### Vendor Statement

Rust is affected by this, and we issued CVE-2024-24576 to track the issue. Rust 1.77.2 fixes the vulnerability, and we recommend affected users to recompile their programs with the new compiler version.

#### References

* <https://github.com/rust-lang/rust/security/advisories/GHSA-q455-m56c-85mh>
* <https://blog.rust-lang.org/2024/04/09/cve-2024-24576.html>

### [The PHP Group](#The%20PHP%20Group) Affected

Notified:  2024-02-22
Updated: 2024-04-10

**Statement Date:   February 22, 2024**

| **CVE-2024-1874** | Unknown |
| --- | --- |
| **CVE-2024-22423** | Unknown |
| **CVE-2024-24576** | Unknown |
| **CVE-2024-3566** | Affected |

#### Vendor Statement

We have not received a statement from the vendor.

### [yt-dlp](#yt-dlp) Affected

Notified:  2024-03-21
Updated: 2024-04-10

**Statement Date:   April 10, 2024**

| **CVE-2024-1874** | Not Affected |
| --- | --- |
| **CVE-2024-22423** | Affected |
| **CVE-2024-24576** | Not Affected |
| **CVE-2024-3566** | Affected |

#### Vendor Statement

yt-dlp is affected and CVE-2024-22423 was issued to track the vulnerability

#### References

* <https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-hjq6-52gw-2g7p>

### [Go Programming Language](#Go%20Programming%20Language) Not Affected

Notified:  2024-02-22
Updated: 2024-04-10

**Statement Date:   March 14, 2024**

| **CVE-2024-1874** | Unknown |
| --- | --- |
| **CVE-2024-22423** | Unknown |
| **CVE-2024-24576** | Unknown |
| **CVE-2024-3566** | Not Affected |

#### Vendor Statement

We have not received a statement from the vendor.

### [Microsoft](#Microsoft) Not Affected

Notified:  2024-02-22
Updated: 2024-04-18

**Statement Date:   April 17, 2024**

| **CVE-2024-1874** | Not Affected |
| --- | --- |
| **CVE-2024-22423** | Not Affected |
| **CVE-2024-24576** | Not Affected |
| **CVE-2024-3566** | Not Affected |

#### Vendor Statement

We have not received a statement from the vendor.

#### CERT Addendum

This issue was identified by Microsoft in 2011 and continues to be a problem today. Thanks to a security researcher, the vulnerability is receiving greater attention and additional mitigation are being developed.

### [PostgreSQL](#PostgreSQL) Not Affected

Notified:  2024-02-22
Updated: 2024-05-13

**Statement Date:   May 10, 2024**

| **CVE-2024-1874** | Not Affected |
| --- | --- |
| **CVE-2024-22423** | Not Affected |
| **CVE-2024-24576** | Not Affected |
| **CVE-2024-3566** | Not Affected |

#### Vendor Statement

We have not received a statement from the vendor.

### [Red Hat](#Red%20Hat) Not Affected

Notified:  2024-02-22
Updated: 2024-04-10

**Statement Date:   April 10, 2024**

| **CVE-2024-1874** | Not Affected |
| --- | --- |
| **CVE-2024-22423** | Not Affected |
| **CVE-2024-24576** | Not Affected |
| **CVE-2024-3566** | Not Affected |

#### Vendor Statement

We have not received a statement from the vendor.

### [R Programing Language](#R%20Programing%20Language) Not Affected

Notified:  2024-04-10
Updated: 2024-05-13

**Statement Date:   May 13, 2024**

| **CVE-2024-1874** | Not Affected |
| --- | --- |
| **CVE-2024-22423** | Not Affected |
| **CVE-2024-24576** | Not Affected |
| **CVE-2024-3566** | Not Affected |

#### Vendor Statement

We have not received a statement from the vendor.

### [Erlang Programming Language](#Erlang%20Programming%20Language) Unknown

Notified:  2024-04-02
Updated: 2024-04-10

**Statement Date:   April 09, 2024**

| **CVE-2024-1874** | Unknown |
| --- | --- |
| **CVE-2024-22423** | Unknown |
| **CVE-2024-24576** | Unknown |
| **CVE-2024-3566** | Unknown |
| **Vendor Statement:** | |
| `erlang:open\_port/1,2` with the `spawn` and `spawn\_executable` options are vulnerable and should not be used with untrusted input. | |

### [Dart Programming Language](#Dart%20Programming%20Language) Unknown

Notified:  2024-04-02
Updated: 2024-04-10

| **CVE-2024-1874** | Unknown |
| --- | --- |
| **CVE-2024-22423** | Unknown |
| **CVE-2024-24576** | Unknown |
| **CVE-2024-3566** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Julia Language Security Reporting](#Julia%20Language%20Security%20Reporting) Unknown

Notified:  2024-04-10
Updated: 2024-04-10

| **CVE-2024-1874** | Unknown |
| --- | --- |
| **CVE-2024-22423** | Unknown |
| **CVE-2024-24576** | Unknown |
| **CVE-2024-3566** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [MySQL](#MySQL) Unknown

Notified:  2024-02-22
Updated: 2024-04-10

| **CVE-2024-1874** | Unknown |
| --- | --- |
| **CVE-2024-22423** | Unknown |
| **CVE-2024-24576** | Unknown |
| **CVE-2024-3566** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [MYSQL2](#MYSQL2) Unknown

Notified:  2024-02-22
Updated: 2024-04-10

| **CVE-2024-1874** | Unknown |
| --- | --- |
| **CVE-2024-22423** | Unknown |
| **CVE-2024-24576** | Unknown |
| **CVE-2024-3566** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Oracle Corporation](#Oracle%20Corporation) Unknown

Notified:  2024-02-22
Updated: 2024-04-10

| **CVE-2024-1874** | Unknown |
| --- | --- |
| **CVE-2024-22423** | Unknown |
| **CVE-2024-24576** | Unknown |
| **CVE-2024-3566** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Perl Developers](#Perl%20Developers) Unknown

Notified:  2024-02-22
Updated: 2024-04-10

| **CVE-2024-1874** | Unknown |
| --- | --- |
| **CVE-2024-22423** | Unknown |
| **CVE-2024-24576** | Unknown |
| **CVE-2024-3566** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Python](#Python) Unknown

Notified:  2024-02-22
Updated: 2024-04-10

| **CVE-2024-1874** | Unknown |
| --- | --- |
| **CVE-2024-22423** | Unknown |
| **CVE-2024-24576** | Unknown |
| **CVE-2024-3566** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Ruby](#Ruby) Unknown

Notified:  2024-02-22
Updated: 2024-04-10

| **CVE-2024-1874** | Unknown |
| --- | --- |
| **CVE-2024-22423** | Unknown |
| **CVE-2024-24576** | Unknown |
| **CVE-2024-3566** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [SQLite](#SQLite) Unknown

Notified:  2024-02-22
Updated: 2024-04-10

| **CVE-2024-1874** | Unknown |
| --- | --- |
| **CVE-2024-22423** | Unknown |
| **CVE-2024-24576** | Unknown |
| **CVE-2024-3566** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

View all 20 vendorsView less vendors

### References

* <https://learn.microsoft.com/en-us/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way>
* [https://flatt.tech/research/posts/batbadbut-you-cant-securely-execute-commands-on-windows/](https://flatt.tech/research/posts/batbadbut-you-cant-securely-execute-commands-on-windows/%20)
* <https://github.com/php/php-src/security/advisories/GHSA-pc52-254m-w9w7>
* <https://github.com/rust-lang/rust/security/advisories/GHSA-q455-m56c-85mh>
* <https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-hjq6-52gw-2g7p>
* <https://nodejs.org/en/blog/vulnerability/april-2024-security-releases-2>
* <https://github.com/haskell/security-advisories/blob/main/advisories/hackage/process/HSEC-2024-0003.md>
* <https://osv.dev/vulnerability/HSEC-2024-0003>

### Other Information

| **CVE IDs:** | [CVE-2024-1874](https://www.cve.org/CVERecord?id=CVE-2024-1874)  [CVE-2024-22423](https://www.cve.org/CVERecord?id=CVE-2024-22423)  [CVE-2024-24576](https://www.cve.org/CVERecord?id=CVE-2024-24576)  [CVE-2024-3566](https://www.cve.org/CVERecord?id=CVE-2024-3566) |
| --- | --- |
| **API URL:** | [VINCE JSON](/vuls/api/123335/) | [CSAF](/vuls/api/123335/csaf/) |
| **Date Public:** | 2024-04-10 |
| **Date First Published:** | 2024-04-10 |
| **Date Last Updated:** | 2024-05-13 13:18 UTC |
| **Document Revision:** | 8 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2024 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


