<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - [SECURITY ADVISORY] curl: CVE-2024-2004: Usage of disabled
 protocol</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://hashsuite.openwall.net">
Hash Suite - Windows password security audit tool. GUI, reports in PDF.</a>

</TABLE>
</TABLE>

<a href="../../../2024/03/26/2">[&lt;prev]</a> <a href="2">[next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;p3977r70-o1oo-156p-4970-rr80638qo7s&#64;unkk.fr&gt;
Date: Wed, 27 Mar 2024 07:58:00 +0100 (CET)
From: Daniel Stenberg &lt;daniel&#64;...x.se&gt;
To: curl security announcements -- curl users &lt;curl-users&#64;...ts.haxx.se&gt;, 
    curl-announce&#64;...ts.haxx.se, libcurl hacking &lt;curl-library&#64;...ts.haxx.se&gt;, 
    oss-security&#64;...ts.openwall.com
Subject: [SECURITY ADVISORY] curl: CVE-2024-2004: Usage of disabled
 protocol

Usage of disabled protocol
==========================

Project curl Security Advisory, March 27 2024 -
[Permalink](<a href="https://curl.se/docs/CVE-2024-2004.html" rel="nofollow">https://curl.se/docs/CVE-2024-2004.html</a>)

VULNERABILITY
-------------

When a protocol selection parameter option disables all protocols without
adding any then the default set of protocols would remain in the allowed set
due to an error in the logic for removing protocols. The below command would
perform a request to curl.se with a plaintext protocol which has been
explicitly disabled.

     curl --proto -all,-http <a href="http://curl.se" rel="nofollow">http://curl.se</a>

The flaw is only present if the set of selected protocols disables the entire
set of available protocols, in itself a command with no practical use and
therefore unlikely to be encountered in real situations. The curl security team
has thus assessed this to be low severity bug.

INFO
----

The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2024-2004 to this issue.

CWE-115: Misinterpretation of Input

Severity: Low

AFFECTED VERSIONS
-----------------

- Affected versions: curl 7.85.0 to and including 8.6.0
- Not affected versions: curl &lt; 7.85.0 and &gt;= 8.7.0
- Introduced-in: <a href="https://github.com/curl/curl/commit/e6f8445edef8e7996d1" rel="nofollow">https://github.com/curl/curl/commit/e6f8445edef8e7996d1</a>

libcurl is used by many applications, but not always advertised as such!

This flaw is also accessible using the curl command line tool.

SOLUTION
------------

Starting in curl 8.7.0, the set of allowed protocols is cleared before the set
of disabled protocols is inspected, leaving all protocols disabled even in the
error path.

- Fixed-in: <a href="https://github.com/curl/curl/commit/17d302e56221" rel="nofollow">https://github.com/curl/curl/commit/17d302e56221</a>

RECOMMENDATIONS
--------------

  A - Upgrade curl to version 8.7.0

  B - Apply the patch to your local version

  C - Inspect any scripts which constructs curl commands with `--proto` options
      to make sure there is at least one allowed protocol

TIMELINE
--------

This issue was reported to the curl project on February 15, 2024. We contacted
distros&#64;...nwall on March 19, 2024.

curl 8.7.0 was released on March 27 2024 around 07:00 UTC, coordinated with
the publication of this advisory.

The curl security team is not aware of any active exploits using this
vulnerability.

CREDITS
-------

- Reported-by: Dan Fandrich
- Patched-by: Daniel Gustafsson

Thanks a lot!

-- 

  / daniel.haxx.se
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
