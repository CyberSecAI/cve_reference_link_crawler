=== Content from github.com_76eb3d23_20250110_175013.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevmos%2Fevmos%2Fsecurity%2Fadvisories%2FGHSA-q6hg-6m9x-5g9c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevmos%2Fevmos%2Fsecurity%2Fadvisories%2FGHSA-q6hg-6m9x-5g9c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=evmos%2Fevmos)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[evmos](/evmos)
/
**[evmos](/evmos/evmos)**
Public

* [Notifications](/login?return_to=%2Fevmos%2Fevmos) You must be signed in to change notification settings
* [Fork
  876](/login?return_to=%2Fevmos%2Fevmos)
* [Star
   1.7k](/login?return_to=%2Fevmos%2Fevmos)

* [Code](/evmos/evmos)
* [Issues
  13](/evmos/evmos/issues)
* [Pull requests
  12](/evmos/evmos/pulls)
* [Discussions](/evmos/evmos/discussions)
* [Actions](/evmos/evmos/actions)
* [Security](/evmos/evmos/security)
* [Insights](/evmos/evmos/pulse)

Additional navigation options

* [Code](/evmos/evmos)
* [Issues](/evmos/evmos/issues)
* [Pull requests](/evmos/evmos/pulls)
* [Discussions](/evmos/evmos/discussions)
* [Actions](/evmos/evmos/actions)
* [Security](/evmos/evmos/security)
* [Insights](/evmos/evmos/pulse)

# Precompiles exploit of smart contract account and vesting

Critical

[hanchon](/hanchon)
published
GHSA-q6hg-6m9x-5g9c
Jul 5, 2024

## Package

gomod

github.com/evmos/evmos
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

<= 18.0.1

## Patched versions

>= 19.0.0

## Description

### Summary

This advisory board aims to describe two vulnerabilities found in the Evmos codebase:

* *Authorization check on the fundVestingAccount*: unauthorized spend of funds.

### Details

#### Authorization check on the fundVestingAccount

With the current implementation, a user can create a vesting account with a 3rd party account (EOA or contract) as funder. Then, this user can create an authorization for the contract.CallerAddress, this is the authorization checked in the code. But the funds are taken from the funder address provided in the message. Consequently, the user can fund a vesting account with a 3rd party account without its permission. The funder address can be any address, so this vulnerability can be used to drain all the accounts in the chain.

### Severity

Based on [ImmuneFi Severity Classification System](https://immunefisupport.zendesk.com/hc/en-us/articles/13332717597585-Severity-Classification-System) the severity was evaluated to Critical since the attack could have lead to direct loss of funds.

### Patches

The issue has been patched in versions >=V19.0.0

### Severity

Critical

### CVE ID

CVE-2024-39696

### Weaknesses

No CWEs

### Credits

* [![@GAtom22](https://avatars.githubusercontent.com/u/54514587?s=40&v=4)](/GAtom22)
  [GAtom22](/GAtom22)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_4db1a4f2_20250110_175012.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevmos%2Fevmos%2Fcommit%2F0a620e176617a835ac697eea494afea09185dfaf)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevmos%2Fevmos%2Fcommit%2F0a620e176617a835ac697eea494afea09185dfaf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=evmos%2Fevmos)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[evmos](/evmos)
/
**[evmos](/evmos/evmos)**
Public

* [Notifications](/login?return_to=%2Fevmos%2Fevmos) You must be signed in to change notification settings
* [Fork
  876](/login?return_to=%2Fevmos%2Fevmos)
* [Star
   1.7k](/login?return_to=%2Fevmos%2Fevmos)

* [Code](/evmos/evmos)
* [Issues
  13](/evmos/evmos/issues)
* [Pull requests
  12](/evmos/evmos/pulls)
* [Discussions](/evmos/evmos/discussions)
* [Actions](/evmos/evmos/actions)
* [Security](/evmos/evmos/security)
* [Insights](/evmos/evmos/pulse)

Additional navigation options

* [Code](/evmos/evmos)
* [Issues](/evmos/evmos/issues)
* [Pull requests](/evmos/evmos/pulls)
* [Discussions](/evmos/evmos/discussions)
* [Actions](/evmos/evmos/actions)
* [Security](/evmos/evmos/security)
* [Insights](/evmos/evmos/pulse)

## Commit

[Permalink](/evmos/evmos/commit/0a620e176617a835ac697eea494afea09185dfaf)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-q6hg-6m9x-5g9c](https://github.com/advisories/GHSA-q6hg-6m9x-5g9c "GHSA-q6hg-6m9x-5g9c")

[Browse files](/evmos/evmos/tree/0a620e176617a835ac697eea494afea09185dfaf)
Browse the repository at this point in the history

```
* fix(precompile): add funder and dest check to update balance

* add more test cases

* restrict funder to be origin or contract caller

* restrict dest address when calling from sc

* add test case with funds transfer within precompile call

* remove print

* add check for dirty addresses

* add UpdateDirties func

* update dirties helper func

* Update precompiles/vesting/utils_test.go

Co-authored-by: stepit <48993133+0xstepit@users.noreply.github.com>
Signed-off-by: Tom <54514587+GAtom22@users.noreply.github.com>

* update comment description

* changes based on review comments

* refactor updateDirties

* add test cases for updating funder balance before and after precompile call

* add revert state test

* update tx logic

* update integration tests

* refactor auth logic

* update tests

* add comt

* fix: add funder and vest acc to dirties

* add test cases for latest changes

* address review comments

* address review comments

* address review comments

* fix FlashLoan contract compilation

* update logic

* use pointer in precompile txs

* remove unnecessary comment

---------

Signed-off-by: Tom <54514587+GAtom22@users.noreply.github.com>
Co-authored-by: stepit <48993133+0xstepit@users.noreply.github.com>
```

* Loading branch information

[![@GAtom22](https://avatars.githubusercontent.com/u/54514587?s=40&v=4)](/GAtom22) [![@0xstepit](https://avatars.githubusercontent.com/u/48993133?s=40&v=4)](/0xstepit)

[GAtom22](/evmos/evmos/commits?author=GAtom22 "View all commits by GAtom22")
and
[0xstepit](/evmos/evmos/commits?author=0xstepit "View all commits by 0xstepit")
authored
Jul 5, 2024

1 parent
[37ddf53](/evmos/evmos/commit/37ddf530a1e32486dd56cdeaeef2580a705a32cb)

commit 0a620e1

 Show file tree

 Hide file tree

Showing
**15 changed files**
with
**1,668 additions**
and
**178 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* precompiles

  + testutil/contracts

    - precompiles/testutil/contracts/Counter.json
      [Counter.json](#diff-fc1f59b17c9d48dbde1ac4cf9576f3efb6a2260f8d5b1e9d5b670c7b21c777b9)
    - precompiles/testutil/contracts/Counter.sol
      [Counter.sol](#diff-6f96e6fb2757ac2ec5aa705f0d326c927cbf2a55b6fb2fbe956e1cb72dd9d36a)
    - precompiles/testutil/contracts/DistributionCaller.json
      [DistributionCaller.json](#diff-80575ea9a6bfb169eb121dc5e19daf4a6439a037a2293a29ae1caa848e539fa2)
    - precompiles/testutil/contracts/FlashLoan.json
      [FlashLoan.json](#diff-eae1fdaec77e7c36d636f2e7310867a2216bc3cd3b61c0fd0b50902ca8f3a163)
    - precompiles/testutil/contracts/FlashLoan.sol
      [FlashLoan.sol](#diff-0a01efeb42760664846355faa3e380f2198aba3b6ddbccf20445c54035e294eb)
    - precompiles/testutil/contracts/ICounter.sol
      [ICounter.sol](#diff-20df62ad44b07a2ef4ea562409f04a09f9dd6708099f3258c623a07714865b47)
    - precompiles/testutil/contracts/Reverter.json
      [Reverter.json](#diff-e9271150576c41105c4ba6dce2e21cd326eeaa7c8444e29a1a0280c38416bd9f)
    - precompiles/testutil/contracts/counter.go
      [counter.go](#diff-82c06cf976f62f95717e54604a9f71d81cbe2aca547a87192b85857928037a9f)
  + vesting

    - precompiles/vesting/errors.go
      [errors.go](#diff-4f184b31dca888ab7f48d001fe29b1e457a0632acb611a5c2fd0040d6d68114b)
    - precompiles/vesting/events.go
      [events.go](#diff-bfc0d6427fb3d383f6a36854339357775874f018832a9454c5678058bf168e37)
    - precompiles/vesting/integration\_test.go
      [integration\_test.go](#diff-a6395294dc883f7af8a5842c8c400d1d75d8062c5e9d3cdc84cff620f2d5c9d8)
    - testdata

      * precompiles/vesting/testdata/VestingCaller.json
        [VestingCaller.json](#diff-0c1744156a9610362ca4e054bdc00605a48d9b5af6c8cf960524af5906168c86)
      * precompiles/vesting/testdata/VestingCaller.sol
        [VestingCaller.sol](#diff-2a676311dec2bfb098a56f2178242245e04ed009c90dff8113b39a96366f0085)
    - precompiles/vesting/tx.go
      [tx.go](#diff-2e0d2413647430f00caaaa9c9412ae7ec22abb198b3f7e1cb133fefdc19667e1)
    - precompiles/vesting/utils\_test.go
      [utils\_test.go](#diff-9dfa159f935c2fe0cdf886dde3fd44660ce86ef845df4594b8718f038e7cb5d9)

## There are no files selected for viewing

64 changes: 64 additions & 0 deletions

64
[precompiles/testutil/contracts/Counter.json](#diff-fc1f59b17c9d48dbde1ac4cf9576f3efb6a2260f8d5b1e9d5b670c7b21c777b9 "precompiles/testutil/contracts/Counter.json")

Show comments

[View file](/evmos/evmos/blob/0a620e176617a835ac697eea494afea09185dfaf/precompiles/testutil/contracts/Counter.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,64 @@ |
|  |  | { |
|  |  | "\_format": "hh-sol-artifact-1", |
|  |  | "contractName": "Counter", |
|  |  | "sourceName": "solidity/precompiles/testutil/contracts/Counter.sol", |
|  |  | "abi": [ |
|  |  | { |
|  |  | "anonymous": false, |
|  |  | "inputs": [ |
|  |  | { |
|  |  | "indexed": false, |
|  |  | "internalType": "uint256", |
|  |  | "name": "counter", |
|  |  | "type": "uint256" |
|  |  | } |
|  |  | ], |
|  |  | "name": "Added", |
|  |  | "type": "event" |
|  |  | }, |
|  |  | { |
|  |  | "anonymous": false, |
|  |  | "inputs": [ |
|  |  | { |
|  |  | "indexed": false, |
|  |  | "internalType": "uint256", |
|  |  | "name": "counter", |
|  |  | "type": "uint256" |
|  |  | } |
|  |  | ], |
|  |  | "name": "Changed", |
|  |  | "type": "event" |
|  |  | }, |
|  |  | { |
|  |  | "inputs": [], |
|  |  | "name": "add", |
|  |  | "outputs": [], |
|  |  | "stateMutability": "nonpayable", |
|  |  | "type": "function" |
|  |  | }, |
|  |  | { |
|  |  | "inputs": [], |
|  |  | "name": "getCounter", |
|  |  | "outputs": [ |
|  |  | { |
|  |  | "internalType": "uint256", |
|  |  | "name": "", |
|  |  | "type": "uint256" |
|  |  | } |
|  |  | ], |
|  |  | "stateMutability": "view", |
|  |  | "type": "function" |
|  |  | }, |
|  |  | { |
|  |  | "inputs": [], |
|  |  | "name": "subtract", |
|  |  | "outputs": [], |
|  |  | "stateMutability": "nonpayable", |
|  |  | "type": "function" |
|  |  | } |
|  |  | ], |
|  |  | "bytecode": "0x60806040526000805534801561001457600080fd5b50610397806100246000396000f3fe608060405234801561001057600080fd5b50600436106100415760003560e01c80634f2be91f146100465780636deebae3146100505780638ada066e1461005a575b600080fd5b61004e610078565b005b610058610103565b005b6100626101d2565b60405161006f91906101f4565b60405180910390f35b60008081548092919061008a9061023e565b91905055507f64a55044d1f2eddebe1b90e8e2853e8e96931cefadbfa0b2ceb34bee360619416000546040516100c091906101f4565b60405180910390a17f938d2ee5be9cfb0f7270ee2eff90507e94b37625d9d2b3a61c97d30a4560b8296000546040516100f991906101f4565b60405180910390a1565b60008054116040518060400160405280600f81526020017f434f554e5445525f544f4f5f4c4f5700000000000000000000000000000000008152509061017f576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016101769190610316565b60405180910390fd5b5060008081548092919061019290610338565b91905055507f938d2ee5be9cfb0f7270ee2eff90507e94b37625d9d2b3a61c97d30a4560b8296000546040516101c891906101f4565b60405180910390a1565b60008054905090565b6000819050919050565b6101ee816101db565b82525050565b600060208201905061020960008301846101e5565b92915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b6000610249826101db565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff820361027b5761027a61020f565b5b600182019050919050565b600081519050919050565b600082825260208201905092915050565b60005b838110156102c05780820151818401526020810190506102a5565b60008484015250505050565b6000601f19601f8301169050919050565b60006102e882610286565b6102f28185610291565b93506103028185602086016102a2565b61030b816102cc565b840191505092915050565b6000602082019050818103600083015261033081846102dd565b905092915050565b6000610343826101db565b9150600082036103565761035561020f565b5b60018203905091905056fea26469706673582212202870b2d78304eb0ec6b95f72bacf96e449481ecaa4d58a3ce786c1cba532075d64736f6c63430008130033", |
|  |  | "deployedBytecode": "0x608060405234801561001057600080fd5b50600436106100415760003560e01c80634f2be91f146100465780636deebae3146100505780638ada066e1461005a575b600080fd5b61004e610078565b005b610058610103565b005b6100626101d2565b60405161006f91906101f4565b60405180910390f35b60008081548092919061008a9061023e565b91905055507f64a55044d1f2eddebe1b90e8e2853e8e96931cefadbfa0b2ceb34bee360619416000546040516100c091906101f4565b60405180910390a17f938d2ee5be9cfb0f7270ee2eff90507e94b37625d9d2b3a61c97d30a4560b8296000546040516100f991906101f4565b60405180910390a1565b60008054116040518060400160405280600f81526020017f434f554e5445525f544f4f5f4c4f5700000000000000000000000000000000008152509061017f576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016101769190610316565b60405180910390fd5b5060008081548092919061019290610338565b91905055507f938d2ee5be9cfb0f7270ee2eff90507e94b37625d9d2b3a61c97d30a4560b8296000546040516101c891906101f4565b60405180910390a1565b60008054905090565b6000819050919050565b6101ee816101db565b82525050565b600060208201905061020960008301846101e5565b92915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b6000610249826101db565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff820361027b5761027a61020f565b5b600182019050919050565b600081519050919050565b600082825260208201905092915050565b60005b838110156102c05780820151818401526020810190506102a5565b60008484015250505050565b6000601f19601f8301169050919050565b60006102e882610286565b6102f28185610291565b93506103028185602086016102a2565b61030b816102cc565b840191505092915050565b6000602082019050818103600083015261033081846102dd565b905092915050565b6000610343826101db565b9150600082036103565761035561020f565b5b60018203905091905056fea26469706673582212202870b2d78304eb0ec6b95f72bacf96e449481ecaa4d58a3ce786c1cba532075d64736f6c63430008130033", |
|  |  | "linkReferences": {}, |
|  |  | "deployedLinkReferences": {} |
|  |  | } |

26 changes: 26 additions & 0 deletions

26
[precompiles/testutil/contracts/Counter.sol](#diff-6f96e6fb2757ac2ec5aa705f0d326c927cbf2a55b6fb2fbe956e1cb72dd9d36a "precompiles/testutil/contracts/Counter.sol")

Show comments

[View file](/evmos/evmos/blob/0a620e176617a835ac697eea494afea09185dfaf/precompiles/testutil/contracts/Counter.sol)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,26 @@ |
|  |  | // SPDX-License-Identifier: GPL-3.0 |
|  |  |  |
|  |  | pragma solidity >=0.7.0 <0.9.0; |
|  |  |  |
|  |  | contract Counter { |
|  |  | uint256 counter = 0; |
|  |  | string internal constant ERROR\_TOO\_LOW = "COUNTER\_TOO\_LOW"; |
|  |  | event Changed(uint256 counter); |
|  |  | event Added(uint256 counter); |
|  |  |  |
|  |  | function add() public { |
|  |  | counter++; |
|  |  | emit Added(counter); |
|  |  | emit Changed(counter); |
|  |  | } |
|  |  |  |
|  |  | function subtract() public { |
|  |  | require(counter > 0, ERROR\_TOO\_LOW); |
|  |  | counter--; |
|  |  | emit Changed(counter); |
|  |  | } |
|  |  |  |
|  |  | function getCounter() public view returns (uint256) { |
|  |  | return counter; |
|  |  | } |
|  |  | } |

4 changes: 2 additions & 2 deletions

4
[precompiles/testutil/contracts/DistributionCaller.json](#diff-80575ea9a6bfb169eb121dc5e19daf4a6439a037a2293a29ae1caa848e539fa2 "precompiles/testutil/contracts/DistributionCaller.json")

Show comments

[View file](/evmos/evmos/blob/0a620e176617a835ac697eea494afea09185dfaf/precompiles/testutil/contracts/DistributionCaller.json)
Edit file

Delete file

Load diff

Large diffs are not rendered by default.

Oops, something went wrong.

Retry

6 changes: 3 additions & 3 deletions

6
[precompiles/testutil/contracts/FlashLoan.json](#diff-eae1fdaec77e7c36d636f2e7310867a2216bc3cd3b61c0fd0b50902ca8f3a163 "precompiles/testutil/contracts/FlashLoan.json")

Show comments

[View file](/evmos/evmos/blob/0a620e176617a835ac697eea494afea09185dfaf/precompiles/testutil/contracts/FlashLoan.json)
Edit file

Delete file

Load diff

Large diffs are not rendered by default.

Oops, something went wrong.

Retry

6 changes: 3 additions & 3 deletions

6
[precompiles/testutil/contracts/FlashLoan.sol](#diff-0a01efeb42760664846355faa3e380f2198aba3b6ddbccf20445c54035e294eb "precompiles/testutil/contracts/FlashLoan.sol")

Show comments

[View file](/evmos/evmos/blob/0a620e176617a835ac697eea494afea09185dfaf/precompiles/testutil/contracts/FlashLoan.sol)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -28,7 +28,7 @@ contract FlashLoan { |
|  |  | uint256 balancePre = token.balanceOf(address(this)); |
|  |  | bool success = token.transferFrom(msg.sender, address(this), \_amount); |
|  |  | require(success, "Failed to transfer tokens for flash loan"); |
|  |  | assert( |
|  |  | require( |
|  |  | token.balanceOf(address(this)) == balancePre + \_amount, |
|  |  | "Flash loan failed" |
|  |  | ); |
| Expand All | | @@ -44,7 +44,7 @@ contract FlashLoan { |
|  |  | // Transfer tokens back to end the flash loan |
|  |  | balancePre = token.balanceOf(address(this)); |
|  |  | token.transfer(msg.sender, \_amount); |
|  |  | assert( |
|  |  | require( |
|  |  | token.balanceOf(address(this)) == balancePre - \_amount, |
|  |  | "Flash loan repayment failed" |
|  |  | ); |
| Expand All | | @@ -69,7 +69,7 @@ contract FlashLoan { |
|  |  | uint256 balancePre = token.balanceOf(address(this)); |
|  |  | bool success = token.transferFrom(msg.sender, address(this), \_amount); |
|  |  | require(success, "Failed to transfer tokens for flash loan"); |
|  |  | assert( |
|  |  | require( |
|  |  | token.balanceOf(address(this)) == balancePre + \_amount, |
|  |  | "Flash loan failed" |
|  |  | ); |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[precompiles/testutil/contracts/ICounter.sol](#diff-20df62ad44b07a2ef4ea562409f04a09f9dd6708099f3258c623a07714865b47 "precompiles/testutil/contracts/ICounter.sol")

Show comments

[View file](/evmos/evmos/blob/0a620e176617a835ac697eea494afea09185dfaf/precompiles/testutil/contracts/ICounter.sol)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,9 @@ |
|  |  | pragma solidity ^0.8.17; |
|  |  |  |
|  |  | interface ICounter { |
|  |  | function add() external; |
|  |  | function subtract() external; |
|  |  | function getCounter() external view returns (uint256); |
|  |  | event Changed(uint256 counter); |
|  |  | event Added(uint256 counter); |
|  |  | } |

4 changes: 2 additions & 2 deletions

4
[precompiles/testutil/contracts/Reverter.json](#diff-e9271150576c41105c4ba6dce2e21cd326eeaa7c8444e29a1a0280c38416bd9f "precompiles/testutil/contracts/Reverter.json")

Show comments

[View file](/evmos/evmos/blob/0a620e176617a835ac697eea494afea09185dfaf/precompiles/testutil/contracts/Reverter.json)
Edit file

Delete file

Load diff

Large diffs are not rendered by default.

Oops, something went wrong.

Retry

13 changes: 13 additions & 0 deletions

13
[precompiles/testutil/contracts/counter.go](#diff-82c06cf976f62f95717e54604a9f71d81cbe2aca547a87192b85857928037a9f "precompiles/testutil/contracts/counter.go")

Show comments

[View file](/evmos/evmos/blob/0a620e176617a835ac697eea494afea09185dfaf/precompiles/testutil/contracts/counter.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,13 @@ |
|  |  | // Copyright Tharsis Labs Ltd.(Evmos) |
|  |  | // SPDX-License-Identifier:ENCL-1.0(https://github.com/evmos/evmos/blob/main/LICENSE) |
|  |  |  |
|  |  | package contracts |
|  |  |  |
|  |  | import ( |
|  |  | contractutils "github.com/evmos/evmos/v18/contracts/utils" |
|  |  | evmtypes "github.com/evmos/evmos/v18/x/evm/types" |
|  |  | ) |
|  |  |  |
|  |  | func LoadCounterContract() (evmtypes.CompiledContract, error) { |
|  |  | return contractutils.LoadContractFromJSONFile("Counter.json") |
|  |  | } |

2 changes: 2 additions & 0 deletions

2
[precompiles/vesting/errors.go](#diff-4f184b31dca888ab7f48d001fe29b1e457a0632acb611a5c2fd0040d6d68114b "precompiles/vesting/errors.go")

Show comments

[View file](/evmos/evmos/blob/0a620e176617a835ac697eea494afea09185dfaf/precompiles/vesting/errors.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -7,4 +7,6 @@ const ( |
|  |  | ErrDifferentFromOrigin = "tx origin address %s does not match the from address %s" |
|  |  | // ErrDifferentFunderOrigin is raised when the tx origin address is not the same as the vesting transaction funder. |
|  |  | ErrDifferentFunderOrigin = "tx origin address %s does not match the funder address %s" |
|  |  | // ErrInvalidDestination is raised when the destination address is not an EOA or the contract calling the precompile. |
|  |  | ErrInvalidDestination = "invalid destination address %s. Should be an EOA or the contract calling the precompile" |
|  |  | ) |

4 changes: 0 additions & 4 deletions

4
[precompiles/vesting/events.go](#diff-bfc0d6427fb3d383f6a36854339357775874f018832a9454c5678058bf168e37 "precompiles/vesting/events.go")

Show comments

[View file](/evmos/evmos/blob/0a620e176617a835ac697eea494afea09185dfaf/precompiles/vesting/events.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -90,10 +90,6 @@ func (p Precompile) EmitCreateClawbackVestingAccountEvent( |
|  |  | return err |
|  |  | } |
|  |  |  |
|  |  | if err != nil { |
|  |  | return err |
|  |  | } |
|  |  |  |
|  |  | // Create the event |
|  |  | stateDB.AddLog(&ethtypes.Log{ |
|  |  | Address: p.Address(), |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0a620e1`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevmos%2Fevmos%2Fcommit%2F0a620e176617a835ac697eea494afea09185dfaf) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


