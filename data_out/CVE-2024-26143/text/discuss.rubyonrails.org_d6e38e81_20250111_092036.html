

![Ruby on Rails Discussions](data:image/svg;base64...)
Loading

[Ruby on Rails Discussions](/)

# [Possible XSS Vulnerability in Action Controller](/t/possible-xss-vulnerability-in-action-controller/84947)

[Security Announcements](/c/security-announcements/9)

[patch](https://discuss.rubyonrails.org/tag/patch),
[announcement](https://discuss.rubyonrails.org/tag/announcement)

[tenderlove](https://discuss.rubyonrails.org/u/tenderlove)
(Aaron Patterson)

February 21, 2024, 8:44pm

1

There is a possible XSS vulnerability when using the translation helpers
(`translate`, `t`, etc) in Action Controller. This vulnerability has been
assigned the CVE identifier CVE-2024-26143.

Versions Affected: >= 7.0.0.
Not affected: < 7.0.0
Fixed Versions: 7.1.3.1, 7.0.8.1

## Impact

Applications using translation methods like `translate`, or `t` on a
controller, with a key ending in “\_html”, a `:default` key which contains
untrusted user input, and the resulting string is used in a view, may be
susceptible to an XSS vulnerability.

For example, impacted code will look something like this:

```
class ArticlesController < ApplicationController
  def show
    @message = t("message_html", default: untrusted_input)
    # The `show` template displays the contents of `@message`
  end
end

```

To reiterate the pre-conditions, applications must:

* Use a translation function from a controller (i.e. *not* I18n.t, or `t` from
  a view)
* Use a key that ends in `_html`
* Use a default value where the default value is untrusted and unescaped input
* Send the text to the victim (whether that’s part of a template, or a
  `render` call)

All users running an affected release should either upgrade or use one of the
workarounds immediately.

## Releases

The fixed releases are available at the normal locations.

## Workarounds

There are no feasible workarounds for this issue.

## Patches

To aid users who aren’t able to upgrade immediately we have provided patches for
the two supported release series. They are in git-am format and consist of a
single changeset.

* 7-0-translate-xss.patch - Patch for 7.0 series
* 7-1-translate-xss.patch - Patch for 7.1 series

## Credits

Thanks to [ooooooo\_q](https://hackerone.com/ooooooo_q) for the patch and fix!

[7-0-translate-xss.patch](/uploads/short-url/xR0UfuAFkM0JshURTBlFDhVNfnI.patch) (4.2 KB)
[7-1-translate-xss.patch](/uploads/short-url/mTeToHhEi4vif5S131OPALOWEyG.patch) (4.1 KB)

5 Likes

[jhawthorn](https://discuss.rubyonrails.org/u/jhawthorn)
(John Hawthorn)

February 21, 2024, 10:10pm

2

7.1.3.1 contained a small bug in not respecting raise\_on\_missing\_translations for controller translations. 7.1.3.2 has been released with a fix for the bug (and no other changes).

1 Like

[rafaelfranca](https://discuss.rubyonrails.org/u/rafaelfranca)
(Rafael França)

February 27, 2024, 1:30am

3

Amending to this CVE, all version below 7.0.0 aren’t vulnerable to this issue.

5 Likes

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [[CVE-2022-27777] Possible XSS Vulnerability in Action View tag helpers](https://discuss.rubyonrails.org/t/cve-2022-27777-possible-xss-vulnerability-in-action-view-tag-helpers/80534)  [Security Announcements](/c/security-announcements/9) | 0 | 13047 | April 26, 2022 |
| [[CVE-2023-22797] Possible Open Redirect Vulnerability in Action Pack](https://discuss.rubyonrails.org/t/cve-2023-22797-possible-open-redirect-vulnerability-in-action-pack/82120)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) ,  [security](https://discuss.rubyonrails.org/tag/security) ,  [actioncontroller](https://discuss.rubyonrails.org/tag/actioncontroller) | 0 | 5400 | January 17, 2023 |
| [[CVE-2021-22904] Possible DoS Vulnerability in Action Controller Token Authentication](https://discuss.rubyonrails.org/t/cve-2021-22904-possible-dos-vulnerability-in-action-controller-token-authentication/77869)  [Security Announcements](/c/security-announcements/9) | 0 | 11186 | May 5, 2021 |
| [[CVE-2022-22577] Possible XSS Vulnerability in Action Pack](https://discuss.rubyonrails.org/t/cve-2022-22577-possible-xss-vulnerability-in-action-pack/80533)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) | 0 | 11545 | April 26, 2022 |
| [Rails 3.0.11](https://discuss.rubyonrails.org/t/rails-3-0-11/61660)  [rubyonrails-core](/c/rubyonrails-core/5) [announcement](https://discuss.rubyonrails.org/tag/announcement) | 0 | 152 | November 18, 2011 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

