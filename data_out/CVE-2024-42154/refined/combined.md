=== Content from www.openwall.com_5609c3b4_20250111_021404.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[thread-next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID:
 <AM9P192MB131684EA6145690A492F481FD7682@AM9P192MB1316.EURP192.PROD.OUTLOOK.COM>
Date: Tue, 24 Sep 2024 09:12:46 +0000
From: Joel GUITTET <jguittet@...ekio.com>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
Subject: CVE-2024-42154: Linux kernel: tcp_metrics: validate source addr length

Hello security team!

I'm working on a medical product actually and have trouble about the CVE-2024-42154. It is regarding NETLINK socket which can be used only locally, but it is classified with "NETWORK" flag. NETWORK flag is annoying because it means more difficult to justify the CVE.

I already ask the NIST why the NETWOKR flag was set for this CVE, they answer me that it's linked to socket and without more public reference they are just setting the NETWORK flag, in case of.

Can I ask you your opinion about this CVE and the pertinence of the NETWORK flag here?

Thanks for any feedback,
Regard
Joel

Witekio France is an SAS company registered in Lyon. Registered office: 14 rue Rhin et Danube - 69009 Lyon. Registered company number: RCS 518 864 012 00035. VAT number FR 68 518 864 012
This message contains confidential information and is intended only for the individual(s) addressed in the message. If you aren't the named addressee, you should not disseminate, distribute, or copy this e-mail.

We continuously commit to comply with the applicable data protection laws and ensure fair and transparent processing of your personal data. Please read our privacy statement including an information notice and data protection policy for detailed information on our website.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from git.kernel.org_6a8e518c_20250111_021405.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=2a2e79dbe2236a1289412d2044994f7ab419b44c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2a2e79dbe2236a1289412d2044994f7ab419b44c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2a2e79dbe2236a1289412d2044994f7ab419b44c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2a2e79dbe2236a1289412d2044994f7ab419b44c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jakub Kicinski <kuba@kernel.org> | 2024-06-27 14:25:00 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-07-18 11:40:50 +0200 |
| commit | [2a2e79dbe2236a1289412d2044994f7ab419b44c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2a2e79dbe2236a1289412d2044994f7ab419b44c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=2a2e79dbe2236a1289412d2044994f7ab419b44c)) | |
| tree | [39a552f8cddb1abd00c7e0a0aaa3b58c9e0fd35a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2a2e79dbe2236a1289412d2044994f7ab419b44c) | |
| parent | [d8aef6be52529586b0b30010bdf3cd8e0d4054c4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d8aef6be52529586b0b30010bdf3cd8e0d4054c4) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2a2e79dbe2236a1289412d2044994f7ab419b44c&id2=d8aef6be52529586b0b30010bdf3cd8e0d4054c4)) | |
| download | [linux-2a2e79dbe2236a1289412d2044994f7ab419b44c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-2a2e79dbe2236a1289412d2044994f7ab419b44c.tar.gz) | |

tcp\_metrics: validate source addr length[ Upstream commit 66be40e622e177316ae81717aa30057ba9e61dff ]
I don't see anything checking that TCP\_METRICS\_ATTR\_SADDR\_IPV4
is at least 4 bytes long, and the policy doesn't have an entry
for this attribute at all (neither does it for IPv6 but v6 is
manually validated).
Reviewed-by: Eric Dumazet <edumazet@google.com>
Fixes: 3e7013ddf55a ("tcp: metrics: Allow selective get/del of tcp-metrics based on src IP")
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2a2e79dbe2236a1289412d2044994f7ab419b44c)

| -rw-r--r-- | [net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv4/tcp_metrics.c?id=2a2e79dbe2236a1289412d2044994f7ab419b44c) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/ipv4/tcp\_metrics.c b/net/ipv4/tcp\_metrics.cindex 627e3be0f754bb..f6483d6401fb41 100644--- a/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=d8aef6be52529586b0b30010bdf3cd8e0d4054c4)+++ b/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=2a2e79dbe2236a1289412d2044994f7ab419b44c)@@ -614,6 +614,7 @@ static const struct nla\_policy tcp\_metrics\_nl\_policy[TCP\_METRICS\_ATTR\_MAX + 1] = [TCP\_METRICS\_ATTR\_ADDR\_IPV4] = { .type = NLA\_U32, }, [TCP\_METRICS\_ATTR\_ADDR\_IPV6] = { .type = NLA\_BINARY, .len = sizeof(struct in6\_addr), },+ [TCP\_METRICS\_ATTR\_SADDR\_IPV4] = { .type = NLA\_U32, }, /\* Following attributes are not received for GET/DEL, \* we keep them for reference \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:12:43 +0000



=== Content from git.kernel.org_56210300_20250111_021408.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=cdffc358717e436bb67122bb82c1a2a26e050f98)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cdffc358717e436bb67122bb82c1a2a26e050f98)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cdffc358717e436bb67122bb82c1a2a26e050f98)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cdffc358717e436bb67122bb82c1a2a26e050f98)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jakub Kicinski <kuba@kernel.org> | 2024-06-27 14:25:00 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-07-18 13:05:41 +0200 |
| commit | [cdffc358717e436bb67122bb82c1a2a26e050f98](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cdffc358717e436bb67122bb82c1a2a26e050f98) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=cdffc358717e436bb67122bb82c1a2a26e050f98)) | |
| tree | [f8329cab71317e83aff044c32ac085a0fc621063](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cdffc358717e436bb67122bb82c1a2a26e050f98) | |
| parent | [febed740a31de7f515b66548fad11dc9681fe120](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=febed740a31de7f515b66548fad11dc9681fe120) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cdffc358717e436bb67122bb82c1a2a26e050f98&id2=febed740a31de7f515b66548fad11dc9681fe120)) | |
| download | [linux-cdffc358717e436bb67122bb82c1a2a26e050f98.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-cdffc358717e436bb67122bb82c1a2a26e050f98.tar.gz) | |

tcp\_metrics: validate source addr length[ Upstream commit 66be40e622e177316ae81717aa30057ba9e61dff ]
I don't see anything checking that TCP\_METRICS\_ATTR\_SADDR\_IPV4
is at least 4 bytes long, and the policy doesn't have an entry
for this attribute at all (neither does it for IPv6 but v6 is
manually validated).
Reviewed-by: Eric Dumazet <edumazet@google.com>
Fixes: 3e7013ddf55a ("tcp: metrics: Allow selective get/del of tcp-metrics based on src IP")
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cdffc358717e436bb67122bb82c1a2a26e050f98)

| -rw-r--r-- | [net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv4/tcp_metrics.c?id=cdffc358717e436bb67122bb82c1a2a26e050f98) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/ipv4/tcp\_metrics.c b/net/ipv4/tcp\_metrics.cindex f823a15b973c41..95b5ac082a2f4e 100644--- a/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=febed740a31de7f515b66548fad11dc9681fe120)+++ b/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=cdffc358717e436bb67122bb82c1a2a26e050f98)@@ -619,6 +619,7 @@ static const struct nla\_policy tcp\_metrics\_nl\_policy[TCP\_METRICS\_ATTR\_MAX + 1] = [TCP\_METRICS\_ATTR\_ADDR\_IPV4] = { .type = NLA\_U32, }, [TCP\_METRICS\_ATTR\_ADDR\_IPV6] = { .type = NLA\_BINARY, .len = sizeof(struct in6\_addr), },+ [TCP\_METRICS\_ATTR\_SADDR\_IPV4] = { .type = NLA\_U32, }, /\* Following attributes are not received for GET/DEL, \* we keep them for reference \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:12:46 +0000



=== Content from git.kernel.org_c357397e_20250111_021405.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=19d997b59fa1fd7a02e770ee0881c0652b9c32c9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=19d997b59fa1fd7a02e770ee0881c0652b9c32c9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=19d997b59fa1fd7a02e770ee0881c0652b9c32c9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=19d997b59fa1fd7a02e770ee0881c0652b9c32c9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jakub Kicinski <kuba@kernel.org> | 2024-06-27 14:25:00 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-07-18 11:39:34 +0200 |
| commit | [19d997b59fa1fd7a02e770ee0881c0652b9c32c9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=19d997b59fa1fd7a02e770ee0881c0652b9c32c9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=19d997b59fa1fd7a02e770ee0881c0652b9c32c9)) | |
| tree | [ce5396eb7711d3b520562e85ba40700866d32e3c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=19d997b59fa1fd7a02e770ee0881c0652b9c32c9) | |
| parent | [8b5fd51b3040ce2596d22a72767c66d7435853b6](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8b5fd51b3040ce2596d22a72767c66d7435853b6) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=19d997b59fa1fd7a02e770ee0881c0652b9c32c9&id2=8b5fd51b3040ce2596d22a72767c66d7435853b6)) | |
| download | [linux-19d997b59fa1fd7a02e770ee0881c0652b9c32c9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-19d997b59fa1fd7a02e770ee0881c0652b9c32c9.tar.gz) | |

tcp\_metrics: validate source addr length[ Upstream commit 66be40e622e177316ae81717aa30057ba9e61dff ]
I don't see anything checking that TCP\_METRICS\_ATTR\_SADDR\_IPV4
is at least 4 bytes long, and the policy doesn't have an entry
for this attribute at all (neither does it for IPv6 but v6 is
manually validated).
Reviewed-by: Eric Dumazet <edumazet@google.com>
Fixes: 3e7013ddf55a ("tcp: metrics: Allow selective get/del of tcp-metrics based on src IP")
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=19d997b59fa1fd7a02e770ee0881c0652b9c32c9)

| -rw-r--r-- | [net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv4/tcp_metrics.c?id=19d997b59fa1fd7a02e770ee0881c0652b9c32c9) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/ipv4/tcp\_metrics.c b/net/ipv4/tcp\_metrics.cindex 60619b1f4acdc9..1bfbb8f8e0b7c8 100644--- a/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=8b5fd51b3040ce2596d22a72767c66d7435853b6)+++ b/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=19d997b59fa1fd7a02e770ee0881c0652b9c32c9)@@ -624,6 +624,7 @@ static const struct nla\_policy tcp\_metrics\_nl\_policy[TCP\_METRICS\_ATTR\_MAX + 1] = [TCP\_METRICS\_ATTR\_ADDR\_IPV4] = { .type = NLA\_U32, }, [TCP\_METRICS\_ATTR\_ADDR\_IPV6] = { .type = NLA\_BINARY, .len = sizeof(struct in6\_addr), },+ [TCP\_METRICS\_ATTR\_SADDR\_IPV4] = { .type = NLA\_U32, }, /\* Following attributes are not received for GET/DEL, \* we keep them for reference \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:12:42 +0000



=== Content from www.openwall.com_91c9e757_20250111_021404.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](../../../2024/09/25/1) [[<thread-prev]](3) [[thread-next>]](../../../2024/09/25/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20240924153652.GA26720@openwall.com>
Date: Tue, 24 Sep 2024 17:36:52 +0200
From: Solar Designer <solar@...nwall.com>
To: Joel GUITTET <jguittet@...ekio.com>
Cc: oss-security@...ts.openwall.com
Subject: Re: CVE-2024-42154: Linux kernel: tcp_metrics: validate source addr length

Hi Joel,

When you bring issues to this list, please include in the Subject and
start your messages with information on the issue itself - at least the
affected project and vulnerability type when applicable.  As a
moderator, I've edited the Subject line to contain such information.

On Tue, Sep 24, 2024 at 09:12:46AM +0000, Joel GUITTET wrote:
> I'm working on a medical product actually and have trouble about the CVE-2024-42154. It is regarding NETLINK socket which can be used only locally, but it is classified with "NETWORK" flag. NETWORK flag is annoying because it means more difficult to justify the CVE.
>
> I already ask the NIST why the NETWOKR flag was set for this CVE, they answer me that it's linked to socket and without more public reference they are just setting the NETWORK flag, in case of.
>
> Can I ask you your opinion about this CVE and the pertinence of the NETWORK flag here?

I didn't fully analyze this issue, but at a glance:

1. NIST NVD commonly inflates CVSS scores.  You could reasonably dispute
their CVSS vector and they may correct it and the score:

<https://nvd.nist.gov/vuln/detail/CVE-2024-42154>

Base Score:  9.8 CRITICAL
Vector:  CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

2. There are other sources for CVSS vectors/scores, notably Red Hat:

<https://access.redhat.com/security/cve/CVE-2024-42154>

CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N

leading to a score of 2.5.  Indeed, they treat this issue as local, not
network, which is probably correct, although some other components of
this CVSS vector look weird to me.

You could use Red Hat as your source of severity scores.

3. The CVE description originates from Linux kernel CNA, which in turn
reuses the commit message:

<https://lists.openwall.net/linux-cve-announce/2024/07/30/76>

> tcp_metrics: validate source addr length
>
> I don't see anything checking that TCP_METRICS_ATTR_SADDR_IPV4
> is at least 4 bytes long, and the policy doesn't have an entry
> for this attribute at all (neither does it for IPv6 but v6 is
> manually validated).

The code change is:

+++ b/net/ipv4/tcp_metrics.c
@@ -624,6 +624,7 @@ static const struct nla_policy tcp_metrics_nl_policy[TCP_METRICS_ATTR_MAX + 1] =
 	[TCP_METRICS_ATTR_ADDR_IPV4]	= { .type = NLA_U32, },
 	[TCP_METRICS_ATTR_ADDR_IPV6]	= { .type = NLA_BINARY,
 					    .len = sizeof(struct in6_addr), },
+	[TCP_METRICS_ATTR_SADDR_IPV4]	= { .type = NLA_U32, },
 	/* Following attributes are not received for GET/DEL,
 	 * we keep them for reference
 	 */

It would require more context to review and to assess the bug's impact,
but my _guess_ is it may have been merely over-read potential, so local
infoleak maybe?  Besides code review, it could make sense to locate the
corresponding syzbot report, if one exists, and see what type of crash
it was - if it was.

Somehow Red Hat's description lists possibilities worse than over-read,
so either my guess is wrong or they didn't analyze the issue to identify
specific impact:

> A vulnerability was found in the Linux kernel's tcp_metrics subsystem,
> where insufficient validation of the length of the source address for
> TCP metrics could lead to buffer overflows, memory corruption, or
> crashes.

I hope this helps.

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from git.kernel.org_c1439b8f_20250111_021408.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8c2debdd170e395934ac0e039748576dfde14e99)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8c2debdd170e395934ac0e039748576dfde14e99)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8c2debdd170e395934ac0e039748576dfde14e99)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8c2debdd170e395934ac0e039748576dfde14e99)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jakub Kicinski <kuba@kernel.org> | 2024-06-27 14:25:00 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-07-11 12:49:12 +0200 |
| commit | [8c2debdd170e395934ac0e039748576dfde14e99](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8c2debdd170e395934ac0e039748576dfde14e99) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8c2debdd170e395934ac0e039748576dfde14e99)) | |
| tree | [d036809f7e9e506cadd1285616a436be76db42a4](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8c2debdd170e395934ac0e039748576dfde14e99) | |
| parent | [4970e48f83dbd21d2a6a7cdaaafc2a71f7f45dc4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4970e48f83dbd21d2a6a7cdaaafc2a71f7f45dc4) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8c2debdd170e395934ac0e039748576dfde14e99&id2=4970e48f83dbd21d2a6a7cdaaafc2a71f7f45dc4)) | |
| download | [linux-8c2debdd170e395934ac0e039748576dfde14e99.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8c2debdd170e395934ac0e039748576dfde14e99.tar.gz) | |

tcp\_metrics: validate source addr length[ Upstream commit 66be40e622e177316ae81717aa30057ba9e61dff ]
I don't see anything checking that TCP\_METRICS\_ATTR\_SADDR\_IPV4
is at least 4 bytes long, and the policy doesn't have an entry
for this attribute at all (neither does it for IPv6 but v6 is
manually validated).
Reviewed-by: Eric Dumazet <edumazet@google.com>
Fixes: 3e7013ddf55a ("tcp: metrics: Allow selective get/del of tcp-metrics based on src IP")
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8c2debdd170e395934ac0e039748576dfde14e99)

| -rw-r--r-- | [net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv4/tcp_metrics.c?id=8c2debdd170e395934ac0e039748576dfde14e99) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/ipv4/tcp\_metrics.c b/net/ipv4/tcp\_metrics.cindex 7aca12c59c1848..b71f94a5932ac0 100644--- a/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=4970e48f83dbd21d2a6a7cdaaafc2a71f7f45dc4)+++ b/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=8c2debdd170e395934ac0e039748576dfde14e99)@@ -619,6 +619,7 @@ static const struct nla\_policy tcp\_metrics\_nl\_policy[TCP\_METRICS\_ATTR\_MAX + 1] = [TCP\_METRICS\_ATTR\_ADDR\_IPV4] = { .type = NLA\_U32, }, [TCP\_METRICS\_ATTR\_ADDR\_IPV6] = { .type = NLA\_BINARY, .len = sizeof(struct in6\_addr), },+ [TCP\_METRICS\_ATTR\_SADDR\_IPV4] = { .type = NLA\_U32, }, /\* Following attributes are not received for GET/DEL, \* we keep them for reference \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:12:45 +0000



=== Content from git.kernel.org_44148c69_20250111_021409.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ef7c428b425beeb52b894e16f1c4b629d6cebfb6)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ef7c428b425beeb52b894e16f1c4b629d6cebfb6)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ef7c428b425beeb52b894e16f1c4b629d6cebfb6)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ef7c428b425beeb52b894e16f1c4b629d6cebfb6)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jakub Kicinski <kuba@kernel.org> | 2024-06-27 14:25:00 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-07-18 13:07:30 +0200 |
| commit | [ef7c428b425beeb52b894e16f1c4b629d6cebfb6](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ef7c428b425beeb52b894e16f1c4b629d6cebfb6) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ef7c428b425beeb52b894e16f1c4b629d6cebfb6)) | |
| tree | [2d9aa0d7069e9e3f2caf646a170bd175fb699cc8](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ef7c428b425beeb52b894e16f1c4b629d6cebfb6) | |
| parent | [b340526c9ef3b2ff1d7117a93cd7187c9ff72065](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b340526c9ef3b2ff1d7117a93cd7187c9ff72065) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ef7c428b425beeb52b894e16f1c4b629d6cebfb6&id2=b340526c9ef3b2ff1d7117a93cd7187c9ff72065)) | |
| download | [linux-ef7c428b425beeb52b894e16f1c4b629d6cebfb6.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ef7c428b425beeb52b894e16f1c4b629d6cebfb6.tar.gz) | |

tcp\_metrics: validate source addr length[ Upstream commit 66be40e622e177316ae81717aa30057ba9e61dff ]
I don't see anything checking that TCP\_METRICS\_ATTR\_SADDR\_IPV4
is at least 4 bytes long, and the policy doesn't have an entry
for this attribute at all (neither does it for IPv6 but v6 is
manually validated).
Reviewed-by: Eric Dumazet <edumazet@google.com>
Fixes: 3e7013ddf55a ("tcp: metrics: Allow selective get/del of tcp-metrics based on src IP")
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ef7c428b425beeb52b894e16f1c4b629d6cebfb6)

| -rw-r--r-- | [net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv4/tcp_metrics.c?id=ef7c428b425beeb52b894e16f1c4b629d6cebfb6) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/ipv4/tcp\_metrics.c b/net/ipv4/tcp\_metrics.cindex def337f72c860a..f17635ac7d829c 100644--- a/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=b340526c9ef3b2ff1d7117a93cd7187c9ff72065)+++ b/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=ef7c428b425beeb52b894e16f1c4b629d6cebfb6)@@ -619,6 +619,7 @@ static const struct nla\_policy tcp\_metrics\_nl\_policy[TCP\_METRICS\_ATTR\_MAX + 1] = [TCP\_METRICS\_ATTR\_ADDR\_IPV4] = { .type = NLA\_U32, }, [TCP\_METRICS\_ATTR\_ADDR\_IPV6] = { .type = NLA\_BINARY, .len = sizeof(struct in6\_addr), },+ [TCP\_METRICS\_ATTR\_SADDR\_IPV4] = { .type = NLA\_U32, }, /\* Following attributes are not received for GET/DEL, \* we keep them for reference \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:12:46 +0000



=== Content from git.kernel.org_1e8a4ef1_20250111_021406.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=31f03bb04146c1c6df6c03e9f45401f5f5a985d3)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=31f03bb04146c1c6df6c03e9f45401f5f5a985d3)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=31f03bb04146c1c6df6c03e9f45401f5f5a985d3)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=31f03bb04146c1c6df6c03e9f45401f5f5a985d3)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jakub Kicinski <kuba@kernel.org> | 2024-06-27 14:25:00 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-07-11 12:47:11 +0200 |
| commit | [31f03bb04146c1c6df6c03e9f45401f5f5a985d3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=31f03bb04146c1c6df6c03e9f45401f5f5a985d3) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=31f03bb04146c1c6df6c03e9f45401f5f5a985d3)) | |
| tree | [67aee49f98e3768d835d204f96284221d4ab109d](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=31f03bb04146c1c6df6c03e9f45401f5f5a985d3) | |
| parent | [f8b7bd500d89a401167d85dbe78882fbabc7d2ad](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f8b7bd500d89a401167d85dbe78882fbabc7d2ad) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=31f03bb04146c1c6df6c03e9f45401f5f5a985d3&id2=f8b7bd500d89a401167d85dbe78882fbabc7d2ad)) | |
| download | [linux-31f03bb04146c1c6df6c03e9f45401f5f5a985d3.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-31f03bb04146c1c6df6c03e9f45401f5f5a985d3.tar.gz) | |

tcp\_metrics: validate source addr length[ Upstream commit 66be40e622e177316ae81717aa30057ba9e61dff ]
I don't see anything checking that TCP\_METRICS\_ATTR\_SADDR\_IPV4
is at least 4 bytes long, and the policy doesn't have an entry
for this attribute at all (neither does it for IPv6 but v6 is
manually validated).
Reviewed-by: Eric Dumazet <edumazet@google.com>
Fixes: 3e7013ddf55a ("tcp: metrics: Allow selective get/del of tcp-metrics based on src IP")
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=31f03bb04146c1c6df6c03e9f45401f5f5a985d3)

| -rw-r--r-- | [net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv4/tcp_metrics.c?id=31f03bb04146c1c6df6c03e9f45401f5f5a985d3) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/ipv4/tcp\_metrics.c b/net/ipv4/tcp\_metrics.cindex a7364ff8b558d9..a4e03a7a2c030f 100644--- a/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=f8b7bd500d89a401167d85dbe78882fbabc7d2ad)+++ b/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=31f03bb04146c1c6df6c03e9f45401f5f5a985d3)@@ -619,6 +619,7 @@ static const struct nla\_policy tcp\_metrics\_nl\_policy[TCP\_METRICS\_ATTR\_MAX + 1] = [TCP\_METRICS\_ATTR\_ADDR\_IPV4] = { .type = NLA\_U32, }, [TCP\_METRICS\_ATTR\_ADDR\_IPV6] = { .type = NLA\_BINARY, .len = sizeof(struct in6\_addr), },+ [TCP\_METRICS\_ATTR\_SADDR\_IPV4] = { .type = NLA\_U32, }, /\* Following attributes are not received for GET/DEL, \* we keep them for reference \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:12:43 +0000



=== Content from git.kernel.org_fae1ef3f_20250111_021407.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=66be40e622e177316ae81717aa30057ba9e61dff)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=66be40e622e177316ae81717aa30057ba9e61dff)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=66be40e622e177316ae81717aa30057ba9e61dff)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=66be40e622e177316ae81717aa30057ba9e61dff)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jakub Kicinski <kuba@kernel.org> | 2024-06-27 14:25:00 -0700 |
| --- | --- | --- |
| committer | David S. Miller <davem@davemloft.net> | 2024-07-01 09:40:36 +0100 |
| commit | [66be40e622e177316ae81717aa30057ba9e61dff](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=66be40e622e177316ae81717aa30057ba9e61dff) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=66be40e622e177316ae81717aa30057ba9e61dff)) | |
| tree | [0c19a8b90b55ff90c0b5ddedea3372acc7176e17](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=66be40e622e177316ae81717aa30057ba9e61dff) | |
| parent | [134061163ee5ca4759de5c24ca3bd71608891ba7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=134061163ee5ca4759de5c24ca3bd71608891ba7) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=66be40e622e177316ae81717aa30057ba9e61dff&id2=134061163ee5ca4759de5c24ca3bd71608891ba7)) | |
| download | [linux-66be40e622e177316ae81717aa30057ba9e61dff.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-66be40e622e177316ae81717aa30057ba9e61dff.tar.gz) | |

tcp\_metrics: validate source addr lengthI don't see anything checking that TCP\_METRICS\_ATTR\_SADDR\_IPV4
is at least 4 bytes long, and the policy doesn't have an entry
for this attribute at all (neither does it for IPv6 but v6 is
manually validated).
Reviewed-by: Eric Dumazet <edumazet@google.com>
Fixes: 3e7013ddf55a ("tcp: metrics: Allow selective get/del of tcp-metrics based on src IP")
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: David S. Miller <davem@davemloft.net>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=66be40e622e177316ae81717aa30057ba9e61dff)

| -rw-r--r-- | [net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv4/tcp_metrics.c?id=66be40e622e177316ae81717aa30057ba9e61dff) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/ipv4/tcp\_metrics.c b/net/ipv4/tcp\_metrics.cindex e93df98de3f454..b01eb6d9441393 100644--- a/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=134061163ee5ca4759de5c24ca3bd71608891ba7)+++ b/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=66be40e622e177316ae81717aa30057ba9e61dff)@@ -619,6 +619,7 @@ static const struct nla\_policy tcp\_metrics\_nl\_policy[TCP\_METRICS\_ATTR\_MAX + 1] = [TCP\_METRICS\_ATTR\_ADDR\_IPV4] = { .type = NLA\_U32, }, [TCP\_METRICS\_ATTR\_ADDR\_IPV6] = { .type = NLA\_BINARY, .len = sizeof(struct in6\_addr), },+ [TCP\_METRICS\_ATTR\_SADDR\_IPV4] = { .type = NLA\_U32, }, /\* Following attributes are not received for GET/DEL, \* we keep them for reference \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:12:44 +0000



=== Content from git.kernel.org_5b375d12_20250111_021407.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3d550dd5418729a6e77fe7721d27adea7152e321)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3d550dd5418729a6e77fe7721d27adea7152e321)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3d550dd5418729a6e77fe7721d27adea7152e321)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3d550dd5418729a6e77fe7721d27adea7152e321)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jakub Kicinski <kuba@kernel.org> | 2024-06-27 14:25:00 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-07-11 12:51:09 +0200 |
| commit | [3d550dd5418729a6e77fe7721d27adea7152e321](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3d550dd5418729a6e77fe7721d27adea7152e321) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3d550dd5418729a6e77fe7721d27adea7152e321)) | |
| tree | [c5f61fe010ca6368ad26584a069de1af08d0e045](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3d550dd5418729a6e77fe7721d27adea7152e321) | |
| parent | [d311036696fed778301d08a71a4bef737b86d8c5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d311036696fed778301d08a71a4bef737b86d8c5) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3d550dd5418729a6e77fe7721d27adea7152e321&id2=d311036696fed778301d08a71a4bef737b86d8c5)) | |
| download | [linux-3d550dd5418729a6e77fe7721d27adea7152e321.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3d550dd5418729a6e77fe7721d27adea7152e321.tar.gz) | |

tcp\_metrics: validate source addr length[ Upstream commit 66be40e622e177316ae81717aa30057ba9e61dff ]
I don't see anything checking that TCP\_METRICS\_ATTR\_SADDR\_IPV4
is at least 4 bytes long, and the policy doesn't have an entry
for this attribute at all (neither does it for IPv6 but v6 is
manually validated).
Reviewed-by: Eric Dumazet <edumazet@google.com>
Fixes: 3e7013ddf55a ("tcp: metrics: Allow selective get/del of tcp-metrics based on src IP")
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3d550dd5418729a6e77fe7721d27adea7152e321)

| -rw-r--r-- | [net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv4/tcp_metrics.c?id=3d550dd5418729a6e77fe7721d27adea7152e321) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/ipv4/tcp\_metrics.c b/net/ipv4/tcp\_metrics.cindex c2a925538542b5..e0883ba709b0bf 100644--- a/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=d311036696fed778301d08a71a4bef737b86d8c5)+++ b/[net/ipv4/tcp\_metrics.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv4/tcp_metrics.c?id=3d550dd5418729a6e77fe7721d27adea7152e321)@@ -619,6 +619,7 @@ static const struct nla\_policy tcp\_metrics\_nl\_policy[TCP\_METRICS\_ATTR\_MAX + 1] = [TCP\_METRICS\_ATTR\_ADDR\_IPV4] = { .type = NLA\_U32, }, [TCP\_METRICS\_ATTR\_ADDR\_IPV6] = { .type = NLA\_BINARY, .len = sizeof(struct in6\_addr), },+ [TCP\_METRICS\_ATTR\_SADDR\_IPV4] = { .type = NLA\_U32, }, /\* Following attributes are not received for GET/DEL, \* we keep them for reference \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:12:44 +0000



=== Content from security.netapp.com_0ccee9a0_20250111_021410.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2024-42154 Linux Kernel Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20240828-0010)

## CVE-2024-42154 Linux Kernel Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20240828-0010 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20240828-0010 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20240828-0010 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20240828-0010 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20240828-0010
**Version:**
10.0

**Last updated:**
11/11/2024

**Status:**
Interim.

**CVEs:** CVE-2024-42154

Overview
#### Summary

Multiple NetApp products incorporate Linux kernel. Certain versions of Linux kernel are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2024-42154](https://nvd.nist.gov/vuln/detail/CVE-2024-42154) | 4.4 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

Affected Products
#### Affected Products

* AFF Baseboard Management Controller (BMC) - A700s
* Active IQ Unified Manager for VMware vSphere
* E-Series SANtricity OS Controller Software 11.x
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 9

#### Products Under Investigation

* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)

#### Products Not Affected

* AFF BIOS - A1K/A70/A90
* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A1K/A70/A90
* AFF LOADER- A1K/A70/A90
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Volumes ONTAP Mediator
* Data Infrastructure Insights Acquisition Unit (formerly Cloud Insights Acquisition Unit)
* Data Infrastructure Insights Storage Workload Security Agent (formerly Cloud Insights Storage Workload Security Agent)
* Data Infrastructure Insights Telegraf Agent (formerly Cloud Insights Telegraf Agent)
* E-Series BIOS
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp DataOps Toolkit
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP tools for VMware vSphere 10
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG5812/SG5860
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* StorageGRID Baseboard Management Controller (BMC) SG5812/SG5860
* System Manager 9.x
* Terraform Provider for ONTAP
* Workload Factory for VMware

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **E-Series SANtricity OS Controller Software 11.x** | <https://mysupport.netapp.com/site/products/all/details/eseries-santricityos/downloads-tab/download/62735/11.80.1R2> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20240828-0010>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20240828 | Initial Public Release |
| 2.0 | 20240830 | ONTAP tools for VMware vSphere 10 moved to Products Not Affected, FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400 moved to Affected Products |
| 3.0 | 20240912 | Cloud Volumes ONTAP Mediator moved to Products Not Affected, Active IQ Unified Manager for VMware vSphere, NetApp HCI Baseboard Management Controller (BMC) - H610C, NetApp HCI Baseboard Management Controller (BMC) - H610S and NetApp HCI Baseboard Management Controller (BMC) - H615C moved to Affected Products |
| 4.0 | 20240920 | E-Series SANtricity OS Controller Software 11.x added to Software Versions and Fixes |
| 5.0 | 20240925 | FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250 moved to Affected Products |
| 6.0 | 20241014 | ONTAP Select Deploy administration utility moved to Affected Products |
| 7.0 | 20241016 | CVSS Score changed to align to NVD |
| 8.0 | 20241022 | SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine moved to Products Not Affected |
| 9.0 | 20241024 | AFF Baseboard Management Controller (BMC) - A700s moved to Affected Products |
| 10.0 | 20241111 | Brocade Fabric Operating System Firmware moved to Products Not Affected |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from www.openwall.com_17505230_20250111_021404.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](../../../2024/09/24/4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAJ33NAVY_jKsLqGZpuWTXUFTAkkg60qH2hd3uhVmyaDGX7P2cg@mail.gmail.com>
Date: Wed, 25 Sep 2024 14:31:19 +0530
From: Sandipan Roy <saroy@...hat.com>
To: oss-security@...ts.openwall.com
Cc: Joel GUITTET <jguittet@...ekio.com>
Subject: Re: CVE-2024-42154: Linux kernel: tcp_metrics:
 validate source addr length

Hello Alexander and Joel,

Thank you for your quick review.

Regarding the CVE, Red Hat is still in the analysis phase. Our assessment
is based on our own kernel build, which may differ from the default
configuration upstream.

According to our latest analysis, the CVSS score is 4.4:

CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N

The impact level is considered moderate for Red Hat due to the following
reasons:

1. Missed check existed before and worked correctly (because by default it
worked for int32 value, even if it was not specified exactly).

2. Even if for some specific case a fail could happen, still it can lead
only to incorrect memory read.

3. Even if memory corruption happens, it should not lead to anything apart
from incorrect tcp-ip statistics output to the local user.

Additionally, It can lead to incorrect statistics output for commands like
"ip tcp_metrics show", but actually no security impact (or very low
security impact).

Thanks
Sandipan Roy

On Tue, Sep 24, 2024 at 9:10 PM Solar Designer <solar@...nwall.com> wrote:

> Hi Joel,
>
> When you bring issues to this list, please include in the Subject and
> start your messages with information on the issue itself - at least the
> affected project and vulnerability type when applicable.  As a
> moderator, I've edited the Subject line to contain such information.
>
> On Tue, Sep 24, 2024 at 09:12:46AM +0000, Joel GUITTET wrote:
> > I'm working on a medical product actually and have trouble about the
> CVE-2024-42154. It is regarding NETLINK socket which can be used only
> locally, but it is classified with "NETWORK" flag. NETWORK flag is annoying
> because it means more difficult to justify the CVE.
> >
> > I already ask the NIST why the NETWOKR flag was set for this CVE, they
> answer me that it's linked to socket and without more public reference they
> are just setting the NETWORK flag, in case of.
> >
> > Can I ask you your opinion about this CVE and the pertinence of the
> NETWORK flag here?
>
> I didn't fully analyze this issue, but at a glance:
>
> 1. NIST NVD commonly inflates CVSS scores.  You could reasonably dispute
> their CVSS vector and they may correct it and the score:
>
> <https://nvd.nist.gov/vuln/detail/CVE-2024-42154>
>
> Base Score:  9.8 CRITICAL
> Vector:  CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
>
> 2. There are other sources for CVSS vectors/scores, notably Red Hat:
>
> <https://access.redhat.com/security/cve/CVE-2024-42154>
>
> CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N
>
> leading to a score of 2.5.  Indeed, they treat this issue as local, not
> network, which is probably correct, although some other components of
> this CVSS vector look weird to me.
>
> You could use Red Hat as your source of severity scores.
>
> 3. The CVE description originates from Linux kernel CNA, which in turn
> reuses the commit message:
>
> <https://lists.openwall.net/linux-cve-announce/2024/07/30/76>
>
> > tcp_metrics: validate source addr length
> >
> > I don't see anything checking that TCP_METRICS_ATTR_SADDR_IPV4
> > is at least 4 bytes long, and the policy doesn't have an entry
> > for this attribute at all (neither does it for IPv6 but v6 is
> > manually validated).
>
> The code change is:
>
> +++ b/net/ipv4/tcp_metrics.c
> @@ -624,6 +624,7 @@ static const struct nla_policy
> tcp_metrics_nl_policy[TCP_METRICS_ATTR_MAX + 1] =
>         [TCP_METRICS_ATTR_ADDR_IPV4]    = { .type = NLA_U32, },
>         [TCP_METRICS_ATTR_ADDR_IPV6]    = { .type = NLA_BINARY,
>                                             .len = sizeof(struct
> in6_addr), },
> +       [TCP_METRICS_ATTR_SADDR_IPV4]   = { .type = NLA_U32, },
>         /* Following attributes are not received for GET/DEL,
>          * we keep them for reference
>          */
>
> It would require more context to review and to assess the bug's impact,
> but my _guess_ is it may have been merely over-read potential, so local
> infoleak maybe?  Besides code review, it could make sense to locate the
> corresponding syzbot report, if one exists, and see what type of crash
> it was - if it was.
>
> Somehow Red Hat's description lists possibilities worse than over-read,
> so either my guess is wrong or they didn't analyze the issue to identify
> specific impact:
>
> > A vulnerability was found in the Linux kernel's tcp_metrics subsystem,
> > where insufficient validation of the length of the source address for
> > TCP metrics could lead to buffer overflows, memory corruption, or
> > crashes.
>
> I hope this helps.
>
> Alexander
>
>

--
*Sandipan Roy*

Product Security Engineer, Product Security

Secure Engineering - Incident Response

Email: sandipan@...hat.com

PGP:0x4B5C7470051BB332 <<https://bytehackr.fedorapeople.org/saroy.asc>>

*secalert@...hat.com <secalert@...hat.com>* For Urgent Response.
<<https://www.redhat.com/>>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


