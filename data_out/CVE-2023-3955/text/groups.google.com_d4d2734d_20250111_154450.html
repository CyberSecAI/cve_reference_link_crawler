[![](https://fonts.gstatic.com/s/i/productlogos/groups/v9/web-48dp/logo_groups_color_1x_web_48dp.png)Groups](./my-groups "Groups")ConversationsAll groups and messagesSend feedback to GoogleHelpTraining[Sign in](https://accounts.google.com/ServiceLogin?hl=en&passive=true&continue=https://groups.google.com&ec=GAZA0AM)[Groups](./my-groups "Groups")
## kubernetes-security-announce

[Conversations](./g/kubernetes-security-announce)[About](./g/kubernetes-security-announce/about)[Privacy](https://policies.google.com/privacy?hl=en_US) • [Terms](https://policies.google.com/terms?hl=en_US)

Groups keyboard shortcuts have been updatedDismissSee shortcuts
# [Security Advisory] CVE-2023-3955: Insufficient input sanitization on Windows nodes leads to privilege escalation

 672 viewsSkip to first unread message![Rita Zhang's profile photo](//lh3.googleusercontent.com/a-/ALV-UjVGGt2bB6zBF3hBIZyX4VSQKVlgsVlvzPAzJltjlH02UPzrH1cn=s40-c)
### Rita Zhang

unread,Aug 23, 2023, 3:27:38 PM8/23/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto kubernetes-announce, dev, kubernetes-sec...@googlegroups.com, kubernetes-security-discuss, distributo...@kubernetes.io

Hello Kubernetes Community,

A security issue was discovered in Kubernetes where a user that can create pods on Windows nodes may be able to escalate to admin privileges on those nodes. Kubernetes clusters are only affected if they include Windows nodes.

This issue has been rated \*\***HIGH**\*\* ([CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H) [- 8.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)), and assigned \*\*CVE-2023-3955\*\*

**Am I vulnerable?**

Any kubernetes environment with Windows nodes is impacted.  Run `kubectl get nodes -l [kubernetes.io/os=windows`](http://kubernetes.io/os%3Dwindows) to see if any Windows nodes are in use.

**Affected Versions**

- kubelet <= v1.28.0

- kubelet <= v1.27.4

- kubelet <= v1.26.7

- kubelet <= v1.25.12

- kubelet <= v1.24.16

**How do I mitigate this vulnerability?**

The provided patch fully mitigates the vulnerability (see fix impact below).  Full mitigation for this class of issues requires patches applied for CVE-2023-3676, CVE-2023-3955, and CVE-2023-3893.

Outside of applying the patch, there are no known mitigations to this vulnerability.

**Fixed Versions**

- kubelet v1.28.1

- kubelet v1.27.5

- kubelet v1.26.8

- kubelet v1.25.13

- kubelet v1.24.17

These releases will be published over the course of today, August 23rd, 2023.

**\*\*Fix impact:\*\*** Passing Windows Powershell disk format options to in-tree volume plugins will result in an error during volume provisioning on the node.  There are no known use cases for this functionality, nor is this functionality supported by any known out-of-tree CSI driver.

To upgrade, refer to the documentation:

<https://kubernetes.io/docs/tasks/administer-cluster/cluster-management/#upgrading-a-cluster>

**Detection**

Kubernetes audit logs can be used to detect if this vulnerability is being exploited. Pod create events with embedded powershell commands are a strong indication of exploitation.

If you find evidence that this vulnerability has been exploited, please contact secu...@kubernetes.io

**Additional Details**

See the GitHub issue for more details: <https://github.com/kubernetes/kubernetes/issues/119595>

**Acknowledgements**

This vulnerability was discovered by James Sturtevant @jsturtevant and Mark Rossetti @marosset during the process of fixing CVE-2023-3676 (that original CVE was reported by Tomer Peled @tomerpeled92)

The issue was fixed and coordinated by the fix team:

James Sturtevant @jsturtevant

Mark Rossetti @marosset

Andy Zhang @andyzhangx

Justin Terry @jterry75

Kulwant Singh @KlwntSingh

Micah Hausler @micahhausler

Rita Zhang @ritazh

and release managers:

Jeremy Rickard @jeremyrickard

Thank You,

Rita Zhang on behalf of the Kubernetes Security Response Committee

Reply allReply to authorForward0 new messages