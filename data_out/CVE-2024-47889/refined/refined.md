The provided content relates to CVE-2024-47889.

**Root cause of vulnerability:** The vulnerability is due to a potential Regular Expression Denial of Service (ReDoS) in the `block_format` helper within Action Mailer.

**Weaknesses/vulnerabilities present:**
-  The `block_format` helper uses regular expressions to format text which can be exploited.
-  The vulnerability lies in the way the `block_format` method processes list-like strings with leading spaces, `*` or `#`.
-  Specifically, the `split` method was found to be vulnerable to backtracking which allows for a ReDos attack

**Impact of exploitation:** An attacker can provide specially crafted text to the `block_format` helper, causing it to take an excessive amount of time to process, potentially leading to a denial-of-service (DoS) condition.

**Attack vectors:** The attack vector is through the `block_format` helper, which is likely used to format user-provided text within emails generated by the Action Mailer library.

**Required attacker capabilities/position:** An attacker would need to control or influence the input text that is processed by the `block_format` helper. This could be achieved by injecting malicious text into email bodies or similar text-based user inputs that are ultimately formatted using the `block_format` helper.

The content also provides information on:
- Affected versions of the `actionmailer` gem.
- Patched versions of the `actionmailer` gem.
- Workarounds for users who cannot upgrade immediately (avoiding the `block_format` helper or upgrading to Ruby 3.2).
-  The fix involves avoiding backtracking in ActionMailer block_format method by using a more efficient way of processing the input strings, this avoids use of regular expression `split` method to split strings with list markers.