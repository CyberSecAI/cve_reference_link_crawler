<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - Trojan Source Attacks</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://twitter.com/openwall">
Follow @Openwall on Twitter for new release announcements and other news</a>

</TABLE>
</TABLE>

<a href="5">[&lt;prev]</a> <a href="7">[next&gt;]</a> <a href="7">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;c2d12374-0ed6-d6d4-60ea-799934b6f173&#64;cl.cam.ac.uk&gt;
Date: Mon, 1 Nov 2021 17:27:53 +0000
From: Nicholas Boucher &lt;nicholas.boucher&#64;...cam.ac.uk&gt;
To: oss-security&#64;...ts.openwall.com
Subject: Trojan Source Attacks

OSS Security teams,

We have identified an issue affecting all compilers and interpreters 
that support Unicode. We believe that the techniques described hereafter 
can be used to generate adversarial encodings of source code files that 
can be used to craft targeted attacks against source code that cannot be 
seen by human reviewers in rendered text. This is of concern to the open 
source community because, absent defenses, supply chain attacks can be 
imperceptibly mounted against the ecosystem.

This vulnerability has undergone a coordinated disclosure process that 
has concluded today. The security advisory can be found at 
<a href="https://trojansource.codes" rel="nofollow">https://trojansource.codes</a>.

Multiple organizations will be releasing parallel security advisories, 
such as Rust's advisory at 
<a href="https://blog.rust-lang.org/2021/11/01/cve-2021-42574.html" rel="nofollow">https://blog.rust-lang.org/2021/11/01/cve-2021-42574.html</a>, Red Hat's 
advisory at 
<a href="https://access.redhat.com/security/vulnerabilities/RHSB-2021-007" rel="nofollow">https://access.redhat.com/security/vulnerabilities/RHSB-2021-007</a> 
&lt;<a href="https://access.redhat.com/security/vulnerabilities/RHSB-2021-007" rel="nofollow">https://access.redhat.com/security/vulnerabilities/RHSB-2021-007</a>&gt;, and 
GitHub's advisory at 
<a href="https://github.blog/changelog/2021-10-31-warning-about-bidirectional-unicode-text/" rel="nofollow">https://github.blog/changelog/2021-10-31-warning-about-bidirectional-unicode-text/</a> 
&lt;<a href="https://github.blog/changelog/2021-10-31-warning-about-bidirectional-unicode-text/" rel="nofollow">https://github.blog/changelog/2021-10-31-warning-about-bidirectional-unicode-text/</a>&gt;.

The attached paper describes an attack paradigm -- which we believe to 
be novel -- discovered by security researchers at the University of 
Cambridge. There are two techniques for attack, both of which exploit 
Unicode's high expressiveness to craft source code files for which 
rendered text displays divergent logic from the underlying encoded bytes 
seen by compilers.

The first and primary technique, which we dub the Trojan Source attack, 
uses Unicode Bidirectional (Bidi) control characters embedded in 
comments and string literals to produce visually deceptive source code 
files. This technique enables an adversary to encode constructs that 
visually appear to be comments or string literals but execute as code, 
or vice versa. Complete details, as well as recommended mitigations, can 
be found in the attachment 001 Trojan Source.pdf. This vulnerability is 
tracked under CVE-2021-42574.

The second technique, to which we refer as the homoglyph variant, uses 
homoglyphs (characters that render to the same glyph but are represented 
by different Unicode values) to define adversarial identifiers. In this 
technique, an adversary defines an identifier such as a function name 
that appears visually identical to a target function, but is defined 
using Unicode homoglyphs. This adversarial function then performs some 
malicious action, then optionally calls the original function it is 
impersonating. When defined in upstream dependencies such as open source 
software, these adversarial functions can be imported into downstream 
software and invoked without visual indication of malicious code. 
Complete details, as well as recommended mitigations, can also be found 
in the attachment 001 Trojan Source.pdf. This vulnerability is tracked 
under CVE-2021-42694.

Proofs-of-concept can be found at 
<a href="https://github.com/nickboucher/trojan-source" rel="nofollow">https://github.com/nickboucher/trojan-source</a>.

We hope that this information proves useful in building and applying 
defenses where applicable.

Best,
Nicholas Boucher
University of Cambridge

<span style="font-family: times;"><strong>Content of type "</strong>text/html<strong>" skipped</strong></span>

<span style="font-family: times;"><strong>Download attachment "</strong><a href="6/1" rel="nofollow" download>001 Trojan Source.pdf</a><strong>" of type "</strong>application/pdf<strong>" (737637 bytes)</strong></span>

<span style="font-family: times;"><strong>Download attachment "</strong><a href="6/2" rel="nofollow" download>OpenPGP_0x5662BCEC5F1D2BEA.asc</a><strong>" of type "</strong>application/pgp-keys<strong>" (3160 bytes)</strong></span>

<span style="font-family: times;"><strong>Download attachment "</strong><a href="6/3" rel="nofollow" download>OpenPGP_signature</a><strong>" of type "</strong>application/pgp-signature<strong>" (841 bytes)</strong></span>
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
