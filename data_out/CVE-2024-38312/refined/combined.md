=== Content from www.mozilla.org_4e8cd7b8_20250111_182048.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-27

## Security Vulnerabilities fixed in Firefox for iOS 127

Announced
June 13, 2024
Impact
high
Products
Firefox for iOS
Fixed in

* Firefox for iOS 127

#### [#CVE-2024-38313: Location URL bar could be visually spoofed with a fake toolbar](#CVE-2024-38313)

Reporter
Muneaki Nishimura
Impact
high
##### Description

In certain scenarios a malicious website could attempt to display a fake location URL bar which could mislead users as to the actual website address

##### References

* [Bug 1878489](https://bugzilla.mozilla.org/show_bug.cgi?id=1878489)

#### [#CVE-2024-38312: Private tabs could result in residual data related to browsing history in app bundle](#CVE-2024-38312)

Reporter
Adam Berry
Impact
moderate
##### Description

When browsing private tabs, some data related to location history or webpage thumbnails could be persisted incorrectly within the sandboxed app bundle after app termination

##### References

* [Bug 1878578](https://bugzilla.mozilla.org/show_bug.cgi?id=1878578)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_e238d5e8_20250111_182048.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1878578)
* [XML](/show_bug.cgi?ctype=xml&id=1878578)

Closed
[Bug 1878578](/show_bug.cgi?id=1878578)
(CVE-2024-38312)

Opened 11 months ago
Closed 8 months ago

# Firefox on iOS - Private Browsing Security Bug

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox on iOS - Private Browsing Security Bug

## Categories

### (Firefox for iOS :: General, defect)

[Product:](/describecomponents.cgi?product=Firefox%20for%20iOS)

Firefox for iOS
▾

Firefox for iOS
Firefox for iOS is the Firefox mobile experience developed for the iOS platform.
[See Open Bugs in This Product](/buglist.cgi?product=Firefox%20for%20iOS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox%20for%20iOS)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox%20for%20iOS&component=General#General)

General
▾

Firefox for iOS :: General
For bugs that don't fit into other components.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox%20for%20iOS&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| fxios | [127](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=127) | --- |

|  | Tracking | Status |
| --- | --- | --- |
| fxios | 127 |  |

## People

### (Reporter: 4n6focus, Unassigned)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

*Unassigned*

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/21fc797f3427c133abbdb04b1e7dd130?d=mm&size=40)  [4n6focus](/user_profile?user_id=742870)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/481f85b35d45ebad6d41f98cae68ccbf?d=mm&size=40)  [jeevans](/user_profile?user_id=654438)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

9 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1902899](/show_bug.cgi?id=1902899 "RESOLVED MOVED - Private tabs disappeared after update to Firefox 127 on iOS")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[mozilla-hub.atlassian.net/browse/FXIO...](https://mozilla-hub.atlassian.net/browse/FXIOS-8672 "https://mozilla-hub.atlassian.net/browse/FXIOS-8672")

[github.com/mozilla-mobile/firefox-ios...](https://github.com/mozilla-mobile/firefox-ios/pull/19936/ "https://github.com/mozilla-mobile/firefox-ios/pull/19936/")

## Details

### (Keywords: csectype-disclosure, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-38312

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a9229842_1689 "11 months ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty-hof |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [FirefoxTesting.7z](/attachment.cgi?id=9378192)  [11 months ago](#c0)  [4n6focus](/user_profile?user_id=742870)   5.83 MB, application/x-7z-compressed |  | [Details](/attachment.cgi?id=9378192&action=edit) |
| --- | --- | --- |
| [A - Firefox App - 'Firefox wont remember'.png](/attachment.cgi?id=9382182)  [11 months ago](#c5)  [4n6focus](/user_profile?user_id=742870)   127.41 KB, image/png |  | [Details](/attachment.cgi?id=9382182&action=edit) |
| [B - 'learn more' - Mozilla Website Firefox For iOS Screenshot.PNG](/attachment.cgi?id=9382183)  [11 months ago](#c6)  [4n6focus](/user_profile?user_id=742870)   172.00 KB, image/png |  | [Details](/attachment.cgi?id=9382183&action=edit) |
| [advisory.txt](/attachment.cgi?id=9406709)  [7 months ago](#c19)  [mreagan](/user_profile?user_id=734598)   269 bytes, text/plain |  | [Details](/attachment.cgi?id=9406709&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [4n6focus](/user_profile?user_id=742870)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1878578#c0)• 11 months ago |
|  | |

Attached file
[FirefoxTesting.7z](attachment.cgi?id=9378192)
— [Details](attachment.cgi?id=9378192&action=edit)

There are many general and functional related bugs reported on github for iOS Firefox but since this is a security issue I wanted to check if this should be disclosed privately first. Can you please see the below and let me know?

## Steps to reproduce

**First Test**

1. Launch the Firefox app and start a “Private” browsing session.
2. Browse to any website. In this test, Duckduckgo[.]com was used.
3. Generate browsing activity. In this test a DDG search was performed and refreshed.
4. Close the private mode browsing tab.
5. Close the Firefox app.
6. Make basic iTunes backup of the iPhone.
7. Firefox user data located in “org.mozilla.ios.Firefox”. This contains the folder "/profile.profile/" that contains two subfolders

* "/TabManagerScreenshots/" contains image files that are screenshots of the private browsing sessions.
* "/tab-session-data/" contains files with names “tab-“ followed by 32 digit hex strings with 4 hyphens between the strings. Inside these files are the actual URLs that the user was browsing.

These files are persisting despite it being a “private” session that should not store logs or records of the browsing activity.

**Second test**

8.Repeat steps 1 through 3 to generate additional activity.

9. Go into the Firefox App’s Settings menu. Select “Data Management”. “Browsing History,” “Cache,” “Cookies,”, and “Offline Web Site Data” are selected. Then select “Clear Private Data”.

10. A pop-up appears that warns that “this action will clear all of your private data. It cannot be undone.” Select “OK” to proceed.

11. While still in “Data Management,” select “Web Site Data,” and then touch “Clear All Web Site Data.” A pop-up appears that warns “This action will clear all of your web site data. It cannot be undone”.

12. Repeat step 5 and 6.

13. The artifacts observed in step 7 remain.

### Expected behavior

* Firefox states that while in Private browsing mode, browser logs should not be retained on the device.
* Attempts to manually clear browser artifacts/logs and caches in the settings menu should result in purging these artifacts from the device.

### Actual behavior

* Closed or manually cleared private browsing history is not visible to the user but Firefox retains many artifacts associated to the user’s Private browsing activity on the device. These include screenshots of the websites and plists containing potentially sensitive data including verbose logs of the search queries made, the URLs that they browsed, and the dates/times of this activity.
* This could result in disclosure of a user's historical private browsing history (that they thought would have been destroyed) to 3rd parties and presents security and privacy risk.

### Device & build information

* Device: iPhone 12, iOS 17.3
* Build version: 122.1
* First seen version: New
Flags: sec-bounty?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878578#a75759_406194)• 11 months ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralProduct: Firefox → Firefox for iOS

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878578#a257601_406194)• 11 months ago |

Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1878578#c1)• 11 months ago |
|  | |

Adding notes on top of the issue:

Multiple mechanism are implied in the above conversation. There's mention of logs, cookies, session data, caches, browsing history and website data. Those are all distinct, and are treated differently at the moment in the app (not saying this is right or wrong, just that they are very different things from the code perspective, and treated differently).

Data management settings section currently enables the user to delete: browsing history, cache, cookies, website data, tracking protection and downloaded files, but not session data. Tab data (or session data) in itself is different from those, as by default private tabs are in fact indeed stored on local device storage. We do have an option to "Close private tabs when leaving private browsing" under the settings but from the current ticket, I understand this can be missed or misinterpreted by users.

|  | [4n6focus](/user_profile?user_id=742870)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1878578#c2)• 11 months ago |
|  | |

Hi

I understand what you’re saying but I think the problem isn’t so much a misinterpretation by the users, but a problem with how Firefox handles its data.

The purpose of a private mode is so you can have a browsing session that doesn’t retain persistent artifacts (e.g. history, cookies, etc.). This could be for a variety of reasons from web dev work, privacy, security or personal safety, and so on. Firefox for iOS even describes the following:

“Private Browsing does not save history, cookies, passwords, site preferences, or temporary Internet files.”

Unfortunately, Firefox is not only retaining much of the above data, but is doing so in a manner that the user cannot see and has no knowledge of. What makes this worse is the behavior of Firefox in the settings menus. It tells the user that “all private data” will be deleted, yet these sessions files that effectively contain much of their actual browsing logs, remain persistent on the device.

There is a bug with how Firefox handles that data purging. Unless that changes, it poses a significant security and privacy risk to its users.

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1878578#c3)• 11 months ago |
|  | |

Hello! Could you indicate to us where you see the sentence `“Private Browsing does not save history, cookies, passwords, site preferences, or temporary Internet files.”` ? I was searching it in the app and haven't found it.

Also, I opened a [ticket](https://mozilla-hub.atlassian.net/browse/FXIOS-8480) to fix how we manage our tab history whenever we delete browsing history from the `Data management` setting page under [`Tab.swift`](https://github.com/mozilla-mobile/firefox-ios/blob/28cda07c152c8629471b63dc8f4df1c4bddb0b21/firefox-ios/Client/TabManagement/Tab.swift#L576-L584). We've recently changed how `sessionData` is persisted, and there's an improvement there to make to ensure that data is deleted whenever the user selects their data to be deleted. I don't think this is a security issue per se, as to get ahold of that local tab data stored on disk would be required for an attacker to get their hands on the physical device of the user. Unless I am mistaken, let me know!

|  | [4n6focus](/user_profile?user_id=742870)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1878578#c4)• 11 months ago |
|  | |

Hi there,

It is excellent to hear about the updates and that sure was fast.

Regarding the quote I referenced - in the Firefox iOS app, first toggle private mode. It looks like the image starting with "A" that I uploaded just now. In there is an excerpt about how Firefox will not remember history. Below that text is a purple link "Learn More". Click that and it leads to the Mozilla support website: <https://support.mozilla.org/en-US/kb/private-browsing-firefox-ios> . Screenshot "B" shows the quote that I was referencing.

I think it is a security issue for a few reasons and largely focused on the confidentiality aspects. Requiring physical access may help mitigate some risk, but it is still there and can be compromised via a variety of ways, including without physical access to the phone (more detail on that below).

Several browsers have a private browsing mode specifically to help protect the confidentiality of a user’s browsing activities. Firefox on Windows and Linux platforms, for example, destroys private artifacts reliably and that is to protect the confidentiality of the browsing activity (regardless of physical access to the device or not). Imagine if it was found, for example, that Firefox on Ubuntu is saving screenshots and logging private browsing session info to a hidden area on their hard drive and without them knowing. I think that would broadly be seen as a significant security issue impacting privacy/confidentiality. Moreover, it may be safe to say that many users select Firefox over competing browsers for two primary security-related reasons: privacy (confidentiality) and Mozilla's history of instilling trust (e.g., Moz's 'Privacy promise'). In the current build of iOS Firefox, it is telling the user that it is not storing this data when it is, and that raises concerns with both of the above security aspects.

Back to this bug specifics - physical access is not necessarily required to recover these private mode browser artifacts. These items are stored on the device's storage and within backups- backups that are often on PCs, portable hard drives, or cloud storage. This means that compromise of the PC, drives, or cloud storage (e.g. theft, malware infection, malicious or snooping user, etc.) could result in access to a Firefox user's private browser activities that they thought were never stored.

Another scenario could be where someone relinquishes their phone, with the belief that whatever they were browsing or whomever they may have been communicating with in Firefox private mode was purged long ago (perhaps expecting exact similar private mode behavior of Firefox across Linux, Windows, iOS, Android). But it turns out that the browser activity is still there and recoverable... Such a scenario could be an eavesdropping family member, a thief, a lost device, reselling a phone, an oppressive regime seizing a reporter or political rival’s cell phone, and so on.

Yet another scenario could be for when the next Checkm8 is found, and malware or otherwise exploits it to gain access to user app data. Data retention of persistent Firefox private mode data could be recoverable and potentially highly impactful to the user.

In my opinion, regardless of which example scenario above, the persistent retention of these artifacts in a hidden yet easily recoverable manner is significant and would fall under a confidentiality security vulnerability.

|  | [4n6focus](/user_profile?user_id=742870)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1878578#c5)• 11 months ago |
|  | |

Attached image
[A - Firefox App - 'Firefox wont remember'.png](attachment.cgi?id=9382182)
— [Details](attachment.cgi?id=9382182&action=edit)

|  | [4n6focus](/user_profile?user_id=742870)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1878578#c6)• 11 months ago |
|  | |

Attached image
[B - 'learn more' - Mozilla Website Firefox For iOS Screenshot.PNG](attachment.cgi?id=9382183)
— [Details](attachment.cgi?id=9382183&action=edit)

|  | [4n6focus](/user_profile?user_id=742870)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1878578#c7)• 10 months ago |
|  | |

Hi Mozilla,

It has been a couple weeks and I figured I would check to see if there are any updates to the security bug I reported. Could you please let me know?

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1878578#c8)• 10 months ago |
|  | |

There is no update apart from the conversation we had above. Thank you!

|  | [4n6focus](/user_profile?user_id=742870)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1878578#c9)• 10 months ago |
|  | |

Thanks, lmarceau.

Do you know what the next steps are in terms of this report? I can imagine that Mozilla is reviewing various bugs and prioritizing them accordingly, but I am curious about where this one may go from here. The status shows as unconfirmed, but I am not sure where that will go.

I have reported this security bug discreetly and in good faith, with the goal of protecting Mozilla users and giving all the time needed to address it. I will continue to handle it discreetly for as long as needed, but I am also interested in what to expect. As it is a privacy & security issue, I believe it has a flag for bug bounty. I am interested in Mozilla's take on that as well.

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1878578#c10)• 10 months ago |
|  | |

For bug bounty, the right persons to contact are security@mozilla.org, thank you!

|  | [mreagan](/user_profile?user_id=734598) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1878578#c11)• 10 months ago |
|  | |

I noticed there was a follow-up email sent regarding this and just wanted to mention that I'm reviewing the ticket and also taking a closer look at the current iOS client behavior and running a few tests. I'll be sure to update as soon as I have more information. Thank you!

|  | [mreagan](/user_profile?user_id=734598) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1878578#c12)• 10 months ago |
|  | |

Just wanted to add some additional context and comments here. Based on what I can see from the original report and the discussion above it sounds like the primary concern is that tabs (including Private ones) result in residual browsing data within the app bundle that is not removed, specifically tab session data files and tab screenshots. For screenshots, in my testing I can see that the client does properly clean these up for closed private tabs, however it happens on subsequent launches as part of general housekeeping that the client application does during its startup. For tab session files a change has been added to also clean these up (at the same time as screenshots) during app launch. At some point a more robust solution might be implemented to clean up these files more aggressively (immediately upon tab closure) but that is likely to be a more involved code change.

I wanted to be sure to clarify, however, that the data discussed above for the tabs is only stored locally within the app container, it is not ever sync'd or sent across the wire AFAICS. As a result there is not really any way for an attacker or malicious user to gain access to this data without breaking into and gaining full access to the user's phone. A user can of course create a backup of their phone data and then give that to someone, which could potentially include sensitive information, but that is true of most apps on the device (since the backup will typically include the support files for all apps on the device).

I believe this ticket will likely be kept open for a bit longer as the iOS team is re-evaluating potential changes to how Private tabs work in the iOS client, which could impact this. Please let me know if there are any questions in the meantime. Thank you!

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1878578#c13)• 10 months ago |
|  | |

(In reply to mreagan from [comment #12](/show_bug.cgi?id=1878578#c12 "RESOLVED FIXED - Firefox on iOS - Private Browsing Security Bug"))

> I wanted to be sure to clarify, however, that the data discussed above for the tabs is only stored locally within the app container, it is not ever sync'd or sent across the wire AFAICS. As a result there is not really any way for an attacker or malicious user to gain access to this data without breaking into and gaining full access to the user's phone. A user can of course create a backup of their phone data and then give that to someone, which could potentially include sensitive information, but that is true of most apps on the device (since the backup will typically include the support files for all apps on the device).

Yes, that is right. At least on Firefox desktop, I believe the goal is that data from a private browsing session never reaches the disk, so no data will be exposed even if the browser crashes in the middle of a session.

|  | [4n6focus](/user_profile?user_id=742870)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1878578#c14)• 10 months ago |
|  | |

Hi Moz team,

Thanks for continuing to look into this.

Presumably, Firefox for iOS may have to cache some data to disk due to memory constraints. iOS devices often have relatively low RAM capacities compared to Android devices and certainly low compared to desktops. Outside of something similar to a pagefile in a Windows environment, Firefox private browsing activity seems to almost exclusively live out of volatile memory and there are significant and long-lasting security benefits to this. What is odd to me, and something providing for an inconsistent user experience, is that this persistent private mode in Firefox for iOS appears to be by design and an outlier compared to Firefox browsers on other platforms. Persistent private browsing mode is not present in desktop variants or even on other mobile Firefox variants - Firefox for Android seems to behave very similarly to desktop-based Firefox applications with destruction of browser artifacts at application termination.

It is also important to note that potentially the single biggest benefit of why Firefox (and other browsers) private mode on desktop platforms do not cache files to disk is to reduce exposure surface and ensure these artifacts are not easily recoverable by malicious activity - it could be a malicious user or processes that conducts this activity at a later time & after the browsing session. Not retaining data is one of many defensive mechanisms. Mobile devices have their own challenges (e.g., RAM constraints), and may necessitate some disk caching to the app container, but that is even more reason why aggressive cleanup and/or encryption should be leveraged. Perhaps this is the potential more robust solution you alluded to.

Regarding data over the wire, I think there are some aspects to consider there. Firefox for iOS does not appear to be sending private browsing data over the wire via Mozilla’s sync services but the behavior of storing it within the app container means that it syncs over the wire via other services, such Apple iCloud backups. This gets back to the above, with the need for Firefox to have inherent defensive behaviors with cleanup as best as possible regardless of a given platform’s risks. If Firefox does not, crucial, and sensitive browsing data is replicated all over the place (including over the wire). This is data that users thought was purged either by traditional/expected Firefox behavior (again back to expecting like-behavior transcending Firefox applications across platforms and the application’s and website messages saying the browser artifacts were purged).

In any case, breaking into the phone is not necessarily required to abuse this bug. A malicious entity would just need a backup of the phone. This harkens back to all the above – I think one of the biggest benefits of private browsing that many Firefox users leverage is to reduce their footprint and data traces. Less data and logs often correlate to more privacy and less risk. When Firefox is writing all of this to disk in he clear, it is expanding user’s exposure greatly and leaving a trail of potentially sensitive artifacts sprinkled around - the physical device, iTunes backups (which are often replicated to numerous other areas such as HDDs, cloud storages, etc.), backups to iCloud ( which are rather ubiquitous for compromise), and I think illustrates the need to limit data retention wherever possible for private browsing.

|  | [mreagan](/user_profile?user_id=734598) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1878578#c15)• 9 months ago |
|  | |

PR <https://github.com/mozilla-mobile/firefox-ios/pull/19936/> should resolve the final remaining issues with the private tab session data (which are now not persisted at all). The screenshots, as noted before, should already be cleaned up, though that happens on subsequent launches as part of the app's general housekeeping.

Related JIRA for this ticket: <https://mozilla-hub.atlassian.net/browse/FXIOS-8672>

|  | [4n6focus](/user_profile?user_id=742870)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1878578#c16)• 9 months ago |
| offtopic | |

| Comment hidden (offtopic) |  |
| --- | --- |

Good news. Thanks for the update, Matt. I am still interested in understanding Mozilla's take on this report for recognition and bounty eligibility.

|  | [mreagan](/user_profile?user_id=734598) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1878578#c17)• 8 months ago |
| off-topic | |

| Comment hidden (off-topic) |  |
| --- | --- |

For questions on the bounty eligibility can you please reach out again to security@mozilla.org? If you have trouble getting your questions answered there let me know and I can try to help further.

|  | [mreagan](/user_profile?user_id=734598) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878578#a8627263_734598)• 8 months ago |

Status: UNCONFIRMED → RESOLVEDClosed: 8 months ago
[tracking-fxios](/buglist.cgi?f1=cf_tracking_fxios&o1=isnotempty):
--- → [127](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=127)Resolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878578#a8627456_1689)• 8 months ago |

Group: mobile-core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1878578#c18)• 8 months ago |
|  | |

> What is odd to me, and something providing for an inconsistent user experience, is that this persistent private mode in Firefox for iOS appears to be by design and an outlier compared to Firefox browsers on other platforms.

All browsers on iOS devices are required by Apple to use the native browser engine for the part that loads and displays web pages. There are many ways in which the iOS version of Firefox differs from Firefox on other platforms because it's heart has been ripped out and replaced with apple.

See Also: → <https://mozilla-hub.atlassian.net/browse/FXIOS-8672>,
<https://github.com/mozilla-mobile/firefox-ios/pull/19936/>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878578#a9229842_1689)• 8 months ago |

Flags: sec-bounty? → sec-bounty+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878578#a10006755_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [mreagan](/user_profile?user_id=734598) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1878578#c19)• 7 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9406709)
— [Details](attachment.cgi?id=9406709&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878578#a11217649_1689)• 7 months ago |

Alias: CVE-2024-38312

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878578#a11448779_447061)• 7 months ago |

Regressions: [1902899](/show_bug.cgi?id=1902899 "RESOLVED MOVED - Private tabs disappeared after update to Firefox 127 on iOS")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878578#a26075816_1689)• 1 month ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1878578&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [4n6focus](/user_profile?user_id=742870)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


