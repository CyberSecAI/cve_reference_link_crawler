=== Content from wordpress.org_116a9e99_20250111_125857.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

All-in-One Video Gallery

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fall-in-one-video-gallery&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fall-in-one-video-gallery&locale=en_US)

Search plugins

![](https://ps.w.org/all-in-one-video-gallery/assets/banner-772x250.png?rev=3078876)
![](https://ps.w.org/all-in-one-video-gallery/assets/icon-256x256.png?rev=3078876)
# All-in-One Video Gallery

By [Team Plugins360](https://plugins360.com)

[Download](https://downloads.wordpress.org/plugin/all-in-one-video-gallery.3.9.4.zip)

* [Details](https://wordpress.org/plugins/all-in-one-video-gallery/#description)
* [Reviews](https://wordpress.org/plugins/all-in-one-video-gallery/#reviews)
* [Installation](https://wordpress.org/plugins/all-in-one-video-gallery/#installation)
* [Development](https://wordpress.org/plugins/all-in-one-video-gallery/#developers)

[Support](https://wordpress.org/support/plugin/all-in-one-video-gallery/)

## Description

> [View Demo](https://demo.plugins360.com/all-in-one-video-gallery/) | [Getting Started](https://plugins360.com/all-in-one-video-gallery/documentation/) | [Contact & Support](https://plugins360.com/support/) | [Home Page](https://plugins360.com)

“Video is the future of content marketing”. Start converting your blogs to video blogs and win the COMPETITION.

**All-in-One Video Gallery** is a VIDEO POSTS plugin that helps you add videos as posts and build scalable, searchable, SEO-optimized video galleries in minutes.

No coding is required. Suitable for all kinds of websites that require a single video player to a large video-sharing website like YouTube/Vimeo.

### PLAYER FEATURES

* A Custom HTML5 Video Player that supports **MP4**, **WebM**, **OGV**, **HLS**, **MPEG-DASH**, and embeddable players like **YouTube**, **Vimeo**, **Dailymotion**, **Rumble**, **Facebook** and more.
* **Player Controls:** play/pause buttons, timer, progress bar, duration, speed control, quality switcher, volume button, picture-in-picture button, fullscreen button, share buttons, embed button, download button, subtitles on/off, keyboard hotkeys
* **Playback Options:** autoplay, loop, muted, preload, playsinline
* Subtitles & Captions (WebVTT).
* Chapter Markers.
* GDPR compatibility.
* [+] support embed code from any third-party video sharing websites.

### GALLERY FEATURES

Back-End

* An user-friendly interface to upload and manage your videos.
* Create unlimited categories/subcategories and tags.
* Ability to group videos by categories and tags.
* Create a featured videos group.
* 100+ settings (STILL COUNTING) that help you customize the plugin to the maximum you will need.

Front-End

* Modern, Responsive design.
* Categories display options: Grid, List
* Sort categories by “ID”, “videos count”, “category name”, “slug” & “menu order (custom ordering)”.
* Videos display options: Grid. More template options are available with our premium version.
* Filter videos by “categories”, “tags” and “featured” meta key.
* Sort videos by “video posted date”, “title”, “views count”, “likes count”, “dislikes count”, “random” & “menu order (custom ordering)”.
* Ability to control the display of each HTML element in the gallery.
* Numeric Pagination for the large galleries.
* Likes / Dislikes.
* Social Sharing (Facebook, Twitter, Linkedin, Pinterest, Tumblr & WhatsApp).
* Comments System.
* Dedicated search form & layout.
* Shortcode Builder to build the gallery shortcodes.
* Gutenberg Blocks to build the gallery if your website uses the modern WordPress editor.
* Widgets to list categories, list videos, display a single video player, and search videos.

### DEVELOPER OPTIONS

The videos (aiovg\_videos) belong to a WordPress Custom Post Type. Similarly, the categories (aiovg\_categories) and tags (aiovg\_tags) belong to the WordPress Custom Taxonomy. The plugin doesn’t use any custom tables and the settings are stored in the WP\_Options table using the WordPress SETTINGS API. In short, the plugin has been developed completely using the WordPress CORE features. So, if you’re a WordPress developer, you can customize/extend the plugin as you like using the WordPress hooks system easily.

Similarly, the front-end gallery layouts added by our plugin can be customized by developing or overriding our existing templates. Please [check for a detailed documentation](https://plugins360.com/all-in-one-video-gallery/child-themes-and-templates/) on this.

### [+] PREMIUM FEATURES

* Gallery Templates: [Popup](https://demo.plugins360.com/popup/), [Inline](https://demo.plugins360.com/inline/), [Slider](https://demo.plugins360.com/slider/), [Playlist](https://demo.plugins360.com/playlist/), [Compact (Modern)](https://demo.plugins360.com/compact/)
* Auto import videos from YouTube & Vimeo websites.
* Video SEO: Schema.org Markup (via JSON-LD)
* Auto Thumbnail Generator
* Custom Logo & Branding
* Custom Context Menu
* Front-end User Submission
* User Playlists / Favorites
* VAST / VPAID Ads

### TRANSLATION READY

Do you speak another language? Want to contribute in a meaningful way to All-in-One Video Gallery? There’s no better way than to help us translate the plugin. This plugin is translation ready and you can [translate](https://plugins360.com/all-in-one-video-gallery/translate-to-your-language/) to your language easily. Once finished, please reach out to us [here](https://plugins360.com/support/) to get your language file included in the core.

Spanish translation partner – [Blarlo](https://www.blarlo.com/)

### SUPPORT AND DOCUMENTATION

We do have [documentation](https://plugins360.com/all-in-one-video-gallery/documentation/) on the plugin.

Still, Having Issues? We are just an email away. Please write to us describing your issue using the “Contact” form available under our plugin’s menu. You should receive a reply within 24 hours (except Sunday).

Also, we answer all support requests [on the WordPress.org support forum](https://wordpress.org/support/plugin/all-in-one-video-gallery/).

## Screenshots

* [![](https://ps.w.org/all-in-one-video-gallery/assets/screenshot-1.png?rev=1789625)](https://ps.w.org/all-in-one-video-gallery/assets/screenshot-1.png?rev=1789625)

  Categories Layout.
* [![](https://ps.w.org/all-in-one-video-gallery/assets/screenshot-2.png?rev=1789625)](https://ps.w.org/all-in-one-video-gallery/assets/screenshot-2.png?rev=1789625)

  Video Gallery (“Classic” Template).
* [![](https://ps.w.org/all-in-one-video-gallery/assets/screenshot-3.png?rev=1789625)](https://ps.w.org/all-in-one-video-gallery/assets/screenshot-3.png?rev=1789625)

  Single Video page.
* [![](https://ps.w.org/all-in-one-video-gallery/assets/screenshot-4.png?rev=1789625)](https://ps.w.org/all-in-one-video-gallery/assets/screenshot-4.png?rev=1789625)

  Videos list back-end.
* [![](https://ps.w.org/all-in-one-video-gallery/assets/screenshot-5.png?rev=1789625)](https://ps.w.org/all-in-one-video-gallery/assets/screenshot-5.png?rev=1789625)

  Video form back-end.
* [![](https://ps.w.org/all-in-one-video-gallery/assets/screenshot-6.png?rev=1789625)](https://ps.w.org/all-in-one-video-gallery/assets/screenshot-6.png?rev=1789625)

  Category form back-end.
* [![](https://ps.w.org/all-in-one-video-gallery/assets/screenshot-7.png?rev=1789625)](https://ps.w.org/all-in-one-video-gallery/assets/screenshot-7.png?rev=1789625)

  Plugin Settings.

## Blocks

This plugin provides 4 blocks.

* AIOVG – Video Categories
  Display a list of video categories.
* AIOVG – Video Gallery
  Display a video gallery.
* AIOVG – Search Form
  A videos search form for your site.
* AIOVG – Video Player
  Display a video player.

## Installation

1. Download the plugin.
2. From the WordPress Admin Panel, click on Plugins => Add New.
3. Click on Upload, so you can directly upload your plugin zip file.
4. Use the browse button to select the plugin zip file that was downloaded, and then click on Install Now.
5. Once installed, click “Activate”.

For more detailed instructions visit our plugin [documentation](https://plugins360.com/all-in-one-video-gallery/documentation/).

## FAQ

### 1. I have installed the plugin. How to build my first Gallery?

Thanks for installing our plugin. The plugin dashboard should have all the necessary instructions required to build a gallery. Simply follow that.

For more detailed instructions visit our plugin [documentation](https://plugins360.com/all-in-one-video-gallery/documentation/).

Still, Having Issues? We are just an email away. Please write to us describing your issue using the “Contact” form available under our plugin’s menu. You should receive a reply within 24 hours (except Sunday).

### 2. Can I show my videos in a popup, slider, playlist, or something more engaging?

Yes, you can. Kindly refer to the instructions below,

1. [Popup](https://plugins360.com/all-in-one-video-gallery/popup/)
2. [Inline](https://plugins360.com/all-in-one-video-gallery/inline/)
3. [Slider](https://plugins360.com/all-in-one-video-gallery/slider/)
4. [Playlist](https://plugins360.com/all-in-one-video-gallery/playlist/)
5. [Compact](https://plugins360.com/all-in-one-video-gallery/compact/)

### 3. Can I upload large video files using this plugin?

Sure, the plugin doesn’t apply any restriction on the uploaded file size. If you’re not able to upload large files, then it must be your server configuration that is not suitable for large file uploads. Simply write to your HOST and ask them to increase the upload file size limit.

### 4. Does the plugin support third-party page builders like “Elementor”, “WPBakery”, “Divi”, etc.?

Yes. Simply, generate your shortcode using the plugin’s “Shortcode Builder” and add it to your favorite page builder.

### 5. Is the plugin compatible with WordPress Multisite?

Yes, it is. However, do not “network-activate” the plugin. Activate it only on the subsites on which you need the gallery. This can be done under “Plugins => Add New” as the Administrator user.

### 6. The download button in the plugin is not working.

The download option works only on the “Self Hosted / External URL” source type. Even if the video is self-hosted, the video file must be publicly accessible to download. So, make sure that your file is publicly accessible.

Also, the videos from third-party services like “YouTube”, “Vimeo”, “Dailymotion”, or “Rumble” cannot be downloaded.

## Reviews

![](https://secure.gravatar.com/avatar/476f4cdbe7701632bcd789c634822ddb7b6744e7eb867f01f34f259401a7ad2c?s=60&d=retro&r=g)
### [A valuable edition to my website.](https://wordpress.org/support/topic/a-valuable-edition-to-my-website/)

[xxrandy](https://profiles.wordpress.org/xxrandy/ "Posts by xxrandy")
December 16, 2024

I was looking for a more robust video solution to the default one that comes with PeepSo. A PeepSo community forum member had mentioned the AIOVG plugin to another member remarking that the support was excellent. I bought and installed the plugin right away and I’m very pleased with the plugin and the support that San Rosh gives. I highly recommend buying and installing this plugin (I got the paid version) on your site.

![](https://secure.gravatar.com/avatar/f0246d3c63c2a36c133530ba039fc5efca0bfe254003913a5ed13bbffd2ca888?s=60&d=retro&r=g)
### [Fantastic plugin for anything video](https://wordpress.org/support/topic/fantastic-plugin-for-anything-video/)

[Pauk](https://profiles.wordpress.org/paukmentor/ "Posts by Pauk")
November 10, 2024

Thank you so much for creating and maintaining this plugin. It’s amazing and more people should know about it!

![](https://secure.gravatar.com/avatar/255fba76231c74fb501777da16a82f82a505eae7c742bb64028a1ce4c4fa4801?s=60&d=retro&r=g)
### [Great plugin](https://wordpress.org/support/topic/great-plugin-39730/)

[harmannus](https://profiles.wordpress.org/harmannus/ "Posts by harmannus")
November 7, 2024

very usefull
I have testend tis new integratie and Video galerie, For our site the best you can get. Used on a own peepso site, All-in-One Video Gallery is great working.

![](https://secure.gravatar.com/avatar/c58e9f8a724b0d5de8870eed5306e588453005777be4cdee87c361c8cec97ed1?s=60&d=retro&r=g)
### [5 star support](https://wordpress.org/support/topic/5-star-support-42/)

[riflebird](https://profiles.wordpress.org/riflebird/ "Posts by riflebird")
August 8, 2024

Great plugin with even better support. Response is super-fast and San goes above and beyond to sort any issues.

![](https://secure.gravatar.com/avatar/f394961ceee57504ff50f3c707e22c6ffe152fc3b46da50150223d146b5f77f0?s=60&d=retro&r=g)
### [All-In-One Video Gallery Is One Of The Best Plugin](https://wordpress.org/support/topic/noindex-issue-in-video-gallery-videos/)

[shubh01an7](https://profiles.wordpress.org/shubh01an7/ "Posts by shubh01an7")
July 31, 2024
7 replies

Hi,
My name is Shubh. “All-In-One Video Gallery” is an excellent plugin for those who want to add videos to their websites. I really enjoy using it. However, I’ve encountered an issue. Which was 100% get resolved by “All-In-One Video Gallery’s” team. If you also want to add video gallery into your site, I definitely prefer you to go with “All-In-One Video Gallery”. Also, the support system of “All-In-One Video Gallery” is very fast.
Thank you.

![](https://secure.gravatar.com/avatar/6427f6fc022cd88f9965fbbcfecd7426eb983f3dab6bf14abcba1e1289498656?s=60&d=retro&r=g)
### [Support went above and beyond](https://wordpress.org/support/topic/support-went-above-and-beyond-6/)

[cmerrick](https://profiles.wordpress.org/cmerrick/ "Posts by cmerrick")
July 25, 2024

I just started using AIOVG last week and need a page where the user could select from a list of categories and have the page filter down to the right subset of videos, preferably without a separate “submit form” click. San at AIOVG support helped me out with the exact shortcode to use and a php function that would bypass the submit button to create the effect I need. The responses to my emails were super fast, thorough, and helpful, and I’m very pleased with the result.
Even when I had a very silly question at the end about how to change the page title of AIOVG’s auto-generated pages, they patiently wrote back and explained that you can do that in the totally standard way, and didn’t call me a dumba\*\* for asking.
I would give the plugin itself 4 stars (will graduate to 5 when it has AJAX tag filtering) but I would give support 10 stars.

[Read all 124 reviews](https://wordpress.org/support/plugin/all-in-one-video-gallery/reviews/)
## Contributors & Developers

“All-in-One Video Gallery” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/9cd05b2e480907a38726bcaab68b3afd0727803004fb0d8b71f52c6f253d3654?s=32&d=mm&r=g) [plugins360](https://profiles.wordpress.org/plugins360/)
* ![](https://secure.gravatar.com/avatar/7c9568b0aeae2ab01fc15d354da695239679630c3a765f87b76c37860c44e62a?s=32&d=mm&r=g) [wpvideogallery](https://profiles.wordpress.org/wpvideogallery/)
* ![](https://secure.gravatar.com/avatar/a8fa402c1d48477b4ff77f381ec443b53c169a3649b3f457475fbd97cd38192e?s=32&d=mm&r=g) [Freemius](https://profiles.wordpress.org/freemius/)

“All-in-One Video Gallery” has been translated into 5 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/all-in-one-video-gallery/contributors) for their contributions.

[Translate “All-in-One Video Gallery” into your language.](https://translate.wordpress.org/projects/wp-plugins/all-in-one-video-gallery)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/all-in-one-video-gallery/), check out the [SVN repository](https://plugins.svn.wordpress.org/all-in-one-video-gallery/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/all-in-one-video-gallery/) by [RSS](https://plugins.trac.wordpress.org/log/all-in-one-video-gallery/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 3.9.4

* Enhancement: Improved live user interface for the Video.js Player Library, offering a more intuitive and seamless user experience.
* Enhancement: Added custom HTML elements in front-end layouts to improve performance and ensure future scalability.
* Update: Upgraded the “Freemius SDK” to version 2.10.1 for enhanced functionality and stability.
* Fix: Resolved compatibility issues with the Elementor page builder.
* Fix: Addressed several minor bugs for a smoother user experience.

#### 3.9.2

* Fix: Resolved an issue where the popup would close when clicking the Next/Previous buttons in the gallery.

#### 3.9.1

* New: Added the ability to use shortcodes from third-party plugins within video descriptions for greater flexibility and functionality.
* Fix: Addressed problems with subtitle styling to ensure a consistent and improved viewing experience.
* Fix: Fixed a bug causing incorrect ordering of videos based on Likes/Dislikes.
* Fix: [+] a few minor bug fixes.

#### 3.9.0

* New: Added a custom player skin for the Video.js library.
* New: Added “Lazyloading” for images and iframes used by the plugin, improving page load times and performance.
* New: Enhanced the [aiovg\_video] single video shortcode to support dynamic video display based on specified “category,” “tag,” and “sort” attributes, giving users more control over which videos are shown.
* New: Added multi-category filtering to the search form, enabling users to refine video search results with enhanced flexibility.
* New: Added new configuration options to the search form, including the ability to set video sorting preferences, hide the submit button, and enable automatic submission when a form element is modified.
* New: Added new developer hooks, significantly increasing the plugin’s extensibility and customization potential.
* Tweak: Significantly improved the responsiveness of the video.js player skin, enhancing playback experience on smaller devices.
* Tweak: Improved Yoast breadcrumbs support for category pages, now displaying child categories in the breadcrumb trail for better navigation clarity.
* Tweak: Applied various CSS style updates to improve the visual appearance and user experience across the plugin.
* Tweak: Updated Video.js player library (8.18.1).
* Tweak: Updated Freemius SDK (2.9.0).
* Fix: [+] a few minor bug fixes.

#### 3.8.3

* Security Fix: “Authenticated (Contributor+) Stored Cross-Site Scripting via Video Shortcode” issue that was discovered by [Webbernaut](https://www.webbernaut.com/), and reported responsibly to us by Adam Goodlin (Customer Support Engineer) from [Wordfence](https://www.wordfence.com/).
* New: Support for the PiP (Picture-in-Picture) feature in the video player.
* Tweak: The source type formerly known as “Iframe Embed Code” in video forms has been rebranded as “Third-Party Player Code,” which now includes support for third-party plugin shortcodes.
* Tweak: Updated Video.js player library (8.16.1).
* Tweak: Updated Magnific Popup library (1.2.0).
* Tweak: Updated Freemius SDK (2.7.3).
* Fix: WordPress 6.6 compatibility issues.
* Fix: [+] a few minor bug fixes.

#### 3.7.1

* Fix: Pages show a 404 error when the “Permalink Slugs” settings field is empty.

#### 3.7.0

* Security Fix: Fixed “Authenticated (Contributor+) Local File Inclusion via aiovg\_search\_form Shortcode” issue reported responsibly to us by Janet Katile (Customer Support Engineer) from [Wordfence](https://www.wordfence.com/).
* Fix: [+] a few minor bug fixes.

#### 3.6.5

* Security Fix: “Authenticated (Contributor+) Arbitrary File Upload via featured image” issue that was discovered by [stealthcopter](https://sec.stealthcopter.com/), and reported responsibly to us by Adam Goodlin (Customer Support Engineer) from [Wordfence](https://www.wordfence.com/).
* Tweak: Updated Freemius SDK (2.7.2).
* Fix: [+] a few minor bug fixes.

#### 3.6.4

* New: Introduces a new [aiovg\_related\_videos] shortcode that displays the videos related to the current video on the single video pages.
* New: Introduces a new “Menu Order” option in the plugin’s “Order By” settings for videos and categories. This allows you to customize the videos and categories ordering using third-party plugins like [Simple Custom Post Order](https://wordpress.org/plugins/simple-custom-post-order/).
* New: Option to configure the DateTime format that the plugin should use when displaying the dates on the site’s front end.
* Tweak: Updated Freemius SDK (2.7.0).
* Fix: The views count displayed in the front end pages doesn’t use the proper number format.
* Fix: WordPress 6.5 compatibility issues.
* Fix: [+] a few minor bug fixes.

#### 3.6.2

* New: Likes / Dislikes.
* Tweak: Optimized JavaScript loading.
* Fix: [+] a few minor bug fixes.

#### 3.6.0

* New: Chapter Markers.
* New: User Playlists / Favorites.
* Tweak: The back-end & front-end template files have been rewritten to adapt to the latest web standards.
* Tweak: The CSS & JS files used by the plugin have been rewritten to adapt to the latest web standards.
* Tweak: Updated Freemius SDK (2.6.2).
* Fix: Security fix: Broken Access Control. Thanks to emad from [Patchstack](https://patchstack.com/).
* Fix: [+] a few minor bug fixes.

#### 3.5.2

* Fix: Unlisted Vimeo videos stopped working after the 3.5.0 release.

#### 3.5.1

* Fix: The single video shortcode “[aiovg\_video]” attributes stopped working after the 3.5.0 release.

#### 3.5.0

* New: Introduces Web Components to speed up video embeds.
* New: Option to Lazyload videos whenever possible.
* Tweak: The Player file has been completely rewritten for more optimized performance.
* Tweak: Updated Freemius SDK (2.5.11).
* Fix: [+] a few minor bug fixes.

#### 3.4.3

* Security Fix.
* New: Introduces a new stylish video player (Vidstack).
* New: Keyboard Hotkeys.
* Tweak: Updated Freemius SDK (2.5.10).
* Fix: [+] a few minor bug fixes.

#### 3.3.0

* Tweak: The wpml-config.xml file has been updated as per this discussion https://wordpress.org/support/topic/last-update-has-broken-my-websie-2/#post-16593449
* Tweak: Replaced “h4” tags on the thumbnail video titles with the “div” tags.
* Fix: Single category/tag/user pages don’t work when the URL contains special characters.
* Fix: [+] a few minor bug fixes.

#### 3.1.0

* Fix: A quick bug-fix version that addresses a compatibility issue with the WPML & POLYLANG plugins.

#### 3.0.0

* New: WPML Compatibility.
* New: POLYLANG Compatibility.
* New: Support for the “Insert from URL” option on the back-end file uploader.
* New: Option to configure the thumbnail image file size loading on the front-end gallery layouts.
* New: A new “Dropdown” template for categories.
* New: Option to open single videos in a popup.
* New: Option to customize the auto-imported video titles & descriptions when using the “Automations” feature.
* Tweak: The player integration code has been rewritten for better performance.
* Tweak: All the CSS & JS files added by the plugin are minified for better performance.
* Tweak: Updated to the Gutenberg API Version 2.
* Tweak: Improvised search form layout when only the keyword search is enabled.
* Tweak: Shows HD icon on the player control bar when multiple video resolutions are added and the current playing video resolution is greater than 720p.
* Tweak: Updated the front-end video submission form with “Plupload” library to support large file uploads and reworked the form validation.
* Tweak: Updated Freemius SDK (2.5.5).
* Fix: Fixed several [W3C validation](https://validator.w3.org/) errors.
* Fix: [+] a few minor bug fixes.

#### 2.6.4

* Tweak: Updated Freemius SDK (2.5.3).
* Fix: The YouTube, Vimeo, Dailymotion & Facebook videos not working when configured to use native controls.
* Fix: Video playback issues on webOS TV.
* Fix: [+] few minor bug fixes.

#### 2.6.3

* New: Support for featured images.
* New: Option to add videos from [Rumble.com](https://rumble.com/).
* New: Added support to SRT file format for subtitles.
* New: Option to show subtitles automatically on the player.
* New: Option to configure the “Page Range” in the pagination links.
* New: Action hooks named “aiovg\_player\_iframe\_head” and “aiovg\_player\_iframe\_footer” for developers to add their own custom styles/scripts in the player file.
* Tweak: Updated Freemius SDK (2.5.2).
* Fix: PHP 8.x compatibility issues.
* Fix: WordPress 6.1 compatibility issues.
* Fix: “JavaScript” player type not working in some WordPress environments.
* Fix: Replaced deprecated methods in the Gutenberg blocks.
* Fix: [+] few minor bug fixes.

#### 2.6.2

* New: Auto import videos from the Vimeo channel, album, folder, group, portfolio, etc.
* Fix: [+] few minor bug fixes.

#### 2.6.1

* Security Fix: Fixed “Unauthenticated Arbitrary File Download & Server-Side Request Forgery” issue [reported responsibly](https://plugins360.com/support/) by Chloe Chamberland (Wordfence Threat Intelligence Lead).
* Tweak: Updated Freemius SDK (2.4.5).

#### 2.6.0

* Fix: Disable access to the plugin backend to any user roles other than the “administrator” & “editor”.

#### 2.5.9

* Fix: Dailymotion videos not working when using the “JavaScript” player type.

#### 2.5.8

* New: Introduced “Share”, “Embed” & “Download” buttons.
* New: A filter hook “aiovg\_image\_url” for developers to override the image URL in the site front end.
* New: Option to restrict the title length in the gallery layout.
* Tweak: Improvised the plugin settings page UI.
* Fix: Issues with Ajax Pagination.
* Fix: [+] few minor bug fixes.

#### 2.5.7

* Fix: The search form was disabled on some WordPress environments after the last update.

#### 2.5.6

* New: Exclude categories selectively from the front-end search/video forms.
* New: Support for YouTube shorts.
* Tweak: Updated video.js player library & plugins.
* Tweak: Improvised tags input field.
* Tweak: Option to forcefully enable/disable comments in the front-end video pages.
* Fix: [+] few minor bug fixes.

#### 2.5.5

* New: Introduces an option to exclude video description when auto-importing videos from YouTube.
* Tweak: The video select field in the “AIOVG – Video Player” widget has been replaced by a jQuery Autocomplete UI.

#### 2.5.4

* Security Fix.

#### 2.5.3

* Tweak: Tags input field rebuilt using a standard HTML “select” field.
* Fix: [+] few minor bug fixes.

#### 2.5.2

* Fix: Ajax Pagination not working when a page contains multiple galleries.

#### 2.5.1

* New: Ajax Pagination.
* New: Options to disable cookies added by the plugin.
* New: A filter hook “aiovg\_socialshare\_buttons” for developers to override the plugin’s social media buttons.
* Tweak: Tags input field rebuilt using “jQuery AutoComplete UI” instead of the “Select2” library.
* Fix: [+] few minor bug fixes.

#### 2.5.0

Security Fix: Addresses a validation error in the plugin dashboard that leads to a Local File Inclusion issue. Thanks to “Mr.Erwan LR” from wpscan.com for bringing this issue to us.

#### 2.4.9

Tweak: Fallback to the JetPack HLS URLs.

Fix: Updates to the latest Vimeo Image URLs.

#### 2.4.8

* Fix: WordPress 5.8 compatibility issues.

#### 2.4.7

* Fix: Error when you click the “Add More Quality Levels” in the video form but submit the form without selecting any quality level.

#### 2.4.6

* Fix: SVG Icon sizes are HUGE in some WordPress environments.

#### 2.4.5

* New: Option to show/hide video title on the thumbnail galleries.
* New: Support for “start” and “end” times on the YouTube URLs.
* New: A new “exclude” attribute for the shortcode [aiovg\_categories].
* New: Introduced several developer hooks that make the plugin highly extensible.
* Tweak: Replaced the “Big Play Button” in the player with a more clear, more beautiful button.
* Tweak: Added support for a custom video player for YouTube and Vimeo videos on mobiles.
* Tweak: Updated Freemius SDK (2.4.2).
* Fix: [+] few minor bug fixes.

#### 2.4.4

* New: Added pagination support for categories.
* New: Introduced speed control.
* New: Introduced quality switcher.
* Fix: WordPress 5.6 compatibility issues.
* Fix: [+] few minor bug fixes.

#### 2.4.3

* New: Added support for “Video Tags”.
* New: Added “Tumblr” in social sharing buttons.
* Tweak: Updated Freemius SDK (2.4.1).
* Fix: Rank Math plugin compatibility issues.
* Fix: [+] few minor bug fixes.

#### 2.4.2

* New: Plugin settings specific to “Related Videos”.
* New: A filter hook “aiovg\_query\_args” for developers to override the WP\_Query args of the plugin.
* New: A filter hook “aiovg\_back\_to\_categories\_link” for developers to override the “Back to Categories” link on the single category pages.
* Tweak: Display video thumbnails on the back-end “All Videos” list table.
* Fix: WordPress 5.5 compatibility issues.
* Fix: Facebook API compatibility issues.
* Fix: SMUSH plugin conflict issues.
* Fix: Astra theme (“astra\_replace\_header\_attr”) conflict issues.
* Fix: [+] few minor bug fixes.

#### 2.4.1

* Fix: Duplicate plugin menu on the multisite setup.
* Fix: Private Vimeo videos not working.
* Fix: Muted option not working with the Facebook videos.
* Fix: Featured thumbnail issue on the single video pages.
* Fix: [+] few minor bug fixes.

#### 2.4.0

* New: Introduced player types (JavaScript, Iframe).
* New: Introduced Video SEO.
* Tweak: “Self Hosted / External URL” source type supports the relative file paths and the encoded (%20) file names.
* Tweak: “Iframe Embed Code” source type supports non-iframe player embeds. Example: TikTok Videos.
* Tweak: The “videos count” info on the categories page, includes the subcategory videos too.
* Fix: Security Fix. Prevent XSS (Cross-Site Scripting) attempts on the title fields.
* Fix: Conflict with the Autoptimize plugin.
* Fix: [+] few minor bug fixes.

#### 2.3.0

* Fix: Third-party videos like YouTube, Vimeo, Dailymotion & Facebook not working on iOS devices.
* Fix: Video zoomed inside the player in IE.

#### 2.2.0

* Fix: The player controls not showing with vertical videos.

#### 2.1.0

* Fix: Subtitles not working.
* Fix: [+] few minor bug fixes.

#### 2.0.0

* New: Replaced “mediaelement.js” player with the “video.js” player library.
* Fix: [+] few minor bug fixes.

#### EARLIER VERSIONS

For the changelog of earlier versions, please refer to the [changelog on plugins360.com](https://plugins360.com/all-in-one-video-gallery/changelog/).

## Meta

* Version **3.9.4**
* Last updated **2 weeks ago**
* Active installations **20,000+**
* WordPress version **6.3 or higher**
* Tested up to **6.7.1**
* PHP version **5.6.20 or higher**
* Languages
  See all 6

  Close

  [Chinese (China)](https://cn.wordpress.org/plugins/all-in-one-video-gallery/), [Dutch](https://nl.wordpress.org/plugins/all-in-one-video-gallery/), [Dutch (Belgium)](https://nl-be.wordpress.org/plugins/all-in-one-video-gallery/), [English (US)](https://wordpress.org/plugins/all-in-one-video-gallery/), [Romanian](https://ro.wordpress.org/plugins/all-in-one-video-gallery/), and [Russian](https://ru.wordpress.org/plugins/all-in-one-video-gallery/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/all-in-one-video-gallery)
* Tags [Live Stream](https://wordpress.org/plugins/tags/live-stream/)[video gallery](https://wordpress.org/plugins/tags/video-gallery/)[video player](https://wordpress.org/plugins/tags/video-player/)[vimeo gallery](https://wordpress.org/plugins/tags/vimeo-gallery/)[youtube gallery](https://wordpress.org/plugins/tags/youtube-gallery/)
* [Advanced View](https://wordpress.org/plugins/all-in-one-video-gallery/advanced/)

## Ratings

4.8 out of 5 stars.

* [116 5-star reviews
  5 stars

  116](https://wordpress.org/support/plugin/all-in-one-video-gallery/reviews/?filter=5)
* [2 4-star reviews
  4 stars

  2](https://wordpress.org/support/plugin/all-in-one-video-gallery/reviews/?filter=4)
* [2 3-star reviews
  3 stars

  2](https://wordpress.org/support/plugin/all-in-one-video-gallery/reviews/?filter=3)
* [0 2-star reviews
  2 stars

  0](https://wordpress.org/support/plugin/all-in-one-video-gallery/reviews/?filter=2)
* [4 1-star reviews
  1 star

  4](https://wordpress.org/support/plugin/all-in-one-video-gallery/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/all-in-one-video-gallery/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/all-in-one-video-gallery/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/9cd05b2e480907a38726bcaab68b3afd0727803004fb0d8b71f52c6f253d3654?s=32&d=mm&r=g) [plugins360](https://profiles.wordpress.org/plugins360/)
* ![](https://secure.gravatar.com/avatar/7c9568b0aeae2ab01fc15d354da695239679630c3a765f87b76c37860c44e62a?s=32&d=mm&r=g) [wpvideogallery](https://profiles.wordpress.org/wpvideogallery/)
* ![](https://secure.gravatar.com/avatar/a8fa402c1d48477b4ff77f381ec443b53c169a3649b3f457475fbd97cd38192e?s=32&d=mm&r=g) [Freemius](https://profiles.wordpress.org/freemius/)
## Support

Issues resolved in last two months:

3 out of 3

[View support forum](https://wordpress.org/support/plugin/all-in-one-video-gallery/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](https://plugins360.com)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_caf64197_20250111_125858.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# All-in-One Video Gallery <= 3.7.1 - Authenticated (Contributor+) Stored Cross-Site Scripting via Video Shortcode

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   All-in-One Video Gallery <= 3.7.1 - Authenticated (Contributor+) Stored Cross-Site Scripting via Video Shortcode

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-6629](https://www.cve.org/CVERecord?id=CVE-2024-6629) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | July 23, 2024 |
| Last Updated | July 24, 2024 |
| Researcher | [Webbernaut](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/webbernaut) |

### Description

The All-in-One Video Gallery plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's Video shortcode in all versions up to, and including, 3.7.1 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/all-in-one-video-gallery/trunk/public/video.php#L74)
* [wordpress.org](https://wordpress.org/plugins/all-in-one-video-gallery/#developers)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3123171/)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3123171/all-in-one-video-gallery/trunk/public/video.php)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fall-in-one-video-gallery%2Fall-in-one-video-gallery-371-authenticated-contributor-stored-cross-site-scripting-via-video-shortcode&t=All-in-One%20Video%20Gallery%20%3C%3D%203.7.1%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20Video%20Shortcode "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fall-in-one-video-gallery%2Fall-in-one-video-gallery-371-authenticated-contributor-stored-cross-site-scripting-via-video-shortcode&text=All-in-One%20Video%20Gallery%20%3C%3D%203.7.1%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20Video%20Shortcode "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fall-in-one-video-gallery%2Fall-in-one-video-gallery-371-authenticated-contributor-stored-cross-site-scripting-via-video-shortcode "LinkedIn")
Email

## Vulnerability Details for All-in-One Video Gallery

#### [All-in-One Video Gallery](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/all-in-one-video-gallery)

| Software Type | Plugin |
| --- | --- |
| Software Slug | all-in-one-video-gallery [(view on wordpress.org)](https://wordpress.org/plugins/all-in-one-video-gallery) |
| Patched? | Yes |
| Remediation | Update to version 3.8.3, or a newer patched version |
| Affected Version | * <= 3.7.1 |
| Patched Version | * 3.8.3 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_7845e354_20250111_125856.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3123171%2Fall-in-one-video-gallery%2Ftrunk%2Fpublic%2Fvideo.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3072329/all-in-one-video-gallery/trunk/public/video.php "Changeset 3072329 for all-in-one-video-gallery/trunk/public/video.php")
* [Next Change](/changeset/3187342/all-in-one-video-gallery/trunk/public/video.php "Changeset 3187342 for all-in-one-video-gallery/trunk/public/video.php") →

---

# Changeset [3123171](/changeset/3123171 "Show full changeset") for [all-in-one-video-gallery/trunk/public/video.php](/browser/all-in-one-video-gallery/trunk/public/video.php?rev=3123171 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
07/22/2024 11:28:58 AM
([6 months](/timeline?from=2024-07-22T11%3A28%3A58Z&precision=second "See timeline at 07/22/2024 11:28:58 AM") ago)

Author:
plugins360
Message:

Commit Version 3.8.3

File:

1 edited

* [all-in-one-video-gallery/trunk/public/video.php](/browser/all-in-one-video-gallery/trunk/public/video.php?rev=3123171 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [all-in-one-video-gallery/trunk/public/video.php](/changeset/3123171/all-in-one-video-gallery/trunk/public/video.php "Show the changeset 3123171 restricted to all-in-one-video-gallery/trunk/public/video.php")

  | [r3072329](/browser/all-in-one-video-gallery/trunk/public/video.php?rev=3072329#L49 "Show revision 3072329 of this file in browser") | [r3123171](/browser/all-in-one-video-gallery/trunk/public/video.php?rev=3123171#L49 "Show revision 3123171 of this file in browser") |  |
  | --- | --- | --- |
  | 49 | 49 | return $template; |
  | 50 | 50 | } |
  |  | 51 |  |
  |  | 52 | /\*\* |
  |  | 53 | \* Remove admin bar from the AIOVG player page. |
  |  | 54 | \* |
  |  | 55 | \* @since  3.8.0 |
  |  | 56 | \* @param  bool  $show\_admin\_bar Whether the admin bar should be shown. |
  |  | 57 | \* @return bool  $show\_admin\_bar Filtered value. |
  |  | 58 | \*/ |
  |  | 59 | public function remove\_admin\_bar( $show\_admin\_bar ) { |
  |  | 60 | $page\_settings = get\_option( 'aiovg\_page\_settings' ); |
  |  | 61 |  |
  |  | 62 | $player\_page\_id = apply\_filters( 'wpml\_object\_id', (int) $page\_settings['player'], 'page' ); |
  |  | 63 | if ( ! empty( $player\_page\_id ) && is\_page( $player\_page\_id ) ) { |
  |  | 64 | return false; |
  |  | 65 | } |
  |  | 66 |  |
  |  | 67 | return $show\_admin\_bar; |
  |  | 68 | } |
  | 51 | 69 |  |
  | 52 | 70 | /\*\* |
  | […](/browser/all-in-one-video-gallery/trunk/public/video.php?rev=3072329#L136) | […](/browser/all-in-one-video-gallery/trunk/public/video.php?rev=3123171#L154) |  |
  | 136 | 154 | foreach ( $supported\_formats as $format ) { |
  | 137 | 155 | if ( isset( $attributes[ $format ] ) ) { |
  |  | 156 | $attributes[ $format ] = aiovg\_sanitize\_url( $attributes[ $format ] ); |
  | 138 | 157 | $is\_video\_available = 1; |
  | 139 | 158 | break; |
  | 140 | 159 | } |
  | 141 | 160 | } |
  |  | 161 |  |
  |  | 162 | if ( isset( $attributes['poster'] ) ) { |
  |  | 163 | $attributes['poster'] = aiovg\_sanitize\_url( $attributes['poster'] ); |
  |  | 164 | } |
  | 142 | 165 |  |
  | 143 | 166 | if ( 0 == $is\_video\_available ) { |
  | 144 |  | $args = array( |
  | 145 |  | 'post\_type' => 'aiovg\_videos', |
  | 146 |  | 'post\_status' => 'publish', |
  | 147 |  | 'posts\_per\_page' => 1, |
  | 148 |  | 'fields' => 'ids', |
  | 149 |  | 'no\_found\_rows' => true, |
  | 150 |  | 'update\_post\_term\_cache' => false, |
  | 151 |  | 'update\_post\_meta\_cache' => false |
  | 152 |  | ); |
  | 153 |  |  |
  | 154 |  | $aiovg\_query = new WP\_Query( $args ); |
  | 155 |  |  |
  | 156 |  | if ( $aiovg\_query->have\_posts() ) { |
  | 157 |  | $posts = $aiovg\_query->posts; |
  | 158 |  | $post\_id = (int) $posts[0]; |
  | 159 |  |  |
  | 160 |  | $attributes['id'] = $post\_id; |
  |  | 167 | $in\_the\_loop   = apply\_filters( 'aiovg\_the\_content\_in\_the\_loop', in\_the\_loop() ); |
  |  | 168 | $is\_main\_query = apply\_filters( 'aiovg\_the\_content\_is\_main\_query', is\_main\_query() ); |
  |  | 169 |  |
  |  | 170 | if ( is\_singular( 'aiovg\_videos' ) && $in\_the\_loop && $is\_main\_query ) { |
  |  | 171 | $attributes['id'] = get\_the\_ID(); |
  |  | 172 | } else { |
  |  | 173 | $args = array( |
  |  | 174 | 'post\_type' => 'aiovg\_videos', |
  |  | 175 | 'post\_status' => 'publish', |
  |  | 176 | 'posts\_per\_page' => 1, |
  |  | 177 | 'fields' => 'ids', |
  |  | 178 | 'no\_found\_rows' => true, |
  |  | 179 | 'update\_post\_term\_cache' => false, |
  |  | 180 | 'update\_post\_meta\_cache' => false |
  |  | 181 | ); |
  |  | 182 |  |
  |  | 183 | $aiovg\_query = new WP\_Query( $args ); |
  |  | 184 |  |
  |  | 185 | if ( $aiovg\_query->have\_posts() ) { |
  |  | 186 | $posts = $aiovg\_query->posts; |
  |  | 187 | $post\_id = (int) $posts[0]; |
  |  | 188 |  |
  |  | 189 | $attributes['id'] = $post\_id; |
  |  | 190 | } |
  | 161 | 191 | } |
  | 162 | 192 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3123171)
* [Zip Archive](?format=zip&new=3123171)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_aaaffee6_20250111_125854.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3123171)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3123170 "Changeset 3123170")
* [Next Changeset](/changeset/3123172 "Changeset 3123172") →

---

# Changeset 3123171

Timestamp:
07/22/2024 11:28:58 AM
([6 months](/timeline?from=2024-07-22T11%3A28%3A58Z&precision=second "See timeline at 07/22/2024 11:28:58 AM") ago)

Author:
plugins360
Message:

Commit Version 3.8.3

Location:
[all-in-one-video-gallery/trunk](/browser/all-in-one-video-gallery/trunk?rev=3123171)
Files:

8 added
9 deleted
73 edited

* [README.txt](/browser/all-in-one-video-gallery/trunk/README.txt?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/README.txt "Show differences"))
* [admin/admin.php](/browser/all-in-one-video-gallery/trunk/admin/admin.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/admin/admin.php "Show differences"))
* [admin/assets/css/admin.css](/browser/all-in-one-video-gallery/trunk/admin/assets/css/admin.css?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/admin/assets/css/admin.css "Show differences"))
* [admin/assets/css/admin.min.css](/browser/all-in-one-video-gallery/trunk/admin/assets/css/admin.min.css?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/admin/assets/css/admin.min.css "Show differences"))
* [admin/partials/video-sources.php](/browser/all-in-one-video-gallery/trunk/admin/partials/video-sources.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/admin/partials/video-sources.php "Show differences"))
* [admin/settings.php](/browser/all-in-one-video-gallery/trunk/admin/settings.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/admin/settings.php "Show differences"))
* [admin/videos.php](/browser/all-in-one-video-gallery/trunk/admin/videos.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/admin/videos.php "Show differences"))
* [all-in-one-video-gallery.php](/browser/all-in-one-video-gallery/trunk/all-in-one-video-gallery.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/all-in-one-video-gallery.php "Show differences"))
* [blocks/blocks.php](/browser/all-in-one-video-gallery/trunk/blocks/blocks.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/blocks/blocks.php "Show differences"))
* [blocks/build/categories/index.asset.php](/browser/all-in-one-video-gallery/trunk/blocks/build/categories/index.asset.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/blocks/build/categories/index.asset.php "Show differences"))
* [blocks/build/categories/index.js](/browser/all-in-one-video-gallery/trunk/blocks/build/categories/index.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/blocks/build/categories/index.js "Show differences"))
* [blocks/build/search/index.asset.php](/browser/all-in-one-video-gallery/trunk/blocks/build/search/index.asset.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/blocks/build/search/index.asset.php "Show differences"))
* [blocks/build/search/index.js](/browser/all-in-one-video-gallery/trunk/blocks/build/search/index.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/blocks/build/search/index.js "Show differences"))
* [blocks/build/video/index.asset.php](/browser/all-in-one-video-gallery/trunk/blocks/build/video/index.asset.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/blocks/build/video/index.asset.php "Show differences"))
* [blocks/build/video/index.js](/browser/all-in-one-video-gallery/trunk/blocks/build/video/index.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/blocks/build/video/index.js "Show differences"))
* [blocks/build/videos/index.asset.php](/browser/all-in-one-video-gallery/trunk/blocks/build/videos/index.asset.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/blocks/build/videos/index.asset.php "Show differences"))
* [blocks/build/videos/index.js](/browser/all-in-one-video-gallery/trunk/blocks/build/videos/index.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/blocks/build/videos/index.js "Show differences"))
* [blocks/package-lock.json](/browser/all-in-one-video-gallery/trunk/blocks/package-lock.json?rev=3046258 "Show what was removed (content at revision 3123170)")
  (deleted)
* [blocks/package.json](/browser/all-in-one-video-gallery/trunk/blocks/package.json?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/blocks/package.json "Show differences"))
* [blocks/src/video/edit.js](/browser/all-in-one-video-gallery/trunk/blocks/src/video/edit.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/blocks/src/video/edit.js "Show differences"))
* [blocks/src/video/index.js](/browser/all-in-one-video-gallery/trunk/blocks/src/video/index.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/blocks/src/video/index.js "Show differences"))
* [freemius/assets/css/admin/dialog-boxes.css](/browser/all-in-one-video-gallery/trunk/freemius/assets/css/admin/dialog-boxes.css?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/freemius/assets/css/admin/dialog-boxes.css "Show differences"))
* [freemius/includes/class-freemius.php](/browser/all-in-one-video-gallery/trunk/freemius/includes/class-freemius.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/freemius/includes/class-freemius.php "Show differences"))
* [freemius/start.php](/browser/all-in-one-video-gallery/trunk/freemius/start.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/freemius/start.php "Show differences"))
* [freemius/templates/connect.php](/browser/all-in-one-video-gallery/trunk/freemius/templates/connect.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/freemius/templates/connect.php "Show differences"))
* [includes/functions.php](/browser/all-in-one-video-gallery/trunk/includes/functions.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/includes/functions.php "Show differences"))
* [includes/init.php](/browser/all-in-one-video-gallery/trunk/includes/init.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/includes/init.php "Show differences"))
* [includes/player/amp.php](/browser/all-in-one-video-gallery/trunk/includes/player/amp.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/includes/player/amp.php "Show differences"))
* [includes/player/base.php](/browser/all-in-one-video-gallery/trunk/includes/player/base.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/includes/player/base.php "Show differences"))
* [includes/player/iframe.php](/browser/all-in-one-video-gallery/trunk/includes/player/iframe.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/includes/player/iframe.php "Show differences"))
* [includes/player/videojs.php](/browser/all-in-one-video-gallery/trunk/includes/player/videojs.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/includes/player/videojs.php "Show differences"))
* [includes/player/vidstack.php](/browser/all-in-one-video-gallery/trunk/includes/player/vidstack.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/includes/player/vidstack.php "Show differences"))
* [languages/all-in-one-video-gallery.pot](/browser/all-in-one-video-gallery/trunk/languages/all-in-one-video-gallery.pot?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/languages/all-in-one-video-gallery.pot "Show differences"))
* [public/assets/css/videojs.css](/browser/all-in-one-video-gallery/trunk/public/assets/css/videojs.css?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/assets/css/videojs.css "Show differences"))
* [public/assets/css/videojs.min.css](/browser/all-in-one-video-gallery/trunk/public/assets/css/videojs.min.css?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/assets/css/videojs.min.css "Show differences"))
* [public/assets/css/vidstack.css](/browser/all-in-one-video-gallery/trunk/public/assets/css/vidstack.css?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/assets/css/vidstack.css "Show differences"))
* [public/assets/css/vidstack.min.css](/browser/all-in-one-video-gallery/trunk/public/assets/css/vidstack.min.css?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/assets/css/vidstack.min.css "Show differences"))
* [public/assets/js/autocomplete.js](/browser/all-in-one-video-gallery/trunk/public/assets/js/autocomplete.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/assets/js/autocomplete.js "Show differences"))
* [public/assets/js/autocomplete.min.js](/browser/all-in-one-video-gallery/trunk/public/assets/js/autocomplete.min.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/assets/js/autocomplete.min.js "Show differences"))
* [public/assets/js/videojs.js](/browser/all-in-one-video-gallery/trunk/public/assets/js/videojs.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/assets/js/videojs.js "Show differences"))
* [public/assets/js/videojs.min.js](/browser/all-in-one-video-gallery/trunk/public/assets/js/videojs.min.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/assets/js/videojs.min.js "Show differences"))
* [public/assets/js/vidstack.js](/browser/all-in-one-video-gallery/trunk/public/assets/js/vidstack.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/assets/js/vidstack.js "Show differences"))
* [public/assets/js/vidstack.min.js](/browser/all-in-one-video-gallery/trunk/public/assets/js/vidstack.min.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/assets/js/vidstack.min.js "Show differences"))
* [public/categories.php](/browser/all-in-one-video-gallery/trunk/public/categories.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/categories.php "Show differences"))
* [public/public.php](/browser/all-in-one-video-gallery/trunk/public/public.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/public.php "Show differences"))
* [public/templates/category-thumbnail.php](/browser/all-in-one-video-gallery/trunk/public/templates/category-thumbnail.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/templates/category-thumbnail.php "Show differences"))
* [public/templates/player-gdpr.php](/browser/all-in-one-video-gallery/trunk/public/templates/player-gdpr.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/templates/player-gdpr.php "Show differences"))
* [public/templates/player-iframe.php](/browser/all-in-one-video-gallery/trunk/public/templates/player-iframe.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/templates/player-iframe.php "Show differences"))
* [public/templates/player-videojs.php](/browser/all-in-one-video-gallery/trunk/public/templates/player-videojs.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/templates/player-videojs.php "Show differences"))
* [public/templates/player-vidstack.php](/browser/all-in-one-video-gallery/trunk/public/templates/player-vidstack.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/templates/player-vidstack.php "Show differences"))
* [public/templates/player.php](/browser/all-in-one-video-gallery/trunk/public/templates/player.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/templates/player.php "Show differences"))
* [public/video.php](/browser/all-in-one-video-gallery/trunk/public/video.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/video.php "Show differences"))
* [public/videos.php](/browser/all-in-one-video-gallery/trunk/public/videos.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/public/videos.php "Show differences"))
* [vendor/magnific-popup/magnific-popup.min.css](/browser/all-in-one-video-gallery/trunk/vendor/magnific-popup/magnific-popup.min.css?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/magnific-popup/magnific-popup.min.css "Show differences"))
* [vendor/magnific-popup/magnific-popup.min.js](/browser/all-in-one-video-gallery/trunk/vendor/magnific-popup/magnific-popup.min.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/magnific-popup/magnific-popup.min.js "Show differences"))
* [vendor/videojs/font/VideoJS.svg](/browser/all-in-one-video-gallery/trunk/vendor/videojs/font/VideoJS.svg?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/videojs/font/VideoJS.svg "Show differences"))
* [vendor/videojs/font/VideoJS.ttf](/browser/all-in-one-video-gallery/trunk/vendor/videojs/font/VideoJS.ttf?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/videojs/font/VideoJS.ttf "Show differences"))
* [vendor/videojs/font/VideoJS.woff](/browser/all-in-one-video-gallery/trunk/vendor/videojs/font/VideoJS.woff?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/videojs/font/VideoJS.woff "Show differences"))
* [vendor/videojs/font/index.html](/browser/all-in-one-video-gallery/trunk/vendor/videojs/font/index.html?rev=3123171 "Show entry in browser")
  (added)
* [vendor/videojs/plugins/contrib-ads/videojs-contrib-ads.min.css](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/contrib-ads/videojs-contrib-ads.min.css?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/videojs/plugins/contrib-ads/videojs-contrib-ads.min.css "Show differences"))
* [vendor/videojs/plugins/contrib-ads/videojs-contrib-ads.min.js](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/contrib-ads/videojs-contrib-ads.min.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/videojs/plugins/contrib-ads/videojs-contrib-ads.min.js "Show differences"))
* [vendor/videojs/plugins/contrib-ads/videojs.ads.min.css](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/contrib-ads/videojs.ads.min.css?rev=2934695 "Show what was removed (content at revision 3123170)")
  (deleted)
* [vendor/videojs/plugins/contrib-ads/videojs.ads.min.js](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/contrib-ads/videojs.ads.min.js?rev=2934695 "Show what was removed (content at revision 3123170)")
  (deleted)
* [vendor/videojs/plugins/contrib-quality-menu](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/contrib-quality-menu?rev=3123171 "Show entry in browser")
  (added)
* [vendor/videojs/plugins/contrib-quality-menu/index.html](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/contrib-quality-menu/index.html?rev=3123171 "Show entry in browser")
  (added)
* [vendor/videojs/plugins/contrib-quality-menu/videojs-contrib-quality-menu.min.css](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/contrib-quality-menu/videojs-contrib-quality-menu.min.css?rev=3123171 "Show entry in browser")
  (added)
* [vendor/videojs/plugins/contrib-quality-menu/videojs-contrib-quality-menu.min.js](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/contrib-quality-menu/videojs-contrib-quality-menu.min.js?rev=3123171 "Show entry in browser")
  (added)
* [vendor/videojs/plugins/dailymotion](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/dailymotion?rev=2934695 "Show what was removed (content at revision 3123170)")
  (deleted)
* [vendor/videojs/plugins/hotkeys/videojs.hotkeys.js](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/hotkeys/videojs.hotkeys.js?rev=2934695 "Show what was removed (content at revision 3123170)")
  (deleted)
* [vendor/videojs/plugins/ima/videojs.ima.min.css](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/ima/videojs.ima.min.css?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/videojs/plugins/ima/videojs.ima.min.css "Show differences"))
* [vendor/videojs/plugins/ima/videojs.ima.min.js](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/ima/videojs.ima.min.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/videojs/plugins/ima/videojs.ima.min.js "Show differences"))
* [vendor/videojs/plugins/overlay/videojs-overlay.min.js](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/overlay/videojs-overlay.min.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/videojs/plugins/overlay/videojs-overlay.min.js "Show differences"))
* [vendor/videojs/plugins/quality-selector/quality-selector.min.css](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/quality-selector/quality-selector.min.css?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/videojs/plugins/quality-selector/quality-selector.min.css "Show differences"))
* [vendor/videojs/plugins/quality-selector/silvermine-videojs-quality-selector.min.js](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/quality-selector/silvermine-videojs-quality-selector.min.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/videojs/plugins/quality-selector/silvermine-videojs-quality-selector.min.js "Show differences"))
* [vendor/videojs/plugins/videojs-quality-menu](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/videojs-quality-menu?rev=2934695 "Show what was removed (content at revision 3123170)")
  (deleted)
* [vendor/videojs/plugins/vimeo/Vimeo.js](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/vimeo/Vimeo.js?rev=3123171 "Show entry in browser")
  (added)
* [vendor/videojs/plugins/vimeo/Vimeo.min.js](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/vimeo/Vimeo.min.js?rev=3123171 "Show entry in browser")
  (added)
* [vendor/videojs/plugins/vimeo/videojs-vimeo2.min.js](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/vimeo/videojs-vimeo2.min.js?rev=2934695 "Show what was removed (content at revision 3123170)")
  (deleted)
* [vendor/videojs/plugins/youtube/Youtube.js](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/youtube/Youtube.js?rev=3123171 "Show entry in browser")
  (added)
* [vendor/videojs/plugins/youtube/Youtube.min.js](/browser/all-in-one-video-gallery/trunk/vendor/videojs/plugins/youtube/Youtube.min.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/videojs/plugins/youtube/Youtube.min.js "Show differences"))
* [vendor/videojs/video-js.min.css](/browser/all-in-one-video-gallery/trunk/vendor/videojs/video-js.min.css?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/videojs/video-js.min.css "Show differences"))
* [vendor/videojs/video.min.js](/browser/all-in-one-video-gallery/trunk/vendor/videojs/video.min.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/videojs/video.min.js "Show differences"))
* [vendor/vidstack/dash.all.min.js](/browser/all-in-one-video-gallery/trunk/vendor/vidstack/dash.all.min.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/vidstack/dash.all.min.js "Show differences"))
* [vendor/vidstack/dash.all.min.js.map](/browser/all-in-one-video-gallery/trunk/vendor/vidstack/dash.all.min.js.map?rev=2934695 "Show what was removed (content at revision 3123170)")
  (deleted)
* [vendor/vidstack/hls.min.js](/browser/all-in-one-video-gallery/trunk/vendor/vidstack/hls.min.js?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/vendor/vidstack/hls.min.js "Show differences"))
* [vendor/vidstack/hls.min.js.map](/browser/all-in-one-video-gallery/trunk/vendor/vidstack/hls.min.js.map?rev=2934695 "Show what was removed (content at revision 3123170)")
  (deleted)
* [widgets/categories.php](/browser/all-in-one-video-gallery/trunk/widgets/categories.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/widgets/categories.php "Show differences"))
* [widgets/forms/video.php](/browser/all-in-one-video-gallery/trunk/widgets/forms/video.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/widgets/forms/video.php "Show differences"))
* [widgets/video.php](/browser/all-in-one-video-gallery/trunk/widgets/video.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/widgets/video.php "Show differences"))
* [widgets/videos.php](/browser/all-in-one-video-gallery/trunk/widgets/videos.php?rev=3123171 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/3123171/all-in-one-video-gallery/trunk/widgets/videos.php "Show differences"))

**Changeset view not shown**, since the total size (7.6 MB) exceeds
[4.0 MB](/wiki/TracIni#changeset-max_diff_bytes-option)

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3123171)
* [Zip Archive](?format=zip&new=3123171)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_942fa6f9_20250111_125852.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fall-in-one-video-gallery%2Ftrunk%2Fpublic%2Fvideo.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/all-in-one-video-gallery/trunk/public/video.php?rev=3123171 "Revision 3123171")
* Next Revision →
* [Blame](/browser/all-in-one-video-gallery/trunk/public/video.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/all-in-one-video-gallery/trunk/public/video.php)

---

# [source:](/browser?order=name "Go to repository root") [all-in-one-video-gallery](/browser/all-in-one-video-gallery?order=name "View all-in-one-video-gallery")/[trunk](/browser/all-in-one-video-gallery/trunk?order=name "View trunk")/[public](/browser/all-in-one-video-gallery/trunk/public?order=name "View public")/[video.php](/browser/all-in-one-video-gallery/trunk/public/video.php?order=name "View video.php")

View diff against:

View revision:

| [Last change](/changeset/3187342/all-in-one-video-gallery/trunk/public/video.php "View differences") on this file was [3187342](/changeset/3187342/ "View changeset 3187342"), checked in by plugins360, [2 months ago](/timeline?from=2024-11-13T10%3A17%3A26Z&precision=second "See timeline at 11/13/2024 10:17:26 AM") |
| --- |
| Commit Version 3.9.0 |
| **File size:** 23.9 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | /\*\* |
| [4](#L4) | \* Video |
| [5](#L5) | \* |
| [6](#L6) | \* @link    https://plugins360.com |
| [7](#L7) | \* @since   1.0.0 |
| [8](#L8) | \* |
| [9](#L9) | \* @package All\_In\_One\_Video\_Gallery |
| [10](#L10) | \*/ |
| [11](#L11) |  |
| [12](#L12) | // Exit if accessed directly |
| [13](#L13) | if ( ! defined( 'WPINC' ) ) { |
| [14](#L14) | die; |
| [15](#L15) | } |
| [16](#L16) |  |
| [17](#L17) | /\*\* |
| [18](#L18) | \* AIOVG\_Public\_Video class. |
| [19](#L19) | \* |
| [20](#L20) | \* @since 1.0.0 |
| [21](#L21) | \*/ |
| [22](#L22) | class AIOVG\_Public\_Video { |
| [23](#L23) |  |
| [24](#L24) | /\*\* |
| [25](#L25) | \* Get things started. |
| [26](#L26) | \* |
| [27](#L27) | \* @since 1.0.0 |
| [28](#L28) | \*/ |
| [29](#L29) | public function \_\_construct() { |
| [30](#L30) | // Register shortcode(s) |
| [31](#L31) | add\_shortcode( "aiovg\_video", array( $this, "run\_shortcode\_video" ) ); |
| [32](#L32) | } |
| [33](#L33) |  |
| [34](#L34) | /\*\* |
| [35](#L35) | \* Always keep using our custom template for AIOVG player page. |
| [36](#L36) | \* |
| [37](#L37) | \* @since  1.0.0 |
| [38](#L38) | \* @param  string $template The path of the template to include. |
| [39](#L39) | \* @return string $template Filtered template path. |
| [40](#L40) | \*/ |
| [41](#L41) | public function template\_include( $template ) { |
| [42](#L42) | $page\_settings = get\_option( 'aiovg\_page\_settings' ); |
| [43](#L43) |  |
| [44](#L44) | $player\_page\_id = apply\_filters( 'wpml\_object\_id', (int) $page\_settings['player'], 'page' ); |
| [45](#L45) | if ( ! empty( $player\_page\_id ) && is\_page( $player\_page\_id ) ) { |
| [46](#L46) | $template = AIOVG\_PLUGIN\_DIR . 'public/templates/player.php'; |
| [47](#L47) | } |
| [48](#L48) |  |
| [49](#L49) | return $template; |
| [50](#L50) | } |
| [51](#L51) |  |
| [52](#L52) | /\*\* |
| [53](#L53) | \* Remove admin bar from the AIOVG player page. |
| [54](#L54) | \* |
| [55](#L55) | \* @since  3.8.0 |
| [56](#L56) | \* @param  bool  $show\_admin\_bar Whether the admin bar should be shown. |
| [57](#L57) | \* @return bool  $show\_admin\_bar Filtered value. |
| [58](#L58) | \*/ |
| [59](#L59) | public function remove\_admin\_bar( $show\_admin\_bar ) { |
| [60](#L60) | $page\_settings = get\_option( 'aiovg\_page\_settings' ); |
| [61](#L61) |  |
| [62](#L62) | $player\_page\_id = apply\_filters( 'wpml\_object\_id', (int) $page\_settings['player'], 'page' ); |
| [63](#L63) | if ( ! empty( $player\_page\_id ) && is\_page( $player\_page\_id ) ) { |
| [64](#L64) | return false; |
| [65](#L65) | } |
| [66](#L66) |  |
| [67](#L67) | return $show\_admin\_bar; |
| [68](#L68) | } |
| [69](#L69) |  |
| [70](#L70) | /\*\* |
| [71](#L71) | \* Add support for HLS & MPEG-DASH. |
| [72](#L72) | \* |
| [73](#L73) | \* @since  3.0.0 |
| [74](#L74) | \* @param  array $mimes Array of allowed mime types. |
| [75](#L75) | \* @return array        Filtered mime types array. |
| [76](#L76) | \*/ |
| [77](#L77) | public function add\_mime\_types( $mimes ) { |
| [78](#L78) | $mimes['m3u8'] = 'application/x-mpegurl'; |
| [79](#L79) | $mimes['mpd']  = 'application/dash+xml'; |
| [80](#L80) |  |
| [81](#L81) | return $mimes; |
| [82](#L82) | } |
| [83](#L83) |  |
| [84](#L84) | /\*\* |
| [85](#L85) | \* Run the shortcode [aiovg\_video]. |
| [86](#L86) | \* |
| [87](#L87) | \* @since  1.0.0 |
| [88](#L88) | \* @param  array  $attributes An associative array of attributes. |
| [89](#L89) | \* @param  string $content    Enclosing content. |
| [90](#L90) | \* @return string             Shortcode output. |
| [91](#L91) | \*/ |
| [92](#L92) | public function run\_shortcode\_video( $attributes, $content = null ) { |
| [93](#L93) | if ( ! is\_array( $attributes ) ) { |
| [94](#L94) | $attributes = array(); |
| [95](#L95) | } |
| [96](#L96) |  |
| [97](#L97) | $attributes['shortcode'] = 'aiovg\_video'; |
| [98](#L98) | $post\_id = 0; |
| [99](#L99) |  |
| [100](#L100) | if ( isset( $attributes['id'] ) && ! empty( $attributes['id'] ) ) { |
| [101](#L101) | $post\_id = (int) $attributes['id']; |
| [102](#L102) | $post\_status = get\_post\_status( $post\_id ); |
| [103](#L103) |  |
| [104](#L104) | $has\_permission = true; |
| [105](#L105) |  |
| [106](#L106) | if ( 'publish' != $post\_status ) { |
| [107](#L107) | $has\_permission = false; |
| [108](#L108) |  |
| [109](#L109) | if ( 'private' == $post\_status ) { |
| [110](#L110) | if ( current\_user\_can( 'read\_private\_aiovg\_videos' ) ) { |
| [111](#L111) | $has\_permission = true; |
| [112](#L112) | } |
| [113](#L113) | } |
| [114](#L114) | } |
| [115](#L115) |  |
| [116](#L116) | $has\_permission = apply\_filters( 'aiovg\_read\_private\_videos', $has\_permission, $attributes, $content ); |
| [117](#L117) |  |
| [118](#L118) | if ( ! $has\_permission ) { |
| [119](#L119) | return ''; |
| [120](#L120) | } |
| [121](#L121) | } else { |
| [122](#L122) | if ( isset( $attributes['src'] ) && ! empty( $attributes['src'] ) ) { |
| [123](#L123) | if ( false !== strpos( $attributes['src'], 'youtube.com' ) || false !== strpos( $attributes['src'], 'youtu.be' ) ) { |
| [124](#L124) | $attributes['youtube'] = aiovg\_resolve\_youtube\_url( $attributes['src'] ); |
| [125](#L125) | } elseif ( false !== strpos( $attributes['src'], 'vimeo.com' ) ) { |
| [126](#L126) | $attributes['vimeo'] = $attributes['src']; |
| [127](#L127) | } elseif ( false !== strpos( $attributes['src'], 'dailymotion.com' ) ) { |
| [128](#L128) | $attributes['dailymotion'] = $attributes['src']; |
| [129](#L129) | } elseif ( false !== strpos( $attributes['src'], 'rumble.com' ) ) { |
| [130](#L130) | $attributes['rumble'] = $attributes['src']; |
| [131](#L131) | } elseif ( false !== strpos( $attributes['src'], 'facebook.com' ) ) { |
| [132](#L132) | $attributes['facebook'] = $attributes['src']; |
| [133](#L133) | } else { |
| [134](#L134) | $filetype = wp\_check\_filetype( $attributes['src'] ); |
| [135](#L135) |  |
| [136](#L136) | if ( 'webm' == $filetype['ext'] ) { |
| [137](#L137) | $attributes['webm'] = $attributes['src']; |
| [138](#L138) | } elseif ( 'ogv' == $filetype['ext'] ) { |
| [139](#L139) | $attributes['ogv'] = $attributes['src']; |
| [140](#L140) | } elseif ( 'm3u8' == $filetype['ext'] ) { |
| [141](#L141) | $attributes['hls'] = $attributes['src']; |
| [142](#L142) | } elseif ( 'mpd' == $filetype['ext'] ) { |
| [143](#L143) | $attributes['dash'] = $attributes['src']; |
| [144](#L144) | } else { |
| [145](#L145) | $attributes['mp4'] = $attributes['src']; |
| [146](#L146) | } |
| [147](#L147) | } |
| [148](#L148) |  |
| [149](#L149) | unset( $attributes['src'] ); |
| [150](#L150) | } |
| [151](#L151) |  |
| [152](#L152) | $supported\_formats = array( 'mp4', 'webm', 'ogv', 'hls', 'dash', 'youtube', 'vimeo', 'dailymotion', 'rumble', 'facebook' ); |
| [153](#L153) | $is\_video\_available = 0; |
| [154](#L154) |  |
| [155](#L155) | foreach ( $supported\_formats as $format ) { |
| [156](#L156) | if ( isset( $attributes[ $format ] ) ) { |
| [157](#L157) | $attributes[ $format ] = aiovg\_sanitize\_url( $attributes[ $format ] ); |
| [158](#L158) | $is\_video\_available = 1; |
| [159](#L159) | break; |
| [160](#L160) | } |
| [161](#L161) | } |
| [162](#L162) |  |
| [163](#L163) | if ( isset( $attributes['poster'] ) ) { |
| [164](#L164) | $attributes['poster'] = aiovg\_sanitize\_url( $attributes['poster'] ); |
| [165](#L165) | } |
| [166](#L166) |  |
| [167](#L167) | if ( 0 == $is\_video\_available ) { |
| [168](#L168) | $is\_singular   = is\_singular( 'aiovg\_videos' ); |
| [169](#L169) | $in\_the\_loop   = apply\_filters( 'aiovg\_the\_content\_in\_the\_loop', in\_the\_loop() ); |
| [170](#L170) | $is\_main\_query = apply\_filters( 'aiovg\_the\_content\_is\_main\_query', is\_main\_query() ); |
| [171](#L171) |  |
| [172](#L172) | $category = isset( $attributes['category'] ) ? $attributes['category'] : ''; |
| [173](#L173) | $tag      = isset( $attributes['tag'] ) ? $attributes['tag'] : ''; |
| [174](#L174) | $featured = isset( $attributes['featured'] ) ? (int) $attributes['featured'] : 0; |
| [175](#L175) | $orderby  = isset( $attributes['orderby'] ) ? sanitize\_text\_field( $attributes['orderby'] ) : ''; |
| [176](#L176) | $order    = isset( $attributes['order'] ) ? sanitize\_text\_field( $attributes['order'] ) : 'desc'; |
| [177](#L177) |  |
| [178](#L178) | if ( ! empty( $category ) || ! empty( $tag ) || ! empty( $featured ) || ! empty( $orderby ) ) { |
| [179](#L179) | $is\_singular = false; |
| [180](#L180) | } |
| [181](#L181) |  |
| [182](#L182) | if ( $is\_singular && $in\_the\_loop && $is\_main\_query ) { |
| [183](#L183) | $post\_id = get\_the\_ID(); |
| [184](#L184) | $attributes['id'] = $post\_id; |
| [185](#L185) | } else { |
| [186](#L186) | $args = array( |
| [187](#L187) | 'post\_type' => 'aiovg\_videos', |
| [188](#L188) | 'post\_status' => 'publish', |
| [189](#L189) | 'posts\_per\_page' => 1, |
| [190](#L190) | 'fields' => 'ids', |
| [191](#L191) | 'no\_found\_rows' => true, |
| [192](#L192) | 'update\_post\_term\_cache' => false, |
| [193](#L193) | 'update\_post\_meta\_cache' => false |
| [194](#L194) | ); |
| [195](#L195) |  |
| [196](#L196) | // Taxonomy Parameters |
| [197](#L197) | $tax\_queries = array(); |
| [198](#L198) |  |
| [199](#L199) | if ( ! empty( $category ) ) { // Category |
| [200](#L200) | $tax\_queries[] = array( |
| [201](#L201) | 'taxonomy'         => 'aiovg\_categories', |
| [202](#L202) | 'field'            => 'term\_id', |
| [203](#L203) | 'terms'            => is\_array( $category ) ? array\_map( 'intval', $category ) : array\_map( 'intval', explode( ',', $category ) ), |
| [204](#L204) | 'include\_children' => false |
| [205](#L205) | ); |
| [206](#L206) | } |
| [207](#L207) |  |
| [208](#L208) | if ( ! empty( $tag ) ) { // Tag |
| [209](#L209) | $tax\_queries[] = array( |
| [210](#L210) | 'taxonomy'         => 'aiovg\_tags', |
| [211](#L211) | 'field'            => 'term\_id', |
| [212](#L212) | 'terms'            => is\_array( $tag ) ? array\_map( 'intval', $tag ) : array\_map( 'intval', explode( ',', $tag ) ), |
| [213](#L213) | 'include\_children' => false |
| [214](#L214) | ); |
| [215](#L215) | } |
| [216](#L216) |  |
| [217](#L217) | $count\_tax\_queries = count( $tax\_queries ); |
| [218](#L218) | if ( $count\_tax\_queries ) { |
| [219](#L219) | $args['tax\_query'] = ( $count\_tax\_queries > 1 ) ? array\_merge( array( 'relation' => 'AND' ), $tax\_queries ) : $tax\_queries; |
| [220](#L220) | } |
| [221](#L221) |  |
| [222](#L222) | // Custom Field (post meta) Parameters |
| [223](#L223) | $meta\_queries = array(); |
| [224](#L224) |  |
| [225](#L225) | if ( 'likes' == $orderby ) { // Likes |
| [226](#L226) | $meta\_queries['likes'] = array( |
| [227](#L227) | 'relation' => 'OR', |
| [228](#L228) | array( |
| [229](#L229) | 'key'     => 'likes', |
| [230](#L230) | 'compare' => 'NOT EXISTS' |
| [231](#L231) | ), |
| [232](#L232) | array( |
| [233](#L233) | 'key'     => 'likes', |
| [234](#L234) | 'type'    => 'NUMERIC', |
| [235](#L235) | 'compare' => 'EXISTS' |
| [236](#L236) | ) |
| [237](#L237) | ); |
| [238](#L238) | } |
| [239](#L239) |  |
| [240](#L240) | if ( 'dislikes' == $orderby ) { // Dislikes |
| [241](#L241) | $meta\_queries['dislikes'] = array( |
| [242](#L242) | 'relation' => 'OR', |
| [243](#L243) | array( |
| [244](#L244) | 'key'     => 'dislikes', |
| [245](#L245) | 'compare' => 'NOT EXISTS' |
| [246](#L246) | ), |
| [247](#L247) | array( |
| [248](#L248) | 'key'     => 'dislikes', |
| [249](#L249) | 'type'    => 'NUMERIC', |
| [250](#L250) | 'compare' => 'EXISTS' |
| [251](#L251) | ) |
| [252](#L252) | ); |
| [253](#L253) | } |
| [254](#L254) |  |
| [255](#L255) | if ( ! empty( $featured ) ) { // Featured |
| [256](#L256) | $meta\_queries['featured'] = array( |
| [257](#L257) | 'key'     => 'featured', |
| [258](#L258) | 'value'   => 1, |
| [259](#L259) | 'compare' => '=' |
| [260](#L260) | ); |
| [261](#L261) | } |
| [262](#L262) |  |
| [263](#L263) | $count\_meta\_queries = count( $meta\_queries ); |
| [264](#L264) | if ( $count\_meta\_queries ) { |
| [265](#L265) | $args['meta\_query'] = ( $count\_meta\_queries > 1 ) ? array\_merge( array( 'relation' => 'AND' ), $meta\_queries ) : $meta\_queries; |
| [266](#L266) | } |
| [267](#L267) |  |
| [268](#L268) | // Order & Orderby Parameters |
| [269](#L269) | switch ( $orderby ) { |
| [270](#L270) | case 'likes': |
| [271](#L271) | case 'dislikes': |
| [272](#L272) | $args['orderby'] = array( |
| [273](#L273) | $orderby => $order, |
| [274](#L274) | 'date'   => 'DESC' |
| [275](#L275) | ); |
| [276](#L276) | break; |
| [277](#L277) |  |
| [278](#L278) | case 'views': |
| [279](#L279) | $args['meta\_key'] = $orderby; |
| [280](#L280) | $args['orderby']  = 'meta\_value\_num'; |
| [281](#L281) |  |
| [282](#L282) | $args['order']    = $order; |
| [283](#L283) | break; |
| [284](#L284) |  |
| [285](#L285) | case 'rand': |
| [286](#L286) | $args['orderby']  = 'rand'; |
| [287](#L287) | break; |
| [288](#L288) |  |
| [289](#L289) | default: |
| [290](#L290) | if ( ! empty( $orderby ) ) { |
| [291](#L291) | $args['orderby'] = $orderby; |
| [292](#L292) | $args['order']   = $order; |
| [293](#L293) | } |
| [294](#L294) | } |
| [295](#L295) |  |
| [296](#L296) | $args = apply\_filters( 'aiovg\_query\_args', $args, $attributes ); |
| [297](#L297) | $aiovg\_query = new WP\_Query( $args ); |
| [298](#L298) |  |
| [299](#L299) | if ( $aiovg\_query->have\_posts() ) { |
| [300](#L300) | $posts = $aiovg\_query->posts; |
| [301](#L301) | $post\_id = (int) $posts[0]; |
| [302](#L302) |  |
| [303](#L303) | $attributes['id'] = $post\_id; |
| [304](#L304) | } |
| [305](#L305) | } |
| [306](#L306) | } |
| [307](#L307) | } |
| [308](#L308) |  |
| [309](#L309) | // Output |
| [310](#L310) | $show\_title = isset( $attributes['show\_title'] ) ? (int) $attributes['show\_title'] : 0; |
| [311](#L311) | if ( $show\_title && $post\_id > 0 ) { |
| [312](#L312) | $attributes['title'] = get\_the\_title( $post\_id ); |
| [313](#L313) | } |
| [314](#L314) |  |
| [315](#L315) | $attributes = apply\_filters( 'shortcode\_atts\_aiovg\_video', $attributes, $content ); |
| [316](#L316) |  |
| [317](#L317) | $player\_html = aiovg\_get\_player\_html( $post\_id, $attributes ); |
| [318](#L318) |  |
| [319](#L319) | $html = $player\_html; |
| [320](#L320) |  |
| [321](#L321) | if ( isset( $attributes['title'] ) && ! empty( $attributes['title'] ) ) { |
| [322](#L322) | $title\_position = isset( $attributes['title\_position'] ) ? sanitize\_text\_field( $attributes['title\_position'] ) : ''; |
| [323](#L323) |  |
| [324](#L324) | $allowed\_title\_tags = array( 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'div', 'p' ); |
| [325](#L325) | $title\_tag = isset( $attributes['title\_tag'] ) ? sanitize\_key( $attributes['title\_tag'] ) : 'h2'; |
| [326](#L326) | if ( ! in\_array( $title\_tag, $allowed\_title\_tags) ) { |
| [327](#L327) | $title\_tag = 'h2'; |
| [328](#L328) | } |
| [329](#L329) |  |
| [330](#L330) | $html = '<div class="aiovg aiovg-video-shortcode">'; |
| [331](#L331) |  |
| [332](#L332) | switch ( $title\_position ) { |
| [333](#L333) | case 'bottom': |
| [334](#L334) | $html .= sprintf( |
| [335](#L335) | '%1$s<%2$s class="aiovg-player-title">%3$s</%2$s>', |
| [336](#L336) | $player\_html, |
| [337](#L337) | $title\_tag, |
| [338](#L338) | esc\_html( $attributes['title'] ) |
| [339](#L339) | ); |
| [340](#L340) | break; |
| [341](#L341) |  |
| [342](#L342) | default: // top |
| [343](#L343) | $html .= sprintf( |
| [344](#L344) | '<%1$s class="aiovg-player-title">%2$s</%1$s>%3$s', |
| [345](#L345) | $title\_tag, |
| [346](#L346) | esc\_html( $attributes['title'] ), |
| [347](#L347) | $player\_html |
| [348](#L348) | ); |
| [349](#L349) |  |
| [350](#L350) | } |
| [351](#L351) |  |
| [352](#L352) | $html .= '</div>'; |
| [353](#L353) | } |
| [354](#L354) |  |
| [355](#L355) | return $html; |
| [356](#L356) | } |
| [357](#L357) |  |
| [358](#L358) | /\*\* |
| [359](#L359) | \* Filter video sources. |
| [360](#L360) | \* |
| [361](#L361) | \* @since  2.6.5 |
| [362](#L362) | \* @param  array $sources Video sources. |
| [363](#L363) | \* @param  array $params  Player params. |
| [364](#L364) | \* @return array $sources Filtered video sources. |
| [365](#L365) | \*/ |
| [366](#L366) | public function player\_sources( $sources, $params = array() ) { |
| [367](#L367) | $post\_id = 0; |
| [368](#L368) | $type    = ''; |
| [369](#L369) |  |
| [370](#L370) | if ( ! empty( $params ) ) { |
| [371](#L371) | $post\_id = (int) $params['post\_id']; |
| [372](#L372) | } else { |
| [373](#L373) | $post\_id = (int) get\_query\_var( 'aiovg\_video' ); |
| [374](#L374) | } |
| [375](#L375) |  |
| [376](#L376) | if ( $post\_id > 0 ) { |
| [377](#L377) | $type = get\_post\_meta( $post\_id, 'type', true ); |
| [378](#L378) | } |
| [379](#L379) |  |
| [380](#L380) | if ( isset( $sources['mp4'] ) && ! isset( $sources['hls'] ) ) { |
| [381](#L381) | $mp4\_src = $sources['mp4']['src']; |
| [382](#L382) |  |
| [383](#L383) | if ( strpos( $mp4\_src, 'videos.files.wordpress.com' ) !== false && strpos( $mp4\_src, '.mp4' ) !== false ) { |
| [384](#L384) | $hls\_src = str\_replace( '.mp4', '.master.m3u8', $mp4\_src ); |
| [385](#L385) | $has\_hls = 0; |
| [386](#L386) |  |
| [387](#L387) | $query = parse\_url( $mp4\_src, PHP\_URL\_QUERY ); |
| [388](#L388) | parse\_str( $query, $parsed\_url ); |
| [389](#L389) |  |
| [390](#L390) | if ( isset( $parsed\_url['isnew'] ) ) { |
| [391](#L391) | $has\_hls = (int) $parsed\_url['isnew']; |
| [392](#L392) | } else { |
| [393](#L393) | $hls\_response = wp\_remote\_get( $hls\_src ); |
| [394](#L394) |  |
| [395](#L395) | if ( 200 == wp\_remote\_retrieve\_response\_code( $hls\_response ) ) { |
| [396](#L396) | $has\_hls = 1; |
| [397](#L397) | } |
| [398](#L398) |  |
| [399](#L399) | if ( $post\_id > 0 && 'default' == $type ) { |
| [400](#L400) | update\_post\_meta( $post\_id, 'mp4', aiovg\_sanitize\_url( add\_query\_arg( 'isnew', $has\_hls, $mp4\_src ) ) ); |
| [401](#L401) | } |
| [402](#L402) | } |
| [403](#L403) |  |
| [404](#L404) | if ( $has\_hls ) { |
| [405](#L405) | $hls\_source = array( |
| [406](#L406) | 'hls' => array( |
| [407](#L407) | 'type' => 'application/x-mpegurl', |
| [408](#L408) | 'src'  => $hls\_src |
| [409](#L409) | ) |
| [410](#L410) | ); |
| [411](#L411) |  |
| [412](#L412) | $sources = array\_merge( $hls\_source, $sources ); |
| [413](#L413) | } |
| [414](#L414) | } |
| [415](#L415) | } |
| [416](#L416) |  |
| [417](#L417) | return $sources; |
| [418](#L418) | } |
| [419](#L419) |  |
| [420](#L420) | /\*\* |
| [421](#L421) | \* Filter the post content. |
| [422](#L422) | \* |
| [423](#L423) | \* @since  1.0.0 |
| [424](#L424) | \* @param  string $content Content of the current post. |
| [425](#L425) | \* @return string $content Modified Content. |
| [426](#L426) | \*/ |
| [427](#L427) | public function the\_content( $content ) { |
| [428](#L428) | $in\_the\_loop   = apply\_filters( 'aiovg\_the\_content\_in\_the\_loop', in\_the\_loop() ); |
| [429](#L429) | $is\_main\_query = apply\_filters( 'aiovg\_the\_content\_is\_main\_query', is\_main\_query() ); |
| [430](#L430) |  |
| [431](#L431) | if ( is\_singular( 'aiovg\_videos' ) && $in\_the\_loop && $is\_main\_query ) { |
| [432](#L432) | global $post, $wp\_query; |
| [433](#L433) |  |
| [434](#L434) | if ( $post->ID != $wp\_query->get\_queried\_object\_id() ) { |
| [435](#L435) | return $content; |
| [436](#L436) | } |
| [437](#L437) |  |
| [438](#L438) | if ( post\_password\_required( $post->ID ) ) { |
| [439](#L439) | return $content; |
| [440](#L440) | } |
| [441](#L441) |  |
| [442](#L442) | // Vars |
| [443](#L443) | $video\_settings = get\_option( 'aiovg\_video\_settings' ); |
| [444](#L444) | $related\_videos\_settings = get\_option( 'aiovg\_related\_videos\_settings' ); |
| [445](#L445) | $categories\_settings = get\_option( 'aiovg\_categories\_settings' ); |
| [446](#L446) | $likes\_settings = get\_option( 'aiovg\_likes\_settings' ); |
| [447](#L447) |  |
| [448](#L448) | $attributes = array( |
| [449](#L449) | 'id'              => $post->ID, |
| [450](#L450) | 'show\_category'   => isset( $video\_settings['display']['category'] ), |
| [451](#L451) | 'show\_tag'        => isset( $video\_settings['display']['tag'] ), |
| [452](#L452) | 'show\_date'       => isset( $video\_settings['display']['date'] ), |
| [453](#L453) | 'show\_user'       => isset( $video\_settings['display']['user'] ), |
| [454](#L454) | 'show\_views'      => isset( $video\_settings['display']['views'] ), |
| [455](#L455) | 'related'         => isset( $video\_settings['display']['related'] ), |
| [456](#L456) | 'share'           => isset( $video\_settings['display']['share'] ), |
| [457](#L457) | 'columns'         => $related\_videos\_settings['columns'], |
| [458](#L458) | 'limit'           => $related\_videos\_settings['limit'], |
| [459](#L459) | 'orderby'         => $related\_videos\_settings['orderby'], |
| [460](#L460) | 'order'           => $related\_videos\_settings['order'], |
| [461](#L461) | 'show\_pagination' => isset( $related\_videos\_settings['display']['pagination'] ) |
| [462](#L462) | ); |
| [463](#L463) |  |
| [464](#L464) | $show\_like\_button = 0; |
| [465](#L465) | if ( ! empty( $likes\_settings['like\_button'] ) || ! empty( $likes\_settings['dislike\_button'] ) ) { |
| [466](#L466) | $show\_like\_button = 1; |
| [467](#L467) | } |
| [468](#L468) | $attributes['show\_player\_like\_button'] = $show\_like\_button; |
| [469](#L469) |  |
| [470](#L470) | $attributes['categories'] = wp\_get\_object\_terms( |
| [471](#L471) | get\_the\_ID(), |
| [472](#L472) | 'aiovg\_categories', |
| [473](#L473) | array( |
| [474](#L474) | 'orderby' => sanitize\_text\_field( $categories\_settings['orderby'] ), |
| [475](#L475) | 'order'   => sanitize\_text\_field( $categories\_settings['order'] ) |
| [476](#L476) | ) |
| [477](#L477) | ); |
| [478](#L478) |  |
| [479](#L479) | $attributes['tags'] = wp\_get\_object\_terms( |
| [480](#L480) | get\_the\_ID(), |
| [481](#L481) | 'aiovg\_tags', |
| [482](#L482) | array( |
| [483](#L483) | 'orderby' => sanitize\_text\_field( $categories\_settings['orderby'] ), |
| [484](#L484) | 'order'   => sanitize\_text\_field( $categories\_settings['order'] ) |
| [485](#L485) | ) |
| [486](#L486) | ); |
| [487](#L487) |  |
| [488](#L488) | // Enqueue dependencies |
| [489](#L489) | wp\_enqueue\_style( AIOVG\_PLUGIN\_SLUG . '-public' ); |
| [490](#L490) |  |
| [491](#L491) | // Process output |
| [492](#L492) | ob\_start(); |
| [493](#L493) | include apply\_filters( 'aiovg\_load\_template', AIOVG\_PLUGIN\_DIR . 'public/templates/single-video.php' ); |
| [494](#L494) | $content = ob\_get\_clean(); |
| [495](#L495) | } |
| [496](#L496) |  |
| [497](#L497) | return $content; |
| [498](#L498) | } |
| [499](#L499) |  |
| [500](#L500) | /\*\* |
| [501](#L501) | \* Filters whether the current video post is open for comments. |
| [502](#L502) | \* |
| [503](#L503) | \* @since 2.5.6 |
| [504](#L504) | \* |
| [505](#L505) | \* @param  bool $open    Whether the current post is open for comments. |
| [506](#L506) | \* @param  int  $post\_id The post ID. |
| [507](#L507) | \* @return bool $open    True if the comments are open, false if not. |
| [508](#L508) | \*/ |
| [509](#L509) | public function comments\_open( $open, $post\_id ) { |
| [510](#L510) | if ( $post\_id > 0 ) { |
| [511](#L511) | $post\_type = get\_post\_type( $post\_id ); |
| [512](#L512) |  |
| [513](#L513) | if ( 'aiovg\_videos' == $post\_type ) { |
| [514](#L514) | $video\_settings = get\_option( 'aiovg\_video\_settings' ); |
| [515](#L515) |  |
| [516](#L516) | $has\_comments = (int) $video\_settings['has\_comments']; |
| [517](#L517) |  |
| [518](#L518) | if ( $has\_comments == 2 ) { // Forcefully enable comments on all the video pages |
| [519](#L519) | $open = true; |
| [520](#L520) | } |
| [521](#L521) |  |
| [522](#L522) | if ( $has\_comments == -2 ) { // Forcefully disable comments on all the video pages |
| [523](#L523) | $open = false; |
| [524](#L524) | } |
| [525](#L525) | } |
| [526](#L526) | } |
| [527](#L527) |  |
| [528](#L528) | return $open; |
| [529](#L529) | } |
| [530](#L530) |  |
| [531](#L531) | /\*\* |
| [532](#L532) | \* Update video views count. |
| [533](#L533) | \* |
| [534](#L534) | \* @since 1.0.0 |
| [535](#L535) | \*/ |
| [536](#L536) | public function ajax\_callback\_update\_views\_count() { |
| [537](#L537) | if ( isset( $\_REQUEST['post\_id'] ) ) { |
| [538](#L538) | $post\_id = (int) $\_REQUEST['post\_id']; |
| [539](#L539) |  |
| [540](#L540) | if ( $post\_id > 0 ) { |
| [541](#L541) | check\_ajax\_referer( 'aiovg\_ajax\_nonce', 'security' ); |
| [542](#L542) | aiovg\_update\_views\_count( $post\_id ); |
| [543](#L543) |  |
| [544](#L544) | // Update video duration if applicable |
| [545](#L545) | if ( isset( $\_REQUEST['duration'] ) ) { |
| [546](#L546) | $duration = (float) $\_REQUEST['duration']; |
| [547](#L547) |  |
| [548](#L548) | if ( $duration > 0 ) { |
| [549](#L549) | $current\_duration = get\_post\_meta( $post\_id, 'duration', true ); |
| [550](#L550) | if ( empty( $current\_duration ) ) { |
| [551](#L551) | $duration = aiovg\_convert\_seconds\_to\_human\_time( $duration ); |
| [552](#L552) | update\_post\_meta( $post\_id, 'duration', $duration ); |
| [553](#L553) | } |
| [554](#L554) | } |
| [555](#L555) | } |
| [556](#L556) | } |
| [557](#L557) | } |
| [558](#L558) |  |
| [559](#L559) | wp\_send\_json\_success(); |
| [560](#L560) | } |
| [561](#L561) |  |
| [562](#L562) | /\*\* |
| [563](#L563) | \* Force download the video file. |
| [564](#L564) | \* |
| [565](#L565) | \* @since 2.5.8 |
| [566](#L566) | \*/ |
| [567](#L567) | public function download\_video() { |
| [568](#L568) | if ( ! isset( $\_GET['vdl'] ) ) { |
| [569](#L569) | return; |
| [570](#L570) | } |
| [571](#L571) |  |
| [572](#L572) | if ( is\_numeric( $\_GET['vdl'] ) ) { |
| [573](#L573) | $file = get\_post\_meta( (int) $\_GET['vdl'], 'mp4', true ); |
| [574](#L574) | $file = aiovg\_make\_url\_absolute( $file ); |
| [575](#L575) | } else { |
| [576](#L576) | $file = get\_transient( sanitize\_text\_field( $\_GET['vdl'] ) ); |
| [577](#L577) | } |
| [578](#L578) |  |
| [579](#L579) | $file = remove\_query\_arg( 'isnew', $file ); |
| [580](#L580) |  |
| [581](#L581) | if ( empty( $file ) ) { |
| [582](#L582) | die( esc\_html\_\_( 'File is not readable or not found.', 'all-in-one-video-gallery' ) ); |
| [583](#L583) | exit; |
| [584](#L584) | } |
| [585](#L585) |  |
| [586](#L586) | // Vars |
| [587](#L587) | $is\_remote\_file = true; |
| [588](#L588) | $formatted\_path = 'url'; |
| [589](#L589) | $mime\_type      = 'video/mp4'; |
| [590](#L590) | $file\_size      = ''; |
| [591](#L591) |  |
| [592](#L592) | // Removing spaces and replacing with %20 ascii code |
| [593](#L593) | $file = preg\_replace( '/\s+/', '%20', trim( $file ) ); |
| [594](#L594) | $file = str\_replace( '         ', '%20', $file ); |
| [595](#L595) | $file = str\_replace( '        ', '%20', $file ); |
| [596](#L596) | $file = str\_replace( '       ', '%20', $file ); |
| [597](#L597) | $file = str\_replace( '      ', '%20', $file ); |
| [598](#L598) | $file = str\_replace( '     ', '%20', $file ); |
| [599](#L599) | $file = str\_replace( '    ', '%20', $file ); |
| [600](#L600) | $file = str\_replace( '   ', '%20', $file ); |
| [601](#L601) | $file = str\_replace( '  ', '%20', $file ); |
| [602](#L602) | $file = str\_replace( ' ', '%20', $file ); |
| [603](#L603) |  |
| [604](#L604) | // Detect the file type |
| [605](#L605) | if ( strpos( $file, home\_url() ) !== false ) { |
| [606](#L606) | $is\_remote\_file = false; |
| [607](#L607) | } |
| [608](#L608) |  |
| [609](#L609) | if ( preg\_match( '#http://#', $file ) || preg\_match( '#https://#', $file ) ) { |
| [610](#L610) | $formatted\_path = 'url'; |
| [611](#L611) | } else { |
| [612](#L612) | $formatted\_path = 'filepath'; |
| [613](#L613) | } |
| [614](#L614) |  |
| [615](#L615) | if ( $formatted\_path == 'url' ) { |
| [616](#L616) | $file\_headers = @get\_headers( $file ); |
| [617](#L617) |  |
| [618](#L618) | if ( is\_array( $file\_headers ) && $file\_headers[0] == 'HTTP/1.1 404 Not Found' ) { |
| [619](#L619) | die( esc\_html\_\_( 'File is not readable or not found.', 'all-in-one-video-gallery' ) ); |
| [620](#L620) | exit; |
| [621](#L621) | } |
| [622](#L622) | } elseif ( $formatted\_path == 'filepath' ) { |
| [623](#L623) | if ( ! @is\_readable( $file ) ) { |
| [624](#L624) | die( esc\_html\_\_( 'File is not readable or not found.', 'all-in-one-video-gallery' ) ); |
| [625](#L625) | exit; |
| [626](#L626) | } |
| [627](#L627) | } |
| [628](#L628) |  |
| [629](#L629) | // Fetching File Size |
| [630](#L630) | if ( $is\_remote\_file || $formatted\_path == 'url' ) { |
| [631](#L631) | $data = @get\_headers( $file, true ); |
| [632](#L632) |  |
| [633](#L633) | if ( ! empty( $data['Content-Length'] ) ) { |
| [634](#L634) | $file\_size = (int) $data[ 'Content-Length' ]; |
| [635](#L635) | } else { |
| [636](#L636) | // If get\_headers fails then try to fetch fileSize with curl |
| [637](#L637) | $ch = @curl\_init(); |
| [638](#L638) |  |
| [639](#L639) | if ( ! @curl\_setopt( $ch, CURLOPT\_URL, $file ) ) { |
| [640](#L640) | @curl\_close( $ch ); |
| [641](#L641) | @exit; |
| [642](#L642) | } |
| [643](#L643) |  |
| [644](#L644) | @curl\_setopt( $ch, CURLOPT\_NOBODY, true ); |
| [645](#L645) | @curl\_setopt( $ch, CURLOPT\_RETURNTRANSFER, true ); |
| [646](#L646) | @curl\_setopt( $ch, CURLOPT\_HEADER, true ); |
| [647](#L647) | @curl\_setopt( $ch, CURLOPT\_FOLLOWLOCATION, true ); |
| [648](#L648) | @curl\_setopt( $ch, CURLOPT\_MAXREDIRS, 3 ); |
| [649](#L649) | @curl\_setopt( $ch, CURLOPT\_CONNECTTIMEOUT, 10 ); |
| [650](#L650) | @curl\_exec( $ch ); |
| [651](#L651) |  |
| [652](#L652) | if ( ! @curl\_errno( $ch ) ) { |
| [653](#L653) | $http\_status = (int) @curl\_getinfo( $ch, CURLINFO\_HTTP\_CODE ); |
| [654](#L654) | if ( $http\_status >= 200 && $http\_status <= 300 ) |
| [655](#L655) | $file\_size = (int) @curl\_getinfo( $ch, CURLINFO\_CONTENT\_LENGTH\_DOWNLOAD ); |
| [656](#L656) | } |
| [657](#L657) |  |
| [658](#L658) | @curl\_close( $ch ); |
| [659](#L659) | } |
| [660](#L660) | } elseif ( $formatted\_path == 'filepath' ) { |
| [661](#L661) | $file\_size = (int) @filesize( $file ); |
| [662](#L662) | } |
| [663](#L663) |  |
| [664](#L664) | // Get the extension of the file |
| [665](#L665) | $path = @parse\_url( $file, PHP\_URL\_PATH ); |
| [666](#L666) | $ext  = @pathinfo( $path, PATHINFO\_EXTENSION ); |
| [667](#L667) |  |
| [668](#L668) | switch ( $ext ) { |
| [669](#L669) | case 'mp3': |
| [670](#L670) | $mime\_type = "audio/mpeg"; |
| [671](#L671) | break; |
| [672](#L672) | case 'wav': |
| [673](#L673) | $mime\_type = "audio/x-wav"; |
| [674](#L674) | break; |
| [675](#L675) | case 'au': |
| [676](#L676) | $mime\_type = "audio/basic"; |
| [677](#L677) | break; |
| [678](#L678) | case 'snd': |
| [679](#L679) | $mime\_type = "audio/basic"; |
| [680](#L680) | break; |
| [681](#L681) | case 'm3u': |
| [682](#L682) | $mime\_type = "audio/x-mpegurl"; |
| [683](#L683) | break; |
| [684](#L684) | case 'ra': |
| [685](#L685) | $mime\_type = "audio/x-pn-realaudio"; |
| [686](#L686) | break; |
| [687](#L687) | case 'mp2': |
| [688](#L688) | $mime\_type = "video/mpeg"; |
| [689](#L689) | break; |
| [690](#L690) | case 'mov': |
| [691](#L691) | $mime\_type = "video/quicktime"; |
| [692](#L692) | break; |
| [693](#L693) | case 'qt': |
| [694](#L694) | $mime\_type = "video/quicktime"; |
| [695](#L695) | break; |
| [696](#L696) | case 'mp4': |
| [697](#L697) | $mime\_type = "video/mp4"; |
| [698](#L698) | break; |
| [699](#L699) | case 'webm': |
| [700](#L700) | $mime\_type = "video/webm"; |
| [701](#L701) | break; |
| [702](#L702) | case 'ogv': |
| [703](#L703) | $mime\_type = "video/ogg"; |
| [704](#L704) | break; |
| [705](#L705) | case 'm4v': |
| [706](#L706) | $mime\_type = "video/x-m4v"; |
| [707](#L707) | break; |
| [708](#L708) | case 'm4a': |
| [709](#L709) | $mime\_type = "audio/mp4"; |
| [710](#L710) | break; |
| [711](#L711) | case 'mp4a': |
| [712](#L712) | $mime\_type = "audio/mp4"; |
| [713](#L713) | break; |
| [714](#L714) | case 'm4p': |
| [715](#L715) | $mime\_type = "audio/mp4"; |
| [716](#L716) | break; |
| [717](#L717) | case 'm3a': |
| [718](#L718) | $mime\_type = "audio/mpeg"; |
| [719](#L719) | break; |
| [720](#L720) | case 'm2a': |
| [721](#L721) | $mime\_type = "audio/mpeg"; |
| [722](#L722) | break; |
| [723](#L723) | case 'mp2a': |
| [724](#L724) | $mime\_type = "audio/mpeg"; |
| [725](#L725) | break; |
| [726](#L726) | case 'mp2': |
| [727](#L727) | $mime\_type = "audio/mpeg"; |
| [728](#L728) | break; |
| [729](#L729) | case 'mpga': |
| [730](#L730) | $mime\_type = "audio/mpeg"; |
| [731](#L731) | break; |
| [732](#L732) | case '3gp': |
| [733](#L733) | $mime\_type = "video/3gpp"; |
| [734](#L734) | break; |
| [735](#L735) | case '3g2': |
| [736](#L736) | $mime\_type = "video/3gpp2"; |
| [737](#L737) | break; |
| [738](#L738) | case 'mp4v': |
| [739](#L739) | $mime\_type = "video/mp4"; |
| [740](#L740) | break; |
| [741](#L741) | case 'mpg4': |
| [742](#L742) | $mime\_type = "video/mp4"; |
| [743](#L743) | break; |
| [744](#L744) | case 'm2v': |
| [745](#L745) | $mime\_type = "video/mpeg"; |
| [746](#L746) | break; |
| [747](#L747) | case 'm1v': |
| [748](#L748) | $mime\_type = "video/mpeg"; |
| [749](#L749) | break; |
| [750](#L750) | case 'mpe': |
| [751](#L751) | $mime\_type = "video/mpeg"; |
| [752](#L752) | break; |
| [753](#L753) | case 'avi': |
| [754](#L754) | $mime\_type = "video/x-msvideo"; |
| [755](#L755) | break; |
| [756](#L756) | case 'midi': |
| [757](#L757) | $mime\_type = "audio/midi"; |
| [758](#L758) | break; |
| [759](#L759) | case 'mid': |
| [760](#L760) | $mime\_type = "audio/mid"; |
| [761](#L761) | break; |
| [762](#L762) | case 'amr': |
| [763](#L763) | $mime\_type = "audio/amr"; |
| [764](#L764) | break; |
| [765](#L765) |  |
| [766](#L766) | default: |
| [767](#L767) | $mime\_type = "application/octet-stream"; |
| [768](#L768) | } |
| [769](#L769) |  |
| [770](#L770) | if ( 'application/octet-stream' == $mime\_type ) { |
| [771](#L771) | die( esc\_html\_\_( 'Invalid file format.', 'all-in-one-video-gallery' ) ); |
| [772](#L772) | exit; |
| [773](#L773) | } |
| [774](#L774) |  |
| [775](#L775) | // Off output buffering to decrease Server usage |
| [776](#L776) | @ob\_end\_clean(); |
| [777](#L777) |  |
| [778](#L778) | if ( ini\_get( 'zlib.output\_compression' ) ) { |
| [779](#L779) | ini\_set( 'zlib.output\_compression', 'Off' ); |
| [780](#L780) | } |
| [781](#L781) |  |
| [782](#L782) | header( 'Content-Description: File Transfer' ); |
| [783](#L783) | header( 'Content-Type: '. $mime\_type ); |
| [784](#L784) | header( 'Content-Disposition: attachment; filename=' . (string) @basename( $file ) ); |
| [785](#L785) | header( 'Content-Transfer-Encoding: binary' ); |
| [786](#L786) | header( 'Expires: Wed, 07 May 2013 09:09:09 GMT' ); |
| [787](#L787) | header( 'Last-Modified: ' . gmdate( 'D, d M Y H:i:s' ) . ' GMT' ); |
| [788](#L788) | header( 'Cache-Control: post-check=0, pre-check=0', false ); |
| [789](#L789) | header( 'Cache-Control: no-store, no-cache, must-revalidate' ); |
| [790](#L790) | header( 'Pragma: no-cache' ); |
| [791](#L791) | header( 'Content-Length: '. $file\_size); |
| [792](#L792) |  |
| [793](#L793) | // Will Download 1 MB in chunkwise |
| [794](#L794) | $chunk = 1 \* ( 1024 \* 1024 ); |
| [795](#L795) |  |
| [796](#L796) | if ( $nfile = @fopen( $file, 'rb' ) ) { |
| [797](#L797) | while ( ! feof( $nfile ) ) { |
| [798](#L798) | print( @fread( $nfile, $chunk ) ); |
| [799](#L799) | @ob\_flush(); |
| [800](#L800) | @flush(); |
| [801](#L801) | } |
| [802](#L802) | @fclose( $nfile ); |
| [803](#L803) | } |
| [804](#L804) | } |
| [805](#L805) |  |
| [806](#L806) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/all-in-one-video-gallery/trunk/public/video.php?format=txt)
* [Original Format](/export/3220698/all-in-one-video-gallery/trunk/public/video.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


