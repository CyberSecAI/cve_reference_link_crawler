<html lang="en" op="item"><head><meta name="referrer" content="origin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" type="text/css" href="news.css?jZ4kyxqAt22XaoTPqDid">
        <link rel="icon" href="y18.svg">
    <link rel="canonical" href="https://news.ycombinator.com/item?id=38405731"/>            <title>ZFS silent corruption bug found: replaces chunks inside copied files by zeroes | Hacker News</title></head><body><center><table id="hnmain" border="0" cellpadding="0" cellspacing="0" width="85%" bgcolor="#f6f6ef">
        <tr><td bgcolor="#ff6600"><table border="0" cellpadding="0" cellspacing="0" width="100%" style="padding:2px"><tr><td style="width:18px;padding-right:4px"><a href="https://news.ycombinator.com"><img src="y18.svg" width="18" height="18" style="border:1px white solid; display:block"></a></td>
                  <td style="line-height:12pt; height:10px;"><span class="pagetop"><b class="hnname"><a href="news">Hacker News</a></b>
                            <a href="newest">new</a> | <a href="front">past</a> | <a href="newcomments">comments</a> | <a href="ask">ask</a> | <a href="show">show</a> | <a href="jobs">jobs</a> | <a href="submit" rel="nofollow">submit</a>            </span></td><td style="text-align:right;padding-right:4px;"><span class="pagetop">
                              <a href="login?goto=item%3Fid%3D38405731">login</a>
                          </span></td>
              </tr></table></td></tr>
<tr id="pagespace" title="ZFS silent corruption bug found: replaces chunks inside copied files by zeroes" style="height:10px"></tr><tr><td><table class="fatitem" border="0">
        <tr class='athing submission' id='38405731'>
      <td align="right" valign="top" class="title"><span class="rank"></span></td>      <td valign="top" class="votelinks"><center><a id='up_38405731' href='vote?id=38405731&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center></td><td class="title"><span class="titleline"><a href="https://github.com/openzfs/zfs/issues/15526">ZFS silent corruption bug found: replaces chunks inside copied files by zeroes</a><span class="sitebit comhead"> (<a href="from?site=github.com/openzfs"><span class="sitestr">github.com/openzfs</span></a>)</span></span></td></tr><tr><td colspan="2"></td><td class="subtext"><span class="subline">
          <span class="score" id="score_38405731">101 points</span> by <a href="user?id=csdvrx" class="hnuser">csdvrx</a> <span class="age" title="2023-11-24T16:41:31 1700844091"><a href="item?id=38405731">on Nov 24, 2023</a></span> <span id="unv_38405731"></span> | <a href="hide?id=38405731&amp;goto=item%3Fid%3D38405731">hide</a> | <a href="https://hn.algolia.com/?query=ZFS%20silent%20corruption%20bug%20found%3A%20replaces%20chunks%20inside%20copied%20files%20by%20zeroes&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0" class="hnpast">past</a> | <a href="fave?id=38405731&amp;auth=1e44d37a86a9383c4a967f37548455ac4b6b0700">favorite</a> | <a href="item?id=38405731">40&nbsp;comments</a>        </span>
              </td></tr>
        </table><br><br><table border="0" class='comment-tree'>
            <tr class='athing comtr' id='38408993'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_38408993' href='vote?id=38408993&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=ptx" class="hnuser">ptx</a> <span class="age" title="2023-11-24T22:17:22 1700864242"><a href="item?id=38408993">on Nov 24, 2023</a></span> <span id="unv_38408993"></span>          <span class='navs'>
             | <a href="#38405732" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38408993" n="6" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">The recent FreeBSD 14 release apparently failed to build for one of the platforms because a file &quot;somehow ended up being full of NUL bytes&quot; [0]. I wonder if that&#x27;s due to this bug? (Could be just a coincidence, of course.)<p>OpenZFS 2.1.4 was included in FreeBSD 13.1, according to the release notes.<p>[0] <a href="https:&#x2F;&#x2F;www.daemonology.net&#x2F;blog&#x2F;2023-11-21-late-breaking-FreeBSD-14-breakage.html" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.daemonology.net&#x2F;blog&#x2F;2023-11-21-late-breaking-Fr...</a></div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38425599'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_38425599' href='vote?id=38425599&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=cperciva" class="hnuser">cperciva</a> <span class="age" title="2023-11-26T22:17:47 1701037067"><a href="item?id=38425599">on Nov 26, 2023</a></span> <span id="unv_38425599"></span>          <span class='navs'>
             | <a href="#38408993" class="clicky" aria-hidden="true">parent</a> | <a href="#38419202" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38425599" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00"><i>I wonder if that&#x27;s due to this bug?</i><p>It&#x27;s definitely possible.  Once we get this bug patched I&#x27;ll definitely be updating the builders.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='38419202'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_38419202' href='vote?id=38419202&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=inferiorhuman" class="hnuser">inferiorhuman</a> <span class="age" title="2023-11-26T04:37:43 1700973463"><a href="item?id=38419202">on Nov 26, 2023</a></span> <span id="unv_38419202"></span>          <span class='navs'>
             | <a href="#38408993" class="clicky" aria-hidden="true">parent</a> | <a href="#38425599" class="clicky" aria-hidden="true">prev</a> | <a href="#38405732" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38419202" n="4" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c5A"><i>looks at the list</i><p><i>looks at the FreeBSD 14.0 errata on freebsd.org</i><p>This is precisely why I wouldn&#x27;t run FreeBSD in production.  Look at this shit.<p>- You need to freebsd-update fetch install before you upgrade<p>- EC2 AMIs can&#x27;t handle binary user-data<p>- FreeBSD Update reports 14.0-RELEASE approaching its EoL<p>Two ways to break booting and one really stupid mistake and <i>NONE</i> of it is listed on freebsd.org.  Sigh.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38423131'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_38423131' href='vote?id=38423131&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=wkat4242" class="hnuser">wkat4242</a> <span class="age" title="2023-11-26T17:08:50 1701018530"><a href="item?id=38423131">on Nov 26, 2023</a></span> <span id="unv_38423131"></span>          <span class='navs'>
             | <a href="#38408993" class="clicky" aria-hidden="true">root</a> | <a href="#38419202" class="clicky" aria-hidden="true">parent</a> | <a href="#38405732" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38423131" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">freebsd-update fetch install is part of the normal upgrade process. So yeah of course that&#x27;s necessary, it&#x27;s how you upgrade.<p>Not sure what #2 is about, I don&#x27;t use cloud.<p>And the EoL thing did not happen to me, I did hear of it happening though but it&#x27;s not omnipresent.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38427532'><td><table border='0'>  <tr>    <td class='ind' indent='3'><img src="s.gif" height="1" width="120"></td><td valign="top" class="votelinks">
      <center><a id='up_38427532' href='vote?id=38427532&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=inferiorhuman" class="hnuser">inferiorhuman</a> <span class="age" title="2023-11-27T02:51:46 1701053506"><a href="item?id=38427532">on Nov 27, 2023</a></span> <span id="unv_38427532"></span>          <span class='navs'>
             | <a href="#38408993" class="clicky" aria-hidden="true">root</a> | <a href="#38423131" class="clicky" aria-hidden="true">parent</a> | <a href="#38405732" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38427532" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00"><p><pre><code>  freebsd-update fetch install is part of the normal upgrade process
</code></pre>
If the man page and literally every other piece of documentation about upgrading is correct: no, no it&#x27;s not.  If the intent of freebsd-update were only to allow migration from the latest patch level, it would fail instead of corrupting its state, no?<p>The only caveat provided by the freebsd-update man page is the admonishment to read the release notes for special instructions, yet the release notes completely fail to mention this footgun.<p>Or is your assertion that intuition should take the place of documentation?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38427839'><td><table border='0'>  <tr>    <td class='ind' indent='4'><img src="s.gif" height="1" width="160"></td><td valign="top" class="votelinks">
      <center><a id='up_38427839' href='vote?id=38427839&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=wkat4242" class="hnuser">wkat4242</a> <span class="age" title="2023-11-27T03:51:56 1701057116"><a href="item?id=38427839">on Nov 27, 2023</a></span> <span id="unv_38427839"></span>          <span class='navs'>
             | <a href="#38408993" class="clicky" aria-hidden="true">root</a> | <a href="#38427532" class="clicky" aria-hidden="true">parent</a> | <a href="#38405732" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38427839" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">When I upgraded I was sure it told me to be on the latest using this. I&#x27;ll check where I read that, I don&#x27;t think it was in the handbook but elsewhere on the site.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                                    <tr class='athing comtr' id='38405732'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_38405732' href='vote?id=38405732&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=csdvrx" class="hnuser">csdvrx</a> <span class="age" title="2023-11-24T16:41:31 1700844091"><a href="item?id=38405732">on Nov 24, 2023</a></span> <span id="unv_38405732"></span>          <span class='navs'>
             | <a href="#38408993" class="clicky" aria-hidden="true">prev</a> | <a href="#38409408" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38405732" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">The root cause of the bug may have been present for a long time.<p>It increased in probability a bit after 2.1.4 (when zfs_dmu_offset_next_sync=1 became the default), and even more after 2.2.0 (with block cloning)<p>Quick workaround: echo 0 &gt; &#x2F;sys&#x2F;module&#x2F;zfs&#x2F;parameters&#x2F;zfs_dmu_offset_next_sync</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='38409408'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_38409408' href='vote?id=38409408&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=AndrewDavis" class="hnuser">AndrewDavis</a> <span class="age" title="2023-11-24T23:13:12 1700867592"><a href="item?id=38409408">on Nov 24, 2023</a></span> <span id="unv_38409408"></span>          <span class='navs'>
             | <a href="#38405732" class="clicky" aria-hidden="true">prev</a> | <a href="#38422646" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38409408" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">RobN has opened a PR consisting of the patch he asked people to test in the issue.<p><a href="https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;pull&#x2F;15571">https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;pull&#x2F;15571</a><p>Pretty crazy the bug might date back 10 years.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='38422646'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_38422646' href='vote?id=38422646&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=n8henrie" class="hnuser">n8henrie</a> <span class="age" title="2023-11-26T16:09:49 1701014989"><a href="item?id=38422646">on Nov 26, 2023</a></span> <span id="unv_38422646"></span>          <span class='navs'>
             | <a href="#38409408" class="clicky" aria-hidden="true">prev</a> | <a href="#38411811" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38422646" n="4" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">For those just wondering &quot;am I affected?&quot;, my understanding is:<p><pre><code>    zpool get all | grep bclone
</code></pre>
&gt; If the result is 0 for both bcloneused and bclonesaved then it&#x27;s safe to say that you don&#x27;t have silent corruption. [0]<p>People are using `reproducer.sh` (<a href="https:&#x2F;&#x2F;gist.github.com&#x2F;tonyhutter&#x2F;d69f305508ae3b7ff6e9263b22031a84#file-reproducer-sh" rel="nofollow noreferrer">https:&#x2F;&#x2F;gist.github.com&#x2F;tonyhutter&#x2F;d69f305508ae3b7ff6e9263b2...</a>) to see if they can reproduce the bug intentionally: [1]<p><a href="https:&#x2F;&#x2F;github.com&#x2F;0x0177b11f&#x2F;zfs-issue-15526-check-file">https:&#x2F;&#x2F;github.com&#x2F;0x0177b11f&#x2F;zfs-issue-15526-check-file</a> tries to find potentially corrupted files (with some risk of false positives) by searching for zero-byte blocks: [2]<p>[0]: <a href="https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-1810819382">https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-181...</a><p>[1]: <a href="https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-1823575126">https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-182...</a><p>[2]: <a href="https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-1826453702">https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-182...</a></div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38439685'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_38439685' href='vote?id=38439685&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=csdvrx" class="hnuser">csdvrx</a> <span class="age" title="2023-11-27T22:53:33 1701125613"><a href="item?id=38439685">on Nov 27, 2023</a></span> <span id="unv_38439685"></span>          <span class='navs'>
             | <a href="#38422646" class="clicky" aria-hidden="true">parent</a> | <a href="#38411811" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38439685" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">&gt; find potentially corrupted files (with some risk of false positives) by searching for zero-byte blocks<p>I believe it&#x27;s not the best method as it will require carefully defining how many null-bytes blocks (and of which size) are a sign of corruption.<p>Another reason is the frequency of corruption was shown to vary during tests, and to be based on the IO load : the observed zero-byte blocks may have been caused by the artificial scenario to intentionally reproduce the bug. Natural occurrences of this bug may have a different pattern.<p>You should use ctime+checksums from old backups instead.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38440672'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_38440672' href='vote?id=38440672&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=n8henrie" class="hnuser">n8henrie</a> <span class="age" title="2023-11-28T00:31:30 1701131490"><a href="item?id=38440672">on Nov 28, 2023</a></span> <span id="unv_38440672"></span>          <span class='navs'>
             | <a href="#38422646" class="clicky" aria-hidden="true">root</a> | <a href="#38439685" class="clicky" aria-hidden="true">parent</a> | <a href="#38411811" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38440672" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Thanks for your input. Do you have any more detailed instructions for the ctime + checksum method?<p>Would a zfs snapshot be sufficient?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38449504'><td><table border='0'>  <tr>    <td class='ind' indent='3'><img src="s.gif" height="1" width="120"></td><td valign="top" class="votelinks">
      <center><a id='up_38449504' href='vote?id=38449504&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=csdvrx" class="hnuser">csdvrx</a> <span class="age" title="2023-11-28T18:43:13 1701196993"><a href="item?id=38449504">on Nov 28, 2023</a></span> <span id="unv_38449504"></span>          <span class='navs'>
             | <a href="#38422646" class="clicky" aria-hidden="true">root</a> | <a href="#38440672" class="clicky" aria-hidden="true">parent</a> | <a href="#38411811" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38449504" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">I will soon prepare some scripts to do that, but I first want to confirm the core ideas and design something that I will only have to do once, and the discussion on <a href="https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-1826075625">https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-182...</a> is still ongoing.<p>If you want more detail about my proposed approach, please check the discussion on <a href="https:&#x2F;&#x2F;old.reddit.com&#x2F;r&#x2F;zfs&#x2F;comments&#x2F;182x5wy&#x2F;with_old_backups_how_to_check_for_silent&#x2F;" rel="nofollow noreferrer">https:&#x2F;&#x2F;old.reddit.com&#x2F;r&#x2F;zfs&#x2F;comments&#x2F;182x5wy&#x2F;with_old_backu...</a><p>I have 18 months of backups, and could go back earlier if needed but accessing and processing each backup will take time. I don&#x27;t want to do that multiple times.<p>Anything you can mount, using any filesystem keeping this metadata, should be usable as in input: this means from NTFS to zfs snapshots. It may even be possible to use ZIP files (which keep date and time) to feed a medata sqlite database.<p>Comparing the metadata DB to the actual ZFS filesystem would give you a list of suspicious files, and the most recent backup you could use to restore them<p>Alternatively, it could be possible to deduplicate all the backups when measuring the metadata, then to keep local copies of all the files, but it may add complexity and storage requirements.<p>If you are in a rush, write a script like that, but given how the null-bytes detection approach now seems flawed, you may have to rewrite that as we learn more details.<p>Also, there&#x27;s no real fix for this bug yet that isn&#x27;t introducing other problems. While we&#x27;re still learning the ins and out of this &gt;18 years old bug, I recommend to keep using a 2.1 version of zfs with zfs_dmu_offset_next_sync=0, and to bet on the low probability of corruption that allowed this bug to persist for such a long time.<p>Of course, keep your cold backups (don&#x27;t delete!) but they can&#x27;t accumulate corruption if you don&#x27;t access them.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                              <tr class='athing comtr' id='38411811'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_38411811' href='vote?id=38411811&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=veidr" class="hnuser">veidr</a> <span class="age" title="2023-11-25T07:02:27 1700895747"><a href="item?id=38411811">on Nov 25, 2023</a></span> <span id="unv_38411811"></span>          <span class='navs'>
             | <a href="#38422646" class="clicky" aria-hidden="true">prev</a> | <a href="#38406714" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38411811" n="6" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">It&#x27;s a very bad bug, so it is important to note there&#x27;s an apparently-effective mitigation[1], which doesn&#x27;t make it impossible to hit, but reduces the risk of it in the real world by a lot.<p><pre><code>    # as root, or equivalent:
    echo 0 &gt; &#x2F;sys&#x2F;module&#x2F;zfs&#x2F;parameters&#x2F;zfs_dmu_offset_next_sync
 </code></pre>
Before making this change, I was able to easily reproduce this bug on all of my ZFS filesystems (using the reproducer.sh[2] script from the bug thread). After making this change, I could no longer reproduce the bug at all.<p>It seems that the bug is relatively rare (although still very bad if it happens) in most real-world scenarios; one user doing a heuristic scan to look for corrupted files found 0.00027% of their files (7 out of ~2,500,000) were likely affected[3].<p>The mitigation above (disabling zfs_dmu_offset_next_sync) seems to reduce those odds of the bug happening significantly. Almost everybody reports they can no longer reproduce the bug after changing it.<p>Note that changing the setting doesn&#x27;t persist across reboots, so you have to automate that somehow (e.g. editing &#x2F;etc&#x2F;modprobe.d&#x2F;zfs.conf or whatever the normal way to control the setting is on your system; the GitHub thread has info for how to do it on Mac and Windows).<p>Why this is a spectacularly bad bug is that it not only corrupts data, but it may be impossible to know if your existing files have been hit by this bug, during its long existence. There is active discussion in the bug thread about what kind of heuristics can be used to find &quot;this file was probably corrupted by the bug&quot; but there&#x27;s no way (so far, and probably ever) to tell for sure (short of having some known-good copy of the file elsewhere to compare it to).<p>Which makes the above mitigation all the more important while we wait for the fix!<p>[1]: the Reddit thread advocating for this is here: <a href="https:&#x2F;&#x2F;www.reddit.com&#x2F;r&#x2F;zfs&#x2F;comments&#x2F;1826lgs&#x2F;psa_its_not_block_cloning_its_a_data_co" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.reddit.com&#x2F;r&#x2F;zfs&#x2F;comments&#x2F;1826lgs&#x2F;psa_its_not_bl...</a>
rruption&#x2F;<p>[2]: <a href="https:&#x2F;&#x2F;gist.github.com&#x2F;masonmark&#x2F;03c7cb08e22968b1f2feb1a6ac3c9701" rel="nofollow noreferrer">https:&#x2F;&#x2F;gist.github.com&#x2F;masonmark&#x2F;03c7cb08e22968b1f2feb1a6ac...</a><p>[3]: <a href="https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-1826182928">https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-182...</a></div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38416934'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_38416934' href='vote?id=38416934&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=qwertox" class="hnuser">qwertox</a> <span class="age" title="2023-11-25T21:38:09 1700948289"><a href="item?id=38416934">on Nov 25, 2023</a></span> <span id="unv_38416934"></span>          <span class='navs'>
             | <a href="#38411811" class="clicky" aria-hidden="true">parent</a> | <a href="#38412052" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38416934" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">It seems that this doesn&#x27;t really fixe the bug [0] and also enables another one [1][2]<p>[0] <a href="https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-1826125014">https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-182...</a><p>[1] <a href="https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-1826378265">https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-182...</a><p>[2] <a href="https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;6958">https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;6958</a></div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38419151'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_38419151' href='vote?id=38419151&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=veidr" class="hnuser">veidr</a> <span class="age" title="2023-11-26T04:25:42 1700972742"><a href="item?id=38419151">on Nov 26, 2023</a></span> <span id="unv_38419151"></span>          <span class='navs'>
             | <a href="#38411811" class="clicky" aria-hidden="true">root</a> | <a href="#38416934" class="clicky" aria-hidden="true">parent</a> | <a href="#38412052" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38419151" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">(&gt;_&lt;) Oh man, I knew about [0] when I posted (which is why I said it just reduces the chance of hitting the bug (by a lot)). But after spending all Saturday JST on it, I went to bed before [1] was posted.<p>Skimming through #6958 though, it seems like it&#x27;s the lesser of evils, compared to #15526... I think? It&#x27;s less obvious (to me) what the impact of #6958 is. Is it silent undetectable corruption of your precious data potentially over years, or more likely to cause a crash or runtime error?<p>Reports like <a href="https:&#x2F;&#x2F;github.com&#x2F;intel&#x2F;bmap-tools&#x2F;issues&#x2F;65">https:&#x2F;&#x2F;github.com&#x2F;intel&#x2F;bmap-tools&#x2F;issues&#x2F;65</a> make it seem more like the latter.<p>But I have to read more. But since the zfs_dmu_offset_next_sync setting was disabled by default until recently, I still suspect (but yeah, don&#x27;t know for sure) that disabling is the safest thing we can currently do on unmodified ZFS systems.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='38412052'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_38412052' href='vote?id=38412052&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=mustache_kimono" class="hnuser">mustache_kimono</a> <span class="age" title="2023-11-25T08:01:06 1700899266"><a href="item?id=38412052">on Nov 25, 2023</a></span> <span id="unv_38412052"></span>          <span class='navs'>
             | <a href="#38411811" class="clicky" aria-hidden="true">parent</a> | <a href="#38416934" class="clicky" aria-hidden="true">prev</a> | <a href="#38419197" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38412052" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">&gt; It seems that the bug is relatively rare (although still very bad if it happens) in most real-world scenarios; one user doing a heuristic scan to look for corrupted files found 0.00027% of their files (7 out of ~2,500,000) were likely affected.<p>I&#x27;m running the following script to detect corruption.[0]  The two files I&#x27;ve found so far seem like false positives.<p>[0]: <a href="https:&#x2F;&#x2F;gist.github.com&#x2F;kimono-koans&#x2F;2696a8c8eac0a6babf7b2d9b26a82f65" rel="nofollow noreferrer">https:&#x2F;&#x2F;gist.github.com&#x2F;kimono-koans&#x2F;2696a8c8eac0a6babf7b2d9...</a></div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38412126'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_38412126' href='vote?id=38412126&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=veidr" class="hnuser">veidr</a> <span class="age" title="2023-11-25T08:26:32 1700900792"><a href="item?id=38412126">on Nov 25, 2023</a></span> <span id="unv_38412126"></span>          <span class='navs'>
             | <a href="#38411811" class="clicky" aria-hidden="true">root</a> | <a href="#38412052" class="clicky" aria-hidden="true">parent</a> | <a href="#38419197" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38412126" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Yeah, I am running a similar script I got from the GitHub bug thread; so far I have not found any suspected-corrupt files at all, except for in the files generated by the reproducer.sh script, e.g.:<p><pre><code>    Possible corruption in &#x2F;mnt&#x2F;slow&#x2F;reproducer_146495_720</code></pre></div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='38419197'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_38419197' href='vote?id=38419197&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=veidr" class="hnuser">veidr</a> <span class="age" title="2023-11-26T04:36:31 1700973391"><a href="item?id=38419197">on Nov 26, 2023</a></span> <span id="unv_38419197"></span>          <span class='navs'>
             | <a href="#38411811" class="clicky" aria-hidden="true">parent</a> | <a href="#38412052" class="clicky" aria-hidden="true">prev</a> | <a href="#38406714" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38419197" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">UPDATE: There is now a very good simple explantaion of the bug, and how it became much more likely to happen recently, even though it has existed for  a very long time:<p><a href="https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-1826412289">https:&#x2F;&#x2F;github.com&#x2F;openzfs&#x2F;zfs&#x2F;issues&#x2F;15526#issuecomment-182...</a></div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='38406714'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_38406714' href='vote?id=38406714&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=remram" class="hnuser">remram</a> <span class="age" title="2023-11-24T18:28:32 1700850512"><a href="item?id=38406714">on Nov 24, 2023</a></span> <span id="unv_38406714"></span>          <span class='navs'>
             | <a href="#38411811" class="clicky" aria-hidden="true">prev</a> | <a href="#38406875" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38406714" n="10" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">dupe: <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38380240">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=38380240</a> (2 days ago)</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38407053'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_38407053' href='vote?id=38407053&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=csdvrx" class="hnuser">csdvrx</a> <span class="age" title="2023-11-24T19:04:27 1700852667"><a href="item?id=38407053">on Nov 24, 2023</a></span> <span id="unv_38407053"></span>          <span class='navs'>
             | <a href="#38406714" class="clicky" aria-hidden="true">parent</a> | <a href="#38406875" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38407053" n="9" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Thanks, I had seen the title with the cloning issue, and I even commented, but I thought it didn&#x27;t apply to me as new features are never deployed until at least a few months have passed and other people have confirmed they work well.<p>I was only worried about the zfs send | zfs receive bug corrupting both pools.<p>I had been too lazy to check the details, so I had missed that the bug could be triggered even when you DON&#x27;T use block cloning at all but just copy files, and even on old versions like 2.1.4: it&#x27;s only the probability of the bug that increases.<p>I only caught this issue through reddit.<p>Now thanks to your link after going through all the github comments I&#x27;m rereading all the comments from the HN thread from 2 days ago to decide how to analyze several months worth of backups, some of them not on ZFS, but all of them sourced from ZFS and therefore now suspicious of silent corruption.<p>Hopefully, this warning will stay long enough in the toplist for affected users to deploy the simple countermeasures or at least preserve their backups until we know how to identify the affected files reliably enough (though number of contiguous zeroes, repeating patterns inside the file etc)</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38407746'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_38407746' href='vote?id=38407746&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=k8svet" class="hnuser">k8svet</a> <span class="age" title="2023-11-24T20:14:58 1700856898"><a href="item?id=38407746">on Nov 24, 2023</a></span> <span id="unv_38407746"></span>          <span class='navs'>
             | <a href="#38406714" class="clicky" aria-hidden="true">root</a> | <a href="#38407053" class="clicky" aria-hidden="true">parent</a> | <a href="#38406875" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38407746" n="8" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Wait, is scrubbing it and checking for errors not sufficient?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38407811'><td><table border='0'>  <tr>    <td class='ind' indent='3'><img src="s.gif" height="1" width="120"></td><td valign="top" class="votelinks">
      <center><a id='up_38407811' href='vote?id=38407811&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=PaulCarrack" class="hnuser">PaulCarrack</a> <span class="age" title="2023-11-24T20:21:32 1700857292"><a href="item?id=38407811">on Nov 24, 2023</a></span> <span id="unv_38407811"></span>          <span class='navs'>
             | <a href="#38406714" class="clicky" aria-hidden="true">root</a> | <a href="#38407746" class="clicky" aria-hidden="true">parent</a> | <a href="#38406875" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38407811" n="7" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">It&#x27;s &quot;silent corruption&quot; so a scrub would not detect it. This is the worst possible scenario which is why this is getting a lot of publicity in contrast to bugs in the past.<p>What&#x27;s worse is that the bug has been in production for 18 months (since 2.1.4) so if you&#x27;ve ever put a file on a ZFS filesystem in the last year or so, you may be affected.<p>The only true way of knowing whether you are are victim of this is to look at every single file and compare it against the known good that has never been on a ZFS filesystem.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38408493'><td><table border='0'>  <tr>    <td class='ind' indent='4'><img src="s.gif" height="1" width="160"></td><td valign="top" class="votelinks">
      <center><a id='up_38408493' href='vote?id=38408493&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=gavinhoward" class="hnuser">gavinhoward</a> <span class="age" title="2023-11-24T21:21:09 1700860869"><a href="item?id=38408493">on Nov 24, 2023</a></span> <span id="unv_38408493"></span>          <span class='navs'>
             | <a href="#38406714" class="clicky" aria-hidden="true">root</a> | <a href="#38407811" class="clicky" aria-hidden="true">parent</a> | <a href="#38406875" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38408493" n="6" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Oh...this is bad.<p>I have a filesystem that is not ZFS, but it is a backup of a ZFS filesystem.<p>Am I screwed?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38409146'><td><table border='0'>  <tr>    <td class='ind' indent='5'><img src="s.gif" height="1" width="200"></td><td valign="top" class="votelinks">
      <center><a id='up_38409146' href='vote?id=38409146&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=csdvrx" class="hnuser">csdvrx</a> <span class="age" title="2023-11-24T22:34:38 1700865278"><a href="item?id=38409146">on Nov 24, 2023</a></span> <span id="unv_38409146"></span>          <span class='navs'>
             | <a href="#38406714" class="clicky" aria-hidden="true">root</a> | <a href="#38408493" class="clicky" aria-hidden="true">parent</a> | <a href="#38406875" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38409146" n="5" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">&gt; Oh...this is bad.<p>Yes, it&#x27;s extremely bad, and the title of the original submission from 2 days ago may not have caught your attention.<p>It should have been &quot;If your version of ZFS is less than 18 months old, you may have silent data corruption&quot;.<p>I editorialized the git title as little as I could while still describing the essential problem.<p>&gt; I have a filesystem that is not ZFS, but it is a backup of a ZFS filesystem. Am I screwed?<p>If it&#x27;s a backcup of a ZFS filesystem created with a version of OpenZFS more recent than 18 months, maybe.<p>That&#x27;s because even if it&#x27;s a 100% perfect backup, you can&#x27;t know if the backup contains files that where silently corrupted when they were on the original ZFS filesystem (unless you have copies of the files <i>before</i> they were on the ZFS)<p>The bug is deemed &quot;unlikely&quot; from 2.1.4 to the version 2.2 which introduced block cloning and increated the probability of the bug showing up, but you won&#x27;t know if 0% or 0.1% (or any other proportion) of your files are affected until after you compare checksums.<p>I&#x27;d suggest to wait until more is known. If this bug flew under the radar for so long, it should be rare.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38409238'><td><table border='0'>  <tr>    <td class='ind' indent='6'><img src="s.gif" height="1" width="240"></td><td valign="top" class="votelinks">
      <center><a id='up_38409238' href='vote?id=38409238&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=gavinhoward" class="hnuser">gavinhoward</a> <span class="age" title="2023-11-24T22:48:37 1700866117"><a href="item?id=38409238">on Nov 24, 2023</a></span> <span id="unv_38409238"></span>          <span class='navs'>
             | <a href="#38406714" class="clicky" aria-hidden="true">root</a> | <a href="#38409146" class="clicky" aria-hidden="true">parent</a> | <a href="#38406875" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38409238" n="4" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Unfortunately, I&#x27;m on Gentoo and tend to update regularly.<p>And within the last two weeks, I destroyed many of my oldest snapshots.<p>So yeah, I&#x27;m screwed.<p>I guess I should just hope for the best.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38410308'><td><table border='0'>  <tr>    <td class='ind' indent='7'><img src="s.gif" height="1" width="280"></td><td valign="top" class="votelinks">
      <center><a id='up_38410308' href='vote?id=38410308&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=csdvrx" class="hnuser">csdvrx</a> <span class="age" title="2023-11-25T01:38:22 1700876302"><a href="item?id=38410308">on Nov 25, 2023</a></span> <span id="unv_38410308"></span>          <span class='navs'>
             | <a href="#38406714" class="clicky" aria-hidden="true">root</a> | <a href="#38409238" class="clicky" aria-hidden="true">parent</a> | <a href="#38406875" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38410308" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">&gt; And within the last two weeks, I destroyed many of my oldest snapshots.<p>The goal of this repost is to save some trouble to people who may also delete old snapshots if they don&#x27;t understand how they can be impacted by this bug as the original title was very unclear</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38415066'><td><table border='0'>  <tr>    <td class='ind' indent='8'><img src="s.gif" height="1" width="320"></td><td valign="top" class="votelinks">
      <center><a id='up_38415066' href='vote?id=38415066&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=gavinhoward" class="hnuser">gavinhoward</a> <span class="age" title="2023-11-25T17:48:25 1700934505"><a href="item?id=38415066">on Nov 25, 2023</a></span> <span id="unv_38415066"></span>          <span class='navs'>
             | <a href="#38406714" class="clicky" aria-hidden="true">root</a> | <a href="#38410308" class="clicky" aria-hidden="true">parent</a> | <a href="#38406875" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38415066" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Yes, that was a good idea.<p>Hey, are there any tools to search for all zero blocks? Maybe that might help detect corruption in this case.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38439584'><td><table border='0'>  <tr>    <td class='ind' indent='9'><img src="s.gif" height="1" width="360"></td><td valign="top" class="votelinks">
      <center><a id='up_38439584' href='vote?id=38439584&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=csdvrx" class="hnuser">csdvrx</a> <span class="age" title="2023-11-27T22:46:16 1701125176"><a href="item?id=38439584">on Nov 27, 2023</a></span> <span id="unv_38439584"></span>          <span class='navs'>
             | <a href="#38406714" class="clicky" aria-hidden="true">root</a> | <a href="#38415066" class="clicky" aria-hidden="true">parent</a> | <a href="#38406875" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38439584" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Last time I checked, the discussion about how to best detect affected files was still going on.<p>IIRC having a null-byte prefix may be caused by the special scripts to artificially and forcefully trigger the bug. In naturally corrupted files, the position of null bytes may be more random than that.<p>New tests reveal the IO load may matters a lot: if you kept your IO low, you may have as few as 0.01% corrupted files.<p>All this brings me back to my original idea: the best solution may be using metadata from old backups (ctime, checksum) and looking for discontinuities (same ctime, different checksum) like an IDS would, as checking for null bytes would require too much calibration.<p>This method will require acquiring this metadata from old backups to figure which file got corrupted when, and what&#x27;s the best backup to restore it from</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                                                                  <tr class='athing comtr' id='38406875'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_38406875' href='vote?id=38406875&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=steponlego" class="hnuser">steponlego</a> <span class="age" title="2023-11-24T18:49:22 1700851762"><a href="item?id=38406875">on Nov 24, 2023</a></span> <span id="unv_38406875"></span>          <span class='navs'>
             | <a href="#38406714" class="clicky" aria-hidden="true">prev</a> | <a href="#38419378" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38406875" n="10" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Note this is an issue with OpenZFS, not ZFS.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38406918'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_38406918' href='vote?id=38406918&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=kadoban" class="hnuser">kadoban</a> <span class="age" title="2023-11-24T18:53:28 1700852008"><a href="item?id=38406918">on Nov 24, 2023</a></span> <span id="unv_38406918"></span>          <span class='navs'>
             | <a href="#38406875" class="clicky" aria-hidden="true">parent</a> | <a href="#38410073" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38406918" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">What other implementation of ZFS is commonly used?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38406989'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_38406989' href='vote?id=38406989&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=steponlego" class="hnuser">steponlego</a> <span class="age" title="2023-11-24T18:57:50 1700852270"><a href="item?id=38406989">on Nov 24, 2023</a></span> <span id="unv_38406989"></span>          <span class='navs'>
             | <a href="#38406875" class="clicky" aria-hidden="true">root</a> | <a href="#38406918" class="clicky" aria-hidden="true">parent</a> | <a href="#38410073" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38406989" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Sun&#x27;s ZFS, now owned and maintained by Oracle. ZFS is actually a Sun project.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38409242'><td><table border='0'>  <tr>    <td class='ind' indent='3'><img src="s.gif" height="1" width="120"></td><td valign="top" class="votelinks">
      <center><a id='up_38409242' href='vote?id=38409242&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=15457345234" class="hnuser">15457345234</a> <span class="age" title="2023-11-24T22:49:59 1700866199"><a href="item?id=38409242">on Nov 24, 2023</a></span> <span id="unv_38409242"></span>          <span class='navs'>
             | <a href="#38406875" class="clicky" aria-hidden="true">root</a> | <a href="#38406989" class="clicky" aria-hidden="true">parent</a> | <a href="#38410073" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38409242" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Remain In Light</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                        <tr class='athing comtr' id='38410073'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_38410073' href='vote?id=38410073&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=justaj" class="hnuser">justaj</a> <span class="age" title="2023-11-25T00:58:22 1700873902"><a href="item?id=38410073">on Nov 25, 2023</a></span> <span id="unv_38410073"></span>          <span class='navs'>
             | <a href="#38406875" class="clicky" aria-hidden="true">parent</a> | <a href="#38406918" class="clicky" aria-hidden="true">prev</a> | <a href="#38419378" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38410073" n="6" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Is there any indication this bug was not present in (Oracle) ZFS?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38410175'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_38410175' href='vote?id=38410175&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=mustache_kimono" class="hnuser">mustache_kimono</a> <span class="age" title="2023-11-25T01:13:34 1700874814"><a href="item?id=38410175">on Nov 25, 2023</a></span> <span id="unv_38410175"></span>          <span class='navs'>
             | <a href="#38406875" class="clicky" aria-hidden="true">root</a> | <a href="#38410073" class="clicky" aria-hidden="true">parent</a> | <a href="#38419378" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38410175" n="5" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Yeah, right now, it&#x27;s actually not known whether roots of this bug dates back to even the Sun days.  And because Oracle ZFS is not open source we can&#x27;t know if this or other bugs are lurking.<p>It seems to require certain extremely specific situations to trigger it.  Like using copy_file_range, which is the new feature which exposed it, or writing a file and then writing a larger than recordsize hole in that file in the same transaction group.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38416638'><td><table border='0'>  <tr>    <td class='ind' indent='3'><img src="s.gif" height="1" width="120"></td><td valign="top" class="votelinks">
      <center><a id='up_38416638' href='vote?id=38416638&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=ryao" class="hnuser">ryao</a> <span class="age" title="2023-11-25T21:01:34 1700946094"><a href="item?id=38416638">on Nov 25, 2023</a></span> <span id="unv_38416638"></span>          <span class='navs'>
             | <a href="#38406875" class="clicky" aria-hidden="true">root</a> | <a href="#38410175" class="clicky" aria-hidden="true">parent</a> | <a href="#38414869" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38416638" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Another contributor who is watching this more closely informed me that the issue appears to predate Oracle’s acquisition of Sun. While this is bad, it at least suggests that this bug is very rare.<p>The code has never been formally verified, so there was always a possibility of such a bug existing. Without formal verification, it is possible that more such bugs will be found. I should add that there is no formally verified production ready storage stack, so not using ZFS would not eliminate the risk of hitting bugs like this. :&#x2F;</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38424448'><td><table border='0'>  <tr>    <td class='ind' indent='4'><img src="s.gif" height="1" width="160"></td><td valign="top" class="votelinks">
      <center><a id='up_38424448' href='vote?id=38424448&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=steponlego" class="hnuser">steponlego</a> <span class="age" title="2023-11-26T19:58:34 1701028714"><a href="item?id=38424448">on Nov 26, 2023</a></span> <span id="unv_38424448"></span>          <span class='navs'>
             | <a href="#38406875" class="clicky" aria-hidden="true">root</a> | <a href="#38416638" class="clicky" aria-hidden="true">parent</a> | <a href="#38414869" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38424448" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Formal verification seems more appropriate for finished software not undergoing development or feature changes. It&#x27;s the last step before software is set permanently in stone, unchanging, forever.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='38414869'><td><table border='0'>  <tr>    <td class='ind' indent='3'><img src="s.gif" height="1" width="120"></td><td valign="top" class="votelinks">
      <center><a id='up_38414869' href='vote?id=38414869&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=chlorion" class="hnuser">chlorion</a> <span class="age" title="2023-11-25T17:24:00 1700933040"><a href="item?id=38414869">on Nov 25, 2023</a></span> <span id="unv_38414869"></span>          <span class='navs'>
             | <a href="#38406875" class="clicky" aria-hidden="true">root</a> | <a href="#38410175" class="clicky" aria-hidden="true">parent</a> | <a href="#38416638" class="clicky" aria-hidden="true">prev</a> | <a href="#38419378" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38414869" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">It&#x27;s worth noting that copy_file_range is used by a lot of things. Most programming languages &quot;copy_file&quot; functions use copy_file_range, everything from Rust to Emacs Lisp! The only language I can think of that doesn&#x27;t use copy_file_range when copying files is Python.<p>On Gentoo, the portage package manager is written in Python but has some &quot;native extensions&quot;, one of these extensions is copying files with copy_file_range, which is used when merging images to the root filesystem from my understanding.<p>Also GNU coreutils &quot;cp&quot; command uses it by default in recent releases, I&#x27;m not sure which release specifically introduced this change.<p>There are other things required to trigger the bug that are a lot less common though.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38415472'><td><table border='0'>  <tr>    <td class='ind' indent='4'><img src="s.gif" height="1" width="160"></td><td valign="top" class="votelinks">
      <center><a id='up_38415472' href='vote?id=38415472&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=mustache_kimono" class="hnuser">mustache_kimono</a> <span class="age" title="2023-11-25T18:40:21 1700937621"><a href="item?id=38415472">on Nov 25, 2023</a></span> <span id="unv_38415472"></span>          <span class='navs'>
             | <a href="#38406875" class="clicky" aria-hidden="true">root</a> | <a href="#38414869" class="clicky" aria-hidden="true">parent</a> | <a href="#38419378" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="38415472" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">&gt; It&#x27;s worth noting that copy_file_range is used by a lot of things.<p>Yes, but the trigger feature, block cloning, only landed in the latest 2.2 release.  If you immediately hopped on 2.2, and used a system with lots copy_file_range and FICLONE use, yes, you may have a problem (like, as you note, on Gentoo, where this problem surfaced).<p>Most people were just hopping on the bandwagon.  My distro ships 2.1.5, so I have a 6 month wait until this feature lands, so I was just building copy_file_range support into my ZFS apps, right before news of this bug hit.[0]<p>&gt; There are other things required to trigger the bug that are a lot less common though.<p>Exactly.  My guess is the incidence of this will exceedingly rare for the common user&#x2F;small NAS user&#x2F;etc.  I&#x27;ve run a corruption detector[1], and what I&#x27;ve found mostly indicates false positives.  Fingers crossed, but, so far, no actual positive matches on a system with probably a little less than 1 million files.<p>[0]: <a href="https:&#x2F;&#x2F;github.com&#x2F;kimono-koans&#x2F;httm">https:&#x2F;&#x2F;github.com&#x2F;kimono-koans&#x2F;httm</a>
[1]: <a href="https:&#x2F;&#x2F;gist.github.com&#x2F;kimono-koans&#x2F;2696a8c8eac0a6babf7b2d9b26a82f65" rel="nofollow noreferrer">https:&#x2F;&#x2F;gist.github.com&#x2F;kimono-koans&#x2F;2696a8c8eac0a6babf7b2d9...</a></div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                                    <tr class='athing comtr' id='38419378'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_38419378' href='vote?id=38419378&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=kevvok" class="hnuser">kevvok</a> <span class="age" title="2023-11-26T05:23:27 1700976207"><a href="item?id=38419378">on Nov 26, 2023</a></span> <span id="unv_38419378"></span>          <span class='navs'>
             | <a href="#38406875" class="clicky" aria-hidden="true">prev</a> <a class="togg clicky" id="38419378" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Interestingly, a CVE has been assigned for this issue: <a href="https:&#x2F;&#x2F;www.cve.org&#x2F;CVERecord?id=CVE-2023-49298" rel="nofollow noreferrer">https:&#x2F;&#x2F;www.cve.org&#x2F;CVERecord?id=CVE-2023-49298</a></div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='38419543'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_38419543' href='vote?id=38419543&amp;how=up&amp;goto=item%3Fid%3D38405731'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=mekster" class="hnuser">mekster</a> <span class="age" title="2023-11-26T06:04:49 1700978689"><a href="item?id=38419543">on Nov 26, 2023</a></span> <span id="unv_38419543"></span>          <span class='navs'>
             | <a href="#38419378" class="clicky" aria-hidden="true">parent</a> <a class="togg clicky" id="38419543" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">It says because it could overwrite config files but not always a security problem.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  </table>
  <br><br>
</td></tr>
<tr><td><img src="s.gif" height="10" width="0"><table width="100%" cellspacing="0" cellpadding="1"><tr><td bgcolor="#ff6600"></td></tr></table><br>
<center><span class="yclinks"><a href="newsguidelines.html">Guidelines</a> | <a href="newsfaq.html">FAQ</a> | <a href="lists">Lists</a> | <a href="https://github.com/HackerNews/API">API</a> | <a href="security.html">Security</a> | <a href="https://www.ycombinator.com/legal/">Legal</a> | <a href="https://www.ycombinator.com/apply/">Apply to YC</a> | <a href="mailto:hn@ycombinator.com">Contact</a></span><br><br>
<form method="get" action="//hn.algolia.com/">Search: <input type="text" name="q" size="17" autocorrect="off" spellcheck="false" autocapitalize="off" autocomplete="off"></form></center></td></tr>      </table></center></body>
      <script type='text/javascript' src='hn.js?jZ4kyxqAt22XaoTPqDid'></script>
  </html>
