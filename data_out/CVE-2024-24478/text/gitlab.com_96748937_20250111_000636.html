

[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# BGP: addition of RFC9072 (BGP open optional paramaeter extension)

## Summary

Current implementation doesnâ€™t support the optional parameters extension in the BGP OPEN messages as per [RFC9072](https://datatracker.ietf.org/doc/html/rfc9072.html#name-update-to-rfc-4271). This RFC proposes a solution for OPEN message that longer than 255 with backward compatibility.

A patch proposition and merge request will follow

## Sample capture file

The capture joined to the issue contains 3 packets:

* First packet: to check retro-compatibility : non use of the extension, wireshark + patch will keep the classic behavior
* Second packet that use the optional parameter extension: Wireshark + patch will detect it and adapt its dissection to take the extended length
* Third packet with a 0 standard optional parameter length but with the use of extension : Wireshark will ignore the extension.

I tried to keep original behavior as much as possible, I opened to discuss about how to better integrate it in the dissection tree.

Without extension usage:
[![image](data:image/gif;base64...)](/-/project/7898047/uploads/f53544079943799e6af1033142cf01be/image.png)

With extension usage
[![image](data:image/gif;base64...)](/-/project/7898047/uploads/da7f75eb2cb770633ac17d13aafe146a/image.png)

[BGP\_RFC9072\_validation.pcapng](/-/project/7898047/uploads/0848389c49df714bae4f5444d40d3e2f/BGP_RFC9072_validation.pcapng)

Edited Sep 16, 2023 by [Yann Lejeune](/ylejeune)

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.

