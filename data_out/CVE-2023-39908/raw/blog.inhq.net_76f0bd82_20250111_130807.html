<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag -->
<title>Yubico YubiHSM PKCS#11 Library Vulnerability (CVE-2023-39908) | invd blog</title>
<meta name="generator" content="Jekyll" />
<meta property="og:title" content="Yubico YubiHSM PKCS#11 Library Vulnerability (CVE-2023-39908)" />
<meta name="author" content="Christian Reitter" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Heiko SchÃ¤fer discovered a new security issue in the Yubico yubihsm_pkcs11.so driver library, which we disclosed together to Yubico. The YubiHSM PKCS#11 client-side library is designed to interact with Yubico HSM2 hardware security modules. Due to flaws in the memory handling, the library code accidentally returns 8192 bytes of previously used process memory under some circumstances. This impacts the memory confidentiality of the calling program for some usages." />
<meta property="og:description" content="Heiko SchÃ¤fer discovered a new security issue in the Yubico yubihsm_pkcs11.so driver library, which we disclosed together to Yubico. The YubiHSM PKCS#11 client-side library is designed to interact with Yubico HSM2 hardware security modules. Due to flaws in the memory handling, the library code accidentally returns 8192 bytes of previously used process memory under some circumstances. This impacts the memory confidentiality of the calling program for some usages." />
<link rel="canonical" href="https://blog.inhq.net/posts/yubico-yubihsm-pkcs-vuln/" />
<meta property="og:url" content="https://blog.inhq.net/posts/yubico-yubihsm-pkcs-vuln/" />
<meta property="og:site_name" content="invd blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-08-14T19:50:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Yubico YubiHSM PKCS#11 Library Vulnerability (CVE-2023-39908)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Christian Reitter"},"dateModified":"2023-08-14T19:50:00+02:00","datePublished":"2023-08-14T19:50:00+02:00","description":"Heiko SchÃ¤fer discovered a new security issue in the Yubico yubihsm_pkcs11.so driver library, which we disclosed together to Yubico. The YubiHSM PKCS#11 client-side library is designed to interact with Yubico HSM2 hardware security modules. Due to flaws in the memory handling, the library code accidentally returns 8192 bytes of previously used process memory under some circumstances. This impacts the memory confidentiality of the calling program for some usages.","headline":"Yubico YubiHSM PKCS#11 Library Vulnerability (CVE-2023-39908)","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.inhq.net/posts/yubico-yubihsm-pkcs-vuln/"},"url":"https://blog.inhq.net/posts/yubico-yubihsm-pkcs-vuln/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://blog.inhq.net/feed.xml" title="invd blog" /><script type="text/javascript">
  var _paq = window._paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  _paq.push(['setSecureCookie', true]);
  _paq.push(['setVisitorCookieTimeout', 60 * 60 * 24 * 90]);
  _paq.push(['setReferralCookieTimeout', 60 * 60 * 24 * 90]);
  _paq.push(['appendToTrackingUrl', 'bots=1']);
  (function() {
    var u="https://mato.inhq.net/";
    _paq.push(['setTrackerUrl', u+'m']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'mat.js'; s.parentNode.insertBefore(g,s);
  })();
  </script></head>
<body><header class="site-header"><noscript><img src="https://mato.inhq.net/m?rec=1&bots=1&idsite=1" alt="" style="position:absolute; visibility:hidden" /></noscript><div class="wrapper"><a class="site-title" rel="author" href="/">invd blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
        <a class="page-link" href="/archive/">Archive</a><a class="page-link" href="/cve/">CVEs</a><a class="page-link" href="/consulting/">Consulting</a><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Yubico YubiHSM PKCS#11 Library Vulnerability (CVE-2023-39908)</h1>
    <p class="post-meta"><time class="dt-published" datetime="2023-08-14T19:50:00+02:00" itemprop="datePublished">
        Aug 14, 2023
      </time>â¢ <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Christian Reitter</span></span><br/>ID:
        
          
          <span>CVE-2023-39908</span>
        <br/>
      <div class="related_article">
      Related articles:
      <a href="/posts/yubico-libykpiv-vuln2/">Yubico libykpiv Vulnerabilities II</a>
          â¢ <a href="/posts/yubico-yubihsm-shell-vuln3/">Yubico yubihsm-shell Vulnerability (CVE-2021-43399)</a>
          â¢ <a href="/posts/yubico-libyubihsm-vuln2/">Yubico libyubihsmâVulnerabilities (CVE-2021-27217, CVE-2021-32489)</a>
          </p></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Heiko SchÃ¤fer discovered a new security issue in the Yubico <code class="language-plaintext highlighter-rouge">yubihsm_pkcs11.so</code> driver library, which we disclosed together to Yubico. The YubiHSM PKCS#11 client-side library is designed to interact with Yubico HSM2 hardware security modules. Due to flaws in the memory handling, the library code accidentally returns 8192 bytes of previously used process memory under some circumstances. This impacts the memory confidentiality of the calling program for some usages.</p>

<p>This article will describe the issue.</p>

<div id="toc-container">
  <h2 class="no_toc">Contents</h2>
<ul id="markdown-toc">
  <li><a href="#memory-handling-issue-in-c_getattributevalue" id="markdown-toc-memory-handling-issue-in-c_getattributevalue">Memory Handling Issue in C_GetAttributeValue</a>    <ul>
      <li><a href="#initial-debugging" id="markdown-toc-initial-debugging">Initial Debugging</a></li>
      <li><a href="#poc" id="markdown-toc-poc">PoC</a></li>
      <li><a href="#code-history" id="markdown-toc-code-history">Code History</a></li>
      <li><a href="#patch" id="markdown-toc-patch">Patch</a></li>
      <li><a href="#security-implications" id="markdown-toc-security-implications">Security Implications</a></li>
    </ul>
  </li>
  <li><a href="#coordinated-disclosure" id="markdown-toc-coordinated-disclosure">Coordinated Disclosure</a>    <ul>
      <li><a href="#credits-and-commercial-work" id="markdown-toc-credits-and-commercial-work">Credits and Commercial Work</a></li>
      <li><a href="#relevant-sources" id="markdown-toc-relevant-sources">Relevant Sources</a></li>
      <li><a href="#detailed-timeline" id="markdown-toc-detailed-timeline">Detailed Timeline</a></li>
      <li><a href="#bug-bounty" id="markdown-toc-bug-bounty">Bug Bounty</a></li>
    </ul>
  </li>
</ul>

</div>

<h2 class="no_toc">Consulting</h2>

<p><i>Iâm a freelance Security Consultant and currently available for new projects.
  If you are looking for assistance to secure your projects or organization, <a href="/consulting">contact me</a>.</i></p>

<h2 id="memory-handling-issue-in-c_getattributevalue">Memory Handling Issue in C_GetAttributeValue</h2>

<p>The <code class="language-plaintext highlighter-rouge">C_GetAttributeValue()</code> function in <code class="language-plaintext highlighter-rouge">yubihsm_pkcs11.c</code> can be used to query X.509 certificate attributes of particular types. However, some codepaths have problematic memory handling.</p>

<p>Consider client software that retrieves the certificate attribute <code class="language-plaintext highlighter-rouge">CKA_SERIAL_NUMBER</code> with the <code class="language-plaintext highlighter-rouge">C_GetAttributeValue</code> call from a regular, non-malicious YubiHSM2 device via the PKCS#11 API interface.</p>

<p>Internally, the PKCS#11 functions will establish a session with the YubiHSM2 device and then attempt to handle and parse the received object information.
This happens via the following code positions:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">CK_DEFINE_FUNCTION</span><span class="p">(</span><span class="n">CK_RV</span><span class="p">,</span> <span class="n">C_GetAttributeValue</span><span class="p">)[...]</span></code></pre></figure>

<p><a href="https://github.com/Yubico/yubihsm-shell/blob/91ac2c7e04ef6a6a1ec91b8a58efd1489ff02e63/pkcs11/yubihsm_pkcs11.c#L2018" class="highlightref">yubihsm_pkcs11.c L2018</a></p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">CK_RV</span> <span class="n">populate_template</span><span class="p">(</span><span class="kt">int</span> <span class="n">type</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">object</span><span class="p">,</span> <span class="n">CK_ATTRIBUTE_PTR</span> <span class="n">pTemplate</span><span class="p">,</span> <span class="p">[..])</span></code></pre></figure>

<p><a href="https://github.com/Yubico/yubihsm-shell/blob/91ac2c7e04ef6a6a1ec91b8a58efd1489ff02e63/pkcs11/util_pkcs11.c#L5065" class="highlightref">util_pkcs11.c L5065</a></p>

<p>Note that <code class="language-plaintext highlighter-rouge">populate_template()</code> reserves a local stack buffer <code class="language-plaintext highlighter-rouge">CK_BYTE tmp[8192];</code> without explicit data initialization and passes its size as the <code class="language-plaintext highlighter-rouge">len</code> parameter to subsequent function calls in</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">CK_ULONG</span> <span class="n">len</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span></code></pre></figure>

<p><a href="https://github.com/Yubico/yubihsm-shell/blob/91ac2c7e04ef6a6a1ec91b8a58efd1489ff02e63/pkcs11/util_pkcs11.c#L5072" class="highlightref">util_pkcs11.c L5072</a>
This will become relevant later.</p>

<p>The particular security issue is associated with opaque attributes, which are handled via</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="k">static</span> <span class="n">CK_RV</span> <span class="n">get_attribute</span><span class="p">([...])</span></code></pre></figure>

<p><a href="https://github.com/Yubico/yubihsm-shell/blob/91ac2c7e04ef6a6a1ec91b8a58efd1489ff02e63/pkcs11/util_pkcs11.c#L1969" class="highlightref">util_pkcs11.c L1969</a></p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="k">static</span> <span class="n">CK_RV</span> <span class="n">get_attribute_opaque</span><span class="p">(</span><span class="n">CK_ATTRIBUTE_TYPE</span> <span class="n">type</span><span class="p">,</span> <span class="p">[...]</span> <span class="p">)</span></code></pre></figure>

<p><a href="https://github.com/Yubico/yubihsm-shell/blob/91ac2c7e04ef6a6a1ec91b8a58efd1489ff02e63/pkcs11/util_pkcs11.c#L1030" class="highlightref">util_pkcs11.c L1030</a></p>

<p>In <code class="language-plaintext highlighter-rouge">get_attribute_opaque()</code>, some function paths overwrite the <code class="language-plaintext highlighter-rouge">length</code> parameter - which is passed as a reference - to the actual length of the field for the specific attribute they fetched. However, for at least three specific field types, this does not happen:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c">   <span class="k">case</span> <span class="n">CKA_SUBJECT</span><span class="p">:</span>
   <span class="k">case</span> <span class="n">CKA_ISSUER</span><span class="p">:</span>
   <span class="k">case</span> <span class="n">CKA_SERIAL_NUMBER</span><span class="p">:</span>
<span class="k">break</span><span class="p">;</span></code></pre></figure>

<p><a href="https://github.com/Yubico/yubihsm-shell/blob/91ac2c7e04ef6a6a1ec91b8a58efd1489ff02e63/pkcs11/util_pkcs11.c#L1105-L1108" class="highlightref">util_pkcs11.c L1105-L1108</a></p>

<p>As a result, code flows hitting the quoted code lines in <code class="language-plaintext highlighter-rouge">get_attribute_opaque()</code> will return to the parent function <em>without</em> writing data into the <code class="language-plaintext highlighter-rouge">tmp</code> buffer, <em>without</em> changing the <code class="language-plaintext highlighter-rouge">length</code> parameter away from the maximum value, and <em>without</em> returning an error code. By convention, this appears like a successful operation which produced 8192 bytes of new output, although in reality the <code class="language-plaintext highlighter-rouge">tmp</code> buffer was not written to at all.</p>

<p>This constellation leads to a problematic <code class="language-plaintext highlighter-rouge">memcpy()</code> call which leaks the uninitialized memory contents of <code class="language-plaintext highlighter-rouge">tmp</code> into the output:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">memcpy</span><span class="p">(</span><span class="n">pTemplate</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">pValue</span><span class="p">,</span> <span class="n">tmp</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span></code></pre></figure>

<p><a href="https://github.com/Yubico/yubihsm-shell/blob/91ac2c7e04ef6a6a1ec91b8a58efd1489ff02e63/pkcs11/util_pkcs11.c#L5095" class="highlightref">util_pkcs11.c L5095</a></p>

<p>Typically, the content of uninitialized stack memory variables will contain memory from stack frames which previously occupied the relevant memory region. Copying data from this memory region will likely contain stack variables and other stack-related information (stack canaries, pointers) from previous function calls.</p>

<p>The leaked data will then get returned to the PKCS#11 caller. Since the caller requested some specific certificate information, but instead gets data from an information leak, this represents a security issue. Additionally, since the problematic library function indicates no errors, this information may be passed on by the caller towards other components and trust spheres, depending on the specific behavior of the program.</p>

<p>Programs that use the YubiHSM are likely to handle secrets, possibly including secret key material, or sensitive plaintext. The sensitive key material may include the PIN secret used to secure the HSM communication. Because of this bug, a program that uses <code class="language-plaintext highlighter-rouge">yubihsm_pkcs11.so</code> may inadvertently return such information instead of the requested X.509 certificate attributes.</p>

<p>Since the vulnerable component is a flexible library, it is unclear which programs call into the problematic function, and under which circumstances. Additionally, the relevant memory accesses are undefined behavior (UB) in C and may depend on the compiler and system environment. If you have more information about specific integrating applications and their confirmed security impacts, please contact us.</p>

<h3 id="initial-debugging">Initial Debugging</h3>
<p>To confirm that this data actually leaks from the tmp variable on the stack, we used a modified <code class="language-plaintext highlighter-rouge">yubihsm_pkcs11.so</code> library which specifically marks the memory in question with ASCII âAâ characters. During initial debugging, this allowed a straightforward identification of the problematic memory in returned data:</p>

<figure class="highlight"><pre><code class="language-diff" data-lang="diff"><span class="p">CK_BYTE tmp[8192];
</span><span class="gi">+ // mark potentially leaked bytes
+ memset(tmp, 0x41, sizeof(tmp));</span></code></pre></figure>

<p><a id="poc"></a></p>
<h3 id="poc">PoC</h3>

<p>In order to confirm the issue and help Yubico reproduce it, we crafted a proof-of-concept (PoC). The PoC consists of a short dummy program written in C that triggers the issue: <a href="/assets/artifacts/cve-2023-39908/pkcs11-memleak.c">pkcs11-memleak.c</a>.</p>

<p><strong>WARNING: use the provided PoC code at your own risk, and only on non-production HSM devices.</strong>
<br /></p>

<p>Please see the code comments for setup details and explanations. The special <code class="language-plaintext highlighter-rouge">put_dummy_secrets_on_stack()</code> function may be of particular interest to understand the leaked output and attack conditions.</p>

<p><a id="bughistory"></a></p>
<h3 id="code-history">Code History</h3>
<p><em>Note: this section has been updated to include new information.</em></p>

<p>By our understanding, this issue was introduced via a combination of two commits:</p>
<ol>
  <li><a href="https://github.com/Yubico/yubihsm-shell/commit/c5723d17cd50081f641da21210942cdc76387673">This</a> commit on Sep 8, 2020 (released with version <code class="language-plaintext highlighter-rouge">2.0.3</code>)</li>
  <li><a href="https://github.com/Yubico/yubihsm-shell/commit/96732186c970eb6d426f0fa22d4dc81470fd6476#diff-fa4816e3d6c18558a759b602826c3b5345b3d3d3393d95b89357bacdfa231fffR1042-R1046">This</a> commit merged on Jan 1, 2023 (released with version <code class="language-plaintext highlighter-rouge">2.4.0</code>)</li>
</ol>

<p>Commit 1) introduces the weak <code class="language-plaintext highlighter-rouge">tmp</code> buffer initialization, and commit 2) introduces problematic code paths and makes the issue reachable.</p>

<h3 id="patch">Patch</h3>

<p>The main patch improves the problematic code paths in <code class="language-plaintext highlighter-rouge">get_attribute_opaque()</code>:</p>

<figure class="highlight"><pre><code class="language-diff" data-lang="diff">    case CKA_SUBJECT:
    case CKA_ISSUER:
    case CKA_SERIAL_NUMBER:
<span class="gi">+      *((CK_BYTE_PTR *) value) = NULL;
+      *length = 0;
</span>      break;</code></pre></figure>

<p><a href="https://github.com/Yubico/yubihsm-shell/commit/d56f8567d4fe807dc097febbac7bb4e02ca9dea3" class="highlightref">d56f8567d4fe807dc097febbac7bb4e02ca9dea3</a></p>

<p>A second patch improves the buffer initialization:</p>

<figure class="highlight"><pre><code class="language-diff" data-lang="diff"><span class="gd">-  CK_BYTE tmp[8192];
</span><span class="gi">+  CK_BYTE tmp[8192] = {0};</span></code></pre></figure>

<p><a href="https://github.com/Yubico/yubihsm-shell/commit/a393ea37ec91df7bb6ed1d70330da8700c45a57d#diff-fa4816e3d6c18558a759b602826c3b5345b3d3d3393d95b89357bacdfa231fffR5179" class="highlightref">util_pkcs11.c R5179</a></p>

<p>Additional references:</p>
<ul>
  <li><a href="https://github.com/Yubico/yubihsm-shell/pull/354/">PR#354</a></li>
</ul>

<h3 id="security-implications">Security Implications</h3>

<h4 id="cvss-score">CVSS Score</h4>
<p>The described security issue affects the confidentiality of program memory. Due to the characteristics of the flaw, we think that program memory integrity and program availability is not impacted.</p>

<p>As with other memory- and library-related vulnerabilities, it is difficult to say generally what the sensitive information in memory is going to be, and how the leaked information will be processed or exposed by the caller. As a result, the practical worst-case impact will likely be very target-dependent.</p>

<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>CVSS 3.1 Score</th>
      <th>Parameters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>CVE-2023-39908 stack information leak</td>
      <td><strong>4.4</strong> (Medium)</td>
      <td><a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N&amp;version=3.1">AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N</a></td>
    </tr>
  </tbody>
</table>

<p>The listed scoring maps the impact on a network-enabled integrating program which allows a remote user to trigger the affected functionality and obtain secrets after some form of authentication as a high-privileged user. Other integrating programs that use the PKCS#11 driver may have different impacts. For example, if a lower-privileged user can trigger the issue, <code class="language-plaintext highlighter-rouge">PR: L</code> would turn this into a <strong>5.3</strong> CVSS base score (<a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N&amp;version=3.1">calculator</a>).</p>

<h2 id="coordinated-disclosure">Coordinated Disclosure</h2>
<p>As outlined in the <a href="#timeline">timeline</a>, the first ~60 days out of the overall 90 days of disclosure did not see a lot of activity or feedback from the vendor side. This follows a pattern seen with previous coordinated disclosures to Yubico, which also had significant delays between reporting and technical discussion &amp; assessment coordination with the vendor. We recommend focusing on a quicker initial handling for future disclosures to reduce the time pressure on coordination tasks.
We want to positively mention that Yubico has provided security patches and an advisory on the disclosure date for this disclosure, which is an improvement over the previous issue.</p>

<h3 id="credits-and-commercial-work">Credits and Commercial Work</h3>

<p>During work on integration of YubiHSM2 into <a href="https://codeberg.org/heiko/openpgp-pkcs11">an OpenPGP project</a>, Heiko SchÃ¤fer found the memory safety issue. Christian Reitter assisted with triage, issue analysis, coordinated disclosure and report writeup. In references to this issue, please credit âHeiko SchÃ¤fer and Christian Reitterâ.</p>

<p><a href="mailto:heiko@schaefer.name">Heiko SchÃ¤fer</a> is available for commercial work with a focus on OpenPGP and Rust:</p>
<ul>
  <li><a href="https://openpgp-ca.org/">OpenPGP CA</a>,</li>
  <li>OpenPGP on HSM devices (<a href="https://gitlab.com/openpgp-card/openpgp-card">OpenPGP card</a>, PKCS #11, PIV),</li>
  <li>Sequoia PGP.</li>
</ul>

<h3 id="relevant-sources">Relevant Sources</h3>

<table>
  <thead>
    <tr>
      <th>Variant</th>
      <th>Source</th>
      <th>Likely Affected</th>
      <th>Fix</th>
      <th>References</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Yubico upstream</td>
      <td><a href="https://github.com/Yubico/yubihsm-shell">GitHub</a></td>
      <td><code class="language-plaintext highlighter-rouge">2.4.0</code></td>
      <td><a href="https://developers.yubico.com/YubiHSM2/Releases/">SDK 2023.08</a>, <code class="language-plaintext highlighter-rouge">2.4.1</code></td>
      <td><a href="https://www.yubico.com/support/security-advisories/ysa-2023-01/">YSA-2023-01 advisory</a>, <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39908">CVE-2023-39908</a></td>
    </tr>
    <tr>
      <td>Fedora package</td>
      <td><a href="https://src.fedoraproject.org/rpms/yubihsm-shell">rpm package</a></td>
      <td><code class="language-plaintext highlighter-rouge">2.4.0-1</code></td>
      <td><code class="language-plaintext highlighter-rouge">2.4.1-1</code>, <a href="https://src.fedoraproject.org/rpms/yubihsm-shell/c/e3525f8970a3003edd79924b3b2cfc7f50c8ed24">commit</a></td>
      <td><a href="https://bugzilla.redhat.com/show_bug.cgi?id=2232340">bugzilla #2232340</a></td>
    </tr>
  </tbody>
</table>

<p>We originally reproduced the issue with <code class="language-plaintext highlighter-rouge">yubihsm-shell-2.4.0-1.fc38.x86_64</code> under Fedora. It appears that earlier versions before <code class="language-plaintext highlighter-rouge">2.4.0</code> do not contain the problematic code path, see <a href="#bughistory">here</a>.</p>

<p><a id="timeline"></a></p>
<h3 id="detailed-timeline">Detailed Timeline</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Information</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2023-05-18</td>
      <td>Disclosure of issue to Yubico, including <a href="#poc">proof-of-concept</a> code</td>
    </tr>
    <tr>
      <td>2023-05-24</td>
      <td>Response by Yubico, confirms recept of disclosure</td>
    </tr>
    <tr>
      <td>2023-06-21</td>
      <td>Request to Yubico for a status update and severity assessment</td>
    </tr>
    <tr>
      <td>2023-07-17</td>
      <td>Status update request to Yubico after lack of response</td>
    </tr>
    <tr>
      <td>2023-07-17</td>
      <td>Response by Yubico with technical details and CVSS scoring</td>
    </tr>
    <tr>
      <td>2023-07-21</td>
      <td>Message to Yubico, discussing proposed CVSS scoring &amp; CVE</td>
    </tr>
    <tr>
      <td>2023-07-25</td>
      <td>Response by Yubico, discussing proposed CVSS scoring</td>
    </tr>
    <tr>
      <td>2023-07-31</td>
      <td>Message to Yubico, discussing proposed CVSS scoring &amp; CVE</td>
    </tr>
    <tr>
      <td>2023-08-02</td>
      <td>Response by Yubico, outlining CVE assignment and disclosure date plans</td>
    </tr>
    <tr>
      <td>2023-08-04</td>
      <td>Response by Yubico, disclosure date plans</td>
    </tr>
    <tr>
      <td>2023-08-05</td>
      <td>Message to Yubico, acknowledgment</td>
    </tr>
    <tr>
      <td>2023-08-14</td>
      <td>Yubico publishes YSA-2023-01 and patch release</td>
    </tr>
    <tr>
      <td>2023-08-14</td>
      <td>Publication of this article</td>
    </tr>
    <tr>
      <td>2023-08-16</td>
      <td>Original end date of 90-day coordinated disclosure period</td>
    </tr>
    <tr>
      <td>2023-08-23</td>
      <td>Update of this article, revising version information, adding patch details</td>
    </tr>
  </tbody>
</table>

<h3 id="bug-bounty">Bug Bounty</h3>
<p>At the time of the disclosure, the vendor did not offer a bug bounty.</p>

  </div>


  <a class="u-url" href="/posts/yubico-yubihsm-pkcs-vuln/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col-left">
        <ul class="contact-list">
          <li class="p-name">
            <b>Christian Reitter</b>
          </li>
        </ul>
        <p>Information security and other interests.</p>

      </div>

      <div class="footer-col-right">
        <div class="social-ref"><ul class="social-ref-list"><li><a rel="me" href="https://github.com/invd" title="invd"><svg class="svg-icon grey"><use xlink:href="/assets/minima-icons.svg#github"></use></svg></a></li><li><a href="/feed.xml" title="Atom"><svg class="svg-icon grey"><use xlink:href="/assets/minima-icons.svg#rss"></use></svg></a></li></ul>
</div>
      </div>
    </div>
  </div>
</footer>
</body>

</html>
