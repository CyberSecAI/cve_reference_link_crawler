=== Content from blog.inhq.net_76f0bd82_20250111_130807.html ===
![](https://mato.inhq.net/m?rec=1&bots=1&idsite=1)[invd blog](/)

[Archive](/archive/)[CVEs](/cve/)[Consulting](/consulting/)[About](/about/)

# Yubico YubiHSM PKCS#11 Library Vulnerability (CVE-2023-39908)

Aug 14, 2023
â¢
Christian Reitter
ID:
CVE-2023-39908

Related articles:
[Yubico libykpiv Vulnerabilities II](/posts/yubico-libykpiv-vuln2/)
â¢ [Yubico yubihsm-shell Vulnerability (CVE-2021-43399)](/posts/yubico-yubihsm-shell-vuln3/)
â¢ [Yubico libyubihsmâVulnerabilities (CVE-2021-27217, CVE-2021-32489)](/posts/yubico-libyubihsm-vuln2/)

Heiko SchÃ¤fer discovered a new security issue in the Yubico `yubihsm_pkcs11.so` driver library, which we disclosed together to Yubico. The YubiHSM PKCS#11 client-side library is designed to interact with Yubico HSM2 hardware security modules. Due to flaws in the memory handling, the library code accidentally returns 8192 bytes of previously used process memory under some circumstances. This impacts the memory confidentiality of the calling program for some usages.

This article will describe the issue.

## Contents

* [Memory Handling Issue in C\_GetAttributeValue](#memory-handling-issue-in-c_getattributevalue)
  + [Initial Debugging](#initial-debugging)
  + [PoC](#poc)
  + [Code History](#code-history)
  + [Patch](#patch)
  + [Security Implications](#security-implications)
* [Coordinated Disclosure](#coordinated-disclosure)
  + [Credits and Commercial Work](#credits-and-commercial-work)
  + [Relevant Sources](#relevant-sources)
  + [Detailed Timeline](#detailed-timeline)
  + [Bug Bounty](#bug-bounty)
## Consulting

*Iâm a freelance Security Consultant and currently available for new projects.
If you are looking for assistance to secure your projects or organization, [contact me](/consulting).*

## Memory Handling Issue in C\_GetAttributeValue

The `C_GetAttributeValue()` function in `yubihsm_pkcs11.c` can be used to query X.509 certificate attributes of particular types. However, some codepaths have problematic memory handling.

Consider client software that retrieves the certificate attribute `CKA_SERIAL_NUMBER` with the `C_GetAttributeValue` call from a regular, non-malicious YubiHSM2 device via the PKCS#11 API interface.

Internally, the PKCS#11 functions will establish a session with the YubiHSM2 device and then attempt to handle and parse the received object information.
This happens via the following code positions:

```
CK_DEFINE_FUNCTION(CK_RV, C_GetAttributeValue)[...]
```

[yubihsm\_pkcs11.c L2018](https://github.com/Yubico/yubihsm-shell/blob/91ac2c7e04ef6a6a1ec91b8a58efd1489ff02e63/pkcs11/yubihsm_pkcs11.c#L2018)

```
CK_RV populate_template(int type, void *object, CK_ATTRIBUTE_PTR pTemplate, [..])
```

[util\_pkcs11.c L5065](https://github.com/Yubico/yubihsm-shell/blob/91ac2c7e04ef6a6a1ec91b8a58efd1489ff02e63/pkcs11/util_pkcs11.c#L5065)

Note that `populate_template()` reserves a local stack buffer `CK_BYTE tmp[8192];` without explicit data initialization and passes its size as the `len` parameter to subsequent function calls in

```
CK_ULONG len = sizeof(tmp);
```

[util\_pkcs11.c L5072](https://github.com/Yubico/yubihsm-shell/blob/91ac2c7e04ef6a6a1ec91b8a58efd1489ff02e63/pkcs11/util_pkcs11.c#L5072)
This will become relevant later.

The particular security issue is associated with opaque attributes, which are handled via

```
static CK_RV get_attribute([...])
```

[util\_pkcs11.c L1969](https://github.com/Yubico/yubihsm-shell/blob/91ac2c7e04ef6a6a1ec91b8a58efd1489ff02e63/pkcs11/util_pkcs11.c#L1969)

```
static CK_RV get_attribute_opaque(CK_ATTRIBUTE_TYPE type, [...] )
```

[util\_pkcs11.c L1030](https://github.com/Yubico/yubihsm-shell/blob/91ac2c7e04ef6a6a1ec91b8a58efd1489ff02e63/pkcs11/util_pkcs11.c#L1030)

In `get_attribute_opaque()`, some function paths overwrite the `length` parameter - which is passed as a reference - to the actual length of the field for the specific attribute they fetched. However, for at least three specific field types, this does not happen:

```
   case CKA_SUBJECT:
   case CKA_ISSUER:
   case CKA_SERIAL_NUMBER:
break;
```

[util\_pkcs11.c L1105-L1108](https://github.com/Yubico/yubihsm-shell/blob/91ac2c7e04ef6a6a1ec91b8a58efd1489ff02e63/pkcs11/util_pkcs11.c#L1105-L1108)

As a result, code flows hitting the quoted code lines in `get_attribute_opaque()` will return to the parent function *without* writing data into the `tmp` buffer, *without* changing the `length` parameter away from the maximum value, and *without* returning an error code. By convention, this appears like a successful operation which produced 8192 bytes of new output, although in reality the `tmp` buffer was not written to at all.

This constellation leads to a problematic `memcpy()` call which leaks the uninitialized memory contents of `tmp` into the output:

```
memcpy(pTemplate[i].pValue, tmp, len);
```

[util\_pkcs11.c L5095](https://github.com/Yubico/yubihsm-shell/blob/91ac2c7e04ef6a6a1ec91b8a58efd1489ff02e63/pkcs11/util_pkcs11.c#L5095)

Typically, the content of uninitialized stack memory variables will contain memory from stack frames which previously occupied the relevant memory region. Copying data from this memory region will likely contain stack variables and other stack-related information (stack canaries, pointers) from previous function calls.

The leaked data will then get returned to the PKCS#11 caller. Since the caller requested some specific certificate information, but instead gets data from an information leak, this represents a security issue. Additionally, since the problematic library function indicates no errors, this information may be passed on by the caller towards other components and trust spheres, depending on the specific behavior of the program.

Programs that use the YubiHSM are likely to handle secrets, possibly including secret key material, or sensitive plaintext. The sensitive key material may include the PIN secret used to secure the HSM communication. Because of this bug, a program that uses `yubihsm_pkcs11.so` may inadvertently return such information instead of the requested X.509 certificate attributes.

Since the vulnerable component is a flexible library, it is unclear which programs call into the problematic function, and under which circumstances. Additionally, the relevant memory accesses are undefined behavior (UB) in C and may depend on the compiler and system environment. If you have more information about specific integrating applications and their confirmed security impacts, please contact us.

### Initial Debugging

To confirm that this data actually leaks from the tmp variable on the stack, we used a modified `yubihsm_pkcs11.so` library which specifically marks the memory in question with ASCII âAâ characters. During initial debugging, this allowed a straightforward identification of the problematic memory in returned data:

```
CK_BYTE tmp[8192];
+ // mark potentially leaked bytes
+ memset(tmp, 0x41, sizeof(tmp));
```
### PoC

In order to confirm the issue and help Yubico reproduce it, we crafted a proof-of-concept (PoC). The PoC consists of a short dummy program written in C that triggers the issue: [pkcs11-memleak.c](/assets/artifacts/cve-2023-39908/pkcs11-memleak.c).

**WARNING: use the provided PoC code at your own risk, and only on non-production HSM devices.**

Please see the code comments for setup details and explanations. The special `put_dummy_secrets_on_stack()` function may be of particular interest to understand the leaked output and attack conditions.

### Code History

*Note: this section has been updated to include new information.*

By our understanding, this issue was introduced via a combination of two commits:

1. [This](https://github.com/Yubico/yubihsm-shell/commit/c5723d17cd50081f641da21210942cdc76387673) commit on Sep 8, 2020 (released with version `2.0.3`)
2. [This](https://github.com/Yubico/yubihsm-shell/commit/96732186c970eb6d426f0fa22d4dc81470fd6476#diff-fa4816e3d6c18558a759b602826c3b5345b3d3d3393d95b89357bacdfa231fffR1042-R1046) commit merged on Jan 1, 2023 (released with version `2.4.0`)

Commit 1) introduces the weak `tmp` buffer initialization, and commit 2) introduces problematic code paths and makes the issue reachable.

### Patch

The main patch improves the problematic code paths in `get_attribute_opaque()`:

```
    case CKA_SUBJECT:
    case CKA_ISSUER:
    case CKA_SERIAL_NUMBER:
+      *((CK_BYTE_PTR *) value) = NULL;
+      *length = 0;
      break;
```

[d56f8567d4fe807dc097febbac7bb4e02ca9dea3](https://github.com/Yubico/yubihsm-shell/commit/d56f8567d4fe807dc097febbac7bb4e02ca9dea3)

A second patch improves the buffer initialization:

```
-  CK_BYTE tmp[8192];
+  CK_BYTE tmp[8192] = {0};
```

[util\_pkcs11.c R5179](https://github.com/Yubico/yubihsm-shell/commit/a393ea37ec91df7bb6ed1d70330da8700c45a57d#diff-fa4816e3d6c18558a759b602826c3b5345b3d3d3393d95b89357bacdfa231fffR5179)

Additional references:

* [PR#354](https://github.com/Yubico/yubihsm-shell/pull/354/)

### Security Implications

#### CVSS Score

The described security issue affects the confidentiality of program memory. Due to the characteristics of the flaw, we think that program memory integrity and program availability is not impacted.

As with other memory- and library-related vulnerabilities, it is difficult to say generally what the sensitive information in memory is going to be, and how the leaked information will be processed or exposed by the caller. As a result, the practical worst-case impact will likely be very target-dependent.

| ID | CVSS 3.1 Score | Parameters |
| --- | --- | --- |
| CVE-2023-39908 stack information leak | **4.4** (Medium) | [AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N&version=3.1) |

The listed scoring maps the impact on a network-enabled integrating program which allows a remote user to trigger the affected functionality and obtain secrets after some form of authentication as a high-privileged user. Other integrating programs that use the PKCS#11 driver may have different impacts. For example, if a lower-privileged user can trigger the issue, `PR: L` would turn this into a **5.3** CVSS base score ([calculator](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N&version=3.1)).

## Coordinated Disclosure

As outlined in the [timeline](#timeline), the first ~60 days out of the overall 90 days of disclosure did not see a lot of activity or feedback from the vendor side. This follows a pattern seen with previous coordinated disclosures to Yubico, which also had significant delays between reporting and technical discussion & assessment coordination with the vendor. We recommend focusing on a quicker initial handling for future disclosures to reduce the time pressure on coordination tasks.
We want to positively mention that Yubico has provided security patches and an advisory on the disclosure date for this disclosure, which is an improvement over the previous issue.

### Credits and Commercial Work

During work on integration of YubiHSM2 into [an OpenPGP project](https://codeberg.org/heiko/openpgp-pkcs11), Heiko SchÃ¤fer found the memory safety issue. Christian Reitter assisted with triage, issue analysis, coordinated disclosure and report writeup. In references to this issue, please credit âHeiko SchÃ¤fer and Christian Reitterâ.

Heiko SchÃ¤fer is available for commercial work with a focus on OpenPGP and Rust:

* [OpenPGP CA](https://openpgp-ca.org/),
* OpenPGP on HSM devices ([OpenPGP card](https://gitlab.com/openpgp-card/openpgp-card), PKCS #11, PIV),
* Sequoia PGP.

### Relevant Sources

| Variant | Source | Likely Affected | Fix | References |
| --- | --- | --- | --- | --- |
| Yubico upstream | [GitHub](https://github.com/Yubico/yubihsm-shell) | `2.4.0` | [SDK 2023.08](https://developers.yubico.com/YubiHSM2/Releases/), `2.4.1` | [YSA-2023-01 advisory](https://www.yubico.com/support/security-advisories/ysa-2023-01/), [CVE-2023-39908](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39908) |
| Fedora package | [rpm package](https://src.fedoraproject.org/rpms/yubihsm-shell) | `2.4.0-1` | `2.4.1-1`, [commit](https://src.fedoraproject.org/rpms/yubihsm-shell/c/e3525f8970a3003edd79924b3b2cfc7f50c8ed24) | [bugzilla #2232340](https://bugzilla.redhat.com/show_bug.cgi?id=2232340) |

We originally reproduced the issue with `yubihsm-shell-2.4.0-1.fc38.x86_64` under Fedora. It appears that earlier versions before `2.4.0` do not contain the problematic code path, see [here](#bughistory).

### Detailed Timeline

| Date | Information |
| --- | --- |
| 2023-05-18 | Disclosure of issue to Yubico, including [proof-of-concept](#poc) code |
| 2023-05-24 | Response by Yubico, confirms recept of disclosure |
| 2023-06-21 | Request to Yubico for a status update and severity assessment |
| 2023-07-17 | Status update request to Yubico after lack of response |
| 2023-07-17 | Response by Yubico with technical details and CVSS scoring |
| 2023-07-21 | Message to Yubico, discussing proposed CVSS scoring & CVE |
| 2023-07-25 | Response by Yubico, discussing proposed CVSS scoring |
| 2023-07-31 | Message to Yubico, discussing proposed CVSS scoring & CVE |
| 2023-08-02 | Response by Yubico, outlining CVE assignment and disclosure date plans |
| 2023-08-04 | Response by Yubico, disclosure date plans |
| 2023-08-05 | Message to Yubico, acknowledgment |
| 2023-08-14 | Yubico publishes YSA-2023-01 and patch release |
| 2023-08-14 | Publication of this article |
| 2023-08-16 | Original end date of 90-day coordinated disclosure period |
| 2023-08-23 | Update of this article, revising version information, adding patch details |

### Bug Bounty

At the time of the disclosure, the vendor did not offer a bug bounty.

* **Christian Reitter**

Information security and other interests.



=== Content from www.yubico.com_9bb390de_20250111_130808.html ===


[Skip to content](#wp--skip-link--target)
EnglishFrançaisDeutsch日本語EspañolSvenska

* [Contact Sales](/contact-us/)
* [Resellers](/support/resellers/)
* [Support](https://support.yubico.com/hc/en-us/)

menu![X icon](https://www.yubico.com/wp-content/themes/yubicool/img/icons/close.svg)[![Yubico Header Text Logo](https://www.yubico.com/wp-content/themes/yubicool/img/logos/logo.svg)](https://www.yubico.com)
Why Yubicoexpand\_more
[Why Yubico](https://www.yubico.com/why-yubico/)
How we help

* [Enterprises](https://www.yubico.com/why-yubico/for-business/)
* [SMBs](https://www.yubico.com/why-yubico/yubico-and-smbs/)
* [Individuals](https://www.yubico.com/why-yubico/for-individuals/)
* [Developers](https://www.yubico.com/why-yubico/for-developers/)

Work with us

* [Careers](https://www.yubico.com/careers/)
* [Partner programs](https://www.yubico.com/why-yubico/partners/)

Connect & learn

* [Contact Sales](https://www.yubico.com/contact-us/)
* [Events](https://www.yubico.com/events/)
* [Press room](https://www.yubico.com/press/)
* [About us](/why-yubico/about-us/)
* [The team](/why-yubico/team/)
* [Investors](https://investors.yubico.com/)
* [Innovation history](https://www.yubico.com/why-yubico/yubico-innovation-history/)
* [Secure it Forward](https://www.yubico.com/why-yubico/secure-it-forward/)

![](https://www.yubico.com/wp-content/uploads/2023/03/WhyY-nav-easy-to-use-1.jpg)Easy-to-use, secure authenticationWith YubiKey there’s no tradeoff between great security and usabilityWhy YubiKeysecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/WhyY-nav-google-1.jpg)Proven at scale at GoogleGoogle defends against account takeovers and reduces IT costsGoogle Case Studysecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-passwordless-nav-5-1.jpg)Protecting vulnerable organizationsSecure it Forward: Yubico matches up to 5% of the number of YubiKeys purchased on Yubico.comSecure it Forwardsecurity-advisory
Productsexpand\_more
[All products](/products/)
Hardware

* [YubiKey 5 Series](https://www.yubico.com/products/yubikey-5-overview/)
* [YubiKey 5 FIPS Series](https://www.yubico.com/products/yubikey-fips/)
* [YubiKey Bio Series](https://www.yubico.com/products/yubikey-bio-series/)
* [Security Key Series](/products/security-key/)
* [YubiHSM 2 & YubiHSM 2 FIPS](https://www.yubico.com/products/hardware-security-module/)

Services

* [YubiKey as a Service](https://www.yubico.com/products/yubikey-as-a-service/)
* [YubiEnterprise Delivery](https://www.yubico.com/products/yubienterprise-delivery/)
* [Yubico Enrollment Suite](https://www.yubico.com/products/yubicoenrollmentsuite/)
* [YubiCloud](https://www.yubico.com/products/yubicloud/)

Software and tools

* [Yubico Authenticator](https://www.yubico.com/products/yubico-authenticator/)
* [Computer login tools](https://www.yubico.com/products/computer-login-tools/)
* [Software Development Toolkits](https://www.yubico.com/products/software-development-toolkits-sdks/)

Discover the YubiKey

* [Using YubiKey is easy](https://www.yubico.com/products/ease-of-use/)
* [Find the right YubiKey](/quiz/)
* [Works with YubiKey](/works-with-yubikey/catalog/)
* [Compare YubiKeys](https://www.yubico.com/store/compare/)

![](https://www.yubico.com/wp-content/uploads/2023/03/img-hundreds-services-nav-3-1.jpg)One key for hundreds of apps and servicesYubiKey works out-of-the-box and has no client software or batteryYubico protects yousecurity-advisory
![See YubiKeys as a Service](https://www.yubico.com/wp-content/uploads/2023/03/img-YubiEnterprise-nav-3-1.jpg)YubiKey as a Service delivers scale and savingsGain a future-proofed solution and faster MFA rolloutsYubiKey as a Servicesecurity-advisory
Solutionsexpand\_more
[Solutions overview](/solutions/)
Initiatives

* [Zero Trust](https://www.yubico.com/solutions/zero-trust/)
* [Executive Order OMB M-22-09](https://www.yubico.com/solutions/executive-order-hub/)
* [Phishing-resistant MFA](https://www.yubico.com/solutions/multi-factor-authentication/)
* [Passwordless](https://www.yubico.com/solutions/passwordless/)
* [Compliance](https://www.yubico.com/solutions/cybersecurity-compliance/)
* [Cyber Insurance](https://www.yubico.com/solutions/cyber-insurance/)
* [Critical infrastructure](https://www.yubico.com/solutions/critical-infrastructure-security/)
* [Secure supply chain](/solutions/supply-chain-security/)
* [Protect call centers](https://www.yubico.com/solutions/call-centers/)

Use cases

* [Hybrid & remote workers](/solutions/secure-hybrid-and-remote-workers/)
* [Secure privileged users](https://www.yubico.com/solutions/privileged-users/)
* [Mobile restricted environments](https://www.yubico.com/solutions/mobile-restricted-environment/)
* [Shared workstations](https://www.yubico.com/solutions/shared-workstations/)

Technologies

* [Microsoft ecosystem](https://www.yubico.com/solutions/microsoft-365-mfa/)
* [Salesforce workspace](https://www.yubico.com/solutions/yubico-and-salesforce/)
* [IAM solutions](https://www.yubico.com/solutions/identity-access-management/)
* [AWS environment](https://www.yubico.com/solutions/yubico-and-amazon-web-services/)
* [HYPR experience](https://www.yubico.com/solutions/hypr-and-yubico/)
* [Okta identity solutions](https://www.yubico.com/solutions/okta-and-yubico/)

![](https://www.yubico.com/wp-content/uploads/2023/03/img-passwordless-nav-5-1.jpg)The Bridge to PasswordlessBegin the journey to make your organization passwordless Get the white papersecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-zero-trust-nav-3.jpg)Accelerate your Zero Trust Strategy7 best authentication practices to jumpstart your Zero Trust programGet the white papersecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-federal-nav-3.jpg)Federal cybersecurity requirements Guidance for leaders to prepare for the modern cyber threat eraGet the white papersecurity-advisory
Industriesexpand\_more
[Industries overview](https://www.yubico.com/industries/)
Industries

* [High tech](https://www.yubico.com/industries/technology/)
* [Federal government](https://www.yubico.com/industries/federal/)
* [Department of Defense](https://www.yubico.com/industries/us-department-of-defense/)
* [Federal systems integrators](https://www.yubico.com/industries/federal-systems-integrators/)
* [State & local government](https://www.yubico.com/industries/state-local-government/)
* [Education](https://www.yubico.com/industries/education/)
* [Financial services](https://www.yubico.com/industries/finance/)

* [Retail & hospitality](https://www.yubico.com/industries/retail-and-hospitality/)
* [Telecommunications](/industries/telecommunications/)
* [Healthcare](https://www.yubico.com/industries/healthcare/)
* [Pharmaceuticals](https://www.yubico.com/industries/pharmaceuticals/)
* [Cryptocurrency](https://www.yubico.com/industries/cryptocurrency/)
* [Energy & natural resources](https://www.yubico.com/industries/energy-and-natural-resources/)
* [Manufacturing](https://www.yubico.com/industries/manufacturing/)
* [Elections & campaigns](https://www.yubico.com/industries/political-campaigns/)
* [Insurance organizations](https://www.yubico.com/industries/phishing-resistant-mfa-and-passwordless-for-insurance-organizations/)

![](https://www.yubico.com/wp-content/uploads/2023/03/img-mfg-nav.jpg)Manufacturing and supply chain security Authentication best practices for manufacturingGet the white papersecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-phishing-nav.jpg)Phishing-resistant MFA: Fact vs. FictionMeet requirements for phishing-resistant MFA in OMB M-22-09 guidelinesGet the white papersecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-nat-resources-nav.jpg)Secure energy and natural resources from cyber threats Best practices for phishing-resistant MFA to protect infrastructureGet the white papersecurity-advisory
Resourcesexpand\_more
[All resources](/resources/)
Learn

* [Yubico Blog](https://www.yubico.com/blog/)
* [Cybersecurity glossary](https://www.yubico.com/resources/glossary/)
* [Authentication standards](https://www.yubico.com/authentication-standards/)
* [Resource library](https://www.yubico.com/resources/library/)
* [Developer program](https://developers.yubico.com/)
* [Product briefs](https://www.yubico.com/resource_categories/product-briefs/)
* [Solution briefs](https://www.yubico.com/resource_categories/solution-briefs/)
* [Passkeys](https://www.yubico.com/passkeys/)

Best practices

* [Case studies](https://www.yubico.com/resources/reference-customers/)
* [Get a pilot started](https://www.yubico.com/resources/getting-started/)
* [White papers and reports](https://www.yubico.com/resource_categories/white-papers/)
* [Webinars](https://www.yubico.com/resource_categories/webinars/)

![](https://www.yubico.com/wp-content/uploads/2023/03/img-beyondTrust-nav.jpg)BeyondTrust: secured with a subscriptionPrivileged Access Management leader simplifies deploymentSee case studysecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/04/DCT-608-Navigation-promotional-image-for-451-webinar-390x216-1.jpg)S&P Global Market Intelligence report: old habits die hardOnly 46% of orgs protect their applications with MFA. How about yours?Read the reportsecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/08/img-Ebook-nav.jpg)Considering Passkeys for your Enterprise?Learn how to avoid common passkey pitfallsVisit Passkey Hubsecurity-advisory
Supportexpand\_more
 [Support home](https://support.yubico.com/hc/en-us)
Get started

* [Find the right YubiKey](/quiz/)
* [Set up your YubiKey](/setup/)
* [Downloads](https://www.yubico.com/support/download/)
* [Product documentation](https://docs.yubico.com/)
* [Support articles](https://support.yubico.com/hc/en-us/)

Services

* [Support Services](https://www.yubico.com/support/support-services/)
* [Professional Services](https://www.yubico.com/support/yubico-for-professional-services/)
* [YubiKey as a Service](https://www.yubico.com/products/yubikey-as-a-service/)

Additional resources

* [Works with YubiKey Program](https://www.yubico.com/works-with-yubikey/catalog/?sort=popular)
* [Buying and shipping information](https://www.yubico.com/support/shipping-and-buying-information/)
* [Security advisories](https://www.yubico.com/support/security-advisories/)
* [Help center](https://support.yubico.com/hc/en-us/)

![](https://www.yubico.com/wp-content/uploads/2023/03/img-setup-nav-3.jpg)How to set up your YubiKeyFollow our guided tutorials to start protecting your servicesSet up your YubiKeysecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-find-nav-3.jpg)Find the best YubiKey for your needsTake the guided quiz and see which YubiKeys fit your needsTake the quizsecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-accelerate-nav-3.jpg)Accelerate your YubiKey deploymentTechnical and operational guidance for your YubiKey rolloutProfessional Servicessecurity-advisory
Search![X icon](https://www.yubico.com/wp-content/themes/yubicool/img/icons/close.svg)[Subscribe](/products/yubienterprise-subscription/)[Store](/store/)

* # ****Security Advisory YSA-2023-0**1**

  ## **Security Advisory YSA-2023-01 – YubiHSM 2 SDK uninitialized memory read in the PKCS11 module**

  Published Date: 2023-08-14
  Tracking IDs: YSA-2023-01
  CVE: [CVE-2023-39908](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39908)
  CVSS 3.1: [4.4](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N&version=3.1)

  ### Summary

  The PKCS11 module of the YubiHSM 2 SDK does not properly validate the length of specific read operations on object metadata which may lead to disclosure of uninitialized and previously used memory.

  ### Affected products

  The affected component is the PKCS11 module of the YubiHSM 2 SDK product. Release version 2023.01 of the SDK is affected.

  YubiHSM, YubiHSM 2, YubiKey 5 Series, YubiKey 4 Series, YubiKey FIPS Series, Security Key by Yubico Series, or previous generation YubiKey devices are not impacted.

  If you have yubihsm-shell version 2.4.0 (included in the YubiHSM 2 SDK 2023.01 release), your software is packaged with the affected component and we recommend upgrading to the [latest YubiHSM 2 SDK](https://developers.yubico.com/YubiHSM2/Releases/). This advisory only affects customers who have integrated the PKCS11 module of the YubiHSM 2 SDK into their software development. The functionality in yubihsm-shell binaries is unaffected by this advisory.

  ### How to tell if you are affected

  #### Check the version of the YubiHSM 2 SDK:

  Validate the version returned by invoking the C\_GetInfo function of the YubiHSM 2 SDK.

  Users of the PKCS11 module of the YubiHSM 2 SDK, versions 2023.01 are affected.

  ### Customer Actions

  Affected parties should upgrade yubihsm-shell by installing the latest version of [YubiHSM 2 SDK](https://developers.yubico.com/YubiHSM2/Releases/).

  ### Issue Details

  An issue was discovered in the populate\_template() function of the PKCS11 module of libyubihsm in YubiHSM 2 SDK version 2023.01 where up to 8192 bytes of previously used stack memory may be disclosed to the caller. An authenticated session with the YubiHSM2 is required for the function call to process.

  Reading of this uninitialized memory may lead to a disclosure of application memory, but does not affect secrets stored within the HSM.

  Binaries and releases from third parties integrating this PKCS11 functionality may be impacted differently based on the order of function calls, the data these functions process, and various stack alignment requirements of the operating processor architecture.

  #### Downloads

  The current release of the YubiHSM 2 SDK can be found [here](https://developers.yubico.com/YubiHSM2/Releases/).

  Note:
  The first publishing of this advisory incorrectly stated that affected versions of the YubiHSM 2 SDK were 2023.01 and earlier. This has been corrected as the only vulnerable version is 2023.01.

  ### Acknowledgements

  On May 18, 2023, Heiko Schäfer and Christian Reitter notified Yubico of this security issue. We thank them for reporting it and working with us under coordinated vulnerability disclosure.

  ### **Timeline**

  | May 18, 2023 | Issue is reported to Yubico |
  | --- | --- |
  | August 14, 2023 | Yubico releases advisory YSA-2023-01 |
  | August 15, 2023 | Noted correction for affected versions |

[![Yubico Text Logo](https://www.yubico.com/wp-content/themes/yubicool/img/logos/logo.svg)](https://www.yubico.com)

* [RSS Feed](https://www.yubico.com/feed/)
* [X](https://x.com/Yubico)
* [LinkedIn](https://www.linkedin.com/company/Yubico)
* [Facebook](https://www.facebook.com/Yubikey)
* [Instagram](https://www.instagram.com/Yubico)
* [YouTube](https://www.youtube.com/c/Yubico)
* [GitHub](https://www.github.com/Yubico)

Find

* [Product finder quiz](/quiz/)

Set up

* [Find set-up guides](/setup/)

Buy

* [Buy online](/store)
* [Contact sales](/contact-us/)

Sign up

* [Get Yubico updates](https://www.yubico.com/email-subscription/)

Why Yubico

* [Careers](https://www.yubico.com/careers/)
* [Events](https://www.yubico.com/events/)
* [Press room](https://www.yubico.com/press/)
* [About us](https://www.yubico.com/why-yubico/about-us/)
* [Investors](https://investors.yubico.com)
* [Partner programs](https://www.yubico.com/why-yubico/partners/)

Products

* [YubiKey 5 Series](https://www.yubico.com/products/yubikey-5-overview/)
* [YubiKey 5 FIPS Series](https://www.yubico.com/products/yubikey-fips/)
* [YubiKey Bio Series](https://www.yubico.com/products/yubikey-bio-series/)
* [Security Key Series](https://www.yubico.com/products/security-key/)
* [YubiHSM 2 & YubiHSM 2 FIPS](https://www.yubico.com/products/hardware-security-module/)

* [Yubico Authenticator](https://www.yubico.com/products/yubico-authenticator/)

Solutions

* [Zero Trust](https://www.yubico.com/solutions/zero-trust/)
* [Phishing-resistant MFA](https://www.yubico.com/solutions/multi-factor-authentication/)
* [Passwordless](https://www.yubico.com/solutions/passwordless/)
* [Cyber insurance](https://www.yubico.com/solutions/cyber-insurance/)
* [More solutions](https://www.yubico.com/solutions/)

Industries

* [Industries overview](https://www.yubico.com/industries/)

Resources

* [Yubico blog](https://www.yubico.com/blog/)
* [Resource library](https://www.yubico.com/resources/library/)
* [Cybersecurity glossary](https://www.yubico.com/resources/glossary/)
* [Authentication standards](https://www.yubico.com/authentication-standards/)
* [Developer program](https://developers.yubico.com/)

Support

* [Works with YubiKey](https://www.yubico.com/works-with-yubikey/catalog/?sort=popular/)
* [Help center](https://support.yubico.com/hc/en-us/)
* [Downloads](https://www.yubico.com/support/download/)
* [Product documentation](https://docs.yubico.com/)
* [Support Services](https://www.yubico.com/support-services/)
* [Professional Services](https://www.yubico.com/support/yubico-for-professional-services/)
* [Contact support](https://support.yubico.com/hc/en-us/requests/new/)

EnglishFrançaisDeutsch日本語EspañolSvenska
 Yubico © 2025 All Rights Reserved.

* [Sitemap](/sitemap_index.xml)
* [Cookies](/support/terms-conditions/cookie-notice/)
* [Legal](/support/terms-conditions/)
* [Privacy](/support/terms-conditions/privacy-notice/)
* [Patents](https://www.yubico.com/why-yubico/patents/)
* [Terms of use](/support/terms-conditions/yubico-website-terms-conditions/)
* [Trust](/trust/)


