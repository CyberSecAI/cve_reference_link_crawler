=== Content from plugins.trac.wordpress.org_2ede75b5_20250111_092148.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_snippets%2Fwp-extend-module-listing.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3134252 "Revision 3134252")
* Next Revision →
* [Blame](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php)

---

# [source:](/browser?order=name "Go to repository root") [wpextended](/browser/wpextended?order=name "View wpextended")/[trunk](/browser/wpextended/trunk?order=name "View trunk")/[includes](/browser/wpextended/trunk/includes?order=name "View includes")/[modules](/browser/wpextended/trunk/includes/modules?order=name "View modules")/[core\_extensions](/browser/wpextended/trunk/includes/modules/core_extensions?order=name "View core_extensions")/[wpext\_snippets](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets?order=name "View wpext_snippets")/[wp-extend-module-listing.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?order=name "View wp-extend-module-listing.php")

View diff against:

View revision:

| [Last change](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php "View differences") on this file was [3145393](/changeset/3145393/ "View changeset 3145393"), checked in by wpextended, [4 months ago](/timeline?from=2024-09-02T13%3A38%3A46Z&precision=second "See timeline at 09/02/2024 01:38:46 PM") |
| --- |
| 3.0.9 - 02 September 2024  * Improvement: Hide "Active Modules" until enabled any one module. * Update: Part of the Patchstack VDP Program. * Fix: Post Type Order - Post type order not working with hierarchical parent/children. * Fix: Warnings fixed for PHP 8.\* * Security Fix: Code snippet module - Escaping and sanitising output. * Security Fix: Duplicate Duplicate Pages/Posts module - Added user capability checks. * Security Fix: Block username module - Added user capability checks. |
| **File size:** 17.0 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | if ( ! class\_exists( 'WP\_List\_Table' ) ) { |
| [4](#L4) | require\_once ABSPATH . 'wp-admin/includes/class-wp-list-table.php'; |
| [5](#L5) | } |
| [6](#L6) |  |
| [7](#L7) | class Custom\_List\_Table extends WP\_List\_Table { |
| [8](#L8) | function \_\_construct() { |
| [9](#L9) | parent::\_\_construct(array( |
| [10](#L10) | 'post\_type'      => 'snippet', |
| [11](#L11) | 'singular' => 'item', |
| [12](#L12) | 'plural'   => 'items', |
| [13](#L13) | 'ajax'     => false |
| [14](#L14) | )); |
| [15](#L15) |  |
| [16](#L16) | } |
| [17](#L17) | function column\_default($item, $column\_name) { |
| [18](#L18) | switch ($column\_name) { |
| [19](#L19) | case 'date':  // Add this case |
| [20](#L20) | return $item['date']; |
| [21](#L21) | default: |
| [22](#L22) | return isset($item[$column\_name]) ? $item[$column\_name] : ''; |
| [23](#L23) | } |
| [24](#L24) | } |
| [25](#L25) |  |
| [26](#L26) | function column\_cb($item) { |
| [27](#L27) | return sprintf( |
| [28](#L28) | '<input type="checkbox" name="item[]" value="%s" />', |
| [29](#L29) | $item['ID'] |
| [30](#L30) | ); |
| [31](#L31) | } |
| [32](#L32) | function column\_actions($item) { |
| [33](#L33) | $status = ''; |
| [34](#L34) | $active = get\_post\_meta($item['ID'], 'snippet\_active', true); |
| [35](#L35) | if (!empty($active) && $active == 1) { |
| [36](#L36) | $status = 'checked'; |
| [37](#L37) | } else { |
| [38](#L38) | $status = ''; |
| [39](#L39) | } |
| [40](#L40) | $checkbox = sprintf( |
| [41](#L41) | '<div class="field form-check form-switch form-switch-md d-flex align-items-center gap-5"> |
| [42](#L42) | <input type="checkbox" class= "form-check-input" role="switch" data-snippet-id="%s" %s> |
| [43](#L43) | </div>', |
| [44](#L44) | $item['ID'], |
| [45](#L45) | $status |
| [46](#L46) | ); |
| [47](#L47) | return $checkbox; |
| [48](#L48) | } |
| [49](#L49) |  |
| [50](#L50) | function column\_name($item) { |
| [51](#L51) | $Edit\_url = admin\_url('admin.php?page=wp-extended-edit-snippet&snippet\_id=' . $item['ID']); |
| [52](#L52) | $Delete\_url = wp\_nonce\_url(admin\_url('admin.php?page=wp-extended-snippets&action=delete&snippet\_id=' . $item['ID'])); |
| [53](#L53) | $duplicate\_url = wp\_nonce\_url(admin\_url('admin.php?page=wp-extended-snippets&action=duplicate&snippet\_id=' . $item['ID']), 'duplicate\_snippet\_' . $item['ID']); |
| [54](#L54) |  |
| [55](#L55) | $actions = array( |
| [56](#L56) | 'edit'   => sprintf('<a href="'.$Edit\_url.'">Edit</a>', $\_REQUEST['page'], 'edit', $item['ID']), |
| [57](#L57) | 'delete' => sprintf('<a href="#" wpext-attr-id='.$item['ID'].'>Delete</a>', $\_REQUEST['page'], 'delete', $item['ID']), |
| [58](#L58) | 'duplicate' => sprintf('<a href="%s">Duplicate</a>', $duplicate\_url), |
| [59](#L59) | ); |
| [60](#L60) |  |
| [61](#L61) | return sprintf('%1$s %2$s', $item['name'], $this->row\_actions($actions)); |
| [62](#L62) | } |
| [63](#L63) | function get\_columns() { |
| [64](#L64) | $columns = array( |
| [65](#L65) | 'cb'    => '<input type="checkbox" />', |
| [66](#L66) | 'name'  => 'Name', |
| [67](#L67) | 'codetype' => 'Type', |
| [68](#L68) | 'scope' => 'Description', |
| [69](#L69) | 'date'  => 'Modified', |
| [70](#L70) | 'actions' => 'Actions', |
| [71](#L71) | ); |
| [72](#L72) | return $columns; |
| [73](#L73) | } |
| [74](#L74) |  |
| [75](#L75) | function get\_sortable\_columns() { |
| [76](#L76) | $sortable\_columns = array( |
| [77](#L77) | 'name'       => array('name', false), |
| [78](#L78) | 'codetype'  => array('Code Type', false), |
| [79](#L79) | 'scope'      => array('scope', false), |
| [80](#L80) | 'date'       => array('date', false), |
| [81](#L81) | 'actions'     => array('Actions', false), |
| [82](#L82) | ); |
| [83](#L83) | return $sortable\_columns; |
| [84](#L84) | } |
| [85](#L85) |  |
| [86](#L86) | function get\_bulk\_actions() { |
| [87](#L87) | $actions = array( |
| [88](#L88) | 'delete' => 'Delete' |
| [89](#L89) | ); |
| [90](#L90) | return $actions; |
| [91](#L91) | } |
| [92](#L92) |  |
| [93](#L93) | function process\_bulk\_action() { |
| [94](#L94) | if ('delete' === $this->current\_action()) { |
| [95](#L95) | // Security check |
| [96](#L96) | check\_admin\_referer('bulk-snippets'); |
| [97](#L97) | // Handle bulk delete action |
| [98](#L98) | $selected = (isset($\_REQUEST['item']) && is\_array($\_REQUEST['item'])) ? $\_REQUEST['item'] : array(); |
| [99](#L99) | $deleted\_count = 0; |
| [100](#L100) | foreach ($selected as $item\_id) { |
| [101](#L101) | if (get\_post\_type($item\_id) === 'snippet') { |
| [102](#L102) | wp\_trash\_post($item\_id); |
| [103](#L103) | $deleted\_count++; |
| [104](#L104) | } |
| [105](#L105) | } |
| [106](#L106) | set\_transient('snippets\_deleted', $deleted\_count, 30); |
| [107](#L107) |  |
| [108](#L108) | $del = true; |
| [109](#L109) | return $del; |
| [110](#L110) | } |
| [111](#L111) |  |
| [112](#L112) | // Handle duplicate action |
| [113](#L113) | if ('duplicate' === $this->current\_action() && isset($\_GET['snippet\_id'])) { |
| [114](#L114) | $nonce = $\_REQUEST['\_wpnonce']; |
| [115](#L115) | if ( !wp\_verify\_nonce( $nonce, 'duplicate\_snippet\_' . sanitize\_text\_field( $\_GET['snippet\_id'] ) ) ) { |
| [116](#L116) | die('Security check failed'); |
| [117](#L117) | } |
| [118](#L118) | $this->duplicate\_snippet( sanitize\_text\_field($\_GET['snippet\_id']) ); |
| [119](#L119) | } |
| [120](#L120) | } |
| [121](#L121) |  |
| [122](#L122) | function get\_data($search = '') { |
| [123](#L123) | $snippets = new WP\_Query(array( |
| [124](#L124) | 'post\_type'      => 'snippet', |
| [125](#L125) | 'posts\_per\_page' => -1, |
| [126](#L126) | 'orderby'        => 'title', // Order by title, adjust as needed |
| [127](#L127) | 'order'          => 'ASC',   // Ascending order, adjust as needed |
| [128](#L128) | )); |
| [129](#L129) | $data = array(); |
| [130](#L130) | if ($snippets->have\_posts()) { |
| [131](#L131) | while ($snippets->have\_posts()) { |
| [132](#L132) | $snippets->the\_post(); |
| [133](#L133) | $active = get\_post\_meta(get\_the\_ID(), 'snippet\_active', true); |
| [134](#L134) | $time\_diff = human\_time\_diff(get\_the\_time('U'), current\_time('timestamp')) . ' ago'; |
| [135](#L135) | $data[] = array( |
| [136](#L136) | 'ID'    => get\_the\_ID(), |
| [137](#L137) | 'name'  => get\_the\_title(), |
| [138](#L138) | 'codetype'  => get\_post\_meta(get\_the\_ID(), 'snippet\_code\_type', true), |
| [139](#L139) | 'scope'  => get\_post\_meta(get\_the\_ID(), 'snippet\_code\_sesc', true), |
| [140](#L140) | 'date'  =>  $time\_diff, |
| [141](#L141) | 'actions' => array(get\_post\_meta(get\_the\_ID(), 'snippet\_active', true), false), |
| [142](#L142) | ); |
| [143](#L143) | } |
| [144](#L144) | wp\_reset\_postdata(); |
| [145](#L145) | } |
| [146](#L146) | // Filter data based on search term |
| [147](#L147) | if (!empty($search)) { |
| [148](#L148) | $data = array\_filter($data, function ($item) use ($search) { |
| [149](#L149) | return stripos($item['name'], $search) !== false; |
| [150](#L150) | }); |
| [151](#L151) | } |
| [152](#L152) | return $data; |
| [153](#L153) | } |
| [154](#L154) |  |
| [155](#L155) | public function current\_action() { |
| [156](#L156) | if (isset($\_REQUEST['action']) && $\_REQUEST['action'] !== -1) { |
| [157](#L157) | return sanitize\_key($\_REQUEST['action']); |
| [158](#L158) | } |
| [159](#L159) |  |
| [160](#L160) | if (isset($\_REQUEST['action2']) && $\_REQUEST['action2'] !== -1) { |
| [161](#L161) | return sanitize\_key($\_REQUEST['action2']); |
| [162](#L162) | } |
| [163](#L163) |  |
| [164](#L164) | return false; |
| [165](#L165) | } |
| [166](#L166) | function prepare\_items() { |
| [167](#L167) | $this->process\_bulk\_action(); |
| [168](#L168) | $search = isset($\_REQUEST['s']) ? sanitize\_text\_field($\_REQUEST['s']) : ''; |
| [169](#L169) | $columns  = $this->get\_columns(); |
| [170](#L170) | $hidden   = array(); |
| [171](#L171) | $sortable = $this->get\_sortable\_columns(); |
| [172](#L172) | $this->\_column\_headers = array($columns, $hidden, $sortable); |
| [173](#L173) | $data = $this->get\_data($search); |
| [174](#L174) | // Pagination |
| [175](#L175) | $posts\_per\_page = get\_option('posts\_per\_page'); |
| [176](#L176) | if(!empty($posts\_per\_page)){ |
| [177](#L177) | $per\_page     = $posts\_per\_page; |
| [178](#L178) | }else{ |
| [179](#L179) | $per\_page = 5; |
| [180](#L180) | } |
| [181](#L181) | $current\_page = $this->get\_pagenum(); |
| [182](#L182) | $total\_items  = count($data); |
| [183](#L183) | $this->set\_pagination\_args(array( |
| [184](#L184) | 'total\_items' => $total\_items, |
| [185](#L185) | 'per\_page'    => $per\_page, |
| [186](#L186) | )); |
| [187](#L187) | // Sorting |
| [188](#L188) | if (!empty($\_REQUEST['orderby']) && isset($sortable[$\_REQUEST['orderby']])) { |
| [189](#L189) | $order = ($\_REQUEST['order'] === 'asc') ? SORT\_ASC : SORT\_DESC; |
| [190](#L190) | $data = $this->sort\_data($data, $\_REQUEST['orderby'], $order); |
| [191](#L191) | } |
| [192](#L192) | $data = array\_slice($data, (($current\_page - 1) \* $per\_page), $per\_page); |
| [193](#L193) | $this->items = $data; |
| [194](#L194) | } |
| [195](#L195) | function sort\_data($data, $orderby, $order) { |
| [196](#L196) | usort($data, function ($a, $b) use ($orderby, $order) { |
| [197](#L197) | $result = strcmp($a[$orderby], $b[$orderby]); |
| [198](#L198) | return ($order === SORT\_DESC) ? -$result : $result; |
| [199](#L199) | }); |
| [200](#L200) | return $data; |
| [201](#L201) | } |
| [202](#L202) |  |
| [203](#L203) | public function get\_items() { |
| [204](#L204) | return $this->items; |
| [205](#L205) | } |
| [206](#L206) |  |
| [207](#L207) | function custom\_list\_table\_page() { |
| [208](#L208) | $custom\_list\_table = new Custom\_List\_Table(); |
| [209](#L209) | $custom\_list\_table->prepare\_items(); |
| [210](#L210) | $data = $custom\_list\_table->items; // Get the data items |
| [211](#L211) | ?> |
| [212](#L212) | <div class="wrap"> |
| [213](#L213) | <?php |
| [214](#L214) | $items = $custom\_list\_table->get\_items(); ?> |
| [215](#L215) | <form method="get"> |
| [216](#L216) | <input type="hidden" name="page" value="<?php echo esc\_attr( sanitize\_text\_field( $\_REQUEST['page'] ) ); ?>"> |
| [217](#L217) | <?php $custom\_list\_table->search\_box('Search Snippets', 'search\_id'); ?> |
| [218](#L218) | </form> |
| [219](#L219) | <form method="post"> |
| [220](#L220) | <?php |
| [221](#L221) | $items = $custom\_list\_table->get\_items(); |
| [222](#L222) | if (!empty($items)) { |
| [223](#L223) | $custom\_list\_table->display(); |
| [224](#L224) | wp\_nonce\_field('bulk-snippets'); |
| [225](#L225) | self::popup\_after\_existing\_items(); |
| [226](#L226) | } ?> |
| [227](#L227) | </form> |
| [228](#L228) | </div> |
| [229](#L229) | <?php |
| [230](#L230) | $items = $custom\_list\_table->get\_items(); |
| [231](#L231) | if (empty($items)) { |
| [232](#L232) | self::wpex\_first\_step\_snippet\_button(); |
| [233](#L233) | } |
| [234](#L234) |  |
| [235](#L235) | } |
| [236](#L236) |  |
| [237](#L237) | public function wpex\_first\_step\_snippet\_button(){ |
| [238](#L238) | ?> |
| [239](#L239) | <div class="container wpext-container wpext\_snippet\_steps"> |
| [240](#L240) | <div class="col-sm-12 bg-white p-lg-5 border rounded-2 text-center"> |
| [241](#L241) | <h1 class="modal-title fs-5 pb-3"><?php \_e("You haven't yet setup any code snippets.", WP\_EXTENDED\_TEXT\_DOMAIN); ?></h1> |
| [242](#L242) | <button type="button" class="btn wp-ext-btn-prim wpext\_snippet\_popup" data-bs-toggle="modal" data-bs-target="#staticBackdrop"> |
| [243](#L243) | <?php \_e('Get Started', WP\_EXTENDED\_TEXT\_DOMAIN); ?> |
| [244](#L244) | </button> |
| [245](#L245) | <!-- Modal --> |
| [246](#L246) | <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true"> |
| [247](#L247) | <div class="modal-dialog modal-dialog-centered"> |
| [248](#L248) | <div class="modal-content"> |
| [249](#L249) | <div class="modal-header"> |
| [250](#L250) | <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> |
| [251](#L251) | </div> |
| [252](#L252) | <div class="modal-body"> |
| [253](#L253) | <h1 class="modal-title fs-5" id="staticBackdropLabel"><?php \_e('Select the code type', WP\_EXTENDED\_TEXT\_DOMAIN ); ?></h1> |
| [254](#L254) | <div class="row"> |
| [255](#L255) | <div class="col-sm radio-container rounded-2" onclick="selectRadio('PHP', this);"> |
| [256](#L256) | <input type="radio" name="wpext\_snippet\_option" value="PHP" id="PHP"> |
| [257](#L257) | <label for="PHP"><?php \_e('PHP', WP\_EXTENDED\_TEXT\_DOMAIN); ?></label> |
| [258](#L258) | </div> |
| [259](#L259) | <div class="col-sm radio-container rounded-2" onclick="selectRadio('JAVASCRIPT', this); "> |
| [260](#L260) | <input type="radio" name="wpext\_snippet\_option" value="JAVASCRIPT" id="JAVASCRIPT"> |
| [261](#L261) | <label for="JAVASCRIPT"><?php \_e('JS', WP\_EXTENDED\_TEXT\_DOMAIN); ?></label> |
| [262](#L262) | </div> |
| [263](#L263) | <div class="col-sm radio-container rounded-2" onclick="selectRadio('CSS', this); "> |
| [264](#L264) | <input type="radio" name="wpext\_snippet\_option" value="CSS" id="CSS"> |
| [265](#L265) | <label for="CSS"><?php \_e('CSS', WP\_EXTENDED\_TEXT\_DOMAIN); ?></label> |
| [266](#L266) | </div> |
| [267](#L267) |  |
| [268](#L268) | </div> |
| [269](#L269) | </div> |
| [270](#L270) | <div class="modal-footer"> |
| [271](#L271) | <a href="<?php echo home\_url(); ?>/wp-admin/admin.php?page=wp-extended-add-snippet" |
| [272](#L272) | class="btn wp-ext-btn-prim wpext\_snippet\_popup" id="wpext\_goto\_snippet" onclick="appendRadioValue()"> |
| [273](#L273) | <?php \_e('Get Started', WP\_EXTENDED\_TEXT\_DOMAIN); ?> |
| [274](#L274) | </a> |
| [275](#L275) | </div> |
| [276](#L276) | </div> |
| [277](#L277) | </div> |
| [278](#L278) | </div> |
| [279](#L279) | </div> |
| [280](#L280) | </div> |
| [281](#L281) | <?php |
| [282](#L282) | } |
| [283](#L283) |  |
| [284](#L284) | public function popup\_after\_existing\_items(){ ?> |
| [285](#L285) | <div class="container wpext-container wpext\_snippet\_steps" id="wpext\_existing\_popup" style="height:0px;"> |
| [286](#L286) | <div class="col-sm-12 p-lg-5 text-center"> |
| [287](#L287) | <button type="button" class="btn wp-ext-btn-prim d-none wpext\_snippet\_popup" data-bs-toggle="modal" data-bs-target="#staticBackdrop"> |
| [288](#L288) | <?php \_e('Get Started', WP\_EXTENDED\_TEXT\_DOMAIN); ?> |
| [289](#L289) | </button> |
| [290](#L290) | <!-- Modal --> |
| [291](#L291) | <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true"> |
| [292](#L292) | <div class="modal-dialog modal-dialog-centered"> |
| [293](#L293) | <div class="modal-content"> |
| [294](#L294) | <div class="modal-header"> |
| [295](#L295) | <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> |
| [296](#L296) | </div> |
| [297](#L297) | <div class="modal-body"> |
| [298](#L298) | <h1 class="modal-title fs-5" id="staticBackdropLabel"><?php \_e('Select the code type', WP\_EXTENDED\_TEXT\_DOMAIN ); ?></h1> |
| [299](#L299) | <div class="row"> |
| [300](#L300) | <div class="col-sm radio-container rounded-2" onclick="selectRadio\_existing('PHP', this);"> |
| [301](#L301) | <input type="radio" name="wpext\_snippet\_option" value="PHP" id="PHP"> |
| [302](#L302) | <label for="PHP"><?php \_e('PHP', WP\_EXTENDED\_TEXT\_DOMAIN); ?></label> |
| [303](#L303) | </div> |
| [304](#L304) | <div class="col-sm radio-container rounded-2" onclick="selectRadio\_existing('JAVASCRIPT', this); "> |
| [305](#L305) | <input type="radio" name="wpext\_snippet\_option" value="JAVASCRIPT" id="JAVASCRIPT"> |
| [306](#L306) | <label for="JAVASCRIPT"><?php \_e('JS', WP\_EXTENDED\_TEXT\_DOMAIN); ?></label> |
| [307](#L307) | </div> |
| [308](#L308) | <div class="col-sm radio-container rounded-2" onclick="selectRadio\_existing('CSS', this); "> |
| [309](#L309) | <input type="radio" name="wpext\_snippet\_option" value="CSS" id="CSS"> |
| [310](#L310) | <label for="CSS"><?php \_e('CSS', WP\_EXTENDED\_TEXT\_DOMAIN); ?></label> |
| [311](#L311) | </div> |
| [312](#L312) | </div> |
| [313](#L313) | </div> |
| [314](#L314) | <div class="modal-footer"> |
| [315](#L315) | <a href="<?php echo home\_url(); ?>/wp-admin/admin.php?page=wp-extended-add-snippet" |
| [316](#L316) | class="btn wp-ext-btn-prim wpext\_snippet\_popup" id="wpext\_goto\_snippet" onclick="appendRadioValue()"> |
| [317](#L317) | <?php \_e('Get Started', WP\_EXTENDED\_TEXT\_DOMAIN); ?> |
| [318](#L318) | </a> |
| [319](#L319) | </div> |
| [320](#L320) | </div> |
| [321](#L321) | </div> |
| [322](#L322) | </div> |
| [323](#L323) | </div> |
| [324](#L324) | </div> <?php |
| [325](#L325) | } |
| [326](#L326) |  |
| [327](#L327) | function display() { |
| [328](#L328) | $this->display\_tablenav('top'); |
| [329](#L329) | ?> |
| [330](#L330) | <table class="wp-list-table <?php echo implode(' ', $this->get\_table\_classes()); ?>"> |
| [331](#L331) | <thead> |
| [332](#L332) | <tr> |
| [333](#L333) | <?php $this->print\_column\_headers(); ?> |
| [334](#L334) | </tr> |
| [335](#L335) | </thead> |
| [336](#L336) | <tbody id="the-list"<?php |
| [337](#L337) | if ($this->has\_items()) { |
| [338](#L338) | echo ' class="has-items"'; |
| [339](#L339) | } |
| [340](#L340) | ?>> |
| [341](#L341) | <?php $this->display\_rows\_or\_placeholder(); ?> |
| [342](#L342) | </tbody> |
| [343](#L343) | <tfoot> |
| [344](#L344) | <!-- Remove the footer --> |
| [345](#L345) | </tfoot> |
| [346](#L346) | </table> |
| [347](#L347) | <?php |
| [348](#L348) | // $this->display\_tablenav('bottom'); // This line can be removed to hide bulk actions |
| [349](#L349) | } |
| [350](#L350) |  |
| [351](#L351) | function duplicate\_snippet($id) { |
| [352](#L352) | $post = get\_post($id); |
| [353](#L353) |  |
| [354](#L354) | if (isset($post) && $post != null) { |
| [355](#L355) | $new\_post = array( |
| [356](#L356) | 'post\_title'    => $post->post\_title . ' (Duplicate)', |
| [357](#L357) | 'post\_content'  => $post->post\_content, |
| [358](#L358) | 'post\_status'   => 'draft', |
| [359](#L359) | 'post\_type'     => $post->post\_type, |
| [360](#L360) | 'post\_author'   => get\_current\_user\_id(), |
| [361](#L361) | ); |
| [362](#L362) |  |
| [363](#L363) | $new\_post\_id = wp\_insert\_post($new\_post); |
| [364](#L364) |  |
| [365](#L365) | // Duplicate post meta |
| [366](#L366) | $post\_meta = get\_post\_meta($post->ID); |
| [367](#L367) |  |
| [368](#L368) | foreach ($post\_meta as $key => $value) { |
| [369](#L369) | if($key == "snippet\_active"){ |
| [370](#L370) | $snippetActiveValue = 0; |
| [371](#L371) | update\_post\_meta($new\_post\_id, $key, maybe\_unserialize($snippetActiveValue)); |
| [372](#L372) | }else{ |
| [373](#L373) | update\_post\_meta($new\_post\_id, $key, maybe\_unserialize($value[0])); |
| [374](#L374) | } |
| [375](#L375) | } |
| [376](#L376) |  |
| [377](#L377) | // Construct the URL and escape it |
| [378](#L378) | $redirect\_url = admin\_url('admin.php?page=wp-extended-edit-snippet&snippet\_id=' . $new\_post\_id); |
| [379](#L379) |  |
| [380](#L380) | echo '<script type="text/javascript"> |
| [381](#L381) | window.location.href = "' . $redirect\_url . '"; |
| [382](#L382) | </script>'; |
| [383](#L383) | exit; |
| [384](#L384) | } |
| [385](#L385) | } |
| [386](#L386) | } |
| [387](#L387) |  |
| [388](#L388) |  |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?format=txt)
* [Original Format](/export/3220637/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_cd8e27ae_20250111_092150.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# The Ultimate WordPress Toolkit – WP Extended <= 3.0.8 - Reflected Cross-Site Scripting via page

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   The Ultimate WordPress Toolkit – WP Extended <= 3.0.8 - Reflected Cross-Site Scripting via page

6.1

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-8119](https://www.cve.org/CVERecord?id=CVE-2024-8119) |
| --- | --- |
| CVSS | 6.1 (Medium) |
| Publicly Published | September 3, 2024 |
| Last Updated | September 4, 2024 |
| Researcher | [Marco Wotschka - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/marco-wotschka) |

### Description

The The Ultimate WordPress Toolkit – WP Extended plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the page parameter in all versions up to, and including, 3.0.8 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php#L216)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=3145430%40wpextended%2Ftrunk&old=3134345%40wpextended%2Ftrunk&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwpextended%2Fthe-ultimate-wordpress-toolkit-wp-extended-308-reflected-cross-site-scripting-via-page&t=The%20Ultimate%20WordPress%20Toolkit%20%E2%80%93%20WP%20Extended%20%3C%3D%203.0.8%20-%20Reflected%20Cross-Site%20Scripting%20via%20page "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwpextended%2Fthe-ultimate-wordpress-toolkit-wp-extended-308-reflected-cross-site-scripting-via-page&text=The%20Ultimate%20WordPress%20Toolkit%20%E2%80%93%20WP%20Extended%20%3C%3D%203.0.8%20-%20Reflected%20Cross-Site%20Scripting%20via%20page "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwpextended%2Fthe-ultimate-wordpress-toolkit-wp-extended-308-reflected-cross-site-scripting-via-page "LinkedIn")
Email

## Vulnerability Details for The Ultimate WordPress Toolkit – WP Extended

#### [The Ultimate WordPress Toolkit – WP Extended](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wpextended)

| Software Type | Plugin |
| --- | --- |
| Software Slug | wpextended [(view on wordpress.org)](https://wordpress.org/plugins/wpextended) |
| Patched? | Yes |
| Remediation | Update to version 3.0.9, or a newer patched version |
| Affected Version | * <= 3.0.8 |
| Patched Version | * 3.0.9 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_6008f119_20250111_092149.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3145430%2540wpextended%252Ftrunk%26old%3D3134345%2540wpextended%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/3134345/wpextended/trunk?old=3145430&old_path=%2Fwpextended%2Ftrunk)

---

# Changes in [wpextended/trunk](/browser/wpextended/trunk?rev=3145430 "Show entry in browser") [[3134345:3145430]](/log/wpextended/trunk?rev=3145430&stop_rev=3134345 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[wpextended/trunk](/browser/wpextended/trunk?rev=3145430)
Files:

23 edited

* [admin/class-wp-extended-admin.php](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3145393 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [admin/js/wp\_extended-admin.js](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3145393 "Show entry in browser")
  (modified)
  ([4 diffs](#file1 "Show differences"))
* [admin/partials/wp-extend-admin-display.php](/browser/wpextended/trunk/admin/partials/wp-extend-admin-display.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [includes/libraries/wpext\_export/wpext\_export.php](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3145393 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [includes/modules/core\_extensions/wpext\_block\_user\_name\_admin/wpext\_block\_user\_name\_admin.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?rev=3145430 "Show entry in browser")
  (modified)
  ([2 diffs](#file4 "Show differences"))
* [includes/modules/core\_extensions/wpext\_change\_wp\_admin\_url/wpext\_change\_wp\_admin\_url.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_change_wp_admin_url/wpext_change_wp_admin_url.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))
* [includes/modules/core\_extensions/wpext\_duplicate\_menu/wpext\_duplicate\_menu.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicate_menu/wpext_duplicate_menu.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [includes/modules/core\_extensions/wpext\_duplicator/wpext\_duplicator.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3145393 "Show entry in browser")
  (modified)
  ([4 diffs](#file7 "Show differences"))
* [includes/modules/core\_extensions/wpext\_export\_users/wpext\_export\_users.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?rev=3145393 "Show entry in browser")
  (modified)
  ([2 diffs](#file8 "Show differences"))
* [includes/modules/core\_extensions/wpext\_external\_permalinks/wpext\_external\_permalinks.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_external_permalinks/wpext_external_permalinks.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file9 "Show differences"))
* [includes/modules/core\_extensions/wpext\_hide\_admin\_bar/wpext\_hide\_admin\_bar.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_hide_admin_bar/wpext_hide_admin_bar.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file10 "Show differences"))
* [includes/modules/core\_extensions/wpext\_limit\_login\_attempts/wpext\_limit\_login\_attempts.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_limit_login_attempts/wpext_limit_login_attempts.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file11 "Show differences"))
* [includes/modules/core\_extensions/wpext\_maintenance\_mode/wpext\_maintenance\_mode.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_maintenance_mode/wpext_maintenance_mode.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file12 "Show differences"))
* [includes/modules/core\_extensions/wpext\_pixel\_tag\_manager/wpext\_pixel\_tag\_manager.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_pixel_tag_manager/wpext_pixel_tag_manager.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file13 "Show differences"))
* [includes/modules/core\_extensions/wpext\_post\_order/wpext\_post\_order.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_post_order/wpext_post_order.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file14 "Show differences"))
* [includes/modules/core\_extensions/wpext\_smtp\_email/wpext\_smtp\_email.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_smtp_email/wpext_smtp_email.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file15 "Show differences"))
* [includes/modules/core\_extensions/wpext\_snippets/old/wpext\_snippets.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?rev=3145393 "Show entry in browser")
  (modified)
  ([2 diffs](#file16 "Show differences"))
* [includes/modules/core\_extensions/wpext\_snippets/wp-extend-module-listing.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3145393 "Show entry in browser")
  (modified)
  ([3 diffs](#file17 "Show differences"))
* [includes/modules/core\_extensions/wpext\_snippets/wpext\_snippets.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3145393 "Show entry in browser")
  (modified)
  ([4 diffs](#file18 "Show differences"))
* [includes/modules/core\_extensions/wpext\_tidy\_nav/wpext\_tidy\_nav.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_tidy_nav/wpext_tidy_nav.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file19 "Show differences"))
* [includes/modules/core\_extensions/wpext\_user\_sections/wpext\_user\_sections.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_user_sections/wpext_user_sections.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file20 "Show differences"))
* [readme.txt](/browser/wpextended/trunk/readme.txt?rev=3145393 "Show entry in browser")
  (modified)
  ([3 diffs](#file21 "Show differences"))
* [wp-extended.php](/browser/wpextended/trunk/wp-extended.php?rev=3145393 "Show entry in browser")
  (modified)
  ([2 diffs](#file22 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wpextended/trunk/admin/class-wp-extended-admin.php](/changeset/3145393/wpextended/trunk/admin/class-wp-extended-admin.php?old=3131199&old_path=wpextended%2Ftrunk%2Fadmin%2Fclass-wp-extended-admin.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/admin/class-wp-extended-admin.php")

  | [r3134345](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3131199#L41 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3145393#L41 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 41 | 41 | add\_action('admin\_enqueue\_scripts', array( $this, 'enqueue\_styles' ) ); |
  | 42 | 42 | add\_action('admin\_enqueue\_scripts', array( $this, 'enqueue\_scripts' ), 99 ); |
  | 43 |  |  |
  | 44 | 43 | add\_action('wp\_ajax\_wp-extended-module-toggle',   array( $this, 'module\_toggle\_ajax') ); |
  | 45 |  | ~~add\_action('wp\_ajax\_wp-extended-module-all-toggle',   array( $this, 'module\_all\_toggle\_ajax') );~~ |
  | 46 | 44 | add\_action('wpext\_plugin\_sidebar', array( $this, 'admin\_plugin\_info\_sidebar' ), 100 ); |
  | 47 | 45 | add\_action('admin\_plugin\_top\_info', array( $this, 'wpext\_admin\_plugin\_top\_info' ), 100 ); |
  | […](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3131199#L255) | […](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3145393#L253) |  |
  | 255 | 253 | include \_\_DIR\_\_ . '/partials/wp-extend-admin-display.php'; |
  | 256 | 254 | } // admin\_display |
  | 257 |  |  |
  | 258 |  | /\* |
  | 259 |  | \* AJAX endpoint for all module activation/dectivation |
  | 260 |  | \*/ |
  | 261 |  |  |
  | 262 |  | public function module\_all\_toggle\_ajax(){ |
  | 263 |  |  |
  | 264 |  | $status = $\_POST['status']; |
  | 265 |  | $allaction = $\_POST['allaction']; |
  | 266 |  |  |
  | 267 |  | $groups = $this->groups(); |
  | 268 |  | $modules = $this->modules(); |
  | 269 |  |  |
  | 270 |  | update\_option( $allaction, $status); |
  | 271 |  | $response = get\_option( $allaction); |
  | 272 |  |  |
  | 273 |  | foreach ($modules['core\_extensions'] as  $modulename) { |
  | 274 |  | $module = $modulename['dirname']; |
  | 275 |  | if ($modulename['available']){ |
  | 276 |  | $this->module\_toggle( $module, $status ); |
  | 277 |  | } |
  | 278 |  | } |
  | 279 |  | wp\_send\_json( $response ); |
  | 280 |  | die('0'); |
  | 281 |  | } |
  |  | 255 |  |
  | 282 | 256 | /\* |
  | 283 | 257 | \* AJAX endpoint for module activation |
* ## [wpextended/trunk/admin/js/wp\_extended-admin.js](/changeset/3145393/wpextended/trunk/admin/js/wp_extended-admin.js?old=3131199&old_path=wpextended%2Ftrunk%2Fadmin%2Fjs%2Fwp_extended-admin.js "Show the [3134345:3145430] differences restricted to wpextended/trunk/admin/js/wp_extended-admin.js")

  | [r3134345](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3131199#L541 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3145393#L541 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 541 | 541 | .attr('onclick') |
  | 542 | 542 | .match(/'([^']+)'/)[1]; |
  | 543 |  |  |
  |  | 543 |  |
  | 544 | 544 | jQuery('.item.list-group-item, .item.grid-group-item').each(function () { |
  | 545 | 545 | var checkbox = jQuery(this).find('.form-check-input'); |
  | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3131199#L582) | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3145393#L582) |  |
  | 582 | 582 |  |
  | 583 | 583 | var urlParams = new URLSearchParams(window.location.search); |
  | 584 |  | if (urlParams.get('page') === 'wp-extended') { |
  |  | 584 | if (urlParams.get('page') === 'wp-extended') { |
  | 585 | 585 | // Attach the change event listener to the Active Modules checkbox |
  | 586 | 586 | jQuery('#wpext\_active\_modules').change(function () { |
  | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3131199#L595) | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3145393#L595) |  |
  | 595 | 595 | } |
  | 596 | 596 |  |
  |  | 597 | // Delay the visibility toggle when the page reloads |
  |  | 598 | setTimeout(function() { |
  |  | 599 | toggleItemsVisibility(); |
  |  | 600 | }, 100); |
  |  | 601 |  |
  | 597 | 602 | jQuery('#wpext\_active\_modules').on('change', function () { |
  | 598 | 603 | var isChecked = this.checked; |
  | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3131199#L608) | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3145393#L613) |  |
  | 608 | 613 | }); |
  | 609 | 614 | }); |
  |  | 615 |  |
  |  | 616 | /\*Hide show active module \*/ |
  |  | 617 | jQuery(document).ready(function($) { |
  |  | 618 | // Function to toggle visibility of the container based on checkboxes' state |
  |  | 619 | function toggleActiveModulesContainer() { |
  |  | 620 | var $checkboxes = $('.wpext\_toggle\_settings .card-footer input[type="checkbox"]'); |
  |  | 621 | var $activeModulesContainer = $('.wpext\_toggle\_settings .wpext\_active\_modules\_container'); |
  |  | 622 | var anyChecked = $checkboxes.is(':checked'); |
  |  | 623 | if (anyChecked) { |
  |  | 624 | $activeModulesContainer.show(); |
  |  | 625 | } else { |
  |  | 626 | $activeModulesContainer.hide(); |
  |  | 627 | } |
  |  | 628 | } |
  |  | 629 | $('.wpext\_toggle\_settings .card-footer input[type="checkbox"]').click(function() { |
  |  | 630 | toggleActiveModulesContainer(); |
  |  | 631 | }); |
  |  | 632 |  |
  |  | 633 | // Initial call to set the correct visibility based on checkbox states |
  |  | 634 | toggleActiveModulesContainer(); |
  |  | 635 | }); |
  |  | 636 | /\*Hide show active module end here \*/ |
* ## [wpextended/trunk/admin/partials/wp-extend-admin-display.php](/changeset/3145393/wpextended/trunk/admin/partials/wp-extend-admin-display.php?old=3131199&old_path=wpextended%2Ftrunk%2Fadmin%2Fpartials%2Fwp-extend-admin-display.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/admin/partials/wp-extend-admin-display.php")

  | [r3134345](/browser/wpextended/trunk/admin/partials/wp-extend-admin-display.php?rev=3131199#L72 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/admin/partials/wp-extend-admin-display.php?rev=3145393#L72 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 72 | 72 | </div> |
  | 73 | 73 | <div class="wpext\_active\_modules\_container me-lg-3"> |
  | 74 |  | <label for="wpext\_active\_modules" class="mt-1"><?php \_e('Active Modules',WP\_EXTENDED\_TEXT\_DOMAIN); ?></label> |
  | 75 |  | <div class="field form-check form-switch form-switch-md"> |
  | 76 |  | <?php |
  | 77 |  | $action\_module\_status = get\_option('wpext\_active\_modules\_status'); |
  | 78 |  |  |
  | 79 |  | if($action\_module\_status == 'true'){ |
  | 80 |  | $status = 'checked'; |
  | 81 |  | }else{ |
  | 82 |  | $status = ''; |
  | 83 |  | } |
  | 84 |  | ?> |
  | 85 |  | <input id="wpext\_active\_modules" name="wpext\_active\_modules" type="checkbox" class="form-check-input" <?php echo $status; ?> role="switch"> |
  | 86 |  | </div> |
  | 87 |  | </div> |
  |  | 74 | <?php |
  |  | 75 | $wpext\_module\_status = get\_option('wp-extended-modules'); |
  |  | 76 | $has\_displayed = false; |
  |  | 77 | foreach($wpext\_module\_status as $key => $module\_status) { |
  |  | 78 | if(!empty($module\_status) && !$has\_displayed) { ?> |
  |  | 79 | <label for="wpext\_active\_modules" class="mt-1"><?php \_e('Active Modules', WP\_EXTENDED\_TEXT\_DOMAIN); ?></label> |
  |  | 80 | <div class="field form-check form-switch form-switch-md"> |
  |  | 81 | <?php |
  |  | 82 | $action\_module\_status = get\_option('wpext\_active\_modules\_status'); |
  |  | 83 | if($action\_module\_status == 'true'){ |
  |  | 84 | $status = 'checked'; |
  |  | 85 | } else { |
  |  | 86 | $status = ''; |
  |  | 87 | } |
  |  | 88 | ?> |
  |  | 89 | <input id="wpext\_active\_modules" name="wpext\_active\_modules" type="checkbox" class="form-check-input" <?php echo $status; ?>  role="switch"> |
  |  | 90 | </div> |
  |  | 91 | <?php |
  |  | 92 | $has\_displayed = true; // Set the flag to true to prevent further display |
  |  | 93 | } |
  |  | 94 | } ?> |
  |  | 95 | </div> |
  | 88 | 96 | </div> |
  | 89 | 97 | <!-- end grid section --> |
* ## [wpextended/trunk/includes/libraries/wpext\_export/wpext\_export.php](/changeset/3145393/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?old=3134252&old_path=wpextended%2Ftrunk%2Fincludes%2Flibraries%2Fwpext_export%2Fwpext_export.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/libraries/wpext_export/wpext_export.php")

  | [r3134345](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3134252#L136 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3145393#L136 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 136 | 136 |  |
  | 137 | 137 | public function download\_file\_ajax(){ |
  | 138 |  | $filename = $\_GET['filename']; |
  | 139 |  |  |
  |  | 138 |  |
  |  | 139 | /\* Security Issues fixed \*/ |
  |  | 140 | if ( ! current\_user\_can( 'manage\_options' ) ) { |
  |  | 141 | wp\_send\_json\_error( \_\_( 'You do not have permission to access this file.', WP\_EXTENDED\_TEXT\_DOMAIN ) ); |
  |  | 142 | wp\_die(); |
  |  | 143 | } |
  |  | 144 | // Verify the nonce for security. |
  |  | 145 | check\_ajax\_referer( 'wpext-ajax-nonce', 'wpext\_nonce' ); |
  |  | 146 |  |
  |  | 147 | // Sanitize the filename. |
  |  | 148 | $filename = isset( $\_GET['filename'] ) ? sanitize\_file\_name( $\_GET['filename'] ) : ''; |
  |  | 149 |  |
  |  | 150 | if ( empty( $filename ) ) { |
  |  | 151 | wp\_send\_json\_error( \_\_( 'Invalid file request.', WP\_EXTENDED\_TEXT\_DOMAIN ) ); |
  |  | 152 | wp\_die(); |
  |  | 153 | } |
  |  | 154 | /\* Security Issues fixed end here\*/ |
  |  | 155 |  |
  | 140 | 156 | $sent = $this->download\_file( $filename ); |
  | 141 |  |  |
  | 142 | 157 | if( $sent !== true ) { |
  | 143 | 158 | wp\_send\_json( $sent ); |
  | […](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3134252#L152) | […](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3145393#L167) |  |
  | 152 | 167 | try { |
  | 153 | 168 | $dir = $this->\_get\_files\_dir(); |
  | 154 |  |  |
  | 155 |  |  |
  | 156 |  | $file\_path = $dir . "/" . $filename; |
  | 157 |  |  |
  | 158 |  |  |
  |  | 169 | $file\_path = realpath( $dir . '/' . $filename ); |
  |  | 170 |  |
  | 159 | 171 | if( !file\_exists( $file\_path ) ) { |
  | 160 | 172 | throw new \Exception( "File not found" ); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_block\_user\_name\_admin/wpext\_block\_user\_name\_admin.php](/changeset/3145430/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_block_user_name_admin%2Fwpext_block_user_name_admin.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?rev=3099195#L21 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?rev=3145430#L21 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | } |
  | 22 | 22 |  |
  | 23 |  | public function wpext\_check\_the\_current\_username(){ |
  | 24 |  | $admin\_user = get\_user\_by('login', 'admin'); |
  | 25 |  | if ($admin\_user) { |
  | 26 |  | add\_action('admin\_notices', array($this, 'wpext\_admin\_notice')); |
  | 27 |  | } |
  |  | 23 | public function wpext\_check\_the\_current\_username() { |
  |  | 24 | $admin\_user = get\_user\_by('login', 'admin'); |
  |  | 25 | $user = wp\_get\_current\_user(); |
  |  | 26 | $roles = is\_array($user->roles) ? $user->roles : array(); |
  |  | 27 | // Validate that the current user is an administrator and the 'admin' user exists |
  |  | 28 | if ($admin\_user && isset($roles[0]) && sanitize\_text\_field($roles[0]) === 'administrator') { |
  |  | 29 | add\_action('admin\_notices', array($this, 'wpext\_admin\_notice')); |
  |  | 30 | } |
  | 28 | 31 | } |
  | 29 | 32 |  |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?rev=3099195#L49) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?rev=3145430#L52) |  |
  | 49 | 52 | public function wpext\_change\_admin\_name(){ |
  | 50 | 53 | global $wpdb; |
  | 51 |  | if( ! wp\_verify\_nonce(sanitize\_text\_field($\_REQUEST['nonce']), 'wpext-nonce' ) ) { |
  | 52 |  | $result = array( |
  | 53 |  | 'status' => false, |
  | 54 |  | 'error' => \_\_( 'Invalid nonce!', WP\_EXTENDED\_TEXT\_DOMAIN ) |
  | 55 |  | ); |
  | 56 |  | wp\_send\_json( $result ); |
  | 57 |  | die(); |
  |  | 54 |  |
  |  | 55 | // Verify nonce |
  |  | 56 |  |
  |  | 57 | if ( ! isset( $\_REQUEST['nonce'] ) || ! wp\_verify\_nonce( sanitize\_text\_field( $\_REQUEST['nonce'] ), 'wpext-nonce' ) ) { |
  |  | 58 | wp\_send\_json( array( 'status' => false, 'error' => \_\_( 'Invalid nonce!', WP\_EXTENDED\_TEXT\_DOMAIN ) ) ); |
  |  | 59 | die(); |
  | 58 | 60 | } |
  |  | 61 |  |
  |  | 62 | // Capability check: Allow only administrators |
  |  | 63 |  |
  |  | 64 | if ( ! current\_user\_can( 'manage\_options' ) ) { |
  |  | 65 | wp\_send\_json( array( 'status' => false, 'error' => \_\_( 'You do not have sufficient permissions to perform this action.', WP\_EXTENDED\_TEXT\_DOMAIN ) ) ); |
  |  | 66 | die(); |
  |  | 67 | } |
  |  | 68 |  |
  | 59 | 69 | $new\_username = sanitize\_text\_field($\_POST['username']); |
  | 60 | 70 | $admin\_user = get\_user\_by('login', 'admin'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_change\_wp\_admin\_url/wpext\_change\_wp\_admin\_url.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_change_wp_admin_url/wpext_change_wp_admin_url.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_change_wp_admin_url%2Fwpext_change_wp_admin_url.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_change_wp_admin_url/wpext_change_wp_admin_url.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_change_wp_admin_url/wpext_change_wp_admin_url.php?rev=3099195#L93 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_change_wp_admin_url/wpext_change_wp_admin_url.php?rev=3145393#L93 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 93 | 93 | $slug = 'wp-extended-changes-wp-admin-url'; |
  | 94 | 94 | $callback = [ get\_called\_class(), 'settings\_changes\_wp\_admin\_url']; |
  | 95 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 95 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 96 | 96 | add\_rewrite\_rule('^wp-extended-changes-wp-admin-url/?', 'index.php?wp\_extended\_changes\_wp\_admin-url=1', 'top'); |
  | 97 | 97 | add\_rewrite\_tag('%wp\_extended\_changes\_wp\_admin%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_duplicate\_menu/wpext\_duplicate\_menu.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_duplicate_menu/wpext_duplicate_menu.php?old=3112929&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_duplicate_menu%2Fwpext_duplicate_menu.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_duplicate_menu/wpext_duplicate_menu.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicate_menu/wpext_duplicate_menu.php?rev=3112929#L62 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicate_menu/wpext_duplicate_menu.php?rev=3145393#L62 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 62 | 62 | $capability = 'manage\_options'; |
  | 63 | 63 | $callback = [get\_called\_class(), 'settings\_duplicate\_menu']; |
  | 64 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 64 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 65 | 65 | add\_rewrite\_rule('^wp-extended-duplicate-menu/?', 'index.php?wp\_extended\_duplicate\_menu=1', 'top'); |
  | 66 | 66 | add\_rewrite\_tag('%wp\_extended\_duplicate\_menu%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_duplicator/wpext\_duplicator.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_duplicator%2Fwpext_duplicator.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3099195#L24 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3145393#L24 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 |  |
  | 25 | 25 | try { |
  | 26 |  | if ( ! wp\_verify\_nonce( $\_REQUEST['wpext\_nonce'], 'wpext-ajax-nonce' ) ) { |
  | 27 |  | throw new \Exception( "Invalid nonce!" ); |
  | 28 |  | } |
  | 29 |  | $post\_ID = intval($\_REQUEST['post\_ID']); |
  | 30 |  | if( empty($post\_ID) ) { |
  | 31 |  | throw new \Exception( "Post ID not specified" ); |
  | 32 |  | } |
  | 33 |  | $duplicate = $this->duplicate\_post( $post\_ID ); |
  | 34 |  | if( is\_wp\_error( $duplicate ) ) { |
  | 35 |  | throw new \Exception( $duplicate->get\_error\_message() ); |
  | 36 |  | } |
  | 37 |  | $duplicate->url = get\_the\_permalink( $duplicate->ID ); |
  | 38 |  | $duplicate->edit\_url = get\_edit\_post\_link( $duplicate, 'json' ); |
  | 39 |  | $result = array( 'status' => true, 'duplicate' => $duplicate ); |
  |  | 26 | if ( ! current\_user\_can( 'edit\_post', $post\_ID ) ) { |
  |  | 27 | throw new \Exception( \_\_( "You are not allowed to duplicate this post.", WP\_EXTENDED\_TEXT\_DOMAIN ) ); |
  |  | 28 | } |
  |  | 29 | if ( ! wp\_verify\_nonce( $\_REQUEST['wpext\_nonce'], 'wpext-ajax-nonce' ) ) { |
  |  | 30 | throw new \Exception( "Invalid nonce!" ); |
  |  | 31 | } |
  |  | 32 | $post\_ID = intval($\_REQUEST['post\_ID']); |
  |  | 33 | if( empty($post\_ID) ) { |
  |  | 34 | throw new \Exception( "Post ID not specified" ); |
  |  | 35 | } |
  |  | 36 | $duplicate = $this->duplicate\_post( $post\_ID ); |
  |  | 37 | if( is\_wp\_error( $duplicate ) ) { |
  |  | 38 | throw new \Exception( $duplicate->get\_error\_message() ); |
  |  | 39 | } |
  |  | 40 | $duplicate->url = get\_the\_permalink( $duplicate->ID ); |
  |  | 41 | $duplicate->edit\_url = get\_edit\_post\_link( $duplicate, 'json' ); |
  |  | 42 | $result = array( 'status' => true, 'duplicate' => $duplicate ); |
  | 40 | 43 | } |
  | 41 | 44 | catch( \Exception $e ) { |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3099195#L47) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3145393#L50) |  |
  | 47 | 50 |  |
  | 48 | 51 | public function duplicate\_post( $post\_ID ) { |
  |  | 52 |  |
  | 49 | 53 | try { |
  | 50 |  | if~~( !current\_user\_can('edit\_posts'~~) ) { |
  | 51 |  | throw new \Exception( ~~"Not allowed"~~ ); |
  |  | 54 | if ( ! current\_user\_can( 'edit\_post', $post\_ID ) ) { |
  |  | 55 | throw new \Exception( \_\_( "You are not allowed to duplicate this post.", WP\_EXTENDED\_TEXT\_DOMAIN ) ); |
  | 52 | 56 | } |
  | 53 | 57 | if( empty($post\_ID) ) { |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3099195#L58) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3145393#L62) |  |
  | 58 | 62 | throw new \Exception( "Source post not found" ); |
  | 59 | 63 | } |
  |  | 64 | // Ensure that contributors can't duplicate password-protected posts. |
  |  | 65 | if ( 'private' === $post->post\_status && ! current\_user\_can( 'read\_private\_posts' ) ) { |
  |  | 66 | throw new \Exception( \_\_( "You cannot duplicate this private post.", WP\_EXTENDED\_TEXT\_DOMAIN ) ); |
  |  | 67 | } |
  |  | 68 |  |
  | 60 | 69 | // copy |
  | 61 | 70 | $newPost = json\_decode( json\_encode($post), true ); |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3099195#L64) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3145393#L73) |  |
  | 64 | 73 | 'comment\_status' => $post->comment\_status, |
  | 65 | 74 | 'ping\_status'    => $post->ping\_status, |
  | 66 |  | 'post\_author'    => ~~$new\_post\_author~~, |
  |  | 75 | 'post\_author'    => get\_current\_user\_id(), |
  | 67 | 76 | 'post\_content'   => $post->post\_content, |
  | 68 | 77 | 'post\_excerpt'   => $post->post\_excerpt, |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_export\_users/wpext\_export\_users.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?old=3112929&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_export_users%2Fwpext_export_users.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?rev=3112929#L53 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?rev=3145393#L53 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 53 | 53 | } // get\_items |
  | 54 | 54 | public function download\_user\_ajax(){ |
  |  | 55 | check\_ajax\_referer('wpext-ajax-nonce', 'wpext\_nonce'); |
  |  | 56 | if (!current\_user\_can('export')) { |
  |  | 57 | wp\_send\_json\_error(\_\_('You do not have permission to export users.', WP\_EXTENDED\_TEXT\_DOMAIN)); |
  |  | 58 | wp\_die(); |
  |  | 59 | } |
  | 55 | 60 | try { |
  | 56 |  | $id = $\_GET['id']; |
  | 57 |  | $format = !empty($\_GET['format']) ? $\_GET['format'] : 'csv'; |
  |  | 61 | $id = isset($\_GET['id']) ? intval($\_GET['id']) : 0; |
  |  | 62 | $format = !empty($\_GET['format']) ? sanitize\_text\_field($\_GET['format']) : 'csv'; |
  |  | 63 |  |
  | 58 | 64 | $user = get\_userdata( $id ); |
  | 59 | 65 | if( !$user ) { |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?rev=3112929#L79) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?rev=3145393#L85) |  |
  | 79 | 85 | wp\_die(); |
  | 80 | 86 | } // download\_user\_ajax |
  |  | 87 |  |
  | 81 | 88 | public function profile\_button( $user ) { |
  |  | 89 | if (!current\_user\_can('edit\_user', $user->ID)) { |
  |  | 90 | return; |
  |  | 91 | } |
  | 82 | 92 | $actions = $this->add\_export\_action( array(), $user ); |
  | 83 | 93 | ?> |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_external\_permalinks/wpext\_external\_permalinks.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_external_permalinks/wpext_external_permalinks.php?old=3105485&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_external_permalinks%2Fwpext_external_permalinks.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_external_permalinks/wpext_external_permalinks.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_external_permalinks/wpext_external_permalinks.php?rev=3105485#L58 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_external_permalinks/wpext_external_permalinks.php?rev=3145393#L58 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 58 | 58 | $slug = 'wp-extended-external\_permalink'; |
  | 59 | 59 | $callback = [ get\_called\_class(), 'wpext\_external\_permalink\_interface']; |
  | 60 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 60 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 61 | 61 | add\_rewrite\_rule('^wp-extended-external\_permalink/?', 'index.php?wp\_extended\_external\_permalink=1', 'top'); |
  | 62 | 62 | add\_rewrite\_tag('%wp\_extended\_external\_permalink%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_hide\_admin\_bar/wpext\_hide\_admin\_bar.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_hide_admin_bar/wpext_hide_admin_bar.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_hide_admin_bar%2Fwpext_hide_admin_bar.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_hide_admin_bar/wpext_hide_admin_bar.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_hide_admin_bar/wpext_hide_admin_bar.php?rev=3099195#L48 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_hide_admin_bar/wpext_hide_admin_bar.php?rev=3145393#L48 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 48 | 48 | $slug = 'wp-extended-hide-adminbar'; |
  | 49 | 49 | $callback = [ get\_called\_class(), 'settings\_hide\_admin\_bar']; |
  | 50 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 50 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 51 | 51 | add\_rewrite\_rule('^wp-extended-hide-adminbar/?', 'index.php?wp\_extended\_hide\_adminbar=1', 'top'); |
  | 52 | 52 | add\_rewrite\_tag('%wp\_extended\_hide\_adminbar%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_limit\_login\_attempts/wpext\_limit\_login\_attempts.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_limit_login_attempts/wpext_limit_login_attempts.php?old=3109167&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_limit_login_attempts%2Fwpext_limit_login_attempts.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_limit_login_attempts/wpext_limit_login_attempts.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_limit_login_attempts/wpext_limit_login_attempts.php?rev=3109167#L56 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_limit_login_attempts/wpext_limit_login_attempts.php?rev=3145393#L56 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 56 | 56 | $slug = 'wp-extended\_login\_attempt'; |
  | 57 | 57 | $callback = [ get\_called\_class(), 'settings\_admin\_login\_attempt']; |
  | 58 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 58 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 59 | 59 | add\_rewrite\_rule('^wp-extended\_login\_attempt/?', 'index.php?wp\_extended\_login\_attempt=1', 'top'); |
  | 60 | 60 | add\_rewrite\_tag('%wp\_extended\_login\_attempt%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_maintenance\_mode/wpext\_maintenance\_mode.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_maintenance_mode/wpext_maintenance_mode.php?old=3112929&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_maintenance_mode%2Fwpext_maintenance_mode.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_maintenance_mode/wpext_maintenance_mode.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_maintenance_mode/wpext_maintenance_mode.php?rev=3112929#L92 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_maintenance_mode/wpext_maintenance_mode.php?rev=3145393#L92 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 92 | 92 | $slug = 'wp-extended-maintenance-mode'; |
  | 93 | 93 | $callback = [ get\_called\_class(), 'settings\_admin\_maintenance\_mode']; |
  | 94 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 94 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 95 | 95 | add\_rewrite\_rule('^wp-extended-maintenance-mode/?', 'index.php?wp\_extended\_maintenance\_mode=1', 'top'); |
  | 96 | 96 | add\_rewrite\_tag('%wp\_extended\_maintenance\_mode%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_pixel\_tag\_manager/wpext\_pixel\_tag\_manager.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_pixel_tag_manager/wpext_pixel_tag_manager.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_pixel_tag_manager%2Fwpext_pixel_tag_manager.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_pixel_tag_manager/wpext_pixel_tag_manager.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_pixel_tag_manager/wpext_pixel_tag_manager.php?rev=3099195#L48 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_pixel_tag_manager/wpext_pixel_tag_manager.php?rev=3145393#L48 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 48 | 48 | $capability = 'manage\_options'; |
  | 49 | 49 | $callback = [get\_called\_class(), 'settings\_pixel\_tag\_manager']; |
  | 50 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 50 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 51 | 51 | add\_rewrite\_rule('^wp-extended-pixel-tag-manager/?', 'index.php?wp\_extended\_pixel\_tag\_manager=1', 'top'); |
  | 52 | 52 | add\_rewrite\_tag('%wp\_extended\_pixel\_tag\_manager%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_post\_order/wpext\_post\_order.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_post_order/wpext_post_order.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_post_order%2Fwpext_post_order.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_post_order/wpext_post_order.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_post_order/wpext_post_order.php?rev=3099195#L80 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_post_order/wpext_post_order.php?rev=3145393#L80 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 80 | 80 | $query .= ( $query ? "&" : "" ) . $extra; |
  | 81 | 81 | $url = $path . "?" . $query; |
  | 82 |  | wp\_redirect( $url, 302, 'WP-Extended-Post-order' ); |
  | 83 |  | exit; |
  |  | 82 | if($screen->post\_type != 'page'){ |
  |  | 83 | wp\_redirect($url, 302, 'WP-Extended-Post-order'); |
  |  | 84 | exit; |
  |  | 85 | } |
  | 84 | 86 | } |
  | 85 | 87 | else if( $\_REQUEST['orderby'] === 'menu\_order' ) { |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_smtp\_email/wpext\_smtp\_email.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_smtp_email/wpext_smtp_email.php?old=3131199&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_smtp_email%2Fwpext_smtp_email.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_smtp_email/wpext_smtp_email.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_smtp_email/wpext_smtp_email.php?rev=3131199#L37 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_smtp_email/wpext_smtp_email.php?rev=3145393#L37 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 37 | 37 | $callback = [$this, 'wp\_extended\_smtp\_settings\_page']; |
  | 38 | 38 | $icon = 'dashicons-admin-plugins'; |
  | 39 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 39 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 40 | 40 | add\_rewrite\_rule('^wp-extended\_smtp-settings/?', 'index.php?wp\_extended\_smtp-settings=1', 'top'); |
  | 41 | 41 | add\_rewrite\_tag('%wp\_extended\_smtp-settings%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_snippets/old/wpext\_snippets.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?old=3128457&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_snippets%2Fold%2Fwpext_snippets.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?rev=3128457#L42 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?rev=3145393#L42 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 42 | 42 | if((isset($menustatus) && $menustatus == 'true') && !empty($flagfavorite) ) { |
  | 43 | 43 | add\_submenu\_page( |
  | 44 |  | ~~null~~, |
  |  | 44 | '', |
  | 45 | 45 | \_\_( 'Code Snippets Old', WP\_EXTENDED\_TEXT\_DOMAIN ), // page title |
  | 46 | 46 | \_\_( 'Code Snippets Old', WP\_EXTENDED\_TEXT\_DOMAIN ), // menu title |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?rev=3128457#L52) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?rev=3145393#L52) |  |
  | 52 | 52 | $slug = 'wp-extended-snippets-old'; |
  | 53 | 53 | $callback = [ $this, 'page\_cb\_old']; |
  | 54 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 54 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 55 | 55 | add\_rewrite\_rule('^wp-extended-snippets-old/?', 'index.php?wp\_extended\_snippets=1', 'top'); |
  | 56 | 56 | add\_rewrite\_tag('%wp\_extended\_snippets%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_snippets/wp-extend-module-listing.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?old=3134252&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_snippets%2Fwp-extend-module-listing.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3134252#L113 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3145393#L113 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 113 | 113 | if ('duplicate' === $this->current\_action() && isset($\_GET['snippet\_id'])) { |
  | 114 | 114 | $nonce = $\_REQUEST['\_wpnonce']; |
  | 115 |  | if (~~!wp\_verify\_nonce($nonce, 'duplicate\_snippet\_' . $\_GET['snippet\_id'])~~) { |
  |  | 115 | if ( !wp\_verify\_nonce( $nonce, 'duplicate\_snippet\_' . sanitize\_text\_field( $\_GET['snippet\_id'] ) ) ) { |
  | 116 | 116 | die('Security check failed'); |
  | 117 | 117 | } |
  | 118 |  | $this->duplicate\_snippet(~~$\_GET['snippet\_id']~~); |
  |  | 118 | $this->duplicate\_snippet( sanitize\_text\_field($\_GET['snippet\_id']) ); |
  | 119 | 119 | } |
  | 120 | 120 | } |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3134252#L155) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3145393#L155) |  |
  | 155 | 155 | public function current\_action() { |
  | 156 | 156 | if (isset($\_REQUEST['action']) && $\_REQUEST['action'] !== -1) { |
  | 157 |  | return ~~$\_REQUEST['action']~~; |
  |  | 157 | return sanitize\_key($\_REQUEST['action']); |
  | 158 | 158 | } |
  | 159 | 159 |  |
  | 160 | 160 | if (isset($\_REQUEST['action2']) && $\_REQUEST['action2'] !== -1) { |
  | 161 |  | return ~~$\_REQUEST['action2']~~; |
  |  | 161 | return sanitize\_key($\_REQUEST['action2']); |
  | 162 | 162 | } |
  | 163 | 163 |  |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3134252#L214) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3145393#L214) |  |
  | 214 | 214 | $items = $custom\_list\_table->get\_items(); ?> |
  | 215 | 215 | <form method="get"> |
  | 216 |  | <input type="hidden" name="page" value="<?php echo ~~$\_REQUEST['page']~~; ?>"> |
  |  | 216 | <input type="hidden" name="page" value="<?php echo esc\_attr( sanitize\_text\_field( $\_REQUEST['page'] ) ); ?>"> |
  | 217 | 217 | <?php $custom\_list\_table->search\_box('Search Snippets', 'search\_id'); ?> |
  | 218 | 218 | </form> |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_snippets/wpext\_snippets.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?old=3128457&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_snippets%2Fwpext_snippets.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3128457#L104 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3145393#L104 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 104 | 104 | $slug = 'wp-extended-snippets'; |
  | 105 | 105 | $callback = [ $this, 'list\_snippets\_page']; |
  | 106 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 106 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 107 | 107 | add\_rewrite\_rule('^wp-extended-snippets/?', 'index.php?wp\_extended\_snippets=1', 'top'); |
  | 108 | 108 | add\_rewrite\_tag('%wp\_extended\_snippets%', '([^&]+)'); |
  | 109 | 109 | } |
  | 110 |  | add\_submenu\_page(~~null~~, \_\_('Add New Snippet', 'wp-extended-snippets'), \_\_('Add New Snippet', 'wp-extended-snippets'), 'manage\_options', 'wp-extended-add-snippet', array($this, 'wpext\_add\_snippet\_page')); |
  | 111 |  | add\_submenu\_page(~~null~~, \_\_('Edit Snippet', 'wp-extended-snippets'), \_\_('Edit Snippet', 'wp-extended-snippets'), 'manage\_options', 'wp-extended-edit-snippet', array($this, 'edit\_snippet\_page')); |
  |  | 110 | add\_submenu\_page('', \_\_('Add New Snippet', 'wp-extended-snippets'), \_\_('Add New Snippet', 'wp-extended-snippets'), 'manage\_options', 'wp-extended-add-snippet', array($this, 'wpext\_add\_snippet\_page')); |
  |  | 111 | add\_submenu\_page('', \_\_('Edit Snippet', 'wp-extended-snippets'), \_\_('Edit Snippet', 'wp-extended-snippets'), 'manage\_options', 'wp-extended-edit-snippet', array($this, 'edit\_snippet\_page')); |
  | 112 | 112 | } |
  | 113 | 113 |  |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3128457#L291) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3145393#L291) |  |
  | 291 | 291 | <div class="wpext\_snippet\_top\_section d-flex mb-3"> |
  | 292 | 292 | <div class="col-3"> |
  | 293 |  | <h2 class="wpext\_snippet\_title"> <?php echo $selected\_option = isset($\_GET['selected\_option']) ? $\_GET['selected\_option'] : ''; ?></h2> |
  |  | 293 | <h2 class="wpext\_snippet\_title"> |
  |  | 294 | <?php |
  |  | 295 | $selected\_option = isset($\_GET['selected\_option']) ? sanitize\_text\_field($\_GET['selected\_option']) : ''; |
  |  | 296 | echo esc\_html($selected\_option); |
  |  | 297 | ?> |
  |  | 298 | </h2> |
  | 294 | 299 | <?php self::wpext\_custom\_css\_content($selected\_option); ?> |
  | 295 | 300 | <input type="hidden" name="snippet\_position" value="<?php echo $selected\_option; ?>" id="snippet\_code\_type"> |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3128457#L548) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3145393#L553) |  |
  | 548 | 553 | } |
  | 549 | 554 | // Additional check for the specific snippets page |
  | 550 |  | if ($pagenow === 'admin.php' && isset($\_GET['page']) && ~~$\_GET['page']~~ === 'wp-extended-snippets') { |
  |  | 555 | if ($pagenow === 'admin.php' && isset($\_GET['page']) && sanitize\_text\_field($\_GET['page']) === 'wp-extended-snippets') { |
  | 551 | 556 | return false; |
  | 552 | 557 | } |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3128457#L680) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3145393#L685) |  |
  | 680 | 685 | <div class="col-lg-6 wp\_brand\_sub\_header\_right mx-lg-0 px-2"> |
  | 681 | 686 | <div class="wpext-return-module-wrap wpext\_snippet\_action"> |
  | 682 |  | <?php if(isset($\_GET['page']) && ~~$\_GET['page']~~ == 'wp-extended-snippets') { ?> |
  |  | 687 | <?php if(isset($\_GET['page']) && sanitize\_text\_field($\_GET['page']) == 'wp-extended-snippets') { ?> |
  | 683 | 688 | <button class="page-title-action wp-ext-btn-prim" ><?php \_e('Add New', WP\_EXTENDED\_TEXT\_DOMAIN);?></button> |
  | 684 | 689 | <?php } ?> |
  | 685 |  | <?php if(isset($\_GET['page']) && ~~$\_GET['page']~~ == 'wp-extended-add-snippet') { ?> |
  |  | 690 | <?php if(isset($\_GET['page']) && sanitize\_text\_field($\_GET['page']) == 'wp-extended-add-snippet') { ?> |
  | 686 | 691 | <a href='<?php echo admin\_url('admin.php?page=wp-extended-snippets'); ?>' class="wp-ext-btn-sec"><?php \_e('Back to Snippets', WP\_EXTENDED\_TEXT\_DOMAIN);?></a> |
  | 687 | 692 | <button class="wpext\_module\_action wp-ext-btn-prim wpext\_save\_snippet" ><?php \_e('Save', WP\_EXTENDED\_TEXT\_DOMAIN);?></button> |
  | 688 | 693 | <?php } |
  | 689 |  | if(isset($\_GET['page']) && ~~$\_GET['page']~~ == 'wp-extended-edit-snippet') { ?> |
  |  | 694 | if(isset($\_GET['page']) && sanitize\_text\_field($\_GET['page']) == 'wp-extended-edit-snippet') { ?> |
  | 690 | 695 | <a href='<?php echo admin\_url('admin.php?page=wp-extended-snippets'); ?>' class="wp-ext-btn-sec"><?php \_e('Back to Snippets', WP\_EXTENDED\_TEXT\_DOMAIN);?></a> |
  | 691 | 696 | <button class="wpext\_module\_action wp-ext-btn-prim wpext\_updeate\_code\_snippets" ><?php \_e('Save', WP\_EXTENDED\_TEXT\_DOMAIN);?></button> |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_tidy\_nav/wpext\_tidy\_nav.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_tidy_nav/wpext_tidy_nav.php?old=3112929&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_tidy_nav%2Fwpext_tidy_nav.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_tidy_nav/wpext_tidy_nav.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_tidy_nav/wpext_tidy_nav.php?rev=3112929#L79 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_tidy_nav/wpext_tidy_nav.php?rev=3145393#L79 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 79 | 79 | $slug = 'wp-extended-tidymenu'; |
  | 80 | 80 | $callback = [ get\_called\_class(), 'settings\_tidy\_menu']; |
  | 81 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 81 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 82 | 82 | add\_rewrite\_rule('^wp-extended-tidymenu/?', 'index.php?wp\_extended\_tidymenu=1', 'top'); |
  | 83 | 83 | add\_rewrite\_tag('%wp\_extended\_tidymenu%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_user\_sections/wpext\_user\_sections.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_user_sections/wpext_user_sections.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_user_sections%2Fwpext_user_sections.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_user_sections/wpext_user_sections.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_user_sections/wpext_user_sections.php?rev=3099195#L76 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_user_sections/wpext_user_sections.php?rev=3145393#L76 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 76 | 76 | $slug = 'wp-extended-user-sections'; |
  | 77 | 77 | $callback = [ $this, 'page\_cb']; |
  | 78 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 78 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 79 | 79 | add\_rewrite\_rule('^wp-extended-user-sections/?', 'index.php?wp\_extended\_user\_sections=1', 'top'); |
  | 80 | 80 | add\_rewrite\_tag('%wp\_extended\_user\_sections%', '([^&]+)'); |
* ## [wpextended/trunk/readme.txt](/changeset/3145393/wpextended/trunk/readme.txt?old=3134345&old_path=wpextended%2Ftrunk%2Freadme.txt "Show the [3134345:3145430] differences restricted to wpextended/trunk/readme.txt")

  | [r3134345](/browser/wpextended/trunk/readme.txt?rev=3134345#L4 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/readme.txt?rev=3145393#L4 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 5.6 |
  | 5 | 5 | Tested up to: 6.6.1 |
  | 6 |  | Stable tag: 3.0.~~8~~ |
  |  | 6 | Stable tag: 3.0.9 |
  | 7 | 7 | Requires PHP: 7.4 |
  | 8 | 8 | License: GPLv2 or later |
  | […](/browser/wpextended/trunk/readme.txt?rev=3134345#L141) | […](/browser/wpextended/trunk/readme.txt?rev=3145393#L141) |  |
  | 141 | 141 | == Changelog == |
  | 142 | 142 |  |
  |  | 143 | = 3.0.9 - 02 September 2024 = |
  |  | 144 | \* Improvement: Hide "Active Modules" until enabled any one module. |
  |  | 145 | \* Update: Part of the Patchstack VDP Program. |
  |  | 146 | \* Fix: Post Type Order - Post type order not working with hierarchical parent/children. |
  |  | 147 | \* Fix: Warnings fixed for PHP 8.\* |
  |  | 148 | \* Security Fix: Code snippet module - Escaping and sanitising output. |
  |  | 149 | \* Security Fix: Duplicate Duplicate Pages/Posts module - Added user capability checks. |
  |  | 150 | \* Security Fix: Block username module - Added user capability checks. |
  |  | 151 |  |
  | 143 | 152 | = 3.0.8 - 12 August 2024 = |
  | 144 | 153 | \* Improvement: Code snippet - Duplicate functionality. |
  | 145 |  | \* Improvement:  Quick Add Post - Updated module description. |
  |  | 154 | \* Improvement: Hide "Active Modules" until active any one module. |
  |  | 155 | \* Improvement:  Quick Add Post - Updated module description |
  | 146 | 156 | \* Fix: mkdir issue on some servers. |
  | 147 |  | \* Fix: Duplicate Menu - Updated correct Read Documentation link~~.~~ |
  |  | 157 | \* Fix: Duplicate Menu - Updated correct Read Documentation link |
  | 148 | 158 |  |
  | 149 | 159 | = 3.0.7 - 5 August 2024 = |
  | […](/browser/wpextended/trunk/readme.txt?rev=3134345#L409) | […](/browser/wpextended/trunk/readme.txt?rev=3145393#L419) |  |
  | 409 | 419 | The "Disable Blog" module is designed for websites that don't require a blog feature. By disabling blog-related functionalities, this module helps streamline your admin area. |
  | 410 | 420 |  |
  |  | 421 | = How can I report security bugs? = |
  |  | 422 |  |
  |  | 423 | You can report security bugs through the Patchstack Vulnerability Disclosure Program. The Patchstack team help validate, triage and handle any security vulnerabilities. [Report a security vulnerability.](https://patchstack.com/database/vdp/wpextended) |
* ## [wpextended/trunk/wp-extended.php](/changeset/3145393/wpextended/trunk/wp-extended.php?old=3134252&old_path=wpextended%2Ftrunk%2Fwp-extended.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/wp-extended.php")

  | [r3134345](/browser/wpextended/trunk/wp-extended.php?rev=3134252#L4 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/wp-extended.php?rev=3145393#L4 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: https://wordpress.org/plugins/wpextended |
  | 5 | 5 | \* Description: Many of your favourite plugins rolled up into 1 modular plugin making your WordPress faster and easier to manage. |
  | 6 |  | \* Version: 3.0.~~8~~ |
  |  | 6 | \* Version: 3.0.9 |
  | 7 | 7 | \* Requires at least: 5.6 |
  | 8 | 8 | \* Requires PHP:      7.4 |
  | […](/browser/wpextended/trunk/wp-extended.php?rev=3134252#L28) | […](/browser/wpextended/trunk/wp-extended.php?rev=3145393#L28) |  |
  | 28 | 28 |  |
  | 29 | 29 | }else{ |
  | 30 |  | define( 'WP\_EXTENDED\_VERSION', '3.0.~~8~~' ); |
  |  | 30 | define( 'WP\_EXTENDED\_VERSION', '3.0.9' ); |
  | 31 | 31 | define( 'WP\_EXTENDED\_TEXT\_DOMAIN', 'wp-extended' ); |
  | 32 | 32 | define( 'WP\_EXTENDED\_PATH', plugin\_dir\_path( \_\_FILE\_\_ ) ); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3145430&old=3134345&new_path=%2Fwpextended%2Ftrunk&old_path=%2Fwpextended%2Ftrunk)
* [Zip Archive](?format=zip&new=3145430&old=3134345&new_path=%2Fwpextended%2Ftrunk&old_path=%2Fwpextended%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


