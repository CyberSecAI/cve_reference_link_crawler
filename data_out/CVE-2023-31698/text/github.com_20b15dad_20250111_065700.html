
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbludit%2Fbludit%2Fissues%2F1212)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbludit%2Fbludit%2Fissues%2F1212)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=bludit%2Fbludit)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bludit](/bludit)
/
**[bludit](/bludit/bludit)**
Public

* [Notifications](/login?return_to=%2Fbludit%2Fbludit) You must be signed in to change notification settings
* [Fork
  295](/login?return_to=%2Fbludit%2Fbludit)
* [Star
   1.3k](/login?return_to=%2Fbludit%2Fbludit)

* [Code](/bludit/bludit)
* [Issues
  51](/bludit/bludit/issues)
* [Pull requests
  10](/bludit/bludit/pulls)
* [Actions](/bludit/bludit/actions)
* [Security](/bludit/bludit/security)
* [Insights](/bludit/bludit/pulse)

Additional navigation options

* [Code](/bludit/bludit)
* [Issues](/bludit/bludit/issues)
* [Pull requests](/bludit/bludit/pulls)
* [Actions](/bludit/bludit/actions)
* [Security](/bludit/bludit/security)
* [Insights](/bludit/bludit/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fbludit%2Fbludit%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fbludit%2Fbludit%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Store XSS #1212

Closed

[3as0n](/3as0n) opened this issue
Jun 19, 2020
· 10 comments

Closed

# [Store XSS](#top) #1212

[3as0n](/3as0n) opened this issue
Jun 19, 2020
· 10 comments

## Comments

[![@3as0n](https://avatars.githubusercontent.com/u/8120951?s=80&v=4)](/3as0n)

Copy link

### **[3as0n](/3as0n)** commented [Jun 19, 2020](#issue-641764976)

| Describe your problem <https://github.com/bludit/bludit/blob/master/bl-kernel/ajax/logo-upload.php>  Logo upload only determines the suffix, but not the content, which causes XSS and the user can inject any javascript and html code in the page  payload [image](https://user-images.githubusercontent.com/8120951/85107565-c28ea200-b240-11ea-9967-e68dc6b38462.png)  [image](https://user-images.githubusercontent.com/8120951/85107027-d4237a00-b23f-11ea-904b-143e35b6e1e8.png) [image](https://user-images.githubusercontent.com/8120951/85107079-ea313a80-b23f-11ea-98e1-3f1d683356d5.png) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@tamir-ben](https://avatars.githubusercontent.com/u/56576974?s=80&v=4)](/tamir-ben)

Copy link

### **[tamir-ben](/tamir-ben)** commented [Jun 25, 2020](#issuecomment-649505180) • edited Loading

| Any known fix for issue yet? Seems like it was assigned to [CVE-2020-15006](https://github.com/advisories/GHSA-vpx4-gw3g-4jwv "CVE-2020-15006") |
| --- |

All reactions

Sorry, something went wrong.

[![@3as0n](https://avatars.githubusercontent.com/u/8120951?s=80&v=4)](/3as0n)

Copy link

Author

### **[3as0n](/3as0n)** commented [Jun 25, 2020](#issuecomment-649512792) via email

| Yes, this is the cve number. I think we can either delete the svg format or add a check mechanism. But it affects performance. … ---Original--- From: "galaktipus"<notifications@github.com&gt; Date: Thu, Jun 25, 2020 20:17 PM To: "bludit/bludit"<bludit@noreply.github.com&gt;; Cc: "Author"<author@noreply.github.com&gt;;"bj60907811"<171583065@qq.com&gt;; Subject: Re: [bludit/bludit] Store XSS ([#1212](https://github.com/bludit/bludit/issues/1212)) Any knows fix for issue yet? Seems like it was assigned to CVE-2020-15006 — You are receiving this because you authored the thread. Reply to this email directly, view it on GitHub, or unsubscribe. |
| --- |

All reactions

Sorry, something went wrong.

[![@dignajar](https://avatars.githubusercontent.com/u/507352?s=80&u=5b98d16c0b58a7aef90250927d0ff5282ca59d92&v=4)](/dignajar)

Copy link

Member

### **[dignajar](/dignajar)** commented [Jun 25, 2020](#issuecomment-649514491)

| I will check, is not a problem for Bludit because the users are trusted by the Administrator, I mean Bludit doesn't have user registration.  Feel free to provide a fix for it.  Regards |
| --- |

All reactions

Sorry, something went wrong.

[![@3as0n](https://avatars.githubusercontent.com/u/8120951?s=80&v=4)](/3as0n)

Copy link

Author

### **[3as0n](/3as0n)** commented [Jun 26, 2020](#issuecomment-649931423) via email

| If people enter the background, they can use this vulnerability to spread or fish malicious JS. If someone's domain name is trusted … ------------------&nbsp;原始邮件&nbsp;------------------ 发件人:&nbsp;"Diego Najar"<notifications@github.com&gt;; 发送时间:&nbsp;2020年6月25日(星期四) 晚上8:38 收件人:&nbsp;"bludit/bludit"<bludit@noreply.github.com&gt;; 抄送:&nbsp;"仁豪装饰"<171583065@qq.com&gt;;"Author"<author@noreply.github.com&gt;; 主题:&nbsp;Re: [bludit/bludit] Store XSS ([#1212](https://github.com/bludit/bludit/issues/1212)) I will check, is not a problem for Bludit because the users are trusted by the Administrator, I mean Bludit doesn't have user registration. Feel free to provide a fix for it. Regards — You are receiving this because you authored the thread. Reply to this email directly, view it on GitHub, or unsubscribe. |
| --- |

All reactions

Sorry, something went wrong.

[![@ghost](https://avatars.githubusercontent.com/u/10137?s=80&v=4)](/ghost)

Copy link

### **[ghost](/ghost)** commented [Jun 26, 2020](#issuecomment-650217389) • edited by ghost Loading

| Vector Images are really important (especially for responsive design), but many Content Management Systems avoid them because detecting and filtering XSS is a horrible job.  However, losing SVG Support in Bludit shouldn't be the way to go. So how about the following Validation function (can be part of the Valid helper class). It's may not perfect now, but it works on the most common XSS attacks and I also checked the used Regular Expression against [MDN's SVG Attribute's list](https://developer.mozilla.org/de/docs/Web/SVG/Attribute) to avoid false positives.  ``` <?php  class Valid {     static public function svg($content, $requireXmlTag = false, $requireDoctypeTag = false) {         if($requireXmlTag && stripos($content, "<?xml") !== 0) {             return false;         }         if($requireDoctypeTag && stripos($content, "<!DOCTYPE") === false) {             return false;         }          // Validate XML Format         try {             $xml = @new SimpleXMLElement($content);         } catch(Exception $e) {             $xml = false;         }         if(!$xml) {             return false;         }          // Check Basic XSS         if(!!preg_match("/(<(\/)?script|on[a-z]+=|(java)?script:)/i", $content)) {             return false;         }         return true;     } } ```  ~ Sam. |
| --- |

All reactions

Sorry, something went wrong.

[![@ghost](https://avatars.githubusercontent.com/u/10137?s=80&v=4)](/ghost)

Copy link

### **[ghost](/ghost)** commented [Jun 26, 2020](#issuecomment-650224129) • edited by ghost Loading

| We can also add the following regular expression to avoid URLs except the w3.org standards too, which may leads to false positives if someone adds a URL as comment. This is also not fully tested yet.  ``` (http.)?(:\/\/)?(www\.)(?!w3\.org)  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@working-name](https://avatars.githubusercontent.com/u/16505052?s=80&u=203fdfa877c447b7dc9cfd0c0e452517fd7093f8&v=4)](/working-name)

Copy link

### **[working-name](/working-name)** commented [Jun 26, 2020](#issuecomment-650433274)

| [@SamBrishes](https://github.com/SamBrishes) That regex is a good start but it gets complicated fast: <https://owasp.org/www-community/xss-filter-evasion-cheatsheet>  Especially when you can have whitespace in the word 'javascript:'. Let me know if you're serious about using regex for this, I'd be happy to make one that catches the known methods people use to bypass xss checks. |
| --- |

All reactions

Sorry, something went wrong.

[![@3as0n](https://avatars.githubusercontent.com/u/8120951?s=80&v=4)](/3as0n)

Copy link

Author

### **[3as0n](/3as0n)** commented [Jun 27, 2020](#issuecomment-650471597) via email

| It's a good idea. … ---Original--- From: "SamBrishes"<notifications@github.com&gt; Date: Fri, Jun 26, 2020 22:56 PM To: "bludit/bludit"<bludit@noreply.github.com&gt;; Cc: "Author"<author@noreply.github.com&gt;;"bj60907811"<171583065@qq.com&gt;; Subject: Re: [bludit/bludit] Store XSS ([#1212](https://github.com/bludit/bludit/issues/1212)) We can also add the following regular expression to avoid URLs except the w3.org standards, which may leads to false positives if someone adds a URL as comment. This is also not fully tested yet. (http.)?(:)?\/\/(www\.)(?!w3\.org) — You are receiving this because you authored the thread. Reply to this email directly, view it on GitHub, or unsubscribe. |
| --- |

All reactions

Sorry, something went wrong.

[![@ghost](https://avatars.githubusercontent.com/u/10137?s=80&v=4)](/ghost)

Copy link

### **[ghost](/ghost)** commented [Jun 27, 2020](#issuecomment-650501547) • edited by ghost Loading

| Especially when you can have whitespace in the word 'javascript:'. Let me know if you're serious about using regex for this, I'd be happy to make one that catches the known methods people use to bypass xss checks.  Feel free to bypass the regex, but keep in mind, that it still need to be a valid XML file according to `SimpleXMLElement`.  Of course, we can also use an (adapted) version of the Ulf Harnhammar's [Kses Library](https://github.com/pytesNET/php-helpers/blob/master/PIT/Kses/Kses.php) and check each single tag and attribute available in a SVG image only, but I don't think that this is really necessary.  Anyway, Bludit should also just allow admins to upload SVGs to restrict the responsibility and I guess it is also important to check the MIME type of images too, next to the file extension. (For example as I'm using it on my [media](https://github.com/pytesNET/media/blob/master/system/manager.php#L183) plugin). |
| --- |

All reactions

Sorry, something went wrong.

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
mentioned this issue
[Jun 28, 2020](#ref-pullrequest-646872767)

[MIME Type Check for Issue #1218 and #1212
#1219](/bludit/bludit/pull/1219)
 Merged

[dignajar](/dignajar)
added a commit
that referenced
this issue
[Jun 29, 2020](#ref-commit-4282a97)
[![@dignajar](https://avatars.githubusercontent.com/u/507352?s=40&u=5b98d16c0b58a7aef90250927d0ff5282ca59d92&v=4)](/dignajar)

`[Merge pull request](/bludit/bludit/commit/4282a976a6cdcc6a22fc30e69481d070ced8bb01 "Merge pull request #1219 from SamBrishes/patch-010

MIME Type Check for Issue #1218 and #1212") [#1219](https://github.com/bludit/bludit/pull/1219) [from SamBrishes/patch-010](/bludit/bludit/commit/4282a976a6cdcc6a22fc30e69481d070ced8bb01 "Merge pull request #1219 from SamBrishes/patch-010

MIME Type Check for Issue #1218 and #1212")`
…

`[4282a97](/bludit/bludit/commit/4282a976a6cdcc6a22fc30e69481d070ced8bb01)`

```
MIME Type Check for Issue [#1218](https://github.com/bludit/bludit/issues/1218) and [#1212](https://github.com/bludit/bludit/issues/1212)
```

[![@dignajar](https://avatars.githubusercontent.com/u/507352?s=80&u=5b98d16c0b58a7aef90250927d0ff5282ca59d92&v=4)](/dignajar)

Copy link

Member

### **[dignajar](/dignajar)** commented [Feb 22, 2022](#issuecomment-1047955886)

| Hello, with the new version of Bludit v4.0 rc1, I would like to close the old Github issues. If you feel that your issue is not resolved in the latest version, create a new ticket.   * Help and Support use the Forum <https://forum.bludit.org> * Bugs and new requests here in Github <https://github.com/bludit/bludit/issues> |
| --- |

All reactions

Sorry, something went wrong.

[![@dignajar](https://avatars.githubusercontent.com/u/507352?s=40&u=5b98d16c0b58a7aef90250927d0ff5282ca59d92&v=4)](/dignajar)
[dignajar](/dignajar)
closed this as [completed](/bludit/bludit/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Feb 22, 2022](#event-6119241321)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fbludit%2Fbludit%2Fissues%2F1212)

Assignees

No one assigned

Labels

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@dignajar](https://avatars.githubusercontent.com/u/507352?s=52&v=4)](/dignajar) [![@3as0n](https://avatars.githubusercontent.com/u/8120951?s=52&v=4)](/3as0n) [![@working-name](https://avatars.githubusercontent.com/u/16505052?s=52&v=4)](/working-name) [![@tamir-ben](https://avatars.githubusercontent.com/u/56576974?s=52&v=4)](/tamir-ben)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

