The provided content is related to CVE-2024-5039.

**Root Cause of Vulnerability:**
The vulnerability stems from insufficient input sanitization and output escaping within the HUSKY â€“ Products Filter Professional for WooCommerce plugin. Specifically, the plugin's shortcode attributes are not properly sanitized, allowing for the injection of malicious web scripts.

**Weaknesses/Vulnerabilities Present:**
- Stored Cross-Site Scripting (XSS): Malicious scripts injected into the plugin's shortcode attributes are stored in the database and executed when a user accesses the page containing the shortcode.

**Impact of Exploitation:**
- The impact is Stored Cross-Site Scripting, which can allow an attacker to execute arbitrary JavaScript code in the browsers of users accessing the vulnerable pages. This can lead to:
    - Session hijacking
    - Redirecting users to malicious websites
    - Defacement
    - Information theft

**Attack Vectors:**
- The attack vector is through the use of the plugin's shortcode(s) by an authenticated user. An attacker with contributor-level access or higher can inject malicious web scripts via the plugin's shortcode attributes.

**Required Attacker Capabilities/Position:**
- The attacker must be an authenticated user with at least contributor-level access to the WordPress site.
- The attacker needs the ability to modify content that uses the vulnerable shortcode (e.g., pages, posts, custom post types).

**Additional Details from the Content:**
- The vulnerability was reported by Richard Telleng (stueotue) from wordfence.com.
- The fix for this vulnerability was included in version 1.3.6 of the plugin.
- The vulnerable code was found within `woocommerce-products-filter/trunk/views/woof.php`.
- The vulnerability was a stored XSS and it was fixed in changeset 3093324.
- The affected versions of the plugin were all versions up to and including 1.3.5.3.
- Several code changes were made to address this vulnerability, primarily in `woocommerce-products-filter/trunk/classes/helper.php` and other files to sanitize and properly escape output, and improve security. Examples of fixes include:
    - Replacing `sanitize_text_field(esc_html($value))` with `esc_html($value)` in `classes/helper.php`
    - Using `esc_url` for URLs, `esc_attr` for HTML attributes, `wp_kses_post` to sanitize HTML, `intval` to parse integers and `apply_filters` to modify titles.
    - Adding nonces for sensitive actions