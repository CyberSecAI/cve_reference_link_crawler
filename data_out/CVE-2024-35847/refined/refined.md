```
{
  "vulnerability": {
    "root_cause": "The error handling path in `its_vpe_irq_domain_alloc()` caused a double free when `its_vpe_init()` failed after successfully allocating at least one interrupt. This happened because `its_vpe_irq_domain_free()` frees the interrupts along with the area bitmap and the `vprop_page`, and `its_vpe_irq_domain_alloc()` would subsequently free the area bitmap and the `vprop_page` again.",
    "weaknesses": [
      "Double free"
    ],
    "impact": "A double free vulnerability can lead to memory corruption and potentially a denial of service or privilege escalation.",
     "attack_vectors": [
        "The vulnerability is triggered during the initialization of the interrupt domain, specifically when an error occurs during `its_vpe_init()` after successfully allocating at least one interrupt."
     ],
    "required_capabilities": "The attacker needs to trigger the error condition in the `its_vpe_init()` after at least one interrupt has been allocated. This may require specific hardware or configuration scenarios."
  },
  "fix": "The fix involves unconditionally invoking `its_vpe_irq_domain_free()`, which handles all cases correctly, and removing the bitmap/`vprop_page` freeing from `its_vpe_irq_domain_alloc()`."
}
```