Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-23830

**Root Cause:**
The vulnerability stems from the application's reliance on the `HTTP_HOST` header to construct the base URL for password reset links. The `HTTP_HOST` header is client-controlled, making it susceptible to manipulation.

**Weaknesses/Vulnerabilities:**
- **Host Header Injection:** The application uses the `HTTP_HOST` header, which can be modified by an attacker, to generate password reset links.
- **Insecure URL Generation:** The application constructs URLs without properly validating the host, allowing an attacker to inject a malicious host.

**Impact of Exploitation:**
- **Account Hijacking:** An attacker can poison the password reset link sent to the victim. When the victim clicks the link, the reset verification hash is sent to the attacker's controlled server instead. The attacker can then use this hash to reset the victim's password and gain control of their account.

**Attack Vectors:**
- The attacker sends a password reset request for a known user.
- The attacker intercepts the request with a proxy and modifies the `Host` header to point to a malicious server they control.
- The application generates a password reset email using the attacker-controlled host.
- The user clicks on the malicious link.

**Required Attacker Capabilities/Position:**
- The attacker needs to know the victim's username and email address.
- The attacker needs to be able to intercept and modify HTTP requests, typically by using an intercepting proxy.
- The attacker needs a server they control to receive the verification hash when the victim clicks on the link.

**Additional Details:**
- The vulnerability is present in MantisBT versions prior to 2.26.1.
- The fix involves using `$_SERVER['SERVER_NAME']` (server controlled) instead of `$_SERVER['HTTP_HOST']` (client controlled), and prompting the administrator to configure `$g_path` during installation
- The vulnerability can also be triggered by using the `X-Forwarded-Host` header
- The fix also detects if `$g_path` was defaulted and alerts the user if it's using the default, insecure value.
- The advisory also references the OWASP guide on Host Header Injection.