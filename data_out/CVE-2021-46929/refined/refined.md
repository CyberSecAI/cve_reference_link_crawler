```
{
  "CVE_data_meta": {
    "ID": "CVE-2021-46929",
    "ASSIGNER": "cve@example.org"
  },
  "description": {
    "description_data": [
      {
        "lang": "en",
        "value": "The provided commits fix a use-after-free vulnerability in the Linux kernel SCTP implementation. This vulnerability occurs in the `sctp_sock_dump` function when an association is peeled off and the old socket is freed after being accessed via `asoc->base.sk` but before `lock_sock(sk)` is called. This can lead to a use-after-free condition when the freed socket is accessed later in the `sctp_sock_dump` function. The fix involves delaying the endpoint free using `call_rcu` and moving the `sock_put` and endpoint free to `sctp_endpoint_destroy_rcu`. Additionally, a check is added to ensure the endpoint hasn't been peeled off while dumping."
      }
    ]
  },
  "impact": {
    "cvss": {
      "version": "3.1",
      "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
      "attackComplexity": "LOW",
      "attackVector": "LOCAL",
      "availabilityImpact": "HIGH",
      "confidentialityImpact": "HIGH",
      "integrityImpact": "HIGH",
      "privilegesRequired": "LOW",
      "scope": "UNCHANGED",
      "userInteraction": "NONE",
      "baseScore": 7.8,
      "baseSeverity": "HIGH"
    }
  },
  "configurations": {
    "nodes": [
      {
        "operator": "OR",
        "cpe_match": [
          {
            "vulnerable": true,
             "cpe23Uri": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
             "versionEndExcluding": "5.16"
          }
        ]
      }
    ]
  },
  "references": {
    "reference_data": [
      {
        "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5ec7d18d1813a5bead0b495045606c93873aecbb",
        "name": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5ec7d18d1813a5bead0b495045606c93873aecbb",
        "refsource": "MISC"
      },
      {
        "url": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=af6e6e58f7ebf86b4e7201694b1e4f3a62cbc3ec",
        "name": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=af6e6e58f7ebf86b4e7201694b1e4f3a62cbc3ec",
        "refsource": "MISC"
      },
      {
         "url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=831de271452b87657fcf8d715ee20519b79caef5",
         "name":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=831de271452b87657fcf8d715ee20519b79caef5",
         "refsource":"MISC"
      },
       {
         "url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8873140f95d4977bf37e4cf0d5c5e3f6e34cdd3e",
         "name":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8873140f95d4977bf37e4cf0d5c5e3f6e34cdd3e",
         "refsource":"MISC"
      },
      {
        "url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=75799e71df1da11394740b43ae5686646179561d",
         "name":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=75799e71df1da11394740b43ae5686646179561d",
         "refsource":"MISC"
      },
       {
        "url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=769d14abd35e0e153b5149c3e1e989a9d719e3ff",
         "name":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=769d14abd35e0e153b5149c3e1e989a9d719e3ff",
         "refsource":"MISC"
      }
    ]
  },
   "vulnerability": {
        "Root cause of vulnerability": "The vulnerability is due to a race condition where the socket associated with an SCTP endpoint can be freed before the `lock_sock()` function is called within `sctp_sock_dump`, leading to a use-after-free when accessing the freed socket structure.",
        "Weaknesses/vulnerabilities present": "Use-after-free vulnerability.",
        "Impact of exploitation": "A successful exploit could lead to system crash, arbitrary code execution or information disclosure.",
        "Attack vectors": "Local access is required to trigger the vulnerable code path via netlink interface.",
        "Required attacker capabilities/position": "Attacker needs to have local access and be able to trigger the `sctp_diag_dump` function via netlink."
    }
}
```