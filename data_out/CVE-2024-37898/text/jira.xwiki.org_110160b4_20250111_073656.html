

[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21553)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21553)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-21553](/browse/XWIKI-21553)

# Document overwrite from edit through Rights UI

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21553 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  [16.0.0-rc-1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+16.0.0-rc-1 "16.0.0-rc-1 "), [15.5.5](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.5.5 "15.5.5 "), [15.10.6](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.10.6 "15.10.6 "), [14.10.21](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.10.21 "14.10.21 ")
* **Affects Version/s:**
  14.2, 13.10.4
* **Component/s:**
  [Flamingo Skin](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Flamingo+Skin%22 "Flamingo Skin ")
* **Labels:**
  + [attack\_edit](/issues/?jql=labels+%3D+attack_edit "attack_edit")
  + [attacker\_edit](/issues/?jql=labels+%3D+attacker_edit "attacker_edit")
  + [regression](/issues/?jql=labels+%3D+regression "regression")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Tests:**
  Unit
* **Difficulty:**
  Unknown
* **Documentation:**
  N/A
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

XWIKI-14088 already covers extensively why edit rights and view rights need to be separated. However, this leads to a side effect on the UI to edit rights on documents:

As a user with edit rights, go to the Access Rights UI, switch to Users, and click at least twice on the View right for Unregistered Users.

The original document has now been overwritten with an empty one, which was unlikely to be what the user expected.

This bug is due to the fact that denying view rights does not affect edit rights, but prevents the user from viewing the content of the document. Thus, the document ends up saved by a user that cannot access the original content.

Note that this does not happen while editing the rights of any other user on this UI, since the requests usually go through a `view` endpoint. `Unregistered Users` is the only exception, using the `edit` endpoint with Flamingo: <https://github.com/xwiki/xwiki-platform/blob/master/xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-resources/src/main/resources/flamingo/rightsUI.vm#L111>

#### Attachments

#### Issue Links

is caused by

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19549](/browse/XWIKI-19549)
Page content, object properties and title leak on fully private wiki with xpages on the login action

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[Security Advisory](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-33gp-gmg3-hfpq)

#### Activity

#### People

Assignee:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Reporter:

![pjeanjean](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Pierre Jeanjean

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

#### Dates

Created:

14/Nov/23 14:12

Updated:

17/Jun/24 12:28

Resolved:

16/Jan/24 16:56

Date of First Response:

08/Jan/24 6:09 PM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

